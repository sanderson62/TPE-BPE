* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
    80* 101016  CR2015082500001  PEMA  ADD COMPANY VPP
    81* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    82* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    83* 052918  CR2018040600002  PEMA  ADD REFUND DIRECT INDICATOR
    84* 021519  CR2019021100001  PEMA  non-monthly al calcs
    85* 012220  CR2018092700002  TANA  Add letter reqd field
    86******************************************************************
    87
    88 ENVIRONMENT DIVISION.
    89
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page   4
* EL6311.cbl
    91 DATA DIVISION.
    92 WORKING-STORAGE SECTION.
    93 01  DFH-START PIC X(04).
    94 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    95 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    96 77  FILLER  PIC X(32)  VALUE '********************************'.
    97 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    98 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    99 77  A1                          PIC S999 COMP-3 VALUE +0.
   100 77  N1                          PIC S999 COMP-3 VALUE +0.
   101 77  N2                          PIC S999 COMP-3 VALUE +0.
   102 77  N3                          PIC S999 COMP-3 VALUE +0.
   103 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
   104 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
   105 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   106     88  REVERSAL                    VALUE 'Y'.
   107 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   108 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   109 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   110 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   111 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   112     88  ERMAIL-FOUND                 VALUE 'Y'.
   113 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   114 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   115 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   116 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   117     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   118 77  ws-stop-sw                  pic x value ' '.
   119     88  i-say-stop                 value 'Y'.
   120 77  ws-check-sw                 pic x value ' '.
   121     88  i-have-checks              value 'Y'.
   122 77  ws-proc-check-sw            pic x value ' '.
   123     88  i-have-processed-checks    value 'Y'.
   124 77  ws-any-check-sw             pic x value ' '.
   125     88  i-have-a-check-period      value 'Y'.
   126 77  ws-chek-browse-sw           pic x value ' '.
   127 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   128 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   129 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   130 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   131 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   132 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   133 77  ws-elcrtt-update-sw         pic x value ' '.
   134     88  update-elcrtt              value 'Y'.
   135 01  P pointer.
   136 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   137 01  var-ptr pointer.
   138 01  env-var-len                 pic 9(4)  binary.
   139 01  rc                          pic 9(9)  binary.
   140 01  WS-KIXSYS.
   141     05  WS-KIX-FIL1             PIC X(10).
   142     05  WS-KIX-APPS             PIC X(10).
   143     05  WS-KIX-ENV              PIC X(10).
   144     05  WS-KIX-MYENV            PIC X(10).
   145     05  WS-KIX-SYS              PIC X(10).
   146*    COPY ELCSCTM.
   147******************************************************************
   148*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page   5
* EL6311.cbl
   149*                                                                *
   150*                            ELCSCTM                             *
   151*                            VMOD=2.001                          *
   152*                                                                *
   153*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   154*                                                                *
   155******************************************************************
   156 01  SECURITY-MESSAGE.
   157     12  FILLER                          PIC X(30)
   158            VALUE '** LOGIC SECURITY VIOLATION -'.
   159     12  SM-READ                         PIC X(6).
   160     12  FILLER                          PIC X(5)
   161            VALUE ' PGM='.
   162     12  SM-PGM                          PIC X(6).
   163     12  FILLER                          PIC X(5)
   164            VALUE ' OPR='.
   165     12  SM-PROCESSOR-ID                 PIC X(4).
   166     12  FILLER                          PIC X(6)
   167            VALUE ' TERM='.
   168     12  SM-TERMID                       PIC X(4).
   169     12  FILLER                          PIC XX   VALUE SPACE.
   170     12  SM-JUL-DATE                     PIC 9(5).
   171     12  FILLER                          PIC X    VALUE SPACE.
   172     12  SM-TIME                         PIC 99.99.
   173
   174
   175*    COPY ELCSCRTY.
   176******************************************************************
   177*                                                                *
   178*                                                                *
   179*                            ELCSCRTY                            *
   180*                            VMOD=2.001                          *
   181*                                                                *
   182*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   183*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   184*        SAVED IN PI-SECURITY-ADDRESS.                           *
   185*                                                                *
   186******************************************************************
   187 01  SECURITY-CONTROL.
   188     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   189     12  FILLER                       PIC XX    VALUE 'SC'.
   190     12  SC-CREDIT-CODES.
   191         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   192             20  SC-CREDIT-DISPLAY    PIC X.
   193             20  SC-CREDIT-UPDATE     PIC X.
   194     12  SC-CLAIMS-CODES.
   195         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   196             20  SC-CLAIMS-DISPLAY    PIC X.
   197             20  SC-CLAIMS-UPDATE     PIC X.
   198
   199 01  WS-VA-NO-COMM-MESS.
   200     12  FILLER                  PIC X(41) VALUE
   201        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   202 01  WS-OC-MESSAGE.
   203     12  FILLER                  PIC X(43) VALUE
   204        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   205     12  WS-OC-DIS-AMT           PIC -----9.99.
   206     12  FILLER                  PIC X(4) VALUE ' ON '.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page   6
* EL6311.cbl
   207     12  WS-OC-DATE              PIC X(10).
   208 01  WS-DATE-AREA.
   209     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   210     12  WS-CURRENT-DT.
   211         16  FILLER              PIC X(6)    VALUE SPACES.
   212         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   213     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   214     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   215     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   216
   217 01  STANDARD-AREAS.
   218     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   219     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   220     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   221     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   222     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   223     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   224     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   225     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   226     12  PGM-NAME                PIC X(8).
   227     12  TIME-IN                 PIC S9(7).
   228     12  TIME-OUT-R  REDEFINES TIME-IN.
   229         16  FILLER              PIC X.
   230         16  TIME-OUT            PIC 99V99.
   231         16  FILLER              PIC XX.
   232     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   233     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   234     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   235     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   236     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   237     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   238     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   239     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   240     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   241     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   242     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   243     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   244     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   245     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   246     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   247     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   248     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   249     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   250     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   251     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   252     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   253     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   254     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   255     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   256     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   257     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   258     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   259     12  FILE-ID                 PIC X(8).
   260     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   261     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   262     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   263     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   264     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page   7
* EL6311.cbl
   265     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   266     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   267     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   268     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   269     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   270     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   271     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   272     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   273     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   274     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   275
   276 01  WS-PASS-AREA.
   277     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   278     05  WS-PASS-VADS-REC    PIC X(350).
   279*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   280*                                COPY ELCZREC.
   281******************************************************************
   282*                                                                *
   283*                                                                *
   284*                            ELCZREC.                            *
   285*                                                                *
   286*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   287*                                                                *
   288******************************************************************
   289*-----------------------------------------------------------------
   290*                   C H A N G E   L O G
   291*
   292* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   293*-----------------------------------------------------------------
   294*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   295* EFFECTIVE    NUMBER
   296*-----------------------------------------------------------------
   297* 122011    2011022800001  AJRA  NEW FILE
   298* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   299* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   300* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   301* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   302*-----------------------------------------------------------------
   303 01  W-Z-CONTROL-DATA.
   304     05  W-NUMBER-OF-COPIES      PIC  9.
   305     05  FILLER                  PIC  X.
   306     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   307     05  FILLER                  PIC  X.
   308     05  W-DAYS-TO-RESEND        PIC  999.
   309     05  FILLER                  PIC  X.
   310     05  W-FORM-TO-RESEND        PIC  X(4).
   311     05  W-ADD-BAR-CODE          PIC  X.
   312     05  W-PROMPT-LETTER         PIC  X.
   313     05  W-HAS-RETURN-ENV        PIC  X.
   314     05  W-ENCLOSURE-CD          PIC  XXX.
   315     05  W-SIG-FLAG-DEFAULT      PIC  X.
   316     05  W-AUTO-CLOSE-IND        PIC  X.
   317     05  FILLER                  PIC  X.
   318     05  W-LETTER-TO-BENE        PIC  X.
   319     05  FILLER                  PIC  X.
   320     05  W-LETTER-TO-ACCT        PIC  X.
   321     05  FILLER                  PIC  X.
   322     05  W-LETTER-TYPE           PIC  X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page   8
* EL6311.cbl
   323     05  FILLER                  PIC  X.
   324     05  W-PRINT-CERTIFICATE     PIC  X.
   325     05  FILLER                  PIC  X.
   326     05  W-REFUND-REQUIRED       PIC  X.
   327     05  FILLER                  PIC  X.
   328     05  W-ONBASE-CODE           PIC  XX.
   329     05  FILLER                  PIC  X.
   330     05  W-ACCT-SUMM             PIC  X.
   331     05  FILLER                  PIC  X.
   332     05  W-CSO-SUMM              PIC  X.
   333     05  FILLER                  PIC  X.
   334     05  W-REASONS-REQUIRED      PIC  X.
   335     05  FILLER                  PIC  X(29).
   336******************************************************************
   337*                                                                *
   338*              A C C E S S   K E Y S                             *
   339*                                                                *
   340******************************************************************
   341
   342 01  ACCESS-KEYS.
   343     12  ERPYAJ-KEY.
   344         16  ERPYAJ-COMPANY-CD       PIC X.
   345         16  ERPYAJ-CARRIER          PIC X.
   346         16  ERPYAJ-GROUPING         PIC X(6).
   347         16  ERPYAJ-FIN-RESP         PIC X(10).
   348         16  ERPYAJ-ACCOUNT          PIC X(10).
   349         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   350         16  ERPYAJ-TYPE             PIC X.
   351     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   352     12  ELCERT-KEY.
   353         16  ELCERT-COMPANY-CD       PIC X.
   354         16  ELCERT-CARRIER          PIC X.
   355         16  ELCERT-GROUPING         PIC X(6).
   356         16  ELCERT-STATE            PIC XX.
   357         16  ELCERT-ACCOUNT          PIC X(10).
   358         16  ELCERT-CERT-EFF-DT      PIC XX.
   359         16  ELCERT-CERT-NO.
   360             20  ELCERT-CERT-PRIME   PIC X(10).
   361             20  ELCERT-CERT-SFX     PIC X.
   362
   363     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   364     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   365     12  ELCRTO-KEY.
   366         16  ELCRTO-COMPANY-CD       PIC X.
   367         16  ELCRTO-CARRIER          PIC X.
   368         16  ELCRTO-GROUPING         PIC X(6).
   369         16  ELCRTO-STATE            PIC XX.
   370         16  ELCRTO-ACCOUNT          PIC X(10).
   371         16  ELCRTO-CERT-EFF-DT      PIC XX.
   372         16  ELCRTO-CERT-NO.
   373             20  ELCRTO-CERT-PRIME   PIC X(10).
   374             20  ELCRTO-CERT-SFX     PIC X.
   375         16  ELCRTO-RECORD-TYPE      PIC X.
   376         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   377
   378     12  ELCRTT-KEY.
   379         16  ELCRTT-PRIMARY          PIC X(33).
   380         16  ELCRTT-REC-TYPE         PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page   9
* EL6311.cbl
   381     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   382     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   383
   384     12  ERPNDB-KEY.
   385         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   386         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   387         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   388         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   389             ERPNDB-BATCH-SEQ-NO     PIC XX.
   390         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   391
   392     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   393     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   394     12  ERCHEK-KEY.
   395         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   396         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   397         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   398         16  CHEK-STATE              PIC XX      VALUE SPACES.
   399         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   400         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   401         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   402         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   403         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   404     12  ELLETR-KEY.
   405         16  LETR-COMPANY-CD     PIC X.
   406         16  LETR-LETTER-ID      PIC X(4).
   407         16  LETR-FILLER         PIC X(8).
   408         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   409     12  ERPNDM-KEY.
   410         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   411         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   412         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   413         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   414
   415*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   416     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   417*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   418     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   419
   420     12  ERPNDB-ALT-KEY.
   421         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   422         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   423         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   424         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   425         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   426         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   427         16  ERPNDB-CERT-NO.
   428             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   429             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   430         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   431         16  ERPNDB-RECORD-TYPE      PIC X.
   432
   433      12  ERPNDB-CSR-KEY.
   434          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   435          20  ERPNDB-CSR-ID                PIC X(4).
   436          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   437          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   438          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  10
* EL6311.cbl
   439
   440     12  ERNOTE-KEY.
   441         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   442         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   443         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   444         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   445         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   446         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   447         16  ERNOTE-CERT-NO.
   448             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   449             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   450
   451     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   452     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   453
   454     12  ERCNOT-KEY.
   455         16  ERCNOT-PART-KEY.
   456             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   457             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   458             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   459             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   460             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   461             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   462             20  ERCNOT-CERT-NO.
   463                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   464                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   465         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   466         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   467
   468     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   469     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   470
   471     12  ERMAIL-KEY.
   472         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   473         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   474         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   475         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   476         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   477         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   478         16  ERMAIL-CERT-NO.
   479             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   480             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   481
   482     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   483     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   484
   485     12  ERRQST-KEY.
   486         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   487         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   488
   489     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   490     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   491
   492     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   493
   494     12  ERLOFC-KEY.
   495         16  ERLOFC-COMPANY-CD          PIC  X.
   496         16  ERLOFC-CARRIER             PIC  X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  11
* EL6311.cbl
   497         16  ERLOFC-GROUPING            PIC  X(6).
   498         16  ERLOFC-STATE               PIC  XX.
   499         16  ERLOFC-ACCOUNT             PIC  X(10).
   500         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   501*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   502
   503     12  ERACCT-KEY.
   504         16  ERACCT-COMPANY-CD          PIC  X.
   505         16  ERACCT-CARRIER             PIC  X.
   506         16  ERACCT-GROUPING            PIC  X(6).
   507         16  ERACCT-STATE               PIC  XX.
   508         16  ERACCT-ACCOUNT             PIC  X(10).
   509         16  ERACCT-EXP-DT.
   510             20  ERACCT-DT              PIC  XX.
   511             20  ERACCT-FILL            PIC  X(4).
   512     12  ERACNT-KEY.
   513         16  ERACNT-COMPANY-CD          PIC  X.
   514         16  ERACNT-CARRIER             PIC  X.
   515         16  ERACNT-GROUPING            PIC  X(6).
   516         16  ERACNT-STATE               PIC  XX.
   517         16  ERACNT-ACCOUNT             PIC  X(10).
   518         16  ERACNT-REC-TYPE            PIC  X.
   519         16  ERACNT-SEQ-NO              PIC  S9(4) COMP.
   520     12  ERENDT-KEY.
   521         16  ENDT-COMPANY-CD       PIC X.
   522         16  ENDT-CARRIER          PIC X.
   523         16  ENDT-GROUPING         PIC X(6).
   524         16  ENDT-STATE            PIC XX.
   525         16  ENDT-ACCOUNT          PIC X(10).
   526         16  ENDT-CERT-EFF-DT      PIC XX.
   527         16  ENDT-CERT-PRIME       PIC X(10).
   528         16  ENDT-CERT-SFX         PIC X.
   529         16  ENDT-RECORD-TYPE      PIC X.
   530         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   531
   532 01  WS-ELMSTR-WORK.
   533     12  ELMSTR-KEY.
   534         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   535         16  MSTR-CERT-NO.
   536             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   537             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   538     12  W-CLAIM-KEY.
   539         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   540         16  W-CL-CERT-NO.
   541             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   542             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   543      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   544 01  CANCEL-GEN-PASS-AREA.
   545     05  CG-OPTION-CODE          PIC X.
   546         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   547         88  CG-FLAT-CANCEL        VALUE '1'.
   548         88  CG-CANCEL             VALUE '2'.
   549         88  CG-CANCEL-REISSUE     VALUE '3'.
   550     05  CG-ERROR-CODE           PIC 99.
   551         88  CG-SUCCESS            VALUE 00.
   552         88  CG-DATE-ERROR         VALUE 01.
   553         88  CG-CERT-NOT-FOUND     VALUE 02.
   554         88  CG-AMOUNT-ERROR       VALUE 04.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  12
* EL6311.cbl
   555         88  CG-OPTION-ERROR       VALUE 05.
   556         88  CG-PREV-CAN           VALUE 06.
   557         88  CG-INVALID-DATA       VALUE 07.
   558         88  CG-NO-ACCT-MSTR       VALUE 08.
   559         88  CG-SFX-A-EXIST        VALUE 09.
   560         88  CG-MISC-ERROR         VALUE 99.
   561     05  CG-COMPANY-ID           PIC XXX.
   562     05  CG-PROC-ID              PIC XXXX.
   563     05  CG-CURRENT-DT           PIC XX.
   564     05  CG-MONTH-END-DT         PIC XX.
   565     05  CG-CERT-KEY.
   566         10  CG-CERT-COMPANY-CD  PIC X.
   567         10  CG-CERT-CARRIER     PIC X.
   568         10  CG-CERT-GROUP       PIC X(6).
   569         10  CG-CERT-STATE       PIC XX.
   570         10  CG-CERT-ACCOUNT     PIC X(10).
   571         10  CG-CERT-EFF-DT      PIC XX.
   572         10  CG-CERT-CERT-NO     PIC X(11).
   573     05  CG-LF-CAN-DATA.
   574         10  CG-LF-CAN-DT        PIC XX.
   575         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   576     05  CG-AH-CAN-DATA.
   577         10  CG-AH-CAN-DT        PIC XX.
   578         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   579     05  CG-CERT-PROFILE-DATA.
   580         10  CG-INS-LNAME        PIC X(15).
   581         10  CG-INS-FNAME        PIC X(10).
   582         10  CG-INS-MID-INIT     PIC X.
   583         10  CG-INS-AGE          PIC 99.
   584         10  CG-JNT-LNAME        PIC X(15).
   585         10  CG-JNT-FNAME        PIC X(10).
   586         10  CG-JNT-MID-INIT     PIC X.
   587         10  CG-JNT-AGE          PIC 99.
   588     05  CG-LF-ISS-DATA.
   589         10  CG-LF-BENCD         PIC XX.
   590         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   591         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   592     05  CG-AH-ISS-DATA.
   593         10  CG-AH-BENCD         PIC XX.
   594         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   595     05  CG-BATCH-NO             PIC X(6).
   596     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   597     05  FILLER                  PIC X(306).
   598******************************************************************
   599*                                                                *
   600*            G E N E R A L   W O R K   A R E A                   *
   601*                                                                *
   602******************************************************************
   603
   604 01  WORK-AREA.
   605     12  WS-RESPONSE             PIC S9(8)   COMP.
   606         88  RESP-NORMAL           VALUE +0.
   607         88  resp-file-notfnd      value +12.
   608         88  RESP-NOTFND           VALUE +13.
   609         88  resp-duprec           value +14.
   610         88  resp-dupkey           value +15.
   611         88  resp-invreq           value +16.
   612         88  RESP-NOTOPEN          VALUE +19.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  13
* EL6311.cbl
   613         88  RESP-ENDFILE          VALUE +20.
   614         88  resp-lengtherr        value +22.
   615     12  DEEDIT-FIELD            PIC X(15).
   616     12  FILLER          REDEFINES DEEDIT-FIELD.
   617         16  FILLER              PIC X(4).
   618         16  DEEDIT-FIELD-X11    PIC X(11).
   619     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   620                                 PIC S9(15).
   621     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   622                                 PIC S9(13)V99.
   623     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   624                                 PIC S9(11)V9999.
   625     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   626     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   627     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   628         16  WS-CALC-TERM-WHOLE  PIC S999.
   629         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   630
   631     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   632     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   633         16  WS-HR-MINS          PIC 99V99.
   634         16  FILLER              PIC XX.
   635
   636     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   637     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   638
   639     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   640     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   641
   642     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   643     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   644     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   645     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   646     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   647     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   648     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   649
   650     12  QID.
   651         16  QID-TERM            PIC X(4).
   652         16  FILLER              PIC X(4)    VALUE '607B'.
   653
   654     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   655         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   656
   657     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   658         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   659
   660     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   661         88 WS-MODE-CODE-VALID     VALUE ' '
   662                                         'W'     *> Weekly
   663                                         'B'     *> Bi-weekly
   664                                         'S'     *> Semi-monthly
   665                                         'M'     *> Monthly (Def)
   666                                         'Q'     *> Quarterly
   667                                         'N'     *> Bi-Monthly??
   668                                         'T'     *> Semi-annual
   669                                         'A'.    *> Annual Pay
   670
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  14
* EL6311.cbl
   671     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   672
   673     12  WS-NUMERIC-SW           PIC X.
   674        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   675
   676     12  WS-EDIT-CSO-FIELD.
   677         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   678                                 PIC X.
   679     12  WS-SAVE-PEND-ISSUE          PIC X(375).
   680     12  WS-ARCHIVE-LETTER-SW    PIC X    VALUE 'N'.
   681        88  ARCHIVE-LETTER-RELEASED   VALUE 'Y'.
   682        88  CALLED-FROM-6315          VALUE '5'.
   683
   684     12  WS-SAVE-INPUT-FIELDS.
   685         16  WS-BAGE             PIC 99       VALUE ZERO.
   686*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   687         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   688         16  FILLER REDEFINES WS-BAPR.
   689             20  WS-APR-WHOLE-NUM    PIC 99.
   690             20  WS-APR-DEC          PIC 9999.
   691         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   692         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   693
   694         16  WS-B-COVERAGE OCCURS 2 TIMES.
   695             20  WS-TERM-IN-DAYS-SW  PIC X.
   696                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   697             20  WS-BTERM        PIC 999       COMP-3.
   698             20  WS-BALT-TERM    PIC 999       COMP-3.
   699             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   700             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   701             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   702             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   703             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   704             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   705
   706         16  WS-C-FIELDS COMP-3.
   707             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   708             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   709             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   710
   711         16  WS-D-FIELDS COMP-3.
   712             20  WS-DRISS        PIC S9(5)    VALUE +0.
   713             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   714             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   715             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   716             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   717             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   718
   719     12  WS-SAVE-BIRTH-DATE.
   720         16  FILLER              PIC X(4)   VALUE SPACES.
   721         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   722
   723     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   724     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   725     12  FILLER REDEFINES WS-WORK-BIN-RED.
   726         16  FILLER              PIC X(02).
   727         16  WS-WORK-BIN-DT      PIC X(02).
   728     12  WS-SW-1                 PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  15
* EL6311.cbl
   729     12  WS-SW-2                 PIC X     VALUE SPACE.
   730     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   731         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   732     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   733         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   734
   735     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   736     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   737     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   738     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   739     12  WS-CONVERTED-CANCEL-DATES.
   740         16  WS-CONVERTED-CANDT1                  PIC XX.
   741         16  WS-CONVERTED-CANDT2                  PIC XX.
   742
   743     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   744
   745     12  WS-REC-FOUND-SW         PIC X.
   746         88  RECORD-NOT-FOUND    VALUE 'N'.
   747
   748     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   749         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   750         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   751
   752     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   753         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   754         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   755
   756     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   757         88  BROWSE-STARTED      VALUE 'Y'.
   758
   759     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   760         88  FIRST-TIME          VALUE 'Y'.
   761
   762     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   763         88  FIRST-ENTRY         VALUE 'Y'.
   764
   765     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   766         88  REC-BILLED          VALUE 'Y'.
   767
   768     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   769         88  NO-CURSOR-SET       VALUE +0.
   770         88  CURSOR-SET          VALUE +1.
   771
   772     12  WS-ERR-SW               PIC X.
   773         88  STD-ERRORS          VALUE 'S'.
   774         88  TRN-ERRORS          VALUE 'T'.
   775
   776     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   777         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   778
   779     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   780         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   781
   782     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   783         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   784
   785     12  WS-ERR-CODE.
   786         16  FILLER              PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  16
* EL6311.cbl
   787         16  WS-ERROR-SUB        PIC 99.
   788
   789     12  WS-DATE-WORK.
   790         16  WS-WORK-MM          PIC XX.
   791         16  WS-WORK-DD          PIC XX.
   792         16  WS-WORK-YY          PIC XX.
   793
   794     12  WS-MM-YY.
   795         16  WS-MM               PIC XX.
   796         16  FILLER              PIC X     VALUE '/'.
   797         16  WS-YY               PIC XX.
   798
   799     12  WS-CERT-EFF-DT          PIC XX.
   800
   801     12  WS-MEMBER-NO            PIC X(12).
   802     12  FILLER  REDEFINES  WS-MEMBER-NO.
   803         16  WS-MEMBER-NO-1-8    PIC 9(8).
   804         16  FILLER              PIC X(4).
   805
   806     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   807
   808     12  WS-ERPNDB-ALT-KEY.
   809         16  WS-PB-COMPANY-CD-A1         PIC X.
   810         16  WS-PB-CARRIER               PIC X.
   811         16  WS-PB-GROUPING              PIC X(6).
   812         16  WS-PB-STATE                 PIC XX.
   813         16  WS-PB-ACCOUNT               PIC X(10).
   814         16  WS-PB-CERT-EFF-DT           PIC XX.
   815         16  WS-PB-CERT-NO.
   816             20  WS-PB-CERT-PRIME        PIC X(10).
   817             20  WS-PB-CERT-SFX          PIC X.
   818         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   819         16  WS-PB-RECORD-TYPE           PIC X.
   820
   821     12  WS-SHOW-SAVE-AREAS.
   822         16  WS-NEW-CERT-NO.
   823             20  WS-NEW-PRIME    PIC X(10).
   824             20  WS-NEW-SUFFIX   PIC X.
   825         16  WS-NEW-CERT-EFF-DT  PIC XX.
   826         16  WS-NEW-RECORD-TYPE  PIC X.
   827         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   828             88   SHOW-RECORD            VALUE 'Y'.
   829
   830     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   831
   832     12  WS-BATCH-NO.
   833         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   834         16  FILLER              PIC X(5) VALUE SPACES.
   835
   836     12  WS-FIRST-NAME.
   837         16  WS-1ST-INIT         PIC X.
   838         16  FILLER              PIC X(9).
   839
   840     12  WS-INITIALS.
   841         16  WS-INITIAL-1        PIC X.
   842         16  WS-INITIAL-2        PIC X.
   843
   844     12  WS-C-HDG.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  17
* EL6311.cbl
   845         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   846         16  FILLER              PIC X(4) VALUE '-REF'.
   847
   848     12  WS-D-PREM-HDG.
   849         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   850         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   851
   852     12  WS-D-REFUND-HDG.
   853         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   854         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   855
   856     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   857
   858     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   859     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   860     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   861     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   862     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   863     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   864     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   865
   866     12  WS-01-CANCEL-ERR        PIC X(25)
   867         VALUE 'CANCEL DATE ERROR'.
   868     12  WS-02-CANCEL-ERR        PIC X(25)
   869         VALUE 'CERT NOT FOUND'.
   870     12  WS-04-CANCEL-ERR        PIC X(25)
   871         VALUE 'CANCEL AMOUNT ERROR'.
   872     12  WS-05-CANCEL-ERR        PIC X(25)
   873         VALUE 'CANCEL OPTION ERROR'.
   874     12  WS-06-CANCEL-ERR        PIC X(25)
   875         VALUE 'PREVIOUSLY CANCELLED'.
   876     12  WS-07-CANCEL-ERR        PIC X(25)
   877         VALUE 'INVALID DATA'.
   878     12  WS-08-CANCEL-ERR        PIC X(25)
   879         VALUE 'NO ACCOUNT MASTER'.
   880     12  WS-09-CANCEL-ERR        PIC X(25)
   881         VALUE 'SUFFIX ALREADY EXISTS'.
   882     12  WS-99-CANCEL-ERR        PIC X(25)
   883         VALUE 'MISC CANCEL ERROR'.
   884
   885     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   886     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   887
   888     12  WS-AGE-FIELDS.
   889         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   890         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   891         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   892         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   893
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  18
* EL6311.cbl
   895
   896******************************************************************
   897*                                                                *
   898*                 B A T C H   T O T A L S                        *
   899*                                                                *
   900******************************************************************
   901
   902     12  WS-BATCH-RECORD.
   903         16  FILLER                       PIC X(10).
   904         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   905         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   906         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   907         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   908         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   909         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   910         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   911         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   912         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   913         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   914         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   915         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   916         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   917         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   918         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   919         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   920         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   921         16  WS-ACCOUNT-NAME              PIC X(30).
   922         16  FILLER                       PIC X.
   923         16  WS-REFERENCE                 PIC X(12).
   924         16  FILLER                       PIC X(197).
   925
   926     12  WS-BATCH-TOTALS.
   927         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   928         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   929         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   930         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   931         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   932         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   933         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   934         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   935         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   936         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   937         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   938         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   939         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   940         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   941         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   942         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   943         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   944         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   945         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   946
   947     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   948
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  19
* EL6311.cbl
   950
   951******************************************************************
   952*                                                                *
   953*                E R R O R   M E S S A G E S                     *
   954*                                                                *
   955******************************************************************
   956
   957 01  ERROR-MESSAGES.
   958     12  ER-0004                 PIC  9(4) VALUE 0004.
   959     12  ER-0008                 PIC  9(4) VALUE 0008.
   960     12  ER-0023                 PIC  9(4) VALUE 0023.
   961     12  ER-0029                 PIC  9(4) VALUE 0029.
   962     12  ER-0033                 PIC  9(4) VALUE 0033.
   963     12  ER-0070                 PIC  9(4) VALUE 0070.
   964     12  ER-0220                 PIC  9(4) VALUE 0220.
   965     12  ER-0248                 PIC  9(4) VALUE 0248.
   966     12  ER-0280                 PIC  9(4) VALUE 0280.
   967     12  ER-0348                 PIC  9(4) VALUE 0348.
   968     12  ER-0582                 PIC  9(4) VALUE 0582.
   969     12  ER-0877                 PIC  9(4) VALUE 0877.
   970     12  ER-1236                 PIC  9(4) VALUE 1236.
   971     12  ER-1570                 PIC  9(4) VALUE 1570.
   972     12  ER-1575                 PIC  9(4) VALUE 1575.
   973     12  ER-1577                 PIC  9(4) VALUE 1577.
   974     12  ER-1584                 PIC  9(4) VALUE 1584.
   975     12  ER-1585                 PIC  9(4) VALUE 1585.
   976     12  ER-1609                 PIC  9(4) VALUE 1609.
   977     12  er-1762                 pic  9(4) value 1762.
   978     12  ER-1819                 PIC  9(4) VALUE 1819.
   979     12  ER-2077                 PIC  9(4) VALUE 2077.
   980     12  ER-2129                 PIC  9(4) VALUE 2129.
   981     12  ER-2188                 PIC  9(4) VALUE 2188.
   982     12  ER-2192                 PIC  9(4) VALUE 2192.
   983     12  ER-2196                 PIC  9(4) VALUE 2196.
   984     12  ER-2197                 PIC  9(4) VALUE 2197.
   985     12  ER-2198                 PIC  9(4) VALUE 2198.
   986     12  ER-2200                 PIC  9(4) VALUE 2200.
   987     12  ER-2212                 PIC  9(4) VALUE 2212.
   988     12  ER-2218                 PIC  9(4) VALUE 2218.
   989     12  ER-2220                 PIC  9(4) VALUE 2220.
   990     12  ER-2222                 PIC  9(4) VALUE 2222.
   991     12  ER-2223                 PIC  9(4) VALUE 2223.
   992     12  ER-2224                 PIC  9(4) VALUE 2224.
   993     12  ER-2225                 PIC  9(4) VALUE 2225.
   994     12  ER-2226                 PIC  9(4) VALUE 2226.
   995     12  ER-2227                 PIC  9(4) VALUE 2227.
   996     12  ER-2228                 PIC  9(4) VALUE 2228.
   997     12  ER-2240                 PIC  9(4) VALUE 2240.
   998     12  ER-2241                 PIC  9(4) VALUE 2241.
   999     12  ER-2242                 PIC  9(4) VALUE 2242.
  1000     12  ER-2243                 PIC  9(4) VALUE 2243.
  1001     12  ER-2244                 PIC  9(4) VALUE 2244.
  1002     12  ER-2245                 PIC  9(4) VALUE 2245.
  1003     12  ER-2246                 PIC  9(4) VALUE 2246.
  1004     12  ER-2247                 PIC  9(4) VALUE 2247.
  1005     12  ER-2251                 PIC  9(4) VALUE 2251.
  1006     12  ER-2252                 PIC  9(4) VALUE 2252.
  1007     12  ER-2253                 PIC  9(4) VALUE 2253.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  20
* EL6311.cbl
  1008     12  ER-2254                 PIC  9(4) VALUE 2254.
  1009     12  ER-2255                 PIC  9(4) VALUE 2255.
  1010     12  ER-2256                 PIC  9(4) VALUE 2256.
  1011     12  ER-2257                 PIC  9(4) VALUE 2257.
  1012     12  ER-2258                 PIC  9(4) VALUE 2258.
  1013     12  ER-2259                 PIC  9(4) VALUE 2259.
  1014     12  ER-2260                 PIC  9(4) VALUE 2260.
  1015     12  ER-2261                 PIC  9(4) VALUE 2261.
  1016     12  ER-2287                 PIC  9(4) VALUE 2287.
  1017     12  ER-2336                 PIC  9(4) VALUE 2336.
  1018     12  ER-2337                 PIC  9(4) VALUE 2337.
  1019     12  ER-2437                 PIC  9(4) VALUE 2437.
  1020     12  ER-2471                 PIC  9(4) VALUE 2471.
  1021     12  ER-2530                 PIC  9(4) VALUE 2530.
  1022     12  ER-2531                 PIC  9(4) VALUE 2531.
  1023     12  ER-2532                 PIC  9(4) VALUE 2532.
  1024     12  ER-2533                 PIC  9(4) VALUE 2533.
  1025     12  ER-2547                 PIC  9(4) VALUE 2547.
  1026     12  ER-2591                 PIC  9(4) VALUE 2591.
  1027     12  ER-2592                 PIC  9(4) VALUE 2592.
  1028     12  ER-2593                 PIC  9(4) VALUE 2593.
  1029     12  ER-2600                 PIC  9(4) VALUE 2600.
  1030     12  ER-2601                 PIC  9(4) VALUE 2601.
  1031     12  ER-2604                 PIC  9(4) VALUE 2604.
  1032     12  ER-2605                 PIC  9(4) VALUE 2605.
  1033     12  ER-2606                 PIC  9(4) VALUE 2606.
  1034     12  ER-2607                 PIC  9(4) VALUE 2607.
  1035     12  ER-2622                 PIC  9(4) VALUE 2622.
  1036     12  ER-2625                 PIC  9(4) VALUE 2625.
  1037     12  ER-2626                 PIC  9(4) VALUE 2626.
  1038     12  ER-2627                 PIC  9(4) VALUE 2627.
  1039     12  ER-2628                 PIC  9(4) VALUE 2628.
  1040     12  ER-2629                 PIC  9(4) VALUE 2629.
  1041     12  ER-2630                 PIC  9(4) VALUE 2630.
  1042     12  ER-2631                 PIC  9(4) VALUE 2631.
  1043     12  ER-2632                 PIC  9(4) VALUE 2632.
  1044     12  ER-2633                 PIC  9(4) VALUE 2633.
  1045     12  ER-2634                 PIC  9(4) VALUE 2634.
  1046     12  ER-2635                 PIC  9(4) VALUE 2635.
  1047     12  ER-2636                 PIC  9(4) VALUE 2636.
  1048     12  ER-2639                 PIC  9(4) VALUE 2639.
  1049     12  ER-2640                 PIC  9(4) VALUE 2640.
  1050     12  ER-2647                 PIC  9(4) VALUE 2647.
  1051     12  ER-2648                 PIC  9(4) VALUE 2648.
  1052     12  ER-2649                 PIC  9(4) VALUE 2649.
  1053     12  ER-2650                 PIC  9(4) VALUE 2650.
  1054     12  ER-2651                 PIC  9(4) VALUE 2651.
  1055     12  ER-2653                 PIC  9(4) VALUE 2653.
  1056     12  ER-2654                 PIC  9(4) VALUE 2654.
  1057     12  ER-2655                 PIC  9(4) VALUE 2655.
  1058     12  ER-2656                 PIC  9(4) VALUE 2656.
  1059     12  ER-2657                 PIC  9(4) VALUE 2657.
  1060     12  ER-2660                 PIC  9(4) VALUE 2660.
  1061     12  ER-2661                 PIC  9(4) VALUE 2661.
  1062     12  ER-2662                 PIC  9(4) VALUE 2662.
  1063     12  ER-2663                 PIC  9(4) VALUE 2663.
  1064     12  ER-2664                 PIC  9(4) VALUE 2664.
  1065     12  ER-2667                 PIC  9(4) VALUE 2667.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  21
* EL6311.cbl
  1066     12  ER-2668                 PIC  9(4) VALUE 2668.
  1067     12  ER-2669                 PIC  9(4) VALUE 2669.
  1068     12  ER-2670                 PIC  9(4) VALUE 2670.
  1069     12  ER-2671                 PIC  9(4) VALUE 2671.
  1070     12  ER-2672                 PIC  9(4) VALUE 2672.
  1071     12  ER-2673                 PIC  9(4) VALUE 2673.
  1072     12  ER-2677                 PIC  9(4) VALUE 2677.
  1073     12  ER-2678                 PIC  9(4) VALUE 2678.
  1074     12  ER-2679                 PIC  9(4) VALUE 2679.
  1075     12  ER-2680                 PIC  9(4) VALUE 2680.
  1076     12  ER-2681                 PIC  9(4) VALUE 2681.
  1077     12  ER-2682                 PIC  9(4) VALUE 2682.
  1078     12  ER-2683                 PIC  9(4) VALUE 2683.
  1079     12  ER-2684                 PIC  9(4) VALUE 2684.
  1080     12  ER-2686                 PIC  9(4) VALUE 2686.
  1081     12  ER-2689                 PIC  9(4) VALUE 2689.
  1082     12  ER-2690                 PIC  9(4) VALUE 2690.
  1083     12  ER-2693                 PIC  9(4) VALUE 2693.
  1084     12  ER-2695                 PIC  9(4) VALUE 2695.
  1085     12  ER-2701                 PIC  9(4) VALUE 2701.
  1086     12  ER-2720                 PIC  9(4) VALUE 2720.
  1087     12  ER-2709                 PIC  9(4) VALUE 2709.
  1088     12  ER-2704                 PIC  9(4) VALUE 2704.
  1089     12  ER-2725                 PIC  9(4) VALUE 2725.
  1090     12  ER-2726                 PIC  9(4) VALUE 2726.
  1091     12  ER-2728                 PIC  9(4) VALUE 2728.
  1092     12  ER-2729                 PIC  9(4) VALUE 2729.
  1093     12  ER-2731                 PIC  9(4) VALUE 2731.
  1094     12  ER-2732                 PIC  9(4) VALUE 2732.
  1095     12  ER-2733                 PIC  9(4) VALUE 2733.
  1096     12  ER-2735                 PIC  9(4) VALUE 2735.
  1097     12  ER-2738                 PIC  9(4) VALUE 2738.
  1098     12  ER-2742                 PIC  9(4) VALUE 2742.
  1099     12  ER-2743                 PIC  9(4) VALUE 2743.
  1100     12  ER-2744                 PIC  9(4) VALUE 2744.
  1101     12  ER-2747                 PIC  9(4) VALUE 2747.
  1102     12  ER-2749                 PIC  9(4) VALUE 2749.
  1103     12  ER-2753                 PIC  9(4) VALUE 2753.
  1104     12  ER-2755                 PIC  9(4) VALUE 2755.
  1105     12  ER-2757                 PIC  9(4) VALUE 2757.
  1106     12  ER-2771                 PIC  9(4) VALUE 2771.
  1107     12  ER-2774                 PIC  9(4) VALUE 2774.
  1108     12  ER-2775                 PIC  9(4) VALUE 2775.
  1109     12  ER-2776                 PIC  9(4) VALUE 2776.
  1110     12  ER-2777                 PIC  9(4) VALUE 2777.
  1111     12  ER-2794                 PIC  9(4) VALUE 2794.
  1112     12  ER-2799                 PIC  9(4) VALUE 2799.
  1113     12  ER-2900                 PIC  9(4) VALUE 2900.
  1114     12  ER-2902                 PIC  9(4) VALUE 2902.
  1115     12  ER-2945                 PIC  9(4) VALUE 2945.
  1116     12  ER-3000                 PIC  9(4) VALUE 3000.
  1117     12  ER-3006                 PIC  9(4) VALUE 3006.
  1118     12  ER-3054                 PIC  9(4) VALUE 3054.
  1119     12  ER-3224                 PIC  9(4) VALUE 3224.
  1120     12  ER-3269                 PIC  9(4) VALUE 3269.
  1121     12  er-3444                 pic  9(4) value 3444.
  1122     12  er-3446                 pic  9(4) value 3446.
  1123     12  er-3447                 pic  9(4) value 3447.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  22
* EL6311.cbl
  1124     12  er-3448                 pic  9(4) value 3448.
  1125     12  er-3449                 pic  9(4) value 3449.
  1126     12  ER-3456                 PIC  9(4) VALUE 3456.
  1127     12  ER-3457                 PIC  9(4) VALUE 3457.
  1128     12  ER-3458                 PIC  9(4) VALUE 3458.
  1129     12  ER-3504                 PIC  9(4) VALUE 3504.
  1130     12  ER-3513                 PIC  9(4) VALUE 3513.
  1131     12  ER-3831                 PIC  9(4) VALUE 3831.
  1132     12  ER-3834                 PIC  9(4) VALUE 3834.
  1133     12  ER-3835                 PIC  9(4) VALUE 3835.
  1134     12  ER-4005                 PIC  9(4) VALUE 4005.
  1135     12  ER-7144                 PIC  9(4) VALUE 7144.
  1136     12  ER-7401                 PIC  9(4) VALUE 7401.
  1137     12  ER-7402                 PIC  9(4) VALUE 7402.
  1138     12  ER-7403                 PIC  9(4) VALUE 7403.
  1139     12  ER-7404                 PIC  9(4) VALUE 7404.
  1140     12  ER-7423                 PIC  9(4) VALUE 7423.
  1141     12  ER-7424                 PIC  9(4) VALUE 7424.
  1142     12  ER-7433                 PIC  9(4) VALUE 7433.
  1143     12  ER-7450                 PIC  9(4) VALUE 7450.
  1144     12  ER-7451                 PIC  9(4) VALUE 7451.
  1145     12  ER-7530                 PIC  9(4) VALUE 7530.
  1146     12  ER-7573                 PIC  9(4) VALUE 7573.
  1147     12  ER-7631                 PIC  9(4) VALUE 7631.
  1148     12  ER-7632                 PIC  9(4) VALUE 7632.
  1149     12  ER-7633                 PIC  9(4) VALUE 7633.
  1150     12  ER-7537                 PIC  9(4) VALUE 7537.
  1151     12  ER-7538                 PIC  9(4) VALUE 7538.
  1152     12  ER-7574                 PIC  9(4) VALUE 7574.
  1153     12  ER-7997                 PIC  9(4) VALUE 7997.
  1154     12  ER-7998                 PIC  9(4) VALUE 7998.
  1155     12  ER-8148                 PIC  9(4) VALUE 8148.
  1156     12  ER-9063                 PIC  9(4) VALUE 9063.
  1157     12  ER-9076                 PIC  9(4) VALUE 9076.
  1158     12  ER-9618                 PIC  9(4) VALUE 9618.
  1159     12  ER-9841                 PIC  9(4) VALUE 9841.
  1160
  1161*                                COPY ELCTEXT.
  1162******************************************************************
  1163*                                                                *
  1164*                                                                *
  1165*                            ELCTEXT.                            *
  1166*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1167*                            VMOD=2.008                          *
  1168*                                                                *
  1169*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1170*                                     FORM LETTERS,              *
  1171*                                     CERT FORM DISPLAY.
  1172*                                                                *
  1173*   FILE TYPE = VSAM,KSDS                                        *
  1174*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1175*                                                                *
  1176*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1177*       ALTERNATE INDEX = NONE                                   *
  1178*                                                                *
  1179*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1180*       ALTERNATE INDEX = NONE                                   *
  1181*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  23
* EL6311.cbl
  1182*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1183*       ALTERNATE INDEX = NONE                                   *
  1184*                                                                *
  1185*   LOG = NO                                                     *
  1186*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1187******************************************************************
  1188 01  TEXT-FILES.
  1189     12  TEXT-FILE-ID                PIC XX.
  1190         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1191         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1192         88  HELP-FILE-TEXT             VALUE 'TH'.
  1193
  1194     12  TX-CONTROL-PRIMARY.
  1195         16  TX-COMPANY-CD           PIC X.
  1196             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1197         16  TX-ACCESS-CD-GENL       PIC X(12).
  1198
  1199         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1200             20  TX-LETTER-NO        PIC X(4).
  1201             20  FILLER              PIC X(8).
  1202
  1203         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1204             20  TX-FORM-NO          PIC X(12).
  1205
  1206         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1207             20  TX-HELP-TYPE        PIC X.
  1208                 88  HELP-FOR-GENERAL   VALUE ' '.
  1209                 88  HELP-BY-SCREEN     VALUE 'S'.
  1210                 88  HELP-BY-ERROR      VALUE 'E'.
  1211             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1212                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1213             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1214                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1215             20  FILLER              PIC X(4).
  1216
  1217         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1218
  1219     12  TX-PROCESS-CONTROL          PIC XX.
  1220         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1221
  1222     12  TX-TEXT-LINE                PIC X(70).
  1223
  1224     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1225         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1226         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1227         88  TX-VALID-FORM-SQUEEZE-VALUE
  1228                                        VALUE 'Y' ' '.
  1229
  1230     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1231         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1232         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1233         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1234         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1235         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1236         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1237         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1238                                              'K' 'N' ' '
  1239                                              'Z'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  24
* EL6311.cbl
  1240
  1241     12  TX-ARCHIVE-SW               PIC X.
  1242         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1243         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1244         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1245
  1246     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1247     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1248
  1249     12  TX-BSR-CODE                 PIC X.
  1250         88  TX-BSR-LETTER              VALUE 'B'.
  1251         88  TX-NON-BSR-LETTER          VALUE ' '.
  1252
  1253     12  FILLER                      PIC X.
  1254*****************************************************************
  1255*                                COPY ELCCRTO.
  1256******************************************************************
  1257*                                                                *
  1258*                            ELCCRTO.                            *
  1259*                                                                *
  1260*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1261*                                                                *
  1262*   FILE TYPE = VSAM,KSDS                                        *
  1263*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1264*                                                                *
  1265*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1266*                                                                *
  1267*   LOG = YES                                                    *
  1268*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1269******************************************************************
  1270*                   C H A N G E   L O G
  1271*
  1272* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1273*-----------------------------------------------------------------
  1274*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1275* EFFECTIVE    NUMBER
  1276*-----------------------------------------------------------------
  1277* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1278* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1279* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1280* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1281* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1282******************************************************************
  1283 01  ORIGINAL-CERTIFICATE.
  1284     12  OC-RECORD-ID                      PIC XX.
  1285         88  VALID-OC-ID                      VALUE 'OC'.
  1286     12  OC-CONTROL-PRIMARY.
  1287         16  OC-COMPANY-CD                 PIC X.
  1288         16  OC-CARRIER                    PIC X.
  1289         16  OC-GROUPING                   PIC X(6).
  1290         16  OC-STATE                      PIC XX.
  1291         16  OC-ACCOUNT                    PIC X(10).
  1292         16  OC-CERT-EFF-DT                PIC XX.
  1293         16  OC-CERT-NO.
  1294             20  OC-CERT-PRIME             PIC X(10).
  1295             20  OC-CERT-SFX               PIC X.
  1296         16  OC-RECORD-TYPE                PIC X.
  1297         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  25
* EL6311.cbl
  1298     12  OC-LAST-MAINT-DT                  PIC XX.
  1299     12  OC-LAST-MAINT-BY                  PIC X(4).
  1300     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1301     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1302     12  FILLER                            PIC X(49).
  1303     12  OC-ORIG-REC.
  1304         16  OC-INS-LAST-NAME              PIC X(15).
  1305         16  OC-INS-FIRST-NAME             PIC X(10).
  1306         16  OC-INS-MIDDLE-INIT            PIC X.
  1307         16  OC-INS-AGE                    PIC S999     COMP-3.
  1308         16  OC-JNT-LAST-NAME              PIC X(15).
  1309         16  OC-JNT-FIRST-NAME             PIC X(10).
  1310         16  OC-JNT-MIDDLE-INIT            PIC X.
  1311         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1312         16  OC-LF-BENCD                   PIC XX.
  1313         16  OC-LF-TERM                    PIC S999      COMP-3.
  1314         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1315         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1316         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1317         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1318         16  OC-LF-EXP-DT                  PIC XX.
  1319         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1320         16  OC-LF-CANCEL-DT               PIC XX.
  1321         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1322         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1323         16  OC-AH-BENCD                   PIC XX.
  1324         16  OC-AH-TERM                    PIC S999      COMP-3.
  1325         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1326         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1327         16  OC-AH-EXP-DT                  PIC XX.
  1328         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1329         16  OC-AH-CP                      PIC 99.
  1330         16  OC-AH-CANCEL-DT               PIC XX.
  1331         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1332         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1333         16  OC-CRED-BENE-NAME             PIC X(25).
  1334         16  OC-1ST-PMT-DT                 PIC XX.
  1335         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1336         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1337         16  OC-ISSUE-TRAN-IND             PIC X.
  1338         16  OC-CANCEL-TRAN-IND            PIC X.
  1339         16  FILLER                        PIC X(211).
  1340
  1341     12  FILLER                            PIC X(50).
  1342******************************************************************
  1343*                                COPY ERCACCT.
  1344******************************************************************
  1345*                                                                *
  1346*                                                                *
  1347*                            ERCACCT                             *
  1348*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1349*                            VMOD=2.031                          *
  1350*                                                                *
  1351*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1352*                                                                *
  1353*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1354*   VSAM ACCOUNT MASTER FILES.                                   *
  1355*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  26
* EL6311.cbl
  1356*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1357*                                                                *
  1358*   FILE TYPE = VSAM,KSDS                                        *
  1359*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1360*                                                                *
  1361*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1362*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1363*                                                                *
  1364*   LOG = NO                                                     *
  1365*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1366*                                                                *
  1367*                                                                *
  1368******************************************************************
  1369*                   C H A N G E   L O G
  1370*
  1371* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1372*-----------------------------------------------------------------
  1373*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1374* EFFECTIVE    NUMBER
  1375*-----------------------------------------------------------------
  1376* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1377* 092705    2005050300006  PEMA  ADD SPP LEASES
  1378* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1379* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1380* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1381* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1382* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1383* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1384******************************************************************
  1385
  1386 01  ACCOUNT-MASTER.
  1387     12  AM-RECORD-ID                      PIC XX.
  1388         88  VALID-AM-ID                      VALUE 'AM'.
  1389
  1390     12  AM-CONTROL-PRIMARY.
  1391         16  AM-COMPANY-CD                 PIC X.
  1392         16  AM-MSTR-CNTRL.
  1393             20  AM-CONTROL-A.
  1394                 24  AM-CARRIER            PIC X.
  1395                 24  AM-GROUPING.
  1396                     28 AM-GROUPING-PREFIX PIC XXX.
  1397                     28 AM-GROUPING-PRIME  PIC XXX.
  1398                 24  AM-STATE              PIC XX.
  1399                 24  AM-ACCOUNT.
  1400                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1401                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1402             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1403                                           PIC X(19).
  1404             20  AM-CNTRL-B.
  1405                 24  AM-EXPIRATION-DT      PIC XX.
  1406                 24  FILLER                PIC X(4).
  1407             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1408                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1409
  1410     12  AM-CONTROL-BY-VAR-GRP.
  1411         16  AM-COMPANY-CD-A1              PIC X.
  1412         16  AM-VG-CARRIER                 PIC X.
  1413         16  AM-VG-GROUPING                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  27
* EL6311.cbl
  1414         16  AM-VG-STATE                   PIC XX.
  1415         16  AM-VG-ACCOUNT                 PIC X(10).
  1416         16  AM-VG-DATE.
  1417             20  AM-VG-EXPIRATION-DT       PIC XX.
  1418             20  FILLER                    PIC X(4).
  1419         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1420                                           PIC 9(11)      COMP-3.
  1421     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1422         16  FILLER                        PIC X(10).
  1423         16  AM-VG-KEY3.
  1424             20  AM-VG3-ACCOUNT            PIC X(10).
  1425             20  AM-VG3-EXP-DT             PIC XX.
  1426         16  FILLER                        PIC X(4).
  1427     12  AM-MAINT-INFORMATION.
  1428         16  AM-LAST-MAINT-DT              PIC XX.
  1429         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1430         16  AM-LAST-MAINT-USER            PIC X(4).
  1431         16  FILLER                        PIC XX.
  1432
  1433     12  AM-EFFECTIVE-DT                   PIC XX.
  1434     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1435
  1436     12  AM-PREV-DATES  COMP-3.
  1437         16  AM-PREV-EXP-DT                PIC 9(11).
  1438         16  AM-PREV-EFF-DT                PIC 9(11).
  1439
  1440     12  AM-REPORT-CODE-1                  PIC X(10).
  1441     12  AM-REPORT-CODE-2                  PIC X(10).
  1442
  1443     12  AM-CITY-CODE                      PIC X(4).
  1444     12  AM-COUNTY-PARISH                  PIC X(6).
  1445
  1446     12  AM-NAME                           PIC X(30).
  1447     12  AM-PERSON                         PIC X(30).
  1448     12  AM-ADDRS                          PIC X(30).
  1449     12  AM-CITY.
  1450         16  AM-ADDR-CITY                  PIC X(28).
  1451         16  AM-ADDR-STATE                 PIC XX.
  1452     12  AM-ZIP.
  1453         16  AM-ZIP-PRIME.
  1454             20  AM-ZIP-PRI-1ST            PIC X.
  1455                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1456             20  FILLER                    PIC X(4).
  1457         16  AM-ZIP-PLUS4                  PIC X(4).
  1458     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1459         16  AM-CAN-POSTAL-1               PIC XXX.
  1460         16  AM-CAN-POSTAL-2               PIC XXX.
  1461         16  FILLER                        PIC XXX.
  1462     12  AM-TEL-NO.
  1463         16  AM-AREA-CODE                  PIC 999.
  1464         16  AM-TEL-PRE                    PIC 999.
  1465         16  AM-TEL-NBR                    PIC 9(4).
  1466     12  AM-TEL-LOC                        PIC X.
  1467         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1468         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1469
  1470     12  AM-COMM-STRUCTURE.
  1471         16  AM-DEFN-1.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  28
* EL6311.cbl
  1472             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1473                 24  AM-AGT.
  1474                     28  AM-AGT-PREFIX     PIC X(4).
  1475                     28  AM-AGT-PRIME      PIC X(6).
  1476                 24  AM-COM-TYP            PIC X.
  1477                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1478                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1479                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1480                 24  AM-RECALC-LV-INDIC    PIC X.
  1481                 24  AM-RETRO-LV-INDIC     PIC X.
  1482                 24  AM-GL-CODES           PIC X.
  1483                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1484                 24  FILLER                PIC X(01).
  1485         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1486             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1487                 24  FILLER                PIC X(11).
  1488                 24  AM-L-COMA             PIC XXX.
  1489                 24  AM-J-COMA             PIC XXX.
  1490                 24  AM-A-COMA             PIC XXX.
  1491                 24  FILLER                PIC X(6).
  1492
  1493     12  AM-COMM-CHANGE-STATUS             PIC X.
  1494         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1495
  1496     12  AM-CSR-CODE                       PIC X(4).
  1497
  1498     12  AM-BILLING-STATUS                 PIC X.
  1499         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1500         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1501     12  AM-AUTO-REFUND-SW                 PIC X.
  1502         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1503         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1504     12  AM-GPCD                           PIC 99.
  1505     12  AM-IG                             PIC X.
  1506         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1507         88  AM-HAS-GROUP                     VALUE '2'.
  1508     12  AM-STATUS                         PIC X.
  1509         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1510         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1511         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1512         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1513         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1514         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1515         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1516         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1517         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1518         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1519     12  AM-REMIT-TO                       PIC 99.
  1520     12  AM-ID-NO                          PIC X(11).
  1521
  1522     12  AM-CAL-TABLE                      PIC XX.
  1523     12  AM-LF-DEVIATION                   PIC XXX.
  1524     12  AM-AH-DEVIATION                   PIC XXX.
  1525     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1526     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1527     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1528     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1529     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  29
* EL6311.cbl
  1530     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1531
  1532     12  AM-USER-FIELDS.
  1533         16  AM-FLD-1                      PIC XX.
  1534         16  AM-FLD-2                      PIC XX.
  1535         16  AM-FLD-3                      PIC XX.
  1536         16  AM-FLD-4                      PIC XX.
  1537         16  AM-FLD-5                      PIC XX.
  1538
  1539     12  AM-1ST-PROD-DATE.
  1540         16  AM-1ST-PROD-YR                PIC XX.
  1541         16  AM-1ST-PROD-MO                PIC XX.
  1542         16  AM-1ST-PROD-DA                PIC XX.
  1543     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1544     12  AM-CERTS-PURGED-DATE.
  1545         16  AM-PUR-YR                     PIC XX.
  1546         16  AM-PUR-MO                     PIC XX.
  1547         16  AM-PUR-DA                     PIC XX.
  1548     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1549     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1550     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1551     12  AM-INACTIVE-DATE.
  1552         16  AM-INA-MO                     PIC 99.
  1553         16  AM-INA-DA                     PIC 99.
  1554         16  AM-INA-YR                     PIC 99.
  1555     12  AM-AR-HI-CERT-DATE                PIC XX.
  1556
  1557     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1558     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1559
  1560     12  AM-OB-PAYMENT-MODE                PIC X.
  1561         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1562         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1563         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1564         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1565
  1566     12  AM-AH-ONLY-INDICATOR              PIC X.
  1567         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1568         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1569
  1570     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1571
  1572     12  AM-OVER-SHORT.
  1573         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1574         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1575
  1576     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1577     12  AM-DCC-CLP-STATE                  PIC XX.
  1578
  1579     12  AM-RECALC-COMM                    PIC X.
  1580     12  AM-RECALC-REIN                    PIC X.
  1581
  1582     12  AM-REI-TABLE                      PIC XXX.
  1583     12  AM-REI-ET-LF                      PIC X.
  1584     12  AM-REI-ET-AH                      PIC X.
  1585     12  AM-REI-PE-LF                      PIC X.
  1586     12  AM-REI-PE-AH                      PIC X.
  1587     12  AM-REI-PRT-ST                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  30
* EL6311.cbl
  1588     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1589     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1590     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1591     12  AM-REI-GROUP-A                    PIC X(6).
  1592     12  AM-REI-MORT                       PIC X(4).
  1593     12  AM-REI-PRT-OW                     PIC X.
  1594     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1595     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1596     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1597     12  AM-REI-GROUP-B                    PIC X(6).
  1598
  1599     12  AM-TRUST-TYPE                     PIC X(2).
  1600
  1601     12  AM-EMPLOYER-STMT-USED             PIC X.
  1602     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1603
  1604     12  AM-STD-AH-TYPE                    PIC XX.
  1605     12  AM-EARN-METHODS.
  1606         16  AM-EARN-METHOD-R              PIC X.
  1607             88 AM-REF-RL-R78                 VALUE 'R'.
  1608             88 AM-REF-RL-PR                  VALUE 'P'.
  1609             88 AM-REF-RL-MEAN                VALUE 'M'.
  1610             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1611         16  AM-EARN-METHOD-L              PIC X.
  1612             88 AM-REF-LL-R78                 VALUE 'R'.
  1613             88 AM-REF-LL-PR                  VALUE 'P'.
  1614             88 AM-REF-LL-MEAN                VALUE 'M'.
  1615             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1616         16  AM-EARN-METHOD-A              PIC X.
  1617             88 AM-REF-AH-R78                 VALUE 'R'.
  1618             88 AM-REF-AH-PR                  VALUE 'P'.
  1619             88 AM-REF-AH-MEAN                VALUE 'M'.
  1620             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1621             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1622             88 AM-REF-AH-NET                 VALUE 'N'.
  1623
  1624     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1625     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1626     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1627
  1628     12  AM-RET-Y-N                        PIC X.
  1629     12  AM-RET-P-E                        PIC X.
  1630     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1631     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1632     12  AM-RET-GRP                        PIC X(6).
  1633     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1634         16  AM-POOL-PRIME                 PIC XXX.
  1635         16  AM-POOL-SUB                   PIC XXX.
  1636     12  AM-RETRO-EARNINGS.
  1637         16  AM-RET-EARN-R                 PIC X.
  1638         16  AM-RET-EARN-L                 PIC X.
  1639         16  AM-RET-EARN-A                 PIC X.
  1640     12  AM-RET-ST-TAX-USE                 PIC X.
  1641         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1642         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1643     12  AM-RETRO-BEG-EARNINGS.
  1644         16  AM-RET-BEG-EARN-R             PIC X.
  1645         16  AM-RET-BEG-EARN-L             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  31
* EL6311.cbl
  1646         16  AM-RET-BEG-EARN-A             PIC X.
  1647     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1648     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1649
  1650     12  AM-USER-SELECT-OPTIONS.
  1651         16  AM-USER-SELECT-1              PIC X(10).
  1652         16  AM-USER-SELECT-2              PIC X(10).
  1653         16  AM-USER-SELECT-3              PIC X(10).
  1654         16  AM-USER-SELECT-4              PIC X(10).
  1655         16  AM-USER-SELECT-5              PIC X(10).
  1656
  1657     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1658
  1659     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1660
  1661     12  AM-RPT045A-SWITCH                 PIC X.
  1662         88  RPT045A-OFF                   VALUE 'N'.
  1663
  1664     12  AM-INSURANCE-LIMITS.
  1665         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1666         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1667
  1668     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1669         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1670
  1671     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1672         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1673         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1674
  1675     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1676
  1677     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1678     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1679     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1680     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1681     12  AM-DCC-UEF-STATE                  PIC XX.
  1682     12  FILLER                            PIC XXX.
  1683     12  AM-REPORT-CODE-3                  PIC X(10).
  1684*    12  FILLER                            PIC X(22).
  1685
  1686     12  AM-RESERVE-DATE.
  1687         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1688         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1689         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1690
  1691     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1692     12  AM-NOTIFICATION-TYPES.
  1693         16  AM-NOTIF-OF-LETTERS           PIC X.
  1694         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1695         16  AM-NOTIF-OF-REPORTS           PIC X.
  1696         16  AM-NOTIF-OF-STATUS            PIC X.
  1697
  1698     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1699         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1700         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1701         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1702         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1703
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  32
* EL6311.cbl
  1704     12  AM-BENEFIT-CONTROLS.
  1705         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1706             20  AM-BENEFIT-CODE           PIC XX.
  1707             20  AM-BENEFIT-TYPE           PIC X.
  1708             20  AM-BENEFIT-REVISION       PIC XXX.
  1709             20  AM-BENEFIT-REM-TERM       PIC X.
  1710             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1711             20  FILLER                    PIC XX.
  1712         16  FILLER                        PIC X(80).
  1713
  1714     12  AM-TRANSFER-DATA.
  1715         16  AM-TRANSFERRED-FROM.
  1716             20  AM-TRNFROM-CARRIER        PIC X.
  1717             20  AM-TRNFROM-GROUPING.
  1718                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1719                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1720             20  AM-TRNFROM-STATE          PIC XX.
  1721             20  AM-TRNFROM-ACCOUNT.
  1722                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1723                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1724             20  AM-TRNFROM-DTE            PIC XX.
  1725         16  AM-TRANSFERRED-TO.
  1726             20  AM-TRNTO-CARRIER          PIC X.
  1727             20  AM-TRNTO-GROUPING.
  1728                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1729                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1730             20  AM-TRNTO-STATE            PIC XX.
  1731             20  AM-TRNTO-ACCOUNT.
  1732                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1733                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1734             20  AM-TRNTO-DTE              PIC XX.
  1735         16  FILLER                        PIC X(10).
  1736
  1737     12  AM-SAVED-REMIT-TO                 PIC 99.
  1738
  1739     12  AM-COMM-STRUCTURE-SAVED.
  1740         16  AM-DEFN-1-SAVED.
  1741             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1742                 24  AM-AGT-SV             PIC X(10).
  1743                 24  AM-COM-TYP-SV         PIC X.
  1744                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1745                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1746                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1747                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1748                 24  FILLER                PIC X.
  1749                 24  AM-GL-CODES-SV        PIC X.
  1750                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1751                 24  FILLER                PIC X.
  1752         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1753             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1754                 24  FILLER                PIC X(11).
  1755                 24  AM-L-COMA-SV          PIC XXX.
  1756                 24  AM-J-COMA-SV          PIC XXX.
  1757                 24  AM-A-COMA-SV          PIC XXX.
  1758                 24  FILLER                PIC X(6).
  1759
  1760     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1761         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  33
* EL6311.cbl
  1762            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1763            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1764            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1765
  1766     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1767     12  FILLER                            PIC X(120).
  1768
  1769     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1770         16  AM-CONTROL-NAME               PIC X(30).
  1771         16  AM-EXECUTIVE-ONE.
  1772             20  AM-EXEC1-NAME             PIC X(15).
  1773             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1774                                                          COMP-3.
  1775             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1776                                                          COMP-3.
  1777         16  AM-EXECUTIVE-TWO.
  1778             20  AM-EXEC2-NAME             PIC X(15).
  1779             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1780                                                          COMP-3.
  1781             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1782                                                          COMP-3.
  1783
  1784     12  AM-RETRO-ADDITIONAL-DATA.
  1785         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1786         16  AM-RETRO-PREM-P-E             PIC X.
  1787         16  AM-RETRO-CLMS-P-I             PIC X.
  1788         16  AM-RETRO-RET-BRACKET-LF.
  1789             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1790                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1791                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1792             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1793                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1794                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1795             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1796                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1797                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1798         16  AM-RETRO-RET-BRACKET-AH.
  1799             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1800                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1801                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1802                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1803             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1804                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1805                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1806             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1807                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1808                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1809
  1810     12  AM-COMMENTS.
  1811         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1812
  1813     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1814         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1815         16  AM-FLI-BILLING-CODE           PIC X.
  1816         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1817         16  AM-FLI-UNITED-IDENT           PIC X.
  1818         16  AM-FLI-INTEREST-LOST-DATA.
  1819             20  AM-FLI-BANK-NO            PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  34
* EL6311.cbl
  1820             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1821             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1822             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1823         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1824             20  AM-FLI-AGT                PIC X(9).
  1825             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1826             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1827         16  FILLER                        PIC X(102).
  1828
  1829     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1830         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1831             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1832             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1833             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1834             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1835             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1836         16  FILLER                          PIC X(10).
  1837******************************************************************
  1838*                                copy ERCACNT.
  1839******************************************************************
  1840*                                                                *
  1841*                                                                *
  1842*                            ERCACNT.                            *
  1843*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1844*                            VMOD=2.002                          *
  1845*                                                                *
  1846*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1847*                                                                *
  1848*   FILE TYPE = VSAM,KSDS                                        *
  1849*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1850*                                                                *
  1851*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1852*       ALTERNATE INDEX = NONE                                   *
  1853*                                                                *
  1854*                                                                *
  1855*   LOG = YES                                                    *
  1856*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1857******************************************************************
  1858*                   C H A N G E   L O G
  1859*
  1860* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1861*-----------------------------------------------------------------
  1862*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1863* EFFECTIVE    NUMBER
  1864*-----------------------------------------------------------------
  1865* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1866*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  1867******************************************************************
  1868 01  NOTE-FILE.
  1869     12  NT-FILE-ID                  PIC XX.
  1870         88  VALID-NOTE-ID              VALUE 'NT'.
  1871
  1872     12  NT-CONTROL-PRIMARY.
  1873         16  NT-COMPANY-CD           PIC X.
  1874         16  NT-ACCT-NOTE-KEY.
  1875             18  NT-CARRIER              PIC X.
  1876             18  NT-GROUPING             PIC X(06).
  1877             18  NT-STATE                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  35
* EL6311.cbl
  1878             18  NT-ACCOUNT              PIC X(10).
  1879         16  NT-RECORD-TYPE          PIC X.
  1880              88  ACCT-NOTE          VALUE '1'.
  1881              88  ACCT-BRANCH-LOC    VALUE '2'.
  1882              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1883         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1884
  1885     12  NT-LAST-MAINT-DT            PIC XX.
  1886     12  NT-LAST-MAINT-BY            PIC X(4).
  1887     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1888
  1889*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1890*     SEQUENCE NUMBERS
  1891     12  NT-NOTE-INFORMATION.
  1892         16  NT-NOTE-LINE            PIC X(60).
  1893         16  FILLER                  PIC X(25).
  1894*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1895     12  NT-LOCATION-INFORMATION REDEFINES
  1896                         NT-NOTE-INFORMATION.
  1897         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1898         16  FILLER                  PIC X(25).
  1899* Account special indicator is record type '2', sequence 3
  1900     12  filler REDEFINES NT-NOTE-INFORMATION.
  1901         16  nt-account-special      PIC X.
  1902         16  FILLER                  PIC X(84).
  1903*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1904*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1905*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1906*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1907*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1908*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1909*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1910     12  NT-SHIPPING-INFORMATION REDEFINES
  1911                         NT-NOTE-INFORMATION.
  1912         16  NT-SHIPPING-LINE        PIC X(60).
  1913         16  NT-SHIP-STATE           PIC XX.
  1914         16  NT-SHIP-ZIP             PIC X(10).
  1915         16  FILLER                  PIC X(13).
  1916*****************************************************************
  1917*                                COPY ELCVADS.
  1918******************************************************************
  1919*                                                                *
  1920*                                                                *
  1921*                            ELCVADS.                            *
  1922*                                                                *
  1923*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1924*   ELVADS                  LENGTH = 350                         *
  1925******************************************************************
  1926******************************************************************
  1927*                   C H A N G E   L O G
  1928*
  1929* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1930*-----------------------------------------------------------------
  1931*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1932* EFFECTIVE    NUMBER
  1933*-----------------------------------------------------------------
  1934* 100111    2011022800001  AJRA  NAPERSOFT
  1935******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  36
* EL6311.cbl
  1936
  1937 01  VIRGINIA-DISCLOSURE.
  1938     12  VD-COMPANY-CD              PIC X.
  1939     12  VD-CARRIER                 PIC X.
  1940     12  VD-GROUPING.
  1941         20  VD-GROUPING-PREFIX     PIC XXX.
  1942         20  VD-GROUPING-PRIME      PIC XXX.
  1943     12  VD-STATE                   PIC XX.
  1944     12  VD-ACCOUNT.
  1945         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1946         20  VD-ACCOUNT-PRIME       PIC X(6).
  1947     12  VD-CERT-EFF-DT             PIC XX.
  1948     12  VD-CERT-NO.
  1949         20  VD-CERT-PRIME          PIC X(10).
  1950         20  VD-CERT-SFX            PIC X.
  1951     12  VD-ENTRY-BATCH             PIC X(6).
  1952     12  VD-CSR-ID                  PIC X(4).
  1953     12  VD-NAME.
  1954         20  VD-INSURED-LAST-NAME   PIC X(15).
  1955         20  VD-INSURED-FIRST-NAME.
  1956             24  VD-INSURED-1ST-INIT PIC X.
  1957             24  FILLER             PIC X(9).
  1958         20  VD-INSURED-MIDDLE-INIT PIC X.
  1959     12  VD-JOINT-INSURED.
  1960         20 VD-JOINT-LAST-NAME      PIC X(15).
  1961         20 VD-JOINT-FIRST-NAME.
  1962            24  VD-JOINT-FIRST-INIT PIC X.
  1963            24  FILLER              PIC X(9).
  1964         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1965     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1966     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1967     12  VD-INSURED-CITY-STATE.
  1968         20  VD-INSURED-CITY        PIC X(28).
  1969         20  VD-INSURED-STATE       PIC XX.
  1970     12  VD-INSURED-ZIP-CODE.
  1971         20  VD-INSURED-ZIP-PRIME.
  1972             24  VD-INSURED-ZIP-1   PIC X.
  1973                 88  VD-CANADIAN-POST-CODE
  1974                                       VALUE 'A' THRU 'Z'.
  1975             24  FILLER             PIC X(4).
  1976         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1977     12  VD-BENEFICIARY-NAME        PIC X(30).
  1978     12  VD-ACCOUNT-NAME            PIC X(30).
  1979     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1980     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1981     12  VD-1ST-PMT-DT              PIC XX.
  1982     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1983         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1984         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1985                                             '90' THRU '99'.
  1986     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1987                                    PIC XX.
  1988     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1989     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1990     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1991     12  VD-LF-TERM                 PIC S999   COMP-3.
  1992     12  VD-AH-BENEFIT-CD           PIC XX.
  1993         88  VD-VALID-AH               VALUE '01' THRU '89'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  37
* EL6311.cbl
  1994         88  VD-INVALID-AH             VALUE '  ' '00'
  1995                                             '90' THRU '99'.
  1996     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1997     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1998     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1999     12  VD-AH-TERM                 PIC S999   COMP-3.
  2000     12  VD-LETTER-ID               PIC X(4).
  2001     12  VD-PROC-ID                 PIC X(4).
  2002     12  VD-COMP-ID                 PIC X(3).
  2003     12  VD-CURRENT-DATE            PIC XX.
  2004     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  2005     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  2006     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  38
* EL6311.cbl
  2008*    COPY ELCDATE.
  2009******************************************************************
  2010*                                                                *
  2011*                                                                *
  2012*                            ELCDATE.                            *
  2013*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2014*                            VMOD=2.003
  2015*                                                                *
  2016*                                                                *
  2017*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2018*                 LENGTH = 200                                   *
  2019******************************************************************
  2020
  2021 01  DATE-CONVERSION-DATA.
  2022     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2023     12  DC-OPTION-CODE                PIC X.
  2024         88  BIN-TO-GREG                VALUE ' '.
  2025         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2026         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2027         88  YMD-GREG-TO-BIN            VALUE '3'.
  2028         88  MDY-GREG-TO-BIN            VALUE '4'.
  2029         88  JULIAN-TO-BIN              VALUE '5'.
  2030         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2031         88  FIND-CENTURY               VALUE '7'.
  2032         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2033         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2034         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2035         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2036         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2037         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2038         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2039         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2040         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2041         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2042         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2043         88  BIN-3-TO-GREG              VALUE 'I'.
  2044         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2045         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2046         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2047         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2048         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2049         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2050         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2051         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2052         88  THREE-CHARACTER-BIN
  2053                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2054         88  GREGORIAN-TO-BIN
  2055                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2056         88  BIN-TO-GREGORIAN
  2057                  VALUES ' ' '1' 'I' '8' 'G'.
  2058         88  JULIAN-TO-BINARY
  2059                  VALUES '5' 'C' 'E' 'F'.
  2060     12  DC-ERROR-CODE                 PIC X.
  2061         88  NO-CONVERSION-ERROR        VALUE ' '.
  2062         88  DATE-CONVERSION-ERROR
  2063                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2064         88  DATE-IS-ZERO               VALUE '1'.
  2065         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  39
* EL6311.cbl
  2066         88  DATE-IS-INVALID            VALUE '3'.
  2067         88  DATE1-GREATER-DATE2        VALUE '4'.
  2068         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2069         88  DATE-INVALID-OPTION        VALUE '9'.
  2070         88  INVALID-CENTURY            VALUE 'A'.
  2071         88  ONLY-CENTURY               VALUE 'B'.
  2072         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2073         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2074     12  DC-END-OF-MONTH               PIC X.
  2075         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2076     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2077         88  USE-NORMAL-PROCESS         VALUE ' '.
  2078         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2079         88  ADJUST-UP-100-YRS          VALUE '2'.
  2080     12  FILLER                        PIC X.
  2081     12  DC-CONVERSION-DATES.
  2082         16  DC-BIN-DATE-1             PIC XX.
  2083         16  DC-BIN-DATE-2             PIC XX.
  2084         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2085         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2086                       DC-GREG-DATE-1-EDIT.
  2087             20  DC-EDIT1-MONTH        PIC 99.
  2088             20  SLASH1-1              PIC X.
  2089             20  DC-EDIT1-DAY          PIC 99.
  2090             20  SLASH1-2              PIC X.
  2091             20  DC-EDIT1-YEAR         PIC 99.
  2092         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2093         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2094                     DC-GREG-DATE-2-EDIT.
  2095             20  DC-EDIT2-MONTH        PIC 99.
  2096             20  SLASH2-1              PIC X.
  2097             20  DC-EDIT2-DAY          PIC 99.
  2098             20  SLASH2-2              PIC X.
  2099             20  DC-EDIT2-YEAR         PIC 99.
  2100         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2101         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2102                     DC-GREG-DATE-1-YMD.
  2103             20  DC-YMD-YEAR           PIC 99.
  2104             20  DC-YMD-MONTH          PIC 99.
  2105             20  DC-YMD-DAY            PIC 99.
  2106         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2107         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2108                      DC-GREG-DATE-1-MDY.
  2109             20  DC-MDY-MONTH          PIC 99.
  2110             20  DC-MDY-DAY            PIC 99.
  2111             20  DC-MDY-YEAR           PIC 99.
  2112         16  DC-GREG-DATE-1-ALPHA.
  2113             20  DC-ALPHA-MONTH        PIC X(10).
  2114             20  DC-ALPHA-DAY          PIC 99.
  2115             20  FILLER                PIC XX.
  2116             20  DC-ALPHA-CENTURY.
  2117                 24 DC-ALPHA-CEN-N     PIC 99.
  2118             20  DC-ALPHA-YEAR         PIC 99.
  2119         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2120         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2121         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2122         16  DC-JULIAN-DATE            PIC 9(05).
  2123         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  40
* EL6311.cbl
  2124                                       PIC 9(05).
  2125         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2126             20  DC-JULIAN-YEAR        PIC 99.
  2127             20  DC-JULIAN-DAYS        PIC 999.
  2128         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2129         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2130         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2131     12  DATE-CONVERSION-VARIBLES.
  2132         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2133         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2134             20  FILLER                PIC 9(3).
  2135             20  HOLD-CEN-1-CCYY.
  2136                 24  HOLD-CEN-1-CC     PIC 99.
  2137                 24  HOLD-CEN-1-YY     PIC 99.
  2138             20  HOLD-CEN-1-MO         PIC 99.
  2139             20  HOLD-CEN-1-DA         PIC 99.
  2140         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2141             20  HOLD-CEN-1-R-MO       PIC 99.
  2142             20  HOLD-CEN-1-R-DA       PIC 99.
  2143             20  HOLD-CEN-1-R-CCYY.
  2144                 24  HOLD-CEN-1-R-CC   PIC 99.
  2145                 24  HOLD-CEN-1-R-YY   PIC 99.
  2146             20  FILLER                PIC 9(3).
  2147         16  HOLD-CENTURY-1-X.
  2148             20  FILLER                PIC X(3)  VALUE SPACES.
  2149             20  HOLD-CEN-1-X-CCYY.
  2150                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2151                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2152             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2153             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2154         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2155             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2156             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2157             20  HOLD-CEN-1-R-X-CCYY.
  2158                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2159                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2160             20  FILLER                PIC XXX.
  2161         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2162         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2163         16  DC-JULIAN-DATE-1          PIC 9(07).
  2164         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2165             20  DC-JULIAN-1-CCYY.
  2166                 24  DC-JULIAN-1-CC    PIC 99.
  2167                 24  DC-JULIAN-1-YR    PIC 99.
  2168             20  DC-JULIAN-DA-1        PIC 999.
  2169         16  DC-JULIAN-DATE-2          PIC 9(07).
  2170         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2171             20  DC-JULIAN-2-CCYY.
  2172                 24  DC-JULIAN-2-CC    PIC 99.
  2173                 24  DC-JULIAN-2-YR    PIC 99.
  2174             20  DC-JULIAN-DA-2        PIC 999.
  2175         16  DC-GREG-DATE-A-EDIT.
  2176             20  DC-EDITA-MONTH        PIC 99.
  2177             20  SLASHA-1              PIC X VALUE '/'.
  2178             20  DC-EDITA-DAY          PIC 99.
  2179             20  SLASHA-2              PIC X VALUE '/'.
  2180             20  DC-EDITA-CCYY.
  2181                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  41
* EL6311.cbl
  2182                 24  DC-EDITA-YEAR     PIC 99.
  2183         16  DC-GREG-DATE-B-EDIT.
  2184             20  DC-EDITB-MONTH        PIC 99.
  2185             20  SLASHB-1              PIC X VALUE '/'.
  2186             20  DC-EDITB-DAY          PIC 99.
  2187             20  SLASHB-2              PIC X VALUE '/'.
  2188             20  DC-EDITB-CCYY.
  2189                 24  DC-EDITB-CENT     PIC 99.
  2190                 24  DC-EDITB-YEAR     PIC 99.
  2191         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2192         16  DC-GREG-DATE-CYMD-R REDEFINES
  2193                              DC-GREG-DATE-CYMD.
  2194             20  DC-CYMD-CEN           PIC 99.
  2195             20  DC-CYMD-YEAR          PIC 99.
  2196             20  DC-CYMD-MONTH         PIC 99.
  2197             20  DC-CYMD-DAY           PIC 99.
  2198         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2199         16  DC-GREG-DATE-MDCY-R REDEFINES
  2200                              DC-GREG-DATE-MDCY.
  2201             20  DC-MDCY-MONTH         PIC 99.
  2202             20  DC-MDCY-DAY           PIC 99.
  2203             20  DC-MDCY-CEN           PIC 99.
  2204             20  DC-MDCY-YEAR          PIC 99.
  2205    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2206        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2207    12  DC-EL310-DATE                  PIC X(21).
  2208    12  FILLER                         PIC X(28).
  2209
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  42
* EL6311.cbl
  2211*    COPY ELCLOGOF.
  2212******************************************************************
  2213*                                                                *
  2214*                                                                *
  2215*                            ELCLOGOF.                           *
  2216*                            VMOD=2.001                          *
  2217*                                                                *
  2218*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2219*                                                                *
  2220******************************************************************
  2221 01  CLASIC-LOGOFF.
  2222     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2223     12  LOGOFF-TEXT.
  2224         16  FILLER          PIC X(5)    VALUE SPACES.
  2225         16  LOGOFF-MSG.
  2226             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2227             20  FILLER      PIC X       VALUE SPACES.
  2228             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2229         16  FILLER          PIC X(80)
  2230           VALUE '* YOU ARE NOW LOGGED OFF'.
  2231         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2232         16  FILLER          PIC X       VALUE QUOTE.
  2233         16  LOGOFF-SYS-MSG  PIC X(17)
  2234           VALUE 'S CLAS-IC SYSTEM '.
  2235     12  TEXT-MESSAGES.
  2236         16  UNACCESS-MSG    PIC X(29)
  2237             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2238         16  PGMIDERR-MSG    PIC X(17)
  2239             VALUE 'PROGRAM NOT FOUND'.
  2240
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  43
* EL6311.cbl
  2242*    COPY ELCATTR.
  2243******************************************************************
  2244*                                                                *
  2245*                            ELCATTR.                            *
  2246*                            VMOD=2.001                          *
  2247*                                                                *
  2248*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2249*                                                                *
  2250*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2251*                                                                *
  2252*                   POS 1   P=PROTECTED                          *
  2253*                           U=UNPROTECTED                        *
  2254*                           S=ASKIP                              *
  2255*                   POS 2   A=ALPHA/NUMERIC                      *
  2256*                           N=NUMERIC                            *
  2257*                   POS 3   N=NORMAL                             *
  2258*                           B=BRIGHT                             *
  2259*                           D=DARK                               *
  2260*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2261*                           OF=MODIFIED DATA TAG OFF             *
  2262*                                                                *
  2263*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2264******************************************************************
  2265 01  ATTRIBUTE-LIST.
  2266     12  AL-PABOF            PIC X       VALUE 'Y'.
  2267     12  AL-PABON            PIC X       VALUE 'Z'.
  2268     12  AL-PADOF            PIC X       VALUE '%'.
  2269     12  AL-PADON            PIC X       VALUE '_'.
  2270     12  AL-PANOF            PIC X       VALUE '-'.
  2271     12  AL-PANON            PIC X       VALUE '/'.
  2272     12  AL-SABOF            PIC X       VALUE '8'.
  2273     12  AL-SABON            PIC X       VALUE '9'.
  2274     12  AL-SADOF            PIC X       VALUE '@'.
  2275     12  AL-SADON            PIC X       VALUE QUOTE.
  2276     12  AL-SANOF            PIC X       VALUE '0'.
  2277     12  AL-SANON            PIC X       VALUE '1'.
  2278     12  AL-UABOF            PIC X       VALUE 'H'.
  2279     12  AL-UABON            PIC X       VALUE 'I'.
  2280     12  AL-UADOF            PIC X       VALUE '<'.
  2281     12  AL-UADON            PIC X       VALUE '('.
  2282     12  AL-UANOF            PIC X       VALUE ' '.
  2283     12  AL-UANON            PIC X       VALUE 'A'.
  2284     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2285     12  AL-UNBON            PIC X       VALUE 'R'.
  2286     12  AL-UNDOF            PIC X       VALUE '*'.
  2287     12  AL-UNDON            PIC X       VALUE ')'.
  2288     12  AL-UNNOF            PIC X       VALUE '&'.
  2289     12  AL-UNNON            PIC X       VALUE 'J'.
  2290
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  44
* EL6311.cbl
  2292*    COPY ELCEMIB.
  2293******************************************************************
  2294*                                                                *
  2295*                                                                *
  2296*                            ELCEMIB.                            *
  2297*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2298*                            VMOD=2.005                          *
  2299*                                                                *
  2300*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2301*                                                                *
  2302******************************************************************
  2303 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2304     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2305     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2306     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2307     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2308     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2309     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2310     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2311     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2312     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2313         88  EMI-NO-ERRORS                    VALUE '1'.
  2314         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2315         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2316     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2317         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2318     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2319         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2320         88  EMI-AREA1-FULL                   VALUE '2'.
  2321     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2322         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2323         88  EMI-AREA2-FULL                   VALUE '2'.
  2324     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2325         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2326         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2327         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2328         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2329         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2330     12  EMI-ERROR-LINES.
  2331         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2332         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2333         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2334         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2335             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2336                 24  EMI-ERR-NUM         PIC X(4).
  2337                 24  EMI-FILLER          PIC X.
  2338                 24  EMI-SEV             PIC X.
  2339                 24  FILLER              PIC X.
  2340             20  FILLER                  PIC X(02).
  2341     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2342         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2343             20  EMI-ERROR-NUMBER    PIC X(4).
  2344             20  EMI-FILL            PIC X.
  2345             20  EMI-SEVERITY        PIC X.
  2346             20  FILLER              PIC X.
  2347             20  EMI-ERROR-TEXT.
  2348                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2349                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  45
* EL6311.cbl
  2350     12  EMI-SEVERITY-SAVE           PIC X.
  2351         88  EMI-NOTE                    VALUE 'N'.
  2352         88  EMI-WARNING                 VALUE 'W'.
  2353         88  EMI-FORCABLE                VALUE 'F'.
  2354         88  EMI-FATAL                   VALUE 'X'.
  2355     12  EMI-MESSAGE-FLAG            PIC X.
  2356         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2357         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2358     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2359     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2360         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2361         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2362         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2363     12  emi-claim-no                pic x(7).
  2364     12  emi-claim-type              pic x(6).
  2365     12  FILLER                      PIC X(124)  VALUE SPACES.
  2366     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2367     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2368     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2369     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2370
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  46
* EL6311.cbl
  2372*    COPY ELCINTF.
  2373******************************************************************
  2374*                                                                *
  2375*                                                                *
  2376*                            ELCINTF.                            *
  2377*                            VMOD=2.017                          *
  2378*                                                                *
  2379*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2380*                                                                *
  2381*       LENGTH = 1024                                            *
  2382*                                                                *
  2383******************************************************************
  2384*                   C H A N G E   L O G
  2385*
  2386* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2387*-----------------------------------------------------------------
  2388*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2389* EFFECTIVE    NUMBER
  2390*-----------------------------------------------------------------
  2391* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2392******************************************************************
  2393 01  PROGRAM-INTERFACE-BLOCK.
  2394     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2395     12  PI-CALLING-PROGRAM              PIC X(8).
  2396     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2397     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2398     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2399     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2400     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2401     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2402     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2403     12  PI-COMPANY-ID                   PIC XXX.
  2404     12  PI-COMPANY-CD                   PIC X.
  2405
  2406     12  PI-COMPANY-PASSWORD             PIC X(8).
  2407
  2408     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2409
  2410     12  PI-CONTROL-IN-PROGRESS.
  2411         16  PI-CARRIER                  PIC X.
  2412         16  PI-GROUPING                 PIC X(6).
  2413         16  PI-STATE                    PIC XX.
  2414         16  PI-ACCOUNT                  PIC X(10).
  2415         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2416                                         PIC X(10).
  2417         16  PI-CLAIM-CERT-GRP.
  2418             20  PI-CLAIM-NO             PIC X(7).
  2419             20  PI-CERT-NO.
  2420                 25  PI-CERT-PRIME       PIC X(10).
  2421                 25  PI-CERT-SFX         PIC X.
  2422             20  PI-CERT-EFF-DT          PIC XX.
  2423         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2424             20  PI-PLAN-CODE            PIC X(2).
  2425             20  PI-REVISION-NUMBER      PIC X(3).
  2426             20  PI-PLAN-EFF-DT          PIC X(2).
  2427             20  PI-PLAN-EXP-DT          PIC X(2).
  2428             20  FILLER                  PIC X(11).
  2429         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  47
* EL6311.cbl
  2430             20  PI-OE-REFERENCE-1.
  2431                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2432                 25  PI-OE-REF-1-SUFF    PIC XX.
  2433
  2434     12  PI-SESSION-IN-PROGRESS          PIC X.
  2435         88  CLAIM-SESSION                   VALUE '1'.
  2436         88  CREDIT-SESSION                  VALUE '2'.
  2437         88  WARRANTY-SESSION                VALUE '3'.
  2438         88  MORTGAGE-SESSION                VALUE '4'.
  2439         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2440
  2441
  2442*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2443
  2444     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2445     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2446
  2447     12  PI-CREDIT-USER                  PIC X.
  2448         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2449         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2450
  2451     12  PI-CLAIM-USER                   PIC X.
  2452         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2453         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2454
  2455     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2456         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2457         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2458         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2459         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2460         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2461
  2462     12  PI-PROCESSOR-ID                 PIC X(4).
  2463
  2464     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2465
  2466     12  PI-MEMBER-CAPTION               PIC X(10).
  2467
  2468     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2469         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2470
  2471     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2472     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2473     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2474     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2475
  2476     12  PI-AH-OVERRIDE-L1               PIC X.
  2477     12  PI-AH-OVERRIDE-L2               PIC XX.
  2478     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2479     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2480
  2481     12  PI-NEW-SYSTEM                   PIC X(2).
  2482
  2483     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2484     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2485         88  PI-USES-PAID-TO                 VALUE '1'.
  2486     12  PI-CRDTCRD-SYSTEM.
  2487         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  48
* EL6311.cbl
  2488             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2489             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2490         16  PI-CC-MONTH-END-DT          PIC XX.
  2491     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2492
  2493     12  PI-OE-REFERENCE-2.
  2494         16  PI-OE-REF-2-PRIME           PIC X(10).
  2495         16  PI-OE-REF-2-SUFF            PIC X.
  2496
  2497     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2498
  2499     12  PI-LANGUAGE-TYPE                PIC X.
  2500             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2501             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2502             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2503
  2504     12  PI-POLICY-LINKAGE-IND           PIC X.
  2505         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2506         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2507                                                   LOW-VALUES.
  2508
  2509     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2510     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2511         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2512         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2513
  2514     12  PI-PROCESSOR-CSR-IND            PIC X.
  2515         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2516         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2517
  2518     12  FILLER                          PIC X(3).
  2519
  2520     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2521
  2522     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2523         PI-SYSTEM-LEVEL.
  2524
  2525         16  PI-ENTRY-CODES.
  2526             20  PI-ENTRY-CD-1           PIC X.
  2527             20  PI-ENTRY-CD-2           PIC X.
  2528
  2529         16  PI-RETURN-CODES.
  2530             20  PI-RETURN-CD-1          PIC X.
  2531             20  PI-RETURN-CD-2          PIC X.
  2532
  2533         16  PI-UPDATE-STATUS-SAVE.
  2534             20  PI-UPDATE-BY            PIC X(4).
  2535             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2536
  2537         16  PI-LOWER-CASE-LETTERS       PIC X.
  2538             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2539
  2540*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2541*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2542*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2543
  2544         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2545             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  49
* EL6311.cbl
  2546             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2547             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2548             88  ACCNT-CNTL                  VALUE '3'.
  2549             88  CARR-ACCNT-CNTL             VALUE '4'.
  2550
  2551         16  PI-PROCESSOR-CAP-LIST.
  2552             20  PI-SYSTEM-CONTROLS.
  2553                24 PI-SYSTEM-DISPLAY     PIC X.
  2554                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2555                24 PI-SYSTEM-MODIFY      PIC X.
  2556                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2557             20  FILLER                  PIC XX.
  2558             20  PI-DISPLAY-CAP          PIC X.
  2559                 88  DISPLAY-CAP             VALUE 'Y'.
  2560             20  PI-MODIFY-CAP           PIC X.
  2561                 88  MODIFY-CAP              VALUE 'Y'.
  2562             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2563                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2564             20  PI-FORCE-CAP            PIC X.
  2565                 88  FORCE-CAP               VALUE 'Y'.
  2566
  2567         16  PI-PROGRAM-CONTROLS.
  2568             20  PI-PGM-PRINT-OPT        PIC X.
  2569             20  PI-PGM-FORMAT-OPT       PIC X.
  2570             20  PI-PGM-PROCESS-OPT      PIC X.
  2571             20  PI-PGM-TOTALS-OPT       PIC X.
  2572
  2573         16  PI-HELP-INTERFACE.
  2574             20  PI-LAST-ERROR-NO        PIC X(4).
  2575             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2576
  2577         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2578             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2579
  2580         16  PI-CR-CONTROL-IN-PROGRESS.
  2581             20  PI-CR-CARRIER           PIC X.
  2582             20  PI-CR-GROUPING          PIC X(6).
  2583             20  PI-CR-STATE             PIC XX.
  2584             20  PI-CR-ACCOUNT           PIC X(10).
  2585             20  PI-CR-FIN-RESP          PIC X(10).
  2586             20  PI-CR-TYPE              PIC X.
  2587
  2588         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2589
  2590         16  PI-CR-MONTH-END-DT          PIC XX.
  2591
  2592         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2593             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2594             88  PI-ZERO-CARRIER             VALUE '1'.
  2595             88  PI-ZERO-GROUPING            VALUE '2'.
  2596             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2597
  2598         16  PI-CARRIER-SECURITY         PIC X.
  2599             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2600
  2601         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2602             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2603             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  50
* EL6311.cbl
  2604
  2605         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2606             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2607                                         INDEXED BY PI-ACCESS-NDX
  2608                                         PIC X.
  2609
  2610         16  PI-GA-BILLING-CONTROL       PIC X.
  2611             88  PI-GA-BILLING               VALUE '1'.
  2612
  2613         16  PI-MAIL-PROCESSING          PIC X.
  2614             88  PI-MAIL-YES                 VALUE 'Y'.
  2615
  2616         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2617
  2618         16  PI-AR-SYSTEM.
  2619             20  PI-AR-PROCESSING-CNTL   PIC X.
  2620                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2621             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2622             20  PI-AR-MONTH-END-DT      PIC XX.
  2623
  2624         16  PI-MP-SYSTEM.
  2625             20  PI-MORTGAGE-USER            PIC X.
  2626                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2627                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2628             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2629                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2630                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2631                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2632                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2633                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2634             20  PI-MP-MONTH-END-DT          PIC XX.
  2635             20  PI-MP-REFERENCE-NO.
  2636                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2637                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2638
  2639         16  PI-LABEL-CONTROL            PIC X(01).
  2640             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2641             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2642
  2643         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2644             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2645
  2646         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2647             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2648             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2649
  2650         16  FILLER                      PIC X(14).
  2651
  2652     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2653******************************************************************
  2654
  2655     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2656*    COPY ELC631PI.
  2657******************************************************************
  2658*                                                                *
  2659*                                                                *
  2660*                            ELC631PI                            *
  2661*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  51
* EL6311.cbl
  2662*                                                                *
  2663*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2664*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2665*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2666*                                                                *
  2667*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2668*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2669*    BETWEEN PROGRAMS.                                           *
  2670*                                                                *
  2671*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2672*                                                                *
  2673*               EL631 - EL6311 - EL6312 - EL6313                 *
  2674*                                                                *
  2675******************************************************************
  2676*                   C H A N G E   L O G
  2677*
  2678* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2679*-----------------------------------------------------------------
  2680*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2681* EFFECTIVE    NUMBER
  2682*-----------------------------------------------------------------
  2683* 021414    2003053000001  PEMA  changes for auto chk request
  2684******************************************************************
  2685
  2686         16  PI-631-DATA.
  2687             20  PI-ERPNDB-KEY.
  2688                 24  PI-PB-COMPANY-CD     PIC X.
  2689                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2690                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2691                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2692
  2693             20  PI-ERPNDB-ALT-KEY.
  2694                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2695                 24  PI-PB-CARRIER        PIC X.
  2696                 24  PI-PB-GROUPING       PIC X(6).
  2697                 24  PI-PB-STATE          PIC XX.
  2698                 24  PI-PB-ACCOUNT        PIC X(10).
  2699                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2700                 24  PI-PB-CERT-NO.
  2701                     28  PI-PB-CERT-PRIME PIC X(10).
  2702                     28  PI-PB-CERT-SFX   PIC X.
  2703                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2704                 24  PI-PB-RECORD-TYPE    PIC X.
  2705
  2706             20  PI-ERPNDB-CSR-KEY.
  2707                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2708                 24  PI-PB-CSR-ID             PIC X(4).
  2709                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2710                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2711                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2712
  2713             20  PI-BROWSE-TYPE               PIC X.
  2714                 88  PI-FILE-BROWSE             VALUE ' '.
  2715                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2716                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2717                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2718                 88  PI-CSR-BROWSE              VALUE '4'.
  2719
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  52
* EL6311.cbl
  2720             20  PI-MAINT-FUNCTION            PIC X.
  2721                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2722                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2723                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2724                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2725                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2726                 88  PI-PF5-FUNCTION            VALUE '5'.
  2727                 88  PI-PF6-FUNCTION            VALUE '6'.
  2728
  2729             20  PI-FILE-SWITCHES.
  2730                 24  PI-ALL-ISSUES-SW         PIC X.
  2731                     88  ALL-ISSUES             VALUE 'Y'.
  2732                 24  PI-ALL-CANCELS-SW        PIC X.
  2733                     88  ALL-CANCELS            VALUE 'Y'.
  2734                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2735                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2736                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2737                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2738                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2739                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2740                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2741                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2742                 24  PI-HOLD-REC-SW           PIC X.
  2743                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2744                 24  PI-CHANGE-REC-SW         PIC X.
  2745                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2746                 24  PI-CHK-REQ-REC-SW        PIC X.
  2747                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2748                 24  PI-ISSUE-WARNING-SW      PIC X.
  2749                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2750                 24  PI-CANCEL-WARNING-SW     PIC X.
  2751                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2752             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2753                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2754             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2755                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2756
  2757             20  PI-MAP-NAME                  PIC X(8).
  2758
  2759             20  PI-CURSOR                    PIC S9(4) COMP.
  2760
  2761             20  PI-PREV-ALT-KEY              PIC X(36).
  2762             20  PI-PREV-CSR-KEY              PIC X(15).
  2763             20  PI-PREV-KEY.
  2764                 24  PI-PREV-COMPANY-CD       PIC X.
  2765                 24  PI-PREV-BATCH            PIC X(6).
  2766                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2767                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2768             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2769             20  PI-BROWSE-SW                 PIC X.
  2770                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2771                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2772             20  PI-SV-CARRIER                PIC X.
  2773             20  PI-SV-GROUPING               PIC X(6).
  2774             20  PI-SV-STATE                  PIC XX.
  2775             20  PI-EDIT-SW                   PIC X.
  2776             20  PI-DISPLAY-SW                PIC XX.
  2777                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  53
* EL6311.cbl
  2778                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2779             20  PI-CRITERIA-DATA             PIC X(350).
  2780             20  PI-BMODE                     PIC X.
  2781             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2782             20  PI-BPMTS                     PIC S999     COMP-3.
  2783             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2784             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2785             20  PI-CSR-SESSION-SW            PIC X.
  2786                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2787             20  PI-ERRORS-SW                 PIC X.
  2788                 88  FATAL-ERRORS               VALUE 'X'.
  2789*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2790             20  pi-unforced-sw               pic x.
  2791                 88  unforced-errors            value 'X'.
  2792             20  FILLER                       PIC X(4).
  2793
  2794        16  pi-6311-fatal-ctr    pic s999 comp-3.
  2795        16  FILLER             PIC X(92).
  2796
  2797 01  W-LETTER-COMMUNICATION-AREAS.
  2798*    COPY ELC1042.
  2799******************************************************************
  2800*                                                                *
  2801*                                                                *
  2802*                           ELC1042                              *
  2803*                            VMOD=2.002                          *
  2804*                                                                *
  2805*    NOTE                                                        *
  2806*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2807*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2808*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2809*        TO THESE PROGRAMS.                                      *
  2810*                                                                *
  2811*    NOTE                                                        *
  2812*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2813*        USE ONLY!                                               *
  2814*                                                                *
  2815******************************************************************
  2816
  2817         16  PI-1042-WA.
  2818             20  PI-ACTION       PIC  X(01).
  2819                 88 PI-SHOW-MODE           VALUE '1'.
  2820                 88 PI-CLEAR-MODE          VALUE '2'.
  2821                 88 PI-CREATE-MODE         VALUE '3'.
  2822             20  PI-COMM-CONTROL PIC  X(12).
  2823             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2824             20  PI-EOF-SW       PIC  X(01).
  2825                 88  PI-FILE-EOF           VALUE 'Y'.
  2826             20  PI-FILETYP      PIC  X(01).
  2827             20  PI-FORM-SQUEEZE-CONTROL
  2828                                 PIC  X(01).
  2829                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2830                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2831             20  PI-LAST-CONTROL PIC  X(12).
  2832             20  PI-TEMP-STOR-ITEMS
  2833                                 PIC S9(04) COMP.
  2834             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2835             20  PI-UPDATE-SW    PIC  9(01).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  54
* EL6311.cbl
  2836                 88 ANY-UPDATES            VALUE 1.
  2837             20  PI-104-SCREEN-SENT-IND
  2838                                 PIC  X(01).
  2839                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2840                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2841             20  PI-1042-SCREEN-SENT-IND
  2842                                 PIC  X(01).
  2843                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2844                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2845             20  PI-1042-ARCHIVE-IND
  2846                                 PIC  X(01).
  2847                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2848             20  FILLER          PIC  X(29).
  2849*    COPY ELC689PI.
  2850******************************************************************
  2851*                                                                *
  2852*                            ELC689PI                            *
  2853*                            VMOD=2.003                          *
  2854*                                                                *
  2855*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2856*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2857*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2858*                                                                *
  2859*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2860*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2861*    BETWEEN PROGRAMS.                                           *
  2862*                                                                *
  2863*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2864*                                                                *
  2865*               EL631 - EL689  - EL6891 - EL6892                 *
  2866*                                                                *
  2867******************************************************************
  2868*                   C H A N G E   L O G
  2869*
  2870* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2871*-----------------------------------------------------------------
  2872*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2873* EFFECTIVE    NUMBER
  2874*-----------------------------------------------------------------
  2875* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2876* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2877* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2878******************************************************************
  2879
  2880
  2881         16  PI-689-WORK-AREA.
  2882             20  PI-689-ALT-PRINTER-ID
  2883                                 PIC  X(04).
  2884             20  PI-689-ARCHIVE-NUMBER
  2885                                 PIC  9(08).
  2886             20  PI-689-ARCHIVE-SW
  2887                                 PIC  X(01).
  2888                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2889             20  PI-689-DATA-SOURCE
  2890                                 PIC  X(01).
  2891                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2892                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2893                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  55
* EL6311.cbl
  2894                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2895                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2896             20  PI-689-ERROR-IND
  2897                                 PIC  X(01).
  2898                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2899             20  PI-689-ERROR    PIC  9(04).
  2900                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2901                 88  PI-689-FATAL-ERROR
  2902                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2903                            0042 0047 0051 0066 0067 0070
  2904                            0168 0169 0174 0175 0176 0177 0179
  2905                            0180 0181 0182 0184 0185 0189 0190
  2906                            0191
  2907                            0215 0279 0280
  2908                            0412 0413 0454
  2909                            0533 0537
  2910                            2055 2114 2208 2209 2216 2232 2369
  2911                            2398 2433 2908 2999
  2912                            3000 3770 3771 3775
  2913                            7250 7365 7367 7368 7369 7370 7371
  2914                            7272 7373 7374 7376 7377 7378 7379
  2915                            7381 7388 7390 7393 7395 7396 7398
  2916                            9095 9096 9281 9298 9299 9320 9327
  2917                            9426 9427.
  2918                 88  PI-689-STOP-ERROR
  2919                     VALUES 0004 0008 0013 0023 0029 0033
  2920                            0042 0047 0066 0067 0070
  2921                            0168 0169 0174 0175 0176 0177
  2922                            0181 0182 0184 0185 0189 0190
  2923                            0279 0280
  2924                            0412 0413 0454
  2925                            2055 2208 2209 2216 2232
  2926                            2398 2999
  2927                            3000 3770 3771 3775
  2928                            7250 7365 7369 7370 7371
  2929                            7272 7373 7374 7376 7377 7378 7379
  2930                            7381 7388 7390 7393 7396 7398
  2931                            9095 9096 9299 9320 9426.
  2932             20  PI-689-FOLLOW-UP-DATE
  2933                                 PIC  X(02).
  2934             20  PI-689-FORM-NUMBER
  2935                                 PIC  X(04).
  2936             20  PI-689-LABEL-SOURCE
  2937                                 PIC X(01).
  2938                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2939                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2940                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2941                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2942                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2943                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2944                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2945             20  PI-689-NUMBER-COPIES
  2946                                 PIC  9(01).
  2947             20  PI-689-NUMBER-LABEL-LINES
  2948                                 PIC  9(01).
  2949             20  PI-689-NUMBER-TEXT-RECORDS
  2950                                 PIC  9(03).
  2951             20  PI-689-PRINT-ORDER-SW
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  56
* EL6311.cbl
  2952                                 PIC  X(01).
  2953                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2954                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2955                 88  PI-689-PRINT-LATER     VALUE '3'.
  2956                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2957             20  PI-689-PRINT-RESTRICTION
  2958                                 PIC  X(01).
  2959                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2960                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2961                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2962             20  PI-689-PRINT-SW PIC  X(01).
  2963                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2964             20  PI-689-RESEND-DATE-1
  2965                                 PIC  X(02).
  2966             20  PI-689-RESEND-LETR-1
  2967                                 PIC X(4).
  2968             20  PI-689-TEMP-STOR-ID
  2969                                 PIC  X(08).
  2970             20  PI-689-USE-SCREEN-IND
  2971                                 PIC  X(01).
  2972                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2973             20  PI-689-ARCH-POINTER
  2974                                 PIC S9(08) COMP.
  2975                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2976             20  PI-689-ARCT-POINTER
  2977                                 PIC S9(08) COMP.
  2978                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2979             20  PI-689-VARIABLE-DATA-GRP.
  2980                 24  PI-689-VARIABLE-DATA-1
  2981                                 PIC  X(30).
  2982                 24  PI-689-VARIABLE-DATA-2
  2983                                 PIC  X(30).
  2984                 24  PI-689-VARIABLE-DATA-3
  2985                                 PIC  X(30).
  2986                 24  PI-689-VARIABLE-DATA-4
  2987                                 PIC  X(30).
  2988
  2989         16  PI-689-KEY-DATA-FIELDS.
  2990             20  PI-689-ACCOUNT  PIC  X(10).
  2991             20  PI-689-CARRIER  PIC  X(01).
  2992             20  PI-689-CERT-NO.
  2993                 24  PI-689-CERT-PRIME
  2994                                 PIC  X(10).
  2995                 24  PI-689-CERT-SFX
  2996                                 PIC  X(01).
  2997             20  PI-689-CHG-SEQ-NO
  2998                                 PIC S9(04)    COMP.
  2999             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  3000                                 PIC  X(02).
  3001             20  PI-689-ENTRY-BATCH
  3002                                 PIC  X(06).
  3003             20  PI-689-EFF-DATE PIC  X(02).
  3004             20  PI-689-EXP-DATE PIC  X(02).
  3005             20  PI-689-GROUPING PIC  X(06).
  3006             20  PI-689-RESP-PERSON
  3007                                 PIC  X(10).
  3008             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  3009             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  57
* EL6311.cbl
  3010                                 PIC  X(04).
  3011             20  PI-689-STATE    PIC  X(02).
  3012             20  PI-689-TYPE     PIC  X(01).
  3013             20  PI-689-CONTROL  PIC S9(08)    COMP.
  3014             20  PI-689-ALT-SEQ-NO
  3015                                 PIC S9(04)    COMP.
  3016         16  PI-689-DATE-EDIT    PIC  X(08).
  3017         16  PI-689-FOLLOW-UP-EDIT
  3018                                 PIC  X(08).
  3019         16  PI-689-RESEND1-EDIT PIC  X(08).
  3020         16  PI-689-SEQ-EDIT     PIC  X(08).
  3021         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  3022         16  PI-689-LBL-OVERRIDE PIC  X(01).
  3023             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  3024         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  3025         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  58
* EL6311.cbl
  3027
  3028 01  WS-EL6315-PASS-AREA.
  3029        16  PI-6315-ISS-CAN-SW      PIC X.
  3030        16  FILLER                  PIC X(120).
  3031        16  PI-RES-REF-CLM-TYPE     PIC X.
  3032        16  FILLER                  PIC X.
  3033        16  PI-6315-PASS-AREA.
  3034            20 FILLER               PIC X(236).
  3035            20 PI-6315-FINALIZED    PIC X.
  3036            20 FILLER               PIC X(280).
  3037
  3038 01  WS-EL6316-PASS-AREA.
  3039        16  PI-ISS-CAN-SW           PIC X.
  3040        16  FILLER                  PIC X(121).
  3041        16  PI-CLM-RESC-IND         PIC X.
  3042        16  PI-6316-PASS-AREA.
  3043            20 FILLER               PIC X(236).
  3044            20 PI-6316-FINALIZED    PIC X.
  3045            20 FILLER               PIC X(280).
  3046
  3047******************************************************************
  3048*                                                                *
  3049*         P A S S   A R E A   F O R   E D I T                    *
  3050*                                                                *
  3051******************************************************************
  3052
  3053 01  PASSED-RECORD.
  3054     12  RECORD-SAVE                  PIC X(585).
  3055* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  3056*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  3057*                    BY  WK-CURRENT-DATE.
  3058******************************************************************
  3059*                                                                *
  3060*                                                                *
  3061*                             ELC50W1                            *
  3062*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3063*                            VMOD=2.004                          *
  3064*                                                                *
  3065*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  3066*                                                                *
  3067*                                                                *
  3068******************************************************************
  3069
  3070     12  WK-WORK-AREA.
  3071         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  3072         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  3073         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  3074         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  3075         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  3076         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  3077         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  3078         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  3079         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  3080         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  3081         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  3082         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  3083         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  3084         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  59
* EL6311.cbl
  3085         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  3086         16  WK-CREDIT-EDIT-CONTROLS.
  3087             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  3088             20  WK-MIN-AGE           PIC 99  VALUE 00.
  3089             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  3090             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  3091             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  3092             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  3093         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  3094         16  WK-SAVE-REIN-DATA.
  3095             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  3096             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  3097             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  3098         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  3099             88  ENTRY-FROM-EL6311       VALUE '6'.
  3100         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  3101         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  3102     12  WK-RECORD-ADDRESSES.
  3103         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3104         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  3105         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  3106         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  3107         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  3108         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  3109         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3110         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3111     12  WK-OVER-SHORT-AREA.
  3112         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3113         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3114         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3115             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3116         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  60
* EL6311.cbl
  3118
  3119*    COPY ELCEDITC.
  3120******************************************************************
  3121*                                                                *
  3122*                                                                *
  3123*                            ELCEDITC                            *
  3124*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3125*                            VMOD=2.012                          *
  3126*                                                                *
  3127*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3128*                     EL6313, EL050 AND EL517.                   *
  3129*                                                                *
  3130******************************************************************
  3131******************************************************************
  3132*                   C H A N G E   L O G
  3133*
  3134* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3135*-----------------------------------------------------------------
  3136*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3137* EFFECTIVE    NUMBER
  3138*-----------------------------------------------------------------
  3139* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3140******************************************************************
  3141
  3142     12  EDIT-CRITERIA-DATA.
  3143         16  EC-CO-MONTH-END-DT       PIC XX.
  3144         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3145         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3146         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3147         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3148         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3149         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3150         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3151         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3152         16  EC-CO-REM-TERM-CALC      PIC X.
  3153               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3154               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3155               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3156               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3157
  3158         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3159               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3160               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3161               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3162               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3163               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3164               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3165               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3166               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3167               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3168               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3169
  3170         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3171               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3172               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3173               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3174               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3175               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  61
* EL6311.cbl
  3176               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3177               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3178               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3179
  3180         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3181                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3182                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3183
  3184         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3185                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3186                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3187                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3188                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3189                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3190                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3191                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3192                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3193
  3194         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3195               88  EC-BR-REDUCING                   VALUE 'R'.
  3196               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3197
  3198         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3199         16  EC-BR-LF-DESC             PIC X(10).
  3200         16  EC-BR-AH-DESC             PIC X(10).
  3201         16  EC-BR-LF-COMMENT          PIC X(10).
  3202         16  EC-BR-AH-COMMENT          PIC X(10).
  3203
  3204         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3205               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3206               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3207               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3208               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3209
  3210         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3211               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3212               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3213               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3214               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3215
  3216         16  EC-BR-LF-REFUND-CALC      PIC X.
  3217                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3218                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3219                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3220                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3221                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3222                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3223                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3224
  3225         16  EC-BR-AH-REFUND-CALC      PIC X.
  3226                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3227                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3228                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3229                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3230                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3231                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3232                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3233                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  62
* EL6311.cbl
  3234
  3235         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3236                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3237                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3238                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3239
  3240         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3241                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3242                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3243                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3244
  3245         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3246         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3247         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3248         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3249
  3250         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3251         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3252                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3253                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3254                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3255                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3256
  3257         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3258               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3259               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3260               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3261               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3262               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3263
  3264         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3265               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3266               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3267               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3268               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3269               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3270
  3271         16  EC-ST-LF-REFUND-CALC      PIC X.
  3272                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3273                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3274                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3275                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3276                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3277                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3278                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3279                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3280
  3281         16  EC-ST-AH-REFUND-CALC      PIC X.
  3282                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3283                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3284                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3285                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3286                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3287                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3288                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3289                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3290
  3291         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  63
* EL6311.cbl
  3292         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3293         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3294         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3295         16  EC-AM-EXPIRATION-DT       PIC XX.
  3296         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3297         16  EC-AM-CLASS-CD            PIC XX.
  3298         16  EC-AM-LF-DEVIATION        PIC XXX.
  3299         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3300         16  EC-AM-AH-DEVIATION        PIC XXX.
  3301         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3302         16  EC-AM-PHONE-NO            PIC X(10).
  3303
  3304         16  EC-AM-LF-REFUND-CALC      PIC X.
  3305                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3306                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3307                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3308                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3309                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3310                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3311                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3312
  3313         16  EC-AM-AH-REFUND-CALC      PIC X.
  3314                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3315                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3316                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3317                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3318                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3319                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3320                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3321
  3322         16  EC-AM-BEN-I-G-CD          PIC X.
  3323                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3324                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3325                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3326
  3327         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3328         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3329         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3330         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3331         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3332         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3333         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3334         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3335         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3336
  3337         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3338         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3339         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3340         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3341         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3342         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3343         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3344         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3345         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3346         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3347         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3348         16  EC-RT-LF-NSP-ST           PIC XX.
  3349         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  64
* EL6311.cbl
  3350         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3351         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3352
  3353         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3354             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3355                                             'M' '5' '9' '2'.
  3356             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3357             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3358             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3359             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3360             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3361             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3362             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3363             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3364             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3365             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3366
  3367         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3368             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3369                                             'M' '5' '9' '2'.
  3370             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3371             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3372             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3373             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3374             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3375             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3376             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3377             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3378             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3379             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3380
  3381         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3382         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3383         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3384         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3385         16  EC-CM-DEATH-DT            PIC XX.
  3386
  3387*DMD CUSTOM CODING FIELDS BELOW
  3388*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3389         16  EC-BR-DMD-RATING-SW       PIC X.
  3390                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3391                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3392                 88  NO-DMD-RATING               VALUE 'N'.
  3393
  3394         16  EC-NEW-CERT               PIC X(11).
  3395         16  EC-NEW-STATE              PIC XX.
  3396         16  FILLER                    PIC X.
  3397*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3398         16  OVER-SHORT-EDIT-FIELDS.
  3399             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3400             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3401             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3402             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3403             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3404             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3405             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3406             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3407             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  65
* EL6311.cbl
  3408         16  FILLER                    PIC X(71).
  3409
  3410******************************************************************
  3411
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  66
* EL6311.cbl
  3413
  3414*    COPY ELCJPFX.
  3415******************************************************************
  3416*                                                                *
  3417*                                                                *
  3418*                            ELCJPFX.                            *
  3419*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3420*                            VMOD=2.002                          *
  3421*                                                                *
  3422*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3423*                                                                *
  3424*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3425*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3426*        ELCNTL - CONTROL FILE                                   *
  3427*        ELMSTR - CLAIM MASTERS                                  *
  3428*        ELTRLR - ACTIVITY TRAILERS                              *
  3429*        ELCHKQ - CHECK QUE                                      *
  3430******************************************************************
  3431 01  JOURNAL-RECORD.
  3432     12  jp-date                     pic s9(5) comp-3.
  3433     12  jp-time                     pic s9(7) comp-3.
  3434     12  JP-USER-ID                  PIC X(4).
  3435     12  JP-FILE-ID                  PIC X(8).
  3436     12  JP-PROGRAM-ID               PIC X(8).
  3437     12  JP-RECORD-TYPE              PIC X.
  3438         88 JP-ADD              VALUE 'A'.
  3439         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3440         88 JP-AFTER-CHANGE     VALUE 'C'.
  3441         88 JP-DELETE           VALUE 'D'.
  3442         88 JP-GENERIC-DELETE   VALUE 'G'.
  3443         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3444         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3445     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3446     12  JP-RECORD-AREA
  3447
  3448
  3449                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  67
* EL6311.cbl
  3451*    COPY ELCAID.
  3452******************************************************************
  3453*                                                                *
  3454*                            ELCAID.                             *
  3455*                            VMOD=2.001                          *
  3456*                                                                *
  3457*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3458*                                                                *
  3459*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3460*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3461******************************************************************
  3462
  3463 01  DFHAID.
  3464   02  DFHNULL   PIC  X  VALUE  ' '.
  3465   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3466   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3467   02  DFHPEN    PIC  X  VALUE  '='.
  3468   02  DFHOPID   PIC  X  VALUE  'W'.
  3469   02  DFHPA1    PIC  X  VALUE  '%'.
  3470   02  DFHPA2    PIC  X  VALUE  '>'.
  3471   02  DFHPA3    PIC  X  VALUE  ','.
  3472   02  DFHPF1    PIC  X  VALUE  '1'.
  3473   02  DFHPF2    PIC  X  VALUE  '2'.
  3474   02  DFHPF3    PIC  X  VALUE  '3'.
  3475   02  DFHPF4    PIC  X  VALUE  '4'.
  3476   02  DFHPF5    PIC  X  VALUE  '5'.
  3477   02  DFHPF6    PIC  X  VALUE  '6'.
  3478   02  DFHPF7    PIC  X  VALUE  '7'.
  3479   02  DFHPF8    PIC  X  VALUE  '8'.
  3480   02  DFHPF9    PIC  X  VALUE  '9'.
  3481   02  DFHPF10   PIC  X  VALUE  ':'.
  3482   02  DFHPF11   PIC  X  VALUE  '#'.
  3483   02  DFHPF12   PIC  X  VALUE  '@'.
  3484   02  DFHPF13   PIC  X  VALUE  'A'.
  3485   02  DFHPF14   PIC  X  VALUE  'B'.
  3486   02  DFHPF15   PIC  X  VALUE  'C'.
  3487   02  DFHPF16   PIC  X  VALUE  'D'.
  3488   02  DFHPF17   PIC  X  VALUE  'E'.
  3489   02  DFHPF18   PIC  X  VALUE  'F'.
  3490   02  DFHPF19   PIC  X  VALUE  'G'.
  3491   02  DFHPF20   PIC  X  VALUE  'H'.
  3492   02  DFHPF21   PIC  X  VALUE  'I'.
  3493*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3494   02  DFHPF22   PIC  X  VALUE  '['.
  3495   02  DFHPF23   PIC  X  VALUE  '.'.
  3496   02  DFHPF24   PIC  X  VALUE  '<'.
  3497   02  DFHMSRE   PIC  X  VALUE  'X'.
  3498   02  DFHSTRF   PIC  X  VALUE  'h'.
  3499   02  DFHTRIG   PIC  X  VALUE  '"'.
  3500
  3501 01  FILLER    REDEFINES DFHAID.
  3502     12  FILLER              PIC X(8).
  3503     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3504
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  68
* EL6311.cbl
  3506*    COPY EL6311S.
  3507 01  EL631BI.
  3508     05  FILLER            PIC  X(0012).
  3509*    -------------------------------
  3510     05  BDATEL PIC S9(0004) COMP.
  3511     05  BDATEF PIC  X(0001).
  3512     05  FILLER REDEFINES BDATEF.
  3513         10  BDATEA PIC  X(0001).
  3514     05  BDATEI PIC  X(0008).
  3515*    -------------------------------
  3516     05  BTIMEL PIC S9(0004) COMP.
  3517     05  BTIMEF PIC  X(0001).
  3518     05  FILLER REDEFINES BTIMEF.
  3519         10  BTIMEA PIC  X(0001).
  3520     05  BTIMEI PIC  X(0005).
  3521*    -------------------------------
  3522     05  BHEADL PIC S9(0004) COMP.
  3523     05  BHEADF PIC  X(0001).
  3524     05  FILLER REDEFINES BHEADF.
  3525         10  BHEADA PIC  X(0001).
  3526     05  BHEADI PIC  X(0038).
  3527*    -------------------------------
  3528     05  BNCERTLL PIC S9(0004) COMP.
  3529     05  BNCERTLF PIC  X(0001).
  3530     05  FILLER REDEFINES BNCERTLF.
  3531         10  BNCERTLA PIC  X(0001).
  3532     05  BNCERTLI PIC  X(0008).
  3533*    -------------------------------
  3534     05  BNCERTL PIC S9(0004) COMP.
  3535     05  BNCERTF PIC  X(0001).
  3536     05  FILLER REDEFINES BNCERTF.
  3537         10  BNCERTA PIC  X(0001).
  3538     05  BNCERTI PIC  X(0011).
  3539*    -------------------------------
  3540     05  BNSTATLL PIC S9(0004) COMP.
  3541     05  BNSTATLF PIC  X(0001).
  3542     05  FILLER REDEFINES BNSTATLF.
  3543         10  BNSTATLA PIC  X(0001).
  3544     05  BNSTATLI PIC  X(0009).
  3545*    -------------------------------
  3546     05  BNSTATL PIC S9(0004) COMP.
  3547     05  BNSTATF PIC  X(0001).
  3548     05  FILLER REDEFINES BNSTATF.
  3549         10  BNSTATA PIC  X(0001).
  3550     05  BNSTATI PIC  X(0002).
  3551*    -------------------------------
  3552     05  BCHGTL PIC S9(0004) COMP.
  3553     05  BCHGTF PIC  X(0001).
  3554     05  FILLER REDEFINES BCHGTF.
  3555         10  BCHGTA PIC  X(0001).
  3556     05  BCHGTI PIC  X(0004).
  3557*    -------------------------------
  3558     05  BCHGL PIC S9(0004) COMP.
  3559     05  BCHGF PIC  X(0001).
  3560     05  FILLER REDEFINES BCHGF.
  3561         10  BCHGA PIC  X(0001).
  3562     05  BCHGI PIC  X(0004).
  3563*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  69
* EL6311.cbl
  3564     05  BCOMPIDL PIC S9(0004) COMP.
  3565     05  BCOMPIDF PIC  X(0001).
  3566     05  FILLER REDEFINES BCOMPIDF.
  3567         10  BCOMPIDA PIC  X(0001).
  3568     05  BCOMPIDI PIC  X(0003).
  3569*    -------------------------------
  3570     05  BREGIONL PIC S9(0004) COMP.
  3571     05  BREGIONF PIC  X(0001).
  3572     05  FILLER REDEFINES BREGIONF.
  3573         10  BREGIONA PIC  X(0001).
  3574     05  BREGIONI PIC  X(0006).
  3575*    -------------------------------
  3576     05  BUSERL PIC S9(0004) COMP.
  3577     05  BUSERF PIC  X(0001).
  3578     05  FILLER REDEFINES BUSERF.
  3579         10  BUSERA PIC  X(0001).
  3580     05  BUSERI PIC  X(0004).
  3581*    -------------------------------
  3582     05  BMAINTL PIC S9(0004) COMP.
  3583     05  BMAINTF PIC  X(0001).
  3584     05  FILLER REDEFINES BMAINTF.
  3585         10  BMAINTA PIC  X(0001).
  3586     05  BMAINTI PIC  X(0001).
  3587*    -------------------------------
  3588     05  BMANTBYL PIC S9(0004) COMP.
  3589     05  BMANTBYF PIC  X(0001).
  3590     05  FILLER REDEFINES BMANTBYF.
  3591         10  BMANTBYA PIC  X(0001).
  3592     05  BMANTBYI PIC  X(0004).
  3593*    -------------------------------
  3594     05  BCHGHDGL PIC S9(0004) COMP.
  3595     05  BCHGHDGF PIC  X(0001).
  3596     05  FILLER REDEFINES BCHGHDGF.
  3597         10  BCHGHDGA PIC  X(0001).
  3598     05  BCHGHDGI PIC  X(0003).
  3599*    -------------------------------
  3600     05  BMANTDTL PIC S9(0004) COMP.
  3601     05  BMANTDTF PIC  X(0001).
  3602     05  FILLER REDEFINES BMANTDTF.
  3603         10  BMANTDTA PIC  X(0001).
  3604     05  BMANTDTI PIC  X(0008).
  3605*    -------------------------------
  3606     05  BMANTATL PIC S9(0004) COMP.
  3607     05  BMANTATF PIC  X(0001).
  3608     05  FILLER REDEFINES BMANTATF.
  3609         10  BMANTATA PIC  X(0001).
  3610     05  BMANTATI PIC  X(0005).
  3611*    -------------------------------
  3612     05  BCSRL PIC S9(0004) COMP.
  3613     05  BCSRF PIC  X(0001).
  3614     05  FILLER REDEFINES BCSRF.
  3615         10  BCSRA PIC  X(0001).
  3616     05  BCSRI PIC  X(0004).
  3617*    -------------------------------
  3618     05  BBATCHL PIC S9(0004) COMP.
  3619     05  BBATCHF PIC  X(0001).
  3620     05  FILLER REDEFINES BBATCHF.
  3621         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  70
* EL6311.cbl
  3622     05  BBATCHI PIC  X(0006).
  3623*    -------------------------------
  3624     05  BSEQL PIC S9(0004) COMP.
  3625     05  BSEQF PIC  X(0001).
  3626     05  FILLER REDEFINES BSEQF.
  3627         10  BSEQA PIC  X(0001).
  3628     05  BSEQI PIC  X(0004).
  3629*    -------------------------------
  3630     05  BMOENDTL PIC S9(0004) COMP.
  3631     05  BMOENDTF PIC  X(0001).
  3632     05  FILLER REDEFINES BMOENDTF.
  3633         10  BMOENDTA PIC  X(0001).
  3634     05  BMOENDTI PIC  X(0008).
  3635*    -------------------------------
  3636     05  BCARRL PIC S9(0004) COMP.
  3637     05  BCARRF PIC  X(0001).
  3638     05  FILLER REDEFINES BCARRF.
  3639         10  BCARRA PIC  X(0001).
  3640     05  BCARRI PIC  X(0001).
  3641*    -------------------------------
  3642     05  BGROUPL PIC S9(0004) COMP.
  3643     05  BGROUPF PIC  X(0001).
  3644     05  FILLER REDEFINES BGROUPF.
  3645         10  BGROUPA PIC  X(0001).
  3646     05  BGROUPI PIC  X(0006).
  3647*    -------------------------------
  3648     05  BSTATEL PIC S9(0004) COMP.
  3649     05  BSTATEF PIC  X(0001).
  3650     05  FILLER REDEFINES BSTATEF.
  3651         10  BSTATEA PIC  X(0001).
  3652     05  BSTATEI PIC  X(0002).
  3653*    -------------------------------
  3654     05  BACCTL PIC S9(0004) COMP.
  3655     05  BACCTF PIC  X(0001).
  3656     05  FILLER REDEFINES BACCTF.
  3657         10  BACCTA PIC  X(0001).
  3658     05  BACCTI PIC  X(0010).
  3659*    -------------------------------
  3660     05  BVINHL PIC S9(0004) COMP.
  3661     05  BVINHF PIC  X(0001).
  3662     05  FILLER REDEFINES BVINHF.
  3663         10  BVINHA PIC  X(0001).
  3664     05  BVINHI PIC  X(0004).
  3665*    -------------------------------
  3666     05  BVINL PIC S9(0004) COMP.
  3667     05  BVINF PIC  X(0001).
  3668     05  FILLER REDEFINES BVINF.
  3669         10  BVINA PIC  X(0001).
  3670     05  BVINI PIC  X(0017).
  3671*    -------------------------------
  3672     05  BREFHDGL PIC S9(0004) COMP.
  3673     05  BREFHDGF PIC  X(0001).
  3674     05  FILLER REDEFINES BREFHDGF.
  3675         10  BREFHDGA PIC  X(0001).
  3676     05  BREFHDGI PIC  X(0004).
  3677*    -------------------------------
  3678     05  BREFL PIC S9(0004) COMP.
  3679     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  71
* EL6311.cbl
  3680     05  FILLER REDEFINES BREFF.
  3681         10  BREFA PIC  X(0001).
  3682     05  BREFI PIC  X(0012).
  3683*    -------------------------------
  3684     05  LETRREQL PIC S9(0004) COMP.
  3685     05  LETRREQF PIC  X(0001).
  3686     05  FILLER REDEFINES LETRREQF.
  3687         10  LETRREQA PIC  X(0001).
  3688     05  LETRREQI PIC  X(0001).
  3689*    -------------------------------
  3690     05  BAGEDEFL PIC S9(0004) COMP.
  3691     05  BAGEDEFF PIC  X(0001).
  3692     05  FILLER REDEFINES BAGEDEFF.
  3693         10  BAGEDEFA PIC  X(0001).
  3694     05  BAGEDEFI PIC  X(0004).
  3695*    -------------------------------
  3696     05  BCERTNOL PIC S9(0004) COMP.
  3697     05  BCERTNOF PIC  X(0001).
  3698     05  FILLER REDEFINES BCERTNOF.
  3699         10  BCERTNOA PIC  X(0001).
  3700     05  BCERTNOI PIC  X(0010).
  3701*    -------------------------------
  3702     05  BSUFIXL PIC S9(0004) COMP.
  3703     05  BSUFIXF PIC  X(0001).
  3704     05  FILLER REDEFINES BSUFIXF.
  3705         10  BSUFIXA PIC  X(0001).
  3706     05  BSUFIXI PIC  X(0001).
  3707*    -------------------------------
  3708     05  BEFFDTL PIC S9(0004) COMP.
  3709     05  BEFFDTF PIC  X(0001).
  3710     05  FILLER REDEFINES BEFFDTF.
  3711         10  BEFFDTA PIC  X(0001).
  3712     05  BEFFDTI PIC  X(0008).
  3713*    -------------------------------
  3714     05  BLSTNML PIC S9(0004) COMP.
  3715     05  BLSTNMF PIC  X(0001).
  3716     05  FILLER REDEFINES BLSTNMF.
  3717         10  BLSTNMA PIC  X(0001).
  3718     05  BLSTNMI PIC  X(0015).
  3719*    -------------------------------
  3720     05  B1STNML PIC S9(0004) COMP.
  3721     05  B1STNMF PIC  X(0001).
  3722     05  FILLER REDEFINES B1STNMF.
  3723         10  B1STNMA PIC  X(0001).
  3724     05  B1STNMI PIC  X(0010).
  3725*    -------------------------------
  3726     05  BINITL PIC S9(0004) COMP.
  3727     05  BINITF PIC  X(0001).
  3728     05  FILLER REDEFINES BINITF.
  3729         10  BINITA PIC  X(0001).
  3730     05  BINITI PIC  X(0001).
  3731*    -------------------------------
  3732     05  BSEXL PIC S9(0004) COMP.
  3733     05  BSEXF PIC  X(0001).
  3734     05  FILLER REDEFINES BSEXF.
  3735         10  BSEXA PIC  X(0001).
  3736     05  BSEXI PIC  X(0001).
  3737*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  72
* EL6311.cbl
  3738     05  BAGEL PIC S9(0004) COMP.
  3739     05  BAGEF PIC  X(0001).
  3740     05  FILLER REDEFINES BAGEF.
  3741         10  BAGEA PIC  X(0001).
  3742     05  BAGEI PIC  X(0002).
  3743*    -------------------------------
  3744     05  BBIRTHL PIC S9(0004) COMP.
  3745     05  BBIRTHF PIC  X(0001).
  3746     05  FILLER REDEFINES BBIRTHF.
  3747         10  BBIRTHA PIC  X(0001).
  3748     05  BBIRTHI PIC  X(0008).
  3749*    -------------------------------
  3750     05  B1STPMTL PIC S9(0004) COMP.
  3751     05  B1STPMTF PIC  X(0001).
  3752     05  FILLER REDEFINES B1STPMTF.
  3753         10  B1STPMTA PIC  X(0001).
  3754     05  B1STPMTI PIC  X(0008).
  3755*    -------------------------------
  3756     05  BDAYSL PIC S9(0004) COMP.
  3757     05  BDAYSF PIC  X(0001).
  3758     05  FILLER REDEFINES BDAYSF.
  3759         10  BDAYSA PIC  X(0001).
  3760     05  BDAYSI PIC  X(0003).
  3761*    -------------------------------
  3762     05  BLNTRML PIC S9(0004) COMP.
  3763     05  BLNTRMF PIC  X(0001).
  3764     05  FILLER REDEFINES BLNTRMF.
  3765         10  BLNTRMA PIC  X(0001).
  3766     05  BLNTRMI PIC  X(0003).
  3767*    -------------------------------
  3768     05  BLNOFCRL PIC S9(0004) COMP.
  3769     05  BLNOFCRF PIC  X(0001).
  3770     05  FILLER REDEFINES BLNOFCRF.
  3771         10  BLNOFCRA PIC  X(0001).
  3772     05  BLNOFCRI PIC  X(0005).
  3773*    -------------------------------
  3774     05  BMODEL PIC S9(0004) COMP.
  3775     05  BMODEF PIC  X(0001).
  3776     05  FILLER REDEFINES BMODEF.
  3777         10  BMODEA PIC  X(0001).
  3778     05  BMODEI PIC  X(0001).
  3779*    -------------------------------
  3780     05  BFREQL PIC S9(0004) COMP.
  3781     05  BFREQF PIC  X(0001).
  3782     05  FILLER REDEFINES BFREQF.
  3783         10  BFREQA PIC  X(0001).
  3784     05  BFREQI PIC  X(0002).
  3785*    -------------------------------
  3786     05  BPMTSL PIC S9(0004) COMP.
  3787     05  BPMTSF PIC  X(0001).
  3788     05  FILLER REDEFINES BPMTSF.
  3789         10  BPMTSA PIC  X(0001).
  3790     05  BPMTSI PIC  999.
  3791*    -------------------------------
  3792     05  BPMTAMTL PIC S9(0004) COMP.
  3793     05  BPMTAMTF PIC  X(0001).
  3794     05  FILLER REDEFINES BPMTAMTF.
  3795         10  BPMTAMTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  73
* EL6311.cbl
  3796     05  BPMTAMTI PIC  9(7)V99.
  3797*    -------------------------------
  3798     05  BAPRL PIC S9(0004) COMP.
  3799     05  BAPRF PIC  X(0001).
  3800     05  FILLER REDEFINES BAPRF.
  3801         10  BAPRA PIC  X(0001).
  3802     05  BAPRI PIC  X(7).
  3803*    -------------------------------
  3804     05  BLIVESL PIC S9(0004) COMP.
  3805     05  BLIVESF PIC  X(0001).
  3806     05  FILLER REDEFINES BLIVESF.
  3807         10  BLIVESA PIC  X(0001).
  3808     05  BLIVESI PIC  X(0009).
  3809*    -------------------------------
  3810     05  BMEMCAPL PIC S9(0004) COMP.
  3811     05  BMEMCAPF PIC  X(0001).
  3812     05  FILLER REDEFINES BMEMCAPF.
  3813         10  BMEMCAPA PIC  X(0001).
  3814     05  BMEMCAPI PIC  X(0011).
  3815*    -------------------------------
  3816     05  BORIGHDL PIC S9(0004) COMP.
  3817     05  BORIGHDF PIC  X(0001).
  3818     05  FILLER REDEFINES BORIGHDF.
  3819         10  BORIGHDA PIC  X(0001).
  3820     05  BORIGHDI PIC  X(0009).
  3821*    -------------------------------
  3822     05  DMDBILL PIC S9(0004) COMP.
  3823     05  DMDBILF PIC  X(0001).
  3824     05  FILLER REDEFINES DMDBILF.
  3825         10  DMDBILA PIC  X(0001).
  3826     05  DMDBILI PIC  X(0006).
  3827*    -------------------------------
  3828     05  BFORCEL PIC S9(0004) COMP.
  3829     05  BFORCEF PIC  X(0001).
  3830     05  FILLER REDEFINES BFORCEF.
  3831         10  BFORCEA PIC  X(0001).
  3832     05  BFORCEI PIC  X(0001).
  3833*    -------------------------------
  3834     05  BENTRYL PIC S9(0004) COMP.
  3835     05  BENTRYF PIC  X(0001).
  3836     05  FILLER REDEFINES BENTRYF.
  3837         10  BENTRYA PIC  X(0001).
  3838     05  BENTRYI PIC  X(0001).
  3839*    -------------------------------
  3840     05  BREINL PIC S9(0004) COMP.
  3841     05  BREINF PIC  X(0001).
  3842     05  FILLER REDEFINES BREINF.
  3843         10  BREINA PIC  X(0001).
  3844     05  BREINI PIC  X(0001).
  3845*    -------------------------------
  3846     05  BBILCDL PIC S9(0004) COMP.
  3847     05  BBILCDF PIC  X(0001).
  3848     05  FILLER REDEFINES BBILCDF.
  3849         10  BBILCDA PIC  X(0001).
  3850     05  BBILCDI PIC  X(0001).
  3851*    -------------------------------
  3852     05  BUNWRITL PIC S9(0004) COMP.
  3853     05  BUNWRITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  74
* EL6311.cbl
  3854     05  FILLER REDEFINES BUNWRITF.
  3855         10  BUNWRITA PIC  X(0001).
  3856     05  BUNWRITI PIC  X(0001).
  3857*    -------------------------------
  3858     05  BSKPCDL PIC S9(0004) COMP.
  3859     05  BSKPCDF PIC  X(0001).
  3860     05  FILLER REDEFINES BSKPCDF.
  3861         10  BSKPCDA PIC  X(0001).
  3862     05  BSKPCDI PIC  X(0001).
  3863*    -------------------------------
  3864     05  BINDGRPL PIC S9(0004) COMP.
  3865     05  BINDGRPF PIC  X(0001).
  3866     05  FILLER REDEFINES BINDGRPF.
  3867         10  BINDGRPA PIC  X(0001).
  3868     05  BINDGRPI PIC  X(0001).
  3869*    -------------------------------
  3870     05  BSIGL PIC S9(0004) COMP.
  3871     05  BSIGF PIC  X(0001).
  3872     05  FILLER REDEFINES BSIGF.
  3873         10  BSIGA PIC  X(0001).
  3874     05  BSIGI PIC  X(0001).
  3875*    -------------------------------
  3876     05  BRTCLSL PIC S9(0004) COMP.
  3877     05  BRTCLSF PIC  X(0001).
  3878     05  FILLER REDEFINES BRTCLSF.
  3879         10  BRTCLSA PIC  X(0001).
  3880     05  BRTCLSI PIC  X(0002).
  3881*    -------------------------------
  3882     05  BCHGCNTL PIC S9(0004) COMP.
  3883     05  BCHGCNTF PIC  X(0001).
  3884     05  FILLER REDEFINES BCHGCNTF.
  3885         10  BCHGCNTA PIC  X(0001).
  3886     05  BCHGCNTI PIC  X(0003).
  3887*    -------------------------------
  3888     05  BMEMBERL PIC S9(0004) COMP.
  3889     05  BMEMBERF PIC  X(0001).
  3890     05  FILLER REDEFINES BMEMBERF.
  3891         10  BMEMBERA PIC  X(0001).
  3892     05  BMEMBERI PIC  X(0012).
  3893*    -------------------------------
  3894     05  BORGNOL PIC S9(0004) COMP.
  3895     05  BORGNOF PIC  X(0001).
  3896     05  FILLER REDEFINES BORGNOF.
  3897         10  BORGNOA PIC  X(0001).
  3898     05  BORGNOI PIC  X(0006).
  3899*    -------------------------------
  3900     05  BORGSEQL PIC S9(0004) COMP.
  3901     05  BORGSEQF PIC  X(0001).
  3902     05  FILLER REDEFINES BORGSEQF.
  3903         10  BORGSEQA PIC  X(0001).
  3904     05  BORGSEQI PIC  X(0004).
  3905*    -------------------------------
  3906     05  BBILLEDL PIC S9(0004) COMP.
  3907     05  BBILLEDF PIC  X(0001).
  3908     05  FILLER REDEFINES BBILLEDF.
  3909         10  BBILLEDA PIC  X(0001).
  3910     05  BBILLEDI PIC  9(9).
  3911*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  75
* EL6311.cbl
  3912     05  BKIND1L PIC S9(0004) COMP.
  3913     05  BKIND1F PIC  X(0001).
  3914     05  FILLER REDEFINES BKIND1F.
  3915         10  BKIND1A PIC  X(0001).
  3916     05  BKIND1I PIC  X(0002).
  3917*    -------------------------------
  3918     05  BTYPE1L PIC S9(0004) COMP.
  3919     05  BTYPE1F PIC  X(0001).
  3920     05  FILLER REDEFINES BTYPE1F.
  3921         10  BTYPE1A PIC  X(0001).
  3922     05  BTYPE1I PIC  X(0003).
  3923*    -------------------------------
  3924     05  BTERM1L PIC S9(0004) COMP.
  3925     05  BTERM1F PIC  X(0001).
  3926     05  FILLER REDEFINES BTERM1F.
  3927         10  BTERM1A PIC  X(0001).
  3928     05  BTERM1I PIC  X(0003).
  3929*    -------------------------------
  3930     05  BBEN1L PIC S9(0004) COMP.
  3931     05  BBEN1F PIC  X(0001).
  3932     05  FILLER REDEFINES BBEN1F.
  3933         10  BBEN1A PIC  X(0001).
  3934     05  BBEN1I PIC  X(0012).
  3935*    -------------------------------
  3936     05  BPREM1L PIC S9(0004) COMP.
  3937     05  BPREM1F PIC  X(0001).
  3938     05  FILLER REDEFINES BPREM1F.
  3939         10  BPREM1A PIC  X(0001).
  3940     05  BPREM1I PIC  X(0011).
  3941*    -------------------------------
  3942     05  BEXPIR1L PIC S9(0004) COMP.
  3943     05  BEXPIR1F PIC  X(0001).
  3944     05  FILLER REDEFINES BEXPIR1F.
  3945         10  BEXPIR1A PIC  X(0001).
  3946     05  BEXPIR1I PIC  X(0008).
  3947*    -------------------------------
  3948     05  BCP1L PIC S9(0004) COMP.
  3949     05  BCP1F PIC  X(0001).
  3950     05  FILLER REDEFINES BCP1F.
  3951         10  BCP1A PIC  X(0001).
  3952     05  BCP1I PIC  X(0002).
  3953*    -------------------------------
  3954     05  BALTBN1L PIC S9(0004) COMP.
  3955     05  BALTBN1F PIC  X(0001).
  3956     05  FILLER REDEFINES BALTBN1F.
  3957         10  BALTBN1A PIC  X(0001).
  3958     05  BALTBN1I PIC  X(0012).
  3959*    -------------------------------
  3960     05  BALTPR1L PIC S9(0004) COMP.
  3961     05  BALTPR1F PIC  X(0001).
  3962     05  FILLER REDEFINES BALTPR1F.
  3963         10  BALTPR1A PIC  X(0001).
  3964     05  BALTPR1I PIC  X(0011).
  3965*    -------------------------------
  3966     05  BBNCD1L PIC S9(0004) COMP.
  3967     05  BBNCD1F PIC  X(0001).
  3968     05  FILLER REDEFINES BBNCD1F.
  3969         10  BBNCD1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  76
* EL6311.cbl
  3970     05  BBNCD1I PIC  X(0003).
  3971*    -------------------------------
  3972     05  BCPRM1L PIC S9(0004) COMP.
  3973     05  BCPRM1F PIC  X(0001).
  3974     05  FILLER REDEFINES BCPRM1F.
  3975         10  BCPRM1A PIC  X(0001).
  3976     05  BCPRM1I PIC  X(0011).
  3977*    -------------------------------
  3978     05  BCAPRM1L PIC S9(0004) COMP.
  3979     05  BCAPRM1F PIC  X(0001).
  3980     05  FILLER REDEFINES BCAPRM1F.
  3981         10  BCAPRM1A PIC  X(0001).
  3982     05  BCAPRM1I PIC  X(0011).
  3983*    -------------------------------
  3984     05  BENABR1L PIC S9(0004) COMP.
  3985     05  BENABR1F PIC  X(0001).
  3986     05  FILLER REDEFINES BENABR1F.
  3987         10  BENABR1A PIC  X(0001).
  3988     05  BENABR1I PIC  X(0005).
  3989*    -------------------------------
  3990     05  BDIFF1L PIC S9(0004) COMP.
  3991     05  BDIFF1F PIC  X(0001).
  3992     05  FILLER REDEFINES BDIFF1F.
  3993         10  BDIFF1A PIC  X(0001).
  3994     05  BDIFF1I PIC  X(0011).
  3995*    -------------------------------
  3996     05  BBILIT1L PIC S9(0004) COMP.
  3997     05  BBILIT1F PIC  X(0001).
  3998     05  FILLER REDEFINES BBILIT1F.
  3999         10  BBILIT1A PIC  X(0001).
  4000     05  BBILIT1I PIC  X(0008).
  4001*    -------------------------------
  4002     05  BADIFF1L PIC S9(0004) COMP.
  4003     05  BADIFF1F PIC  X(0001).
  4004     05  FILLER REDEFINES BADIFF1F.
  4005         10  BADIFF1A PIC  X(0001).
  4006     05  BADIFF1I PIC  X(0011).
  4007*    -------------------------------
  4008     05  BKIND2L PIC S9(0004) COMP.
  4009     05  BKIND2F PIC  X(0001).
  4010     05  FILLER REDEFINES BKIND2F.
  4011         10  BKIND2A PIC  X(0001).
  4012     05  BKIND2I PIC  X(0002).
  4013*    -------------------------------
  4014     05  BTYPE2L PIC S9(0004) COMP.
  4015     05  BTYPE2F PIC  X(0001).
  4016     05  FILLER REDEFINES BTYPE2F.
  4017         10  BTYPE2A PIC  X(0001).
  4018     05  BTYPE2I PIC  X(0003).
  4019*    -------------------------------
  4020     05  BTERM2L PIC S9(0004) COMP.
  4021     05  BTERM2F PIC  X(0001).
  4022     05  FILLER REDEFINES BTERM2F.
  4023         10  BTERM2A PIC  X(0001).
  4024     05  BTERM2I PIC  X(0003).
  4025*    -------------------------------
  4026     05  BBEN2L PIC S9(0004) COMP.
  4027     05  BBEN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  77
* EL6311.cbl
  4028     05  FILLER REDEFINES BBEN2F.
  4029         10  BBEN2A PIC  X(0001).
  4030     05  BBEN2I PIC  X(0012).
  4031*    -------------------------------
  4032     05  BPREM2L PIC S9(0004) COMP.
  4033     05  BPREM2F PIC  X(0001).
  4034     05  FILLER REDEFINES BPREM2F.
  4035         10  BPREM2A PIC  X(0001).
  4036     05  BPREM2I PIC  X(0011).
  4037*    -------------------------------
  4038     05  BEXPIR2L PIC S9(0004) COMP.
  4039     05  BEXPIR2F PIC  X(0001).
  4040     05  FILLER REDEFINES BEXPIR2F.
  4041         10  BEXPIR2A PIC  X(0001).
  4042     05  BEXPIR2I PIC  X(0008).
  4043*    -------------------------------
  4044     05  BCP2L PIC S9(0004) COMP.
  4045     05  BCP2F PIC  X(0001).
  4046     05  FILLER REDEFINES BCP2F.
  4047         10  BCP2A PIC  X(0001).
  4048     05  BCP2I PIC  X(0002).
  4049*    -------------------------------
  4050     05  BALTBN2L PIC S9(0004) COMP.
  4051     05  BALTBN2F PIC  X(0001).
  4052     05  FILLER REDEFINES BALTBN2F.
  4053         10  BALTBN2A PIC  X(0001).
  4054     05  BALTBN2I PIC  X(0012).
  4055*    -------------------------------
  4056     05  BALTPR2L PIC S9(0004) COMP.
  4057     05  BALTPR2F PIC  X(0001).
  4058     05  FILLER REDEFINES BALTPR2F.
  4059         10  BALTPR2A PIC  X(0001).
  4060     05  BALTPR2I PIC  X(0011).
  4061*    -------------------------------
  4062     05  BBNCD2L PIC S9(0004) COMP.
  4063     05  BBNCD2F PIC  X(0001).
  4064     05  FILLER REDEFINES BBNCD2F.
  4065         10  BBNCD2A PIC  X(0001).
  4066     05  BBNCD2I PIC  X(0003).
  4067*    -------------------------------
  4068     05  BCPRM2L PIC S9(0004) COMP.
  4069     05  BCPRM2F PIC  X(0001).
  4070     05  FILLER REDEFINES BCPRM2F.
  4071         10  BCPRM2A PIC  X(0001).
  4072     05  BCPRM2I PIC  X(0011).
  4073*    -------------------------------
  4074     05  BCAPRM2L PIC S9(0004) COMP.
  4075     05  BCAPRM2F PIC  X(0001).
  4076     05  FILLER REDEFINES BCAPRM2F.
  4077         10  BCAPRM2A PIC  X(0001).
  4078     05  BCAPRM2I PIC  X(0011).
  4079*    -------------------------------
  4080     05  BENABR2L PIC S9(0004) COMP.
  4081     05  BENABR2F PIC  X(0001).
  4082     05  FILLER REDEFINES BENABR2F.
  4083         10  BENABR2A PIC  X(0001).
  4084     05  BENABR2I PIC  X(0005).
  4085*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  78
* EL6311.cbl
  4086     05  BDIFF2L PIC S9(0004) COMP.
  4087     05  BDIFF2F PIC  X(0001).
  4088     05  FILLER REDEFINES BDIFF2F.
  4089         10  BDIFF2A PIC  X(0001).
  4090     05  BDIFF2I PIC  X(0011).
  4091*    -------------------------------
  4092     05  BBILIT2L PIC S9(0004) COMP.
  4093     05  BBILIT2F PIC  X(0001).
  4094     05  FILLER REDEFINES BBILIT2F.
  4095         10  BBILIT2A PIC  X(0001).
  4096     05  BBILIT2I PIC  X(0008).
  4097*    -------------------------------
  4098     05  BADIFF2L PIC S9(0004) COMP.
  4099     05  BADIFF2F PIC  X(0001).
  4100     05  FILLER REDEFINES BADIFF2F.
  4101         10  BADIFF2A PIC  X(0001).
  4102     05  BADIFF2I PIC  X(0011).
  4103*    -------------------------------
  4104     05  BERMSG1L PIC S9(0004) COMP.
  4105     05  BERMSG1F PIC  X(0001).
  4106     05  FILLER REDEFINES BERMSG1F.
  4107         10  BERMSG1A PIC  X(0001).
  4108     05  BERMSG1I PIC  X(0078).
  4109*    -------------------------------
  4110     05  BERMSG2L PIC S9(0004) COMP.
  4111     05  BERMSG2F PIC  X(0001).
  4112     05  FILLER REDEFINES BERMSG2F.
  4113         10  BERMSG2A PIC  X(0001).
  4114     05  BERMSG2I PIC  X(0078).
  4115*    -------------------------------
  4116     05  BERMSG3L PIC S9(0004) COMP.
  4117     05  BERMSG3F PIC  X(0001).
  4118     05  FILLER REDEFINES BERMSG3F.
  4119         10  BERMSG3A PIC  X(0001).
  4120     05  BERMSG3I PIC  X(0078).
  4121*    -------------------------------
  4122     05  BPFENTRL PIC S9(0004) COMP.
  4123     05  BPFENTRF PIC  X(0001).
  4124     05  FILLER REDEFINES BPFENTRF.
  4125         10  BPFENTRA PIC  X(0001).
  4126     05  BPFENTRI PIC  9(2).
  4127*    -------------------------------
  4128     05  BPF5HDRL PIC S9(0004) COMP.
  4129     05  BPF5HDRF PIC  X(0001).
  4130     05  FILLER REDEFINES BPF5HDRF.
  4131         10  BPF5HDRA PIC  X(0001).
  4132     05  BPF5HDRI PIC  X(0005).
  4133*    -------------------------------
  4134     05  BPF4HDRL PIC S9(0004) COMP.
  4135     05  BPF4HDRF PIC  X(0001).
  4136     05  FILLER REDEFINES BPF4HDRF.
  4137         10  BPF4HDRA PIC  X(0001).
  4138     05  BPF4HDRI PIC  X(0013).
  4139*    -------------------------------
  4140     05  BF15HDRL PIC S9(0004) COMP.
  4141     05  BF15HDRF PIC  X(0001).
  4142     05  FILLER REDEFINES BF15HDRF.
  4143         10  BF15HDRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  79
* EL6311.cbl
  4144     05  BF15HDRI PIC  X(0010).
  4145 01  EL631BO REDEFINES EL631BI.
  4146     05  FILLER            PIC  X(0012).
  4147*    -------------------------------
  4148     05  FILLER            PIC  X(0003).
  4149     05  BDATEO PIC  X(0008).
  4150*    -------------------------------
  4151     05  FILLER            PIC  X(0003).
  4152     05  BTIMEO PIC  99.99.
  4153*    -------------------------------
  4154     05  FILLER            PIC  X(0003).
  4155     05  BHEADO PIC  X(0038).
  4156*    -------------------------------
  4157     05  FILLER            PIC  X(0003).
  4158     05  BNCERTLO PIC  X(0008).
  4159*    -------------------------------
  4160     05  FILLER            PIC  X(0003).
  4161     05  BNCERTO PIC  X(0011).
  4162*    -------------------------------
  4163     05  FILLER            PIC  X(0003).
  4164     05  BNSTATLO PIC  X(0009).
  4165*    -------------------------------
  4166     05  FILLER            PIC  X(0003).
  4167     05  BNSTATO PIC  X(0002).
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  BCHGTO PIC  X(0004).
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  BCHGO PIC  ZZZ9.
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  BCOMPIDO PIC  X(0003).
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  BREGIONO PIC  X(0006).
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  BUSERO PIC  X(0004).
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  BMAINTO PIC  X(0001).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  BMANTBYO PIC  X(0004).
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  BCHGHDGO PIC  X(0003).
  4192*    -------------------------------
  4193     05  FILLER            PIC  X(0003).
  4194     05  BMANTDTO PIC  X(0008).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  BMANTATO PIC  99.99.
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  BCSRO PIC  X(0004).
  4201*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  80
* EL6311.cbl
  4202     05  FILLER            PIC  X(0003).
  4203     05  BBATCHO PIC  X(0006).
  4204*    -------------------------------
  4205     05  FILLER            PIC  X(0003).
  4206     05  BSEQO PIC  X(0004).
  4207*    -------------------------------
  4208     05  FILLER            PIC  X(0003).
  4209     05  BMOENDTO PIC  X(0008).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  BCARRO PIC  X(0001).
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  BGROUPO PIC  X(0006).
  4216*    -------------------------------
  4217     05  FILLER            PIC  X(0003).
  4218     05  BSTATEO PIC  X(0002).
  4219*    -------------------------------
  4220     05  FILLER            PIC  X(0003).
  4221     05  BACCTO PIC  X(0010).
  4222*    -------------------------------
  4223     05  FILLER            PIC  X(0003).
  4224     05  BVINHO PIC  X(0004).
  4225*    -------------------------------
  4226     05  FILLER            PIC  X(0003).
  4227     05  BVINO PIC  X(0017).
  4228*    -------------------------------
  4229     05  FILLER            PIC  X(0003).
  4230     05  BREFHDGO PIC  X(0004).
  4231*    -------------------------------
  4232     05  FILLER            PIC  X(0003).
  4233     05  BREFO PIC  X(0012).
  4234*    -------------------------------
  4235     05  FILLER            PIC  X(0003).
  4236     05  LETRREQO PIC  X(0001).
  4237*    -------------------------------
  4238     05  FILLER            PIC  X(0003).
  4239     05  BAGEDEFO PIC  X(0004).
  4240*    -------------------------------
  4241     05  FILLER            PIC  X(0003).
  4242     05  BCERTNOO PIC  X(0010).
  4243*    -------------------------------
  4244     05  FILLER            PIC  X(0003).
  4245     05  BSUFIXO PIC  X(0001).
  4246*    -------------------------------
  4247     05  FILLER            PIC  X(0003).
  4248     05  BEFFDTO PIC  X(0008).
  4249*    -------------------------------
  4250     05  FILLER            PIC  X(0003).
  4251     05  BLSTNMO PIC  X(0015).
  4252*    -------------------------------
  4253     05  FILLER            PIC  X(0003).
  4254     05  B1STNMO PIC  X(0010).
  4255*    -------------------------------
  4256     05  FILLER            PIC  X(0003).
  4257     05  BINITO PIC  X(0001).
  4258*    -------------------------------
  4259     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  81
* EL6311.cbl
  4260     05  BSEXO PIC  X(0001).
  4261*    -------------------------------
  4262     05  FILLER            PIC  X(0003).
  4263     05  BAGEO PIC  X(0002).
  4264*    -------------------------------
  4265     05  FILLER            PIC  X(0003).
  4266     05  BBIRTHO PIC  X(0008).
  4267*    -------------------------------
  4268     05  FILLER            PIC  X(0003).
  4269     05  B1STPMTO PIC  X(0008).
  4270*    -------------------------------
  4271     05  FILLER            PIC  X(0003).
  4272     05  BDAYSO PIC  X(0003).
  4273*    -------------------------------
  4274     05  FILLER            PIC  X(0003).
  4275     05  BLNTRMO PIC  X(0003).
  4276*    -------------------------------
  4277     05  FILLER            PIC  X(0003).
  4278     05  BLNOFCRO PIC  X(0005).
  4279*    -------------------------------
  4280     05  FILLER            PIC  X(0003).
  4281     05  BMODEO PIC  X(0001).
  4282*    -------------------------------
  4283     05  FILLER            PIC  X(0003).
  4284     05  BFREQO PIC  X(0002).
  4285*    -------------------------------
  4286     05  FILLER            PIC  X(0003).
  4287     05  BPMTSO PIC  X(0003).
  4288*    -------------------------------
  4289     05  FILLER            PIC  X(0003).
  4290     05  BPMTAMTO PIC  ZZZZZ9.99.
  4291*    -------------------------------
  4292     05  FILLER            PIC  X(0003).
  4293     05  BAPRO PIC  99.9999.
  4294*    -------------------------------
  4295     05  FILLER            PIC  X(0003).
  4296     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4297*    -------------------------------
  4298     05  FILLER            PIC  X(0003).
  4299     05  BMEMCAPO PIC  X(0011).
  4300*    -------------------------------
  4301     05  FILLER            PIC  X(0003).
  4302     05  BORIGHDO PIC  X(0009).
  4303*    -------------------------------
  4304     05  FILLER            PIC  X(0003).
  4305     05  DMDBILO PIC  X(0006).
  4306*    -------------------------------
  4307     05  FILLER            PIC  X(0003).
  4308     05  BFORCEO PIC  X(0001).
  4309*    -------------------------------
  4310     05  FILLER            PIC  X(0003).
  4311     05  BENTRYO PIC  X(0001).
  4312*    -------------------------------
  4313     05  FILLER            PIC  X(0003).
  4314     05  BREINO PIC  X(0001).
  4315*    -------------------------------
  4316     05  FILLER            PIC  X(0003).
  4317     05  BBILCDO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  82
* EL6311.cbl
  4318*    -------------------------------
  4319     05  FILLER            PIC  X(0003).
  4320     05  BUNWRITO PIC  X(0001).
  4321*    -------------------------------
  4322     05  FILLER            PIC  X(0003).
  4323     05  BSKPCDO PIC  X(0001).
  4324*    -------------------------------
  4325     05  FILLER            PIC  X(0003).
  4326     05  BINDGRPO PIC  X(0001).
  4327*    -------------------------------
  4328     05  FILLER            PIC  X(0003).
  4329     05  BSIGO PIC  X(0001).
  4330*    -------------------------------
  4331     05  FILLER            PIC  X(0003).
  4332     05  BRTCLSO PIC  X(0002).
  4333*    -------------------------------
  4334     05  FILLER            PIC  X(0003).
  4335     05  BCHGCNTO PIC  X(0003).
  4336*    -------------------------------
  4337     05  FILLER            PIC  X(0003).
  4338     05  BMEMBERO PIC  X(0012).
  4339*    -------------------------------
  4340     05  FILLER            PIC  X(0003).
  4341     05  BORGNOO PIC  X(0006).
  4342*    -------------------------------
  4343     05  FILLER            PIC  X(0003).
  4344     05  BORGSEQO PIC  X(0004).
  4345*    -------------------------------
  4346     05  FILLER            PIC  X(0003).
  4347     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4348*    -------------------------------
  4349     05  FILLER            PIC  X(0003).
  4350     05  BKIND1O PIC  X(0002).
  4351*    -------------------------------
  4352     05  FILLER            PIC  X(0003).
  4353     05  BTYPE1O PIC  X(0003).
  4354*    -------------------------------
  4355     05  FILLER            PIC  X(0003).
  4356     05  BTERM1O PIC  X(0003).
  4357*    -------------------------------
  4358     05  FILLER            PIC  X(0003).
  4359     05  BBEN1O PIC  X(0012).
  4360*    -------------------------------
  4361     05  FILLER            PIC  X(0003).
  4362     05  BPREM1O PIC  X(0011).
  4363*    -------------------------------
  4364     05  FILLER            PIC  X(0003).
  4365     05  BEXPIR1O PIC  X(0008).
  4366*    -------------------------------
  4367     05  FILLER            PIC  X(0003).
  4368     05  BCP1O PIC  X(0002).
  4369*    -------------------------------
  4370     05  FILLER            PIC  X(0003).
  4371     05  BALTBN1O PIC  X(0012).
  4372*    -------------------------------
  4373     05  FILLER            PIC  X(0003).
  4374     05  BALTPR1O PIC  X(0011).
  4375*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  83
* EL6311.cbl
  4376     05  FILLER            PIC  X(0003).
  4377     05  BBNCD1O PIC  X(0003).
  4378*    -------------------------------
  4379     05  FILLER            PIC  X(0003).
  4380     05  BCPRM1O PIC  X(0011).
  4381*    -------------------------------
  4382     05  FILLER            PIC  X(0003).
  4383     05  BCAPRM1O PIC  X(0011).
  4384*    -------------------------------
  4385     05  FILLER            PIC  X(0003).
  4386     05  BENABR1O PIC  X(0005).
  4387*    -------------------------------
  4388     05  FILLER            PIC  X(0003).
  4389     05  BDIFF1O PIC  X(0011).
  4390*    -------------------------------
  4391     05  FILLER            PIC  X(0003).
  4392     05  BBILIT1O PIC  X(0008).
  4393*    -------------------------------
  4394     05  FILLER            PIC  X(0003).
  4395     05  BADIFF1O PIC  X(0011).
  4396*    -------------------------------
  4397     05  FILLER            PIC  X(0003).
  4398     05  BKIND2O PIC  X(0002).
  4399*    -------------------------------
  4400     05  FILLER            PIC  X(0003).
  4401     05  BTYPE2O PIC  X(0003).
  4402*    -------------------------------
  4403     05  FILLER            PIC  X(0003).
  4404     05  BTERM2O PIC  X(0003).
  4405*    -------------------------------
  4406     05  FILLER            PIC  X(0003).
  4407     05  BBEN2O PIC  X(0012).
  4408*    -------------------------------
  4409     05  FILLER            PIC  X(0003).
  4410     05  BPREM2O PIC  X(0011).
  4411*    -------------------------------
  4412     05  FILLER            PIC  X(0003).
  4413     05  BEXPIR2O PIC  X(0008).
  4414*    -------------------------------
  4415     05  FILLER            PIC  X(0003).
  4416     05  BCP2O PIC  X(0002).
  4417*    -------------------------------
  4418     05  FILLER            PIC  X(0003).
  4419     05  BALTBN2O PIC  X(0012).
  4420*    -------------------------------
  4421     05  FILLER            PIC  X(0003).
  4422     05  BALTPR2O PIC  X(0011).
  4423*    -------------------------------
  4424     05  FILLER            PIC  X(0003).
  4425     05  BBNCD2O PIC  X(0003).
  4426*    -------------------------------
  4427     05  FILLER            PIC  X(0003).
  4428     05  BCPRM2O PIC  X(0011).
  4429*    -------------------------------
  4430     05  FILLER            PIC  X(0003).
  4431     05  BCAPRM2O PIC  X(0011).
  4432*    -------------------------------
  4433     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  84
* EL6311.cbl
  4434     05  BENABR2O PIC  X(0005).
  4435*    -------------------------------
  4436     05  FILLER            PIC  X(0003).
  4437     05  BDIFF2O PIC  X(0011).
  4438*    -------------------------------
  4439     05  FILLER            PIC  X(0003).
  4440     05  BBILIT2O PIC  X(0008).
  4441*    -------------------------------
  4442     05  FILLER            PIC  X(0003).
  4443     05  BADIFF2O PIC  X(0011).
  4444*    -------------------------------
  4445     05  FILLER            PIC  X(0003).
  4446     05  BERMSG1O PIC  X(0078).
  4447*    -------------------------------
  4448     05  FILLER            PIC  X(0003).
  4449     05  BERMSG2O PIC  X(0078).
  4450*    -------------------------------
  4451     05  FILLER            PIC  X(0003).
  4452     05  BERMSG3O PIC  X(0078).
  4453*    -------------------------------
  4454     05  FILLER            PIC  X(0003).
  4455     05  BPFENTRO PIC  X(0002).
  4456*    -------------------------------
  4457     05  FILLER            PIC  X(0003).
  4458     05  BPF5HDRO PIC  X(0005).
  4459*    -------------------------------
  4460     05  FILLER            PIC  X(0003).
  4461     05  BPF4HDRO PIC  X(0013).
  4462*    -------------------------------
  4463     05  FILLER            PIC  X(0003).
  4464     05  BF15HDRO PIC  X(0010).
  4465*    -------------------------------
  4466 01  EL631CI REDEFINES EL631BI.
  4467     05  FILLER            PIC  X(0012).
  4468*    -------------------------------
  4469     05  CDATEL PIC S9(0004) COMP.
  4470     05  CDATEF PIC  X(0001).
  4471     05  FILLER REDEFINES CDATEF.
  4472         10  CDATEA PIC  X(0001).
  4473     05  CDATEI PIC  X(0008).
  4474*    -------------------------------
  4475     05  CTIMEL PIC S9(0004) COMP.
  4476     05  CTIMEF PIC  X(0001).
  4477     05  FILLER REDEFINES CTIMEF.
  4478         10  CTIMEA PIC  X(0001).
  4479     05  CTIMEI PIC  X(0005).
  4480*    -------------------------------
  4481     05  CHEADL PIC S9(0004) COMP.
  4482     05  CHEADF PIC  X(0001).
  4483     05  FILLER REDEFINES CHEADF.
  4484         10  CHEADA PIC  X(0001).
  4485     05  CHEADI PIC  X(0038).
  4486*    -------------------------------
  4487     05  CCHGTL PIC S9(0004) COMP.
  4488     05  CCHGTF PIC  X(0001).
  4489     05  FILLER REDEFINES CCHGTF.
  4490         10  CCHGTA PIC  X(0001).
  4491     05  CCHGTI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  85
* EL6311.cbl
  4492*    -------------------------------
  4493     05  CCHGL PIC S9(0004) COMP.
  4494     05  CCHGF PIC  X(0001).
  4495     05  FILLER REDEFINES CCHGF.
  4496         10  CCHGA PIC  X(0001).
  4497     05  CCHGI PIC  X(0004).
  4498*    -------------------------------
  4499     05  CMAINTL PIC S9(0004) COMP.
  4500     05  CMAINTF PIC  X(0001).
  4501     05  FILLER REDEFINES CMAINTF.
  4502         10  CMAINTA PIC  X(0001).
  4503     05  CMAINTI PIC  X(0001).
  4504*    -------------------------------
  4505     05  CMANTBYL PIC S9(0004) COMP.
  4506     05  CMANTBYF PIC  X(0001).
  4507     05  FILLER REDEFINES CMANTBYF.
  4508         10  CMANTBYA PIC  X(0001).
  4509     05  CMANTBYI PIC  X(0004).
  4510*    -------------------------------
  4511     05  CCHGHDGL PIC S9(0004) COMP.
  4512     05  CCHGHDGF PIC  X(0001).
  4513     05  FILLER REDEFINES CCHGHDGF.
  4514         10  CCHGHDGA PIC  X(0001).
  4515     05  CCHGHDGI PIC  X(0003).
  4516*    -------------------------------
  4517     05  CMANTDTL PIC S9(0004) COMP.
  4518     05  CMANTDTF PIC  X(0001).
  4519     05  FILLER REDEFINES CMANTDTF.
  4520         10  CMANTDTA PIC  X(0001).
  4521     05  CMANTDTI PIC  X(0008).
  4522*    -------------------------------
  4523     05  CMANTATL PIC S9(0004) COMP.
  4524     05  CMANTATF PIC  X(0001).
  4525     05  FILLER REDEFINES CMANTATF.
  4526         10  CMANTATA PIC  X(0001).
  4527     05  CMANTATI PIC  X(0005).
  4528*    -------------------------------
  4529     05  CCSRL PIC S9(0004) COMP.
  4530     05  CCSRF PIC  X(0001).
  4531     05  FILLER REDEFINES CCSRF.
  4532         10  CCSRA PIC  X(0001).
  4533     05  CCSRI PIC  X(0004).
  4534*    -------------------------------
  4535     05  CBATCHL PIC S9(0004) COMP.
  4536     05  CBATCHF PIC  X(0001).
  4537     05  FILLER REDEFINES CBATCHF.
  4538         10  CBATCHA PIC  X(0001).
  4539     05  CBATCHI PIC  X(0006).
  4540*    -------------------------------
  4541     05  CSEQL PIC S9(0004) COMP.
  4542     05  CSEQF PIC  X(0001).
  4543     05  FILLER REDEFINES CSEQF.
  4544         10  CSEQA PIC  X(0001).
  4545     05  CSEQI PIC  X(0004).
  4546*    -------------------------------
  4547     05  CMOENDTL PIC S9(0004) COMP.
  4548     05  CMOENDTF PIC  X(0001).
  4549     05  FILLER REDEFINES CMOENDTF.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  86
* EL6311.cbl
  4550         10  CMOENDTA PIC  X(0001).
  4551     05  CMOENDTI PIC  X(0008).
  4552*    -------------------------------
  4553     05  CCARRL PIC S9(0004) COMP.
  4554     05  CCARRF PIC  X(0001).
  4555     05  FILLER REDEFINES CCARRF.
  4556         10  CCARRA PIC  X(0001).
  4557     05  CCARRI PIC  X(0001).
  4558*    -------------------------------
  4559     05  CGROUPL PIC S9(0004) COMP.
  4560     05  CGROUPF PIC  X(0001).
  4561     05  FILLER REDEFINES CGROUPF.
  4562         10  CGROUPA PIC  X(0001).
  4563     05  CGROUPI PIC  X(0006).
  4564*    -------------------------------
  4565     05  CSTATEL PIC S9(0004) COMP.
  4566     05  CSTATEF PIC  X(0001).
  4567     05  FILLER REDEFINES CSTATEF.
  4568         10  CSTATEA PIC  X(0001).
  4569     05  CSTATEI PIC  X(0002).
  4570*    -------------------------------
  4571     05  CACCTL PIC S9(0004) COMP.
  4572     05  CACCTF PIC  X(0001).
  4573     05  FILLER REDEFINES CACCTF.
  4574         10  CACCTA PIC  X(0001).
  4575     05  CACCTI PIC  X(0010).
  4576*    -------------------------------
  4577     05  CORIGHDL PIC S9(0004) COMP.
  4578     05  CORIGHDF PIC  X(0001).
  4579     05  FILLER REDEFINES CORIGHDF.
  4580         10  CORIGHDA PIC  X(0001).
  4581     05  CORIGHDI PIC  X(0011).
  4582*    -------------------------------
  4583     05  CORGNOL PIC S9(0004) COMP.
  4584     05  CORGNOF PIC  X(0001).
  4585     05  FILLER REDEFINES CORGNOF.
  4586         10  CORGNOA PIC  X(0001).
  4587     05  CORGNOI PIC  X(0006).
  4588*    -------------------------------
  4589     05  CORGSEQL PIC S9(0004) COMP.
  4590     05  CORGSEQF PIC  X(0001).
  4591     05  FILLER REDEFINES CORGSEQF.
  4592         10  CORGSEQA PIC  X(0001).
  4593     05  CORGSEQI PIC  X(0004).
  4594*    -------------------------------
  4595     05  CREFHDGL PIC S9(0004) COMP.
  4596     05  CREFHDGF PIC  X(0001).
  4597     05  FILLER REDEFINES CREFHDGF.
  4598         10  CREFHDGA PIC  X(0001).
  4599     05  CREFHDGI PIC  X(0010).
  4600*    -------------------------------
  4601     05  CREFL PIC S9(0004) COMP.
  4602     05  CREFF PIC  X(0001).
  4603     05  FILLER REDEFINES CREFF.
  4604         10  CREFA PIC  X(0001).
  4605     05  CREFI PIC  X(0012).
  4606*    -------------------------------
  4607     05  CNHINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  87
* EL6311.cbl
  4608     05  CNHINTF PIC  X(0001).
  4609     05  FILLER REDEFINES CNHINTF.
  4610         10  CNHINTA PIC  X(0001).
  4611     05  CNHINTI PIC  9(7)V99.
  4612*    -------------------------------
  4613     05  CCERTNOL PIC S9(0004) COMP.
  4614     05  CCERTNOF PIC  X(0001).
  4615     05  FILLER REDEFINES CCERTNOF.
  4616         10  CCERTNOA PIC  X(0001).
  4617     05  CCERTNOI PIC  X(0010).
  4618*    -------------------------------
  4619     05  CSUFIXL PIC S9(0004) COMP.
  4620     05  CSUFIXF PIC  X(0001).
  4621     05  FILLER REDEFINES CSUFIXF.
  4622         10  CSUFIXA PIC  X(0001).
  4623     05  CSUFIXI PIC  X(0001).
  4624*    -------------------------------
  4625     05  CEFFDTL PIC S9(0004) COMP.
  4626     05  CEFFDTF PIC  X(0001).
  4627     05  FILLER REDEFINES CEFFDTF.
  4628         10  CEFFDTA PIC  X(0001).
  4629     05  CEFFDTI PIC  X(0008).
  4630*    -------------------------------
  4631     05  CLSTNML PIC S9(0004) COMP.
  4632     05  CLSTNMF PIC  X(0001).
  4633     05  FILLER REDEFINES CLSTNMF.
  4634         10  CLSTNMA PIC  X(0001).
  4635     05  CLSTNMI PIC  X(0015).
  4636*    -------------------------------
  4637     05  CPCYNL PIC S9(0004) COMP.
  4638     05  CPCYNF PIC  X(0001).
  4639     05  FILLER REDEFINES CPCYNF.
  4640         10  CPCYNA PIC  X(0001).
  4641     05  CPCYNI PIC  X(0001).
  4642*    -------------------------------
  4643     05  CINAMEL PIC S9(0004) COMP.
  4644     05  CINAMEF PIC  X(0001).
  4645     05  FILLER REDEFINES CINAMEF.
  4646         10  CINAMEA PIC  X(0001).
  4647     05  CINAMEI PIC  X(0015).
  4648*    -------------------------------
  4649     05  CINITSL PIC S9(0004) COMP.
  4650     05  CINITSF PIC  X(0001).
  4651     05  FILLER REDEFINES CINITSF.
  4652         10  CINITSA PIC  X(0001).
  4653     05  CINITSI PIC  X(0010).
  4654*    -------------------------------
  4655     05  CCANREAL PIC S9(0004) COMP.
  4656     05  CCANREAF PIC  X(0001).
  4657     05  FILLER REDEFINES CCANREAF.
  4658         10  CCANREAA PIC  X(0001).
  4659     05  CCANREAI PIC  X(0001).
  4660*    -------------------------------
  4661     05  ACTSPCL PIC S9(0004) COMP.
  4662     05  ACTSPCF PIC  X(0001).
  4663     05  FILLER REDEFINES ACTSPCF.
  4664         10  ACTSPCA PIC  X(0001).
  4665     05  ACTSPCI PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  88
* EL6311.cbl
  4666*    -------------------------------
  4667     05  CKIND1L PIC S9(0004) COMP.
  4668     05  CKIND1F PIC  X(0001).
  4669     05  FILLER REDEFINES CKIND1F.
  4670         10  CKIND1A PIC  X(0001).
  4671     05  CKIND1I PIC  X(0002).
  4672*    -------------------------------
  4673     05  CCANDT1L PIC S9(0004) COMP.
  4674     05  CCANDT1F PIC  X(0001).
  4675     05  FILLER REDEFINES CCANDT1F.
  4676         10  CCANDT1A PIC  X(0001).
  4677     05  CCANDT1I PIC  X(0008).
  4678*    -------------------------------
  4679     05  CREFND1L PIC S9(0004) COMP.
  4680     05  CREFND1F PIC  X(0001).
  4681     05  FILLER REDEFINES CREFND1F.
  4682         10  CREFND1A PIC  X(0001).
  4683     05  CREFND1I PIC  S9(9)V99.
  4684*    -------------------------------
  4685     05  CMTHD1L PIC S9(0004) COMP.
  4686     05  CMTHD1F PIC  X(0001).
  4687     05  FILLER REDEFINES CMTHD1F.
  4688         10  CMTHD1A PIC  X(0001).
  4689     05  CMTHD1I PIC  X(0001).
  4690*    -------------------------------
  4691     05  CKIND2L PIC S9(0004) COMP.
  4692     05  CKIND2F PIC  X(0001).
  4693     05  FILLER REDEFINES CKIND2F.
  4694         10  CKIND2A PIC  X(0001).
  4695     05  CKIND2I PIC  X(0002).
  4696*    -------------------------------
  4697     05  CCANDT2L PIC S9(0004) COMP.
  4698     05  CCANDT2F PIC  X(0001).
  4699     05  FILLER REDEFINES CCANDT2F.
  4700         10  CCANDT2A PIC  X(0001).
  4701     05  CCANDT2I PIC  X(0008).
  4702*    -------------------------------
  4703     05  CREFND2L PIC S9(0004) COMP.
  4704     05  CREFND2F PIC  X(0001).
  4705     05  FILLER REDEFINES CREFND2F.
  4706         10  CREFND2A PIC  X(0001).
  4707     05  CREFND2I PIC  S9(9)V99.
  4708*    -------------------------------
  4709     05  CMTHD2L PIC S9(0004) COMP.
  4710     05  CMTHD2F PIC  X(0001).
  4711     05  FILLER REDEFINES CMTHD2F.
  4712         10  CMTHD2A PIC  X(0001).
  4713     05  CMTHD2I PIC  X(0001).
  4714*    -------------------------------
  4715     05  CLIVESL PIC S9(0004) COMP.
  4716     05  CLIVESF PIC  X(0001).
  4717     05  FILLER REDEFINES CLIVESF.
  4718         10  CLIVESA PIC  X(0001).
  4719     05  CLIVESI PIC  X(0003).
  4720*    -------------------------------
  4721     05  CFORCEL PIC S9(0004) COMP.
  4722     05  CFORCEF PIC  X(0001).
  4723     05  FILLER REDEFINES CFORCEF.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  89
* EL6311.cbl
  4724         10  CFORCEA PIC  X(0001).
  4725     05  CFORCEI PIC  X(0001).
  4726*    -------------------------------
  4727     05  CBILCDL PIC S9(0004) COMP.
  4728     05  CBILCDF PIC  X(0001).
  4729     05  FILLER REDEFINES CBILCDF.
  4730         10  CBILCDA PIC  X(0001).
  4731     05  CBILCDI PIC  X(0001).
  4732*    -------------------------------
  4733     05  CCRFND1L PIC S9(0004) COMP.
  4734     05  CCRFND1F PIC  X(0001).
  4735     05  FILLER REDEFINES CCRFND1F.
  4736         10  CCRFND1A PIC  X(0001).
  4737     05  CCRFND1I PIC  X(0011).
  4738*    -------------------------------
  4739     05  CCRFND2L PIC S9(0004) COMP.
  4740     05  CCRFND2F PIC  X(0001).
  4741     05  FILLER REDEFINES CCRFND2F.
  4742         10  CCRFND2A PIC  X(0001).
  4743     05  CCRFND2I PIC  X(0011).
  4744*    -------------------------------
  4745     05  CBILIT1L PIC S9(0004) COMP.
  4746     05  CBILIT1F PIC  X(0001).
  4747     05  FILLER REDEFINES CBILIT1F.
  4748         10  CBILIT1A PIC  X(0001).
  4749     05  CBILIT1I PIC  X(0008).
  4750*    -------------------------------
  4751     05  CDRFND1L PIC S9(0004) COMP.
  4752     05  CDRFND1F PIC  X(0001).
  4753     05  FILLER REDEFINES CDRFND1F.
  4754         10  CDRFND1A PIC  X(0001).
  4755     05  CDRFND1I PIC  X(0011).
  4756*    -------------------------------
  4757     05  CBILIT2L PIC S9(0004) COMP.
  4758     05  CBILIT2F PIC  X(0001).
  4759     05  FILLER REDEFINES CBILIT2F.
  4760         10  CBILIT2A PIC  X(0001).
  4761     05  CBILIT2I PIC  X(0008).
  4762*    -------------------------------
  4763     05  CDRFND2L PIC S9(0004) COMP.
  4764     05  CDRFND2F PIC  X(0001).
  4765     05  FILLER REDEFINES CDRFND2F.
  4766         10  CDRFND2A PIC  X(0001).
  4767     05  CDRFND2I PIC  X(0011).
  4768*    -------------------------------
  4769     05  CCANTXTL PIC S9(0004) COMP.
  4770     05  CCANTXTF PIC  X(0001).
  4771     05  FILLER REDEFINES CCANTXTF.
  4772         10  CCANTXTA PIC  X(0001).
  4773     05  CCANTXTI PIC  X(0005).
  4774*    -------------------------------
  4775     05  CCANFEEL PIC S9(0004) COMP.
  4776     05  CCANFEEF PIC  X(0001).
  4777     05  FILLER REDEFINES CCANFEEF.
  4778         10  CCANFEEA PIC  X(0001).
  4779     05  CCANFEEI PIC  X(0002).
  4780*    -------------------------------
  4781     05  CTERM1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  90
* EL6311.cbl
  4782     05  CTERM1F PIC  X(0001).
  4783     05  FILLER REDEFINES CTERM1F.
  4784         10  CTERM1A PIC  X(0001).
  4785     05  CTERM1I PIC  X(0003).
  4786*    -------------------------------
  4787     05  CRTERM1L PIC S9(0004) COMP.
  4788     05  CRTERM1F PIC  X(0001).
  4789     05  FILLER REDEFINES CRTERM1F.
  4790         10  CRTERM1A PIC  X(0001).
  4791     05  CRTERM1I PIC  X(0003).
  4792*    -------------------------------
  4793     05  CPREM1L PIC S9(0004) COMP.
  4794     05  CPREM1F PIC  X(0001).
  4795     05  FILLER REDEFINES CPREM1F.
  4796         10  CPREM1A PIC  X(0001).
  4797     05  CPREM1I PIC  X(0011).
  4798*    -------------------------------
  4799     05  CTERM2L PIC S9(0004) COMP.
  4800     05  CTERM2F PIC  X(0001).
  4801     05  FILLER REDEFINES CTERM2F.
  4802         10  CTERM2A PIC  X(0001).
  4803     05  CTERM2I PIC  X(0003).
  4804*    -------------------------------
  4805     05  CRTERM2L PIC S9(0004) COMP.
  4806     05  CRTERM2F PIC  X(0001).
  4807     05  FILLER REDEFINES CRTERM2F.
  4808         10  CRTERM2A PIC  X(0001).
  4809     05  CRTERM2I PIC  X(0003).
  4810*    -------------------------------
  4811     05  CPREM2L PIC S9(0004) COMP.
  4812     05  CPREM2F PIC  X(0001).
  4813     05  FILLER REDEFINES CPREM2F.
  4814         10  CPREM2A PIC  X(0001).
  4815     05  CPREM2I PIC  X(0011).
  4816*    -------------------------------
  4817     05  CENTRDTL PIC S9(0004) COMP.
  4818     05  CENTRDTF PIC  X(0001).
  4819     05  FILLER REDEFINES CENTRDTF.
  4820         10  CENTRDTA PIC  X(0001).
  4821     05  CENTRDTI PIC  X(0008).
  4822*    -------------------------------
  4823     05  CPAYEEL PIC S9(0004) COMP.
  4824     05  CPAYEEF PIC  X(0001).
  4825     05  FILLER REDEFINES CPAYEEF.
  4826         10  CPAYEEA PIC  X(0001).
  4827     05  CPAYEEI PIC  X(0006).
  4828*    -------------------------------
  4829     05  CRFNDSWL PIC S9(0004) COMP.
  4830     05  CRFNDSWF PIC  X(0001).
  4831     05  FILLER REDEFINES CRFNDSWF.
  4832         10  CRFNDSWA PIC  X(0001).
  4833     05  CRFNDSWI PIC  X(0003).
  4834*    -------------------------------
  4835     05  CLFHDGL PIC S9(0004) COMP.
  4836     05  CLFHDGF PIC  X(0001).
  4837     05  FILLER REDEFINES CLFHDGF.
  4838         10  CLFHDGA PIC  X(0001).
  4839     05  CLFHDGI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  91
* EL6311.cbl
  4840*    -------------------------------
  4841     05  CAHHDGL PIC S9(0004) COMP.
  4842     05  CAHHDGF PIC  X(0001).
  4843     05  FILLER REDEFINES CAHHDGF.
  4844         10  CAHHDGA PIC  X(0001).
  4845     05  CAHHDGI PIC  X(0006).
  4846*    -------------------------------
  4847     05  CENTDTL PIC S9(0004) COMP.
  4848     05  CENTDTF PIC  X(0001).
  4849     05  FILLER REDEFINES CENTDTF.
  4850         10  CENTDTA PIC  X(0001).
  4851     05  CENTDTI PIC  X(0008).
  4852*    -------------------------------
  4853     05  CENTBYL PIC S9(0004) COMP.
  4854     05  CENTBYF PIC  X(0001).
  4855     05  FILLER REDEFINES CENTBYF.
  4856         10  CENTBYA PIC  X(0001).
  4857     05  CENTBYI PIC  X(0004).
  4858*    -------------------------------
  4859     05  CCHGCNTL PIC S9(0004) COMP.
  4860     05  CCHGCNTF PIC  X(0001).
  4861     05  FILLER REDEFINES CCHGCNTF.
  4862         10  CCHGCNTA PIC  X(0001).
  4863     05  CCHGCNTI PIC  X(0003).
  4864*    -------------------------------
  4865     05  CLFREFNL PIC S9(0004) COMP.
  4866     05  CLFREFNF PIC  X(0001).
  4867     05  FILLER REDEFINES CLFREFNF.
  4868         10  CLFREFNA PIC  X(0001).
  4869     05  CLFREFNI PIC  X(0006).
  4870*    -------------------------------
  4871     05  CAHREFNL PIC S9(0004) COMP.
  4872     05  CAHREFNF PIC  X(0001).
  4873     05  FILLER REDEFINES CAHREFNF.
  4874         10  CAHREFNA PIC  X(0001).
  4875     05  CAHREFNI PIC  X(0006).
  4876*    -------------------------------
  4877     05  CREINCDL PIC S9(0004) COMP.
  4878     05  CREINCDF PIC  X(0001).
  4879     05  FILLER REDEFINES CREINCDF.
  4880         10  CREINCDA PIC  X(0001).
  4881     05  CREINCDI PIC  X(0003).
  4882*    -------------------------------
  4883     05  CAEFFDTL PIC S9(0004) COMP.
  4884     05  CAEFFDTF PIC  X(0001).
  4885     05  FILLER REDEFINES CAEFFDTF.
  4886         10  CAEFFDTA PIC  X(0001).
  4887     05  CAEFFDTI PIC  X(0008).
  4888*    -------------------------------
  4889     05  CAEXPDTL PIC S9(0004) COMP.
  4890     05  CAEXPDTF PIC  X(0001).
  4891     05  FILLER REDEFINES CAEXPDTF.
  4892         10  CAEXPDTA PIC  X(0001).
  4893     05  CAEXPDTI PIC  X(0008).
  4894*    -------------------------------
  4895     05  COMMLFL PIC S9(0004) COMP.
  4896     05  COMMLFF PIC  X(0001).
  4897     05  FILLER REDEFINES COMMLFF.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  92
* EL6311.cbl
  4898         10  COMMLFA PIC  X(0001).
  4899     05  COMMLFI PIC  X(0006).
  4900*    -------------------------------
  4901     05  COMMAHL PIC S9(0004) COMP.
  4902     05  COMMAHF PIC  X(0001).
  4903     05  FILLER REDEFINES COMMAHF.
  4904         10  COMMAHA PIC  X(0001).
  4905     05  COMMAHI PIC  X(0006).
  4906*    -------------------------------
  4907     05  CERMSG1L PIC S9(0004) COMP.
  4908     05  CERMSG1F PIC  X(0001).
  4909     05  FILLER REDEFINES CERMSG1F.
  4910         10  CERMSG1A PIC  X(0001).
  4911     05  CERMSG1I PIC  X(0078).
  4912*    -------------------------------
  4913     05  CERMSG2L PIC S9(0004) COMP.
  4914     05  CERMSG2F PIC  X(0001).
  4915     05  FILLER REDEFINES CERMSG2F.
  4916         10  CERMSG2A PIC  X(0001).
  4917     05  CERMSG2I PIC  X(0078).
  4918*    -------------------------------
  4919     05  CERMSG3L PIC S9(0004) COMP.
  4920     05  CERMSG3F PIC  X(0001).
  4921     05  FILLER REDEFINES CERMSG3F.
  4922         10  CERMSG3A PIC  X(0001).
  4923     05  CERMSG3I PIC  X(0078).
  4924*    -------------------------------
  4925     05  CPFENTRL PIC S9(0004) COMP.
  4926     05  CPFENTRF PIC  X(0001).
  4927     05  FILLER REDEFINES CPFENTRF.
  4928         10  CPFENTRA PIC  X(0001).
  4929     05  CPFENTRI PIC  9(2).
  4930*    -------------------------------
  4931     05  CPF5HDRL PIC S9(0004) COMP.
  4932     05  CPF5HDRF PIC  X(0001).
  4933     05  FILLER REDEFINES CPF5HDRF.
  4934         10  CPF5HDRA PIC  X(0001).
  4935     05  CPF5HDRI PIC  X(0005).
  4936*    -------------------------------
  4937     05  CPF4HDRL PIC S9(0004) COMP.
  4938     05  CPF4HDRF PIC  X(0001).
  4939     05  FILLER REDEFINES CPF4HDRF.
  4940         10  CPF4HDRA PIC  X(0001).
  4941     05  CPF4HDRI PIC  X(0013).
  4942*    -------------------------------
  4943     05  CF15HDRL PIC S9(0004) COMP.
  4944     05  CF15HDRF PIC  X(0001).
  4945     05  FILLER REDEFINES CF15HDRF.
  4946         10  CF15HDRA PIC  X(0001).
  4947     05  CF15HDRI PIC  X(0022).
  4948 01  EL631CO REDEFINES EL631BI.
  4949     05  FILLER            PIC  X(0012).
  4950*    -------------------------------
  4951     05  FILLER            PIC  X(0003).
  4952     05  CDATEO PIC  X(0008).
  4953*    -------------------------------
  4954     05  FILLER            PIC  X(0003).
  4955     05  CTIMEO PIC  99.99.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  93
* EL6311.cbl
  4956*    -------------------------------
  4957     05  FILLER            PIC  X(0003).
  4958     05  CHEADO PIC  X(0038).
  4959*    -------------------------------
  4960     05  FILLER            PIC  X(0003).
  4961     05  CCHGTO PIC  X(0004).
  4962*    -------------------------------
  4963     05  FILLER            PIC  X(0003).
  4964     05  CCHGO PIC  ZZZ9.
  4965*    -------------------------------
  4966     05  FILLER            PIC  X(0003).
  4967     05  CMAINTO PIC  X(0001).
  4968*    -------------------------------
  4969     05  FILLER            PIC  X(0003).
  4970     05  CMANTBYO PIC  X(0004).
  4971*    -------------------------------
  4972     05  FILLER            PIC  X(0003).
  4973     05  CCHGHDGO PIC  X(0003).
  4974*    -------------------------------
  4975     05  FILLER            PIC  X(0003).
  4976     05  CMANTDTO PIC  X(0008).
  4977*    -------------------------------
  4978     05  FILLER            PIC  X(0003).
  4979     05  CMANTATO PIC  99.99.
  4980*    -------------------------------
  4981     05  FILLER            PIC  X(0003).
  4982     05  CCSRO PIC  X(0004).
  4983*    -------------------------------
  4984     05  FILLER            PIC  X(0003).
  4985     05  CBATCHO PIC  X(0006).
  4986*    -------------------------------
  4987     05  FILLER            PIC  X(0003).
  4988     05  CSEQO PIC  X(0004).
  4989*    -------------------------------
  4990     05  FILLER            PIC  X(0003).
  4991     05  CMOENDTO PIC  X(0008).
  4992*    -------------------------------
  4993     05  FILLER            PIC  X(0003).
  4994     05  CCARRO PIC  X(0001).
  4995*    -------------------------------
  4996     05  FILLER            PIC  X(0003).
  4997     05  CGROUPO PIC  X(0006).
  4998*    -------------------------------
  4999     05  FILLER            PIC  X(0003).
  5000     05  CSTATEO PIC  X(0002).
  5001*    -------------------------------
  5002     05  FILLER            PIC  X(0003).
  5003     05  CACCTO PIC  X(0010).
  5004*    -------------------------------
  5005     05  FILLER            PIC  X(0003).
  5006     05  CORIGHDO PIC  X(0011).
  5007*    -------------------------------
  5008     05  FILLER            PIC  X(0003).
  5009     05  CORGNOO PIC  X(0006).
  5010*    -------------------------------
  5011     05  FILLER            PIC  X(0003).
  5012     05  CORGSEQO PIC  X(0004).
  5013*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  94
* EL6311.cbl
  5014     05  FILLER            PIC  X(0003).
  5015     05  CREFHDGO PIC  X(0010).
  5016*    -------------------------------
  5017     05  FILLER            PIC  X(0003).
  5018     05  CREFO PIC  X(0012).
  5019*    -------------------------------
  5020     05  FILLER            PIC  X(0003).
  5021     05  CNHINTO PIC  ZZZZZ9.99.
  5022*    -------------------------------
  5023     05  FILLER            PIC  X(0003).
  5024     05  CCERTNOO PIC  X(0010).
  5025*    -------------------------------
  5026     05  FILLER            PIC  X(0003).
  5027     05  CSUFIXO PIC  X(0001).
  5028*    -------------------------------
  5029     05  FILLER            PIC  X(0003).
  5030     05  CEFFDTO PIC  X(0008).
  5031*    -------------------------------
  5032     05  FILLER            PIC  X(0003).
  5033     05  CLSTNMO PIC  X(0015).
  5034*    -------------------------------
  5035     05  FILLER            PIC  X(0003).
  5036     05  CPCYNO PIC  X(0001).
  5037*    -------------------------------
  5038     05  FILLER            PIC  X(0003).
  5039     05  CINAMEO PIC  X(0015).
  5040*    -------------------------------
  5041     05  FILLER            PIC  X(0003).
  5042     05  CINITSO PIC  X(0010).
  5043*    -------------------------------
  5044     05  FILLER            PIC  X(0003).
  5045     05  CCANREAO PIC  X(0001).
  5046*    -------------------------------
  5047     05  FILLER            PIC  X(0003).
  5048     05  ACTSPCO PIC  X(0001).
  5049*    -------------------------------
  5050     05  FILLER            PIC  X(0003).
  5051     05  CKIND1O PIC  X(0002).
  5052*    -------------------------------
  5053     05  FILLER            PIC  X(0003).
  5054     05  CCANDT1O PIC  X(0008).
  5055*    -------------------------------
  5056     05  FILLER            PIC  X(0003).
  5057     05  CREFND1O PIC  Z(7).99-.
  5058*    -------------------------------
  5059     05  FILLER            PIC  X(0003).
  5060     05  CMTHD1O PIC  X(0001).
  5061*    -------------------------------
  5062     05  FILLER            PIC  X(0003).
  5063     05  CKIND2O PIC  X(0002).
  5064*    -------------------------------
  5065     05  FILLER            PIC  X(0003).
  5066     05  CCANDT2O PIC  X(0008).
  5067*    -------------------------------
  5068     05  FILLER            PIC  X(0003).
  5069     05  CREFND2O PIC  Z(7).99-.
  5070*    -------------------------------
  5071     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  95
* EL6311.cbl
  5072     05  CMTHD2O PIC  X(0001).
  5073*    -------------------------------
  5074     05  FILLER            PIC  X(0003).
  5075     05  CLIVESO PIC  X(0003).
  5076*    -------------------------------
  5077     05  FILLER            PIC  X(0003).
  5078     05  CFORCEO PIC  X(0001).
  5079*    -------------------------------
  5080     05  FILLER            PIC  X(0003).
  5081     05  CBILCDO PIC  X(0001).
  5082*    -------------------------------
  5083     05  FILLER            PIC  X(0003).
  5084     05  CCRFND1O PIC  Z(7).99-.
  5085*    -------------------------------
  5086     05  FILLER            PIC  X(0003).
  5087     05  CCRFND2O PIC  Z(7).99-.
  5088*    -------------------------------
  5089     05  FILLER            PIC  X(0003).
  5090     05  CBILIT1O PIC  X(0008).
  5091*    -------------------------------
  5092     05  FILLER            PIC  X(0003).
  5093     05  CDRFND1O PIC  Z(7).99-.
  5094*    -------------------------------
  5095     05  FILLER            PIC  X(0003).
  5096     05  CBILIT2O PIC  X(0008).
  5097*    -------------------------------
  5098     05  FILLER            PIC  X(0003).
  5099     05  CDRFND2O PIC  Z(7).99-.
  5100*    -------------------------------
  5101     05  FILLER            PIC  X(0003).
  5102     05  CCANTXTO PIC  X(0005).
  5103*    -------------------------------
  5104     05  FILLER            PIC  X(0003).
  5105     05  CCANFEEO PIC  Z9.
  5106*    -------------------------------
  5107     05  FILLER            PIC  X(0003).
  5108     05  CTERM1O PIC  ZZ9.
  5109*    -------------------------------
  5110     05  FILLER            PIC  X(0003).
  5111     05  CRTERM1O PIC  ZZ9.
  5112*    -------------------------------
  5113     05  FILLER            PIC  X(0003).
  5114     05  CPREM1O PIC  ZZZZZZ9.99-.
  5115*    -------------------------------
  5116     05  FILLER            PIC  X(0003).
  5117     05  CTERM2O PIC  ZZ9.
  5118*    -------------------------------
  5119     05  FILLER            PIC  X(0003).
  5120     05  CRTERM2O PIC  ZZ9.
  5121*    -------------------------------
  5122     05  FILLER            PIC  X(0003).
  5123     05  CPREM2O PIC  ZZZZZZ9.99-.
  5124*    -------------------------------
  5125     05  FILLER            PIC  X(0003).
  5126     05  CENTRDTO PIC  X(0008).
  5127*    -------------------------------
  5128     05  FILLER            PIC  X(0003).
  5129     05  CPAYEEO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  96
* EL6311.cbl
  5130*    -------------------------------
  5131     05  FILLER            PIC  X(0003).
  5132     05  CRFNDSWO PIC  X(0003).
  5133*    -------------------------------
  5134     05  FILLER            PIC  X(0003).
  5135     05  CLFHDGO PIC  X(0006).
  5136*    -------------------------------
  5137     05  FILLER            PIC  X(0003).
  5138     05  CAHHDGO PIC  X(0006).
  5139*    -------------------------------
  5140     05  FILLER            PIC  X(0003).
  5141     05  CENTDTO PIC  X(0008).
  5142*    -------------------------------
  5143     05  FILLER            PIC  X(0003).
  5144     05  CENTBYO PIC  X(0004).
  5145*    -------------------------------
  5146     05  FILLER            PIC  X(0003).
  5147     05  CCHGCNTO PIC  X(0003).
  5148*    -------------------------------
  5149     05  FILLER            PIC  X(0003).
  5150     05  CLFREFNO PIC  X(0006).
  5151*    -------------------------------
  5152     05  FILLER            PIC  X(0003).
  5153     05  CAHREFNO PIC  X(0006).
  5154*    -------------------------------
  5155     05  FILLER            PIC  X(0003).
  5156     05  CREINCDO PIC  X(0003).
  5157*    -------------------------------
  5158     05  FILLER            PIC  X(0003).
  5159     05  CAEFFDTO PIC  X(0008).
  5160*    -------------------------------
  5161     05  FILLER            PIC  X(0003).
  5162     05  CAEXPDTO PIC  X(0008).
  5163*    -------------------------------
  5164     05  FILLER            PIC  X(0003).
  5165     05  COMMLFO PIC  .99999.
  5166*    -------------------------------
  5167     05  FILLER            PIC  X(0003).
  5168     05  COMMAHO PIC  .99999.
  5169*    -------------------------------
  5170     05  FILLER            PIC  X(0003).
  5171     05  CERMSG1O PIC  X(0078).
  5172*    -------------------------------
  5173     05  FILLER            PIC  X(0003).
  5174     05  CERMSG2O PIC  X(0078).
  5175*    -------------------------------
  5176     05  FILLER            PIC  X(0003).
  5177     05  CERMSG3O PIC  X(0078).
  5178*    -------------------------------
  5179     05  FILLER            PIC  X(0003).
  5180     05  CPFENTRO PIC  X(0002).
  5181*    -------------------------------
  5182     05  FILLER            PIC  X(0003).
  5183     05  CPF5HDRO PIC  X(0005).
  5184*    -------------------------------
  5185     05  FILLER            PIC  X(0003).
  5186     05  CPF4HDRO PIC  X(0013).
  5187*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  97
* EL6311.cbl
  5188     05  FILLER            PIC  X(0003).
  5189     05  CF15HDRO PIC  X(0022).
  5190*    -------------------------------
  5191 01  EL631DI REDEFINES EL631BI.
  5192     05  FILLER            PIC  X(0012).
  5193*    -------------------------------
  5194     05  DDATEL PIC S9(0004) COMP.
  5195     05  DDATEF PIC  X(0001).
  5196     05  FILLER REDEFINES DDATEF.
  5197         10  DDATEA PIC  X(0001).
  5198     05  DDATEI PIC  X(0008).
  5199*    -------------------------------
  5200     05  DTIMEL PIC S9(0004) COMP.
  5201     05  DTIMEF PIC  X(0001).
  5202     05  FILLER REDEFINES DTIMEF.
  5203         10  DTIMEA PIC  X(0001).
  5204     05  DTIMEI PIC  X(0005).
  5205*    -------------------------------
  5206     05  DHEADL PIC S9(0004) COMP.
  5207     05  DHEADF PIC  X(0001).
  5208     05  FILLER REDEFINES DHEADF.
  5209         10  DHEADA PIC  X(0001).
  5210     05  DHEADI PIC  X(0038).
  5211*    -------------------------------
  5212     05  DLDATEL PIC S9(0004) COMP.
  5213     05  DLDATEF PIC  X(0001).
  5214     05  FILLER REDEFINES DLDATEF.
  5215         10  DLDATEA PIC  X(0001).
  5216     05  DLDATEI PIC  X(0010).
  5217*    -------------------------------
  5218     05  DBATCHL PIC S9(0004) COMP.
  5219     05  DBATCHF PIC  X(0001).
  5220     05  FILLER REDEFINES DBATCHF.
  5221         10  DBATCHA PIC  X(0001).
  5222     05  DBATCHI PIC  X(0011).
  5223*    -------------------------------
  5224     05  DACCTNML PIC S9(0004) COMP.
  5225     05  DACCTNMF PIC  X(0001).
  5226     05  FILLER REDEFINES DACCTNMF.
  5227         10  DACCTNMA PIC  X(0001).
  5228     05  DACCTNMI PIC  X(0030).
  5229*    -------------------------------
  5230     05  DPROCDTL PIC S9(0004) COMP.
  5231     05  DPROCDTF PIC  X(0001).
  5232     05  FILLER REDEFINES DPROCDTF.
  5233         10  DPROCDTA PIC  X(0001).
  5234     05  DPROCDTI PIC  X(0008).
  5235*    -------------------------------
  5236     05  DINPUTL PIC S9(0004) COMP.
  5237     05  DINPUTF PIC  X(0001).
  5238     05  FILLER REDEFINES DINPUTF.
  5239         10  DINPUTA PIC  X(0001).
  5240     05  DINPUTI PIC  X(0008).
  5241*    -------------------------------
  5242     05  DMAINDTL PIC S9(0004) COMP.
  5243     05  DMAINDTF PIC  X(0001).
  5244     05  FILLER REDEFINES DMAINDTF.
  5245         10  DMAINDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  98
* EL6311.cbl
  5246     05  DMAINDTI PIC  X(0008).
  5247*    -------------------------------
  5248     05  DCARRL PIC S9(0004) COMP.
  5249     05  DCARRF PIC  X(0001).
  5250     05  FILLER REDEFINES DCARRF.
  5251         10  DCARRA PIC  X(0001).
  5252     05  DCARRI PIC  X(0001).
  5253*    -------------------------------
  5254     05  DGROUPL PIC S9(0004) COMP.
  5255     05  DGROUPF PIC  X(0001).
  5256     05  FILLER REDEFINES DGROUPF.
  5257         10  DGROUPA PIC  X(0001).
  5258     05  DGROUPI PIC  X(0006).
  5259*    -------------------------------
  5260     05  DSTATEL PIC S9(0004) COMP.
  5261     05  DSTATEF PIC  X(0001).
  5262     05  FILLER REDEFINES DSTATEF.
  5263         10  DSTATEA PIC  X(0001).
  5264     05  DSTATEI PIC  X(0002).
  5265*    -------------------------------
  5266     05  DACCTL PIC S9(0004) COMP.
  5267     05  DACCTF PIC  X(0001).
  5268     05  FILLER REDEFINES DACCTF.
  5269         10  DACCTA PIC  X(0001).
  5270     05  DACCTI PIC  X(0010).
  5271*    -------------------------------
  5272     05  DRECVDTL PIC S9(0004) COMP.
  5273     05  DRECVDTF PIC  X(0001).
  5274     05  FILLER REDEFINES DRECVDTF.
  5275         10  DRECVDTA PIC  X(0001).
  5276     05  DRECVDTI PIC  X(0008).
  5277*    -------------------------------
  5278     05  DCSRL PIC S9(0004) COMP.
  5279     05  DCSRF PIC  X(0001).
  5280     05  FILLER REDEFINES DCSRF.
  5281         10  DCSRA PIC  X(0001).
  5282     05  DCSRI PIC  X(0004).
  5283*    -------------------------------
  5284     05  DREFHDGL PIC S9(0004) COMP.
  5285     05  DREFHDGF PIC  X(0001).
  5286     05  FILLER REDEFINES DREFHDGF.
  5287         10  DREFHDGA PIC  X(0001).
  5288     05  DREFHDGI PIC  X(0010).
  5289*    -------------------------------
  5290     05  DREFL PIC S9(0004) COMP.
  5291     05  DREFF PIC  X(0001).
  5292     05  FILLER REDEFINES DREFF.
  5293         10  DREFA PIC  X(0001).
  5294     05  DREFI PIC  X(0012).
  5295*    -------------------------------
  5296     05  DLFPHDGL PIC S9(0004) COMP.
  5297     05  DLFPHDGF PIC  X(0001).
  5298     05  FILLER REDEFINES DLFPHDGF.
  5299         10  DLFPHDGA PIC  X(0001).
  5300     05  DLFPHDGI PIC  X(0010).
  5301*    -------------------------------
  5302     05  DAHPHDGL PIC S9(0004) COMP.
  5303     05  DAHPHDGF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page  99
* EL6311.cbl
  5304     05  FILLER REDEFINES DAHPHDGF.
  5305         10  DAHPHDGA PIC  X(0001).
  5306     05  DAHPHDGI PIC  X(0010).
  5307*    -------------------------------
  5308     05  DLFRHDGL PIC S9(0004) COMP.
  5309     05  DLFRHDGF PIC  X(0001).
  5310     05  FILLER REDEFINES DLFRHDGF.
  5311         10  DLFRHDGA PIC  X(0001).
  5312     05  DLFRHDGI PIC  X(0009).
  5313*    -------------------------------
  5314     05  DAHRHDGL PIC S9(0004) COMP.
  5315     05  DAHRHDGF PIC  X(0001).
  5316     05  FILLER REDEFINES DAHRHDGF.
  5317         10  DAHRHDGA PIC  X(0001).
  5318     05  DAHRHDGI PIC  X(0009).
  5319*    -------------------------------
  5320     05  DRISSL PIC S9(0004) COMP.
  5321     05  DRISSF PIC  X(0001).
  5322     05  FILLER REDEFINES DRISSF.
  5323         10  DRISSA PIC  X(0001).
  5324     05  DRISSI PIC  X(0005).
  5325*    -------------------------------
  5326     05  DRLFPRML PIC S9(0004) COMP.
  5327     05  DRLFPRMF PIC  X(0001).
  5328     05  FILLER REDEFINES DRLFPRMF.
  5329         10  DRLFPRMA PIC  X(0001).
  5330     05  DRLFPRMI PIC  S9(9)V99.
  5331*    -------------------------------
  5332     05  DRAHPRML PIC S9(0004) COMP.
  5333     05  DRAHPRMF PIC  X(0001).
  5334     05  FILLER REDEFINES DRAHPRMF.
  5335         10  DRAHPRMA PIC  X(0001).
  5336     05  DRAHPRMI PIC  S9(9)V99.
  5337*    -------------------------------
  5338     05  DRCANCL PIC S9(0004) COMP.
  5339     05  DRCANCF PIC  X(0001).
  5340     05  FILLER REDEFINES DRCANCF.
  5341         10  DRCANCA PIC  X(0001).
  5342     05  DRCANCI PIC  X(0005).
  5343*    -------------------------------
  5344     05  DRLFRFDL PIC S9(0004) COMP.
  5345     05  DRLFRFDF PIC  X(0001).
  5346     05  FILLER REDEFINES DRLFRFDF.
  5347         10  DRLFRFDA PIC  X(0001).
  5348     05  DRLFRFDI PIC  S9(9)V99.
  5349*    -------------------------------
  5350     05  DRAHRFDL PIC S9(0004) COMP.
  5351     05  DRAHRFDF PIC  X(0001).
  5352     05  FILLER REDEFINES DRAHRFDF.
  5353         10  DRAHRFDA PIC  X(0001).
  5354     05  DRAHRFDI PIC  S9(9)V99.
  5355*    -------------------------------
  5356     05  DEISSL PIC S9(0004) COMP.
  5357     05  DEISSF PIC  X(0001).
  5358     05  FILLER REDEFINES DEISSF.
  5359         10  DEISSA PIC  X(0001).
  5360     05  DEISSI PIC  X(0005).
  5361*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 100
* EL6311.cbl
  5362     05  DELFPRML PIC S9(0004) COMP.
  5363     05  DELFPRMF PIC  X(0001).
  5364     05  FILLER REDEFINES DELFPRMF.
  5365         10  DELFPRMA PIC  X(0001).
  5366     05  DELFPRMI PIC  X(0011).
  5367*    -------------------------------
  5368     05  DEAHPRML PIC S9(0004) COMP.
  5369     05  DEAHPRMF PIC  X(0001).
  5370     05  FILLER REDEFINES DEAHPRMF.
  5371         10  DEAHPRMA PIC  X(0001).
  5372     05  DEAHPRMI PIC  X(0011).
  5373*    -------------------------------
  5374     05  DECANCL PIC S9(0004) COMP.
  5375     05  DECANCF PIC  X(0001).
  5376     05  FILLER REDEFINES DECANCF.
  5377         10  DECANCA PIC  X(0001).
  5378     05  DECANCI PIC  X(0005).
  5379*    -------------------------------
  5380     05  DELFRFDL PIC S9(0004) COMP.
  5381     05  DELFRFDF PIC  X(0001).
  5382     05  FILLER REDEFINES DELFRFDF.
  5383         10  DELFRFDA PIC  X(0001).
  5384     05  DELFRFDI PIC  X(0011).
  5385*    -------------------------------
  5386     05  DEAHRFDL PIC S9(0004) COMP.
  5387     05  DEAHRFDF PIC  X(0001).
  5388     05  FILLER REDEFINES DEAHRFDF.
  5389         10  DEAHRFDA PIC  X(0001).
  5390     05  DEAHRFDI PIC  X(0011).
  5391*    -------------------------------
  5392     05  DCISSL PIC S9(0004) COMP.
  5393     05  DCISSF PIC  X(0001).
  5394     05  FILLER REDEFINES DCISSF.
  5395         10  DCISSA PIC  X(0001).
  5396     05  DCISSI PIC  X(0005).
  5397*    -------------------------------
  5398     05  DCLFPRML PIC S9(0004) COMP.
  5399     05  DCLFPRMF PIC  X(0001).
  5400     05  FILLER REDEFINES DCLFPRMF.
  5401         10  DCLFPRMA PIC  X(0001).
  5402     05  DCLFPRMI PIC  X(0011).
  5403*    -------------------------------
  5404     05  DCAHPRML PIC S9(0004) COMP.
  5405     05  DCAHPRMF PIC  X(0001).
  5406     05  FILLER REDEFINES DCAHPRMF.
  5407         10  DCAHPRMA PIC  X(0001).
  5408     05  DCAHPRMI PIC  X(0011).
  5409*    -------------------------------
  5410     05  DCCANCL PIC S9(0004) COMP.
  5411     05  DCCANCF PIC  X(0001).
  5412     05  FILLER REDEFINES DCCANCF.
  5413         10  DCCANCA PIC  X(0001).
  5414     05  DCCANCI PIC  X(0005).
  5415*    -------------------------------
  5416     05  DCLFRFDL PIC S9(0004) COMP.
  5417     05  DCLFRFDF PIC  X(0001).
  5418     05  FILLER REDEFINES DCLFRFDF.
  5419         10  DCLFRFDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 101
* EL6311.cbl
  5420     05  DCLFRFDI PIC  X(0011).
  5421*    -------------------------------
  5422     05  DCAHRFDL PIC S9(0004) COMP.
  5423     05  DCAHRFDF PIC  X(0001).
  5424     05  FILLER REDEFINES DCAHRFDF.
  5425         10  DCAHRFDA PIC  X(0001).
  5426     05  DCAHRFDI PIC  X(0011).
  5427*    -------------------------------
  5428     05  DOISSL PIC S9(0004) COMP.
  5429     05  DOISSF PIC  X(0001).
  5430     05  FILLER REDEFINES DOISSF.
  5431         10  DOISSA PIC  X(0001).
  5432     05  DOISSI PIC  X(0005).
  5433*    -------------------------------
  5434     05  DOLFPRML PIC S9(0004) COMP.
  5435     05  DOLFPRMF PIC  X(0001).
  5436     05  FILLER REDEFINES DOLFPRMF.
  5437         10  DOLFPRMA PIC  X(0001).
  5438     05  DOLFPRMI PIC  X(0011).
  5439*    -------------------------------
  5440     05  DOAHPRML PIC S9(0004) COMP.
  5441     05  DOAHPRMF PIC  X(0001).
  5442     05  FILLER REDEFINES DOAHPRMF.
  5443         10  DOAHPRMA PIC  X(0001).
  5444     05  DOAHPRMI PIC  X(0011).
  5445*    -------------------------------
  5446     05  DOCANCL PIC S9(0004) COMP.
  5447     05  DOCANCF PIC  X(0001).
  5448     05  FILLER REDEFINES DOCANCF.
  5449         10  DOCANCA PIC  X(0001).
  5450     05  DOCANCI PIC  X(0005).
  5451*    -------------------------------
  5452     05  DOLFRFDL PIC S9(0004) COMP.
  5453     05  DOLFRFDF PIC  X(0001).
  5454     05  FILLER REDEFINES DOLFRFDF.
  5455         10  DOLFRFDA PIC  X(0001).
  5456     05  DOLFRFDI PIC  X(0011).
  5457*    -------------------------------
  5458     05  DOAHRFDL PIC S9(0004) COMP.
  5459     05  DOAHRFDF PIC  X(0001).
  5460     05  FILLER REDEFINES DOAHRFDF.
  5461         10  DOAHRFDA PIC  X(0001).
  5462     05  DOAHRFDI PIC  X(0011).
  5463*    -------------------------------
  5464     05  DITOTALL PIC S9(0004) COMP.
  5465     05  DITOTALF PIC  X(0001).
  5466     05  FILLER REDEFINES DITOTALF.
  5467         10  DITOTALA PIC  X(0001).
  5468     05  DITOTALI PIC  X(0005).
  5469*    -------------------------------
  5470     05  DIFATALL PIC S9(0004) COMP.
  5471     05  DIFATALF PIC  X(0001).
  5472     05  FILLER REDEFINES DIFATALF.
  5473         10  DIFATALA PIC  X(0001).
  5474     05  DIFATALI PIC  X(0005).
  5475*    -------------------------------
  5476     05  DIFORCEL PIC S9(0004) COMP.
  5477     05  DIFORCEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 102
* EL6311.cbl
  5478     05  FILLER REDEFINES DIFORCEF.
  5479         10  DIFORCEA PIC  X(0001).
  5480     05  DIFORCEI PIC  X(0005).
  5481*    -------------------------------
  5482     05  DIHOLDL PIC S9(0004) COMP.
  5483     05  DIHOLDF PIC  X(0001).
  5484     05  FILLER REDEFINES DIHOLDF.
  5485         10  DIHOLDA PIC  X(0001).
  5486     05  DIHOLDI PIC  X(0005).
  5487*    -------------------------------
  5488     05  DIAVAILL PIC S9(0004) COMP.
  5489     05  DIAVAILF PIC  X(0001).
  5490     05  FILLER REDEFINES DIAVAILF.
  5491         10  DIAVAILA PIC  X(0001).
  5492     05  DIAVAILI PIC  X(0005).
  5493*    -------------------------------
  5494     05  DIGPREML PIC S9(0004) COMP.
  5495     05  DIGPREMF PIC  X(0001).
  5496     05  FILLER REDEFINES DIGPREMF.
  5497         10  DIGPREMA PIC  X(0001).
  5498     05  DIGPREMI PIC  X(0011).
  5499*    -------------------------------
  5500     05  DIBPREML PIC S9(0004) COMP.
  5501     05  DIBPREMF PIC  X(0001).
  5502     05  FILLER REDEFINES DIBPREMF.
  5503         10  DIBPREMA PIC  X(0001).
  5504     05  DIBPREMI PIC  X(0011).
  5505*    -------------------------------
  5506     05  DCTOTALL PIC S9(0004) COMP.
  5507     05  DCTOTALF PIC  X(0001).
  5508     05  FILLER REDEFINES DCTOTALF.
  5509         10  DCTOTALA PIC  X(0001).
  5510     05  DCTOTALI PIC  X(0005).
  5511*    -------------------------------
  5512     05  DCFATALL PIC S9(0004) COMP.
  5513     05  DCFATALF PIC  X(0001).
  5514     05  FILLER REDEFINES DCFATALF.
  5515         10  DCFATALA PIC  X(0001).
  5516     05  DCFATALI PIC  X(0005).
  5517*    -------------------------------
  5518     05  DCFORCEL PIC S9(0004) COMP.
  5519     05  DCFORCEF PIC  X(0001).
  5520     05  FILLER REDEFINES DCFORCEF.
  5521         10  DCFORCEA PIC  X(0001).
  5522     05  DCFORCEI PIC  X(0005).
  5523*    -------------------------------
  5524     05  DCHOLDL PIC S9(0004) COMP.
  5525     05  DCHOLDF PIC  X(0001).
  5526     05  FILLER REDEFINES DCHOLDF.
  5527         10  DCHOLDA PIC  X(0001).
  5528     05  DCHOLDI PIC  X(0005).
  5529*    -------------------------------
  5530     05  DCAVAILL PIC S9(0004) COMP.
  5531     05  DCAVAILF PIC  X(0001).
  5532     05  FILLER REDEFINES DCAVAILF.
  5533         10  DCAVAILA PIC  X(0001).
  5534     05  DCAVAILI PIC  X(0005).
  5535*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 103
* EL6311.cbl
  5536     05  DCGPREML PIC S9(0004) COMP.
  5537     05  DCGPREMF PIC  X(0001).
  5538     05  FILLER REDEFINES DCGPREMF.
  5539         10  DCGPREMA PIC  X(0001).
  5540     05  DCGPREMI PIC  X(0011).
  5541*    -------------------------------
  5542     05  DCBPREML PIC S9(0004) COMP.
  5543     05  DCBPREMF PIC  X(0001).
  5544     05  FILLER REDEFINES DCBPREMF.
  5545         10  DCBPREMA PIC  X(0001).
  5546     05  DCBPREMI PIC  X(0011).
  5547*    -------------------------------
  5548     05  DNTOTALL PIC S9(0004) COMP.
  5549     05  DNTOTALF PIC  X(0001).
  5550     05  FILLER REDEFINES DNTOTALF.
  5551         10  DNTOTALA PIC  X(0001).
  5552     05  DNTOTALI PIC  X(0005).
  5553*    -------------------------------
  5554     05  DNFATALL PIC S9(0004) COMP.
  5555     05  DNFATALF PIC  X(0001).
  5556     05  FILLER REDEFINES DNFATALF.
  5557         10  DNFATALA PIC  X(0001).
  5558     05  DNFATALI PIC  X(0005).
  5559*    -------------------------------
  5560     05  DNFORCEL PIC S9(0004) COMP.
  5561     05  DNFORCEF PIC  X(0001).
  5562     05  FILLER REDEFINES DNFORCEF.
  5563         10  DNFORCEA PIC  X(0001).
  5564     05  DNFORCEI PIC  X(0005).
  5565*    -------------------------------
  5566     05  DNHOLDL PIC S9(0004) COMP.
  5567     05  DNHOLDF PIC  X(0001).
  5568     05  FILLER REDEFINES DNHOLDF.
  5569         10  DNHOLDA PIC  X(0001).
  5570     05  DNHOLDI PIC  X(0005).
  5571*    -------------------------------
  5572     05  DNAVAILL PIC S9(0004) COMP.
  5573     05  DNAVAILF PIC  X(0001).
  5574     05  FILLER REDEFINES DNAVAILF.
  5575         10  DNAVAILA PIC  X(0001).
  5576     05  DNAVAILI PIC  X(0005).
  5577*    -------------------------------
  5578     05  DNGPREML PIC S9(0004) COMP.
  5579     05  DNGPREMF PIC  X(0001).
  5580     05  FILLER REDEFINES DNGPREMF.
  5581         10  DNGPREMA PIC  X(0001).
  5582     05  DNGPREMI PIC  X(0011).
  5583*    -------------------------------
  5584     05  DNBPREML PIC S9(0004) COMP.
  5585     05  DNBPREMF PIC  X(0001).
  5586     05  FILLER REDEFINES DNBPREMF.
  5587         10  DNBPREMA PIC  X(0001).
  5588     05  DNBPREMI PIC  X(0011).
  5589*    -------------------------------
  5590     05  DERMSGL PIC S9(0004) COMP.
  5591     05  DERMSGF PIC  X(0001).
  5592     05  FILLER REDEFINES DERMSGF.
  5593         10  DERMSGA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 104
* EL6311.cbl
  5594     05  DERMSGI PIC  X(0075).
  5595*    -------------------------------
  5596     05  DPFENTRL PIC S9(0004) COMP.
  5597     05  DPFENTRF PIC  X(0001).
  5598     05  FILLER REDEFINES DPFENTRF.
  5599         10  DPFENTRA PIC  X(0001).
  5600     05  DPFENTRI PIC  9(2).
  5601 01  EL631DO REDEFINES EL631BI.
  5602     05  FILLER            PIC  X(0012).
  5603*    -------------------------------
  5604     05  FILLER            PIC  X(0003).
  5605     05  DDATEO PIC  X(0008).
  5606*    -------------------------------
  5607     05  FILLER            PIC  X(0003).
  5608     05  DTIMEO PIC  99.99.
  5609*    -------------------------------
  5610     05  FILLER            PIC  X(0003).
  5611     05  DHEADO PIC  X(0038).
  5612*    -------------------------------
  5613     05  FILLER            PIC  X(0003).
  5614     05  DLDATEO PIC  X(0010).
  5615*    -------------------------------
  5616     05  FILLER            PIC  X(0003).
  5617     05  DBATCHO PIC  X(0011).
  5618*    -------------------------------
  5619     05  FILLER            PIC  X(0003).
  5620     05  DACCTNMO PIC  X(0030).
  5621*    -------------------------------
  5622     05  FILLER            PIC  X(0003).
  5623     05  DPROCDTO PIC  X(0008).
  5624*    -------------------------------
  5625     05  FILLER            PIC  X(0003).
  5626     05  DINPUTO PIC  X(0008).
  5627*    -------------------------------
  5628     05  FILLER            PIC  X(0003).
  5629     05  DMAINDTO PIC  X(0008).
  5630*    -------------------------------
  5631     05  FILLER            PIC  X(0003).
  5632     05  DCARRO PIC  X(0001).
  5633*    -------------------------------
  5634     05  FILLER            PIC  X(0003).
  5635     05  DGROUPO PIC  X(0006).
  5636*    -------------------------------
  5637     05  FILLER            PIC  X(0003).
  5638     05  DSTATEO PIC  X(0002).
  5639*    -------------------------------
  5640     05  FILLER            PIC  X(0003).
  5641     05  DACCTO PIC  X(0010).
  5642*    -------------------------------
  5643     05  FILLER            PIC  X(0003).
  5644     05  DRECVDTO PIC  X(0008).
  5645*    -------------------------------
  5646     05  FILLER            PIC  X(0003).
  5647     05  DCSRO PIC  X(0004).
  5648*    -------------------------------
  5649     05  FILLER            PIC  X(0003).
  5650     05  DREFHDGO PIC  X(0010).
  5651*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 105
* EL6311.cbl
  5652     05  FILLER            PIC  X(0003).
  5653     05  DREFO PIC  X(0012).
  5654*    -------------------------------
  5655     05  FILLER            PIC  X(0003).
  5656     05  DLFPHDGO PIC  X(0010).
  5657*    -------------------------------
  5658     05  FILLER            PIC  X(0003).
  5659     05  DAHPHDGO PIC  X(0010).
  5660*    -------------------------------
  5661     05  FILLER            PIC  X(0003).
  5662     05  DLFRHDGO PIC  X(0009).
  5663*    -------------------------------
  5664     05  FILLER            PIC  X(0003).
  5665     05  DAHRHDGO PIC  X(0009).
  5666*    -------------------------------
  5667     05  FILLER            PIC  X(0003).
  5668     05  DRISSO PIC  ZZ99-.
  5669*    -------------------------------
  5670     05  FILLER            PIC  X(0003).
  5671     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5672*    -------------------------------
  5673     05  FILLER            PIC  X(0003).
  5674     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5675*    -------------------------------
  5676     05  FILLER            PIC  X(0003).
  5677     05  DRCANCO PIC  ZZ99-.
  5678*    -------------------------------
  5679     05  FILLER            PIC  X(0003).
  5680     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5681*    -------------------------------
  5682     05  FILLER            PIC  X(0003).
  5683     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5684*    -------------------------------
  5685     05  FILLER            PIC  X(0003).
  5686     05  DEISSO PIC  ZZ99-.
  5687*    -------------------------------
  5688     05  FILLER            PIC  X(0003).
  5689     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5690*    -------------------------------
  5691     05  FILLER            PIC  X(0003).
  5692     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5693*    -------------------------------
  5694     05  FILLER            PIC  X(0003).
  5695     05  DECANCO PIC  ZZ99-.
  5696*    -------------------------------
  5697     05  FILLER            PIC  X(0003).
  5698     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5699*    -------------------------------
  5700     05  FILLER            PIC  X(0003).
  5701     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5702*    -------------------------------
  5703     05  FILLER            PIC  X(0003).
  5704     05  DCISSO PIC  ZZ99-.
  5705*    -------------------------------
  5706     05  FILLER            PIC  X(0003).
  5707     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5708*    -------------------------------
  5709     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 106
* EL6311.cbl
  5710     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5711*    -------------------------------
  5712     05  FILLER            PIC  X(0003).
  5713     05  DCCANCO PIC  ZZ99-.
  5714*    -------------------------------
  5715     05  FILLER            PIC  X(0003).
  5716     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5717*    -------------------------------
  5718     05  FILLER            PIC  X(0003).
  5719     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5720*    -------------------------------
  5721     05  FILLER            PIC  X(0003).
  5722     05  DOISSO PIC  ZZ99-.
  5723*    -------------------------------
  5724     05  FILLER            PIC  X(0003).
  5725     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5726*    -------------------------------
  5727     05  FILLER            PIC  X(0003).
  5728     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5729*    -------------------------------
  5730     05  FILLER            PIC  X(0003).
  5731     05  DOCANCO PIC  ZZ99-.
  5732*    -------------------------------
  5733     05  FILLER            PIC  X(0003).
  5734     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5735*    -------------------------------
  5736     05  FILLER            PIC  X(0003).
  5737     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5738*    -------------------------------
  5739     05  FILLER            PIC  X(0003).
  5740     05  DITOTALO PIC  ZZZ99.
  5741*    -------------------------------
  5742     05  FILLER            PIC  X(0003).
  5743     05  DIFATALO PIC  ZZZ99.
  5744*    -------------------------------
  5745     05  FILLER            PIC  X(0003).
  5746     05  DIFORCEO PIC  ZZZ99.
  5747*    -------------------------------
  5748     05  FILLER            PIC  X(0003).
  5749     05  DIHOLDO PIC  ZZZ99.
  5750*    -------------------------------
  5751     05  FILLER            PIC  X(0003).
  5752     05  DIAVAILO PIC  ZZZ99.
  5753*    -------------------------------
  5754     05  FILLER            PIC  X(0003).
  5755     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5756*    -------------------------------
  5757     05  FILLER            PIC  X(0003).
  5758     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5759*    -------------------------------
  5760     05  FILLER            PIC  X(0003).
  5761     05  DCTOTALO PIC  ZZZ99.
  5762*    -------------------------------
  5763     05  FILLER            PIC  X(0003).
  5764     05  DCFATALO PIC  ZZZ99.
  5765*    -------------------------------
  5766     05  FILLER            PIC  X(0003).
  5767     05  DCFORCEO PIC  ZZZ99.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 107
* EL6311.cbl
  5768*    -------------------------------
  5769     05  FILLER            PIC  X(0003).
  5770     05  DCHOLDO PIC  ZZZ99.
  5771*    -------------------------------
  5772     05  FILLER            PIC  X(0003).
  5773     05  DCAVAILO PIC  ZZZ99.
  5774*    -------------------------------
  5775     05  FILLER            PIC  X(0003).
  5776     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5777*    -------------------------------
  5778     05  FILLER            PIC  X(0003).
  5779     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5780*    -------------------------------
  5781     05  FILLER            PIC  X(0003).
  5782     05  DNTOTALO PIC  ---99.
  5783*    -------------------------------
  5784     05  FILLER            PIC  X(0003).
  5785     05  DNFATALO PIC  ---99.
  5786*    -------------------------------
  5787     05  FILLER            PIC  X(0003).
  5788     05  DNFORCEO PIC  ---99.
  5789*    -------------------------------
  5790     05  FILLER            PIC  X(0003).
  5791     05  DNHOLDO PIC  ---99.
  5792*    -------------------------------
  5793     05  FILLER            PIC  X(0003).
  5794     05  DNAVAILO PIC  ---99.
  5795*    -------------------------------
  5796     05  FILLER            PIC  X(0003).
  5797     05  DNGPREMO PIC  -------9.99.
  5798*    -------------------------------
  5799     05  FILLER            PIC  X(0003).
  5800     05  DNBPREMO PIC  -------9.99.
  5801*    -------------------------------
  5802     05  FILLER            PIC  X(0003).
  5803     05  DERMSGO PIC  X(0075).
  5804*    -------------------------------
  5805     05  FILLER            PIC  X(0003).
  5806     05  DPFENTRO PIC  X(0002).
  5807*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 108
* EL6311.cbl
  5809 01  MAP-B REDEFINES EL631BI.
  5810     12  FILLER                  PIC X(595).
  5811*    12  FILLER                  PIC X(591).
  5812*    12  FILLER                  PIC X(512).
  5813*    12  FILLER                  PIC X(510).
  5814     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5815         16  BKIND-LEN               PIC S9(4)  COMP.
  5816         16  BKIND-ATTRB             PIC X.
  5817         16  BKIND                   PIC XX.
  5818         16  BTYPE-LEN               PIC S9(4)  COMP.
  5819         16  BTYPE-ATTRB             PIC X.
  5820         16  BTYPE                   PIC X(3).
  5821         16  BTERM-LEN               PIC S9(4)  COMP.
  5822         16  BTERM-ATTRB             PIC X.
  5823         16  BTERMI                  PIC 999.
  5824         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5825         16  BBEN-LEN                PIC S9(4)  COMP.
  5826         16  BBEN-ATTRB              PIC X.
  5827         16  BBENI                   PIC 9(10)V99.
  5828*        16  BBENI                   PIC 9(12).
  5829         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5830         16  BPREM-LEN               PIC S9(4)  COMP.
  5831         16  BPREM-ATTRB             PIC X.
  5832         16  BPREMI                  PIC S9(9)V99.
  5833*        16  BPREMI                  PIC 9(11).
  5834         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5835         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5836         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5837         16  BEXPIRE-ATTRB           PIC X.
  5838         16  BEXPIRE                 PIC X(8).
  5839         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5840         16  BCRIT-PERD-ATTRB        PIC X.
  5841         16  BCRIT-PERDI             PIC 99.
  5842         16  BCRIT-PERDO REDEFINES
  5843                         BCRIT-PERDI PIC ZZ.
  5844         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5845         16  BALT-BEN-ATTRB          PIC X.
  5846         16  BALT-BENI               PIC 9(10)V99.
  5847*        16  BALT-BENI               PIC 9(12).
  5848         16  BALT-BENO REDEFINES
  5849                           BALT-BENI PIC Z(9).ZZ.
  5850         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5851         16  BALT-PREM-ATTRB         PIC X.
  5852         16  BALT-PREMI              PIC 9(9)V99.
  5853*        16  BALT-PREMI              PIC 9(11).
  5854         16  BALT-PREMO REDEFINES
  5855                          BALT-PREMI PIC Z(7).ZZ-.
  5856         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5857         16  BBEN-CD-ATTRB           PIC X.
  5858         16  BBEN-CD                 PIC XXX.
  5859         16  BCPREM-LEN              PIC S9(4)  COMP.
  5860         16  BCPREM-ATTRB            PIC X.
  5861         16  BCPREMI                 PIC S9(9)V99.
  5862*        16  BCPREMI                 PIC X(11).
  5863         16  BCPREMO REDEFINES BCPREMI
  5864                                     PIC Z(7).99-.
  5865         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5866         16  BCALT-PREM-ATTRB        PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 109
* EL6311.cbl
  5867         16  BCALT-PREM              PIC Z(7).99-.
  5868         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5869         16  BBEN-ABBR-ATTRB         PIC X.
  5870         16  BBEN-ABBR               PIC X(5).
  5871         16  BDIFF-LEN               PIC S9(4)  COMP.
  5872         16  BDIFF-ATTRB             PIC X.
  5873         16  BDIFFO                  PIC Z(7).99-.
  5874         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5875         16  BBILL-LIT-ATTRB         PIC X.
  5876         16  BBILL-LIT               PIC X(8).
  5877         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5878         16  BDALT-PREM-ATTRB        PIC X.
  5879         16  BDALT-PREM              PIC Z(7).99-.
  5880
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 110
* EL6311.cbl
  5882
  5883****************************************************************
  5884*
  5885* Copyright (c) 2007-2013 Dell Inc.
  5886* All rights reserved.
  5887*
  5888****************************************************************
  5889 01  DFHEIV.
  5890   02  DFHEIV0               PIC X(35).
  5891   02  DFHEIV1               PIC X(08).
  5892   02  DFHEIV2               PIC X(08).
  5893   02  DFHEIV3               PIC X(08).
  5894   02  DFHEIV4               PIC X(06).
  5895   02  DFHEIV5               PIC X(04).
  5896   02  DFHEIV6               PIC X(04).
  5897   02  DFHEIV7               PIC X(02).
  5898   02  DFHEIV8               PIC X(02).
  5899   02  DFHEIV9               PIC X(01).
  5900   02  DFHEIV10              PIC S9(7) COMP-3.
  5901   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5902   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5903   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5904   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5905   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5906   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5907   02  DFHEIV17              PIC X(04).
  5908   02  DFHEIV18              PIC X(04).
  5909   02  DFHEIV19              PIC X(04).
  5910   02  DFHEIV20              USAGE IS POINTER.
  5911   02  DFHEIV21              USAGE IS POINTER.
  5912   02  DFHEIV22              USAGE IS POINTER.
  5913   02  DFHEIV23              USAGE IS POINTER.
  5914   02  DFHEIV24              USAGE IS POINTER.
  5915   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5916   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5917   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5918   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5919   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5920   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5921   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5922   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5923   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5924   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5925   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5926   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5927   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5928   02  FILLER                PIC X(02).
  5929   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5930   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5931   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5932   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5933   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5934   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5935   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5936 LINKAGE  SECTION.
  5937*****************************************************************
  5938*                                                               *
  5939* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 111
* EL6311.cbl
  5940* All rights reserved.                                          *
  5941*                                                               *
  5942*****************************************************************
  5943 01  dfheiblk.
  5944     02  eibtime          pic s9(7) comp-3.
  5945     02  eibdate          pic s9(7) comp-3.
  5946     02  eibtrnid         pic x(4).
  5947     02  eibtaskn         pic s9(7) comp-3.
  5948     02  eibtrmid         pic x(4).
  5949     02  dfheigdi         pic s9(4) comp.
  5950     02  eibcposn         pic s9(4) comp.
  5951     02  eibcalen         pic s9(4) comp.
  5952     02  eibaid           pic x(1).
  5953     02  eibfiller1       pic x(1).
  5954     02  eibfn            pic x(2).
  5955     02  eibfiller2       pic x(2).
  5956     02  eibrcode         pic x(6).
  5957     02  eibfiller3       pic x(2).
  5958     02  eibds            pic x(8).
  5959     02  eibreqid         pic x(8).
  5960     02  eibrsrce         pic x(8).
  5961     02  eibsync          pic x(1).
  5962     02  eibfree          pic x(1).
  5963     02  eibrecv          pic x(1).
  5964     02  eibsend          pic x(1).
  5965     02  eibatt           pic x(1).
  5966     02  eibeoc           pic x(1).
  5967     02  eibfmh           pic x(1).
  5968     02  eibcompl         pic x(1).
  5969     02  eibsig           pic x(1).
  5970     02  eibconf          pic x(1).
  5971     02  eiberr           pic x(1).
  5972     02  eibrldbk         pic x(1).
  5973     02  eiberrcd         pic x(4).
  5974     02  eibsynrb         pic x(1).
  5975     02  eibnodat         pic x(1).
  5976     02  eibfiller5       pic x(2).
  5977     02  eibresp          pic s9(8) comp.
  5978     02  eibresp2         pic s9(8) comp.
  5979     02  dfheigdj         pic s9(4) comp.
  5980     02  dfheigdk         pic s9(4) comp.
  5981 01  DFHCOMMAREA                 PIC X(1300).
  5982*                                COPY ERCPNDB.
  5983******************************************************************
  5984*                                                                *
  5985*                                                                *
  5986*                            ERCPNDB.                            *
  5987*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5988*                            VMOD=2.025                          *
  5989*                                                                *
  5990*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5991*                                                                *
  5992******************************************************************
  5993*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5994*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5995******************************************************************
  5996*                                                                *
  5997*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 112
* EL6311.cbl
  5998*   FILE TYPE = VSAM,KSDS                                        *
  5999*   RECORD SIZE = 585  RECFORM = FIXED                           *
  6000*                                                                *
  6001*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  6002*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  6003*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  6004*                                                 RKP=13,LEN=36  *
  6005*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  6006*                                      AND CHG-SEQ.)             *
  6007*                                                RKP=49,LEN=11   *
  6008*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  6009*                                      AND CHG-SEQ.)             *
  6010*                                                RKP=60,LEN=15   *
  6011*                                                                *
  6012*   LOG = NO                                                     *
  6013*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6014******************************************************************
  6015******************************************************************
  6016*                   C H A N G E   L O G
  6017*
  6018* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6019*-----------------------------------------------------------------
  6020*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6021* EFFECTIVE    NUMBER
  6022*-----------------------------------------------------------------
  6023* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6024* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6025* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  6026* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6027* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  6028* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6029* 032306                   PEMA  ADD BOW LOAN NUMBER
  6030* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  6031* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  6032* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6033* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6034* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  6035* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  6036* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6037* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  6038* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  6039* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6040* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  6041* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6042* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  6043******************************************************************
  6044
  6045 01  PENDING-BUSINESS.
  6046     12  PB-RECORD-ID                     PIC XX.
  6047         88  VALID-PB-ID                        VALUE 'PB'.
  6048
  6049     12  PB-CONTROL-PRIMARY.
  6050         16  PB-COMPANY-CD                PIC X.
  6051         16  PB-ENTRY-BATCH               PIC X(6).
  6052         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  6053         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  6054
  6055     12  PB-CONTROL-BY-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 113
* EL6311.cbl
  6056         16  PB-COMPANY-CD-A1             PIC X.
  6057         16  PB-CARRIER                   PIC X.
  6058         16  PB-GROUPING.
  6059             20  PB-GROUPING-PREFIX       PIC XXX.
  6060             20  PB-GROUPING-PRIME        PIC XXX.
  6061         16  PB-STATE                     PIC XX.
  6062         16  PB-ACCOUNT.
  6063             20  PB-ACCOUNT-PREFIX        PIC X(4).
  6064             20  PB-ACCOUNT-PRIME         PIC X(6).
  6065         16  PB-CERT-EFF-DT               PIC XX.
  6066         16  PB-CERT-NO.
  6067             20  PB-CERT-PRIME            PIC X(10).
  6068             20  PB-CERT-SFX              PIC X.
  6069         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  6070
  6071         16  PB-RECORD-TYPE               PIC X.
  6072             88  PB-MAILING-DATA                VALUE '0'.
  6073             88  PB-ISSUE                       VALUE '1'.
  6074             88  PB-CANCELLATION                VALUE '2'.
  6075             88  PB-BATCH-TRAILER               VALUE '9'.
  6076
  6077     12  PB-CONTROL-BY-ORIG-BATCH.
  6078         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  6079         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  6080         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  6081         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  6082
  6083     12  PB-CONTROL-BY-CSR.
  6084         16  PB-CSR-COMPANY-CD            PIC X.
  6085         16  PB-CSR-ID                    PIC X(4).
  6086         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  6087         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  6088         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  6089******************************************************************
  6090*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  6091******************************************************************
  6092
  6093     12  PB-LAST-MAINT-DT                 PIC XX.
  6094     12  PB-LAST-MAINT-BY                 PIC X(4).
  6095     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  6096
  6097     12  PB-RECORD-BODY                   PIC X(375).
  6098
  6099     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  6100         16  PB-CERT-ORIGIN               PIC X.
  6101             88  CLASIC-CREATED-CERT         VALUE '1'.
  6102         16  PB-I-NAME.
  6103             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  6104             20  PB-I-INSURED-FIRST-NAME.
  6105                 24  PB-I-INSURED-1ST-INIT PIC X.
  6106                 24  FILLER                PIC X(9).
  6107             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  6108         16  PB-I-AGE                     PIC S99   COMP-3.
  6109         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  6110         16  PB-I-BIRTHDAY                PIC XX.
  6111         16  PB-I-INSURED-SEX             PIC X.
  6112             88  PB-SEX-MALE     VALUE 'M'.
  6113             88  PB-SEX-FEMALE   VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 114
* EL6311.cbl
  6114
  6115         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  6116         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  6117         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  6118         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  6119         16  PB-I-SKIP-CODE               PIC X.
  6120             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  6121             88  PB-SKIP-JULY              VALUE '1'.
  6122             88  PB-SKIP-AUGUST            VALUE '2'.
  6123             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  6124             88  PB-SKIP-JULY-AUG          VALUE '4'.
  6125             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  6126             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  6127             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  6128             88  PB-SKIP-JUNE              VALUE '8'.
  6129             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6130             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6131             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6132         16  PB-I-TERM-TYPE               PIC X.
  6133             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6134             88  PB-PAID-WEEKLY            VALUE 'W'.
  6135             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6136             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6137             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6138         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6139         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6140         16  PB-I-DATA-ENTRY-SW           PIC X.
  6141             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6142             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6143             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6144             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6145         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6146         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6147*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6148         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6149         16  PB-I-LETTER-REQD             PIC X.
  6150
  6151         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6152             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6153             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6154                                                   '90' THRU '99'.
  6155         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6156                                          PIC XX.
  6157         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6158         16  PB-I-AMOUNT-FINANCED REDEFINES
  6159                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6160         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6161         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6162                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6163         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6164         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6165         16  PB-I-CLP-AMOUNT REDEFINES
  6166                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6167         16  PB-I-LF-CALC-FLAG            PIC X.
  6168             88 PB-COMP-LF-PREM               VALUE '?'.
  6169         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6170         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6171         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 115
* EL6311.cbl
  6172         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6173         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6174         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6175         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6176         16  PB-I-LF-ABBR                 PIC XXX.
  6177         16  PB-I-LF-INPUT-CD             PIC XX.
  6178
  6179         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6180             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6181             88  PB-INVALID-AH               VALUE '  ' '00'
  6182                                                   '90' THRU '99'.
  6183         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6184         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6185         16  PB-I-AH-CALC-FLAG            PIC X.
  6186             88 PB-COMP-AH-PREM                  VALUE '?'.
  6187         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6188         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6189         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6190         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6191         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6192         16  PB-I-AH-ABBR                 PIC XXX.
  6193         16  PB-I-AH-INPUT-CD             PIC XXX.
  6194
  6195         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6196         16  PB-I-REIN-TABLE              PIC XXX.
  6197         16  PB-I-BUSINESS-TYPE           PIC 99.
  6198         16  PB-I-INDV-GRP-CD             PIC X.
  6199         16  PB-I-MORT-CODE.
  6200             20  PB-I-TABLE               PIC X.
  6201             20  PB-I-INTEREST            PIC XX.
  6202             20  PB-I-MORT-TYP            PIC X.
  6203         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6204         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6205         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6206         16  PB-I-INDV-GRP-OVRD           PIC X.
  6207         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6208         16  PB-I-SIG-SW                  PIC X.
  6209             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6210         16  PB-I-RATE-CLASS              PIC XX.
  6211         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6212         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6213         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6214         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6215         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6216         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6217         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6218         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6219         16  PB-I-OB-FLAG                 PIC X.
  6220             88  PB-I-OB                      VALUE 'B'.
  6221             88  PB-I-SUMMARY                 VALUE 'Z'.
  6222         16  PB-I-ENTRY-STATUS            PIC X.
  6223             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6224                                              'M' '5' '9' '2'.
  6225             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6226             88  PB-I-POLICY-PENDING          VALUE '2'.
  6227             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6228             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6229             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 116
* EL6311.cbl
  6230             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6231             88  PB-I-REIN-ONLY               VALUE '9'.
  6232             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6233             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6234             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6235             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6236         16  PB-I-INT-CODE                PIC X.
  6237             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6238             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6239         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6240         16  PB-I-SOC-SEC-NO              PIC X(11).
  6241         16  PB-I-MEMBER-NO               PIC X(12).
  6242         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6243*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6244         16  PB-I-OLD-LOF                 PIC XXX.
  6245         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6246         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6247         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6248         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6249         16  PB-I-LIFE-INDICATOR          PIC X.
  6250             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6251         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6252         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6253                                          PIC S9(5)V99    COMP-3.
  6254         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6255             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6256             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6257         16  PB-I-1ST-PMT-DT              PIC XX.
  6258         16  PB-I-JOINT-INSURED.
  6259             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6260             20 PB-I-JOINT-FIRST-NAME.
  6261                24  PB-I-JOINT-FIRST-INIT PIC X.
  6262                24  FILLER                PIC X(9).
  6263             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6264*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6265         16  PB-I-BENEFICIARY-NAME.
  6266             20  PB-I-BANK-NUMBER         PIC X(10).
  6267             20  FILLER                   PIC X(15).
  6268         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6269         16  PB-I-REFERENCE               PIC X(12).
  6270         16  FILLER REDEFINES PB-I-REFERENCE.
  6271             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6272             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6273             20  PB-I-CLP-STATE           PIC XX.
  6274         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6275             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6276             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6277             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6278         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6279         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6280         16  PB-I-RESIDENT-STATE          PIC XX.
  6281         16  PB-I-RATE-CODE               PIC X(4).
  6282         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6283         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6284         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6285         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6286         16  PB-I-BANK-NOCHRGB            PIC 99.
  6287         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 117
* EL6311.cbl
  6288         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6289
  6290     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6291         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6292             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6293         16  PB-C-CANCEL-ORIGIN           PIC X.
  6294             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6295         16  PB-C-LF-CANCEL-DT            PIC XX.
  6296         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6297         16  PB-C-LF-CALC-REQ             PIC X.
  6298             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6299         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6300         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6301         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6302             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6303         16  PB-C-AH-CANCEL-DT            PIC XX.
  6304         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6305         16  PB-C-AH-CALC-REQ             PIC X.
  6306             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6307         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6308         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6309         16  PB-C-LAST-NAME               PIC X(15).
  6310         16  PB-C-REFUND-SW               PIC X.
  6311             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6312             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6313         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6314         16  PB-C-PAYEE-CODE              PIC X(6).
  6315         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6316         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6317         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6318         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6319         16  PB-C-REFERENCE               PIC X(12).
  6320         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6321         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6322         16  PB-C-POST-CARD-IND           PIC X.
  6323         16  PB-C-CANCEL-REASON           PIC X.
  6324         16  PB-C-REF-INTERFACE-SW        PIC X.
  6325         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6326         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6327         16  FILLER                       PIC X(01).
  6328*        16  FILLER                       PIC X(18).
  6329         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6330*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6331         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  6332         16  PB-CANCELED-CERT-DATA.
  6333             20  PB-CI-INSURED-NAME.
  6334                 24  PB-CI-LAST-NAME      PIC X(15).
  6335                 24  PB-CI-INITIALS       PIC XX.
  6336             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6337             20  PB-CI-INSURED-SEX        PIC X.
  6338             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6339             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6340             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6341             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6342             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6343             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6344             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6345             20  PB-CI-AH-BENEFIT-CD      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 118
* EL6311.cbl
  6346             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6347             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6348             20  PB-CI-RATE-CLASS         PIC XX.
  6349             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6350             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6351             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6352             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6353             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6354             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6355             20  PB-CI-LF-ABBR            PIC X(3).
  6356             20  PB-CI-AH-ABBR            PIC X(3).
  6357             20  PB-CI-OB-FLAG            PIC X.
  6358                 88  PB-CI-OB                VALUE 'B'.
  6359             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6360                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6361                                           'M' '4' '5' '9' '2'.
  6362                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6363                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6364                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6365                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6366                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6367                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6368                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6369                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6370                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6371                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6372                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6373                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6374                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6375             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6376                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6377                                           'M' '4' '5' '9' '2'.
  6378                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6379                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6380                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6381                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6382                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6383                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6384                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6385                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6386                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6387                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6388                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6389                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6390                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6391             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6392             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6393             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6394             20  PB-CI-MEMBER-NO          PIC X(12).
  6395             20  PB-CI-INT-CODE           PIC X.
  6396                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6397                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6398             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6399             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6400             20  PB-CI-COMP-EXCP-SW       PIC X.
  6401                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6402                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6403             20  PB-CI-ENTRY-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 119
* EL6311.cbl
  6404             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6405             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6406             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6407             20  PB-CI-DEATH-DT           PIC XX.
  6408             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6409             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6410             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6411             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6412             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6413             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6414             20  PB-CI-ENTRY-DT              PIC XX.
  6415             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6416             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6417             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6418             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6419             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6420             20  PB-CI-OLD-LOF               PIC XXX.
  6421*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6422             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6423             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6424             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6425             20  PB-CI-INDV-GRP-CD           PIC X.
  6426             20  PB-CI-BENEFICIARY-NAME.
  6427                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6428                 24  FILLER                  PIC X(15).
  6429             20  PB-CI-NOTE-SW               PIC X.
  6430             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6431             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6432             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6433             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6434             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6435             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6436             20  PB-CI-FIRST-NAME            PIC X(10).
  6437             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6438
  6439         16  FILLER                       PIC X(13).
  6440*032306  16  FILLER                       PIC X(27).
  6441*        16  FILLER                       PIC X(46).
  6442
  6443     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6444         16  FILLER                       PIC X(10).
  6445         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6446         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6447         16  PB-M-INSURED-MID-INIT        PIC X.
  6448         16  PB-M-INSURED-AGE             PIC 99.
  6449         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6450         16  PB-M-INSURED-SEX             PIC X.
  6451         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6452         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6453         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6454         16  PB-M-INSURED-CITY-STATE.
  6455             20  PB-M-INSURED-CITY        PIC X(28).
  6456             20  PB-M-INSURED-STATE       PIC XX.
  6457         16  PB-M-INSURED-ZIP-CODE.
  6458             20  PB-M-INSURED-ZIP-PRIME.
  6459                 24  PB-M-INSURED-ZIP-1   PIC X.
  6460                     88  PB-M-CANADIAN-POST-CODE
  6461                                             VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 120
* EL6311.cbl
  6462                 24  FILLER               PIC X(4).
  6463             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6464         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6465                                        PB-M-INSURED-ZIP-CODE.
  6466             20  PM-M-INS-CAN-POST1       PIC XXX.
  6467             20  PM-M-INS-CAN-POST2       PIC XXX.
  6468             20  FILLER                   PIC XXX.
  6469         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6470         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6471         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6472         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6473         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6474         16  PB-M-CRED-BENE-CITYST.
  6475             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6476             20  PB-M-CRED-BENE-STATE     PIC XX.
  6477         16  FILLER                       PIC X(92).
  6478
  6479     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6480         16  FILLER                       PIC X(10).
  6481         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6482         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6483         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6484         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6485         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6486         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6487         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6488         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6489         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6490         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6491         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6492         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6493         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6494         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6495         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6496         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6497         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6498         16  PB-ACCOUNT-NAME              PIC X(30).
  6499         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6500         16  PB-REFERENCE                 PIC X(12).
  6501         16  PB-B-RECEIVED-DT             PIC XX.
  6502         16  FILLER                       PIC X(234).
  6503
  6504     12  PB-RECORD-STATUS.
  6505         16  PB-CREDIT-SELECT-DT          PIC XX.
  6506         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6507         16  PB-BILLED-DT                 PIC XX.
  6508         16  PB-BILLING-STATUS            PIC X.
  6509             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6510             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6511             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6512         16  PB-RECORD-BILL               PIC X.
  6513             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6514             88  PB-RECORD-RETURNED           VALUE 'R'.
  6515             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6516             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6517             88  PB-OVERRIDE-AH               VALUE 'A'.
  6518             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6519         16  PB-BATCH-ENTRY               PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 121
* EL6311.cbl
  6520             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6521             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6522             88  PB-REISSUED-CERT             VALUE 'E'.
  6523             88  PB-CASH-CERT                 VALUE 'C'.
  6524             88  PB-MONTHLY-CERT              VALUE 'M'.
  6525             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6526             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6527             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6528         16  PB-FORCE-CODE                PIC X.
  6529             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6530             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6531             88  PB-CANCEL-FORCE              VALUE '8'.
  6532             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6533             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6534             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6535             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6536             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6537             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6538             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6539             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6540         16  PB-FATAL-FLAG                PIC X.
  6541             88  PB-FATAL-ERRORS              VALUE 'X'.
  6542         16  PB-FORCE-ER-CD               PIC X.
  6543             88  PB-FORCE-ERRORS              VALUE 'F'.
  6544             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6545         16  PB-WARN-ER-CD                PIC X.
  6546             88  PB-WARNING-ERRORS            VALUE 'W'.
  6547         16  FILLER                       PIC X.
  6548         16  PB-OUT-BAL-CD                PIC X.
  6549             88  PB-OUT-OF-BAL                VALUE 'O'.
  6550         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6551         16  PB-AH-OVERRIDE-L1            PIC X.
  6552         16  PB-INPUT-DT                  PIC XX.
  6553         16  PB-INPUT-BY                  PIC X(4).
  6554         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6555         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6556         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6557         16  PB-LF-EARNING-METHOD         PIC X.
  6558         16  PB-AH-EARNING-METHOD         PIC X.
  6559         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6560         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6561         16  PB-REIN-CD                   PIC XXX.
  6562         16  PB-LF-REFUND-TYPE            PIC X.
  6563         16  PB-AH-REFUND-TYPE            PIC X.
  6564         16  PB-ACCT-EFF-DT               PIC XX.
  6565         16  PB-ACCT-EXP-DT               PIC XX.
  6566         16  PB-COMPANY-ID                PIC X(3).
  6567         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6568         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6569         16  PB-SV-CARRIER                PIC X.
  6570         16  PB-SV-GROUPING               PIC X(6).
  6571         16  PB-SV-STATE                  PIC XX.
  6572         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6573         16  PB-GA-BILLING-INFO.
  6574             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6575                                          PIC XX.
  6576         16  PB-SV-REMIT-TO  REDEFINES
  6577             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 122
* EL6311.cbl
  6578         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6579         16  PB-I-LOAN-OFFICER            PIC X(5).
  6580         16  PB-I-VIN                     PIC X(17).
  6581
  6582         16  FILLER                       PIC X(04).
  6583         16  IMNET-BYPASS-SW              PIC X.
  6584
  6585******************************************************************
  6586*                COMMON EDIT ERRORS                              *
  6587******************************************************************
  6588
  6589     12  PB-COMMON-ERRORS.
  6590         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6591                                           PIC S9(4)     COMP.
  6592
  6593******************************************************************
  6594*                                COPY ELCCERT.
  6595******************************************************************
  6596*                                                                *
  6597*                            ELCCERT.                            *
  6598*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6599*                            VMOD=2.013                          *
  6600*                                                                *
  6601*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6602*                                                                *
  6603*   FILE TYPE = VSAM,KSDS                                        *
  6604*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6605*                                                                *
  6606*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6607*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6608*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6609*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6610*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6611*                                                                *
  6612*   LOG = YES                                                    *
  6613*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6614******************************************************************
  6615*                   C H A N G E   L O G
  6616*
  6617* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6618*-----------------------------------------------------------------
  6619*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6620* EFFECTIVE    NUMBER
  6621*-----------------------------------------------------------------
  6622* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6623* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6624* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6625* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6626* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6627* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6628* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6629* 032612  CR2011110200001  PEMA  AHL CHANGES
  6630* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6631* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6632* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6633******************************************************************
  6634
  6635 01  CERTIFICATE-MASTER.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 123
* EL6311.cbl
  6636     12  CM-RECORD-ID                      PIC XX.
  6637         88  VALID-CM-ID                      VALUE 'CM'.
  6638
  6639     12  CM-CONTROL-PRIMARY.
  6640         16  CM-COMPANY-CD                 PIC X.
  6641         16  CM-CARRIER                    PIC X.
  6642         16  CM-GROUPING.
  6643             20  CM-GROUPING-PREFIX        PIC X(3).
  6644             20  CM-GROUPING-PRIME         PIC X(3).
  6645         16  CM-STATE                      PIC XX.
  6646         16  CM-ACCOUNT.
  6647             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6648             20  CM-ACCOUNT-PRIME          PIC X(6).
  6649         16  CM-CERT-EFF-DT                PIC XX.
  6650         16  CM-CERT-NO.
  6651             20  CM-CERT-PRIME             PIC X(10).
  6652             20  CM-CERT-SFX               PIC X.
  6653
  6654     12  CM-CONTROL-BY-NAME.
  6655         16  CM-COMPANY-CD-A1              PIC X.
  6656         16  CM-INSURED-LAST-NAME          PIC X(15).
  6657         16  CM-INSURED-INITIALS.
  6658             20  CM-INSURED-INITIAL1       PIC X.
  6659             20  CM-INSURED-INITIAL2       PIC X.
  6660
  6661     12  CM-CONTROL-BY-SSN.
  6662         16  CM-COMPANY-CD-A2              PIC X.
  6663         16  CM-SOC-SEC-NO.
  6664             20  CM-SSN-STATE              PIC XX.
  6665             20  CM-SSN-ACCOUNT            PIC X(6).
  6666             20  CM-SSN-LN3.
  6667                 25  CM-INSURED-INITIALS-A2.
  6668                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6669                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6670                 25 CM-PART-LAST-NAME-A2         PIC X.
  6671
  6672     12  CM-CONTROL-BY-CERT-NO.
  6673         16  CM-COMPANY-CD-A4              PIC X.
  6674         16  CM-CERT-NO-A4                 PIC X(11).
  6675
  6676     12  CM-CONTROL-BY-MEMB.
  6677         16  CM-COMPANY-CD-A5              PIC X.
  6678         16  CM-MEMBER-NO.
  6679             20  CM-MEMB-STATE             PIC XX.
  6680             20  CM-MEMB-ACCOUNT           PIC X(6).
  6681             20  CM-MEMB-LN4.
  6682                 25  CM-INSURED-INITIALS-A5.
  6683                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6684                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6685                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6686
  6687     12  CM-INSURED-PROFILE-DATA.
  6688         16  CM-INSURED-FIRST-NAME.
  6689             20  CM-INSURED-1ST-INIT       PIC X.
  6690             20  FILLER                    PIC X(9).
  6691         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6692         16  CM-INSURED-SEX                PIC X.
  6693             88  CM-SEX-MALE                  VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 124
* EL6311.cbl
  6694             88  CM-SEX-FEMAL                 VALUE 'F'.
  6695         16  CM-INSURED-JOINT-AGE          PIC 99.
  6696         16  CM-JOINT-INSURED-NAME.
  6697             20  CM-JT-LAST-NAME           PIC X(15).
  6698             20  CM-JT-FIRST-NAME.
  6699                 24  CM-JT-1ST-INIT        PIC X.
  6700                 24  FILLER                PIC X(9).
  6701             20  CM-JT-INITIAL             PIC X.
  6702
  6703     12  CM-LIFE-DATA.
  6704         16  CM-LF-BENEFIT-CD              PIC XX.
  6705         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6706         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6707         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6708         16  CM-LF-DEV-CODE                PIC XXX.
  6709         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6710         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6711         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6712         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6713         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6714         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6715         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6716         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6717         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6718         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6719         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6720         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6721         16  cm-temp-epiq                  pic xx.
  6722             88  EPIQ-CLASS                  value 'EQ'.
  6723*        16  FILLER                        PIC XX.
  6724
  6725     12  CM-AH-DATA.
  6726         16  CM-AH-BENEFIT-CD              PIC XX.
  6727         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6728         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6729         16  CM-AH-DEV-CODE                PIC XXX.
  6730         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6731         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6732         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6733         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6734         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6735         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6736         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6737         16  CM-AH-PAID-THRU-DT            PIC XX.
  6738             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6739         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6740         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6741         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6742         16  FILLER                        PIC X.
  6743
  6744     12  CM-LOAN-INFORMATION.
  6745         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6746         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6747                                           PIC S9(5)V99  COMP-3.
  6748         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6749         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6750         16  CM-PAY-FREQUENCY              PIC S99.
  6751         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 125
* EL6311.cbl
  6752         16  CM-RATE-CLASS                 PIC XX.
  6753         16  CM-BENEFICIARY                PIC X(25).
  6754         16  CM-POLICY-FORM-NO             PIC X(12).
  6755         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6756         16  CM-LAST-ADD-ON-DT             PIC XX.
  6757         16  CM-DEDUCTIBLE-AMOUNTS.
  6758             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6759             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6760         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6761             20  CM-RESIDENT-STATE         PIC XX.
  6762             20  CM-RATE-CODE              PIC X(4).
  6763             20  FILLER                    PIC XX.
  6764         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6765             20  CM-LOAN-OFFICER           PIC X(5).
  6766             20  FILLER                    PIC XXX.
  6767         16  CM-CSR-CODE                   PIC XXX.
  6768         16  CM-UNDERWRITING-CODE          PIC X.
  6769             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6770         16  CM-POST-CARD-IND              PIC X.
  6771         16  CM-REF-INTERFACE-SW           PIC X.
  6772         16  CM-PREMIUM-TYPE               PIC X.
  6773             88  CM-SING-PRM                  VALUE '1'.
  6774             88  CM-O-B-COVERAGE              VALUE '2'.
  6775             88  CM-OPEN-END                  VALUE '3'.
  6776         16  CM-IND-GRP-TYPE               PIC X.
  6777             88  CM-INDIVIDUAL                VALUE 'I'.
  6778             88  CM-GROUP                     VALUE 'G'.
  6779         16  CM-SKIP-CODE                  PIC X.
  6780             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6781             88  SKIP-JULY                    VALUE '1'.
  6782             88  SKIP-AUGUST                  VALUE '2'.
  6783             88  SKIP-SEPTEMBER               VALUE '3'.
  6784             88  SKIP-JULY-AUG                VALUE '4'.
  6785             88  SKIP-AUG-SEPT                VALUE '5'.
  6786             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6787             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6788             88  SKIP-JUNE                    VALUE '8'.
  6789             88  SKIP-JUNE-JULY               VALUE '9'.
  6790             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6791             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6792         16  CM-PAYMENT-MODE               PIC X.
  6793             88  PAY-MONTHLY                  VALUE SPACE.
  6794             88  PAY-WEEKLY                   VALUE '1'.
  6795             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6796             88  PAY-BI-WEEKLY                VALUE '3'.
  6797             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6798         16  CM-LOAN-NUMBER                PIC X(8).
  6799         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6800         16  CM-OLD-LOF                    PIC XXX.
  6801*        16  CM-LOAN-OFFICER               PIC XXX.
  6802         16  CM-REIN-TABLE                 PIC XXX.
  6803         16  CM-SPECIAL-REIN-CODE          PIC X.
  6804         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6805         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6806         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6807
  6808     12  CM-STATUS-DATA.
  6809         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 126
* EL6311.cbl
  6810         16  CM-ENTRY-DT                   PIC XX.
  6811
  6812         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6813         16  CM-LF-CANCEL-DT               PIC XX.
  6814         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6815
  6816         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6817         16  CM-LF-DEATH-DT                PIC XX.
  6818         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6819
  6820         16  CM-LF-CURRENT-STATUS          PIC X.
  6821             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6822                                                'M' '4' '5' '9'.
  6823             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6824             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6825             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6826             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6827             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6828             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6829             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6830             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6831             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6832             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6833             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6834             88  CM-LF-DECLINED               VALUE 'D'.
  6835             88  CM-LF-VOIDED                 VALUE 'V'.
  6836
  6837         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6838         16  CM-AH-CANCEL-DT               PIC XX.
  6839         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6840
  6841         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6842         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6843         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6844
  6845         16  CM-AH-CURRENT-STATUS          PIC X.
  6846             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6847                                                'M' '4' '5' '9'.
  6848             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6849             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6850             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6851             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6852             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6853             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6854             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6855             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6856             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6857             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6858             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6859             88  CM-AH-DECLINED               VALUE 'D'.
  6860             88  CM-AH-VOIDED                 VALUE 'V'.
  6861
  6862         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6863             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6864             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6865             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6866         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6867
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 127
* EL6311.cbl
  6868         16  CM-ENTRY-BATCH                PIC X(6).
  6869         16  CM-LF-EXIT-BATCH              PIC X(6).
  6870         16  CM-AH-EXIT-BATCH              PIC X(6).
  6871         16  CM-LAST-MONTH-END             PIC XX.
  6872
  6873     12  CM-NOTE-SW                        PIC X.
  6874         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6875         88  CERT-NOTES-PRESENT               VALUE '1'.
  6876         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6877         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6878         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6879         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6880         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6881         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6882     12  CM-COMP-EXCP-SW                   PIC X.
  6883         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6884         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6885     12  CM-INSURED-ADDRESS-SW             PIC X.
  6886         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6887         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6888
  6889*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6890     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6891     12  FILLER                            PIC X.
  6892
  6893*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6894     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6895     12  FILLER                            PIC X.
  6896*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6897     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  6898
  6899     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6900         88  CERT-ADDED-BATCH                 VALUE ' '.
  6901         88  CERT-ADDED-ONLINE                VALUE '1'.
  6902         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6903         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6904         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6905     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6906         88  CERT-AS-LOADED                   VALUE ' '.
  6907         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6908         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6909         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6910         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6911         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6912         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6913         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6914
  6915     12  CM-ACCOUNT-COMM-PCTS.
  6916         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6917         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6918
  6919     12  CM-USER-FIELD                     PIC X.
  6920     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6921     12  CM-CLP-STATE                      PIC XX.
  6922     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6923     12  CM-USER-RESERVED                  PIC XXX.
  6924     12  FILLER REDEFINES CM-USER-RESERVED.
  6925         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 128
* EL6311.cbl
  6926         16  F                             PIC X.
  6927******************************************************************
  6928*                                COPY ERCNOTE.
  6929******************************************************************
  6930*                                                                *
  6931*                                                                *
  6932*                            ERCNOTE                             *
  6933*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6934*                            VMOD=2.003                          *
  6935*                                                                *
  6936*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6937*                                                                *
  6938*        FILE TYPE= VSAM,KSDS                                    *
  6939*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6940*                                                                *
  6941*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6942*                                                                *
  6943*        LOG = YES                                               *
  6944*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6945*                                                                *
  6946******************************************************************
  6947*                   C H A N G E   L O G
  6948*
  6949* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6950*-----------------------------------------------------------------
  6951*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6952* EFFECTIVE    NUMBER
  6953*-----------------------------------------------------------------
  6954* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6955*                                FILE WILL CONTAIN BILLING NOTES O
  6956******************************************************************
  6957
  6958 01  CERTIFICATE-NOTE.
  6959     12  CN-RECORD-ID                PIC  XX.
  6960         88  VALID-CN-ID                  VALUE 'CN'.
  6961
  6962     12  CN-CONTROL-PRIMARY.
  6963         16  CN-COMPANY-CD           PIC X.
  6964         16  CN-CARRIER              PIC X.
  6965         16  CN-GROUPING.
  6966             20 CN-GROUPING-PREFIX   PIC XXX.
  6967             20 CN-GROUPING-PRIME    PIC XXX.
  6968         16  CN-STATE                PIC XX.
  6969         16  CN-ACCOUNT.
  6970             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6971             20 CN-ACCOUNT-PRIME     PIC X(6).
  6972         16  CN-CERT-EFF-DT          PIC XX.
  6973         16  CN-CERT-NO.
  6974             20  CN-CERT-PRIME       PIC X(10).
  6975             20  CN-CERT-SFX         PIC X.
  6976
  6977     12  CN-BILLING-START-LINE-NO    PIC 99.
  6978     12  CN-BILLING-END-LINE-NO      PIC 99.
  6979
  6980     12  CN-LINES.
  6981         16  CN-LINE OCCURS 10       PIC X(77).
  6982
  6983     12  CN-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 129
* EL6311.cbl
  6984     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6985     12  CN-LAST-MAINT-USER          PIC X(4).
  6986     12  FILLER                      PIC X(6).
  6987******************************************************************
  6988*                                COPY ERCPNDM.
  6989******************************************************************
  6990*                                                                *
  6991*                                                                *
  6992*                            ERCPNDM                             *
  6993*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6994*                            VMOD=2.003                          *
  6995*                                                                *
  6996*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6997*                                                                *
  6998*   FILE TYPE = VSAM,KSDS                                        *
  6999*   RECORD SIZE = 374   RECFORM = FIX                            *
  7000*                                                                *
  7001*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  7002*   ALTERNATE PATH    = NOT USED                                 *
  7003*                                                                *
  7004*   LOG = YES                                                    *
  7005*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7006******************************************************************
  7007*                   C H A N G E   L O G
  7008*
  7009* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7010*-----------------------------------------------------------------
  7011*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7012* EFFECTIVE    NUMBER
  7013*-----------------------------------------------------------------
  7014* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7015* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  7016* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7017* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7018******************************************************************
  7019
  7020 01  PENDING-MAILING-DATA.
  7021     12  PM-RECORD-ID                      PIC XX.
  7022         88  VALID-MA-ID                       VALUE 'PM'.
  7023
  7024     12  PM-CONTROL-PRIMARY.
  7025         16  PM-COMPANY-CD                 PIC X.
  7026         16  PM-ENTRY-BATCH                PIC X(6).
  7027         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  7028         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  7029
  7030     12  FILLER                            PIC X(14).
  7031
  7032     12  PM-ACCESS-CONTROL.
  7033         16  PM-SOURCE-SYSTEM              PIC XX.
  7034             88  PM-FROM-CREDIT                VALUE 'CR'.
  7035             88  PM-FROM-VSI                   VALUE 'VS'.
  7036             88  PM-FROM-WARRANTY              VALUE 'WA'.
  7037             88  PM-FROM-OTHER                 VALUE 'OT'.
  7038         16  PM-RECORD-ADD-DT              PIC XX.
  7039         16  PM-RECORD-ADDED-BY            PIC XXXX.
  7040         16  PM-LAST-MAINT-DT              PIC XX.
  7041         16  PM-LAST-MAINT-BY              PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 130
* EL6311.cbl
  7042         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7043
  7044     12  PM-PROFILE-INFO.
  7045         16  PM-QUALIFY-CODE-1             PIC XX.
  7046         16  PM-QUALIFY-CODE-2             PIC XX.
  7047         16  PM-QUALIFY-CODE-3             PIC XX.
  7048         16  PM-QUALIFY-CODE-4             PIC XX.
  7049         16  PM-QUALIFY-CODE-5             PIC XX.
  7050
  7051         16  PM-INSURED-LAST-NAME          PIC X(15).
  7052         16  PM-INSURED-FIRST-NAME         PIC X(10).
  7053         16  PM-INSURED-MIDDLE-INIT        PIC X.
  7054         16  PM-INSURED-ISSUE-AGE          PIC 99.
  7055         16  PM-INSURED-BIRTH-DT           PIC XX.
  7056         16  PM-INSURED-SEX                PIC X.
  7057             88  PM-SEX-MALE                   VALUE 'M'.
  7058             88  PM-SEX-FEMALE                 VALUE 'F'.
  7059         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  7060
  7061         16  PM-ADDRESS-CORRECTED          PIC X.
  7062         16  PM-JOINT-BIRTH-DT             PIC XX.
  7063*        16  FILLER                        PIC X(12).
  7064
  7065         16  PM-ADDRESS-LINE-1             PIC X(30).
  7066         16  PM-ADDRESS-LINE-2             PIC X(30).
  7067         16  PM-CITY-STATE.
  7068             20  PM-CITY                   PIC X(28).
  7069             20  PM-STATE                  PIC XX.
  7070         16  PM-ZIP.
  7071             20  PM-ZIP-CODE.
  7072                 24  PM-ZIP-1              PIC X.
  7073                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7074                 24  FILLER                PIC X(4).
  7075             20  PM-ZIP-PLUS4              PIC X(4).
  7076         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  7077             20  PM-CAN-POST1              PIC XXX.
  7078             20  PM-CAN-POST2              PIC XXX.
  7079             20  FILLER                    PIC XXX.
  7080
  7081         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  7082         16  pm-city-st-zip-verified       pic x.
  7083         16  FILLER                        PIC XX.
  7084
  7085     12  PM-CRED-BENE-INFO.
  7086         16  PM-CRED-BENE-NAME             PIC X(25).
  7087         16  PM-CRED-BENE-ADDR             PIC X(30).
  7088         16  PM-CRED-BENE-ADDR2            PIC X(30).
  7089         16  PM-CRED-BENE-CTYST.
  7090             20  PM-CRED-BENE-CITY         PIC X(28).
  7091             20  PM-CRED-BENE-STATE        PIC XX.
  7092         16  PM-CRED-BENE-ZIP.
  7093             20  PM-CB-ZIP-CODE.
  7094                 24  PM-CB-ZIP-1           PIC X.
  7095                     88  PM-CB-CANADIAN-POST-CODE
  7096                                  VALUE 'A' THRU 'Z'.
  7097                 24  FILLER                PIC X(4).
  7098             20  PM-CB-ZIP-PLUS4           PIC X(4).
  7099         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 131
* EL6311.cbl
  7100             20  PM-CB-CAN-POST1           PIC XXX.
  7101             20  PM-CB-CAN-POST2           PIC XXX.
  7102             20  FILLER                    PIC XXX.
  7103     12  PM-POST-CARD-MAIL-DATA.
  7104         16  PM-MAIL-DATA OCCURS 7.
  7105             20  PM-MAIL-TYPE              PIC X.
  7106                 88  PM-12MO-MAILING           VALUE '1'.
  7107                 88  PM-EXP-MAILING            VALUE '2'.
  7108             20  PM-MAIL-STATUS            PIC X.
  7109                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  7110                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  7111                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  7112             20  PM-MAIL-DATE              PIC XX.
  7113     12  FILLER                            PIC XX.
  7114     12  FILLER                            PIC X(12).
  7115*    12  FILLER                            PIC X(30).
  7116
  7117******************************************************************
  7118*                                COPY ERCMAIL.
  7119******************************************************************
  7120*                                                                *
  7121*                                                                *
  7122*                            ERCMAIL                             *
  7123*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7124*                            VMOD=2.003                          *
  7125*                                                                *
  7126*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7127*                                                                *
  7128*   FILE TYPE = VSAM,KSDS                                        *
  7129*   RECORD SIZE = 374   RECFORM = FIX                            *
  7130*                                                                *
  7131*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7132*   ALTERNATE PATH    = NOT USED                                 *
  7133*                                                                *
  7134*   LOG = YES                                                    *
  7135*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7136******************************************************************
  7137*                   C H A N G E   L O G
  7138*
  7139* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7140*-----------------------------------------------------------------
  7141*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7142* EFFECTIVE    NUMBER
  7143*-----------------------------------------------------------------
  7144* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7145* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7146* 111108                   PEMA  ADD CRED BENE ADDR2
  7147******************************************************************
  7148
  7149 01  MAILING-DATA.
  7150     12  MA-RECORD-ID                      PIC XX.
  7151         88  VALID-MA-ID                       VALUE 'MA'.
  7152
  7153     12  MA-CONTROL-PRIMARY.
  7154         16  MA-COMPANY-CD                 PIC X.
  7155         16  MA-CARRIER                    PIC X.
  7156         16  MA-GROUPING.
  7157             20  MA-GROUPING-PREFIX        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 132
* EL6311.cbl
  7158             20  MA-GROUPING-PRIME         PIC XXX.
  7159         16  MA-STATE                      PIC XX.
  7160         16  MA-ACCOUNT.
  7161             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7162             20  MA-ACCOUNT-PRIME          PIC X(6).
  7163         16  MA-CERT-EFF-DT                PIC XX.
  7164         16  MA-CERT-NO.
  7165             20  MA-CERT-PRIME             PIC X(10).
  7166             20  MA-CERT-SFX               PIC X.
  7167
  7168     12  FILLER                            PIC XX.
  7169
  7170     12  MA-ACCESS-CONTROL.
  7171         16  MA-SOURCE-SYSTEM              PIC XX.
  7172             88  MA-FROM-CREDIT                VALUE 'CR'.
  7173             88  MA-FROM-VSI                   VALUE 'VS'.
  7174             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7175             88  MA-FROM-OTHER                 VALUE 'OT'.
  7176         16  MA-RECORD-ADD-DT              PIC XX.
  7177         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7178         16  MA-LAST-MAINT-DT              PIC XX.
  7179         16  MA-LAST-MAINT-BY              PIC XXXX.
  7180         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7181
  7182     12  MA-PROFILE-INFO.
  7183         16  MA-QUALIFY-CODE-1             PIC XX.
  7184         16  MA-QUALIFY-CODE-2             PIC XX.
  7185         16  MA-QUALIFY-CODE-3             PIC XX.
  7186         16  MA-QUALIFY-CODE-4             PIC XX.
  7187         16  MA-QUALIFY-CODE-5             PIC XX.
  7188
  7189         16  MA-INSURED-LAST-NAME          PIC X(15).
  7190         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7191         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7192         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7193         16  MA-INSURED-BIRTH-DT           PIC XX.
  7194         16  MA-INSURED-SEX                PIC X.
  7195             88  MA-SEX-MALE                   VALUE 'M'.
  7196             88  MA-SEX-FEMALE                 VALUE 'F'.
  7197         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7198
  7199         16  MA-ADDRESS-CORRECTED          PIC X.
  7200         16  MA-JOINT-BIRTH-DT             PIC XX.
  7201*        16  FILLER                        PIC X(12).
  7202
  7203         16  MA-ADDRESS-LINE-1             PIC X(30).
  7204         16  MA-ADDRESS-LINE-2             PIC X(30).
  7205         16  MA-CITY-STATE.
  7206             20  MA-CITY                   PIC X(28).
  7207             20  MA-ADDR-STATE             PIC XX.
  7208         16  MA-ZIP.
  7209             20  MA-ZIP-CODE.
  7210                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7211                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7212                 24  FILLER                PIC X(4).
  7213             20  MA-ZIP-PLUS4              PIC X(4).
  7214         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7215             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 133
* EL6311.cbl
  7216             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7217             20  FILLER                    PIC X(3).
  7218
  7219         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7220
  7221         16  FILLER                        PIC XXX.
  7222*        16  FILLER                        PIC X(10).
  7223
  7224     12  MA-CRED-BENE-INFO.
  7225         16  MA-CRED-BENE-NAME                 PIC X(25).
  7226         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7227         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7228         16  MA-CRED-BENE-CTYST.
  7229             20  MA-CRED-BENE-CITY             PIC X(28).
  7230             20  MA-CRED-BENE-STATE            PIC XX.
  7231         16  MA-CRED-BENE-ZIP.
  7232             20  MA-CB-ZIP-CODE.
  7233                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7234                     88  MA-CB-CANADIAN-POST-CODE
  7235                                           VALUE 'A' THRU 'Z'.
  7236                 24  FILLER                    PIC X(4).
  7237             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7238         16  MA-CB-CANADIAN-POSTAL-CODE
  7239                            REDEFINES MA-CRED-BENE-ZIP.
  7240             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7241             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7242             20  FILLER                        PIC X(3).
  7243     12  MA-POST-CARD-MAIL-DATA.
  7244         16  MA-MAIL-DATA OCCURS 7.
  7245             20  MA-MAIL-TYPE              PIC X.
  7246                 88  MA-12MO-MAILING           VALUE '1'.
  7247                 88  MA-EXP-MAILING            VALUE '2'.
  7248             20  MA-MAIL-STATUS            PIC X.
  7249                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7250                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7251                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7252             20  MA-MAIL-DATE              PIC XX.
  7253     12  FILLER                            PIC XX.
  7254     12  FILLER                            PIC XX.
  7255*    12  FILLER                            PIC X(30).
  7256******************************************************************
  7257*                                COPY ERCRQST.
  7258******************************************************************
  7259*                                                                *
  7260*                                                                *
  7261*                            ERCRQST.                            *
  7262*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7263*                            VMOD=2.002                          *
  7264*                                                                *
  7265*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7266*                                                                *
  7267*   FILE TYPE = VSAM,KSDS                                        *
  7268*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7269*                                                                *
  7270*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7271*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7272*                                   ACCOUNT, REF, BATCH)         *
  7273*                                                RKP=9, LEN=38   *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 134
* EL6311.cbl
  7274*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7275*                                   ACCOUNT, REF, BATCH)         *
  7276*                                                RKP=47, LEN=46  *
  7277*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7278*                                   BATCH)                       *
  7279*                                                RKP=93, LEN=24  *
  7280*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7281*                                   REF, BATCH)                  *
  7282*                                                RKP=117, LEN=35 *
  7283*   LOG = NO                                                     *
  7284*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7285******************************************************************
  7286
  7287 01  AR-REQUEST-RECORD.
  7288     12  RQ-RECORD-ID                     PIC XX.
  7289         88  VALID-RQ-ID                        VALUE 'RQ'.
  7290
  7291     12  RQ-CONTROL-PRIMARY.
  7292         16  RQ-COMPANY-CD                PIC X.
  7293         16  RQ-ENTRY-BATCH               PIC X(6).
  7294
  7295     12  RQ-CONTROL-BY-ACCT-REF.
  7296         16  RQ-COMPANY-CD-A1             PIC X.
  7297         16  RQ-CARRIER-A1                PIC X.
  7298         16  RQ-GROUPING-A1               PIC X(6).
  7299         16  RQ-STATE-A1                  PIC XX.
  7300         16  RQ-ACCOUNT-A1                PIC X(10).
  7301         16  RQ-REFERENCE-A1              PIC X(12).
  7302         16  RQ-BATCH-A1                  PIC X(6).
  7303
  7304     12  RQ-CONTROL-BY-FIN-RESP.
  7305         16  RQ-COMPANY-CD-A2             PIC X.
  7306         16  RQ-CARRIER-A2                PIC X.
  7307         16  RQ-GROUPING-A2               PIC X(6).
  7308         16  RQ-FIN-RESP-A2               PIC X(10).
  7309         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7310         16  RQ-REFERENCE-A2              PIC X(12).
  7311         16  RQ-BATCH-A2                  PIC X(6).
  7312
  7313     12  RQ-CONTROL-BY-ACCT-AGENT.
  7314         16  RQ-COMPANY-CD-A3             PIC X.
  7315         16  RQ-CARRIER-A3                PIC X.
  7316         16  RQ-GROUPING-A3               PIC X(6).
  7317         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7318         16  RQ-BATCH-A3                  PIC X(6).
  7319
  7320     12  RQ-CONTROL-BY-SUMMARY.
  7321         16  RQ-COMPANY-CD-A4             PIC X.
  7322         16  RQ-SUMMARY-CODE              PIC X(6).
  7323         16  RQ-ACCOUNT-A4                PIC X(10).
  7324         16  RQ-REFERENCE-A4              PIC X(12).
  7325         16  RQ-BATCH-A4                  PIC X(6).
  7326
  7327     12  RQ-REQUEST-METHOD                PIC X.
  7328         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7329         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7330         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7331         88 RQ-BATCH-REQUEST                  VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 135
* EL6311.cbl
  7332     12  FILLER                           PIC X.
  7333     12  RQ-STATUS                        PIC X.
  7334         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7335         88  RQ-RESUBMIT                      VALUE 'R'.
  7336     12  RQ-PROCESSOR-ID                  PIC X(4).
  7337     12  RQ-ENTRY-DT                      PIC XX.
  7338     12  RQ-MO-END-DT                     PIC XX.
  7339     12  RQ-REQUEST-DT                    PIC XX.
  7340     12  RQ-STMT-DT                       PIC XX.
  7341     12  RQ-REVERSAL-DT                   PIC XX.
  7342     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7343     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7344
  7345     12  FILLER                           PIC X(27).
  7346
  7347******************************************************************
  7348
  7349*                                COPY ERCLOFC.
  7350******************************************************************
  7351*                                                                *
  7352*                                                                *
  7353*                            ERCLOFC                             *
  7354*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7355*                            VMOD=2.003                          *
  7356*                                                                *
  7357*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7358*                                                                *
  7359*   FILE TYPE = VSAM,KSDS                                        *
  7360*   RECORD SIZE = 670   RECFORM = FIX                            *
  7361*                                                                *
  7362*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7363*                                                                *
  7364*   LOG = YES                                                    *
  7365*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7366*                                                                *
  7367******************************************************************
  7368
  7369 01  LOAN-OFFICER-MASTER.
  7370     12  LO-RECORD-ID                PIC XX.
  7371         88  VALID-LO-ID                VALUE 'LO'.
  7372
  7373     12  LO-CONTROL-PRIMARY.
  7374         16  LO-COMPANY-CD           PIC X.
  7375         16  LO-CARRIER              PIC X.
  7376         16  LO-GROUPING.
  7377             20  LO-GROUPING-PREFIX  PIC XXX.
  7378             20  LO-GROUPING-PRIME   PIC XXX.
  7379         16  LO-STATE                PIC XX.
  7380         16  LO-ACCOUNT.
  7381             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7382             20  LO-ACCOUNT-PRIME    PIC X(6).
  7383         16  LO-OFFICER-CODE         PIC X(5).
  7384
  7385     12  LO-OFFICER-NAME             PIC X(30).
  7386
  7387     12  LO-LAST-MAINT-DT            PIC XX.
  7388     12  LO-LAST-USER                PIC X(4).
  7389     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 136
* EL6311.cbl
  7390
  7391     12  LO-COMP-CONTROL             PIC X.
  7392             88  LO-SHOW-COMP           VALUE 'Y'.
  7393             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7394     12  LO-DETAIL-CONTROL           PIC X.
  7395             88  LO-PRINT-DETAIL        VALUE 'D'.
  7396             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7397
  7398     12  LO-SV-CARRIER               PIC X.
  7399     12  LO-SV-GROUPING              PIC X(6).
  7400     12  LO-SV-STATE                 PIC XX.
  7401
  7402     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7403     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7404
  7405     12  LO-OFFICER-INFO.
  7406         16  FILLER OCCURS 12 TIMES.
  7407             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7408             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7409             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7410             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7411             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7412             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7413             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7414             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7415     12  FILLER                      PIC X(198).
  7416******************************************************************
  7417*                                COPY ERCPYAJ.
  7418******************************************************************
  7419*                                                                *
  7420*                            ERCPYAJ                             *
  7421*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7422*                            VMOD=2.015                          *
  7423*                                                                *
  7424*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7425*                                                                *
  7426*                                                                *
  7427*   FILE TYPE = VSAM,KSDS                                        *
  7428*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7429*                                                                *
  7430*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7431*       ALTERNATE PATHS = NONE                                   *
  7432*                                                                *
  7433*   LOG = YES                                                    *
  7434*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7435******************************************************************
  7436******************************************************************
  7437*                   C H A N G E   L O G
  7438*
  7439* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7440*-----------------------------------------------------------------
  7441*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7442* EFFECTIVE    NUMBER
  7443*-----------------------------------------------------------------
  7444* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7445* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7446******************************************************************
  7447
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 137
* EL6311.cbl
  7448 01  PENDING-PAY-ADJ.
  7449     12  PY-RECORD-ID                     PIC XX.
  7450         88  VALID-PY-ID                        VALUE 'PY'.
  7451
  7452     12  PY-CONTROL-PRIMARY.
  7453         16  PY-COMPANY-CD                PIC X.
  7454         16  PY-CARRIER                   PIC X.
  7455         16  PY-GROUPING                  PIC X(6).
  7456         16  PY-FIN-RESP                  PIC X(10).
  7457         16  PY-ACCOUNT                   PIC X(10).
  7458         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7459                                          PIC X(10).
  7460         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7461         16  PY-RECORD-TYPE               PIC X.
  7462             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7463             88  PY-DEPOSIT                   VALUE 'D'.
  7464             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7465             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7466             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7467             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7468             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7469             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7470             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7471             88  PY-FICA-ENTRY                VALUE 'F'.
  7472             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7473             88  PY-POLICY-FEE                VALUE 'W'.
  7474             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7475
  7476     12  PY-PYMT-TYPE                     PIC X.
  7477             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7478             88  PY-REINS-PYMT                VALUE 'R'.
  7479             88  PY-EXP-PYMT                  VALUE 'E'.
  7480
  7481     12  PY-BIL-INV                       PIC X(6).
  7482     12  PY-REF-NO                        PIC X(12).
  7483
  7484     12  PY-LAST-MAINT-DT                 PIC XX.
  7485     12  PY-LAST-MAINT-BY                 PIC X(4).
  7486     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7487
  7488     12  PY-PYADJ-RECORD.
  7489         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7490         16  PY-ENTRY-COMMENT             PIC X(30).
  7491         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7492             20  PY-GL-ACCOUNT            PIC X(10).
  7493             20  PY-GL-STATE              PIC X(02).
  7494             20  PY-GL-CANC-SW            PIC X(01).
  7495                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7496                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7497             20  PY-GL-COMMENT            PIC X(10).
  7498             20  FILLER      REDEFINES PY-GL-COMMENT.
  7499                 24  PY-GL-CHECK-NO       PIC 9(06).
  7500                 24  FILLER               PIC X(04).
  7501             20  FILLER                   PIC X(07).
  7502         16  PY-SAVE-ACCOUNT              PIC X(10).
  7503         16  PY-SAVE-TYPE                 PIC X(01).
  7504
  7505         16  PY-LETTERS.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 138
* EL6311.cbl
  7506             20  PY-LETTER OCCURS 3 TIMES
  7507                           INDEXED BY PY-LET-NDX
  7508                                          PIC X(04).
  7509
  7510         16  PY-ERCOMP-TYPE               PIC X.
  7511             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7512             88  PY-GA-TYPE                   VALUE 'G'.
  7513             88  PY-BANK-TYPE                 VALUE 'B'.
  7514         16  FILLER                       PIC X(05).
  7515
  7516     12  PY-RECORD-STATUS.
  7517         16  PY-CREDIT-SELECT-DT          PIC XX.
  7518         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7519         16  PY-BILLED-DATE               PIC XX.
  7520         16  PY-REPORTED-DT               PIC XX.
  7521         16  PY-PMT-APPLIED               PIC X.
  7522             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7523             88  PY-GA-PMT                    VALUE 'G'.
  7524             88  PY-OVWRITE-PMT               VALUE 'O'.
  7525             88  PY-NON-AR-PMT                VALUE 'N'.
  7526         16  FILLER                       PIC X(5).
  7527         16  PY-INPUT-DT                  PIC XX.
  7528         16  PY-CHECK-NUMBER              PIC X(6).
  7529         16  PY-VOID-SW                   PIC X.
  7530             88  PY-CHECK-VOIDED              VALUE 'V'.
  7531         16  PY-CHECK-ORIGIN-SW           PIC X.
  7532             88  PY-BILLING-CHECK             VALUE 'B'.
  7533             88  PY-REFUND-CHECK              VALUE 'R'.
  7534             88  PY-GA-CHECK                  VALUE 'G'.
  7535             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7536             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7537         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7538         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7539         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7540         16  PY-BILL-FLAG                 PIC X.
  7541             88  PY-BILLED                    VALUE 'B'.
  7542         16  PY-AR-FLAG                   PIC X.
  7543             88  PY-AR-CYCLE                  VALUE 'C'.
  7544             88  PY-AR-MONTH-END              VALUE 'M'.
  7545         16  PY-AR-DATE                   PIC XX.
  7546
  7547     12  PY-GL-CODES.
  7548         16  PY-GL-DB                     PIC X(14).
  7549         16  PY-GL-CR                     PIC X(14).
  7550         16  PY-GL-FLAG                   PIC X.
  7551         16  PY-GL-DATE                   PIC XX.
  7552
  7553     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7554     12  FILLER                           PIC X(3).
  7555******************************************************************
  7556*                                COPY ERCCNOT.
  7557******************************************************************
  7558*                                                                *
  7559*                            ERCCNOT                             *
  7560*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7561*                            VMOD=2.003                          *
  7562*                                                                *
  7563*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 139
* EL6311.cbl
  7564*                                                                *
  7565*        FILE TYPE= VSAM,KSDS                                    *
  7566*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7567*                                                                *
  7568*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7569*                                                                *
  7570*        LOG = YES                                               *
  7571*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7572*                                                                *
  7573******************************************************************
  7574*                   C H A N G E   L O G
  7575*
  7576* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7577*-----------------------------------------------------------------
  7578*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7579* EFFECTIVE    NUMBER
  7580*-----------------------------------------------------------------
  7581* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7582******************************************************************
  7583
  7584 01  CERT-NOTE-FILE.
  7585     12  CZ-RECORD-ID                PIC  XX.
  7586         88  VALID-CZ-ID                  VALUE 'CZ'.
  7587
  7588     12  CZ-CONTROL-PRIMARY.
  7589         16  CZ-COMPANY-CD           PIC X.
  7590         16  CZ-CARRIER              PIC X.
  7591         16  CZ-GROUPING.
  7592             20 CZ-GROUPING-PREFIX   PIC XXX.
  7593             20 CZ-GROUPING-PRIME    PIC XXX.
  7594         16  CZ-STATE                PIC XX.
  7595         16  CZ-ACCOUNT.
  7596             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7597             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7598         16  CZ-CERT-EFF-DT          PIC XX.
  7599         16  CZ-CERT-NO.
  7600             20  CZ-CERT-PRIME       PIC X(10).
  7601             20  CZ-CERT-SFX         PIC X.
  7602         16  CZ-RECORD-TYPE          PIC X.
  7603             88  CERT-NOTE           VALUE '1'.
  7604             88  CLAIM-CERT-NOTE     VALUE '2'.
  7605         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7606
  7607     12  CZ-LAST-MAINT-DT            PIC XX.
  7608     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7609     12  CZ-LAST-MAINT-USER          PIC X(4).
  7610
  7611     12  CZ-NOTE-INFORMATION.
  7612         16  CZ-NOTE                 PIC X(63).
  7613         16  FILLER                  PIC X(39).
  7614******************************************************************
  7615*                                COPY ELCMSTR.
  7616******************************************************************
  7617*                                                                *
  7618*                            ELCMSTR.                            *
  7619*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7620*                            VMOD=2.012                          *
  7621*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 140
* EL6311.cbl
  7622*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7623*                                                                *
  7624*   FILE TYPE = VSAM,KSDS                                        *
  7625*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7626*                                                                *
  7627*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7628*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7629*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7630*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7631*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7632*                                                 RKP=75,LEN=21  *
  7633*                                                                *
  7634*   **** NOTE ****                                               *
  7635*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7636*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7637*                                                                *
  7638*   LOG = YES                                                    *
  7639*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7640******************************************************************
  7641*                   C H A N G E   L O G
  7642*
  7643* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7644*-----------------------------------------------------------------
  7645*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7646* EFFECTIVE    NUMBER
  7647*-----------------------------------------------------------------
  7648* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7649* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7650* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7651* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7652* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7653* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7654* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7655******************************************************************
  7656 01  CLAIM-MASTER.
  7657     12  CL-RECORD-ID                PIC XX.
  7658         88  VALID-CL-ID         VALUE 'CL'.
  7659
  7660     12  CL-CONTROL-PRIMARY.
  7661         16  CL-COMPANY-CD           PIC X.
  7662         16  CL-CARRIER              PIC X.
  7663         16  CL-CLAIM-NO             PIC X(7).
  7664         16  CL-CERT-NO.
  7665             20  CL-CERT-PRIME       PIC X(10).
  7666             20  CL-CERT-SFX         PIC X.
  7667
  7668     12  CL-CONTROL-BY-NAME.
  7669         16  CL-COMPANY-CD-A1        PIC X.
  7670         16  CL-INSURED-LAST-NAME    PIC X(15).
  7671         16  CL-INSURED-NAME.
  7672             20  CL-INSURED-1ST-NAME PIC X(12).
  7673             20  CL-INSURED-MID-INIT PIC X.
  7674
  7675     12  CL-CONTROL-BY-SSN.
  7676         16  CL-COMPANY-CD-A2        PIC X.
  7677         16  CL-SOC-SEC-NO.
  7678             20  CL-SSN-STATE        PIC XX.
  7679             20  CL-SSN-ACCOUNT      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 141
* EL6311.cbl
  7680             20  CL-SSN-LN3          PIC X(3).
  7681
  7682     12  CL-CONTROL-BY-CERT-NO.
  7683         16  CL-COMPANY-CD-A4        PIC X.
  7684         16  CL-CERT-NO-A4.
  7685             20  CL-CERT-A4-PRIME    PIC X(10).
  7686             20  CL-CERT-A4-SFX      PIC X.
  7687
  7688     12  CL-CONTROL-BY-CCN.
  7689         16  CL-COMPANY-CD-A5        PIC X.
  7690         16  CL-CCN-A5.
  7691             20  CL-CCN.
  7692                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7693                 24  CL-CCN-PRIME-A5 PIC X(12).
  7694             20  CL-CCN-FILLER-A5    PIC X(4).
  7695
  7696     12  CL-INSURED-PROFILE-DATA.
  7697         16  CL-INSURED-BIRTH-DT     PIC XX.
  7698         16  CL-INSURED-SEX-CD       PIC X.
  7699             88  INSURED-IS-MALE        VALUE 'M'.
  7700             88  INSURED-IS-FEMALE      VALUE 'F'.
  7701             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7702         16  CL-INSURED-OCC-CD       PIC X(6).
  7703         16  FILLER                  PIC X(5).
  7704
  7705     12  CL-PROCESSING-INFO.
  7706         16  CL-PROCESSOR-ID         PIC X(4).
  7707         16  CL-CLAIM-STATUS         PIC X.
  7708             88  CLAIM-IS-OPEN          VALUE 'O'.
  7709             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7710         16  CL-CLAIM-TYPE           PIC X.
  7711*            88  AH-CLAIM               VALUE 'A'.
  7712*            88  LIFE-CLAIM             VALUE 'L'.
  7713*            88  PROPERTY-CLAIM         VALUE 'P'.
  7714*            88  IUI-CLAIM              VALUE 'I'.
  7715*            88  GAP-CLAIM              VALUE 'G'.
  7716*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7717*            88  OTHER-CLAIM            VALUE 'O'.
  7718         16  CL-CLAIM-PREM-TYPE      PIC X.
  7719             88  SINGLE-PREMIUM         VALUE '1'.
  7720             88  O-B-COVERAGE           VALUE '2'.
  7721             88  OPEN-END-COVERAGE      VALUE '3'.
  7722         16  CL-INCURRED-DT          PIC XX.
  7723         16  CL-REPORTED-DT          PIC XX.
  7724         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7725         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7726         16  CL-LAST-PMT-DT          PIC XX.
  7727         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7728         16  CL-PAID-THRU-DT         PIC XX.
  7729         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7730         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7731         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7732         16  CL-PMT-CALC-METHOD      PIC X.
  7733             88  CL-360-DAY-YR          VALUE '1'.
  7734             88  CL-365-DAY-YR          VALUE '2'.
  7735             88  CL-FULL-MONTHS         VALUE '3'.
  7736         16  CL-CAUSE-CD             PIC X(6).
  7737
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 142
* EL6311.cbl
  7738         16  CL-PRIME-CERT-NO.
  7739             20  CL-PRIME-CERT-PRIME PIC X(10).
  7740             20  CL-PRIME-CERT-SFX   PIC X.
  7741
  7742         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7743             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7744             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7745
  7746         16  CL-MICROFILM-NO         PIC X(10).
  7747         16  FILLER REDEFINES CL-MICROFILM-NO.
  7748             20  CL-BENEFIT-PERIOD   PIC 99.
  7749             20  FILLER              PIC X(8).
  7750         16  CL-PROG-FORM-TYPE       PIC X.
  7751         16  CL-LAST-ADD-ON-DT       PIC XX.
  7752
  7753         16  CL-LAST-REOPEN-DT       PIC XX.
  7754         16  CL-LAST-CLOSE-DT        PIC XX.
  7755         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7756             88  FINAL-PAID             VALUE '1'.
  7757             88  CLAIM-DENIED           VALUE '2'.
  7758             88  AUTO-CLOSE             VALUE '3'.
  7759             88  MANUAL-CLOSE           VALUE '4'.
  7760             88  BENEFITS-CHANGED       VALUE 'C'.
  7761             88  SETUP-ERRORS           VALUE 'E'.
  7762         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7763         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7764         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7765             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7766         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7767         16  FILLER                  PIC X.
  7768
  7769     12  CL-CERTIFICATE-DATA.
  7770         16  CL-CERT-ORIGIN          PIC X.
  7771             88  CERT-WAS-ONLINE        VALUE '1'.
  7772             88  CERT-WAS-CREATED       VALUE '2'.
  7773             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7774         16  CL-CERT-KEY-DATA.
  7775             20  CL-CERT-CARRIER     PIC X.
  7776             20  CL-CERT-GROUPING    PIC X(6).
  7777             20  CL-CERT-STATE       PIC XX.
  7778             20  CL-CERT-ACCOUNT.
  7779                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7780                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7781             20  CL-CERT-EFF-DT      PIC XX.
  7782
  7783     12  CL-STATUS-CONTROLS.
  7784         16  CL-PRIORITY-CD          PIC X.
  7785             88  CONFIDENTIAL-DATA      VALUE '8'.
  7786             88  HIGHEST-PRIORITY       VALUE '9'.
  7787         16  CL-SUPV-ATTN-CD         PIC X.
  7788             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7789             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7790         16  CL-PURGED-DT            PIC XX.
  7791         16  CL-RESTORED-DT          PIC XX.
  7792         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7793         16  CL-NEXT-RESEND-DT       PIC XX.
  7794         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7795         16  CL-CRITICAL-PERIOD      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 143
* EL6311.cbl
  7796*        16  FILLER                  PIC XX.
  7797         16  CL-LAST-MAINT-DT        PIC XX.
  7798         16  CL-LAST-MAINT-USER      PIC X(4).
  7799         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7800         16  CL-LAST-MAINT-TYPE      PIC X.
  7801             88  CLAIM-SET-UP           VALUE ' '.
  7802             88  PAYMENT-MADE           VALUE '1'.
  7803             88  LETTER-SENT            VALUE '2'.
  7804             88  MASTER-WAS-ALTERED     VALUE '3'.
  7805             88  MASTER-WAS-RESTORED    VALUE '4'.
  7806             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7807             88  FILE-CONVERTED         VALUE '6'.
  7808             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7809             88  ERROR-CORRECTION       VALUE 'E'.
  7810         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7811         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7812         16  CL-BENEFICIARY          PIC X(10).
  7813         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7814         16  CL-DENIAL-TYPE          PIC X.
  7815             88  CL-TYPE-DENIAL          VALUE '1'.
  7816             88  CL-TYPE-RESCISSION      VALUE '2'.
  7817             88  CL-TYPE-REFORMATION     VALUE '3'.
  7818             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7819             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7820         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7821         16  filler                  pic x(3).
  7822*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7823*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7824*        16  CL-RTW-DT               PIC XX.
  7825
  7826     12  CL-TRAILER-CONTROLS.
  7827         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7828             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7829             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7830             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7831         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7832         16  FILLER                  PIC XX.
  7833         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7834         16  CL-ADDRESS-TRAILER-CNT.
  7835             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7836                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7837             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7838                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7839             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7840                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7841             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7842                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7843             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7844                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7845             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7846                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7847             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7848                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7849
  7850     12  CL-CV-REFERENCE-NO.
  7851         16  CL-CV-REFNO-PRIME       PIC X(18).
  7852         16  CL-CV-REFNO-SFX         PIC XX.
  7853
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 144
* EL6311.cbl
  7854     12  CL-FILE-LOCATION            PIC X(4).
  7855
  7856     12  CL-PROCESS-ERRORS.
  7857         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7858             88  NO-FATAL-ERRORS        VALUE ZERO.
  7859         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7860             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7861
  7862     12  CL-PRODUCT-CD               PIC X.
  7863
  7864     12  CL-CURRENT-KEY-DATA.
  7865         16  CL-CURRENT-CARRIER      PIC X.
  7866         16  CL-CURRENT-GROUPING     PIC X(6).
  7867         16  CL-CURRENT-STATE        PIC XX.
  7868         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7869
  7870     12  CL-ASSOCIATES               PIC X.
  7871         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7872         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7873         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7874         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7875
  7876     12  CL-ACTIVITY-CODE            PIC 99.
  7877     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7878     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7879
  7880     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7881     12  CL-LAG-REPORT-CODE          PIC 9.
  7882     12  CL-LOAN-TYPE                PIC XX.
  7883     12  CL-LEGAL-STATE              PIC XX.
  7884
  7885     12  CL-YESNOSW                  PIC X.
  7886     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7887         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7888         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7889         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7890     12  cl-insured-type             pic x.
  7891         88  cl-claim-on-primary         value 'P'.
  7892         88  cl-claim-on-co-borrower     value 'C'.
  7893     12  cl-benefit-expiration-dt    PIC XX.
  7894*                                COPY ERCENDT.
  7895******************************************************************
  7896*                                                                *
  7897*                                                                *
  7898*                            ERCENDT.                            *
  7899*                            VMOD=2.001                          *
  7900*                                                                *
  7901*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7902*                                                                *
  7903*   FILE TYPE = VSAM,KSDS                                        *
  7904*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7905*                                                                *
  7906*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7907*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7908*                                                                *
  7909*   LOG = NO                                                     *
  7910*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7911******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 145
* EL6311.cbl
  7912*-----------------------------------------------------------------
  7913*                   C H A N G E   L O G
  7914*
  7915* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7916*-----------------------------------------------------------------
  7917*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7918* EFFECTIVE    NUMBER
  7919*-----------------------------------------------------------------
  7920* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7921*                                WITH OPEN CLAIMS
  7922* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7923* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7924* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7925* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7926*-----------------------------------------------------------------
  7927 01  ENDORSEMENT-RECORD.
  7928     12  EN-RECORD-ID                PIC XX.
  7929         88  VALID-EN-ID                VALUE 'EN'.
  7930     12  EN-CONTROL-PRIMARY.
  7931         16  EN-COMPANY-CD           PIC X.
  7932         16  EN-CARRIER              PIC X.
  7933         16  EN-GROUPING             PIC X(6).
  7934         16  EN-STATE                PIC XX.
  7935         16  EN-ACCOUNT              PIC X(10).
  7936         16  EN-CERT-EFF-DT          PIC XX.
  7937         16  EN-CERT-NO.
  7938             20  EN-CERT-PRIME       PIC X(10).
  7939             20  EN-CERT-SFX         PIC X.
  7940         16  EN-REC-TYPE             PIC X.
  7941             88  EN-ISSUE               VALUE 'I'.
  7942             88  EN-CANCELLATION        VALUE 'C'.
  7943         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7944     12  EN-CONTROL-BY-ARCH-NO.
  7945         16  EN-COMPANY-CD-A1              PIC X.
  7946         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7947     12  EN-LAST-MAINT-DT            PIC XX.
  7948     12  EN-LAST-MAINT-BY            PIC X(4).
  7949     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7950     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7951     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7952         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7953         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7954         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7955         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7956         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7957         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7958         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7959         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7960         16  EN-LF-ORIG-BENCD        PIC XX.
  7961         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7962         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7963         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7964         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7965         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7966         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7967*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7968         16  EN-ORIG-CRED-BENE       PIC X(25).
  7969         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 146
* EL6311.cbl
  7970         16  FILLER                  PIC X.
  7971         16  EN-AH-ORIG-BENCD        PIC XX.
  7972         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7973         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7974         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7975         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7976*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7977*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7978         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7979         16  F                       PIC X(09).
  7980         16  EN-AH-ORIG-CP           PIC 99.
  7981         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7982         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7983         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7984         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7985         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7986         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7987         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7988         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7989         16  EN-LF-NEW-BENCD         PIC XX.
  7990         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7991         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7992         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7993         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7994         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7995         16  EN-LF-NEW-EXP-DT        PIC XX.
  7996         16  EN-NEW-CRED-BENE        PIC X(25).
  7997         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7998         16  FILLER                  PIC X.
  7999         16  EN-AH-NEW-BENCD         PIC XX.
  8000         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  8001         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8002         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8003         16  EN-AH-NEW-EXP-DT        PIC XX.
  8004*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  8005*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  8006*        16  F                       PIC X(12).
  8007         16  EN-AH-NEW-CP            PIC 99.
  8008         16  EN-SIG-SW               PIC X.
  8009         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8010         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  8011         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  8012         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8013         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8014         16  FILLER                  PIC X(33).
  8015     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8016         16  EN-LF-ORIG-REF-DT       PIC XX.
  8017         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8018         16  EN-AH-ORIG-REF-DT       PIC XX.
  8019         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8020         16  EN-LF-NEW-REF-DT        PIC XX.
  8021         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8022         16  EN-AH-NEW-REF-DT        PIC XX.
  8023         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8024         16  EN-FLAG-CERT            PIC X.
  8025         16  EN-INS-LAST-NAME        PIC X(15).
  8026         16  EN-INS-FIRST-NAME       PIC X(10).
  8027         16  EN-INS-MIDDLE-INIT      PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 147
* EL6311.cbl
  8028         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8029         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8030         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8031         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8032         16  FILLER                  PIC X(262).
  8033     12  EN-MONEY-SW             PIC X.
  8034     12  EN-HEALTH-APP           PIC X.
  8035     12  EN-VOUCHER-SW           PIC X.
  8036     12  EN-PAYEE                PIC X(14).
  8037     12  EN-INPUT-DT             PIC XX.
  8038     12  EN-PROCESS-DT           PIC XX.
  8039     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8040     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8041     12  EN-REASON-CODES.
  8042         16  F OCCURS 12.
  8043             20  EN-REASON-CODE  PIC X(4).
  8044     12  EN-TEMPLATE-USED        PIC X(8).
  8045     12  EN-DOCU-TYPE            PIC X.
  8046         88  EN-VERI-DOCU          VALUE 'V'.
  8047         88  EN-GCE-DOCU           VALUE 'G'.
  8048         88  EN-CANC-DOCU          VALUE 'C'.
  8049     12  EN-COMMENTS1            PIC X(13).
  8050     12  EN-COMMENTS2            PIC X(70).
  8051     12  EN-COMM-CHGBK           PIC X.
  8052         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8053         88  EN-CHG-ACCT           VALUE 'Y'.
  8054     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8055     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8056     12  EN-BATCH-NUMBER         PIC X(6).
  8057     12  EN-ACCT-SUMM            PIC X.
  8058     12  EN-CSO-SUMM             PIC X.
  8059     12  en-check-type           pic x.
  8060     12  FILLER                  PIC X(12).
  8061******************************************************************
  8062*                                COPY ELCCRTT.
  8063******************************************************************
  8064*                                                                *
  8065*                            ELCCRTT.                            *
  8066*                                                                *
  8067*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8068*                                                                *
  8069*   FILE TYPE = VSAM,KSDS                                        *
  8070*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8071*                                                                *
  8072*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8073*                                                                *
  8074*   LOG = YES                                                    *
  8075*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8076******************************************************************
  8077*                   C H A N G E   L O G
  8078*
  8079* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8080*-----------------------------------------------------------------
  8081*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8082* EFFECTIVE    NUMBER
  8083*-----------------------------------------------------------------
  8084* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8085* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 148
* EL6311.cbl
  8086* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8087* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8088* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8089* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8090* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8091* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8092* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8093* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8094* 091318  CR2018073000001  PEMA  ADD Refund methods
  8095* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8096******************************************************************
  8097
  8098 01  CERTIFICATE-TRAILERS.
  8099     12  CS-RECORD-ID                      PIC XX.
  8100         88  VALID-CS-ID                      VALUE 'CS'.
  8101
  8102     12  CS-CONTROL-PRIMARY.
  8103         16  CS-COMPANY-CD                 PIC X.
  8104         16  CS-CARRIER                    PIC X.
  8105         16  CS-GROUPING                   PIC X(6).
  8106         16  CS-STATE                      PIC XX.
  8107         16  CS-ACCOUNT                    PIC X(10).
  8108         16  CS-CERT-EFF-DT                PIC XX.
  8109         16  CS-CERT-NO.
  8110             20  CS-CERT-PRIME             PIC X(10).
  8111             20  CS-CERT-SFX               PIC X.
  8112         16  CS-TRAILER-TYPE               PIC X.
  8113             88  COMM-TRLR           VALUE 'A'.
  8114             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8115             88  CERT-DATA-TRLR      VALUE 'C'.
  8116
  8117     12  CS-DATA-AREA                      PIC X(516).
  8118
  8119     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8120         16  CS-BANK-COMMISSION-AREA.
  8121             20  CS-BANK-COMMS       OCCURS 10.
  8122                 24  CS-AGT                PIC X(10).
  8123                 24  CS-COM-TYP            PIC X.
  8124                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8125                 24  CS-RECALC-LV-INDIC    PIC X.
  8126                 24  FILLER                PIC X(10).
  8127         16  FILLER                        PIC X(256).
  8128
  8129     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8130****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8131         16  CS-MB-CLAIM-DATA OCCURS 24.
  8132             20  CS-CLAIM-NO               PIC X(7).
  8133             20  CS-CLAIM-TYPE             PIC X.
  8134                 88  CS-AH-CLM               VALUE 'A'.
  8135                 88  CS-IU-CLM               VALUE 'I'.
  8136                 88  CS-GP-CLM               VALUE 'G'.
  8137                 88  CS-LF-CLM               VALUE 'L'.
  8138                 88  CS-PR-CLM               VALUE 'P'.
  8139                 88  CS-FL-CLM               VALUE 'F'.
  8140                 88  CS-OT-CLM               VALUE 'O'.
  8141             20  CS-INSURED-TYPE           PIC X.
  8142                 88  CS-PRIM-INSURED          VALUE 'P'.
  8143                 88  CS-CO-BORROWER           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 149
* EL6311.cbl
  8144             20  CS-BENEFIT-PERIOD         PIC 99.
  8145             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8146             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8147             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8148         16  FILLER                        PIC X(12).
  8149     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8150         16  CS-VIN-NUMBER                 PIC X(17).
  8151         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8152         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8153         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8154         16  cs-agent-name.
  8155             20  cs-agent-fname            pic x(20).
  8156             20  cs-agent-mi               pic x.
  8157             20  cs-agent-lname            pic x(25).
  8158         16  cs-license-no                 pic x(15).
  8159         16  cs-npn-number                 pic x(10).
  8160         16  cs-agent-edit-status          pic x.
  8161             88  cs-ae-refer-to-manager      value 'M'.
  8162             88  cs-ae-cover-sheet           value 'C'.
  8163             88  cs-ae-sig-form              value 'S'.
  8164             88  cs-ae-verified              value 'V'.
  8165             88  cs-unidentified-signature   value 'U'.
  8166             88  cs-cert-returned            value 'R'.
  8167             88  cs-accept-no-commission     value 'N'.
  8168         16  cs-year                       pic 9999.
  8169         16  cs-make                       pic x(20).
  8170         16  cs-model                      pic x(20).
  8171         16  cs-future                     pic x(20).
  8172         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8173         16  cs-claim-verification-status  pic x.
  8174             88  cs-clm-ver-eligible         value 'A'.
  8175             88  cs-clm-ver-partial-elig     value 'B'.
  8176             88  cs-clm-ver-not-eligible     value 'C'.
  8177             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8178             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8179             88  cs-clm-ver-ND-CERT          value 'F'.
  8180             88  cs-clm-ver-spec-other       value 'G'.
  8181             88  cs-clam-ver-pratial-corrected
  8182                                             value 'H'.
  8183             88  cs-clm-ver-no-matches       value 'I'.
  8184             88  cs-clm-ver-not-elig-corrected
  8185                                             value 'J'.
  8186             88  cs-clm-ver-needs-review     value 'R'.
  8187             88  cs-clm-ver-sent-to-claims   value 'W'.
  8188         16  CS-LF-REFUND-METHOD           PIC X.
  8189         16  CS-AH-REFUND-METHOD           PIC X.
  8190         16  FILLER                        PIC X(353). *> was 420
  8191*        16  FILLER                        PIC X(496).
  8192*                                COPY ERCCHEK.
  8193******************************************************************
  8194*                                                                *
  8195*                                                                *
  8196*                            ERCCHEK                             *
  8197*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8198*                            VMOD=2.008                          *
  8199*                                                                *
  8200*   FILE DESCRIPTION = CHECK RECORDS                             *
  8201*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 150
* EL6311.cbl
  8202*   FILE TYPE = VSAM,KSDS                                        *
  8203*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8204*                                                                *
  8205*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8206*       ALTERNATE INDEX = NONE                                   *
  8207*                                                                *
  8208*   LOG = YES                                                    *
  8209*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8210******************************************************************
  8211*                   C H A N G E   L O G
  8212*
  8213* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8214*-----------------------------------------------------------------
  8215*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8216* EFFECTIVE    NUMBER
  8217*-----------------------------------------------------------------
  8218* 021414    2003053000001  PEMA  changes for auto chk request
  8219******************************************************************
  8220 01  CHECK-RECORDS.
  8221     12  CH-RECORD-ID                      PIC XX.
  8222         88  VALID-CH-ID                      VALUE 'CH'.
  8223
  8224     12  CH-CONTROL-PRIMARY.
  8225         16  CH-COMPANY-CD                 PIC X.
  8226         16  CH-CARRIER                    PIC X.
  8227         16  CH-GROUPING                   PIC X(6).
  8228         16  CH-STATE                      PIC XX.
  8229         16  CH-ACCOUNT                    PIC X(10).
  8230         16  CH-CERT-EFF-DT                PIC XX.
  8231         16  CH-CERT-NO.
  8232             20  CH-CERT-PRIME             PIC X(10).
  8233             20  CH-CERT-SFX               PIC X.
  8234         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8235
  8236     12  CH-RECORDED-DT                    PIC XX.
  8237     12  CH-RECORDED-BY                    PIC X(4).
  8238     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8239
  8240     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8241     12  CH-CHECK-NO                       PIC X(7).
  8242     12  CH-REASON-FOR-CHECK               PIC X(25).
  8243     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8244     12  FILLER                            PIC X.
  8245
  8246     12  CH-PAYEE-INFO.
  8247         16  CH-PAYEE-NAME-1               PIC X(30).
  8248         16  CH-PAYEE-NAME-2               PIC X(30).
  8249         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8250         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8251         16  CH-PAYEE-CITY-ST.
  8252             20  CH-PAYEE-CITY             PIC X(28).
  8253             20  CH-PAYEE-STATE            PIC XX.
  8254         16  CH-PAYEE-ZIP-CODE.
  8255             20  CH-PAYEE-ZIP.
  8256                 24  CH-ZIP-PRI-1ST        PIC X.
  8257                     88  CH-CANADIAN-POST-CODE
  8258                                           VALUES 'A' THRU 'Z'.
  8259                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 151
* EL6311.cbl
  8260             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8261         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8262             20  CH-CAN-POSTAL-1           PIC XXX.
  8263             20  CH-CAN-POSTAL-2           PIC XXX.
  8264             20  FILLER                    PIC XXX.
  8265
  8266     12  CH-CHECK-STUB-TEXT.
  8267         16  CH-STUB-LINE-1                PIC X(30).
  8268         16  CH-TEXT-LINE-1                PIC X(50).
  8269         16  CH-TEXT-LINE-2                PIC X(50).
  8270         16  CH-TEXT-LINE-3                PIC X(40).
  8271     12  CH-RETURN-TO                      PIC X(30).
  8272
  8273     12  CH-COMPENSATION-CONTROL.
  8274         16  CH-COMP-CARRIER               PIC X.
  8275         16  CH-COMP-GROUPING              PIC X(6).
  8276         16  CH-COMP-FIN-RESP              PIC X(10).
  8277         16  CH-COMP-ACCOUNT               PIC X(10).
  8278
  8279     12  CH-CREDIT-SELECT-DT               PIC XX.
  8280     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8281     12  CH-PAYEE-CODE                     PIC X(6).
  8282
  8283     12  CH-VOID-DATA.
  8284         20  CH-VOID-DT                    PIC XX.
  8285         20  CH-VOID-BY                    PIC X(4).
  8286         20  CH-VOID-REASON                PIC X(25).
  8287
  8288     12  CH-APPROVAL-DATA.
  8289         20  CH-APPROVAL-DT                PIC XX.
  8290         20  CH-APPROVAL-STATUS            PIC X.
  8291             88  CH-IN-LIMBO                  VALUE ' '.
  8292             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8293             88  CH-APPROVED                  VALUE 'A'.
  8294             88  CH-DENIED                    VALUE 'D'.
  8295         20  CH-APPROVED-BY                PIC XXXX.
  8296     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8297             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8298     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8299
  8300     12  ch-released-dt                    pic xx.
  8301     12  ch-check-cashed-dt                pic xx.
  8302     12  FILLER                            PIC X.
  8303*    12  CH-CHECK-REFERENCE                PIC X(12).
  8304     12  CH-CHECK-ORIGIN-SW                PIC X.
  8305             88  CH-REFUND-CHECK              VALUE 'R'.
  8306             88  CH-MAINT-CHECK               VALUE 'M'.
  8307
  8308     12  CH-CANC-DT                        PIC XX.
  8309     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8310     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8311
  8312     12  CH-INSURED-NAME                   PIC X(28).
  8313
  8314     12  ch-released-by                    pic x(4).
  8315     12  ch-csr                            pic x(4).
  8316     12  ch-deduct-commission              pic x.
  8317         88  ch-deduct-comm                  value 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 152
* EL6311.cbl
  8318         88  ch-do-not-deduct-comm           value 'N'.
  8319
  8320     12  FILLER                            PIC X(11).
  8321*    12  CH-LETTER-TABLE.
  8322*        16  CH-LETTERS OCCURS 3 TIMES
  8323*                       INDEXED BY CH-LT-NDX
  8324*                                          PIC X(04).
  8325
  8326     12  FILLER                            PIC X(07).
  8327
  8328 01  var                         pic x(30).
  8329 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8330                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8331                          PENDING-MAILING-DATA MAILING-DATA
  8332                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8333                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8334                          CLAIM-MASTER ENDORSEMENT-RECORD
  8335                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8336                          VAR.
  8337 0000-DFHEXIT SECTION.
  8338     MOVE '9#                    $   ' TO DFHEIV0.
  8339     MOVE 'EL6311' TO DFHEIV1.
  8340     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8341
  8342     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8343     MOVE EIBTRMID               TO QID-TERM.
  8344     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8345     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8346     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8347     MOVE 2                      TO EMI-SWITCH2.
  8348
  8349     move spaces to ws-kix-myenv
  8350     set P to address of KIXSYS
  8351     CALL "getenv" using by value P returning var-ptr
  8352     if var-ptr = null then
  8353        display ' kixsys not set '
  8354     else
  8355        set address of var to var-ptr
  8356        move 0 to env-var-len
  8357        inspect var tallying env-var-len
  8358          for characters before X'00'
  8359        unstring var (1:env-var-len) delimited by '/'
  8360           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8361              WS-KIX-SYS
  8362        end-unstring
  8363     end-if
  8364     perform varying a1 from +1 by +1 until a1 > +10
  8365        if ws-kix-myenv (a1:1) = low-values or high-values
  8366           display ' found low or hi val '
  8367           move spaces to ws-kix-myenv (a1:1)
  8368        end-if
  8369     end-perform
  8370*    display ' env *' ws-kix-myenv '*'
  8371     IF EIBCALEN = 0
  8372         GO TO 8800-UNAUTHORIZED-ACCESS.
  8373
  8374     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8375     MOVE '5'                   TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 153
* EL6311.cbl
  8376     PERFORM 9700-DATE-LINK.
  8377     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8378     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8379
  8380     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8381     MOVE SPACE                  TO DC-OPTION-CODE.
  8382     PERFORM 9700-DATE-LINK.
  8383     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8384     MOVE LOW-VALUES             TO EL631BI.
  8385
  8386
  8387* EXEC CICS HANDLE CONDITION
  8388*        PGMIDERR  (9600-PGMID-ERROR)
  8389*        ERROR     (9990-ABEND)
  8390*        INVREQ    (9990-ABEND)
  8391*        QIDERR    (0010-MAIN-LOGIC)
  8392*    END-EXEC.
  8393*    MOVE '"$L.8N                ! " #00008382' TO DFHEIV0
  8394     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8396     MOVE X'2220233030303038333832' TO DFHEIV0(25:11)
  8397     CALL 'kxdfhei1' USING DFHEIV0
  8398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8399
  8400
  8401     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8402         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8403             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8404             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8405             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8406             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8407             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8408             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8409             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8410             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8411
  8412             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8413                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8414
  8415             ELSE
  8416                 NEXT SENTENCE
  8417
  8418         ELSE
  8419             IF PI-CALLING-PROGRAM = 'EL6315'
  8420                SET CALLED-FROM-6315 TO TRUE
  8421             END-IF
  8422             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8423             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8424             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8425             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8426             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8427             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8428             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8429             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8430             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8431             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8432             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8433             GO TO 3900-RE-DISPLAY-RECORD
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 154
* EL6311.cbl
  8434     ELSE
  8435         GO TO 0020-MAIN-LOGIC.
  8436
  8437 0010-MAIN-LOGIC.
  8438     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8439                                    WS-FIRST-ENTRY-SW.
  8440
  8441     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8442
  8443     MOVE LOW-VALUES             TO EC-NEW-CERT
  8444                                    EC-NEW-STATE.
  8445
  8446     IF PI-DISPLAY-ORIGINAL-BATCH
  8447         NEXT SENTENCE
  8448     ELSE
  8449         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8450             GO TO 5000-BROWSE-BATCH-HEADERS.
  8451
  8452     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8453         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8454
  8455     IF PI-CSR-BROWSE
  8456        GO TO 4200-BROWSE-CSR-FORWARD.
  8457
  8458     IF PI-FILE-BROWSE
  8459         GO TO 4300-BROWSE-FILE-FORWARD.
  8460
  8461     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8462
  8463 0020-MAIN-LOGIC.
  8464     IF EIBAID = DFHCLEAR
  8465         GO TO 9400-CLEAR.
  8466
  8467     MOVE LOW-VALUES             TO EC-NEW-CERT
  8468                                    EC-NEW-STATE.
  8469
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 155
* EL6311.cbl
  8471
  8472******************************************************************
  8473*                                                                *
  8474*              R E C E I V E   M A P                             *
  8475*                                                                *
  8476******************************************************************
  8477
  8478 0200-RECEIVE.
  8479     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8480         MOVE ER-0008            TO EMI-ERROR
  8481         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8482         IF PI-MAP-NAME = EL631B
  8483             MOVE -1                 TO BMAINTL
  8484             GO TO 8200-SEND-DATAONLY
  8485         ELSE
  8486             IF PI-MAP-NAME = EL631C
  8487                 MOVE -1                 TO CMAINTL
  8488                 GO TO 8200-SEND-DATAONLY
  8489             ELSE
  8490                 IF PI-MAP-NAME = EL631D
  8491                     MOVE -1                 TO DPFENTRL
  8492                     GO TO 8200-SEND-DATAONLY.
  8493
  8494
  8495* EXEC CICS RECEIVE
  8496*        MAP      (PI-MAP-NAME)
  8497*        MAPSET   (MAPSET-EL6311S)
  8498*        INTO     (EL631BI)
  8499*    END-EXEC.
  8500     MOVE LENGTH OF
  8501      EL631BI
  8502       TO DFHEIV11
  8503*    MOVE '8"T I  L              ''   #00008482' TO DFHEIV0
  8504     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8505     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8506     MOVE X'2020233030303038343832' TO DFHEIV0(25:11)
  8507     CALL 'kxdfhei1' USING DFHEIV0,
  8508           PI-MAP-NAME,
  8509           EL631BI,
  8510           DFHEIV11,
  8511           MAPSET-EL6311S,
  8512           DFHEIV99,
  8513           DFHEIV99
  8514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8515
  8516
  8517******************************************************************
  8518*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8519******************************************************************
  8520
  8521     IF BTYPE-LEN (1) EQUAL +3
  8522        IF BTYPE (1) EQUAL ALL ' '
  8523            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8524
  8525     IF BTYPE-LEN (2) EQUAL +3
  8526        IF BTYPE (2) EQUAL ALL ' '
  8527            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8528
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 156
* EL6311.cbl
  8529     INSPECT EL631BI CONVERTING '_' TO ' '.
  8530
  8531     IF PI-MAP-NAME = EL631B
  8532         IF BPFENTRL GREATER THAN ZEROS
  8533             IF EIBAID NOT = DFHENTER
  8534                 MOVE ER-0004       TO EMI-ERROR
  8535                 MOVE -1            TO BPFENTRL
  8536                 MOVE AL-UNBOF      TO BPFENTRA
  8537                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8538                 GO TO 8200-SEND-DATAONLY
  8539             ELSE
  8540                 IF BPFENTRI NUMERIC AND
  8541                   (BPFENTRI GREATER 0 AND LESS 25)
  8542                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8543                 ELSE
  8544                     MOVE ER-0029  TO EMI-ERROR
  8545                     MOVE AL-UNBON TO BPFENTRA
  8546                     MOVE -1       TO BPFENTRL
  8547                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8548                     GO TO 8200-SEND-DATAONLY
  8549         ELSE
  8550             NEXT SENTENCE
  8551     ELSE
  8552         IF PI-MAP-NAME = EL631C
  8553            IF CPFENTRL GREATER THAN ZEROS
  8554                IF EIBAID NOT = DFHENTER
  8555                 MOVE ER-0004         TO EMI-ERROR
  8556                 MOVE -1              TO CPFENTRL
  8557                 MOVE AL-UNBOF        TO CPFENTRA
  8558                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8559                 GO TO 8200-SEND-DATAONLY
  8560             ELSE
  8561                 IF CPFENTRI NUMERIC AND
  8562                   (CPFENTRI GREATER 0 AND LESS 25)
  8563                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8564                 ELSE
  8565                     MOVE ER-0029      TO EMI-ERROR
  8566                     MOVE AL-UNBON     TO CPFENTRA
  8567                     MOVE -1           TO CPFENTRL
  8568                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8569                     GO TO 8200-SEND-DATAONLY
  8570         ELSE
  8571             NEXT SENTENCE
  8572     ELSE
  8573     IF PI-MAP-NAME = EL631D
  8574         IF DPFENTRL GREATER THAN ZEROS
  8575             IF EIBAID NOT = DFHENTER
  8576                 MOVE ER-0004         TO EMI-ERROR
  8577                 MOVE -1              TO DPFENTRL
  8578                 MOVE AL-UNBOF        TO DPFENTRA
  8579                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8580                 GO TO 8200-SEND-DATAONLY
  8581             ELSE
  8582                 IF DPFENTRI NUMERIC AND
  8583                   (DPFENTRI GREATER 0 AND LESS 25)
  8584                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8585                 ELSE
  8586                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 157
* EL6311.cbl
  8587                     MOVE AL-UNBON     TO DPFENTRA
  8588                     MOVE -1           TO DPFENTRL
  8589                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8590                     GO TO 8200-SEND-DATAONLY.
  8591
  8592     IF EIBAID = DFHPF23
  8593         GO TO 8810-PF23.
  8594
  8595     IF EIBAID = DFHPF24
  8596         GO TO 9200-RETURN-MAIN-MENU.
  8597
  8598     IF EIBAID = DFHPF12
  8599         GO TO 9500-PF12.
  8600
  8601     IF PI-MAP-NAME = EL631B
  8602        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8603
  8604     IF PI-MAP-NAME = EL631C
  8605        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8606
  8607     IF PI-MAP-NAME = EL631D
  8608        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8609
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 158
* EL6311.cbl
  8611
  8612******************************************************************
  8613*                                                                *
  8614*      ISSUE SCREEN PF KEY CHECKING                              *
  8615*                                                                *
  8616******************************************************************
  8617
  8618******************************************************************
  8619*                                                                *
  8620*      PF KEY FUNCTIONS:                                         *
  8621*                                                                *
  8622*      PF1  = BROWSE FORWARD                                     *
  8623*      PF2  = BROWSE BACKWARD                                    *
  8624*      PF3  = CERTIFICATE LOOKUP                                 *
  8625*      PF4  = DISPLAY BATCH HEADER                               *
  8626*      PF5  = ADD ISSUE  SCREEN                                  *
  8627*      PF6  = ADD CANCEL SCREEN                                  *
  8628*      PF7  = CERTIFICATE DISPLAY                                *
  8629*      PF8  = CERTIFICATE NOTES                                  *
  8630*      PF9  = EDIT CONTROL                                       *
  8631*      PF10 = DISPLAY LETTER SCREEN                              *
  8632*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8633*      PF12 = HELP SCREEN                                        *
  8634*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8635*      PF14 = ACCOUNT MASTER                                     *
  8636*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8637*      PF16 = DISPLAY LETTER REVIEW                              *
  8638*                                                                *
  8639******************************************************************
  8640
  8641 0300-CHECK-ISSUE-PF-KEYS.
  8642     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8643        MOVE ER-2337            TO EMI-ERROR
  8644        MOVE -1                  TO BMAINTL
  8645        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8646        GO TO 8200-SEND-DATAONLY.
  8647
  8648     IF EIBAID = DFHPF1
  8649        MOVE '0'                TO PI-EDIT-SW
  8650        IF PI-PRIMARY-BROWSE
  8651           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8652        ELSE
  8653           IF PI-PRIMARY-WITH-SELECT
  8654              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8655           ELSE
  8656              IF PI-FILE-BROWSE
  8657                 GO TO 4300-BROWSE-FILE-FORWARD
  8658              ELSE
  8659                 IF PI-CSR-BROWSE
  8660                    GO TO 4200-BROWSE-CSR-FORWARD
  8661                 ELSE
  8662                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8663
  8664     IF EIBAID = DFHPF2
  8665        MOVE '0'                TO PI-EDIT-SW
  8666        IF PI-PRIMARY-BROWSE
  8667           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8668        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 159
* EL6311.cbl
  8669           IF PI-PRIMARY-WITH-SELECT
  8670              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8671           ELSE
  8672              IF PI-FILE-BROWSE
  8673                 GO TO 4800-BROWSE-FILE-BACKWARD
  8674              ELSE
  8675                 IF PI-CSR-BROWSE
  8676                    GO TO 4900-BROWSE-CSR-BACKWARD
  8677                 ELSE
  8678                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8679
  8680     IF EIBAID = DFHPF3
  8681        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8682        MOVE XCTL-EL127         TO PGM-NAME
  8683        GO TO 9300-XCTL.
  8684
  8685     IF (EIBAID = DFHPF15 OR DFHPF6)
  8686        AND (CSR-EDIT-SESSION)
  8687*       AND (FATAL-OR-UNFORCED)
  8688*       AND (FATAL-ERRORS)
  8689        and (pi-6311-fatal-ctr <> +0)
  8690        MOVE ER-1819             TO EMI-ERROR
  8691        MOVE -1                  TO BMAINTL
  8692        MOVE AL-UANON            TO BMAINTA
  8693        PERFORM 9900-ERROR-FORMAT
  8694                                 THRU 9900-EXIT
  8695        GO TO 8200-SEND-DATAONLY
  8696     END-IF
  8697     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8698      OR (EIBAID = DFHPF10)
  8699        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8700        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8701        IF (RESP-NORMAL)
  8702           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8703              AM-CONTROL-PRIMARY (1:20))
  8704            IF AM-NAME NOT GREATER THAN SPACES OR
  8705               AM-ADDRS NOT GREATER THAN SPACES  OR
  8706               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8707               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8708               AM-ZIP NOT GREATER THAN SPACES
  8709               MOVE ER-3834             TO EMI-ERROR
  8710               MOVE -1                  TO BMAINTL
  8711               MOVE AL-UANON            TO BMAINTA
  8712               PERFORM 9900-ERROR-FORMAT
  8713                                 THRU 9900-EXIT
  8714               GO TO 8200-SEND-DATAONLY
  8715            END-IF
  8716        ELSE
  8717           MOVE ER-1609             TO EMI-ERROR
  8718           MOVE -1                  TO BMAINTL
  8719           MOVE AL-UANON            TO BMAINTA
  8720           PERFORM 9900-ERROR-FORMAT
  8721                                THRU 9900-EXIT
  8722           GO TO 8200-SEND-DATAONLY
  8723        END-IF
  8724
  8725        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8726        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 160
* EL6311.cbl
  8727        IF (ERMAIL-FOUND)
  8728            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8729               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8730               MA-CITY NOT GREATER THAN SPACES OR
  8731               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8732               MA-ZIP-CODE NOT GREATER THAN SPACES
  8733               MOVE ER-3835             TO EMI-ERROR
  8734               MOVE -1                  TO BMAINTL
  8735               MOVE AL-UANON            TO BMAINTA
  8736               PERFORM 9900-ERROR-FORMAT
  8737                                 THRU 9900-EXIT
  8738               GO TO 8200-SEND-DATAONLY
  8739            END-IF
  8740        ELSE
  8741           MOVE ER-3000             TO EMI-ERROR
  8742           MOVE -1                  TO BMAINTL
  8743           MOVE AL-UANON            TO BMAINTA
  8744           PERFORM 9900-ERROR-FORMAT
  8745                                THRU 9900-EXIT
  8746           GO TO 8200-SEND-DATAONLY
  8747        END-IF
  8748
  8749     END-IF
  8750     IF (EIBAID = DFHPF15)
  8751        AND (CSR-EDIT-SESSION)
  8752        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8753        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8754        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8755        MOVE PI-SV-STATE         TO PI-STATE
  8756        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8757        MOVE BCERTNOI            TO PI-CERT-PRIME
  8758        MOVE BSUFIXI             TO PI-CERT-SFX
  8759        MOVE BEFFDTI             TO DEEDIT-FIELD
  8760        PERFORM 8600-DEEDIT
  8761        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8762        MOVE '4'                 TO DC-OPTION-CODE
  8763        PERFORM 9700-DATE-LINK
  8764        IF DATE-CONVERSION-ERROR
  8765           MOVE ER-0348          TO EMI-ERROR
  8766           MOVE -1               TO BEFFDTL
  8767           MOVE AL-UABON         TO BEFFDTA
  8768           PERFORM 9900-ERROR-FORMAT
  8769                                 THRU 9900-EXIT
  8770           GO TO 8200-SEND-DATAONLY
  8771        ELSE
  8772           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8773           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8774           MOVE XCTL-EL6315      TO PGM-NAME
  8775           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8776           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8777           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8778           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8779           GO TO 9300-XCTL
  8780        END-IF
  8781     END-IF
  8782
  8783     IF EIBAID = DFHPF4
  8784        MOVE '0'                TO PI-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 161
* EL6311.cbl
  8785        IF PI-DISPLAY-ORIGINAL-BATCH
  8786           NEXT SENTENCE
  8787        ELSE
  8788           GO TO 7200-DISPLAY-BATCHES.
  8789
  8790     IF EIBAID = DFHPF5
  8791        MOVE ER-0029                TO EMI-ERROR
  8792        MOVE -1                     TO BPFENTRL
  8793        MOVE AL-UNBON               TO BPFENTRA
  8794        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8795        GO TO 8200-SEND-DATAONLY.
  8796*        MOVE '0'                TO PI-EDIT-SW
  8797*        IF PI-DISPLAY-ORIGINAL-BATCH
  8798*           NEXT SENTENCE
  8799*        ELSE
  8800*           MOVE EL631B              TO PI-MAP-NAME
  8801*           MOVE LOW-VALUES          TO EL631BI
  8802*           MOVE 'A'                 TO BMAINTO
  8803*           MOVE AL-UANON            TO BMAINTA
  8804*           MOVE -1                  TO BMAINTL
  8805*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8806*           GO TO 8100-SEND-INITIAL-MAP.
  8807
  8808     IF EIBAID = DFHPF6
  8809        IF NOT CSR-EDIT-SESSION
  8810           MOVE ER-0029                TO EMI-ERROR
  8811           MOVE -1                     TO BPFENTRL
  8812           MOVE AL-UNBON               TO BPFENTRA
  8813           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8814           GO TO 8200-SEND-DATAONLY
  8815*           MOVE '0'              TO PI-EDIT-SW
  8816*           IF PI-DISPLAY-ORIGINAL-BATCH
  8817*              NEXT SENTENCE
  8818*           ELSE
  8819*              MOVE EL631C        TO PI-MAP-NAME
  8820*              MOVE LOW-VALUES    TO EL631CI
  8821*              MOVE 'A'           TO CMAINTO
  8822*              MOVE AL-UANON      TO CMAINTA
  8823*              MOVE -1            TO CMAINTL
  8824*              MOVE '6'           TO PI-MAINT-FUNCTION
  8825*              GO TO 8100-SEND-INITIAL-MAP
  8826*           END-IF
  8827        ELSE
  8828           PERFORM 5100-PROCESS-POL-RESC
  8829                                 THRU 5100-EXIT
  8830           MOVE  PI-PREV-CONTROL-PRIMARY
  8831                                 TO ERPNDB-KEY
  8832
  8833* EXEC CICS READ
  8834*              SET     (ADDRESS OF PENDING-BUSINESS)
  8835*              DATASET (FILE-ID-ERPNDB)
  8836*              RIDFLD  (ERPNDB-KEY)
  8837*          END-EXEC
  8838*    MOVE '&"S        E          (   #00008803' TO DFHEIV0
  8839     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8840     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8841     MOVE X'2020233030303038383033' TO DFHEIV0(25:11)
  8842     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 162
* EL6311.cbl
  8843           FILE-ID-ERPNDB,
  8844           DFHEIV20,
  8845           DFHEIV99,
  8846           ERPNDB-KEY,
  8847           DFHEIV99,
  8848           DFHEIV99,
  8849           DFHEIV99
  8850     SET ADDRESS OF PENDING-BUSINESS TO
  8851         DFHEIV20
  8852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8853           PERFORM 9800-LINK-PENDING-EDIT
  8854                                 THRU 9800-EXIT
  8855           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8856           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8857                                    PI-PREV-SEQ-NO
  8858           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8859*                                    WS-CANCEL-LETTER-SW
  8860                                    PI-ALL-ISSUES-SW
  8861                                    PI-ALL-CANCELS-SW
  8862           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8863        END-IF
  8864     END-IF
  8865     IF EIBAID = DFHPF7
  8866        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8867        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8868        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8869        MOVE PI-SV-STATE            TO PI-STATE
  8870        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8871        MOVE BCERTNOI               TO PI-CERT-PRIME
  8872        MOVE BSUFIXI                TO PI-CERT-SFX
  8873        MOVE BEFFDTI                TO DEEDIT-FIELD
  8874        PERFORM 8600-DEEDIT
  8875        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8876        MOVE '4'                    TO DC-OPTION-CODE
  8877        PERFORM 9700-DATE-LINK
  8878        IF DATE-CONVERSION-ERROR
  8879           MOVE ER-0348            TO EMI-ERROR
  8880           MOVE -1                  TO BEFFDTL
  8881           MOVE AL-UABON            TO BEFFDTA
  8882           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8883           GO TO 8200-SEND-DATAONLY
  8884        ELSE
  8885           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8886           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8887           MOVE XCTL-EL1273        TO PGM-NAME
  8888           GO TO 9300-XCTL.
  8889
  8890     IF EIBAID = DFHPF8
  8891        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8892        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8893        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8894        MOVE PI-SV-STATE            TO PI-STATE
  8895        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8896        MOVE BCERTNOI               TO PI-CERT-PRIME
  8897        MOVE BSUFIXI                TO PI-CERT-SFX
  8898        MOVE BEFFDTI                TO DEEDIT-FIELD
  8899        PERFORM 8600-DEEDIT
  8900        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 163
* EL6311.cbl
  8901        MOVE '4'                    TO DC-OPTION-CODE
  8902        PERFORM 9700-DATE-LINK
  8903        IF DATE-CONVERSION-ERROR
  8904           MOVE ER-0348            TO EMI-ERROR
  8905           MOVE -1                  TO BEFFDTL
  8906           MOVE AL-UABON            TO BEFFDTA
  8907           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8908           GO TO 8200-SEND-DATAONLY
  8909        ELSE
  8910           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8911           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8912           IF PI-COMPANY-ID = 'DMD'
  8913               MOVE XCTL-EL401DMD      TO PGM-NAME
  8914             ELSE
  8915               MOVE XCTL-EL1279        TO PGM-NAME
  8916           END-IF
  8917           GO TO 9300-XCTL.
  8918
  8919     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8920        MOVE XCTL-EL6312         TO PGM-NAME
  8921
  8922* EXEC CICS XCTL
  8923*           PROGRAM   (PGM-NAME)
  8924*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8925*           LENGTH    (WS-COMM-LENGTH)
  8926*       END-EXEC
  8927*    MOVE '.$C                   %   #00008876' TO DFHEIV0
  8928     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8929     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8930     MOVE X'2020233030303038383736' TO DFHEIV0(25:11)
  8931     CALL 'kxdfhei1' USING DFHEIV0,
  8932           PGM-NAME,
  8933           PROGRAM-INTERFACE-BLOCK,
  8934           WS-COMM-LENGTH,
  8935           DFHEIV99
  8936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8937     ELSE
  8938        MOVE '0'                 TO  PI-EDIT-SW.
  8939
  8940     IF  EIBAID = DFHPF10
  8941         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8942         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8943         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8944                                    PI-1042-WA
  8945         MOVE 4                  TO PI-689-DATA-SOURCE
  8946         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8947         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8948         MOVE PI-SV-STATE        TO PI-689-STATE
  8949         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8950         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8951         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8952         MOVE PI-PB-ALT-CHG-SEQ-NO
  8953                                 TO PI-689-ALT-SEQ-NO
  8954         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8955         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8956         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8957         MOVE +0                 TO PI-689-CONTROL
  8958         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 164
* EL6311.cbl
  8959                                    PI-689-EXP-DATE
  8960                                    PI-689-RESP-PERSON
  8961                                    PI-689-TYPE
  8962                                    PI-689-FOLLOW-UP-EDIT
  8963                                    PI-689-RESEND1-EDIT
  8964                                    PI-689-SEQ-EDIT
  8965                                    PI-689-BCSEQ-EDIT
  8966                                    PI-689-LBL-OVERRIDE
  8967         MOVE W-LETTER-COMMUNICATION-AREAS
  8968                                 TO PI-PROGRAM-WORK-AREA
  8969         MOVE XCTL-EL689         TO PGM-NAME
  8970         GO TO 9300-XCTL.
  8971
  8972     IF  EIBAID = DFHPF16
  8973         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8974         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8975         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8976                                    PI-1042-WA
  8977         MOVE 4                  TO PI-689-DATA-SOURCE
  8978         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8979         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8980         MOVE PI-SV-STATE        TO PI-689-STATE
  8981         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8982         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8983         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8984         MOVE PI-PB-ALT-CHG-SEQ-NO
  8985                                 TO PI-689-ALT-SEQ-NO
  8986         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8987         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8988         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8989         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8990         MOVE W-LETTER-COMMUNICATION-AREAS
  8991                                 TO PI-PROGRAM-WORK-AREA
  8992         MOVE XCTL-EL690         TO PGM-NAME
  8993         GO TO 9300-XCTL.
  8994
  8995     IF EIBAID = DFHPF13
  8996         MOVE XCTL-EL6313        TO PGM-NAME
  8997         GO TO 9300-XCTL.
  8998
  8999     IF EIBAID = DFHPF17
  9000        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  9001        IF (PB-I-LOAN-APR numeric)
  9002           and (pb-i-loan-apr < 99.9999)
  9003           AND (PB-I-BENEFICIARY-NAME NOT
  9004              = SPACES AND LOW-VALUES)
  9005
  9006           MOVE LINK-ELVADS          TO PGM-NAME
  9007
  9008* EXEC CICS LINK
  9009*              PROGRAM    (PGM-NAME)
  9010*              COMMAREA   (WS-PASS-AREA)
  9011*              LENGTH     (WS-PASS-AREA-LENGTH)
  9012*          END-EXEC
  9013*    MOVE '."C                   (   #00008951' TO DFHEIV0
  9014     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9015     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9016     MOVE X'2020233030303038393531' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 165
* EL6311.cbl
  9017     CALL 'kxdfhei1' USING DFHEIV0,
  9018           PGM-NAME,
  9019           WS-PASS-AREA,
  9020           WS-PASS-AREA-LENGTH,
  9021           DFHEIV99,
  9022           DFHEIV99,
  9023           DFHEIV99,
  9024           DFHEIV99
  9025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9026
  9027           MOVE 0000             TO EMI-ERROR
  9028           MOVE -1               TO BMAINTL
  9029           PERFORM 9900-ERROR-FORMAT
  9030                                 THRU 9900-EXIT
  9031           GO TO 8200-SEND-DATAONLY
  9032        ELSE
  9033           MOVE ER-0877            TO EMI-ERROR
  9034           MOVE -1                  TO BEFFDTL
  9035           MOVE AL-UABON            TO BEFFDTA
  9036           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9037           GO TO 8200-SEND-DATAONLY
  9038        END-IF
  9039     END-IF
  9040     IF EIBAID = DFHPF14
  9041        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9042        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9043        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9044        MOVE PI-SV-STATE            TO PI-CR-STATE
  9045        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9046        MOVE SPACE                  TO PI-EDIT-SW
  9047        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9048        MOVE XCTL-EL650             TO PGM-NAME
  9049        GO TO 9300-XCTL.
  9050
  9051     IF EIBAID = DFHPF15
  9052        IF PI-COMPANY-ID  =  'HER'
  9053            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9054            MOVE XCTL-EL680         TO PGM-NAME
  9055            GO TO 9300-XCTL.
  9056
  9057     IF EIBAID = DFHENTER OR DFHPF11
  9058        GO TO 1000-ISSUE-MAINLINE.
  9059
  9060     MOVE ER-0029                TO EMI-ERROR
  9061     MOVE -1                     TO BPFENTRL
  9062     MOVE AL-UNBON               TO BPFENTRA
  9063     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9064     GO TO 8200-SEND-DATAONLY.
  9065
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 166
* EL6311.cbl
  9067
  9068******************************************************************
  9069*                                                                *
  9070*      CANCEL SCREEN PF KEY CHECKING                             *
  9071*                                                                *
  9072******************************************************************
  9073
  9074******************************************************************
  9075*                                                                *
  9076*      PF KEY FUNCTIONS:                                         *
  9077*                                                                *
  9078*      PF1  = BROWSE FORWARD                                     *
  9079*      PF2  = BROWSE BACKWARD                                    *
  9080*      PF3  = CERTIFICATE LOOKUP                                 *
  9081*      PF4  = DISPLAY BATCH HEADER                               *
  9082*      PF5  = ADD ISSUE SCREEN                                   *
  9083*      PF6  = ADD CANCEL SCREEN                                  *
  9084*      PF7  = CERTIFICATE DISPLAY                                *
  9085*      PF8  = CERTIFICATE NOTES                                  *
  9086*      PF9  = EDIT CONTROL                                       *
  9087*      PF10 = DISPLAY LETTER SCREEN                              *
  9088*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  9089*      PF12 = DISPLAY HELP SCREEN                                *
  9090*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  9091*      PF14 = ACCOUNT MASTER                                     *
  9092*      PF16 = LETTER REVIEW                                      *
  9093*                                                                *
  9094******************************************************************
  9095
  9096 0400-CHECK-CANCEL-PF-KEYS.
  9097     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  9098        MOVE ER-2337             TO EMI-ERROR
  9099        MOVE -1                  TO CMAINTL
  9100        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9101        GO TO 8200-SEND-DATAONLY.
  9102
  9103     IF EIBAID = DFHPF1
  9104        MOVE '0'                TO PI-EDIT-SW
  9105        IF PI-PRIMARY-BROWSE
  9106           GO TO 4100-BROWSE-PRIMARY-FORWARD
  9107        ELSE
  9108           IF PI-PRIMARY-WITH-SELECT
  9109              GO TO 4100-BROWSE-PRIMARY-FORWARD
  9110           ELSE
  9111              IF PI-FILE-BROWSE
  9112                 GO TO 4300-BROWSE-FILE-FORWARD
  9113              ELSE
  9114                 IF PI-CSR-BROWSE
  9115                    GO TO 4200-BROWSE-CSR-FORWARD
  9116                 ELSE
  9117                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  9118
  9119     IF EIBAID = DFHPF2
  9120        MOVE '0'                TO PI-EDIT-SW
  9121        IF PI-PRIMARY-BROWSE
  9122           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9123        ELSE
  9124           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 167
* EL6311.cbl
  9125              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9126           ELSE
  9127              IF PI-FILE-BROWSE
  9128                 GO TO 4800-BROWSE-FILE-BACKWARD
  9129              ELSE
  9130                 IF PI-CSR-BROWSE
  9131                    GO TO 4900-BROWSE-CSR-BACKWARD
  9132                 ELSE
  9133                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  9134
  9135     IF EIBAID = DFHPF3
  9136        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9137        MOVE XCTL-EL127         TO PGM-NAME
  9138        GO TO 9300-XCTL.
  9139
  9140     IF (EIBAID = DFHPF15 OR DFHPF17)
  9141        AND (CSR-EDIT-SESSION)
  9142*       AND (FATAL-OR-UNFORCED)
  9143        AND (FATAL-ERRORS)
  9144        MOVE ER-1819             TO EMI-ERROR
  9145        MOVE -1                  TO CMAINTL
  9146        MOVE AL-UANON            TO CMAINTA
  9147        PERFORM 9900-ERROR-FORMAT
  9148                                 THRU 9900-EXIT
  9149        GO TO 8200-SEND-DATAONLY
  9150     END-IF
  9151     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  9152       AND (CSR-EDIT-SESSION)
  9153        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  9154        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  9155        IF (RESP-NORMAL)
  9156           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  9157              AM-CONTROL-PRIMARY (1:20))
  9158            IF AM-NAME NOT GREATER THAN SPACES OR
  9159               AM-ADDRS NOT GREATER THAN SPACES  OR
  9160               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  9161               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  9162               AM-ZIP NOT GREATER THAN SPACES
  9163               MOVE ER-3834             TO EMI-ERROR
  9164               MOVE -1                  TO BMAINTL
  9165               MOVE AL-UANON            TO BMAINTA
  9166               PERFORM 9900-ERROR-FORMAT
  9167                                 THRU 9900-EXIT
  9168               GO TO 8200-SEND-DATAONLY
  9169            END-IF
  9170        ELSE
  9171           MOVE ER-1609             TO EMI-ERROR
  9172           MOVE -1                  TO BMAINTL
  9173           MOVE AL-UANON            TO BMAINTA
  9174           PERFORM 9900-ERROR-FORMAT
  9175                                THRU 9900-EXIT
  9176           GO TO 8200-SEND-DATAONLY
  9177        END-IF
  9178
  9179        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  9180        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  9181        IF (ERMAIL-FOUND)
  9182            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 168
* EL6311.cbl
  9183               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  9184               MA-CITY NOT GREATER THAN SPACES OR
  9185               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  9186               MA-ZIP-CODE NOT GREATER THAN SPACES
  9187               MOVE ER-3835             TO EMI-ERROR
  9188               MOVE -1                  TO BMAINTL
  9189               MOVE AL-UANON            TO BMAINTA
  9190               PERFORM 9900-ERROR-FORMAT
  9191                                 THRU 9900-EXIT
  9192               GO TO 8200-SEND-DATAONLY
  9193            END-IF
  9194        ELSE
  9195           MOVE ER-3000             TO EMI-ERROR
  9196           MOVE -1                  TO BMAINTL
  9197           MOVE AL-UANON            TO BMAINTA
  9198           PERFORM 9900-ERROR-FORMAT
  9199                                THRU 9900-EXIT
  9200           GO TO 8200-SEND-DATAONLY
  9201        END-IF
  9202
  9203     END-IF
  9204     IF (EIBAID = DFHPF15 OR DFHPF17)
  9205        AND (CSR-EDIT-SESSION)
  9206        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9207        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9208        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9209        MOVE PI-SV-STATE         TO PI-STATE
  9210        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9211        MOVE CCERTNOI            TO PI-CERT-PRIME
  9212        MOVE CSUFIXI             TO PI-CERT-SFX
  9213        MOVE CEFFDTI             TO DEEDIT-FIELD
  9214        PERFORM 8600-DEEDIT
  9215        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9216        MOVE '4'                 TO DC-OPTION-CODE
  9217        PERFORM 9700-DATE-LINK
  9218        IF DATE-CONVERSION-ERROR
  9219           MOVE ER-0348          TO EMI-ERROR
  9220           MOVE -1               TO CEFFDTL
  9221           MOVE AL-UABON         TO CEFFDTA
  9222           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9223           GO TO 8200-SEND-DATAONLY
  9224        ELSE
  9225           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9226           PERFORM 6000-CREATE-TEMP-STORAGE
  9227                                 THRU 6000-EXIT
  9228           IF EIBAID = DFHPF17
  9229               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9230                                  THRU 6400-EXIT
  9231               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9232                                 '2' AND '3' AND '4'
  9233                  MOVE ER-3831     TO  EMI-ERROR
  9234                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9235                  GO TO 8200-SEND-DATAONLY
  9236               END-IF
  9237               MOVE 'Y'          TO PI-CLM-RESC-IND
  9238           ELSE
  9239               MOVE 'N'          TO PI-CLM-RESC-IND
  9240           END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 169
* EL6311.cbl
  9241           MOVE XCTL-EL6316      TO PGM-NAME
  9242           MOVE '2'              TO PI-ISS-CAN-SW
  9243           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9244           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9245           GO TO 9300-XCTL
  9246        END-IF
  9247     END-IF
  9248
  9249     IF EIBAID = DFHPF4
  9250        MOVE '0'                TO PI-EDIT-SW
  9251        IF PI-DISPLAY-ORIGINAL-BATCH
  9252           NEXT SENTENCE
  9253        ELSE
  9254           GO TO 7200-DISPLAY-BATCHES.
  9255
  9256     IF EIBAID = DFHPF5
  9257        MOVE ER-0029                TO EMI-ERROR
  9258        MOVE -1                     TO BPFENTRL
  9259        MOVE AL-UNBON               TO BPFENTRA
  9260        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9261        GO TO 8200-SEND-DATAONLY.
  9262*        MOVE '0'                TO PI-EDIT-SW
  9263*        IF PI-DISPLAY-ORIGINAL-BATCH
  9264*           NEXT SENTENCE
  9265*        ELSE
  9266*           MOVE EL631B              TO PI-MAP-NAME
  9267*           MOVE LOW-VALUES          TO EL631BI
  9268*           MOVE 'A'                 TO BMAINTO
  9269*           MOVE AL-UANON            TO BMAINTA
  9270*           MOVE -1                  TO BMAINTL
  9271*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9272*           GO TO 8100-SEND-INITIAL-MAP.
  9273
  9274     IF EIBAID = DFHPF6
  9275        MOVE ER-0029                TO EMI-ERROR
  9276        MOVE -1                     TO BPFENTRL
  9277        MOVE AL-UNBON               TO BPFENTRA
  9278        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9279        GO TO 8200-SEND-DATAONLY.
  9280*        MOVE '0'                TO PI-EDIT-SW
  9281*        IF PI-DISPLAY-ORIGINAL-BATCH
  9282*           NEXT SENTENCE
  9283*        ELSE
  9284*           MOVE EL631C              TO PI-MAP-NAME
  9285*           MOVE LOW-VALUES          TO EL631CI
  9286*           MOVE 'A'                 TO CMAINTO
  9287*           MOVE AL-UANON            TO CMAINTA
  9288*           MOVE -1                  TO CMAINTL
  9289*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9290*           GO TO 8100-SEND-INITIAL-MAP.
  9291
  9292     IF EIBAID = DFHPF7
  9293        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9294        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9295        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9296        MOVE PI-SV-STATE            TO PI-STATE
  9297        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9298        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 170
* EL6311.cbl
  9299        MOVE CSUFIXI                TO PI-CERT-SFX
  9300        MOVE CEFFDTI                TO DEEDIT-FIELD
  9301        PERFORM 8600-DEEDIT
  9302        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9303        MOVE '4'                    TO DC-OPTION-CODE
  9304        PERFORM 9700-DATE-LINK
  9305        IF DATE-CONVERSION-ERROR
  9306           MOVE ER-0348            TO EMI-ERROR
  9307           MOVE -1                  TO BEFFDTL
  9308           MOVE AL-UABON            TO BEFFDTA
  9309           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9310           GO TO 8200-SEND-DATAONLY
  9311        ELSE
  9312           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9313           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9314           MOVE XCTL-EL1273        TO PGM-NAME
  9315           GO TO 9300-XCTL.
  9316
  9317     IF EIBAID = DFHPF8
  9318        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9319        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9320        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9321        MOVE PI-SV-STATE            TO PI-STATE
  9322        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9323        MOVE CCERTNOI               TO PI-CERT-PRIME
  9324        MOVE CSUFIXI                TO PI-CERT-SFX
  9325        MOVE CEFFDTI                TO DEEDIT-FIELD
  9326        PERFORM 8600-DEEDIT
  9327        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9328        MOVE '4'                    TO DC-OPTION-CODE
  9329        PERFORM 9700-DATE-LINK
  9330        IF DATE-CONVERSION-ERROR
  9331           MOVE ER-0348             TO EMI-ERROR
  9332           MOVE -1                  TO BEFFDTL
  9333           MOVE AL-UABON            TO BEFFDTA
  9334           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9335           GO TO 8200-SEND-DATAONLY
  9336        ELSE
  9337           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9338           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9339           IF PI-COMPANY-ID = 'DMD'
  9340               MOVE XCTL-EL401DMD      TO PGM-NAME
  9341             ELSE
  9342               MOVE XCTL-EL1279        TO PGM-NAME
  9343           END-IF
  9344           GO TO 9300-XCTL.
  9345
  9346     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9347        MOVE XCTL-EL6312     TO PGM-NAME
  9348
  9349* EXEC CICS XCTL
  9350*           PROGRAM  (PGM-NAME)
  9351*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9352*           LENGTH   (WS-COMM-LENGTH)
  9353*       END-EXEC
  9354*    MOVE '.$C                   %   #00009278' TO DFHEIV0
  9355     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9356     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 171
* EL6311.cbl
  9357     MOVE X'2020233030303039323738' TO DFHEIV0(25:11)
  9358     CALL 'kxdfhei1' USING DFHEIV0,
  9359           PGM-NAME,
  9360           PROGRAM-INTERFACE-BLOCK,
  9361           WS-COMM-LENGTH,
  9362           DFHEIV99
  9363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9364     ELSE
  9365        MOVE '0'                 TO  PI-EDIT-SW.
  9366
  9367     IF EIBAID = DFHPF10
  9368         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9369         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9370         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9371         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9372                                    PI-1042-WA
  9373         MOVE 4                  TO PI-689-DATA-SOURCE
  9374         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9375         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9376         MOVE PI-SV-STATE        TO PI-689-STATE
  9377         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9378         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9379         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9380         MOVE PI-PB-ALT-CHG-SEQ-NO
  9381                                 TO PI-689-ALT-SEQ-NO
  9382         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9383         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9384         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9385         MOVE +0                 TO PI-689-CONTROL
  9386         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9387                                    PI-689-EXP-DATE
  9388                                    PI-689-RESP-PERSON
  9389                                    PI-689-TYPE
  9390                                    PI-689-FOLLOW-UP-EDIT
  9391                                    PI-689-RESEND1-EDIT
  9392                                    PI-689-SEQ-EDIT
  9393                                    PI-689-BCSEQ-EDIT
  9394                                    PI-689-LBL-OVERRIDE
  9395         MOVE W-LETTER-COMMUNICATION-AREAS
  9396                                 TO PI-PROGRAM-WORK-AREA
  9397         MOVE XCTL-EL689         TO PGM-NAME
  9398         GO TO 9300-XCTL.
  9399
  9400     IF  EIBAID = DFHPF16
  9401         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9402         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9403         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9404                                    PI-1042-WA
  9405         MOVE 4                  TO PI-689-DATA-SOURCE
  9406         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9407         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9408         MOVE PI-SV-STATE        TO PI-689-STATE
  9409         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9410         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9411         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9412         MOVE PI-PB-ALT-CHG-SEQ-NO
  9413                                 TO PI-689-ALT-SEQ-NO
  9414         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 172
* EL6311.cbl
  9415         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9416         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9417         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9418         MOVE W-LETTER-COMMUNICATION-AREAS
  9419                                 TO PI-PROGRAM-WORK-AREA
  9420         MOVE XCTL-EL690         TO PGM-NAME
  9421         GO TO 9300-XCTL.
  9422     IF (EIBAID = DFHPF13)
  9423        if (not fatal-errors)
  9424           and (not unforced-errors)
  9425           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9426           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9427           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9428           MOVE PI-SV-STATE      TO PI-STATE
  9429           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9430           MOVE CCERTNOI         TO PI-CERT-PRIME
  9431           MOVE CSUFIXI          TO PI-CERT-SFX
  9432           MOVE CEFFDTI          TO DEEDIT-FIELD
  9433           PERFORM 8600-DEEDIT
  9434           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9435           MOVE '4'              TO DC-OPTION-CODE
  9436           PERFORM 9700-DATE-LINK
  9437           IF DATE-CONVERSION-ERROR
  9438              MOVE ER-0348       TO EMI-ERROR
  9439              MOVE -1            TO CEFFDTL
  9440              MOVE AL-UABON      TO CEFFDTA
  9441              PERFORM 9900-ERROR-FORMAT
  9442                                 THRU 9900-EXIT
  9443              GO TO 8200-SEND-DATAONLY
  9444           ELSE
  9445              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9446              MOVE AL-UANON      TO CEFFDTA
  9447              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9448              PERFORM 6000-CREATE-TEMP-STORAGE
  9449                                 THRU 6000-EXIT
  9450              MOVE XCTL-EL677    TO PGM-NAME
  9451              GO TO 9300-XCTL
  9452           end-if
  9453        else
  9454           MOVE ER-3444          TO EMI-ERROR
  9455           MOVE -1               TO CPFENTRL
  9456           MOVE AL-UNBON         TO CPFENTRA
  9457           PERFORM 9900-ERROR-FORMAT
  9458                                 THRU 9900-EXIT
  9459           GO TO 8200-SEND-DATAONLY
  9460        end-if
  9461     end-if
  9462
  9463     IF EIBAID = DFHPF14
  9464        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9465        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9466        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9467        MOVE PI-SV-STATE            TO PI-CR-STATE
  9468        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9469        MOVE SPACE                  TO PI-EDIT-SW
  9470        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9471        MOVE XCTL-EL650             TO PGM-NAME
  9472        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 173
* EL6311.cbl
  9473
  9474     IF EIBAID = DFHENTER OR DFHPF11
  9475        GO TO 2000-CANCEL-MAINLINE.
  9476
  9477     MOVE ER-0029                TO EMI-ERROR.
  9478     MOVE -1                     TO CPFENTRL.
  9479     MOVE AL-UNBON               TO CPFENTRA.
  9480     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9481     GO TO 8200-SEND-DATAONLY.
  9482
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 174
* EL6311.cbl
  9484
  9485******************************************************************
  9486*                                                                *
  9487*      BATCH SCREEN PF KEY CHECKING                              *
  9488*                                                                *
  9489******************************************************************
  9490
  9491******************************************************************
  9492*                                                                *
  9493*      PF KEY FUNCTIONS:                                         *
  9494*                                                                *
  9495*      PF1 = BROWSE FORWARD                                      *
  9496*      PF2 = BROWSE BACKWARD                                     *
  9497*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9498*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9499*                                                                *
  9500*                                                                *
  9501******************************************************************
  9502
  9503 0500-CHECK-BATCH-PF-KEYS.
  9504     IF EIBAID = DFHPF1
  9505        MOVE '0'                TO PI-EDIT-SW
  9506        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9507           GO TO 5000-BROWSE-BATCH-HEADERS
  9508        ELSE
  9509           IF PI-GOOD-BROWSE
  9510              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9511                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9512              ELSE
  9513                 IF PI-FILE-BROWSE
  9514                    GO TO 4300-BROWSE-FILE-FORWARD
  9515                 ELSE
  9516                    IF PI-CSR-BROWSE
  9517                       GO TO 4200-BROWSE-CSR-FORWARD
  9518                    ELSE
  9519                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9520           ELSE
  9521              GO TO 0800-BROWSE-ERROR.
  9522
  9523     IF EIBAID = DFHPF2
  9524        MOVE '0'                TO PI-EDIT-SW
  9525        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9526           GO TO 5500-BROWSE-BATCH-BACKWARD
  9527        ELSE
  9528           IF PI-GOOD-BROWSE
  9529              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9530                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9531              ELSE
  9532                 IF PI-FILE-BROWSE
  9533                    GO TO 4800-BROWSE-FILE-BACKWARD
  9534                 ELSE
  9535                    IF PI-CSR-BROWSE
  9536                       GO TO 4900-BROWSE-CSR-BACKWARD
  9537                    ELSE
  9538                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9539           ELSE
  9540              GO TO 0800-BROWSE-ERROR.
  9541
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 175
* EL6311.cbl
  9542     IF EIBAID = DFHPF3
  9543        GO TO 3000-BATCH-MAINLINE.
  9544
  9545     IF  EIBAID = DFHPF4
  9546        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9547        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9548        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9549        MOVE PI-SV-STATE            TO PI-CR-STATE
  9550        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9551                                       PI-CR-FIN-RESP
  9552        MOVE 'A'                    TO PI-CR-TYPE
  9553        MOVE SPACE                  TO PI-EDIT-SW
  9554        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9555        MOVE XCTL-EL640             TO PGM-NAME
  9556        GO TO 9300-XCTL.
  9557
  9558     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9559       AND
  9560        (EIBAID = DFHENTER)
  9561           GO TO 3500-EDIT-BATCH-DATA.
  9562
  9563     IF EIBAID = DFHENTER
  9564        GO TO 3500-EDIT-BATCH-DATA.
  9565
  9566     MOVE ER-0029             TO EMI-ERROR.
  9567     MOVE -1                  TO DPFENTRL.
  9568     MOVE AL-UNBON            TO DPFENTRA.
  9569     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9570     GO TO 8200-SEND-DATAONLY.
  9571
  9572 0800-BROWSE-ERROR.
  9573     MOVE ER-2258                TO EMI-ERROR.
  9574     MOVE -1                     TO DPFENTRL.
  9575     MOVE AL-UNBON               TO DPFENTRA.
  9576     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9577     GO TO 8200-SEND-DATAONLY.
  9578
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 176
* EL6311.cbl
  9580
  9581******************************************************************
  9582*                                                                *
  9583*                I S S U E   M A I N L I N E                     *
  9584*                                                                *
  9585******************************************************************
  9586
  9587 1000-ISSUE-MAINLINE.
  9588     IF PI-DISPLAY-ORIGINAL-BATCH
  9589        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9590           MOVE ER-0023             TO EMI-ERROR
  9591           MOVE -1                  TO BMAINTL
  9592           MOVE AL-UABON            TO BMAINTA
  9593           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9594           GO TO 8200-SEND-DATAONLY
  9595        ELSE
  9596           NEXT SENTENCE
  9597     ELSE
  9598        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9599           MOVE ER-0023             TO EMI-ERROR
  9600           MOVE -1                  TO BMAINTL
  9601           MOVE AL-UABON            TO BMAINTA
  9602           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9603           GO TO 8200-SEND-DATAONLY.
  9604
  9605     IF BMAINTI = 'S'
  9606        GO TO 1100-SHOW-REQUEST.
  9607
  9608     IF NOT MODIFY-CAP
  9609         MOVE 'UPDATE'       TO SM-READ
  9610         PERFORM 9995-SECURITY-VIOLATION
  9611         MOVE ER-0070        TO EMI-ERROR
  9612         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9613         GO TO 8100-SEND-INITIAL-MAP.
  9614
  9615     IF BMAINTL GREATER THAN ZEROS
  9616        IF PI-PF5-FUNCTION
  9617           IF BMAINTI NOT = 'A'
  9618              MOVE AL-UABON  TO BMAINTA
  9619              MOVE -1        TO BMAINTL
  9620              MOVE ER-2260   TO EMI-ERROR
  9621              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9622              GO TO 8200-SEND-DATAONLY.
  9623
  9624     IF BCERTNOL = ZEROS
  9625       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9626         NEXT SENTENCE
  9627     ELSE
  9628         IF BCERTNOL NOT = ZEROS
  9629             MOVE AL-UANON       TO BCERTNOA
  9630         ELSE
  9631             MOVE -1             TO BCERTNOL
  9632             MOVE  1             TO SET-CURSOR-SW
  9633             MOVE ER-2218        TO EMI-ERROR
  9634             MOVE AL-UABON       TO BCERTNOA
  9635             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9636
  9637     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 177
* EL6311.cbl
  9638         MOVE AL-UANON       TO BSUFIXA
  9639     ELSE
  9640         MOVE AL-SANOF       TO BSUFIXA.
  9641
  9642
  9643* EXEC CICS READ
  9644*        DATASET (FILE-ID-ERPNDB)
  9645*        INTO    (PENDING-BUSINESS)
  9646*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
  9647*    END-EXEC.
  9648     MOVE LENGTH OF
  9649      PENDING-BUSINESS
  9650       TO DFHEIV11
  9651*    MOVE '&"IL       E          (   #00009561' TO DFHEIV0
  9652     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9653     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9654     MOVE X'2020233030303039353631' TO DFHEIV0(25:11)
  9655     CALL 'kxdfhei1' USING DFHEIV0,
  9656           FILE-ID-ERPNDB,
  9657           PENDING-BUSINESS,
  9658           DFHEIV11,
  9659           PI-PREV-CONTROL-PRIMARY,
  9660           DFHEIV99,
  9661           DFHEIV99,
  9662           DFHEIV99
  9663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9664
  9665
  9666     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9667        NEXT SENTENCE
  9668     ELSE
  9669        IF BEFFDTL NOT = ZEROS
  9670           MOVE AL-UNNON             TO BEFFDTA
  9671           MOVE BEFFDTI              TO DEEDIT-FIELD
  9672           PERFORM 8600-DEEDIT
  9673           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9674           MOVE 4                    TO DC-OPTION-CODE
  9675           PERFORM 9700-DATE-LINK
  9676           IF NO-CONVERSION-ERROR
  9677              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9678              ELSE
  9679              MOVE -1                TO BEFFDTL
  9680              MOVE  1                TO SET-CURSOR-SW
  9681              MOVE ER-2226           TO EMI-ERROR
  9682              MOVE AL-UNBON          TO BEFFDTA
  9683              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9684           ELSE
  9685              MOVE -1                TO BEFFDTL
  9686              MOVE  1                TO SET-CURSOR-SW
  9687              MOVE ER-2220           TO EMI-ERROR
  9688              MOVE AL-UNBON          TO BEFFDTA
  9689              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9690
  9691     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9692
  9693     IF BCERTNOL NOT = ZEROS
  9694        MOVE BCERTNOI                TO WS-NEW-PRIME
  9695     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 178
* EL6311.cbl
  9696        MOVE SPACES                  TO WS-NEW-PRIME.
  9697
  9698     IF BSUFIXL NOT = ZEROS
  9699        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9700     ELSE
  9701        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9702
  9703     IF BEFFDTL NOT = ZEROS
  9704        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9705     ELSE
  9706        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9707
  9708     IF BMAINTI = 'A' OR 'K' OR 'S'
  9709        NEXT SENTENCE
  9710     ELSE
  9711        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9712        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9713           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9714           WS-PB-RECORD-TYPE NOT = '1'
  9715           IF BMAINTI = 'C'
  9716               MOVE ER-2287          TO EMI-ERROR
  9717               MOVE -1               TO BCERTNOL
  9718               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9719               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9720               GO TO 8200-SEND-DATAONLY
  9721             ELSE
  9722               MOVE ER-2260          TO EMI-ERROR
  9723               MOVE -1               TO BCERTNOL
  9724               MOVE AL-UABON         TO BCERTNOA
  9725               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9726               GO TO 8200-SEND-DATAONLY.
  9727
  9728     IF BMAINTI = 'D'
  9729         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9730
  9731*    IF BMICRNOL  NOT =  ZEROS
  9732*        IF BMICRNOI  NUMERIC
  9733*            MOVE AL-UNNON       TO  BMICRNOA
  9734*        ELSE
  9735*            MOVE -1             TO  BMICRNOL
  9736*            MOVE 1              TO  SET-CURSOR-SW
  9737*            MOVE AL-UNBON       TO  BMICRNOA
  9738*            MOVE ER-2701        TO  EMI-ERROR
  9739*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9740     IF BVINL NOT = ZEROS
  9741        MOVE AL-UANON            TO BVINA
  9742     END-IF
  9743
  9744     IF LETRREQL   GREATER THAN ZEROS
  9745        IF LETRREQI = 'Y'
  9746          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9747           CONTINUE
  9748        ELSE
  9749        IF LETRREQI = 'N'
  9750          AND (PB-I-LETTER-REQD = 'Y' OR 'N')
  9751           CONTINUE
  9752        ELSE
  9753           MOVE -1               TO LETRREQL
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 179
* EL6311.cbl
  9754           MOVE ER-1585          TO EMI-ERROR
  9755           MOVE AL-UABON         TO LETRREQA
  9756           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9757        END-IF
  9758     END-IF.
  9759     IF B1STNML NOT = ZEROS
  9760         MOVE AL-UANON                TO B1STNMA.
  9761
  9762     IF BINITL  NOT = ZEROS
  9763        MOVE AL-UANON                TO BINITA.
  9764
  9765     IF BSEXL NOT = ZEROS
  9766        IF BSEXI = 'M' OR 'F'
  9767           MOVE AL-UANON             TO BSEXA
  9768        ELSE
  9769           MOVE -1               TO BSEXL
  9770           MOVE ER-2629          TO EMI-ERROR
  9771           MOVE AL-UABON         TO BSEXA
  9772           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9773
  9774     IF BAGEL NOT = ZEROS
  9775         IF BAGEI NUMERIC
  9776             MOVE BAGEI              TO WS-BAGE
  9777             MOVE AL-UNNON           TO BAGEA
  9778         ELSE
  9779             MOVE -1                 TO BAGEL
  9780             MOVE  1                 TO SET-CURSOR-SW
  9781             MOVE ER-2223            TO EMI-ERROR
  9782             MOVE AL-UNBON           TO BAGEA
  9783             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9784
  9785     IF BLSTNML NOT = ZERO  OR
  9786        B1STNML NOT = ZERO  OR
  9787        BINITL NOT = ZERO
  9788         IF BAGEL = ZEROS
  9789             MOVE -1                 TO BAGEL
  9790             MOVE  1                 TO SET-CURSOR-SW
  9791             MOVE ER-3269            TO EMI-ERROR
  9792             MOVE AL-UNBON           TO BAGEA
  9793             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9794         END-IF
  9795     END-IF.
  9796
  9797     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9798
  9799     IF (BBIRTHL GREATER THAN +0) AND
  9800        (BBIRTHI NOT EQUAL SPACES)
  9801        NEXT SENTENCE
  9802     ELSE
  9803        GO TO 1010-CHECK-AGE.
  9804
  9805     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9806     PERFORM 8600-DEEDIT.
  9807     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9808     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9809     MOVE AL-UNNON               TO BBIRTHA.
  9810     MOVE '4'                    TO DC-OPTION-CODE.
  9811     PERFORM 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 180
* EL6311.cbl
  9812     IF DATE-CONVERSION-ERROR
  9813        MOVE -1                  TO BBIRTHL
  9814        MOVE  1                  TO SET-CURSOR-SW
  9815        MOVE ER-2228             TO EMI-ERROR
  9816        MOVE AL-UNBON            TO BBIRTHA
  9817        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9818        GO TO 1010-CHECK-AGE.
  9819
  9820     IF (NO-CONVERSION-ERROR) AND
  9821        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9822        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9823        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9824        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9825                                    WS-CONVERTED-BIRTH
  9826        MOVE AL-UANON            TO BBIRTHA
  9827     ELSE
  9828        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9829        MOVE AL-UANON            TO BBIRTHA.
  9830
  9831 1010-CHECK-AGE.
  9832
  9833*    IF BAGEL = ZERO
  9834*       IF BBIRTHL GREATER THAN ZERO
  9835*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9836
  9837     IF B1STPMTL NOT = ZEROS
  9838        IF B1STPMTI = SPACES
  9839           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9840        ELSE
  9841           MOVE B1STPMTI             TO DEEDIT-FIELD
  9842           PERFORM 8600-DEEDIT
  9843           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9844           MOVE AL-UNNON             TO B1STPMTA
  9845           MOVE 4                    TO DC-OPTION-CODE
  9846           PERFORM 9700-DATE-LINK
  9847           IF NO-CONVERSION-ERROR
  9848              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9849              MOVE AL-UANON          TO B1STPMTA
  9850           ELSE
  9851              MOVE -1                TO B1STPMTL
  9852              MOVE  1                TO SET-CURSOR-SW
  9853              MOVE ER-2200           TO EMI-ERROR
  9854              MOVE AL-UNBON          TO B1STPMTA
  9855              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9856
  9857     IF BDAYSL NOT = ZEROS
  9858         IF BDAYSI NUMERIC
  9859             MOVE AL-UNNON           TO BDAYSA
  9860         ELSE
  9861             MOVE -1                 TO BDAYSL
  9862             MOVE ER-2530            TO EMI-ERROR
  9863             MOVE AL-UNBON           TO BDAYSA
  9864             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9865
  9866     IF BLNTRML NOT = ZEROS
  9867         IF BLNTRMI NUMERIC
  9868             MOVE AL-UNNON       TO BLNTRMA
  9869         ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 181
* EL6311.cbl
  9870             MOVE -1             TO BLNTRML
  9871             MOVE ER-2533        TO EMI-ERROR
  9872             MOVE AL-UNBON       TO BLNTRMA
  9873             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9874
  9875**   IF PI-COMPANY-ID = 'DMD'
  9876     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9877        NEXT SENTENCE
  9878     ELSE
  9879         IF BLNOFCRL NOT = ZEROS
  9880            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9881            IF LOAN-OFFICER-FOUND
  9882                MOVE AL-UANON        TO BLNOFCRA
  9883             ELSE
  9884                 MOVE SPACE          TO WS-LOAN-OFFICER
  9885                 MOVE -1             TO BLNOFCRL
  9886                 MOVE  1             TO SET-CURSOR-SW
  9887                 MOVE ER-3006        TO EMI-ERROR
  9888                 MOVE AL-UNBON       TO BLNOFCRA
  9889                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9890
  9891     IF BFREQL NOT = ZEROS
  9892         IF BFREQI NUMERIC
  9893             MOVE AL-UNNON       TO BFREQA
  9894         ELSE
  9895             MOVE -1             TO BFREQL
  9896             MOVE  1             TO SET-CURSOR-SW
  9897             MOVE ER-2223        TO EMI-ERROR
  9898             MOVE AL-UNBON       TO BFREQA
  9899             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9900
  9901     IF BMODEL NOT = ZEROS
  9902         MOVE BMODEI             TO WS-MODE-CODE
  9903                                    PI-BMODE
  9904         IF WS-MODE-CODE-VALID
  9905             MOVE AL-UANON       TO BMODEA
  9906         ELSE
  9907             MOVE -1             TO BMODEL
  9908             MOVE ER-2591        TO EMI-ERROR
  9909             MOVE AL-UABON       TO BMODEA
  9910             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9911
  9912     IF BPMTSL NOT = ZEROS
  9913         IF BPMTSI NUMERIC
  9914             MOVE AL-UNNON           TO BPMTSA
  9915             MOVE BPMTSI             TO PI-BPMTS
  9916         ELSE
  9917             MOVE -1                 TO BPMTSL
  9918             MOVE ER-2592            TO EMI-ERROR
  9919             MOVE AL-UNBON           TO BPMTSA
  9920             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9921
  9922     IF BPMTAMTL NOT = ZEROS
  9923
  9924* EXEC CICS BIF DEEDIT
  9925*            FIELD  (BPMTAMTI)
  9926*            LENGTH (9)
  9927*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 182
* EL6311.cbl
  9928     MOVE 9
  9929       TO DFHEIV11
  9930*    MOVE '@"L                   #   #00009824' TO DFHEIV0
  9931     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9932     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9933     MOVE X'2020233030303039383234' TO DFHEIV0(25:11)
  9934     CALL 'kxdfhei1' USING DFHEIV0,
  9935           BPMTAMTI,
  9936           DFHEIV11
  9937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9938        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9939*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9940*        PERFORM 8600-DEEDIT
  9941*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9942
  9943*    IF BAPRL NOT = ZEROS
  9944*        EXEC CICS BIF DEEDIT
  9945*            FIELD  (BAPRI)
  9946*            LENGTH (7)
  9947*        END-EXEC
  9948*        MOVE BAPRI              TO WS-BAPR.
  9949
  9950     IF BAPRL > 0
  9951        MOVE +0                  TO  WS-BAPR
  9952        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9953           (WS-SUB > 7)
  9954           OR (BAPRI (WS-SUB:1) NUMERIC)
  9955           OR (BAPRI (WS-SUB:1) = '.')
  9956        END-PERFORM
  9957        IF WS-SUB > 7
  9958           MOVE ER-2471       TO EMI-ERROR
  9959           MOVE -1            TO BAPRL
  9960           MOVE AL-UNBON      TO BAPRA
  9961           PERFORM 9900-ERROR-FORMAT
  9962                                 THRU 9900-EXIT
  9963        ELSE
  9964           IF BAPRI (WS-SUB:1) NUMERIC
  9965              MOVE WS-SUB           TO WS-BEG
  9966              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9967                 (WS-SUB > 7)
  9968                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9969              END-PERFORM
  9970              COMPUTE WS-END = WS-SUB - WS-BEG
  9971              MOVE BAPRI (WS-BEG:WS-END)
  9972                                 TO WS-APR-WHOLE-NUM
  9973           END-IF
  9974           IF BAPRI (WS-SUB:1) = '.'
  9975              COMPUTE WS-BEG = WS-SUB + 1
  9976              IF (WS-BEG < 8)
  9977                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9978                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9979                    (WS-SUB > 7)
  9980                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9981                 END-PERFORM
  9982                 COMPUTE WS-END = WS-SUB - WS-BEG
  9983                 MOVE BAPRI (WS-BEG:WS-END)
  9984                                 TO WS-APR-DEC (1:WS-END)
  9985              END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 183
* EL6311.cbl
  9986           END-IF
  9987           MOVE AL-UNNON      TO BAPRA
  9988           MOVE WS-BAPR       TO BAPRO
  9989        END-IF
  9990     END-IF
  9991*     IF BAPRL NOT = ZEROS
  9992*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9993*        PERFORM 8600-DEEDIT
  9994*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9995
  9996     IF BLIVESL NOT = ZEROS
  9997        MOVE BLIVESI             TO DEEDIT-FIELD
  9998        PERFORM 8600-DEEDIT
  9999        IF DEEDIT-FIELD-V0 NUMERIC
 10000           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
 10001           MOVE AL-UNNON         TO BLIVESA
 10002        ELSE
 10003           MOVE -1               TO BLIVESL
 10004           MOVE AL-UNBON         TO BLIVESA
 10005           MOVE ER-2223          TO EMI-ERROR
 10006           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10007
 10008*DMD CUSTOM CODING*************START
 10009*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
 10010     IF PI-COMPANY-ID NOT = 'DMD'
 10011         MOVE ZEROS               TO BBILLEDL
 10012         GO TO 1010-EDIT-CONT.
 10013
 10014     IF BBILLEDL NOT = ZEROS
 10015        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
 10016        MOVE 'Y'                 TO WS-NUMERIC-SW
 10017        MOVE +1                  TO WS-CSO-SUB
 10018        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
 10019        IF CSO-NUMERIC-FIELD
 10020
 10021* EXEC CICS BIF DEEDIT
 10022*              FIELD  (BBILLEDI)
 10023*              LENGTH (9)
 10024*          END-EXEC
 10025     MOVE 9
 10026       TO DFHEIV11
 10027*    MOVE '@"L                   #   #00009910' TO DFHEIV0
 10028     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10029     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10030     MOVE X'2020233030303039393130' TO DFHEIV0(25:11)
 10031     CALL 'kxdfhei1' USING DFHEIV0,
 10032           BBILLEDI,
 10033           DFHEIV11
 10034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10035           MOVE BBILLEDI         TO WS-BILLED
 10036           MOVE AL-UNNON         TO BBILLEDA
 10037        ELSE
 10038           MOVE -1               TO BBILLEDL
 10039           MOVE AL-UNBON         TO BBILLEDA
 10040           MOVE ER-2547          TO EMI-ERROR
 10041           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10042     ELSE
 10043        IF BMAINTI EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 184
* EL6311.cbl
 10044           MOVE -1               TO BBILLEDL
 10045           MOVE AL-UNBON         TO BBILLEDA
 10046           MOVE ER-8148          TO EMI-ERROR
 10047           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10048
 10049 1010-EDIT-CONT.
 10050
 10051     IF BFORCEL  NOT = ZEROS
 10052         IF FORCE-CAP
 10053            MOVE AL-UANON            TO BFORCEA
 10054         ELSE
 10055            MOVE ER-2945             TO EMI-ERROR
 10056            MOVE AL-UABON            TO BFORCEA
 10057            MOVE -1                  TO BFORCEL
 10058            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10059
 10060     if (bforcel not = zeros)
 10061        and (bforcei = 'L')
 10062        and (not csr-edit-session)
 10063        and (emi-error <> er-2945)
 10064        MOVE ER-2670             TO EMI-ERROR
 10065        MOVE AL-UABON            TO BFORCEA
 10066        MOVE -1                  TO BFORCEL
 10067        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10068     end-if
 10069     IF BENTRYL NOT = ZEROS
 10070        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
 10071                 'C' and 'D' AND 'V' AND 'U' AND 'M'
 10072           MOVE ER-2224              TO EMI-ERROR
 10073           MOVE AL-UABON             TO BENTRYA
 10074           MOVE -1                   TO BENTRYL
 10075           MOVE  1                   TO SET-CURSOR-SW
 10076           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10077        ELSE
 10078           MOVE AL-UANON             TO BENTRYA.
 10079
 10080     IF BUNWRITL NOT = ZEROS
 10081        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
 10082           MOVE ER-7574              TO EMI-ERROR
 10083           MOVE AL-UABON             TO BUNWRITA
 10084           MOVE -1                   TO BUNWRITL
 10085           MOVE  1                   TO SET-CURSOR-SW
 10086           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10087        ELSE
 10088           MOVE AL-UANON             TO BUNWRITA.
 10089
 10090     IF BREINL  NOT = ZEROS
 10091         MOVE AL-UANON               TO BREINA.
 10092
 10093     IF BBILCDL NOT = ZEROS
 10094        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 10095                             AND 'A' AND 'B' AND 'E'
 10096           MOVE ER-2225              TO EMI-ERROR
 10097           MOVE AL-UABON             TO BBILCDA
 10098           MOVE -1                   TO BBILCDL
 10099           MOVE  1                   TO SET-CURSOR-SW
 10100           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10101        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 185
* EL6311.cbl
 10102           MOVE AL-UANON             TO BBILCDA.
 10103
 10104     IF BSKPCDL NOT = ZEROS
 10105         MOVE AL-UANON               TO BSKPCDA.
 10106
 10107     IF BINDGRPL NOT = ZEROS
 10108         MOVE AL-UANON               TO BINDGRPA.
 10109
 10110     IF BSIGL   NOT = ZEROS
 10111         MOVE AL-UANON               TO BSIGA.
 10112
 10113     IF BRTCLSL NOT = ZEROS
 10114         MOVE AL-UANON               TO BRTCLSA.
 10115
 10116     IF BMEMBERL NOT = ZEROS
 10117         MOVE AL-UANON               TO BMEMBERA.
 10118
 10119     MOVE +0                         TO WS-SUB1.
 10120
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 186
* EL6311.cbl
 10122
 10123******************************************************************
 10124*                                                                *
 10125*           E D I T   I S S U E   C O V E R A G E S              *
 10126*                                                                *
 10127******************************************************************
 10128
 10129 1020-EDIT-COVERAGES.
 10130     ADD +1                      TO WS-SUB1.
 10131
 10132     IF WS-SUB1 GREATER +2
 10133        GO TO 1025-EDIT-CONTINUE
 10134     END-IF
 10135
 10136     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10137       IF (BMODEL   GREATER ZERO  OR
 10138            BPMTSL   GREATER ZERO  OR
 10139            BPMTAMTL GREATER ZERO)
 10140          AND
 10141            BTYPE-LEN (WS-SUB1) GREATER THAN +0
 10142               GO TO 1021-CONT-EDIT.
 10143
 10144     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10145        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10146        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
 10147        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
 10148        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
 10149        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
 10150        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
 10151        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
 10152        NEXT SENTENCE
 10153         ELSE
 10154            GO TO 1020-EDIT-COVERAGES.
 10155
 10156 1021-CONT-EDIT.
 10157
 10158     IF BMAINTI = 'A'
 10159        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10160           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
 10161        ELSE
 10162           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
 10163           MOVE ER-7404          TO EMI-ERROR
 10164           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
 10165           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10166     ELSE
 10167        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
 10168           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
 10169
 10170     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
 10171        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
 10172        PERFORM 8600-DEEDIT
 10173        IF DEEDIT-FIELD-V0 NUMERIC
 10174           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
 10175        ELSE
 10176           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
 10177
 10178     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10179*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 187
* EL6311.cbl
 10180        IF BMODEL  GREATER THAN ZEROS  AND
 10181           BPMTSL  GREATER THAN ZEROS
 10182           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10183
 10184     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10185         IF BMODEL   GREATER THAN ZEROS  OR
 10186            BPMTSL   GREATER THAN ZEROS  OR
 10187            BPMTAMTL GREATER THAN ZEROS
 10188             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10189
 10190     IF BMAINTI = ('C' OR 'K')
 10191        IF BTERM-LEN (WS-SUB1)  = ZEROS
 10192           NEXT SENTENCE
 10193        ELSE
 10194           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10195           PERFORM 8600-DEEDIT
 10196           IF DEEDIT-FIELD-V0 NUMERIC
 10197              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
 10198              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
 10199                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
 10200              ELSE
 10201                    MOVE ER-2241      TO EMI-ERROR
 10202                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
 10203                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
 10204                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10205           ELSE
 10206              MOVE ER-2223          TO EMI-ERROR
 10207              MOVE -1               TO BTERM-LEN     (WS-SUB1)
 10208              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
 10209              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10210     ELSE
 10211        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
 10212            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10213            PERFORM 8600-DEEDIT
 10214            IF DEEDIT-FIELD-V0      NUMERIC
 10215               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
 10216                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
 10217                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
 10218               ELSE
 10219                  MOVE ER-2241         TO EMI-ERROR
 10220                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
 10221                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
 10222                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10223            ELSE
 10224              MOVE ER-2223             TO EMI-ERROR
 10225              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
 10226              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
 10227              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10228        ELSE
 10229            MOVE ER-2240               TO EMI-ERROR
 10230            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
 10231            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10232*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10233*        IF BMODEL  GREATER THAN ZEROS  AND
 10234*           BPMTSL  GREATER THAN ZEROS
 10235*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10236
 10237     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 188
* EL6311.cbl
 10238        AND BMAINTI = ('C' OR 'K')
 10239           NEXT SENTENCE
 10240     ELSE
 10241        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10242           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10243
 10244* EXEC CICS BIF DEEDIT
 10245*              FIELD  (BBENI (WS-SUB1))
 10246*              LENGTH (12)
 10247*          END-EXEC
 10248     MOVE 12
 10249       TO DFHEIV11
 10250*    MOVE '@"L                   #   #00010122' TO DFHEIV0
 10251     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10252     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10253     MOVE X'2020233030303130313232' TO DFHEIV0(25:11)
 10254     CALL 'kxdfhei1' USING DFHEIV0,
 10255           BBENI(WS-SUB1),
 10256           DFHEIV11
 10257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10258           IF BBENI (WS-SUB1)  NUMERIC
 10259              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10260                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10261*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10262*          PERFORM 8600-DEEDIT
 10263*          IF DEEDIT-FIELD-V2  NUMERIC
 10264*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10265*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10266              ELSE
 10267                 MOVE ER-7632    TO EMI-ERROR
 10268                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10269                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10270                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10271           ELSE
 10272              MOVE ER-2223         TO EMI-ERROR
 10273              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10274              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10275              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10276        ELSE
 10277           MOVE ER-7632    TO EMI-ERROR
 10278           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10279           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10280           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10281
 10282     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10283        AND (BMAINTI = ('C' OR 'K'))
 10284        CONTINUE
 10285     ELSE
 10286        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10287           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10288           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10289              FOR ALL '.'
 10290           IF WS-TALLY > 1
 10291              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10292                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10293              END-PERFORM
 10294              IF A1 < 9
 10295                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 189
* EL6311.cbl
 10296                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10297              END-IF
 10298           ELSE
 10299              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10300                (A1 > 11)
 10301                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10302                  LOW-VALUES OR SPACES)
 10303              END-PERFORM
 10304              IF A1 > 1 AND < 12
 10305                 MOVE SPACES
 10306                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10307              END-IF
 10308           END-IF
 10309
 10310* EXEC CICS BIF DEEDIT
 10311*              FIELD  (BPREMI (WS-SUB1))
 10312*              LENGTH (11)
 10313*          END-EXEC
 10314     MOVE 11
 10315       TO DFHEIV11
 10316*    MOVE '@"L                   #   #00010177' TO DFHEIV0
 10317     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10318     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10319     MOVE X'2020233030303130313737' TO DFHEIV0(25:11)
 10320     CALL 'kxdfhei1' USING DFHEIV0,
 10321           BPREMI(WS-SUB1),
 10322           DFHEIV11
 10323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10324           IF BPREMI (WS-SUB1) NUMERIC
 10325              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10326                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10327*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10328*          PERFORM 8600-DEEDIT
 10329*          IF DEEDIT-FIELD-V2  NUMERIC
 10330*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10331*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10332              ELSE
 10333                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10334                    MOVE ER-7633    TO EMI-ERROR
 10335                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10336                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10337                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10338                 END-IF
 10339              END-IF
 10340           ELSE
 10341              MOVE ER-2223         TO EMI-ERROR
 10342              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10343              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10344              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10345           END-IF
 10346        ELSE
 10347           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10348              MOVE ER-7633         TO EMI-ERROR
 10349              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10350              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10351              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10352           END-IF
 10353        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 190
* EL6311.cbl
 10354     END-IF
 10355
 10356     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10357        NEXT SENTENCE
 10358     ELSE
 10359        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10360
 10361* EXEC CICS BIF DEEDIT
 10362*           FIELD  (BCPREMI (WS-SUB1))
 10363*           LENGTH (11)
 10364*       END-EXEC
 10365     MOVE 11
 10366       TO DFHEIV11
 10367*    MOVE '@"L                   #   #00010217' TO DFHEIV0
 10368     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10369     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10370     MOVE X'2020233030303130323137' TO DFHEIV0(25:11)
 10371     CALL 'kxdfhei1' USING DFHEIV0,
 10372           BCPREMI(WS-SUB1),
 10373           DFHEIV11
 10374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10375        IF BCPREMI (WS-SUB1) NUMERIC
 10376           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10377*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10378*       PERFORM 8600-DEEDIT
 10379*       IF DEEDIT-FIELD-V2  NUMERIC
 10380*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10381        ELSE
 10382           MOVE ER-2223         TO EMI-ERROR
 10383           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10384           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10385           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10386
 10387     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10388        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10389        PERFORM 8600-DEEDIT
 10390        IF DEEDIT-FIELD-V0 NUMERIC
 10391           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10392           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10393         ELSE
 10394           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10395           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10396           MOVE ER-2223              TO EMI-ERROR
 10397           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10398
 10399     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10400        IF BEXPIRE   (WS-SUB1) = SPACES
 10401           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10402        ELSE
 10403           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10404           PERFORM 8600-DEEDIT
 10405           IF DEEDIT-FIELD-V0        NUMERIC
 10406              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10407              MOVE 4                TO DC-OPTION-CODE
 10408              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10409              PERFORM 9700-DATE-LINK
 10410              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10411                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 191
* EL6311.cbl
 10412              IF NO-CONVERSION-ERROR
 10413                 NEXT SENTENCE
 10414              ELSE
 10415                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10416                 MOVE ER-2531    TO EMI-ERROR
 10417                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10418                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10419           ELSE
 10420             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10421             MOVE ER-2532        TO EMI-ERROR
 10422             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10423             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10424
 10425     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10426        NEXT SENTENCE
 10427     ELSE
 10428
 10429* EXEC CICS BIF DEEDIT
 10430*           FIELD  (BALT-BENI (WS-SUB1))
 10431*           LENGTH (12)
 10432*       END-EXEC
 10433     MOVE 12
 10434       TO DFHEIV11
 10435*    MOVE '@"L                   #   #00010274' TO DFHEIV0
 10436     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10437     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10438     MOVE X'2020233030303130323734' TO DFHEIV0(25:11)
 10439     CALL 'kxdfhei1' USING DFHEIV0,
 10440           BALT-BENI(WS-SUB1),
 10441           DFHEIV11
 10442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10443        IF BALT-BENI (WS-SUB1) NUMERIC
 10444           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10445*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10446*       PERFORM 8600-DEEDIT
 10447*       IF DEEDIT-FIELD-V0 NUMERIC
 10448*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10449        ELSE
 10450           MOVE ER-2223         TO EMI-ERROR
 10451           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10452           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10453           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10454
 10455     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10456        NEXT SENTENCE
 10457     ELSE
 10458
 10459* EXEC CICS BIF DEEDIT
 10460*           FIELD  (BALT-PREMI (WS-SUB1))
 10461*           LENGTH (11)
 10462*       END-EXEC
 10463     MOVE 11
 10464       TO DFHEIV11
 10465*    MOVE '@"L                   #   #00010293' TO DFHEIV0
 10466     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10467     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10468     MOVE X'2020233030303130323933' TO DFHEIV0(25:11)
 10469     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 192
* EL6311.cbl
 10470           BALT-PREMI(WS-SUB1),
 10471           DFHEIV11
 10472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10473        IF BALT-PREMI (WS-SUB1) NUMERIC
 10474           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10475*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10476*       PERFORM 8600-DEEDIT
 10477*       IF DEEDIT-FIELD-V0 NUMERIC
 10478*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10479        ELSE
 10480           MOVE ER-2223         TO EMI-ERROR
 10481           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10482           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10483           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10484
 10485      GO TO 1020-EDIT-COVERAGES.
 10486     .
 10487 1025-edit-continue.
 10488     IF PI-COMPANY-ID  =  'DMD'
 10489        MOVE LOW-VALUES             TO BNCERTI
 10490                                       BNSTATI.
 10491
 10492     IF EMI-ERROR = ZEROS
 10493         NEXT SENTENCE
 10494     ELSE
 10495         GO TO 8200-SEND-DATAONLY.
 10496
 10497     IF BMAINTI = 'A'
 10498         GO TO 1200-ADD-ISSUE-ROUTINE.
 10499
 10500     IF BMAINTI = 'C'
 10501         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10502
 10503     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10504
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 193
* EL6311.cbl
 10506
 10507 1030-EDIT-FOR-NUMERICS.
 10508     IF WS-CSO-SUB EQUAL 10
 10509        GO TO 1030-EDIT-EXIT.
 10510
 10511     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10512        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10513        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10514           ADD +1               TO WS-CSO-SUB
 10515           GO TO 1030-EDIT-FOR-NUMERICS.
 10516
 10517     MOVE 'N'                   TO WS-NUMERIC-SW.
 10518
 10519 1030-EDIT-EXIT.
 10520******************************************************************
 10521*                                                                *
 10522*                 C A L C U L A T E   A G E                      *
 10523*                                                                *
 10524******************************************************************
 10525
 10526
 10527 1095-CALC-AGE.
 10528
 10529     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10530     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10531     MOVE 1                  TO DC-OPTION-CODE.
 10532     PERFORM 9700-DATE-LINK
 10533     IF NO-CONVERSION-ERROR
 10534         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10535         MOVE WS-BAGE            TO BAGEI
 10536         MOVE +2                 TO BAGEL
 10537         MOVE AL-UNNON TO BAGEA.
 10538
 10539 1099-EXIT.
 10540     EXIT.
 10541
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 194
* EL6311.cbl
 10543
 10544******************************************************************
 10545*                                                                *
 10546*                   S H O W   I S S U E                          *
 10547*                                                                *
 10548******************************************************************
 10549
 10550 1100-SHOW-REQUEST.
 10551     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10552
 10553     IF BCERTNOL = ZEROS AND
 10554        BEFFDTL  = ZEROS
 10555        MOVE -1                  TO BMAINTL
 10556        GO TO 8200-SEND-DATAONLY.
 10557
 10558     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10559
 10560     IF BSUFIXL NOT = ZEROS
 10561        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10562     ELSE
 10563        MOVE SPACE               TO WS-NEW-SUFFIX.
 10564
 10565     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10566     PERFORM 8600-DEEDIT.
 10567     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10568     MOVE '4'                    TO DC-OPTION-CODE.
 10569     PERFORM 9700-DATE-LINK.
 10570     IF DATE-CONVERSION-ERROR
 10571        MOVE ER-0348             TO EMI-ERROR
 10572        MOVE -1                  TO BEFFDTL
 10573        MOVE AL-UABON            TO BEFFDTA
 10574        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10575        GO TO 8200-SEND-DATAONLY
 10576     ELSE
 10577        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10578        MOVE AL-UANON            TO BEFFDTA
 10579        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10580
 10581     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10582
 10583     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10584        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10585          MOVE 'Y'                    TO WS-SHOW-SW
 10586          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10587             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10588           ELSE
 10589             IF PI-FILE-BROWSE
 10590                GO TO 4300-BROWSE-FILE-FORWARD
 10591              ELSE
 10592                IF PI-CSR-BROWSE
 10593                   GO TO 4200-BROWSE-CSR-FORWARD
 10594                ELSE
 10595                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10596        ELSE
 10597           GO TO 3900-RE-DISPLAY-RECORD.
 10598
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 195
* EL6311.cbl
 10600
 10601******************************************************************
 10602*                                                                *
 10603*            A D D   I S S U E   R O U T I N E                   *
 10604*                                                                *
 10605******************************************************************
 10606
 10607***************************************************************
 10608*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10609*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10610*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10611*     4. LINK TO THE EDIT ROUTINE.                            *
 10612*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10613*     6. WRITE THE NEW ISSUE RECORD.                          *
 10614*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10615*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10616*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10617*        ELSE                                                 *
 10618*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10619***************************************************************
 10620
 10621 1200-ADD-ISSUE-ROUTINE.
 10622     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10623
 10624
 10625* EXEC CICS GETMAIN
 10626*        SET     (ADDRESS OF PENDING-BUSINESS)
 10627*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10628*    END-EXEC.
 10629*    MOVE '," L                  $   #00010448' TO DFHEIV0
 10630     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10631     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10632     MOVE X'2020233030303130343438' TO DFHEIV0(25:11)
 10633     CALL 'kxdfhei1' USING DFHEIV0,
 10634           DFHEIV20,
 10635           ERPNDB-RECORD-LENGTH,
 10636           DFHEIV99
 10637     SET ADDRESS OF PENDING-BUSINESS TO
 10638         DFHEIV20
 10639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10640
 10641
 10642
 10643* EXEC CICS HANDLE CONDITION
 10644*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10645*    END-EXEC.
 10646*    MOVE '"$I                   ! # #00010453' TO DFHEIV0
 10647     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10648     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10649     MOVE X'2320233030303130343533' TO DFHEIV0(25:11)
 10650     CALL 'kxdfhei1' USING DFHEIV0
 10651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10652
 10653
 10654     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10655     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10656     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10657
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 196
* EL6311.cbl
 10658
 10659* EXEC CICS READ
 10660*        INTO    (PENDING-BUSINESS)
 10661*        DATASET (FILE-ID-ERPNDB)
 10662*        RIDFLD  (ERPNDB-KEY)
 10663*    END-EXEC.
 10664     MOVE LENGTH OF
 10665      PENDING-BUSINESS
 10666       TO DFHEIV11
 10667*    MOVE '&"IL       E          (   #00010461' TO DFHEIV0
 10668     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10669     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10670     MOVE X'2020233030303130343631' TO DFHEIV0(25:11)
 10671     CALL 'kxdfhei1' USING DFHEIV0,
 10672           FILE-ID-ERPNDB,
 10673           PENDING-BUSINESS,
 10674           DFHEIV11,
 10675           ERPNDB-KEY,
 10676           DFHEIV99,
 10677           DFHEIV99,
 10678           DFHEIV99
 10679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10680
 10681
 10682     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10683
 10684     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10685     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10686     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10687     MOVE SPACES                 TO PENDING-BUSINESS.
 10688     MOVE 'PB'                   TO PB-RECORD-ID.
 10689     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10690     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10691     MOVE SPACES                 TO PB-CERT-SFX.
 10692     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10693     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10694                                    PB-ALT-CHG-SEQ-NO.
 10695
 10696     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10697     MOVE '1'                    TO PB-RECORD-TYPE.
 10698
 10699     IF BSUFIXL NOT = ZEROS
 10700        MOVE BSUFIXI             TO PB-CERT-SFX.
 10701
 10702     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10703
 10704     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10705     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10706
 10707     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10708                                    PB-I-LF-PREM-CALC
 10709                                    PB-I-LF-ALT-PREM-CALC
 10710                                    PB-I-LF-RATE
 10711                                    PB-I-LF-ALT-RATE
 10712                                    PB-I-LF-REI-RATE
 10713                                    PB-I-LF-ALT-REI-RATE
 10714                                    PB-I-RATE-DEV-PCT-LF
 10715                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 197
* EL6311.cbl
 10716                                    PB-I-AH-RATE
 10717                                    PB-I-AH-REI-RATE
 10718                                    PB-I-AH-RATE-TRM
 10719                                    PB-I-RATE-DEV-PCT-AH
 10720                                    PB-I-BUSINESS-TYPE
 10721                                    PB-I-LIFE-COMMISSION
 10722                                    PB-I-JOINT-COMMISSION
 10723                                    PB-I-JOINT-AGE
 10724                                    PB-I-AH-COMMISSION
 10725                                    PB-I-CURR-SEQ
 10726                                    PB-CHG-COUNT
 10727                                    PB-LF-BILLED-AMTS
 10728                                    PB-AH-BILLED-AMTS
 10729                                    PB-CALC-TOLERANCE
 10730                                    PB-I-EXTENTION-DAYS
 10731*                                   PB-I-MICROFILM-NO
 10732                                    PB-I-TERM-IN-DAYS.
 10733
 10734     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10735                                    PB-I-LF-EXPIRE-DT
 10736                                    PB-I-AH-EXPIRE-DT
 10737                                    PB-BILLED-DT
 10738                                    PB-ACCT-EFF-DT
 10739                                    PB-ACCT-EXP-DT
 10740                                    PB-I-1ST-PMT-DT.
 10741
 10742     MOVE 'X'                    TO PB-FATAL-FLAG.
 10743
 10744     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10745
 10746     IF BLSTNML GREATER THAN ZEROS
 10747         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10748
 10749*    IF BMICRNOL  GREATER  ZEROS
 10750*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10751*    ELSE
 10752*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10753     IF BVINL > ZEROS
 10754        MOVE BVINI               TO PB-I-VIN
 10755     END-IF
 10756     IF B1STNML GREATER THAN ZEROS
 10757         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10758
 10759     IF BINITL  GREATER THAN ZEROS
 10760         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10761
 10762     IF BBIRTHL GREATER THAN ZERO
 10763         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10764     ELSE
 10765         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10766
 10767     IF B1STPMTL GREATER THAN ZERO
 10768         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10769     ELSE
 10770         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10771
 10772     IF BAGEL    GREATER THAN ZEROS
 10773         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 198
* EL6311.cbl
 10774        ELSE
 10775         MOVE ZEROS              TO PB-I-AGE.
 10776
 10777     IF BSEXL    GREATER THAN ZEROS
 10778         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10779
 10780     IF BTERM-LEN (1) GREATER THAN ZEROS
 10781        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10782     ELSE
 10783        MOVE ZEROS               TO PB-I-LF-TERM.
 10784
 10785     IF BTERM-LEN (2) GREATER THAN ZEROS
 10786        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10787     ELSE
 10788        MOVE ZEROS               TO PB-I-AH-TERM.
 10789
 10790     IF BLNTRML       GREATER THAN ZEROS
 10791         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10792        ELSE
 10793         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10794
 10795     IF BFREQL        GREATER THAN ZEROS
 10796         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10797        ELSE
 10798         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10799
 10800     IF BSKPCDL       GREATER THAN ZEROS
 10801         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10802
 10803     IF BMODEL        GREATER THAN ZEROS
 10804         MOVE BMODEI             TO PB-I-TERM-TYPE
 10805                                    PI-BMODE.
 10806
 10807     IF BPMTSL        GREATER THAN ZEROS
 10808         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10809                                    PI-BPMTS
 10810        ELSE
 10811         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10812                                    PI-BPMTS.
 10813
 10814     IF BPMTAMTL      GREATER THAN ZEROS
 10815         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10816        ELSE
 10817         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10818
 10819     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10820        IF BTYPE  (1)   NOT = ZEROS
 10821           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10822                                    PI-BTYPE (1)
 10823           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10824           MOVE SPACES           TO PB-I-LF-ABBR
 10825        ELSE
 10826           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10827                                    PB-I-LF-ABBR
 10828           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10829     ELSE
 10830        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10831                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 199
* EL6311.cbl
 10832        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10833
 10834     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10835         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10836     ELSE
 10837         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10838
 10839     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10840         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10841     ELSE
 10842         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10843
 10844     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10845         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10846            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10847            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10848         ELSE
 10849            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10850*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10851*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10852         END-IF
 10853     ELSE
 10854         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10855
 10856     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10857         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10858
 10859     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10860         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10861         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10862     ELSE
 10863         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10864
 10865     IF  BALT-PREM-LEN     (2) > ZEROS
 10866         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10867     ELSE
 10868         MOVE ZEROS            TO PB-I-TOT-FEES.
 10869
 10870     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10871        IF BTYPE      (2)   NOT = ZEROS
 10872           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10873                                  PI-BTYPE (2)
 10874           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10875           MOVE SPACES         TO PB-I-AH-ABBR
 10876        ELSE
 10877           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10878                                  PB-I-AH-ABBR
 10879           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10880     ELSE
 10881        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10882                                  PB-I-AH-ABBR
 10883        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10884
 10885     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10886         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10887     ELSE
 10888         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10889
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 200
* EL6311.cbl
 10890     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10891         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10892            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10893            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10894         ELSE
 10895            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10896*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10897*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10898         END-IF
 10899     ELSE
 10900         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10901
 10902     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10903         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10904
 10905     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10906        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10907     ELSE
 10908        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10909
 10910     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10911        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10912     ELSE
 10913        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10914
 10915     IF BINDGRPL  GREATER THAN ZEROS
 10916         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10917
 10918     IF BRTCLSL   GREATER THAN ZEROS
 10919         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10920
 10921     IF BSIGL     GREATER THAN ZEROS
 10922         MOVE BSIGI              TO PB-I-SIG-SW.
 10923     IF BAPRL > ZEROS
 10924         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10925     ELSE
 10926        if pi-company-id = 'CID'
 10927           move +99.9999         to pb-i-loan-apr
 10928        else
 10929           MOVE ZEROS            TO PB-I-LOAN-APR
 10930        end-if
 10931     end-if
 10932     IF BMEMBERL  GREATER THAN ZEROS
 10933         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10934
 10935     IF BLNOFCRL  GREATER THAN ZEROS
 10936         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10937
 10938     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10939        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10940     ELSE
 10941        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10942
 10943     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10944        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10945     ELSE
 10946        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10947
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 201
* EL6311.cbl
 10948     IF BDAYSL   GREATER THAN ZEROS
 10949        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10950                                    PB-I-EXTENTION-DAYS
 10951     ELSE
 10952        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10953                                    PB-I-EXTENTION-DAYS.
 10954
 10955     IF BDAYSL GREATER THAN ZEROS
 10956        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10957
 10958     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10959        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10960           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10961
 10962     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10963        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10964           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10965
 10966     IF B1STPMTL GREATER THAN ZEROS
 10967        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10968
 10969     IF PB-EXT-DAYS-PROCESSING
 10970        IF PB-I-EXTENTION-DAYS = ZEROS
 10971           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10972
 10973     IF PB-EXPIRE-DT-PROCESSING
 10974        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10975           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10976             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10977
 10978     IF PB-1ST-PMT-DT-PROCESSING
 10979        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10980           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10981
 10982     IF BREINL GREATER THAN ZEROS
 10983        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10984
 10985     IF BENTRYL NOT = ZEROS
 10986        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10987        IF PI-COMPANY-ID = 'CID'
 10988           AND (PB-BATCH-ENTRY = 'P')
 10989           AND (PB-STATE = 'VA')
 10990           PERFORM 1500-UPDATE-ERNOTE
 10991                                 THRU 1500-EXIT
 10992        END-IF
 10993     END-IF
 10994     IF BUNWRITL NOT = ZEROS
 10995        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10996
 10997     IF BFORCEL NOT = ZEROS
 10998        MOVE BFORCEI             TO PB-FORCE-CODE.
 10999
 11000     IF BBILCDL NOT = ZEROS
 11001        MOVE BBILCDI             TO PB-RECORD-BILL.
 11002
 11003     IF BLIVESL GREATER THAN ZEROS
 11004        MOVE WS-BLIVES           TO PB-I-LIVES
 11005     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 202
* EL6311.cbl
 11006        MOVE ZEROS               TO PB-I-LIVES.
 11007
 11008     IF BBILLEDL GREATER THAN ZEROS
 11009        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 11010     ELSE
 11011        MOVE ZEROS               TO PB-I-NUM-BILLED.
 11012
 11013*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 11014
 11015 1260-WRITE-PB-RECORD.
 11016     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 11017                                    PB-INPUT-BY.
 11018     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11019     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 11020                                    PB-INPUT-DT.
 11021
 11022     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11023     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 11024                                    PB-CONTROL-BY-ORIG-BATCH.
 11025
 11026
 11027     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11028     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 11029     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11030     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11031     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11032
 11033     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11034
 11035     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11036
 11037     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11038     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11039     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11040
 11041     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 11042     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 11043
 11044 1275-WRITE-PENDING-BUSINESS.
 11045     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11046     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11047     MOVE 'A'                    TO JP-RECORD-TYPE.
 11048     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11049
 11050
 11051* EXEC CICS HANDLE CONDITION
 11052*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 11053*    END-EXEC.
 11054*    MOVE '"$%                   ! $ #00010835' TO DFHEIV0
 11055     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11056     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11057     MOVE X'2420233030303130383335' TO DFHEIV0(25:11)
 11058     CALL 'kxdfhei1' USING DFHEIV0
 11059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11060
 11061
 11062
 11063* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 203
* EL6311.cbl
 11064*        DATASET (FILE-ID-ERPNDB)
 11065*        FROM    (PENDING-BUSINESS)
 11066*        RIDFLD  (PB-CONTROL-PRIMARY)
 11067*    END-EXEC.
 11068     MOVE LENGTH OF
 11069      PENDING-BUSINESS
 11070       TO DFHEIV11
 11071*    MOVE '&$ L                  ''   #00010839' TO DFHEIV0
 11072     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11073     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11074     MOVE X'2020233030303130383339' TO DFHEIV0(25:11)
 11075     CALL 'kxdfhei1' USING DFHEIV0,
 11076           FILE-ID-ERPNDB,
 11077           PENDING-BUSINESS,
 11078           DFHEIV11,
 11079           PB-CONTROL-PRIMARY,
 11080           DFHEIV99,
 11081           DFHEIV99
 11082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11083
 11084
 11085     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 11086
 11087     PERFORM 8400-LOG-JOURNAL-RECORD.
 11088
 11089******************************************************************
 11090*       A D D  O R I G I N A L  C E R T  I N F O                 *
 11091******************************************************************
 11092     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11093     MOVE ' '                    TO WS-ERMAIL-SW
 11094
 11095* EXEC CICS READ
 11096*       DATASET   (FILE-ID-ERMAIL)
 11097*       SET       (ADDRESS OF MAILING-DATA)
 11098*       RIDFLD    (ERMAIL-KEY)
 11099*       RESP      (WS-RESPONSE)
 11100*    END-EXEC
 11101*    MOVE '&"S        E          (  N#00010855' TO DFHEIV0
 11102     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11103     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11104     MOVE X'204E233030303130383535' TO DFHEIV0(25:11)
 11105     CALL 'kxdfhei1' USING DFHEIV0,
 11106           FILE-ID-ERMAIL,
 11107           DFHEIV20,
 11108           DFHEIV99,
 11109           ERMAIL-KEY,
 11110           DFHEIV99,
 11111           DFHEIV99,
 11112           DFHEIV99
 11113     SET ADDRESS OF MAILING-DATA TO
 11114         DFHEIV20
 11115     MOVE EIBRESP  TO WS-RESPONSE
 11116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11117     IF RESP-NORMAL
 11118        SET ERMAIL-FOUND TO TRUE
 11119     END-IF
 11120
 11121     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 204
* EL6311.cbl
 11122     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 11123     MOVE 'OC'                   TO OC-RECORD-ID
 11124     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11125                                 TO OC-CONTROL-PRIMARY (1:33)
 11126     MOVE 'I'                    TO OC-RECORD-TYPE
 11127     MOVE +4096                  TO OC-KEY-SEQ-NO
 11128     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 11129     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 11130     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 11131     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11132     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11133     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11134     MOVE PB-I-AGE               TO OC-INS-AGE
 11135     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 11136     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 11137     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11138     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 11139     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 11140     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 11141     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 11142     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 11143     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11144     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11145     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 11146     IF PB-I-JOINT-COMMISSION > +0
 11147         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 11148     ELSE
 11149         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 11150     END-IF
 11151     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 11152     MOVE +0                     TO OC-LF-CANCEL-AMT
 11153                                    OC-LF-ITD-CANCEL-AMT
 11154     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 11155     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 11156     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 11157     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 11158     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 11159     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 11160     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 11161     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 11162     MOVE +0                     TO OC-AH-CANCEL-AMT
 11163                                    OC-AH-ITD-CANCEL-AMT
 11164     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 11165     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 11166     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 11167     IF ERMAIL-FOUND
 11168        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 11169     END-IF
 11170     IF NOT CERT-TRL-REC-NOT-FOUND
 11171        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11172                           OC-INS-AGE-DEFAULT-FLAG
 11173        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11174                           OC-JNT-AGE-DEFAULT-FLAG
 11175     END-IF
 11176     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 11177     .
 11178 1275-WRITE-ELCRTO.
 11179
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 205
* EL6311.cbl
 11180* EXEC CICS WRITE
 11181*       DATASET   ('ELCRTO')
 11182*       FROM      (ORIGINAL-CERTIFICATE)
 11183*       RIDFLD    (OC-CONTROL-PRIMARY)
 11184*       RESP      (WS-RESPONSE)
 11185*    END-EXEC
 11186     MOVE LENGTH OF
 11187      ORIGINAL-CERTIFICATE
 11188       TO DFHEIV11
 11189     MOVE 'ELCRTO' TO DFHEIV1
 11190*    MOVE '&$ L                  ''  N#00010923' TO DFHEIV0
 11191     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11192     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11193     MOVE X'204E233030303130393233' TO DFHEIV0(25:11)
 11194     CALL 'kxdfhei1' USING DFHEIV0,
 11195           DFHEIV1,
 11196           ORIGINAL-CERTIFICATE,
 11197           DFHEIV11,
 11198           OC-CONTROL-PRIMARY,
 11199           DFHEIV99,
 11200           DFHEIV99
 11201     MOVE EIBRESP  TO WS-RESPONSE
 11202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11203*    display ' just wrote 1275 ' ws-response
 11204     IF RESP-DUPKEY
 11205        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 11206        GO TO 1275-WRITE-ELCRTO
 11207     ELSE
 11208        IF NOT RESP-NORMAL
 11209           MOVE -1               TO BMAINTL
 11210           MOVE ER-7450          TO EMI-ERROR
 11211           PERFORM 9900-ERROR-FORMAT
 11212                                 THRU 9900-EXIT
 11213           GO TO 8200-SEND-DATAONLY
 11214        END-IF
 11215     END-IF
 11216******************************************************************
 11217*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11218******************************************************************
 11219
 11220
 11221* EXEC CICS READ
 11222*        INTO    (PENDING-BUSINESS)
 11223*        DATASET (FILE-ID-ERPNDB)
 11224*        RIDFLD  (ERPNDB-KEY)
 11225*        UPDATE
 11226*    END-EXEC.
 11227     MOVE LENGTH OF
 11228      PENDING-BUSINESS
 11229       TO DFHEIV11
 11230*    MOVE '&"IL       EU         (   #00010946' TO DFHEIV0
 11231     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11232     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11233     MOVE X'2020233030303130393436' TO DFHEIV0(25:11)
 11234     CALL 'kxdfhei1' USING DFHEIV0,
 11235           FILE-ID-ERPNDB,
 11236           PENDING-BUSINESS,
 11237           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 206
* EL6311.cbl
 11238           ERPNDB-KEY,
 11239           DFHEIV99,
 11240           DFHEIV99,
 11241           DFHEIV99
 11242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11243
 11244
 11245     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11246     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11247     MOVE 'B'                    TO JP-RECORD-TYPE.
 11248     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11249
 11250     PERFORM 8400-LOG-JOURNAL-RECORD.
 11251
 11252     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11253
 11254
 11255* EXEC CICS REWRITE
 11256*        DATASET (FILE-ID-ERPNDB)
 11257*        FROM    (PENDING-BUSINESS)
 11258*    END-EXEC.
 11259     MOVE LENGTH OF
 11260      PENDING-BUSINESS
 11261       TO DFHEIV11
 11262*    MOVE '&& L                  %   #00010962' TO DFHEIV0
 11263     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11264     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11265     MOVE X'2020233030303130393632' TO DFHEIV0(25:11)
 11266     CALL 'kxdfhei1' USING DFHEIV0,
 11267           FILE-ID-ERPNDB,
 11268           PENDING-BUSINESS,
 11269           DFHEIV11,
 11270           DFHEIV99
 11271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11272
 11273
 11274     MOVE 'C'                    TO JP-RECORD-TYPE.
 11275     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11276
 11277     PERFORM 8400-LOG-JOURNAL-RECORD.
 11278
 11279     IF WS-ERRORS-PRESENT
 11280         GO TO 3900-RE-DISPLAY-RECORD.
 11281
 11282     MOVE ZEROS                  TO EMI-ERROR.
 11283     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11284     MOVE LOW-VALUES             TO EL631BI.
 11285     MOVE  -1                    TO BMAINTL.
 11286     GO TO 8100-SEND-INITIAL-MAP.
 11287
 11288 1280-BATCH-HDR-NOT-FOUND.
 11289     MOVE -1                     TO BMAINTL.
 11290     MOVE ER-7450                TO EMI-ERROR.
 11291     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11292     GO TO 8200-SEND-DATAONLY.
 11293
 11294 1290-DUPLICATE-ALT-INDEX.
 11295
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 207
* EL6311.cbl
 11296******************************************************************
 11297*                                                                *
 11298*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11299*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11300*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11301*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11302*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11303*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11304*                                                                *
 11305******************************************************************
 11306
 11307     IF LCP-ONCTR-01 =  0
 11308         ADD 1 TO LCP-ONCTR-01
 11309        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11310
 11311     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11312
 11313     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11314         NEXT SENTENCE
 11315     ELSE
 11316         ADD +1 TO PB-BATCH-SEQ-NO
 11317                   PB-CSR-BATCH-SEQ-NO
 11318         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11319         GO TO 1275-WRITE-PENDING-BUSINESS.
 11320
 11321     MOVE -1                     TO BCERTNOL.
 11322     MOVE AL-UABON               TO BCERTNOA.
 11323     MOVE AL-UNBON               TO BEFFDTA.
 11324
 11325     MOVE 1                      TO EMI-SUB
 11326                                    EMI-SWITCH1
 11327                                    EMI-SWITCH-AREA-1
 11328                                    EMI-SWITCH-AREA-2.
 11329
 11330     MOVE SPACES                 TO EMI-ERROR-LINES.
 11331
 11332
 11333* EXEC CICS SYNCPOINT ROLLBACK
 11334*    END-EXEC.
 11335*    MOVE '6"R                   !   #00011025' TO DFHEIV0
 11336     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11337     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11338     MOVE X'2020233030303131303235' TO DFHEIV0(25:11)
 11339     CALL 'kxdfhei1' USING DFHEIV0
 11340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11341
 11342
 11343     MOVE ER-2247                TO EMI-ERROR.
 11344     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11345     GO TO 8200-SEND-DATAONLY.
 11346
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 208
* EL6311.cbl
 11348
 11349
 11350 1295-READ-CERT-TRAILER.
 11351
 11352
 11353* EXEC CICS GETMAIN
 11354*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11355*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11356*        INITIMG (GETMAIN-SPACE)
 11357*    END-EXEC
 11358*    MOVE ',"IL                  $   #00011037' TO DFHEIV0
 11359     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11360     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11361     MOVE X'2020233030303131303337' TO DFHEIV0(25:11)
 11362     CALL 'kxdfhei1' USING DFHEIV0,
 11363           DFHEIV20,
 11364           ELCRTT-RECORD-LENGTH,
 11365           GETMAIN-SPACE
 11366     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11367         DFHEIV20
 11368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11369
 11370     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11371     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11372     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11373
 11374
 11375* EXEC CICS HANDLE CONDITION
 11376*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11377*    END-EXEC.
 11378*    MOVE '"$I                   ! % #00011047' TO DFHEIV0
 11379     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11380     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11381     MOVE X'2520233030303131303437' TO DFHEIV0(25:11)
 11382     CALL 'kxdfhei1' USING DFHEIV0
 11383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11384
 11385
 11386
 11387* EXEC CICS READ
 11388*        DATASET  (CRTT-ID)
 11389*        RIDFLD   (ELCRTT-KEY)
 11390*        INTO     (CERTIFICATE-TRAILERS)
 11391*    END-EXEC.
 11392     MOVE LENGTH OF
 11393      CERTIFICATE-TRAILERS
 11394       TO DFHEIV11
 11395*    MOVE '&"IL       E          (   #00011051' TO DFHEIV0
 11396     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11397     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11398     MOVE X'2020233030303131303531' TO DFHEIV0(25:11)
 11399     CALL 'kxdfhei1' USING DFHEIV0,
 11400           CRTT-ID,
 11401           CERTIFICATE-TRAILERS,
 11402           DFHEIV11,
 11403           ELCRTT-KEY,
 11404           DFHEIV99,
 11405           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 209
* EL6311.cbl
 11406           DFHEIV99
 11407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11408
 11409
 11410     GO TO 1295-EXIT.
 11411
 11412 1295-CERT-TRL-REC-NOTFND.
 11413     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11414
 11415 1295-EXIT.
 11416     EXIT.
 11417
 11418******************************************************************
 11419*                                                                *
 11420*          C H A N G E   I S S U E   R O U T I N E               *
 11421*                                                                *
 11422******************************************************************
 11423
 11424***************************************************************
 11425*                                                             *
 11426*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11427*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11428*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11429*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11430*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11431*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11432*     5. LINK TO THE EDIT ROUTINE.                            *
 11433*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11434*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11435*              THE EDIT ROUTINE.                              *
 11436*     7. REWRITE THE NEW ISSUE                                *
 11437*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11438*                                                             *
 11439***************************************************************
 11440
 11441 1300-CHANGE-ISSUE-ROUTINE.
 11442     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11443
 11444     IF BCHGL NOT = ZEROS
 11445        MOVE ER-2196             TO EMI-ERROR
 11446        MOVE AL-UABON            TO BMAINTA
 11447        MOVE -1                  TO BMAINTL
 11448        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11449        GO TO 8200-SEND-DATAONLY.
 11450
 11451     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11452
 11453     IF BSUFIXL NOT = ZEROS
 11454        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11455     ELSE
 11456        MOVE SPACE               TO WS-NEW-SUFFIX.
 11457
 11458     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11459     PERFORM 8600-DEEDIT.
 11460     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11461     MOVE '4'                    TO DC-OPTION-CODE.
 11462     PERFORM 9700-DATE-LINK.
 11463     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 210
* EL6311.cbl
 11464        MOVE ER-0348             TO EMI-ERROR
 11465        MOVE -1                  TO BEFFDTL
 11466        MOVE AL-UABON            TO BEFFDTA
 11467        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11468        GO TO 8200-SEND-DATAONLY
 11469     ELSE
 11470        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11471        MOVE AL-UANON            TO BEFFDTA
 11472        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11473
 11474 1325-PROCESS-ISSUE-CHANGES.
 11475
 11476* EXEC CICS HANDLE CONDITION
 11477*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11478*    END-EXEC.
 11479*    MOVE '"$I                   ! & #00011122' TO DFHEIV0
 11480     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11481     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11482     MOVE X'2620233030303131313232' TO DFHEIV0(25:11)
 11483     CALL 'kxdfhei1' USING DFHEIV0
 11484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11485
 11486
 11487     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11488     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11489     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11490
 11491
 11492* EXEC CICS GETMAIN
 11493*        SET      (ADDRESS OF PENDING-BUSINESS)
 11494*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11495*        INITIMG  (GETMAIN-SPACE)
 11496*     END-EXEC.
 11497*    MOVE ',"IL                  $   #00011130' TO DFHEIV0
 11498     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11499     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11500     MOVE X'2020233030303131313330' TO DFHEIV0(25:11)
 11501     CALL 'kxdfhei1' USING DFHEIV0,
 11502           DFHEIV20,
 11503           ERPNDB-RECORD-LENGTH,
 11504           GETMAIN-SPACE
 11505     SET ADDRESS OF PENDING-BUSINESS TO
 11506         DFHEIV20
 11507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11508
 11509
 11510
 11511* EXEC CICS READ
 11512*        INTO    (PENDING-BUSINESS)
 11513*        DATASET (FILE-ID-ERPNDB)
 11514*        RIDFLD  (ERPNDB-KEY)
 11515*    END-EXEC.
 11516     MOVE LENGTH OF
 11517      PENDING-BUSINESS
 11518       TO DFHEIV11
 11519*    MOVE '&"IL       E          (   #00011136' TO DFHEIV0
 11520     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11521     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 211
* EL6311.cbl
 11522     MOVE X'2020233030303131313336' TO DFHEIV0(25:11)
 11523     CALL 'kxdfhei1' USING DFHEIV0,
 11524           FILE-ID-ERPNDB,
 11525           PENDING-BUSINESS,
 11526           DFHEIV11,
 11527           ERPNDB-KEY,
 11528           DFHEIV99,
 11529           DFHEIV99,
 11530           DFHEIV99
 11531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11532
 11533
 11534     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11535
 11536
 11537* EXEC CICS HANDLE CONDITION
 11538*         NOTFND     (1385-REC-NOT-FOUND)
 11539*    END-EXEC.
 11540*    MOVE '"$I                   ! '' #00011144' TO DFHEIV0
 11541     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11543     MOVE X'2720233030303131313434' TO DFHEIV0(25:11)
 11544     CALL 'kxdfhei1' USING DFHEIV0
 11545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11546
 11547
 11548**********************************************************
 11549*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11550*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11551**********************************************************
 11552
 11553
 11554* EXEC CICS READ
 11555*        DATASET (FILE-ID-ERPNDB)
 11556*        INTO    (PENDING-BUSINESS)
 11557*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11558*    END-EXEC.
 11559     MOVE LENGTH OF
 11560      PENDING-BUSINESS
 11561       TO DFHEIV11
 11562*    MOVE '&"IL       E          (   #00011153' TO DFHEIV0
 11563     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11564     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11565     MOVE X'2020233030303131313533' TO DFHEIV0(25:11)
 11566     CALL 'kxdfhei1' USING DFHEIV0,
 11567           FILE-ID-ERPNDB,
 11568           PENDING-BUSINESS,
 11569           DFHEIV11,
 11570           PI-PREV-CONTROL-PRIMARY,
 11571           DFHEIV99,
 11572           DFHEIV99,
 11573           DFHEIV99
 11574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11575
 11576
 11577********** DO NOT ALLOW CHANGES IF THRU A/R
 11578     IF BMAINTI = 'C'
 11579         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 212
* EL6311.cbl
 11580             MOVE ER-4005          TO EMI-ERROR
 11581             MOVE -1               TO BMAINTL
 11582             MOVE AL-UABON         TO BMAINTA
 11583             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11584             GO TO 8200-SEND-DATAONLY.
 11585**********
 11586     MOVE PB-ISSUE-RECORD TO WS-SAVE-PEND-ISSUE
 11587
 11588     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11589        MOVE -1                 TO BMAINTL
 11590        MOVE ER-2197            TO EMI-ERROR
 11591        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11592        GO TO 8200-SEND-DATAONLY.
 11593
 11594     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11595        MOVE ER-2196             TO EMI-ERROR
 11596        MOVE AL-UABON            TO BMAINTA
 11597        MOVE -1                  TO BMAINTL
 11598        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11599        GO TO 8200-SEND-DATAONLY.
 11600
 11601     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11602
 11603     IF PB-BILLED-DT = LOW-VALUES AND
 11604        PB-CHG-COUNT = ZEROS
 11605        NEXT SENTENCE
 11606     ELSE
 11607        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11608            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11609           OR
 11610           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11611            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11612           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11613     move zeros                  to ws-check-amts
 11614     move ' '                    to ws-stop-sw
 11615                                    ws-check-sw
 11616                                    ws-proc-check-sw
 11617                                    ws-any-check-sw
 11618                                    ws-chek-browse-sw
 11619
 11620     perform 2500-browse-checks  thru 2500-exit
 11621
 11622     if i-have-processed-checks
 11623        or i-have-checks
 11624        continue
 11625     else
 11626        go to 1330-continue
 11627     end-if
 11628
 11629     compute ws-tot-orig-prem =
 11630        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11631        pb-i-lf-alt-premium-amt
 11632
 11633     if bprem1l <> zeros
 11634        MOVE AL-UNNON            TO bprem1a
 11635        move ws-bprem (1)        to ws-new-iss-total
 11636     else
 11637        move pb-i-lf-premium-amt to ws-new-iss-total
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 213
* EL6311.cbl
 11638     end-if
 11639     display ' new iss totala ' ws-new-iss-total
 11640
 11641     if baltpr1l <> zeros
 11642        MOVE AL-UNNON            TO baltpr1a
 11643        compute ws-new-iss-total =
 11644           ws-new-iss-total + ws-balt-prem(1)
 11645     else
 11646        compute ws-new-iss-total =
 11647           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11648     end-if
 11649
 11650     if bprem2l <> zeros
 11651        MOVE AL-UNNON            TO bprem2a
 11652        compute ws-new-iss-total = ws-new-iss-total +
 11653           ws-bprem (2)
 11654     else
 11655        compute ws-new-iss-total = ws-new-iss-total +
 11656           pb-i-ah-premium-amt
 11657     end-if
 11658
 11659     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11660        if ((bprem1l <> zeros)
 11661           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11662                      or
 11663           ((bprem2l <> zeros)
 11664           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11665           move er-3456          to emi-error
 11666           perform 9900-error-format
 11667                                 thru 9900-exit
 11668           go to 1330-continue
 11669        end-if
 11670     end-if
 11671
 11672     if ws-new-iss-total > ws-tot-orig-prem
 11673        move er-3458             to emi-error
 11674        perform 9900-error-format thru 9900-exit
 11675        move al-uabon            to bmainta
 11676        move -1                  to bmaintl
 11677        go to 8200-send-dataonly
 11678     end-if
 11679
 11680     if ws-new-iss-total < ws-tot-orig-prem
 11681        move er-3457             to emi-error
 11682        move al-uabon            to bprem1a
 11683                                    bprem2a
 11684        move +0 to bprem1l bprem2l
 11685        perform 9900-error-format thru 9900-exit
 11686        move -1                  to bmaintl
 11687        go to 1330-continue
 11688     end-if
 11689
 11690     .
 11691 1330-continue.
 11692
 11693
 11694* EXEC CICS READ
 11695*        DATASET (FILE-ID-ERPNDB)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 214
* EL6311.cbl
 11696*        INTO    (PENDING-BUSINESS)
 11697*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11698*        UPDATE
 11699*    END-EXEC.
 11700     MOVE LENGTH OF
 11701      PENDING-BUSINESS
 11702       TO DFHEIV11
 11703*    MOVE '&"IL       EU         (   #00011275' TO DFHEIV0
 11704     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11705     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11706     MOVE X'2020233030303131323735' TO DFHEIV0(25:11)
 11707     CALL 'kxdfhei1' USING DFHEIV0,
 11708           FILE-ID-ERPNDB,
 11709           PENDING-BUSINESS,
 11710           DFHEIV11,
 11711           PI-PREV-CONTROL-PRIMARY,
 11712           DFHEIV99,
 11713           DFHEIV99,
 11714           DFHEIV99
 11715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11716
 11717
 11718     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11719     MOVE 'B'                    TO JP-RECORD-TYPE
 11720     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11721     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11722
 11723     PERFORM 8400-LOG-JOURNAL-RECORD.
 11724
 11725     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11726        PB-CHG-COUNT NOT = ZEROS
 11727        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11728            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11729           OR
 11730           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11731            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11732            MOVE LOW-VALUES             TO PB-BILLED-DT
 11733            ADD +1                      TO PB-CHG-COUNT.
 11734
 11735     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11736     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11737     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11738     MOVE '5'                    TO DC-OPTION-CODE.
 11739     PERFORM 9700-DATE-LINK
 11740     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11741
 11742*    IF BMICRNOL  GREATER  ZEROS
 11743*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11744
 11745     IF BVINL > ZEROS
 11746        MOVE BVINI               TO PB-I-VIN
 11747     END-IF
 11748     IF (BFORCEL NOT = ZEROS)
 11749        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11750        AND (BFORCEI = ' ')
 11751        AND (PB-FORCE-CODE = 'O')
 11752        COMPUTE PB-I-AH-PREMIUM-AMT =
 11753           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 215
* EL6311.cbl
 11754        PERFORM 1800-REMOVE-CERT-NOTES
 11755                                 THRU 1800-EXIT
 11756        PERFORM 1900-DELETE-ERPYAJ
 11757                                 THRU 1900-EXIT
 11758        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11759     END-IF
 11760     IF (BFORCEL NOT = ZEROS)
 11761        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11762        AND (BFORCEI = 'O')
 11763        AND (PB-FORCE-CODE NOT = 'O')
 11764        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11765           PB-I-AH-PREM-CALC
 11766        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11767        MOVE SPACE               TO DC-OPTION-CODE
 11768        PERFORM 9700-DATE-LINK
 11769        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11770        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11771        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11772        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11773        PERFORM 1500-UPDATE-ERNOTE
 11774                                 THRU 1500-EXIT
 11775        PERFORM 1600-UPDATE-ERPYAJ
 11776                                 THRU 1600-EXIT
 11777     END-IF
 11778     IF BLSTNML  GREATER THAN ZEROS
 11779         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11780
 11781     IF B1STNML  GREATER THAN ZEROS
 11782         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11783
 11784     IF BINITL   GREATER THAN ZEROS
 11785         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11786
 11787     IF BBIRTHL  GREATER THAN ZERO
 11788         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11789
 11790     IF B1STPMTL GREATER THAN ZERO
 11791         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11792
 11793     IF BAGEL    GREATER THAN ZEROS
 11794         MOVE BAGEI              TO PB-I-AGE.
 11795
 11796     MOVE 'N'                    TO WS-INS-AGE-SET
 11797                                    WS-JNT-AGE-SET.
 11798     IF BAGEL    GREATER THAN ZEROS
 11799        MOVE 'Y'                TO WS-INS-AGE-SET
 11800        IF BAGEI = ZERO AND
 11801             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11802           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11803           MOVE 'AGE*'          TO BAGEDEFO
 11804        ELSE
 11805           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11806           MOVE 'AGE '          TO BAGEDEFO
 11807        END-IF
 11808        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11809     END-IF.
 11810
 11811     IF BSEXL    GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 216
* EL6311.cbl
 11812         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11813
 11814     IF LETRREQL   GREATER THAN ZEROS
 11815        MOVE LETRREQI TO PB-I-LETTER-REQD
 11816     END-IF.
 11817
 11818     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11819        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11820
 11821     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11822        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11823
 11824     IF BLNTRML  GREATER THAN ZEROS
 11825         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11826
 11827     IF BFREQL   GREATER THAN ZEROS
 11828         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11829
 11830     IF BSKPCDL  GREATER THAN ZEROS
 11831         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11832
 11833     IF BMODEL   GREATER THAN ZEROS
 11834         MOVE BMODEI             TO PB-I-TERM-TYPE
 11835                                    PI-BMODE.
 11836
 11837     IF BPMTSL   GREATER THAN ZEROS
 11838         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11839                                    PI-BPMTS.
 11840
 11841     IF BPMTAMTL GREATER THAN ZEROS
 11842         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11843
 11844     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11845         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11846
 11847     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11848         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11849
 11850     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11851
 11852     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11853         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11854            SUBTRACT PB-I-LF-PREMIUM-AMT
 11855                     FROM WS-B-LF-ISS-PRM-ENTERED
 11856            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11857            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11858            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11859         ELSE
 11860            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11861*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11862*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11863         END-IF
 11864     END-IF.
 11865
 11866     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11867            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11868                     FROM WS-B-LF-ISS-PRM-ENTERED
 11869         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 217
* EL6311.cbl
 11870         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11871
 11872     IF  BALT-PREM-LEN     (2)  > ZEROS
 11873         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11874
 11875     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11876         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11877
 11878     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11879         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11880            SUBTRACT PB-I-AH-PREMIUM-AMT
 11881                     FROM WS-B-AH-ISS-PRM-ENTERED
 11882            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11883            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11884            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11885         ELSE
 11886            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11887*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11888*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11889         END-IF
 11890     END-IF
 11891
 11892     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11893        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11894
 11895     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11896        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11897
 11898     IF BINDGRPL            GREATER THAN ZEROS
 11899         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11900
 11901     IF BRTCLSL             GREATER THAN ZEROS
 11902         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11903
 11904     IF BSIGL               GREATER THAN ZEROS
 11905         MOVE BSIGI              TO PB-I-SIG-SW.
 11906
 11907     IF BAPRL               GREATER THAN ZEROS
 11908         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11909
 11910     IF BMEMBERL            GREATER THAN ZEROS
 11911         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11912
 11913     IF BLNOFCRL            GREATER THAN ZEROS
 11914         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11915
 11916     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11917        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11918
 11919     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11920        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11921
 11922     IF BDAYSL              GREATER THAN ZEROS
 11923        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11924                                    PB-I-EXTENTION-DAYS.
 11925
 11926     IF BDAYSL GREATER THAN ZEROS
 11927        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 218
* EL6311.cbl
 11928
 11929     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11930        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11931           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11932
 11933     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11934        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11935           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11936
 11937     IF B1STPMTL GREATER THAN ZEROS
 11938        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11939
 11940     IF PB-EXT-DAYS-PROCESSING
 11941        IF PB-I-EXTENTION-DAYS = ZEROS
 11942           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11943
 11944     IF PB-EXPIRE-DT-PROCESSING
 11945        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11946           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11947             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11948
 11949     IF PB-1ST-PMT-DT-PROCESSING
 11950        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11951           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11952
 11953     IF BREINL GREATER THAN ZEROS
 11954        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11955
 11956     IF BFORCEL NOT = ZEROS
 11957        MOVE BFORCEI             TO PB-FORCE-CODE.
 11958     IF (BENTRYL NOT = ZEROS)
 11959        AND (PB-COMPANY-ID = 'CID')
 11960        AND (PB-STATE = 'VA')
 11961        AND (BENTRYI NOT = 'P')
 11962        AND (PB-BATCH-ENTRY = 'P')
 11963        PERFORM 1800-REMOVE-CERT-NOTES
 11964                                 THRU 1800-EXIT
 11965     END-IF
 11966     IF BENTRYL NOT = ZEROS
 11967        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11968        IF PI-COMPANY-ID = 'CID'
 11969           AND (PB-BATCH-ENTRY = 'P')
 11970           AND (PB-STATE = 'VA')
 11971           PERFORM 1500-UPDATE-ERNOTE
 11972                                 THRU 1500-EXIT
 11973        END-IF
 11974     END-IF
 11975
 11976     IF BUNWRITL NOT = ZEROS
 11977        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11978
 11979     IF BBILCDL NOT = ZEROS
 11980        MOVE BBILCDI             TO PB-RECORD-BILL.
 11981
 11982     IF BLIVESL GREATER THAN ZEROS
 11983        MOVE WS-BLIVES           TO PB-I-LIVES.
 11984
 11985
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 219
* EL6311.cbl
 11986*DMD CUSTOM CODING*************START
 11987     IF PI-COMPANY-ID NOT = 'DMD'
 11988         MOVE ZEROS               TO BBILLEDL.
 11989*DMD CUSTOM CODING*************END
 11990
 11991     IF BBILLEDL GREATER THAN ZEROS
 11992        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11993
 11994
 11995*****************************************************************
 11996*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11997*****************************************************************
 11998
 11999     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 12000        IF BTYPE  (1)   = ZEROS OR SPACES
 12001           IF REMOVE-LF-COVERAGE
 12002               MOVE SPACES           TO PB-I-LF-INPUT-CD
 12003                                        PI-BTYPE (1)
 12004               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 12005                                        WS-B-LF-ISS-PRM-ENTERED
 12006               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 12007                                        WS-B-LF-ISS-PRM-ENTERED
 12008               SUBTRACT PB-I-LF-PREM-CALC FROM
 12009                                        WS-B-LF-ISS-PRM-COMPUTED
 12010               MOVE ZEROS            TO PB-I-LF-TERM
 12011                                        PB-I-LF-BENEFIT-AMT
 12012                                        PB-I-LF-PREMIUM-AMT
 12013                                        PB-I-LF-BENEFIT-CD
 12014                                        PB-I-LF-PREM-CALC
 12015                                        PB-I-LF-CRIT-PER
 12016                                        PB-I-LF-ALT-BENEFIT-AMT
 12017                                        PB-I-LF-ALT-PREMIUM-AMT
 12018               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 12019           ELSE
 12020               NEXT SENTENCE
 12021        ELSE
 12022           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 12023                                    PI-BTYPE (1).
 12024     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 12025        IF BTYPE  (2)   = ZEROS OR SPACES
 12026           IF  REMOVE-AH-COVERAGE
 12027               MOVE SPACES           TO PB-I-AH-INPUT-CD
 12028                                        PI-BTYPE (2)
 12029               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 12030                                        WS-B-AH-ISS-PRM-ENTERED
 12031               SUBTRACT PB-I-AH-PREM-CALC FROM
 12032                                        WS-B-AH-ISS-PRM-COMPUTED
 12033               MOVE ZEROS            TO PB-I-AH-TERM
 12034                                        PB-I-AH-BENEFIT-AMT
 12035                                        PB-I-AH-PREMIUM-AMT
 12036                                        PB-I-AH-BENEFIT-CD
 12037                                        PB-I-AH-PREM-CALC
 12038                                        PB-I-AH-CRIT-PER
 12039               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 12040           ELSE
 12041               NEXT SENTENCE
 12042        ELSE
 12043           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 220
* EL6311.cbl
 12044                                    PI-BTYPE (2).
 12045 1360-REWRITE-PB-RECORD.
 12046     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 12047
 12048     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 12049     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 12050
 12051     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 12052
 12053     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 12054     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 12055
 12056     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 12057         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 12058
 12059     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 12060         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 12061
 12062     IF CSR-EDIT-SESSION
 12063        PERFORM 139A-SET-LETTER-REQD THRU 139A-EXIT
 12064     END-IF.
 12065
 12066     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 12067
 12068     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 12069
 12070     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 12071
 12072     IF ARCHIVE-LETTER-RELEASED
 12073        MOVE 'C' TO PB-I-LETTER-REQD
 12074        PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT
 12075        PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT
 12076     END-IF
 12077
 12078     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 12079     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 12080     MOVE PB-SV-STATE            TO PI-SV-STATE.
 12081
 12082     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 12083     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 12084
 12085 1375-REWRITE-PB-RECORD.
 12086     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12087     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 12088     MOVE 'C'                    TO JP-RECORD-TYPE.
 12089     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12090
 12091
 12092* EXEC CICS REWRITE
 12093*        DATASET (FILE-ID-ERPNDB)
 12094*        FROM    (PENDING-BUSINESS)
 12095*    END-EXEC.
 12096     MOVE LENGTH OF
 12097      PENDING-BUSINESS
 12098       TO DFHEIV11
 12099*    MOVE '&& L                  %   #00011655' TO DFHEIV0
 12100     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12101     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 221
* EL6311.cbl
 12102     MOVE X'2020233030303131363535' TO DFHEIV0(25:11)
 12103     CALL 'kxdfhei1' USING DFHEIV0,
 12104           FILE-ID-ERPNDB,
 12105           PENDING-BUSINESS,
 12106           DFHEIV11,
 12107           DFHEIV99
 12108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12109
 12110
 12111     PERFORM 8400-LOG-JOURNAL-RECORD.
 12112******************************************************************
 12113*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 12114******************************************************************
 12115     MOVE ELCERT-KEY             TO ERMAIL-KEY
 12116     MOVE ' '                    TO WS-ERMAIL-SW
 12117
 12118* EXEC CICS READ
 12119*       DATASET   (FILE-ID-ERMAIL)
 12120*       SET       (ADDRESS OF MAILING-DATA)
 12121*       RIDFLD    (ERMAIL-KEY)
 12122*       RESP      (WS-RESPONSE)
 12123*    END-EXEC
 12124*    MOVE '&"S        E          (  N#00011666' TO DFHEIV0
 12125     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12126     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12127     MOVE X'204E233030303131363636' TO DFHEIV0(25:11)
 12128     CALL 'kxdfhei1' USING DFHEIV0,
 12129           FILE-ID-ERMAIL,
 12130           DFHEIV20,
 12131           DFHEIV99,
 12132           ERMAIL-KEY,
 12133           DFHEIV99,
 12134           DFHEIV99,
 12135           DFHEIV99
 12136     SET ADDRESS OF MAILING-DATA TO
 12137         DFHEIV20
 12138     MOVE EIBRESP  TO WS-RESPONSE
 12139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12140     IF RESP-NORMAL
 12141        SET ERMAIL-FOUND TO TRUE
 12142     END-IF
 12143
 12144     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 12145     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12146                                 TO ELCRTO-KEY
 12147     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12148     MOVE +0                     TO ELCRTO-SEQ-NO
 12149
 12150* EXEC CICS READ
 12151*       DATASET   ('ELCRTO')
 12152*       INTO      (ORIGINAL-CERTIFICATE)
 12153*       RIDFLD    (ELCRTO-KEY)
 12154*       GTEQ
 12155*       RESP      (WS-RESPONSE)
 12156*    END-EXEC
 12157     MOVE LENGTH OF
 12158      ORIGINAL-CERTIFICATE
 12159       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 222
* EL6311.cbl
 12160     MOVE 'ELCRTO' TO DFHEIV1
 12161*    MOVE '&"IL       G          (  N#00011681' TO DFHEIV0
 12162     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12163     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12164     MOVE X'204E233030303131363831' TO DFHEIV0(25:11)
 12165     CALL 'kxdfhei1' USING DFHEIV0,
 12166           DFHEIV1,
 12167           ORIGINAL-CERTIFICATE,
 12168           DFHEIV11,
 12169           ELCRTO-KEY,
 12170           DFHEIV99,
 12171           DFHEIV99,
 12172           DFHEIV99
 12173     MOVE EIBRESP  TO WS-RESPONSE
 12174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12175*    display ' just read gteq ' ws-response
 12176     IF RESP-NORMAL
 12177        AND (OC-CONTROL-PRIMARY (1:33) =
 12178                 PB-CONTROL-BY-ACCOUNT (1:33))
 12179        AND (OC-RECORD-TYPE = 'I')
 12180        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 12181           display ' csr edit session ' PI-CSR-SESSION-SW
 12182           IF NOT CSR-EDIT-SESSION
 12183
 12184* EXEC CICS READ
 12185*                DATASET   ('ELCRTO')
 12186*                INTO      (ORIGINAL-CERTIFICATE)
 12187*                RIDFLD    (OC-CONTROL-PRIMARY)
 12188*                UPDATE
 12189*                RESP      (WS-RESPONSE)
 12190*             END-EXEC
 12191     MOVE LENGTH OF
 12192      ORIGINAL-CERTIFICATE
 12193       TO DFHEIV11
 12194     MOVE 'ELCRTO' TO DFHEIV1
 12195*    MOVE '&"IL       EU         (  N#00011698' TO DFHEIV0
 12196     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12197     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12198     MOVE X'204E233030303131363938' TO DFHEIV0(25:11)
 12199     CALL 'kxdfhei1' USING DFHEIV0,
 12200           DFHEIV1,
 12201           ORIGINAL-CERTIFICATE,
 12202           DFHEIV11,
 12203           OC-CONTROL-PRIMARY,
 12204           DFHEIV99,
 12205           DFHEIV99,
 12206           DFHEIV99
 12207     MOVE EIBRESP  TO WS-RESPONSE
 12208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12209              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 12210              IF RESP-NORMAL
 12211                 display ' good read upd '
 12212                 MOVE PB-I-INSURED-LAST-NAME TO
 12213                         OC-INS-LAST-NAME
 12214                 MOVE PB-I-INSURED-FIRST-NAME TO
 12215                         OC-INS-FIRST-NAME
 12216                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 12217                         OC-INS-MIDDLE-INIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 223
* EL6311.cbl
 12218                 MOVE PB-I-AGE         TO OC-INS-AGE
 12219                 MOVE PB-I-JOINT-LAST-NAME   TO
 12220                         OC-JNT-LAST-NAME
 12221                 MOVE PB-I-JOINT-FIRST-NAME  TO
 12222                         OC-JNT-FIRST-NAME
 12223                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 12224                         OC-JNT-MIDDLE-INIT
 12225                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12226                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12227                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12228                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12229                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12230                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 12231                         OC-LF-ALT-BEN-AMT
 12232                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 12233                         OC-LF-ALT-PRM-AMT
 12234                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12235                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12236                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12237                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12238                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12239                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12240                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12241                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12242                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12243                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12244                 IF OC-CANCEL-TRAN-IND = 'N'
 12245                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 12246                    MOVE +0            TO OC-LF-CANCEL-AMT
 12247                                          OC-LF-ITD-CANCEL-AMT
 12248                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 12249                    MOVE +0            TO OC-AH-CANCEL-AMT
 12250                                          OC-AH-ITD-CANCEL-AMT
 12251                 END-IF
 12252                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12253                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12254                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12255                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12256                 IF ERMAIL-FOUND
 12257                    MOVE MA-CRED-BENE-NAME
 12258                                 TO OC-CRED-BENE-NAME
 12259                 END-IF
 12260                 IF NOT CERT-TRL-REC-NOT-FOUND
 12261                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12262                           OC-INS-AGE-DEFAULT-FLAG
 12263                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12264                           OC-JNT-AGE-DEFAULT-FLAG
 12265                 END-IF
 12266
 12267* EXEC CICS REWRITE
 12268*                   DATASET   ('ELCRTO')
 12269*                   FROM      (ORIGINAL-CERTIFICATE)
 12270*                   RESP      (WS-RESPONSE)
 12271*                END-EXEC
 12272     MOVE LENGTH OF
 12273      ORIGINAL-CERTIFICATE
 12274       TO DFHEIV11
 12275     MOVE 'ELCRTO' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 224
* EL6311.cbl
 12276*    MOVE '&& L                  %  N#00011762' TO DFHEIV0
 12277     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12278     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12279     MOVE X'204E233030303131373632' TO DFHEIV0(25:11)
 12280     CALL 'kxdfhei1' USING DFHEIV0,
 12281           DFHEIV1,
 12282           ORIGINAL-CERTIFICATE,
 12283           DFHEIV11,
 12284           DFHEIV99
 12285     MOVE EIBRESP  TO WS-RESPONSE
 12286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12287                 display ' just rewrote ' ws-response
 12288              END-IF
 12289           END-IF
 12290        ELSE
 12291           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12292           MOVE 'OC'             TO OC-RECORD-ID
 12293           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12294           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12295           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12296           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12297           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12298           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12299           MOVE PB-I-AGE         TO OC-INS-AGE
 12300           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12301           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12302           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12303           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12304           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12305           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12306           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12307           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12308           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12309           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12310           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12311           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12312           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12313           MOVE +0               TO OC-LF-CANCEL-AMT
 12314                                    OC-LF-ITD-CANCEL-AMT
 12315           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12316           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12317           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12318           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12319           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12320           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12321           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12322           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12323           MOVE +0               TO OC-AH-CANCEL-AMT
 12324                                    OC-AH-ITD-CANCEL-AMT
 12325           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12326           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12327           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12328           IF ERMAIL-FOUND
 12329              MOVE MA-CRED-BENE-NAME
 12330                                 TO OC-CRED-BENE-NAME
 12331           END-IF
 12332           IF NOT CERT-TRL-REC-NOT-FOUND
 12333              MOVE CS-INS-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 225
* EL6311.cbl
 12334                           OC-INS-AGE-DEFAULT-FLAG
 12335              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12336                           OC-JNT-AGE-DEFAULT-FLAG
 12337           END-IF
 12338           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12339
 12340* EXEC CICS WRITE
 12341*             DATASET   ('ELCRTO')
 12342*             FROM      (ORIGINAL-CERTIFICATE)
 12343*             RIDFLD    (OC-CONTROL-PRIMARY)
 12344*             RESP      (WS-RESPONSE)
 12345*          END-EXEC
 12346     MOVE LENGTH OF
 12347      ORIGINAL-CERTIFICATE
 12348       TO DFHEIV11
 12349     MOVE 'ELCRTO' TO DFHEIV1
 12350*    MOVE '&$ L                  ''  N#00011819' TO DFHEIV0
 12351     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12352     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12353     MOVE X'204E233030303131383139' TO DFHEIV0(25:11)
 12354     CALL 'kxdfhei1' USING DFHEIV0,
 12355           DFHEIV1,
 12356           ORIGINAL-CERTIFICATE,
 12357           DFHEIV11,
 12358           OC-CONTROL-PRIMARY,
 12359           DFHEIV99,
 12360           DFHEIV99
 12361     MOVE EIBRESP  TO WS-RESPONSE
 12362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12363        END-IF
 12364     ELSE
 12365        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12366        MOVE 'OC'                TO OC-RECORD-ID
 12367        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12368                                 TO OC-CONTROL-PRIMARY (1:33)
 12369        MOVE 'I'                 TO OC-RECORD-TYPE
 12370        MOVE +4096               TO OC-KEY-SEQ-NO
 12371        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12372        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12373        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12374        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12375        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12376        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12377        MOVE PB-I-AGE            TO OC-INS-AGE
 12378        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12379        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12380        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12381        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12382        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12383        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12384        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12385        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12386        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12387        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12388        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12389        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12390        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 12391        MOVE +0                  TO OC-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 226
* EL6311.cbl
 12392                                    OC-LF-ITD-CANCEL-AMT
 12393        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12394        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12395        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12396        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12397        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12398        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12399        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12400        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12401        MOVE +0                  TO OC-AH-CANCEL-AMT
 12402                                    OC-AH-ITD-CANCEL-AMT
 12403        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12404        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12405        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12406        IF ERMAIL-FOUND
 12407           MOVE MA-CRED-BENE-NAME
 12408                                 TO OC-CRED-BENE-NAME
 12409        END-IF
 12410        IF NOT CERT-TRL-REC-NOT-FOUND
 12411           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12412                           OC-INS-AGE-DEFAULT-FLAG
 12413           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12414                           OC-JNT-AGE-DEFAULT-FLAG
 12415        END-IF
 12416        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12417
 12418* EXEC CICS WRITE
 12419*          DATASET   ('ELCRTO')
 12420*          FROM      (ORIGINAL-CERTIFICATE)
 12421*          RIDFLD    (OC-CONTROL-PRIMARY)
 12422*          RESP      (WS-RESPONSE)
 12423*       END-EXEC
 12424     MOVE LENGTH OF
 12425      ORIGINAL-CERTIFICATE
 12426       TO DFHEIV11
 12427     MOVE 'ELCRTO' TO DFHEIV1
 12428*    MOVE '&$ L                  ''  N#00011879' TO DFHEIV0
 12429     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12430     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12431     MOVE X'204E233030303131383739' TO DFHEIV0(25:11)
 12432     CALL 'kxdfhei1' USING DFHEIV0,
 12433           DFHEIV1,
 12434           ORIGINAL-CERTIFICATE,
 12435           DFHEIV11,
 12436           OC-CONTROL-PRIMARY,
 12437           DFHEIV99,
 12438           DFHEIV99
 12439     MOVE EIBRESP  TO WS-RESPONSE
 12440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12441     END-IF
 12442******************************************************************
 12443*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12444******************************************************************
 12445
 12446     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12447     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12448
 12449
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 227
* EL6311.cbl
 12450* EXEC CICS READ
 12451*        INTO    (PENDING-BUSINESS)
 12452*        DATASET (FILE-ID-ERPNDB)
 12453*        RIDFLD  (ERPNDB-KEY)
 12454*        UPDATE
 12455*    END-EXEC.
 12456     MOVE LENGTH OF
 12457      PENDING-BUSINESS
 12458       TO DFHEIV11
 12459*    MOVE '&"IL       EU         (   #00011893' TO DFHEIV0
 12460     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12461     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12462     MOVE X'2020233030303131383933' TO DFHEIV0(25:11)
 12463     CALL 'kxdfhei1' USING DFHEIV0,
 12464           FILE-ID-ERPNDB,
 12465           PENDING-BUSINESS,
 12466           DFHEIV11,
 12467           ERPNDB-KEY,
 12468           DFHEIV99,
 12469           DFHEIV99,
 12470           DFHEIV99
 12471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12472
 12473
 12474     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12475     MOVE 'B'                    TO JP-RECORD-TYPE.
 12476     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12477
 12478     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12479
 12480     PERFORM 8400-LOG-JOURNAL-RECORD.
 12481
 12482     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12483
 12484     MOVE 'C'                    TO JP-RECORD-TYPE.
 12485     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12486
 12487
 12488* EXEC CICS REWRITE
 12489*        DATASET    (FILE-ID-ERPNDB)
 12490*        FROM       (PENDING-BUSINESS)
 12491*    END-EXEC.
 12492     MOVE LENGTH OF
 12493      PENDING-BUSINESS
 12494       TO DFHEIV11
 12495*    MOVE '&& L                  %   #00011913' TO DFHEIV0
 12496     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12497     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12498     MOVE X'2020233030303131393133' TO DFHEIV0(25:11)
 12499     CALL 'kxdfhei1' USING DFHEIV0,
 12500           FILE-ID-ERPNDB,
 12501           PENDING-BUSINESS,
 12502           DFHEIV11,
 12503           DFHEIV99
 12504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12505
 12506
 12507     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 228
* EL6311.cbl
 12508
 12509     IF WS-ERRORS-PRESENT
 12510        GO TO 3900-RE-DISPLAY-RECORD.
 12511
 12512     MOVE ZEROS                  TO EMI-ERROR.
 12513     MOVE -1                     TO BMAINTL.
 12514     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12515     GO TO 3900-RE-DISPLAY-RECORD.
 12516
 12517 1380-BATCH-HDR-NOT-FOUND.
 12518     MOVE -1                     TO BMAINTL.
 12519     MOVE ER-7450                TO EMI-ERROR.
 12520     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12521     GO TO 8200-SEND-DATAONLY.
 12522
 12523 1385-REC-NOT-FOUND.
 12524     MOVE -1                     TO BMAINTL.
 12525     MOVE ER-7451                TO EMI-ERROR.
 12526     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12527     GO TO 8200-SEND-DATAONLY.
 12528
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 229
* EL6311.cbl
 12530
 12531 1386-UPDATE-AGE-FLAGS.
 12532
 12533
 12534* EXEC CICS GETMAIN
 12535*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12536*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12537*        INITIMG (GETMAIN-SPACE)
 12538*    END-EXEC
 12539*    MOVE ',"IL                  $   #00011944' TO DFHEIV0
 12540     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12541     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12542     MOVE X'2020233030303131393434' TO DFHEIV0(25:11)
 12543     CALL 'kxdfhei1' USING DFHEIV0,
 12544           DFHEIV20,
 12545           ELCRTT-RECORD-LENGTH,
 12546           GETMAIN-SPACE
 12547     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12548         DFHEIV20
 12549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12550
 12551
 12552* EXEC CICS HANDLE CONDITION
 12553*        NOTFND   (1386-NOTFND)
 12554*    END-EXEC.
 12555*    MOVE '"$I                   ! ( #00011950' TO DFHEIV0
 12556     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12557     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12558     MOVE X'2820233030303131393530' TO DFHEIV0(25:11)
 12559     CALL 'kxdfhei1' USING DFHEIV0
 12560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12561
 12562
 12563     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12564     MOVE 'C'                TO ELCRTT-REC-TYPE
 12565
 12566
 12567* EXEC CICS READ
 12568*        UPDATE
 12569*        DATASET  (CRTT-ID)
 12570*        RIDFLD   (ELCRTT-KEY)
 12571*        INTO     (CERTIFICATE-TRAILERS)
 12572*    END-EXEC.
 12573     MOVE LENGTH OF
 12574      CERTIFICATE-TRAILERS
 12575       TO DFHEIV11
 12576*    MOVE '&"IL       EU         (   #00011957' TO DFHEIV0
 12577     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12578     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12579     MOVE X'2020233030303131393537' TO DFHEIV0(25:11)
 12580     CALL 'kxdfhei1' USING DFHEIV0,
 12581           CRTT-ID,
 12582           CERTIFICATE-TRAILERS,
 12583           DFHEIV11,
 12584           ELCRTT-KEY,
 12585           DFHEIV99,
 12586           DFHEIV99,
 12587           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 230
* EL6311.cbl
 12588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12589
 12590
 12591     IF WS-INS-AGE-SET = 'Y'
 12592        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12593     END-IF
 12594     IF WS-JNT-AGE-SET = 'Y'
 12595        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12596     END-IF
 12597
 12598
 12599* EXEC CICS REWRITE
 12600*       DATASET  (CRTT-ID)
 12601*       FROM     (CERTIFICATE-TRAILERS)
 12602*    END-EXEC.
 12603     MOVE LENGTH OF
 12604      CERTIFICATE-TRAILERS
 12605       TO DFHEIV11
 12606*    MOVE '&& L                  %   #00011971' TO DFHEIV0
 12607     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12608     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12609     MOVE X'2020233030303131393731' TO DFHEIV0(25:11)
 12610     CALL 'kxdfhei1' USING DFHEIV0,
 12611           CRTT-ID,
 12612           CERTIFICATE-TRAILERS,
 12613           DFHEIV11,
 12614           DFHEIV99
 12615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12616
 12617
 12618     GO TO 1386-EXIT.
 12619
 12620 1386-NOTFND.
 12621
 12622     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12623     MOVE 'CS'         TO CS-RECORD-ID.
 12624     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12625     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12626     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12627     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12628     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12629
 12630* EXEC CICS WRITE
 12631*       DATASET  (CRTT-ID)
 12632*       RIDFLD   (ELCRTT-KEY)
 12633*       FROM     (CERTIFICATE-TRAILERS)
 12634*    END-EXEC.
 12635     MOVE LENGTH OF
 12636      CERTIFICATE-TRAILERS
 12637       TO DFHEIV11
 12638*    MOVE '&$ L                  ''   #00011987' TO DFHEIV0
 12639     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12640     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12641     MOVE X'2020233030303131393837' TO DFHEIV0(25:11)
 12642     CALL 'kxdfhei1' USING DFHEIV0,
 12643           CRTT-ID,
 12644           CERTIFICATE-TRAILERS,
 12645           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 231
* EL6311.cbl
 12646           ELCRTT-KEY,
 12647           DFHEIV99,
 12648           DFHEIV99
 12649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12650
 12651
 12652 1386-EXIT.
 12653     EXIT.
 12654
 12655 1390-UPDATE-ERPNDM.
 12656
 12657
 12658* EXEC CICS HANDLE CONDITION
 12659*        NOTFND (1399-EXIT)
 12660*    END-EXEC.
 12661*    MOVE '"$I                   ! ) #00011998' TO DFHEIV0
 12662     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12664     MOVE X'2920233030303131393938' TO DFHEIV0(25:11)
 12665     CALL 'kxdfhei1' USING DFHEIV0
 12666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12667
 12668
 12669     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12670
 12671
 12672* EXEC CICS READ
 12673*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12674*        DATASET (FILE-ID-ERPNDM)
 12675*        RIDFLD  (ERPNDM-KEY)
 12676*        UPDATE
 12677*    END-EXEC.
 12678*    MOVE '&"S        EU         (   #00012004' TO DFHEIV0
 12679     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12680     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12681     MOVE X'2020233030303132303034' TO DFHEIV0(25:11)
 12682     CALL 'kxdfhei1' USING DFHEIV0,
 12683           FILE-ID-ERPNDM,
 12684           DFHEIV20,
 12685           DFHEIV99,
 12686           ERPNDM-KEY,
 12687           DFHEIV99,
 12688           DFHEIV99,
 12689           DFHEIV99
 12690     SET ADDRESS OF PENDING-MAILING-DATA TO
 12691         DFHEIV20
 12692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12693
 12694
 12695     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12696     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12697     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12698
 12699     IF BLSTNML GREATER THAN ZEROS
 12700         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12701
 12702     IF B1STNML GREATER  THAN ZEROS
 12703         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 232
* EL6311.cbl
 12704
 12705     IF BINITL GREATER THAN ZEROS
 12706         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12707
 12708     IF BAGEL GREATER THAN ZEROS
 12709         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12710
 12711     IF BBIRTHL GREATER THAN ZEROS
 12712         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12713
 12714     IF BSEXL GREATER THAN ZEROS
 12715         MOVE  BSEXI             TO PM-INSURED-SEX.
 12716
 12717
 12718* EXEC CICS REWRITE
 12719*        DATASET (FILE-ID-ERPNDM)
 12720*        FROM    (PENDING-MAILING-DATA)
 12721*    END-EXEC.
 12722     MOVE LENGTH OF
 12723      PENDING-MAILING-DATA
 12724       TO DFHEIV11
 12725*    MOVE '&& L                  %   #00012033' TO DFHEIV0
 12726     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12727     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12728     MOVE X'2020233030303132303333' TO DFHEIV0(25:11)
 12729     CALL 'kxdfhei1' USING DFHEIV0,
 12730           FILE-ID-ERPNDM,
 12731           PENDING-MAILING-DATA,
 12732           DFHEIV11,
 12733           DFHEIV99
 12734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12735
 12736
 12737 1399-EXIT.
 12738     EXIT.
 12739 139A-SET-LETTER-REQD.
 12740*  COMPARE BEFORE AND AFTER CHANGE
 12741     IF PB-ISSUE-RECORD = WS-SAVE-PEND-ISSUE
 12742        GO TO 139A-EXIT
 12743     END-IF
 12744
 12745*  READ ELCRTO
 12746     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12747                                 TO ELCRTO-KEY
 12748     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12749     MOVE +0                     TO ELCRTO-SEQ-NO
 12750
 12751
 12752* EXEC CICS READ
 12753*       DATASET   ('ELCRTO')
 12754*       INTO      (ORIGINAL-CERTIFICATE)
 12755*       RIDFLD    (ELCRTO-KEY)
 12756*       GTEQ
 12757*       RESP      (WS-RESPONSE)
 12758*    END-EXEC
 12759     MOVE LENGTH OF
 12760      ORIGINAL-CERTIFICATE
 12761       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 233
* EL6311.cbl
 12762     MOVE 'ELCRTO' TO DFHEIV1
 12763*    MOVE '&"IL       G          (  N#00012052' TO DFHEIV0
 12764     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12765     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12766     MOVE X'204E233030303132303532' TO DFHEIV0(25:11)
 12767     CALL 'kxdfhei1' USING DFHEIV0,
 12768           DFHEIV1,
 12769           ORIGINAL-CERTIFICATE,
 12770           DFHEIV11,
 12771           ELCRTO-KEY,
 12772           DFHEIV99,
 12773           DFHEIV99,
 12774           DFHEIV99
 12775     MOVE EIBRESP  TO WS-RESPONSE
 12776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12777
 12778*    display ' just read gteq ' ws-response
 12779     IF RESP-NORMAL
 12780        AND (OC-CONTROL-PRIMARY (1:33) =
 12781                 PB-CONTROL-BY-ACCOUNT (1:33))
 12782        AND (OC-RECORD-TYPE = 'I')
 12783*      compare individual fields
 12784        IF LETRREQL   GREATER THAN ZEROS
 12785           CONTINUE
 12786        ELSE
 12787        IF OC-CERT-NO = PB-CERT-NO
 12788          AND OC-CERT-EFF-DT = PB-CERT-EFF-DT
 12789          AND OC-INS-LAST-NAME = PB-I-INSURED-LAST-NAME
 12790          AND OC-INS-FIRST-NAME = PB-I-INSURED-FIRST-NAME
 12791          AND OC-INS-MIDDLE-INIT =  PB-I-INSURED-MIDDLE-INIT
 12792          AND OC-INS-AGE = PB-I-AGE
 12793          AND OC-LF-BENCD = PB-I-LIFE-BENEFIT-CD
 12794          AND OC-LF-TERM = PB-I-LF-TERM
 12795          AND OC-LF-BEN-AMT = PB-I-LF-BENEFIT-AMT
 12796          AND OC-LF-PRM-AMT = PB-I-LF-PREMIUM-AMT
 12797          AND OC-LF-EXP-DT = PB-I-LF-EXPIRE-DT
 12798          AND OC-LF-ALT-BEN-AMT = PB-I-LF-ALT-BENEFIT-AMT
 12799          AND PB-I-LF-ALT-PREMIUM-AMT = OC-LF-ALT-PRM-AMT
 12800          AND PB-I-LF-EXPIRE-DT = OC-LF-EXP-DT
 12801          AND PB-I-AH-BENEFIT-CD     = OC-AH-BENCD
 12802          AND PB-I-AH-TERM           = OC-AH-TERM
 12803          AND PB-I-AH-BENEFIT-AMT    = OC-AH-BEN-AMT
 12804          AND PB-I-AH-PREMIUM-AMT    = OC-AH-PRM-AMT
 12805          AND PB-I-AH-EXPIRE-DT      = OC-AH-EXP-DT
 12806          AND PB-I-AH-COMMISSION     = OC-AH-COMM-PCT
 12807          AND PB-I-AH-CRIT-PER       = OC-AH-CP
 12808           MOVE SPACE TO PB-I-LETTER-REQD
 12809        ELSE
 12810           MOVE 'Y' TO PB-I-LETTER-REQD
 12811        END-IF
 12812     END-IF.
 12813
 12814 139A-EXIT.
 12815     EXIT.
 12816
 12817******************************************************************
 12818*                                                                *
 12819*          D E L E T E   I S S U E   R O U T I N E               *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 234
* EL6311.cbl
 12820*                                                                *
 12821******************************************************************
 12822
 12823 1400-DELETE-ISSUE-ROUTINE.
 12824     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12825
 12826     IF BCHGL NOT = ZEROS
 12827        MOVE ER-2196             TO EMI-ERROR
 12828        MOVE AL-UABON            TO BMAINTA
 12829        MOVE -1                  TO BMAINTL
 12830        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12831        GO TO 8200-SEND-DATAONLY.
 12832
 12833
 12834* EXEC CICS HANDLE CONDITION
 12835*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12836*    END-EXEC.
 12837*    MOVE '"$I                   ! * #00012115' TO DFHEIV0
 12838     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12839     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12840     MOVE X'2A20233030303132313135' TO DFHEIV0(25:11)
 12841     CALL 'kxdfhei1' USING DFHEIV0
 12842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12843
 12844
 12845     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12846     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12847     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12848
 12849
 12850* EXEC CICS READ
 12851*        SET     (ADDRESS OF PENDING-BUSINESS)
 12852*        DATASET (FILE-ID-ERPNDB)
 12853*        RIDFLD  (ERPNDB-KEY)
 12854*    END-EXEC.
 12855*    MOVE '&"S        E          (   #00012123' TO DFHEIV0
 12856     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12857     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12858     MOVE X'2020233030303132313233' TO DFHEIV0(25:11)
 12859     CALL 'kxdfhei1' USING DFHEIV0,
 12860           FILE-ID-ERPNDB,
 12861           DFHEIV20,
 12862           DFHEIV99,
 12863           ERPNDB-KEY,
 12864           DFHEIV99,
 12865           DFHEIV99,
 12866           DFHEIV99
 12867     SET ADDRESS OF PENDING-BUSINESS TO
 12868         DFHEIV20
 12869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12870
 12871
 12872     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12873
 12874     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12875
 12876     IF BSUFIXL NOT = ZEROS
 12877        MOVE BSUFIXI             TO WS-NEW-SUFFIX
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 235
* EL6311.cbl
 12878     ELSE
 12879        MOVE SPACE               TO WS-NEW-SUFFIX.
 12880
 12881     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12882     PERFORM 8600-DEEDIT.
 12883     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12884     MOVE '4'                    TO DC-OPTION-CODE.
 12885     PERFORM 9700-DATE-LINK.
 12886     IF DATE-CONVERSION-ERROR
 12887        MOVE ER-0348             TO EMI-ERROR
 12888        MOVE -1                  TO BEFFDTL
 12889        MOVE AL-UABON            TO BEFFDTA
 12890        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12891        GO TO 8200-SEND-DATAONLY
 12892     ELSE
 12893        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12894        MOVE AL-UANON            TO BEFFDTA
 12895        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12896
 12897
 12898* EXEC CICS HANDLE CONDITION
 12899*         NOTFND    (1490-RECORD-NOT-FOUND)
 12900*    END-EXEC.
 12901*    MOVE '"$I                   ! + #00012154' TO DFHEIV0
 12902     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12903     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12904     MOVE X'2B20233030303132313534' TO DFHEIV0(25:11)
 12905     CALL 'kxdfhei1' USING DFHEIV0
 12906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12907
 12908
 12909
 12910* EXEC CICS READ
 12911*        SET     (ADDRESS OF PENDING-BUSINESS)
 12912*        DATASET (FILE-ID-ERPNDB)
 12913*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12914*        UPDATE
 12915*    END-EXEC.
 12916*    MOVE '&"S        EU         (   #00012158' TO DFHEIV0
 12917     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12918     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12919     MOVE X'2020233030303132313538' TO DFHEIV0(25:11)
 12920     CALL 'kxdfhei1' USING DFHEIV0,
 12921           FILE-ID-ERPNDB,
 12922           DFHEIV20,
 12923           DFHEIV99,
 12924           PI-PREV-CONTROL-PRIMARY,
 12925           DFHEIV99,
 12926           DFHEIV99,
 12927           DFHEIV99
 12928     SET ADDRESS OF PENDING-BUSINESS TO
 12929         DFHEIV20
 12930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12931
 12932
 12933     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12934        MOVE -1                 TO BMAINTL
 12935        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 236
* EL6311.cbl
 12936        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12937        GO TO 8200-SEND-DATAONLY.
 12938
 12939     IF PB-BILLED-DT NOT = LOW-VALUES
 12940        MOVE -1                 TO BMAINTL
 12941        MOVE ER-2129            TO EMI-ERROR
 12942        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12943        GO TO 8200-SEND-DATAONLY.
 12944
 12945     IF PB-CHG-COUNT NOT = ZEROS
 12946        MOVE ER-2336            TO EMI-ERROR
 12947        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12948        MOVE AL-UABON            TO BMAINTA
 12949        MOVE -1                  TO BMAINTL
 12950        GO TO 8200-SEND-DATAONLY.
 12951
 12952     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12953        PB-CHG-COUNT NOT = ZEROS
 12954        MOVE ER-2196             TO EMI-ERROR
 12955        MOVE AL-UABON            TO BMAINTA
 12956        MOVE -1                  TO BMAINTL
 12957        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12958        GO TO 8200-SEND-DATAONLY.
 12959******************************************************************
 12960*                                                                *
 12961*       Determine if there have been any checks created          *
 12962*                                                                *
 12963******************************************************************
 12964
 12965     perform 2500-browse-checks  thru 2500-exit
 12966
 12967     if i-have-processed-checks
 12968        or i-have-checks
 12969        or i-have-a-check-period
 12970        move er-3446             to emi-error
 12971        perform 9900-error-format thru 9900-exit
 12972        move al-uabon            to bmainta
 12973        move -1                  to bmaintl
 12974        go to 8200-send-dataonly
 12975     end-if
 12976******************************************************************
 12977*                                                                *
 12978*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12979*                                                                *
 12980******************************************************************
 12981     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12982     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12983     MOVE +0                     TO ELCRTO-SEQ-NO
 12984
 12985* EXEC CICS READ
 12986*       DATASET   ('ELCRTO')
 12987*       INTO      (ORIGINAL-CERTIFICATE)
 12988*       RIDFLD    (ELCRTO-KEY)
 12989*       GTEQ
 12990*       RESP      (WS-RESPONSE)
 12991*    END-EXEC
 12992     MOVE LENGTH OF
 12993      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 237
* EL6311.cbl
 12994       TO DFHEIV11
 12995     MOVE 'ELCRTO' TO DFHEIV1
 12996*    MOVE '&"IL       G          (  N#00012216' TO DFHEIV0
 12997     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12998     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12999     MOVE X'204E233030303132323136' TO DFHEIV0(25:11)
 13000     CALL 'kxdfhei1' USING DFHEIV0,
 13001           DFHEIV1,
 13002           ORIGINAL-CERTIFICATE,
 13003           DFHEIV11,
 13004           ELCRTO-KEY,
 13005           DFHEIV99,
 13006           DFHEIV99,
 13007           DFHEIV99
 13008     MOVE EIBRESP  TO WS-RESPONSE
 13009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13010     IF RESP-NORMAL
 13011        AND (OC-CONTROL-PRIMARY (1:33) =
 13012                 PB-CONTROL-BY-ACCOUNT (1:33))
 13013        AND (OC-RECORD-TYPE = 'I')
 13014
 13015* EXEC CICS READ
 13016*          DATASET   ('ELCRTO')
 13017*          INTO      (ORIGINAL-CERTIFICATE)
 13018*          RIDFLD    (ELCRTO-KEY)
 13019*          UPDATE
 13020*          RESP      (WS-RESPONSE)
 13021*       END-EXEC
 13022     MOVE LENGTH OF
 13023      ORIGINAL-CERTIFICATE
 13024       TO DFHEIV11
 13025     MOVE 'ELCRTO' TO DFHEIV1
 13026*    MOVE '&"IL       EU         (  N#00012227' TO DFHEIV0
 13027     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13028     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13029     MOVE X'204E233030303132323237' TO DFHEIV0(25:11)
 13030     CALL 'kxdfhei1' USING DFHEIV0,
 13031           DFHEIV1,
 13032           ORIGINAL-CERTIFICATE,
 13033           DFHEIV11,
 13034           ELCRTO-KEY,
 13035           DFHEIV99,
 13036           DFHEIV99,
 13037           DFHEIV99
 13038     MOVE EIBRESP  TO WS-RESPONSE
 13039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13040        IF RESP-NORMAL
 13041
 13042* EXEC CICS DELETE
 13043*             DATASET   ('ELCRTO')
 13044*          END-EXEC
 13045     MOVE 'ELCRTO' TO DFHEIV1
 13046*    MOVE '&(                    &   #00012235' TO DFHEIV0
 13047     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13048     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13049     MOVE X'2020233030303132323335' TO DFHEIV0(25:11)
 13050     CALL 'kxdfhei1' USING DFHEIV0,
 13051           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 238
* EL6311.cbl
 13052           DFHEIV99,
 13053           DFHEIV99,
 13054           DFHEIV99,
 13055           DFHEIV99
 13056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13057        END-IF
 13058     END-IF
 13059******************************************************************
 13060*                                                                *
 13061*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 13062*                                                                *
 13063******************************************************************
 13064
 13065* EXEC CICS HANDLE CONDITION
 13066*        NOTFND    (1405-DELETE-CERTIFICATE)
 13067*    END-EXEC.
 13068*    MOVE '"$I                   ! , #00012245' TO DFHEIV0
 13069     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13070     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13071     MOVE X'2C20233030303132323435' TO DFHEIV0(25:11)
 13072     CALL 'kxdfhei1' USING DFHEIV0
 13073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13074
 13075
 13076
 13077* EXEC CICS READ
 13078*        EQUAL
 13079*        DATASET   (FILE-ID-ERPNDM)
 13080*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 13081*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 13082*        UPDATE
 13083*    END-EXEC.
 13084*    MOVE '&"S        EU         (   #00012249' TO DFHEIV0
 13085     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13086     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13087     MOVE X'2020233030303132323439' TO DFHEIV0(25:11)
 13088     CALL 'kxdfhei1' USING DFHEIV0,
 13089           FILE-ID-ERPNDM,
 13090           DFHEIV20,
 13091           DFHEIV99,
 13092           PI-PREV-CONTROL-PRIMARY,
 13093           DFHEIV99,
 13094           DFHEIV99,
 13095           DFHEIV99
 13096     SET ADDRESS OF PENDING-MAILING-DATA TO
 13097         DFHEIV20
 13098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13099
 13100
 13101     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 13102     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13103     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 13104
 13105     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13106
 13107
 13108* EXEC CICS DELETE
 13109*        DATASET   (FILE-ID-ERPNDM)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 239
* EL6311.cbl
 13110*    END-EXEC.
 13111*    MOVE '&(                    &   #00012263' TO DFHEIV0
 13112     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13113     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13114     MOVE X'2020233030303132323633' TO DFHEIV0(25:11)
 13115     CALL 'kxdfhei1' USING DFHEIV0,
 13116           FILE-ID-ERPNDM,
 13117           DFHEIV99,
 13118           DFHEIV99,
 13119           DFHEIV99,
 13120           DFHEIV99
 13121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13122
 13123
 13124******************************************************************
 13125*                PROCESS   CERTIFICATE                           *
 13126******************************************************************
 13127
 13128 1405-DELETE-CERTIFICATE.
 13129
 13130* EXEC CICS HANDLE CONDITION
 13131*         NOTFND  (1420-CONTINUE-DELETE)
 13132*    END-EXEC.
 13133*    MOVE '"$I                   ! - #00012272' TO DFHEIV0
 13134     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13135     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13136     MOVE X'2D20233030303132323732' TO DFHEIV0(25:11)
 13137     CALL 'kxdfhei1' USING DFHEIV0
 13138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13139
 13140
 13141     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 13142     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 13143     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 13144     MOVE PB-SV-STATE            TO ELCERT-STATE.
 13145
 13146
 13147* EXEC CICS READ
 13148*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13149*        DATASET (FILE-ID-ELCERT)
 13150*        RIDFLD  (ELCERT-KEY)
 13151*        UPDATE
 13152*    END-EXEC.
 13153*    MOVE '&"S        EU         (   #00012281' TO DFHEIV0
 13154     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13155     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13156     MOVE X'2020233030303132323831' TO DFHEIV0(25:11)
 13157     CALL 'kxdfhei1' USING DFHEIV0,
 13158           FILE-ID-ELCERT,
 13159           DFHEIV20,
 13160           DFHEIV99,
 13161           ELCERT-KEY,
 13162           DFHEIV99,
 13163           DFHEIV99,
 13164           DFHEIV99
 13165     SET ADDRESS OF CERTIFICATE-MASTER TO
 13166         DFHEIV20
 13167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 240
* EL6311.cbl
 13168
 13169
 13170     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13171
 13172     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 13173     MOVE 'B'                    TO JP-RECORD-TYPE
 13174     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 13175
 13176     PERFORM 8400-LOG-JOURNAL-RECORD.
 13177
 13178     IF CERT-NOTES-ARE-NOT-PRESENT
 13179        MOVE ' '                 TO WS-CERT-NOTE-SW
 13180     ELSE
 13181        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 13182
 13183     IF INSURED-ADDR-PRESENT
 13184        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 13185
 13186******************************************************************
 13187******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 13188******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 13189******************************************************************
 13190******************************************************************
 13191
 13192     IF CERT-ADDED-BATCH AND
 13193        (NOT NO-CLAIM-ATTACHED
 13194         OR
 13195         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 13196        GO TO 1410-REWRITE-CERT.
 13197
 13198******************************************************************
 13199******************************************************************
 13200
 13201     IF CERT-ADDED-BATCH  AND
 13202        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 13203        GO TO 1410-REWRITE-CERT.
 13204
 13205     IF NO-CLAIM-ATTACHED
 13206        NEXT SENTENCE
 13207     ELSE
 13208        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 13209        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 13210        GO TO 1410-REWRITE-CERT.
 13211
 13212     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13213     MOVE 'D'                      TO JP-RECORD-TYPE.
 13214     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13215
 13216
 13217* EXEC CICS DELETE
 13218*         DATASET    (FILE-ID-ELCERT)
 13219*    END-EXEC.
 13220*    MOVE '&(                    &   #00012334' TO DFHEIV0
 13221     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13222     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13223     MOVE X'2020233030303132333334' TO DFHEIV0(25:11)
 13224     CALL 'kxdfhei1' USING DFHEIV0,
 13225           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 241
* EL6311.cbl
 13226           DFHEIV99,
 13227           DFHEIV99,
 13228           DFHEIV99,
 13229           DFHEIV99
 13230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13231
 13232
 13233     PERFORM 8400-LOG-JOURNAL-RECORD.
 13234
 13235******************************************************************
 13236*                                                                *
 13237*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 13238*                                                                *
 13239******************************************************************
 13240
 13241     IF  CERT-NOTES-ARE-PRESENT
 13242         NEXT SENTENCE
 13243     ELSE
 13244         GO TO 1407-DELETE-MAILING.
 13245
 13246
 13247* EXEC CICS HANDLE CONDITION
 13248*         NOTFND  (1406-DELETE-ERNOTE)
 13249*    END-EXEC.
 13250*    MOVE '"$I                   ! . #00012351' TO DFHEIV0
 13251     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13252     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13253     MOVE X'2E20233030303132333531' TO DFHEIV0(25:11)
 13254     CALL 'kxdfhei1' USING DFHEIV0
 13255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13256
 13257
 13258     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 13259     MOVE '0'                   TO ERCNOT-REC-TYPE.
 13260     MOVE 0                     TO ERCNOT-SEQUENCE.
 13261
 13262 1406-DELETE-ERCNOT-LOOP.
 13263
 13264
 13265* EXEC CICS READ
 13266*        GTEQ
 13267*        DATASET   (FILE-ID-ERCNOT)
 13268*        SET       (ADDRESS OF CERT-NOTE-FILE)
 13269*        RIDFLD    (ERCNOT-KEY)
 13270*    END-EXEC.
 13271*    MOVE '&"S        G          (   #00012361' TO DFHEIV0
 13272     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13273     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13274     MOVE X'2020233030303132333631' TO DFHEIV0(25:11)
 13275     CALL 'kxdfhei1' USING DFHEIV0,
 13276           FILE-ID-ERCNOT,
 13277           DFHEIV20,
 13278           DFHEIV99,
 13279           ERCNOT-KEY,
 13280           DFHEIV99,
 13281           DFHEIV99,
 13282           DFHEIV99
 13283     SET ADDRESS OF CERT-NOTE-FILE TO
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 242
* EL6311.cbl
 13284         DFHEIV20
 13285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13286
 13287
 13288     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 13289     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 13290         GO TO 1406-DELETE-ERNOTE
 13291     END-IF.
 13292
 13293     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 13294     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13295     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 13296
 13297     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13298
 13299
 13300* EXEC CICS DELETE
 13301*        DATASET   (FILE-ID-ERCNOT)
 13302*        RIDFLD    (ERCNOT-KEY)
 13303*        END-EXEC.
 13304*    MOVE '&(  R                 &   #00012379' TO DFHEIV0
 13305     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13306     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13307     MOVE X'2020233030303132333739' TO DFHEIV0(25:11)
 13308     CALL 'kxdfhei1' USING DFHEIV0,
 13309           FILE-ID-ERCNOT,
 13310           ERCNOT-KEY,
 13311           DFHEIV99,
 13312           DFHEIV99,
 13313           DFHEIV99
 13314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13315
 13316
 13317     PERFORM 8400-LOG-JOURNAL-RECORD.
 13318
 13319     GO TO 1406-DELETE-ERCNOT-LOOP.
 13320
 13321 1406-DELETE-ERNOTE.
 13322
 13323
 13324* EXEC CICS HANDLE CONDITION
 13325*         NOTFND  (1407-DELETE-MAILING)
 13326*    END-EXEC.
 13327*    MOVE '"$I                   ! / #00012390' TO DFHEIV0
 13328     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13329     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13330     MOVE X'2F20233030303132333930' TO DFHEIV0(25:11)
 13331     CALL 'kxdfhei1' USING DFHEIV0
 13332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13333
 13334
 13335
 13336* EXEC CICS READ
 13337*        EQUAL
 13338*        DATASET   (FILE-ID-ERNOTE)
 13339*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13340*        RIDFLD    (ELCERT-KEY)
 13341*        UPDATE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 243
* EL6311.cbl
 13342*    END-EXEC.
 13343*    MOVE '&"S        EU         (   #00012394' TO DFHEIV0
 13344     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13345     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13346     MOVE X'2020233030303132333934' TO DFHEIV0(25:11)
 13347     CALL 'kxdfhei1' USING DFHEIV0,
 13348           FILE-ID-ERNOTE,
 13349           DFHEIV20,
 13350           DFHEIV99,
 13351           ELCERT-KEY,
 13352           DFHEIV99,
 13353           DFHEIV99,
 13354           DFHEIV99
 13355     SET ADDRESS OF CERTIFICATE-NOTE TO
 13356         DFHEIV20
 13357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13358
 13359
 13360     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 13361     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13362     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13363
 13364     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13365
 13366
 13367* EXEC CICS DELETE
 13368*        DATASET   (FILE-ID-ERNOTE)
 13369*        END-EXEC.
 13370*    MOVE '&(                    &   #00012408' TO DFHEIV0
 13371     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13372     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13373     MOVE X'2020233030303132343038' TO DFHEIV0(25:11)
 13374     CALL 'kxdfhei1' USING DFHEIV0,
 13375           FILE-ID-ERNOTE,
 13376           DFHEIV99,
 13377           DFHEIV99,
 13378           DFHEIV99,
 13379           DFHEIV99
 13380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13381
 13382
 13383     PERFORM 8400-LOG-JOURNAL-RECORD.
 13384
 13385******************************************************************
 13386*                                                                *
 13387*                DELETE MAILING ADDRESS RECORDS                  *
 13388*                                                                *
 13389******************************************************************
 13390
 13391 1407-DELETE-MAILING.
 13392     IF CERT-ADDRESS-PRESENT
 13393        NEXT SENTENCE
 13394     ELSE
 13395        GO TO 1420-CONTINUE-DELETE.
 13396
 13397
 13398* EXEC CICS HANDLE CONDITION
 13399*         NOTFND  (1420-CONTINUE-DELETE)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 244
* EL6311.cbl
 13400*    END-EXEC.
 13401*    MOVE '"$I                   ! 0 #00012426' TO DFHEIV0
 13402     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13403     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13404     MOVE X'3020233030303132343236' TO DFHEIV0(25:11)
 13405     CALL 'kxdfhei1' USING DFHEIV0
 13406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13407
 13408
 13409
 13410* EXEC CICS READ
 13411*        EQUAL
 13412*        DATASET   (FILE-ID-ERMAIL)
 13413*        SET       (ADDRESS OF MAILING-DATA)
 13414*        RIDFLD    (ELCERT-KEY)
 13415*        UPDATE
 13416*    END-EXEC.
 13417*    MOVE '&"S        EU         (   #00012430' TO DFHEIV0
 13418     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13419     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13420     MOVE X'2020233030303132343330' TO DFHEIV0(25:11)
 13421     CALL 'kxdfhei1' USING DFHEIV0,
 13422           FILE-ID-ERMAIL,
 13423           DFHEIV20,
 13424           DFHEIV99,
 13425           ELCERT-KEY,
 13426           DFHEIV99,
 13427           DFHEIV99,
 13428           DFHEIV99
 13429     SET ADDRESS OF MAILING-DATA TO
 13430         DFHEIV20
 13431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13432
 13433
 13434     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13435     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13436     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13437
 13438     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13439
 13440
 13441* EXEC CICS DELETE
 13442*        DATASET   (FILE-ID-ERMAIL)
 13443*    END-EXEC.
 13444*    MOVE '&(                    &   #00012444' TO DFHEIV0
 13445     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13446     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13447     MOVE X'2020233030303132343434' TO DFHEIV0(25:11)
 13448     CALL 'kxdfhei1' USING DFHEIV0,
 13449           FILE-ID-ERMAIL,
 13450           DFHEIV99,
 13451           DFHEIV99,
 13452           DFHEIV99,
 13453           DFHEIV99
 13454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13455
 13456
 13457     GO TO 1420-CONTINUE-DELETE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 245
* EL6311.cbl
 13458
 13459 1410-REWRITE-CERT.
 13460     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13461     MOVE 'C'                      TO JP-RECORD-TYPE.
 13462     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13463     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13464
 13465
 13466* EXEC CICS REWRITE
 13467*         DATASET    (FILE-ID-ELCERT)
 13468*         FROM       (CERTIFICATE-MASTER)
 13469*         END-EXEC.
 13470     MOVE LENGTH OF
 13471      CERTIFICATE-MASTER
 13472       TO DFHEIV11
 13473*    MOVE '&& L                  %   #00012456' TO DFHEIV0
 13474     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13475     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13476     MOVE X'2020233030303132343536' TO DFHEIV0(25:11)
 13477     CALL 'kxdfhei1' USING DFHEIV0,
 13478           FILE-ID-ELCERT,
 13479           CERTIFICATE-MASTER,
 13480           DFHEIV11,
 13481           DFHEIV99
 13482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13483
 13484
 13485     PERFORM 8400-LOG-JOURNAL-RECORD.
 13486
 13487 1420-CONTINUE-DELETE.
 13488     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13489     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13490
 13491     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13492     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13493
 13494     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13495
 13496 1450-DELETE-PB-RECORD.
 13497     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13498     MOVE 'D'                      TO JP-RECORD-TYPE
 13499     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13500
 13501
 13502* EXEC CICS DELETE
 13503*        DATASET    (FILE-ID-ERPNDB)
 13504*    END-EXEC.
 13505*    MOVE '&(                    &   #00012477' TO DFHEIV0
 13506     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13507     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13508     MOVE X'2020233030303132343737' TO DFHEIV0(25:11)
 13509     CALL 'kxdfhei1' USING DFHEIV0,
 13510           FILE-ID-ERPNDB,
 13511           DFHEIV99,
 13512           DFHEIV99,
 13513           DFHEIV99,
 13514           DFHEIV99
 13515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 246
* EL6311.cbl
 13516
 13517
 13518     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13519
 13520     PERFORM 8400-LOG-JOURNAL-RECORD.
 13521
 13522     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13523     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13524     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13525
 13526
 13527* EXEC CICS HANDLE CONDITION
 13528*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13529*    END-EXEC.
 13530*    MOVE '"$I                   ! 1 #00012489' TO DFHEIV0
 13531     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13532     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13533     MOVE X'3120233030303132343839' TO DFHEIV0(25:11)
 13534     CALL 'kxdfhei1' USING DFHEIV0
 13535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13536
 13537
 13538
 13539* EXEC CICS READ
 13540*        SET     (ADDRESS OF PENDING-BUSINESS)
 13541*        DATASET (FILE-ID-ERPNDB)
 13542*        RIDFLD  (ERPNDB-KEY)
 13543*        UPDATE
 13544*    END-EXEC.
 13545*    MOVE '&"S        EU         (   #00012493' TO DFHEIV0
 13546     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13547     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13548     MOVE X'2020233030303132343933' TO DFHEIV0(25:11)
 13549     CALL 'kxdfhei1' USING DFHEIV0,
 13550           FILE-ID-ERPNDB,
 13551           DFHEIV20,
 13552           DFHEIV99,
 13553           ERPNDB-KEY,
 13554           DFHEIV99,
 13555           DFHEIV99,
 13556           DFHEIV99
 13557     SET ADDRESS OF PENDING-BUSINESS TO
 13558         DFHEIV20
 13559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13560
 13561
 13562     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13563
 13564     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13565
 13566     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13567        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13568        MOVE 'D'                   TO JP-RECORD-TYPE
 13569        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13570
 13571* EXEC CICS DELETE
 13572*            DATASET    (FILE-ID-ERPNDB)
 13573*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 247
* EL6311.cbl
 13574*    MOVE '&(                    &   #00012508' TO DFHEIV0
 13575     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13576     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13577     MOVE X'2020233030303132353038' TO DFHEIV0(25:11)
 13578     CALL 'kxdfhei1' USING DFHEIV0,
 13579           FILE-ID-ERPNDB,
 13580           DFHEIV99,
 13581           DFHEIV99,
 13582           DFHEIV99,
 13583           DFHEIV99
 13584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13585        PERFORM 8400-LOG-JOURNAL-RECORD
 13586     ELSE
 13587        MOVE 'B'                 TO JP-RECORD-TYPE
 13588        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13589        PERFORM 8400-LOG-JOURNAL-RECORD
 13590        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13591        MOVE 'C'                 TO JP-RECORD-TYPE
 13592        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13593
 13594* EXEC CICS REWRITE
 13595*            DATASET    (FILE-ID-ERPNDB)
 13596*            FROM       (PENDING-BUSINESS)
 13597*       END-EXEC
 13598     MOVE LENGTH OF
 13599      PENDING-BUSINESS
 13600       TO DFHEIV11
 13601*    MOVE '&& L                  %   #00012519' TO DFHEIV0
 13602     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13603     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13604     MOVE X'2020233030303132353139' TO DFHEIV0(25:11)
 13605     CALL 'kxdfhei1' USING DFHEIV0,
 13606           FILE-ID-ERPNDB,
 13607           PENDING-BUSINESS,
 13608           DFHEIV11,
 13609           DFHEIV99
 13610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13611        PERFORM 8400-LOG-JOURNAL-RECORD.
 13612
 13613******************************************************************
 13614*                                                                *
 13615*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13616*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13617*                                                                *
 13618******************************************************************
 13619
 13620     IF NOT PI-AR-PROCESSING
 13621        GO TO 1475-DELETE-FINISHED.
 13622
 13623     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13624        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13625        NEXT SENTENCE
 13626     ELSE
 13627        GO TO 1475-DELETE-FINISHED.
 13628
 13629
 13630* EXEC CICS HANDLE CONDITION
 13631*         NOTFND    (1475-DELETE-FINISHED)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 248
* EL6311.cbl
 13632*         END-EXEC.
 13633*    MOVE '"$I                   ! 2 #00012541' TO DFHEIV0
 13634     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13635     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13636     MOVE X'3220233030303132353431' TO DFHEIV0(25:11)
 13637     CALL 'kxdfhei1' USING DFHEIV0
 13638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13639
 13640
 13641     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13642     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13643
 13644
 13645* EXEC CICS READ
 13646*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13647*        DATASET (FILE-ID-ERRQST)
 13648*        RIDFLD  (ERRQST-KEY)
 13649*        UPDATE
 13650*    END-EXEC.
 13651*    MOVE '&"S        EU         (   #00012548' TO DFHEIV0
 13652     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13653     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13654     MOVE X'2020233030303132353438' TO DFHEIV0(25:11)
 13655     CALL 'kxdfhei1' USING DFHEIV0,
 13656           FILE-ID-ERRQST,
 13657           DFHEIV20,
 13658           DFHEIV99,
 13659           ERRQST-KEY,
 13660           DFHEIV99,
 13661           DFHEIV99,
 13662           DFHEIV99
 13663     SET ADDRESS OF AR-REQUEST-RECORD TO
 13664         DFHEIV20
 13665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13666
 13667
 13668     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13669
 13670     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13671
 13672     MOVE 'D'                      TO JP-RECORD-TYPE.
 13673     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13674
 13675
 13676* EXEC CICS DELETE
 13677*         DATASET    (FILE-ID-ERRQST)
 13678*    END-EXEC.
 13679*    MOVE '&(                    &   #00012562' TO DFHEIV0
 13680     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13681     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13682     MOVE X'2020233030303132353632' TO DFHEIV0(25:11)
 13683     CALL 'kxdfhei1' USING DFHEIV0,
 13684           FILE-ID-ERRQST,
 13685           DFHEIV99,
 13686           DFHEIV99,
 13687           DFHEIV99,
 13688           DFHEIV99
 13689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 249
* EL6311.cbl
 13690
 13691
 13692     PERFORM 8400-LOG-JOURNAL-RECORD.
 13693
 13694 1475-DELETE-FINISHED.
 13695     MOVE ZEROS                  TO EMI-ERROR.
 13696     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13697     MOVE LOW-VALUES             TO EL631BI.
 13698     MOVE -1                     TO BMAINTL.
 13699     GO TO 8100-SEND-INITIAL-MAP.
 13700
 13701 1480-BATCH-HDR-NOT-FOUND.
 13702     MOVE -1                     TO BMAINTL.
 13703     MOVE ER-7450                TO EMI-ERROR.
 13704     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13705     GO TO 8200-SEND-DATAONLY.
 13706
 13707 1490-RECORD-NOT-FOUND.
 13708     MOVE -1                     TO BMAINTL.
 13709     MOVE ER-7451                TO EMI-ERROR.
 13710     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13711     GO TO 8200-SEND-DATAONLY.
 13712
 13713******************************************************************
 13714*            O V E R   C H A R G E   P R O C E S S I N G         *
 13715******************************************************************
 13716 1500-UPDATE-ERNOTE.
 13717     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13718     MOVE 'A'                    TO WS-NOTE-SW
 13719     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13720     .
 13721 1500-EXIT.
 13722     EXIT.
 13723 1510-ADD-ERNOTE-REC.
 13724
 13725* EXEC CICS GETMAIN
 13726*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13727*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13728*        INITIMG (GETMAIN-SPACE)
 13729*    END-EXEC
 13730*    MOVE ',"IL                  $   #00012598' TO DFHEIV0
 13731     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13732     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13733     MOVE X'2020233030303132353938' TO DFHEIV0(25:11)
 13734     CALL 'kxdfhei1' USING DFHEIV0,
 13735           DFHEIV20,
 13736           ERNOTE-RECORD-LENGTH,
 13737           GETMAIN-SPACE
 13738     SET ADDRESS OF CERTIFICATE-NOTE TO
 13739         DFHEIV20
 13740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13741     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13742                                 TO ERNOTE-KEY
 13743
 13744* EXEC CICS READ
 13745*       DATASET    (FILE-ID-ERNOTE)
 13746*       RIDFLD     (ERNOTE-KEY)
 13747*       INTO       (CERTIFICATE-NOTE)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 250
* EL6311.cbl
 13748*       RESP       (WS-RESPONSE)
 13749*       UPDATE
 13750*    END-EXEC
 13751     MOVE LENGTH OF
 13752      CERTIFICATE-NOTE
 13753       TO DFHEIV11
 13754*    MOVE '&"IL       EU         (  N#00012605' TO DFHEIV0
 13755     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13756     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13757     MOVE X'204E233030303132363035' TO DFHEIV0(25:11)
 13758     CALL 'kxdfhei1' USING DFHEIV0,
 13759           FILE-ID-ERNOTE,
 13760           CERTIFICATE-NOTE,
 13761           DFHEIV11,
 13762           ERNOTE-KEY,
 13763           DFHEIV99,
 13764           DFHEIV99,
 13765           DFHEIV99
 13766     MOVE EIBRESP  TO WS-RESPONSE
 13767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13768     IF RESP-NORMAL
 13769        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13770           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13771        END-IF
 13772        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13773           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13774        END-IF
 13775        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13776           (N1 > +10)
 13777           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13778           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13779        END-PERFORM
 13780        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13781          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13782
 13783* EXEC CICS UNLOCK
 13784*            DATASET    (FILE-ID-ERNOTE)
 13785*          END-EXEC
 13786*    MOVE '&*                    #   #00012626' TO DFHEIV0
 13787     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13788     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13789     MOVE X'2020233030303132363236' TO DFHEIV0(25:11)
 13790     CALL 'kxdfhei1' USING DFHEIV0,
 13791           FILE-ID-ERNOTE,
 13792           DFHEIV99
 13793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13794        ELSE
 13795          PERFORM VARYING N1 FROM +1 BY +1
 13796           UNTIL (N1 > +10)
 13797           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13798          END-PERFORM
 13799          IF (N1 < +11)
 13800            IF N1 >= CN-BILLING-START-LINE-NO AND
 13801              N1 <= CN-BILLING-END-LINE-NO
 13802              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13803                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13804              ELSE
 13805                 MOVE WS-VA-NO-COMM-MESS
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 251
* EL6311.cbl
 13806                                    TO CN-LINE (N1)
 13807              END-IF
 13808            ELSE
 13809              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13810               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13811                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13812                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13813                ELSE
 13814                  MOVE WS-VA-NO-COMM-MESS
 13815                                    TO CN-LINE (N1)
 13816                END-IF
 13817                MOVE N1             TO CN-BILLING-END-LINE-NO
 13818              ELSE
 13819                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13820                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13821                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13822                  ELSE
 13823                     MOVE WS-VA-NO-COMM-MESS
 13824                                    TO CN-LINE (N1)
 13825                  END-IF
 13826                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13827                                      CN-BILLING-START-LINE-NO
 13828                ELSE
 13829                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13830                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13831                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13832                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13833                     ELSE
 13834                       MOVE WS-VA-NO-COMM-MESS
 13835                                    TO CN-LINE (N1)
 13836                     END-IF
 13837                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13838                  ELSE
 13839                     PERFORM 1700-SQUEEZE-IT-IN
 13840                                 THRU 1700-EXIT
 13841                  END-IF
 13842                END-IF
 13843              END-IF
 13844            END-IF
 13845            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13846            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13847            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13848
 13849* EXEC CICS REWRITE
 13850*              DATASET    (FILE-ID-ERNOTE)
 13851*              FROM       (CERTIFICATE-NOTE)
 13852*              RESP       (WS-RESPONSE)
 13853*           END-EXEC
 13854     MOVE LENGTH OF
 13855      CERTIFICATE-NOTE
 13856       TO DFHEIV11
 13857*    MOVE '&& L                  %  N#00012683' TO DFHEIV0
 13858     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13859     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13860     MOVE X'204E233030303132363833' TO DFHEIV0(25:11)
 13861     CALL 'kxdfhei1' USING DFHEIV0,
 13862           FILE-ID-ERNOTE,
 13863           CERTIFICATE-NOTE,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 252
* EL6311.cbl
 13864           DFHEIV11,
 13865           DFHEIV99
 13866     MOVE EIBRESP  TO WS-RESPONSE
 13867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13868          END-IF
 13869        END-IF
 13870     ELSE
 13871        MOVE SPACES              TO CERTIFICATE-NOTE
 13872        MOVE 'CN'                TO CN-RECORD-ID
 13873        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13874                                 TO CN-CONTROL-PRIMARY
 13875                                    ERNOTE-KEY
 13876        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13877                                    CN-BILLING-END-LINE-NO
 13878        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13879           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13880        ELSE
 13881           MOVE WS-VA-NO-COMM-MESS
 13882                                 TO CN-LINE (1)
 13883        END-IF
 13884        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13885        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13886        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13887
 13888* EXEC CICS WRITE
 13889*          DATASET    (FILE-ID-ERNOTE)
 13890*          FROM       (CERTIFICATE-NOTE)
 13891*          RIDFLD     (ERNOTE-KEY)
 13892*          RESP       (WS-RESPONSE)
 13893*       END-EXEC
 13894     MOVE LENGTH OF
 13895      CERTIFICATE-NOTE
 13896       TO DFHEIV11
 13897*    MOVE '&$ L                  ''  N#00012707' TO DFHEIV0
 13898     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13899     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13900     MOVE X'204E233030303132373037' TO DFHEIV0(25:11)
 13901     CALL 'kxdfhei1' USING DFHEIV0,
 13902           FILE-ID-ERNOTE,
 13903           CERTIFICATE-NOTE,
 13904           DFHEIV11,
 13905           ERNOTE-KEY,
 13906           DFHEIV99,
 13907           DFHEIV99
 13908     MOVE EIBRESP  TO WS-RESPONSE
 13909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13910     END-IF
 13911     .
 13912 1510-EXIT.
 13913     EXIT.
 13914 1520-UPDATE-ELCERT.
 13915     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13916                                 TO ELCERT-KEY
 13917
 13918* EXEC CICS READ
 13919*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13920*        DATASET (FILE-ID-ELCERT)
 13921*        RIDFLD  (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 253
* EL6311.cbl
 13922*        UPDATE
 13923*        RESP    (WS-RESPONSE)
 13924*    END-EXEC
 13925*    MOVE '&"S        EU         (  N#00012720' TO DFHEIV0
 13926     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13927     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13928     MOVE X'204E233030303132373230' TO DFHEIV0(25:11)
 13929     CALL 'kxdfhei1' USING DFHEIV0,
 13930           FILE-ID-ELCERT,
 13931           DFHEIV20,
 13932           DFHEIV99,
 13933           ELCERT-KEY,
 13934           DFHEIV99,
 13935           DFHEIV99,
 13936           DFHEIV99
 13937     SET ADDRESS OF CERTIFICATE-MASTER TO
 13938         DFHEIV20
 13939     MOVE EIBRESP  TO WS-RESPONSE
 13940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13941     IF RESP-NORMAL
 13942        IF WS-NOTE-SW = 'A'
 13943           IF CM-NOTE-SW = ' '
 13944              MOVE '2'             TO CM-NOTE-SW
 13945           ELSE
 13946             IF CM-NOTE-SW = '1'
 13947                MOVE '3'           TO CM-NOTE-SW
 13948             ELSE
 13949               IF CM-NOTE-SW = '4'
 13950                  MOVE '6'         TO CM-NOTE-SW
 13951               ELSE
 13952                 IF CM-NOTE-SW = '5'
 13953                    MOVE '7'       TO CM-NOTE-SW
 13954                 END-IF
 13955               END-IF
 13956             END-IF
 13957           END-IF
 13958        ELSE
 13959           IF CM-NOTE-SW = '2'
 13960              MOVE ' '             TO CM-NOTE-SW
 13961           ELSE
 13962             IF CM-NOTE-SW = '3'
 13963                MOVE '1'           TO CM-NOTE-SW
 13964             ELSE
 13965               IF CM-NOTE-SW = '6'
 13966                  MOVE '4'         TO CM-NOTE-SW
 13967               ELSE
 13968                 IF CM-NOTE-SW = '7'
 13969                    MOVE '5'       TO CM-NOTE-SW
 13970                 END-IF
 13971               END-IF
 13972             END-IF
 13973           END-IF
 13974        END-IF
 13975
 13976* EXEC CICS REWRITE
 13977*          DATASET    (FILE-ID-ELCERT)
 13978*          FROM       (CERTIFICATE-MASTER)
 13979*          RESP       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 254
* EL6311.cbl
 13980*       END-EXEC
 13981     MOVE LENGTH OF
 13982      CERTIFICATE-MASTER
 13983       TO DFHEIV11
 13984*    MOVE '&& L                  %  N#00012761' TO DFHEIV0
 13985     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13986     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13987     MOVE X'204E233030303132373631' TO DFHEIV0(25:11)
 13988     CALL 'kxdfhei1' USING DFHEIV0,
 13989           FILE-ID-ELCERT,
 13990           CERTIFICATE-MASTER,
 13991           DFHEIV11,
 13992           DFHEIV99
 13993     MOVE EIBRESP  TO WS-RESPONSE
 13994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13995        IF RESP-NORMAL
 13996           CONTINUE
 13997        ELSE
 13998           MOVE WS-RESPONSE TO EMI-ERROR
 13999           PERFORM 9900-ERROR-FORMAT
 14000                                 THRU 9900-EXIT
 14001           GO TO 8200-SEND-DATAONLY
 14002        END-IF
 14003     ELSE
 14004        MOVE -1                  TO BMAINTL
 14005        MOVE 0249                TO EMI-ERROR
 14006        PERFORM 9900-ERROR-FORMAT
 14007                                 THRU 9900-EXIT
 14008        GO TO 8200-SEND-DATAONLY
 14009     END-IF
 14010     .
 14011 1520-EXIT.
 14012     EXIT.
 14013 1600-UPDATE-ERPYAJ.
 14014     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 14015                                 THRU 1610-EXIT
 14016     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 14017                                 THRU 1620-EXIT
 14018     .
 14019 1600-EXIT.
 14020     EXIT.
 14021 1610-ADD-ERPYAJ-BANK-REC.
 14022
 14023* EXEC CICS GETMAIN
 14024*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 14025*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 14026*        INITIMG (GETMAIN-SPACE)
 14027*    END-EXEC
 14028*    MOVE ',"IL                  $   #00012793' TO DFHEIV0
 14029     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14030     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14031     MOVE X'2020233030303132373933' TO DFHEIV0(25:11)
 14032     CALL 'kxdfhei1' USING DFHEIV0,
 14033           DFHEIV20,
 14034           ERPYAJ-RECORD-LENGTH,
 14035           GETMAIN-SPACE
 14036     SET ADDRESS OF PENDING-PAY-ADJ TO
 14037         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 255
* EL6311.cbl
 14038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14039     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14040     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14041     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14042     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14043     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14044     MOVE +10                    TO ERPYAJ-SEQ-NO
 14045     MOVE 'R'                    TO ERPYAJ-TYPE
 14046     IF REVERSAL
 14047        MOVE 'C'                 TO ERPYAJ-TYPE
 14048     END-IF
 14049     MOVE SPACES                 TO PENDING-PAY-ADJ
 14050     MOVE 'PY'                   TO PY-RECORD-ID
 14051     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14052     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 14053     IF REVERSAL
 14054        MOVE PB-I-DCC-OVER-CHG-AMT
 14055                                 TO PY-ENTRY-AMT
 14056     END-IF
 14057     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 14058                                    PY-INPUT-DT
 14059*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 14060*                                   PY-INPUT-DT
 14061     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 14062     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 14063     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 14064     MOVE 'B'                    TO PY-ERCOMP-TYPE
 14065     IF PB-CARRIER = '2'
 14066        MOVE '2725040330'        TO PY-GL-ACCOUNT
 14067     ELSE
 14068        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14069     END-IF
 14070     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 14071                                    PY-BILLED-DATE
 14072                                    PY-AR-DATE
 14073                                    PY-REPORTED-DT
 14074                                    PY-CHECK-WRITTEN-DT
 14075     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 14076                                    PY-CHECK-QUE-SEQUENCE
 14077     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 14078     PERFORM WITH TEST AFTER
 14079        UNTIL (NOT RESP-DUPKEY)
 14080           AND (NOT RESP-DUPREC)
 14081
 14082* EXEC CICS WRITE
 14083*          DATASET    (FILE-ID-ERPYAJ)
 14084*          FROM       (PENDING-PAY-ADJ)
 14085*          RIDFLD     (ERPYAJ-KEY)
 14086*          RESP       (WS-RESPONSE)
 14087*       END-EXEC
 14088     MOVE LENGTH OF
 14089      PENDING-PAY-ADJ
 14090       TO DFHEIV11
 14091*    MOVE '&$ L                  ''  N#00012840' TO DFHEIV0
 14092     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14093     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14094     MOVE X'204E233030303132383430' TO DFHEIV0(25:11)
 14095     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 256
* EL6311.cbl
 14096           FILE-ID-ERPYAJ,
 14097           PENDING-PAY-ADJ,
 14098           DFHEIV11,
 14099           ERPYAJ-KEY,
 14100           DFHEIV99,
 14101           DFHEIV99
 14102     MOVE EIBRESP  TO WS-RESPONSE
 14103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14104        IF RESP-DUPKEY OR RESP-DUPREC
 14105           ADD +1                TO ERPYAJ-SEQ-NO
 14106           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14107        END-IF
 14108     END-PERFORM
 14109     .
 14110 1610-EXIT.
 14111     EXIT.
 14112 1620-ADD-ERPYAJ-DLR-REC.
 14113     MOVE 'C'                    TO ERPYAJ-TYPE
 14114     IF REVERSAL
 14115        MOVE 'R'                 TO ERPYAJ-TYPE
 14116     END-IF
 14117     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14118                                    ERPYAJ-ACCOUNT
 14119     ADD +1                      TO ERPYAJ-SEQ-NO
 14120     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 14121     MOVE 'A'                    TO PY-ERCOMP-TYPE
 14122     IF PB-CARRIER = '2'
 14123        MOVE '2725040330'        TO PY-GL-ACCOUNT
 14124     ELSE
 14125        MOVE '2725040130'        TO PY-GL-ACCOUNT
 14126     END-IF
 14127     PERFORM WITH TEST AFTER
 14128        UNTIL (NOT RESP-DUPKEY)
 14129           AND (NOT RESP-DUPREC)
 14130
 14131* EXEC CICS WRITE
 14132*          DATASET    (FILE-ID-ERPYAJ)
 14133*          FROM       (PENDING-PAY-ADJ)
 14134*          RIDFLD     (ERPYAJ-KEY)
 14135*          RESP       (WS-RESPONSE)
 14136*       END-EXEC
 14137     MOVE LENGTH OF
 14138      PENDING-PAY-ADJ
 14139       TO DFHEIV11
 14140*    MOVE '&$ L                  ''  N#00012872' TO DFHEIV0
 14141     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14142     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14143     MOVE X'204E233030303132383732' TO DFHEIV0(25:11)
 14144     CALL 'kxdfhei1' USING DFHEIV0,
 14145           FILE-ID-ERPYAJ,
 14146           PENDING-PAY-ADJ,
 14147           DFHEIV11,
 14148           ERPYAJ-KEY,
 14149           DFHEIV99,
 14150           DFHEIV99
 14151     MOVE EIBRESP  TO WS-RESPONSE
 14152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14153        IF RESP-DUPKEY OR RESP-DUPREC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 257
* EL6311.cbl
 14154           ADD +1                TO ERPYAJ-SEQ-NO
 14155           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 14156        END-IF
 14157     END-PERFORM
 14158     .
 14159 1620-EXIT.
 14160     EXIT.
 14161 1700-SQUEEZE-IT-IN.
 14162     IF (N1 > CN-BILLING-END-LINE-NO)
 14163        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 14164           N1 = +1
 14165           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 14166           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 14167              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14168                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 14169              ELSE
 14170                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 14171              END-IF
 14172              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 14173              MOVE +2 TO N1
 14174           END-IF
 14175        END-PERFORM
 14176     ELSE
 14177        IF (N1 < CN-BILLING-START-LINE-NO)
 14178           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 14179              N1 = +10
 14180              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 14181              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 14182                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 14183                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 14184                 ELSE
 14185                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 14186                 END-IF
 14187                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 14188                 MOVE +9 TO N1
 14189              END-IF
 14190           END-PERFORM
 14191        END-IF
 14192     END-IF
 14193     .
 14194 1700-EXIT.
 14195     EXIT.
 14196 1800-REMOVE-CERT-NOTES.
 14197     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14198                                 TO ERNOTE-KEY
 14199
 14200* EXEC CICS READ
 14201*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 14202*       DATASET    (FILE-ID-ERNOTE)
 14203*       RIDFLD     (ERNOTE-KEY)
 14204*       RESP       (WS-RESPONSE)
 14205*       UPDATE
 14206*    END-EXEC
 14207*    MOVE '&"S        EU         (  N#00012924' TO DFHEIV0
 14208     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14209     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14210     MOVE X'204E233030303132393234' TO DFHEIV0(25:11)
 14211     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 258
* EL6311.cbl
 14212           FILE-ID-ERNOTE,
 14213           DFHEIV20,
 14214           DFHEIV99,
 14215           ERNOTE-KEY,
 14216           DFHEIV99,
 14217           DFHEIV99,
 14218           DFHEIV99
 14219     SET ADDRESS OF CERTIFICATE-NOTE TO
 14220         DFHEIV20
 14221     MOVE EIBRESP  TO WS-RESPONSE
 14222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14223     IF RESP-NORMAL
 14224        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 14225           (N1 > +10)
 14226           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 14227           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 14228        END-PERFORM
 14229        IF N1 < +11
 14230           MOVE SPACES              TO CN-LINE (N1)
 14231           IF N1 >= CN-BILLING-START-LINE-NO  AND
 14232              N1 <= CN-BILLING-END-LINE-NO
 14233              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 14234              IF CN-BILLING-END-LINE-NO <
 14235                               CN-BILLING-START-LINE-NO
 14236                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 14237                                     CN-BILLING-START-LINE-NO
 14238              END-IF
 14239              PERFORM 1820-SQUEEZE-ERNOTE
 14240                                  THRU 1820-EXIT
 14241           END-IF
 14242           IF CN-LINES = SPACES
 14243
 14244* EXEC CICS DELETE
 14245*                DATASET    (FILE-ID-ERNOTE)
 14246*                RESP       (WS-RESPONSE)
 14247*             END-EXEC
 14248*    MOVE '&(                    &  N#00012951' TO DFHEIV0
 14249     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14250     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14251     MOVE X'204E233030303132393531' TO DFHEIV0(25:11)
 14252     CALL 'kxdfhei1' USING DFHEIV0,
 14253           FILE-ID-ERNOTE,
 14254           DFHEIV99,
 14255           DFHEIV99,
 14256           DFHEIV99,
 14257           DFHEIV99
 14258     MOVE EIBRESP  TO WS-RESPONSE
 14259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14260              IF RESP-NORMAL
 14261                 MOVE 'D'        TO WS-NOTE-SW
 14262                 PERFORM 1520-UPDATE-ELCERT
 14263                                 THRU 1520-EXIT
 14264              END-IF
 14265           ELSE
 14266
 14267* EXEC CICS REWRITE
 14268*                DATASET    (FILE-ID-ERNOTE)
 14269*                FROM       (CERTIFICATE-NOTE)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 259
* EL6311.cbl
 14270*                RESP       (WS-RESPONSE)
 14271*             END-EXEC
 14272     MOVE LENGTH OF
 14273      CERTIFICATE-NOTE
 14274       TO DFHEIV11
 14275*    MOVE '&& L                  %  N#00012961' TO DFHEIV0
 14276     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14277     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14278     MOVE X'204E233030303132393631' TO DFHEIV0(25:11)
 14279     CALL 'kxdfhei1' USING DFHEIV0,
 14280           FILE-ID-ERNOTE,
 14281           CERTIFICATE-NOTE,
 14282           DFHEIV11,
 14283           DFHEIV99
 14284     MOVE EIBRESP  TO WS-RESPONSE
 14285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14286           END-IF
 14287        END-IF
 14288     END-IF
 14289     .
 14290 1800-EXIT.
 14291     EXIT.
 14292 1820-SQUEEZE-ERNOTE.
 14293     MOVE CN-BILLING-START-LINE-NO TO N2
 14294     IF N2 = 0
 14295         MOVE +1                 TO N2
 14296     END-IF
 14297     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 14298        (N1 > +9)
 14299        IF CN-LINE (N1) = SPACES
 14300           MOVE CN-LINE (N1 + +1)
 14301                                 TO CN-LINE (N1)
 14302           MOVE SPACES           TO CN-LINE (N1 + +1)
 14303        END-IF
 14304     END-PERFORM
 14305     .
 14306 1820-EXIT.
 14307     EXIT.
 14308 1900-DELETE-ERPYAJ.
 14309     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14310     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14311     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14312     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14313     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14314     MOVE +10                    TO ERPYAJ-SEQ-NO
 14315     MOVE 'R'                    TO ERPYAJ-TYPE
 14316     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14317
 14318* EXEC CICS STARTBR
 14319*       DATASET    (FILE-ID-ERPYAJ)
 14320*       RIDFLD     (ERPYAJ-KEY)
 14321*       RESP       (WS-RESPONSE)
 14322*    END-EXEC
 14323     MOVE 0
 14324       TO DFHEIV11
 14325*    MOVE '&,         G          &  N#00012997' TO DFHEIV0
 14326     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14327     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 260
* EL6311.cbl
 14328     MOVE X'204E233030303132393937' TO DFHEIV0(25:11)
 14329     CALL 'kxdfhei1' USING DFHEIV0,
 14330           FILE-ID-ERPYAJ,
 14331           ERPYAJ-KEY,
 14332           DFHEIV99,
 14333           DFHEIV11,
 14334           DFHEIV99
 14335     MOVE EIBRESP  TO WS-RESPONSE
 14336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14337     IF RESP-NORMAL
 14338        CONTINUE
 14339     ELSE
 14340        GO TO 1900-GET-DEALER
 14341     END-IF
 14342     .
 14343 1900-READNEXT-ERPYAJ-B.
 14344*  GET THE BANK ERPYAJ RECORD
 14345
 14346* EXEC CICS READNEXT
 14347*       DATASET    (FILE-ID-ERPYAJ)
 14348*       RIDFLD     (ERPYAJ-KEY)
 14349*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14350*       RESP       (WS-RESPONSE)
 14351*    END-EXEC
 14352     MOVE 0
 14353       TO DFHEIV11
 14354*    MOVE '&.S                   )  N#00013010' TO DFHEIV0
 14355     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14356     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14357     MOVE X'204E233030303133303130' TO DFHEIV0(25:11)
 14358     CALL 'kxdfhei1' USING DFHEIV0,
 14359           FILE-ID-ERPYAJ,
 14360           DFHEIV20,
 14361           DFHEIV99,
 14362           ERPYAJ-KEY,
 14363           DFHEIV99,
 14364           DFHEIV11,
 14365           DFHEIV99,
 14366           DFHEIV99
 14367     SET ADDRESS OF PENDING-PAY-ADJ TO
 14368         DFHEIV20
 14369     MOVE EIBRESP  TO WS-RESPONSE
 14370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14371     IF RESP-NORMAL
 14372        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14373           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14374              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14375                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14376
 14377* EXEC CICS READ
 14378*                   DATASET    (FILE-ID-ERPYAJ)
 14379*                   RIDFLD     (ERPYAJ-KEY)
 14380*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14381*                   RESP       (WS-RESPONSE)
 14382*                   UPDATE
 14383*                END-EXEC
 14384*    MOVE '&"S        EU         (  N#00013021' TO DFHEIV0
 14385     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 261
* EL6311.cbl
 14386     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14387     MOVE X'204E233030303133303231' TO DFHEIV0(25:11)
 14388     CALL 'kxdfhei1' USING DFHEIV0,
 14389           FILE-ID-ERPYAJ,
 14390           DFHEIV20,
 14391           DFHEIV99,
 14392           ERPYAJ-KEY,
 14393           DFHEIV99,
 14394           DFHEIV99,
 14395           DFHEIV99
 14396     SET ADDRESS OF PENDING-PAY-ADJ TO
 14397         DFHEIV20
 14398     MOVE EIBRESP  TO WS-RESPONSE
 14399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14400                 IF RESP-NORMAL
 14401
 14402* EXEC CICS DELETE
 14403*                      DATASET   (FILE-ID-ERPYAJ)
 14404*                      RESP      (WS-RESPONSE)
 14405*                   END-EXEC
 14406*    MOVE '&(                    &  N#00013029' TO DFHEIV0
 14407     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14408     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14409     MOVE X'204E233030303133303239' TO DFHEIV0(25:11)
 14410     CALL 'kxdfhei1' USING DFHEIV0,
 14411           FILE-ID-ERPYAJ,
 14412           DFHEIV99,
 14413           DFHEIV99,
 14414           DFHEIV99,
 14415           DFHEIV99
 14416     MOVE EIBRESP  TO WS-RESPONSE
 14417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14418                 END-IF
 14419              ELSE
 14420                 SET REVERSAL    TO TRUE
 14421                 PERFORM 1600-UPDATE-ERPYAJ
 14422                                 THRU 1600-EXIT
 14423                 GO TO 1900-EXIT
 14424              END-IF
 14425           ELSE
 14426              GO TO 1900-READNEXT-ERPYAJ-B
 14427           END-IF
 14428        END-IF
 14429
 14430* EXEC CICS ENDBR
 14431*          DATASET   (FILE-ID-ERPYAJ)
 14432*       END-EXEC
 14433     MOVE 0
 14434       TO DFHEIV11
 14435*    MOVE '&2                    $   #00013044' TO DFHEIV0
 14436     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14437     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14438     MOVE X'2020233030303133303434' TO DFHEIV0(25:11)
 14439     CALL 'kxdfhei1' USING DFHEIV0,
 14440           FILE-ID-ERPYAJ,
 14441           DFHEIV11,
 14442           DFHEIV99
 14443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 262
* EL6311.cbl
 14444     END-IF
 14445     .
 14446 1900-GET-DEALER.
 14447     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14448     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14449     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14450     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14451     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14452     MOVE +10                    TO ERPYAJ-SEQ-NO
 14453     MOVE 'C'                    TO ERPYAJ-TYPE
 14454     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14455
 14456* EXEC CICS STARTBR
 14457*       DATASET    (FILE-ID-ERPYAJ)
 14458*       RIDFLD     (ERPYAJ-KEY)
 14459*       RESP       (WS-RESPONSE)
 14460*    END-EXEC
 14461     MOVE 0
 14462       TO DFHEIV11
 14463*    MOVE '&,         G          &  N#00013058' TO DFHEIV0
 14464     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14465     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14466     MOVE X'204E233030303133303538' TO DFHEIV0(25:11)
 14467     CALL 'kxdfhei1' USING DFHEIV0,
 14468           FILE-ID-ERPYAJ,
 14469           ERPYAJ-KEY,
 14470           DFHEIV99,
 14471           DFHEIV11,
 14472           DFHEIV99
 14473     MOVE EIBRESP  TO WS-RESPONSE
 14474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14475     IF RESP-NORMAL
 14476        CONTINUE
 14477     ELSE
 14478        GO TO 1900-EXIT
 14479     END-IF
 14480     .
 14481 1900-READNEXT-ERPYAJ-D.
 14482*  GET THE DEALER ERPYAJ RECORD
 14483
 14484* EXEC CICS READNEXT
 14485*       DATASET    (FILE-ID-ERPYAJ)
 14486*       RIDFLD     (ERPYAJ-KEY)
 14487*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14488*       RESP       (WS-RESPONSE)
 14489*    END-EXEC
 14490     MOVE 0
 14491       TO DFHEIV11
 14492*    MOVE '&.S                   )  N#00013071' TO DFHEIV0
 14493     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14494     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14495     MOVE X'204E233030303133303731' TO DFHEIV0(25:11)
 14496     CALL 'kxdfhei1' USING DFHEIV0,
 14497           FILE-ID-ERPYAJ,
 14498           DFHEIV20,
 14499           DFHEIV99,
 14500           ERPYAJ-KEY,
 14501           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 263
* EL6311.cbl
 14502           DFHEIV11,
 14503           DFHEIV99,
 14504           DFHEIV99
 14505     SET ADDRESS OF PENDING-PAY-ADJ TO
 14506         DFHEIV20
 14507     MOVE EIBRESP  TO WS-RESPONSE
 14508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14509     IF RESP-NORMAL
 14510        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14511           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14512              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14513                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14514
 14515* EXEC CICS READ
 14516*                   DATASET    (FILE-ID-ERPYAJ)
 14517*                   RIDFLD     (ERPYAJ-KEY)
 14518*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14519*                   RESP       (WS-RESPONSE)
 14520*                   UPDATE
 14521*                END-EXEC
 14522*    MOVE '&"S        EU         (  N#00013082' TO DFHEIV0
 14523     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14524     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14525     MOVE X'204E233030303133303832' TO DFHEIV0(25:11)
 14526     CALL 'kxdfhei1' USING DFHEIV0,
 14527           FILE-ID-ERPYAJ,
 14528           DFHEIV20,
 14529           DFHEIV99,
 14530           ERPYAJ-KEY,
 14531           DFHEIV99,
 14532           DFHEIV99,
 14533           DFHEIV99
 14534     SET ADDRESS OF PENDING-PAY-ADJ TO
 14535         DFHEIV20
 14536     MOVE EIBRESP  TO WS-RESPONSE
 14537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14538                 IF RESP-NORMAL
 14539
 14540* EXEC CICS DELETE
 14541*                      DATASET   (FILE-ID-ERPYAJ)
 14542*                      RESP      (WS-RESPONSE)
 14543*                   END-EXEC
 14544*    MOVE '&(                    &  N#00013090' TO DFHEIV0
 14545     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14546     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14547     MOVE X'204E233030303133303930' TO DFHEIV0(25:11)
 14548     CALL 'kxdfhei1' USING DFHEIV0,
 14549           FILE-ID-ERPYAJ,
 14550           DFHEIV99,
 14551           DFHEIV99,
 14552           DFHEIV99,
 14553           DFHEIV99
 14554     MOVE EIBRESP  TO WS-RESPONSE
 14555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14556                 END-IF
 14557              ELSE
 14558                 SET REVERSAL    TO TRUE
 14559              END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 264
* EL6311.cbl
 14560           ELSE
 14561              GO TO 1900-READNEXT-ERPYAJ-D
 14562           END-IF
 14563        END-IF
 14564
 14565* EXEC CICS ENDBR
 14566*          DATASET   (FILE-ID-ERPYAJ)
 14567*       END-EXEC
 14568     MOVE 0
 14569       TO DFHEIV11
 14570*    MOVE '&2                    $   #00013102' TO DFHEIV0
 14571     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14572     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14573     MOVE X'2020233030303133313032' TO DFHEIV0(25:11)
 14574     CALL 'kxdfhei1' USING DFHEIV0,
 14575           FILE-ID-ERPYAJ,
 14576           DFHEIV11,
 14577           DFHEIV99
 14578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14579     END-IF
 14580     .
 14581 1900-EXIT.
 14582     EXIT.
 14583******************************************************************
 14584*            C A N C E L   M A I N L I N E                       *
 14585******************************************************************
 14586
 14587 2000-CANCEL-MAINLINE.
 14588     IF PI-DISPLAY-ORIGINAL-BATCH
 14589        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14590           MOVE ER-0023             TO EMI-ERROR
 14591           MOVE -1                  TO CMAINTL
 14592           MOVE AL-UABON            TO CMAINTA
 14593           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14594           GO TO 8200-SEND-DATAONLY
 14595        ELSE
 14596           NEXT SENTENCE
 14597     ELSE
 14598        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14599           MOVE ER-0023             TO EMI-ERROR
 14600           MOVE -1                  TO CMAINTL
 14601           MOVE AL-UABON            TO CMAINTA
 14602           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14603           GO TO 8200-SEND-DATAONLY.
 14604
 14605     IF CMAINTI = 'S'
 14606        GO TO 2100-SHOW-REQUEST.
 14607
 14608     IF NOT MODIFY-CAP
 14609         MOVE 'UPDATE'       TO SM-READ
 14610         PERFORM 9995-SECURITY-VIOLATION
 14611         MOVE ER-0070        TO EMI-ERROR
 14612         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14613         GO TO 8100-SEND-INITIAL-MAP.
 14614
 14615     IF CMAINTL GREATER THAN ZEROS
 14616        IF PI-PF6-FUNCTION
 14617           IF CMAINTI NOT = 'A'
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 265
* EL6311.cbl
 14618              MOVE AL-UABON  TO CMAINTA
 14619              MOVE -1        TO CMAINTL
 14620              MOVE ER-2260   TO EMI-ERROR
 14621              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14622              GO TO 8200-SEND-DATAONLY.
 14623
 14624     IF CCERTNOL = ZEROS
 14625       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14626         NEXT SENTENCE
 14627     ELSE
 14628         IF CCERTNOL NOT = ZEROS
 14629             MOVE AL-UANON       TO CCERTNOA
 14630         ELSE
 14631             MOVE -1             TO CCERTNOL
 14632             MOVE  1             TO SET-CURSOR-SW
 14633             MOVE ER-2218       TO EMI-ERROR
 14634             MOVE AL-UABON       TO CCERTNOA
 14635             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14636
 14637     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14638        NEXT SENTENCE
 14639     ELSE
 14640        IF CEFFDTL NOT = ZEROS
 14641           MOVE AL-UNNON         TO CEFFDTA
 14642           MOVE CEFFDTI TO DEEDIT-FIELD
 14643           PERFORM 8600-DEEDIT
 14644           MOVE 4                TO DC-OPTION-CODE
 14645           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14646           PERFORM 9700-DATE-LINK
 14647           IF NO-CONVERSION-ERROR
 14648              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14649              ELSE
 14650              MOVE -1            TO CEFFDTL
 14651              MOVE  1            TO SET-CURSOR-SW
 14652              MOVE ER-2226      TO EMI-ERROR
 14653              MOVE AL-UNBON      TO CEFFDTA
 14654              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14655          ELSE
 14656          MOVE -1                 TO CEFFDTL
 14657          MOVE  1                 TO SET-CURSOR-SW
 14658          MOVE ER-2220            TO EMI-ERROR
 14659          MOVE AL-UNBON           TO CEFFDTA
 14660          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14661
 14662     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14663
 14664     IF CCERTNOL NOT = ZEROS
 14665        MOVE CCERTNOI                TO WS-NEW-PRIME
 14666     ELSE
 14667        MOVE SPACES                  TO WS-NEW-PRIME.
 14668
 14669     IF CSUFIXL NOT = ZEROS
 14670        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14671     ELSE
 14672        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14673
 14674     IF CEFFDTL NOT = ZEROS
 14675        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 266
* EL6311.cbl
 14676     ELSE
 14677        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14678
 14679     IF CMAINTI = 'A' OR 'K' OR 'S'
 14680        NEXT SENTENCE
 14681     ELSE
 14682        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14683        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14684           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14685           WS-PB-RECORD-TYPE NOT = '2'
 14686           IF CMAINTI = 'C'
 14687              MOVE ER-2287          TO EMI-ERROR
 14688              MOVE -1               TO CCERTNOL
 14689              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14690              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14691              GO TO 8200-SEND-DATAONLY
 14692             ELSE
 14693              MOVE ER-2260          TO EMI-ERROR
 14694              MOVE -1               TO CCERTNOL
 14695              MOVE AL-UABON         TO CCERTNOA
 14696              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14697              GO TO 8200-SEND-DATAONLY.
 14698
 14699     IF CMAINTI = 'D'
 14700        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14701
 14702     IF CLSTNML GREATER THAN ZEROS
 14703         MOVE AL-UANON           TO CLSTNMA.
 14704
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 267
* EL6311.cbl
 14706
 14707******************************************************************
 14708*                                                                *
 14709*           E D I T   C A N C E L   C O V E R A G E S            *
 14710*                                                                *
 14711******************************************************************
 14712
 14713 2015-EDIT-COVERAGES.
 14714     IF CCANDT1L      GREATER THAN ZEROS OR
 14715        CREFND1L      GREATER THAN ZEROS OR
 14716        CCANDT2L      GREATER THAN ZEROS OR
 14717        CREFND2L      GREATER THAN ZEROS OR
 14718        CMTHD1L       GREATER THAN ZEROS OR
 14719        CMTHD2L       GREATER THAN ZEROS OR
 14720        CLIVESL       GREATER THAN ZEROS OR
 14721        CPAYEEL       GREATER THAN ZEROS OR
 14722        CFORCEL       GREATER THAN ZEROS OR
 14723        CBILCDL       GREATER THAN ZEROS OR
 14724        CCANREAL      GREATER THAN ZEROS
 14725            NEXT SENTENCE
 14726         ELSE
 14727            GO TO 2030-EDIT-COMPLETE.
 14728
 14729     IF CCANDT1L = ZEROS
 14730        AND (CMAINTI = 'C' OR 'K')
 14731        NEXT SENTENCE
 14732     ELSE
 14733        IF CCANDT1L      GREATER THAN ZEROS
 14734            MOVE AL-UNNON            TO CCANDT1A
 14735            IF CCANDT1I = SPACES
 14736               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14737            ELSE
 14738               MOVE CCANDT1I            TO DEEDIT-FIELD
 14739               PERFORM 8600-DEEDIT
 14740               IF DEEDIT-FIELD-V0   NUMERIC
 14741                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14742                  MOVE 4                TO DC-OPTION-CODE
 14743                  PERFORM 9700-DATE-LINK
 14744                  IF NO-CONVERSION-ERROR
 14745                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14746                  ELSE
 14747                      MOVE -1        TO CCANDT1L
 14748                      MOVE ER-2227   TO EMI-ERROR
 14749                      MOVE AL-UNBON  TO CCANDT1A
 14750                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14751               ELSE
 14752                  MOVE -1         TO CCANDT1L
 14753                  MOVE ER-2223    TO EMI-ERROR
 14754                  MOVE AL-UNBON   TO CCANDT1A
 14755                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14756        ELSE
 14757            IF CREFND1L GREATER THAN ZEROS
 14758               MOVE -1             TO CCANDT1L
 14759               MOVE ER-2222        TO EMI-ERROR
 14760               MOVE AL-UNBOF       TO CCANDT1A
 14761               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14762
 14763     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 268
* EL6311.cbl
 14764        AND (CMAINTI = 'C' OR 'K')
 14765         NEXT SENTENCE
 14766     ELSE
 14767         IF CREFND1L NOT = ZEROS
 14768            MOVE AL-UNNON        TO CREFND1A
 14769
 14770* EXEC CICS BIF DEEDIT
 14771*               FIELD  (CREFND1I)
 14772*               LENGTH (11)
 14773*           END-EXEC
 14774     MOVE 11
 14775       TO DFHEIV11
 14776*    MOVE '@"L                   #   #00013295' TO DFHEIV0
 14777     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14778     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14779     MOVE X'2020233030303133323935' TO DFHEIV0(25:11)
 14780     CALL 'kxdfhei1' USING DFHEIV0,
 14781           CREFND1I,
 14782           DFHEIV11
 14783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14784            MOVE CREFND1I        TO WS-CREFND1
 14785*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14786*           PERFORM 8600-DEEDIT
 14787*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14788            IF WS-CREFND1  = ZEROS
 14789               AND CMAINTI = 'A'
 14790             MOVE ER-2437        TO EMI-ERROR
 14791             MOVE -1             TO CREFND1L
 14792             MOVE AL-UNBON       TO CREFND1A
 14793             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14794
 14795     IF CCANREAL > +0
 14796        MOVE AL-UANON            TO CCANREAA
 14797        IF CCANREAI = 'R' OR ' '
 14798           CONTINUE
 14799        ELSE
 14800           MOVE ER-9841        TO EMI-ERROR
 14801           MOVE -1             TO CCANREAL
 14802           MOVE AL-UABON       TO CCANREAA
 14803           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14804        END-IF
 14805     END-IF
 14806     IF CMTHD1L EQUAL +0
 14807        NEXT SENTENCE
 14808     ELSE
 14809        IF CMTHD1L NOT = +0
 14810           MOVE AL-UNNON        TO CMTHD1A
 14811           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14812                         OR '5' OR '6' OR '8' OR '9'
 14813                         OR 'R' OR ' '
 14814              NEXT SENTENCE
 14815           ELSE
 14816              MOVE ER-0582        TO EMI-ERROR
 14817              MOVE -1             TO CMTHD1L
 14818              MOVE AL-UNBON       TO CMTHD1A
 14819              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14820
 14821     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 269
* EL6311.cbl
 14822        AND (CMAINTI = 'C' OR 'K')
 14823         NEXT SENTENCE
 14824     ELSE
 14825         IF CCANDT2L  GREATER THAN ZEROS
 14826             MOVE AL-UNNON       TO CCANDT2A
 14827             IF CCANDT2I = SPACES
 14828                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14829             ELSE
 14830                MOVE CCANDT2I       TO DEEDIT-FIELD
 14831                PERFORM 8600-DEEDIT
 14832                IF DEEDIT-FIELD-V0   NUMERIC
 14833                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14834                   MOVE 4                TO DC-OPTION-CODE
 14835                   PERFORM 9700-DATE-LINK
 14836                   IF NO-CONVERSION-ERROR
 14837                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14838                   ELSE
 14839                      MOVE -1       TO CCANDT2L
 14840                      MOVE ER-2227  TO EMI-ERROR
 14841                      MOVE AL-UNBON TO CCANDT2A
 14842                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14843                ELSE
 14844                   MOVE -1         TO CCANDT2L
 14845                   MOVE ER-2223    TO EMI-ERROR
 14846                   MOVE AL-UNBON   TO CCANDT2A
 14847                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14848         ELSE
 14849            IF CREFND2L GREATER THAN ZEROS
 14850               MOVE -1             TO CCANDT2L
 14851               MOVE ER-2222        TO EMI-ERROR
 14852               MOVE AL-UNBOF       TO CCANDT2A
 14853               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14854
 14855     IF CREFND2L = ZEROS
 14856        AND (CMAINTI = 'C' OR 'K')
 14857         NEXT SENTENCE
 14858     ELSE
 14859         IF CREFND2L NOT = ZEROS
 14860            MOVE AL-UNNON        TO CREFND2A
 14861
 14862* EXEC CICS BIF DEEDIT
 14863*               FIELD  (CREFND2I)
 14864*               LENGTH (11)
 14865*           END-EXEC
 14866     MOVE 11
 14867       TO DFHEIV11
 14868*    MOVE '@"L                   #   #00013376' TO DFHEIV0
 14869     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14870     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14871     MOVE X'2020233030303133333736' TO DFHEIV0(25:11)
 14872     CALL 'kxdfhei1' USING DFHEIV0,
 14873           CREFND2I,
 14874           DFHEIV11
 14875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14876            MOVE CREFND2I        TO WS-CREFND2
 14877*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14878*           PERFORM 8600-DEEDIT
 14879*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 270
* EL6311.cbl
 14880            IF WS-CREFND2  = ZEROS
 14881               AND CMAINTI = 'A'
 14882             MOVE ER-2437        TO EMI-ERROR
 14883             MOVE -1             TO CREFND2L
 14884             MOVE AL-UNBON       TO CREFND2A
 14885             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14886
 14887     IF CMTHD2L EQUAL +0
 14888        NEXT SENTENCE
 14889     ELSE
 14890        IF CMTHD2L NOT = +0
 14891           MOVE AL-UNNON        TO CMTHD2A
 14892           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14893                         OR '5' OR '6' OR '8' OR '9'
 14894                         OR ' ' OR 'R'
 14895              NEXT SENTENCE
 14896           ELSE
 14897              MOVE ER-0582        TO EMI-ERROR
 14898              MOVE -1             TO CMTHD2L
 14899              MOVE AL-UNBON       TO CMTHD2A
 14900              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14901
 14902     IF CLIVESL GREATER THAN ZEROS
 14903         MOVE CLIVESI            TO DEEDIT-FIELD
 14904         PERFORM 8600-DEEDIT
 14905         IF DEEDIT-FIELD-V0 NUMERIC
 14906             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14907             MOVE AL-UNNON       TO CLIVESA
 14908         ELSE
 14909             MOVE -1             TO CLIVESL
 14910             MOVE AL-UNBON       TO CLIVESA
 14911             MOVE ER-2223        TO EMI-ERROR
 14912             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14913
 14914     IF CFORCEL  NOT = ZEROS
 14915         IF FORCE-CAP
 14916            MOVE AL-UANON            TO CFORCEA
 14917         ELSE
 14918            MOVE ER-2945             TO EMI-ERROR
 14919            MOVE AL-UABON            TO CFORCEA
 14920            MOVE -1                  TO CFORCEL
 14921            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14922
 14923     IF CPAYEEL GREATER THAN ZEROS
 14924        MOVE AL-UANON            TO CPAYEEA.
 14925
 14926     IF CBILCDL NOT = ZEROS
 14927        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14928                             AND 'A' AND 'B' AND 'E'
 14929           MOVE ER-2225              TO EMI-ERROR
 14930           MOVE AL-UABON             TO CBILCDA
 14931           MOVE -1                   TO CBILCDL
 14932           MOVE  1                   TO SET-CURSOR-SW
 14933           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14934        ELSE
 14935           MOVE AL-UANON             TO CBILCDA.
 14936
 14937 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 271
* EL6311.cbl
 14938     IF EMI-ERROR = ZEROS
 14939         NEXT SENTENCE
 14940     ELSE
 14941         GO TO 8200-SEND-DATAONLY.
 14942
 14943     IF CMAINTI = 'A'
 14944        GO TO 2200-ADD-CANCEL-ROUTINE.
 14945
 14946     IF CMAINTI = 'C'
 14947        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14948
 14949     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14950
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 272
* EL6311.cbl
 14952
 14953******************************************************************
 14954*                                                                *
 14955*                   S H O W   C A N C E L                        *
 14956*                                                                *
 14957******************************************************************
 14958
 14959 2100-SHOW-REQUEST.
 14960     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14961
 14962     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14963        MOVE -1                  TO CMAINTL
 14964        GO TO 8200-SEND-DATAONLY.
 14965
 14966     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14967
 14968     IF CSUFIXL NOT = ZEROS
 14969        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14970       ELSE
 14971        MOVE SPACE            TO WS-NEW-SUFFIX.
 14972
 14973     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14974     PERFORM 8600-DEEDIT.
 14975     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14976     MOVE '4'                    TO DC-OPTION-CODE.
 14977     PERFORM 9700-DATE-LINK.
 14978     IF DATE-CONVERSION-ERROR
 14979        MOVE ER-0348             TO EMI-ERROR
 14980        MOVE -1                  TO CEFFDTL
 14981        MOVE AL-UABON            TO CEFFDTA
 14982        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14983        GO TO 8200-SEND-DATAONLY
 14984     ELSE
 14985        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14986        MOVE AL-UANON            TO CEFFDTA
 14987        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14988
 14989     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14990
 14991     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14992        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14993        MOVE 'Y'                    TO WS-SHOW-SW
 14994        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14995           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14996        ELSE
 14997           IF PI-FILE-BROWSE
 14998              GO TO 4300-BROWSE-FILE-FORWARD
 14999           ELSE
 15000              IF PI-CSR-BROWSE
 15001                 GO TO 4200-BROWSE-CSR-FORWARD
 15002              ELSE
 15003                 GO TO 4000-BROWSE-DETAIL-FORWARD
 15004     ELSE
 15005        GO TO 3900-RE-DISPLAY-RECORD.
 15006
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 273
* EL6311.cbl
 15008
 15009
 15010******************************************************************
 15011*                                                                *
 15012*            A D D   C A N C E L   R O U T I N E                 *
 15013*                                                                *
 15014******************************************************************
 15015
 15016 2200-ADD-CANCEL-ROUTINE.
 15017     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 15018
 15019
 15020* EXEC CICS GETMAIN
 15021*        SET     (ADDRESS OF PENDING-BUSINESS)
 15022*        LENGTH  (ERPNDB-RECORD-LENGTH)
 15023*    END-EXEC.
 15024*    MOVE '," L                  $   #00013523' TO DFHEIV0
 15025     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 15026     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15027     MOVE X'2020233030303133353233' TO DFHEIV0(25:11)
 15028     CALL 'kxdfhei1' USING DFHEIV0,
 15029           DFHEIV20,
 15030           ERPNDB-RECORD-LENGTH,
 15031           DFHEIV99
 15032     SET ADDRESS OF PENDING-BUSINESS TO
 15033         DFHEIV20
 15034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15035
 15036
 15037
 15038* EXEC CICS HANDLE CONDITION
 15039*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 15040*    END-EXEC.
 15041*    MOVE '"$I                   ! 3 #00013528' TO DFHEIV0
 15042     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15043     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15044     MOVE X'3320233030303133353238' TO DFHEIV0(25:11)
 15045     CALL 'kxdfhei1' USING DFHEIV0
 15046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15047
 15048
 15049     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 15050     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15051     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15052
 15053
 15054* EXEC CICS READ
 15055*        INTO    (PENDING-BUSINESS)
 15056*        DATASET (FILE-ID-ERPNDB)
 15057*        RIDFLD  (ERPNDB-KEY)
 15058*    END-EXEC.
 15059     MOVE LENGTH OF
 15060      PENDING-BUSINESS
 15061       TO DFHEIV11
 15062*    MOVE '&"IL       E          (   #00013536' TO DFHEIV0
 15063     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15064     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15065     MOVE X'2020233030303133353336' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 274
* EL6311.cbl
 15066     CALL 'kxdfhei1' USING DFHEIV0,
 15067           FILE-ID-ERPNDB,
 15068           PENDING-BUSINESS,
 15069           DFHEIV11,
 15070           ERPNDB-KEY,
 15071           DFHEIV99,
 15072           DFHEIV99,
 15073           DFHEIV99
 15074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15075
 15076
 15077     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 15078
 15079     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15080     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 15081     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 15082     MOVE SPACES                 TO PENDING-BUSINESS.
 15083     MOVE 'PB'                   TO PB-RECORD-ID.
 15084     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 15085     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 15086     MOVE SPACES                 TO PB-CERT-SFX.
 15087     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 15088     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15089                                    PB-ALT-CHG-SEQ-NO.
 15090
 15091     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 15092     MOVE CCERTNOI               TO PB-CERT-PRIME.
 15093     MOVE '2'                    TO PB-RECORD-TYPE.
 15094
 15095     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 15096     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 15097
 15098
 15099     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 15100                                    PB-ALT-CHG-SEQ-NO
 15101                                    PB-C-LF-REF-CALC
 15102                                    PB-C-AH-REF-CALC
 15103                                    PB-C-LF-RFND-CLP
 15104                                    PB-C-AH-RFND-CLP
 15105                                    PB-CI-INSURED-AGE
 15106                                    PB-CI-LF-TERM
 15107                                    PB-CI-AH-TERM
 15108                                    PB-CI-LF-BENEFIT-CD
 15109                                    PB-CI-LF-BENEFIT-AMT
 15110                                    PB-CI-LF-ALT-BENEFIT-AMT
 15111                                    PB-CI-LF-PREMIUM-AMT
 15112                                    PB-CI-LF-ALT-PREMIUM-AMT
 15113                                    PB-CI-AH-BENEFIT-CD
 15114                                    PB-CI-AH-BENEFIT-AMT
 15115                                    PB-CI-AH-PREMIUM-AMT
 15116                                    PB-CI-PAY-FREQUENCY
 15117                                    PB-CI-LOAN-APR
 15118                                    PB-CI-LOAN-TERM
 15119                                    PB-CI-LIFE-COMMISSION
 15120                                    PB-CI-AH-COMMISSION
 15121                                    PB-CI-CURR-SEQ
 15122                                    PB-CI-AH-CANCEL-AMT
 15123                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 275
* EL6311.cbl
 15124                                    PB-CI-RATE-DEV-PCT-LF
 15125                                    PB-CI-RATE-DEV-PCT-AH
 15126                                    PB-CI-EXTENTION-DAYS
 15127                                    PB-CI-TERM-IN-DAYS
 15128                                    PB-CI-LIVES
 15129                                    PB-CI-LF-CRIT-PER
 15130                                    PB-CI-AH-CRIT-PER
 15131                                    PB-C-LF-REM-TERM
 15132                                    PB-C-AH-REM-TERM
 15133                                    PB-CHG-COUNT
 15134                                    PB-LF-BILLED-AMTS
 15135                                    PB-AH-BILLED-AMTS
 15136                                    PB-C-INT-ON-REFS
 15137*                                   PB-C-MICROFILM-NO
 15138                                    PB-CALC-TOLERANCE.
 15139
 15140     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 15141                                    PB-CI-AH-SETTLEMENT-DT
 15142                                    PB-CI-DEATH-DT
 15143                                    PB-CI-LF-PRIOR-CANCEL-DT
 15144                                    PB-CI-AH-PRIOR-CANCEL-DT
 15145                                    PB-CI-ENTRY-DT
 15146                                    PB-CI-LF-EXPIRE-DT
 15147                                    PB-CI-AH-EXPIRE-DT
 15148                                    PB-CI-LOAN-1ST-PMT-DT
 15149                                    PB-C-LF-CANCEL-DT
 15150                                    PB-C-AH-CANCEL-DT
 15151                                    PB-CREDIT-ACCEPT-DT
 15152                                    PB-BILLED-DT
 15153                                    PB-ACCT-EFF-DT
 15154                                    PB-ACCT-EXP-DT.
 15155
 15156     MOVE 'X'                    TO PB-FATAL-FLAG.
 15157
 15158     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 15159
 15160     IF CSUFIXL     GREATER THAN ZEROS
 15161        MOVE CSUFIXI             TO PB-CERT-SFX.
 15162
 15163*    IF CMICRNOL  GREATER  ZEROS
 15164*        IF CMICRNOI  NUMERIC
 15165*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15166*            MOVE AL-UNNON       TO  CMICRNOA
 15167*        ELSE
 15168*            MOVE -1             TO  CMICRNOL
 15169*            MOVE AL-UNBON       TO  CMICRNOA
 15170*            MOVE ER-2701        TO  EMI-ERROR
 15171*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15172
 15173     IF CLSTNML     GREATER THAN ZEROS
 15174        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 15175
 15176     IF CCANREAL > ZEROS
 15177        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15178     END-IF
 15179     IF CPCYNL > ZEROS
 15180        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15181     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 276
* EL6311.cbl
 15182     IF CCANDT1L    GREATER THAN ZEROS
 15183        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15184
 15185     IF CCANDT2L    GREATER THAN ZEROS
 15186        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15187
 15188     IF CMTHD1L    GREATER THAN +0
 15189        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15190
 15191     IF CMTHD2L    GREATER THAN +0
 15192        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15193
 15194     IF CREFND1L    GREATER THAN ZEROS
 15195        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15196        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15197     ELSE
 15198        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 15199
 15200     IF CREFND2L    GREATER THAN ZEROS
 15201        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15202        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15203     ELSE
 15204        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 15205
 15206     IF CLIVESL     GREATER THAN ZEROS
 15207        MOVE WS-CLIVES           TO PB-C-LIVES
 15208     ELSE
 15209        MOVE ZEROS               TO PB-C-LIVES.
 15210
 15211     IF CPAYEEL     GREATER THAN ZEROS
 15212        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15213
 15214     IF CFORCEL     GREATER THAN ZEROS
 15215        MOVE CFORCEI             TO PB-FORCE-CODE.
 15216
 15217     IF CBILCDL     GREATER THAN ZEROS
 15218        MOVE CBILCDI             TO PB-RECORD-BILL.
 15219
 15220*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 15221
 15222 2260-WRITE-PB-RECORD.
 15223     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 15224                                    PB-INPUT-BY.
 15225     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15226     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 15227                                    PB-INPUT-DT.
 15228
 15229     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15230     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 15231                                    PB-CONTROL-BY-ORIG-BATCH.
 15232
 15233     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 15234     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 15235     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 15236     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 15237     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 15238
 15239     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 277
* EL6311.cbl
 15240
 15241     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15242
 15243     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15244     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15245     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15246
 15247     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15248     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15249
 15250 2275-WRITE-PENDING-BUSINESS.
 15251     MOVE 'A'                    TO JP-RECORD-TYPE.
 15252     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15253     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15254     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15255
 15256
 15257* EXEC CICS HANDLE CONDITION
 15258*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 15259*    END-EXEC.
 15260*    MOVE '"$%                   ! 4 #00013721' TO DFHEIV0
 15261     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15263     MOVE X'3420233030303133373231' TO DFHEIV0(25:11)
 15264     CALL 'kxdfhei1' USING DFHEIV0
 15265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15266
 15267
 15268
 15269* EXEC CICS WRITE
 15270*        DATASET (FILE-ID-ERPNDB)
 15271*        FROM    (PENDING-BUSINESS)
 15272*        RIDFLD  (PB-CONTROL-PRIMARY)
 15273*    END-EXEC.
 15274     MOVE LENGTH OF
 15275      PENDING-BUSINESS
 15276       TO DFHEIV11
 15277*    MOVE '&$ L                  ''   #00013725' TO DFHEIV0
 15278     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15279     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15280     MOVE X'2020233030303133373235' TO DFHEIV0(25:11)
 15281     CALL 'kxdfhei1' USING DFHEIV0,
 15282           FILE-ID-ERPNDB,
 15283           PENDING-BUSINESS,
 15284           DFHEIV11,
 15285           PB-CONTROL-PRIMARY,
 15286           DFHEIV99,
 15287           DFHEIV99
 15288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15289
 15290
 15291     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 15292
 15293     PERFORM 8400-LOG-JOURNAL-RECORD.
 15294
 15295******************************************************************
 15296*       A D D  O R I G I N A L  C E R T  I N F O                 *
 15297******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 278
* EL6311.cbl
 15298
 15299     display ' made it to add orig CANCEL cert '
 15300     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15301     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15302     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15303     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15304
 15305
 15306* EXEC CICS READ
 15307*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15308*        DATASET (FILE-ID-ELCERT)
 15309*        RIDFLD  (ELCERT-KEY)
 15310*        RESP    (WS-RESPONSE)
 15311*    END-EXEC.
 15312*    MOVE '&"S        E          (  N#00013745' TO DFHEIV0
 15313     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15315     MOVE X'204E233030303133373435' TO DFHEIV0(25:11)
 15316     CALL 'kxdfhei1' USING DFHEIV0,
 15317           FILE-ID-ELCERT,
 15318           DFHEIV20,
 15319           DFHEIV99,
 15320           ELCERT-KEY,
 15321           DFHEIV99,
 15322           DFHEIV99,
 15323           DFHEIV99
 15324     SET ADDRESS OF CERTIFICATE-MASTER TO
 15325         DFHEIV20
 15326     MOVE EIBRESP  TO WS-RESPONSE
 15327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15328
 15329
 15330     IF NOT RESP-NORMAL
 15331        GO TO 2276-BYPASS-CRTO
 15332     END-IF
 15333
 15334     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15335     MOVE ' '                    TO WS-ERMAIL-SW
 15336
 15337
 15338* EXEC CICS READ
 15339*       DATASET   (FILE-ID-ERMAIL)
 15340*       SET       (ADDRESS OF MAILING-DATA)
 15341*       RIDFLD    (ERMAIL-KEY)
 15342*       RESP      (WS-RESPONSE)
 15343*    END-EXEC
 15344*    MOVE '&"S        E          (  N#00013759' TO DFHEIV0
 15345     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15346     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15347     MOVE X'204E233030303133373539' TO DFHEIV0(25:11)
 15348     CALL 'kxdfhei1' USING DFHEIV0,
 15349           FILE-ID-ERMAIL,
 15350           DFHEIV20,
 15351           DFHEIV99,
 15352           ERMAIL-KEY,
 15353           DFHEIV99,
 15354           DFHEIV99,
 15355           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 279
* EL6311.cbl
 15356     SET ADDRESS OF MAILING-DATA TO
 15357         DFHEIV20
 15358     MOVE EIBRESP  TO WS-RESPONSE
 15359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15360
 15361     IF RESP-NORMAL
 15362        SET ERMAIL-FOUND TO TRUE
 15363     END-IF
 15364
 15365     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15366
 15367     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15368     MOVE 'OC'                   TO OC-RECORD-ID
 15369     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15370                                 TO OC-CONTROL-PRIMARY (1:33)
 15371     MOVE 'I'                    TO OC-RECORD-TYPE
 15372     MOVE +4096                  TO OC-KEY-SEQ-NO
 15373     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15374     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15375     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15376
 15377     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15378     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15379     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15380     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15381     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15382     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15383     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15384     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15385     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15386     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15387     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15388     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15389     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15390     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15391     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15392     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15393     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15394     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15395     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15396     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15397     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15398     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15399     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15400     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15401     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15402     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15403     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15404     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15405     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15406     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15407     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15408     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15409
 15410     IF ERMAIL-FOUND
 15411        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15412     END-IF
 15413     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 280
* EL6311.cbl
 15414        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15415                           OC-INS-AGE-DEFAULT-FLAG
 15416        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15417                           OC-JNT-AGE-DEFAULT-FLAG
 15418     END-IF
 15419     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15420     .
 15421 2275-WRITE-ELCRTO.
 15422
 15423
 15424* EXEC CICS WRITE
 15425*       DATASET   ('ELCRTO')
 15426*       FROM      (ORIGINAL-CERTIFICATE)
 15427*       RIDFLD    (OC-CONTROL-PRIMARY)
 15428*       RESP      (WS-RESPONSE)
 15429*    END-EXEC
 15430     MOVE LENGTH OF
 15431      ORIGINAL-CERTIFICATE
 15432       TO DFHEIV11
 15433     MOVE 'ELCRTO' TO DFHEIV1
 15434*    MOVE '&$ L                  ''  N#00013828' TO DFHEIV0
 15435     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15436     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15437     MOVE X'204E233030303133383238' TO DFHEIV0(25:11)
 15438     CALL 'kxdfhei1' USING DFHEIV0,
 15439           DFHEIV1,
 15440           ORIGINAL-CERTIFICATE,
 15441           DFHEIV11,
 15442           OC-CONTROL-PRIMARY,
 15443           DFHEIV99,
 15444           DFHEIV99
 15445     MOVE EIBRESP  TO WS-RESPONSE
 15446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15447
 15448     display ' just wrote 2275 ' ws-response
 15449     IF RESP-DUPKEY
 15450        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15451        GO TO 2275-WRITE-ELCRTO
 15452     ELSE
 15453        IF NOT RESP-NORMAL
 15454           MOVE -1               TO BMAINTL
 15455           MOVE ER-7450          TO EMI-ERROR
 15456           PERFORM 9900-ERROR-FORMAT
 15457                                 THRU 9900-EXIT
 15458           GO TO 8200-SEND-DATAONLY
 15459        END-IF
 15460     END-IF.
 15461
 15462 2276-BYPASS-CRTO.
 15463******************************************************************
 15464*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15465******************************************************************
 15466
 15467
 15468* EXEC CICS READ
 15469*        INTO    (PENDING-BUSINESS)
 15470*        DATASET (FILE-ID-ERPNDB)
 15471*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 281
* EL6311.cbl
 15472*        UPDATE
 15473*    END-EXEC.
 15474     MOVE LENGTH OF
 15475      PENDING-BUSINESS
 15476       TO DFHEIV11
 15477*    MOVE '&"IL       EU         (   #00013854' TO DFHEIV0
 15478     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15479     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15480     MOVE X'2020233030303133383534' TO DFHEIV0(25:11)
 15481     CALL 'kxdfhei1' USING DFHEIV0,
 15482           FILE-ID-ERPNDB,
 15483           PENDING-BUSINESS,
 15484           DFHEIV11,
 15485           ERPNDB-KEY,
 15486           DFHEIV99,
 15487           DFHEIV99,
 15488           DFHEIV99
 15489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15490
 15491
 15492     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15493     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15494     MOVE 'B'                    TO JP-RECORD-TYPE.
 15495     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15496
 15497     PERFORM 8400-LOG-JOURNAL-RECORD.
 15498
 15499     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15500
 15501
 15502* EXEC CICS REWRITE
 15503*        DATASET (FILE-ID-ERPNDB)
 15504*        FROM    (PENDING-BUSINESS)
 15505*    END-EXEC.
 15506     MOVE LENGTH OF
 15507      PENDING-BUSINESS
 15508       TO DFHEIV11
 15509*    MOVE '&& L                  %   #00013870' TO DFHEIV0
 15510     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15511     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15512     MOVE X'2020233030303133383730' TO DFHEIV0(25:11)
 15513     CALL 'kxdfhei1' USING DFHEIV0,
 15514           FILE-ID-ERPNDB,
 15515           PENDING-BUSINESS,
 15516           DFHEIV11,
 15517           DFHEIV99
 15518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15519
 15520
 15521     MOVE 'C'                    TO JP-RECORD-TYPE.
 15522     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15523
 15524     PERFORM 8400-LOG-JOURNAL-RECORD.
 15525
 15526     IF WS-ERRORS-PRESENT
 15527        GO TO 3900-RE-DISPLAY-RECORD.
 15528
 15529     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 282
* EL6311.cbl
 15530     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15531     MOVE LOW-VALUES             TO EL631CI.
 15532     MOVE  -1                    TO CMAINTL.
 15533     GO TO 8100-SEND-INITIAL-MAP.
 15534
 15535 2280-BATCH-HDR-NOT-FOUND.
 15536     MOVE -1                     TO BMAINTL.
 15537     MOVE ER-7450                TO EMI-ERROR.
 15538     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15539     GO TO 8200-SEND-DATAONLY.
 15540
 15541 2290-DUPLICATE-ALT-INDEX.
 15542
 15543******************************************************************
 15544*                                                                *
 15545*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15546*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15547*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15548*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15549*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15550*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15551*                                                                *
 15552******************************************************************
 15553
 15554     IF LCP-ONCTR-02 =  0
 15555         ADD 1 TO LCP-ONCTR-02
 15556        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15557
 15558     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15559
 15560     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15561         NEXT SENTENCE
 15562     ELSE
 15563         ADD +1 TO PB-BATCH-SEQ-NO
 15564                   PB-CSR-BATCH-SEQ-NO
 15565         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15566         GO TO 2275-WRITE-PENDING-BUSINESS.
 15567
 15568     MOVE -1                     TO CCERTNOL.
 15569     MOVE AL-UABON               TO CCERTNOA.
 15570     MOVE AL-UNBON               TO CEFFDTA.
 15571
 15572     MOVE 1                      TO EMI-SUB
 15573                                    EMI-SWITCH1
 15574                                    EMI-SWITCH-AREA-1
 15575                                    EMI-SWITCH-AREA-2.
 15576
 15577     MOVE SPACES                 TO EMI-ERROR-LINES.
 15578
 15579
 15580* EXEC CICS SYNCPOINT ROLLBACK
 15581*    END-EXEC.
 15582*    MOVE '6"R                   !   #00013933' TO DFHEIV0
 15583     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15585     MOVE X'2020233030303133393333' TO DFHEIV0(25:11)
 15586     CALL 'kxdfhei1' USING DFHEIV0
 15587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 283
* EL6311.cbl
 15588
 15589
 15590     MOVE ER-2247                TO EMI-ERROR.
 15591     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15592     GO TO 8200-SEND-DATAONLY.
 15593
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 284
* EL6311.cbl
 15595
 15596******************************************************************
 15597*                                                                *
 15598*          C H A N G E   C A N C E L   R O U T I N E             *
 15599*                                                                *
 15600******************************************************************
 15601
 15602***************************************************************
 15603*                                                             *
 15604*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15605*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15606*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15607*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15608*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15609*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15610*     5. LINK TO THE EDIT ROUTINE.                            *
 15611*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15612*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15613*              THE EDIT ROUTINE.                              *
 15614*     7. REWRITE THE NEW ISSUE                                *
 15615*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15616*                                                             *
 15617***************************************************************
 15618 2300-CHANGE-CANCEL-ROUTINE.
 15619     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15620
 15621     IF CCHGL NOT = ZEROS
 15622        MOVE ER-2196             TO EMI-ERROR
 15623        MOVE AL-UABON            TO CMAINTA
 15624        MOVE -1                  TO CMAINTL
 15625        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15626        GO TO 8200-SEND-DATAONLY.
 15627
 15628     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15629
 15630     IF CSUFIXL NOT = ZEROS
 15631        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15632     ELSE
 15633        MOVE SPACE               TO WS-NEW-SUFFIX.
 15634
 15635     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15636     PERFORM 8600-DEEDIT.
 15637     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15638     MOVE '4'                    TO DC-OPTION-CODE.
 15639
 15640     PERFORM 9700-DATE-LINK.
 15641
 15642     IF DATE-CONVERSION-ERROR
 15643        MOVE ER-0348             TO EMI-ERROR
 15644        MOVE -1                  TO CEFFDTL
 15645        MOVE AL-UABON            TO CEFFDTA
 15646        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15647        GO TO 8200-SEND-DATAONLY
 15648     ELSE
 15649        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15650        MOVE AL-UANON            TO CEFFDTA
 15651        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15652
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 285
* EL6311.cbl
 15653 2325-PROCESS-CANCEL-CHANGES.
 15654
 15655* EXEC CICS HANDLE CONDITION
 15656*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15657*    END-EXEC.
 15658*    MOVE '"$I                   ! 5 #00014000' TO DFHEIV0
 15659     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15660     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15661     MOVE X'3520233030303134303030' TO DFHEIV0(25:11)
 15662     CALL 'kxdfhei1' USING DFHEIV0
 15663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15664
 15665
 15666     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15667     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15668     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15669
 15670
 15671* EXEC CICS GETMAIN
 15672*        SET      (ADDRESS OF PENDING-BUSINESS)
 15673*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15674*        INITIMG  (GETMAIN-SPACE)
 15675*     END-EXEC.
 15676*    MOVE ',"IL                  $   #00014008' TO DFHEIV0
 15677     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15678     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15679     MOVE X'2020233030303134303038' TO DFHEIV0(25:11)
 15680     CALL 'kxdfhei1' USING DFHEIV0,
 15681           DFHEIV20,
 15682           ERPNDB-RECORD-LENGTH,
 15683           GETMAIN-SPACE
 15684     SET ADDRESS OF PENDING-BUSINESS TO
 15685         DFHEIV20
 15686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15687
 15688
 15689
 15690* EXEC CICS READ
 15691*        INTO    (PENDING-BUSINESS)
 15692*        DATASET (FILE-ID-ERPNDB)
 15693*        RIDFLD  (ERPNDB-KEY)
 15694*    END-EXEC.
 15695     MOVE LENGTH OF
 15696      PENDING-BUSINESS
 15697       TO DFHEIV11
 15698*    MOVE '&"IL       E          (   #00014014' TO DFHEIV0
 15699     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15700     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15701     MOVE X'2020233030303134303134' TO DFHEIV0(25:11)
 15702     CALL 'kxdfhei1' USING DFHEIV0,
 15703           FILE-ID-ERPNDB,
 15704           PENDING-BUSINESS,
 15705           DFHEIV11,
 15706           ERPNDB-KEY,
 15707           DFHEIV99,
 15708           DFHEIV99,
 15709           DFHEIV99
 15710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 286
* EL6311.cbl
 15711
 15712
 15713     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15714
 15715
 15716* EXEC CICS HANDLE CONDITION
 15717*         NOTFND     (2385-REC-NOT-FOUND)
 15718*    END-EXEC.
 15719*    MOVE '"$I                   ! 6 #00014022' TO DFHEIV0
 15720     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15721     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15722     MOVE X'3620233030303134303232' TO DFHEIV0(25:11)
 15723     CALL 'kxdfhei1' USING DFHEIV0
 15724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15725
 15726
 15727**********************************************************
 15728*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15729*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15730**********************************************************
 15731
 15732
 15733* EXEC CICS READ
 15734*        DATASET (FILE-ID-ERPNDB)
 15735*        INTO    (PENDING-BUSINESS)
 15736*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15737*    END-EXEC.
 15738     MOVE LENGTH OF
 15739      PENDING-BUSINESS
 15740       TO DFHEIV11
 15741*    MOVE '&"IL       E          (   #00014031' TO DFHEIV0
 15742     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15743     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15744     MOVE X'2020233030303134303331' TO DFHEIV0(25:11)
 15745     CALL 'kxdfhei1' USING DFHEIV0,
 15746           FILE-ID-ERPNDB,
 15747           PENDING-BUSINESS,
 15748           DFHEIV11,
 15749           PI-PREV-CONTROL-PRIMARY,
 15750           DFHEIV99,
 15751           DFHEIV99,
 15752           DFHEIV99
 15753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15754
 15755
 15756********** DO NOT ALLOW CHANGES IF THRU A/R
 15757     IF BMAINTI = 'C'
 15758         IF PB-EL860-INTERNAL-PROCESS
 15759             MOVE ER-4005          TO EMI-ERROR
 15760             MOVE -1               TO BMAINTL
 15761             MOVE AL-UABON         TO BMAINTA
 15762             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15763             GO TO 8200-SEND-DATAONLY.
 15764**********
 15765
 15766     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15767        MOVE -1                 TO CMAINTL
 15768        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 287
* EL6311.cbl
 15769        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15770        GO TO 8200-SEND-DATAONLY.
 15771
 15772     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15773        MOVE ER-2196             TO EMI-ERROR
 15774        MOVE AL-UABON            TO CMAINTA
 15775        MOVE -1                  TO CMAINTL
 15776        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15777        GO TO 8200-SEND-DATAONLY.
 15778     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15779
 15780     IF PB-BILLED-DT = LOW-VALUES AND
 15781        PB-CHG-COUNT = ZEROS
 15782        NEXT SENTENCE
 15783     ELSE
 15784        IF (CREFND1L GREATER THAN ZEROS AND
 15785            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15786           OR
 15787           (CREFND2L GREATER THAN ZEROS AND
 15788            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15789           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15790     if ((crefnd1l <> zeros)
 15791        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15792                      or
 15793        ((crefnd2l <> zeros)
 15794        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15795        continue
 15796     else
 15797        go to 2330-continue-change
 15798     end-if
 15799
 15800     move zeros                  to ws-check-amts
 15801     move ' '                    to ws-stop-sw
 15802                                    ws-check-sw
 15803                                    ws-any-check-sw
 15804                                    ws-proc-check-sw
 15805                                    ws-chek-browse-sw
 15806
 15807     perform 2500-browse-checks  thru 2500-exit
 15808
 15809     if i-have-processed-checks
 15810        or i-have-checks
 15811        continue
 15812     else
 15813        go to 2330-continue-change
 15814     end-if
 15815
 15816     if crefnd1l <> zeros
 15817        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15818        move ws-crefnd1 to ws-new-ref-total
 15819     else
 15820        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15821     end-if
 15822     if crefnd2l <> zeros
 15823        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15824        compute ws-new-ref-total = ws-new-ref-total +
 15825           ws-crefnd2
 15826     else
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 288
* EL6311.cbl
 15827        compute ws-new-ref-total = ws-new-ref-total +
 15828           pb-c-ah-cancel-amt
 15829     end-if
 15830
 15831     if zeros = (ws-lf-diff + ws-ah-diff)
 15832        move er-3449             to emi-error
 15833        perform 9900-error-format thru 9900-exit
 15834        go to 2330-continue-change
 15835     end-if
 15836
 15837     if (ws-new-ref-total < ws-check-amts)
 15838        and (pb-c-refund-sw = 'Y')
 15839        move er-3447             to emi-error
 15840        perform 9900-error-format thru 9900-exit
 15841        move al-uabon            to cmainta
 15842        move -1                  to cmaintl
 15843        go to 8200-send-dataonly
 15844     end-if
 15845
 15846     if (ws-new-ref-total > ws-check-amts)
 15847        and (ws-check-amts not = zeros)
 15848        move er-3448             to emi-error
 15849        move al-uabon            to crefnd1a
 15850                                    crefnd2a
 15851        perform 9900-error-format thru 9900-exit
 15852     end-if
 15853
 15854*     if (ws-lf-diff + ws-ah-diff) < zeros
 15855*        move er-3447             to emi-error
 15856*        perform 9900-error-format thru 9900-exit
 15857*        move al-uabon            to cmainta
 15858*        move -1                  to cmaintl
 15859*        go to 8200-send-dataonly
 15860*     end-if
 15861     .
 15862 2330-continue-change.
 15863
 15864
 15865* EXEC CICS READ
 15866*        DATASET (FILE-ID-ERPNDB)
 15867*        INTO    (PENDING-BUSINESS)
 15868*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15869*        UPDATE
 15870*    END-EXEC.
 15871     MOVE LENGTH OF
 15872      PENDING-BUSINESS
 15873       TO DFHEIV11
 15874*    MOVE '&"IL       EU         (   #00014145' TO DFHEIV0
 15875     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15876     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15877     MOVE X'2020233030303134313435' TO DFHEIV0(25:11)
 15878     CALL 'kxdfhei1' USING DFHEIV0,
 15879           FILE-ID-ERPNDB,
 15880           PENDING-BUSINESS,
 15881           DFHEIV11,
 15882           PI-PREV-CONTROL-PRIMARY,
 15883           DFHEIV99,
 15884           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 289
* EL6311.cbl
 15885           DFHEIV99
 15886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15887
 15888
 15889     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15890     MOVE 'B'                    TO JP-RECORD-TYPE
 15891     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15892     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15893
 15894     PERFORM 8400-LOG-JOURNAL-RECORD.
 15895
 15896     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15897          PB-CHG-COUNT NOT = ZEROS
 15898        IF (CREFND1L GREATER THAN ZEROS AND
 15899            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15900           OR
 15901           (CREFND2L GREATER THAN ZEROS AND
 15902            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15903            ADD +1                      TO PB-CHG-COUNT
 15904            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15905
 15906*    IF CMICRNOL  GREATER  ZEROS
 15907*        IF CMICRNOI  NUMERIC
 15908*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15909*            MOVE AL-UNNON       TO  CMICRNOA
 15910*        ELSE
 15911*            MOVE -1             TO  CMICRNOL
 15912*            MOVE AL-UNBON       TO  CMICRNOA
 15913*            MOVE ER-2701        TO  EMI-ERROR
 15914*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15915
 15916     IF CSUFIXL GREATER THAN ZEROS
 15917        MOVE CSUFIXI             TO PB-CERT-SFX.
 15918
 15919     IF CLSTNML GREATER THAN ZEROS
 15920         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15921
 15922     IF CCANREAL > ZEROS
 15923        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15924     END-IF
 15925     IF CPCYNL > ZEROS
 15926        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15927     END-IF
 15928     IF CCANDT1L    GREATER THAN ZEROS
 15929        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15930
 15931     IF CCANDT2L    GREATER THAN ZEROS
 15932        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15933
 15934     IF CMTHD1L    GREATER THAN +0
 15935        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15936
 15937     IF CMTHD2L    GREATER THAN +0
 15938        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15939
 15940     IF CREFND1L    GREATER THAN ZEROS
 15941        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15942        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 290
* EL6311.cbl
 15943        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15944        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15945
 15946     IF CREFND2L    GREATER THAN ZEROS
 15947        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15948        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15949        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15950        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15951
 15952     IF CLIVESL     GREATER THAN ZEROS
 15953        MOVE WS-CLIVES           TO PB-C-LIVES.
 15954
 15955     IF CPAYEEL     GREATER THAN ZEROS
 15956        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15957
 15958     IF CFORCEL     GREATER THAN ZEROS
 15959        MOVE CFORCEI             TO PB-FORCE-CODE.
 15960
 15961     IF CBILCDL     GREATER THAN ZEROS
 15962        MOVE CBILCDI             TO PB-RECORD-BILL.
 15963
 15964 2360-REWRITE-PB-RECORD.
 15965     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15966     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15967     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15968     MOVE 'C'                    TO JP-RECORD-TYPE.
 15969     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15970     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15971     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15972
 15973     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15974
 15975     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15976     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15977
 15978     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15979
 15980     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15981
 15982     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15983     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15984     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15985
 15986     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15987     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15988
 15989 2375-REWRITE-PENDING-BUSINESS.
 15990     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15991     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15992     MOVE 'C'                    TO JP-RECORD-TYPE.
 15993     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15994
 15995
 15996* EXEC CICS REWRITE
 15997*        DATASET (FILE-ID-ERPNDB)
 15998*        FROM    (PENDING-BUSINESS)
 15999*    END-EXEC.
 16000     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 291
* EL6311.cbl
 16001      PENDING-BUSINESS
 16002       TO DFHEIV11
 16003*    MOVE '&& L                  %   #00014258' TO DFHEIV0
 16004     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16005     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16006     MOVE X'2020233030303134323538' TO DFHEIV0(25:11)
 16007     CALL 'kxdfhei1' USING DFHEIV0,
 16008           FILE-ID-ERPNDB,
 16009           PENDING-BUSINESS,
 16010           DFHEIV11,
 16011           DFHEIV99
 16012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16013
 16014
 16015     PERFORM 8400-LOG-JOURNAL-RECORD.
 16016
 16017******************************************************************
 16018*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 16019******************************************************************
 16020
 16021     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16022     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16023     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16024     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16025
 16026
 16027* EXEC CICS READ
 16028*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16029*        DATASET (FILE-ID-ELCERT)
 16030*        RIDFLD  (ELCERT-KEY)
 16031*        RESP    (WS-RESPONSE)
 16032*    END-EXEC.
 16033*    MOVE '&"S        E          (  N#00014274' TO DFHEIV0
 16034     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16035     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16036     MOVE X'204E233030303134323734' TO DFHEIV0(25:11)
 16037     CALL 'kxdfhei1' USING DFHEIV0,
 16038           FILE-ID-ELCERT,
 16039           DFHEIV20,
 16040           DFHEIV99,
 16041           ELCERT-KEY,
 16042           DFHEIV99,
 16043           DFHEIV99,
 16044           DFHEIV99
 16045     SET ADDRESS OF CERTIFICATE-MASTER TO
 16046         DFHEIV20
 16047     MOVE EIBRESP  TO WS-RESPONSE
 16048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16049
 16050
 16051     IF NOT RESP-NORMAL
 16052        GO TO 2376-BYPASS-CRTO
 16053     END-IF
 16054
 16055
 16056     MOVE ELCERT-KEY             TO ERMAIL-KEY
 16057     MOVE ' '                    TO WS-ERMAIL-SW
 16058
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 292
* EL6311.cbl
 16059
 16060* EXEC CICS READ
 16061*       DATASET   (FILE-ID-ERMAIL)
 16062*       SET       (ADDRESS OF MAILING-DATA)
 16063*       RIDFLD    (ERMAIL-KEY)
 16064*       RESP      (WS-RESPONSE)
 16065*    END-EXEC
 16066*    MOVE '&"S        E          (  N#00014289' TO DFHEIV0
 16067     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16068     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16069     MOVE X'204E233030303134323839' TO DFHEIV0(25:11)
 16070     CALL 'kxdfhei1' USING DFHEIV0,
 16071           FILE-ID-ERMAIL,
 16072           DFHEIV20,
 16073           DFHEIV99,
 16074           ERMAIL-KEY,
 16075           DFHEIV99,
 16076           DFHEIV99,
 16077           DFHEIV99
 16078     SET ADDRESS OF MAILING-DATA TO
 16079         DFHEIV20
 16080     MOVE EIBRESP  TO WS-RESPONSE
 16081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16082
 16083     IF RESP-NORMAL
 16084        SET ERMAIL-FOUND TO TRUE
 16085     END-IF
 16086
 16087     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 16088
 16089     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16090                                 TO ELCRTO-KEY
 16091     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 16092     MOVE +0                     TO ELCRTO-SEQ-NO
 16093
 16094
 16095* EXEC CICS READ
 16096*       DATASET   ('ELCRTO')
 16097*       INTO      (ORIGINAL-CERTIFICATE)
 16098*       RIDFLD    (ELCRTO-KEY)
 16099*       GTEQ
 16100*       RESP      (WS-RESPONSE)
 16101*    END-EXEC
 16102     MOVE LENGTH OF
 16103      ORIGINAL-CERTIFICATE
 16104       TO DFHEIV11
 16105     MOVE 'ELCRTO' TO DFHEIV1
 16106*    MOVE '&"IL       G          (  N#00014307' TO DFHEIV0
 16107     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 16108     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16109     MOVE X'204E233030303134333037' TO DFHEIV0(25:11)
 16110     CALL 'kxdfhei1' USING DFHEIV0,
 16111           DFHEIV1,
 16112           ORIGINAL-CERTIFICATE,
 16113           DFHEIV11,
 16114           ELCRTO-KEY,
 16115           DFHEIV99,
 16116           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 293
* EL6311.cbl
 16117           DFHEIV99
 16118     MOVE EIBRESP  TO WS-RESPONSE
 16119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16120
 16121     IF RESP-NORMAL
 16122        AND (OC-CONTROL-PRIMARY (1:33) =
 16123                 PB-CONTROL-BY-ACCOUNT (1:33))
 16124        AND (OC-RECORD-TYPE = 'I')
 16125        display ' resp norm, key =, type i '
 16126        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 16127           display ' end proc blank '
 16128           display ' csr edit session ' PI-CSR-SESSION-SW
 16129           IF NOT CSR-EDIT-SESSION
 16130
 16131* EXEC CICS READ
 16132*                DATASET   ('ELCRTO')
 16133*                INTO      (ORIGINAL-CERTIFICATE)
 16134*                RIDFLD    (OC-CONTROL-PRIMARY)
 16135*                UPDATE
 16136*                RESP      (WS-RESPONSE)
 16137*             END-EXEC
 16138     MOVE LENGTH OF
 16139      ORIGINAL-CERTIFICATE
 16140       TO DFHEIV11
 16141     MOVE 'ELCRTO' TO DFHEIV1
 16142*    MOVE '&"IL       EU         (  N#00014324' TO DFHEIV0
 16143     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16144     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16145     MOVE X'204E233030303134333234' TO DFHEIV0(25:11)
 16146     CALL 'kxdfhei1' USING DFHEIV0,
 16147           DFHEIV1,
 16148           ORIGINAL-CERTIFICATE,
 16149           DFHEIV11,
 16150           OC-CONTROL-PRIMARY,
 16151           DFHEIV99,
 16152           DFHEIV99,
 16153           DFHEIV99
 16154     MOVE EIBRESP  TO WS-RESPONSE
 16155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16156              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 16157              IF RESP-NORMAL
 16158                 display ' good read upd '
 16159                 IF OC-ISSUE-TRAN-IND = 'N'
 16160                    MOVE CM-INSURED-LAST-NAME   TO
 16161                         OC-INS-LAST-NAME
 16162                    MOVE CM-INSURED-FIRST-NAME  TO
 16163                         OC-INS-FIRST-NAME
 16164                    MOVE CM-INSURED-INITIAL2    TO
 16165                         OC-INS-MIDDLE-INIT
 16166                    MOVE CM-INSURED-ISSUE-AGE   TO
 16167                         OC-INS-AGE
 16168                    MOVE CM-JT-LAST-NAME        TO
 16169                         OC-JNT-LAST-NAME
 16170                    MOVE CM-JT-FIRST-NAME       TO
 16171                         OC-JNT-FIRST-NAME
 16172                    MOVE CM-JT-INITIAL          TO
 16173                         OC-JNT-MIDDLE-INIT
 16174                    MOVE CM-INSURED-JOINT-AGE   TO
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 294
* EL6311.cbl
 16175                         OC-JNT-AGE
 16176                    MOVE CM-LF-BENEFIT-CD       TO
 16177                         OC-LF-BENCD
 16178                    MOVE CM-LF-ORIG-TERM        TO
 16179                         OC-LF-TERM
 16180                    MOVE CM-LF-BENEFIT-AMT      TO
 16181                         OC-LF-BEN-AMT
 16182                    MOVE CM-LF-PREMIUM-AMT      TO
 16183                         OC-LF-PRM-AMT
 16184                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 16185                         OC-LF-ALT-BEN-AMT
 16186                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 16187                         OC-LF-ALT-PRM-AMT
 16188                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 16189                         OC-LF-EXP-DT
 16190                    MOVE CM-LIFE-COMM-PCT       TO
 16191                         OC-LF-COMM-PCT
 16192                    MOVE CM-AH-BENEFIT-CD       TO
 16193                         OC-AH-BENCD
 16194                    MOVE CM-AH-ORIG-TERM        TO
 16195                         OC-AH-TERM
 16196                    MOVE CM-AH-BENEFIT-AMT      TO
 16197                         OC-AH-BEN-AMT
 16198                    MOVE CM-AH-PREMIUM-AMT      TO
 16199                         OC-AH-PRM-AMT
 16200                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 16201                         OC-AH-EXP-DT
 16202                    MOVE CM-AH-COMM-PCT         TO
 16203                         OC-AH-COMM-PCT
 16204                    MOVE CM-AH-CRITICAL-PERIOD  TO
 16205                         OC-AH-CP
 16206                    MOVE CM-LOAN-1ST-PMT-DT     TO
 16207                         OC-1ST-PMT-DT
 16208                 END-IF
 16209                 MOVE PB-C-LF-CANCEL-DT      TO
 16210                         OC-LF-CANCEL-DT
 16211                 MOVE PB-C-LF-CANCEL-AMT     TO
 16212                         OC-LF-CANCEL-AMT
 16213                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 16214                         OC-LF-ITD-CANCEL-AMT
 16215                 MOVE PB-C-AH-CANCEL-DT      TO
 16216                         OC-AH-CANCEL-DT
 16217                 MOVE PB-C-AH-CANCEL-AMT     TO
 16218                         OC-AH-CANCEL-AMT
 16219                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 16220                         OC-AH-ITD-CANCEL-AMT
 16221                 MOVE 'Y'                    TO
 16222                         OC-CANCEL-TRAN-IND
 16223                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16224                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16225                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16226                 IF ERMAIL-FOUND
 16227                    MOVE MA-CRED-BENE-NAME
 16228                                 TO OC-CRED-BENE-NAME
 16229                 END-IF
 16230                 IF NOT CERT-TRL-REC-NOT-FOUND
 16231                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16232                           OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 295
* EL6311.cbl
 16233                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16234                           OC-JNT-AGE-DEFAULT-FLAG
 16235                 END-IF
 16236
 16237* EXEC CICS REWRITE
 16238*                   DATASET   ('ELCRTO')
 16239*                   FROM      (ORIGINAL-CERTIFICATE)
 16240*                   RESP      (WS-RESPONSE)
 16241*                END-EXEC
 16242     MOVE LENGTH OF
 16243      ORIGINAL-CERTIFICATE
 16244       TO DFHEIV11
 16245     MOVE 'ELCRTO' TO DFHEIV1
 16246*    MOVE '&& L                  %  N#00014411' TO DFHEIV0
 16247     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16248     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16249     MOVE X'204E233030303134343131' TO DFHEIV0(25:11)
 16250     CALL 'kxdfhei1' USING DFHEIV0,
 16251           DFHEIV1,
 16252           ORIGINAL-CERTIFICATE,
 16253           DFHEIV11,
 16254           DFHEIV99
 16255     MOVE EIBRESP  TO WS-RESPONSE
 16256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16257                 display ' just rewrote ' ws-response
 16258              END-IF
 16259           END-IF
 16260        ELSE
 16261           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 16262           MOVE 'OC'             TO OC-RECORD-ID
 16263           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 16264           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 16265           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 16266           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16267           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16268           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16269           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16270           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16271           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16272           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16273           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16274           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16275           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16276           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16277           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16278           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16279           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16280           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16281           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16282           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16283           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16284           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16285           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16286           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16287           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16288           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16289           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16290           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 296
* EL6311.cbl
 16291           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16292           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16293           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16294           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16295           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16296           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16297           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16298           IF ERMAIL-FOUND
 16299              MOVE MA-CRED-BENE-NAME
 16300                                 TO OC-CRED-BENE-NAME
 16301           END-IF
 16302           IF NOT CERT-TRL-REC-NOT-FOUND
 16303              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16304                           OC-INS-AGE-DEFAULT-FLAG
 16305              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16306                           OC-JNT-AGE-DEFAULT-FLAG
 16307           END-IF
 16308           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 16309
 16310* EXEC CICS WRITE
 16311*             DATASET   ('ELCRTO')
 16312*             FROM      (ORIGINAL-CERTIFICATE)
 16313*             RIDFLD    (OC-CONTROL-PRIMARY)
 16314*             RESP      (WS-RESPONSE)
 16315*          END-EXEC
 16316     MOVE LENGTH OF
 16317      ORIGINAL-CERTIFICATE
 16318       TO DFHEIV11
 16319     MOVE 'ELCRTO' TO DFHEIV1
 16320*    MOVE '&$ L                  ''  N#00014468' TO DFHEIV0
 16321     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16322     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16323     MOVE X'204E233030303134343638' TO DFHEIV0(25:11)
 16324     CALL 'kxdfhei1' USING DFHEIV0,
 16325           DFHEIV1,
 16326           ORIGINAL-CERTIFICATE,
 16327           DFHEIV11,
 16328           OC-CONTROL-PRIMARY,
 16329           DFHEIV99,
 16330           DFHEIV99
 16331     MOVE EIBRESP  TO WS-RESPONSE
 16332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16333        END-IF
 16334     ELSE
 16335        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 16336        MOVE 'OC'                TO OC-RECORD-ID
 16337        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16338                                 TO OC-CONTROL-PRIMARY (1:33)
 16339        MOVE 'I'                 TO OC-RECORD-TYPE
 16340        MOVE +4096               TO OC-KEY-SEQ-NO
 16341        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 16342        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 16343        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 16344        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16345        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16346        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16347        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16348        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 297
* EL6311.cbl
 16349        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16350        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16351        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16352        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16353        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16354        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16355        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16356        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16357        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16358        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16359        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16360        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16361        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16362        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16363        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16364        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16365        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16366        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16367        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16368        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16369        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16370        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16371        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16372        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16373        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16374        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16375        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16376        IF ERMAIL-FOUND
 16377           MOVE MA-CRED-BENE-NAME
 16378                                 TO OC-CRED-BENE-NAME
 16379        END-IF
 16380        IF NOT CERT-TRL-REC-NOT-FOUND
 16381           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16382                           OC-INS-AGE-DEFAULT-FLAG
 16383           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16384                           OC-JNT-AGE-DEFAULT-FLAG
 16385        END-IF
 16386        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16387
 16388
 16389* EXEC CICS WRITE
 16390*          DATASET   ('ELCRTO')
 16391*          FROM      (ORIGINAL-CERTIFICATE)
 16392*          RIDFLD    (OC-CONTROL-PRIMARY)
 16393*          RESP      (WS-RESPONSE)
 16394*       END-EXEC
 16395     MOVE LENGTH OF
 16396      ORIGINAL-CERTIFICATE
 16397       TO DFHEIV11
 16398     MOVE 'ELCRTO' TO DFHEIV1
 16399*    MOVE '&$ L                  ''  N#00014529' TO DFHEIV0
 16400     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16401     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16402     MOVE X'204E233030303134353239' TO DFHEIV0(25:11)
 16403     CALL 'kxdfhei1' USING DFHEIV0,
 16404           DFHEIV1,
 16405           ORIGINAL-CERTIFICATE,
 16406           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 298
* EL6311.cbl
 16407           OC-CONTROL-PRIMARY,
 16408           DFHEIV99,
 16409           DFHEIV99
 16410     MOVE EIBRESP  TO WS-RESPONSE
 16411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16412     END-IF.
 16413
 16414 2376-BYPASS-CRTO.
 16415******************************************************************
 16416*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16417******************************************************************
 16418
 16419
 16420* EXEC CICS HANDLE CONDITION
 16421*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16422*    END-EXEC.
 16423*    MOVE '"$I                   ! 7 #00014542' TO DFHEIV0
 16424     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16425     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16426     MOVE X'3720233030303134353432' TO DFHEIV0(25:11)
 16427     CALL 'kxdfhei1' USING DFHEIV0
 16428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16429
 16430
 16431
 16432* EXEC CICS READ
 16433*        INTO    (PENDING-BUSINESS)
 16434*        DATASET (FILE-ID-ERPNDB)
 16435*        RIDFLD  (ERPNDB-KEY)
 16436*        UPDATE
 16437*    END-EXEC.
 16438     MOVE LENGTH OF
 16439      PENDING-BUSINESS
 16440       TO DFHEIV11
 16441*    MOVE '&"IL       EU         (   #00014546' TO DFHEIV0
 16442     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16443     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16444     MOVE X'2020233030303134353436' TO DFHEIV0(25:11)
 16445     CALL 'kxdfhei1' USING DFHEIV0,
 16446           FILE-ID-ERPNDB,
 16447           PENDING-BUSINESS,
 16448           DFHEIV11,
 16449           ERPNDB-KEY,
 16450           DFHEIV99,
 16451           DFHEIV99,
 16452           DFHEIV99
 16453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16454
 16455
 16456     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16457     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16458     MOVE 'B'                    TO JP-RECORD-TYPE.
 16459     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16460
 16461     PERFORM 8400-LOG-JOURNAL-RECORD.
 16462
 16463     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16464
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 299
* EL6311.cbl
 16465
 16466* EXEC CICS REWRITE
 16467*        DATASET (FILE-ID-ERPNDB)
 16468*        FROM    (PENDING-BUSINESS)
 16469*    END-EXEC.
 16470     MOVE LENGTH OF
 16471      PENDING-BUSINESS
 16472       TO DFHEIV11
 16473*    MOVE '&& L                  %   #00014562' TO DFHEIV0
 16474     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16475     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16476     MOVE X'2020233030303134353632' TO DFHEIV0(25:11)
 16477     CALL 'kxdfhei1' USING DFHEIV0,
 16478           FILE-ID-ERPNDB,
 16479           PENDING-BUSINESS,
 16480           DFHEIV11,
 16481           DFHEIV99
 16482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16483
 16484
 16485     MOVE 'C'                    TO JP-RECORD-TYPE.
 16486     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16487
 16488     PERFORM 8400-LOG-JOURNAL-RECORD.
 16489
 16490     IF WS-ERRORS-PRESENT
 16491         GO TO 3900-RE-DISPLAY-RECORD.
 16492
 16493     MOVE ZEROS                  TO EMI-ERROR
 16494     MOVE -1                     TO CMAINTL
 16495     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16496     GO TO 3900-RE-DISPLAY-RECORD.
 16497
 16498 2380-BATCH-HDR-NOT-FOUND.
 16499     MOVE -1                     TO BMAINTL.
 16500     MOVE ER-7450                TO EMI-ERROR.
 16501     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16502     GO TO 8200-SEND-DATAONLY.
 16503
 16504 2385-REC-NOT-FOUND.
 16505     MOVE -1                     TO BMAINTL.
 16506     MOVE ER-7451                TO EMI-ERROR.
 16507     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16508     GO TO 8200-SEND-DATAONLY.
 16509
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 300
* EL6311.cbl
 16511
 16512******************************************************************
 16513*                                                                *
 16514*          D E L E T E   C A N C E L   R O U T I N E             *
 16515*                                                                *
 16516******************************************************************
 16517
 16518 2400-DELETE-CANCEL-ROUTINE.
 16519     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16520
 16521     IF CCHGL NOT = ZEROS
 16522        MOVE ER-2196             TO EMI-ERROR
 16523        MOVE AL-UABON            TO CMAINTA
 16524        MOVE -1                  TO CMAINTL
 16525        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16526        GO TO 8200-SEND-DATAONLY.
 16527
 16528
 16529* EXEC CICS HANDLE CONDITION
 16530*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16531*    END-EXEC.
 16532*    MOVE '"$I                   ! 8 #00014610' TO DFHEIV0
 16533     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16534     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16535     MOVE X'3820233030303134363130' TO DFHEIV0(25:11)
 16536     CALL 'kxdfhei1' USING DFHEIV0
 16537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16538
 16539
 16540     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16541     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16542     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16543
 16544
 16545* EXEC CICS READ
 16546*        SET     (ADDRESS OF PENDING-BUSINESS)
 16547*        DATASET (FILE-ID-ERPNDB)
 16548*        RIDFLD  (ERPNDB-KEY)
 16549*    END-EXEC.
 16550*    MOVE '&"S        E          (   #00014618' TO DFHEIV0
 16551     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16552     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16553     MOVE X'2020233030303134363138' TO DFHEIV0(25:11)
 16554     CALL 'kxdfhei1' USING DFHEIV0,
 16555           FILE-ID-ERPNDB,
 16556           DFHEIV20,
 16557           DFHEIV99,
 16558           ERPNDB-KEY,
 16559           DFHEIV99,
 16560           DFHEIV99,
 16561           DFHEIV99
 16562     SET ADDRESS OF PENDING-BUSINESS TO
 16563         DFHEIV20
 16564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16565
 16566
 16567     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16568
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 301
* EL6311.cbl
 16569     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16570
 16571     IF CSUFIXL NOT = ZEROS
 16572        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16573     ELSE
 16574        MOVE SPACE               TO WS-NEW-SUFFIX.
 16575
 16576     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16577
 16578     PERFORM 8600-DEEDIT.
 16579     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16580     MOVE '4'                    TO DC-OPTION-CODE.
 16581     PERFORM 9700-DATE-LINK.
 16582
 16583     IF DATE-CONVERSION-ERROR
 16584        MOVE ER-0348             TO EMI-ERROR
 16585        MOVE -1                  TO CEFFDTL
 16586        MOVE AL-UABON            TO CEFFDTA
 16587        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16588        GO TO 8200-SEND-DATAONLY
 16589     ELSE
 16590        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16591        MOVE AL-UANON            TO CEFFDTA
 16592        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16593
 16594
 16595* EXEC CICS HANDLE CONDITION
 16596*         NOTFND    (2490-RECORD-NOT-FOUND)
 16597*    END-EXEC.
 16598*    MOVE '"$I                   ! 9 #00014651' TO DFHEIV0
 16599     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16600     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16601     MOVE X'3920233030303134363531' TO DFHEIV0(25:11)
 16602     CALL 'kxdfhei1' USING DFHEIV0
 16603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16604
 16605
 16606
 16607* EXEC CICS READ
 16608*        SET     (ADDRESS OF PENDING-BUSINESS)
 16609*        DATASET (FILE-ID-ERPNDB)
 16610*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16611*        UPDATE
 16612*    END-EXEC.
 16613*    MOVE '&"S        EU         (   #00014655' TO DFHEIV0
 16614     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16615     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16616     MOVE X'2020233030303134363535' TO DFHEIV0(25:11)
 16617     CALL 'kxdfhei1' USING DFHEIV0,
 16618           FILE-ID-ERPNDB,
 16619           DFHEIV20,
 16620           DFHEIV99,
 16621           PI-PREV-CONTROL-PRIMARY,
 16622           DFHEIV99,
 16623           DFHEIV99,
 16624           DFHEIV99
 16625     SET ADDRESS OF PENDING-BUSINESS TO
 16626         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 302
* EL6311.cbl
 16627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16628
 16629
 16630     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16631        MOVE -1                 TO CMAINTL
 16632        MOVE ER-2197            TO EMI-ERROR
 16633        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16634        GO TO 8200-SEND-DATAONLY.
 16635
 16636     IF PB-BILLED-DT NOT = LOW-VALUES
 16637        MOVE -1                 TO CMAINTL
 16638        MOVE ER-2129            TO EMI-ERROR
 16639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16640        GO TO 8200-SEND-DATAONLY.
 16641
 16642     IF PB-CHG-COUNT NOT = ZEROS
 16643        MOVE ER-2336            TO EMI-ERROR
 16644        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16645        MOVE AL-UABON            TO CMAINTA
 16646        MOVE -1                  TO CMAINTL
 16647        GO TO 8200-SEND-DATAONLY.
 16648
 16649     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16650        PB-CHG-COUNT NOT = ZEROS
 16651        MOVE ER-2196             TO EMI-ERROR
 16652        MOVE AL-UABON            TO CMAINTA
 16653        MOVE -1                  TO CMAINTL
 16654        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16655        GO TO 8200-SEND-DATAONLY.
 16656
 16657     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16658        MOVE ER-2900 TO EMI-ERROR
 16659        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16660        MOVE AL-UABON         TO CMAINTA
 16661        MOVE -1               TO CMAINTL
 16662        GO TO 8200-SEND-DATAONLY.
 16663     move ' '                    to ws-stop-sw
 16664                                    ws-check-sw
 16665                                    ws-any-check-sw
 16666                                    ws-proc-check-sw
 16667                                    ws-chek-browse-sw
 16668
 16669     perform 2500-browse-checks  thru 2500-exit
 16670     if (i-have-processed-checks)
 16671        and (pb-c-refund-sw = 'Y')
 16672        move er-3446             to emi-error
 16673        perform 9900-error-format thru 9900-exit
 16674        move al-uabon            to cmainta
 16675        move -1                  to cmaintl
 16676        go to 8200-send-dataonly
 16677     end-if
 16678
 16679* EXEC CICS HANDLE CONDITION
 16680*         NOTFND  (2475-CONTINUE-DELETE)
 16681*    END-EXEC
 16682*    MOVE '"$I                   ! : #00014710' TO DFHEIV0
 16683     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16684     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 303
* EL6311.cbl
 16685     MOVE X'3A20233030303134373130' TO DFHEIV0(25:11)
 16686     CALL 'kxdfhei1' USING DFHEIV0
 16687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16688
 16689     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16690     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16691     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16692     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16693
 16694
 16695* EXEC CICS READ
 16696*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16697*        DATASET (FILE-ID-ELCERT)
 16698*        RIDFLD  (ELCERT-KEY)
 16699*        UPDATE
 16700*    END-EXEC.
 16701*    MOVE '&"S        EU         (   #00014719' TO DFHEIV0
 16702     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16703     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16704     MOVE X'2020233030303134373139' TO DFHEIV0(25:11)
 16705     CALL 'kxdfhei1' USING DFHEIV0,
 16706           FILE-ID-ELCERT,
 16707           DFHEIV20,
 16708           DFHEIV99,
 16709           ELCERT-KEY,
 16710           DFHEIV99,
 16711           DFHEIV99,
 16712           DFHEIV99
 16713     SET ADDRESS OF CERTIFICATE-MASTER TO
 16714         DFHEIV20
 16715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16716
 16717
 16718     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16719
 16720     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16721     MOVE 'B'                    TO JP-RECORD-TYPE.
 16722     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16723     PERFORM 8400-LOG-JOURNAL-RECORD.
 16724
 16725     IF PB-CI-LIVES NOT NUMERIC
 16726         MOVE ZERO                    TO PB-CI-LIVES.
 16727
 16728     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16729        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16730           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16731           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16732           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16733                                            CM-LF-CANCEL-DT
 16734           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16735        ELSE
 16736           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16737           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16738           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16739           MOVE PB-CI-LIVES              TO CM-LIVES.
 16740
 16741     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16742        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 304
* EL6311.cbl
 16743           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16744               MOVE CM-LF-STATUS-AT-CANCEL
 16745                                        TO CM-LF-CURRENT-STATUS
 16746               MOVE SPACE
 16747                                        TO CM-LF-STATUS-AT-CANCEL
 16748           ELSE
 16749               MOVE PB-CI-LF-POLICY-STATUS
 16750                                        TO CM-LF-CURRENT-STATUS
 16751        ELSE
 16752           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16753
 16754
 16755     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16756        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16757           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16758           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16759           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16760                                            CM-AH-CANCEL-DT
 16761           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16762        ELSE
 16763           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16764           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16765           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16766           MOVE PB-CI-LIVES              TO CM-LIVES.
 16767
 16768     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16769        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16770           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16771               MOVE CM-AH-STATUS-AT-CANCEL
 16772                                        TO CM-AH-CURRENT-STATUS
 16773               MOVE SPACE
 16774                                        TO CM-AH-STATUS-AT-CANCEL
 16775           ELSE
 16776               MOVE PB-CI-AH-POLICY-STATUS
 16777                                        TO CM-AH-CURRENT-STATUS
 16778        ELSE
 16779           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16780
 16781 2450-REWRITE-CERT.
 16782     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16783     MOVE 'C'                      TO JP-RECORD-TYPE.
 16784     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16785
 16786
 16787* EXEC CICS REWRITE
 16788*        DATASET  (FILE-ID-ELCERT)
 16789*        FROM     (CERTIFICATE-MASTER)
 16790*    END-EXEC.
 16791     MOVE LENGTH OF
 16792      CERTIFICATE-MASTER
 16793       TO DFHEIV11
 16794*    MOVE '&& L                  %   #00014794' TO DFHEIV0
 16795     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16796     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16797     MOVE X'2020233030303134373934' TO DFHEIV0(25:11)
 16798     CALL 'kxdfhei1' USING DFHEIV0,
 16799           FILE-ID-ELCERT,
 16800           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 305
* EL6311.cbl
 16801           DFHEIV11,
 16802           DFHEIV99
 16803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16804
 16805
 16806     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16807
 16808     PERFORM 8400-LOG-JOURNAL-RECORD.
 16809
 16810     move ' '                    to ws-stop-sw
 16811                                    ws-any-check-sw
 16812                                    ws-proc-check-sw
 16813                                    ws-chek-browse-sw
 16814
 16815     if i-have-checks
 16816        perform until i-say-stop
 16817           perform 2510-startbr-erchek
 16818                                 thru 2510-exit
 16819           if resp-normal
 16820              perform 2520-readnext-erchek
 16821                                 thru 2520-exit
 16822           end-if
 16823           if (not resp-normal)
 16824              or (pb-control-by-account (1:33) not =
 16825                 ch-control-primary (1:33))
 16826                 set i-say-stop to true
 16827           else
 16828              perform 2530-readupd-erchek
 16829                                 thru 2530-exit
 16830              if resp-normal
 16831                 perform 2540-delete-erchek
 16832                                 thru 2540-exit
 16833              end-if
 16834              if ws-chek-browse-sw = 'Y'
 16835                 perform 2525-endbr-erchek
 16836                                 thru 2525-exit
 16837                 move ' '        to ws-chek-browse-sw
 16838              end-if
 16839           end-if
 16840        end-perform
 16841     end-if
 16842
 16843     if ws-chek-browse-sw = 'Y'
 16844        perform 2525-endbr-erchek thru 2525-exit
 16845     end-if
 16846     .
 16847 2475-CONTINUE-DELETE.
 16848     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16849     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16850
 16851     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16852     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16853
 16854     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16855
 16856     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16857     MOVE 'D'                    TO JP-RECORD-TYPE
 16858     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 306
* EL6311.cbl
 16859
 16860
 16861* EXEC CICS DELETE
 16862*        DATASET    (FILE-ID-ERPNDB)
 16863*    END-EXEC.
 16864*    MOVE '&(                    &   #00014853' TO DFHEIV0
 16865     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16866     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16867     MOVE X'2020233030303134383533' TO DFHEIV0(25:11)
 16868     CALL 'kxdfhei1' USING DFHEIV0,
 16869           FILE-ID-ERPNDB,
 16870           DFHEIV99,
 16871           DFHEIV99,
 16872           DFHEIV99,
 16873           DFHEIV99
 16874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16875
 16876
 16877     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16878
 16879     PERFORM 8400-LOG-JOURNAL-RECORD.
 16880
 16881     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16882     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16883
 16884
 16885* EXEC CICS HANDLE CONDITION
 16886*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16887*    END-EXEC.
 16888*    MOVE '"$I                   ! ; #00014864' TO DFHEIV0
 16889     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16890     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16891     MOVE X'3B20233030303134383634' TO DFHEIV0(25:11)
 16892     CALL 'kxdfhei1' USING DFHEIV0
 16893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16894
 16895
 16896
 16897* EXEC CICS READ
 16898*        SET     (ADDRESS OF PENDING-BUSINESS)
 16899*        DATASET (FILE-ID-ERPNDB)
 16900*        RIDFLD  (ERPNDB-KEY)
 16901*        UPDATE
 16902*    END-EXEC.
 16903*    MOVE '&"S        EU         (   #00014868' TO DFHEIV0
 16904     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16905     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16906     MOVE X'2020233030303134383638' TO DFHEIV0(25:11)
 16907     CALL 'kxdfhei1' USING DFHEIV0,
 16908           FILE-ID-ERPNDB,
 16909           DFHEIV20,
 16910           DFHEIV99,
 16911           ERPNDB-KEY,
 16912           DFHEIV99,
 16913           DFHEIV99,
 16914           DFHEIV99
 16915     SET ADDRESS OF PENDING-BUSINESS TO
 16916         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 307
* EL6311.cbl
 16917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16918
 16919
 16920     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16921     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16922
 16923     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16924        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16925        MOVE 'D'                 TO JP-RECORD-TYPE
 16926        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16927
 16928* EXEC CICS DELETE
 16929*            DATASET    (FILE-ID-ERPNDB)
 16930*       END-EXEC
 16931*    MOVE '&(                    &   #00014882' TO DFHEIV0
 16932     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16933     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16934     MOVE X'2020233030303134383832' TO DFHEIV0(25:11)
 16935     CALL 'kxdfhei1' USING DFHEIV0,
 16936           FILE-ID-ERPNDB,
 16937           DFHEIV99,
 16938           DFHEIV99,
 16939           DFHEIV99,
 16940           DFHEIV99
 16941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16942        PERFORM 8400-LOG-JOURNAL-RECORD
 16943     ELSE
 16944        MOVE 'B'                 TO JP-RECORD-TYPE
 16945        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16946        PERFORM 8400-LOG-JOURNAL-RECORD
 16947        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16948        MOVE 'C'                 TO JP-RECORD-TYPE
 16949        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16950
 16951* EXEC CICS REWRITE
 16952*            DATASET    (FILE-ID-ERPNDB)
 16953*            FROM       (PENDING-BUSINESS)
 16954*       END-EXEC
 16955     MOVE LENGTH OF
 16956      PENDING-BUSINESS
 16957       TO DFHEIV11
 16958*    MOVE '&& L                  %   #00014893' TO DFHEIV0
 16959     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16960     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16961     MOVE X'2020233030303134383933' TO DFHEIV0(25:11)
 16962     CALL 'kxdfhei1' USING DFHEIV0,
 16963           FILE-ID-ERPNDB,
 16964           PENDING-BUSINESS,
 16965           DFHEIV11,
 16966           DFHEIV99
 16967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16968        PERFORM 8400-LOG-JOURNAL-RECORD.
 16969
 16970******************************************************************
 16971*                                                                *
 16972*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16973*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16974*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 308
* EL6311.cbl
 16975******************************************************************
 16976
 16977     IF NOT PI-AR-PROCESSING
 16978        GO TO 2480-DELETE-FINISHED.
 16979
 16980     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16981        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16982        NEXT SENTENCE
 16983     ELSE
 16984        GO TO 2480-DELETE-FINISHED.
 16985
 16986
 16987* EXEC CICS HANDLE CONDITION
 16988*         NOTFND    (2480-DELETE-FINISHED)
 16989*    END-EXEC.
 16990*    MOVE '"$I                   ! < #00014915' TO DFHEIV0
 16991     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16992     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16993     MOVE X'3C20233030303134393135' TO DFHEIV0(25:11)
 16994     CALL 'kxdfhei1' USING DFHEIV0
 16995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16996
 16997
 16998     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16999     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 17000
 17001
 17002* EXEC CICS READ
 17003*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 17004*        DATASET (FILE-ID-ERRQST)
 17005*        RIDFLD  (ERRQST-KEY)
 17006*        UPDATE
 17007*    END-EXEC.
 17008*    MOVE '&"S        EU         (   #00014922' TO DFHEIV0
 17009     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17010     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17011     MOVE X'2020233030303134393232' TO DFHEIV0(25:11)
 17012     CALL 'kxdfhei1' USING DFHEIV0,
 17013           FILE-ID-ERRQST,
 17014           DFHEIV20,
 17015           DFHEIV99,
 17016           ERRQST-KEY,
 17017           DFHEIV99,
 17018           DFHEIV99,
 17019           DFHEIV99
 17020     SET ADDRESS OF AR-REQUEST-RECORD TO
 17021         DFHEIV20
 17022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17023
 17024
 17025     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17026
 17027     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 17028
 17029     MOVE 'D'                      TO JP-RECORD-TYPE.
 17030     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 17031
 17032
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 309
* EL6311.cbl
 17033* EXEC CICS DELETE
 17034*         DATASET    (FILE-ID-ERRQST)
 17035*    END-EXEC.
 17036*    MOVE '&(                    &   #00014936' TO DFHEIV0
 17037     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17038     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17039     MOVE X'2020233030303134393336' TO DFHEIV0(25:11)
 17040     CALL 'kxdfhei1' USING DFHEIV0,
 17041           FILE-ID-ERRQST,
 17042           DFHEIV99,
 17043           DFHEIV99,
 17044           DFHEIV99,
 17045           DFHEIV99
 17046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17047
 17048
 17049     PERFORM 8400-LOG-JOURNAL-RECORD.
 17050
 17051 2480-DELETE-FINISHED.
 17052     MOVE ZEROS                  TO EMI-ERROR.
 17053     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17054     MOVE LOW-VALUES             TO EL631CI.
 17055     MOVE -1                     TO CMAINTL.
 17056     GO TO 8100-SEND-INITIAL-MAP.
 17057
 17058 2485-BATCH-HDR-NOT-FOUND.
 17059     MOVE -1                     TO CMAINTL
 17060     MOVE AL-UABON               TO CMAINTA.
 17061     MOVE ER-7450                TO EMI-ERROR.
 17062     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17063     GO TO 8200-SEND-DATAONLY.
 17064
 17065 2490-RECORD-NOT-FOUND.
 17066     MOVE -1                     TO CMAINTL
 17067     MOVE AL-UABON               TO CMAINTA.
 17068     MOVE ER-7451                TO EMI-ERROR.
 17069     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17070     GO TO 8200-SEND-DATAONLY.
 17071***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 17072***                                                            ***
 17073***     2500  B R O W S E   C H E C K S                        ***
 17074***  We perform this routine from 2 different places.          ***
 17075***  1. If the user changes the refund amount on a cancel, we  ***
 17076***    want to.........                                        ***
 17077***    a. determine if prior checks have been processed        ***
 17078***    b. If the amt is larger, display message instructing    ***
 17079***     them to create another check to make up the difference.***
 17080***    c. If the amt is less, do not allow the change and      ***
 17081***     display a FATAL error suggesting they deal with check  ***
 17082***     records befor continuing.                              ***
 17083***  2. If the user wants to delete a cancel record we......   ***
 17084***    a. browse through all the checks and if there is a      ***
 17085***     processed check, send FATAL message.                   ***
 17086***    b. If there is a non-released check, then delete that   ***
 17087***     check after you delete the pending cancel record.      ***
 17088***                                                            ***
 17089***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 17090
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 310
* EL6311.cbl
 17091 2500-browse-checks.
 17092
 17093     perform 2510-startbr-erchek thru 2510-exit
 17094
 17095     if not resp-normal
 17096        go to 2500-exit
 17097     end-if
 17098
 17099     perform until i-say-stop
 17100        perform 2520-readnext-erchek
 17101                                 thru 2520-exit
 17102        if (not resp-normal)
 17103           or (pb-control-by-account (1:33) not =
 17104              ch-control-primary (1:33))
 17105              set i-say-stop to true
 17106        else
 17107           set i-have-a-check-period to true
 17108           if (ch-approval-status) = ' '
 17109              and (ch-void-dt = low-values)
 17110              and (ch-released-dt = low-values)
 17111              set i-have-checks to true
 17112           else
 17113              if ch-void-dt = low-values
 17114                 set i-have-processed-checks to true
 17115              end-if
 17116           end-if
 17117           if (ch-credit-accept-dt = low-values)
 17118              and (ch-void-dt = low-values)
 17119              and (ch-approval-status = ' ' OR 'P' OR 'A')
 17120              if (ch-check-origin-sw not = 'R')
 17121                 and (pb-record-type = '2')
 17122                 continue
 17123              else
 17124                 compute ws-check-amts =
 17125                    ws-check-amts + ch-amount-paid
 17126              end-if
 17127           end-if
 17128        end-if
 17129     end-perform
 17130
 17131     if ws-chek-browse-sw = 'Y'
 17132        perform 2525-endbr-erchek thru 2525-exit
 17133     end-if
 17134
 17135    .
 17136 2500-exit.
 17137     exit.
 17138
 17139 2510-startbr-erchek.
 17140
 17141     move pb-control-by-account  to erchek-key
 17142     move +0                     to chek-record-seq
 17143
 17144
 17145* exec cics startbr
 17146*       dataset   ('ERCHEK')
 17147*       ridfld    (erchek-key)
 17148*       gteq
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 311
* EL6311.cbl
 17149*       resp      (ws-response)
 17150*    end-exec
 17151     MOVE 'ERCHEK' TO DFHEIV1
 17152     MOVE 0
 17153       TO DFHEIV11
 17154*    MOVE '&,         G          &  N#00015035' TO DFHEIV0
 17155     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17156     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17157     MOVE X'204E233030303135303335' TO DFHEIV0(25:11)
 17158     CALL 'kxdfhei1' USING DFHEIV0,
 17159           DFHEIV1,
 17160           erchek-key,
 17161           DFHEIV99,
 17162           DFHEIV11,
 17163           DFHEIV99
 17164     MOVE EIBRESP  TO ws-response
 17165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17166
 17167     IF RESP-NORMAL
 17168        move 'Y'                 to ws-chek-browse-sw
 17169     end-if
 17170
 17171     .
 17172 2510-exit.
 17173     exit.
 17174
 17175 2520-readnext-erchek.
 17176
 17177
 17178* EXEC CICS READNEXT
 17179*       SET     (ADDRESS OF CHECK-RECORDS)
 17180*       DATASET ('ERCHEK')
 17181*       RIDFLD  (ERCHEK-KEY)
 17182*       RESP    (WS-RESPONSE)
 17183*    END-EXEC
 17184     MOVE 'ERCHEK' TO DFHEIV1
 17185     MOVE 0
 17186       TO DFHEIV11
 17187*    MOVE '&.S                   )  N#00015052' TO DFHEIV0
 17188     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17189     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17190     MOVE X'204E233030303135303532' TO DFHEIV0(25:11)
 17191     CALL 'kxdfhei1' USING DFHEIV0,
 17192           DFHEIV1,
 17193           DFHEIV20,
 17194           DFHEIV99,
 17195           ERCHEK-KEY,
 17196           DFHEIV99,
 17197           DFHEIV11,
 17198           DFHEIV99,
 17199           DFHEIV99
 17200     SET ADDRESS OF CHECK-RECORDS TO
 17201         DFHEIV20
 17202     MOVE EIBRESP  TO WS-RESPONSE
 17203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17204
 17205     .
 17206 2520-exit.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 312
* EL6311.cbl
 17207     exit.
 17208
 17209 2525-endbr-erchek.
 17210
 17211
 17212* exec cics endbr
 17213*       dataset  ('ERCHEK')
 17214*    end-exec
 17215     MOVE 'ERCHEK' TO DFHEIV1
 17216     MOVE 0
 17217       TO DFHEIV11
 17218*    MOVE '&2                    $   #00015065' TO DFHEIV0
 17219     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17220     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17221     MOVE X'2020233030303135303635' TO DFHEIV0(25:11)
 17222     CALL 'kxdfhei1' USING DFHEIV0,
 17223           DFHEIV1,
 17224           DFHEIV11,
 17225           DFHEIV99
 17226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17227
 17228     .
 17229 2525-exit.
 17230     exit.
 17231
 17232 2530-readupd-erchek.
 17233
 17234
 17235* EXEC CICS READ
 17236*       UPDATE
 17237*       SET     (ADDRESS OF CHECK-RECORDS)
 17238*       DATASET ('ERCHEK')
 17239*       RIDFLD  (ERCHEK-KEY)
 17240*       RESP    (WS-RESPONSE)
 17241*    END-EXEC
 17242     MOVE 'ERCHEK' TO DFHEIV1
 17243*    MOVE '&"S        EU         (  N#00015075' TO DFHEIV0
 17244     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17245     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17246     MOVE X'204E233030303135303735' TO DFHEIV0(25:11)
 17247     CALL 'kxdfhei1' USING DFHEIV0,
 17248           DFHEIV1,
 17249           DFHEIV20,
 17250           DFHEIV99,
 17251           ERCHEK-KEY,
 17252           DFHEIV99,
 17253           DFHEIV99,
 17254           DFHEIV99
 17255     SET ADDRESS OF CHECK-RECORDS TO
 17256         DFHEIV20
 17257     MOVE EIBRESP  TO WS-RESPONSE
 17258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17259
 17260     .
 17261 2530-exit.
 17262     exit.
 17263
 17264 2540-delete-erchek.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 313
* EL6311.cbl
 17265
 17266
 17267* EXEC CICS DELETE
 17268*       DATASET ('ERCHEK')
 17269*       RESP    (WS-RESPONSE)
 17270*    END-EXEC
 17271     MOVE 'ERCHEK' TO DFHEIV1
 17272*    MOVE '&(                    &  N#00015089' TO DFHEIV0
 17273     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17274     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17275     MOVE X'204E233030303135303839' TO DFHEIV0(25:11)
 17276     CALL 'kxdfhei1' USING DFHEIV0,
 17277           DFHEIV1,
 17278           DFHEIV99,
 17279           DFHEIV99,
 17280           DFHEIV99,
 17281           DFHEIV99
 17282     MOVE EIBRESP  TO WS-RESPONSE
 17283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17284
 17285     .
 17286 2540-exit.
 17287     exit.
 17288***************************************************************
 17289*                                                             *
 17290*       B U I L D   C O R R E C T I O N   R E C O R D         *
 17291*                                                             *
 17292***************************************************************
 17293
 17294***************************************************************
 17295*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 17296*     AN ALREADY BILLED RECORD.                               *
 17297***************************************************************
 17298
 17299 2700-BUILD-CORRECTION-RECORD.
 17300     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17301     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17302     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17303     MOVE '5'                    TO DC-OPTION-CODE.
 17304     PERFORM 9700-DATE-LINK.
 17305     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17306
 17307     IF PB-CHG-COUNT = ZEROS
 17308        MOVE +1                  TO WS-SEQ-SAVE
 17309     ELSE
 17310        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 17311
 17312     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 17313     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 17314
 17315     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 17316
 17317     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17318     MOVE 'A'                    TO JP-RECORD-TYPE.
 17319     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17320
 17321
 17322* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 314
* EL6311.cbl
 17323*        DATASET    (FILE-ID-ERPNDB)
 17324*        FROM       (PENDING-BUSINESS)
 17325*        RIDFLD     (PB-CONTROL-PRIMARY)
 17326*    END-EXEC.
 17327     MOVE LENGTH OF
 17328      PENDING-BUSINESS
 17329       TO DFHEIV11
 17330*    MOVE '&$ L                  ''   #00015130' TO DFHEIV0
 17331     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17332     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17333     MOVE X'2020233030303135313330' TO DFHEIV0(25:11)
 17334     CALL 'kxdfhei1' USING DFHEIV0,
 17335           FILE-ID-ERPNDB,
 17336           PENDING-BUSINESS,
 17337           DFHEIV11,
 17338           PB-CONTROL-PRIMARY,
 17339           DFHEIV99,
 17340           DFHEIV99
 17341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17342
 17343
 17344     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17345
 17346     PERFORM 8400-LOG-JOURNAL-RECORD.
 17347
 17348 2799-EXIT.
 17349      EXIT.
 17350
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 315
* EL6311.cbl
 17352
 17353******************************************************************
 17354*                                                                *
 17355*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17356*                                                                *
 17357******************************************************************
 17358
 17359 2800-REWRITE-ISSUE-CERT-KEY.
 17360     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17361
 17362     IF  BCERTNOL GREATER THAN ZEROS
 17363         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17364
 17365     IF  BSUFIXL  GREATER THAN ZEROS
 17366         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17367
 17368     IF  BEFFDTL  GREATER THAN ZEROS
 17369         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17370
 17371 2810-READ-BY-ACCOUNT.
 17372
 17373* EXEC CICS HANDLE CONDITION
 17374*         NOTFND    (2820-PROCESS-REWRITE)
 17375*    END-EXEC.
 17376*    MOVE '"$I                   ! = #00015164' TO DFHEIV0
 17377     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17378     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17379     MOVE X'3D20233030303135313634' TO DFHEIV0(25:11)
 17380     CALL 'kxdfhei1' USING DFHEIV0
 17381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17382
 17383
 17384***  read pndb using new key
 17385
 17386* EXEC CICS READ
 17387*        SET     (ADDRESS OF PENDING-BUSINESS)
 17388*        DATASET (FILE-ID-ERPNDB2)
 17389*        RIDFLD  (ERPNDB-ALT-KEY)
 17390*    END-EXEC.
 17391*    MOVE '&"S        E          (   #00015169' TO DFHEIV0
 17392     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17393     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17394     MOVE X'2020233030303135313639' TO DFHEIV0(25:11)
 17395     CALL 'kxdfhei1' USING DFHEIV0,
 17396           FILE-ID-ERPNDB2,
 17397           DFHEIV20,
 17398           DFHEIV99,
 17399           ERPNDB-ALT-KEY,
 17400           DFHEIV99,
 17401           DFHEIV99,
 17402           DFHEIV99
 17403     SET ADDRESS OF PENDING-BUSINESS TO
 17404         DFHEIV20
 17405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17406
 17407
 17408     GO TO 2890-DUPLICATE-RECORD.
 17409
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 316
* EL6311.cbl
 17410  2820-PROCESS-REWRITE.
 17411
 17412* EXEC CICS HANDLE CONDITION
 17413*         NOTFND    (2885-RECORD-MISSING)
 17414*    END-EXEC.
 17415*    MOVE '"$I                   ! > #00015178' TO DFHEIV0
 17416     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17417     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17418     MOVE X'3E20233030303135313738' TO DFHEIV0(25:11)
 17419     CALL 'kxdfhei1' USING DFHEIV0
 17420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17421
 17422
 17423     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17424
 17425***  read pndb using original key
 17426
 17427* EXEC CICS READ
 17428*        SET     (ADDRESS OF PENDING-BUSINESS)
 17429*        DATASET (FILE-ID-ERPNDB)
 17430*        RIDFLD  (ERPNDB-KEY)
 17431*        UPDATE
 17432*    END-EXEC.
 17433*    MOVE '&"S        EU         (   #00015185' TO DFHEIV0
 17434     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17435     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17436     MOVE X'2020233030303135313835' TO DFHEIV0(25:11)
 17437     CALL 'kxdfhei1' USING DFHEIV0,
 17438           FILE-ID-ERPNDB,
 17439           DFHEIV20,
 17440           DFHEIV99,
 17441           ERPNDB-KEY,
 17442           DFHEIV99,
 17443           DFHEIV99,
 17444           DFHEIV99
 17445     SET ADDRESS OF PENDING-BUSINESS TO
 17446         DFHEIV20
 17447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17448
 17449
 17450     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17451     MOVE 'D'                    TO JP-RECORD-TYPE.
 17452     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17453     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17454
 17455     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17456
 17457     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17458     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17459     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17460
 17461***  delete pndb using original key
 17462
 17463* EXEC CICS DELETE
 17464*        DATASET    (FILE-ID-ERPNDB)
 17465*    END-EXEC.
 17466*    MOVE '&(                    &   #00015204' TO DFHEIV0
 17467     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 317
* EL6311.cbl
 17468     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17469     MOVE X'2020233030303135323034' TO DFHEIV0(25:11)
 17470     CALL 'kxdfhei1' USING DFHEIV0,
 17471           FILE-ID-ERPNDB,
 17472           DFHEIV99,
 17473           DFHEIV99,
 17474           DFHEIV99,
 17475           DFHEIV99
 17476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17477
 17478
 17479     PERFORM 8400-LOG-JOURNAL-RECORD.
 17480
 17481
 17482* EXEC CICS GETMAIN
 17483*        SET      (ADDRESS OF PENDING-BUSINESS)
 17484*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17485*        INITIMG  (GETMAIN-SPACE)
 17486*    END-EXEC.
 17487*    MOVE ',"IL                  $   #00015210' TO DFHEIV0
 17488     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17489     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17490     MOVE X'2020233030303135323130' TO DFHEIV0(25:11)
 17491     CALL 'kxdfhei1' USING DFHEIV0,
 17492           DFHEIV20,
 17493           ERPNDB-RECORD-LENGTH,
 17494           GETMAIN-SPACE
 17495     SET ADDRESS OF PENDING-BUSINESS TO
 17496         DFHEIV20
 17497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17498
 17499
 17500***  pending-business now has original record
 17501     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17502
 17503
 17504* EXEC CICS HANDLE CONDITION
 17505*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 17506*    END-EXEC.
 17507*    MOVE '"$I                   ! ? #00015219' TO DFHEIV0
 17508     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17509     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17510     MOVE X'3F20233030303135323139' TO DFHEIV0(25:11)
 17511     CALL 'kxdfhei1' USING DFHEIV0
 17512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17513
 17514
 17515***  read elcert using original key
 17516
 17517* EXEC CICS READ
 17518*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17519*        DATASET (FILE-ID-ELCERT)
 17520*        RIDFLD  (ELCERT-KEY)
 17521*        UPDATE
 17522*    END-EXEC.
 17523*    MOVE '&"S        EU         (   #00015224' TO DFHEIV0
 17524     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17525     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 318
* EL6311.cbl
 17526     MOVE X'2020233030303135323234' TO DFHEIV0(25:11)
 17527     CALL 'kxdfhei1' USING DFHEIV0,
 17528           FILE-ID-ELCERT,
 17529           DFHEIV20,
 17530           DFHEIV99,
 17531           ELCERT-KEY,
 17532           DFHEIV99,
 17533           DFHEIV99,
 17534           DFHEIV99
 17535     SET ADDRESS OF CERTIFICATE-MASTER TO
 17536         DFHEIV20
 17537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17538
 17539
 17540     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 17541     MOVE 'B'                    TO JP-RECORD-TYPE
 17542     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17543     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17544
 17545     IF INSURED-ADDR-PRESENT
 17546        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 17547
 17548     IF CERT-NOTES-ARE-NOT-PRESENT
 17549        MOVE SPACE               TO WS-CERT-NOTE-SW
 17550     ELSE
 17551        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 17552
 17553     IF CERT-ADDED-BATCH      OR
 17554        CERT-AND-CLAIM-ONLINE OR
 17555        CERT-WAS-CREATED-FOR-CLAIM
 17556        NEXT SENTENCE
 17557     ELSE
 17558        GO TO 2825-DELETE-CERTIFICATE.
 17559
 17560     PERFORM 8400-LOG-JOURNAL-RECORD.
 17561
 17562*********************************************************
 17563** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17564     IF CERT-ADDED-BATCH
 17565         GO TO 2822-REWRITE-ELCERT.
 17566*********************************************************
 17567
 17568     IF NO-CLAIM-ATTACHED
 17569        NEXT SENTENCE
 17570     ELSE
 17571        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17572        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17573
 17574 2822-REWRITE-ELCERT.
 17575     MOVE 'C'                    TO JP-RECORD-TYPE
 17576     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17577
 17578     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17579
 17580
 17581* EXEC CICS REWRITE
 17582*         DATASET    (FILE-ID-ELCERT)
 17583*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 319
* EL6311.cbl
 17584*    END-EXEC.
 17585     MOVE LENGTH OF
 17586      CERTIFICATE-MASTER
 17587       TO DFHEIV11
 17588*    MOVE '&& L                  %   #00015271' TO DFHEIV0
 17589     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17590     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17591     MOVE X'2020233030303135323731' TO DFHEIV0(25:11)
 17592     CALL 'kxdfhei1' USING DFHEIV0,
 17593           FILE-ID-ELCERT,
 17594           CERTIFICATE-MASTER,
 17595           DFHEIV11,
 17596           DFHEIV99
 17597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17598
 17599
 17600     PERFORM 8400-LOG-JOURNAL-RECORD.
 17601
 17602     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17603
 17604 2825-DELETE-CERTIFICATE.
 17605     MOVE 'D'                      TO JP-RECORD-TYPE.
 17606     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17607
 17608     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17609
 17610
 17611* EXEC CICS DELETE
 17612*         DATASET    (FILE-ID-ELCERT)
 17613*    END-EXEC.
 17614*    MOVE '&(                    &   #00015286' TO DFHEIV0
 17615     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17616     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17617     MOVE X'2020233030303135323836' TO DFHEIV0(25:11)
 17618     CALL 'kxdfhei1' USING DFHEIV0,
 17619           FILE-ID-ELCERT,
 17620           DFHEIV99,
 17621           DFHEIV99,
 17622           DFHEIV99,
 17623           DFHEIV99
 17624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17625
 17626
 17627     PERFORM 8400-LOG-JOURNAL-RECORD.
 17628
 17629******************************************************************
 17630*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17631******************************************************************
 17632
 17633     IF CERT-NOTES-ARE-PRESENT
 17634        NEXT SENTENCE
 17635     ELSE
 17636        GO TO 2827-DELETE-MAILING.
 17637
 17638
 17639* EXEC CICS HANDLE CONDITION
 17640*         NOTFND  (2827-DELETE-MAILING)
 17641*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 320
* EL6311.cbl
 17642*    MOVE '"$I                   ! @ #00015301' TO DFHEIV0
 17643     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17644     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17645     MOVE X'4020233030303135333031' TO DFHEIV0(25:11)
 17646     CALL 'kxdfhei1' USING DFHEIV0
 17647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17648
 17649
 17650
 17651* EXEC CICS READ
 17652*        EQUAL
 17653*        DATASET   (FILE-ID-ERNOTE)
 17654*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17655*        RIDFLD    (ELCERT-KEY)
 17656*        UPDATE
 17657*    END-EXEC.
 17658*    MOVE '&"S        EU         (   #00015305' TO DFHEIV0
 17659     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17660     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17661     MOVE X'2020233030303135333035' TO DFHEIV0(25:11)
 17662     CALL 'kxdfhei1' USING DFHEIV0,
 17663           FILE-ID-ERNOTE,
 17664           DFHEIV20,
 17665           DFHEIV99,
 17666           ELCERT-KEY,
 17667           DFHEIV99,
 17668           DFHEIV99,
 17669           DFHEIV99
 17670     SET ADDRESS OF CERTIFICATE-NOTE TO
 17671         DFHEIV20
 17672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17673
 17674
 17675     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17676     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17677     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17678
 17679     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17680
 17681
 17682* EXEC CICS DELETE
 17683*        DATASET   (FILE-ID-ERNOTE)
 17684*    END-EXEC.
 17685*    MOVE '&(                    &   #00015319' TO DFHEIV0
 17686     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17687     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17688     MOVE X'2020233030303135333139' TO DFHEIV0(25:11)
 17689     CALL 'kxdfhei1' USING DFHEIV0,
 17690           FILE-ID-ERNOTE,
 17691           DFHEIV99,
 17692           DFHEIV99,
 17693           DFHEIV99,
 17694           DFHEIV99
 17695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17696
 17697
 17698     PERFORM 8400-LOG-JOURNAL-RECORD.
 17699
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 321
* EL6311.cbl
 17700******************************************************************
 17701*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17702******************************************************************
 17703
 17704 2827-DELETE-MAILING.
 17705     IF CERT-ADDRESS-PRESENT
 17706        NEXT SENTENCE
 17707     ELSE
 17708        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17709
 17710
 17711* EXEC CICS HANDLE CONDITION
 17712*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17713*    END-EXEC.
 17714*    MOVE '"$I                   ! A #00015335' TO DFHEIV0
 17715     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17716     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17717     MOVE X'4120233030303135333335' TO DFHEIV0(25:11)
 17718     CALL 'kxdfhei1' USING DFHEIV0
 17719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17720
 17721
 17722     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17723
 17724
 17725* EXEC CICS READ
 17726*        EQUAL
 17727*        DATASET   (FILE-ID-ERMAIL)
 17728*        SET       (ADDRESS OF MAILING-DATA)
 17729*        RIDFLD    (ERMAIL-KEY)
 17730*        UPDATE
 17731*    END-EXEC.
 17732*    MOVE '&"S        EU         (   #00015341' TO DFHEIV0
 17733     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17734     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17735     MOVE X'2020233030303135333431' TO DFHEIV0(25:11)
 17736     CALL 'kxdfhei1' USING DFHEIV0,
 17737           FILE-ID-ERMAIL,
 17738           DFHEIV20,
 17739           DFHEIV99,
 17740           ERMAIL-KEY,
 17741           DFHEIV99,
 17742           DFHEIV99,
 17743           DFHEIV99
 17744     SET ADDRESS OF MAILING-DATA TO
 17745         DFHEIV20
 17746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17747
 17748
 17749     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17750     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17751     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17752
 17753     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17754
 17755
 17756* EXEC CICS DELETE
 17757*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 322
* EL6311.cbl
 17758*    END-EXEC.
 17759*    MOVE '&(                    &   #00015355' TO DFHEIV0
 17760     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17761     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17762     MOVE X'2020233030303135333535' TO DFHEIV0(25:11)
 17763     CALL 'kxdfhei1' USING DFHEIV0,
 17764           FILE-ID-ERMAIL,
 17765           DFHEIV99,
 17766           DFHEIV99,
 17767           DFHEIV99,
 17768           DFHEIV99
 17769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17770
 17771
 17772     PERFORM 8400-LOG-JOURNAL-RECORD.
 17773
 17774 2830-BUILD-NEW-ISSUE-RECORD.
 17775     MOVE SPACES                 TO ELCERT-KEY.
 17776
 17777     IF  BCERTNOL GREATER THAN ZEROS
 17778         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17779
 17780     IF  BSUFIXL  GREATER THAN ZEROS
 17781         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17782
 17783     IF BEFFDTL GREATER THAN ZEROS
 17784        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17785
 17786 2870-WRITE-PENDING-BUSINESS.
 17787     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17788     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17789     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17790     MOVE '5'                    TO DC-OPTION-CODE.
 17791     PERFORM 9700-DATE-LINK.
 17792     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17793
 17794     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17795
 17796     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17797     MOVE 'A'                    TO JP-RECORD-TYPE.
 17798     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17799
 17800
 17801* EXEC CICS WRITE
 17802*        DATASET  (FILE-ID-ERPNDB)
 17803*        FROM     (PENDING-BUSINESS)
 17804*        RIDFLD   (PB-CONTROL-PRIMARY)
 17805*    END-EXEC.
 17806     MOVE LENGTH OF
 17807      PENDING-BUSINESS
 17808       TO DFHEIV11
 17809*    MOVE '&$ L                  ''   #00015387' TO DFHEIV0
 17810     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17811     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17812     MOVE X'2020233030303135333837' TO DFHEIV0(25:11)
 17813     CALL 'kxdfhei1' USING DFHEIV0,
 17814           FILE-ID-ERPNDB,
 17815           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 323
* EL6311.cbl
 17816           DFHEIV11,
 17817           PB-CONTROL-PRIMARY,
 17818           DFHEIV99,
 17819           DFHEIV99
 17820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17821
 17822
 17823     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17824
 17825     PERFORM 8400-LOG-JOURNAL-RECORD.
 17826
 17827     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17828
 17829 2885-RECORD-MISSING.
 17830     MOVE -1                     TO BMAINTL
 17831     MOVE AL-UABON               TO BMAINTA
 17832     MOVE ER-2902                TO EMI-ERROR.
 17833     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17834     GO TO 8200-SEND-DATAONLY.
 17835
 17836 2890-DUPLICATE-RECORD.
 17837     MOVE -1                     TO BMAINTL.
 17838     MOVE AL-UABON               TO BCERTNOA.
 17839     MOVE AL-UNBON               TO BEFFDTA.
 17840     MOVE SPACE                  TO BMAINTI.
 17841
 17842     MOVE 1                      TO EMI-SUB
 17843                                    EMI-SWITCH1
 17844                                    EMI-SWITCH-AREA-1
 17845                                    EMI-SWITCH-AREA-2.
 17846
 17847     MOVE SPACES                 TO EMI-ERROR-LINES.
 17848
 17849
 17850* EXEC CICS SYNCPOINT ROLLBACK
 17851*    END-EXEC.
 17852*    MOVE '6"R                   !   #00015419' TO DFHEIV0
 17853     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17854     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17855     MOVE X'2020233030303135343139' TO DFHEIV0(25:11)
 17856     CALL 'kxdfhei1' USING DFHEIV0
 17857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17858
 17859
 17860     MOVE ER-2247                TO EMI-ERROR.
 17861     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17862     GO TO 8200-SEND-DATAONLY.
 17863
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 324
* EL6311.cbl
 17865
 17866******************************************************************
 17867*                                                                *
 17868*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17869*                                                                *
 17870******************************************************************
 17871
 17872 2900-REWRITE-CAN-CERT-KEY.
 17873     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17874
 17875     IF  CCERTNOL GREATER THAN ZEROS
 17876         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17877
 17878     IF  CSUFIXL  GREATER THAN ZEROS
 17879         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17880
 17881     IF  CEFFDTL  GREATER THAN ZEROS
 17882         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17883
 17884 2910-READ-BY-ACCOUNT.
 17885
 17886* EXEC CICS HANDLE CONDITION
 17887*         NOTFND    (2920-PROCESS-REWRITE)
 17888*    END-EXEC.
 17889*    MOVE '"$I                   ! B #00015447' TO DFHEIV0
 17890     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17891     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17892     MOVE X'4220233030303135343437' TO DFHEIV0(25:11)
 17893     CALL 'kxdfhei1' USING DFHEIV0
 17894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17895
 17896
 17897
 17898* EXEC CICS READ
 17899*        SET     (ADDRESS OF PENDING-BUSINESS)
 17900*        DATASET (FILE-ID-ERPNDB2)
 17901*        RIDFLD  (ERPNDB-ALT-KEY)
 17902*    END-EXEC.
 17903*    MOVE '&"S        E          (   #00015451' TO DFHEIV0
 17904     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17905     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17906     MOVE X'2020233030303135343531' TO DFHEIV0(25:11)
 17907     CALL 'kxdfhei1' USING DFHEIV0,
 17908           FILE-ID-ERPNDB2,
 17909           DFHEIV20,
 17910           DFHEIV99,
 17911           ERPNDB-ALT-KEY,
 17912           DFHEIV99,
 17913           DFHEIV99,
 17914           DFHEIV99
 17915     SET ADDRESS OF PENDING-BUSINESS TO
 17916         DFHEIV20
 17917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17918
 17919
 17920     GO TO 2990-DUPLICATE-RECORD.
 17921
 17922  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 325
* EL6311.cbl
 17923
 17924* EXEC CICS HANDLE CONDITION
 17925*         NOTFND    (2985-RECORD-MISSING)
 17926*    END-EXEC.
 17927*    MOVE '"$I                   ! C #00015460' TO DFHEIV0
 17928     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17929     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17930     MOVE X'4320233030303135343630' TO DFHEIV0(25:11)
 17931     CALL 'kxdfhei1' USING DFHEIV0
 17932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17933
 17934
 17935     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17936
 17937
 17938* EXEC CICS READ
 17939*        SET     (ADDRESS OF PENDING-BUSINESS)
 17940*        DATASET (FILE-ID-ERPNDB)
 17941*        RIDFLD  (ERPNDB-KEY)
 17942*        UPDATE
 17943*    END-EXEC.
 17944*    MOVE '&"S        EU         (   #00015466' TO DFHEIV0
 17945     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17946     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17947     MOVE X'2020233030303135343636' TO DFHEIV0(25:11)
 17948     CALL 'kxdfhei1' USING DFHEIV0,
 17949           FILE-ID-ERPNDB,
 17950           DFHEIV20,
 17951           DFHEIV99,
 17952           ERPNDB-KEY,
 17953           DFHEIV99,
 17954           DFHEIV99,
 17955           DFHEIV99
 17956     SET ADDRESS OF PENDING-BUSINESS TO
 17957         DFHEIV20
 17958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17959
 17960
 17961     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17962     MOVE 'D'                    TO JP-RECORD-TYPE.
 17963     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17964     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17965
 17966     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17967
 17968     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17969     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17970     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17971
 17972
 17973* EXEC CICS DELETE
 17974*        DATASET    (FILE-ID-ERPNDB)
 17975*    END-EXEC.
 17976*    MOVE '&(                    &   #00015484' TO DFHEIV0
 17977     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17978     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17979     MOVE X'2020233030303135343834' TO DFHEIV0(25:11)
 17980     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 326
* EL6311.cbl
 17981           FILE-ID-ERPNDB,
 17982           DFHEIV99,
 17983           DFHEIV99,
 17984           DFHEIV99,
 17985           DFHEIV99
 17986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17987
 17988
 17989     PERFORM 8400-LOG-JOURNAL-RECORD.
 17990
 17991
 17992* EXEC CICS GETMAIN
 17993*        SET      (ADDRESS OF PENDING-BUSINESS)
 17994*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17995*        INITIMG  (GETMAIN-SPACE)
 17996*    END-EXEC.
 17997*    MOVE ',"IL                  $   #00015490' TO DFHEIV0
 17998     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17999     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18000     MOVE X'2020233030303135343930' TO DFHEIV0(25:11)
 18001     CALL 'kxdfhei1' USING DFHEIV0,
 18002           DFHEIV20,
 18003           ERPNDB-RECORD-LENGTH,
 18004           GETMAIN-SPACE
 18005     SET ADDRESS OF PENDING-BUSINESS TO
 18006         DFHEIV20
 18007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18008
 18009
 18010     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 18011
 18012 2950-PROCESS-CANCELS.
 18013
 18014
 18015* EXEC CICS HANDLE CONDITION
 18016*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 18017*    END-EXEC.
 18018*    MOVE '"$I                   ! D #00015500' TO DFHEIV0
 18019     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18020     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18021     MOVE X'4420233030303135353030' TO DFHEIV0(25:11)
 18022     CALL 'kxdfhei1' USING DFHEIV0
 18023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18024
 18025
 18026
 18027* EXEC CICS READ
 18028*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 18029*        DATASET (FILE-ID-ELCERT)
 18030*        RIDFLD  (ELCERT-KEY)
 18031*        UPDATE
 18032*    END-EXEC.
 18033*    MOVE '&"S        EU         (   #00015504' TO DFHEIV0
 18034     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18035     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18036     MOVE X'2020233030303135353034' TO DFHEIV0(25:11)
 18037     CALL 'kxdfhei1' USING DFHEIV0,
 18038           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 327
* EL6311.cbl
 18039           DFHEIV20,
 18040           DFHEIV99,
 18041           ELCERT-KEY,
 18042           DFHEIV99,
 18043           DFHEIV99,
 18044           DFHEIV99
 18045     SET ADDRESS OF CERTIFICATE-MASTER TO
 18046         DFHEIV20
 18047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18048
 18049
 18050     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 18051
 18052     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 18053     MOVE 'B'                      TO JP-RECORD-TYPE.
 18054     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 18055     PERFORM 8400-LOG-JOURNAL-RECORD.
 18056
 18057     IF PB-CI-LIVES NOT NUMERIC
 18058         MOVE ZERO                    TO PB-CI-LIVES.
 18059
 18060     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 18061        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18062        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 18063        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 18064                                         CM-LF-CANCEL-DT
 18065     ELSE
 18066        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18067        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 18068        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 18069        MOVE PB-CI-LIVES              TO CM-LIVES.
 18070
 18071     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 18072        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 18073            MOVE CM-LF-STATUS-AT-CANCEL
 18074                                     TO CM-LF-CURRENT-STATUS
 18075            MOVE SPACE
 18076                                     TO CM-LF-STATUS-AT-CANCEL
 18077        ELSE
 18078            MOVE PB-CI-LF-POLICY-STATUS
 18079                                     TO CM-LF-CURRENT-STATUS
 18080     ELSE
 18081        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 18082
 18083     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 18084        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18085        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 18086        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 18087                                         CM-AH-CANCEL-DT
 18088     ELSE
 18089        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 18090        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 18091        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 18092        MOVE PB-CI-LIVES              TO CM-LIVES.
 18093
 18094     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 18095        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 18096            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 328
* EL6311.cbl
 18097                                     TO CM-AH-CURRENT-STATUS
 18098            MOVE SPACE
 18099                                     TO CM-AH-STATUS-AT-CANCEL
 18100        ELSE
 18101            MOVE PB-CI-AH-POLICY-STATUS
 18102                                     TO CM-AH-CURRENT-STATUS
 18103     ELSE
 18104        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 18105
 18106 2975-REWRITE-CERT.
 18107     MOVE 'C'                      TO JP-RECORD-TYPE.
 18108     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 18109
 18110
 18111* EXEC CICS REWRITE
 18112*        DATASET    (FILE-ID-ELCERT)
 18113*        FROM       (CERTIFICATE-MASTER)
 18114*    END-EXEC.
 18115     MOVE LENGTH OF
 18116      CERTIFICATE-MASTER
 18117       TO DFHEIV11
 18118*    MOVE '&& L                  %   #00015571' TO DFHEIV0
 18119     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18120     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18121     MOVE X'2020233030303135353731' TO DFHEIV0(25:11)
 18122     CALL 'kxdfhei1' USING DFHEIV0,
 18123           FILE-ID-ELCERT,
 18124           CERTIFICATE-MASTER,
 18125           DFHEIV11,
 18126           DFHEIV99
 18127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18128
 18129
 18130     PERFORM 8400-LOG-JOURNAL-RECORD.
 18131
 18132 2960-BUILD-NEW-CANCEL-RECORD.
 18133     IF  CCERTNOL GREATER THAN ZEROS
 18134         MOVE CCERTNOI            TO PB-CERT-PRIME.
 18135
 18136     IF  CSUFIXL  GREATER THAN ZEROS
 18137         MOVE CSUFIXI             TO PB-CERT-SFX.
 18138
 18139     IF  CEFFDTL  GREATER  THAN ZEROS
 18140         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 18141
 18142 2970-WRITE-PENDING-BUSINESS.
 18143     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 18144     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 18145     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 18146     MOVE '5'                    TO DC-OPTION-CODE.
 18147     PERFORM 9700-DATE-LINK.
 18148     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 18149
 18150     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 18151
 18152     MOVE SPACES                 TO PB-CI-INSURED-NAME
 18153                                    PB-CI-INSURED-SEX
 18154                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 329
* EL6311.cbl
 18155                                    PB-CI-AH-BENEFIT-CD
 18156                                    PB-CI-RATE-CLASS
 18157                                    PB-CI-RATE-DEV-LF
 18158                                    PB-CI-RATE-DEV-AH
 18159                                    PB-CI-LF-ABBR
 18160                                    PB-CI-AH-ABBR
 18161                                    PB-CI-OB-FLAG
 18162                                    PB-CI-LF-POLICY-STATUS
 18163                                    PB-CI-AH-POLICY-STATUS
 18164                                    PB-CI-INDV-GRP-CD
 18165                                    PB-CI-BENEFICIARY-NAME
 18166                                    PB-CI-NOTE-SW
 18167                                    PB-CI-SOC-SEC-NO
 18168                                    PB-CI-MEMBER-NO
 18169                                    PB-CI-INT-CODE
 18170                                    PB-CI-COMP-EXCP-SW
 18171                                    PB-CI-ENTRY-STATUS
 18172                                    PB-CI-CREDIT-INTERFACE-SW-1
 18173                                    PB-CI-CREDIT-INTERFACE-SW-2
 18174                                    PB-CI-ENTRY-BATCH.
 18175
 18176     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 18177                                    PB-CI-AH-SETTLEMENT-DT
 18178                                    PB-CI-DEATH-DT
 18179                                    PB-CI-LF-PRIOR-CANCEL-DT
 18180                                    PB-CI-AH-PRIOR-CANCEL-DT
 18181                                    PB-CI-LOAN-1ST-PMT-DT
 18182                                    PB-CI-ENTRY-DT
 18183                                    PB-CI-LF-EXPIRE-DT
 18184                                    PB-CI-AH-EXPIRE-DT.
 18185
 18186     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 18187                                    PB-CI-LF-TERM
 18188                                    PB-CI-LF-BENEFIT-AMT
 18189                                    PB-CI-LF-ALT-BENEFIT-AMT
 18190                                    PB-CI-LF-PREMIUM-AMT
 18191                                    PB-CI-LF-ALT-PREMIUM-AMT
 18192                                    PB-CI-AH-TERM
 18193                                    PB-CI-AH-BENEFIT-AMT
 18194                                    PB-CI-AH-PREMIUM-AMT
 18195                                    PB-CI-RATE-DEV-PCT-LF
 18196                                    PB-CI-RATE-DEV-PCT-AH
 18197                                    PB-CI-LIFE-COMMISSION
 18198                                    PB-CI-AH-COMMISSION
 18199                                    PB-CI-PAY-FREQUENCY
 18200                                    PB-CI-LOAN-APR
 18201                                    PB-CI-LOAN-TERM
 18202                                    PB-CI-CURR-SEQ
 18203                                    PB-CI-AH-CANCEL-AMT
 18204                                    PB-CI-LF-CANCEL-AMT
 18205                                    PB-CI-EXTENTION-DAYS
 18206                                    PB-CI-TERM-IN-DAYS
 18207                                    PB-CI-LOAN-OFFICER
 18208                                    PB-CI-LIVES
 18209                                    PB-CI-LF-CRIT-PER
 18210                                    PB-CI-AH-CRIT-PER
 18211                                    PB-C-LF-REM-TERM
 18212                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 330
* EL6311.cbl
 18213
 18214     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 18215     MOVE 'A'                    TO JP-RECORD-TYPE.
 18216     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18217
 18218
 18219* EXEC CICS HANDLE CONDITION
 18220*        DUPREC   (2990-DUPLICATE-RECORD)
 18221*    END-EXEC.
 18222*    MOVE '"$%                   ! E #00015664' TO DFHEIV0
 18223     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18224     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18225     MOVE X'4520233030303135363634' TO DFHEIV0(25:11)
 18226     CALL 'kxdfhei1' USING DFHEIV0
 18227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18228
 18229
 18230
 18231* EXEC CICS WRITE
 18232*        DATASET  (FILE-ID-ERPNDB)
 18233*        FROM     (PENDING-BUSINESS)
 18234*        RIDFLD   (PB-CONTROL-PRIMARY)
 18235*    END-EXEC.
 18236     MOVE LENGTH OF
 18237      PENDING-BUSINESS
 18238       TO DFHEIV11
 18239*    MOVE '&$ L                  ''   #00015668' TO DFHEIV0
 18240     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18241     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18242     MOVE X'2020233030303135363638' TO DFHEIV0(25:11)
 18243     CALL 'kxdfhei1' USING DFHEIV0,
 18244           FILE-ID-ERPNDB,
 18245           PENDING-BUSINESS,
 18246           DFHEIV11,
 18247           PB-CONTROL-PRIMARY,
 18248           DFHEIV99,
 18249           DFHEIV99
 18250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18251
 18252
 18253     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 18254
 18255     PERFORM 8400-LOG-JOURNAL-RECORD.
 18256
 18257     GO TO 2325-PROCESS-CANCEL-CHANGES.
 18258
 18259 2985-RECORD-MISSING.
 18260     MOVE -1                     TO CMAINTL
 18261     MOVE AL-UABON               TO CMAINTA.
 18262
 18263     MOVE ER-2902                TO EMI-ERROR.
 18264     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18265     GO TO 8200-SEND-DATAONLY.
 18266
 18267 2990-DUPLICATE-RECORD.
 18268     MOVE SPACE                  TO CMAINTI.
 18269     MOVE -1                     TO CMAINTL.
 18270     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 331
* EL6311.cbl
 18271     MOVE AL-UNBON               TO CEFFDTA.
 18272
 18273     MOVE 1                      TO EMI-SUB
 18274                                    EMI-SWITCH1
 18275                                    EMI-SWITCH-AREA-1
 18276                                    EMI-SWITCH-AREA-2.
 18277     MOVE SPACES                 TO EMI-ERROR-LINES.
 18278
 18279
 18280* EXEC CICS SYNCPOINT ROLLBACK
 18281*    END-EXEC.
 18282*    MOVE '6"R                   !   #00015700' TO DFHEIV0
 18283     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18284     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18285     MOVE X'2020233030303135373030' TO DFHEIV0(25:11)
 18286     CALL 'kxdfhei1' USING DFHEIV0
 18287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18288
 18289
 18290     MOVE ER-2247                TO EMI-ERROR.
 18291     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18292     GO TO 8200-SEND-DATAONLY.
 18293
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 332
* EL6311.cbl
 18295
 18296***************************************************************
 18297*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 18298*     PREMIUM FOR A SINGLE BATCH.                             *
 18299*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 18300***************************************************************
 18301
 18302 3000-BATCH-MAINLINE.
 18303     IF PI-PREV-KEY NOT = SPACES
 18304         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 18305     ELSE
 18306         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 18307
 18308     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 18309
 18310 3010-READNEXT.
 18311
 18312* EXEC CICS READ
 18313*         DATASET    (FILE-ID-ERPNDB)
 18314*         SET        (ADDRESS OF PENDING-BUSINESS)
 18315*         RIDFLD     (ERPNDB-KEY)
 18316*         GTEQ
 18317*    END-EXEC.
 18318*    MOVE '&"S        G          (   #00015724' TO DFHEIV0
 18319     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18320     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18321     MOVE X'2020233030303135373234' TO DFHEIV0(25:11)
 18322     CALL 'kxdfhei1' USING DFHEIV0,
 18323           FILE-ID-ERPNDB,
 18324           DFHEIV20,
 18325           DFHEIV99,
 18326           ERPNDB-KEY,
 18327           DFHEIV99,
 18328           DFHEIV99,
 18329           DFHEIV99
 18330     SET ADDRESS OF PENDING-BUSINESS TO
 18331         DFHEIV20
 18332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18333
 18334
 18335     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 18336        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 18337          GO TO 3030-END-BATCH.
 18338
 18339     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 18340
 18341     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 18342        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 18343          GO TO 3020-BUMP-SEQ.
 18344
 18345     IF PB-ISSUE
 18346        ADD +1                   TO WS-ISS-TOTAL-CNT
 18347        IF PB-FATAL-ERRORS
 18348           ADD +1                      TO WS-ISS-FATAL-CNT
 18349           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18350           GO TO 3020-BUMP-SEQ
 18351        ELSE
 18352           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 333
* EL6311.cbl
 18353              ADD +1                      TO WS-ISS-FORCE-CNT
 18354              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18355              GO TO 3020-BUMP-SEQ
 18356           ELSE
 18357              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18358                 ADD +1                      TO WS-ISS-HOLD-CNT
 18359                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18360                 GO TO 3020-BUMP-SEQ
 18361              ELSE
 18362                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 18363                     THRU  3299-EXIT
 18364                 GO TO 3020-BUMP-SEQ.
 18365
 18366     IF PB-CANCELLATION
 18367        ADD +1                   TO WS-CAN-TOTAL-CNT
 18368        IF PB-FATAL-ERRORS
 18369           ADD +1                 TO WS-CAN-FATAL-CNT
 18370           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18371           GO TO 3020-BUMP-SEQ
 18372        ELSE
 18373           IF PB-UNFORCED-ERRORS
 18374              ADD +1                 TO WS-CAN-FORCE-CNT
 18375              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18376              GO TO 3020-BUMP-SEQ
 18377           ELSE
 18378              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18379                 ADD +1                 TO WS-CAN-HOLD-CNT
 18380                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18381                 GO TO 3020-BUMP-SEQ
 18382              ELSE
 18383                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 18384                     THRU  3499-EXIT
 18385                 GO TO 3020-BUMP-SEQ.
 18386
 18387     IF PB-BATCH-TRAILER
 18388         GO TO 3030-END-BATCH.
 18389
 18390 3020-BUMP-SEQ.
 18391     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 18392     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18393     GO TO 3010-READNEXT.
 18394
 18395 3030-END-BATCH.
 18396     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 18397     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 18398     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 18399     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 18400
 18401     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18402                                          - WS-ISS-FORCE-CNT
 18403                                          - WS-ISS-HOLD-CNT).
 18404
 18405     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 18406     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 18407
 18408     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 18409     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 18410     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 334
* EL6311.cbl
 18411     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 18412     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18413                                          - WS-CAN-FORCE-CNT
 18414                                          - WS-CAN-HOLD-CNT).
 18415     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18416     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18417
 18418     COMPUTE WS-NET-TOTAL-CNT
 18419         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18420     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18421     COMPUTE WS-NET-FATAL-CNT
 18422         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18423     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18424     COMPUTE WS-NET-FORCE-CNT
 18425         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18426     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18427     COMPUTE WS-NET-HOLD-CNT
 18428         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18429     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18430
 18431     COMPUTE WS-NET-AVAIL-CNT
 18432          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18433                              - WS-ISS-FORCE-CNT
 18434                              - WS-ISS-HOLD-CNT)
 18435          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18436                              - WS-CAN-FORCE-CNT
 18437                              - WS-CAN-HOLD-CNT).
 18438     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18439
 18440     COMPUTE WS-NET-GOOD-PREM
 18441         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18442     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18443     COMPUTE WS-NET-BAD-PREM
 18444         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18445     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18446
 18447     MOVE 0000                   TO EMI-ERROR.
 18448     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18449     MOVE -1                     TO DPFENTRL.
 18450     GO TO 8200-SEND-DATAONLY.
 18451
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 335
* EL6311.cbl
 18453
 18454******************************************************************
 18455*                                                                *
 18456*           A D D    B A D   I S S U E   P R E M I U M           *
 18457*                                                                *
 18458******************************************************************
 18459
 18460 3100-ADD-BAD-ISSUE-PREM.
 18461     IF PB-OVERRIDE-LIFE
 18462       OR PB-OVERRIDE-BOTH
 18463           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18464           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18465       ELSE
 18466           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18467           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18468
 18469     IF PB-OVERRIDE-AH
 18470       OR PB-OVERRIDE-BOTH
 18471           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18472       ELSE
 18473           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18474
 18475 3199-EXIT.
 18476     EXIT.
 18477
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 336
* EL6311.cbl
 18479
 18480******************************************************************
 18481*                                                                *
 18482*       A D D   G O O D   I S S U E   P R E M I U M              *
 18483*                                                                *
 18484******************************************************************
 18485
 18486 3200-ADD-GOOD-ISSUE-PREM.
 18487     IF PB-OVERRIDE-LIFE
 18488       OR PB-OVERRIDE-BOTH
 18489           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18490           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18491       ELSE
 18492           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18493           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18494
 18495     IF PB-OVERRIDE-AH
 18496       OR PB-OVERRIDE-BOTH
 18497           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18498       ELSE
 18499           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18500
 18501 3299-EXIT.
 18502     EXIT.
 18503
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 337
* EL6311.cbl
 18505
 18506
 18507******************************************************************
 18508*                                                                *
 18509*        A D D   B A D   C A N C E L   P R E M I U M             *
 18510*                                                                *
 18511******************************************************************
 18512
 18513 3300-ADD-BAD-CANCEL-PREM.
 18514     IF PB-OVERRIDE-LIFE
 18515       OR PB-OVERRIDE-BOTH
 18516           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18517       ELSE
 18518           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18519
 18520     IF PB-OVERRIDE-AH
 18521       OR PB-OVERRIDE-BOTH
 18522           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18523       ELSE
 18524           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18525
 18526 3399-EXIT.
 18527     EXIT.
 18528
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 338
* EL6311.cbl
 18530
 18531******************************************************************
 18532*                                                                *
 18533*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18534*                                                                *
 18535******************************************************************
 18536
 18537 3400-ADD-GOOD-CANCEL-PREM.
 18538     IF PB-OVERRIDE-LIFE
 18539       OR PB-OVERRIDE-BOTH
 18540           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18541       ELSE
 18542           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18543
 18544     IF PB-OVERRIDE-AH
 18545       OR PB-OVERRIDE-BOTH
 18546           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18547       ELSE
 18548           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18549
 18550 3499-EXIT.
 18551     EXIT.
 18552
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 339
* EL6311.cbl
 18554
 18555******************************************************************
 18556*                                                                *
 18557*           E D I T   B A T C H   D A T A                        *
 18558*                                                                *
 18559******************************************************************
 18560
 18561 3500-EDIT-BATCH-DATA.
 18562     IF PI-PREV-KEY NOT = SPACES
 18563        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18564     ELSE
 18565        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18566
 18567     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18568     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18569
 18570
 18571* EXEC CICS HANDLE CONDITION
 18572*         NOTFND      (3590-NOT-FOUND)
 18573*    END-EXEC.
 18574*    MOVE '"$I                   ! F #00015966' TO DFHEIV0
 18575     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18576     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18577     MOVE X'4620233030303135393636' TO DFHEIV0(25:11)
 18578     CALL 'kxdfhei1' USING DFHEIV0
 18579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18580
 18581
 18582     IF DRISSL   GREATER THAN ZEROS OR
 18583        DRISSL   GREATER THAN ZEROS OR
 18584        DRLFPRML GREATER THAN ZEROS OR
 18585        DRAHPRML GREATER THAN ZEROS OR
 18586        DRCANCL  GREATER THAN ZEROS OR
 18587        DRLFRFDL GREATER THAN ZEROS OR
 18588        DRAHRFDL GREATER THAN ZEROS
 18589              NEXT SENTENCE
 18590          ELSE
 18591              MOVE ER-3224    TO EMI-ERROR
 18592              MOVE -1         TO DPFENTRL
 18593              MOVE AL-UNBON   TO DPFENTRA
 18594              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18595              GO TO 8200-SEND-DATAONLY.
 18596
 18597     IF NOT MODIFY-CAP
 18598         MOVE 'UPDATE'       TO SM-READ
 18599         PERFORM 9995-SECURITY-VIOLATION
 18600         MOVE ER-0070        TO EMI-ERROR
 18601         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18602         GO TO 8100-SEND-INITIAL-MAP.
 18603
 18604        IF DRISSL GREATER THAN ZEROS
 18605           MOVE AL-UNNON         TO DRISSA
 18606           MOVE DRISSI           TO DEEDIT-FIELD
 18607           PERFORM 8600-DEEDIT
 18608           IF DEEDIT-FIELD-V0  NUMERIC
 18609              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18610           ELSE
 18611              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 340
* EL6311.cbl
 18612              MOVE -1         TO DRISSL
 18613              MOVE AL-UNBON   TO DRISSA
 18614              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18615
 18616        IF DRLFPRML GREATER THAN ZEROS
 18617           MOVE AL-UNNON         TO DRLFPRMA
 18618
 18619* EXEC CICS BIF DEEDIT
 18620*              FIELD  (DRLFPRMI)
 18621*              LENGTH (11)
 18622*          END-EXEC
 18623     MOVE 11
 18624       TO DFHEIV11
 18625*    MOVE '@"L                   #   #00016006' TO DFHEIV0
 18626     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18627     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18628     MOVE X'2020233030303136303036' TO DFHEIV0(25:11)
 18629     CALL 'kxdfhei1' USING DFHEIV0,
 18630           DRLFPRMI,
 18631           DFHEIV11
 18632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18633           IF DRLFPRMI NUMERIC
 18634              MOVE DRLFPRMI   TO WS-DRLFPRM
 18635*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18636*          PERFORM 8600-DEEDIT
 18637*          IF DEEDIT-FIELD-V2  NUMERIC
 18638*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18639           ELSE
 18640              MOVE ER-2223    TO EMI-ERROR
 18641              MOVE -1         TO DRLFPRML
 18642              MOVE AL-UNBON   TO DRLFPRMA
 18643              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18644
 18645        IF DRAHPRML GREATER THAN ZEROS
 18646           MOVE AL-UNNON         TO DRAHPRMA
 18647
 18648* EXEC CICS BIF DEEDIT
 18649*              FIELD  (DRAHPRMI)
 18650*              LENGTH (11)
 18651*          END-EXEC
 18652     MOVE 11
 18653       TO DFHEIV11
 18654*    MOVE '@"L                   #   #00016024' TO DFHEIV0
 18655     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18656     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18657     MOVE X'2020233030303136303234' TO DFHEIV0(25:11)
 18658     CALL 'kxdfhei1' USING DFHEIV0,
 18659           DRAHPRMI,
 18660           DFHEIV11
 18661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18662           IF DRAHPRMI NUMERIC
 18663              MOVE DRAHPRMI   TO WS-DRAHPRM
 18664*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18665*          PERFORM 8600-DEEDIT
 18666*          IF DEEDIT-FIELD-V2  NUMERIC
 18667*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18668           ELSE
 18669              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 341
* EL6311.cbl
 18670              MOVE -1         TO DRAHPRML
 18671              MOVE AL-UNBON   TO DRAHPRMA
 18672              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18673
 18674        IF DRCANCL GREATER THAN ZEROS
 18675           MOVE AL-UNNON         TO DRCANCA
 18676           MOVE DRCANCI          TO DEEDIT-FIELD
 18677           PERFORM 8600-DEEDIT
 18678           IF DEEDIT-FIELD-V0  NUMERIC
 18679              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18680           ELSE
 18681              MOVE ER-2223    TO EMI-ERROR
 18682              MOVE -1         TO DRCANCL
 18683              MOVE AL-UNBON   TO DRCANCL
 18684              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18685
 18686        IF DRLFRFDL GREATER THAN ZEROS
 18687           MOVE AL-UNNON         TO DRLFRFDA
 18688
 18689* EXEC CICS BIF DEEDIT
 18690*              FIELD  (DRLFRFDI)
 18691*              LENGTH (11)
 18692*          END-EXEC
 18693     MOVE 11
 18694       TO DFHEIV11
 18695*    MOVE '@"L                   #   #00016054' TO DFHEIV0
 18696     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18697     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18698     MOVE X'2020233030303136303534' TO DFHEIV0(25:11)
 18699     CALL 'kxdfhei1' USING DFHEIV0,
 18700           DRLFRFDI,
 18701           DFHEIV11
 18702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18703           IF DRLFRFDI NUMERIC
 18704              MOVE DRLFRFDI   TO WS-DRLFRFD
 18705*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18706*          PERFORM 8600-DEEDIT
 18707*          IF DEEDIT-FIELD-V2  NUMERIC
 18708*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18709           ELSE
 18710              MOVE ER-2223    TO EMI-ERROR
 18711              MOVE -1         TO DRLFRFDL
 18712              MOVE AL-UNBON   TO DRLFRFDA
 18713              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18714
 18715        IF DRAHRFDL GREATER THAN ZEROS
 18716           MOVE AL-UNNON         TO DRAHRFDA
 18717
 18718* EXEC CICS BIF DEEDIT
 18719*              FIELD  (DRAHRFDI)
 18720*              LENGTH (11)
 18721*          END-EXEC
 18722     MOVE 11
 18723       TO DFHEIV11
 18724*    MOVE '@"L                   #   #00016072' TO DFHEIV0
 18725     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18726     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18727     MOVE X'2020233030303136303732' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 342
* EL6311.cbl
 18728     CALL 'kxdfhei1' USING DFHEIV0,
 18729           DRAHRFDI,
 18730           DFHEIV11
 18731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18732           IF DRAHRFDI NUMERIC
 18733              MOVE DRAHRFDI   TO WS-DRAHRFD
 18734*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18735*          PERFORM 8600-DEEDIT
 18736*          IF DEEDIT-FIELD-V2  NUMERIC
 18737*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18738           ELSE
 18739              MOVE ER-2223    TO EMI-ERROR
 18740              MOVE -1         TO DRAHRFDL
 18741              MOVE AL-UNBON   TO DRAHRFDA
 18742              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18743
 18744     IF EMI-ERROR = ZEROS
 18745        GO 3600-UPDATE-BATCH-HEADER.
 18746
 18747     GO TO 8200-SEND-DATAONLY.
 18748
 18749 3590-NOT-FOUND.
 18750     MOVE ER-2192                TO EMI-ERROR.
 18751     MOVE -1                     TO DPFENTRL.
 18752     MOVE AL-UNBON               TO DPFENTRA.
 18753     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18754     GO TO 8200-SEND-DATAONLY.
 18755
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 343
* EL6311.cbl
 18757
 18758******************************************************************
 18759*                                                                *
 18760*           U P D A T E   B A T C H   H E A D E R                *
 18761*                                                                *
 18762******************************************************************
 18763
 18764 3600-UPDATE-BATCH-HEADER.
 18765
 18766* EXEC CICS HANDLE CONDITION
 18767*         NOTFND      (3690-NOT-FOUND)
 18768*    END-EXEC.
 18769*    MOVE '"$I                   ! G #00016109' TO DFHEIV0
 18770     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18771     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18772     MOVE X'4720233030303136313039' TO DFHEIV0(25:11)
 18773     CALL 'kxdfhei1' USING DFHEIV0
 18774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18775
 18776
 18777
 18778* EXEC CICS READ
 18779*        DATASET (FILE-ID-ERPNDB)
 18780*        RIDFLD  (ERPNDB-KEY)
 18781*        SET     (ADDRESS OF PENDING-BUSINESS)
 18782*        UPDATE
 18783*    END-EXEC.
 18784*    MOVE '&"S        EU         (   #00016113' TO DFHEIV0
 18785     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18786     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18787     MOVE X'2020233030303136313133' TO DFHEIV0(25:11)
 18788     CALL 'kxdfhei1' USING DFHEIV0,
 18789           FILE-ID-ERPNDB,
 18790           DFHEIV20,
 18791           DFHEIV99,
 18792           ERPNDB-KEY,
 18793           DFHEIV99,
 18794           DFHEIV99,
 18795           DFHEIV99
 18796     SET ADDRESS OF PENDING-BUSINESS TO
 18797         DFHEIV20
 18798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18799
 18800
 18801     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18802     MOVE 'B'                    TO JP-RECORD-TYPE.
 18803     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18804
 18805     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18806
 18807     PERFORM 8400-LOG-JOURNAL-RECORD.
 18808
 18809     IF DRISSL GREATER THAN ZEROS
 18810        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18811
 18812     IF DRCANCL GREATER THAN ZEROS
 18813        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18814
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 344
* EL6311.cbl
 18815
 18816     IF DRLFPRML GREATER THAN ZEROS
 18817        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18818
 18819     IF DRAHPRML GREATER THAN ZEROS
 18820        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18821
 18822     IF DRLFRFDL GREATER THAN ZEROS
 18823        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18824
 18825     IF DRAHRFDL GREATER THAN ZEROS
 18826        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18827
 18828 3670-REWRITE-BATCH-HEADER.
 18829     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18830        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18831        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18832        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18833        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18834        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18835        MOVE SPACE               TO PB-OUT-BAL-CD
 18836     ELSE
 18837        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18838
 18839     MOVE 'C'                    TO JP-RECORD-TYPE.
 18840     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18841
 18842
 18843* EXEC CICS REWRITE
 18844*         DATASET      (FILE-ID-ERPNDB)
 18845*         FROM         (PENDING-BUSINESS)
 18846*    END-EXEC.
 18847     MOVE LENGTH OF
 18848      PENDING-BUSINESS
 18849       TO DFHEIV11
 18850*    MOVE '&& L                  %   #00016161' TO DFHEIV0
 18851     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18852     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18853     MOVE X'2020233030303136313631' TO DFHEIV0(25:11)
 18854     CALL 'kxdfhei1' USING DFHEIV0,
 18855           FILE-ID-ERPNDB,
 18856           PENDING-BUSINESS,
 18857           DFHEIV11,
 18858           DFHEIV99
 18859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18860
 18861
 18862     PERFORM 8400-LOG-JOURNAL-RECORD.
 18863
 18864     GO TO 7200-DISPLAY-BATCHES.
 18865
 18866 3690-NOT-FOUND.
 18867     MOVE ER-2192                TO EMI-ERROR.
 18868     MOVE -1                     TO DPFENTRL.
 18869     MOVE AL-UNBON               TO DPFENTRA.
 18870     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18871     GO TO 8200-SEND-DATAONLY.
 18872
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 345
* EL6311.cbl
 18874
 18875******************************************************************
 18876*                                                                *
 18877*           R E - D I S P L A Y   R E C O R D                    *
 18878*                                                                *
 18879******************************************************************
 18880
 18881 3900-RE-DISPLAY-RECORD.
 18882
 18883* EXEC CICS HANDLE CONDITION
 18884*         NOTFND   (3990-NOT-FOUND)
 18885*    END-EXEC.
 18886*    MOVE '"$I                   ! H #00016186' TO DFHEIV0
 18887     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18889     MOVE X'4820233030303136313836' TO DFHEIV0(25:11)
 18890     CALL 'kxdfhei1' USING DFHEIV0
 18891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18892
 18893
 18894     IF PI-DISPLAY-ORIGINAL-BATCH
 18895         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18896     ELSE
 18897         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18898
 18899
 18900* EXEC CICS READ
 18901*         DATASET   (FILE-ID)
 18902*         RIDFLD    (PI-PREV-KEY)
 18903*         SET       (ADDRESS OF PENDING-BUSINESS)
 18904*    END-EXEC.
 18905*    MOVE '&"S        E          (   #00016195' TO DFHEIV0
 18906     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18907     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18908     MOVE X'2020233030303136313935' TO DFHEIV0(25:11)
 18909     CALL 'kxdfhei1' USING DFHEIV0,
 18910           FILE-ID,
 18911           DFHEIV20,
 18912           DFHEIV99,
 18913           PI-PREV-KEY,
 18914           DFHEIV99,
 18915           DFHEIV99,
 18916           DFHEIV99
 18917     SET ADDRESS OF PENDING-BUSINESS TO
 18918         DFHEIV20
 18919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18920
 18921
 18922     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18923
 18924     IF PB-ISSUE
 18925         GO TO 7000-DISPLAY-ISSUES.
 18926
 18927     IF PB-CANCELLATION
 18928         GO TO 7100-DISPLAY-CANCELS.
 18929
 18930     IF PB-BATCH-TRAILER
 18931         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 346
* EL6311.cbl
 18932
 18933 3990-NOT-FOUND.
 18934     MOVE LOW-VALUES             TO EL631BI.
 18935
 18936     IF PI-MAP-NAME = EL631B
 18937         MOVE -1                  TO BMAINTL
 18938     ELSE
 18939         MOVE -1                  TO CMAINTL.
 18940
 18941     GO TO 8100-SEND-INITIAL-MAP.
 18942
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 347
* EL6311.cbl
 18944
 18945***************************************************************
 18946*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18947*                                                             *
 18948*      1. START BROWSE WITH                                   *
 18949*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18950*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18951*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18952*                                                             *
 18953*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18954*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18955*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18956*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18957*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18958*               AND IS IT TO BE DISPLAYED.                    *
 18959*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18960*               DISPLAYED.                                    *
 18961*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18962*               DISPLAYED.                                    *
 18963*                                                             *
 18964*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18965*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18966***************************************************************
 18967
 18968 4000-BROWSE-DETAIL-FORWARD.
 18969     IF FIRST-TIME
 18970        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18971     ELSE
 18972        IF SHOW-RECORD
 18973           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18974           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18975           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18976           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18977           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18978        ELSE
 18979           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18980
 18981
 18982* EXEC CICS HANDLE CONDITION
 18983*         NOTFND   (4050-END-RECORDS)
 18984*         ENDFILE  (4050-END-RECORDS)
 18985*    END-EXEC.
 18986*    MOVE '"$I''                  ! I #00016260' TO DFHEIV0
 18987     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18988     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18989     MOVE X'4920233030303136323630' TO DFHEIV0(25:11)
 18990     CALL 'kxdfhei1' USING DFHEIV0
 18991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18992
 18993
 18994
 18995* EXEC CICS STARTBR
 18996*         DATASET   (FILE-ID-ERPNDB2)
 18997*         RIDFLD    (ERPNDB-ALT-KEY)
 18998*    END-EXEC.
 18999     MOVE 0
 19000       TO DFHEIV11
 19001*    MOVE '&,         G          &   #00016265' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 348
* EL6311.cbl
 19002     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19003     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19004     MOVE X'2020233030303136323635' TO DFHEIV0(25:11)
 19005     CALL 'kxdfhei1' USING DFHEIV0,
 19006           FILE-ID-ERPNDB2,
 19007           ERPNDB-ALT-KEY,
 19008           DFHEIV99,
 19009           DFHEIV11,
 19010           DFHEIV99
 19011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19012
 19013
 19014     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19015
 19016     IF FIRST-TIME OR SHOW-RECORD
 19017        MOVE SPACE               TO WS-FIRST-TIME-SW
 19018        GO TO 4005-READ-NEXT-RECORD.
 19019
 19020
 19021* EXEC CICS READNEXT
 19022*         DATASET    (FILE-ID-ERPNDB2)
 19023*         SET        (ADDRESS OF PENDING-BUSINESS)
 19024*         RIDFLD     (ERPNDB-ALT-KEY)
 19025*    END-EXEC.
 19026     MOVE 0
 19027       TO DFHEIV11
 19028*    MOVE '&.S                   )   #00016276' TO DFHEIV0
 19029     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19030     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19031     MOVE X'2020233030303136323736' TO DFHEIV0(25:11)
 19032     CALL 'kxdfhei1' USING DFHEIV0,
 19033           FILE-ID-ERPNDB2,
 19034           DFHEIV20,
 19035           DFHEIV99,
 19036           ERPNDB-ALT-KEY,
 19037           DFHEIV99,
 19038           DFHEIV11,
 19039           DFHEIV99,
 19040           DFHEIV99
 19041     SET ADDRESS OF PENDING-BUSINESS TO
 19042         DFHEIV20
 19043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19044
 19045
 19046 4005-READ-NEXT-RECORD.
 19047
 19048* EXEC CICS READNEXT
 19049*         DATASET    (FILE-ID-ERPNDB2)
 19050*         SET        (ADDRESS OF PENDING-BUSINESS)
 19051*         RIDFLD     (ERPNDB-ALT-KEY)
 19052*    END-EXEC.
 19053     MOVE 0
 19054       TO DFHEIV11
 19055*    MOVE '&.S                   )   #00016283' TO DFHEIV0
 19056     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19057     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19058     MOVE X'2020233030303136323833' TO DFHEIV0(25:11)
 19059     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 349
* EL6311.cbl
 19060           FILE-ID-ERPNDB2,
 19061           DFHEIV20,
 19062           DFHEIV99,
 19063           ERPNDB-ALT-KEY,
 19064           DFHEIV99,
 19065           DFHEIV11,
 19066           DFHEIV99,
 19067           DFHEIV99
 19068     SET ADDRESS OF PENDING-BUSINESS TO
 19069         DFHEIV20
 19070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19071
 19072
 19073     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19074
 19075     IF WS-BATCH-PREFIX = '#CL'
 19076        GO TO 4005-READ-NEXT-RECORD.
 19077
 19078     IF SHOW-RECORD
 19079        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 19080           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 19081           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 19082           PB-STATE         NOT = PI-PB-STATE          OR
 19083           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 19084           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 19085           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 19086           GO TO 4050-END-RECORDS
 19087        ELSE
 19088           GO TO 4010-CHECK-REC-TYPE.
 19089
 19090     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 19091        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 19092        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 19093        PB-STATE            NOT = PI-PB-STATE          OR
 19094        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 19095        GO TO 4050-END-RECORDS.
 19096
 19097     IF PB-BATCH-TRAILER
 19098        GO TO 4005-READ-NEXT-RECORD.
 19099
 19100     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19101        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19102           GO TO 4005-READ-NEXT-RECORD
 19103        ELSE
 19104           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19105              GO TO 4010-CHECK-REC-TYPE
 19106           ELSE
 19107              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19108                 GO TO 4010-CHECK-REC-TYPE
 19109              ELSE
 19110                 GO TO 4005-READ-NEXT-RECORD.
 19111
 19112     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19113        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19114           GO TO 4005-READ-NEXT-RECORD.
 19115
 19116 4010-CHECK-REC-TYPE.
 19117     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 350
* EL6311.cbl
 19118         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19119             NEXT SENTENCE
 19120         ELSE
 19121             GO TO 4005-READ-NEXT-RECORD.
 19122
 19123     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19124         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19125             NEXT SENTENCE
 19126        ELSE
 19127             GO TO 4005-READ-NEXT-RECORD.
 19128
 19129     IF NOT DISPLAY-CHANGE-RECORDS AND
 19130            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19131        GO TO 4005-READ-NEXT-RECORD.
 19132
 19133     IF DISPLAY-HOLD-RECORDS AND
 19134        NOT PB-RECORD-ON-HOLD
 19135          GO TO 4005-READ-NEXT-RECORD.
 19136
 19137     IF PB-ISSUE
 19138        IF DISPLAY-CHK-REQ-RECORDS
 19139            GO TO 4005-READ-NEXT-RECORD.
 19140
 19141     IF PB-ISSUE
 19142        IF ISSUE-WITH-WARNING
 19143           IF PB-WARNING-ERRORS
 19144              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19145                  GO TO 4005-READ-NEXT-RECORD
 19146              ELSE
 19147                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19148                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19149                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19150                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19151                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19152                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19153                 GO TO 7000-DISPLAY-ISSUES
 19154           ELSE
 19155              GO TO 4005-READ-NEXT-RECORD.
 19156
 19157     IF PB-ISSUE
 19158        IF (ISSUES-IN-ERROR AND
 19159            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19160            ALL-ISSUES
 19161            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19162            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19163            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19164            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19165            MOVE PB-SV-STATE            TO PI-SV-STATE
 19166            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19167            GO TO 7000-DISPLAY-ISSUES
 19168        ELSE
 19169            GO TO 4005-READ-NEXT-RECORD.
 19170
 19171     IF PB-CANCELLATION
 19172        IF DISPLAY-CHK-REQ-RECORDS
 19173           IF PB-C-REFUND-REQUESTED
 19174              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19175              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 351
* EL6311.cbl
 19176              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19177              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19178              MOVE PB-SV-STATE            TO PI-SV-STATE
 19179              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19180              GO TO 7100-DISPLAY-CANCELS
 19181           ELSE
 19182               GO TO 4005-READ-NEXT-RECORD.
 19183
 19184     IF PB-CANCELLATION
 19185        IF CANCEL-WITH-WARNING
 19186           IF PB-WARNING-ERRORS
 19187              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19188                  GO TO 4005-READ-NEXT-RECORD
 19189              ELSE
 19190                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19191                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19192                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19193                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19194                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19195                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19196                 GO TO 7100-DISPLAY-CANCELS
 19197           ELSE
 19198              GO TO 4005-READ-NEXT-RECORD.
 19199
 19200     IF PB-CANCELLATION
 19201        IF (CANCEL-IN-ERROR  AND
 19202            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19203            ALL-CANCELS
 19204            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19205            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19206            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19207            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19208            MOVE PB-SV-STATE            TO PI-SV-STATE
 19209            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19210            GO TO 7100-DISPLAY-CANCELS.
 19211
 19212     GO TO 4005-READ-NEXT-RECORD.
 19213
 19214 4050-END-RECORDS.
 19215******************************************************************
 19216*                                                                *
 19217*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19218*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19219*         PROGRAM.                                               *
 19220*                                                                *
 19221******************************************************************
 19222
 19223     IF BROWSE-STARTED
 19224        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19225
 19226* EXEC CICS ENDBR
 19227*            DATASET  (FILE-ID-ERPNDB2)
 19228*       END-EXEC.
 19229     MOVE 0
 19230       TO DFHEIV11
 19231*    MOVE '&2                    $   #00016441' TO DFHEIV0
 19232     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19233     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 352
* EL6311.cbl
 19234     MOVE X'2020233030303136343431' TO DFHEIV0(25:11)
 19235     CALL 'kxdfhei1' USING DFHEIV0,
 19236           FILE-ID-ERPNDB2,
 19237           DFHEIV11,
 19238           DFHEIV99
 19239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19240
 19241
 19242     IF  EIBTRNID NOT = TRANS-EXB1
 19243         IF PENDING-BUS-RECS-FOUND
 19244             NEXT SENTENCE
 19245           ELSE
 19246             MOVE '9'            TO PI-BROWSE-SW
 19247             GO TO 9400-CLEAR.
 19248
 19249     IF SHOW-RECORD
 19250        MOVE ER-2253            TO EMI-ERROR
 19251       ELSE
 19252        MOVE ER-2254            TO EMI-ERROR.
 19253
 19254     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19255
 19256     IF PI-MAP-NAME = SPACES
 19257        MOVE -1                  TO DPFENTRL
 19258        MOVE EL631D               TO PI-MAP-NAME
 19259        GO TO 8100-SEND-INITIAL-MAP.
 19260
 19261     IF PI-MAP-NAME = EL631B
 19262        MOVE -1                  TO BMAINTL
 19263     ELSE
 19264        IF PI-MAP-NAME = EL631C
 19265           MOVE -1               TO CMAINTL
 19266        ELSE
 19267           MOVE -1               TO DPFENTRL.
 19268
 19269     GO TO 8200-SEND-DATAONLY.
 19270
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 353
* EL6311.cbl
 19272
 19273***************************************************************
 19274*                                                             *
 19275*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 19276*                                                             *
 19277*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 19278*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19279*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19280*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 19281*                                                             *
 19282*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19283*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19284*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 19285*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19286*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19287*                AND IS IT TO BE DISPLAYED.                   *
 19288*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19289*                DISPLAYED.                                   *
 19290*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19291*                DISPLAYED.                                   *
 19292*                                                             *
 19293*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19294*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19295*                                                             *
 19296*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19297*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19298*                THEY ARE NOT TO BE DISPLAYED.                *
 19299*                                                             *
 19300***************************************************************
 19301
 19302 4100-BROWSE-PRIMARY-FORWARD.
 19303     IF FIRST-TIME  OR SHOW-RECORD
 19304        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 19305        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 19306        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 19307     ELSE
 19308        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 19309        IF ERPNDB-BATCH-SEQ-NO = +9999
 19310           GO TO 4150-END-BATCH
 19311        ELSE
 19312           IF DISPLAY-CHANGE-RECORDS
 19313              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19314           ELSE
 19315              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19316              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19317
 19318     IF FIRST-TIME
 19319         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 19320            PI-PB-BATCH-SEQ-NO NOT = ZERO
 19321              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 19322
 19323
 19324* EXEC CICS HANDLE CONDITION
 19325*         ENDFILE  (4150-END-BATCH)
 19326*    END-EXEC.
 19327*    MOVE '"$''                   ! J #00016526' TO DFHEIV0
 19328     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 19329     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 354
* EL6311.cbl
 19330     MOVE X'4A20233030303136353236' TO DFHEIV0(25:11)
 19331     CALL 'kxdfhei1' USING DFHEIV0
 19332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19333
 19334
 19335 4105-READ-NEXT.
 19336
 19337* EXEC CICS HANDLE CONDITION
 19338*         NOTFND    (4150-END-BATCH)
 19339*    END-EXEC.
 19340*    MOVE '"$I                   ! K #00016531' TO DFHEIV0
 19341     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19342     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19343     MOVE X'4B20233030303136353331' TO DFHEIV0(25:11)
 19344     CALL 'kxdfhei1' USING DFHEIV0
 19345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19346
 19347
 19348     MOVE SPACES                 TO WS-REC-FOUND-SW.
 19349
 19350     IF PI-DISPLAY-ORIGINAL-BATCH
 19351        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19352     ELSE
 19353        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19354
 19355
 19356* EXEC CICS READ
 19357*         DATASET   (FILE-ID)
 19358*         SET       (ADDRESS OF PENDING-BUSINESS)
 19359*         RIDFLD    (ERPNDB-KEY)
 19360*         GTEQ
 19361*    END-EXEC.
 19362*    MOVE '&"S        G          (   #00016542' TO DFHEIV0
 19363     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19364     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19365     MOVE X'2020233030303136353432' TO DFHEIV0(25:11)
 19366     CALL 'kxdfhei1' USING DFHEIV0,
 19367           FILE-ID,
 19368           DFHEIV20,
 19369           DFHEIV99,
 19370           ERPNDB-KEY,
 19371           DFHEIV99,
 19372           DFHEIV99,
 19373           DFHEIV99
 19374     SET ADDRESS OF PENDING-BUSINESS TO
 19375         DFHEIV20
 19376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19377
 19378
 19379     IF PI-DISPLAY-ORIGINAL-BATCH
 19380        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19381           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19382           GO TO 4150-END-BATCH
 19383        ELSE
 19384           IF PB-BATCH-TRAILER
 19385              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 19386              GO TO 4105-READ-NEXT
 19387           ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 355
* EL6311.cbl
 19388              NEXT SENTENCE
 19389     ELSE
 19390        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19391           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19392           GO TO 4150-END-BATCH.
 19393
 19394     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19395
 19396     IF WS-BATCH-PREFIX = '#CL'
 19397         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19398         GO TO 4105-READ-NEXT.
 19399
 19400     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19401     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19402     MOVE PB-STATE               TO PI-PB-STATE.
 19403     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19404
 19405     IF PB-BATCH-TRAILER
 19406        IF SHOW-RECORD
 19407           GO TO 4150-END-BATCH
 19408        ELSE
 19409           MOVE ER-2251         TO EMI-ERROR
 19410           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19411           MOVE 1               TO PI-BROWSE-TYPE
 19412           GO TO 7200-DISPLAY-BATCHES.
 19413
 19414     IF SHOW-RECORD
 19415           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19416              GO TO 4110-BUMP-SEQ
 19417           ELSE
 19418              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19419                 GO TO 4110-BUMP-SEQ
 19420              ELSE
 19421                 GO TO 4107-CHECK-REC-TYPE.
 19422
 19423     IF NOT  PI-PRIMARY-WITH-SELECT
 19424        GO TO 4107-CHECK-REC-TYPE.
 19425
 19426     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19427        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19428           GO TO 4110-BUMP-SEQ
 19429        ELSE
 19430           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19431              GO TO 4107-CHECK-REC-TYPE
 19432           ELSE
 19433              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19434                 GO TO 4107-CHECK-REC-TYPE
 19435              ELSE
 19436                 GO TO 4110-BUMP-SEQ.
 19437
 19438     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19439        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19440           GO TO 4110-BUMP-SEQ.
 19441
 19442 4107-CHECK-REC-TYPE.
 19443     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19444         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19445             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 356
* EL6311.cbl
 19446           ELSE
 19447             GO TO 4110-BUMP-SEQ.
 19448
 19449     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19450         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19451             NEXT SENTENCE
 19452           ELSE
 19453             GO TO 4110-BUMP-SEQ.
 19454
 19455     IF NOT DISPLAY-CHANGE-RECORDS AND
 19456        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19457           GO TO 4110-BUMP-SEQ.
 19458
 19459     IF DISPLAY-HOLD-RECORDS AND
 19460        NOT PB-RECORD-ON-HOLD
 19461          GO TO 4110-BUMP-SEQ.
 19462
 19463     IF PB-ISSUE
 19464        IF DISPLAY-CHK-REQ-RECORDS
 19465            GO TO 4110-BUMP-SEQ.
 19466
 19467     IF PB-ISSUE
 19468        IF ISSUE-WITH-WARNING
 19469           IF PB-WARNING-ERRORS
 19470              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19471                  GO TO 4110-BUMP-SEQ
 19472              ELSE
 19473                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19474                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19475                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19476                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19477                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19478                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19479                 GO TO 7000-DISPLAY-ISSUES
 19480        ELSE
 19481            GO TO 4110-BUMP-SEQ.
 19482
 19483     IF PB-ISSUE
 19484        IF (ISSUES-IN-ERROR AND
 19485            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19486            ALL-ISSUES
 19487            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19488            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19489            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19490            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19491            MOVE PB-SV-STATE            TO PI-SV-STATE
 19492            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19493            GO TO 7000-DISPLAY-ISSUES
 19494        ELSE
 19495            GO TO 4110-BUMP-SEQ.
 19496
 19497     IF PB-CANCELLATION
 19498        IF DISPLAY-CHK-REQ-RECORDS
 19499           IF PB-C-REFUND-REQUESTED
 19500              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19501              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19502              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19503              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 357
* EL6311.cbl
 19504              MOVE PB-SV-STATE            TO PI-SV-STATE
 19505              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19506              GO TO 7100-DISPLAY-CANCELS
 19507           ELSE
 19508              GO TO 4110-BUMP-SEQ.
 19509
 19510     IF PB-CANCELLATION
 19511        IF CANCEL-WITH-WARNING
 19512           IF PB-WARNING-ERRORS
 19513              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19514                  GO TO 4110-BUMP-SEQ
 19515              ELSE
 19516                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19517                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19518                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19519                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19520                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19521                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19522                 GO TO 7100-DISPLAY-CANCELS
 19523           ELSE
 19524              GO TO 4110-BUMP-SEQ.
 19525
 19526     IF PB-CANCELLATION
 19527        IF (CANCEL-IN-ERROR  AND
 19528            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19529            ALL-CANCELS
 19530            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19531            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19532            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19533            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19534            MOVE PB-SV-STATE            TO PI-SV-STATE
 19535            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19536            GO TO 7100-DISPLAY-CANCELS.
 19537
 19538 4110-BUMP-SEQ.
 19539     IF NOT DISPLAY-CHANGE-RECORDS
 19540        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19541        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19542     ELSE
 19543        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19544           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19545           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19546        ELSE
 19547           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19548           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19549
 19550     GO TO 4105-READ-NEXT.
 19551
 19552 4150-END-BATCH.
 19553******************************************************************
 19554*                                                                *
 19555*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19556*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19557*         PROGRAM.                                               *
 19558*                                                                *
 19559******************************************************************
 19560
 19561     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 358
* EL6311.cbl
 19562         IF PENDING-BUS-RECS-FOUND
 19563             NEXT SENTENCE
 19564           ELSE
 19565             MOVE '9'            TO PI-BROWSE-SW
 19566             GO TO 9400-CLEAR.
 19567
 19568     IF SHOW-RECORD
 19569        MOVE ER-2253             TO EMI-ERROR
 19570     ELSE
 19571        MOVE ER-2251             TO EMI-ERROR.
 19572
 19573     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19574
 19575     IF PI-MAP-NAME = SPACES
 19576        MOVE -1                  TO BMAINTL
 19577        MOVE EL631B              TO PI-MAP-NAME
 19578        GO TO 8100-SEND-INITIAL-MAP.
 19579
 19580     IF PI-MAP-NAME = EL631B
 19581        MOVE -1                  TO BMAINTL
 19582     ELSE
 19583        IF PI-MAP-NAME = EL631C
 19584           MOVE -1               TO CMAINTL
 19585        ELSE
 19586           MOVE -1               TO DPFENTRL.
 19587
 19588     GO TO 8200-SEND-DATAONLY.
 19589
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 359
* EL6311.cbl
 19591
 19592***************************************************************
 19593*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19594*                                                             *
 19595*      1. START BROWSE WITH                                   *
 19596*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19597*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19598*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19599*                                                             *
 19600*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19601*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19602*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19603*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19604*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19605*               AND IS IT TO BE DISPLAYED.                    *
 19606*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19607*               DISPLAYED.                                    *
 19608*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19609*               DISPLAYED.                                    *
 19610*                                                             *
 19611*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19612*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19613***************************************************************
 19614
 19615 4200-BROWSE-CSR-FORWARD.
 19616
 19617     IF FIRST-TIME
 19618        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19619     ELSE
 19620        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19621
 19622
 19623* EXEC CICS HANDLE CONDITION
 19624*         NOTFND   (4250-END-RECORDS)
 19625*         ENDFILE  (4250-END-RECORDS)
 19626*    END-EXEC.
 19627*    MOVE '"$I''                  ! L #00016792' TO DFHEIV0
 19628     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19629     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19630     MOVE X'4C20233030303136373932' TO DFHEIV0(25:11)
 19631     CALL 'kxdfhei1' USING DFHEIV0
 19632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19633
 19634
 19635
 19636* EXEC CICS STARTBR
 19637*         DATASET   (FILE-ID-ERPNDB4)
 19638*         RIDFLD    (ERPNDB-CSR-KEY)
 19639*    END-EXEC.
 19640     MOVE 0
 19641       TO DFHEIV11
 19642*    MOVE '&,         G          &   #00016797' TO DFHEIV0
 19643     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19644     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19645     MOVE X'2020233030303136373937' TO DFHEIV0(25:11)
 19646     CALL 'kxdfhei1' USING DFHEIV0,
 19647           FILE-ID-ERPNDB4,
 19648           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 360
* EL6311.cbl
 19649           DFHEIV99,
 19650           DFHEIV11,
 19651           DFHEIV99
 19652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19653
 19654
 19655     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19656
 19657     IF FIRST-TIME
 19658        MOVE SPACE               TO WS-FIRST-TIME-SW
 19659        GO TO 4205-READ-NEXT-RECORD.
 19660
 19661
 19662* EXEC CICS READNEXT
 19663*         DATASET    (FILE-ID-ERPNDB4)
 19664*         SET        (ADDRESS OF PENDING-BUSINESS)
 19665*         RIDFLD     (ERPNDB-CSR-KEY)
 19666*    END-EXEC.
 19667     MOVE 0
 19668       TO DFHEIV11
 19669*    MOVE '&.S                   )   #00016808' TO DFHEIV0
 19670     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19671     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19672     MOVE X'2020233030303136383038' TO DFHEIV0(25:11)
 19673     CALL 'kxdfhei1' USING DFHEIV0,
 19674           FILE-ID-ERPNDB4,
 19675           DFHEIV20,
 19676           DFHEIV99,
 19677           ERPNDB-CSR-KEY,
 19678           DFHEIV99,
 19679           DFHEIV11,
 19680           DFHEIV99,
 19681           DFHEIV99
 19682     SET ADDRESS OF PENDING-BUSINESS TO
 19683         DFHEIV20
 19684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19685
 19686
 19687 4205-READ-NEXT-RECORD.
 19688
 19689
 19690* EXEC CICS READNEXT
 19691*         DATASET    (FILE-ID-ERPNDB4)
 19692*         SET        (ADDRESS OF PENDING-BUSINESS)
 19693*         RIDFLD     (ERPNDB-CSR-KEY)
 19694*    END-EXEC.
 19695     MOVE 0
 19696       TO DFHEIV11
 19697*    MOVE '&.S                   )   #00016816' TO DFHEIV0
 19698     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19699     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19700     MOVE X'2020233030303136383136' TO DFHEIV0(25:11)
 19701     CALL 'kxdfhei1' USING DFHEIV0,
 19702           FILE-ID-ERPNDB4,
 19703           DFHEIV20,
 19704           DFHEIV99,
 19705           ERPNDB-CSR-KEY,
 19706           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 361
* EL6311.cbl
 19707           DFHEIV11,
 19708           DFHEIV99,
 19709           DFHEIV99
 19710     SET ADDRESS OF PENDING-BUSINESS TO
 19711         DFHEIV20
 19712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19713
 19714
 19715     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19716
 19717     IF WS-BATCH-PREFIX = '#CL'
 19718        GO TO 4205-READ-NEXT-RECORD.
 19719
 19720     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19721        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19722        GO TO 4250-END-RECORDS.
 19723
 19724     IF PB-BATCH-TRAILER
 19725        GO TO 4205-READ-NEXT-RECORD.
 19726
 19727     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19728        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19729           GO TO 4205-READ-NEXT-RECORD
 19730        ELSE
 19731           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19732              GO TO 4210-CHECK-REC-TYPE
 19733           ELSE
 19734              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19735                 GO TO 4210-CHECK-REC-TYPE
 19736              ELSE
 19737                 GO TO 4205-READ-NEXT-RECORD.
 19738
 19739     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19740        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19741           GO TO 4205-READ-NEXT-RECORD.
 19742
 19743 4210-CHECK-REC-TYPE.
 19744     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19745         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19746             NEXT SENTENCE
 19747         ELSE
 19748             GO TO 4205-READ-NEXT-RECORD.
 19749
 19750     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19751         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19752             NEXT SENTENCE
 19753        ELSE
 19754             GO TO 4205-READ-NEXT-RECORD.
 19755
 19756     IF NOT DISPLAY-CHANGE-RECORDS AND
 19757            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19758        GO TO 4205-READ-NEXT-RECORD.
 19759
 19760     IF DISPLAY-HOLD-RECORDS AND
 19761        NOT PB-RECORD-ON-HOLD
 19762          GO TO 4205-READ-NEXT-RECORD.
 19763
 19764     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 362
* EL6311.cbl
 19765        IF DISPLAY-CHK-REQ-RECORDS
 19766            GO TO 4205-READ-NEXT-RECORD.
 19767
 19768     IF PB-ISSUE
 19769        IF ISSUE-WITH-WARNING
 19770           IF PB-WARNING-ERRORS
 19771              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19772                  GO TO 4205-READ-NEXT-RECORD
 19773              ELSE
 19774                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19775                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19776                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19777                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19778                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19779                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19780                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19781                 GO TO 7000-DISPLAY-ISSUES
 19782           ELSE
 19783              GO TO 4205-READ-NEXT-RECORD.
 19784
 19785     IF PB-ISSUE
 19786        IF (ISSUES-IN-ERROR AND
 19787            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19788            ALL-ISSUES
 19789            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19790            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19791            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19792            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19793            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19794            MOVE PB-SV-STATE            TO PI-SV-STATE
 19795            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19796            GO TO 7000-DISPLAY-ISSUES
 19797        ELSE
 19798            GO TO 4205-READ-NEXT-RECORD.
 19799
 19800     IF PB-CANCELLATION
 19801        IF DISPLAY-CHK-REQ-RECORDS
 19802           IF PB-C-REFUND-REQUESTED
 19803              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19804              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19805              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19806              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19807              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19808              MOVE PB-SV-STATE            TO PI-SV-STATE
 19809              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19810              GO TO 7100-DISPLAY-CANCELS
 19811           ELSE
 19812               GO TO 4205-READ-NEXT-RECORD.
 19813
 19814     IF PB-CANCELLATION
 19815        IF CANCEL-WITH-WARNING
 19816           IF PB-WARNING-ERRORS
 19817              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19818                  GO TO 4205-READ-NEXT-RECORD
 19819              ELSE
 19820                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19821                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19822                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 363
* EL6311.cbl
 19823                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19824                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19825                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19826                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19827                 GO TO 7100-DISPLAY-CANCELS
 19828           ELSE
 19829              GO TO 4205-READ-NEXT-RECORD.
 19830
 19831     IF PB-CANCELLATION
 19832        IF (CANCEL-IN-ERROR  AND
 19833            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19834            ALL-CANCELS
 19835            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19836            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19837            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19838            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19839            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19840            MOVE PB-SV-STATE            TO PI-SV-STATE
 19841            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19842            GO TO 7100-DISPLAY-CANCELS.
 19843
 19844     GO TO 4205-READ-NEXT-RECORD.
 19845
 19846 4250-END-RECORDS.
 19847******************************************************************
 19848*                                                                *
 19849*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19850*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19851*         PROGRAM.                                               *
 19852*                                                                *
 19853******************************************************************
 19854
 19855     IF BROWSE-STARTED
 19856        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19857
 19858* EXEC CICS ENDBR
 19859*            DATASET  (FILE-ID-ERPNDB4)
 19860*       END-EXEC.
 19861     MOVE 0
 19862       TO DFHEIV11
 19863*    MOVE '&2                    $   #00016964' TO DFHEIV0
 19864     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19865     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19866     MOVE X'2020233030303136393634' TO DFHEIV0(25:11)
 19867     CALL 'kxdfhei1' USING DFHEIV0,
 19868           FILE-ID-ERPNDB4,
 19869           DFHEIV11,
 19870           DFHEIV99
 19871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19872
 19873
 19874     IF  EIBTRNID NOT = TRANS-EXB1
 19875         IF PENDING-BUS-RECS-FOUND
 19876             NEXT SENTENCE
 19877           ELSE
 19878             MOVE '9'            TO PI-BROWSE-SW
 19879             GO TO 9400-CLEAR.
 19880
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 364
* EL6311.cbl
 19881     IF SHOW-RECORD
 19882        MOVE ER-2253            TO EMI-ERROR
 19883       ELSE
 19884        MOVE ER-2254            TO EMI-ERROR.
 19885
 19886     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19887
 19888     IF PI-MAP-NAME = SPACES
 19889        MOVE -1                  TO DPFENTRL
 19890        MOVE EL631D               TO PI-MAP-NAME
 19891        GO TO 8100-SEND-INITIAL-MAP.
 19892
 19893     IF PI-MAP-NAME = EL631B
 19894        MOVE -1                  TO BMAINTL
 19895     ELSE
 19896        IF PI-MAP-NAME = EL631C
 19897           MOVE -1               TO CMAINTL
 19898        ELSE
 19899           MOVE -1               TO DPFENTRL.
 19900
 19901     GO TO 8200-SEND-DATAONLY.
 19902
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 365
* EL6311.cbl
 19904
 19905***************************************************************
 19906*                                                             *
 19907*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19908*                                                             *
 19909*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19910*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19911*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19912*                                                             *
 19913*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19914*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19915*          A. IS IT WITHIN THE SAME COMPANY                   *
 19916*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19917*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19918*                AND IS IT TO BE DISPLAYED.                   *
 19919*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19920*                DISPLAYED.                                   *
 19921*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19922*                DISPLAYED.                                   *
 19923*                                                             *
 19924*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19925*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19926*                                                             *
 19927*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19928*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19929*                THEY ARE NOT TO BE DISPLAYED.                *
 19930*                                                             *
 19931***************************************************************
 19932
 19933 4300-BROWSE-FILE-FORWARD.
 19934     IF FIRST-TIME OR SHOW-RECORD
 19935        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19936        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19937        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19938     ELSE
 19939        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19940        IF ERPNDB-BATCH-SEQ-NO = +9999
 19941           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19942        ELSE
 19943           IF DISPLAY-CHANGE-RECORDS
 19944              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19945           ELSE
 19946              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19947              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19948
 19949
 19950* EXEC CICS HANDLE CONDITION
 19951*         ENDFILE  (4350-END-BATCH)
 19952*         NOTFND   (4350-END-BATCH)
 19953*    END-EXEC.
 19954*    MOVE '"$''I                  ! M #00017043' TO DFHEIV0
 19955     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19957     MOVE X'4D20233030303137303433' TO DFHEIV0(25:11)
 19958     CALL 'kxdfhei1' USING DFHEIV0
 19959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19960
 19961
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 366
* EL6311.cbl
 19962 4305-READ-NEXT.
 19963     IF PI-DISPLAY-ORIGINAL-BATCH
 19964        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19965     ELSE
 19966        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19967
 19968
 19969* EXEC CICS READ
 19970*         DATASET   (FILE-ID)
 19971*         SET       (ADDRESS OF PENDING-BUSINESS)
 19972*         RIDFLD    (ERPNDB-KEY)
 19973*         GTEQ
 19974*    END-EXEC.
 19975*    MOVE '&"S        G          (   #00017054' TO DFHEIV0
 19976     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19977     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19978     MOVE X'2020233030303137303534' TO DFHEIV0(25:11)
 19979     CALL 'kxdfhei1' USING DFHEIV0,
 19980           FILE-ID,
 19981           DFHEIV20,
 19982           DFHEIV99,
 19983           ERPNDB-KEY,
 19984           DFHEIV99,
 19985           DFHEIV99,
 19986           DFHEIV99
 19987     SET ADDRESS OF PENDING-BUSINESS TO
 19988         DFHEIV20
 19989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19990
 19991
 19992     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19993        GO TO 4350-END-BATCH.
 19994
 19995     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19996                                    WS-BATCH-NO.
 19997
 19998     IF  WS-BATCH-PREFIX = '#CL'
 19999         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20000         GO TO 4305-READ-NEXT.
 20001
 20002     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 20003     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 20004     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 20005     MOVE PB-STATE               TO PI-PB-STATE.
 20006     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 20007
 20008     IF PB-BATCH-TRAILER
 20009        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 20010        GO TO 4305-READ-NEXT.
 20011
 20012     IF SHOW-RECORD
 20013           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 20014              GO TO 4310-BUMP-SEQ
 20015           ELSE
 20016              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20017                 GO TO 4310-BUMP-SEQ
 20018              ELSE
 20019                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 367
* EL6311.cbl
 20020
 20021     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20022        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20023           GO TO 4310-BUMP-SEQ
 20024        ELSE
 20025           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20026              GO TO 4307-CHECK-REC-TYPE
 20027           ELSE
 20028              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20029                 GO TO 4307-CHECK-REC-TYPE
 20030              ELSE
 20031                 GO TO 4310-BUMP-SEQ.
 20032
 20033     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20034        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20035           GO TO 4310-BUMP-SEQ.
 20036
 20037 4307-CHECK-REC-TYPE.
 20038     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20039         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20040             NEXT SENTENCE
 20041         ELSE
 20042             GO TO 4310-BUMP-SEQ.
 20043
 20044     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20045         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20046             NEXT SENTENCE
 20047        ELSE
 20048             GO TO 4310-BUMP-SEQ.
 20049
 20050     IF NOT DISPLAY-CHANGE-RECORDS AND
 20051            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20052        GO TO 4310-BUMP-SEQ.
 20053
 20054     IF DISPLAY-HOLD-RECORDS AND
 20055        NOT PB-RECORD-ON-HOLD
 20056          GO TO 4310-BUMP-SEQ.
 20057
 20058     IF PB-ISSUE
 20059        IF DISPLAY-CHK-REQ-RECORDS
 20060           GO TO 4310-BUMP-SEQ.
 20061
 20062     IF PB-ISSUE
 20063        IF ISSUE-WITH-WARNING
 20064           IF PB-WARNING-ERRORS
 20065              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20066                  GO TO 4310-BUMP-SEQ
 20067              ELSE
 20068                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20069                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20070                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20071                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20072                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20073                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20074                 GO TO 7000-DISPLAY-ISSUES
 20075           ELSE
 20076              GO TO 4310-BUMP-SEQ.
 20077
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 368
* EL6311.cbl
 20078     IF PB-ISSUE
 20079        IF (ISSUES-IN-ERROR AND
 20080            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20081            ALL-ISSUES
 20082            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20083            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20084            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20085            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20086            MOVE PB-SV-STATE            TO PI-SV-STATE
 20087            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20088            GO TO 7000-DISPLAY-ISSUES
 20089        ELSE
 20090            GO TO 4310-BUMP-SEQ.
 20091
 20092     IF PB-CANCELLATION
 20093        IF DISPLAY-CHK-REQ-RECORDS
 20094           IF PB-C-REFUND-REQUESTED
 20095              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20096              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20097              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20098              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20099              MOVE PB-SV-STATE            TO PI-SV-STATE
 20100              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20101              GO TO 7100-DISPLAY-CANCELS
 20102           ELSE
 20103              GO TO 4310-BUMP-SEQ.
 20104
 20105     IF PB-CANCELLATION
 20106        IF CANCEL-WITH-WARNING
 20107           IF PB-WARNING-ERRORS
 20108              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20109                  GO TO 4310-BUMP-SEQ
 20110              ELSE
 20111                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20112                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20113                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20114                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20115                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20116                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20117                 GO TO 7100-DISPLAY-CANCELS
 20118           ELSE
 20119              GO TO 4310-BUMP-SEQ.
 20120
 20121     IF PB-CANCELLATION
 20122        IF (CANCEL-IN-ERROR  AND
 20123            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20124            ALL-CANCELS
 20125            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20126            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20127            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20128            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20129            MOVE PB-SV-STATE            TO PI-SV-STATE
 20130            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20131            GO TO 7100-DISPLAY-CANCELS.
 20132
 20133 4310-BUMP-SEQ.
 20134     IF NOT DISPLAY-CHANGE-RECORDS
 20135        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 369
* EL6311.cbl
 20136        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 20137     ELSE
 20138        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 20139           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 20140           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 20141        ELSE
 20142           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 20143           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 20144
 20145     GO TO 4305-READ-NEXT.
 20146
 20147 4350-END-BATCH.
 20148
 20149******************************************************************
 20150*                                                                *
 20151*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 20152*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 20153*         PROGRAM.                                               *
 20154*                                                                *
 20155******************************************************************
 20156
 20157     IF  EIBTRNID NOT = TRANS-EXB1
 20158         IF PENDING-BUS-RECS-FOUND
 20159             NEXT SENTENCE
 20160           ELSE
 20161             MOVE '9'            TO PI-BROWSE-SW
 20162             GO TO 9400-CLEAR.
 20163
 20164     IF SHOW-RECORD
 20165        MOVE ER-2253            TO EMI-ERROR
 20166     ELSE
 20167        MOVE ER-2251            TO EMI-ERROR.
 20168
 20169     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20170
 20171     IF PI-MAP-NAME = SPACES
 20172        MOVE -1                  TO BMAINTL
 20173        MOVE EL631B               TO PI-MAP-NAME
 20174        GO TO 8100-SEND-INITIAL-MAP.
 20175
 20176     IF PI-MAP-NAME = EL631B
 20177        MOVE -1                  TO BMAINTL
 20178     ELSE
 20179        IF PI-MAP-NAME = EL631C
 20180           MOVE -1               TO CMAINTL
 20181        ELSE
 20182           MOVE -1               TO DPFENTRL.
 20183
 20184     GO TO 8200-SEND-DATAONLY.
 20185
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 370
* EL6311.cbl
 20187
 20188******************************************************************
 20189*                                                                *
 20190*        B R O W S E   D E T A I L   B A C K W A R D             *
 20191*                                                                *
 20192******************************************************************
 20193
 20194 4500-BROWSE-DETAIL-BACKWARD.
 20195
 20196     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 20197
 20198
 20199* EXEC CICS HANDLE CONDITION
 20200*         NOTFND   (4570-NOT-FOUND)
 20201*         ENDFILE  (4550-END-RECORDS)
 20202*    END-EXEC
 20203*    MOVE '"$I''                  ! N #00017267' TO DFHEIV0
 20204     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20205     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20206     MOVE X'4E20233030303137323637' TO DFHEIV0(25:11)
 20207     CALL 'kxdfhei1' USING DFHEIV0
 20208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20209
 20210
 20211* EXEC CICS STARTBR
 20212*         DATASET   (FILE-ID-ERPNDB2)
 20213*         RIDFLD    (ERPNDB-ALT-KEY)
 20214*    END-EXEC.
 20215     MOVE 0
 20216       TO DFHEIV11
 20217*    MOVE '&,         G          &   #00017272' TO DFHEIV0
 20218     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20219     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20220     MOVE X'2020233030303137323732' TO DFHEIV0(25:11)
 20221     CALL 'kxdfhei1' USING DFHEIV0,
 20222           FILE-ID-ERPNDB2,
 20223           ERPNDB-ALT-KEY,
 20224           DFHEIV99,
 20225           DFHEIV11,
 20226           DFHEIV99
 20227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20228
 20229
 20230     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20231                                    WS-FIRST-TIME-SW.
 20232
 20233 4505-READ-PREV-RECORD.
 20234
 20235* EXEC CICS READPREV
 20236*         DATASET    (FILE-ID-ERPNDB2)
 20237*         SET        (ADDRESS OF PENDING-BUSINESS)
 20238*         RIDFLD     (ERPNDB-ALT-KEY)
 20239*    END-EXEC.
 20240     MOVE 0
 20241       TO DFHEIV11
 20242*    MOVE '&0S                   )   #00017281' TO DFHEIV0
 20243     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20244     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 371
* EL6311.cbl
 20245     MOVE X'2020233030303137323831' TO DFHEIV0(25:11)
 20246     CALL 'kxdfhei1' USING DFHEIV0,
 20247           FILE-ID-ERPNDB2,
 20248           DFHEIV20,
 20249           DFHEIV99,
 20250           ERPNDB-ALT-KEY,
 20251           DFHEIV99,
 20252           DFHEIV11,
 20253           DFHEIV99,
 20254           DFHEIV99
 20255     SET ADDRESS OF PENDING-BUSINESS TO
 20256         DFHEIV20
 20257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20258
 20259
 20260     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20261
 20262     IF WS-BATCH-PREFIX = '#CL'
 20263         GO TO 4505-READ-PREV-RECORD.
 20264
 20265     IF FIRST-TIME
 20266         MOVE SPACE               TO WS-FIRST-TIME-SW
 20267         GO TO 4505-READ-PREV-RECORD.
 20268
 20269     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 20270        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 20271        PB-GROUPING      NOT = PI-PB-GROUPING OR
 20272        PB-STATE         NOT = PI-PB-STATE    OR
 20273        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 20274          GO TO 4550-END-RECORDS.
 20275
 20276
 20277     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20278
 20279     IF PB-BATCH-TRAILER
 20280        GO TO 4505-READ-PREV-RECORD.
 20281
 20282     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20283
 20284     IF  WS-BATCH-PREFIX = '#CL'
 20285         GO TO 4505-READ-PREV-RECORD.
 20286
 20287     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20288        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20289           GO TO 4505-READ-PREV-RECORD
 20290        ELSE
 20291           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20292              GO TO 4510-CHECK-REC-TYPE
 20293           ELSE
 20294              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20295                 GO TO 4510-CHECK-REC-TYPE
 20296              ELSE
 20297                 GO TO 4505-READ-PREV-RECORD.
 20298
 20299     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20300        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20301           GO TO 4505-READ-PREV-RECORD.
 20302
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 372
* EL6311.cbl
 20303 4510-CHECK-REC-TYPE.
 20304     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20305         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20306             NEXT SENTENCE
 20307         ELSE
 20308             GO TO 4505-READ-PREV-RECORD.
 20309
 20310     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20311         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20312             NEXT SENTENCE
 20313        ELSE
 20314             GO TO 4505-READ-PREV-RECORD.
 20315
 20316     IF NOT DISPLAY-CHANGE-RECORDS AND
 20317            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20318        GO TO 4505-READ-PREV-RECORD.
 20319
 20320     IF DISPLAY-HOLD-RECORDS AND
 20321        NOT PB-RECORD-ON-HOLD
 20322          GO TO 4505-READ-PREV-RECORD.
 20323
 20324     IF PB-ISSUE
 20325        IF DISPLAY-CHK-REQ-RECORDS
 20326           GO TO 4505-READ-PREV-RECORD.
 20327
 20328     IF PB-ISSUE
 20329        IF ISSUE-WITH-WARNING
 20330           IF PB-WARNING-ERRORS
 20331              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20332                  GO TO 4505-READ-PREV-RECORD
 20333              ELSE
 20334                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20335                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20336                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20337                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20338                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20339                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20340                 GO TO 7000-DISPLAY-ISSUES
 20341           ELSE
 20342              GO TO 4505-READ-PREV-RECORD.
 20343
 20344     IF PB-ISSUE
 20345        IF (ISSUES-IN-ERROR AND
 20346            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20347            ALL-ISSUES
 20348            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20349            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20350            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20351            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20352            MOVE PB-SV-STATE            TO PI-SV-STATE
 20353            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20354            GO TO 7000-DISPLAY-ISSUES
 20355        ELSE
 20356            GO TO 4505-READ-PREV-RECORD.
 20357
 20358     IF PB-CANCELLATION
 20359        IF DISPLAY-CHK-REQ-RECORDS
 20360           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 373
* EL6311.cbl
 20361              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20362              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20363              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20364              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20365              MOVE PB-SV-STATE            TO PI-SV-STATE
 20366              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20367              GO TO 7100-DISPLAY-CANCELS
 20368           ELSE
 20369              GO TO 4505-READ-PREV-RECORD.
 20370
 20371     IF PB-CANCELLATION
 20372        IF CANCEL-WITH-WARNING
 20373           IF PB-WARNING-ERRORS
 20374              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20375                  GO TO 4505-READ-PREV-RECORD
 20376              ELSE
 20377                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20378                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20379                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20380                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20381                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20382                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20383                 GO TO 7100-DISPLAY-CANCELS
 20384           ELSE
 20385              GO TO 4505-READ-PREV-RECORD.
 20386
 20387     IF PB-CANCELLATION
 20388        IF (CANCEL-IN-ERROR  AND
 20389            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20390            ALL-CANCELS
 20391            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20392            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20393            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20394            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20395            MOVE PB-SV-STATE            TO PI-SV-STATE
 20396            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20397            GO TO 7100-DISPLAY-CANCELS.
 20398
 20399     GO TO 4505-READ-PREV-RECORD.
 20400
 20401 4550-END-RECORDS.
 20402     IF PI-MAP-NAME = EL631B
 20403        MOVE -1                  TO BMAINTL
 20404     ELSE
 20405        IF PI-MAP-NAME = EL631C
 20406           MOVE -1               TO CMAINTL
 20407        ELSE
 20408           MOVE -1               TO DPFENTRL.
 20409
 20410     MOVE ER-2255               TO EMI-ERROR.
 20411     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20412     GO TO 8200-SEND-DATAONLY.
 20413
 20414 4570-NOT-FOUND.
 20415
 20416******************************************************************
 20417*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20418******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 374
* EL6311.cbl
 20419
 20420
 20421* EXEC CICS RESETBR
 20422*         DATASET    (FILE-ID-ERPNDB2)
 20423*         RIDFLD     (ERPNDB-ALT-KEY)
 20424*    END-EXEC.
 20425     MOVE 0
 20426       TO DFHEIV11
 20427*    MOVE '&4         G          &   #00017447' TO DFHEIV0
 20428     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20429     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20430     MOVE X'2020233030303137343437' TO DFHEIV0(25:11)
 20431     CALL 'kxdfhei1' USING DFHEIV0,
 20432           FILE-ID-ERPNDB2,
 20433           ERPNDB-ALT-KEY,
 20434           DFHEIV99,
 20435           DFHEIV11,
 20436           DFHEIV99
 20437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20438
 20439
 20440
 20441* EXEC CICS READNEXT
 20442*         DATASET    (FILE-ID-ERPNDB2)
 20443*         SET        (ADDRESS OF PENDING-BUSINESS)
 20444*         RIDFLD     (ERPNDB-ALT-KEY)
 20445*    END-EXEC.
 20446     MOVE 0
 20447       TO DFHEIV11
 20448*    MOVE '&.S                   )   #00017452' TO DFHEIV0
 20449     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20450     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20451     MOVE X'2020233030303137343532' TO DFHEIV0(25:11)
 20452     CALL 'kxdfhei1' USING DFHEIV0,
 20453           FILE-ID-ERPNDB2,
 20454           DFHEIV20,
 20455           DFHEIV99,
 20456           ERPNDB-ALT-KEY,
 20457           DFHEIV99,
 20458           DFHEIV11,
 20459           DFHEIV99,
 20460           DFHEIV99
 20461     SET ADDRESS OF PENDING-BUSINESS TO
 20462         DFHEIV20
 20463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20464
 20465
 20466
 20467* EXEC CICS READPREV
 20468*         DATASET    (FILE-ID-ERPNDB2)
 20469*         SET        (ADDRESS OF PENDING-BUSINESS)
 20470*         RIDFLD     (ERPNDB-ALT-KEY)
 20471*    END-EXEC.
 20472     MOVE 0
 20473       TO DFHEIV11
 20474*    MOVE '&0S                   )   #00017458' TO DFHEIV0
 20475     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20476     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 375
* EL6311.cbl
 20477     MOVE X'2020233030303137343538' TO DFHEIV0(25:11)
 20478     CALL 'kxdfhei1' USING DFHEIV0,
 20479           FILE-ID-ERPNDB2,
 20480           DFHEIV20,
 20481           DFHEIV99,
 20482           ERPNDB-ALT-KEY,
 20483           DFHEIV99,
 20484           DFHEIV11,
 20485           DFHEIV99,
 20486           DFHEIV99
 20487     SET ADDRESS OF PENDING-BUSINESS TO
 20488         DFHEIV20
 20489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20490
 20491
 20492 4580-READ-PREV-RECORD.
 20493
 20494* EXEC CICS READPREV
 20495*         DATASET    (FILE-ID-ERPNDB2)
 20496*         SET        (ADDRESS OF PENDING-BUSINESS)
 20497*         RIDFLD     (ERPNDB-ALT-KEY)
 20498*    END-EXEC.
 20499     MOVE 0
 20500       TO DFHEIV11
 20501*    MOVE '&0S                   )   #00017465' TO DFHEIV0
 20502     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20503     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20504     MOVE X'2020233030303137343635' TO DFHEIV0(25:11)
 20505     CALL 'kxdfhei1' USING DFHEIV0,
 20506           FILE-ID-ERPNDB2,
 20507           DFHEIV20,
 20508           DFHEIV99,
 20509           ERPNDB-ALT-KEY,
 20510           DFHEIV99,
 20511           DFHEIV11,
 20512           DFHEIV99,
 20513           DFHEIV99
 20514     SET ADDRESS OF PENDING-BUSINESS TO
 20515         DFHEIV20
 20516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20517
 20518
 20519     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20520
 20521     IF WS-BATCH-PREFIX = '#CL'
 20522        GO TO 4580-READ-PREV-RECORD.
 20523
 20524     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20525     GO TO 4505-READ-PREV-RECORD.
 20526
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 376
* EL6311.cbl
 20528
 20529******************************************************************
 20530*                                                                *
 20531*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20532*                                                                *
 20533******************************************************************
 20534
 20535 4600-BROWSE-PRIMARY-BACKWARD.
 20536        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20537
 20538     IF ERPNDB-BATCH-SEQ-NO = +9999
 20539        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20540
 20541        IF ERPNDB-BATCH-SEQ-NO = +0000
 20542           GO TO 4650-END-BATCH
 20543        ELSE
 20544           IF PI-MAP-NAME NOT = EL631D
 20545              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20546                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20547              ELSE
 20548                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20549                 IF DISPLAY-CHANGE-RECORDS
 20550                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20551                 ELSE
 20552                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20553
 20554
 20555* EXEC CICS HANDLE CONDITION
 20556*         NOTFND    (4680-NOT-FOUND)
 20557*         ENDFILE   (4680-NOT-FOUND)
 20558*    END-EXEC.
 20559*    MOVE '"$I''                  ! O #00017506' TO DFHEIV0
 20560     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20561     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20562     MOVE X'4F20233030303137353036' TO DFHEIV0(25:11)
 20563     CALL 'kxdfhei1' USING DFHEIV0
 20564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20565
 20566
 20567 4605-READ-NEXT.
 20568     IF ERPNDB-BATCH-SEQ-NO = +0000
 20569        GO TO 4650-END-BATCH.
 20570
 20571     IF PI-DISPLAY-ORIGINAL-BATCH
 20572        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20573     ELSE
 20574        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20575
 20576
 20577* EXEC CICS READ
 20578*         DATASET   (FILE-ID)
 20579*         SET       (ADDRESS OF PENDING-BUSINESS)
 20580*         RIDFLD    (ERPNDB-KEY)
 20581*    END-EXEC.
 20582*    MOVE '&"S        E          (   #00017520' TO DFHEIV0
 20583     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20584     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20585     MOVE X'2020233030303137353230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 377
* EL6311.cbl
 20586     CALL 'kxdfhei1' USING DFHEIV0,
 20587           FILE-ID,
 20588           DFHEIV20,
 20589           DFHEIV99,
 20590           ERPNDB-KEY,
 20591           DFHEIV99,
 20592           DFHEIV99,
 20593           DFHEIV99
 20594     SET ADDRESS OF PENDING-BUSINESS TO
 20595         DFHEIV20
 20596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20597
 20598
 20599     IF NOT  PI-PRIMARY-WITH-SELECT
 20600        GO TO 4607-CHECK-REC-TYPE.
 20601
 20602     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20603
 20604     IF  WS-BATCH-PREFIX = '#CL'
 20605         GO TO 4610-BUMP-SEQ.
 20606
 20607     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20608        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20609           GO TO 4610-BUMP-SEQ
 20610        ELSE
 20611           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20612              GO TO 4607-CHECK-REC-TYPE
 20613           ELSE
 20614              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20615                 GO TO 4607-CHECK-REC-TYPE
 20616              ELSE
 20617                 GO TO 4610-BUMP-SEQ.
 20618
 20619     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20620        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20621           GO TO 4610-BUMP-SEQ.
 20622
 20623 4607-CHECK-REC-TYPE.
 20624     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20625         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20626             NEXT SENTENCE
 20627         ELSE
 20628             GO TO 4610-BUMP-SEQ.
 20629
 20630     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20631         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20632             NEXT SENTENCE
 20633        ELSE
 20634             GO TO 4610-BUMP-SEQ.
 20635
 20636     IF NOT DISPLAY-CHANGE-RECORDS AND
 20637            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20638        GO TO 4610-BUMP-SEQ.
 20639
 20640     IF DISPLAY-HOLD-RECORDS AND
 20641        NOT PB-RECORD-ON-HOLD
 20642          GO TO 4610-BUMP-SEQ.
 20643
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 378
* EL6311.cbl
 20644     IF PB-ISSUE
 20645        IF DISPLAY-CHK-REQ-RECORDS
 20646           GO TO 4610-BUMP-SEQ.
 20647
 20648     IF PB-ISSUE
 20649        IF ISSUE-WITH-WARNING
 20650           IF PB-WARNING-ERRORS
 20651              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20652                  GO TO 4610-BUMP-SEQ
 20653              ELSE
 20654                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20655                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20656                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20657                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20658                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20659                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20660                 GO TO 7000-DISPLAY-ISSUES
 20661           ELSE
 20662              GO TO 4610-BUMP-SEQ.
 20663
 20664     IF PB-ISSUE
 20665        IF (ISSUES-IN-ERROR AND
 20666            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20667            ALL-ISSUES
 20668            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20669            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20670            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20671            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20672            MOVE PB-SV-STATE            TO PI-SV-STATE
 20673            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20674            GO TO 7000-DISPLAY-ISSUES
 20675        ELSE
 20676            GO TO 4610-BUMP-SEQ.
 20677
 20678     IF PB-CANCELLATION
 20679        IF DISPLAY-CHK-REQ-RECORDS
 20680           IF PB-C-REFUND-REQUESTED
 20681              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20682              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20683              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20684              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20685              MOVE PB-SV-STATE            TO PI-SV-STATE
 20686              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20687              GO TO 7100-DISPLAY-CANCELS
 20688           ELSE
 20689              GO TO 4610-BUMP-SEQ.
 20690
 20691     IF PB-CANCELLATION
 20692        IF CANCEL-WITH-WARNING
 20693           IF PB-WARNING-ERRORS
 20694              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20695                  GO TO 4610-BUMP-SEQ
 20696              ELSE
 20697                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20698                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20699                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20700                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20701                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 379
* EL6311.cbl
 20702                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20703                 GO TO 7100-DISPLAY-CANCELS
 20704           ELSE
 20705              GO TO 4610-BUMP-SEQ.
 20706
 20707     IF PB-CANCELLATION
 20708        IF (CANCEL-IN-ERROR  AND
 20709            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20710            ALL-CANCELS
 20711            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20712            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20713            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20714            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20715            MOVE PB-SV-STATE            TO PI-SV-STATE
 20716            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20717            GO TO 7100-DISPLAY-CANCELS.
 20718
 20719 4610-BUMP-SEQ.
 20720     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20721        GO TO 4650-END-BATCH.
 20722
 20723     IF DISPLAY-CHANGE-RECORDS
 20724        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20725           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20726        ELSE
 20727           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20728           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20729        ELSE
 20730           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20731           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20732
 20733        GO TO 4605-READ-NEXT.
 20734
 20735 4650-END-BATCH.
 20736     IF PI-MAP-NAME = EL631B
 20737        MOVE -1                  TO BMAINTL
 20738     ELSE
 20739        IF PI-MAP-NAME = EL631C
 20740           MOVE -1               TO CMAINTL
 20741        ELSE
 20742           MOVE -1               TO DPFENTRL.
 20743
 20744     MOVE ER-2252               TO EMI-ERROR.
 20745     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20746     GO TO 8200-SEND-DATAONLY.
 20747
 20748 4680-NOT-FOUND.
 20749     IF DISPLAY-CHANGE-RECORDS
 20750        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20751           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20752        ELSE
 20753           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20754           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20755     ELSE
 20756        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20757
 20758     GO TO 4605-READ-NEXT.
 20759
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 380
* EL6311.cbl
 20761
 20762******************************************************************
 20763*                                                                *
 20764*        B R O W S E   F I L E   B A C K W A R D S               *
 20765*                                                                *
 20766******************************************************************
 20767
 20768 4800-BROWSE-FILE-BACKWARD.
 20769
 20770* EXEC CICS HANDLE CONDITION
 20771*         NOTFND   (4860-NOT-FOUND)
 20772*         ENDFILE  (4850-END-RECORDS)
 20773*    END-EXEC.
 20774*    MOVE '"$I''                  ! P #00017696' TO DFHEIV0
 20775     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20776     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20777     MOVE X'5020233030303137363936' TO DFHEIV0(25:11)
 20778     CALL 'kxdfhei1' USING DFHEIV0
 20779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20780
 20781
 20782     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20783
 20784     IF PI-DISPLAY-ORIGINAL-BATCH
 20785        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20786     ELSE
 20787        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20788
 20789
 20790* EXEC CICS STARTBR
 20791*         DATASET   (FILE-ID)
 20792*         RIDFLD    (ERPNDB-KEY)
 20793*    END-EXEC.
 20794     MOVE 0
 20795       TO DFHEIV11
 20796*    MOVE '&,         G          &   #00017708' TO DFHEIV0
 20797     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20798     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20799     MOVE X'2020233030303137373038' TO DFHEIV0(25:11)
 20800     CALL 'kxdfhei1' USING DFHEIV0,
 20801           FILE-ID,
 20802           ERPNDB-KEY,
 20803           DFHEIV99,
 20804           DFHEIV11,
 20805           DFHEIV99
 20806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20807
 20808
 20809     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20810
 20811
 20812* EXEC CICS READPREV
 20813*         DATASET    (FILE-ID-ERPNDB)
 20814*         SET        (ADDRESS OF PENDING-BUSINESS)
 20815*         RIDFLD     (ERPNDB-KEY)
 20816*    END-EXEC.
 20817     MOVE 0
 20818       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 381
* EL6311.cbl
 20819*    MOVE '&0S                   )   #00017715' TO DFHEIV0
 20820     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20821     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20822     MOVE X'2020233030303137373135' TO DFHEIV0(25:11)
 20823     CALL 'kxdfhei1' USING DFHEIV0,
 20824           FILE-ID-ERPNDB,
 20825           DFHEIV20,
 20826           DFHEIV99,
 20827           ERPNDB-KEY,
 20828           DFHEIV99,
 20829           DFHEIV11,
 20830           DFHEIV99,
 20831           DFHEIV99
 20832     SET ADDRESS OF PENDING-BUSINESS TO
 20833         DFHEIV20
 20834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20835
 20836
 20837 4810-READ-PREV-RECORD.
 20838
 20839* EXEC CICS READPREV
 20840*         DATASET    (FILE-ID-ERPNDB)
 20841*         SET        (ADDRESS OF PENDING-BUSINESS)
 20842*         RIDFLD     (ERPNDB-KEY)
 20843*    END-EXEC.
 20844     MOVE 0
 20845       TO DFHEIV11
 20846*    MOVE '&0S                   )   #00017722' TO DFHEIV0
 20847     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20848     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20849     MOVE X'2020233030303137373232' TO DFHEIV0(25:11)
 20850     CALL 'kxdfhei1' USING DFHEIV0,
 20851           FILE-ID-ERPNDB,
 20852           DFHEIV20,
 20853           DFHEIV99,
 20854           ERPNDB-KEY,
 20855           DFHEIV99,
 20856           DFHEIV11,
 20857           DFHEIV99,
 20858           DFHEIV99
 20859     SET ADDRESS OF PENDING-BUSINESS TO
 20860         DFHEIV20
 20861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20862
 20863
 20864     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20865        GO TO 4850-END-RECORDS.
 20866
 20867     IF PB-BATCH-TRAILER
 20868        GO TO 4810-READ-PREV-RECORD.
 20869
 20870     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20871
 20872     IF  WS-BATCH-PREFIX = '#CL'
 20873         GO TO 4810-READ-PREV-RECORD.
 20874
 20875     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20876        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 382
* EL6311.cbl
 20877           GO TO 4810-READ-PREV-RECORD
 20878        ELSE
 20879           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20880              GO TO 4820-CHECK-REC-TYPE
 20881           ELSE
 20882              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20883                 GO TO 4820-CHECK-REC-TYPE
 20884              ELSE
 20885                 GO TO 4810-READ-PREV-RECORD.
 20886
 20887     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20888        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20889           GO TO 4810-READ-PREV-RECORD.
 20890
 20891 4820-CHECK-REC-TYPE.
 20892     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20893         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20894             NEXT SENTENCE
 20895         ELSE
 20896             GO TO 4810-READ-PREV-RECORD.
 20897
 20898     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20899         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20900             NEXT SENTENCE
 20901        ELSE
 20902             GO TO 4810-READ-PREV-RECORD.
 20903
 20904     IF NOT DISPLAY-CHANGE-RECORDS AND
 20905            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20906        GO TO 4810-READ-PREV-RECORD.
 20907
 20908     IF DISPLAY-HOLD-RECORDS AND
 20909        NOT PB-RECORD-ON-HOLD
 20910          GO TO 4810-READ-PREV-RECORD.
 20911
 20912     IF PB-ISSUE
 20913        IF DISPLAY-CHK-REQ-RECORDS
 20914           GO TO 4810-READ-PREV-RECORD.
 20915
 20916     IF PB-ISSUE
 20917        IF ISSUE-WITH-WARNING
 20918           IF PB-WARNING-ERRORS
 20919              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20920                  GO TO 4810-READ-PREV-RECORD
 20921              ELSE
 20922                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20923                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20924                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20925                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20926                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20927                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20928                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20929                 GO TO 7000-DISPLAY-ISSUES
 20930           ELSE
 20931              GO TO 4810-READ-PREV-RECORD.
 20932
 20933     IF PB-ISSUE
 20934        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 383
* EL6311.cbl
 20935            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20936            ALL-ISSUES
 20937            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20938            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20939            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20940            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20941            MOVE PB-SV-STATE            TO PI-SV-STATE
 20942            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20943            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20944            GO TO 7000-DISPLAY-ISSUES
 20945        ELSE
 20946            GO TO 4810-READ-PREV-RECORD.
 20947
 20948     IF PB-CANCELLATION
 20949        IF DISPLAY-CHK-REQ-RECORDS
 20950           IF PB-C-REFUND-REQUESTED
 20951              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20952              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20953              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20954              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20955              MOVE PB-SV-STATE            TO PI-SV-STATE
 20956              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20957              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20958              GO TO 7100-DISPLAY-CANCELS
 20959           ELSE
 20960              GO TO 4810-READ-PREV-RECORD.
 20961
 20962     IF PB-CANCELLATION
 20963        IF CANCEL-WITH-WARNING
 20964           IF PB-WARNING-ERRORS
 20965              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20966                  GO TO 4810-READ-PREV-RECORD
 20967              ELSE
 20968                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20969                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20970                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20971                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20972                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20973                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20974                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20975                 GO TO 7100-DISPLAY-CANCELS
 20976           ELSE
 20977              GO TO 4810-READ-PREV-RECORD.
 20978
 20979     IF PB-CANCELLATION
 20980        IF (CANCEL-IN-ERROR  AND
 20981            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20982            ALL-CANCELS
 20983            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20984            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20985            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20986            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20987            MOVE PB-SV-STATE            TO PI-SV-STATE
 20988            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20989            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20990            GO TO 7100-DISPLAY-CANCELS.
 20991
 20992     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 384
* EL6311.cbl
 20993
 20994 4850-END-RECORDS.
 20995     MOVE ER-2252                TO EMI-ERROR.
 20996     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20997
 20998     IF PI-MAP-NAME = EL631B
 20999        MOVE -1                  TO BPFENTRL
 21000     ELSE
 21001        MOVE -1                  TO CPFENTRL.
 21002
 21003     GO TO 8200-SEND-DATAONLY.
 21004
 21005 4860-NOT-FOUND.
 21006
 21007******************************************************************
 21008*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 21009******************************************************************
 21010
 21011
 21012* EXEC CICS RESETBR
 21013*         DATASET    (FILE-ID-ERPNDB)
 21014*         RIDFLD     (ERPNDB-KEY)
 21015*     END-EXEC.
 21016     MOVE 0
 21017       TO DFHEIV11
 21018*    MOVE '&4         G          &   #00017875' TO DFHEIV0
 21019     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 21020     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21021     MOVE X'2020233030303137383735' TO DFHEIV0(25:11)
 21022     CALL 'kxdfhei1' USING DFHEIV0,
 21023           FILE-ID-ERPNDB,
 21024           ERPNDB-KEY,
 21025           DFHEIV99,
 21026           DFHEIV11,
 21027           DFHEIV99
 21028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21029
 21030
 21031
 21032* EXEC CICS READNEXT
 21033*         DATASET    (FILE-ID-ERPNDB)
 21034*         SET        (ADDRESS OF PENDING-BUSINESS)
 21035*         RIDFLD     (ERPNDB-KEY)
 21036*    END-EXEC.
 21037     MOVE 0
 21038       TO DFHEIV11
 21039*    MOVE '&.S                   )   #00017880' TO DFHEIV0
 21040     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21041     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21042     MOVE X'2020233030303137383830' TO DFHEIV0(25:11)
 21043     CALL 'kxdfhei1' USING DFHEIV0,
 21044           FILE-ID-ERPNDB,
 21045           DFHEIV20,
 21046           DFHEIV99,
 21047           ERPNDB-KEY,
 21048           DFHEIV99,
 21049           DFHEIV11,
 21050           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 385
* EL6311.cbl
 21051           DFHEIV99
 21052     SET ADDRESS OF PENDING-BUSINESS TO
 21053         DFHEIV20
 21054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21055
 21056
 21057
 21058* EXEC CICS READPREV
 21059*         DATASET    (FILE-ID-ERPNDB)
 21060*         SET        (ADDRESS OF PENDING-BUSINESS)
 21061*         RIDFLD     (ERPNDB-KEY)
 21062*    END-EXEC.
 21063     MOVE 0
 21064       TO DFHEIV11
 21065*    MOVE '&0S                   )   #00017886' TO DFHEIV0
 21066     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21067     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21068     MOVE X'2020233030303137383836' TO DFHEIV0(25:11)
 21069     CALL 'kxdfhei1' USING DFHEIV0,
 21070           FILE-ID-ERPNDB,
 21071           DFHEIV20,
 21072           DFHEIV99,
 21073           ERPNDB-KEY,
 21074           DFHEIV99,
 21075           DFHEIV11,
 21076           DFHEIV99,
 21077           DFHEIV99
 21078     SET ADDRESS OF PENDING-BUSINESS TO
 21079         DFHEIV20
 21080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21081
 21082
 21083     GO TO 4810-READ-PREV-RECORD.
 21084
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 386
* EL6311.cbl
 21086
 21087******************************************************************
 21088*                                                                *
 21089*           B R O W S E   C S R   B A C K W A R D                *
 21090*                                                                *
 21091******************************************************************
 21092
 21093 4900-BROWSE-CSR-BACKWARD.
 21094
 21095     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 21096
 21097
 21098* EXEC CICS HANDLE CONDITION
 21099*         NOTFND   (4970-NOT-FOUND)
 21100*         ENDFILE  (4950-END-RECORDS)
 21101*    END-EXEC
 21102*    MOVE '"$I''                  ! Q #00017906' TO DFHEIV0
 21103     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21104     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21105     MOVE X'5120233030303137393036' TO DFHEIV0(25:11)
 21106     CALL 'kxdfhei1' USING DFHEIV0
 21107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21108
 21109
 21110* EXEC CICS STARTBR
 21111*         DATASET   (FILE-ID-ERPNDB4)
 21112*         RIDFLD    (ERPNDB-CSR-KEY)
 21113*    END-EXEC.
 21114     MOVE 0
 21115       TO DFHEIV11
 21116*    MOVE '&,         G          &   #00017911' TO DFHEIV0
 21117     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21118     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21119     MOVE X'2020233030303137393131' TO DFHEIV0(25:11)
 21120     CALL 'kxdfhei1' USING DFHEIV0,
 21121           FILE-ID-ERPNDB4,
 21122           ERPNDB-CSR-KEY,
 21123           DFHEIV99,
 21124           DFHEIV11,
 21125           DFHEIV99
 21126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21127
 21128
 21129     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 21130                                    WS-FIRST-TIME-SW.
 21131
 21132 4905-READ-PREV-RECORD.
 21133
 21134* EXEC CICS READPREV
 21135*         DATASET    (FILE-ID-ERPNDB4)
 21136*         SET        (ADDRESS OF PENDING-BUSINESS)
 21137*         RIDFLD     (ERPNDB-CSR-KEY)
 21138*    END-EXEC.
 21139     MOVE 0
 21140       TO DFHEIV11
 21141*    MOVE '&0S                   )   #00017920' TO DFHEIV0
 21142     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21143     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 387
* EL6311.cbl
 21144     MOVE X'2020233030303137393230' TO DFHEIV0(25:11)
 21145     CALL 'kxdfhei1' USING DFHEIV0,
 21146           FILE-ID-ERPNDB4,
 21147           DFHEIV20,
 21148           DFHEIV99,
 21149           ERPNDB-CSR-KEY,
 21150           DFHEIV99,
 21151           DFHEIV11,
 21152           DFHEIV99,
 21153           DFHEIV99
 21154     SET ADDRESS OF PENDING-BUSINESS TO
 21155         DFHEIV20
 21156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21157
 21158
 21159     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21160
 21161     IF WS-BATCH-PREFIX = '#CL'
 21162         GO TO 4905-READ-PREV-RECORD.
 21163
 21164     IF FIRST-TIME
 21165         MOVE SPACE               TO WS-FIRST-TIME-SW
 21166         GO TO 4905-READ-PREV-RECORD.
 21167
 21168     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 21169        PB-CSR-ID           NOT = PI-PB-CSR-ID
 21170        GO TO 4950-END-RECORDS.
 21171
 21172     IF PB-BATCH-TRAILER
 21173        GO TO 4905-READ-PREV-RECORD.
 21174
 21175     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21176
 21177     IF  WS-BATCH-PREFIX = '#CL'
 21178         GO TO 4905-READ-PREV-RECORD.
 21179
 21180     IF PI-PB-CERT-NO NOT = LOW-VALUES
 21181        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 21182           GO TO 4905-READ-PREV-RECORD
 21183        ELSE
 21184           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 21185              GO TO 4910-CHECK-REC-TYPE
 21186           ELSE
 21187              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 21188                 GO TO 4910-CHECK-REC-TYPE
 21189              ELSE
 21190                 GO TO 4905-READ-PREV-RECORD.
 21191
 21192     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 21193        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 21194           GO TO 4905-READ-PREV-RECORD.
 21195
 21196 4910-CHECK-REC-TYPE.
 21197     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21198         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21199             NEXT SENTENCE
 21200         ELSE
 21201             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 388
* EL6311.cbl
 21202
 21203     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21204         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21205             NEXT SENTENCE
 21206        ELSE
 21207             GO TO 4905-READ-PREV-RECORD.
 21208
 21209     IF NOT DISPLAY-CHANGE-RECORDS AND
 21210            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21211        GO TO 4905-READ-PREV-RECORD.
 21212
 21213     IF DISPLAY-HOLD-RECORDS AND
 21214        NOT PB-RECORD-ON-HOLD
 21215          GO TO 4905-READ-PREV-RECORD.
 21216
 21217     IF PB-ISSUE
 21218        IF DISPLAY-CHK-REQ-RECORDS
 21219           GO TO 4905-READ-PREV-RECORD.
 21220
 21221     IF PB-ISSUE
 21222        IF ISSUE-WITH-WARNING
 21223           IF PB-WARNING-ERRORS
 21224              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 21225                  GO TO 4505-READ-PREV-RECORD
 21226              ELSE
 21227                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21228                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21229                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21230                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21231                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21232                 MOVE PB-SV-STATE            TO PI-SV-STATE
 21233                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21234                 GO TO 7000-DISPLAY-ISSUES
 21235           ELSE
 21236              GO TO 4905-READ-PREV-RECORD.
 21237
 21238     IF PB-ISSUE
 21239        IF (ISSUES-IN-ERROR AND
 21240            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 21241            ALL-ISSUES
 21242            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21243            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21244            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21245            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21246            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21247            MOVE PB-SV-STATE            TO PI-SV-STATE
 21248            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21249            GO TO 7000-DISPLAY-ISSUES
 21250        ELSE
 21251            GO TO 4905-READ-PREV-RECORD.
 21252
 21253     IF PB-CANCELLATION
 21254        IF DISPLAY-CHK-REQ-RECORDS
 21255           IF PB-C-REFUND-REQUESTED
 21256              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21257              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21258              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21259              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 389
* EL6311.cbl
 21260              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21261              MOVE PB-SV-STATE            TO PI-SV-STATE
 21262              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21263              GO TO 7100-DISPLAY-CANCELS
 21264           ELSE
 21265              GO TO 4905-READ-PREV-RECORD.
 21266
 21267     IF PB-CANCELLATION
 21268        IF CANCEL-WITH-WARNING
 21269           IF PB-WARNING-ERRORS
 21270              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 21271                  GO TO 4505-READ-PREV-RECORD
 21272              ELSE
 21273                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21274                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21275                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21276                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21277                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21278                 MOVE PB-SV-STATE            TO PI-SV-STATE
 21279                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21280                 GO TO 7100-DISPLAY-CANCELS
 21281           ELSE
 21282              GO TO 4905-READ-PREV-RECORD.
 21283
 21284     IF PB-CANCELLATION
 21285        IF (CANCEL-IN-ERROR  AND
 21286            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 21287            ALL-CANCELS
 21288            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21289            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21290            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21291            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21292            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21293            MOVE PB-SV-STATE            TO PI-SV-STATE
 21294            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21295            GO TO 7100-DISPLAY-CANCELS.
 21296
 21297     GO TO 4905-READ-PREV-RECORD.
 21298
 21299 4950-END-RECORDS.
 21300     IF PI-MAP-NAME = EL631B
 21301        MOVE -1                  TO BMAINTL
 21302     ELSE
 21303        IF PI-MAP-NAME = EL631C
 21304           MOVE -1               TO CMAINTL
 21305        ELSE
 21306           MOVE -1               TO DPFENTRL.
 21307
 21308     MOVE ER-2255               TO EMI-ERROR.
 21309     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21310     GO TO 8200-SEND-DATAONLY.
 21311
 21312 4970-NOT-FOUND.
 21313
 21314******************************************************************
 21315*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 21316******************************************************************
 21317
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 390
* EL6311.cbl
 21318
 21319* EXEC CICS RESETBR
 21320*         DATASET    (FILE-ID-ERPNDB4)
 21321*         RIDFLD     (ERPNDB-CSR-KEY)
 21322*    END-EXEC.
 21323     MOVE 0
 21324       TO DFHEIV11
 21325*    MOVE '&4         G          &   #00018085' TO DFHEIV0
 21326     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 21327     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21328     MOVE X'2020233030303138303835' TO DFHEIV0(25:11)
 21329     CALL 'kxdfhei1' USING DFHEIV0,
 21330           FILE-ID-ERPNDB4,
 21331           ERPNDB-CSR-KEY,
 21332           DFHEIV99,
 21333           DFHEIV11,
 21334           DFHEIV99
 21335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21336
 21337
 21338
 21339* EXEC CICS READNEXT
 21340*         DATASET    (FILE-ID-ERPNDB4)
 21341*         SET        (ADDRESS OF PENDING-BUSINESS)
 21342*         RIDFLD     (ERPNDB-CSR-KEY)
 21343*    END-EXEC.
 21344     MOVE 0
 21345       TO DFHEIV11
 21346*    MOVE '&.S                   )   #00018090' TO DFHEIV0
 21347     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21348     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21349     MOVE X'2020233030303138303930' TO DFHEIV0(25:11)
 21350     CALL 'kxdfhei1' USING DFHEIV0,
 21351           FILE-ID-ERPNDB4,
 21352           DFHEIV20,
 21353           DFHEIV99,
 21354           ERPNDB-CSR-KEY,
 21355           DFHEIV99,
 21356           DFHEIV11,
 21357           DFHEIV99,
 21358           DFHEIV99
 21359     SET ADDRESS OF PENDING-BUSINESS TO
 21360         DFHEIV20
 21361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21362
 21363
 21364
 21365* EXEC CICS READPREV
 21366*         DATASET    (FILE-ID-ERPNDB4)
 21367*         SET        (ADDRESS OF PENDING-BUSINESS)
 21368*         RIDFLD     (ERPNDB-CSR-KEY)
 21369*    END-EXEC.
 21370     MOVE 0
 21371       TO DFHEIV11
 21372*    MOVE '&0S                   )   #00018096' TO DFHEIV0
 21373     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21374     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21375     MOVE X'2020233030303138303936' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 391
* EL6311.cbl
 21376     CALL 'kxdfhei1' USING DFHEIV0,
 21377           FILE-ID-ERPNDB4,
 21378           DFHEIV20,
 21379           DFHEIV99,
 21380           ERPNDB-CSR-KEY,
 21381           DFHEIV99,
 21382           DFHEIV11,
 21383           DFHEIV99,
 21384           DFHEIV99
 21385     SET ADDRESS OF PENDING-BUSINESS TO
 21386         DFHEIV20
 21387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21388
 21389
 21390 4980-READ-PREV-RECORD.
 21391
 21392* EXEC CICS READPREV
 21393*         DATASET    (FILE-ID-ERPNDB4)
 21394*         SET        (ADDRESS OF PENDING-BUSINESS)
 21395*         RIDFLD     (ERPNDB-CSR-KEY)
 21396*    END-EXEC.
 21397     MOVE 0
 21398       TO DFHEIV11
 21399*    MOVE '&0S                   )   #00018103' TO DFHEIV0
 21400     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21401     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21402     MOVE X'2020233030303138313033' TO DFHEIV0(25:11)
 21403     CALL 'kxdfhei1' USING DFHEIV0,
 21404           FILE-ID-ERPNDB4,
 21405           DFHEIV20,
 21406           DFHEIV99,
 21407           ERPNDB-CSR-KEY,
 21408           DFHEIV99,
 21409           DFHEIV11,
 21410           DFHEIV99,
 21411           DFHEIV99
 21412     SET ADDRESS OF PENDING-BUSINESS TO
 21413         DFHEIV20
 21414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21415
 21416
 21417     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21418
 21419     IF WS-BATCH-PREFIX = '#CL'
 21420        GO TO 4980-READ-PREV-RECORD.
 21421
 21422     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21423     GO TO 4905-READ-PREV-RECORD.
 21424
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 392
* EL6311.cbl
 21426
 21427
 21428******************************************************************
 21429*                                                                *
 21430*        B R O W S E   B A T C H   H E A D E R S                 *
 21431*                                                                *
 21432******************************************************************
 21433
 21434 5000-BROWSE-BATCH-HEADERS.
 21435
 21436     IF EIBTRNID NOT = TRANS-EXB1
 21437        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21438        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21439        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21440        GO TO 5010-READ-NEXT-RECORD.
 21441
 21442     IF EIBAID = DFHPF4
 21443        MOVE '0'                TO PI-EDIT-SW
 21444        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21445        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21446        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21447        GO TO 5010-READ-NEXT-RECORD.
 21448
 21449     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21450     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21451     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21452
 21453
 21454* EXEC CICS HANDLE CONDITION
 21455*         ENDFILE  (5050-NOT-FOUND)
 21456*    END-EXEC.
 21457*    MOVE '"$''                   ! R #00018145' TO DFHEIV0
 21458     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21459     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21460     MOVE X'5220233030303138313435' TO DFHEIV0(25:11)
 21461     CALL 'kxdfhei1' USING DFHEIV0
 21462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21463
 21464
 21465 5010-READ-NEXT-RECORD.
 21466
 21467* EXEC CICS HANDLE CONDITION
 21468*         NOTFND    (5050-NOT-FOUND)
 21469*    END-EXEC.
 21470*    MOVE '"$I                   ! S #00018150' TO DFHEIV0
 21471     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21472     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21473     MOVE X'5320233030303138313530' TO DFHEIV0(25:11)
 21474     CALL 'kxdfhei1' USING DFHEIV0
 21475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21476
 21477
 21478
 21479* EXEC CICS READ
 21480*         DATASET   (FILE-ID-ERPNDB)
 21481*         SET       (ADDRESS OF PENDING-BUSINESS)
 21482*         RIDFLD    (ERPNDB-KEY)
 21483*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 393
* EL6311.cbl
 21484*    END-EXEC.
 21485*    MOVE '&"S        G          (   #00018154' TO DFHEIV0
 21486     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21487     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21488     MOVE X'2020233030303138313534' TO DFHEIV0(25:11)
 21489     CALL 'kxdfhei1' USING DFHEIV0,
 21490           FILE-ID-ERPNDB,
 21491           DFHEIV20,
 21492           DFHEIV99,
 21493           ERPNDB-KEY,
 21494           DFHEIV99,
 21495           DFHEIV99,
 21496           DFHEIV99
 21497     SET ADDRESS OF PENDING-BUSINESS TO
 21498         DFHEIV20
 21499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21500
 21501
 21502     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21503         GO TO 5050-NOT-FOUND.
 21504
 21505     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21506
 21507     IF WS-BATCH-PREFIX = '#CL'
 21508         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21509         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21510         GO TO 5010-READ-NEXT-RECORD.
 21511
 21512     IF NOT PB-BATCH-TRAILER
 21513         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21514         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21515         GO TO 5010-READ-NEXT-RECORD.
 21516
 21517     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21518         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21519             NEXT SENTENCE
 21520         ELSE
 21521             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21522             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21523             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21524             GO TO 5010-READ-NEXT-RECORD.
 21525
 21526     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21527         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21528             NEXT SENTENCE
 21529        ELSE
 21530             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21531             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21532             GO TO 5010-READ-NEXT-RECORD.
 21533
 21534     IF EIBAID = DFHPF4
 21535        MOVE '0'                TO PI-EDIT-SW
 21536        GO TO 7200-DISPLAY-BATCHES.
 21537
 21538     IF PI-CSR-BROWSE
 21539        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21540           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21541           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 394
* EL6311.cbl
 21542           GO TO 5010-READ-NEXT-RECORD.
 21543
 21544     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21545       IF PI-PB-CARRIER    = SPACES AND
 21546          PI-PB-GROUPING   = SPACES AND
 21547          PI-PB-STATE      = SPACES AND
 21548          PI-PB-ACCOUNT    = SPACES
 21549            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21550            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21551            GO TO 7200-DISPLAY-BATCHES
 21552         ELSE
 21553           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21554              PI-PB-GROUPING   = PB-GROUPING AND
 21555              PI-PB-STATE      = PB-STATE    AND
 21556              PI-PB-ACCOUNT    = PB-ACCOUNT
 21557              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21558              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21559              GO TO 7200-DISPLAY-BATCHES.
 21560
 21561     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21562     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21563
 21564
 21565* EXEC CICS HANDLE CONDITION
 21566*         NOTFND    (5050-NOT-FOUND)
 21567*    END-EXEC.
 21568*    MOVE '"$I                   ! T #00018223' TO DFHEIV0
 21569     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21571     MOVE X'5420233030303138323233' TO DFHEIV0(25:11)
 21572     CALL 'kxdfhei1' USING DFHEIV0
 21573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21574
 21575
 21576
 21577* EXEC CICS READ
 21578*         DATASET   (FILE-ID-ERPNDB)
 21579*         SET       (ADDRESS OF PENDING-BUSINESS)
 21580*         RIDFLD    (ERPNDB-KEY)
 21581*         GTEQ
 21582*    END-EXEC.
 21583*    MOVE '&"S        G          (   #00018227' TO DFHEIV0
 21584     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21585     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21586     MOVE X'2020233030303138323237' TO DFHEIV0(25:11)
 21587     CALL 'kxdfhei1' USING DFHEIV0,
 21588           FILE-ID-ERPNDB,
 21589           DFHEIV20,
 21590           DFHEIV99,
 21591           ERPNDB-KEY,
 21592           DFHEIV99,
 21593           DFHEIV99,
 21594           DFHEIV99
 21595     SET ADDRESS OF PENDING-BUSINESS TO
 21596         DFHEIV20
 21597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21598
 21599
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 395
* EL6311.cbl
 21600     GO TO 5010-READ-NEXT-RECORD.
 21601
 21602 5050-NOT-FOUND.
 21603
 21604******************************************************************
 21605*                                                                *
 21606*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21607*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21608*         PROGRAM.                                               *
 21609*                                                                *
 21610******************************************************************
 21611
 21612     IF EIBTRNID NOT = TRANS-EXB1
 21613        IF PENDING-BUS-RECS-FOUND
 21614            NEXT SENTENCE
 21615          ELSE
 21616            MOVE '9'            TO PI-BROWSE-SW
 21617            GO TO 9400-CLEAR.
 21618
 21619     MOVE ER-2256                TO EMI-ERROR.
 21620     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21621
 21622     IF PI-MAP-NAME = SPACES
 21623        MOVE EL631D              TO PI-MAP-NAME
 21624        MOVE -1                  TO DPFENTRL
 21625        GO TO 8100-SEND-INITIAL-MAP.
 21626
 21627     IF PI-MAP-NAME = EL631B
 21628        MOVE -1                  TO BMAINTL
 21629     ELSE
 21630        IF PI-MAP-NAME = EL631C
 21631           MOVE -1               TO CMAINTL
 21632        ELSE
 21633           MOVE -1               TO DPFENTRL
 21634           GO TO 8200-SEND-DATAONLY.
 21635
 21636     GO TO 8100-SEND-INITIAL-MAP.
 21637
 21638     .
 21639 5100-PROCESS-POL-RESC.
 21640     MOVE ZEROS                  TO CG-LF-BENCD
 21641                                    CG-AH-BENCD
 21642                                    CG-LF-CAN-AMT
 21643                                    CG-AH-CAN-AMT
 21644     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21645                                    CG-AH-CAN-DT
 21646     MOVE SPACES                 TO CG-BATCH-NO
 21647     MOVE '4'                    TO CG-OPTION-CODE
 21648     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21649     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21650     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21651     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21652     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21653     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21654     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21655     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21656     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21657     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 396
* EL6311.cbl
 21658     MOVE PI-PREV-ALT-KEY (1:33)
 21659                                 TO CG-CERT-KEY
 21660     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21661     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21662                                    CG-AH-CAN-AMT
 21663     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21664                                    CG-AH-CAN-DT
 21665     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21666     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21667      display 'about to cancel ' cg-cert-key
 21668
 21669* EXEC CICS LINK
 21670*        PROGRAM  ('ELCANC')
 21671*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21672*    END-EXEC
 21673     MOVE LENGTH OF
 21674      CANCEL-GEN-PASS-AREA
 21675       TO DFHEIV11
 21676     MOVE 'ELCANC' TO DFHEIV1
 21677*    MOVE '."C                   (   #00018302' TO DFHEIV0
 21678     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21679     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21680     MOVE X'2020233030303138333032' TO DFHEIV0(25:11)
 21681     CALL 'kxdfhei1' USING DFHEIV0,
 21682           DFHEIV1,
 21683           CANCEL-GEN-PASS-AREA,
 21684           DFHEIV11,
 21685           DFHEIV99,
 21686           DFHEIV99,
 21687           DFHEIV99,
 21688           DFHEIV99
 21689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21690     IF CG-SUCCESS
 21691        CONTINUE
 21692     ELSE
 21693        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21694        MOVE '3'                 TO EMI-SWITCH1
 21695        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21696        EVALUATE TRUE
 21697           WHEN CG-DATE-ERROR
 21698             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21699           WHEN CG-CERT-NOT-FOUND
 21700             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21701           WHEN CG-AMOUNT-ERROR
 21702             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21703           WHEN CG-OPTION-ERROR
 21704             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21705           WHEN CG-PREV-CAN
 21706             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21707           WHEN CG-INVALID-DATA
 21708             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21709           WHEN CG-NO-ACCT-MSTR
 21710             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21711           WHEN CG-SFX-A-EXIST
 21712             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21713           WHEN CG-MISC-ERROR
 21714             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21715           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 397
* EL6311.cbl
 21716             MOVE ' ERROR - ELCANC - RETURN '
 21717                                 TO EMI-ERROR-TEXT (1) (12:25)
 21718        END-EVALUATE
 21719        GO TO 8200-SEND-DATAONLY
 21720     END-IF
 21721
 21722* EXEC CICS GETMAIN
 21723*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 21724*        LENGTH  (ELCRTT-RECORD-LENGTH)
 21725*        INITIMG (GETMAIN-SPACE)
 21726*    END-EXEC
 21727*    MOVE ',"IL                  $   #00018337' TO DFHEIV0
 21728     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21729     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21730     MOVE X'2020233030303138333337' TO DFHEIV0(25:11)
 21731     CALL 'kxdfhei1' USING DFHEIV0,
 21732           DFHEIV20,
 21733           ELCRTT-RECORD-LENGTH,
 21734           GETMAIN-SPACE
 21735     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 21736         DFHEIV20
 21737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21738
 21739     move ' '                    to ws-elcrtt-update-sw
 21740     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTT-PRIMARY
 21741     MOVE 'C'                    TO ELCRTT-REC-TYPE
 21742
 21743
 21744* EXEC CICS READ
 21745*        UPDATE
 21746*        DATASET  (CRTT-ID)
 21747*        RIDFLD   (ELCRTT-KEY)
 21748*        INTO     (CERTIFICATE-TRAILERS)
 21749*        resp     (ws-response)
 21750*    END-EXEC
 21751     MOVE LENGTH OF
 21752      CERTIFICATE-TRAILERS
 21753       TO DFHEIV11
 21754*    MOVE '&"IL       EU         (  N#00018347' TO DFHEIV0
 21755     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21756     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21757     MOVE X'204E233030303138333437' TO DFHEIV0(25:11)
 21758     CALL 'kxdfhei1' USING DFHEIV0,
 21759           CRTT-ID,
 21760           CERTIFICATE-TRAILERS,
 21761           DFHEIV11,
 21762           ELCRTT-KEY,
 21763           DFHEIV99,
 21764           DFHEIV99,
 21765           DFHEIV99
 21766     MOVE EIBRESP  TO ws-response
 21767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21768
 21769     if resp-normal
 21770        if cs-claim-verification-status = 'B' or 'C' or 'D' or
 21771                  'E' or 'F' or 'G'
 21772           move 'J'              to cs-claim-verification-status
 21773           set update-elcrtt to true
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 398
* EL6311.cbl
 21774        end-if
 21775        if update-elcrtt
 21776
 21777* EXEC CICS REWRITE
 21778*             DATASET    (crtt-ID)
 21779*             FROM       (CERTIFICATE-TRAILERS)
 21780*          END-EXEC
 21781     MOVE LENGTH OF
 21782      CERTIFICATE-TRAILERS
 21783       TO DFHEIV11
 21784*    MOVE '&& L                  %   #00018362' TO DFHEIV0
 21785     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21786     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21787     MOVE X'2020233030303138333632' TO DFHEIV0(25:11)
 21788     CALL 'kxdfhei1' USING DFHEIV0,
 21789           crtt-ID,
 21790           CERTIFICATE-TRAILERS,
 21791           DFHEIV11,
 21792           DFHEIV99
 21793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21794        else
 21795
 21796* exec cics unlock
 21797*             dataset    (crtt-ID)
 21798*          end-exec
 21799*    MOVE '&*                    #   #00018367' TO DFHEIV0
 21800     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21801     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21802     MOVE X'2020233030303138333637' TO DFHEIV0(25:11)
 21803     CALL 'kxdfhei1' USING DFHEIV0,
 21804           crtt-ID,
 21805           DFHEIV99
 21806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21807        end-if
 21808     end-if
 21809     .
 21810 5100-EXIT.
 21811     EXIT.
 21812
 21813******************************************************************
 21814*                                                                *
 21815*        B R O W S E   B A T C H   B A C K W A R D S             *
 21816*                                                                *
 21817******************************************************************
 21818
 21819 5500-BROWSE-BATCH-BACKWARD.
 21820
 21821* EXEC CICS HANDLE CONDITION
 21822*         NOTFND   (5550-END-RECORDS)
 21823*         ENDFILE  (5550-END-RECORDS)
 21824*    END-EXEC.
 21825*    MOVE '"$I''                  ! U #00018383' TO DFHEIV0
 21826     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21828     MOVE X'5520233030303138333833' TO DFHEIV0(25:11)
 21829     CALL 'kxdfhei1' USING DFHEIV0
 21830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21831
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 399
* EL6311.cbl
 21832
 21833 5505-START-BROWSE.
 21834     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21835     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21836     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21837
 21838
 21839* EXEC CICS STARTBR
 21840*         DATASET   (FILE-ID-ERPNDB)
 21841*         RIDFLD    (ERPNDB-ALT-KEY)
 21842*    END-EXEC.
 21843     MOVE 0
 21844       TO DFHEIV11
 21845*    MOVE '&,         G          &   #00018393' TO DFHEIV0
 21846     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21847     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21848     MOVE X'2020233030303138333933' TO DFHEIV0(25:11)
 21849     CALL 'kxdfhei1' USING DFHEIV0,
 21850           FILE-ID-ERPNDB,
 21851           ERPNDB-ALT-KEY,
 21852           DFHEIV99,
 21853           DFHEIV11,
 21854           DFHEIV99
 21855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21856
 21857
 21858     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21859
 21860
 21861* EXEC CICS READNEXT
 21862*         DATASET    (FILE-ID-ERPNDB)
 21863*         SET        (ADDRESS OF PENDING-BUSINESS)
 21864*         RIDFLD     (ERPNDB-KEY)
 21865*    END-EXEC.
 21866     MOVE 0
 21867       TO DFHEIV11
 21868*    MOVE '&.S                   )   #00018400' TO DFHEIV0
 21869     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21870     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21871     MOVE X'2020233030303138343030' TO DFHEIV0(25:11)
 21872     CALL 'kxdfhei1' USING DFHEIV0,
 21873           FILE-ID-ERPNDB,
 21874           DFHEIV20,
 21875           DFHEIV99,
 21876           ERPNDB-KEY,
 21877           DFHEIV99,
 21878           DFHEIV11,
 21879           DFHEIV99,
 21880           DFHEIV99
 21881     SET ADDRESS OF PENDING-BUSINESS TO
 21882         DFHEIV20
 21883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21884
 21885
 21886
 21887* EXEC CICS READPREV
 21888*         DATASET    (FILE-ID-ERPNDB)
 21889*         SET        (ADDRESS OF PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 400
* EL6311.cbl
 21890*         RIDFLD     (ERPNDB-KEY)
 21891*    END-EXEC.
 21892     MOVE 0
 21893       TO DFHEIV11
 21894*    MOVE '&0S                   )   #00018406' TO DFHEIV0
 21895     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21896     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21897     MOVE X'2020233030303138343036' TO DFHEIV0(25:11)
 21898     CALL 'kxdfhei1' USING DFHEIV0,
 21899           FILE-ID-ERPNDB,
 21900           DFHEIV20,
 21901           DFHEIV99,
 21902           ERPNDB-KEY,
 21903           DFHEIV99,
 21904           DFHEIV11,
 21905           DFHEIV99,
 21906           DFHEIV99
 21907     SET ADDRESS OF PENDING-BUSINESS TO
 21908         DFHEIV20
 21909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21910
 21911
 21912
 21913* EXEC CICS READPREV
 21914*         DATASET    (FILE-ID-ERPNDB)
 21915*         SET        (ADDRESS OF PENDING-BUSINESS)
 21916*         RIDFLD     (ERPNDB-KEY)
 21917*    END-EXEC.
 21918     MOVE 0
 21919       TO DFHEIV11
 21920*    MOVE '&0S                   )   #00018412' TO DFHEIV0
 21921     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21922     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21923     MOVE X'2020233030303138343132' TO DFHEIV0(25:11)
 21924     CALL 'kxdfhei1' USING DFHEIV0,
 21925           FILE-ID-ERPNDB,
 21926           DFHEIV20,
 21927           DFHEIV99,
 21928           ERPNDB-KEY,
 21929           DFHEIV99,
 21930           DFHEIV11,
 21931           DFHEIV99,
 21932           DFHEIV99
 21933     SET ADDRESS OF PENDING-BUSINESS TO
 21934         DFHEIV20
 21935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21936
 21937
 21938     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21939        GO TO 5550-END-RECORDS.
 21940
 21941     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21942
 21943     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21944
 21945     IF  WS-BATCH-PREFIX = '#CL'
 21946             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21947
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 401
* EL6311.cbl
 21948* EXEC CICS ENDBR
 21949*                 DATASET  (FILE-ID-ERPNDB)
 21950*            END-EXEC
 21951     MOVE 0
 21952       TO DFHEIV11
 21953*    MOVE '&2                    $   #00018427' TO DFHEIV0
 21954     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21955     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21956     MOVE X'2020233030303138343237' TO DFHEIV0(25:11)
 21957     CALL 'kxdfhei1' USING DFHEIV0,
 21958           FILE-ID-ERPNDB,
 21959           DFHEIV11,
 21960           DFHEIV99
 21961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21962         GO TO 5505-START-BROWSE.
 21963
 21964     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21965         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21966             NEXT SENTENCE
 21967         ELSE
 21968             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21969
 21970* EXEC CICS ENDBR
 21971*                 DATASET  (FILE-ID-ERPNDB)
 21972*            END-EXEC
 21973     MOVE 0
 21974       TO DFHEIV11
 21975*    MOVE '&2                    $   #00018437' TO DFHEIV0
 21976     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21977     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21978     MOVE X'2020233030303138343337' TO DFHEIV0(25:11)
 21979     CALL 'kxdfhei1' USING DFHEIV0,
 21980           FILE-ID-ERPNDB,
 21981           DFHEIV11,
 21982           DFHEIV99
 21983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21984             GO TO 5505-START-BROWSE.
 21985
 21986
 21987     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21988         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21989             NEXT SENTENCE
 21990        ELSE
 21991             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21992
 21993* EXEC CICS ENDBR
 21994*                 DATASET  (FILE-ID-ERPNDB)
 21995*            END-EXEC
 21996     MOVE 0
 21997       TO DFHEIV11
 21998*    MOVE '&2                    $   #00018448' TO DFHEIV0
 21999     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22000     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22001     MOVE X'2020233030303138343438' TO DFHEIV0(25:11)
 22002     CALL 'kxdfhei1' USING DFHEIV0,
 22003           FILE-ID-ERPNDB,
 22004           DFHEIV11,
 22005           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 402
* EL6311.cbl
 22006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22007             GO TO 5505-START-BROWSE.
 22008
 22009     IF NOT PB-BATCH-TRAILER
 22010        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 22011
 22012* EXEC CICS ENDBR
 22013*            DATASET  (FILE-ID-ERPNDB)
 22014*       END-EXEC
 22015     MOVE 0
 22016       TO DFHEIV11
 22017*    MOVE '&2                    $   #00018455' TO DFHEIV0
 22018     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22019     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22020     MOVE X'2020233030303138343535' TO DFHEIV0(25:11)
 22021     CALL 'kxdfhei1' USING DFHEIV0,
 22022           FILE-ID-ERPNDB,
 22023           DFHEIV11,
 22024           DFHEIV99
 22025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22026        GO TO 5505-START-BROWSE.
 22027
 22028     IF PI-CSR-BROWSE
 22029        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 22030           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 22031
 22032* EXEC CICS ENDBR
 22033*               DATASET  (FILE-ID-ERPNDB)
 22034*          END-EXEC
 22035     MOVE 0
 22036       TO DFHEIV11
 22037*    MOVE '&2                    $   #00018463' TO DFHEIV0
 22038     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22039     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22040     MOVE X'2020233030303138343633' TO DFHEIV0(25:11)
 22041     CALL 'kxdfhei1' USING DFHEIV0,
 22042           FILE-ID-ERPNDB,
 22043           DFHEIV11,
 22044           DFHEIV99
 22045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22046           GO TO 5505-START-BROWSE.
 22047
 22048     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 22049        IF PI-PB-CARRIER    = SPACES AND
 22050           PI-PB-GROUPING   = SPACES AND
 22051           PI-PB-STATE      = SPACES AND
 22052           PI-PB-ACCOUNT    = SPACES
 22053             GO TO 7200-DISPLAY-BATCHES
 22054          ELSE
 22055            IF PI-PB-CARRIER    = PB-CARRIER  AND
 22056               PI-PB-GROUPING   = PB-GROUPING AND
 22057               PI-PB-STATE      = PB-STATE    AND
 22058               PI-PB-ACCOUNT    = PB-ACCOUNT
 22059                 GO TO 7200-DISPLAY-BATCHES.
 22060
 22061     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 22062
 22063
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 403
* EL6311.cbl
 22064* EXEC CICS ENDBR
 22065*         DATASET  (FILE-ID-ERPNDB)
 22066*    END-EXEC.
 22067     MOVE 0
 22068       TO DFHEIV11
 22069*    MOVE '&2                    $   #00018483' TO DFHEIV0
 22070     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22071     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22072     MOVE X'2020233030303138343833' TO DFHEIV0(25:11)
 22073     CALL 'kxdfhei1' USING DFHEIV0,
 22074           FILE-ID-ERPNDB,
 22075           DFHEIV11,
 22076           DFHEIV99
 22077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22078
 22079
 22080     GO TO 5505-START-BROWSE.
 22081
 22082 5550-END-RECORDS.
 22083     MOVE ER-2257                TO EMI-ERROR.
 22084     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22085     MOVE -1                     TO DPFENTRL.
 22086
 22087     GO TO 8200-SEND-DATAONLY.
 22088
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 404
* EL6311.cbl
 22090
 22091******************************************************************
 22092*                                                                *
 22093*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 22094*                                                                *
 22095******************************************************************
 22096
 22097 6000-CREATE-TEMP-STORAGE.
 22098
 22099
 22100* EXEC CICS HANDLE CONDITION
 22101*        QIDERR  (6050-QID-ERROR)
 22102*    END-EXEC.
 22103*    MOVE '"$N                   ! V #00018506' TO DFHEIV0
 22104     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 22105     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22106     MOVE X'5620233030303138353036' TO DFHEIV0(25:11)
 22107     CALL 'kxdfhei1' USING DFHEIV0
 22108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22109
 22110
 22111
 22112* EXEC CICS WRITEQ TS
 22113*        QUEUE    (QID)
 22114*        FROM     (PROGRAM-INTERFACE-BLOCK)
 22115*        LENGTH   (WS-COMM-LENGTH)
 22116*        ITEM     (W-ONE)
 22117*    END-EXEC.
 22118*    MOVE '*" I   L              ''   #00018510' TO DFHEIV0
 22119     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 22120     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22121     MOVE X'2020233030303138353130' TO DFHEIV0(25:11)
 22122     CALL 'kxdfhei1' USING DFHEIV0,
 22123           QID,
 22124           PROGRAM-INTERFACE-BLOCK,
 22125           WS-COMM-LENGTH,
 22126           W-ONE,
 22127           DFHEIV99,
 22128           DFHEIV99
 22129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22130
 22131
 22132 6000-EXIT.
 22133      EXIT.
 22134
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 405
* EL6311.cbl
 22136
 22137******************************************************************
 22138*                                                                *
 22139*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 22140*                                                                *
 22141******************************************************************
 22142
 22143 6050-RECOVER-TEMP-STORAGE.
 22144     IF PGM-NAME = XCTL-EL6312
 22145        GO TO 6050-EXIT.
 22146
 22147     IF PGM-NAME = XCTL-EL6313
 22148        GO TO 6050-EXIT.
 22149
 22150     IF PGM-NAME = XCTL-EL6315
 22151         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 22152     END-IF
 22153
 22154     IF PGM-NAME = XCTL-EL6316
 22155         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 22156     END-IF
 22157
 22158
 22159* EXEC CICS HANDLE CONDITION
 22160*        QIDERR  (6050-QID-ERROR)
 22161*    END-EXEC.
 22162*    MOVE '"$N                   ! W #00018543' TO DFHEIV0
 22163     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 22164     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22165     MOVE X'5720233030303138353433' TO DFHEIV0(25:11)
 22166     CALL 'kxdfhei1' USING DFHEIV0
 22167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22168
 22169
 22170
 22171* EXEC CICS READQ TS
 22172*         QUEUE   (QID)
 22173*         INTO    (PROGRAM-INTERFACE-BLOCK)
 22174*         LENGTH  (WS-COMM-LENGTH)
 22175*         ITEM    (W-ONE)
 22176*     END-EXEC.
 22177*    MOVE '*$II   L              ''   #00018547' TO DFHEIV0
 22178     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 22179     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22180     MOVE X'2020233030303138353437' TO DFHEIV0(25:11)
 22181     CALL 'kxdfhei1' USING DFHEIV0,
 22182           QID,
 22183           PROGRAM-INTERFACE-BLOCK,
 22184           WS-COMM-LENGTH,
 22185           W-ONE,
 22186           DFHEIV99,
 22187           DFHEIV99
 22188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22189
 22190
 22191 6050-DELETE-TEMP-STORAGE.
 22192
 22193
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 406
* EL6311.cbl
 22194* EXEC CICS DELETEQ TS
 22195*        QUEUE   (QID)
 22196*    END-EXEC.
 22197*    MOVE '*&                    #   #00018556' TO DFHEIV0
 22198     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 22199     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22200     MOVE X'2020233030303138353536' TO DFHEIV0(25:11)
 22201     CALL 'kxdfhei1' USING DFHEIV0,
 22202           QID,
 22203           DFHEIV99
 22204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22205
 22206
 22207     GO TO 6050-EXIT.
 22208
 22209 6050-QID-ERROR.
 22210     MOVE ER-0033                TO EMI-ERROR
 22211     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22212
 22213 6050-EXIT.
 22214      EXIT.
 22215
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 407
* EL6311.cbl
 22217
 22218******************************************************************
 22219*                                                                *
 22220*            T E R M   C O N V E R S I O N                       *
 22221*                                                                *
 22222******************************************************************
 22223
 22224 6100-TERM-CONVERSION.
 22225
 22226     IF PI-BPMTS = ZERO
 22227         GO TO 6199-EXIT.
 22228
 22229     IF PI-BMODE = ' ' OR 'M'
 22230         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 22231         GO TO 6105-ROUND-TERM.
 22232
 22233     IF PI-BMODE = 'S'
 22234         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 22235         GO TO 6105-ROUND-TERM.
 22236
 22237     IF PI-BMODE = 'W'
 22238         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 22239         GO TO 6105-ROUND-TERM.
 22240
 22241     IF PI-BMODE = 'B'
 22242         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 22243         GO TO 6105-ROUND-TERM.
 22244
 22245     IF PI-BMODE = 'T'
 22246         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 22247
 22248 6105-ROUND-TERM.
 22249
 22250     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 22251         ADD +1                  TO WS-CALC-TERM-WHOLE
 22252         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 22253
 22254     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 22255         GO TO 6125-COMPUTE-TERM-BENEFIT.
 22256
 22257     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 22258         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 22259                                      WS-BTERM    (WS-SUB1)
 22260         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 22261
 22262     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 22263         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 22264             MOVE -1               TO BMODEL
 22265             MOVE ER-2593          TO EMI-ERROR
 22266             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 22267             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22268
 22269 6124-CHECK-BENEFIT.
 22270
 22271     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 22272        GO TO 6126-COMPUTE-BENEFIT.
 22273
 22274     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 408
* EL6311.cbl
 22275
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 409
* EL6311.cbl
 22277******************************************************************
 22278**         COMPUTE TERM AND BENEFIT
 22279******************************************************************
 22280 6125-COMPUTE-TERM-BENEFIT.
 22281
 22282     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 22283        PI-BPMTAMT = ZERO
 22284         GO TO 6199-EXIT.
 22285
 22286     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 22287                                     WS-BTERM  (WS-SUB1).
 22288     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 22289
 22290 6126-COMPUTE-BENEFIT.
 22291
 22292     IF PI-BMODE = 'M' OR  ' '
 22293         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 22294
 22295     IF PI-BMODE = 'W'
 22296         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 22297
 22298     IF PI-BMODE = 'S'
 22299         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 22300
 22301     IF PI-BMODE = 'B'
 22302         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 22303
 22304     IF PI-BMODE = 'T'
 22305         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 22306
 22307     IF WS-SUB1 = +1
 22308        COMPUTE WS-BBEN (WS-SUB1) =
 22309                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 22310
 22311     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 22312     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 22313     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 22314
 22315 6199-EXIT.
 22316     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 410
* EL6311.cbl
 22318
 22319******************************************************************
 22320*                                                                *
 22321*             D I S P L A Y   I S S U E S                        *
 22322*                                                                *
 22323******************************************************************
 22324
 22325 6200-CREATE-VADS.
 22326     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 22327     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 22328     MOVE SPACES                 TO WS-PASS-VADS-REC
 22329
 22330* EXEC CICS GETMAIN
 22331*       SET      (ADDRESS OF PENDING-BUSINESS)
 22332*       LENGTH   (ERPNDB-RECORD-LENGTH)
 22333*       INITIMG  (GETMAIN-SPACE)
 22334*       RESP     (WS-RESPONSE)
 22335*    END-EXEC
 22336*    MOVE ',"IL                  $  N#00018682' TO DFHEIV0
 22337     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22338     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22339     MOVE X'204E233030303138363832' TO DFHEIV0(25:11)
 22340     CALL 'kxdfhei1' USING DFHEIV0,
 22341           DFHEIV20,
 22342           ERPNDB-RECORD-LENGTH,
 22343           GETMAIN-SPACE
 22344     SET ADDRESS OF PENDING-BUSINESS TO
 22345         DFHEIV20
 22346     MOVE EIBRESP  TO WS-RESPONSE
 22347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22348
 22349* EXEC CICS READ
 22350*       INTO    (PENDING-BUSINESS)
 22351*       DATASET (FILE-ID-ERPNDB)
 22352*       RIDFLD  (ERPNDB-KEY)
 22353*       RESP    (WS-RESPONSE)
 22354*    END-EXEC
 22355     MOVE LENGTH OF
 22356      PENDING-BUSINESS
 22357       TO DFHEIV11
 22358*    MOVE '&"IL       E          (  N#00018688' TO DFHEIV0
 22359     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22360     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22361     MOVE X'204E233030303138363838' TO DFHEIV0(25:11)
 22362     CALL 'kxdfhei1' USING DFHEIV0,
 22363           FILE-ID-ERPNDB,
 22364           PENDING-BUSINESS,
 22365           DFHEIV11,
 22366           ERPNDB-KEY,
 22367           DFHEIV99,
 22368           DFHEIV99,
 22369           DFHEIV99
 22370     MOVE EIBRESP  TO WS-RESPONSE
 22371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22372     IF RESP-NORMAL
 22373        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22374        IF (RESP-NORMAL)
 22375           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 411
* EL6311.cbl
 22376              AM-CONTROL-PRIMARY (1:20))
 22377           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 22378        ELSE
 22379           MOVE 'ACCOUNT NOT FOUND'
 22380                                 TO VD-ACCOUNT-NAME
 22381        END-IF
 22382        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 22383                                    TO M1
 22384        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 22385        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 22386           (A2 > M1)
 22387           OR (WS-WORK-FIELD (A2:1) = '*')
 22388           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 22389           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 22390        END-PERFORM
 22391        IF A2 > M1
 22392           CONTINUE
 22393        ELSE
 22394           MOVE WS-WORK-FIELD (1:A2 - 1)
 22395                                    TO VD-ACCOUNT-NAME
 22396        END-IF
 22397        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 22398        MOVE PB-CARRIER          TO VD-CARRIER
 22399        MOVE PB-GROUPING         TO VD-GROUPING
 22400        MOVE PB-STATE            TO VD-STATE
 22401        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 22402        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 22403        MOVE PB-CERT-NO          TO VD-CERT-NO
 22404        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 22405        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 22406        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 22407        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 22408        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 22409        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 22410        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 22411        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 22412        MOVE PB-CSR-ID           TO VD-CSR-ID
 22413        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 22414        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 22415        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 22416        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 22417        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 22418        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 22419        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 22420        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 22421        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 22422        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 22423        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 22424        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 22425        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 22426     END-IF
 22427     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 22428
 22429
 22430* EXEC CICS GETMAIN
 22431*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 22432*       LENGTH   (ERPNDM-RECORD-LENGTH)
 22433*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 412
* EL6311.cbl
 22434*       RESP     (WS-RESPONSE)
 22435*    END-EXEC
 22436*    MOVE ',"IL                  $  N#00018751' TO DFHEIV0
 22437     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22438     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22439     MOVE X'204E233030303138373531' TO DFHEIV0(25:11)
 22440     CALL 'kxdfhei1' USING DFHEIV0,
 22441           DFHEIV20,
 22442           ERPNDM-RECORD-LENGTH,
 22443           GETMAIN-SPACE
 22444     SET ADDRESS OF PENDING-MAILING-DATA TO
 22445         DFHEIV20
 22446     MOVE EIBRESP  TO WS-RESPONSE
 22447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22448
 22449
 22450* EXEC CICS READ
 22451*       INTO    (PENDING-MAILING-DATA)
 22452*       DATASET (FILE-ID-ERPNDM)
 22453*       RIDFLD  (ERPNDM-KEY)
 22454*       RESP    (WS-RESPONSE)
 22455*    END-EXEC
 22456     MOVE LENGTH OF
 22457      PENDING-MAILING-DATA
 22458       TO DFHEIV11
 22459*    MOVE '&"IL       E          (  N#00018758' TO DFHEIV0
 22460     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22461     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22462     MOVE X'204E233030303138373538' TO DFHEIV0(25:11)
 22463     CALL 'kxdfhei1' USING DFHEIV0,
 22464           FILE-ID-ERPNDM,
 22465           PENDING-MAILING-DATA,
 22466           DFHEIV11,
 22467           ERPNDM-KEY,
 22468           DFHEIV99,
 22469           DFHEIV99,
 22470           DFHEIV99
 22471     MOVE EIBRESP  TO WS-RESPONSE
 22472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22473
 22474     IF RESP-NORMAL
 22475        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22476        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22477        MOVE PM-CITY              TO VD-INSURED-CITY
 22478        MOVE PM-STATE             TO VD-INSURED-STATE
 22479        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22480     END-IF
 22481
 22482     MOVE 'VAC1'                  TO VD-LETTER-ID
 22483     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22484     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22485     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22486     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22487     MOVE +0                      TO VD-ARCHIVE-NO
 22488     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22489     .
 22490 6200-EXIT.
 22491     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 413
* EL6311.cbl
 22492 6210-READ-ERACCT.
 22493     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22494     MOVE LOW-VALUES             TO ERACCT-FILL
 22495
 22496* EXEC CICS READ
 22497*         DATASET   ('ERACCT')
 22498*         INTO      (ACCOUNT-MASTER)
 22499*         RIDFLD    (ERACCT-KEY)
 22500*         GTEQ
 22501*         RESP      (WS-RESPONSE)
 22502*    END-EXEC
 22503     MOVE LENGTH OF
 22504      ACCOUNT-MASTER
 22505       TO DFHEIV11
 22506     MOVE 'ERACCT' TO DFHEIV1
 22507*    MOVE '&"IL       G          (  N#00018786' TO DFHEIV0
 22508     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22509     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22510     MOVE X'204E233030303138373836' TO DFHEIV0(25:11)
 22511     CALL 'kxdfhei1' USING DFHEIV0,
 22512           DFHEIV1,
 22513           ACCOUNT-MASTER,
 22514           DFHEIV11,
 22515           ERACCT-KEY,
 22516           DFHEIV99,
 22517           DFHEIV99,
 22518           DFHEIV99
 22519     MOVE EIBRESP  TO WS-RESPONSE
 22520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22521     .
 22522 6210-EXIT.
 22523     EXIT.
 22524
 22525 6220-READ-ERMAIL.
 22526
 22527     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22528     MOVE ' '                    TO WS-ERMAIL-SW
 22529
 22530
 22531* EXEC CICS READ
 22532*       DATASET   (FILE-ID-ERMAIL)
 22533*       SET       (ADDRESS OF MAILING-DATA)
 22534*       RIDFLD    (ERMAIL-KEY)
 22535*       RESP      (WS-RESPONSE)
 22536*    END-EXEC
 22537*    MOVE '&"S        E          (  N#00018802' TO DFHEIV0
 22538     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22539     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22540     MOVE X'204E233030303138383032' TO DFHEIV0(25:11)
 22541     CALL 'kxdfhei1' USING DFHEIV0,
 22542           FILE-ID-ERMAIL,
 22543           DFHEIV20,
 22544           DFHEIV99,
 22545           ERMAIL-KEY,
 22546           DFHEIV99,
 22547           DFHEIV99,
 22548           DFHEIV99
 22549     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 414
* EL6311.cbl
 22550         DFHEIV20
 22551     MOVE EIBRESP  TO WS-RESPONSE
 22552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22553
 22554     IF RESP-NORMAL
 22555        SET ERMAIL-FOUND TO TRUE
 22556     END-IF
 22557     .
 22558 6220-EXIT.
 22559     EXIT.
 22560
 22561 6400-CHECK-FOR-RES-REF-CLAIM.
 22562     display 'made it to 6400- for ' pi-cert-no
 22563     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22564
 22565     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22566                                    W-CL-COMP-CD.
 22567     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22568                                    W-CL-CERT-NO.
 22569     MOVE SPACES                 TO MSTR-CERT-SFX.
 22570
 22571
 22572* EXEC CICS HANDLE CONDITION
 22573*        NOTFND  (6400-CONTINUE)
 22574*        ENDFILE (6400-CONTINUE)
 22575*    END-EXEC.
 22576*    MOVE '"$I''                  ! X #00018826' TO DFHEIV0
 22577     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22579     MOVE X'5820233030303138383236' TO DFHEIV0(25:11)
 22580     CALL 'kxdfhei1' USING DFHEIV0
 22581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22582
 22583
 22584
 22585* EXEC CICS IGNORE CONDITION
 22586*        DUPKEY
 22587*    END-EXEC.
 22588*    MOVE '"*$                   !   #00018831' TO DFHEIV0
 22589     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22590     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22591     MOVE X'2020233030303138383331' TO DFHEIV0(25:11)
 22592     CALL 'kxdfhei1' USING DFHEIV0
 22593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22594
 22595
 22596
 22597* EXEC CICS STARTBR
 22598*        DATASET   (CLMS-ID)
 22599*        RIDFLD    (ELMSTR-KEY)
 22600*        GENERIC   EQUAL
 22601*        KEYLENGTH (ELMSTR-LENGTH)
 22602*    END-EXEC.
 22603     MOVE 0
 22604       TO DFHEIV11
 22605*    MOVE '&,   KG    E          &   #00018835' TO DFHEIV0
 22606     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22607     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 415
* EL6311.cbl
 22608     MOVE X'2020233030303138383335' TO DFHEIV0(25:11)
 22609     CALL 'kxdfhei1' USING DFHEIV0,
 22610           CLMS-ID,
 22611           ELMSTR-KEY,
 22612           ELMSTR-LENGTH,
 22613           DFHEIV11,
 22614           DFHEIV99
 22615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22616
 22617
 22618     display 'browse started'
 22619     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22620
 22621 6400-NEXT-CLAIM.
 22622
 22623
 22624* EXEC CICS READNEXT
 22625*        DATASET   (CLMS-ID)
 22626*        RIDFLD    (ELMSTR-KEY)
 22627*        SET       (ADDRESS OF CLAIM-MASTER)
 22628*    END-EXEC.
 22629     MOVE 0
 22630       TO DFHEIV11
 22631*    MOVE '&.S                   )   #00018847' TO DFHEIV0
 22632     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22633     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22634     MOVE X'2020233030303138383437' TO DFHEIV0(25:11)
 22635     CALL 'kxdfhei1' USING DFHEIV0,
 22636           CLMS-ID,
 22637           DFHEIV20,
 22638           DFHEIV99,
 22639           ELMSTR-KEY,
 22640           DFHEIV99,
 22641           DFHEIV11,
 22642           DFHEIV99,
 22643           DFHEIV99
 22644     SET ADDRESS OF CLAIM-MASTER TO
 22645         DFHEIV20
 22646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22647
 22648
 22649     display 'read claim for ' mstr-cert-no
 22650     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22651        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22652         GO TO 6400-CONTINUE
 22653     END-IF.
 22654
 22655     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22656        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22657        PI-STATE       NOT = CL-CERT-STATE     OR
 22658        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22659        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22660         GO TO 6400-NEXT-CLAIM
 22661     END-IF.
 22662
 22663     display 'found claim ' cl-claim-no
 22664        ' with denial type ' cl-denial-type
 22665     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 416
* EL6311.cbl
 22666         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22667         GO TO 6400-CONTINUE
 22668     END-IF.
 22669
 22670     GO TO 6400-NEXT-CLAIM.
 22671
 22672 6400-CONTINUE.
 22673
 22674     IF WS-BROWSE-STARTED-SW = 'Y'
 22675
 22676* EXEC CICS ENDBR
 22677*            DATASET   (CLMS-ID)
 22678*        END-EXEC
 22679     MOVE 0
 22680       TO DFHEIV11
 22681*    MOVE '&2                    $   #00018879' TO DFHEIV0
 22682     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22683     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22684     MOVE X'2020233030303138383739' TO DFHEIV0(25:11)
 22685     CALL 'kxdfhei1' USING DFHEIV0,
 22686           CLMS-ID,
 22687           DFHEIV11,
 22688           DFHEIV99
 22689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22690         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22691     END-IF.
 22692
 22693 6400-EXIT.
 22694     EXIT.
 22695
 22696 7000-DISPLAY-ISSUES.
 22697
 22698     IF PI-DISPLAY-ORIGINAL-BATCH
 22699        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22700        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22701     ELSE
 22702        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22703
 22704     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22705
 22706     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22707     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22708
 22709     MOVE LOW-VALUES                 TO EL631BI.
 22710     MOVE ZEROS                      TO PI-BPMTAMT
 22711                                        PI-BPMTS.
 22712     MOVE SPACE                      TO PI-BMODE
 22713                                        PI-BTYPE (1)
 22714                                        PI-BTYPE (2).
 22715     MOVE EL631B                     TO PI-MAP-NAME.
 22716     MOVE 'Y'                        TO PI-BROWSE-SW.
 22717     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22718                                        PI-HIGH-SEQ-NO.
 22719
 22720     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22721        MOVE AL-SABOF                TO BCHGTA
 22722        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22723        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 417
* EL6311.cbl
 22724     ELSE
 22725        MOVE AL-SADOF                TO BCHGTA
 22726                                        BCHGA
 22727        MOVE PB-CHG-COUNT            TO BCHGO.
 22728
 22729     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22730     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22731     MOVE WS-HR-MINS                 TO BMANTATO.
 22732
 22733     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22734        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22735        MOVE SPACE                   TO DC-OPTION-CODE
 22736        PERFORM 9700-DATE-LINK
 22737        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22738        MOVE 'INACTIVE'              TO BMOENDTO
 22739     ELSE
 22740        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22741        MOVE SPACE                   TO DC-OPTION-CODE
 22742        PERFORM 9700-DATE-LINK
 22743        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22744        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22745        MOVE SPACE                   TO DC-OPTION-CODE
 22746        PERFORM 9700-DATE-LINK
 22747        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22748
 22749*    MOVE PB-I-REFERENCE             TO BREFO.
 22750
 22751*    IF PI-COMPANY-ID EQUAL 'HER'
 22752*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22753*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22754*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22755*                MOVE WS-MEMBER-NO-1-8
 22756*                                TO  BMICRNOO.
 22757
 22758*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22759*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22760*            MOVE PB-I-MICROFILM-NO
 22761*                                TO  BMICRNOO.
 22762     IF PB-I-VIN NOT = SPACES
 22763        MOVE PB-I-VIN            TO BVINO
 22764     END-IF
 22765     MOVE PB-I-LETTER-REQD           TO LETRREQO
 22766
 22767
 22768     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22769     MOVE PB-CERT-SFX                TO BSUFIXO.
 22770     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22771     MOVE SPACE                      TO DC-OPTION-CODE.
 22772     PERFORM 9700-DATE-LINK.
 22773     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22774
 22775     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22776     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22777     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22778     MOVE PB-I-INSURED-SEX           TO BSEXO
 22779
 22780     IF PB-I-AGE NOT = ZEROS
 22781         MOVE PB-I-AGE               TO BAGEO.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 418
* EL6311.cbl
 22782
 22783     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22784                                 TO ELCERT-KEY
 22785     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22786     IF NOT CERT-TRL-REC-NOT-FOUND
 22787         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22788             MOVE 'AGE*'             TO BAGEDEFO
 22789         ELSE
 22790             MOVE 'AGE '             TO BAGEDEFO
 22791         END-IF
 22792     ELSE
 22793         MOVE 'AGE '             TO BAGEDEFO
 22794     END-IF
 22795
 22796     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22797         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22798         MOVE SPACE                  TO DC-OPTION-CODE
 22799         PERFORM 9700-DATE-LINK
 22800         IF NO-CONVERSION-ERROR
 22801            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22802
 22803     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22804         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22805         MOVE SPACE                  TO DC-OPTION-CODE
 22806         PERFORM 9700-DATE-LINK
 22807         IF NO-CONVERSION-ERROR
 22808            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22809
 22810     IF PB-I-EXTENTION-DAYS NUMERIC
 22811        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22812           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22813        ELSE
 22814           IF PB-I-TERM-IN-DAYS NUMERIC
 22815              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22816                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22817
 22818     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22819        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22820
 22821     MOVE PB-FORCE-CODE              TO BFORCEO.
 22822     MOVE PB-I-TERM-TYPE             TO BMODEO
 22823                                        PI-BMODE.
 22824
 22825     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22826        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22827
 22828     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22829         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22830                                        PI-BPMTS.
 22831
 22832     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22833         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22834           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22835                                        PI-BPMTAMT.
 22836
 22837     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22838     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22839     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 419
* EL6311.cbl
 22840     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22841     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
 22842     MOVE PB-I-SIG-SW                TO BSIGO.
 22843     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22844     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22845     MOVE PB-RECORD-BILL             TO BBILCDO.
 22846     MOVE PB-FORCE-CODE              TO BFORCEO.
 22847
 22848     IF (PB-I-LIVES NUMERIC)
 22849        AND (PB-I-LIVES > ZEROS)
 22850        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22851        IF (RESP-NORMAL)
 22852           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22853           CONTINUE
 22854        ELSE
 22855           MOVE PB-I-LIVES       TO BLIVESO
 22856        END-IF
 22857     END-IF
 22858
 22859     IF PB-I-NUM-BILLED NUMERIC AND
 22860        PB-I-NUM-BILLED GREATER THAN ZEROS
 22861        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22862*    ELSE
 22863*       MOVE ZEROS                   TO BBILLEDO.
 22864
 22865     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22866
 22867     IF PB-I-LOAN-APR NOT = +99.9999
 22868        MOVE PB-I-LOAN-APR           TO BAPRO.
 22869
 22870     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22871        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22872
 22873     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22874        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22875           MOVE AL-SANOF                TO BORIGHDA
 22876           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22877           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22878
 22879     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22880
 22881     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22882        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22883
 22884     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22885        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22886                                        PI-BTYPE (1).
 22887
 22888     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22889        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22890
 22891     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22892        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22893
 22894     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22895        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22896
 22897     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 420
* EL6311.cbl
 22898        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22899
 22900     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22901        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22902
 22903     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22904         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22905         MOVE SPACE                  TO DC-OPTION-CODE
 22906         PERFORM 9700-DATE-LINK
 22907         IF NO-CONVERSION-ERROR
 22908            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22909
 22910     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22911        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22912        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22913        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22914        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22915                 GIVING BDIFFO (1)
 22916     ELSE
 22917        MOVE SPACES                  TO BBEN-CD     (1)
 22918                                        BBEN-ABBR   (1).
 22919
 22920     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22921        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22922        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22923                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22924
 22925     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22926       IF PB-RECORD-ON-HOLD
 22927          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22928
 22929     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22930       IF PB-RECORD-RETURNED
 22931          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22932
 22933     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22934        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22935             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22936
 22937     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22938
 22939     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22940        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22941
 22942     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22943        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22944                                        PI-BTYPE (2).
 22945
 22946     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22947        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22948
 22949     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22950        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22951
 22952     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22953        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22954
 22955     IF PB-I-TOT-FEES NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 421
* EL6311.cbl
 22956        MOVE ZEROS               TO PB-I-TOT-FEES
 22957     END-IF
 22958     IF PB-I-TOT-FEES > ZEROS
 22959        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22960
 22961     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22962         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22963         MOVE SPACE                  TO DC-OPTION-CODE
 22964         PERFORM 9700-DATE-LINK
 22965         IF NO-CONVERSION-ERROR
 22966            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22967
 22968     IF PB-I-TOT-FEES > ZEROS
 22969        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22970        SUBTRACT PB-I-TOT-FEES FROM
 22971                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22972
 22973     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22974        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22975        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22976        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22977        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22978                 GIVING BDIFFO (2)
 22979     ELSE
 22980        MOVE SPACES                  TO BBEN-CD     (2)
 22981                                        BBEN-ABBR   (2).
 22982
 22983     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22984       IF PB-RECORD-ON-HOLD
 22985          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22986
 22987     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22988       IF PB-RECORD-RETURNED
 22989          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22990
 22991     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22992        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22993             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22994
 22995     MOVE PB-CSR-ID                  TO BCSRO.
 22996
 22997     IF PI-COMPANY-ID  =  'DMD'
 22998        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22999            NEXT SENTENCE
 23000        ELSE
 23001            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 23002               MOVE 'NEW CERT'       TO BNCERTLI
 23003               MOVE EC-NEW-CERT      TO BNCERTO.
 23004
 23005     IF PI-COMPANY-ID  =  'DMD'
 23006        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 23007            NEXT SENTENCE
 23008        ELSE
 23009           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 23010               MOVE 'NEW STATE'      TO BNSTATLI
 23011               MOVE EC-NEW-STATE     TO BNSTATO.
 23012
 23013 7000-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 422
* EL6311.cbl
 23014     MOVE 'C'                        TO BMAINTI.
 23015     MOVE AL-UANON                   TO BMAINTA.
 23016
 23017     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 23018        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 23019
 23020     IF ARCHIVE-LETTER-RELEASED
 23021        PERFORM 7050-UPDATE-PENDING THRU 7050-EXIT
 23022     END-IF
 23023     IF PI-6315-FINALIZED = 'Y'   AND
 23024        PB-UNFORCED-ERRORS
 23025          MOVE -1                TO BFORCEL
 23026          MOVE  1                TO SET-CURSOR-SW
 23027     END-IF
 23028
 23029     IF NO-CURSOR-SET
 23030        MOVE -1                      TO BMAINTL.
 23031
 23032     GO TO 8100-SEND-INITIAL-MAP.
 23033
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 423
* EL6311.cbl
 23035
 23036 7050-UPDATE-PENDING.
 23037
 23038* EXEC CICS READ
 23039*        DATASET (FILE-ID-ERPNDB)
 23040*        INTO    (PENDING-BUSINESS)
 23041*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 23042*        UPDATE
 23043*    END-EXEC.
 23044     MOVE LENGTH OF
 23045      PENDING-BUSINESS
 23046       TO DFHEIV11
 23047*    MOVE '&"IL       EU         (   #00019229' TO DFHEIV0
 23048     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23049     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23050     MOVE X'2020233030303139323239' TO DFHEIV0(25:11)
 23051     CALL 'kxdfhei1' USING DFHEIV0,
 23052           FILE-ID-ERPNDB,
 23053           PENDING-BUSINESS,
 23054           DFHEIV11,
 23055           PI-PREV-CONTROL-PRIMARY,
 23056           DFHEIV99,
 23057           DFHEIV99,
 23058           DFHEIV99
 23059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23060
 23061
 23062     MOVE 'C' TO PB-I-LETTER-REQD
 23063     MOVE PB-I-LETTER-REQD       TO LETRREQO
 23064     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 23065     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 23066     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 23067     MOVE '5'                    TO DC-OPTION-CODE.
 23068     PERFORM 9700-DATE-LINK
 23069     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 23070
 23071
 23072* EXEC CICS REWRITE
 23073*        DATASET (FILE-ID-ERPNDB)
 23074*        FROM    (PENDING-BUSINESS)
 23075*    END-EXEC.
 23076     MOVE LENGTH OF
 23077      PENDING-BUSINESS
 23078       TO DFHEIV11
 23079*    MOVE '&& L                  %   #00019245' TO DFHEIV0
 23080     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23081     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23082     MOVE X'2020233030303139323435' TO DFHEIV0(25:11)
 23083     CALL 'kxdfhei1' USING DFHEIV0,
 23084           FILE-ID-ERPNDB,
 23085           PENDING-BUSINESS,
 23086           DFHEIV11,
 23087           DFHEIV99
 23088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23089
 23090
 23091 7050-EXIT.
 23092      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 424
* EL6311.cbl
 23093
 23094******************************************************************
 23095*                                                                *
 23096*             D I S P L A Y   C A N C E L S                      *
 23097*                                                                *
 23098******************************************************************
 23099
 23100 7100-DISPLAY-CANCELS.
 23101     IF PI-DISPLAY-ORIGINAL-BATCH
 23102        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 23103        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 23104     ELSE
 23105        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 23106
 23107     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 23108
 23109     MOVE 'Y'                        TO WS-DISPLAY-SW.
 23110     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 23111
 23112     MOVE LOW-VALUES                 TO EL631CI.
 23113     MOVE EL631C                     TO PI-MAP-NAME.
 23114     MOVE 'Y'                        TO PI-BROWSE-SW.
 23115     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 23116                                        PI-HIGH-SEQ-NO.
 23117
 23118     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 23119        MOVE AL-SABOF                TO CCHGTA
 23120        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 23121        MOVE AL-SANON                TO CCHGA
 23122      ELSE
 23123        MOVE AL-SADOF                TO CCHGTA
 23124                                        CCHGA
 23125        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 23126
 23127*    MOVE PB-C-REFERENCE             TO CREFO.
 23128
 23129*    IF PB-C-MICROFILM-NO IS NUMERIC
 23130*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 23131*          MOVE PB-C-MICROFILM-NO
 23132*                                TO CMICRNOO
 23133*          MOVE AL-UNNON         TO CMICRNOA
 23134*       END-IF
 23135*    END-IF
 23136     IF PB-C-INT-ON-REFS NUMERIC
 23137        IF PB-C-INT-ON-REFS NOT = ZEROS
 23138           MOVE PB-C-INT-ON-REFS
 23139                                 TO CNHINTO
 23140           MOVE AL-SANOF         TO CNHINTA
 23141        END-IF
 23142     END-IF
 23143     MOVE PB-CERT-PRIME              TO CCERTNOO.
 23144     MOVE PB-CERT-SFX                TO CSUFIXO.
 23145     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 23146     MOVE SPACE                      TO DC-OPTION-CODE.
 23147     PERFORM 9700-DATE-LINK.
 23148     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 23149
 23150     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 425
* EL6311.cbl
 23151        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 23152        MOVE SPACE                   TO DC-OPTION-CODE
 23153        PERFORM 9700-DATE-LINK
 23154        IF NO-CONVERSION-ERROR
 23155           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 23156
 23157     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 23158        NEXT SENTENCE
 23159     ELSE
 23160        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 23161
 23162     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 23163        NEXT SENTENCE
 23164     ELSE
 23165        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 23166
 23167     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 23168        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 23169        MOVE SPACE                   TO DC-OPTION-CODE
 23170        PERFORM 9700-DATE-LINK
 23171        IF NO-CONVERSION-ERROR
 23172           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 23173
 23174     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23175         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 23176
 23177     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23178         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 23179
 23180     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 23181        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 23182        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 23183                 GIVING CDRFND1O.
 23184
 23185     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 23186        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 23187        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 23188                 GIVING CDRFND2O.
 23189
 23190     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23191       IF PB-RECORD-ON-HOLD
 23192          MOVE 'ON HOLD'             TO CBILIT1O.
 23193
 23194     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23195       IF PB-RECORD-RETURNED
 23196          MOVE 'RETURNED'            TO CBILIT1O.
 23197
 23198     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 23199        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 23200             MOVE 'OVERRIDE'         TO CBILIT1O.
 23201
 23202     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23203       IF PB-RECORD-ON-HOLD
 23204          MOVE 'ON HOLD'             TO CBILIT2O.
 23205
 23206     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23207       IF PB-RECORD-RETURNED
 23208          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 426
* EL6311.cbl
 23209
 23210     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 23211        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 23212             MOVE 'OVERRIDE'         TO CBILIT2O.
 23213
 23214     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 23215     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 23216     IF PB-C-POST-CARD-IND = 'Y'
 23217        MOVE 'Y'                     TO CPCYNO
 23218     ELSE
 23219        MOVE 'N'                     TO CPCYNO
 23220     END-IF
 23221     MOVE PB-FORCE-CODE              TO CFORCEO.
 23222     MOVE PB-RECORD-BILL             TO CBILCDO.
 23223     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 23224     MOVE SPACES                     TO CINITSO.
 23225     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 23226         MOVE PB-CI-FIRST-NAME       TO CINITSO
 23227     ELSE
 23228         MOVE PB-CI-INITIALS         TO CINITSO
 23229     END-IF.
 23230
 23231     IF PB-CI-CANCEL-FEE NUMERIC
 23232        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 23233        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 23234     ELSE
 23235        MOVE ZEROES                  TO W-CANCEL-FEE.
 23236
 23237     MOVE W-CANCEL-FEE               TO CCANFEEO.
 23238
 23239     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 23240        ADD PB-CI-LF-PREMIUM-AMT
 23241             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 23242
 23243     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 23244        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 23245
 23246     MOVE PB-CI-LF-TERM              TO CTERM1O.
 23247     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 23248     MOVE PB-CI-AH-TERM              TO CTERM2O.
 23249     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 23250
 23251     IF PB-C-LIVES NUMERIC
 23252        MOVE PB-C-LIVES              TO CLIVESO.
 23253
 23254     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 23255        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 23256
 23257     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 23258        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 23259        MOVE SPACE                   TO DC-OPTION-CODE
 23260        PERFORM 9700-DATE-LINK
 23261        IF NO-CONVERSION-ERROR
 23262           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 23263
 23264     IF  PB-C-REFUND-CREATED
 23265         MOVE 'YES'                  TO CRFNDSWO
 23266     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 427
* EL6311.cbl
 23267         IF PB-C-REFUND-REQUESTED
 23268            MOVE 'REQ'               TO CRFNDSWO
 23269         ELSE
 23270            MOVE 'NO'                TO CRFNDSWO.
 23271
 23272     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 23273     MOVE SPACE                      TO DC-OPTION-CODE.
 23274     PERFORM 9700-DATE-LINK.
 23275     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 23276     MOVE PB-INPUT-BY                TO CENTBYO.
 23277
 23278     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23279        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 23280        MOVE SPACE                   TO DC-OPTION-CODE
 23281        PERFORM 9700-DATE-LINK
 23282        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 23283        MOVE 'INACTIVE'              TO CMOENDTO
 23284     ELSE
 23285        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 23286        MOVE SPACE                   TO DC-OPTION-CODE
 23287        PERFORM 9700-DATE-LINK
 23288        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 23289        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 23290        MOVE SPACE                   TO DC-OPTION-CODE
 23291        PERFORM 9700-DATE-LINK
 23292        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 23293
 23294     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 23295
 23296     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 23297     MOVE WS-HR-MINS                 TO CMANTATO.
 23298
 23299     EVALUATE PB-LF-REFUND-TYPE
 23300        WHEN '1'
 23301           MOVE 'RULE78'            TO CLFREFNO
 23302        WHEN '2'
 23303           MOVE 'PRORAT'            TO CLFREFNO
 23304        WHEN '3'
 23305           MOVE 'CALIF'             TO CLFREFNO
 23306        WHEN '4'
 23307           MOVE 'IRREG'             TO CLFREFNO
 23308        WHEN '5'
 23309           MOVE 'NETPAY'            TO CLFREFNO
 23310        WHEN '6'
 23311           MOVE 'ATCP'              TO CLFREFNO
 23312        WHEN '7'
 23313           MOVE 'UTAH'              TO CLFREFNO
 23314        WHEN '8'
 23315           MOVE 'MEAN'              TO CLFREFNO
 23316        WHEN '9'
 23317           MOVE 'SUM '              TO CLFREFNO
 23318        WHEN 'B'
 23319           MOVE 'BALN'              TO CLFREFNO
 23320     END-EVALUATE.
 23321
 23322     EVALUATE TRUE
 23323        WHEN PB-AH-REFUND-TYPE =  '1'
 23324           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 428
* EL6311.cbl
 23325        WHEN PB-AH-REFUND-TYPE =  '2'
 23326           MOVE 'PRORAT'            TO CAHREFNO
 23327        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 23328           MOVE 'CALIF'             TO CAHREFNO
 23329        WHEN PB-AH-REFUND-TYPE =  '4'
 23330           MOVE 'IRREG'             TO CAHREFNO
 23331        WHEN PB-AH-REFUND-TYPE =  '5'
 23332           MOVE 'NETPAY'            TO CAHREFNO
 23333        WHEN PB-AH-REFUND-TYPE =  '6'
 23334           MOVE 'ATCP'              TO CAHREFNO
 23335        WHEN PB-AH-REFUND-TYPE =  '7'
 23336           MOVE 'UTAH'              TO CAHREFNO
 23337        WHEN PB-AH-REFUND-TYPE =  '8'
 23338           MOVE 'MEAN'              TO CAHREFNO
 23339        WHEN PB-AH-REFUND-TYPE =  '9'
 23340           MOVE 'SUM '              TO CAHREFNO
 23341        WHEN PB-AH-REFUND-TYPE =  'B'
 23342           MOVE 'BALN'              TO CAHREFNO
 23343     END-EVALUATE.
 23344
 23345     MOVE PB-REIN-CD                 TO CREINCDO.
 23346
 23347     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 23348        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 23349        MOVE SPACE                   TO DC-OPTION-CODE
 23350        PERFORM 9700-DATE-LINK
 23351        IF NO-CONVERSION-ERROR
 23352           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 23353
 23354     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 23355        MOVE 999999                  TO WS-EXP-DT-EDIT
 23356        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 23357        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 23358     ELSE
 23359        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 23360           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 23361           MOVE SPACE                   TO DC-OPTION-CODE
 23362           PERFORM 9700-DATE-LINK
 23363           IF NO-CONVERSION-ERROR
 23364              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 23365
 23366     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 23367        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 23368           MOVE AL-SANOF                TO CORIGHDA
 23369           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 23370           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 23371
 23372     MOVE PB-CSR-ID              TO CCSRO.
 23373
 23374     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 23375     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 23376     MOVE 'N'                    TO ACTSPCO
 23377     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACNT-KEY
 23378     MOVE '2'                    TO ERACNT-REC-TYPE
 23379     MOVE +3                     TO ERACNT-SEQ-NO
 23380
 23381
 23382* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 429
* EL6311.cbl
 23383*         DATASET   ('ERACNT')
 23384*         INTO      (NOTE-FILE)
 23385*         RIDFLD    (ERACNT-KEY)
 23386*         RESP      (WS-RESPONSE)
 23387*    END-EXEC
 23388     MOVE LENGTH OF
 23389      NOTE-FILE
 23390       TO DFHEIV11
 23391     MOVE 'ERACNT' TO DFHEIV1
 23392*    MOVE '&"IL       E          (  N#00019540' TO DFHEIV0
 23393     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23394     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23395     MOVE X'204E233030303139353430' TO DFHEIV0(25:11)
 23396     CALL 'kxdfhei1' USING DFHEIV0,
 23397           DFHEIV1,
 23398           NOTE-FILE,
 23399           DFHEIV11,
 23400           ERACNT-KEY,
 23401           DFHEIV99,
 23402           DFHEIV99,
 23403           DFHEIV99
 23404     MOVE EIBRESP  TO WS-RESPONSE
 23405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23406
 23407     IF RESP-NORMAL
 23408        IF NT-account-special = 'Y'
 23409           MOVE 'Y'              TO actspcO
 23410           MOVE ER-1762          TO EMI-ERROR
 23411           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23412        END-IF
 23413     END-IF
 23414     MOVE 'C'                    TO CMAINTI.
 23415     MOVE AL-UANON               TO CMAINTA.
 23416
 23417     IF PI-6316-FINALIZED = 'Y'  AND
 23418        PB-UNFORCED-ERRORS
 23419          MOVE -1                TO CFORCEL
 23420          MOVE  1                TO SET-CURSOR-SW
 23421     END-IF
 23422
 23423     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 23424        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 23425
 23426     IF NO-CURSOR-SET
 23427        MOVE -1                  TO CMAINTL.
 23428
 23429     GO TO 8100-SEND-INITIAL-MAP.
 23430
 23431
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 430
* EL6311.cbl
 23433***************************************************************
 23434*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 23435*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 23436***************************************************************
 23437
 23438 7200-DISPLAY-BATCHES.
 23439     MOVE EL631D                 TO PI-MAP-NAME.
 23440     MOVE LOW-VALUES             TO EL631DI.
 23441
 23442     MOVE 'Y'                    TO WS-DISPLAY-SW.
 23443
 23444
 23445* EXEC CICS HANDLE CONDITION
 23446*         NOTFND   (3690-NOT-FOUND)
 23447*    END-EXEC.
 23448*    MOVE '"$I                   ! Y #00019584' TO DFHEIV0
 23449     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23450     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23451     MOVE X'5920233030303139353834' TO DFHEIV0(25:11)
 23452     CALL 'kxdfhei1' USING DFHEIV0
 23453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23454
 23455
 23456     IF PI-DISPLAY-SCREEN
 23457        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 23458     ELSE
 23459        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 23460
 23461     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 23462     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 23463
 23464
 23465* EXEC CICS READ
 23466*         DATASET   (FILE-ID-ERPNDB)
 23467*         RIDFLD    (ERPNDB-KEY)
 23468*         SET       (ADDRESS OF PENDING-BUSINESS)
 23469*    END-EXEC.
 23470*    MOVE '&"S        E          (   #00019596' TO DFHEIV0
 23471     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23472     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23473     MOVE X'2020233030303139353936' TO DFHEIV0(25:11)
 23474     CALL 'kxdfhei1' USING DFHEIV0,
 23475           FILE-ID-ERPNDB,
 23476           DFHEIV20,
 23477           DFHEIV99,
 23478           ERPNDB-KEY,
 23479           DFHEIV99,
 23480           DFHEIV99,
 23481           DFHEIV99
 23482     SET ADDRESS OF PENDING-BUSINESS TO
 23483         DFHEIV20
 23484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23485
 23486
 23487     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 23488     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 23489     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 23490     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 431
* EL6311.cbl
 23491     MOVE PB-SV-STATE            TO PI-SV-STATE.
 23492
 23493     MOVE EL631D                 TO PI-MAP-NAME.
 23494     MOVE LOW-VALUES             TO EL631DI.
 23495     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 23496
 23497*    IF PI-AR-PROCESSING
 23498*       MOVE PB-REFERENCE        TO DREFO.
 23499
 23500     MOVE PB-CSR-ID              TO DCSRO.
 23501
 23502     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23503        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 23504        MOVE SPACE               TO DC-OPTION-CODE
 23505        PERFORM 9700-DATE-LINK
 23506        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 23507        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 23508        MOVE 'INACTIVE'          TO DLDATEO
 23509     ELSE
 23510        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 23511        MOVE SPACE               TO DC-OPTION-CODE
 23512        PERFORM 9700-DATE-LINK
 23513        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 23514
 23515     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 23516     MOVE SPACE                  TO DC-OPTION-CODE.
 23517     PERFORM 9700-DATE-LINK.
 23518     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 23519
 23520     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 23521        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 23522     ELSE
 23523        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 23524        MOVE SPACE               TO DC-OPTION-CODE
 23525        PERFORM 9700-DATE-LINK
 23526        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 23527
 23528     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 23529     MOVE SPACE                  TO DC-OPTION-CODE.
 23530     PERFORM 9700-DATE-LINK.
 23531     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 23532
 23533     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 23534     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 23535
 23536     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 23537        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 23538                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23539
 23540     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23541     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23542     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23543
 23544     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23545        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23546                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23547
 23548     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 432
* EL6311.cbl
 23549     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23550     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23551
 23552     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23553        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23554                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23555
 23556     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23557     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23558
 23559     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23560        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23561                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23562
 23563     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23564     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23565     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23566
 23567     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23568        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23569                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23570
 23571     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23572     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23573     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23574
 23575     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23576        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23577                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23578
 23579     MOVE -1                     TO DPFENTRL.
 23580     GO TO 8100-SEND-INITIAL-MAP.
 23581
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 433
* EL6311.cbl
 23583
 23584***************************************************************
 23585*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23586*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23587*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23588*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23589*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23590*     ARE THEN SET ACCORDINGLY.                               *
 23591*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23592*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23593*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23594***************************************************************
 23595
 23596******************************************************************
 23597*                                                                *
 23598*            E R R O R   A N A L Y S I S                         *
 23599*                                                                *
 23600******************************************************************
 23601
 23602******************************************************************
 23603*                                                                *
 23604*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23605*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23606*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23607*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23608*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23609*                                                                *
 23610*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23611*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23612*                                                                *
 23613******************************************************************
 23614
 23615 7300-FORMAT-ERRORS.
 23616     MOVE ' '                    TO PI-ERRORS-SW
 23617     IF PB-COMMON-ERRORS = LOW-VALUES
 23618        IF PB-FATAL-ERRORS
 23619           MOVE ER-2695          TO EMI-ERROR
 23620           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23621           GO TO 7399-EXIT.
 23622
 23623     MOVE +0                     TO WS-SUB4
 23624     move +0                     to pi-6311-fatal-ctr
 23625     .
 23626 7310-ERROR-LOOP.
 23627
 23628     ADD +1                      TO WS-SUB4.
 23629
 23630     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23631        GO TO 7350-SET-ERROR-FLAGS.
 23632
 23633     IF PI-COMPANY-ID = 'UCL'
 23634         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23635             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23636             MOVE ' '                   TO DC-OPTION-CODE
 23637             PERFORM 9700-DATE-LINK
 23638             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23639
 23640     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 434
* EL6311.cbl
 23641     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23642     if (emi-fatal)
 23643        and (emi-error not = 1753 and 1754 and 1757 and
 23644                             1758 and 1759 and 1760)
 23645        add +1                   to pi-6311-fatal-ctr
 23646     end-if
 23647     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23648
 23649     GO TO 7310-ERROR-LOOP.
 23650
 23651
 23652 7350-SET-ERROR-FLAGS.
 23653
 23654     IF EMI-FATAL-CTR NOT = ZEROS
 23655        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23656        MOVE 'X'                 TO PB-FATAL-FLAG
 23657                                    PI-ERRORS-SW
 23658        GO TO 7355-SET-ERROR-FLAGS.
 23659
 23660     move ' ' to pi-unforced-sw
 23661     IF EMI-FORCABLE-CTR NOT = ZEROS
 23662        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23663        IF PB-ISSUE
 23664           IF PB-ISSUE-FORCE
 23665              MOVE 'F'           TO PB-FORCE-ER-CD
 23666              MOVE ER-2600       TO EMI-ERROR
 23667              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23668             ELSE
 23669              MOVE 'X'           TO PB-FORCE-ER-CD
 23670*                                   PI-ERRORS-SW
 23671          ELSE
 23672           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23673              MOVE 'F'           TO PB-FORCE-ER-CD
 23674                                    pi-unforced-sw
 23675              MOVE ER-2600       TO EMI-ERROR
 23676              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23677             ELSE
 23678              MOVE 'X'           TO PB-FORCE-ER-CD
 23679                                    pi-unforced-sw.
 23680*                                   PI-ERRORS-SW.
 23681
 23682     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23683     IF PB-ISSUE
 23684         MOVE 'I'                TO ENDT-RECORD-TYPE
 23685     ELSE
 23686         MOVE 'C'                TO ENDT-RECORD-TYPE
 23687     END-IF
 23688     MOVE +0                     TO ENDT-SEQ-NO
 23689
 23690
 23691* EXEC CICS READ
 23692*        DATASET   (FILE-ID-ERENDT)
 23693*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23694*        RIDFLD    (ERENDT-KEY)
 23695*        RESP      (WS-RESPONSE)
 23696*        GTEQ
 23697*    END-EXEC
 23698*    MOVE '&"S        G          (  N#00019805' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 435
* EL6311.cbl
 23699     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23700     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23701     MOVE X'204E233030303139383035' TO DFHEIV0(25:11)
 23702     CALL 'kxdfhei1' USING DFHEIV0,
 23703           FILE-ID-ERENDT,
 23704           DFHEIV20,
 23705           DFHEIV99,
 23706           ERENDT-KEY,
 23707           DFHEIV99,
 23708           DFHEIV99,
 23709           DFHEIV99
 23710     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23711         DFHEIV20
 23712     MOVE EIBRESP  TO WS-RESPONSE
 23713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23714
 23715     IF RESP-NORMAL
 23716        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23717        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23718            MOVE ER-0280          TO EMI-ERROR
 23719            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23720            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23721            IF CALLED-FROM-6315
 23722               MOVE 'Y' TO WS-ARCHIVE-LETTER-SW
 23723            END-IF
 23724            EVALUATE TRUE
 23725              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23726                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23727              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23728                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23729              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23730                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23731            END-EVALUATE
 23732        END-IF
 23733     END-IF
 23734
 23735
 23736
 23737     IF FIRST-ENTRY OR
 23738        EIBAID = DFHPF1 OR DFHPF2
 23739        MOVE '0'                TO PI-EDIT-SW
 23740        GO TO 7399-EXIT.
 23741
 23742 7355-SET-ERROR-FLAGS.
 23743
 23744     IF EMI-WARNING-CTR NOT = ZEROS
 23745        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23746        MOVE 'W'                 TO PB-WARN-ER-CD.
 23747
 23748     IF PB-UNFORCED-ERRORS OR
 23749        PB-FATAL-ERRORS    OR
 23750        PB-RECORD-ON-HOLD  OR
 23751        PB-RECORD-RETURNED OR
 23752        PB-CANCELLATION
 23753          NEXT SENTENCE
 23754        ELSE
 23755          GO TO 7399-EXIT.
 23756
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 436
* EL6311.cbl
 23757
 23758* EXEC CICS  HANDLE CONDITION
 23759*           NOTFND   (7399-EXIT)
 23760*    END-EXEC.
 23761*    MOVE '"$I                   ! Z #00019855' TO DFHEIV0
 23762     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23763     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23764     MOVE X'5A20233030303139383535' TO DFHEIV0(25:11)
 23765     CALL 'kxdfhei1' USING DFHEIV0
 23766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23767
 23768
 23769     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23770     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23771     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23772     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23773
 23774
 23775* EXEC CICS READ
 23776*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23777*        DATASET (FILE-ID-ELCERT)
 23778*        RIDFLD  (ELCERT-KEY)
 23779*        UPDATE
 23780*    END-EXEC.
 23781*    MOVE '&"S        EU         (   #00019864' TO DFHEIV0
 23782     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23783     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23784     MOVE X'2020233030303139383634' TO DFHEIV0(25:11)
 23785     CALL 'kxdfhei1' USING DFHEIV0,
 23786           FILE-ID-ELCERT,
 23787           DFHEIV20,
 23788           DFHEIV99,
 23789           ELCERT-KEY,
 23790           DFHEIV99,
 23791           DFHEIV99,
 23792           DFHEIV99
 23793     SET ADDRESS OF CERTIFICATE-MASTER TO
 23794         DFHEIV20
 23795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23796
 23797
 23798
 23799     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23800     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23801
 23802     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23803        GO TO 7360-REWRITE-CERT-MASTER.
 23804
 23805     IF PB-ISSUE
 23806        IF PB-RECORD-RETURNED
 23807            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23808            GO TO 7360-REWRITE-CERT-MASTER
 23809        ELSE
 23810            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23811            GO TO 7360-REWRITE-CERT-MASTER.
 23812
 23813     IF PB-RECORD-RETURNED
 23814         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 437
* EL6311.cbl
 23815         GO TO 7360-REWRITE-CERT-MASTER.
 23816
 23817     IF (PB-C-LF-CANCEL-VOIDED)
 23818        or (pb-c-ah-cancel-voided)
 23819        IF (PB-UNFORCED-ERRORS OR
 23820            PB-FATAL-ERRORS    OR
 23821            PB-RECORD-ON-HOLD)
 23822            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23823            GO TO 7360-REWRITE-CERT-MASTER
 23824        ELSE
 23825            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23826            GO TO 7360-REWRITE-CERT-MASTER.
 23827
 23828     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23829                            OR PB-RECORD-ON-HOLD)
 23830        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23831     ELSE
 23832        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23833
 23834 7360-REWRITE-CERT-MASTER.
 23835
 23836     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23837        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23838
 23839* EXEC CICS UNLOCK
 23840*            DATASET    (FILE-ID-ELCERT)
 23841*       END-EXEC
 23842*    MOVE '&*                    #   #00019911' TO DFHEIV0
 23843     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23844     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23845     MOVE X'2020233030303139393131' TO DFHEIV0(25:11)
 23846     CALL 'kxdfhei1' USING DFHEIV0,
 23847           FILE-ID-ELCERT,
 23848           DFHEIV99
 23849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23850        GO TO 7399-EXIT.
 23851
 23852
 23853* EXEC CICS REWRITE
 23854*         DATASET    (FILE-ID-ELCERT)
 23855*         FROM       (CERTIFICATE-MASTER)
 23856*    END-EXEC.
 23857     MOVE LENGTH OF
 23858      CERTIFICATE-MASTER
 23859       TO DFHEIV11
 23860*    MOVE '&& L                  %   #00019916' TO DFHEIV0
 23861     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23862     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23863     MOVE X'2020233030303139393136' TO DFHEIV0(25:11)
 23864     CALL 'kxdfhei1' USING DFHEIV0,
 23865           FILE-ID-ELCERT,
 23866           CERTIFICATE-MASTER,
 23867           DFHEIV11,
 23868           DFHEIV99
 23869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23870
 23871
 23872 7399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 438
* EL6311.cbl
 23873      EXIT.
 23874
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 439
* EL6311.cbl
 23876
 23877*************************************************************
 23878*                                                           *
 23879*              S E T   A T T R I B U T E S                  *
 23880*                                                           *
 23881*************************************************************
 23882
 23883 7400-SET-ATTRIBUTES.
 23884
 23885     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23886        GO TO 7499-EXIT.
 23887
 23888**2601**
 23889
 23890     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23891        IF PB-ISSUE
 23892           MOVE AL-UABON         TO BEFFDTA
 23893           GO TO 7499-EXIT
 23894         ELSE
 23895           MOVE AL-UABON         TO CEFFDTA
 23896           GO TO 7499-EXIT.
 23897
 23898**2604**
 23899
 23900     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23901        IF PB-ISSUE
 23902           MOVE AL-UABON         TO BTYPE1A
 23903           MOVE -1               TO BTYPE1L
 23904           MOVE  1               TO SET-CURSOR-SW
 23905           GO TO 7499-EXIT.
 23906
 23907**2605**
 23908
 23909     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23910        IF PB-ISSUE
 23911           MOVE AL-UABON         TO BTYPE2A
 23912           MOVE -1               TO BTYPE2L
 23913           MOVE  1               TO SET-CURSOR-SW
 23914           GO TO 7499-EXIT.
 23915
 23916**2606**
 23917
 23918     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23919        IF PB-ISSUE
 23920           MOVE AL-UABON         TO BSIGA
 23921           MOVE -1               TO BSIGL
 23922           MOVE  1               TO SET-CURSOR-SW
 23923           GO TO 7499-EXIT.
 23924
 23925**2607**
 23926
 23927     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23928        IF PB-ISSUE
 23929           MOVE AL-UABON         TO BSIGA
 23930           MOVE -1               TO BSIGL
 23931           MOVE  1               TO SET-CURSOR-SW
 23932           GO TO 7499-EXIT.
 23933
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 440
* EL6311.cbl
 23934**2615**
 23935
 23936     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23937        IF PB-ISSUE
 23938           MOVE AL-UABOF         TO BREINA
 23939           MOVE -1               TO BREINL
 23940           GO TO 7499-EXIT.
 23941
 23942**2622**
 23943
 23944     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23945        IF PB-ISSUE
 23946           MOVE AL-UABON         TO BEFFDTA
 23947           GO TO 7499-EXIT
 23948        ELSE
 23949           MOVE AL-UABON         TO CEFFDTA
 23950           GO TO 7499-EXIT.
 23951
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 441
* EL6311.cbl
 23953
 23954*************************************************************
 23955*                                                           *
 23956*              I S S U E   E R R O R S                      *
 23957*                                                           *
 23958*************************************************************
 23959
 23960 7420-ISSUE-ERRORS.
 23961
 23962     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1577
 23963        MOVE -1                  TO LETRREQL
 23964        MOVE AL-UABOF            TO LETRREQA
 23965        MOVE  1                  TO SET-CURSOR-SW
 23966        GO TO 7499-EXIT.
 23967
 23968     IF PB-COMMON-ERROR    (WS-SUB4) = ER-1584
 23969        MOVE AL-UABOF            TO LETRREQA
 23970        GO TO 7499-EXIT.
 23971
 23972**2626**
 23973
 23974     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23975        MOVE AL-UABON            TO BCERTNOA
 23976        GO TO 7499-EXIT.
 23977
 23978**2627**
 23979
 23980     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23981        MOVE AL-UNBON            TO BAGEA
 23982        MOVE -1                  TO BAGEL
 23983        MOVE  1                  TO SET-CURSOR-SW
 23984        GO TO 7499-EXIT.
 23985
 23986**2628**
 23987
 23988     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23989        MOVE AL-UNBON            TO BAGEA
 23990        MOVE -1                  TO BAGEL
 23991        MOVE  1                  TO SET-CURSOR-SW
 23992        GO TO 7499-EXIT.
 23993
 23994**2629**
 23995
 23996     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23997        MOVE AL-UABON            TO BSEXA
 23998        MOVE -1                  TO BSEXL
 23999        MOVE  1                  TO SET-CURSOR-SW
 24000        GO TO 7499-EXIT.
 24001
 24002**2630**
 24003
 24004     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 24005        MOVE -1                  TO BTYPE1L
 24006        MOVE  1                  TO SET-CURSOR-SW
 24007        GO TO 7499-EXIT.
 24008
 24009**2631**
 24010
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 442
* EL6311.cbl
 24011     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 24012        MOVE -1                  TO BTYPE1L
 24013        MOVE  1                  TO SET-CURSOR-SW
 24014        GO TO 7499-EXIT.
 24015
 24016**2632**
 24017
 24018     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 24019        MOVE AL-UNBON            TO BBEN1A
 24020        MOVE -1                  TO BBEN1L
 24021        MOVE  1                  TO SET-CURSOR-SW
 24022        GO TO 7499-EXIT.
 24023
 24024**2633**
 24025
 24026     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 24027        MOVE AL-UNBON            TO BPREM1A
 24028        MOVE -1                  TO BPREM1L
 24029        MOVE  1                  TO SET-CURSOR-SW
 24030        GO TO 7499-EXIT.
 24031
 24032**2634**
 24033
 24034     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 24035        MOVE -1                  TO BTYPE2L
 24036        MOVE  1                  TO SET-CURSOR-SW
 24037        GO TO 7499-EXIT.
 24038
 24039**2635**
 24040
 24041     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 24042        MOVE AL-UNBON            TO BBEN2A
 24043        MOVE -1                  TO BBEN2L
 24044        MOVE  1                  TO SET-CURSOR-SW
 24045        GO TO 7499-EXIT.
 24046
 24047**2636**
 24048
 24049     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 24050        MOVE AL-UNBON            TO BPREM2A
 24051        MOVE -1                  TO BPREM2L
 24052        MOVE  1                  TO SET-CURSOR-SW
 24053        GO TO 7499-EXIT.
 24054
 24055**2639**
 24056
 24057     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 24058        MOVE AL-UNBON            TO BBEN1A
 24059        MOVE -1                  TO BBEN1L
 24060        MOVE  1                  TO SET-CURSOR-SW
 24061        GO TO 7499-EXIT.
 24062
 24063**2640**
 24064
 24065     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 24066        MOVE AL-UNBON            TO BBEN2A
 24067        MOVE -1                  TO BBEN2L
 24068        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 443
* EL6311.cbl
 24069        GO TO 7499-EXIT.
 24070
 24071**2647**
 24072
 24073     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 24074        MOVE AL-UNBON            TO BTERM1A
 24075        MOVE -1                  TO BTERM1L
 24076        MOVE  1                  TO SET-CURSOR-SW
 24077        GO TO 7499-EXIT.
 24078
 24079**2648**
 24080
 24081     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 24082        MOVE AL-UNBON            TO BLNTRMA
 24083        MOVE -1                  TO BLNTRML
 24084        MOVE  1                  TO SET-CURSOR-SW
 24085        GO TO 7499-EXIT.
 24086
 24087**2649**
 24088
 24089     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 24090        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 24091            MOVE AL-UNBON            TO BPREM1A
 24092            MOVE -1                  TO BPREM1L
 24093            MOVE  1                  TO SET-CURSOR-SW
 24094            GO TO 7499-EXIT
 24095     ELSE
 24096        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 24097           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 24098            MOVE AL-UNBON            TO BPREM2A
 24099            MOVE -1                  TO BPREM2L
 24100            MOVE  1                  TO SET-CURSOR-SW
 24101            GO TO 7499-EXIT.
 24102
 24103**2650**
 24104
 24105     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 24106        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 24107            MOVE AL-UNBON        TO BPREM1A
 24108            MOVE -1              TO BPREM1L
 24109            MOVE  1              TO SET-CURSOR-SW
 24110            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 24111                MOVE AL-UNBON        TO BPREM2A
 24112                MOVE -1              TO BPREM2L
 24113                MOVE  1              TO SET-CURSOR-SW
 24114                GO TO 7499-EXIT
 24115            ELSE
 24116                GO TO 7499-EXIT
 24117        ELSE
 24118            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 24119                MOVE AL-UNBON        TO BPREM2A
 24120                MOVE -1              TO BPREM2L
 24121                MOVE  1              TO SET-CURSOR-SW
 24122                GO TO 7499-EXIT
 24123            ELSE
 24124                GO TO 7499-EXIT.
 24125
 24126**2651**
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 444
* EL6311.cbl
 24127
 24128     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2651
 24129        MOVE AL-UABON            TO BSIGA
 24130        MOVE -1                  TO BSIGL
 24131        MOVE  1                  TO SET-CURSOR-SW
 24132        GO TO 7499-EXIT.
 24133
 24134**2653**
 24135
 24136     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
 24137        MOVE AL-UABON            TO BFREQA
 24138        MOVE -1                  TO BFREQL
 24139        MOVE  1                  TO SET-CURSOR-SW
 24140        GO TO 7499-EXIT.
 24141
 24142**2654**
 24143
 24144     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 24145        MOVE AL-UABON            TO BFREQA
 24146        MOVE -1                  TO BFREQL
 24147        MOVE  1                  TO SET-CURSOR-SW
 24148        GO TO 7499-EXIT.
 24149
 24150**2655**
 24151
 24152     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 24153        MOVE AL-UABON            TO BFREQA
 24154        MOVE -1                  TO BFREQL
 24155        MOVE  1                  TO SET-CURSOR-SW
 24156        GO TO 7499-EXIT.
 24157
 24158**2656**
 24159
 24160     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 24161        MOVE AL-UNBON            TO BAPRA
 24162        MOVE -1                  TO BAPRL
 24163        MOVE  1                  TO SET-CURSOR-SW
 24164        GO TO 7499-EXIT.
 24165
 24166**2657**
 24167
 24168     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 24169        MOVE AL-UNBON            TO BAPRA
 24170        MOVE -1                  TO BAPRL
 24171        MOVE  1                  TO SET-CURSOR-SW
 24172        GO TO 7499-EXIT.
 24173
 24174**2658**
 24175
 24176     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 24177        MOVE AL-UNBON            TO BTERM2A
 24178        MOVE -1                  TO BTERM2L
 24179        MOVE  1                  TO SET-CURSOR-SW
 24180        GO TO 7499-EXIT.
 24181
 24182**2660**
 24183
 24184     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 445
* EL6311.cbl
 24185        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 24186        MOVE -1                  TO BLSTNML
 24187        MOVE  1                  TO SET-CURSOR-SW
 24188        GO TO 7499-EXIT.
 24189
 24190
 24191**2662**
 24192
 24193     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 24194        MOVE AL-UNBON            TO BAGEA
 24195        MOVE -1                  TO BAGEL
 24196        MOVE  1                  TO SET-CURSOR-SW
 24197        GO TO 7499-EXIT.
 24198
 24199**2663**
 24200
 24201     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 24202        MOVE AL-UNBON            TO BAGEA
 24203        MOVE -1                  TO BAGEL
 24204        MOVE  1                  TO SET-CURSOR-SW
 24205        GO TO 7499-EXIT.
 24206
 24207**2664**
 24208
 24209     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 24210        MOVE AL-UABON            TO BREINA
 24211        MOVE -1                  TO BREINL
 24212        MOVE  1                  TO SET-CURSOR-SW
 24213        GO TO 7499-EXIT.
 24214
 24215**2667**
 24216
 24217     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 24218        MOVE AL-UNBON            TO BBEN2A
 24219        MOVE -1                  TO BBEN2L
 24220        MOVE  1                  TO SET-CURSOR-SW
 24221        GO TO 7499-EXIT.
 24222
 24223**2668**
 24224
 24225     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 24226        MOVE AL-UABON            TO BEFFDTA
 24227        GO TO 7499-EXIT.
 24228
 24229**2669**
 24230
 24231     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 24232       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 24233       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 24234        MOVE AL-UNBON            TO BAGEA
 24235        MOVE -1                  TO BAGEL
 24236        MOVE  1                  TO SET-CURSOR-SW
 24237        GO TO 7499-EXIT.
 24238
 24239**2670**
 24240
 24241     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 24242        MOVE AL-UABON            TO BFORCEA
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 446
* EL6311.cbl
 24243        MOVE -1                  TO BFORCEL
 24244        MOVE  1                  TO SET-CURSOR-SW
 24245        GO TO 7499-EXIT.
 24246
 24247**2671**
 24248
 24249     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 24250        MOVE AL-UABON            TO BEFFDTA
 24251        GO TO 7499-EXIT.
 24252
 24253**2672**
 24254
 24255     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 24256        MOVE AL-UABON            TO BEFFDTA
 24257        GO TO 7499-EXIT.
 24258
 24259**2673**
 24260
 24261     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 24262        MOVE AL-UABON            TO BEFFDTA
 24263        GO TO 7499-EXIT.
 24264
 24265**2674**
 24266
 24267     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 24268        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 24269        MOVE -1                  TO BTYPE1L
 24270        MOVE  1                  TO SET-CURSOR-SW
 24271        GO TO 7499-EXIT.
 24272
 24273**2677**
 24274
 24275     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 24276        MOVE AL-UNBON            TO BTERM1A
 24277        MOVE -1                  TO BTERM1L
 24278        MOVE  1                  TO SET-CURSOR-SW
 24279        GO TO 7499-EXIT.
 24280
 24281**2678**
 24282
 24283     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 24284        MOVE AL-UNBON            TO BTERM2A
 24285        MOVE -1                  TO BTERM2L
 24286        MOVE  1                  TO SET-CURSOR-SW
 24287        GO TO 7499-EXIT.
 24288
 24289**2679**
 24290
 24291     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 24292        MOVE AL-UABON            TO BTYPE1A
 24293        MOVE -1                  TO BTYPE1L
 24294        MOVE  1                  TO SET-CURSOR-SW
 24295        GO TO 7499-EXIT.
 24296
 24297**2680**
 24298
 24299     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 24300        MOVE AL-UABOF            TO B1STPMTA
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 447
* EL6311.cbl
 24301        MOVE -1                  TO B1STPMTL
 24302        MOVE  1                  TO SET-CURSOR-SW
 24303        GO TO 7499-EXIT.
 24304
 24305**2681**
 24306
 24307     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 24308        MOVE AL-UABON            TO BDAYSA
 24309        MOVE -1                  TO BDAYSL
 24310        MOVE  1                  TO SET-CURSOR-SW
 24311        GO TO 7499-EXIT.
 24312
 24313**2682**
 24314
 24315     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 24316        MOVE AL-UABON            TO BTERM1A
 24317        MOVE -1                  TO BTERM1L
 24318        MOVE  1                  TO SET-CURSOR-SW
 24319        GO TO 7499-EXIT.
 24320
 24321**2683**
 24322
 24323     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 24324        MOVE AL-UABON            TO BSKPCDA
 24325        MOVE -1                  TO BSKPCDL
 24326        MOVE  1                  TO SET-CURSOR-SW
 24327        GO TO 7499-EXIT.
 24328
 24329**2684**
 24330
 24331     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 24332        MOVE AL-UABON            TO BTYPE2A
 24333        MOVE -1                  TO BTYPE2L
 24334        MOVE  1                  TO SET-CURSOR-SW
 24335        GO TO 7499-EXIT.
 24336
 24337**2686**
 24338
 24339     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 24340        MOVE AL-UABON            TO BTYPE2A
 24341        MOVE -1                  TO BTYPE2L
 24342        MOVE  1                  TO SET-CURSOR-SW
 24343        GO TO 7499-EXIT.
 24344
 24345**2689**
 24346
 24347     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 24348        MOVE AL-UABON            TO BSIGA
 24349        MOVE -1                  TO BSIGL
 24350        MOVE  1                  TO SET-CURSOR-SW
 24351        GO TO 7499-EXIT.
 24352
 24353**2690**
 24354
 24355     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 24356        MOVE AL-UABOF            TO BLNOFCRA
 24357        MOVE -1                  TO BLNOFCRL
 24358        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 448
* EL6311.cbl
 24359        GO TO 7499-EXIT.
 24360
 24361**2693**
 24362
 24363     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 24364        MOVE AL-UABOF            TO BLNOFCRA
 24365        MOVE AL-UNBON            TO BBEN1A
 24366        MOVE -1                  TO BBEN1L
 24367        MOVE  1                  TO SET-CURSOR-SW
 24368        GO TO 7499-EXIT.
 24369
 24370**2720**
 24371
 24372     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 24373        MOVE AL-UNBON            TO BBEN1A
 24374        MOVE -1                  TO BBEN1L
 24375        MOVE  1                  TO SET-CURSOR-SW
 24376        GO TO 7499-EXIT.
 24377
 24378**2709**
 24379
 24380*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 24381*       MOVE AL-UNBON            TO BBEN1A
 24382*       MOVE -1                  TO BBEN1L
 24383*       MOVE  1                  TO SET-CURSOR-SW
 24384*       GO TO 7499-EXIT.
 24385
 24386*************************************************************
 24387*                                                           *
 24388*            C A N C E L   E R R O R S                      *
 24389*                                                           *
 24390*************************************************************
 24391
 24392**2726**
 24393
 24394     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 24395        MOVE AL-UABON            TO CCERTNOA
 24396        GO TO 7499-EXIT.
 24397
 24398**2728**
 24399
 24400     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 24401        MOVE AL-UABON            TO CCERTNOA
 24402        GO TO 7499-EXIT.
 24403
 24404**2729**
 24405
 24406     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24407        MOVE AL-UABON            TO CCERTNOA
 24408        GO TO 7499-EXIT.
 24409
 24410**2730**
 24411
 24412     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24413        MOVE AL-UABON            TO CCERTNOA
 24414        GO TO 7499-EXIT.
 24415
 24416**2731**
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 449
* EL6311.cbl
 24417
 24418     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 24419        MOVE AL-UABON            TO CCANDT1A
 24420        MOVE -1                  TO CCANDT1L
 24421        MOVE  1                  TO SET-CURSOR-SW
 24422        GO TO 7499-EXIT.
 24423
 24424**2732**
 24425
 24426     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
 24427        MOVE AL-UABON            TO CCANDT1A
 24428        MOVE -1                  TO CCANDT1L
 24429        MOVE  1                  TO SET-CURSOR-SW
 24430        GO TO 7499-EXIT.
 24431
 24432**2733**
 24433
 24434     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24435        MOVE AL-UABON            TO CCANDT1A
 24436        MOVE -1                  TO CCANDT1L
 24437        MOVE  1                  TO SET-CURSOR-SW
 24438        GO TO 7499-EXIT.
 24439
 24440**2734**
 24441
 24442     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24443        MOVE AL-UNBON            TO CREFND1A
 24444        MOVE -1                  TO CREFND1L
 24445        MOVE  1                  TO SET-CURSOR-SW
 24446        GO TO 7499-EXIT.
 24447
 24448**2735**
 24449
 24450     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24451        MOVE AL-UABON            TO CCANDT2A
 24452        MOVE -1                  TO CCANDT2L
 24453        MOVE  1                  TO SET-CURSOR-SW
 24454        GO TO 7499-EXIT.
 24455
 24456**2736**
 24457
 24458     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24459        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24460            MOVE AL-UNBON        TO CREFND1A
 24461            MOVE -1              TO CREFND1L
 24462            MOVE  1              TO SET-CURSOR-SW
 24463            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24464                MOVE AL-UNBON        TO CREFND2A
 24465                MOVE -1              TO CREFND2L
 24466                MOVE  1              TO SET-CURSOR-SW
 24467                GO TO 7499-EXIT
 24468            ELSE
 24469                GO TO 7499-EXIT
 24470        ELSE
 24471            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24472                MOVE AL-UNBON        TO CREFND2A
 24473                MOVE -1              TO CREFND2L
 24474                MOVE  1              TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 450
* EL6311.cbl
 24475                GO TO 7499-EXIT
 24476            ELSE
 24477                GO TO 7499-EXIT.
 24478
 24479**2738**
 24480
 24481     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24482        MOVE -1                  TO CREFND2L
 24483        MOVE  1                  TO SET-CURSOR-SW
 24484        GO TO 7499-EXIT.
 24485
 24486**2739**
 24487
 24488     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24489        MOVE -1                  TO CREFND1L
 24490        MOVE  1                  TO SET-CURSOR-SW
 24491        GO TO 7499-EXIT.
 24492
 24493**2741**
 24494
 24495     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24496        MOVE -1                  TO CREFND1L
 24497        MOVE  1                  TO SET-CURSOR-SW
 24498        GO TO 7499-EXIT.
 24499
 24500**2743**
 24501
 24502     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 24503        MOVE AL-UNBON            TO CCANDT1A
 24504        MOVE -1                  TO CCANDT1L
 24505        MOVE  1                  TO SET-CURSOR-SW
 24506        GO TO 7499-EXIT.
 24507
 24508**2744**
 24509
 24510     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 24511        MOVE AL-UNBON            TO CCANDT2A
 24512        MOVE -1                  TO CCANDT2L
 24513        MOVE  1                  TO SET-CURSOR-SW
 24514        GO TO 7499-EXIT.
 24515
 24516**2747**
 24517
 24518     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 24519        MOVE AL-UABON            TO CLSTNMA
 24520        MOVE -1                  TO CLSTNML
 24521        MOVE  1                  TO SET-CURSOR-SW
 24522        GO TO 7499-EXIT.
 24523
 24524**2749**
 24525
 24526     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 24527        MOVE AL-UABON            TO CFORCEA
 24528        MOVE -1                  TO CFORCEL
 24529        MOVE  1                  TO SET-CURSOR-SW
 24530        GO TO 7499-EXIT.
 24531
 24532**2753**
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 451
* EL6311.cbl
 24533
 24534     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 24535        MOVE AL-UNBON            TO CCANDT1A
 24536        MOVE -1                  TO CCANDT1L
 24537        MOVE  1                  TO SET-CURSOR-SW
 24538        GO TO 7499-EXIT.
 24539
 24540**2755**
 24541
 24542     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
 24543        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24544            MOVE AL-UNBON        TO CREFND1A
 24545            MOVE -1              TO CREFND1L
 24546            MOVE  1              TO SET-CURSOR-SW
 24547            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24548                MOVE AL-UNBON        TO CREFND2A
 24549                MOVE -1              TO CREFND2L
 24550                MOVE  1              TO SET-CURSOR-SW
 24551                GO TO 7499-EXIT
 24552            ELSE
 24553                GO TO 7499-EXIT
 24554        ELSE
 24555            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24556                MOVE AL-UNBON        TO CREFND2A
 24557                MOVE -1              TO CREFND2L
 24558                MOVE  1              TO SET-CURSOR-SW
 24559            ELSE
 24560                GO TO 7499-EXIT.
 24561
 24562**2757**
 24563
 24564     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24565        MOVE AL-UNBON            TO CLIVESA
 24566        MOVE -1                  TO CLIVESL
 24567        MOVE  1                  TO SET-CURSOR-SW
 24568        GO TO 7499-EXIT.
 24569
 24570**2771**
 24571
 24572     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24573        MOVE AL-UABON            TO CCANDT2A
 24574        MOVE -1                  TO CCANDT2L
 24575        MOVE  1                  TO SET-CURSOR-SW
 24576        GO TO 7499-EXIT.
 24577
 24578**2774**
 24579
 24580     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24581        MOVE AL-UABON            TO CCANDT1A
 24582        MOVE -1                  TO CCANDT1L
 24583        MOVE  1                  TO SET-CURSOR-SW
 24584        GO TO 7499-EXIT.
 24585
 24586**2775**
 24587
 24588     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24589        MOVE AL-UABON            TO CCANDT2A
 24590        MOVE -1                  TO CCANDT2L
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 452
* EL6311.cbl
 24591        MOVE  1                  TO SET-CURSOR-SW
 24592        GO TO 7499-EXIT.
 24593
 24594**2776**
 24595
 24596     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24597        MOVE AL-UABON            TO CCANDT1A
 24598        MOVE -1                  TO CCANDT1L
 24599        MOVE  1                  TO SET-CURSOR-SW
 24600        GO TO 7499-EXIT.
 24601
 24602
 24603**2777**
 24604
 24605     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24606        MOVE AL-UABON            TO CCANDT2A
 24607        MOVE -1                  TO CCANDT2L
 24608        MOVE  1                  TO SET-CURSOR-SW
 24609        GO TO 7499-EXIT.
 24610
 24611**2794**
 24612
 24613     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24614        MOVE AL-UABON            TO CFORCEA
 24615        MOVE -1                  TO CFORCEL
 24616        MOVE  1                  TO SET-CURSOR-SW
 24617        GO TO 7499-EXIT.
 24618
 24619**2799**
 24620
 24621     IF PI-COMPANY-ID = 'UCL'
 24622         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24623             MOVE AL-UNBON            TO BEFFDTA
 24624             MOVE -1                  TO BEFFDTL
 24625             MOVE  1                  TO SET-CURSOR-SW
 24626             GO TO 7499-EXIT.
 24627
 24628 7499-EXIT.
 24629      EXIT.
 24630
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 453
* EL6311.cbl
 24632
 24633 7500-READ-ERLOFC.
 24634     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24635                                     ERLOFC-KEY.
 24636
 24637     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24638
 24639     IF ST-ACCNT-CNTL
 24640         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24641
 24642     IF CARR-GROUP-ST-ACCNT-CNTL
 24643         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24644         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24645         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24646
 24647     IF CARR-ST-ACCNT-CNTL
 24648         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24649         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24650
 24651     IF CARR-ACCNT-CNTL
 24652         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24653
 24654     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24655
 24656     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24657
 24658
 24659* EXEC CICS HANDLE CONDITION
 24660*        NOTFND   (7550-OFFICER-NOTFND)
 24661*    END-EXEC.
 24662*    MOVE '"$I                   ! [ #00020707' TO DFHEIV0
 24663     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24664     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24665     MOVE X'5B20233030303230373037' TO DFHEIV0(25:11)
 24666     CALL 'kxdfhei1' USING DFHEIV0
 24667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24668
 24669
 24670
 24671* EXEC CICS READ
 24672*        DATASET   (FILE-ID-ERLOFC)
 24673*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24674*        RIDFLD    (ERLOFC-KEY)
 24675*        EQUAL
 24676*    END-EXEC.
 24677*    MOVE '&"S        E          (   #00020711' TO DFHEIV0
 24678     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24679     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24680     MOVE X'2020233030303230373131' TO DFHEIV0(25:11)
 24681     CALL 'kxdfhei1' USING DFHEIV0,
 24682           FILE-ID-ERLOFC,
 24683           DFHEIV20,
 24684           DFHEIV99,
 24685           ERLOFC-KEY,
 24686           DFHEIV99,
 24687           DFHEIV99,
 24688           DFHEIV99
 24689     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 454
* EL6311.cbl
 24690         DFHEIV20
 24691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24692
 24693
 24694     GO TO 7599-EXIT.
 24695
 24696 7550-OFFICER-NOTFND.
 24697     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24698
 24699 7599-EXIT.
 24700      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 455
* EL6311.cbl
 24702******************************************************************
 24703*                                                                *
 24704*            S  E N D    I N I T I A L   M A P                   *
 24705*                                                                *
 24706******************************************************************
 24707
 24708 8100-SEND-INITIAL-MAP.
 24709     MOVE EIBTIME                TO TIME-IN.
 24710
 24711     IF EIBAID = DFHPF11
 24712        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24713        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24714
 24715
 24716     IF PI-COMPANY-ID = CLIENT-GIC
 24717        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24718                                       BCPREM-ATTRB (2).
 24719
 24720     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24721                         CLIENT-PEM OR
 24722                         CLIENT-CSO)
 24723        AND PI-DISPLAY-ORIGINAL-BATCH
 24724          IF PI-MAP-NAME = EL631B
 24725             MOVE AL-SADOF               TO BPF5HDRA
 24726                                            BPF4HDRA
 24727          ELSE
 24728             IF PI-MAP-NAME = EL631C
 24729                MOVE AL-SADOF            TO CPF5HDRA
 24730                                            CPF4HDRA.
 24731
 24732     IF PI-MAP-NAME = EL631B
 24733        MOVE AL-SADOF               TO BPF5HDRA
 24734     ELSE
 24735        MOVE AL-SADOF               TO CPF5HDRA
 24736     END-IF
 24737
 24738*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24739     IF PI-MAP-NAME = EL631B
 24740          IF PI-COMPANY-ID NOT = 'DMD'
 24741             MOVE AL-SANOF            TO BBILLEDA
 24742             MOVE AL-SADOF            TO DMDBILA.
 24743*DMD CUSTOM CODING*************END
 24744
 24745     IF PI-PROCESSOR-ID = 'LGXX'
 24746        IF PI-MAP-NAME = EL631B
 24747           MOVE AL-SABOF                    TO BREFHDGA
 24748           MOVE AL-SANOF                    TO BREFA
 24749        ELSE
 24750           IF PI-MAP-NAME = EL631C
 24751              MOVE AL-SABOF                 TO CREFHDGA
 24752              MOVE AL-SANOF                 TO CREFA.
 24753
 24754     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 24755        continue
 24756     ELSE
 24757        IF PI-MAP-NAME = EL631C
 24758           MOVE AL-SADOF         TO CCANTXTA
 24759                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 456
* EL6311.cbl
 24760        end-if
 24761     end-if
 24762     IF PI-MAP-NAME = EL631D
 24763        IF PI-AR-PROCESSING
 24764           MOVE AL-SANOF            TO DREFHDGA
 24765        ELSE
 24766           MOVE AL-SADOF            TO DREFHDGA.
 24767
 24768     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 24769        AND (PI-MAP-NAME = EL631B)
 24770        MOVE AL-SADOF            TO BVINHA
 24771                                    BVINA
 24772     END-IF
 24773     IF PI-MAP-NAME = EL631B
 24774        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24775        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24776                                 TO BREGIONO
 24777        MOVE PI-PROCESSOR-ID     TO BUSERO
 24778        IF CSR-EDIT-SESSION
 24779           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24780                                 TO BHEADO
 24781           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24782        ELSE
 24783           MOVE AL-SADOF         TO BF15HDRA
 24784           MOVE '4=B-HDR      '  TO BPF4HDRO
 24785        END-IF
 24786        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24787        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24788        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24789        MOVE WS-CURRENT-DT          TO BDATEO
 24790        MOVE TIME-OUT               TO BTIMEO
 24791        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24792        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24793        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24794        IF   WS-DISPLAY-SCREEN
 24795             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24796             MOVE PB-SV-CARRIER     TO BCARRO
 24797             MOVE PB-SV-GROUPING    TO BGROUPO
 24798             MOVE PB-SV-STATE       TO BSTATEO
 24799             MOVE PB-ACCOUNT        TO BACCTO
 24800        ELSE
 24801             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24802     ELSE
 24803        IF PI-MAP-NAME = EL631C
 24804           MOVE '4=B-HDR      '     TO CPF4HDRO
 24805           IF CSR-EDIT-SESSION
 24806              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24807                                 TO CHEADO
 24808           ELSE
 24809              MOVE AL-SADOF      TO CF15HDRA
 24810           END-IF
 24811           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24812           MOVE WS-CURRENT-DT          TO CDATEO
 24813           MOVE TIME-OUT               TO CTIMEO
 24814           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24815           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24816           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24817           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 457
* EL6311.cbl
 24818           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24819           MOVE WS-C-HDG               TO CAHHDGO
 24820           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24821           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24822           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24823           IF   WS-DISPLAY-SCREEN
 24824                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24825                MOVE PB-SV-CARRIER     TO CCARRO
 24826                MOVE PB-SV-GROUPING    TO CGROUPO
 24827                MOVE PB-SV-STATE       TO CSTATEO
 24828                MOVE PB-ACCOUNT        TO CACCTO
 24829           ELSE
 24830                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24831        ELSE
 24832           MOVE WS-CURRENT-DT          TO DDATEO
 24833           MOVE TIME-OUT               TO DTIMEO
 24834           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24835                                          WS-REFUND-HDG-OVERRIDE
 24836           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24837           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24838           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24839                                          WS-REFUND-HDG-OVERRIDE
 24840           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24841           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24842           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24843           IF CSR-EDIT-SESSION
 24844              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24845                                 TO DHEADO
 24846           END-IF
 24847           IF  WS-DISPLAY-SCREEN
 24848               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24849               MOVE PB-CARRIER         TO DCARRO
 24850               MOVE PB-GROUPING        TO DGROUPO
 24851               MOVE PB-STATE           TO DSTATEO
 24852               MOVE PB-ACCOUNT         TO DACCTO
 24853               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24854           ELSE
 24855               MOVE EL631D             TO PI-MAP-NAME
 24856               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24857               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24858
 24859     MOVE SPACE                        TO WS-DISPLAY-SW.
 24860
 24861
 24862* EXEC CICS SEND
 24863*        MAP      (PI-MAP-NAME)
 24864*        MAPSET   (MAPSET-EL6311S)
 24865*        FROM     (EL631BI)
 24866*        ERASE
 24867*        CURSOR
 24868*    END-EXEC.
 24869     MOVE LENGTH OF
 24870      EL631BI
 24871       TO DFHEIV12
 24872     MOVE -1
 24873       TO DFHEIV11
 24874*    MOVE '8$     CT  E    H L F ,   #00020885' TO DFHEIV0
 24875     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 458
* EL6311.cbl
 24876     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24877     MOVE X'2020233030303230383835' TO DFHEIV0(25:11)
 24878     CALL 'kxdfhei1' USING DFHEIV0,
 24879           PI-MAP-NAME,
 24880           EL631BI,
 24881           DFHEIV12,
 24882           MAPSET-EL6311S,
 24883           DFHEIV99,
 24884           DFHEIV99,
 24885           DFHEIV99,
 24886           DFHEIV11,
 24887           DFHEIV99,
 24888           DFHEIV99,
 24889           DFHEIV99
 24890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24891
 24892
 24893     GO TO 9100-RETURN-TRAN.
 24894
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 459
* EL6311.cbl
 24896
 24897******************************************************************
 24898*                                                                *
 24899*              S E N D    D A T A O N L Y                        *
 24900*                                                                *
 24901******************************************************************
 24902
 24903 8200-SEND-DATAONLY.
 24904     MOVE EIBTIME                TO TIME-IN.
 24905
 24906     IF PI-COMPANY-ID = CLIENT-GIC
 24907        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24908                                       BCPREM-ATTRB (2).
 24909
 24910     IF PI-MAP-NAME = EL631B
 24911        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24912        MOVE WS-CURRENT-DT          TO BDATEO
 24913        MOVE TIME-OUT               TO BTIMEO
 24914        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24915        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24916        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24917        MOVE SPACES                 TO BPFENTRO
 24918        MOVE AL-UANOF               TO BPFENTRA
 24919
 24920*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24921        IF PI-COMPANY-ID NOT = 'DMD'
 24922             MOVE AL-SANOF            TO BBILLEDA
 24923             MOVE AL-SADOF            TO DMDBILA
 24924         ELSE
 24925            NEXT SENTENCE
 24926*DMD CUSTOM CODING*************END
 24927     ELSE
 24928        IF PI-MAP-NAME = EL631C
 24929           MOVE WS-CURRENT-DT          TO CDATEO
 24930           MOVE TIME-OUT               TO CTIMEO
 24931           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24932           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24933           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24934           MOVE SPACES                 TO CPFENTRO
 24935           MOVE AL-UANOF               TO CPFENTRA
 24936        ELSE
 24937           MOVE WS-CURRENT-DT          TO DDATEO
 24938           MOVE TIME-OUT               TO DTIMEO
 24939           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24940
 24941
 24942* EXEC CICS SEND
 24943*        MAP      (PI-MAP-NAME)
 24944*        MAPSET   (MAPSET-EL6311S)
 24945*        FROM     (EL631BI)
 24946*        DATAONLY
 24947*        CURSOR
 24948*    END-EXEC.
 24949     MOVE LENGTH OF
 24950      EL631BI
 24951       TO DFHEIV12
 24952     MOVE -1
 24953       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 460
* EL6311.cbl
 24954*    MOVE '8$D    CT       H L F ,   #00020941' TO DFHEIV0
 24955     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24956     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24957     MOVE X'2020233030303230393431' TO DFHEIV0(25:11)
 24958     CALL 'kxdfhei1' USING DFHEIV0,
 24959           PI-MAP-NAME,
 24960           EL631BI,
 24961           DFHEIV12,
 24962           MAPSET-EL6311S,
 24963           DFHEIV99,
 24964           DFHEIV99,
 24965           DFHEIV99,
 24966           DFHEIV11,
 24967           DFHEIV99,
 24968           DFHEIV99,
 24969           DFHEIV99
 24970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24971
 24972
 24973     GO TO 9100-RETURN-TRAN.
 24974
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 461
* EL6311.cbl
 24976
 24977******************************************************************
 24978*                                                                *
 24979*           U T I L I T Y   R O U T I N E S                      *
 24980*                                                                *
 24981******************************************************************
 24982
 24983 8300-SEND-TEXT.
 24984
 24985* EXEC CICS SEND TEXT
 24986*        FROM     (LOGOFF-TEXT)
 24987*        LENGTH   (LOGOFF-LENGTH)
 24988*        ERASE
 24989*        FREEKB
 24990*    END-EXEC.
 24991*    MOVE '8&      T  E F  H   F -   #00020960' TO DFHEIV0
 24992     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24993     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24994     MOVE X'2020233030303230393630' TO DFHEIV0(25:11)
 24995     CALL 'kxdfhei1' USING DFHEIV0,
 24996           LOGOFF-TEXT,
 24997           LOGOFF-LENGTH,
 24998           DFHEIV99,
 24999           DFHEIV99,
 25000           DFHEIV99,
 25001           DFHEIV99,
 25002           DFHEIV99,
 25003           DFHEIV99,
 25004           DFHEIV99,
 25005           DFHEIV99,
 25006           DFHEIV99,
 25007           DFHEIV99
 25008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25009
 25010
 25011
 25012* EXEC CICS RETURN
 25013*    END-EXEC.
 25014*    MOVE '.(                    ''   #00020967' TO DFHEIV0
 25015     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 25016     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 25017     MOVE X'2020233030303230393637' TO DFHEIV0(25:11)
 25018     CALL 'kxdfhei1' USING DFHEIV0,
 25019           DFHEIV99,
 25020           DFHEIV99,
 25021           DFHEIV99,
 25022           DFHEIV99,
 25023           DFHEIV99,
 25024           DFHEIV99
 25025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25026
 25027
 25028 8400-LOG-JOURNAL-RECORD.
 25029     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 25030     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 25031
 25032*    EXEC CICS JOURNAL
 25033*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 462
* EL6311.cbl
 25034*        JTYPEID     ('EL')
 25035*        FROM        (JOURNAL-RECORD)
 25036*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 25037*    END-EXEC.
 25038
 25039 8600-DEEDIT.
 25040
 25041* EXEC CICS BIF DEEDIT
 25042*         FIELD   (DEEDIT-FIELD)
 25043*         LENGTH  (15)
 25044*    END-EXEC.
 25045     MOVE 15
 25046       TO DFHEIV11
 25047*    MOVE '@"L                   #   #00020982' TO DFHEIV0
 25048     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 25049     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 25050     MOVE X'2020233030303230393832' TO DFHEIV0(25:11)
 25051     CALL 'kxdfhei1' USING DFHEIV0,
 25052           DEEDIT-FIELD,
 25053           DFHEIV11
 25054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25055
 25056
 25057 8800-UNAUTHORIZED-ACCESS.
 25058     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 25059     GO TO 8300-SEND-TEXT.
 25060
 25061 8810-PF23.
 25062     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 25063     MOVE XCTL-EL005             TO PGM-NAME.
 25064     GO TO 9300-XCTL.
 25065
 25066 9100-RETURN-TRAN.
 25067     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 25068
 25069     IF  PI-MAP-NAME =  EL631B
 25070         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 25071
 25072     IF  PI-MAP-NAME =  EL631C
 25073         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 25074
 25075     IF  PI-MAP-NAME =  EL631D
 25076         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 25077
 25078
 25079* EXEC CICS RETURN
 25080*        TRANSID    (TRANS-EXB1)
 25081*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 25082*        LENGTH     (1300)
 25083*    END-EXEC.
 25084     MOVE 1300
 25085       TO DFHEIV11
 25086*    MOVE '.(CT                  ''   #00021008' TO DFHEIV0
 25087     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 25088     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 25089     MOVE X'2020233030303231303038' TO DFHEIV0(25:11)
 25090     CALL 'kxdfhei1' USING DFHEIV0,
 25091           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 463
* EL6311.cbl
 25092           PROGRAM-INTERFACE-BLOCK,
 25093           DFHEIV11,
 25094           DFHEIV99,
 25095           DFHEIV99,
 25096           DFHEIV99
 25097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25098
 25099
 25100 9200-RETURN-MAIN-MENU.
 25101     MOVE XCTL-EL626             TO PGM-NAME.
 25102     GO TO 9300-XCTL.
 25103
 25104 9300-XCTL.
 25105
 25106* EXEC CICS XCTL
 25107*        PROGRAM    (PGM-NAME)
 25108*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 25109*        LENGTH     (PI-COMM-LENGTH)
 25110*    END-EXEC.
 25111*    MOVE '.$C                   %   #00021019' TO DFHEIV0
 25112     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 25113     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 25114     MOVE X'2020233030303231303139' TO DFHEIV0(25:11)
 25115     CALL 'kxdfhei1' USING DFHEIV0,
 25116           PGM-NAME,
 25117           PROGRAM-INTERFACE-BLOCK,
 25118           PI-COMM-LENGTH,
 25119           DFHEIV99
 25120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25121
 25122
 25123 9400-CLEAR.
 25124     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 25125     GO TO 9300-XCTL.
 25126
 25127 9500-PF12.
 25128     MOVE XCTL-EL010             TO PGM-NAME.
 25129     GO TO 9300-XCTL.
 25130
 25131 9600-PGMID-ERROR.
 25132
 25133* EXEC CICS HANDLE CONDITION
 25134*        PGMIDERR    (8300-SEND-TEXT)
 25135*    END-EXEC.
 25136*    MOVE '"$L                   ! \ #00021034' TO DFHEIV0
 25137     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 25138     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 25139     MOVE X'5C20233030303231303334' TO DFHEIV0(25:11)
 25140     CALL 'kxdfhei1' USING DFHEIV0
 25141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25142
 25143
 25144     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 25145     MOVE ' '                    TO PI-ENTRY-CD-1.
 25146     MOVE XCTL-EL005             TO PGM-NAME.
 25147     MOVE PGM-NAME               TO LOGOFF-PGM.
 25148     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 25149     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 464
* EL6311.cbl
 25150
 25151 9700-DATE-LINK.
 25152     MOVE LINK-ELDATCV           TO PGM-NAME.
 25153
 25154* EXEC CICS LINK
 25155*        PROGRAM    (PGM-NAME)
 25156*        COMMAREA   (DATE-CONVERSION-DATA)
 25157*        LENGTH     (DC-COMM-LENGTH)
 25158*    END-EXEC.
 25159*    MOVE '."C                   (   #00021047' TO DFHEIV0
 25160     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25162     MOVE X'2020233030303231303437' TO DFHEIV0(25:11)
 25163     CALL 'kxdfhei1' USING DFHEIV0,
 25164           PGM-NAME,
 25165           DATE-CONVERSION-DATA,
 25166           DC-COMM-LENGTH,
 25167           DFHEIV99,
 25168           DFHEIV99,
 25169           DFHEIV99,
 25170           DFHEIV99
 25171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25172
 25173
 25174 9800-LINK-PENDING-EDIT.
 25175     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 25176     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 25177
 25178     MOVE LINK-EL050             TO PGM-NAME
 25179     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 25180     MOVE ZEROS                  TO WK-CO-MAX-CAP
 25181                                    WK-CO-TOL-CLAIM
 25182                                    WK-CO-TOL-PREM
 25183                                    WK-CO-TOL-REFUND
 25184                                    WK-CO-TOL-PREM-PCT
 25185                                    WK-CO-TOL-REFUND-PCT
 25186                                    WK-REFUND-OVS-AMT
 25187                                    WK-REFUND-OVS-PCT
 25188                                    WK-ACCT-ADDR
 25189                                    WK-LIFE-EDIT-ADDR
 25190                                    WK-AH-EDIT-ADDR
 25191                                    WK-LIFE-BEN-ADDR
 25192                                    WK-AH-BEN-ADDR
 25193                                    WK-STATE-ADDR
 25194                                    WK-PLAN-ADDR
 25195                                    WK-FORM-ADDR
 25196     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 25197
 25198     MOVE '6'                    TO WK-ENTRY-SW.
 25199
 25200     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 25201
 25202     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 25203                                    EC-AM-EXPIRATION-DT
 25204                                    EC-AM-EFFECTIVE-DT
 25205                                    EC-CM-LF-CANCEL-DT
 25206                                    EC-CM-AH-CANCEL-DT
 25207                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 465
* EL6311.cbl
 25208
 25209     MOVE ZEROS                  TO EC-CO-TOL-PREM
 25210                                    EC-CO-TOL-REFUND
 25211                                    EC-CO-MIN-AGE
 25212                                    EC-CO-MIN-PREMIUM
 25213                                    EC-CO-MIN-TERM
 25214                                    EC-CO-MAX-TERM
 25215                                    EC-ST-TOL-PREM
 25216                                    EC-ST-TOL-REFUND
 25217                                    EC-AM-LF-TOL-PREM
 25218                                    EC-AM-AH-TOL-PREM
 25219                                    EC-AM-LF-MAX-ATT-AGE
 25220                                    EC-AM-LF-MAX-AGE
 25221                                    EC-AM-LF-MAX-TERM
 25222                                    EC-AM-LF-MAX-TOT-BEN
 25223                                    EC-AM-AH-MAX-ATT-AGE
 25224                                    EC-AM-AH-MAX-AGE
 25225                                    EC-AM-AH-MAX-TERM
 25226                                    EC-AM-AH-MAX-TOT-BEN
 25227                                    EC-AM-AH-MAX-MON-BEN
 25228                                    EC-RT-LF-MAX-ATT-AGE
 25229                                    EC-RT-LF-MAX-AGE
 25230                                    EC-RT-LF-MAX-TERM
 25231                                    EC-RT-LF-MAX-TOT-BEN
 25232                                    EC-RT-AH-MAX-ATT-AGE
 25233                                    EC-RT-AH-MAX-AGE
 25234                                    EC-RT-AH-MAX-TERM
 25235                                    EC-RT-AH-MAX-TOT-BEN
 25236                                    EC-RT-AH-MAX-MON-BEN
 25237                                    EC-RT-AH-RATE
 25238                                    EC-RT-LF-RATE
 25239                                    EC-RT-LF-NSP-RATE
 25240                                    EC-RT-AH-NSP-RATE
 25241                                    EC-CM-LF-PRIOR-REFUND
 25242                                    EC-CM-AH-PRIOR-REFUND.
 25243
 25244     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 25245                                    EC-ST-TOL-PREM-PCT
 25246                                    EC-AM-LF-TOL-REFUND
 25247                                    EC-AM-LF-DEV-PERCENT
 25248                                    EC-CO-TOL-REFUND-PCT
 25249                                    EC-ST-TOL-REFUND-PCT
 25250                                    EC-AM-AH-TOL-REFUND
 25251                                    EC-AM-AH-DEV-PERCENT.
 25252
 25253
 25254* EXEC CICS LINK
 25255*         PROGRAM   (PGM-NAME)
 25256*         COMMAREA  (PASSED-RECORD)
 25257*         LENGTH    (WS-EDIT-PASS-LENGTH)
 25258*    END-EXEC.
 25259*    MOVE '."C                   (   #00021132' TO DFHEIV0
 25260     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25261     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25262     MOVE X'2020233030303231313332' TO DFHEIV0(25:11)
 25263     CALL 'kxdfhei1' USING DFHEIV0,
 25264           PGM-NAME,
 25265           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 466
* EL6311.cbl
 25266           WS-EDIT-PASS-LENGTH,
 25267           DFHEIV99,
 25268           DFHEIV99,
 25269           DFHEIV99,
 25270           DFHEIV99
 25271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25272
 25273
 25274     MOVE '1'                    TO PI-EDIT-SW.
 25275     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 25276
 25277     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 25278
 25279     IF PI-COMPANY-ID = 'UCL'
 25280         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 25281
 25282     IF VALID-PB-ID
 25283        GO TO 9800-EXIT.
 25284
 25285     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 25286
 25287     IF PI-MAP-NAME = EL631B
 25288        MOVE -1                  TO BMAINTL
 25289       ELSE
 25290        MOVE -1                  TO CMAINTL.
 25291
 25292     GO TO 8200-SEND-DATAONLY.
 25293
 25294 9800-EXIT.
 25295      EXIT.
 25296
 25297 9900-ERROR-FORMAT.
 25298
 25299     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 25300
 25301     IF NOT EMI-ERRORS-COMPLETE
 25302         MOVE LINK-EL001         TO PGM-NAME
 25303
 25304* EXEC CICS LINK
 25305*            PROGRAM    (PGM-NAME)
 25306*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 25307*            LENGTH     (EMI-COMM-LENGTH)
 25308*        END-EXEC.
 25309*    MOVE '."C                   (   #00021167' TO DFHEIV0
 25310     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25311     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25312     MOVE X'2020233030303231313637' TO DFHEIV0(25:11)
 25313     CALL 'kxdfhei1' USING DFHEIV0,
 25314           PGM-NAME,
 25315           ERROR-MESSAGE-INTERFACE-BLOCK,
 25316           EMI-COMM-LENGTH,
 25317           DFHEIV99,
 25318           DFHEIV99,
 25319           DFHEIV99,
 25320           DFHEIV99
 25321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25322
 25323
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 467
* EL6311.cbl
 25324 9900-EXIT.
 25325     EXIT.
 25326
 25327 9990-ABEND.
 25328     MOVE LINK-EL004             TO PGM-NAME.
 25329     MOVE DFHEIBLK               TO EMI-LINE1.
 25330
 25331* EXEC CICS LINK
 25332*        PROGRAM   (PGM-NAME)
 25333*        COMMAREA  (EMI-LINE1)
 25334*        LENGTH    (72)
 25335*    END-EXEC.
 25336     MOVE 72
 25337       TO DFHEIV11
 25338*    MOVE '."C                   (   #00021179' TO DFHEIV0
 25339     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25340     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25341     MOVE X'2020233030303231313739' TO DFHEIV0(25:11)
 25342     CALL 'kxdfhei1' USING DFHEIV0,
 25343           PGM-NAME,
 25344           EMI-LINE1,
 25345           DFHEIV11,
 25346           DFHEIV99,
 25347           DFHEIV99,
 25348           DFHEIV99,
 25349           DFHEIV99
 25350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25351
 25352
 25353     IF PI-MAP-NAME = EL631B
 25354        MOVE -1                  TO BMAINTL
 25355       ELSE
 25356        MOVE -1                  TO CMAINTL.
 25357
 25358     IF EIBTRNID NOT = TRANS-EXB1
 25359        GO TO 8100-SEND-INITIAL-MAP
 25360       ELSE
 25361        GO TO 8200-SEND-DATAONLY.
 25362
 25363 9995-SECURITY-VIOLATION.
 25364*                            COPY ELCSCTP.
 25365******************************************************************
 25366*                                                                *
 25367*                            ELCSCTP                             *
 25368*                            VMOD=2.001                          *
 25369*                                                                *
 25370*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 25371******************************************************************
 25372
 25373
 25374     MOVE EIBDATE          TO SM-JUL-DATE.
 25375     MOVE EIBTRMID         TO SM-TERMID.
 25376     MOVE THIS-PGM         TO SM-PGM.
 25377     MOVE EIBTIME          TO TIME-IN.
 25378     MOVE TIME-OUT         TO SM-TIME.
 25379     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 25380
 25381
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 468
* EL6311.cbl
 25382* EXEC CICS LINK
 25383*         PROGRAM  ('EL003')
 25384*         COMMAREA (SECURITY-MESSAGE)
 25385*         LENGTH   (80)
 25386*    END-EXEC.
 25387     MOVE 'EL003' TO DFHEIV1
 25388     MOVE 80
 25389       TO DFHEIV11
 25390*    MOVE '."C                   (   #00021213' TO DFHEIV0
 25391     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25392     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25393     MOVE X'2020233030303231323133' TO DFHEIV0(25:11)
 25394     CALL 'kxdfhei1' USING DFHEIV0,
 25395           DFHEIV1,
 25396           SECURITY-MESSAGE,
 25397           DFHEIV11,
 25398           DFHEIV99,
 25399           DFHEIV99,
 25400           DFHEIV99,
 25401           DFHEIV99
 25402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25403
 25404
 25405******************************************************************
 25406
 25407
 25408 9999-DFHBACK SECTION.
 25409     MOVE '9%                    "   ' TO DFHEIV0
 25410     MOVE 'EL6311' TO DFHEIV1
 25411     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25412     GOBACK.
 25413 9999-DFHEXIT.
 25414     IF DFHEIGDJ EQUAL 0001
 25415         NEXT SENTENCE
 25416     ELSE IF DFHEIGDJ EQUAL 2
 25417         GO TO 9600-PGMID-ERROR,
 25418               9990-ABEND,
 25419               9990-ABEND,
 25420               0010-MAIN-LOGIC
 25421         DEPENDING ON DFHEIGDI
 25422     ELSE IF DFHEIGDJ EQUAL 3
 25423         GO TO 1280-BATCH-HDR-NOT-FOUND
 25424         DEPENDING ON DFHEIGDI
 25425     ELSE IF DFHEIGDJ EQUAL 4
 25426         GO TO 1290-DUPLICATE-ALT-INDEX
 25427         DEPENDING ON DFHEIGDI
 25428     ELSE IF DFHEIGDJ EQUAL 5
 25429         GO TO 1295-CERT-TRL-REC-NOTFND
 25430         DEPENDING ON DFHEIGDI
 25431     ELSE IF DFHEIGDJ EQUAL 6
 25432         GO TO 1380-BATCH-HDR-NOT-FOUND
 25433         DEPENDING ON DFHEIGDI
 25434     ELSE IF DFHEIGDJ EQUAL 7
 25435         GO TO 1385-REC-NOT-FOUND
 25436         DEPENDING ON DFHEIGDI
 25437     ELSE IF DFHEIGDJ EQUAL 8
 25438         GO TO 1386-NOTFND
 25439         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 469
* EL6311.cbl
 25440     ELSE IF DFHEIGDJ EQUAL 9
 25441         GO TO 1399-EXIT
 25442         DEPENDING ON DFHEIGDI
 25443     ELSE IF DFHEIGDJ EQUAL 10
 25444         GO TO 1480-BATCH-HDR-NOT-FOUND
 25445         DEPENDING ON DFHEIGDI
 25446     ELSE IF DFHEIGDJ EQUAL 11
 25447         GO TO 1490-RECORD-NOT-FOUND
 25448         DEPENDING ON DFHEIGDI
 25449     ELSE IF DFHEIGDJ EQUAL 12
 25450         GO TO 1405-DELETE-CERTIFICATE
 25451         DEPENDING ON DFHEIGDI
 25452     ELSE IF DFHEIGDJ EQUAL 13
 25453         GO TO 1420-CONTINUE-DELETE
 25454         DEPENDING ON DFHEIGDI
 25455     ELSE IF DFHEIGDJ EQUAL 14
 25456         GO TO 1406-DELETE-ERNOTE
 25457         DEPENDING ON DFHEIGDI
 25458     ELSE IF DFHEIGDJ EQUAL 15
 25459         GO TO 1407-DELETE-MAILING
 25460         DEPENDING ON DFHEIGDI
 25461     ELSE IF DFHEIGDJ EQUAL 16
 25462         GO TO 1420-CONTINUE-DELETE
 25463         DEPENDING ON DFHEIGDI
 25464     ELSE IF DFHEIGDJ EQUAL 17
 25465         GO TO 1480-BATCH-HDR-NOT-FOUND
 25466         DEPENDING ON DFHEIGDI
 25467     ELSE IF DFHEIGDJ EQUAL 18
 25468         GO TO 1475-DELETE-FINISHED
 25469         DEPENDING ON DFHEIGDI
 25470     ELSE IF DFHEIGDJ EQUAL 19
 25471         GO TO 2280-BATCH-HDR-NOT-FOUND
 25472         DEPENDING ON DFHEIGDI
 25473     ELSE IF DFHEIGDJ EQUAL 20
 25474         GO TO 2290-DUPLICATE-ALT-INDEX
 25475         DEPENDING ON DFHEIGDI
 25476     ELSE IF DFHEIGDJ EQUAL 21
 25477         GO TO 2380-BATCH-HDR-NOT-FOUND
 25478         DEPENDING ON DFHEIGDI
 25479     ELSE IF DFHEIGDJ EQUAL 22
 25480         GO TO 2385-REC-NOT-FOUND
 25481         DEPENDING ON DFHEIGDI
 25482     ELSE IF DFHEIGDJ EQUAL 23
 25483         GO TO 2380-BATCH-HDR-NOT-FOUND
 25484         DEPENDING ON DFHEIGDI
 25485     ELSE IF DFHEIGDJ EQUAL 24
 25486         GO TO 2485-BATCH-HDR-NOT-FOUND
 25487         DEPENDING ON DFHEIGDI
 25488     ELSE IF DFHEIGDJ EQUAL 25
 25489         GO TO 2490-RECORD-NOT-FOUND
 25490         DEPENDING ON DFHEIGDI
 25491     ELSE IF DFHEIGDJ EQUAL 26
 25492         GO TO 2475-CONTINUE-DELETE
 25493         DEPENDING ON DFHEIGDI
 25494     ELSE IF DFHEIGDJ EQUAL 27
 25495         GO TO 2485-BATCH-HDR-NOT-FOUND
 25496         DEPENDING ON DFHEIGDI
 25497     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 470
* EL6311.cbl
 25498         GO TO 2480-DELETE-FINISHED
 25499         DEPENDING ON DFHEIGDI
 25500     ELSE IF DFHEIGDJ EQUAL 29
 25501         GO TO 2820-PROCESS-REWRITE
 25502         DEPENDING ON DFHEIGDI
 25503     ELSE IF DFHEIGDJ EQUAL 30
 25504         GO TO 2885-RECORD-MISSING
 25505         DEPENDING ON DFHEIGDI
 25506     ELSE IF DFHEIGDJ EQUAL 31
 25507         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 25508         DEPENDING ON DFHEIGDI
 25509     ELSE IF DFHEIGDJ EQUAL 32
 25510         GO TO 2827-DELETE-MAILING
 25511         DEPENDING ON DFHEIGDI
 25512     ELSE IF DFHEIGDJ EQUAL 33
 25513         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 25514         DEPENDING ON DFHEIGDI
 25515     ELSE IF DFHEIGDJ EQUAL 34
 25516         GO TO 2920-PROCESS-REWRITE
 25517         DEPENDING ON DFHEIGDI
 25518     ELSE IF DFHEIGDJ EQUAL 35
 25519         GO TO 2985-RECORD-MISSING
 25520         DEPENDING ON DFHEIGDI
 25521     ELSE IF DFHEIGDJ EQUAL 36
 25522         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 25523         DEPENDING ON DFHEIGDI
 25524     ELSE IF DFHEIGDJ EQUAL 37
 25525         GO TO 2990-DUPLICATE-RECORD
 25526         DEPENDING ON DFHEIGDI
 25527     ELSE IF DFHEIGDJ EQUAL 38
 25528         GO TO 3590-NOT-FOUND
 25529         DEPENDING ON DFHEIGDI
 25530     ELSE IF DFHEIGDJ EQUAL 39
 25531         GO TO 3690-NOT-FOUND
 25532         DEPENDING ON DFHEIGDI
 25533     ELSE IF DFHEIGDJ EQUAL 40
 25534         GO TO 3990-NOT-FOUND
 25535         DEPENDING ON DFHEIGDI
 25536     ELSE IF DFHEIGDJ EQUAL 41
 25537         GO TO 4050-END-RECORDS,
 25538               4050-END-RECORDS
 25539         DEPENDING ON DFHEIGDI
 25540     ELSE IF DFHEIGDJ EQUAL 42
 25541         GO TO 4150-END-BATCH
 25542         DEPENDING ON DFHEIGDI
 25543     ELSE IF DFHEIGDJ EQUAL 43
 25544         GO TO 4150-END-BATCH
 25545         DEPENDING ON DFHEIGDI
 25546     ELSE IF DFHEIGDJ EQUAL 44
 25547         GO TO 4250-END-RECORDS,
 25548               4250-END-RECORDS
 25549         DEPENDING ON DFHEIGDI
 25550     ELSE IF DFHEIGDJ EQUAL 45
 25551         GO TO 4350-END-BATCH,
 25552               4350-END-BATCH
 25553         DEPENDING ON DFHEIGDI
 25554     ELSE IF DFHEIGDJ EQUAL 46
 25555         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:03 Page 471
* EL6311.cbl
 25556               4550-END-RECORDS
 25557         DEPENDING ON DFHEIGDI
 25558     ELSE IF DFHEIGDJ EQUAL 47
 25559         GO TO 4680-NOT-FOUND,
 25560               4680-NOT-FOUND
 25561         DEPENDING ON DFHEIGDI
 25562     ELSE IF DFHEIGDJ EQUAL 48
 25563         GO TO 4860-NOT-FOUND,
 25564               4850-END-RECORDS
 25565         DEPENDING ON DFHEIGDI
 25566     ELSE IF DFHEIGDJ EQUAL 49
 25567         GO TO 4970-NOT-FOUND,
 25568               4950-END-RECORDS
 25569         DEPENDING ON DFHEIGDI
 25570     ELSE IF DFHEIGDJ EQUAL 50
 25571         GO TO 5050-NOT-FOUND
 25572         DEPENDING ON DFHEIGDI
 25573     ELSE IF DFHEIGDJ EQUAL 51
 25574         GO TO 5050-NOT-FOUND
 25575         DEPENDING ON DFHEIGDI
 25576     ELSE IF DFHEIGDJ EQUAL 52
 25577         GO TO 5050-NOT-FOUND
 25578         DEPENDING ON DFHEIGDI
 25579     ELSE IF DFHEIGDJ EQUAL 53
 25580         GO TO 5550-END-RECORDS,
 25581               5550-END-RECORDS
 25582         DEPENDING ON DFHEIGDI
 25583     ELSE IF DFHEIGDJ EQUAL 54
 25584         GO TO 6050-QID-ERROR
 25585         DEPENDING ON DFHEIGDI
 25586     ELSE IF DFHEIGDJ EQUAL 55
 25587         GO TO 6050-QID-ERROR
 25588         DEPENDING ON DFHEIGDI
 25589     ELSE IF DFHEIGDJ EQUAL 56
 25590         GO TO 6400-CONTINUE,
 25591               6400-CONTINUE
 25592         DEPENDING ON DFHEIGDI
 25593     ELSE IF DFHEIGDJ EQUAL 57
 25594         GO TO 3690-NOT-FOUND
 25595         DEPENDING ON DFHEIGDI
 25596     ELSE IF DFHEIGDJ EQUAL 58
 25597         GO TO 7399-EXIT
 25598         DEPENDING ON DFHEIGDI
 25599     ELSE IF DFHEIGDJ EQUAL 59
 25600         GO TO 7550-OFFICER-NOTFND
 25601         DEPENDING ON DFHEIGDI
 25602     ELSE IF DFHEIGDJ EQUAL 60
 25603         GO TO 8300-SEND-TEXT
 25604         DEPENDING ON DFHEIGDI.
 25605     MOVE '9%                    "   ' TO DFHEIV0
 25606     MOVE 'EL6311' TO DFHEIV1
 25607     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25608     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16364     Code:      101463
