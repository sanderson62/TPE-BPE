* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING
    61* 012016  IR2016011800003  PEMA  FIXED LENGTH OF PAYEE NAME
    62* 050616  CR2015030200004  TANA  Additional pmt Pd thru exp date
    63* 013017  CR2016053100001  PEMA  ACH PROCESSING
    64* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    65* 102617    2017101800003  TANA  Fix family leave auth level
    66* 022718    2017100200004  TANA  Set hold & pays > than 30 days
    67* 031218    2018030800002  TANA  Handle offline pmts w/ hold & pay
    68* 082218  CR2018051400001  TANA  Hold and Pay
    69* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    70* 112018  CR2018102900001  TANA  REQUIRE EOB NOTE STARTING WITH F
    71* 040819  IR2019030400004  TANA  ADD EDITS FOR HOLD AND PAY
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page   3
* EL156.cbl
    72******************************************************************
    73
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page   4
* EL156.cbl
    75 ENVIRONMENT DIVISION.
    76
    77 DATA DIVISION.
    78
    79 WORKING-STORAGE SECTION.
    80 01  DFH-START PIC X(04).
    81
    82 77  FILLER  PIC X(32)  VALUE '********************************'.
    83 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    84 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    85 77  WS-SSN  PIC X(9) VALUE ZEROS.
    86 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    87 77  C0                          PIC S999 COMP-3 VALUE +0.
    88 77  C1                          PIC S999 COMP-3 VALUE +0.
    89 77  C2                          PIC S999 COMP-3 VALUE +0.
    90 77  C3                          PIC S999 COMP-3 VALUE +0.
    91 77  s1                          PIC S999 COMP-3 VALUE +0.
    92 77  s2                          pic s999 comp-3 value +0.
    93 77  P1                          PIC S999 COMP-3 VALUE +0.
    94 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    95 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    96 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    97 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    98 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    99 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   100 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   101 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   102 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
   103 77  ws-max-bens                 pic s999 comp-3 value +0.
   104 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
   105 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
   106 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
   107 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
   108 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
   109 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
   110
   111*    COPY ELCSCTM.
   112******************************************************************
   113*                                                                *
   114*                                                                *
   115*                            ELCSCTM                             *
   116*                            VMOD=2.001                          *
   117*                                                                *
   118*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   119*                                                                *
   120******************************************************************
   121 01  SECURITY-MESSAGE.
   122     12  FILLER                          PIC X(30)
   123            VALUE '** LOGIC SECURITY VIOLATION -'.
   124     12  SM-READ                         PIC X(6).
   125     12  FILLER                          PIC X(5)
   126            VALUE ' PGM='.
   127     12  SM-PGM                          PIC X(6).
   128     12  FILLER                          PIC X(5)
   129            VALUE ' OPR='.
   130     12  SM-PROCESSOR-ID                 PIC X(4).
   131     12  FILLER                          PIC X(6)
   132            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page   5
* EL156.cbl
   133     12  SM-TERMID                       PIC X(4).
   134     12  FILLER                          PIC XX   VALUE SPACE.
   135     12  SM-JUL-DATE                     PIC 9(5).
   136     12  FILLER                          PIC X    VALUE SPACE.
   137     12  SM-TIME                         PIC 99.99.
   138
   139
   140*    COPY ELCSCRTY.
   141******************************************************************
   142*                                                                *
   143*                                                                *
   144*                            ELCSCRTY                            *
   145*                            VMOD=2.001                          *
   146*                                                                *
   147*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   148*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   149*        SAVED IN PI-SECURITY-ADDRESS.                           *
   150*                                                                *
   151******************************************************************
   152 01  SECURITY-CONTROL.
   153     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   154     12  FILLER                       PIC XX    VALUE 'SC'.
   155     12  SC-CREDIT-CODES.
   156         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   157             20  SC-CREDIT-DISPLAY    PIC X.
   158             20  SC-CREDIT-UPDATE     PIC X.
   159     12  SC-CLAIMS-CODES.
   160         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   161             20  SC-CLAIMS-DISPLAY    PIC X.
   162             20  SC-CLAIMS-UPDATE     PIC X.
   163
   164 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   165 01  WS-DATE-AREA.
   166     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   167     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   168     12  SAVE-DATE-CCYYMMDD.
   169         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   170         16  SAVE-DATE-YMD.
   171             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   172             20  FILLER              PIC X(04)   VALUE SPACES.
   173
   174 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   175 01  STANDARD-AREAS.
   176     12  WS-RESPONSE         PIC S9(8)   COMP.
   177         88  WS-RESP-NORMAL              VALUE +00.
   178         88  WS-RESP-ERROR               VALUE +01.
   179         88  WS-RESP-NOTFND              VALUE +13.
   180         88  WS-RESP-DUPREC              VALUE +14.
   181         88  WS-RESP-ENDFILE             VALUE +20.
   182     12  PMT-HEAD-A.
   183         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   184         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   185         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   186-        '     RESERVES  TYPE    AMOUNT'.
   187     12  PMT-HEAD-B.
   188         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   189         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   190         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page   6
* EL156.cbl
   191     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   192     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   193     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   194     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   195     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   196     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   197     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   198     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   199     12  PGM-NAME            PIC X(8).
   200     12  TIME-IN             PIC S9(7).
   201     12  TIME-OUT-R  REDEFINES TIME-IN.
   202         16  FILLER          PIC X.
   203         16  TIME-OUT        PIC 99V99.
   204         16  FILLER          PIC XX.
   205     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   206     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   207     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   208     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   209     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   210     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   211     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   212     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   213     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   214     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   215     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   216     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   217     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   218     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   219     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   220     12  WS-BLANK            PIC X       VALUE ' '.
   221
   222 01  MISC-WORK-AREAS.
   223     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   224     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   225     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   226     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   227     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   228     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   229     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   230     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   231     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   232     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   233     12  W-CALLED-NAME           PIC X(08).
   234     12  W-EOB-CODES.
   235         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   236             20  W-EOB-CODE      PIC XXX.
   237             20  W-EOB-FILLER    PIC X.
   238     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   239     12  W-NAME-LAST             PIC X(15).
   240     12  W-NAME-FIRST            PIC X(15).
   241     12  W-NAME-MIDDLE.
   242         16  FILLER              PIC X.
   243         16  W-NAME-MIDDLE-2     PIC X.
   244         16  FILLER              PIC X(13).
   245     12  W-DMD-CHECK-NO.
   246         16  W-DMD-CHECK-NO-1    PIC X(4).
   247         16  W-DMD-CHECK-NO-2    PIC X.
   248         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page   7
* EL156.cbl
   249
   250     12  WS-COMPUTE-FROM-DT  PIC XX.
   251     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   252     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   253     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   254     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   255     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   256     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   257         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   258         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   259     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   260         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   261     12  WS-UPDATE-SW        PIC X VALUE ' '.
   262     12  WS-GROUPING.
   263         16  WS-GROUP-1      PIC X VALUE SPACES.
   264         16  FILLER          PIC X(05) VALUE SPACES.
   265     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   266     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   267     12  WS-WORK-STATE-ACCT.
   268         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   269         16  FILLER          PIC X       VALUE '/'.
   270         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   271     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   272     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   273     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   274     12  QID.
   275         16  QID-TERM        PIC X(4)    VALUE SPACES.
   276         16  FILLER          PIC X(4)    VALUE '156A'.
   277     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   278     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   279     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   280     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   281     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   282     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   283     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   284     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   285     12  WS-STATUS           PIC X       VALUE SPACES.
   286     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   287     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   288     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   289     12  ws-extended-exp-dt  pic xx      value low-values.
   290     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   291     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   292     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   293     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   294     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   295     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   296     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   297     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   298     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   299     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   300     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   301     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   302     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   303     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   304     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   305     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   306     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page   8
* EL156.cbl
   307     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   308     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   309     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   310     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   311     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   312     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   313     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   314     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   315     12  WORK-DATE-FROM.
   316         16  WDF-MONTH       PIC 99        VALUE ZERO.
   317         16  WDF-DAY         PIC 99        VALUE ZERO.
   318         16  WDF-YEAR        PIC 99        VALUE ZERO.
   319     12  WORK-DATE-THRU.
   320         16  WDT-MONTH       PIC 99        VALUE ZERO.
   321         16  WDT-DAY         PIC 99        VALUE ZERO.
   322         16  WDT-YEAR        PIC 99        VALUE ZERO.
   323     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   324     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   325     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   326     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   327     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   328     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   329     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   330     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   331     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   332     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   333     12  WS-PY-WK REDEFINES WS-PY-WORK.
   334         16  WS-PY-NUM       PIC S9(7)V99.
   335         16  WS-PY-SIGN      PIC X.
   336     12  WS-DY-WORK          PIC S9(5).
   337     12  WS-DY-WK REDEFINES WS-DY-WORK.
   338         16  WS-DY-NUM       PIC S9(4).
   339         16  WS-DY-SIGN      PIC X.
   340     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   341         88  COMP-REC-FOUND              VALUE 'Y'.
   342     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   343         88  BENEFIT-FOUND       VALUE 'Y'.
   344         88  NO-BENEFIT-FOUND    VALUE 'N'.
   345     12  WS-TERMS.
   346         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   347         16  FILLER          PIC X       VALUE '/'.
   348         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   349         16  WST-REM-DAYS-GRP.
   350             20  WST-SLASH   PIC X       VALUE '/'.
   351             20  WST-REM-DAYS
   352                             PIC --9.
   353     12  WS-ACCESS.
   354         16  FILLER          PIC XX      VALUE SPACES.
   355         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   356     12  WS-STATE-ACCESS.
   357         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   358         16  FILLER          PIC XX      VALUE SPACES.
   359     12  WS-CARR-ACCESS.
   360         16  FILLER          PIC X(3)    VALUE SPACES.
   361         16  WS-CARR         PIC X       VALUE SPACES.
   362     12  DATE-WORK.
   363         16  FILLER          PIC XX      VALUE SPACES.
   364         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page   9
* EL156.cbl
   365     12  WS-SAVE-INPUT.
   366         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   367         16  WS-PAYEE        PIC XX      VALUE SPACE.
   368         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   369         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   370         16  WS-OFFLINE      PIC X       VALUE SPACE.
   371         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   372         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   373         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   374         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   375         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   376         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   377         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   378         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   379         16  WS-ETYPE        PIC X       VALUE SPACE.
   380         16  WS-CASH         PIC X       VALUE SPACE.
   381         16  WS-GROUPED      PIC X       VALUE SPACE.
   382         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   383         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   384         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   385         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   386         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   387         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   388         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   389         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   390         16  ws-int-to-rem-borr pic x value spaces.
   391     12  LAST-ERROR-LINE.
   392         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   393         16  FILLER              PIC X(30)
   394             VALUE ' FATAL ERRORS ENCOUNTERED'.
   395         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   396         16  FILLER              PIC X(28)
   397             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   398     12  WS-CHECK-AREA.
   399         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   400         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   401     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   402     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   403         16  FILLER              PIC XX.
   404         16  WS-A-CHECK-NUM-5    PIC 9(5).
   405     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   406         16  FILLER              PIC X.
   407         16  WS-A-CHECK-NUM-6    PIC 9(6).
   408     12  OPTION-1-SAVE-AREA.
   409         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   410         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   411     12  WS-WORK-ZIP.
   412         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   413         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   414     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   415                                 PIC 9(9).
   416     12  WS-FLI-PMTNOTE.
   417         16  WS-PMTOPTION        PIC XX.
   418         16  WS-DOCNAME          PIC X(28).
   419         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   420             20  WS-AMOUNT       PIC X(8).
   421             20  FILLER          PIC X(20).
   422         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  10
* EL156.cbl
   423             20  WS-NUM-AMT      PIC 9(6)V99.
   424             20  FILLER          PIC X(20).
   425
   426     12  WS-HAN-PMTNOTE.
   427         16  WS-HAN-PMT-CODE     PIC X.
   428         16  WS-HAN-PMT-NOTE     PIC X(39).
   429
   430     12  WS-NCL-PMT-OPTION       PIC XX.
   431         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   432
   433     12  WS-CLAIM-SEQUENCE.
   434         16  FILLER              PIC X VALUE '('.
   435         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   436         16  FILLER              PIC X(04) VALUE ' OF '.
   437         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   438         16  FILLER              PIC X VALUE ')'.
   439
   440     12  WS-REFUND-AMT           PIC Z(7).99.
   441     12  WS-CALC-INT             PIC S9(7)V99.
   442     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   443
   444     12  SUB                     PIC 99 VALUE ZEROS.
   445
   446     12  WS-BOANOTE1.
   447         16  WS-BOANOTE1-DESC    PIC X(11).
   448         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   449         16  FILLER              PIC X(17).
   450     12  WS-BOANOTE2.
   451         16  WS-BOANOTE2-DESC    PIC X(11).
   452         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   453         16  FILLER              PIC X(17).
   454
   455     12  WS-NCLNOTE1.
   456         16  WS-NCLNOTE1-DESC    PIC X(11).
   457         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   458         16  FILLER              PIC X(17).
   459     12  WS-NCLNOTE2.
   460         16  WS-NCLNOTE2-DESC    PIC X(11).
   461         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   462         16  FILLER              PIC X(17).
   463
   464     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   465     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   466     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   467     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   468     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   469     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   470     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   471     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   472     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   473     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   474
   475     12  WS-AIG-WORK-AREAS.
   476         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   477             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   478         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   479             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   480         16  WS-FROM-DATE-MDY.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  11
* EL156.cbl
   481             20  WS-FROM-MO      PIC 99.
   482             20  WS-FROM-DA      PIC 99.
   483             20  WS-FROM-YR      PIC 99.
   484         16  WS-TEMP-DATE-MDY.
   485             20  WS-TEMP-MO      PIC 99.
   486             20  WS-TEMP-DA      PIC 99.
   487             20  WS-TEMP-YR      PIC 99.
   488         16  WS-BIN-FROM-DT      PIC XX.
   489         16  WS-TEMP-INC-MDY.
   490             20  WS-TEMP-INC-MO  PIC 99.
   491             20  WS-TEMP-INC-DA  PIC 99.
   492             20  WS-TEMP-INC-YR  PIC 99.
   493         16  WS-PMT-DUE-MDY.
   494             20  WS-PMT-DUE-MO   PIC 99.
   495             20  WS-PMT-DUE-DA   PIC 99.
   496             20  WS-PMT-DUE-YR   PIC 99.
   497         16  WS-PMT-DUE-DT       PIC XX.
   498         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   499         16  WS-RETRO-ELIM-DT    PIC XX.
   500         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   501             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   502         16  WS-SAVE-DUE-DA      PIC 99.
   503         16  WS-CDAYS            PIC S9(05).
   504         16  WS-DAYS-OFF         PIC S9(05).
   505         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   506             88  ELIM-SATISFIED            VALUE 'Y'.
   507         16  WS-AIG-CHECKNO.
   508             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   509             20  WS-A-CHECKNO-3-7.
   510                 24  FILLER              PIC X(3)    VALUE SPACES.
   511                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   512                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   513         16  WS-AIG-GROUPING.
   514             20  WS-A-BENE               PIC XXX.
   515             20  FILLER                  PIC XXX.
   516         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   517             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   518             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   519         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   520                 VALUE 'UNEMPLOYMENT PAYMENT'.
   521         16  WS-CHK-THRU-DT              PIC XX.
   522         16  WS-HOLD-BIN-DATE-1          PIC XX.
   523
   524 01  MISC-CSO-AREA.
   525     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   526     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   527     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   528         88  APPROVAL-NEEDED                        VALUE 'Y'.
   529     12  WS-APPROV-NOTE                  PIC X(43)
   530         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   531     12  WS-3550-APPROV-NOTE             PIC X(43)
   532         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   533     12  WS-REAUDIT-NOTE                 PIC X(43)
   534         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   535     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   536     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   537     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   538     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  12
* EL156.cbl
   539     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   540     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   541     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   542         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   543     12  WS-PAYEE-CITY-STATE     PIC X(30).
   544     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   545         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   546     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   547     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   548     12  WS-WORK-NAME            PIC X(30).
   549     12  FILLER  REDEFINES WS-WORK-NAME.
   550         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   551     12  WS-INSURED-NAME         PIC X(30).
   552     12  FILLER  REDEFINES WS-INSURED-NAME.
   553         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   554     12  WS-PAYEE-NAME           PIC X(30).
   555     12  FILLER  REDEFINES WS-PAYEE-NAME.
   556         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   557     12  WS-HOLD-UNTIL-SW        PIC X VALUE SPACES.
   558         88  HOLD-UNTIL-CHK            VALUE 'Y'.
   559         88  HOLD-UNTIL-PMT            VALUE 'P'.
   560     12  WS-HOLD-UNTIL-DT        PIC X(02) VALUE ZERO.
   561     12  WS-UNPAID-HOLD-UNTIL-SW PIC X VALUE SPACES.
   562         88  UNPAID-HOLD-UNTIL-EXISTS  VALUE 'Y'.
   563     12  WS-DUPE-VOID-PMT-SW     PIC X VALUE SPACES.
   564         88  DUPE-VOID-PMT-EXISTS      VALUE 'Y'.
   565     12  WS-CHECK-ALL-PMTS-SW    PIC X VALUE SPACES.
   566         88  CHECK-ALL-PMTS            VALUE 'Y'.
   567     12  WS-TOT-AMOUNT-PAID      PIC S9(7)V99  COMP-3 VALUE ZERO.
   568     12  WS-UNPD-HOLD-UNTIL-DT   PIC X(02) VALUE ZERO.
   569
   570 01  ERROR-MESSAGES.
   571     12  ER-0000                 PIC X(4)  VALUE '0000'.
   572     12  ER-0004                 PIC X(4)  VALUE '0004'.
   573     12  ER-0008                 PIC X(4)  VALUE '0008'.
   574     12  ER-0019                 PIC X(4)  VALUE '0019'.
   575     12  ER-0029                 PIC X(4)  VALUE '0029'.
   576     12  ER-0042                 PIC X(4)  VALUE '0042'.
   577     12  ER-0070                 PIC X(4)  VALUE '0070'.
   578     12  ER-0130                 PIC X(4)  VALUE '0130'.
   579     12  ER-0149                 PIC X(4)  VALUE '0149'.
   580     12  ER-0154                 PIC X(4)  VALUE '0154'.
   581     12  ER-0168                 PIC X(4)  VALUE '0168'.
   582     12  ER-0169                 PIC X(4)  VALUE '0169'.
   583     12  ER-0172                 PIC X(4)  VALUE '0174'.
   584     12  ER-0198                 PIC X(4)  VALUE '0198'.
   585     12  ER-0204                 PIC X(4)  VALUE '0204'.
   586     12  ER-0206                 PIC X(4)  VALUE '0206'.
   587     12  ER-0252                 PIC X(4)  VALUE '0252'.
   588     12  ER-0254                 PIC X(4)  VALUE '0254'.
   589     12  ER-0282                 PIC X(4)  VALUE '0282'.
   590     12  ER-0283                 PIC X(4)  VALUE '0283'.
   591     12  ER-0294                 PIC X(4)  VALUE '0294'.
   592     12  ER-0338                 PIC X(4)  VALUE '0338'.
   593     12  ER-0419                 PIC X(4)  VALUE '0419'.
   594     12  ER-0420                 PIC X(4)  VALUE '0420'.
   595     12  ER-0421                 PIC X(4)  VALUE '0421'.
   596     12  ER-0422                 PIC X(4)  VALUE '0422'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  13
* EL156.cbl
   597     12  ER-0433                 PIC X(4)  VALUE '0433'.
   598     12  ER-0436                 PIC X(4)  VALUE '0436'.
   599     12  ER-0437                 PIC X(4)  VALUE '0437'.
   600     12  ER-0438                 PIC X(4)  VALUE '0438'.
   601     12  ER-0439                 PIC X(4)  VALUE '0439'.
   602     12  ER-0440                 PIC X(4)  VALUE '0440'.
   603     12  ER-0441                 PIC X(4)  VALUE '0441'.
   604     12  ER-0442                 PIC X(4)  VALUE '0442'.
   605     12  ER-0443                 PIC X(4)  VALUE '0443'.
   606     12  ER-0444                 PIC X(4)  VALUE '0444'.
   607     12  ER-0445                 PIC X(4)  VALUE '0445'.
   608     12  ER-0446                 PIC X(4)  VALUE '0446'.
   609     12  ER-0447                 PIC X(4)  VALUE '0447'.
   610     12  ER-0448                 PIC X(4)  VALUE '0448'.
   611     12  ER-0449                 PIC X(4)  VALUE '0449'.
   612     12  ER-0452                 PIC X(4)  VALUE '0452'.
   613     12  ER-0458                 PIC X(4)  VALUE '0458'.
   614     12  ER-0459                 PIC X(4)  VALUE '0459'.
   615     12  ER-0460                 PIC X(4)  VALUE '0460'.
   616     12  ER-0461                 PIC X(4)  VALUE '0461'.
   617     12  ER-0462                 PIC X(4)  VALUE '0462'.
   618     12  ER-0463                 PIC X(4)  VALUE '0463'.
   619     12  ER-0464                 PIC X(4)  VALUE '0464'.
   620     12  ER-0465                 PIC X(4)  VALUE '0465'.
   621     12  ER-0466                 PIC X(4)  VALUE '0466'.
   622     12  ER-0467                 PIC X(4)  VALUE '0467'.
   623     12  ER-0468                 PIC X(4)  VALUE '0468'.
   624     12  ER-0469                 PIC X(4)  VALUE '0469'.
   625     12  ER-0473                 PIC X(4)  VALUE '0473'.
   626     12  ER-0474                 PIC X(4)  VALUE '0474'.
   627     12  ER-0475                 PIC X(4)  VALUE '0475'.
   628     12  ER-0476                 PIC X(4)  VALUE '0476'.
   629     12  ER-0477                 PIC X(4)  VALUE '0477'.
   630     12  ER-0478                 PIC X(4)  VALUE '0478'.
   631     12  ER-0479                 PIC X(4)  VALUE '0479'.
   632     12  ER-0481                 PIC X(4)  VALUE '0481'.
   633     12  ER-0491                 PIC X(4)  VALUE '0491'.
   634     12  ER-0492                 PIC X(4)  VALUE '0492'.
   635     12  ER-0493                 PIC X(4)  VALUE '0493'.
   636     12  ER-0494                 PIC X(4)  VALUE '0494'.
   637     12  ER-0495                 PIC X(4)  VALUE '0495'.
   638     12  ER-0499                 PIC X(4)  VALUE '0499'.
   639     12  ER-0500                 PIC X(4)  VALUE '0500'.
   640     12  ER-0501                 PIC X(4)  VALUE '0501'.
   641     12  ER-0502                 PIC X(4)  VALUE '0502'.
   642     12  ER-0508                 PIC X(4)  VALUE '0508'.
   643     12  ER-0513                 PIC X(4)  VALUE '0513'.
   644     12  ER-0518                 PIC X(4)  VALUE '0518'.
   645     12  ER-0524                 PIC X(4)  VALUE '0524'.
   646     12  ER-0525                 PIC X(4)  VALUE '0525'.
   647     12  ER-0526                 PIC X(4)  VALUE '0526'.
   648     12  ER-0530                 PIC X(4)  VALUE '0530'.
   649     12  ER-0540                 PIC X(4)  VALUE '0540'.
   650     12  ER-0541                 PIC X(4)  VALUE '0541'.
   651     12  ER-0542                 PIC X(4)  VALUE '0542'.
   652     12  ER-0543                 PIC X(4)  VALUE '0543'.
   653     12  ER-0545                 PIC X(4)  VALUE '0545'.
   654     12  ER-0552                 PIC X(4)  VALUE '0552'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  14
* EL156.cbl
   655     12  ER-0555                 PIC X(4)  VALUE '0555'.
   656     12  ER-0556                 PIC X(4)  VALUE '0556'.
   657     12  ER-0557                 PIC X(4)  VALUE '0557'.
   658     12  ER-0572                 PIC X(4)  VALUE '0572'.
   659     12  ER-0573                 PIC X(4)  VALUE '0573'.
   660     12  ER-0594                 PIC X(4)  VALUE '0594'.
   661     12  ER-0616                 PIC X(4)  VALUE '0616'.
   662     12  ER-0617                 PIC X(4)  VALUE '0617'.
   663     12  ER-0618                 PIC X(4)  VALUE '0618'.
   664     12  ER-0657                 PIC X(4)  VALUE '0657'.
   665     12  ER-0658                 PIC X(4)  VALUE '0658'.
   666     12  ER-0699                 PIC X(4)  VALUE '0699'.
   667     12  ER-0730                 PIC X(4)  VALUE '0730'.
   668     12  ER-0737                 PIC X(4)  VALUE '0737'.
   669     12  ER-0760                 PIC X(4)  VALUE '0760'.
   670     12  ER-0768                 PIC X(4)  VALUE '0768'.
   671     12  ER-0769                 PIC X(4)  VALUE '0769'.
   672     12  ER-0770                 PIC X(4)  VALUE '0770'.
   673     12  ER-0802                 PIC X(4)  VALUE '0802'.
   674     12  ER-0803                 PIC X(4)  VALUE '0803'.
   675     12  ER-0819                 PIC X(4)  VALUE '0819'.
   676     12  ER-0834                 PIC X(4)  VALUE '0834'.
   677     12  ER-0836                 PIC X(4)  VALUE '0836'.
   678     12  ER-0844                 PIC X(4)  VALUE '0844'.
   679     12  ER-0845                 PIC X(4)  VALUE '0845'.
   680     12  ER-0846                 PIC X(4)  VALUE '0846'.
   681     12  ER-0849                 PIC X(4)  VALUE '0849'.
   682     12  ER-0851                 PIC X(4)  VALUE '0851'.
   683     12  ER-0872                 PIC X(4)  VALUE '0872'.
   684     12  ER-0873                 PIC X(4)  VALUE '0873'.
   685     12  ER-0874                 PIC X(4)  VALUE '0874'.
   686     12  ER-0879                 PIC X(4)  VALUE '0879'.
   687     12  ER-0919                 PIC X(4)  VALUE '0919'.
   688     12  ER-0921                 PIC X(4)  VALUE '0921'.
   689     12  ER-0923                 PIC X(4)  VALUE '0923'.
   690     12  ER-0925                 PIC X(4)  VALUE '0925'.
   691     12  ER-0944                 PIC X(4)  VALUE '0944'.
   692     12  ER-0945                 PIC X(4)  VALUE '0945'.
   693     12  ER-0946                 PIC X(4)  VALUE '0946'.
   694     12  ER-0947                 PIC X(4)  VALUE '0947'.
   695     12  ER-0948                 PIC X(4)  VALUE '0948'.
   696     12  ER-0949                 PIC X(4)  VALUE '0949'.
   697     12  ER-0950                 PIC X(4)  VALUE '0950'.
   698     12  ER-0951                 PIC X(4)  VALUE '0951'.
   699     12  ER-0954                 PIC X(4)  VALUE '0954'.
   700     12  ER-0956                 PIC X(4)  VALUE '0956'.
   701     12  ER-0967                 PIC X(4)  VALUE '0967'.
   702     12  ER-0968                 PIC X(4)  VALUE '0968'.
   703     12  ER-0974                 PIC X(4)  VALUE '0974'.
   704     12  ER-0975                 PIC X(4)  VALUE '0975'.
   705     12  ER-1561                 PIC X(4)  VALUE '1561'.
   706     12  ER-1566                 PIC X(4)  VALUE '1566'.
   707     12  ER-1567                 PIC X(4)  VALUE '1567'.
   708     12  ER-1569                 PIC X(4)  VALUE '1569'.
   709     12  er-1582                 pic x(4)  value '1582'.
   710     12  er-1657                 pic x(4)  value '1657'.
   711     12  er-1658                 pic x(4)  value '1658'.
   712     12  er-1667                 pic x(4)  value '1667'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  15
* EL156.cbl
   713     12  er-1670                 pic x(4)  value '1670'.
   714     12  er-1671                 pic x(4)  value '1671'.
   715     12  er-1672                 pic x(4)  value '1672'.
   716     12  er-1673                 pic x(4)  value '1673'.
   717     12  er-1674                 pic x(4)  value '1674'.
   718     12  er-1677                 pic x(4)  value '1677'.
   719     12  ER-1775                 PIC X(4)  VALUE '1775'.
   720     12  ER-1880                 PIC X(4)  VALUE '1880'.
   721     12  ER-1930                 PIC X(4)  VALUE '1930'.
   722     12  ER-2044                 PIC X(4)  VALUE '2044'.
   723     12  ER-3140                 PIC X(4)  VALUE '3140'.
   724     12  ER-3141                 PIC X(4)  VALUE '3141'.
   725     12  ER-3255                 PIC X(4)  VALUE '3255'.
   726     12  ER-3272                 PIC X(4)  VALUE '3272'.
   727     12  ER-3276                 PIC X(4)  VALUE '3276'.
   728     12  ER-3277                 PIC X(4)  VALUE '3277'.
   729     12  ER-3278                 PIC X(4)  VALUE '3278'.
   730     12  ER-3279                 PIC X(4)  VALUE '3279'.
   731     12  ER-3516                 PIC X(4)  VALUE '3516'.
   732     12  ER-3527                 PIC X(4)  VALUE '3527'.
   733     12  ER-3528                 PIC X(4)  VALUE '3528'.
   734     12  ER-3529                 PIC X(4)  VALUE '3529'.
   735     12  ER-3530                 PIC X(4)  VALUE '3530'.
   736     12  ER-3531                 PIC X(4)  VALUE '3531'.
   737     12  ER-3532                 PIC X(4)  VALUE '3532'.
   738     12  ER-3533                 PIC X(4)  VALUE '3533'.
   739     12  ER-3534                 PIC X(4)  VALUE '3534'.
   740     12  ER-3535                 PIC X(4)  VALUE '3535'.
   741     12  ER-3536                 PIC X(4)  VALUE '3536'.
   742     12  ER-3537                 PIC X(4)  VALUE '3537'.
   743     12  ER-3538                 PIC X(4)  VALUE '3538'.
   744     12  ER-3539                 PIC X(4)  VALUE '3539'.
   745     12  ER-3540                 PIC X(4)  VALUE '3540'.
   746     12  ER-3541                 PIC X(4)  VALUE '3541'.
   747     12  ER-3542                 PIC X(4)  VALUE '3542'.
   748     12  ER-3543                 PIC X(4)  VALUE '3543'.
   749     12  ER-3546                 PIC X(4)  VALUE '3546'.
   750     12  ER-3549                 PIC X(4)  VALUE '3549'.
   751     12  ER-3551                 PIC X(4)  VALUE '3551'.
   752     12  ER-3818                 PIC X(4)  VALUE '3818'.
   753     12  ER-7540                 PIC X(4)  VALUE '7540'.
   754     12  ER-7576                 PIC X(4)  VALUE '7576'.
   755     12  ER-7579                 PIC X(4)  VALUE '7579'.
   756     12  ER-7580                 PIC X(4)  VALUE '7580'.
   757     12  ER-7583                 PIC X(4)  VALUE '7583'.
   758     12  ER-7585                 PIC X(4)  VALUE '7585'.
   759     12  ER-7830                 PIC X(4)  VALUE '7830'.
   760     12  ER-7831                 PIC X(4)  VALUE '7831'.
   761     12  ER-7832                 PIC X(4)  VALUE '7832'.
   762     12  ER-7833                 PIC X(4)  VALUE '7833'.
   763     12  ER-7834                 PIC X(4)  VALUE '7834'.
   764     12  ER-7835                 PIC X(4)  VALUE '7835'.
   765     12  ER-7836                 PIC X(4)  VALUE '7836'.
   766     12  ER-7837                 PIC X(4)  VALUE '7837'.
   767     12  ER-7838                 PIC X(4)  VALUE '7838'.
   768     12  ER-7841                 PIC X(4)  VALUE '7841'.
   769     12  ER-7844                 PIC X(4)  VALUE '7844'.
   770     12  ER-7845                 PIC X(4)  VALUE '7845'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  16
* EL156.cbl
   771     12  ER-8000                 PIC X(4)  VALUE '8000'.
   772     12  ER-8051                 PIC X(4)  VALUE '8051'.
   773     12  ER-8052                 PIC X(4)  VALUE '8052'.
   774     12  ER-8053                 PIC X(4)  VALUE '8053'.
   775     12  ER-8054                 PIC X(4)  VALUE '8054'.
   776     12  ER-8055                 PIC X(4)  VALUE '8055'.
   777     12  ER-8056                 PIC X(4)  VALUE '8056'.
   778     12  ER-8057                 PIC X(4)  VALUE '8057'.
   779     12  ER-8058                 PIC X(4)  VALUE '8058'.
   780     12  ER-8059                 PIC X(4)  VALUE '8059'.
   781     12  ER-8060                 PIC X(4)  VALUE '8060'.
   782     12  ER-8061                 PIC X(4)  VALUE '8061'.
   783     12  ER-8062                 PIC X(4)  VALUE '8062'.
   784     12  ER-8063                 PIC X(4)  VALUE '8063'.
   785     12  ER-8064                 PIC X(4)  VALUE '8064'.
   786     12  ER-8065                 PIC X(4)  VALUE '8065'.
   787     12  ER-8066                 PIC X(4)  VALUE '8066'.
   788     12  ER-8146                 PIC X(4)  VALUE '8146'.
   789     12  ER-8147                 PIC X(4)  VALUE '8147'.
   790     12  ER-8152                 PIC X(4)  VALUE '8152'.
   791     12  ER-8153                 PIC X(4)  VALUE '8153'.
   792     12  ER-8154                 PIC X(4)  VALUE '8154'.
   793     12  ER-8155                 PIC X(4)  VALUE '8155'.
   794     12  ER-8310                 PIC X(4)  VALUE '8310'.
   795     12  ER-8311                 PIC X(4)  VALUE '8311'.
   796     12  ER-8312                 PIC X(4)  VALUE '8312'.
   797     12  ER-8313                 PIC X(4)  VALUE '8313'.
   798     12  ER-8314                 PIC X(4)  VALUE '8314'.
   799     12  ER-8315                 PIC X(4)  VALUE '8315'.
   800     12  ER-8316                 PIC X(4)  VALUE '8316'.
   801     12  ER-8317                 PIC X(4)  VALUE '8317'.
   802
   803 01  CSO-WORK-FIELDS.
   804     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   805       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   806
   807     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   808     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   809         88  CERT-NOTE-ADDED           VALUE 'Y'.
   810     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   811         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   812     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   813
   814     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   815
   816 01  SC-NP6-CERT-NOTE.
   817     12  FILLER                  PIC X(12)
   818               VALUE 'REM BENEFIT '.
   819     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   820     12  SC-NP6-COMM             PIC X(8)
   821               VALUE ' + 6 MO '.
   822     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   823     12  FILLER                  PIC X(12)
   824               VALUE ' = AMT PAID '.
   825     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   826
   827 01  SC-NP6-ORIG-NOTE.
   828     12  FILLER                  PIC X(63)  VALUE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  17
* EL156.cbl
   829         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   830 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   831     88  PDEF-FOUND                   VALUE 'Y'.
   832 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   833     88  ACCT-FOUND                   VALUE 'Y'.
   834 01  CTBL-KEY-SAVE               PIC X(5).
   835 01  CTBL-KEY.
   836     05  CTBL-COMPANY-CD         PIC X.
   837     05  CTBL-TABLE              PIC XXX.
   838     05  CTBL-BEN-TYPE           PIC X.
   839     05  CTBL-BEN-CODE           PIC XX.
   840 01  ERPDEF-KEY-SAVE             PIC X(18).
   841 01  ERPDEF-KEY.
   842     12  ERPDEF-COMPANY-CD       PIC X.
   843     12  ERPDEF-STATE            PIC XX.
   844     12  ERPDEF-PROD-CD          PIC XXX.
   845     12  F                       PIC X(7).
   846     12  ERPDEF-BEN-TYPE         PIC X.
   847     12  ERPDEF-BEN-CODE         PIC XX.
   848     12  ERPDEF-EXP-DT           PIC XX.
   849 01  ELCRTT-KEY.
   850     05  CTRLR-COMP-CD       PIC X.
   851     05  CTRLR-CARRIER       PIC X.
   852     05  CTRLR-GROUPING      PIC X(6).
   853     05  CTRLR-STATE         PIC X(2).
   854     05  CTRLR-ACCOUNT       PIC X(10).
   855     05  CTRLR-EFF-DT        PIC XX.
   856     05  CTRLR-CERT-NO       PIC X(11).
   857     05  CTRLR-REC-TYPE      PIC X.
   858 01  ACCESS-KEYS.
   859     12  ELARCH-KEY.
   860         16  ARCH-CO             PIC X.
   861         16  ARCH-NUMBER         PIC S9(08) COMP.
   862         16  ARCH-REC-TYPE       PIC X.
   863         16  ARCH-SEQ            PIC S9(04) COMP.
   864     12  ELMSTR-KEY.
   865         16  MSTR-COMP-CD        PIC X.
   866         16  MSTR-CARRIER        PIC X.
   867         16  MSTR-CLAIM-NO       PIC X(7).
   868         16  MSTR-CERT-NO        PIC X(11).
   869     12  ELCNTL-KEY.
   870         16  CNTL-COMP-ID        PIC X(3).
   871         16  CNTL-REC-TYPE       PIC X.
   872         16  CNTL-ACCESS         PIC X(4).
   873         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   874     12  ELCERT-KEY.
   875         16  CERT-COMP-CD        PIC X.
   876         16  CERT-CARRIER        PIC X.
   877         16  CERT-GROUPING       PIC X(6).
   878         16  CERT-STATE          PIC XX.
   879         16  CERT-ACCOUNT        PIC X(10).
   880         16  CERT-EFF-DT         PIC XX.
   881         16  CERT-CERT-NO        PIC X(11).
   882     12  ELTRLR-KEY.
   883         16  TRLR-COMP-CD        PIC X.
   884         16  TRLR-CARRIER        PIC X.
   885         16  TRLR-CLAIM-NO       PIC X(7).
   886         16  TRLR-CERT-NO        PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  18
* EL156.cbl
   887         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   888     12  ELACTQ-KEY.
   889         16  ACTQ-COMP-CD        PIC X.
   890         16  ACTQ-CARRIER        PIC X.
   891         16  ACTQ-CLAIM-NO       PIC X(7).
   892         16  ACTQ-CERT-NO        PIC X(11).
   893     12  W-NOTE-KEY.
   894         16  W-NOTE-COMP-CD      PIC X.
   895         16  W-NOTE-CERT-KEY.
   896             20  W-NOTE-CARRIER  PIC X.
   897             20  W-NOTE-GROUPING PIC X(6).
   898             20  W-NOTE-STATE    PIC XX.
   899             20  W-NOTE-ACCOUNT  PIC X(10).
   900             20  W-NOTE-EFF-DT   PIC XX.
   901             20  W-NOTE-CERT-NO  PIC X(11).
   902     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   903     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   904     12  ERACCT-KEY.
   905         16  ERACCT-PARTIAL-KEY.
   906             20  ACCT-COMP-CD    PIC X.
   907             20  ACCT-CARRIER    PIC X.
   908             20  ACCT-GROUPING   PIC X(6).
   909             20  ACCT-STATE      PIC XX.
   910             20  ACCT-ACCOUNT    PIC X(10).
   911         16  ACCT-EXP-DT         PIC XX.
   912         16  FILLER              PIC X(4) VALUE SPACES.
   913     12  ELCHKQ-KEY.
   914         16  CHKQ-COMP-CD        PIC X.
   915         16  CHKQ-CONTROL        PIC S9(8) COMP.
   916         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   917     12  ELBENE-KEY.
   918         16  BENE-COMP-CD         PIC X.
   919         16  BENE-RECORD-TYPE     PIC X.
   920         16  BENE-NUMBER          PIC X(10).
   921     12  ERCOMP-KEY.
   922         16  COMP-COMP-CD        PIC X.
   923         16  COMP-CARRIER        PIC X.
   924         16  COMP-GROUP          PIC X(06).
   925         16  COMP-FIN-RESP       PIC X(10).
   926         16  COMP-ACCOUNT        PIC X(10).
   927         16  COMP-TYPE           PIC X.
   928
   929     12  DLO035-KEY.
   930         16  DL35-PROCESS-TYPE   PIC X.
   931         16  DL35-CREDIT-CARD    PIC X(20).
   932         16  DL35-BEN-TYPE       PIC XX.
   933         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   934         16  DL35-RETURN-CODE    PIC XX.
   935
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  19
* EL156.cbl
   937*    COPY ELCDATE.
   938******************************************************************
   939*                                                                *
   940*                                                                *
   941*                            ELCDATE.                            *
   942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   943*                            VMOD=2.003
   944*                                                                *
   945*                                                                *
   946*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   947*                 LENGTH = 200                                   *
   948******************************************************************
   949
   950 01  DATE-CONVERSION-DATA.
   951     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   952     12  DC-OPTION-CODE                PIC X.
   953         88  BIN-TO-GREG                VALUE ' '.
   954         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   955         88  EDIT-GREG-TO-BIN           VALUE '2'.
   956         88  YMD-GREG-TO-BIN            VALUE '3'.
   957         88  MDY-GREG-TO-BIN            VALUE '4'.
   958         88  JULIAN-TO-BIN              VALUE '5'.
   959         88  BIN-PLUS-ELAPSED           VALUE '6'.
   960         88  FIND-CENTURY               VALUE '7'.
   961         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   962         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   963         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   964         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   965         88  JULIAN-TO-BIN-3            VALUE 'C'.
   966         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   967         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   968         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   969         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   970         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   971         88  CHECK-LEAP-YEAR            VALUE 'H'.
   972         88  BIN-3-TO-GREG              VALUE 'I'.
   973         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   974         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   975         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   976         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   977         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   978         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   979         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   980         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   981         88  THREE-CHARACTER-BIN
   982                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   983         88  GREGORIAN-TO-BIN
   984                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   985         88  BIN-TO-GREGORIAN
   986                  VALUES ' ' '1' 'I' '8' 'G'.
   987         88  JULIAN-TO-BINARY
   988                  VALUES '5' 'C' 'E' 'F'.
   989     12  DC-ERROR-CODE                 PIC X.
   990         88  NO-CONVERSION-ERROR        VALUE ' '.
   991         88  DATE-CONVERSION-ERROR
   992                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   993         88  DATE-IS-ZERO               VALUE '1'.
   994         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  20
* EL156.cbl
   995         88  DATE-IS-INVALID            VALUE '3'.
   996         88  DATE1-GREATER-DATE2        VALUE '4'.
   997         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   998         88  DATE-INVALID-OPTION        VALUE '9'.
   999         88  INVALID-CENTURY            VALUE 'A'.
  1000         88  ONLY-CENTURY               VALUE 'B'.
  1001         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1002         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1003     12  DC-END-OF-MONTH               PIC X.
  1004         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1005     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1006         88  USE-NORMAL-PROCESS         VALUE ' '.
  1007         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1008         88  ADJUST-UP-100-YRS          VALUE '2'.
  1009     12  FILLER                        PIC X.
  1010     12  DC-CONVERSION-DATES.
  1011         16  DC-BIN-DATE-1             PIC XX.
  1012         16  DC-BIN-DATE-2             PIC XX.
  1013         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1014         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1015                       DC-GREG-DATE-1-EDIT.
  1016             20  DC-EDIT1-MONTH        PIC 99.
  1017             20  SLASH1-1              PIC X.
  1018             20  DC-EDIT1-DAY          PIC 99.
  1019             20  SLASH1-2              PIC X.
  1020             20  DC-EDIT1-YEAR         PIC 99.
  1021         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1022         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1023                     DC-GREG-DATE-2-EDIT.
  1024             20  DC-EDIT2-MONTH        PIC 99.
  1025             20  SLASH2-1              PIC X.
  1026             20  DC-EDIT2-DAY          PIC 99.
  1027             20  SLASH2-2              PIC X.
  1028             20  DC-EDIT2-YEAR         PIC 99.
  1029         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1030         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1031                     DC-GREG-DATE-1-YMD.
  1032             20  DC-YMD-YEAR           PIC 99.
  1033             20  DC-YMD-MONTH          PIC 99.
  1034             20  DC-YMD-DAY            PIC 99.
  1035         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1036         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1037                      DC-GREG-DATE-1-MDY.
  1038             20  DC-MDY-MONTH          PIC 99.
  1039             20  DC-MDY-DAY            PIC 99.
  1040             20  DC-MDY-YEAR           PIC 99.
  1041         16  DC-GREG-DATE-1-ALPHA.
  1042             20  DC-ALPHA-MONTH        PIC X(10).
  1043             20  DC-ALPHA-DAY          PIC 99.
  1044             20  FILLER                PIC XX.
  1045             20  DC-ALPHA-CENTURY.
  1046                 24 DC-ALPHA-CEN-N     PIC 99.
  1047             20  DC-ALPHA-YEAR         PIC 99.
  1048         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1049         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1050         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1051         16  DC-JULIAN-DATE            PIC 9(05).
  1052         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  21
* EL156.cbl
  1053                                       PIC 9(05).
  1054         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1055             20  DC-JULIAN-YEAR        PIC 99.
  1056             20  DC-JULIAN-DAYS        PIC 999.
  1057         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1058         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1059         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1060     12  DATE-CONVERSION-VARIBLES.
  1061         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1062         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1063             20  FILLER                PIC 9(3).
  1064             20  HOLD-CEN-1-CCYY.
  1065                 24  HOLD-CEN-1-CC     PIC 99.
  1066                 24  HOLD-CEN-1-YY     PIC 99.
  1067             20  HOLD-CEN-1-MO         PIC 99.
  1068             20  HOLD-CEN-1-DA         PIC 99.
  1069         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1070             20  HOLD-CEN-1-R-MO       PIC 99.
  1071             20  HOLD-CEN-1-R-DA       PIC 99.
  1072             20  HOLD-CEN-1-R-CCYY.
  1073                 24  HOLD-CEN-1-R-CC   PIC 99.
  1074                 24  HOLD-CEN-1-R-YY   PIC 99.
  1075             20  FILLER                PIC 9(3).
  1076         16  HOLD-CENTURY-1-X.
  1077             20  FILLER                PIC X(3)  VALUE SPACES.
  1078             20  HOLD-CEN-1-X-CCYY.
  1079                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1080                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1081             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1082             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1083         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1084             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1085             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1086             20  HOLD-CEN-1-R-X-CCYY.
  1087                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1088                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1089             20  FILLER                PIC XXX.
  1090         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1091         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1092         16  DC-JULIAN-DATE-1          PIC 9(07).
  1093         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1094             20  DC-JULIAN-1-CCYY.
  1095                 24  DC-JULIAN-1-CC    PIC 99.
  1096                 24  DC-JULIAN-1-YR    PIC 99.
  1097             20  DC-JULIAN-DA-1        PIC 999.
  1098         16  DC-JULIAN-DATE-2          PIC 9(07).
  1099         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1100             20  DC-JULIAN-2-CCYY.
  1101                 24  DC-JULIAN-2-CC    PIC 99.
  1102                 24  DC-JULIAN-2-YR    PIC 99.
  1103             20  DC-JULIAN-DA-2        PIC 999.
  1104         16  DC-GREG-DATE-A-EDIT.
  1105             20  DC-EDITA-MONTH        PIC 99.
  1106             20  SLASHA-1              PIC X VALUE '/'.
  1107             20  DC-EDITA-DAY          PIC 99.
  1108             20  SLASHA-2              PIC X VALUE '/'.
  1109             20  DC-EDITA-CCYY.
  1110                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  22
* EL156.cbl
  1111                 24  DC-EDITA-YEAR     PIC 99.
  1112         16  DC-GREG-DATE-B-EDIT.
  1113             20  DC-EDITB-MONTH        PIC 99.
  1114             20  SLASHB-1              PIC X VALUE '/'.
  1115             20  DC-EDITB-DAY          PIC 99.
  1116             20  SLASHB-2              PIC X VALUE '/'.
  1117             20  DC-EDITB-CCYY.
  1118                 24  DC-EDITB-CENT     PIC 99.
  1119                 24  DC-EDITB-YEAR     PIC 99.
  1120         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1121         16  DC-GREG-DATE-CYMD-R REDEFINES
  1122                              DC-GREG-DATE-CYMD.
  1123             20  DC-CYMD-CEN           PIC 99.
  1124             20  DC-CYMD-YEAR          PIC 99.
  1125             20  DC-CYMD-MONTH         PIC 99.
  1126             20  DC-CYMD-DAY           PIC 99.
  1127         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1128         16  DC-GREG-DATE-MDCY-R REDEFINES
  1129                              DC-GREG-DATE-MDCY.
  1130             20  DC-MDCY-MONTH         PIC 99.
  1131             20  DC-MDCY-DAY           PIC 99.
  1132             20  DC-MDCY-CEN           PIC 99.
  1133             20  DC-MDCY-YEAR          PIC 99.
  1134    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1135        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1136    12  DC-EL310-DATE                  PIC X(21).
  1137    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  23
* EL156.cbl
  1139*    COPY ELCLOGOF.
  1140******************************************************************
  1141*                                                                *
  1142*                                                                *
  1143*                            ELCLOGOF.                           *
  1144*                            VMOD=2.001                          *
  1145*                                                                *
  1146*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1147*                                                                *
  1148******************************************************************
  1149 01  CLASIC-LOGOFF.
  1150     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1151     12  LOGOFF-TEXT.
  1152         16  FILLER          PIC X(5)    VALUE SPACES.
  1153         16  LOGOFF-MSG.
  1154             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1155             20  FILLER      PIC X       VALUE SPACES.
  1156             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1157         16  FILLER          PIC X(80)
  1158           VALUE '* YOU ARE NOW LOGGED OFF'.
  1159         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1160         16  FILLER          PIC X       VALUE QUOTE.
  1161         16  LOGOFF-SYS-MSG  PIC X(17)
  1162           VALUE 'S CLAS-IC SYSTEM '.
  1163     12  TEXT-MESSAGES.
  1164         16  UNACCESS-MSG    PIC X(29)
  1165             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1166         16  PGMIDERR-MSG    PIC X(17)
  1167             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  24
* EL156.cbl
  1169*    COPY ELCCALC.
  1170******************************************************************
  1171*                                                                *
  1172*                           ELCCALC.                            *
  1173*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1174*                            VMOD=2.025                          *
  1175*                                                                *
  1176*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1177*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1178*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1179*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1180*                                                                *
  1181*  PASSED TO ELRTRM                                              *
  1182*  -----------------                                             *
  1183*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1184*  ORIGINAL TERM                                                 *
  1185*  BEGINNING DATE                                                *
  1186*  ENDING DATE                                                   *
  1187*  COMPANY I.D.                                                  *
  1188*  ACCOUNT MASTER USER FIELD                                     *
  1189*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1190*  FREE LOOK DAYS                                                *
  1191*                                                                *
  1192*  RETURNED FROM ELRTRM                                          *
  1193*  ---------------------                                         *
  1194*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1195*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1196*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1197*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1198*----------------------------------------------------------------*
  1199*  PASSED TO ELRAMT                                              *
  1200*  ----------------                                              *
  1201*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1202*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1203*  ORIGINAL AMOUNT                                               *
  1204*  ALTERNATE BENEFIT (BALLON)                                    *
  1205*  A.P.R. - NET PAY ONLY                                         *
  1206*  METHOD
  1207*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1208*  COMPANY I.D.                                                  *
  1209*  BENEFIT TYPE                                                  *
  1210*                                                                *
  1211*  RETURNED FROM ELRAMT                                          *
  1212*  --------------------                                          *
  1213*  REMAINING AMOUNT 1 - CURRENT                                  *
  1214*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1215*  REMAINING AMOUNT FACTOR
  1216*----------------------------------------------------------------*
  1217*  PASSED TO ELRESV                                              *
  1218*  -----------------                                             *
  1219*  CERTIFICATE EFFECTIVE DATE                                    *
  1220*  VALUATION DATE                                                *
  1221*  PAID THRU DATE                                                *
  1222*  BENEFIT                                                       *
  1223*  INCURRED DATE                                                 *
  1224*  REPORTED DATE                                                 *
  1225*  ISSUE AGE                                                     *
  1226*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  25
* EL156.cbl
  1227*  CDT PERCENT                                                   *
  1228*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1229* *CLAIM TYPE (LIFE, A/H)                                        *
  1230* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1231* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1232*                                                                *
  1233*  RETURNED FROM ELRESV                                          *
  1234*  --------------------                                          *
  1235*  CDT TABLE USED                                                *
  1236*  CDT FACTOR USED                                               *
  1237*  PAY TO CURRENT RESERVE                                        *
  1238*  I.B.N.R. - A/H ONLY                                           *
  1239*  FUTURE (ACCRUED) AH ONLY                                      *
  1240*----------------------------------------------------------------*
  1241*  PASSED TO ELRATE                                              *
  1242*  ----------------                                              *
  1243*  CERT ISSUE DATE                                               *
  1244*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1245*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1246*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1247*  STATE CODE (CLIENT DEFINED)                                   *
  1248*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1249*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1250*  DEVIATION CODE                                                *
  1251*  ISSUE AGE                                                     *
  1252*  ORIGINAL BENEFIT AMOUNT                                       *
  1253*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1254*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1255*  BENEFIT KIND (LIFE OR A/H)                                    *
  1256*  A.P.R.                                                        *
  1257*  METHOD
  1258*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1259*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1260*  COMPANY I.D. (3 CHARACTER)                                    *
  1261*  BENEFIT CODE                                                  *
  1262*  BENEFIT OVERRIDE CODE                                         *
  1263*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1264*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1265*  JOINT INDICATOR (CSL ONLY)                                    *
  1266*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1267*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1268*                                                                *
  1269*  RETURNED FROM ELRATE                                          *
  1270*  --------------------                                          *
  1271*  CALCULATED PREMIUM                                            *
  1272*  PREMIUM RATE                                                  *
  1273*  MORTALITY CODE                                                *
  1274*  MAX ATTAINED AGE                                              *
  1275*  MAX AGE                                                       *
  1276*  MAX TERM                                                      *
  1277*  MAX MONTHLY BENEFIT                                           *
  1278*  MAX TOTAL BENIFIT                                             *
  1279*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1280*----------------------------------------------------------------*
  1281*  PASSED TO ELRFND                                              *
  1282*  ----------------                                              *
  1283*  CERT ISSUE DATE                                               *
  1284*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  26
* EL156.cbl
  1285*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1286*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1287*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1288*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1289*  STATE CODE (CLIENT DEFINED)                                   *
  1290*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1291*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1292*  DEVIATION CODE                                                *
  1293*  ISSUE AGE                                                     *
  1294*  ORIGINAL BENEFIT AMOUNT                                       *
  1295*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1296*  PROCESS TYPE (CANCEL)                                         *
  1297*  BENEFIT KIND (LIFE OR A/H)                                    *
  1298*  A.P.R.                                                        *
  1299*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1300*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1301*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1302*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1303*  COMPANY I.D. (3 CHARACTER)                                    *
  1304*  BENEFIT CODE                                                  *
  1305*  BENEFIT OVERRIDE CODE                                         *
  1306*                                                                *
  1307*  RETURNED FROM ELRFND                                          *
  1308*  --------------------                                          *
  1309*  CALCULATED REFUND                                             *
  1310*----------------------------------------------------------------*
  1311*  PASSED TO ELEARN                                              *
  1312*  ----------------                                              *
  1313*  CERT ISSUE DATE                                               *
  1314*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1315*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1316*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1317*  STATE CODE (CLIENT DEFINED)                                   *
  1318*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1319*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1320*  DEVIATION CODE                                                *
  1321*  ISSUE AGE                                                     *
  1322*  ORIGINAL BENEFIT AMOUNT                                       *
  1323*  BENEFIT KIND (LIFE OR A/H)                                    *
  1324*  A.P.R.                                                        *
  1325*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1326*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1327*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1328*  COMPANY I.D. (3 CHARACTER)                                    *
  1329*  BENEFIT CODE                                                  *
  1330*  BENEFIT OVERRIDE CODE                                         *
  1331*                                                                *
  1332*  RETURNED FROM ELEARN                                          *
  1333*  --------------------                                          *
  1334*  INDICATED  EARNINGS                                           *
  1335*----------------------------------------------------------------*
  1336*                 LENGTH = 450                                   *
  1337*                                                                *
  1338******************************************************************
  1339******************************************************************
  1340*                   C H A N G E   L O G
  1341*
  1342* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  27
* EL156.cbl
  1343*-----------------------------------------------------------------
  1344*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1345* EFFECTIVE    NUMBER
  1346*-----------------------------------------------------------------
  1347* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1348* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1349* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1350* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1351* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1352* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1353* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1354* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1355* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1356* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1357* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1358******************************************************************
  1359
  1360 01  CALCULATION-PASS-AREA.
  1361     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1362                                     COMP.
  1363
  1364     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1365       88  NO-CP-ERROR                             VALUE ZERO.
  1366       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1367                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1368       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1369       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1370       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1371       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1372       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1373       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1374       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1375       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1376       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1377       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1378       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1379       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1380       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1381       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1382       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1383       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1384       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1385
  1386     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1387       88  NO-CP-ERROR-2                           VALUE ZERO.
  1388***********************  INPUT AREAS ****************************
  1389
  1390     12  CP-CALCULATION-AREA.
  1391         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1392         16  CP-CERT-EFF-DT        PIC XX.
  1393         16  CP-VALUATION-DT       PIC XX.
  1394         16  CP-PAID-THRU-DT       PIC XX.
  1395         16  CP-BENEFIT-TYPE       PIC X.
  1396           88  CP-AH                               VALUE 'A' 'D'
  1397                                                   'I' 'U'.
  1398           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1399           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1400         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  28
* EL156.cbl
  1401         16  CP-REPORTED-DT        PIC XX.
  1402         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1403         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1404         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1405                                     COMP-3.
  1406         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1407                                     COMP-3.
  1408         16  CP-CDT-METHOD         PIC X.
  1409           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1410           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1411           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1412         16  CP-CLAIM-TYPE         PIC X.
  1413           88  CP-AH-CLAIM                         VALUE 'A'.
  1414           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1415         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1416                                     COMP-3.
  1417         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1418                                     COMP-3.
  1419         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1420                                     COMP-3.
  1421         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1422                                     COMP-3.
  1423         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1424                                     COMP-3.
  1425         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1426                                     COMP-3.
  1427         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1428                                     COMP-3.
  1429         16  CP-REM-TERM-METHOD    PIC X.
  1430           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1431           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1432           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1433           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1434           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1435           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1436           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1437         16  CP-EARNING-METHOD     PIC X.
  1438           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1439           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1440           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1441           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1442           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1443           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1444           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1445           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1446           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1447           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1448           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1449           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1450           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1451           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1452         16  CP-PROCESS-TYPE       PIC X.
  1453           88  CP-CLAIM                            VALUE '1'.
  1454           88  CP-CANCEL                           VALUE '2'.
  1455           88  CP-ISSUE                            VALUE '3'.
  1456         16  CP-SPECIAL-CALC-CD    PIC X.
  1457           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1458           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  29
* EL156.cbl
  1459           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1460           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1461           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1462           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1463           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1464           88  CP-FARM-PLAN                    VALUE 'F'.
  1465           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1466           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1467           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1468           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1469           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1470           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1471           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1472           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1473           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1474           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1475                                                     'W' 'X'.
  1476           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1477           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1478           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1479           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1480           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1481           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1482           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1483           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1484           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1485           88  CP-CSL-METH-1                   VALUE '5'.
  1486           88  CP-CSL-METH-2                   VALUE '6'.
  1487           88  CP-CSL-METH-3                   VALUE '7'.
  1488           88  CP-CSL-METH-4                   VALUE '8'.
  1489
  1490         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1491                                     COMP-3.
  1492         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1493         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1494         16  CP-STATE              PIC XX          VALUE SPACE.
  1495         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1496         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1497           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1498               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1499         16  CP-R78-OPTION         PIC X.
  1500           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1501           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1502
  1503         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1504         16  CP-IBNR-RESERVE-SW    PIC X.
  1505         16  CP-CLAIM-STATUS       PIC X.
  1506         16  CP-RATE-FILE          PIC X.
  1507         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1508                                     COMP-3.
  1509
  1510         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1511         16  CP-AH-OVERRIDE-CODE   PIC X.
  1512
  1513         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1514                                     COMP-3.
  1515         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1516                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  30
* EL156.cbl
  1517         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1518                                     COMP-3.
  1519         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1520                                     COMP-3.
  1521         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1522                                     COMP-3.
  1523         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1524                                  PIC S9(7)V99 COMP-3.
  1525
  1526         16  CP-PAID-FROM-DATE     PIC X(02).
  1527         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1528         16  CP-EXT-DAYS-CALC      PIC X.
  1529           88  CP-EXT-NO-CHG                   VALUE ' '.
  1530           88  CP-EXT-CHG-LF                   VALUE '1'.
  1531           88  CP-EXT-CHG-AH                   VALUE '2'.
  1532           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1533         16  CP-DOMICILE-STATE     PIC XX.
  1534         16  CP-CARRIER            PIC X.
  1535         16  CP-REIN-FLAG          PIC X.
  1536         16  CP-REM-TRM-CALC-OPTION PIC X.
  1537           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1538                      '2' '3' '4' '5'.
  1539           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1540           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1541           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1542           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1543           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1544           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1545           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1546           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1547         16  CP-SIG-SWITCH         PIC X.
  1548         16  CP-RATING-METHOD      PIC X.
  1549           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1550           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1551           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1552           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1553           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1554           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1555           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1556           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1557           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1558         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1559                                     COMP-3.
  1560         16  CP-BEN-CATEGORY       PIC X.
  1561         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1562         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1563                                   PIC S99V9(5) COMP-3.
  1564         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1565         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1566                                   PIC S99V9(5) COMP-3.
  1567         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1568         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1569         16  CP-EXPIRE-DT          PIC XX.
  1570         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1571         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1572         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1573         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1574         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  31
* EL156.cbl
  1575             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1576             88  CP-CALC-CLP              VALUE 'C'.
  1577         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1578         16  CP-CANCEL-REASON      PIC X.
  1579         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1580         16  CP-PMT-MODE           PIC X.
  1581         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1582         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1583         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1584         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1585         16  FILLER                PIC X.
  1586
  1587***************    OUTPUT FROM ELRESV   ************************
  1588
  1589         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1590
  1591         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1592                                     COMP-3.
  1593         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1594                                     COMP-3.
  1595         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1596                                     COMP-3.
  1597         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1598                                     COMP-3.
  1599         16  FILLER                PIC X(09).
  1600***************    OUTPUT FROM ELRTRM   *************************
  1601
  1602         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1603                                     COMP-3.
  1604         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1605                                     COMP-3.
  1606         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1607                                     COMP-3.
  1608         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1609                                     COMP-3.
  1610         16  FILLER                PIC X(12).
  1611
  1612***************    OUTPUT FROM ELRAMT   *************************
  1613
  1614         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1615                                     COMP-3.
  1616         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1617                                     COMP-3.
  1618         16  FILLER                PIC X(12).
  1619
  1620***************    OUTPUT FROM ELRATE   *************************
  1621
  1622         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1623                                     COMP-3.
  1624         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1625                                     COMP-3.
  1626         16  CP-MORTALITY-CODE     PIC X(4).
  1627         16  CP-RATE-EDIT-FLAG     PIC X.
  1628             88  CP-RATES-NEED-APR                  VALUE '1'.
  1629         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1630                                     COMP-3.
  1631         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1632         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  32
* EL156.cbl
  1633         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1634                                   PIC S9(7)V99 COMP-3.
  1635         16  FILLER                PIC X(07).
  1636
  1637***************    OUTPUT FROM ELRFND   *************************
  1638
  1639         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1640                                     COMP-3.
  1641         16  CP-REFUND-TYPE-USED   PIC X.
  1642           88  CP-R-AS-R78                         VALUE '1'.
  1643           88  CP-R-AS-PRORATA                     VALUE '2'.
  1644           88  CP-R-AS-CALIF                       VALUE '3'.
  1645           88  CP-R-AS-TEXAS                       VALUE '4'.
  1646           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1647           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1648           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1649           88  CP-R-AS-MEAN                        VALUE '8'.
  1650           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1651           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1652           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1653           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1654           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1655           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1656         16  FILLER                PIC X(12).
  1657
  1658***************    OUTPUT FROM ELEARN   *************************
  1659
  1660         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1661                                     COMP-3.
  1662         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1663                                     COMP-3.
  1664         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1665                                     COMP-3.
  1666         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1667                                     COMP-3.
  1668         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1669                                     COMP-3.
  1670         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1671                                     COMP-3.
  1672         16  CP-EARNING-TYPE-USED  PIC X.
  1673           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1674           88  CP-E-AS-R78                         VALUE '1'.
  1675           88  CP-E-AS-PRORATA                     VALUE '2'.
  1676           88  CP-E-AS-TEXAS                       VALUE '4'.
  1677           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1678           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1679           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1680           88  CP-E-AS-MEAN                        VALUE '8'.
  1681           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1682         16  FILLER                PIC X(12).
  1683
  1684***************    OUTPUT FROM ELPMNT   *************************
  1685
  1686         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1687                                     COMP-3.
  1688         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1689                                     COMP-3.
  1690         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  33
* EL156.cbl
  1691
  1692***************   MISC WORK AREAS    *****************************
  1693         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1694                                     COMP-3.
  1695         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1696                                     COMP-3.
  1697         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1698                                     COMP-3.
  1699         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1700                                     COMP-3.
  1701         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1702                                     COMP-3.
  1703         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1704                                     COMP-3.
  1705         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1706             88  OPEN-RATE-FILE                   VALUE 'O'.
  1707             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1708             88  IO-ERROR                         VALUE 'E'.
  1709
  1710         16  CP-FIRST-PAY-DATE     PIC XX.
  1711
  1712         16  CP-JOINT-INDICATOR    PIC X.
  1713
  1714         16  CP-RESERVE-REMAINING-TERM
  1715                                   PIC S9(4)V9    VALUE ZERO
  1716                                     COMP-3.
  1717
  1718         16  CP-INSURED-BIRTH-DT   PIC XX.
  1719
  1720         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1721                                     COMP-3.
  1722
  1723         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1724                                     COMP-3.
  1725
  1726         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1727                                     COMP-3.
  1728
  1729         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1730                                     COMP-3.
  1731
  1732         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1733                                     COMP-3.
  1734
  1735         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1736                                     COMP-3.
  1737
  1738         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1739                                     COMP-3.
  1740
  1741         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1742             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1743
  1744         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1745                                     COMP-3.
  1746         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1747                                     COMP-3.
  1748         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  34
* EL156.cbl
  1749         16  cp-extra-periods      pic 9 value zeros.
  1750         16  cp-net-only-state     pic x value spaces.
  1751         16  FILLER                PIC X(13).
  1752******************************************************************
  1753*    COPY ELCICALC.
  1754******************************************************************
  1755*                                                                *
  1756*                           ELCCICALC.                           *
  1757*                            VMOD=2.001                          *
  1758*                                                                *
  1759*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1760*                 CALCULATION MODULE                             *
  1761*                                                                *
  1762*  PASSED TO ELCLMI                                              *
  1763*  -----------------                                             *
  1764*  STATE                                                         *
  1765*  PRODUCT                                                       *
  1766*  COVERAGE                                                      *
  1767*  EFFECTIVE DATE                                                *
  1768*  INCURRED DATE                                                 *
  1769*  ESTABLISHED DATE                                              *
  1770*  LAST PAID DATE                                                *
  1771*  REPORTED DATE                                                 *
  1772*  CLAIM PAYMENT AMOUNT                                          *
  1773*                                                                *
  1774*  RETURNED FROM ELRTRM                                          *
  1775*  ---------------------                                         *
  1776*  RETURN CODE                                                   *
  1777*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1778*  CLAIM INTEREST AMOUNT                                         *
  1779*----------------------------------------------------------------*
  1780*----------------------------------------------------------------*
  1781*                 LENGTH = 100                                   *
  1782*                                                                *
  1783******************************************************************
  1784******************************************************************
  1785*                   C H A N G E   L O G
  1786*
  1787* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1788*-----------------------------------------------------------------
  1789*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1790* EFFECTIVE    NUMBER
  1791*-----------------------------------------------------------------
  1792* 120905    2004040700004  PEMA  NEW COPYBOOK
  1793* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1794******************************************************************
  1795
  1796 01  CLAIM-INT-PASS-AREA.
  1797     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1798                                     COMP.
  1799
  1800     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1801       88  NO-CI-ERROR                             VALUE ZERO.
  1802       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1803       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1804       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1805       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1806       88  CP-AMT-LT-5000                          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  35
* EL156.cbl
  1807       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1808       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1809       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1810       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1811***********************  INPUT AREAS ****************************
  1812
  1813     12  CP-CALCULATION-AREA.
  1814         16  CP-COMPANY-CD         PIC X.
  1815         16  CP-STATE              PIC XX.
  1816         16  CP-PRODUCT            PIC XX.
  1817         16  CP-COVERAGE           PIC XX.
  1818         16  CP-INC-DT             PIC XX.
  1819         16  CP-EST-DT             PIC XX.
  1820         16  CP-LSTPD-DT           PIC XX.
  1821         16  CP-RPT-DT             PIC XX.
  1822         16  CP-PRF-DT             PIC XX.
  1823         16  CP-EFF-DT             PIC XX.
  1824         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1825         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1826         16  FILLER                PIC X(37).
  1827
  1828***************    OUTPUT FROM ELCLMI   ************************
  1829
  1830         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1831
  1832         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1833         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1834         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1835         16  FILLER                PIC X(19).
  1836******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  36
* EL156.cbl
  1838*    COPY ELCATTR.
  1839******************************************************************
  1840*                                                                *
  1841*                            ELCATTR.                            *
  1842*                            VMOD=2.001                          *
  1843*                                                                *
  1844*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1845*                                                                *
  1846*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1847*                                                                *
  1848*                   POS 1   P=PROTECTED                          *
  1849*                           U=UNPROTECTED                        *
  1850*                           S=ASKIP                              *
  1851*                   POS 2   A=ALPHA/NUMERIC                      *
  1852*                           N=NUMERIC                            *
  1853*                   POS 3   N=NORMAL                             *
  1854*                           B=BRIGHT                             *
  1855*                           D=DARK                               *
  1856*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1857*                           OF=MODIFIED DATA TAG OFF             *
  1858*                                                                *
  1859*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1860******************************************************************
  1861 01  ATTRIBUTE-LIST.
  1862     12  AL-PABOF            PIC X       VALUE 'Y'.
  1863     12  AL-PABON            PIC X       VALUE 'Z'.
  1864     12  AL-PADOF            PIC X       VALUE '%'.
  1865     12  AL-PADON            PIC X       VALUE '_'.
  1866     12  AL-PANOF            PIC X       VALUE '-'.
  1867     12  AL-PANON            PIC X       VALUE '/'.
  1868     12  AL-SABOF            PIC X       VALUE '8'.
  1869     12  AL-SABON            PIC X       VALUE '9'.
  1870     12  AL-SADOF            PIC X       VALUE '@'.
  1871     12  AL-SADON            PIC X       VALUE QUOTE.
  1872     12  AL-SANOF            PIC X       VALUE '0'.
  1873     12  AL-SANON            PIC X       VALUE '1'.
  1874     12  AL-UABOF            PIC X       VALUE 'H'.
  1875     12  AL-UABON            PIC X       VALUE 'I'.
  1876     12  AL-UADOF            PIC X       VALUE '<'.
  1877     12  AL-UADON            PIC X       VALUE '('.
  1878     12  AL-UANOF            PIC X       VALUE ' '.
  1879     12  AL-UANON            PIC X       VALUE 'A'.
  1880     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1881     12  AL-UNBON            PIC X       VALUE 'R'.
  1882     12  AL-UNDOF            PIC X       VALUE '*'.
  1883     12  AL-UNDON            PIC X       VALUE ')'.
  1884     12  AL-UNNOF            PIC X       VALUE '&'.
  1885     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  37
* EL156.cbl
  1887*    COPY ELCEMIB.
  1888******************************************************************
  1889*                                                                *
  1890*                                                                *
  1891*                            ELCEMIB.                            *
  1892*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1893*                            VMOD=2.005                          *
  1894*                                                                *
  1895*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1896*                                                                *
  1897******************************************************************
  1898 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1899     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1900     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1901     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1902     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1903     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1904     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1905     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1906     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1907     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1908         88  EMI-NO-ERRORS                    VALUE '1'.
  1909         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1910         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1911     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1912         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1913     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1914         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1915         88  EMI-AREA1-FULL                   VALUE '2'.
  1916     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1917         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1918         88  EMI-AREA2-FULL                   VALUE '2'.
  1919     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1920         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1921         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1922         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1923         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1924         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1925     12  EMI-ERROR-LINES.
  1926         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1927         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1928         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1929         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1930             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1931                 24  EMI-ERR-NUM         PIC X(4).
  1932                 24  EMI-FILLER          PIC X.
  1933                 24  EMI-SEV             PIC X.
  1934                 24  FILLER              PIC X.
  1935             20  FILLER                  PIC X(02).
  1936     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1937         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1938             20  EMI-ERROR-NUMBER    PIC X(4).
  1939             20  EMI-FILL            PIC X.
  1940             20  EMI-SEVERITY        PIC X.
  1941             20  FILLER              PIC X.
  1942             20  EMI-ERROR-TEXT.
  1943                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1944                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  38
* EL156.cbl
  1945     12  EMI-SEVERITY-SAVE           PIC X.
  1946         88  EMI-NOTE                    VALUE 'N'.
  1947         88  EMI-WARNING                 VALUE 'W'.
  1948         88  EMI-FORCABLE                VALUE 'F'.
  1949         88  EMI-FATAL                   VALUE 'X'.
  1950     12  EMI-MESSAGE-FLAG            PIC X.
  1951         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1952         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1953     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1954     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1955         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1956         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1957         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1958     12  emi-claim-no                pic x(7).
  1959     12  emi-claim-type              pic x(6).
  1960     12  FILLER                      PIC X(124)  VALUE SPACES.
  1961     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1962     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1963     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1964     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  39
* EL156.cbl
  1966*    COPY ELCLNKLT.
  1967******************************************************************
  1968*                                                                *
  1969*                                                                *
  1970*                           ELCLNKLT                             *
  1971*                            VMOD=2.003                          *
  1972*                                                                *
  1973*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1974*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1975*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1976*                                                                *
  1977*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1978*   COMPLETING THE REQUIRED FIELDS.                              *
  1979*                                                                *
  1980*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1981*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1982*                              9999 INDICATES AN UNKNOWN ABEND   *
  1983*                                   WAS DETECTED.                *
  1984*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1985*                              CODES FOUND IN THE ERROR FILE.    *
  1986******************************************************************
  1987 01  W-1523-LINKDATA.
  1988     12  W-1523-COMMON-PI-DATA.
  1989         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1990         16  FILLER              PIC  X(67).
  1991         16  W-1523-COMPANY-CD   PIC  X(01).
  1992         16  FILLER              PIC  X(10).
  1993         16  W-1523-CONTROL-IN-PROGRESS.
  1994             20  W-1523-CARRIER  PIC  X(01).
  1995             20  W-1523-GROUPING PIC  X(06).
  1996             20  W-1523-STATE    PIC  X(02).
  1997             20  W-1523-ACCOUNT  PIC  X(10).
  1998             20  W-1523-CLAIM-CERT-GRP.
  1999                 24  W-1523-CLAIM-NO
  2000                                 PIC  X(07).
  2001                 24  W-1523-CERT-NO.
  2002                     28  W-1523-CERT-PRIME
  2003                                 PIC  X(10).
  2004                     28  W-1523-CERT-SFX
  2005                                 PIC  X(01).
  2006                 24  W-1523-CERT-EFF-DT
  2007                                 PIC  X(02).
  2008         16  FILLER              PIC X(265).
  2009
  2010     12  W-1523-WORK-AREA.
  2011         16  W-1523-FORM-NUMBER  PIC  X(04).
  2012         16  W-1523-NUMBER-COPIES
  2013                                 PIC  9(01).
  2014         16  W-1523-ADDR-TYPE    PIC  X(02).
  2015         16  W-1523-FOLLOW-UP-DATE
  2016                                 PIC  X(02).
  2017         16  W-1523-RESEND-DATE  PIC  X(02).
  2018         16  W-1523-ERROR-CODE   PIC  9(04).
  2019             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  2020             88  W-1523-FATAL-ERROR
  2021                                    VALUES  0006 0013 0042
  2022                                            0154 0168 0169
  2023                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  40
* EL156.cbl
  2024                                            0179 0186 0281
  2025                                            0332 2055 3697
  2026                                            3698 3699 3770
  2027                                            3771 3772 7675
  2028                                            9106 9808 9883
  2029                                            9887.
  2030             88  W-1523-STOP-ERRORS
  2031                                    VALUES  0013 0042 0154
  2032                                            0168 0169 0172
  2033                                            0281 0332 2055
  2034                                            3698 3699 7675
  2035                                            9106 9808 9883
  2036                                            9999.
  2037         16  W-1523-REASON       PIC  X(70).
  2038         16  W-1523-ARCHIVE-NUMBER
  2039                                 PIC  9(08).
  2040     12  W-1523-POINTER-AREA.
  2041         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2042         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2043         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2044         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2045         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  41
* EL156.cbl
  2047*    COPY ELCNWA.
  2048*****************************************************************
  2049*                                                               *
  2050*                                                               *
  2051*                            ELCNWA.                            *
  2052*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2053*                            VMOD=2.003                         *
  2054*                                                               *
  2055*            M O V E   N A M E   W O R K   A R E A.             *
  2056*                                                               *
  2057*****************************************************************.
  2058
  2059 01  WS-NAME-WORK-AREA.
  2060     05  WS-INSURED-LAST-NAME        PIC X(15).
  2061     05  WS-INSURED-1ST-NAME         PIC X(12).
  2062     05  WS-INSURED-MID-INIT         PIC X.
  2063
  2064     05  WS-NAME-WORK.
  2065         10  WS-NW                   PIC X
  2066             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2067
  2068     05  WS-NAME-WORK2.
  2069         10  WS-NW2                  PIC X
  2070             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2071                                        NWA-INDEX0.
  2072
  2073     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2074                                     COMP-3.
  2075
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  42
* EL156.cbl
  2077*    COPY ELCDMO.
  2078******************************************************************
  2079*                                                                *
  2080*                                                                *
  2081*                            ELCDMO.                             *
  2082*                            VMOD=2.004                          *
  2083*                                                                *
  2084*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2085*        COMMUNICATION AREA                                      *
  2086*   FILE TYPE = NA                                               *
  2087*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2088*                                                                *
  2089******************************************************************
  2090 01  DMO-COMMUNICATION-AREA.
  2091     12  DM-RECORD-TYPE                  PIC  X(02).
  2092             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2093             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2094             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2095     12  DM-DIST-CODE                    PIC  X(04).
  2096     12  DM-MAIL-CODE                    PIC  X(05).
  2097     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2098     12  DM-INSURED-NAME                 PIC  X(30).
  2099     12  DM-CLAIM-NO                     PIC  X(07).
  2100     12  DM-CLAIM-TYPE                   PIC  X.
  2101
  2102     12  DM-STATUS-DATA-AREA.
  2103         16  DM-CLAIM-STATUS             PIC  X.
  2104             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2105             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2106             88  DM-CLOSED                        VALUE '3'.
  2107             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2108             88  DM-DEFAULT                       VALUE '9'.
  2109         16  DM-STATUS-DATE              PIC  X(08).
  2110******YYYYMMDD
  2111         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2112             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2113             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2114             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2115             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2116             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2117             88  DM-RE-OPENED                     VALUE 'R'.
  2118             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2119             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2120             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2121         16  DM-STAT-CARRIER             PIC X.
  2122
  2123     12  DM-DRAFT-DATA-AREA.
  2124         16  DM-PAYMENT-TYPE             PIC  X.
  2125             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2126         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2127         16  DM-PAYMENT-DATE             PIC  X(08).
  2128******YYYYMMDD
  2129         16  DM-CERT-NO                  PIC  X(11).
  2130         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2131         16  DM-CARRIER                  PIC  X.
  2132
  2133     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  43
* EL156.cbl
  2135*    COPY ELCDMDCD.
  2136******************************************************************
  2137*                                                                *
  2138*                                                                *
  2139*                            ELCDMDCD.                           *
  2140*                            VMOD=2.001                          *
  2141*                                                                *
  2142*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2143*       COMMUNICATIONS AREA                                      *
  2144*                                                                *
  2145******************************************************************
  2146 01  CD-COMMUNICATION-AREA.
  2147     12  CD-SYSTEM-ID            PIC  X(02).
  2148         88 CD-CLAIMS                      VALUE 'CL'.
  2149         88 CD-CREDIT                      VALUE 'CR'.
  2150     12  CD-RECORD-TYPE          PIC  X(02).
  2151         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2152         88 CD-EOB-CODE                    VALUE 'EO'.
  2153         88 CD-ICD9-CODE                   VALUE 'I9'.
  2154         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2155         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2156         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2157         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2158         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2159     12  CD-RECORD-KEY           PIC  X(06).
  2160         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2161     12  CD-RETURN-CODE          PIC  X(02).
  2162     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2163     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2164     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2165     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  44
* EL156.cbl
  2167*    COPY ELCDCTB.
  2168******************************************************************
  2169*                                                                *
  2170*                                                                *
  2171*                            ELCDCTB.                            *
  2172*                            VMOD=2.002                          *
  2173*                                                                *
  2174*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2175*       COMMUNICATIONS AREA                                      *
  2176*                                                                *
  2177******************************************************************
  2178 01  DCT-COMMUNICATION-AREA.
  2179     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2180     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2181     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2182     12  DCT-PRODUCT-CODE         PIC  X(02).
  2183     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2184     12  DCT-RETURN-CODE          PIC  X(02).
  2185     12  DCT-MAIL-CODE            PIC  X(05).
  2186     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2187     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  45
* EL156.cbl
  2189 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2190 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2191 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2192 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  46
* EL156.cbl
  2194*    COPY ELCINTF.
  2195******************************************************************
  2196*                                                                *
  2197*                                                                *
  2198*                            ELCINTF.                            *
  2199*                            VMOD=2.017                          *
  2200*                                                                *
  2201*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2202*                                                                *
  2203*       LENGTH = 1024                                            *
  2204*                                                                *
  2205******************************************************************
  2206*                   C H A N G E   L O G
  2207*
  2208* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2209*-----------------------------------------------------------------
  2210*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2211* EFFECTIVE    NUMBER
  2212*-----------------------------------------------------------------
  2213* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2214******************************************************************
  2215 01  PROGRAM-INTERFACE-BLOCK.
  2216     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2217     12  PI-CALLING-PROGRAM              PIC X(8).
  2218     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2219     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2220     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2221     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2222     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2223     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2224     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2225     12  PI-COMPANY-ID                   PIC XXX.
  2226     12  PI-COMPANY-CD                   PIC X.
  2227
  2228     12  PI-COMPANY-PASSWORD             PIC X(8).
  2229
  2230     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2231
  2232     12  PI-CONTROL-IN-PROGRESS.
  2233         16  PI-CARRIER                  PIC X.
  2234         16  PI-GROUPING                 PIC X(6).
  2235         16  PI-STATE                    PIC XX.
  2236         16  PI-ACCOUNT                  PIC X(10).
  2237         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2238                                         PIC X(10).
  2239         16  PI-CLAIM-CERT-GRP.
  2240             20  PI-CLAIM-NO             PIC X(7).
  2241             20  PI-CERT-NO.
  2242                 25  PI-CERT-PRIME       PIC X(10).
  2243                 25  PI-CERT-SFX         PIC X.
  2244             20  PI-CERT-EFF-DT          PIC XX.
  2245         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2246             20  PI-PLAN-CODE            PIC X(2).
  2247             20  PI-REVISION-NUMBER      PIC X(3).
  2248             20  PI-PLAN-EFF-DT          PIC X(2).
  2249             20  PI-PLAN-EXP-DT          PIC X(2).
  2250             20  FILLER                  PIC X(11).
  2251         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  47
* EL156.cbl
  2252             20  PI-OE-REFERENCE-1.
  2253                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2254                 25  PI-OE-REF-1-SUFF    PIC XX.
  2255
  2256     12  PI-SESSION-IN-PROGRESS          PIC X.
  2257         88  CLAIM-SESSION                   VALUE '1'.
  2258         88  CREDIT-SESSION                  VALUE '2'.
  2259         88  WARRANTY-SESSION                VALUE '3'.
  2260         88  MORTGAGE-SESSION                VALUE '4'.
  2261         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2262
  2263
  2264*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2265
  2266     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2267     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2268
  2269     12  PI-CREDIT-USER                  PIC X.
  2270         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2271         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2272
  2273     12  PI-CLAIM-USER                   PIC X.
  2274         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2275         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2276
  2277     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2278         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2279         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2280         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2281         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2282         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2283
  2284     12  PI-PROCESSOR-ID                 PIC X(4).
  2285
  2286     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2287
  2288     12  PI-MEMBER-CAPTION               PIC X(10).
  2289
  2290     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2291         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2292
  2293     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2294     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2295     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2296     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2297
  2298     12  PI-AH-OVERRIDE-L1               PIC X.
  2299     12  PI-AH-OVERRIDE-L2               PIC XX.
  2300     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2301     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2302
  2303     12  PI-NEW-SYSTEM                   PIC X(2).
  2304
  2305     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2306     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2307         88  PI-USES-PAID-TO                 VALUE '1'.
  2308     12  PI-CRDTCRD-SYSTEM.
  2309         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  48
* EL156.cbl
  2310             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2311             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2312         16  PI-CC-MONTH-END-DT          PIC XX.
  2313     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2314
  2315     12  PI-OE-REFERENCE-2.
  2316         16  PI-OE-REF-2-PRIME           PIC X(10).
  2317         16  PI-OE-REF-2-SUFF            PIC X.
  2318
  2319     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2320
  2321     12  PI-LANGUAGE-TYPE                PIC X.
  2322             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2323             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2324             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2325
  2326     12  PI-POLICY-LINKAGE-IND           PIC X.
  2327         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2328         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2329                                                   LOW-VALUES.
  2330
  2331     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2332     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2333         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2334         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2335
  2336     12  PI-PROCESSOR-CSR-IND            PIC X.
  2337         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2338         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2339
  2340     12  FILLER                          PIC X(3).
  2341
  2342     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2343
  2344     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2345         PI-SYSTEM-LEVEL.
  2346
  2347         16  PI-ENTRY-CODES.
  2348             20  PI-ENTRY-CD-1           PIC X.
  2349             20  PI-ENTRY-CD-2           PIC X.
  2350
  2351         16  PI-RETURN-CODES.
  2352             20  PI-RETURN-CD-1          PIC X.
  2353             20  PI-RETURN-CD-2          PIC X.
  2354
  2355         16  PI-UPDATE-STATUS-SAVE.
  2356             20  PI-UPDATE-BY            PIC X(4).
  2357             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2358
  2359         16  PI-LOWER-CASE-LETTERS       PIC X.
  2360             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2361
  2362*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2363*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2364*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2365
  2366         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2367             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  49
* EL156.cbl
  2368             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2369             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2370             88  ACCNT-CNTL                  VALUE '3'.
  2371             88  CARR-ACCNT-CNTL             VALUE '4'.
  2372
  2373         16  PI-PROCESSOR-CAP-LIST.
  2374             20  PI-SYSTEM-CONTROLS.
  2375                24 PI-SYSTEM-DISPLAY     PIC X.
  2376                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2377                24 PI-SYSTEM-MODIFY      PIC X.
  2378                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2379             20  FILLER                  PIC XX.
  2380             20  PI-DISPLAY-CAP          PIC X.
  2381                 88  DISPLAY-CAP             VALUE 'Y'.
  2382             20  PI-MODIFY-CAP           PIC X.
  2383                 88  MODIFY-CAP              VALUE 'Y'.
  2384             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2385                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2386             20  PI-FORCE-CAP            PIC X.
  2387                 88  FORCE-CAP               VALUE 'Y'.
  2388
  2389         16  PI-PROGRAM-CONTROLS.
  2390             20  PI-PGM-PRINT-OPT        PIC X.
  2391             20  PI-PGM-FORMAT-OPT       PIC X.
  2392             20  PI-PGM-PROCESS-OPT      PIC X.
  2393             20  PI-PGM-TOTALS-OPT       PIC X.
  2394
  2395         16  PI-HELP-INTERFACE.
  2396             20  PI-LAST-ERROR-NO        PIC X(4).
  2397             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2398
  2399         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2400             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2401
  2402         16  PI-CR-CONTROL-IN-PROGRESS.
  2403             20  PI-CR-CARRIER           PIC X.
  2404             20  PI-CR-GROUPING          PIC X(6).
  2405             20  PI-CR-STATE             PIC XX.
  2406             20  PI-CR-ACCOUNT           PIC X(10).
  2407             20  PI-CR-FIN-RESP          PIC X(10).
  2408             20  PI-CR-TYPE              PIC X.
  2409
  2410         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2411
  2412         16  PI-CR-MONTH-END-DT          PIC XX.
  2413
  2414         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2415             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2416             88  PI-ZERO-CARRIER             VALUE '1'.
  2417             88  PI-ZERO-GROUPING            VALUE '2'.
  2418             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2419
  2420         16  PI-CARRIER-SECURITY         PIC X.
  2421             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2422
  2423         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2424             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2425             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  50
* EL156.cbl
  2426
  2427         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2428             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2429                                         INDEXED BY PI-ACCESS-NDX
  2430                                         PIC X.
  2431
  2432         16  PI-GA-BILLING-CONTROL       PIC X.
  2433             88  PI-GA-BILLING               VALUE '1'.
  2434
  2435         16  PI-MAIL-PROCESSING          PIC X.
  2436             88  PI-MAIL-YES                 VALUE 'Y'.
  2437
  2438         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2439
  2440         16  PI-AR-SYSTEM.
  2441             20  PI-AR-PROCESSING-CNTL   PIC X.
  2442                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2443             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2444             20  PI-AR-MONTH-END-DT      PIC XX.
  2445
  2446         16  PI-MP-SYSTEM.
  2447             20  PI-MORTGAGE-USER            PIC X.
  2448                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2449                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2450             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2451                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2452                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2453                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2454                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2455                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2456             20  PI-MP-MONTH-END-DT          PIC XX.
  2457             20  PI-MP-REFERENCE-NO.
  2458                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2459                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2460
  2461         16  PI-LABEL-CONTROL            PIC X(01).
  2462             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2463             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2464
  2465         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2466             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2467
  2468         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2469             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2470             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2471
  2472         16  FILLER                      PIC X(14).
  2473
  2474     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2475******************************************************************
  2476     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2477         16  PI-SAVE-FORM        PIC X(12).
  2478         16  PI-ACCT-KEY         PIC X(26).
  2479         16  PI-PAYEE-NAME       PIC X(30).
  2480         16  PI-DAILY-RATE       PIC S9(3)V99.
  2481         16  PI-MONTH-END-SAVE   PIC XX.
  2482         16  PI-BENEFIT-SAVE.
  2483             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  51
* EL156.cbl
  2484             20  PI-BEN-TYPE     PIC X.
  2485         16  PI-MANUAL-SW        PIC 9.
  2486         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2487         16  PI-PASS-SW          PIC X.
  2488         16  PI-PFKEY-USED       PIC X.
  2489         16  PI-CK-ASSIGN        PIC X.
  2490         16  PI-FATAL-COUNT      PIC 99.
  2491         16  PI-FORCE-COUNT      PIC 99.
  2492         16  PI-SAVE-INPUT.
  2493             20  PI-PMTTYPE      PIC X.
  2494             20  PI-PAYEE.
  2495                 24  PI-PAYEE-TYPE PIC X.
  2496                 24  PI-PAYEE-SEQ  PIC X.
  2497                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2498                   PI-PAYEE-SEQ    PIC S9.
  2499             20  PI-PMTNOTE1     PIC X(60).
  2500             20  PI-PMTNOTE2     PIC X(60).
  2501             20  PI-OFFLINE      PIC X.
  2502             20  PI-ECHECKNO     PIC X(7).
  2503             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2504                 28  PI-ECHECKNO-N     PIC X.
  2505                 28  PI-ECHECKNO-6     PIC X(6).
  2506             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2507                 24  PI-ECHECKNO-CR    PIC XX.
  2508                 24  PI-ECHECKNO-5     PIC X(5).
  2509             20  PI-HOLDTIL      PIC 9(6).
  2510             20  PI-EPYFROM      PIC 9(6).
  2511             20  PI-EPYTHRU      PIC 9(6).
  2512             20  PI-EDAYS        PIC S9(5).
  2513             20  PI-EPYAMT       PIC S9(7)V99.
  2514             20  PI-ERESV        PIC S9(7)V99.
  2515             20  PI-EEXPENS      PIC 9(6)V99.
  2516             20  PI-ETYPE        PIC X.
  2517             20  PI-CASH         PIC X.
  2518             20  PI-GROUPED      PIC X.
  2519             20  PI-INT-RATE     PIC S99V9(5).
  2520             20  PI-AIGFROM      PIC 9(6).
  2521             20  PI-LOAN-NO      PIC X(20).
  2522             20  PI-PROOF-DATE   PIC 9(6).
  2523             20  PI-PRINT-EOB-YN PIC X.
  2524             20  PI-PRINT-CLM-FRM-YN PIC X.
  2525             20  PI-PRINT-SURVEY-YN PIC X.
  2526             20  PI-SPECIAL-RELEASE-YN PIC X.
  2527             20  pi-int-to-rem-borr pic x.
  2528         16  PI-SAVE-COMPUTED.
  2529             20  PI-CCHECKNO     PIC X(7).
  2530             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2531                 28  PI-CCHECKNO-N     PIC X.
  2532                 28  PI-CCHECKNO-6     PIC X(6).
  2533             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2534                 24  PI-CCHECKNO-CR    PIC XX.
  2535                 24  PI-CCHECKNO-5     PIC X(5).
  2536             20  PI-CPYFROM      PIC XX.
  2537             20  PI-CPYTHRU      PIC XX.
  2538             20  PI-CDAYS        PIC S9(5).
  2539             20  PI-CPYAMT       PIC S9(7)V99.
  2540             20  PI-CRESV        PIC 9(6)V99.
  2541             20  PI-CEXPENS      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  52
* EL156.cbl
  2542             20  PI-PMT-APPR-SW  PIC X.
  2543                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2544                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2545                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2546         16  PI-PREV-CLMNO       PIC X(7).
  2547         16  PI-LF-COVERAGE-TYPE PIC X.
  2548         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2549         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2550         16  PI-PROVISIONAL-IND  PIC X.
  2551             88 PI-PROV-PMT      VALUE 'P'.
  2552         16  PI-PREV-TRLR-KEY    PIC X(22).
  2553         16  PI-SPLIT-PMT-SW     PIC X.
  2554         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2555         16  PI-ACTIVITY-CODE    PIC 99.
  2556         16  PI-RESET-SW         PIC X.
  2557         16  PI-SPECIAL-BEN-SW   PIC X.
  2558             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2559         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2560         16  PI-EXP-DT           PIC XX.
  2561         16  PI-LOAN-DUE-DAY     PIC 99.
  2562         16  PI-3RD-PARTY-SW     PIC X.
  2563         16  PI-LOAN-UPDATE-SW   PIC X.
  2564
  2565         16  PI-DMD-DATA.
  2566             20  PI-SV-CERT-KEY       PIC X(21).
  2567             20  PI-SV-CERT-NO        PIC X(11).
  2568             20  PI-SV-BEN            PIC X(10).
  2569             20  PI-SV-CCN            PIC X(16).
  2570             20  PI-INTEREST-PAID-IND PIC X.
  2571                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2572             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2573             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2574             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2575             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2576         16  PI-AT-EOB-CODES.
  2577             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2578         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2579         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2580         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2581         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2582         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2583         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2584         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2585         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2586         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2587         16  PI-LF-BENEFIT-CD         PIC X(2).
  2588         16  PI-EOB-CODES-EXIST PIC X.
  2589         16  PI-SET-NOTE2-MDT   PIC X.
  2590         16  PI-VFY-2ND-BENE          PIC X.
  2591         16  PI-CLM-TYPE              PIC X.
  2592         16  PI-APPROVAL-LEVEL        PIC X.
  2593         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2594         16  PI-REAUDIT-NEEDED        PIC X.
  2595         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2596         16  PI-AH-BENEFIT-CD         PIC XX.
  2597         16  pi-ah-term               pic s999 comp-3.
  2598         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2599         16  pi-max-ext               pic 999.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  53
* EL156.cbl
  2600         16  pi-max-ext-used          pic x.
  2601         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2602         16  PI-JOINT-COV-IND         PIC X.
  2603             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2604             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2605         16  PI-JOINT-INSURED-IND     PIC X.
  2606             88  PI-JOINT-INSURED        VALUE 'Y'.
  2607             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2608         16  pi-int-payees-name       pic x(30).
  2609         16  PI-RB-JOINT-COV-IND      PIC X.
  2610             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.
  2611             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.
  2612         16  pi-ach-payment           pic x.
  2613*00781          16  FILLER                   PIC X(176).
  2614*052506         16  FILLER                   PIC X(161).
  2615*031808         16  FILLER                   PIC X(154).
  2616*091808         16  FILLER                   PIC X(152).
  2617*041710         16  FILLER                   PIC X(94).
  2618         16  FILLER                   PIC X(34).
  2619
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  54
* EL156.cbl
  2621*    COPY ELCJPFX.
  2622******************************************************************
  2623*                                                                *
  2624*                                                                *
  2625*                            ELCJPFX.                            *
  2626*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2627*                            VMOD=2.002                          *
  2628*                                                                *
  2629*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2630*                                                                *
  2631*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2632*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2633*        ELCNTL - CONTROL FILE                                   *
  2634*        ELMSTR - CLAIM MASTERS                                  *
  2635*        ELTRLR - ACTIVITY TRAILERS                              *
  2636*        ELCHKQ - CHECK QUE                                      *
  2637******************************************************************
  2638 01  JOURNAL-RECORD.
  2639     12  jp-date                     pic s9(5) comp-3.
  2640     12  jp-time                     pic s9(7) comp-3.
  2641     12  JP-USER-ID                  PIC X(4).
  2642     12  JP-FILE-ID                  PIC X(8).
  2643     12  JP-PROGRAM-ID               PIC X(8).
  2644     12  JP-RECORD-TYPE              PIC X.
  2645         88 JP-ADD              VALUE 'A'.
  2646         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2647         88 JP-AFTER-CHANGE     VALUE 'C'.
  2648         88 JP-DELETE           VALUE 'D'.
  2649         88 JP-GENERIC-DELETE   VALUE 'G'.
  2650         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2651         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2652     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2653     12  JP-RECORD-AREA
  2654
  2655
  2656                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  55
* EL156.cbl
  2658*    COPY ELCAID.
  2659******************************************************************
  2660*                                                                *
  2661*                            ELCAID.                             *
  2662*                            VMOD=2.001                          *
  2663*                                                                *
  2664*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2665*                                                                *
  2666*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2667*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2668******************************************************************
  2669
  2670 01  DFHAID.
  2671   02  DFHNULL   PIC  X  VALUE  ' '.
  2672   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2673   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2674   02  DFHPEN    PIC  X  VALUE  '='.
  2675   02  DFHOPID   PIC  X  VALUE  'W'.
  2676   02  DFHPA1    PIC  X  VALUE  '%'.
  2677   02  DFHPA2    PIC  X  VALUE  '>'.
  2678   02  DFHPA3    PIC  X  VALUE  ','.
  2679   02  DFHPF1    PIC  X  VALUE  '1'.
  2680   02  DFHPF2    PIC  X  VALUE  '2'.
  2681   02  DFHPF3    PIC  X  VALUE  '3'.
  2682   02  DFHPF4    PIC  X  VALUE  '4'.
  2683   02  DFHPF5    PIC  X  VALUE  '5'.
  2684   02  DFHPF6    PIC  X  VALUE  '6'.
  2685   02  DFHPF7    PIC  X  VALUE  '7'.
  2686   02  DFHPF8    PIC  X  VALUE  '8'.
  2687   02  DFHPF9    PIC  X  VALUE  '9'.
  2688   02  DFHPF10   PIC  X  VALUE  ':'.
  2689   02  DFHPF11   PIC  X  VALUE  '#'.
  2690   02  DFHPF12   PIC  X  VALUE  '@'.
  2691   02  DFHPF13   PIC  X  VALUE  'A'.
  2692   02  DFHPF14   PIC  X  VALUE  'B'.
  2693   02  DFHPF15   PIC  X  VALUE  'C'.
  2694   02  DFHPF16   PIC  X  VALUE  'D'.
  2695   02  DFHPF17   PIC  X  VALUE  'E'.
  2696   02  DFHPF18   PIC  X  VALUE  'F'.
  2697   02  DFHPF19   PIC  X  VALUE  'G'.
  2698   02  DFHPF20   PIC  X  VALUE  'H'.
  2699   02  DFHPF21   PIC  X  VALUE  'I'.
  2700*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2701   02  DFHPF22   PIC  X  VALUE  '['.
  2702   02  DFHPF23   PIC  X  VALUE  '.'.
  2703   02  DFHPF24   PIC  X  VALUE  '<'.
  2704   02  DFHMSRE   PIC  X  VALUE  'X'.
  2705   02  DFHSTRF   PIC  X  VALUE  'h'.
  2706   02  DFHTRIG   PIC  X  VALUE  '"'.
  2707 01  FILLER    REDEFINES DFHAID.
  2708     12  FILLER              PIC X(8).
  2709     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  56
* EL156.cbl
  2711*    COPY EL156S.
  2712 01  EL156AI.
  2713     05  FILLER            PIC  X(0012).
  2714*    -------------------------------
  2715     05  RUNDTEAL PIC S9(0004) COMP.
  2716     05  RUNDTEAF PIC  X(0001).
  2717     05  FILLER REDEFINES RUNDTEAF.
  2718         10  RUNDTEAA PIC  X(0001).
  2719     05  RUNDTEAI PIC  X(0008).
  2720*    -------------------------------
  2721     05  RUNTIMAL PIC S9(0004) COMP.
  2722     05  RUNTIMAF PIC  X(0001).
  2723     05  FILLER REDEFINES RUNTIMAF.
  2724         10  RUNTIMAA PIC  X(0001).
  2725     05  RUNTIMAI PIC  X(0005).
  2726*    -------------------------------
  2727     05  SEQUL PIC S9(0004) COMP.
  2728     05  SEQUF PIC  X(0001).
  2729     05  FILLER REDEFINES SEQUF.
  2730         10  SEQUA PIC  X(0001).
  2731     05  SEQUI PIC  X(0010).
  2732*    -------------------------------
  2733     05  CLMNOL PIC S9(0004) COMP.
  2734     05  CLMNOF PIC  X(0001).
  2735     05  FILLER REDEFINES CLMNOF.
  2736         10  CLMNOA PIC  X(0001).
  2737     05  CLMNOI PIC  X(0007).
  2738*    -------------------------------
  2739     05  CARRL PIC S9(0004) COMP.
  2740     05  CARRF PIC  X(0001).
  2741     05  FILLER REDEFINES CARRF.
  2742         10  CARRA PIC  X(0001).
  2743     05  CARRI PIC  X(0001).
  2744*    -------------------------------
  2745     05  CERTNOL PIC S9(0004) COMP.
  2746     05  CERTNOF PIC  X(0001).
  2747     05  FILLER REDEFINES CERTNOF.
  2748         10  CERTNOA PIC  X(0001).
  2749     05  CERTNOI PIC  X(0010).
  2750*    -------------------------------
  2751     05  SUFXL PIC S9(0004) COMP.
  2752     05  SUFXF PIC  X(0001).
  2753     05  FILLER REDEFINES SUFXF.
  2754         10  SUFXA PIC  X(0001).
  2755     05  SUFXI PIC  X(0001).
  2756*    -------------------------------
  2757     05  CLMTYPL PIC S9(0004) COMP.
  2758     05  CLMTYPF PIC  X(0001).
  2759     05  FILLER REDEFINES CLMTYPF.
  2760         10  CLMTYPA PIC  X(0001).
  2761     05  CLMTYPI PIC  X(0006).
  2762*    -------------------------------
  2763     05  CLMSTATL PIC S9(0004) COMP.
  2764     05  CLMSTATF PIC  X(0001).
  2765     05  FILLER REDEFINES CLMSTATF.
  2766         10  CLMSTATA PIC  X(0001).
  2767     05  CLMSTATI PIC  X(0006).
  2768*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  57
* EL156.cbl
  2769     05  LSTNMEL PIC S9(0004) COMP.
  2770     05  LSTNMEF PIC  X(0001).
  2771     05  FILLER REDEFINES LSTNMEF.
  2772         10  LSTNMEA PIC  X(0001).
  2773     05  LSTNMEI PIC  X(0015).
  2774*    -------------------------------
  2775     05  FSTNMEL PIC S9(0004) COMP.
  2776     05  FSTNMEF PIC  X(0001).
  2777     05  FILLER REDEFINES FSTNMEF.
  2778         10  FSTNMEA PIC  X(0001).
  2779     05  FSTNMEI PIC  X(0012).
  2780*    -------------------------------
  2781     05  MINITL PIC S9(0004) COMP.
  2782     05  MINITF PIC  X(0001).
  2783     05  FILLER REDEFINES MINITF.
  2784         10  MINITA PIC  X(0001).
  2785     05  MINITI PIC  X(0001).
  2786*    -------------------------------
  2787     05  PRIMHDGL PIC S9(0004) COMP.
  2788     05  PRIMHDGF PIC  X(0001).
  2789     05  FILLER REDEFINES PRIMHDGF.
  2790         10  PRIMHDGA PIC  X(0001).
  2791     05  PRIMHDGI PIC  X(0012).
  2792*    -------------------------------
  2793     05  PCERTNOL PIC S9(0004) COMP.
  2794     05  PCERTNOF PIC  X(0001).
  2795     05  FILLER REDEFINES PCERTNOF.
  2796         10  PCERTNOA PIC  X(0001).
  2797     05  PCERTNOI PIC  X(0010).
  2798*    -------------------------------
  2799     05  PSUFXL PIC S9(0004) COMP.
  2800     05  PSUFXF PIC  X(0001).
  2801     05  FILLER REDEFINES PSUFXF.
  2802         10  PSUFXA PIC  X(0001).
  2803     05  PSUFXI PIC  X(0001).
  2804*    -------------------------------
  2805     05  STATUSL PIC S9(0004) COMP.
  2806     05  STATUSF PIC  X(0001).
  2807     05  FILLER REDEFINES STATUSF.
  2808         10  STATUSA PIC  X(0001).
  2809     05  STATUSI PIC  X(0010).
  2810*    -------------------------------
  2811     05  LOANHL PIC S9(0004) COMP.
  2812     05  LOANHF PIC  X(0001).
  2813     05  FILLER REDEFINES LOANHF.
  2814         10  LOANHA PIC  X(0001).
  2815     05  LOANHI PIC  X(0014).
  2816*    -------------------------------
  2817     05  LOANNOL PIC S9(0004) COMP.
  2818     05  LOANNOF PIC  X(0001).
  2819     05  FILLER REDEFINES LOANNOF.
  2820         10  LOANNOA PIC  X(0001).
  2821     05  LOANNOI PIC  X(0025).
  2822*    -------------------------------
  2823     05  DUEDAYHL PIC S9(0004) COMP.
  2824     05  DUEDAYHF PIC  X(0001).
  2825     05  FILLER REDEFINES DUEDAYHF.
  2826         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  58
* EL156.cbl
  2827     05  DUEDAYHI PIC  X(0008).
  2828*    -------------------------------
  2829     05  DUEDAYL PIC S9(0004) COMP.
  2830     05  DUEDAYF PIC  X(0001).
  2831     05  FILLER REDEFINES DUEDAYF.
  2832         10  DUEDAYA PIC  X(0001).
  2833     05  DUEDAYI PIC  X(0002).
  2834*    -------------------------------
  2835     05  ZINTHL PIC S9(0004) COMP.
  2836     05  ZINTHF PIC  X(0001).
  2837     05  FILLER REDEFINES ZINTHF.
  2838         10  ZINTHA PIC  X(0001).
  2839     05  ZINTHI PIC  X(0009).
  2840*    -------------------------------
  2841     05  ZINTL PIC S9(0004) COMP.
  2842     05  ZINTF PIC  X(0001).
  2843     05  FILLER REDEFINES ZINTF.
  2844         10  ZINTA PIC  X(0001).
  2845     05  ZINTI PIC  99V99999.
  2846*    -------------------------------
  2847     05  PTHRHDGL PIC S9(0004) COMP.
  2848     05  PTHRHDGF PIC  X(0001).
  2849     05  FILLER REDEFINES PTHRHDGF.
  2850         10  PTHRHDGA PIC  X(0001).
  2851     05  PTHRHDGI PIC  X(0014).
  2852*    -------------------------------
  2853     05  PDTHRUL PIC S9(0004) COMP.
  2854     05  PDTHRUF PIC  X(0001).
  2855     05  FILLER REDEFINES PDTHRUF.
  2856         10  PDTHRUA PIC  X(0001).
  2857     05  PDTHRUI PIC  X(0008).
  2858*    -------------------------------
  2859     05  TOTPAIDL PIC S9(0004) COMP.
  2860     05  TOTPAIDF PIC  X(0001).
  2861     05  FILLER REDEFINES TOTPAIDF.
  2862         10  TOTPAIDA PIC  X(0001).
  2863     05  TOTPAIDI PIC  X(0010).
  2864*    -------------------------------
  2865     05  COVERL PIC S9(0004) COMP.
  2866     05  COVERF PIC  X(0001).
  2867     05  FILLER REDEFINES COVERF.
  2868         10  COVERA PIC  X(0001).
  2869     05  COVERI PIC  X(0010).
  2870*    -------------------------------
  2871     05  INCURL PIC S9(0004) COMP.
  2872     05  INCURF PIC  X(0001).
  2873     05  FILLER REDEFINES INCURF.
  2874         10  INCURA PIC  X(0001).
  2875     05  INCURI PIC  X(0008).
  2876*    -------------------------------
  2877     05  LSTDTEL PIC S9(0004) COMP.
  2878     05  LSTDTEF PIC  X(0001).
  2879     05  FILLER REDEFINES LSTDTEF.
  2880         10  LSTDTEA PIC  X(0001).
  2881     05  LSTDTEI PIC  X(0008).
  2882*    -------------------------------
  2883     05  CRTSTATL PIC S9(0004) COMP.
  2884     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  59
* EL156.cbl
  2885     05  FILLER REDEFINES CRTSTATF.
  2886         10  CRTSTATA PIC  X(0001).
  2887     05  CRTSTATI PIC  X(0010).
  2888*    -------------------------------
  2889     05  EFFECTL PIC S9(0004) COMP.
  2890     05  EFFECTF PIC  X(0001).
  2891     05  FILLER REDEFINES EFFECTF.
  2892         10  EFFECTA PIC  X(0001).
  2893     05  EFFECTI PIC  X(0008).
  2894*    -------------------------------
  2895     05  TERMSL PIC S9(0004) COMP.
  2896     05  TERMSF PIC  X(0001).
  2897     05  FILLER REDEFINES TERMSF.
  2898         10  TERMSA PIC  X(0001).
  2899     05  TERMSI PIC  X(0011).
  2900*    -------------------------------
  2901     05  STACCTL PIC S9(0004) COMP.
  2902     05  STACCTF PIC  X(0001).
  2903     05  FILLER REDEFINES STACCTF.
  2904         10  STACCTA PIC  X(0001).
  2905     05  STACCTI PIC  X(0013).
  2906*    -------------------------------
  2907     05  EXPDTEHL PIC S9(0004) COMP.
  2908     05  EXPDTEHF PIC  X(0001).
  2909     05  FILLER REDEFINES EXPDTEHF.
  2910         10  EXPDTEHA PIC  X(0001).
  2911     05  EXPDTEHI PIC  X(0014).
  2912*    -------------------------------
  2913     05  EXPDTEL PIC S9(0004) COMP.
  2914     05  EXPDTEF PIC  X(0001).
  2915     05  FILLER REDEFINES EXPDTEF.
  2916         10  EXPDTEA PIC  X(0001).
  2917     05  EXPDTEI PIC  X(0008).
  2918*    -------------------------------
  2919     05  BENECAPL PIC S9(0004) COMP.
  2920     05  BENECAPF PIC  X(0001).
  2921     05  FILLER REDEFINES BENECAPF.
  2922         10  BENECAPA PIC  X(0001).
  2923     05  BENECAPI PIC  X(0013).
  2924*    -------------------------------
  2925     05  BENEL PIC S9(0004) COMP.
  2926     05  BENEF PIC  X(0001).
  2927     05  FILLER REDEFINES BENEF.
  2928         10  BENEA PIC  X(0001).
  2929     05  BENEI PIC  X(0009).
  2930*    -------------------------------
  2931     05  FORMTYPL PIC S9(0004) COMP.
  2932     05  FORMTYPF PIC  X(0001).
  2933     05  FILLER REDEFINES FORMTYPF.
  2934         10  FORMTYPA PIC  X(0001).
  2935     05  FORMTYPI PIC  X(0001).
  2936*    -------------------------------
  2937     05  PMTTYPEL PIC S9(0004) COMP.
  2938     05  PMTTYPEF PIC  X(0001).
  2939     05  FILLER REDEFINES PMTTYPEF.
  2940         10  PMTTYPEA PIC  X(0001).
  2941     05  PMTTYPEI PIC  X(0001).
  2942*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  60
* EL156.cbl
  2943     05  PAYEEL PIC S9(0004) COMP.
  2944     05  PAYEEF PIC  X(0001).
  2945     05  FILLER REDEFINES PAYEEF.
  2946         10  PAYEEA PIC  X(0001).
  2947     05  PAYEEI PIC  X(0002).
  2948*    -------------------------------
  2949     05  CHECKNOL PIC S9(0004) COMP.
  2950     05  CHECKNOF PIC  X(0001).
  2951     05  FILLER REDEFINES CHECKNOF.
  2952         10  CHECKNOA PIC  X(0001).
  2953     05  CHECKNOI PIC  X(0007).
  2954*    -------------------------------
  2955     05  OFFLINEL PIC S9(0004) COMP.
  2956     05  OFFLINEF PIC  X(0001).
  2957     05  FILLER REDEFINES OFFLINEF.
  2958         10  OFFLINEA PIC  X(0001).
  2959     05  OFFLINEI PIC  X(0001).
  2960*    -------------------------------
  2961     05  HOLDTILL PIC S9(0004) COMP.
  2962     05  HOLDTILF PIC  X(0001).
  2963     05  FILLER REDEFINES HOLDTILF.
  2964         10  HOLDTILA PIC  X(0001).
  2965     05  HOLDTILI PIC  X(0008).
  2966*    -------------------------------
  2967     05  NOTE1L PIC S9(0004) COMP.
  2968     05  NOTE1F PIC  X(0001).
  2969     05  FILLER REDEFINES NOTE1F.
  2970         10  NOTE1A PIC  X(0001).
  2971     05  NOTE1I PIC  X(0060).
  2972*    -------------------------------
  2973     05  ITRB1L PIC S9(0004) COMP.
  2974     05  ITRB1F PIC  X(0001).
  2975     05  FILLER REDEFINES ITRB1F.
  2976         10  ITRB1A PIC  X(0001).
  2977     05  ITRB1I PIC  X(0008).
  2978*    -------------------------------
  2979     05  NOTE2L PIC S9(0004) COMP.
  2980     05  NOTE2F PIC  X(0001).
  2981     05  FILLER REDEFINES NOTE2F.
  2982         10  NOTE2A PIC  X(0001).
  2983     05  NOTE2I PIC  X(0060).
  2984*    -------------------------------
  2985     05  ITRB2L PIC S9(0004) COMP.
  2986     05  ITRB2F PIC  X(0001).
  2987     05  FILLER REDEFINES ITRB2F.
  2988         10  ITRB2A PIC  X(0001).
  2989     05  ITRB2I PIC  X(0010).
  2990*    -------------------------------
  2991     05  EOBYNL PIC S9(0004) COMP.
  2992     05  EOBYNF PIC  X(0001).
  2993     05  FILLER REDEFINES EOBYNF.
  2994         10  EOBYNA PIC  X(0001).
  2995     05  EOBYNI PIC  X(0001).
  2996*    -------------------------------
  2997     05  CLMFMYNL PIC S9(0004) COMP.
  2998     05  CLMFMYNF PIC  X(0001).
  2999     05  FILLER REDEFINES CLMFMYNF.
  3000         10  CLMFMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  61
* EL156.cbl
  3001     05  CLMFMYNI PIC  X(0001).
  3002*    -------------------------------
  3003     05  SURVYYNL PIC S9(0004) COMP.
  3004     05  SURVYYNF PIC  X(0001).
  3005     05  FILLER REDEFINES SURVYYNF.
  3006         10  SURVYYNA PIC  X(0001).
  3007     05  SURVYYNI PIC  X(0001).
  3008*    -------------------------------
  3009     05  SPRELYNL PIC S9(0004) COMP.
  3010     05  SPRELYNF PIC  X(0001).
  3011     05  FILLER REDEFINES SPRELYNF.
  3012         10  SPRELYNA PIC  X(0001).
  3013     05  SPRELYNI PIC  X(0001).
  3014*    -------------------------------
  3015     05  PINTHL PIC S9(0004) COMP.
  3016     05  PINTHF PIC  X(0001).
  3017     05  FILLER REDEFINES PINTHF.
  3018         10  PINTHA PIC  X(0001).
  3019     05  PINTHI PIC  X(0004).
  3020*    -------------------------------
  3021     05  PINTL PIC S9(0004) COMP.
  3022     05  PINTF PIC  X(0001).
  3023     05  FILLER REDEFINES PINTF.
  3024         10  PINTA PIC  X(0001).
  3025     05  PINTI PIC  X(0008).
  3026*    -------------------------------
  3027     05  ITRBYNL PIC S9(0004) COMP.
  3028     05  ITRBYNF PIC  X(0001).
  3029     05  FILLER REDEFINES ITRBYNF.
  3030         10  ITRBYNA PIC  X(0001).
  3031     05  ITRBYNI PIC  X(0001).
  3032*    -------------------------------
  3033     05  PROOFDTL PIC S9(0004) COMP.
  3034     05  PROOFDTF PIC  X(0001).
  3035     05  FILLER REDEFINES PROOFDTF.
  3036         10  PROOFDTA PIC  X(0001).
  3037     05  PROOFDTI PIC  X(0008).
  3038*    -------------------------------
  3039     05  AIGFRMHL PIC S9(0004) COMP.
  3040     05  AIGFRMHF PIC  X(0001).
  3041     05  FILLER REDEFINES AIGFRMHF.
  3042         10  AIGFRMHA PIC  X(0001).
  3043     05  AIGFRMHI PIC  X(0012).
  3044*    -------------------------------
  3045     05  AIGFROML PIC S9(0004) COMP.
  3046     05  AIGFROMF PIC  X(0001).
  3047     05  FILLER REDEFINES AIGFROMF.
  3048         10  AIGFROMA PIC  X(0001).
  3049     05  AIGFROMI PIC  X(0008).
  3050*    -------------------------------
  3051     05  PMTHDGAL PIC S9(0004) COMP.
  3052     05  PMTHDGAF PIC  X(0001).
  3053     05  FILLER REDEFINES PMTHDGAF.
  3054         10  PMTHDGAA PIC  X(0001).
  3055     05  PMTHDGAI PIC  X(0066).
  3056*    -------------------------------
  3057     05  EPYFROML PIC S9(0004) COMP.
  3058     05  EPYFROMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  62
* EL156.cbl
  3059     05  FILLER REDEFINES EPYFROMF.
  3060         10  EPYFROMA PIC  X(0001).
  3061     05  EPYFROMI PIC  X(0008).
  3062*    -------------------------------
  3063     05  EPYTHRUL PIC S9(0004) COMP.
  3064     05  EPYTHRUF PIC  X(0001).
  3065     05  FILLER REDEFINES EPYTHRUF.
  3066         10  EPYTHRUA PIC  X(0001).
  3067     05  EPYTHRUI PIC  X(0008).
  3068*    -------------------------------
  3069     05  EDAYSL PIC S9(0004) COMP.
  3070     05  EDAYSF PIC  X(0001).
  3071     05  FILLER REDEFINES EDAYSF.
  3072         10  EDAYSA PIC  X(0001).
  3073     05  EDAYSI PIC  S9(6).
  3074*    -------------------------------
  3075     05  EPYAMTL PIC S9(0004) COMP.
  3076     05  EPYAMTF PIC  X(0001).
  3077     05  FILLER REDEFINES EPYAMTF.
  3078         10  EPYAMTA PIC  X(0001).
  3079     05  EPYAMTI PIC  S9(8)V99.
  3080*    -------------------------------
  3081     05  ERESVL PIC S9(0004) COMP.
  3082     05  ERESVF PIC  X(0001).
  3083     05  FILLER REDEFINES ERESVF.
  3084         10  ERESVA PIC  X(0001).
  3085     05  ERESVI PIC  S9(7)V99.
  3086*    -------------------------------
  3087     05  ETYPEL PIC S9(0004) COMP.
  3088     05  ETYPEF PIC  X(0001).
  3089     05  FILLER REDEFINES ETYPEF.
  3090         10  ETYPEA PIC  X(0001).
  3091     05  ETYPEI PIC  X(0001).
  3092*    -------------------------------
  3093     05  EEXPENSL PIC S9(0004) COMP.
  3094     05  EEXPENSF PIC  X(0001).
  3095     05  FILLER REDEFINES EEXPENSF.
  3096         10  EEXPENSA PIC  X(0001).
  3097     05  EEXPENSI PIC  9(6)V99.
  3098*    -------------------------------
  3099     05  CPYFROML PIC S9(0004) COMP.
  3100     05  CPYFROMF PIC  X(0001).
  3101     05  FILLER REDEFINES CPYFROMF.
  3102         10  CPYFROMA PIC  X(0001).
  3103     05  CPYFROMI PIC  X(0008).
  3104*    -------------------------------
  3105     05  CPYTHRUL PIC S9(0004) COMP.
  3106     05  CPYTHRUF PIC  X(0001).
  3107     05  FILLER REDEFINES CPYTHRUF.
  3108         10  CPYTHRUA PIC  X(0001).
  3109     05  CPYTHRUI PIC  X(0008).
  3110*    -------------------------------
  3111     05  CDAYSL PIC S9(0004) COMP.
  3112     05  CDAYSF PIC  X(0001).
  3113     05  FILLER REDEFINES CDAYSF.
  3114         10  CDAYSA PIC  X(0001).
  3115     05  CDAYSI PIC  9(6).
  3116*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  63
* EL156.cbl
  3117     05  CPYAMTL PIC S9(0004) COMP.
  3118     05  CPYAMTF PIC  X(0001).
  3119     05  FILLER REDEFINES CPYAMTF.
  3120         10  CPYAMTA PIC  X(0001).
  3121     05  CPYAMTI PIC  S9(8)V99.
  3122*    -------------------------------
  3123     05  CRESVL PIC S9(0004) COMP.
  3124     05  CRESVF PIC  X(0001).
  3125     05  FILLER REDEFINES CRESVF.
  3126         10  CRESVA PIC  X(0001).
  3127     05  CRESVI PIC  9(6)V99.
  3128*    -------------------------------
  3129     05  CEXPENSL PIC S9(0004) COMP.
  3130     05  CEXPENSF PIC  X(0001).
  3131     05  FILLER REDEFINES CEXPENSF.
  3132         10  CEXPENSA PIC  X(0001).
  3133     05  CEXPENSI PIC  9(6)V99.
  3134*    -------------------------------
  3135     05  ERRMSG0L PIC S9(0004) COMP.
  3136     05  ERRMSG0F PIC  X(0001).
  3137     05  FILLER REDEFINES ERRMSG0F.
  3138         10  ERRMSG0A PIC  X(0001).
  3139     05  ERRMSG0I PIC  X(0072).
  3140*    -------------------------------
  3141     05  ERRMSG1L PIC S9(0004) COMP.
  3142     05  ERRMSG1F PIC  X(0001).
  3143     05  FILLER REDEFINES ERRMSG1F.
  3144         10  ERRMSG1A PIC  X(0001).
  3145     05  ERRMSG1I PIC  X(0072).
  3146*    -------------------------------
  3147     05  ERRMSG2L PIC S9(0004) COMP.
  3148     05  ERRMSG2F PIC  X(0001).
  3149     05  FILLER REDEFINES ERRMSG2F.
  3150         10  ERRMSG2A PIC  X(0001).
  3151     05  ERRMSG2I PIC  X(0072).
  3152*    -------------------------------
  3153     05  ENTERPFL PIC S9(0004) COMP.
  3154     05  ENTERPFF PIC  X(0001).
  3155     05  FILLER REDEFINES ENTERPFF.
  3156         10  ENTERPFA PIC  X(0001).
  3157     05  ENTERPFI PIC  99.
  3158*    -------------------------------
  3159     05  PF6TITL PIC S9(0004) COMP.
  3160     05  PF6TITF PIC  X(0001).
  3161     05  FILLER REDEFINES PF6TITF.
  3162         10  PF6TITA PIC  X(0001).
  3163     05  PF6TITI PIC  X(0016).
  3164 01  EL156AO REDEFINES EL156AI.
  3165     05  FILLER            PIC  X(0012).
  3166*    -------------------------------
  3167     05  FILLER            PIC  X(0003).
  3168     05  RUNDTEAO PIC  X(0008).
  3169*    -------------------------------
  3170     05  FILLER            PIC  X(0003).
  3171     05  RUNTIMAO PIC  99.99.
  3172*    -------------------------------
  3173     05  FILLER            PIC  X(0003).
  3174     05  SEQUO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  64
* EL156.cbl
  3175*    -------------------------------
  3176     05  FILLER            PIC  X(0003).
  3177     05  CLMNOO PIC  X(0007).
  3178*    -------------------------------
  3179     05  FILLER            PIC  X(0003).
  3180     05  CARRO PIC  X(0001).
  3181*    -------------------------------
  3182     05  FILLER            PIC  X(0003).
  3183     05  CERTNOO PIC  X(0010).
  3184*    -------------------------------
  3185     05  FILLER            PIC  X(0003).
  3186     05  SUFXO PIC  X(0001).
  3187*    -------------------------------
  3188     05  FILLER            PIC  X(0003).
  3189     05  CLMTYPO PIC  X(0006).
  3190*    -------------------------------
  3191     05  FILLER            PIC  X(0003).
  3192     05  CLMSTATO PIC  X(0006).
  3193*    -------------------------------
  3194     05  FILLER            PIC  X(0003).
  3195     05  LSTNMEO PIC  X(0015).
  3196*    -------------------------------
  3197     05  FILLER            PIC  X(0003).
  3198     05  FSTNMEO PIC  X(0012).
  3199*    -------------------------------
  3200     05  FILLER            PIC  X(0003).
  3201     05  MINITO PIC  X(0001).
  3202*    -------------------------------
  3203     05  FILLER            PIC  X(0003).
  3204     05  PRIMHDGO PIC  X(0012).
  3205*    -------------------------------
  3206     05  FILLER            PIC  X(0003).
  3207     05  PCERTNOO PIC  X(0010).
  3208*    -------------------------------
  3209     05  FILLER            PIC  X(0003).
  3210     05  PSUFXO PIC  X(0001).
  3211*    -------------------------------
  3212     05  FILLER            PIC  X(0003).
  3213     05  STATUSO PIC  X(0010).
  3214*    -------------------------------
  3215     05  FILLER            PIC  X(0003).
  3216     05  LOANHO PIC  X(0014).
  3217*    -------------------------------
  3218     05  FILLER            PIC  X(0003).
  3219     05  LOANNOO PIC  X(0025).
  3220*    -------------------------------
  3221     05  FILLER            PIC  X(0003).
  3222     05  DUEDAYHO PIC  X(0008).
  3223*    -------------------------------
  3224     05  FILLER            PIC  X(0003).
  3225     05  DUEDAYO PIC  X(0002).
  3226*    -------------------------------
  3227     05  FILLER            PIC  X(0003).
  3228     05  ZINTHO PIC  X(0009).
  3229*    -------------------------------
  3230     05  FILLER            PIC  X(0003).
  3231     05  ZINTO PIC  9.99999.
  3232*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  65
* EL156.cbl
  3233     05  FILLER            PIC  X(0003).
  3234     05  PTHRHDGO PIC  X(0014).
  3235*    -------------------------------
  3236     05  FILLER            PIC  X(0003).
  3237     05  PDTHRUO PIC  X(0008).
  3238*    -------------------------------
  3239     05  FILLER            PIC  X(0003).
  3240     05  TOTPAIDO PIC  Z(6).99-.
  3241*    -------------------------------
  3242     05  FILLER            PIC  X(0003).
  3243     05  COVERO PIC  X(0010).
  3244*    -------------------------------
  3245     05  FILLER            PIC  X(0003).
  3246     05  INCURO PIC  X(0008).
  3247*    -------------------------------
  3248     05  FILLER            PIC  X(0003).
  3249     05  LSTDTEO PIC  X(0008).
  3250*    -------------------------------
  3251     05  FILLER            PIC  X(0003).
  3252     05  CRTSTATO PIC  X(0010).
  3253*    -------------------------------
  3254     05  FILLER            PIC  X(0003).
  3255     05  EFFECTO PIC  X(0008).
  3256*    -------------------------------
  3257     05  FILLER            PIC  X(0003).
  3258     05  TERMSO PIC  X(0011).
  3259*    -------------------------------
  3260     05  FILLER            PIC  X(0003).
  3261     05  STACCTO PIC  X(0013).
  3262*    -------------------------------
  3263     05  FILLER            PIC  X(0003).
  3264     05  EXPDTEHO PIC  X(0014).
  3265*    -------------------------------
  3266     05  FILLER            PIC  X(0003).
  3267     05  EXPDTEO PIC  X(0008).
  3268*    -------------------------------
  3269     05  FILLER            PIC  X(0003).
  3270     05  BENECAPO PIC  X(0013).
  3271*    -------------------------------
  3272     05  FILLER            PIC  X(0003).
  3273     05  BENEO PIC  Z(6).99.
  3274*    -------------------------------
  3275     05  FILLER            PIC  X(0003).
  3276     05  FORMTYPO PIC  X(0001).
  3277*    -------------------------------
  3278     05  FILLER            PIC  X(0003).
  3279     05  PMTTYPEO PIC  X(0001).
  3280*    -------------------------------
  3281     05  FILLER            PIC  X(0003).
  3282     05  PAYEEO PIC  X(0002).
  3283*    -------------------------------
  3284     05  FILLER            PIC  X(0003).
  3285     05  CHECKNOO PIC  X(0007).
  3286*    -------------------------------
  3287     05  FILLER            PIC  X(0003).
  3288     05  OFFLINEO PIC  X(0001).
  3289*    -------------------------------
  3290     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  66
* EL156.cbl
  3291     05  HOLDTILO PIC  99B99B99.
  3292*    -------------------------------
  3293     05  FILLER            PIC  X(0003).
  3294     05  NOTE1O PIC  X(0060).
  3295*    -------------------------------
  3296     05  FILLER            PIC  X(0003).
  3297     05  ITRB1O PIC  X(0008).
  3298*    -------------------------------
  3299     05  FILLER            PIC  X(0003).
  3300     05  NOTE2O PIC  X(0060).
  3301*    -------------------------------
  3302     05  FILLER            PIC  X(0003).
  3303     05  ITRB2O PIC  X(0010).
  3304*    -------------------------------
  3305     05  FILLER            PIC  X(0003).
  3306     05  EOBYNO PIC  X(0001).
  3307*    -------------------------------
  3308     05  FILLER            PIC  X(0003).
  3309     05  CLMFMYNO PIC  X(0001).
  3310*    -------------------------------
  3311     05  FILLER            PIC  X(0003).
  3312     05  SURVYYNO PIC  X(0001).
  3313*    -------------------------------
  3314     05  FILLER            PIC  X(0003).
  3315     05  SPRELYNO PIC  X(0001).
  3316*    -------------------------------
  3317     05  FILLER            PIC  X(0003).
  3318     05  PINTHO PIC  X(0004).
  3319*    -------------------------------
  3320     05  FILLER            PIC  X(0003).
  3321     05  PINTO PIC  Z,ZZ9.99.
  3322*    -------------------------------
  3323     05  FILLER            PIC  X(0003).
  3324     05  ITRBYNO PIC  X(0001).
  3325*    -------------------------------
  3326     05  FILLER            PIC  X(0003).
  3327     05  PROOFDTO PIC  99B99B99.
  3328*    -------------------------------
  3329     05  FILLER            PIC  X(0003).
  3330     05  AIGFRMHO PIC  X(0012).
  3331*    -------------------------------
  3332     05  FILLER            PIC  X(0003).
  3333     05  AIGFROMO PIC  99B99B99.
  3334*    -------------------------------
  3335     05  FILLER            PIC  X(0003).
  3336     05  PMTHDGAO PIC  X(0066).
  3337*    -------------------------------
  3338     05  FILLER            PIC  X(0003).
  3339     05  EPYFROMO PIC  99B99B99.
  3340*    -------------------------------
  3341     05  FILLER            PIC  X(0003).
  3342     05  EPYTHRUO PIC  99B99B99.
  3343*    -------------------------------
  3344     05  FILLER            PIC  X(0003).
  3345     05  EDAYSO PIC  Z(4)9-.
  3346*    -------------------------------
  3347     05  FILLER            PIC  X(0003).
  3348     05  EPYAMTO PIC  Z(6).99-.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  67
* EL156.cbl
  3349*    -------------------------------
  3350     05  FILLER            PIC  X(0003).
  3351     05  ERESVO PIC  Z(5).99-.
  3352*    -------------------------------
  3353     05  FILLER            PIC  X(0003).
  3354     05  ETYPEO PIC  X(0001).
  3355*    -------------------------------
  3356     05  FILLER            PIC  X(0003).
  3357     05  EEXPENSO PIC  Z(5).99.
  3358*    -------------------------------
  3359     05  FILLER            PIC  X(0003).
  3360     05  CPYFROMO PIC  99B99B99.
  3361*    -------------------------------
  3362     05  FILLER            PIC  X(0003).
  3363     05  CPYTHRUO PIC  99B99B99.
  3364*    -------------------------------
  3365     05  FILLER            PIC  X(0003).
  3366     05  CDAYSO PIC  Z(4)9-.
  3367*    -------------------------------
  3368     05  FILLER            PIC  X(0003).
  3369     05  CPYAMTO PIC  Z(6).99-.
  3370*    -------------------------------
  3371     05  FILLER            PIC  X(0003).
  3372     05  CRESVO PIC  Z(5).99.
  3373*    -------------------------------
  3374     05  FILLER            PIC  X(0003).
  3375     05  CEXPENSO PIC  Z(5).99.
  3376*    -------------------------------
  3377     05  FILLER            PIC  X(0003).
  3378     05  ERRMSG0O PIC  X(0072).
  3379*    -------------------------------
  3380     05  FILLER            PIC  X(0003).
  3381     05  ERRMSG1O PIC  X(0072).
  3382*    -------------------------------
  3383     05  FILLER            PIC  X(0003).
  3384     05  ERRMSG2O PIC  X(0072).
  3385*    -------------------------------
  3386     05  FILLER            PIC  X(0003).
  3387     05  ENTERPFO PIC  X(0002).
  3388*    -------------------------------
  3389     05  FILLER            PIC  X(0003).
  3390     05  PF6TITO PIC  X(0016).
  3391*    -------------------------------
  3392 01  EL156BI REDEFINES EL156AI.
  3393     05  FILLER            PIC  X(0012).
  3394*    -------------------------------
  3395     05  RUNDTEBL PIC S9(0004) COMP.
  3396     05  RUNDTEBF PIC  X(0001).
  3397     05  FILLER REDEFINES RUNDTEBF.
  3398         10  RUNDTEBA PIC  X(0001).
  3399     05  RUNDTEBI PIC  X(0008).
  3400*    -------------------------------
  3401     05  RUNTIMBL PIC S9(0004) COMP.
  3402     05  RUNTIMBF PIC  X(0001).
  3403     05  FILLER REDEFINES RUNTIMBF.
  3404         10  RUNTIMBA PIC  X(0001).
  3405     05  RUNTIMBI PIC  X(0005).
  3406*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  68
* EL156.cbl
  3407     05  PAYDTBL PIC S9(0004) COMP.
  3408     05  PAYDTBF PIC  X(0001).
  3409     05  FILLER REDEFINES PAYDTBF.
  3410         10  PAYDTBA PIC  X(0001).
  3411     05  PAYDTBI PIC  X(0008).
  3412*    -------------------------------
  3413     05  PAYTYPBL PIC S9(0004) COMP.
  3414     05  PAYTYPBF PIC  X(0001).
  3415     05  FILLER REDEFINES PAYTYPBF.
  3416         10  PAYTYPBA PIC  X(0001).
  3417     05  PAYTYPBI PIC  X(0015).
  3418*    -------------------------------
  3419     05  PAYAMTBL PIC S9(0004) COMP.
  3420     05  PAYAMTBF PIC  X(0001).
  3421     05  FILLER REDEFINES PAYAMTBF.
  3422         10  PAYAMTBA PIC  X(0001).
  3423     05  PAYAMTBI PIC  X(0011).
  3424*    -------------------------------
  3425     05  LOANHBL PIC S9(0004) COMP.
  3426     05  LOANHBF PIC  X(0001).
  3427     05  FILLER REDEFINES LOANHBF.
  3428         10  LOANHBA PIC  X(0001).
  3429     05  LOANHBI PIC  X(0012).
  3430*    -------------------------------
  3431     05  LOANNBL PIC S9(0004) COMP.
  3432     05  LOANNBF PIC  X(0001).
  3433     05  FILLER REDEFINES LOANNBF.
  3434         10  LOANNBA PIC  X(0001).
  3435     05  LOANNBI PIC  X(0025).
  3436*    -------------------------------
  3437     05  CKNUMHDL PIC S9(0004) COMP.
  3438     05  CKNUMHDF PIC  X(0001).
  3439     05  FILLER REDEFINES CKNUMHDF.
  3440         10  CKNUMHDA PIC  X(0001).
  3441     05  CKNUMHDI PIC  X(0012).
  3442*    -------------------------------
  3443     05  CKNUMBL PIC S9(0004) COMP.
  3444     05  CKNUMBF PIC  X(0001).
  3445     05  FILLER REDEFINES CKNUMBF.
  3446         10  CKNUMBA PIC  X(0001).
  3447     05  CKNUMBI PIC  X(0007).
  3448*    -------------------------------
  3449     05  AGTHDGL PIC S9(0004) COMP.
  3450     05  AGTHDGF PIC  X(0001).
  3451     05  FILLER REDEFINES AGTHDGF.
  3452         10  AGTHDGA PIC  X(0001).
  3453     05  AGTHDGI PIC  X(0016).
  3454*    -------------------------------
  3455     05  NAMEBL PIC S9(0004) COMP.
  3456     05  NAMEBF PIC  X(0001).
  3457     05  FILLER REDEFINES NAMEBF.
  3458         10  NAMEBA PIC  X(0001).
  3459     05  NAMEBI PIC  X(0030).
  3460*    -------------------------------
  3461     05  NAMEB2L PIC S9(0004) COMP.
  3462     05  NAMEB2F PIC  X(0001).
  3463     05  FILLER REDEFINES NAMEB2F.
  3464         10  NAMEB2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  69
* EL156.cbl
  3465     05  NAMEB2I PIC  X(0030).
  3466*    -------------------------------
  3467     05  ADDR1BL PIC S9(0004) COMP.
  3468     05  ADDR1BF PIC  X(0001).
  3469     05  FILLER REDEFINES ADDR1BF.
  3470         10  ADDR1BA PIC  X(0001).
  3471     05  ADDR1BI PIC  X(0030).
  3472*    -------------------------------
  3473     05  ADDR1B2L PIC S9(0004) COMP.
  3474     05  ADDR1B2F PIC  X(0001).
  3475     05  FILLER REDEFINES ADDR1B2F.
  3476         10  ADDR1B2A PIC  X(0001).
  3477     05  ADDR1B2I PIC  X(0030).
  3478*    -------------------------------
  3479     05  ADDR2BL PIC S9(0004) COMP.
  3480     05  ADDR2BF PIC  X(0001).
  3481     05  FILLER REDEFINES ADDR2BF.
  3482         10  ADDR2BA PIC  X(0001).
  3483     05  ADDR2BI PIC  X(0030).
  3484*    -------------------------------
  3485     05  ADDR2B2L PIC S9(0004) COMP.
  3486     05  ADDR2B2F PIC  X(0001).
  3487     05  FILLER REDEFINES ADDR2B2F.
  3488         10  ADDR2B2A PIC  X(0001).
  3489     05  ADDR2B2I PIC  X(0030).
  3490*    -------------------------------
  3491     05  CITYSTBL PIC S9(0004) COMP.
  3492     05  CITYSTBF PIC  X(0001).
  3493     05  FILLER REDEFINES CITYSTBF.
  3494         10  CITYSTBA PIC  X(0001).
  3495     05  CITYSTBI PIC  X(0030).
  3496*    -------------------------------
  3497     05  CITYST2L PIC S9(0004) COMP.
  3498     05  CITYST2F PIC  X(0001).
  3499     05  FILLER REDEFINES CITYST2F.
  3500         10  CITYST2A PIC  X(0001).
  3501     05  CITYST2I PIC  X(0030).
  3502*    -------------------------------
  3503     05  ZIPBL PIC S9(0004) COMP.
  3504     05  ZIPBF PIC  X(0001).
  3505     05  FILLER REDEFINES ZIPBF.
  3506         10  ZIPBA PIC  X(0001).
  3507     05  ZIPBI PIC  X(0009).
  3508*    -------------------------------
  3509     05  ZIPB2L PIC S9(0004) COMP.
  3510     05  ZIPB2F PIC  X(0001).
  3511     05  FILLER REDEFINES ZIPB2F.
  3512         10  ZIPB2A PIC  X(0001).
  3513     05  ZIPB2I PIC  X(0009).
  3514*    -------------------------------
  3515     05  INTHDBL PIC S9(0004) COMP.
  3516     05  INTHDBF PIC  X(0001).
  3517     05  FILLER REDEFINES INTHDBF.
  3518         10  INTHDBA PIC  X(0001).
  3519     05  INTHDBI PIC  X(0012).
  3520*    -------------------------------
  3521     05  INTAMTBL PIC S9(0004) COMP.
  3522     05  INTAMTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  70
* EL156.cbl
  3523     05  FILLER REDEFINES INTAMTBF.
  3524         10  INTAMTBA PIC  X(0001).
  3525     05  INTAMTBI PIC  X(0011).
  3526*    -------------------------------
  3527     05  PMTHDGBL PIC S9(0004) COMP.
  3528     05  PMTHDGBF PIC  X(0001).
  3529     05  FILLER REDEFINES PMTHDGBF.
  3530         10  PMTHDGBA PIC  X(0001).
  3531     05  PMTHDGBI PIC  X(0034).
  3532*    -------------------------------
  3533     05  CLMNOBL PIC S9(0004) COMP.
  3534     05  CLMNOBF PIC  X(0001).
  3535     05  FILLER REDEFINES CLMNOBF.
  3536         10  CLMNOBA PIC  X(0001).
  3537     05  CLMNOBI PIC  X(0007).
  3538*    -------------------------------
  3539     05  CARRBL PIC S9(0004) COMP.
  3540     05  CARRBF PIC  X(0001).
  3541     05  FILLER REDEFINES CARRBF.
  3542         10  CARRBA PIC  X(0001).
  3543     05  CARRBI PIC  X(0001).
  3544*    -------------------------------
  3545     05  CERTNOBL PIC S9(0004) COMP.
  3546     05  CERTNOBF PIC  X(0001).
  3547     05  FILLER REDEFINES CERTNOBF.
  3548         10  CERTNOBA PIC  X(0001).
  3549     05  CERTNOBI PIC  X(0010).
  3550*    -------------------------------
  3551     05  SUFXBL PIC S9(0004) COMP.
  3552     05  SUFXBF PIC  X(0001).
  3553     05  FILLER REDEFINES SUFXBF.
  3554         10  SUFXBA PIC  X(0001).
  3555     05  SUFXBI PIC  X(0001).
  3556*    -------------------------------
  3557     05  CLMTYPBL PIC S9(0004) COMP.
  3558     05  CLMTYPBF PIC  X(0001).
  3559     05  FILLER REDEFINES CLMTYPBF.
  3560         10  CLMTYPBA PIC  X(0001).
  3561     05  CLMTYPBI PIC  X(0006).
  3562*    -------------------------------
  3563     05  INCURBL PIC S9(0004) COMP.
  3564     05  INCURBF PIC  X(0001).
  3565     05  FILLER REDEFINES INCURBF.
  3566         10  INCURBA PIC  X(0001).
  3567     05  INCURBI PIC  X(0008).
  3568*    -------------------------------
  3569     05  PYFROMBL PIC S9(0004) COMP.
  3570     05  PYFROMBF PIC  X(0001).
  3571     05  FILLER REDEFINES PYFROMBF.
  3572         10  PYFROMBA PIC  X(0001).
  3573     05  PYFROMBI PIC  X(0008).
  3574*    -------------------------------
  3575     05  PYTHRUBL PIC S9(0004) COMP.
  3576     05  PYTHRUBF PIC  X(0001).
  3577     05  FILLER REDEFINES PYTHRUBF.
  3578         10  PYTHRUBA PIC  X(0001).
  3579     05  PYTHRUBI PIC  X(0008).
  3580*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  71
* EL156.cbl
  3581     05  DAYSBL PIC S9(0004) COMP.
  3582     05  DAYSBF PIC  X(0001).
  3583     05  FILLER REDEFINES DAYSBF.
  3584         10  DAYSBA PIC  X(0001).
  3585     05  DAYSBI PIC  X(0005).
  3586*    -------------------------------
  3587     05  BYBL PIC S9(0004) COMP.
  3588     05  BYBF PIC  X(0001).
  3589     05  FILLER REDEFINES BYBF.
  3590         10  BYBA PIC  X(0001).
  3591     05  BYBI PIC  X(0004).
  3592*    -------------------------------
  3593     05  PROOFDBL PIC S9(0004) COMP.
  3594     05  PROOFDBF PIC  X(0001).
  3595     05  FILLER REDEFINES PROOFDBF.
  3596         10  PROOFDBA PIC  X(0001).
  3597     05  PROOFDBI PIC  X(0008).
  3598*    -------------------------------
  3599     05  ACCTBL PIC S9(0004) COMP.
  3600     05  ACCTBF PIC  X(0001).
  3601     05  FILLER REDEFINES ACCTBF.
  3602         10  ACCTBA PIC  X(0001).
  3603     05  ACCTBI PIC  X(0010).
  3604*    -------------------------------
  3605     05  STATEBL PIC S9(0004) COMP.
  3606     05  STATEBF PIC  X(0001).
  3607     05  FILLER REDEFINES STATEBF.
  3608         10  STATEBA PIC  X(0001).
  3609     05  STATEBI PIC  X(0002).
  3610*    -------------------------------
  3611     05  GROUPBL PIC S9(0004) COMP.
  3612     05  GROUPBF PIC  X(0001).
  3613     05  FILLER REDEFINES GROUPBF.
  3614         10  GROUPBA PIC  X(0001).
  3615     05  GROUPBI PIC  X(0006).
  3616*    -------------------------------
  3617     05  ACARRBL PIC S9(0004) COMP.
  3618     05  ACARRBF PIC  X(0001).
  3619     05  FILLER REDEFINES ACARRBF.
  3620         10  ACARRBA PIC  X(0001).
  3621     05  ACARRBI PIC  X(0001).
  3622*    -------------------------------
  3623     05  ACCTNMBL PIC S9(0004) COMP.
  3624     05  ACCTNMBF PIC  X(0001).
  3625     05  FILLER REDEFINES ACCTNMBF.
  3626         10  ACCTNMBA PIC  X(0001).
  3627     05  ACCTNMBI PIC  X(0030).
  3628*    -------------------------------
  3629     05  UNDISBL PIC S9(0004) COMP.
  3630     05  UNDISBF PIC  X(0001).
  3631     05  FILLER REDEFINES UNDISBF.
  3632         10  UNDISBA PIC  X(0001).
  3633     05  UNDISBI PIC  X(0010).
  3634*    -------------------------------
  3635     05  RATEBL PIC S9(0004) COMP.
  3636     05  RATEBF PIC  X(0001).
  3637     05  FILLER REDEFINES RATEBF.
  3638         10  RATEBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  72
* EL156.cbl
  3639     05  RATEBI PIC  X(0006).
  3640*    -------------------------------
  3641     05  ERMSG1BL PIC S9(0004) COMP.
  3642     05  ERMSG1BF PIC  X(0001).
  3643     05  FILLER REDEFINES ERMSG1BF.
  3644         10  ERMSG1BA PIC  X(0001).
  3645     05  ERMSG1BI PIC  X(0072).
  3646*    -------------------------------
  3647     05  ENTPFBL PIC S9(0004) COMP.
  3648     05  ENTPFBF PIC  X(0001).
  3649     05  FILLER REDEFINES ENTPFBF.
  3650         10  ENTPFBA PIC  X(0001).
  3651     05  ENTPFBI PIC  99.
  3652 01  EL156BO REDEFINES EL156AI.
  3653     05  FILLER            PIC  X(0012).
  3654*    -------------------------------
  3655     05  FILLER            PIC  X(0003).
  3656     05  RUNDTEBO PIC  X(0008).
  3657*    -------------------------------
  3658     05  FILLER            PIC  X(0003).
  3659     05  RUNTIMBO PIC  99.99.
  3660*    -------------------------------
  3661     05  FILLER            PIC  X(0003).
  3662     05  PAYDTBO PIC  99B99B99.
  3663*    -------------------------------
  3664     05  FILLER            PIC  X(0003).
  3665     05  PAYTYPBO PIC  X(0015).
  3666*    -------------------------------
  3667     05  FILLER            PIC  X(0003).
  3668     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3669*    -------------------------------
  3670     05  FILLER            PIC  X(0003).
  3671     05  LOANHBO PIC  X(0012).
  3672*    -------------------------------
  3673     05  FILLER            PIC  X(0003).
  3674     05  LOANNBO PIC  X(0025).
  3675*    -------------------------------
  3676     05  FILLER            PIC  X(0003).
  3677     05  CKNUMHDO PIC  X(0012).
  3678*    -------------------------------
  3679     05  FILLER            PIC  X(0003).
  3680     05  CKNUMBO PIC  X(0007).
  3681*    -------------------------------
  3682     05  FILLER            PIC  X(0003).
  3683     05  AGTHDGO PIC  X(0016).
  3684*    -------------------------------
  3685     05  FILLER            PIC  X(0003).
  3686     05  NAMEBO PIC  X(0030).
  3687*    -------------------------------
  3688     05  FILLER            PIC  X(0003).
  3689     05  NAMEB2O PIC  X(0030).
  3690*    -------------------------------
  3691     05  FILLER            PIC  X(0003).
  3692     05  ADDR1BO PIC  X(0030).
  3693*    -------------------------------
  3694     05  FILLER            PIC  X(0003).
  3695     05  ADDR1B2O PIC  X(0030).
  3696*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  73
* EL156.cbl
  3697     05  FILLER            PIC  X(0003).
  3698     05  ADDR2BO PIC  X(0030).
  3699*    -------------------------------
  3700     05  FILLER            PIC  X(0003).
  3701     05  ADDR2B2O PIC  X(0030).
  3702*    -------------------------------
  3703     05  FILLER            PIC  X(0003).
  3704     05  CITYSTBO PIC  X(0030).
  3705*    -------------------------------
  3706     05  FILLER            PIC  X(0003).
  3707     05  CITYST2O PIC  X(0030).
  3708*    -------------------------------
  3709     05  FILLER            PIC  X(0003).
  3710     05  ZIPBO PIC  ZZZZ99999.
  3711*    -------------------------------
  3712     05  FILLER            PIC  X(0003).
  3713     05  ZIPB2O PIC  ZZZZZZZZZ.
  3714*    -------------------------------
  3715     05  FILLER            PIC  X(0003).
  3716     05  INTHDBO PIC  X(0012).
  3717*    -------------------------------
  3718     05  FILLER            PIC  X(0003).
  3719     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3720*    -------------------------------
  3721     05  FILLER            PIC  X(0003).
  3722     05  PMTHDGBO PIC  X(0034).
  3723*    -------------------------------
  3724     05  FILLER            PIC  X(0003).
  3725     05  CLMNOBO PIC  X(0007).
  3726*    -------------------------------
  3727     05  FILLER            PIC  X(0003).
  3728     05  CARRBO PIC  X(0001).
  3729*    -------------------------------
  3730     05  FILLER            PIC  X(0003).
  3731     05  CERTNOBO PIC  X(0010).
  3732*    -------------------------------
  3733     05  FILLER            PIC  X(0003).
  3734     05  SUFXBO PIC  X(0001).
  3735*    -------------------------------
  3736     05  FILLER            PIC  X(0003).
  3737     05  CLMTYPBO PIC  X(0006).
  3738*    -------------------------------
  3739     05  FILLER            PIC  X(0003).
  3740     05  INCURBO PIC  X(0008).
  3741*    -------------------------------
  3742     05  FILLER            PIC  X(0003).
  3743     05  PYFROMBO PIC  99B99B99.
  3744*    -------------------------------
  3745     05  FILLER            PIC  X(0003).
  3746     05  PYTHRUBO PIC  99B99B99.
  3747*    -------------------------------
  3748     05  FILLER            PIC  X(0003).
  3749     05  DAYSBO PIC  X(0005).
  3750*    -------------------------------
  3751     05  FILLER            PIC  X(0003).
  3752     05  BYBO PIC  X(0004).
  3753*    -------------------------------
  3754     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  74
* EL156.cbl
  3755     05  PROOFDBO PIC  99B99B99.
  3756*    -------------------------------
  3757     05  FILLER            PIC  X(0003).
  3758     05  ACCTBO PIC  X(0010).
  3759*    -------------------------------
  3760     05  FILLER            PIC  X(0003).
  3761     05  STATEBO PIC  X(0002).
  3762*    -------------------------------
  3763     05  FILLER            PIC  X(0003).
  3764     05  GROUPBO PIC  X(0006).
  3765*    -------------------------------
  3766     05  FILLER            PIC  X(0003).
  3767     05  ACARRBO PIC  X(0001).
  3768*    -------------------------------
  3769     05  FILLER            PIC  X(0003).
  3770     05  ACCTNMBO PIC  X(0030).
  3771*    -------------------------------
  3772     05  FILLER            PIC  X(0003).
  3773     05  UNDISBO PIC  ZZZ,Z99.99.
  3774*    -------------------------------
  3775     05  FILLER            PIC  X(0003).
  3776     05  RATEBO PIC  ZZZ.99.
  3777*    -------------------------------
  3778     05  FILLER            PIC  X(0003).
  3779     05  ERMSG1BO PIC  X(0072).
  3780*    -------------------------------
  3781     05  FILLER            PIC  X(0003).
  3782     05  ENTPFBO PIC  X(0002).
  3783*    -------------------------------
  3784****************************************************************
  3785*
  3786* Copyright (c) 2007-2013 Dell Inc.
  3787* All rights reserved.
  3788*
  3789****************************************************************
  3790 01  DFHEIV.
  3791   02  DFHEIV0               PIC X(35).
  3792   02  DFHEIV1               PIC X(08).
  3793   02  DFHEIV2               PIC X(08).
  3794   02  DFHEIV3               PIC X(08).
  3795   02  DFHEIV4               PIC X(06).
  3796   02  DFHEIV5               PIC X(04).
  3797   02  DFHEIV6               PIC X(04).
  3798   02  DFHEIV7               PIC X(02).
  3799   02  DFHEIV8               PIC X(02).
  3800   02  DFHEIV9               PIC X(01).
  3801   02  DFHEIV10              PIC S9(7) COMP-3.
  3802   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3803   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3804   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3805   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3806   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3807   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3808   02  DFHEIV17              PIC X(04).
  3809   02  DFHEIV18              PIC X(04).
  3810   02  DFHEIV19              PIC X(04).
  3811   02  DFHEIV20              USAGE IS POINTER.
  3812   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  75
* EL156.cbl
  3813   02  DFHEIV22              USAGE IS POINTER.
  3814   02  DFHEIV23              USAGE IS POINTER.
  3815   02  DFHEIV24              USAGE IS POINTER.
  3816   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3817   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3818   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3819   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3820   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3821   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3822   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3823   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3824   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3825   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3826   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3827   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3828   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3829   02  FILLER                PIC X(02).
  3830   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3831   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3832   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3833   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3834   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3835   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3836   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3837 LINKAGE  SECTION.
  3838*****************************************************************
  3839*                                                               *
  3840* Copyright (c) 2007-2013 Dell Inc.                             *
  3841* All rights reserved.                                          *
  3842*                                                               *
  3843*****************************************************************
  3844 01  dfheiblk.
  3845     02  eibtime          pic s9(7) comp-3.
  3846     02  eibdate          pic s9(7) comp-3.
  3847     02  eibtrnid         pic x(4).
  3848     02  eibtaskn         pic s9(7) comp-3.
  3849     02  eibtrmid         pic x(4).
  3850     02  dfheigdi         pic s9(4) comp.
  3851     02  eibcposn         pic s9(4) comp.
  3852     02  eibcalen         pic s9(4) comp.
  3853     02  eibaid           pic x(1).
  3854     02  eibfiller1       pic x(1).
  3855     02  eibfn            pic x(2).
  3856     02  eibfiller2       pic x(2).
  3857     02  eibrcode         pic x(6).
  3858     02  eibfiller3       pic x(2).
  3859     02  eibds            pic x(8).
  3860     02  eibreqid         pic x(8).
  3861     02  eibrsrce         pic x(8).
  3862     02  eibsync          pic x(1).
  3863     02  eibfree          pic x(1).
  3864     02  eibrecv          pic x(1).
  3865     02  eibsend          pic x(1).
  3866     02  eibatt           pic x(1).
  3867     02  eibeoc           pic x(1).
  3868     02  eibfmh           pic x(1).
  3869     02  eibcompl         pic x(1).
  3870     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  76
* EL156.cbl
  3871     02  eibconf          pic x(1).
  3872     02  eiberr           pic x(1).
  3873     02  eibrldbk         pic x(1).
  3874     02  eiberrcd         pic x(4).
  3875     02  eibsynrb         pic x(1).
  3876     02  eibnodat         pic x(1).
  3877     02  eibfiller5       pic x(2).
  3878     02  eibresp          pic s9(8) comp.
  3879     02  eibresp2         pic s9(8) comp.
  3880     02  dfheigdj         pic s9(4) comp.
  3881     02  dfheigdk         pic s9(4) comp.
  3882 01  DFHCOMMAREA             PIC X(1024).
  3883
  3884*    COPY ELCMSTR.
  3885******************************************************************
  3886*                                                                *
  3887*                            ELCMSTR.                            *
  3888*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3889*                            VMOD=2.012                          *
  3890*                                                                *
  3891*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3892*                                                                *
  3893*   FILE TYPE = VSAM,KSDS                                        *
  3894*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3895*                                                                *
  3896*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3897*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3898*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3899*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3900*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3901*                                                 RKP=75,LEN=21  *
  3902*                                                                *
  3903*   **** NOTE ****                                               *
  3904*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3905*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3906*                                                                *
  3907*   LOG = YES                                                    *
  3908*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3909******************************************************************
  3910*                   C H A N G E   L O G
  3911*
  3912* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3913*-----------------------------------------------------------------
  3914*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3915* EFFECTIVE    NUMBER
  3916*-----------------------------------------------------------------
  3917* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3918* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3919* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3920* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3921* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3922* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3923* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3924******************************************************************
  3925 01  CLAIM-MASTER.
  3926     12  CL-RECORD-ID                PIC XX.
  3927         88  VALID-CL-ID         VALUE 'CL'.
  3928
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  77
* EL156.cbl
  3929     12  CL-CONTROL-PRIMARY.
  3930         16  CL-COMPANY-CD           PIC X.
  3931         16  CL-CARRIER              PIC X.
  3932         16  CL-CLAIM-NO             PIC X(7).
  3933         16  CL-CERT-NO.
  3934             20  CL-CERT-PRIME       PIC X(10).
  3935             20  CL-CERT-SFX         PIC X.
  3936
  3937     12  CL-CONTROL-BY-NAME.
  3938         16  CL-COMPANY-CD-A1        PIC X.
  3939         16  CL-INSURED-LAST-NAME    PIC X(15).
  3940         16  CL-INSURED-NAME.
  3941             20  CL-INSURED-1ST-NAME PIC X(12).
  3942             20  CL-INSURED-MID-INIT PIC X.
  3943
  3944     12  CL-CONTROL-BY-SSN.
  3945         16  CL-COMPANY-CD-A2        PIC X.
  3946         16  CL-SOC-SEC-NO.
  3947             20  CL-SSN-STATE        PIC XX.
  3948             20  CL-SSN-ACCOUNT      PIC X(6).
  3949             20  CL-SSN-LN3          PIC X(3).
  3950
  3951     12  CL-CONTROL-BY-CERT-NO.
  3952         16  CL-COMPANY-CD-A4        PIC X.
  3953         16  CL-CERT-NO-A4.
  3954             20  CL-CERT-A4-PRIME    PIC X(10).
  3955             20  CL-CERT-A4-SFX      PIC X.
  3956
  3957     12  CL-CONTROL-BY-CCN.
  3958         16  CL-COMPANY-CD-A5        PIC X.
  3959         16  CL-CCN-A5.
  3960             20  CL-CCN.
  3961                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3962                 24  CL-CCN-PRIME-A5 PIC X(12).
  3963             20  CL-CCN-FILLER-A5    PIC X(4).
  3964
  3965     12  CL-INSURED-PROFILE-DATA.
  3966         16  CL-INSURED-BIRTH-DT     PIC XX.
  3967         16  CL-INSURED-SEX-CD       PIC X.
  3968             88  INSURED-IS-MALE        VALUE 'M'.
  3969             88  INSURED-IS-FEMALE      VALUE 'F'.
  3970             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3971         16  CL-INSURED-OCC-CD       PIC X(6).
  3972         16  FILLER                  PIC X(5).
  3973
  3974     12  CL-PROCESSING-INFO.
  3975         16  CL-PROCESSOR-ID         PIC X(4).
  3976         16  CL-CLAIM-STATUS         PIC X.
  3977             88  CLAIM-IS-OPEN          VALUE 'O'.
  3978             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3979         16  CL-CLAIM-TYPE           PIC X.
  3980*            88  AH-CLAIM               VALUE 'A'.
  3981*            88  LIFE-CLAIM             VALUE 'L'.
  3982*            88  PROPERTY-CLAIM         VALUE 'P'.
  3983*            88  IUI-CLAIM              VALUE 'I'.
  3984*            88  GAP-CLAIM              VALUE 'G'.
  3985*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3986*            88  OTHER-CLAIM            VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  78
* EL156.cbl
  3987         16  CL-CLAIM-PREM-TYPE      PIC X.
  3988             88  SINGLE-PREMIUM         VALUE '1'.
  3989             88  O-B-COVERAGE           VALUE '2'.
  3990             88  OPEN-END-COVERAGE      VALUE '3'.
  3991         16  CL-INCURRED-DT          PIC XX.
  3992         16  CL-REPORTED-DT          PIC XX.
  3993         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3994         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3995         16  CL-LAST-PMT-DT          PIC XX.
  3996         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3997         16  CL-PAID-THRU-DT         PIC XX.
  3998         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3999         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  4000         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  4001         16  CL-PMT-CALC-METHOD      PIC X.
  4002             88  CL-360-DAY-YR          VALUE '1'.
  4003             88  CL-365-DAY-YR          VALUE '2'.
  4004             88  CL-FULL-MONTHS         VALUE '3'.
  4005         16  CL-CAUSE-CD             PIC X(6).
  4006
  4007         16  CL-PRIME-CERT-NO.
  4008             20  CL-PRIME-CERT-PRIME PIC X(10).
  4009             20  CL-PRIME-CERT-SFX   PIC X.
  4010
  4011         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  4012             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  4013             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  4014
  4015         16  CL-MICROFILM-NO         PIC X(10).
  4016         16  FILLER REDEFINES CL-MICROFILM-NO.
  4017             20  CL-BENEFIT-PERIOD   PIC 99.
  4018             20  FILLER              PIC X(8).
  4019         16  CL-PROG-FORM-TYPE       PIC X.
  4020         16  CL-LAST-ADD-ON-DT       PIC XX.
  4021
  4022         16  CL-LAST-REOPEN-DT       PIC XX.
  4023         16  CL-LAST-CLOSE-DT        PIC XX.
  4024         16  CL-LAST-CLOSE-REASON    PIC X(01).
  4025             88  FINAL-PAID             VALUE '1'.
  4026             88  CLAIM-DENIED           VALUE '2'.
  4027             88  AUTO-CLOSE             VALUE '3'.
  4028             88  MANUAL-CLOSE           VALUE '4'.
  4029             88  BENEFITS-CHANGED       VALUE 'C'.
  4030             88  SETUP-ERRORS           VALUE 'E'.
  4031         16  CL-ASSOC-CERT-SEQU      PIC S99.
  4032         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  4033         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  4034             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  4035         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  4036         16  FILLER                  PIC X.
  4037
  4038     12  CL-CERTIFICATE-DATA.
  4039         16  CL-CERT-ORIGIN          PIC X.
  4040             88  CERT-WAS-ONLINE        VALUE '1'.
  4041             88  CERT-WAS-CREATED       VALUE '2'.
  4042             88  COVERAGE-WAS-ADDED     VALUE '3'.
  4043         16  CL-CERT-KEY-DATA.
  4044             20  CL-CERT-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  79
* EL156.cbl
  4045             20  CL-CERT-GROUPING    PIC X(6).
  4046             20  CL-CERT-STATE       PIC XX.
  4047             20  CL-CERT-ACCOUNT.
  4048                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4049                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4050             20  CL-CERT-EFF-DT      PIC XX.
  4051
  4052     12  CL-STATUS-CONTROLS.
  4053         16  CL-PRIORITY-CD          PIC X.
  4054             88  CONFIDENTIAL-DATA      VALUE '8'.
  4055             88  HIGHEST-PRIORITY       VALUE '9'.
  4056         16  CL-SUPV-ATTN-CD         PIC X.
  4057             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4058             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4059         16  CL-PURGED-DT            PIC XX.
  4060         16  CL-RESTORED-DT          PIC XX.
  4061         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4062         16  CL-NEXT-RESEND-DT       PIC XX.
  4063         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4064         16  CL-CRITICAL-PERIOD      PIC 99.
  4065*        16  FILLER                  PIC XX.
  4066         16  CL-LAST-MAINT-DT        PIC XX.
  4067         16  CL-LAST-MAINT-USER      PIC X(4).
  4068         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4069         16  CL-LAST-MAINT-TYPE      PIC X.
  4070             88  CLAIM-SET-UP           VALUE ' '.
  4071             88  PAYMENT-MADE           VALUE '1'.
  4072             88  LETTER-SENT            VALUE '2'.
  4073             88  MASTER-WAS-ALTERED     VALUE '3'.
  4074             88  MASTER-WAS-RESTORED    VALUE '4'.
  4075             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4076             88  FILE-CONVERTED         VALUE '6'.
  4077             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4078             88  ERROR-CORRECTION       VALUE 'E'.
  4079         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4080         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4081         16  CL-BENEFICIARY          PIC X(10).
  4082         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4083         16  CL-DENIAL-TYPE          PIC X.
  4084             88  CL-TYPE-DENIAL          VALUE '1'.
  4085             88  CL-TYPE-RESCISSION      VALUE '2'.
  4086             88  CL-TYPE-REFORMATION     VALUE '3'.
  4087             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4088             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4089         16  CL-NO-OF-EXTENSIONS     PIC 99.
  4090         16  filler                  pic x(3).
  4091*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4092*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4093*        16  CL-RTW-DT               PIC XX.
  4094
  4095     12  CL-TRAILER-CONTROLS.
  4096         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4097             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4098             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4099             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4100         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4101         16  FILLER                  PIC XX.
  4102         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  80
* EL156.cbl
  4103         16  CL-ADDRESS-TRAILER-CNT.
  4104             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4105                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4106             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4107                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4108             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4109                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4110             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4111                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4112             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4113                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4114             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4115                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4116             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4117                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4118
  4119     12  CL-CV-REFERENCE-NO.
  4120         16  CL-CV-REFNO-PRIME       PIC X(18).
  4121         16  CL-CV-REFNO-SFX         PIC XX.
  4122
  4123     12  CL-FILE-LOCATION            PIC X(4).
  4124
  4125     12  CL-PROCESS-ERRORS.
  4126         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4127             88  NO-FATAL-ERRORS        VALUE ZERO.
  4128         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4129             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4130
  4131     12  CL-PRODUCT-CD               PIC X.
  4132
  4133     12  CL-CURRENT-KEY-DATA.
  4134         16  CL-CURRENT-CARRIER      PIC X.
  4135         16  CL-CURRENT-GROUPING     PIC X(6).
  4136         16  CL-CURRENT-STATE        PIC XX.
  4137         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4138
  4139     12  CL-ASSOCIATES               PIC X.
  4140         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4141         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4142         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4143         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4144
  4145     12  CL-ACTIVITY-CODE            PIC 99.
  4146     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4147     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4148
  4149     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4150     12  CL-LAG-REPORT-CODE          PIC 9.
  4151     12  CL-LOAN-TYPE                PIC XX.
  4152     12  CL-LEGAL-STATE              PIC XX.
  4153
  4154     12  CL-YESNOSW                  PIC X.
  4155     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4156         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4157         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4158         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4159     12  cl-insured-type             pic x.
  4160         88  cl-claim-on-primary         value 'P'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  81
* EL156.cbl
  4161         88  cl-claim-on-co-borrower     value 'C'.
  4162     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  82
* EL156.cbl
  4164*    COPY ELCCNTL.
  4165******************************************************************
  4166*                                                                *
  4167*                                                                *
  4168*                            ELCCNTL.                            *
  4169*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4170*                            VMOD=2.059                          *
  4171*                                                                *
  4172*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4173*                                                                *
  4174*   FILE TYPE = VSAM,KSDS                                        *
  4175*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4176*                                                                *
  4177*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4178*       ALTERNATE INDEX = NONE                                   *
  4179*                                                                *
  4180*   LOG = YES                                                    *
  4181*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4182******************************************************************
  4183*                   C H A N G E   L O G
  4184*
  4185* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4186*-----------------------------------------------------------------
  4187*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4188* EFFECTIVE    NUMBER
  4189*-----------------------------------------------------------------
  4190* 082503                   PEMA  ADD BENEFIT GROUP
  4191* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4192* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4193* 092705    2005050300006  PEMA  ADD SPP LEASES
  4194* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4195* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4196* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4197* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4198* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4199* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4200* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4201* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4202* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4203* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4204* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4205******************************************************************
  4206*
  4207 01  CONTROL-FILE.
  4208     12  CF-RECORD-ID                       PIC XX.
  4209         88  VALID-CF-ID                        VALUE 'CF'.
  4210
  4211     12  CF-CONTROL-PRIMARY.
  4212         16  CF-COMPANY-ID                  PIC XXX.
  4213         16  CF-RECORD-TYPE                 PIC X.
  4214             88  CF-COMPANY-MASTER              VALUE '1'.
  4215             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4216             88  CF-STATE-MASTER                VALUE '3'.
  4217             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4218             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4219             88  CF-CARRIER-MASTER              VALUE '6'.
  4220             88  CF-MORTALITY-MASTER            VALUE '7'.
  4221             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  83
* EL156.cbl
  4222             88  CF-TERMINAL-MASTER             VALUE '9'.
  4223             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4224             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4225             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4226             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4227             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4228             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4229             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4230             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4231             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4232         16  CF-ACCESS-CD-GENL              PIC X(4).
  4233         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4234             20  CF-PROCESSOR               PIC X(4).
  4235         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4236             20  CF-STATE-CODE              PIC XX.
  4237             20  FILLER                     PIC XX.
  4238         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4239             20  FILLER                     PIC XX.
  4240             20  CF-HI-BEN-IN-REC           PIC XX.
  4241         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4242             20  FILLER                     PIC XXX.
  4243             20  CF-CARRIER-CNTL            PIC X.
  4244         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4245             20  FILLER                     PIC XX.
  4246             20  CF-HI-TYPE-IN-REC          PIC 99.
  4247         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4248             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4249                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4250             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4251             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4252         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4253             20  FILLER                     PIC X.
  4254             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4255         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4256             20  FILLER                     PIC XX.
  4257             20  CF-MORTGAGE-PLAN           PIC XX.
  4258         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4259
  4260     12  CF-LAST-MAINT-DT                   PIC XX.
  4261     12  CF-LAST-MAINT-BY                   PIC X(4).
  4262     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4263
  4264     12  CF-RECORD-BODY                     PIC X(728).
  4265
  4266
  4267****************************************************************
  4268*             COMPANY MASTER RECORD                            *
  4269****************************************************************
  4270
  4271     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4272         16  CF-COMPANY-ADDRESS.
  4273             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4274             20  CF-CL-IN-CARE-OF           PIC X(30).
  4275             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4276             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4277             20  CF-CL-CITY-STATE           PIC X(30).
  4278             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4279             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  84
* EL156.cbl
  4280         16  CF-COMPANY-CD                  PIC X.
  4281         16  CF-COMPANY-PASSWORD            PIC X(8).
  4282         16  CF-SECURITY-OPTION             PIC X.
  4283             88  ALL-SECURITY                   VALUE '1'.
  4284             88  COMPANY-VERIFY                 VALUE '2'.
  4285             88  PROCESSOR-VERIFY               VALUE '3'.
  4286             88  NO-SECURITY                    VALUE '4'.
  4287             88  ALL-BUT-TERM                   VALUE '5'.
  4288         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4289             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4290         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4291             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4292         16  CF-INFORCE-LOCATION            PIC X.
  4293             88  CERTS-ARE-ONLINE               VALUE '1'.
  4294             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4295             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4296         16  CF-LOWER-CASE-LETTERS          PIC X.
  4297         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4298             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4299             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4300             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4301             88  CF-ACCNT-CNTL                  VALUE '3'.
  4302             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4303
  4304         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4305         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4306
  4307         16  CF-LGX-CREDIT-USER             PIC X.
  4308             88  CO-IS-NOT-USER                 VALUE 'N'.
  4309             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4310
  4311         16 CF-CREDIT-CALC-CODES.
  4312             20  CF-CR-REM-TERM-CALC PIC X.
  4313               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4314               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4315               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4316               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4317               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4318               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4319               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4320             20  CF-CR-R78-METHOD           PIC X.
  4321               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4322               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4323
  4324         16  CF-CLAIM-CONTROL-COUNTS.
  4325             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4326                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4327
  4328             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4329                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4330
  4331             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4332                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4333
  4334             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4335                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4336
  4337         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  85
* EL156.cbl
  4338
  4339         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4340             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4341             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4342             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4343             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4344                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4345                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4346             20  CF-CO-PREM-REJECT-SW       PIC X.
  4347                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4348                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4349             20  CF-CO-REF-REJECT-SW        PIC X.
  4350                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4351                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4352
  4353         16  CF-CO-REPORTING-DT             PIC XX.
  4354         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4355         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4356           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4357           88  CF-CO-MONTH-END                  VALUE '1'.
  4358
  4359         16  CF-LGX-CLAIM-USER              PIC X.
  4360             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4361             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4362
  4363         16  CF-CREDIT-EDIT-CONTROLS.
  4364             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4365             20  CF-MIN-AGE                 PIC 99.
  4366             20  CF-DEFAULT-AGE             PIC 99.
  4367             20  CF-MIN-TERM                PIC S999      COMP-3.
  4368             20  CF-MAX-TERM                PIC S999      COMP-3.
  4369             20  CF-DEFAULT-SEX             PIC X.
  4370             20  CF-JOINT-AGE-INPUT         PIC X.
  4371                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4372             20  CF-BIRTH-DATE-INPUT        PIC X.
  4373                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4374             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4375                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4376                 88  CF-ZERO-CARRIER            VALUE '1'.
  4377                 88  CF-ZERO-GROUPING           VALUE '2'.
  4378                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4379             20  CF-EDIT-SW                 PIC X.
  4380                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4381             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4382             20  CF-CR-PR-METHOD            PIC X.
  4383               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4384               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4385             20  FILLER                     PIC X.
  4386
  4387         16  CF-CREDIT-MISC-CONTROLS.
  4388             20  CF-REIN-TABLE-SW           PIC X.
  4389                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4390             20  CF-COMP-TABLE-SW           PIC X.
  4391                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4392             20  CF-EXPERIENCE-RETENTION-AGE
  4393                                            PIC S9        COMP-3.
  4394             20  CF-CONVERSION-DT           PIC XX.
  4395             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  86
* EL156.cbl
  4396             20  CF-RUN-FREQUENCY-SW        PIC X.
  4397                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4398                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4399
  4400             20  CF-CR-CHECK-NO-CONTROL.
  4401                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4402                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4403                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4404                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4405                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4406                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4407
  4408                 24  CF-CR-CHECK-COUNT       REDEFINES
  4409                     CF-CR-CHECK-COUNTER      PIC X(4).
  4410
  4411                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4412                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4413
  4414                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4415                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4416                 24  CF-MAIL-PROCESSING       PIC X.
  4417                     88  MAIL-PROCESSING          VALUE 'Y'.
  4418
  4419         16  CF-MISC-SYSTEM-CONTROL.
  4420             20  CF-SYSTEM-C                 PIC X.
  4421                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4422             20  CF-SYSTEM-D                 PIC X.
  4423                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4424             20  CF-SOC-SEC-NO-SW            PIC X.
  4425                 88  SOC-SEC-NO-USED             VALUE '1'.
  4426             20  CF-MEMBER-NO-SW             PIC X.
  4427                 88  MEMBER-NO-USED              VALUE '1'.
  4428             20  CF-TAX-ID-NUMBER            PIC X(11).
  4429             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4430             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4431                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4432                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4433                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4434                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4435             20  CF-SYSTEM-E                 PIC X.
  4436                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4437
  4438         16  CF-LGX-LIFE-USER               PIC X.
  4439             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4440             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4441
  4442         16  CF-CR-MONTH-END-DT             PIC XX.
  4443
  4444         16  CF-FILE-MAINT-DATES.
  4445             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4446                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4447             20  CF-LAST-BATCH       REDEFINES
  4448                 CF-LAST-BATCH-NO               PIC X(4).
  4449             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4450             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4451             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4452             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4453             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  87
* EL156.cbl
  4454             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4455             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4456             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4457             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4458             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4459
  4460         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4461         16  FILLER                         PIC X.
  4462
  4463         16  CF-ALT-MORT-CODE               PIC X(4).
  4464         16  CF-MEMBER-CAPTION              PIC X(10).
  4465
  4466         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4467             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4468             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4469             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4470             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4471             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4472
  4473         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4474
  4475         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4476         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4477         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4478         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4479
  4480         16  CF-AH-OVERRIDE-L1              PIC X.
  4481         16  CF-AH-OVERRIDE-L2              PIC XX.
  4482         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4483         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4484
  4485         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4486         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4487
  4488         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4489         16  CF-AR-LAST-EL860-DT            PIC XX.
  4490         16  CF-MP-MONTH-END-DT             PIC XX.
  4491
  4492         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4493         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4494             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4495
  4496         16  CF-AR-MONTH-END-DT             PIC XX.
  4497
  4498         16  CF-CRDTCRD-USER                PIC X.
  4499             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4500             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4501
  4502         16  CF-CC-MONTH-END-DT             PIC XX.
  4503
  4504         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4505
  4506         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4507             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4508             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4509             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4510         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4511         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  88
* EL156.cbl
  4512         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4513         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4514             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4515             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4516         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4517         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4518         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4519             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4520         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4521
  4522         16  CF-CL-ZIP-CODE.
  4523             20  CF-CL-ZIP-PRIME.
  4524                 24  CF-CL-ZIP-1ST          PIC X.
  4525                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4526                 24  FILLER                 PIC X(4).
  4527             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4528         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4529             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4530             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4531             20  FILLER                     PIC XXX.
  4532
  4533         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4534         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4535         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4536         16  CF-CO-OPTION-START-DATE        PIC XX.
  4537         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4538           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4539                                                      '3' '4'.
  4540           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4541           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4542           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4543           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4544           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4545           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4546
  4547         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4548
  4549         16  CF-PAYMENT-APPROVAL-LEVELS.
  4550             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4551             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4552             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4553             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4554             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4555             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4556
  4557         16  CF-END-USER-REPORTING-USER     PIC X.
  4558             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4559             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4560
  4561         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4562             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4563             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4564
  4565         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4566
  4567         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4568         16  FILLER                         PIC X.
  4569
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  89
* EL156.cbl
  4570         16  CF-CREDIT-ARCHIVE-CNTL.
  4571             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4572             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4573             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4574
  4575         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4576
  4577         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4578             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4579             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4580
  4581         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4582             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4583             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4584
  4585         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4586
  4587         16  CF-CO-ACH-ID-CODE              PIC  X.
  4588             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4589             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4590             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4591         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4592         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4593         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4594         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4595         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4596         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4597         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4598         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4599         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4600                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4601         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4602                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4603
  4604         16  CF-CO-OVER-SHORT.
  4605             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4606             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4607
  4608*         16  FILLER                         PIC X(102).
  4609         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4610             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4611             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4612
  4613         16  CF-AH-APPROVAL-DAYS.
  4614             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4615             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4616             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4617             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4618
  4619         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4620
  4621         16  CF-APPROV-LEV-5.
  4622             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4623             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4624             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4625
  4626         16  FILLER                         PIC X(68).
  4627****************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  90
* EL156.cbl
  4628*             PROCESSOR/USER RECORD                            *
  4629****************************************************************
  4630
  4631     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4632         16  CF-PROCESSOR-NAME              PIC X(30).
  4633         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4634         16  CF-PROCESSOR-TITLE             PIC X(26).
  4635         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4636                 88  MESSAGE-YES                VALUE 'Y'.
  4637                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4638
  4639*****************************************************
  4640****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4641****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4642****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4643****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4644*****************************************************
  4645
  4646         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4647             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4648             20  CF-APPLICATION-FORCE       PIC X.
  4649             20  CF-INDIVIDUAL-APP.
  4650                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4651                     28  CF-BROWSE-APP      PIC X.
  4652                     28  CF-UPDATE-APP      PIC X.
  4653
  4654         16  CF-CURRENT-TERM-ON             PIC X(4).
  4655         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4656             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4657             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4658             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4659             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4660             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4661             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4662             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4663         16  CF-PROCESSOR-CARRIER           PIC X.
  4664             88  NO-CARRIER-SECURITY            VALUE ' '.
  4665         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4666             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4667         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4668             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4669         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4670             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4671
  4672         16  CF-PROC-SYS-ACCESS-SW.
  4673             20  CF-PROC-CREDIT-CLAIMS-SW.
  4674                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4675                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4676                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4677                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4678             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4679                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4680                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4681             20  CF-PROC-LIFE-GNRLDGR-SW.
  4682                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4683                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4684                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4685                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  91
* EL156.cbl
  4686             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4687                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4688                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4689         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4690             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4691             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4692         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4693
  4694         16  CF-APPROVAL-LEVEL                  PIC X.
  4695             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4696             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4697             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4698             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4699             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4700
  4701         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4702
  4703         16  CF-LANGUAGE-TYPE                   PIC X.
  4704             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4705             88  CF-LANG-IS-FR                      VALUE 'F'.
  4706
  4707         16  CF-CSR-IND                         PIC X.
  4708         16  FILLER                             PIC X(239).
  4709
  4710****************************************************************
  4711*             PROCESSOR/REMINDERS RECORD                       *
  4712****************************************************************
  4713
  4714     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4715         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4716             20  CF-START-REMIND-DT         PIC XX.
  4717             20  CF-END-REMIND-DT           PIC XX.
  4718             20  CF-REMINDER-TEXT           PIC X(50).
  4719         16  FILLER                         PIC X(296).
  4720
  4721
  4722****************************************************************
  4723*             STATE MASTER RECORD                              *
  4724****************************************************************
  4725
  4726     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4727         16  CF-STATE-ABBREVIATION          PIC XX.
  4728         16  CF-STATE-NAME                  PIC X(25).
  4729         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4730         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4731             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4732             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4733             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4734             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4735                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4736                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4737             20  CF-ST-PREM-REJECT-SW       PIC X.
  4738                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4739                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4740             20  CF-ST-REF-REJECT-SW        PIC X.
  4741                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4742                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4743         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  92
* EL156.cbl
  4744         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4745         16  CF-ST-REFUND-RULES.
  4746             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4747             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4748             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4749         16  CF-ST-FST-PMT-EXTENSION.
  4750             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4751             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4752                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4753                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4754                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4755                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4756         16  CF-ST-STATE-CALL.
  4757             20  CF-ST-CALL-UNEARNED        PIC X.
  4758             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4759             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4760         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4761             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4762             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4763         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4764         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4765         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4766         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4767         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4768         16  FILLER                         PIC X.
  4769         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4770             20  CF-ST-BENEFIT-CD           PIC XX.
  4771             20  CF-ST-BENEFIT-KIND         PIC X.
  4772                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4773                 88  CF-ST-AH-KIND              VALUE 'A'.
  4774             20  CF-ST-REM-TERM-CALC        PIC X.
  4775                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4776                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4777                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4778                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4779                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4780                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4781                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4782                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4783
  4784             20  CF-ST-REFUND-CALC          PIC X.
  4785                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4786                 88  ST-REFD-BY-R78             VALUE '1'.
  4787                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4788                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4789                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4790                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4791                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4792                 88  ST-REFD-UTAH               VALUE '7'.
  4793                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4794                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4795                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4796
  4797             20  CF-ST-EARNING-CALC         PIC X.
  4798                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4799                 88  ST-EARN-BY-R78             VALUE '1'.
  4800                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4801                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  93
* EL156.cbl
  4802                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4803                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4804                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4805                 88  ST-EARN-MEAN               VALUE '8'.
  4806                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4807
  4808             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4809                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4810                 88  ST-OVRD-BY-R78             VALUE '1'.
  4811                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4812                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4813                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4814                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4815                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4816                 88  ST-OVRD-MEAN               VALUE '8'.
  4817                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4818             20  cf-st-extra-periods        pic 9.
  4819*            20  FILLER                     PIC X.
  4820
  4821         16  CF-ST-COMMISSION-CAPS.
  4822             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4823             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4824             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4825             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4826         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4827                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4828                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4829                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4830
  4831         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4832
  4833         16  CF-ST-STATUTORY-INTEREST.
  4834             20  CF-ST-STAT-DATE-FROM       PIC X.
  4835                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4836                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4837             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4838             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4839             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4840             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4841             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4842
  4843         16  CF-ST-OVER-SHORT.
  4844             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4845             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4846
  4847         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4848
  4849         16  CF-ST-RT-CALC                  PIC X.
  4850
  4851         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4852         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4853         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4854         16  CF-ST-RF-LR-CALC               PIC X.
  4855         16  CF-ST-RF-LL-CALC               PIC X.
  4856         16  CF-ST-RF-LN-CALC               PIC X.
  4857         16  CF-ST-RF-AH-CALC               PIC X.
  4858         16  CF-ST-RF-CP-CALC               PIC X.
  4859*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  94
* EL156.cbl
  4860*CIDMOD         16  FILLER                         PIC X(192).
  4861         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4862             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4863         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4864         16  CF-ST-VFY-2ND-BENE             PIC X.
  4865         16  CF-ST-CAUSAL-STATE             PIC X.
  4866         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4867         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4868         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4869             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4870         16  CF-ST-NET-ONLY-STATE           PIC X.
  4871             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4872         16  cf-commission-cap-required     pic x.
  4873         16  CF-ST-GA-COMMISSION-CAPS.
  4874             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4875             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4876             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4877             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4878         16  CF-ST-TOT-COMMISSION-CAPS.
  4879             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4880             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4881             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4882             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4883         16  FILLER                         PIC X(156).
  4884
  4885****************************************************************
  4886*             BENEFIT MASTER RECORD                            *
  4887****************************************************************
  4888
  4889     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4890         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4891             20  CF-BENEFIT-CODE            PIC XX.
  4892             20  CF-BENEFIT-NUMERIC  REDEFINES
  4893                 CF-BENEFIT-CODE            PIC XX.
  4894             20  CF-BENEFIT-ALPHA           PIC XXX.
  4895             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4896             20  CF-BENEFIT-COMMENT         PIC X(10).
  4897
  4898             20  CF-LF-COVERAGE-TYPE        PIC X.
  4899                 88  CF-REDUCING                VALUE 'R'.
  4900                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4901
  4902             20  CF-SPECIAL-CALC-CD         PIC X.
  4903                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4904                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4905                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4906                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4907                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4908                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4909                 88  CF-FARM-PLAN               VALUE 'F'.
  4910                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4911                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4912                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4913                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4914                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4915                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4916                 88  CF-PRUDENTIAL              VALUE 'P'.
  4917                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  95
* EL156.cbl
  4918                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4919                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4920                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4921                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4922                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4923
  4924             20  CF-JOINT-INDICATOR         PIC X.
  4925                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4926
  4927*            20  FILLER                     PIC X(12).
  4928             20  cf-maximum-benefits        pic s999 comp-3.
  4929             20  FILLER                     PIC X(09).
  4930             20  CF-BENEFIT-CATEGORY        PIC X.
  4931             20  CF-LOAN-TYPE               PIC X(8).
  4932
  4933             20  CF-CO-REM-TERM-CALC        PIC X.
  4934                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4935                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4936                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4937                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4938                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4939
  4940             20  CF-CO-EARNINGS-CALC        PIC X.
  4941                 88  CO-EARN-BY-R78             VALUE '1'.
  4942                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4943                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4944                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4945                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4946                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4947                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4948                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4949
  4950             20  CF-CO-REFUND-CALC          PIC X.
  4951                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4952                 88  CO-REFD-BY-R78             VALUE '1'.
  4953                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4954                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4955                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4956                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4957                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4958                 88  CO-REFD-MEAN               VALUE '8'.
  4959                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4960                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4961                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4962
  4963             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4964                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4965                 88  CO-OVRD-BY-R78             VALUE '1'.
  4966                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4967                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4968                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4969                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4970                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4971                 88  CO-OVRD-MEAN               VALUE '8'.
  4972                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4973
  4974             20  CF-CO-BEN-I-G-CD           PIC X.
  4975                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  96
* EL156.cbl
  4976                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4977                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4978
  4979         16  FILLER                         PIC X(304).
  4980
  4981
  4982****************************************************************
  4983*             CARRIER MASTER RECORD                            *
  4984****************************************************************
  4985
  4986     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4987         16  CF-ADDRESS-DATA.
  4988             20  CF-MAIL-TO-NAME            PIC X(30).
  4989             20  CF-IN-CARE-OF              PIC X(30).
  4990             20  CF-ADDRESS-LINE-1          PIC X(30).
  4991             20  CF-ADDRESS-LINE-2          PIC X(30).
  4992             20  CF-CITY-STATE              PIC X(30).
  4993             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4994             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4995
  4996         16  CF-CLAIM-NO-CONTROL.
  4997             20  CF-CLAIM-NO-METHOD         PIC X.
  4998                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4999                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5000                 88  CLAIM-NO-SEQ               VALUE '3'.
  5001                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5002             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5003                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5004                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5005                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5006
  5007         16  CF-CHECK-NO-CONTROL.
  5008             20  CF-CHECK-NO-METHOD         PIC X.
  5009                 88  CHECK-NO-MANUAL            VALUE '1'.
  5010                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5011                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5012                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5013             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5014                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5015
  5016         16  CF-DOMICILE-STATE              PIC XX.
  5017
  5018         16  CF-EXPENSE-CONTROLS.
  5019             20  CF-EXPENSE-METHOD          PIC X.
  5020                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5021                 88  DOLLARS-PER-PMT            VALUE '2'.
  5022                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5023                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5024             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5025             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5026
  5027         16  CF-CORRESPONDENCE-CONTROL.
  5028             20  CF-LETTER-RESEND-OPT       PIC X.
  5029                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5030                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5031             20  FILLER                     PIC X(4).
  5032
  5033         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  97
* EL156.cbl
  5034             20  CF-MANUAL-SW               PIC X.
  5035                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5036             20  CF-FUTURE-SW               PIC X.
  5037                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5038             20  CF-PTC-SW                  PIC X.
  5039                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5040             20  CF-IBNR-SW                 PIC X.
  5041                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5042             20  CF-PTC-LF-SW               PIC X.
  5043                 88  CF-LF-PTC-USED             VALUE '1'.
  5044             20  CF-CDT-ACCESS-METHOD       PIC X.
  5045                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5046                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5047                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5048             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5049
  5050         16  CF-CLAIM-CALC-METHOD           PIC X.
  5051             88  360-PLUS-MONTHS                VALUE '1'.
  5052             88  365-PLUS-MONTHS                VALUE '2'.
  5053             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5054             88  360-DAILY                      VALUE '4'.
  5055             88  365-DAILY                      VALUE '5'.
  5056
  5057         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5058         16  FILLER                         PIC X(11).
  5059
  5060         16  CF-LIMIT-AMOUNTS.
  5061             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5062             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5063             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5064             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5065             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5066             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5067             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5068             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5069             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5070             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5071
  5072         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5073         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5074         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5075
  5076         16  CF-ZIP-CODE.
  5077             20  CF-ZIP-PRIME.
  5078                 24  CF-ZIP-1ST             PIC X.
  5079                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5080                 24  FILLER                 PIC X(4).
  5081             20  CF-ZIP-PLUS4               PIC X(4).
  5082         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5083             20  CF-CAN-POSTAL-1            PIC XXX.
  5084             20  CF-CAN-POSTAL-2            PIC XXX.
  5085             20  FILLER                     PIC XXX.
  5086
  5087         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5088         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5089         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5090
  5091         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  98
* EL156.cbl
  5092             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5093             88  CF-NO-RATING                   VALUE 'N'.
  5094
  5095         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5096
  5097         16  CF-CARRIER-OVER-SHORT.
  5098             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5099             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5100
  5101         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5102         16  CF-SECPAY-SWITCH               PIC X.
  5103             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5104             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5105         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5106         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5107         16  FILLER                         PIC X(444).
  5108*        16  FILLER                         PIC X(452).
  5109
  5110
  5111****************************************************************
  5112*             MORTALITY MASTER RECORD                          *
  5113****************************************************************
  5114
  5115     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5116         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5117                                INDEXED BY CF-MORT-NDX.
  5118             20  CF-MORT-TABLE              PIC X(5).
  5119             20  CF-MORT-TABLE-TYPE         PIC X.
  5120                 88  CF-MORT-JOINT              VALUE 'J'.
  5121                 88  CF-MORT-SINGLE             VALUE 'S'.
  5122                 88  CF-MORT-COMBINED           VALUE 'C'.
  5123                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5124                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5125             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5126             20  CF-MORT-AGE-METHOD         PIC XX.
  5127                 88  CF-AGE-LAST                VALUE 'AL'.
  5128                 88  CF-AGE-NEAR                VALUE 'AN'.
  5129             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5130             20  CF-MORT-ADJUSTMENT-DIRECTION
  5131                                            PIC X.
  5132                 88  CF-MINUS                   VALUE '-'.
  5133                 88  CF-PLUS                    VALUE '+'.
  5134             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5135             20  CF-MORT-JOINT-CODE         PIC X.
  5136                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5137             20  CF-MORT-PC-Q               PIC X.
  5138                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5139             20  CF-MORT-TABLE-CODE         PIC X(4).
  5140             20  CF-MORT-COMMENTS           PIC X(15).
  5141             20  FILLER                     PIC X(14).
  5142
  5143         16  FILLER                         PIC X(251).
  5144
  5145
  5146****************************************************************
  5147*             BUSSINESS TYPE MASTER RECORD                     *
  5148****************************************************************
  5149
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page  99
* EL156.cbl
  5150     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5151* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5152* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5153* AND RECORD 05 IS TYPES 81-99
  5154         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5155             20  CF-BUSINESS-TITLE          PIC  X(19).
  5156             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5157                                            PIC S9V9(4) COMP-3.
  5158             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5159             20  FILLER                     PIC  X.
  5160         16  FILLER                         PIC  X(248).
  5161
  5162
  5163****************************************************************
  5164*             TERMINAL MASTER RECORD                           *
  5165****************************************************************
  5166
  5167     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5168
  5169         16  CF-COMPANY-TERMINALS.
  5170             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5171                                  PIC X(4).
  5172         16  FILLER               PIC X(248).
  5173
  5174
  5175****************************************************************
  5176*             LIFE EDIT MASTER RECORD                          *
  5177****************************************************************
  5178
  5179     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5180         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5181             20  CF-LIFE-CODE-IN            PIC XX.
  5182             20  CF-LIFE-CODE-OUT           PIC XX.
  5183         16  FILLER                         PIC X(248).
  5184
  5185
  5186****************************************************************
  5187*             AH EDIT MASTER RECORD                            *
  5188****************************************************************
  5189
  5190     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5191         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5192             20  CF-AH-CODE-IN              PIC XXX.
  5193             20  CF-AH-CODE-OUT             PIC XX.
  5194         16  FILLER                         PIC X(248).
  5195
  5196
  5197****************************************************************
  5198*             CREDIBILITY TABLES                               *
  5199****************************************************************
  5200
  5201     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5202         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5203                             INDEXED BY CF-CRDB-NDX.
  5204             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5205             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5206             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5207         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 100
* EL156.cbl
  5208
  5209
  5210****************************************************************
  5211*             REPORT CUSTOMIZATION RECORD                      *
  5212****************************************************************
  5213
  5214     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5215         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5216             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5217             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5218             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5219**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5220****       A T-TRANSFER.                                   ****
  5221             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5222
  5223         16  FILLER                         PIC XX.
  5224
  5225         16  CF-CARRIER-CNTL-OPT.
  5226             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5227                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5228                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5229             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5230                                            PIC X.
  5231         16  CF-GROUP-CNTL-OPT.
  5232             20  CF-GROUP-OPT-SEQ           PIC 9.
  5233                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5234                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5235             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5236                                            PIC X(6).
  5237         16  CF-STATE-CNTL-OPT.
  5238             20  CF-STATE-OPT-SEQ           PIC 9.
  5239                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5240                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5241             20  CF-STATE-SELECT OCCURS 3 TIMES
  5242                                            PIC XX.
  5243         16  CF-ACCOUNT-CNTL-OPT.
  5244             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5245                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5246                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5247             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5248                                            PIC X(10).
  5249         16  CF-BUS-TYP-CNTL-OPT.
  5250             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5251                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5252                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5253             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5254                                            PIC XX.
  5255         16  CF-LF-TYP-CNTL-OPT.
  5256             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5257                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5258                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5259             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5260                                            PIC XX.
  5261         16  CF-AH-TYP-CNTL-OPT.
  5262             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5263                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5264                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5265             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 101
* EL156.cbl
  5266                                            PIC XX.
  5267         16  CF-REPTCD1-CNTL-OPT.
  5268             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5269                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5270                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5271             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5272                                            PIC X(10).
  5273         16  CF-REPTCD2-CNTL-OPT.
  5274             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5275                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5276                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5277             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5278                                            PIC X(10).
  5279         16  CF-USER1-CNTL-OPT.
  5280             20  CF-USER1-OPT-SEQ           PIC 9.
  5281                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5282                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5283             20  CF-USER1-SELECT OCCURS 3 TIMES
  5284                                            PIC X(10).
  5285         16  CF-USER2-CNTL-OPT.
  5286             20  CF-USER2-OPT-SEQ           PIC 9.
  5287                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5288                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5289             20  CF-USER2-SELECT OCCURS 3 TIMES
  5290                                            PIC X(10).
  5291         16  CF-USER3-CNTL-OPT.
  5292             20  CF-USER3-OPT-SEQ           PIC 9.
  5293                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5294                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5295             20  CF-USER3-SELECT OCCURS 3 TIMES
  5296                                            PIC X(10).
  5297         16  CF-USER4-CNTL-OPT.
  5298             20  CF-USER4-OPT-SEQ           PIC 9.
  5299                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5300                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5301             20  CF-USER4-SELECT OCCURS 3 TIMES
  5302                                            PIC X(10).
  5303         16  CF-USER5-CNTL-OPT.
  5304             20  CF-USER5-OPT-SEQ           PIC 9.
  5305                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5306                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5307             20  CF-USER5-SELECT OCCURS 3 TIMES
  5308                                            PIC X(10).
  5309         16  CF-REINS-CNTL-OPT.
  5310             20  CF-REINS-OPT-SEQ           PIC 9.
  5311                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5312                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5313             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5314                 24  CF-REINS-PRIME         PIC XXX.
  5315                 24  CF-REINS-SUB           PIC XXX.
  5316
  5317         16  CF-AGENT-CNTL-OPT.
  5318             20  CF-AGENT-OPT-SEQ           PIC 9.
  5319                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5320                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5321             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5322                                            PIC X(10).
  5323
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 102
* EL156.cbl
  5324         16  FILLER                         PIC X(43).
  5325
  5326         16  CF-LOSS-RATIO-SELECT.
  5327             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5328             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5329         16  CF-ENTRY-DATE-SELECT.
  5330             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5331             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5332         16  CF-EFFECTIVE-DATE-SELECT.
  5333             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5334             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5335
  5336         16  CF-EXCEPTION-LIST-IND          PIC X.
  5337             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5338
  5339         16  FILLER                         PIC X(318).
  5340
  5341****************************************************************
  5342*                  EXCEPTION REPORTING RECORD                  *
  5343****************************************************************
  5344
  5345     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5346         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5347             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5348
  5349         16  CF-COMBINED-LIFE-AH-OPT.
  5350             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5351             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5352             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5353             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5354
  5355         16  CF-LIFE-OPT.
  5356             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5357             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5358             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5359             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5360             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5361             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5362             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5363             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5364             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5365             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5366
  5367         16  CF-AH-OPT.
  5368             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5369             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5370             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5371             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5372             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5373             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5374             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5375             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5376             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5377             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5378
  5379         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5380             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5381             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 103
* EL156.cbl
  5382             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5383
  5384         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5385
  5386         16  FILLER                         PIC X(673).
  5387
  5388
  5389****************************************************************
  5390*             MORTGAGE SYSTEM PLAN RECORD                      *
  5391****************************************************************
  5392
  5393     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5394         16  CF-PLAN-TYPE                   PIC X.
  5395             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5396             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5397             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5398         16  CF-PLAN-ABBREV                 PIC XXX.
  5399         16  CF-PLAN-DESCRIPT               PIC X(10).
  5400         16  CF-PLAN-NOTES                  PIC X(20).
  5401         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5402         16  CF-PLAN-UNDERWRITING.
  5403             20  CF-PLAN-TERM-DATA.
  5404                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5405                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5406             20  CF-PLAN-AGE-DATA.
  5407                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5408                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5409                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5410             20  CF-PLAN-BENEFIT-DATA.
  5411                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5412                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5413                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5414                                            PIC S9(7)V99  COMP-3.
  5415         16  CF-PLAN-POLICY-FORMS.
  5416             20  CF-POLICY-FORM             PIC X(12).
  5417             20  CF-MASTER-APPLICATION      PIC X(12).
  5418             20  CF-MASTER-POLICY           PIC X(12).
  5419         16  CF-PLAN-RATING.
  5420             20  CF-RATE-CODE               PIC X(5).
  5421             20  CF-SEX-RATING              PIC X.
  5422                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5423                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5424             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5425             20  CF-SUB-STD-TYPE            PIC X.
  5426                 88  CF-PCT-OF-PREM            VALUE '1'.
  5427                 88  CF-PCT-OF-BENE            VALUE '2'.
  5428         16  CF-PLAN-PREM-TOLERANCES.
  5429             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5430             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5431         16  CF-PLAN-PYMT-TOLERANCES.
  5432             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5433             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5434         16  CF-PLAN-MISC-DATA.
  5435             20  FILLER                     PIC X.
  5436             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5437             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5438         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5439         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 104
* EL156.cbl
  5440             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5441                                                     '1'.
  5442             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5443                                                     '2'.
  5444         16  CF-MIB-SEARCH-SW               PIC X.
  5445             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5446             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5447             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5448             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5449         16  CF-ALPHA-SEARCH-SW             PIC X.
  5450             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5451             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5452             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5453             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5454             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5455             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5456             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5457             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5458             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5459             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5460                                                     'A' 'B' 'C'
  5461                                                     'X' 'Y' 'Z'.
  5462         16  CF-EFF-DT-RULE-SW              PIC X.
  5463             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5464             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5465             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5466             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5467             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5468         16  FILLER                         PIC X(4).
  5469         16  CF-HEALTH-QUESTIONS            PIC X.
  5470             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5471         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5472         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5473         16  CF-PLAN-SNGL-JNT               PIC X.
  5474             88  CF-COMBINED-PLAN              VALUE 'C'.
  5475             88  CF-JNT-PLAN                   VALUE 'J'.
  5476             88  CF-SNGL-PLAN                  VALUE 'S'.
  5477         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5478         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5479         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5480         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5481         16  CF-RERATE-CNTL                 PIC  X.
  5482             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5483             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5484             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5485             88  CF-AUTO-RECALC                 VALUE '4'.
  5486         16  CF-BENEFIT-TYPE                PIC  X.
  5487             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5488             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5489         16  CF-POLICY-FEE                  PIC S999V99
  5490                                                    COMP-3.
  5491         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5492         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5493         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5494         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5495         16  FILLER                         PIC  X(32).
  5496         16  CF-TERMINATION-FORM            PIC  X(04).
  5497         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 105
* EL156.cbl
  5498         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5499                                                       COMP-3.
  5500         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5501         16  CF-ISSUE-LETTER                PIC  X(4).
  5502         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5503         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5504             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5505             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5506         16  CF-MP-REFUND-CALC              PIC X.
  5507             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5508             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5509             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5510             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5511             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5512             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5513             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5514             88  CF-MP-REFD-MEAN                VALUE '8'.
  5515         16  CF-ALT-RATE-CODE               PIC  X(5).
  5516
  5517
  5518         16  FILLER                         PIC X(498).
  5519****************************************************************
  5520*             MORTGAGE COMPANY MASTER RECORD                   *
  5521****************************************************************
  5522
  5523     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5524         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5525         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5526             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5527             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5528             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5529             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5530             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5531
  5532         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5533         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5534         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5535         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5536         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5537
  5538         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5539             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5540         16  CF-MP-RECON-USE-IND            PIC X(1).
  5541             88  CF-MP-USE-RECON             VALUE 'Y'.
  5542         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5543             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5544         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5545             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5546             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5547         16  FILLER                         PIC X(1).
  5548         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5549             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5550         16  CF-MORTG-MIB-VERSION           PIC X.
  5551             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5552             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5553             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5554         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5555             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 106
* EL156.cbl
  5556                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5557             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5558                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5559             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5560                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5561             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5562                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5563             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5564                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5565             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5566                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5567         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5568         16  FILLER                         PIC X(7).
  5569         16  CF-MORTG-DESTINATION-SYMBOL.
  5570             20  CF-MORTG-MIB-COMM          PIC X(5).
  5571             20  CF-MORTG-MIB-TERM          PIC X(5).
  5572         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5573             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5574         16  FILLER                         PIC X(03).
  5575         16  CF-MP-CHECK-NO-CONTROL.
  5576             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5577                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5578                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5579                                                ' ' LOW-VALUES.
  5580                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5581                                               VALUE '3'.
  5582         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5583         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5584         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5585             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5586                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5587             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5588                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5589             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5590                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5591             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5592                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5593             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5594                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5595             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5596                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5597         16  CF-MORTG-BILLING-AREA.
  5598             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5599                                            PIC X.
  5600         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5601         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5602         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5603         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5604             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5605             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5606         16  FILLER                         PIC X.
  5607         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5608             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5609             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5610         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5611         16  FILLER                         PIC X(8).
  5612         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5613         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 107
* EL156.cbl
  5614         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5615         16  CF-ACH-COMPANY-ID.
  5616             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5617                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5618                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5619                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5620             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5621         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5622             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5623         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5624             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5625             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5626         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5627         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5628         16  FILLER                         PIC X(536).
  5629
  5630****************************************************************
  5631*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5632****************************************************************
  5633
  5634     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5635         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5636             20  CF-FEMALE-HEIGHT.
  5637                 24  CF-FEMALE-FT           PIC 99.
  5638                 24  CF-FEMALE-IN           PIC 99.
  5639             20  CF-FEMALE-MIN-WT           PIC 999.
  5640             20  CF-FEMALE-MAX-WT           PIC 999.
  5641         16  FILLER                         PIC X(428).
  5642
  5643     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5644         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5645             20  CF-MALE-HEIGHT.
  5646                 24  CF-MALE-FT             PIC 99.
  5647                 24  CF-MALE-IN             PIC 99.
  5648             20  CF-MALE-MIN-WT             PIC 999.
  5649             20  CF-MALE-MAX-WT             PIC 999.
  5650         16  FILLER                         PIC X(428).
  5651******************************************************************
  5652*             AUTOMATIC ACTIVITY RECORD                          *
  5653******************************************************************
  5654     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5655         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5656             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5657             20  CF-SYS-LETTER-ID           PIC X(04).
  5658             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5659             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5660             20  CF-SYS-RESET-SW            PIC X(01).
  5661             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5662             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5663
  5664         16  FILLER                         PIC X(50).
  5665
  5666         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5667             20  CF-USER-ACTIVE-SW          PIC X(01).
  5668             20  CF-USER-LETTER-ID          PIC X(04).
  5669             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5670             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5671             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 108
* EL156.cbl
  5672             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5673             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5674             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5675
  5676         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 109
* EL156.cbl
  5678*    COPY ELCCERT.
  5679******************************************************************
  5680*                                                                *
  5681*                            ELCCERT.                            *
  5682*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5683*                            VMOD=2.013                          *
  5684*                                                                *
  5685*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5686*                                                                *
  5687*   FILE TYPE = VSAM,KSDS                                        *
  5688*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5689*                                                                *
  5690*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5691*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5692*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5693*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5694*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5695*                                                                *
  5696*   LOG = YES                                                    *
  5697*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5698******************************************************************
  5699*                   C H A N G E   L O G
  5700*
  5701* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5702*-----------------------------------------------------------------
  5703*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5704* EFFECTIVE    NUMBER
  5705*-----------------------------------------------------------------
  5706* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5707* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5708* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5709* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5710* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5711* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5712* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5713* 032612  CR2011110200001  PEMA  AHL CHANGES
  5714* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5715* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5716* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5717******************************************************************
  5718
  5719 01  CERTIFICATE-MASTER.
  5720     12  CM-RECORD-ID                      PIC XX.
  5721         88  VALID-CM-ID                      VALUE 'CM'.
  5722
  5723     12  CM-CONTROL-PRIMARY.
  5724         16  CM-COMPANY-CD                 PIC X.
  5725         16  CM-CARRIER                    PIC X.
  5726         16  CM-GROUPING.
  5727             20  CM-GROUPING-PREFIX        PIC X(3).
  5728             20  CM-GROUPING-PRIME         PIC X(3).
  5729         16  CM-STATE                      PIC XX.
  5730         16  CM-ACCOUNT.
  5731             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5732             20  CM-ACCOUNT-PRIME          PIC X(6).
  5733         16  CM-CERT-EFF-DT                PIC XX.
  5734         16  CM-CERT-NO.
  5735             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 110
* EL156.cbl
  5736             20  CM-CERT-SFX               PIC X.
  5737
  5738     12  CM-CONTROL-BY-NAME.
  5739         16  CM-COMPANY-CD-A1              PIC X.
  5740         16  CM-INSURED-LAST-NAME          PIC X(15).
  5741         16  CM-INSURED-INITIALS.
  5742             20  CM-INSURED-INITIAL1       PIC X.
  5743             20  CM-INSURED-INITIAL2       PIC X.
  5744
  5745     12  CM-CONTROL-BY-SSN.
  5746         16  CM-COMPANY-CD-A2              PIC X.
  5747         16  CM-SOC-SEC-NO.
  5748             20  CM-SSN-STATE              PIC XX.
  5749             20  CM-SSN-ACCOUNT            PIC X(6).
  5750             20  CM-SSN-LN3.
  5751                 25  CM-INSURED-INITIALS-A2.
  5752                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5753                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5754                 25 CM-PART-LAST-NAME-A2         PIC X.
  5755
  5756     12  CM-CONTROL-BY-CERT-NO.
  5757         16  CM-COMPANY-CD-A4              PIC X.
  5758         16  CM-CERT-NO-A4                 PIC X(11).
  5759
  5760     12  CM-CONTROL-BY-MEMB.
  5761         16  CM-COMPANY-CD-A5              PIC X.
  5762         16  CM-MEMBER-NO.
  5763             20  CM-MEMB-STATE             PIC XX.
  5764             20  CM-MEMB-ACCOUNT           PIC X(6).
  5765             20  CM-MEMB-LN4.
  5766                 25  CM-INSURED-INITIALS-A5.
  5767                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5768                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5769                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5770
  5771     12  CM-INSURED-PROFILE-DATA.
  5772         16  CM-INSURED-FIRST-NAME.
  5773             20  CM-INSURED-1ST-INIT       PIC X.
  5774             20  FILLER                    PIC X(9).
  5775         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5776         16  CM-INSURED-SEX                PIC X.
  5777             88  CM-SEX-MALE                  VALUE 'M'.
  5778             88  CM-SEX-FEMAL                 VALUE 'F'.
  5779         16  CM-INSURED-JOINT-AGE          PIC 99.
  5780         16  CM-JOINT-INSURED-NAME.
  5781             20  CM-JT-LAST-NAME           PIC X(15).
  5782             20  CM-JT-FIRST-NAME.
  5783                 24  CM-JT-1ST-INIT        PIC X.
  5784                 24  FILLER                PIC X(9).
  5785             20  CM-JT-INITIAL             PIC X.
  5786
  5787     12  CM-LIFE-DATA.
  5788         16  CM-LF-BENEFIT-CD              PIC XX.
  5789         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5790         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5791         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5792         16  CM-LF-DEV-CODE                PIC XXX.
  5793         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 111
* EL156.cbl
  5794         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5795         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5796         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5797         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5798         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5799         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5800         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5801         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5802         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5803         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5804         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5805         16  cm-temp-epiq                  pic xx.
  5806             88  EPIQ-CLASS                  value 'EQ'.
  5807*        16  FILLER                        PIC XX.
  5808
  5809     12  CM-AH-DATA.
  5810         16  CM-AH-BENEFIT-CD              PIC XX.
  5811         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5812         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5813         16  CM-AH-DEV-CODE                PIC XXX.
  5814         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5815         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5816         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5817         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5818         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5819         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5820         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5821         16  CM-AH-PAID-THRU-DT            PIC XX.
  5822             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5823         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5824         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5825         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5826         16  FILLER                        PIC X.
  5827
  5828     12  CM-LOAN-INFORMATION.
  5829         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5830         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5831                                           PIC S9(5)V99  COMP-3.
  5832         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5833         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5834         16  CM-PAY-FREQUENCY              PIC S99.
  5835         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5836         16  CM-RATE-CLASS                 PIC XX.
  5837         16  CM-BENEFICIARY                PIC X(25).
  5838         16  CM-POLICY-FORM-NO             PIC X(12).
  5839         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5840         16  CM-LAST-ADD-ON-DT             PIC XX.
  5841         16  CM-DEDUCTIBLE-AMOUNTS.
  5842             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5843             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5844         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5845             20  CM-RESIDENT-STATE         PIC XX.
  5846             20  CM-RATE-CODE              PIC X(4).
  5847             20  FILLER                    PIC XX.
  5848         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5849             20  CM-LOAN-OFFICER           PIC X(5).
  5850             20  FILLER                    PIC XXX.
  5851         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 112
* EL156.cbl
  5852         16  CM-UNDERWRITING-CODE          PIC X.
  5853             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5854         16  CM-POST-CARD-IND              PIC X.
  5855         16  CM-REF-INTERFACE-SW           PIC X.
  5856         16  CM-PREMIUM-TYPE               PIC X.
  5857             88  CM-SING-PRM                  VALUE '1'.
  5858             88  CM-O-B-COVERAGE              VALUE '2'.
  5859             88  CM-OPEN-END                  VALUE '3'.
  5860         16  CM-IND-GRP-TYPE               PIC X.
  5861             88  CM-INDIVIDUAL                VALUE 'I'.
  5862             88  CM-GROUP                     VALUE 'G'.
  5863         16  CM-SKIP-CODE                  PIC X.
  5864             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5865             88  SKIP-JULY                    VALUE '1'.
  5866             88  SKIP-AUGUST                  VALUE '2'.
  5867             88  SKIP-SEPTEMBER               VALUE '3'.
  5868             88  SKIP-JULY-AUG                VALUE '4'.
  5869             88  SKIP-AUG-SEPT                VALUE '5'.
  5870             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5871             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5872             88  SKIP-JUNE                    VALUE '8'.
  5873             88  SKIP-JUNE-JULY               VALUE '9'.
  5874             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5875             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5876         16  CM-PAYMENT-MODE               PIC X.
  5877             88  PAY-MONTHLY                  VALUE SPACE.
  5878             88  PAY-WEEKLY                   VALUE '1'.
  5879             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5880             88  PAY-BI-WEEKLY                VALUE '3'.
  5881             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5882         16  CM-LOAN-NUMBER                PIC X(8).
  5883         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5884         16  CM-OLD-LOF                    PIC XXX.
  5885*        16  CM-LOAN-OFFICER               PIC XXX.
  5886         16  CM-REIN-TABLE                 PIC XXX.
  5887         16  CM-SPECIAL-REIN-CODE          PIC X.
  5888         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5889         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5890         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5891
  5892     12  CM-STATUS-DATA.
  5893         16  CM-ENTRY-STATUS               PIC X.
  5894         16  CM-ENTRY-DT                   PIC XX.
  5895
  5896         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5897         16  CM-LF-CANCEL-DT               PIC XX.
  5898         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5899
  5900         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5901         16  CM-LF-DEATH-DT                PIC XX.
  5902         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5903
  5904         16  CM-LF-CURRENT-STATUS          PIC X.
  5905             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5906                                                'M' '4' '5' '9'.
  5907             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5908             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5909             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 113
* EL156.cbl
  5910             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5911             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5912             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5913             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5914             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5915             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5916             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5917             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5918             88  CM-LF-DECLINED               VALUE 'D'.
  5919             88  CM-LF-VOIDED                 VALUE 'V'.
  5920
  5921         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5922         16  CM-AH-CANCEL-DT               PIC XX.
  5923         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5924
  5925         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5926         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5927         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5928
  5929         16  CM-AH-CURRENT-STATUS          PIC X.
  5930             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5931                                                'M' '4' '5' '9'.
  5932             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5933             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5934             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5935             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5936             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5937             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5938             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5939             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5940             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5941             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5942             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5943             88  CM-AH-DECLINED               VALUE 'D'.
  5944             88  CM-AH-VOIDED                 VALUE 'V'.
  5945
  5946         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5947             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5948             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5949             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5950         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5951
  5952         16  CM-ENTRY-BATCH                PIC X(6).
  5953         16  CM-LF-EXIT-BATCH              PIC X(6).
  5954         16  CM-AH-EXIT-BATCH              PIC X(6).
  5955         16  CM-LAST-MONTH-END             PIC XX.
  5956
  5957     12  CM-NOTE-SW                        PIC X.
  5958         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5959         88  CERT-NOTES-PRESENT               VALUE '1'.
  5960         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5961         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5962         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5963         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5964         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5965         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5966     12  CM-COMP-EXCP-SW                   PIC X.
  5967         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 114
* EL156.cbl
  5968         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5969     12  CM-INSURED-ADDRESS-SW             PIC X.
  5970         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5971         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5972
  5973*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5974     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5975     12  FILLER                            PIC X.
  5976
  5977*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5978     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5979     12  FILLER                            PIC X.
  5980*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5981     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  5982
  5983     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5984         88  CERT-ADDED-BATCH                 VALUE ' '.
  5985         88  CERT-ADDED-ONLINE                VALUE '1'.
  5986         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5987         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5988         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5989     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5990         88  CERT-AS-LOADED                   VALUE ' '.
  5991         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5992         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5993         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5994         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5995         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5996         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5997         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5998
  5999     12  CM-ACCOUNT-COMM-PCTS.
  6000         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6001         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6002
  6003     12  CM-USER-FIELD                     PIC X.
  6004     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6005     12  CM-CLP-STATE                      PIC XX.
  6006     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6007     12  CM-USER-RESERVED                  PIC XXX.
  6008     12  FILLER REDEFINES CM-USER-RESERVED.
  6009         16  CM-AH-CLASS-CD                PIC XX.
  6010         16  F                             PIC X.
  6011******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 115
* EL156.cbl
  6013*    COPY ELCTRLR.
  6014******************************************************************
  6015*                                                                *
  6016*                            ELCTRLR.                            *
  6017*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6018*                            VMOD=2.014                          *
  6019*                                                                *
  6020*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  6021*                                                                *
  6022*   FILE TYPE = VSAM,KSDS                                        *
  6023*   RECORD SIZE = 200    RECFORM = FIXED                         *
  6024*                                                                *
  6025*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  6026*       ALTERNATE INDEX = NONE                                   *
  6027*                                                                *
  6028*   LOG = YES                                                    *
  6029*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6030******************************************************************
  6031*                   C H A N G E   L O G
  6032*
  6033* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6034*-----------------------------------------------------------------
  6035*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6036* EFFECTIVE    NUMBER
  6037*-----------------------------------------------------------------
  6038* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  6039* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  6040* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  6041* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  6042* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  6043* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  6044* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  6045* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  6046* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  6047* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  6048* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  6049* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  6050* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  6051* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  6052* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  6053* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6054* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  6055* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  6056* 040814    2014030500002  AJRA  ADD ICD CODES
  6057* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  6058* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6059* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  6060* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  6061* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
  6062******************************************************************
  6063 01  ACTIVITY-TRAILERS.
  6064     12  AT-RECORD-ID                    PIC XX.
  6065         88  VALID-AT-ID                       VALUE 'AT'.
  6066
  6067     12  AT-CONTROL-PRIMARY.
  6068         16  AT-COMPANY-CD               PIC X.
  6069         16  AT-CARRIER                  PIC X.
  6070         16  AT-CLAIM-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 116
* EL156.cbl
  6071         16  AT-CERT-NO.
  6072             20  AT-CERT-PRIME           PIC X(10).
  6073             20  AT-CERT-SFX             PIC X.
  6074         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  6075             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  6076             88  AT-LAST-TRL-AVAIL            VALUE +100.
  6077             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  6078             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  6079             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  6080             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  6081             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  6082             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  6083             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  6084             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  6085             88  AT-DIAGNOSIS-TRL             VALUE +90.
  6086             88  AT-BENEFICIARY-TRL           VALUE +91.
  6087             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  6088             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  6089             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  6090             88  AT-ERROR-MSGS-TRL            VALUE +95.
  6091
  6092     12  AT-TRAILER-TYPE                 PIC X.
  6093         88  RESERVE-EXPENSE-TR               VALUE '1'.
  6094         88  PAYMENT-TR                       VALUE '2'.
  6095         88  AUTO-PAY-TR                      VALUE '3'.
  6096         88  CORRESPONDENCE-TR                VALUE '4'.
  6097         88  ADDRESS-TR                       VALUE '5'.
  6098         88  GENERAL-INFO-TR                  VALUE '6'.
  6099         88  AUTO-PROMPT-TR                   VALUE '7'.
  6100         88  DENIAL-TR                        VALUE '8'.
  6101         88  INCURRED-CHG-TR                  VALUE '9'.
  6102         88  FORM-CONTROL-TR                  VALUE 'A'.
  6103
  6104     12  AT-RECORDED-DT                  PIC XX.
  6105     12  AT-RECORDED-BY                  PIC X(4).
  6106     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6107
  6108     12  AT-TRAILER-BODY                 PIC X(165).
  6109
  6110     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6111         16  AT-RESERVE-CONTROLS.
  6112             20  AT-MANUAL-SW            PIC X.
  6113                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6114             20  AT-FUTURE-SW            PIC X.
  6115                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6116             20  AT-PTC-SW               PIC X.
  6117                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6118             20  AT-IBNR-SW              PIC X.
  6119                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6120             20  AT-PTC-LF-SW            PIC X.
  6121                 88  AT-LF-PTC-USED          VALUE '1'.
  6122             20  AT-CDT-ACCESS-METHOD    PIC X.
  6123                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6124                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6125                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6126             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6127         16  AT-LAST-COMPUTED-DT         PIC XX.
  6128         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 117
* EL156.cbl
  6129         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6130         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6131         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6132         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6133         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6134         16  AT-EXPENSE-CONTROLS.
  6135             20  AT-EXPENSE-METHOD       PIC X.
  6136                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6137                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6138                 88  PERCENT-OF-PMT           VALUE '3'.
  6139                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6140             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6141             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6142         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6143         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6144
  6145         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6146         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6147
  6148*        16  FILLER                      PIC X(53).
  6149         16  FILLER                      PIC X(47).
  6150
  6151         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6152         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6153
  6154         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6155             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6156             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6157*                    C = CLOSED
  6158*                    O = OPEN
  6159             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6160*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6161
  6162     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6163         16  AT-PAYMENT-TYPE             PIC X.
  6164             88  PARTIAL-PAYMENT                VALUE '1'.
  6165             88  FINAL-PAYMENT                  VALUE '2'.
  6166             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6167             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6168             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6169             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6170             88  VOIDED-PAYMENT                 VALUE '9'.
  6171             88  TRANSFER                       VALUE 'T'.
  6172             88  LIFE-INTEREST                  VALUE 'I'.
  6173
  6174         16  AT-CLAIM-TYPE               PIC X.
  6175             88  PAID-FOR-AH                    VALUE 'A'.
  6176             88  PAID-FOR-LIFE                  VALUE 'L'.
  6177             88  PAID-FOR-IUI                   VALUE 'I'.
  6178             88  PAID-FOR-GAP                   VALUE 'G'.
  6179             88  PAID-FOR-FAM                   VALUE 'F'.
  6180             88  PAID-FOR-OTH                   VALUE 'O'.
  6181         16  AT-CLAIM-PREM-TYPE          PIC X.
  6182             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6183             88  AT-O-B-COVERAGE                VALUE '2'.
  6184             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6185         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6186         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 118
* EL156.cbl
  6187         16  AT-PAID-FROM-DT             PIC XX.
  6188         16  AT-PAID-THRU-DT             PIC XX.
  6189         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6190         16  AT-ACH-PAYMENT              PIC X.
  6191*        16  FILLER                      PIC X.
  6192         16  AT-PAYEES-NAME              PIC X(30).
  6193         16  AT-PAYMENT-ORIGIN           PIC X.
  6194             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6195             88  ONLINE-AUTO-PMT                VALUE '2'.
  6196             88  OFFLINE-PMT                    VALUE '3'.
  6197         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6198         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6199         16  AT-VOID-DATA.
  6200             20  AT-VOID-DT              PIC XX.
  6201*00144       20  AT-VOID-REASON          PIC X(30).
  6202             20  AT-VOID-REASON          PIC X(26).
  6203         16  AT-PMT-APPROVED-BY          PIC X(04).
  6204         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6205         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6206         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6207                                         PIC S99V9(5)  COMP-3.
  6208         16  AT-CREDIT-INTERFACE.
  6209             20  AT-PMT-SELECT-DT        PIC XX.
  6210                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6211             20  AT-PMT-ACCEPT-DT        PIC XX.
  6212                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6213             20  AT-VOID-SELECT-DT       PIC XX.
  6214                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6215             20  AT-VOID-ACCEPT-DT       PIC XX.
  6216                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6217
  6218         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6219                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6220                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6221         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6222
  6223         16  AT-FORCE-CONTROL            PIC X.
  6224             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6225         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6226         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6227         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6228         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6229         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6230         16  AT-BENEFIT-TYPE             PIC X.
  6231
  6232         16  AT-EXPENSE-TYPE             PIC X.
  6233         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6234
  6235         16  AT-PAYEE-TYPE-CD.
  6236             20  AT-PAYEE-TYPE           PIC X.
  6237                 88  INSURED-PAID           VALUE 'I'.
  6238                 88  BENEFICIARY-PAID       VALUE 'B'.
  6239                 88  ACCOUNT-PAID           VALUE 'A'.
  6240                 88  OTHER-1-PAID           VALUE 'O'.
  6241                 88  OTHER-2-PAID           VALUE 'Q'.
  6242                 88  DOCTOR-PAID            VALUE 'P'.
  6243                 88  EMPLOYER-PAID          VALUE 'E'.
  6244             20  AT-PAYEE-SEQ            PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 119
* EL156.cbl
  6245
  6246         16  AT-CASH-PAYMENT             PIC X.
  6247         16  AT-GROUPED-PAYMENT          PIC X.
  6248         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6249         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6250         16  AT-APPROVED-LEVEL           PIC X.
  6251         16  AT-VOID-TYPE                PIC X.
  6252             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6253             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6254         16  AT-AIG-UNEMP-IND            PIC X.
  6255             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6256         16  AT-ASSOCIATES               PIC X.
  6257             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6258             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6259
  6260         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6261         16  AT-CV-PMT-CODE              PIC X.
  6262             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6263             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6264             88  FULL-ADD-PAYMENT           VALUE '3'.
  6265             88  HALF-ADD-PAYMENT           VALUE '4'.
  6266             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6267             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6268             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6269             88  ADDL-PAYMENT               VALUE '8'.
  6270
  6271         16  AT-EOB-CODE1                PIC XXX.
  6272         16  AT-EOB-CODE2                PIC XXX.
  6273         16  AT-EOB-CODE3                PIC XXX.
  6274         16  FILLER REDEFINES AT-EOB-CODE3.
  6275             20  AT-PRINT-CLM-FORM       PIC X.
  6276             20  AT-PRINT-SURVEY         PIC X.
  6277             20  AT-SPECIAL-RELEASE      PIC X.
  6278         16  AT-EOB-CODE4                PIC XXX.
  6279         16  FILLER REDEFINES AT-EOB-CODE4.
  6280             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6281             20  FILLER                  PIC X.
  6282         16  AT-EOB-CODE5                PIC XXX.
  6283         16  FILLER REDEFINES AT-EOB-CODE5.
  6284             20  AT-PMT-PROOF-DT         PIC XX.
  6285             20  FILLER                  PIC X.
  6286
  6287         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6288             88  AT-PRINT-EOB            VALUE 'Y'.
  6289
  6290         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6291         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6292
  6293     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6294         16  AT-SCHEDULE-START-DT        PIC XX.
  6295         16  AT-SCHEDULE-END-DT          PIC XX.
  6296         16  AT-TERMINATED-DT            PIC XX.
  6297         16  AT-LAST-PMT-TYPE            PIC X.
  6298             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6299             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6300         16  AT-FIRST-PMT-DATA.
  6301             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6302             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 120
* EL156.cbl
  6303             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6304         16  AT-REGULAR-PMT-DATA.
  6305             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6306             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6307             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6308         16  AT-AUTO-PAYEE-CD.
  6309             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6310                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6311                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6312                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6313                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6314                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6315             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6316         16  AT-AUTO-PAY-DAY             PIC 99.
  6317         16  AT-AUTO-CASH                PIC X.
  6318             88  AT-CASH                      VALUE 'Y'.
  6319             88  AT-NON-CASH                  VALUE 'N'.
  6320*        16  FILLER                      PIC X(129).
  6321         16  AT-AUTO-END-LETTER          PIC X(4).
  6322         16  FILLER                      PIC X(125).
  6323
  6324         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6325         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6326
  6327     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6328         16  AT-LETTER-SENT-DT           PIC XX.
  6329         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6330         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6331         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6332         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6333         16  AT-LETTER-ORIGIN            PIC X.
  6334             88  ONLINE-CREATION              VALUE '1' '3'.
  6335             88  OFFLINE-CREATION             VALUE '2' '4'.
  6336             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6337             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6338         16  AT-STD-LETTER-FORM          PIC X(4).
  6339         16  AT-REASON-TEXT              PIC X(70).
  6340         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6341         16  AT-ADDRESEE-TYPE            PIC X.
  6342              88  INSURED-ADDRESEE            VALUE 'I'.
  6343              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6344              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6345              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6346              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6347              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6348              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6349         16  AT-ADDRESSEE-NAME           PIC X(30).
  6350         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6351         16  AT-RESEND-PRINT-DATE        PIC XX.
  6352         16  AT-CORR-SOL-UNSOL           PIC X.
  6353         16  AT-LETTER-PURGED-DT         PIC XX.
  6354*
  6355*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6356*
  6357         16  AT-CSO-REDEFINITION.
  6358             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6359             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6360             20  AT-LETTER-TO-BENE       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 121
* EL156.cbl
  6361             20  AT-STOP-LETTER-DT       PIC X(2).
  6362             20  AT-AUTH-RCVD            PIC X(1).
  6363             20  FILLER                  PIC X(18).
  6364*             20  FILLER                  PIC X(27).
  6365             20  AT-CSO-LETTER-STATUS    PIC X.
  6366                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6367                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6368                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6369             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6370             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6371*
  6372*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6373*
  6374*        16  FILLER                      PIC X(26).
  6375*
  6376*        16  AT-DMD-BSR-CODE             PIC X.
  6377*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6378*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6379*
  6380*        16  AT-DMD-LETTER-STATUS        PIC X.
  6381*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6382*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6383*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6384*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6385*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6386
  6387         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6388         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6389
  6390     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6391         16  AT-ADDRESS-TYPE             PIC X.
  6392             88  INSURED-ADDRESS               VALUE 'I'.
  6393             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6394             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6395             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6396             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6397             88  OTHER-ADDRESS-1               VALUE 'O'.
  6398             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6399         16  AT-MAIL-TO-NAME             PIC X(30).
  6400         16  AT-ADDRESS-LINE-1           PIC X(30).
  6401         16  AT-ADDRESS-LINE-2           PIC X(30).
  6402         16  AT-CITY-STATE.
  6403             20  AT-CITY                 PIC X(28).
  6404             20  AT-STATE                PIC XX.
  6405         16  AT-ZIP.
  6406             20  AT-ZIP-CODE.
  6407                 24  AT-ZIP-1ST          PIC X.
  6408                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6409                 24  FILLER              PIC X(4).
  6410             20  AT-ZIP-PLUS4            PIC X(4).
  6411         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6412             20  AT-CAN-POSTAL-1         PIC XXX.
  6413             20  AT-CAN-POSTAL-2         PIC XXX.
  6414             20  FILLER                  PIC XXX.
  6415         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6416*         16  FILLER                      PIC X(23).
  6417         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6418         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 122
* EL156.cbl
  6419         16  FILLER                      PIC X(13).
  6420         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6421         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6422
  6423     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6424         16  AT-INFO-LINE-1              PIC X(60).
  6425         16  FILLER REDEFINES AT-INFO-LINE-1.
  6426             20  AT-NOTE-ERROR-NO OCCURS 15
  6427                                         PIC X(4).
  6428         16  AT-INFO-LINE-2              PIC X(60).
  6429         16  FILLER REDEFINES AT-INFO-LINE-2.
  6430             20  AT-ICD-CODE-1           PIC X(8).
  6431             20  AT-ICD-CODE-2           PIC X(8).
  6432             20  FILLER                  PIC X(44).
  6433         16  AT-INFO-TRAILER-TYPE        PIC X.
  6434             88  AT-ERRORS-NOTE          VALUE 'E'.
  6435             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6436             88  AT-CALL-NOTE            VALUE 'C'.
  6437             88  AT-MAINT-NOTE           VALUE 'M'.
  6438             88  AT-CERT-CHANGE          VALUE 'X'.
  6439             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6440             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6441             88  AT-CERT-CANCELLED       VALUE 'T'.
  6442         16  AT-CALL-TYPE                PIC X.
  6443             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6444             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  6445             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6446         16  AT-NOTE-CONTINUATION        PIC X.
  6447             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6448         16  AT-EOB-CODES-EXIST          PIC X.
  6449             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6450         16  FILLER                      PIC X(35).
  6451         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6452         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6453
  6454     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6455         16  AT-PROMPT-LINE-1            PIC X(60).
  6456         16  AT-PROMPT-LINE-2            PIC X(60).
  6457         16  AT-PROMPT-START-DT          PIC XX.
  6458         16  AT-PROMPT-END-DT            PIC XX.
  6459         16  FILLER                      PIC X(35).
  6460         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6461         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6462
  6463     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6464         16  AT-DENIAL-INFO-1            PIC X(60).
  6465         16  AT-DENIAL-INFO-2            PIC X(60).
  6466         16  AT-DENIAL-DT                PIC XX.
  6467         16  AT-RETRACTION-DT            PIC XX.
  6468         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6469*         16  FILLER                      PIC X(31).
  6470         16  AT-DENIAL-PROOF-DT          PIC XX.
  6471         16  FILLER                      PIC X(29).
  6472         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6473         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6474
  6475     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6476         16  AT-OLD-INCURRED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 123
* EL156.cbl
  6477         16  AT-OLD-REPORTED-DT          PIC XX.
  6478         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6479         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6480         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6481         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6482         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6483         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6484         16  FILLER                      PIC X(26).
  6485         16  AT-OLD-DIAG-CODE            PIC X(6).
  6486         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6487         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6488         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6489         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6490         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6491         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6492         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6493         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6494         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6495         16  FILLER                      PIC X(9).
  6496         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6497
  6498     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6499         16  AT-FORM-SEND-ON-DT          PIC XX.
  6500         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6501         16  AT-FORM-RE-SEND-DT          PIC XX.
  6502         16  AT-FORM-ANSWERED-DT         PIC XX.
  6503         16  AT-FORM-PRINTED-DT          PIC XX.
  6504         16  AT-FORM-REPRINT-DT          PIC XX.
  6505         16  AT-FORM-TYPE                PIC X.
  6506             88  INITIAL-FORM                  VALUE '1'.
  6507             88  PROGRESS-FORM                 VALUE '2'.
  6508         16  AT-INSTRUCT-LN-1            PIC X(28).
  6509         16  AT-INSTRUCT-LN-2            PIC X(28).
  6510         16  AT-INSTRUCT-LN-3            PIC X(28).
  6511         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6512         16  AT-FORM-ADDRESS             PIC X.
  6513             88  FORM-TO-INSURED              VALUE 'I'.
  6514             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6515             88  FORM-TO-OTHER-1              VALUE 'O'.
  6516             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6517         16  AT-RELATED-1.
  6518             20 AT-REL-CARR-1            PIC X.
  6519             20 AT-REL-CLAIM-1           PIC X(7).
  6520             20 AT-REL-CERT-1            PIC X(11).
  6521         16  AT-RELATED-2.
  6522             20 AT-REL-CARR-2            PIC X.
  6523             20 AT-REL-CLAIM-2           PIC X(7).
  6524             20 AT-REL-CERT-2            PIC X(11).
  6525         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6526         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6527         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6528         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6529         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6530         16  AT-STOP-FORM-DT             PIC X(2).
  6531
  6532         16  FILLER                      PIC X(09).
  6533         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6534         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 124
* EL156.cbl
  6535******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 125
* EL156.cbl
  6537*    COPY ELCACTQ.
  6538******************************************************************
  6539*                                                                *
  6540*                            ELCACTQ.                            *
  6541*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6542*                            VMOD=2.004                          *
  6543*                                                                *
  6544*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6545*                                                                *
  6546*   FILE TYPE = VSAM,KSDS                                        *
  6547*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6548*                                                                *
  6549*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6550*       ALTERNATE INDEX = NONE                                   *
  6551*                                                                *
  6552*   LOG = YES                                                    *
  6553*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6554*                                                                *
  6555*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6556******************************************************************
  6557
  6558 01  ACTIVITY-QUE.
  6559     12  AQ-RECORD-ID                PIC XX.
  6560         88  VALID-AQ-ID                VALUE 'AQ'.
  6561
  6562     12  AQ-CONTROL-PRIMARY.
  6563         16  AQ-COMPANY-CD           PIC X.
  6564         16  AQ-CARRIER              PIC X.
  6565         16  AQ-CLAIM-NO             PIC X(7).
  6566         16  AQ-CERT-NO.
  6567             20  AQ-CERT-PRIME       PIC X(10).
  6568             20  AQ-CERT-SFX         PIC X.
  6569
  6570     12  AQ-PENDING-ACTIVITY-FLAGS.
  6571         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6572         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6573             88  PENDING-PAYMENTS       VALUE '1'.
  6574         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6575             88  PENDING-FULL-PRINT     VALUE '1'.
  6576             88  PENDING-PART-PRINT     VALUE '2'.
  6577         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6578             88  PENDING-LETTERS        VALUE '1'.
  6579         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6580             88  PENDING-RESTORE        VALUE 'C'.
  6581             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6582
  6583     12  FILLER                      PIC X(20).
  6584
  6585     12  AQ-RESEND-DATE              PIC XX.
  6586     12  AQ-FOLLOWUP-DATE            PIC XX.
  6587     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6588     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6589     12  AQ-AUTO-LETTER              PIC X(4).
  6590     12  FILLER                      PIC XX.
  6591     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6592*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 126
* EL156.cbl
  6594*    COPY ERCACCT.
  6595******************************************************************
  6596*                                                                *
  6597*                                                                *
  6598*                            ERCACCT                             *
  6599*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6600*                            VMOD=2.031                          *
  6601*                                                                *
  6602*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6603*                                                                *
  6604*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6605*   VSAM ACCOUNT MASTER FILES.                                   *
  6606*                                                                *
  6607*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6608*                                                                *
  6609*   FILE TYPE = VSAM,KSDS                                        *
  6610*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6611*                                                                *
  6612*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6613*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6614*                                                                *
  6615*   LOG = NO                                                     *
  6616*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6617*                                                                *
  6618*                                                                *
  6619******************************************************************
  6620*                   C H A N G E   L O G
  6621*
  6622* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6623*-----------------------------------------------------------------
  6624*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6625* EFFECTIVE    NUMBER
  6626*-----------------------------------------------------------------
  6627* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6628* 092705    2005050300006  PEMA  ADD SPP LEASES
  6629* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6630* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6631* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6632* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6633* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6634* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6635******************************************************************
  6636
  6637 01  ACCOUNT-MASTER.
  6638     12  AM-RECORD-ID                      PIC XX.
  6639         88  VALID-AM-ID                      VALUE 'AM'.
  6640
  6641     12  AM-CONTROL-PRIMARY.
  6642         16  AM-COMPANY-CD                 PIC X.
  6643         16  AM-MSTR-CNTRL.
  6644             20  AM-CONTROL-A.
  6645                 24  AM-CARRIER            PIC X.
  6646                 24  AM-GROUPING.
  6647                     28 AM-GROUPING-PREFIX PIC XXX.
  6648                     28 AM-GROUPING-PRIME  PIC XXX.
  6649                 24  AM-STATE              PIC XX.
  6650                 24  AM-ACCOUNT.
  6651                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 127
* EL156.cbl
  6652                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6653             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6654                                           PIC X(19).
  6655             20  AM-CNTRL-B.
  6656                 24  AM-EXPIRATION-DT      PIC XX.
  6657                 24  FILLER                PIC X(4).
  6658             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6659                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6660
  6661     12  AM-CONTROL-BY-VAR-GRP.
  6662         16  AM-COMPANY-CD-A1              PIC X.
  6663         16  AM-VG-CARRIER                 PIC X.
  6664         16  AM-VG-GROUPING                PIC X(6).
  6665         16  AM-VG-STATE                   PIC XX.
  6666         16  AM-VG-ACCOUNT                 PIC X(10).
  6667         16  AM-VG-DATE.
  6668             20  AM-VG-EXPIRATION-DT       PIC XX.
  6669             20  FILLER                    PIC X(4).
  6670         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6671                                           PIC 9(11)      COMP-3.
  6672     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6673         16  FILLER                        PIC X(10).
  6674         16  AM-VG-KEY3.
  6675             20  AM-VG3-ACCOUNT            PIC X(10).
  6676             20  AM-VG3-EXP-DT             PIC XX.
  6677         16  FILLER                        PIC X(4).
  6678     12  AM-MAINT-INFORMATION.
  6679         16  AM-LAST-MAINT-DT              PIC XX.
  6680         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6681         16  AM-LAST-MAINT-USER            PIC X(4).
  6682         16  FILLER                        PIC XX.
  6683
  6684     12  AM-EFFECTIVE-DT                   PIC XX.
  6685     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6686
  6687     12  AM-PREV-DATES  COMP-3.
  6688         16  AM-PREV-EXP-DT                PIC 9(11).
  6689         16  AM-PREV-EFF-DT                PIC 9(11).
  6690
  6691     12  AM-REPORT-CODE-1                  PIC X(10).
  6692     12  AM-REPORT-CODE-2                  PIC X(10).
  6693
  6694     12  AM-CITY-CODE                      PIC X(4).
  6695     12  AM-COUNTY-PARISH                  PIC X(6).
  6696
  6697     12  AM-NAME                           PIC X(30).
  6698     12  AM-PERSON                         PIC X(30).
  6699     12  AM-ADDRS                          PIC X(30).
  6700     12  AM-CITY.
  6701         16  AM-ADDR-CITY                  PIC X(28).
  6702         16  AM-ADDR-STATE                 PIC XX.
  6703     12  AM-ZIP.
  6704         16  AM-ZIP-PRIME.
  6705             20  AM-ZIP-PRI-1ST            PIC X.
  6706                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6707             20  FILLER                    PIC X(4).
  6708         16  AM-ZIP-PLUS4                  PIC X(4).
  6709     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 128
* EL156.cbl
  6710         16  AM-CAN-POSTAL-1               PIC XXX.
  6711         16  AM-CAN-POSTAL-2               PIC XXX.
  6712         16  FILLER                        PIC XXX.
  6713     12  AM-TEL-NO.
  6714         16  AM-AREA-CODE                  PIC 999.
  6715         16  AM-TEL-PRE                    PIC 999.
  6716         16  AM-TEL-NBR                    PIC 9(4).
  6717     12  AM-TEL-LOC                        PIC X.
  6718         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6719         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6720
  6721     12  AM-COMM-STRUCTURE.
  6722         16  AM-DEFN-1.
  6723             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6724                 24  AM-AGT.
  6725                     28  AM-AGT-PREFIX     PIC X(4).
  6726                     28  AM-AGT-PRIME      PIC X(6).
  6727                 24  AM-COM-TYP            PIC X.
  6728                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6729                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6730                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6731                 24  AM-RECALC-LV-INDIC    PIC X.
  6732                 24  AM-RETRO-LV-INDIC     PIC X.
  6733                 24  AM-GL-CODES           PIC X.
  6734                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6735                 24  FILLER                PIC X(01).
  6736         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6737             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6738                 24  FILLER                PIC X(11).
  6739                 24  AM-L-COMA             PIC XXX.
  6740                 24  AM-J-COMA             PIC XXX.
  6741                 24  AM-A-COMA             PIC XXX.
  6742                 24  FILLER                PIC X(6).
  6743
  6744     12  AM-COMM-CHANGE-STATUS             PIC X.
  6745         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6746
  6747     12  AM-CSR-CODE                       PIC X(4).
  6748
  6749     12  AM-BILLING-STATUS                 PIC X.
  6750         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6751         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6752     12  AM-AUTO-REFUND-SW                 PIC X.
  6753         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6754         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6755     12  AM-GPCD                           PIC 99.
  6756     12  AM-IG                             PIC X.
  6757         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6758         88  AM-HAS-GROUP                     VALUE '2'.
  6759     12  AM-STATUS                         PIC X.
  6760         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6761         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6762         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6763         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6764         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6765         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6766         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6767         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 129
* EL156.cbl
  6768         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6769         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6770     12  AM-REMIT-TO                       PIC 99.
  6771     12  AM-ID-NO                          PIC X(11).
  6772
  6773     12  AM-CAL-TABLE                      PIC XX.
  6774     12  AM-LF-DEVIATION                   PIC XXX.
  6775     12  AM-AH-DEVIATION                   PIC XXX.
  6776     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6777     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6778     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6779     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6780     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6781     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6782
  6783     12  AM-USER-FIELDS.
  6784         16  AM-FLD-1                      PIC XX.
  6785         16  AM-FLD-2                      PIC XX.
  6786         16  AM-FLD-3                      PIC XX.
  6787         16  AM-FLD-4                      PIC XX.
  6788         16  AM-FLD-5                      PIC XX.
  6789
  6790     12  AM-1ST-PROD-DATE.
  6791         16  AM-1ST-PROD-YR                PIC XX.
  6792         16  AM-1ST-PROD-MO                PIC XX.
  6793         16  AM-1ST-PROD-DA                PIC XX.
  6794     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6795     12  AM-CERTS-PURGED-DATE.
  6796         16  AM-PUR-YR                     PIC XX.
  6797         16  AM-PUR-MO                     PIC XX.
  6798         16  AM-PUR-DA                     PIC XX.
  6799     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6800     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6801     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6802     12  AM-INACTIVE-DATE.
  6803         16  AM-INA-MO                     PIC 99.
  6804         16  AM-INA-DA                     PIC 99.
  6805         16  AM-INA-YR                     PIC 99.
  6806     12  AM-AR-HI-CERT-DATE                PIC XX.
  6807
  6808     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6809     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6810
  6811     12  AM-OB-PAYMENT-MODE                PIC X.
  6812         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6813         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6814         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6815         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6816
  6817     12  AM-AH-ONLY-INDICATOR              PIC X.
  6818         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6819         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6820
  6821     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6822
  6823     12  AM-OVER-SHORT.
  6824         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6825         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 130
* EL156.cbl
  6826
  6827     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6828     12  AM-DCC-CLP-STATE                  PIC XX.
  6829
  6830     12  AM-RECALC-COMM                    PIC X.
  6831     12  AM-RECALC-REIN                    PIC X.
  6832
  6833     12  AM-REI-TABLE                      PIC XXX.
  6834     12  AM-REI-ET-LF                      PIC X.
  6835     12  AM-REI-ET-AH                      PIC X.
  6836     12  AM-REI-PE-LF                      PIC X.
  6837     12  AM-REI-PE-AH                      PIC X.
  6838     12  AM-REI-PRT-ST                     PIC X.
  6839     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6840     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6841     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6842     12  AM-REI-GROUP-A                    PIC X(6).
  6843     12  AM-REI-MORT                       PIC X(4).
  6844     12  AM-REI-PRT-OW                     PIC X.
  6845     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6846     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6847     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6848     12  AM-REI-GROUP-B                    PIC X(6).
  6849
  6850     12  AM-TRUST-TYPE                     PIC X(2).
  6851
  6852     12  AM-EMPLOYER-STMT-USED             PIC X.
  6853     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6854
  6855     12  AM-STD-AH-TYPE                    PIC XX.
  6856     12  AM-EARN-METHODS.
  6857         16  AM-EARN-METHOD-R              PIC X.
  6858             88 AM-REF-RL-R78                 VALUE 'R'.
  6859             88 AM-REF-RL-PR                  VALUE 'P'.
  6860             88 AM-REF-RL-MEAN                VALUE 'M'.
  6861             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6862         16  AM-EARN-METHOD-L              PIC X.
  6863             88 AM-REF-LL-R78                 VALUE 'R'.
  6864             88 AM-REF-LL-PR                  VALUE 'P'.
  6865             88 AM-REF-LL-MEAN                VALUE 'M'.
  6866             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6867         16  AM-EARN-METHOD-A              PIC X.
  6868             88 AM-REF-AH-R78                 VALUE 'R'.
  6869             88 AM-REF-AH-PR                  VALUE 'P'.
  6870             88 AM-REF-AH-MEAN                VALUE 'M'.
  6871             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6872             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6873             88 AM-REF-AH-NET                 VALUE 'N'.
  6874
  6875     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6876     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6877     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6878
  6879     12  AM-RET-Y-N                        PIC X.
  6880     12  AM-RET-P-E                        PIC X.
  6881     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6882     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6883     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 131
* EL156.cbl
  6884     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6885         16  AM-POOL-PRIME                 PIC XXX.
  6886         16  AM-POOL-SUB                   PIC XXX.
  6887     12  AM-RETRO-EARNINGS.
  6888         16  AM-RET-EARN-R                 PIC X.
  6889         16  AM-RET-EARN-L                 PIC X.
  6890         16  AM-RET-EARN-A                 PIC X.
  6891     12  AM-RET-ST-TAX-USE                 PIC X.
  6892         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6893         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6894     12  AM-RETRO-BEG-EARNINGS.
  6895         16  AM-RET-BEG-EARN-R             PIC X.
  6896         16  AM-RET-BEG-EARN-L             PIC X.
  6897         16  AM-RET-BEG-EARN-A             PIC X.
  6898     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6899     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6900
  6901     12  AM-USER-SELECT-OPTIONS.
  6902         16  AM-USER-SELECT-1              PIC X(10).
  6903         16  AM-USER-SELECT-2              PIC X(10).
  6904         16  AM-USER-SELECT-3              PIC X(10).
  6905         16  AM-USER-SELECT-4              PIC X(10).
  6906         16  AM-USER-SELECT-5              PIC X(10).
  6907
  6908     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6909
  6910     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6911
  6912     12  AM-RPT045A-SWITCH                 PIC X.
  6913         88  RPT045A-OFF                   VALUE 'N'.
  6914
  6915     12  AM-INSURANCE-LIMITS.
  6916         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6917         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6918
  6919     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6920         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6921
  6922     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6923         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6924         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6925
  6926     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6927
  6928     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6929     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6930     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6931     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6932     12  AM-DCC-UEF-STATE                  PIC XX.
  6933     12  FILLER                            PIC XXX.
  6934     12  AM-REPORT-CODE-3                  PIC X(10).
  6935*    12  FILLER                            PIC X(22).
  6936
  6937     12  AM-RESERVE-DATE.
  6938         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6939         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6940         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6941
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 132
* EL156.cbl
  6942     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6943     12  AM-NOTIFICATION-TYPES.
  6944         16  AM-NOTIF-OF-LETTERS           PIC X.
  6945         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6946         16  AM-NOTIF-OF-REPORTS           PIC X.
  6947         16  AM-NOTIF-OF-STATUS            PIC X.
  6948
  6949     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6950         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6951         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6952         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6953         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6954
  6955     12  AM-BENEFIT-CONTROLS.
  6956         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6957             20  AM-BENEFIT-CODE           PIC XX.
  6958             20  AM-BENEFIT-TYPE           PIC X.
  6959             20  AM-BENEFIT-REVISION       PIC XXX.
  6960             20  AM-BENEFIT-REM-TERM       PIC X.
  6961             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6962             20  FILLER                    PIC XX.
  6963         16  FILLER                        PIC X(80).
  6964
  6965     12  AM-TRANSFER-DATA.
  6966         16  AM-TRANSFERRED-FROM.
  6967             20  AM-TRNFROM-CARRIER        PIC X.
  6968             20  AM-TRNFROM-GROUPING.
  6969                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6970                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6971             20  AM-TRNFROM-STATE          PIC XX.
  6972             20  AM-TRNFROM-ACCOUNT.
  6973                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6974                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6975             20  AM-TRNFROM-DTE            PIC XX.
  6976         16  AM-TRANSFERRED-TO.
  6977             20  AM-TRNTO-CARRIER          PIC X.
  6978             20  AM-TRNTO-GROUPING.
  6979                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6980                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6981             20  AM-TRNTO-STATE            PIC XX.
  6982             20  AM-TRNTO-ACCOUNT.
  6983                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6984                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6985             20  AM-TRNTO-DTE              PIC XX.
  6986         16  FILLER                        PIC X(10).
  6987
  6988     12  AM-SAVED-REMIT-TO                 PIC 99.
  6989
  6990     12  AM-COMM-STRUCTURE-SAVED.
  6991         16  AM-DEFN-1-SAVED.
  6992             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6993                 24  AM-AGT-SV             PIC X(10).
  6994                 24  AM-COM-TYP-SV         PIC X.
  6995                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6996                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6997                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6998                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6999                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 133
* EL156.cbl
  7000                 24  AM-GL-CODES-SV        PIC X.
  7001                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7002                 24  FILLER                PIC X.
  7003         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7004             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7005                 24  FILLER                PIC X(11).
  7006                 24  AM-L-COMA-SV          PIC XXX.
  7007                 24  AM-J-COMA-SV          PIC XXX.
  7008                 24  AM-A-COMA-SV          PIC XXX.
  7009                 24  FILLER                PIC X(6).
  7010
  7011     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7012         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7013            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7014            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7015            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7016
  7017     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7018     12  FILLER                            PIC X(120).
  7019
  7020     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7021         16  AM-CONTROL-NAME               PIC X(30).
  7022         16  AM-EXECUTIVE-ONE.
  7023             20  AM-EXEC1-NAME             PIC X(15).
  7024             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7025                                                          COMP-3.
  7026             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7027                                                          COMP-3.
  7028         16  AM-EXECUTIVE-TWO.
  7029             20  AM-EXEC2-NAME             PIC X(15).
  7030             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7031                                                          COMP-3.
  7032             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7033                                                          COMP-3.
  7034
  7035     12  AM-RETRO-ADDITIONAL-DATA.
  7036         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7037         16  AM-RETRO-PREM-P-E             PIC X.
  7038         16  AM-RETRO-CLMS-P-I             PIC X.
  7039         16  AM-RETRO-RET-BRACKET-LF.
  7040             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7041                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7042                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7043             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7044                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7045                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7046             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7047                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7048                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7049         16  AM-RETRO-RET-BRACKET-AH.
  7050             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7051                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7052                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7053                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7054             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7055                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7056                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7057             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 134
* EL156.cbl
  7058                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7059                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7060
  7061     12  AM-COMMENTS.
  7062         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7063
  7064     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7065         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7066         16  AM-FLI-BILLING-CODE           PIC X.
  7067         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7068         16  AM-FLI-UNITED-IDENT           PIC X.
  7069         16  AM-FLI-INTEREST-LOST-DATA.
  7070             20  AM-FLI-BANK-NO            PIC X(5).
  7071             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7072             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7073             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7074         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7075             20  AM-FLI-AGT                PIC X(9).
  7076             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7077             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7078         16  FILLER                        PIC X(102).
  7079
  7080     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7081         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7082             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7083             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7084             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7085             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7086             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7087         16  FILLER                          PIC X(10).
  7088******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 135
* EL156.cbl
  7090*    COPY ELCCHKQ.
  7091******************************************************************
  7092*                                                                *
  7093*                                                                *
  7094*                            ELCCHKQ.                            *
  7095*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7096*                            VMOD=2.007                          *
  7097*                                                                *
  7098*   FILE DESCRIPTION = CHECK QUE FILE                            *
  7099*                                                                *
  7100*   FILE TYPE = VSAM,KSDS                                        *
  7101*   RECORD SIZE = 100  RECFORM = FIXED                           *
  7102*                                                                *
  7103*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  7104*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  7105*                                                                *
  7106*   LOG = YES                                                    *
  7107*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7108******************************************************************
  7109 01  CHECK-QUE.
  7110     12  CQ-RECORD-ID                PIC XX.
  7111         88  VALID-CQ-ID         VALUE 'CQ'.
  7112
  7113     12  CQ-CONTROL-PRIMARY.
  7114         16  CQ-COMPANY-CD           PIC X.
  7115         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7116         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7117
  7118     12  CQ-CONTROL-BY-PAYEE.
  7119         16  CQ-CONTROL-BY-NUMBER.
  7120             20  CQ-COMPANY-CD-A1     PIC X.
  7121             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7122         16  CQ-PAYEE-CARRIER        PIC X.
  7123         16  CQ-PAYEE-GROUPING       PIC X(6).
  7124         16  CQ-PAYEE-STATE          PIC XX.
  7125         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7126         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7127
  7128     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7129         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7130         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7131         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7132         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7133         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7134         16  FILLER                  PIC X(3).
  7135
  7136     12  CQ-ENTRY-TYPE               PIC X.
  7137             88  CHECK-ON-QUE           VALUE 'Q'.
  7138             88  ALIGNMENT-CHECK        VALUE 'A'.
  7139             88  SPOILED-CHECK          VALUE 'S'.
  7140             88  PAYMENT-ABORTED        VALUE 'X'.
  7141
  7142     12  CQ-CLAIM-MAST-CNTL.
  7143         16  CQ-CARRIER              PIC X.
  7144         16  CQ-CLAIM-NO             PIC X(7).
  7145         16  CQ-CERT-NO.
  7146             20  CQ-CERT-PRIME       PIC X(10).
  7147             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 136
* EL156.cbl
  7148         16  CQ-CLAIM-TYPE           PIC X.
  7149             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7150             88  CQ-AH-CLAIM            VALUE 'A'.
  7151         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7152             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7153             88  CQ-O-B-COVERAGE        VALUE '2'.
  7154             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7155
  7156     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7157     12  CQ-CHECK-NUMBER             PIC X(7).
  7158     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7159     12  CQ-PAYMENT-TYPE             PIC X.
  7160             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7161             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7162             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7163             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7164             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7165             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7166             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7167             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7168     12  CQ-VOID-INDICATOR           PIC X.
  7169             88  CHECK-IS-STOPPED          VALUE 'S'.
  7170             88  CHECK-IS-VOID             VALUE 'V'.
  7171     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7172     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7173     12  CQ-CHECK-BY-USER            PIC X(4).
  7174     12  CQ-PRE-NUMBERING-SW         PIC X.
  7175       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7176       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7177
  7178     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7179     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7180     12  CQ-LEDGER-FLAG              PIC X(01).
  7181     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7182     12  CQ-LAST-UPDATED-DT          PIC XX.
  7183     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7184     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7185
  7186     12  FILLER                      PIC X(04).
  7187
  7188******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 137
* EL156.cbl
  7190*    COPY ELCBENE.
  7191******************************************************************
  7192*                                                                *
  7193*                            ELCBENE.                            *
  7194*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7195*                            VMOD=2.006                          *
  7196*                                                                *
  7197*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7198*                                                                *
  7199*   FILE TYPE = VSAM,KSDS                                        *
  7200*   RECORD SIZE = 500   RECFORM = FIX                            *
  7201*                                                                *
  7202*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7203*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7204*                                                                *
  7205*   LOG = YES                                                    *
  7206*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7207*                                                                *
  7208*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7209******************************************************************
  7210*                   C H A N G E   L O G
  7211*
  7212* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7213*-----------------------------------------------------------------
  7214*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7215* EFFECTIVE    NUMBER
  7216*-----------------------------------------------------------------
  7217* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7218* 082317  CR2017082100003  PEMA  Add sub type
  7219******************************************************************
  7220
  7221 01  BENEFICIARY-MASTER.
  7222     12  BE-RECORD-ID                PIC XX.
  7223         88  VALID-BE-ID                VALUE 'BE'.
  7224
  7225     12  BE-CONTROL-PRIMARY.
  7226         16  BE-COMPANY-CD           PIC X.
  7227         16  BE-RECORD-TYPE          PIC X.
  7228             88  BENEFICIARY-RECORD  VALUE 'B'.
  7229             88  ADJUSTOR-RECORD     VALUE 'A'.
  7230         16  BE-BENEFICIARY          PIC X(10).
  7231     12  BE-CONTROL-BY-NAME.
  7232         16  BE-COMPANY-CD-A1        PIC X.
  7233         16  BE-RECORD-TYPE-A1       PIC X.
  7234         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7235         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7236
  7237     12  BE-LAST-MAINT-DT            PIC XX.
  7238     12  BE-LAST-MAINT-BY            PIC X(4).
  7239     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7240
  7241     12  BE-ADDRESS-DATA.
  7242         16  BE-MAIL-TO-NAME         PIC X(30).
  7243         16  BE-ADDRESS-LINE-1       PIC X(30).
  7244         16  BE-ADDRESS-LINE-2       PIC X(30).
  7245         16  BE-ADDRESS-LINE-3       PIC X(30).
  7246         16  BE-CITY-STATE.
  7247             20  BE-CITY             PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 138
* EL156.cbl
  7248             20  BE-STATE            PIC XX.
  7249         16  BE-ZIP-CODE.
  7250             20  BE-ZIP-PRIME.
  7251                 24  BE-ZIP-1ST      PIC X.
  7252                     88  BE-CANADIAN-POST-CODE
  7253                                         VALUE 'A' THRU 'Z'.
  7254                 24  FILLER          PIC X(4).
  7255             20  BE-ZIP-PLUS4        PIC X(4).
  7256         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7257             20  BE-CAN-POSTAL-1     PIC XXX.
  7258             20  BE-CAN-POSTAL-2     PIC XXX.
  7259             20  FILLER              PIC XXX.
  7260         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7261         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7262
  7263******************************************************************
  7264*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7265*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7266******************************************************************
  7267     12  BE-CARRIER                  PIC X.
  7268
  7269     12  BE-ADDRESS-DATA2.
  7270         16  BE-MAIL-TO-NAME2        PIC X(30).
  7271         16  BE-ADDRESS-LINE-12      PIC X(30).
  7272         16  BE-ADDRESS-LINE-22      PIC X(30).
  7273         16  BE-ADDRESS-LINE-32      PIC X(30).
  7274         16  BE-CITY-STATE2.
  7275             20  BE-CITY2            PIC X(28).
  7276             20  BE-STATE2           PIC XX.
  7277         16  BE-ZIP-CODE2.
  7278             20  BE-ZIP-PRIME2.
  7279                 24  BE-ZIP-1ST2     PIC X.
  7280                     88  BE-CANADIAN-POST-CODE2
  7281                                         VALUE 'A' THRU 'Z'.
  7282                 24  FILLER          PIC X(4).
  7283             20  BE-ZIP-PLUS42       PIC X(4).
  7284         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7285             20  BE-CAN-POSTAL-12    PIC XXX.
  7286             20  BE-CAN-POSTAL-22    PIC XXX.
  7287             20  FILLER              PIC XXX.
  7288         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7289         16  BE-ACH-DATA.
  7290             20  BE-ACH-YES-OR-NO    PIC X.
  7291                 88  BE-ON-ACH       VALUE 'Y'.
  7292                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7293             20  BE-ACH-ABA-ROUTING-NUMBER
  7294                                     PIC X(15).
  7295             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7296                                     PIC X(20).
  7297             20  BE-ACH-SUB-TYPE     PIC XX.
  7298             20  FILLER              PIC X(23).
  7299         16  BE-BILLING-STMT-DATA.
  7300*            20  BE-BSR              PIC X.
  7301*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7302*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7303*            20  BE-BSR-FROM         PIC X(30).
  7304*            20  BE-BSR-DEPT         PIC X(30).
  7305             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 139
* EL156.cbl
  7306             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7307             20  BE-OUTPUT-TYPE      PIC X.
  7308                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7309                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7310
  7311     12  FILLER                      PIC X(28).
  7312******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 140
* EL156.cbl
  7314*    COPY ELCARCH.
  7315******************************************************************
  7316*                                                                *
  7317*                            ELCARCH.                            *
  7318*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7319*                            VMOD=2.007                          *
  7320*                                                                *
  7321*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7322*                                                                *
  7323*   FILE TYPE = VSAM,KSDS                                        *
  7324*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7325*                                                                *
  7326*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7327*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7328*                                                                *
  7329*   LOG = NO                                                     *
  7330*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7331*                                                                *
  7332*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7333******************************************************************
  7334 01  LETTER-ARCHIVE.
  7335     12  LA-RECORD-ID                PIC XX.
  7336         88  VALID-LA-ID                VALUE 'LA'.
  7337
  7338     12  LA-CONTROL-PRIMARY.
  7339         16  LA-COMPANY-CD           PIC X.
  7340         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7341         16  LA-RECORD-TYPE          PIC X.
  7342             88  LA-HEADER-DATA         VALUE '1'.
  7343             88  LA-ADDRESS-DATA        VALUE '2'.
  7344             88  LA-TEXT-DATA           VALUE '3'.
  7345             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7346         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7347
  7348     12  LA-CONTROL-BY-TYPE.
  7349         16  LA-COMPANY-CD-A1        PIC X.
  7350         16  LA-RECORD-TYPE-A1       PIC X.
  7351         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7352         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7353
  7354     12  LA-TEXT-RECORD.
  7355         16  LA-SKIP-CONTROL         PIC XX.
  7356             88  NO-LINES-SKIPPED       VALUE SPACES.
  7357             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7358         16  LA-TEXT-LINE            PIC X(70).
  7359
  7360     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7361         16  FILLER                  PIC XX.
  7362         16  LA-ADDRESS-LINE         PIC X(30).
  7363         16  FILLER                  PIC X(40).
  7364
  7365     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7366         16  FILLER                  PIC XX.
  7367         16  LA-CARRIER              PIC X.
  7368         16  LA-CLAIM-NO             PIC X(7).
  7369         16  LA-CERT-NO.
  7370             20  LA-CERT-PRIME       PIC X(10).
  7371             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 141
* EL156.cbl
  7372         16  LA-NO-OF-COPIES         PIC S9.
  7373         16  LA-RESEND-DATE          PIC XX.
  7374         16  LA-PROCESSOR-CD         PIC X(4).
  7375         16  LA-CREATION-DT          PIC XX.
  7376         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7377         16  LA-RESEND-PRINT-DATE    PIC XX.
  7378         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7379         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7380*
  7381* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7382*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7383*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7384*   I        20  LA-DMD-RES-ST           PIC XX.
  7385*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7386*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7387*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7388*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7389*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7390*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7391*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7392*   I        20  LA-DMD-UND-CODE         PIC XX.
  7393*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7394*   V    16  FILLER                  PIC X(15).
  7395* -----
  7396*
  7397* REINSERTED  CSO  MODS
  7398*
  7399         16  FILLER.
  7400             20  FILLER                  PIC X(29).
  7401             20  LA-CSO-LETTER-STATUS    PIC X.
  7402                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7403                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7404                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7405             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7406             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7407*
  7408
  7409     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7410         16  FILLER                  PIC XX.
  7411         16  LA4-CARRIER             PIC X.
  7412         16  LA4-CLAIM-NO            PIC X(7).
  7413         16  LA4-CERT-NO.
  7414             20  LA4-CERT-PRIME      PIC X(10).
  7415             20  LA4-CERT-SFX        PIC X.
  7416         16  LA4-NO-OF-COPIES        PIC S9.
  7417         16  LA4-RESEND-DATE         PIC XX.
  7418         16  LA4-PROCESSOR-CD        PIC X(4).
  7419         16  LA4-CREATION-DT         PIC XX.
  7420         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7421         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7422         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7423         16  LA4-FORM-TYPE           PIC X.
  7424             88  LA4-INITIAL-FORM    VALUE '1'.
  7425             88  LA4-PROGRESS-FORM   VALUE '2'.
  7426         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7427         16  LA4-STATE               PIC X(02).
  7428         16  FILLER                  PIC X(31).
  7429******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 142
* EL156.cbl
  7431*    COPY ELCDAR.
  7432******************************************************************
  7433*                                                                *
  7434*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7435*   FILE TYPE = VSAM,KSDS                                        *
  7436*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7437*   BASE CLUSTER = DLYACTV                                       *
  7438*   LOG = YES                                                    *
  7439*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7440*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7441*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7442*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7443*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7444*               BY PROGRAM "LGINFCE".                            *
  7445*                                                                *
  7446******************************************************************
  7447 01  DAILY-ACTIVITY-RECORD.
  7448     05  DA-KEY.
  7449         10  DA-COMP-CD          PIC X.
  7450         10  DA-CARRIER          PIC X.
  7451         10  DA-CLAIM-NO         PIC X(7).
  7452         10  DA-CERT-NO.
  7453             15  DA-CERT-PRIME   PIC X(10).
  7454             15  DA-CERT-SFX     PIC X.
  7455     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7456     05  DA-RECORD-TYPE          PIC X.
  7457     05  FILLER                  PIC X(2).
  7458******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 143
* EL156.cbl
  7460*    COPY ERCCOMP.
  7461******************************************************************
  7462*                                                                *
  7463*                                                                *
  7464*                            ERCCOMP                             *
  7465*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7466*                            VMOD=2.019                          *
  7467*                                                                *
  7468*   ONLINE CREDIT SYSTEM                                         *
  7469*                                                                *
  7470*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7471*                                                                *
  7472*   FILE TYPE = VSAM,KSDS                                        *
  7473*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7474*                                                                *
  7475*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7476*       ALTERNATE PATH = NONE                                    *
  7477*                                                                *
  7478*   LOG = NO                                                     *
  7479*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7480*                                                                *
  7481******************************************************************
  7482*                   C H A N G E   L O G
  7483*
  7484* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7485*-----------------------------------------------------------------
  7486*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7487* EFFECTIVE    NUMBER
  7488*-----------------------------------------------------------------
  7489* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7490* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7491* 092205    2005050300006  PEMA  ADD LEASE FEE
  7492* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7493* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7494* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7495* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7496* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7497* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7498******************************************************************
  7499
  7500 01  COMPENSATION-MASTER.
  7501     12  CO-RECORD-ID                          PIC XX.
  7502         88  VALID-CO-ID                          VALUE 'CO'.
  7503
  7504     12  CO-CONTROL-PRIMARY.
  7505         16  CO-COMPANY-CD                     PIC X.
  7506         16  CO-CONTROL.
  7507             20  CO-CTL-1.
  7508                 24  CO-CARR-GROUP.
  7509                     28  CO-CARRIER            PIC X.
  7510                     28  CO-GROUPING.
  7511                         32  CO-GROUP-PREFIX   PIC XXX.
  7512                         32  CO-GROUP-PRIME    PIC XXX.
  7513                 24  CO-RESP-NO.
  7514                     28  CO-RESP-PREFIX        PIC X(4).
  7515                     28  CO-RESP-PRIME         PIC X(6).
  7516             20  CO-CTL-2.
  7517                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 144
* EL156.cbl
  7518                     28  CO-ACCT-PREFIX        PIC X(4).
  7519                     28  CO-ACCT-PRIME         PIC X(6).
  7520         16  CO-TYPE                           PIC X.
  7521             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7522             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7523             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7524
  7525     12  CO-MAINT-INFORMATION.
  7526         16  CO-LAST-MAINT-DT                  PIC XX.
  7527         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7528         16  CO-LAST-MAINT-USER                PIC X(4).
  7529     12  FILLER                                PIC XX.
  7530     12  CO-STMT-TYPE                          PIC XXX.
  7531     12  CO-COMP-TYPE                          PIC X.
  7532         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7533     12  CO-STMT-OWNER                         PIC X(4).
  7534     12  CO-BALANCE-CONTROL                    PIC X.
  7535         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7536         88  CO-NO-BALANCE                        VALUE 'N'.
  7537
  7538     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7539         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7540         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7541         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7542
  7543     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7544         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7545         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7546
  7547     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7548     12  CO-GA-DIRECT-DEP                      PIC X.
  7549     12  CO-FUTURE-SPACE                       PIC X.
  7550         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7551
  7552     12  CO-ACCT-NAME                          PIC X(30).
  7553     12  CO-MAIL-NAME                          PIC X(30).
  7554     12  CO-ADDR-1                             PIC X(30).
  7555     12  CO-ADDR-2                             PIC X(30).
  7556     12  CO-ADDR-3.
  7557         16  CO-ADDR-CITY                      PIC X(27).
  7558         16  CO-ADDR-STATE                     PIC XX.
  7559     12  CO-CSO-1099                           PIC X.
  7560     12  CO-ZIP.
  7561         16  CO-ZIP-PRIME.
  7562             20  CO-ZIP-PRI-1ST                PIC X.
  7563                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7564             20  FILLER                        PIC X(4).
  7565         16  CO-ZIP-PLUS4                      PIC X(4).
  7566     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7567         16  CO-CAN-POSTAL-1                   PIC XXX.
  7568         16  CO-CAN-POSTAL-2                   PIC XXX.
  7569         16  FILLER                            PIC XXX.
  7570     12  CO-SOC-SEC                            PIC X(13).
  7571     12  CO-TELEPHONE.
  7572         16  CO-AREA-CODE                      PIC XXX.
  7573         16  CO-PREFIX                         PIC XXX.
  7574         16  CO-PHONE                          PIC X(4).
  7575
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 145
* EL156.cbl
  7576     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7577
  7578     12  CO-AR-BAL-LEVEL                       PIC X.
  7579         88  CO-AR-REF-LVL                        VALUE '1'.
  7580         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7581         88  CO-AR-BILL-LVL                       VALUE '2'.
  7582         88  CO-AR-AGT-LVL                        VALUE '3'.
  7583         88  CO-AR-FR-LVL                         VALUE '4'.
  7584
  7585     12  CO-AR-NORMAL-PRINT                    PIC X.
  7586         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7587         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7588
  7589     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7590
  7591     12  CO-AR-REPORTING                       PIC X.
  7592         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7593         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7594
  7595     12  CO-AR-PULL-CHECK                      PIC X.
  7596         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7597         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7598
  7599     12  CO-AR-BALANCE-PRINT                   PIC X.
  7600         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7601
  7602     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7603         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7604         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7605         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7606
  7607     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7608
  7609     12  CO-USER-CODE                          PIC X.
  7610     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7611
  7612******************************************************************
  7613*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7614*    THE LAST MONTH END RUN.
  7615******************************************************************
  7616
  7617     12  CO-LAST-ACTIVITY-DATE.
  7618         16  CO-ACT-YEAR                       PIC 99.
  7619         16  CO-ACT-MONTH                      PIC 99.
  7620         16  CO-ACT-DAY                        PIC 99.
  7621
  7622     12  CO-LAST-STMT-DT.
  7623         16  CO-LAST-STMT-YEAR                 PIC 99.
  7624         16  CO-LAST-STMT-MONTH                PIC 99.
  7625         16  CO-LAST-STMT-DAY                  PIC 99.
  7626
  7627     12  CO-MO-END-TOTALS.
  7628         16  CO-MONTHLY-TOTALS.
  7629             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7630             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7631             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7632             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7633             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 146
* EL156.cbl
  7634
  7635         16  CO-AGING-TOTALS.
  7636             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7637             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7638             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7639             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7640
  7641         16  CO-YTD-TOTALS.
  7642             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7643             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7644
  7645         16  CO-OVER-UNDER-TOTALS.
  7646             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7647             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7648
  7649     12  CO-MISCELLANEOUS-TOTALS.
  7650         16  CO-FICA-TOTALS.
  7651             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7652             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7653
  7654         16  CO-CLAIM-TOTALS.
  7655             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7656             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7657
  7658******************************************************************
  7659*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7660*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7661******************************************************************
  7662
  7663     12  CO-CURRENT-TOTALS.
  7664         16  CO-CURRENT-LAST-STMT-DT.
  7665             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7666             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7667             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7668
  7669         16  CO-CURRENT-MONTHLY-TOTALS.
  7670             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7671             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7672             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7673             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7674             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7675
  7676         16  CO-CURRENT-AGING-TOTALS.
  7677             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7678             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7679             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7680             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7681
  7682         16  CO-CURRENT-YTD-TOTALS.
  7683             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7684             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7685
  7686     12  CO-PAID-COMM-TOTALS.
  7687         16  CO-YTD-PAID-COMMS.
  7688             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7689             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7690
  7691     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 147
* EL156.cbl
  7692         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7693         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7694
  7695     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7696         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7697         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7698         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7699         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7700         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7701         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7702         88  CO-FINAL-LETTER                  VALUE 'F'.
  7703         88  CO-RECONCILING                   VALUE 'R'.
  7704         88  CO-PHONE-CALL                    VALUE 'P'.
  7705         88  CO-LEGAL                         VALUE 'L'.
  7706         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7707         88  CO-WRITE-OFF                     VALUE 'W'.
  7708         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7709
  7710     12  CO-CSR-CODE                       PIC X(4).
  7711
  7712     12  CO-GA-STATUS-INFO.
  7713         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7714         16  CO-GA-TERMINATION-DT          PIC XX.
  7715         16  CO-GA-STATUS-CODE             PIC X.
  7716             88  CO-GA-ACTIVE                 VALUE 'A'.
  7717             88  CO-GA-INACTIVE               VALUE 'I'.
  7718             88  CO-GA-PENDING                VALUE 'P'.
  7719         16  CO-GA-COMMENTS.
  7720             20  CO-GA-COMMENT-1           PIC X(40).
  7721             20  CO-GA-COMMENT-2           PIC X(40).
  7722             20  CO-GA-COMMENT-3           PIC X(40).
  7723             20  CO-GA-COMMENT-4           PIC X(40).
  7724
  7725     12  CO-RPTCD2                         PIC X(10).
  7726     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7727         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7728         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7729
  7730     12  CO-TYPE-AGENT                     PIC X(01).
  7731         88  CO-CORPORATION                   VALUE 'C'.
  7732         88  CO-PARTNERSHIP                   VALUE 'P'.
  7733         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7734         88  CO-TRUST                         VALUE 'T'.
  7735         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7736
  7737     12  CO-FAXNO.
  7738         16  CO-FAX-AREA-CODE                  PIC XXX.
  7739         16  CO-FAX-PREFIX                     PIC XXX.
  7740         16  CO-FAX-PHONE                      PIC X(4).
  7741
  7742     12  CO-BANK-INFORMATION.
  7743         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7744         16  CO-BANK-TRANSIT-NON REDEFINES
  7745             CO-BANK-TRANSIT-NO                PIC 9(8).
  7746
  7747         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7748     12  CO-MISC-DEDUCT-INFO REDEFINES
  7749                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 148
* EL156.cbl
  7750         16  CO-MD-GL-ACCT                     PIC X(10).
  7751         16  CO-MD-DIV                         PIC XX.
  7752         16  CO-MD-CENTER                      PIC X(4).
  7753         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7754         16  CO-CREATE-AP-CHECK                PIC X.
  7755         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7756         16  FILLER                            PIC XXX.
  7757     12  CO-ACH-STATUS                         PIC X.
  7758         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7759         88  CO-ACH-PENDING                        VALUE 'P'.
  7760
  7761     12  CO-BILL-SW                            PIC X.
  7762     12  CO-CONTROL-NAME                       PIC X(30).
  7763     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7764     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7765     12  CO-CLP-STATE                          PIC XX.
  7766     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7767     12  CO-SPP-REFUND-EDIT                    PIC X.
  7768
  7769******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 149
* EL156.cbl
  7771*    COPY ERCDMDNT.
  7772******************************************************************
  7773*                                                                *
  7774*                            ERCDMDNT                            *
  7775*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7776*                            VMOD=2.005                          *
  7777*                                                                *
  7778*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7779*                                                                *
  7780*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7781*                                                                *
  7782*        FILE TYPE= VSAM,KSDS                                    *
  7783*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7784*                                                                *
  7785*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7786*                                                                *
  7787*        LOG = YES                                               *
  7788*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7789*                                                                *
  7790******************************************************************
  7791
  7792 01  CERTIFICATE-NOTE.
  7793     12  CN-RECORD-ID                     PIC  XX.
  7794         88  VALID-CN-ID                      VALUE 'CN'.
  7795
  7796     12  CN-CONTROL-PRIMARY.
  7797         16  CN-COMPANY-CD                PIC X.
  7798         16  CN-CERT-KEY.
  7799             20  CN-CARRIER               PIC X.
  7800             20  CN-GROUPING.
  7801                 24  CN-GROUPING-PREFIX   PIC XXX.
  7802                 24  CN-GROUPING-PRIME    PIC XXX.
  7803             20  CN-STATE                 PIC XX.
  7804             20  CN-ACCOUNT.
  7805                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7806                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7807             20  CN-CERT-EFF-DT           PIC XX.
  7808             20  CN-CERT-NO.
  7809                 24  CN-CERT-PRIME        PIC X(10).
  7810                 24  CN-CERT-SFX          PIC X.
  7811
  7812     12  CN-BILLING-START-LINE-NO         PIC 99.
  7813     12  CN-BILLING-END-LINE-NO           PIC 99.
  7814
  7815     12  CN-LINES.
  7816         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7817
  7818     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7819         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7820         16  CN-CSI-GENERAL-DATA-AREA.
  7821             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7822
  7823         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7824             CN-CSI-GENERAL-DATA-AREA.
  7825             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7826             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7827             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7828             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 150
* EL156.cbl
  7829             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7830             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7831             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7832             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7833             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7834             20  FILLER                       PIC XX.
  7835             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7836             20  FILLER                       PIC X(38).
  7837
  7838         16  CN-CSI-PRODUCT-DATA-AREA.
  7839             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7840
  7841         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7842             CN-CSI-PRODUCT-DATA-AREA.
  7843             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7844             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7845             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7846             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7847             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7848             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7849             20  FILLER                   PIC XX.
  7850             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7851             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7852             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7853             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7854             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7855             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7856             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7857             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7858             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7859             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7860             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7861             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7862             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7863             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7864             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7865             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7866             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7867             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7868             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7869             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7870             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7871             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7872             20  FILLER                   PIC X(25).
  7873
  7874         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7875             CN-CSI-CREDIT-CARD-DATA.
  7876             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7877             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7878             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7879             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7880             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7881             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7882             20  FILLER                   PIC XX.
  7883             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7884             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7885             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7886             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 151
* EL156.cbl
  7887             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7888             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7889             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7890             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7891             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7892             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7893             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7894             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7895             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7896             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7897             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7898             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7899             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7900             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7901             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7902             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7903             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7904             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7905             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7906             20  FILLER                   PIC X(17).
  7907
  7908         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7909             CN-CSI-FAMILY-LEAVE-DATA.
  7910             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7911             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7912             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7913             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7914             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7915             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7916             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7917             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7918             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7919             20  CN-CSI-SL-INT-ON-PROCEEDS
  7920                                          PIC S9(5)V99  COMP-3.
  7921             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7922             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7923             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7924             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7925             20  CN-CSI-SL-POLICY-BENEFITS
  7926                                          PIC S9(5)V99  COMP-3.
  7927             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7928             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7929             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7930             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7931             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7932             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7933             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7934             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7935             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7936             20  CN-CSI-SL-STATE-NOT      PIC X.
  7937             20  FILLER                   PIC XX.
  7938
  7939         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7940             CN-CSI-SENIOR-LIFE-DATA.
  7941             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7942             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7943             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7944                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 152
* EL156.cbl
  7945             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7946             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7947             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7948             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7949             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7950             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7951             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7952             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7953             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7954             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7955             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7956             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7957             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7958             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7959             20  CN-CSI-PP-REPAIR         PIC X.
  7960             20  CN-CSI-PP-REPLACE        PIC X.
  7961             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7962             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7963             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7964             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7965             20  FILLER                   PIC X(5).
  7966
  7967         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7968             CN-CSI-PURCH-PROP-DATA.
  7969             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7970             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7971             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7972             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7973             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7974             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7975             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7976             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7977             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7978             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7979             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7980             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7981             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7982             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7983             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7984             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7985             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7986             20  CN-CSI-EW-REPLACE        PIC X.
  7987             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7988             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7989             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7990             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7991             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7992             20  FILLER                   PIC X(4).
  7993
  7994     12  CN-LAST-MAINT-DT                 PIC XX.
  7995     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7996     12  CN-LAST-MAINT-USER               PIC X(4).
  7997     12  FILLER                           PIC X(6).
  7998
  7999******************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 153
* EL156.cbl
  8001*    COPY ERCCNOT.
  8002******************************************************************
  8003*                                                                *
  8004*                            ERCCNOT                             *
  8005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8006*                            VMOD=2.003                          *
  8007*                                                                *
  8008*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  8009*                                                                *
  8010*        FILE TYPE= VSAM,KSDS                                    *
  8011*        RECORD SIZE = 150    RECFORM = FIXED                    *
  8012*                                                                *
  8013*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  8014*                                                                *
  8015*        LOG = YES                                               *
  8016*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  8017*                                                                *
  8018******************************************************************
  8019*                   C H A N G E   L O G
  8020*
  8021* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8022*-----------------------------------------------------------------
  8023*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8024* EFFECTIVE    NUMBER
  8025*-----------------------------------------------------------------
  8026* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  8027******************************************************************
  8028
  8029 01  CERT-NOTE-FILE.
  8030     12  CZ-RECORD-ID                PIC  XX.
  8031         88  VALID-CZ-ID                  VALUE 'CZ'.
  8032
  8033     12  CZ-CONTROL-PRIMARY.
  8034         16  CZ-COMPANY-CD           PIC X.
  8035         16  CZ-CARRIER              PIC X.
  8036         16  CZ-GROUPING.
  8037             20 CZ-GROUPING-PREFIX   PIC XXX.
  8038             20 CZ-GROUPING-PRIME    PIC XXX.
  8039         16  CZ-STATE                PIC XX.
  8040         16  CZ-ACCOUNT.
  8041             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  8042             20 CZ-ACCOUNT-PRIME     PIC X(6).
  8043         16  CZ-CERT-EFF-DT          PIC XX.
  8044         16  CZ-CERT-NO.
  8045             20  CZ-CERT-PRIME       PIC X(10).
  8046             20  CZ-CERT-SFX         PIC X.
  8047         16  CZ-RECORD-TYPE          PIC X.
  8048             88  CERT-NOTE           VALUE '1'.
  8049             88  CLAIM-CERT-NOTE     VALUE '2'.
  8050         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  8051
  8052     12  CZ-LAST-MAINT-DT            PIC XX.
  8053     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8054     12  CZ-LAST-MAINT-USER          PIC X(4).
  8055
  8056     12  CZ-NOTE-INFORMATION.
  8057         16  CZ-NOTE                 PIC X(63).
  8058         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 154
* EL156.cbl
  8059******************************************************************
  8060*                            COPY ERCPDEF.
  8061******************************************************************
  8062*                                                                *
  8063*                                                                *
  8064*                            ERCPDEF.                            *
  8065*                                                                *
  8066*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  8067*                                                                *
  8068*    FILE TYPE = VSAM,KSDS                                       *
  8069*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  8070*                                                                *
  8071*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  8072*                                                                *
  8073*    LOG = YES                                                   *
  8074*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8075******************************************************************
  8076*                   C H A N G E   L O G
  8077*
  8078* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8079*-----------------------------------------------------------------
  8080*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8081* EFFECTIVE    NUMBER
  8082*-----------------------------------------------------------------
  8083* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8084* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8085* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  8086* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8087******************************************************************
  8088 01  PRODUCT-MASTER.
  8089    12  PD-RECORD-ID                 PIC X(02).
  8090        88  VALID-PD-ID                  VALUE 'PD'.
  8091    12  PD-CONTROL-PRIMARY.
  8092        16  PD-COMPANY-CD            PIC X.
  8093        16  PD-STATE                 PIC XX.
  8094        16  PD-PRODUCT-CD            PIC XXX.
  8095        16  PD-FILLER                PIC X(7).
  8096        16  PD-BEN-TYPE              PIC X.
  8097        16  PD-BEN-CODE              PIC XX.
  8098        16  PD-PROD-EXP-DT           PIC XX.
  8099    12  FILLER                       PIC X(50).
  8100    12  PD-PRODUCT-DATA OCCURS 8.
  8101        16  PD-PROD-CODE             PIC X.
  8102            88  PD-PROD-LIFE           VALUE 'L'.
  8103            88  PD-PROD-PROP           VALUE 'P'.
  8104            88  PD-PROD-AH             VALUE 'A'.
  8105            88  PD-PROD-IU             VALUE 'I'.
  8106            88  PD-PROD-GAP            VALUE 'G'.
  8107            88  PD-PROD-FAML           VALUE 'F'.
  8108            88  PD-PROD-OTH            VALUE 'O'.
  8109        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  8110        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  8111        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  8112        16  PD-MAX-TERM              PIC S999        COMP-3.
  8113        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  8114        16  FILLER                   PIC X.
  8115        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  8116        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 155
* EL156.cbl
  8117        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  8118        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  8119        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  8120        16  PD-REC-CRIT-PERIOD       PIC 99.
  8121        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  8122            20  PD-RECURRING-YN      PIC X.
  8123            20  FILLER               PIC X.
  8124        16  PD-RTW-MOS               PIC 99.
  8125        16  PD-MAX-EXTENSION         PIC 99.
  8126        16  pd-ben-pct               pic sv999 comp-3.
  8127*       16  FILLER                   PIC XX.
  8128    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  8129    12  PD-TERM-LIMITS OCCURS 15.
  8130        16  PD-LOW-TERM              PIC S999        COMP-3.
  8131        16  PD-HI-TERM               PIC S999        COMP-3.
  8132*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8133    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8134        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8135        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8136    12  PD-EARN-FACTORS.
  8137        16  FILLER OCCURS 15.
  8138            20  FILLER OCCURS 15.
  8139                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8140    12  PD-PRODUCT-DESC              PIC X(80).
  8141    12  PD-TRUNCATED                 PIC X.
  8142    12  FILLER                       PIC X(59).
  8143    12  PD-MAINT-INFORMATION.
  8144        16  PD-LAST-MAINT-DT         PIC X(02).
  8145        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8146        16  PD-LAST-MAINT-BY         PIC X(04).
  8147*                            COPY ELCCRTT.
  8148******************************************************************
  8149*                                                                *
  8150*                            ELCCRTT.                            *
  8151*                                                                *
  8152*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8153*                                                                *
  8154*   FILE TYPE = VSAM,KSDS                                        *
  8155*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8156*                                                                *
  8157*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8158*                                                                *
  8159*   LOG = YES                                                    *
  8160*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8161******************************************************************
  8162*                   C H A N G E   L O G
  8163*
  8164* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8165*-----------------------------------------------------------------
  8166*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8167* EFFECTIVE    NUMBER
  8168*-----------------------------------------------------------------
  8169* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8170* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8171* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8172* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8173* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8174* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 156
* EL156.cbl
  8175* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8176* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  8177* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8178* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  8179* 091318  CR2018073000001  PEMA  ADD Refund methods
  8180* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  8181******************************************************************
  8182
  8183 01  CERTIFICATE-TRAILERS.
  8184     12  CS-RECORD-ID                      PIC XX.
  8185         88  VALID-CS-ID                      VALUE 'CS'.
  8186
  8187     12  CS-CONTROL-PRIMARY.
  8188         16  CS-COMPANY-CD                 PIC X.
  8189         16  CS-CARRIER                    PIC X.
  8190         16  CS-GROUPING                   PIC X(6).
  8191         16  CS-STATE                      PIC XX.
  8192         16  CS-ACCOUNT                    PIC X(10).
  8193         16  CS-CERT-EFF-DT                PIC XX.
  8194         16  CS-CERT-NO.
  8195             20  CS-CERT-PRIME             PIC X(10).
  8196             20  CS-CERT-SFX               PIC X.
  8197         16  CS-TRAILER-TYPE               PIC X.
  8198             88  COMM-TRLR           VALUE 'A'.
  8199             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8200             88  CERT-DATA-TRLR      VALUE 'C'.
  8201
  8202     12  CS-DATA-AREA                      PIC X(516).
  8203
  8204     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8205         16  CS-BANK-COMMISSION-AREA.
  8206             20  CS-BANK-COMMS       OCCURS 10.
  8207                 24  CS-AGT                PIC X(10).
  8208                 24  CS-COM-TYP            PIC X.
  8209                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8210                 24  CS-RECALC-LV-INDIC    PIC X.
  8211                 24  FILLER                PIC X(10).
  8212         16  FILLER                        PIC X(256).
  8213
  8214     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8215****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8216         16  CS-MB-CLAIM-DATA OCCURS 24.
  8217             20  CS-CLAIM-NO               PIC X(7).
  8218             20  CS-CLAIM-TYPE             PIC X.
  8219                 88  CS-AH-CLM               VALUE 'A'.
  8220                 88  CS-IU-CLM               VALUE 'I'.
  8221                 88  CS-GP-CLM               VALUE 'G'.
  8222                 88  CS-LF-CLM               VALUE 'L'.
  8223                 88  CS-PR-CLM               VALUE 'P'.
  8224                 88  CS-FL-CLM               VALUE 'F'.
  8225                 88  CS-OT-CLM               VALUE 'O'.
  8226             20  CS-INSURED-TYPE           PIC X.
  8227                 88  CS-PRIM-INSURED          VALUE 'P'.
  8228                 88  CS-CO-BORROWER           VALUE 'C'.
  8229             20  CS-BENEFIT-PERIOD         PIC 99.
  8230             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8231             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8232             20  CS-REMAINING-BENS         PIC S999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 157
* EL156.cbl
  8233         16  FILLER                        PIC X(12).
  8234     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8235         16  CS-VIN-NUMBER                 PIC X(17).
  8236         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8237         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8238         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8239         16  cs-agent-name.
  8240             20  cs-agent-fname            pic x(20).
  8241             20  cs-agent-mi               pic x.
  8242             20  cs-agent-lname            pic x(25).
  8243         16  cs-license-no                 pic x(15).
  8244         16  cs-npn-number                 pic x(10).
  8245         16  cs-agent-edit-status          pic x.
  8246             88  cs-ae-refer-to-manager      value 'M'.
  8247             88  cs-ae-cover-sheet           value 'C'.
  8248             88  cs-ae-sig-form              value 'S'.
  8249             88  cs-ae-verified              value 'V'.
  8250             88  cs-unidentified-signature   value 'U'.
  8251             88  cs-cert-returned            value 'R'.
  8252             88  cs-accept-no-commission     value 'N'.
  8253         16  cs-year                       pic 9999.
  8254         16  cs-make                       pic x(20).
  8255         16  cs-model                      pic x(20).
  8256         16  cs-future                     pic x(20).
  8257         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8258         16  cs-claim-verification-status  pic x.
  8259             88  cs-clm-ver-eligible         value 'A'.
  8260             88  cs-clm-ver-partial-elig     value 'B'.
  8261             88  cs-clm-ver-not-eligible     value 'C'.
  8262             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8263             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8264             88  cs-clm-ver-ND-CERT          value 'F'.
  8265             88  cs-clm-ver-spec-other       value 'G'.
  8266             88  cs-clam-ver-pratial-corrected
  8267                                             value 'H'.
  8268             88  cs-clm-ver-no-matches       value 'I'.
  8269             88  cs-clm-ver-not-elig-corrected
  8270                                             value 'J'.
  8271             88  cs-clm-ver-needs-review     value 'R'.
  8272             88  cs-clm-ver-sent-to-claims   value 'W'.
  8273         16  CS-LF-REFUND-METHOD           PIC X.
  8274         16  CS-AH-REFUND-METHOD           PIC X.
  8275         16  FILLER                        PIC X(353). *> was 420
  8276*        16  FILLER                        PIC X(496).
  8277 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8278                          CONTROL-FILE CERTIFICATE-MASTER
  8279                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8280                          ACCOUNT-MASTER CHECK-QUE
  8281                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8282                          DAILY-ACTIVITY-RECORD
  8283                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8284                          CERT-NOTE-FILE PRODUCT-MASTER
  8285                          CERTIFICATE-TRAILERS.
  8286 0000-DFHEXIT SECTION.
  8287     MOVE '9#                    $   ' TO DFHEIV0.
  8288     MOVE 'EL156' TO DFHEIV1.
  8289     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8290
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 158
* EL156.cbl
  8291     IF EIBCALEN = 0
  8292         GO TO 8800-UNAUTHORIZED-ACCESS.
  8293
  8294     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8295     MOVE EIBTRMID               TO QID-TERM.
  8296     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8297     MOVE '2'                    TO EMI-SWITCH2.
  8298     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8299     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8300
  8301     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8302     MOVE '5'                    TO DC-OPTION-CODE.
  8303     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8304     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8305                                    SAVE-BIN-DATE.
  8306     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8307     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8308
  8309     IF SAVE-DATE-YY > 70
  8310         MOVE 19                 TO SAVE-DATE-CC
  8311     ELSE
  8312         MOVE 20                 TO SAVE-DATE-CC.
  8313
  8314     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8315         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8316     END-IF.
  8317
  8318     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8319        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8320     ELSE
  8321        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8322     END-IF
  8323
  8324     IF PI-PRINT-CLM-FRM-YN = 'N'
  8325         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8326     ELSE
  8327         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8328     END-IF
  8329
  8330     IF PI-PRINT-SURVEY-YN = 'N'
  8331         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8332     ELSE
  8333         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8334     END-IF
  8335
  8336     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8337         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8338     ELSE
  8339         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8340     END-IF
  8341
  8342* EXEC CICS HANDLE CONDITION
  8343*        NOTOPEN   (9990-ABEND)
  8344*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8345*        MAPFAIL   (0400-FIRST-TIME)
  8346*        DUPREC    (6180-DUPREC)
  8347*        ERROR     (9990-ABEND)
  8348*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 159
* EL156.cbl
  8349*    MOVE '"$JL?%.               ! " #00008337' TO DFHEIV0
  8350     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8351     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8352     MOVE X'2220233030303038333337' TO DFHEIV0(25:11)
  8353     CALL 'kxdfhei1' USING DFHEIV0
  8354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8355
  8356
  8357     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8358         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8359
  8360     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8361         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8362             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8363             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8364             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8365             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8366             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8367             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8368             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8369             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8370             MOVE LOW-VALUES           TO EL156AI
  8371             MOVE 'Y'                  TO FIRST-ENTRY
  8372         ELSE
  8373             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8374             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8375             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8376             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8377             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8378             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8379             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8380             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8381
  8382     IF RETURNED-FROM NOT = SPACES
  8383        IF (RETURNED-FROM = 'EL614')
  8384           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8385           IF WS-SAVED-EOB-CODES NOT = SPACES
  8386              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8387           ELSE
  8388              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8389           END-IF
  8390        END-IF
  8391         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8392            MOVE 'Y'             TO FIRST-ENTRY
  8393            IF RETURNED-FROM = 'EL614'
  8394               AND (PI-PASS-SW NOT = 'C')
  8395               IF WS-SAVED-EOB-CODES NOT = SPACES
  8396                  MOVE WS-SAVED-EOB-CODES
  8397                                 TO PI-PMTNOTE2
  8398                                    WS-PMTNOTE2
  8399                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8400               ELSE
  8401                  MOVE SPACES    TO PI-PMTNOTE2
  8402                                    WS-PMTNOTE2
  8403                                    PI-EOB-CODES-EXIST
  8404               END-IF
  8405            END-IF
  8406            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 160
* EL156.cbl
  8407            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8408            IF RETURNED-FROM = 'EL614'
  8409               GO TO 1000-EDIT-DATA
  8410            END-IF
  8411            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8412               (PAYEEI   = LOW-VALUES OR SPACES)
  8413               GO TO 8100-SEND-INITIAL-MAP
  8414            ELSE
  8415               GO TO 1000-EDIT-DATA.
  8416
  8417     IF EIBTRNID NOT = TRANS-ID
  8418         GO TO 0400-FIRST-TIME.
  8419
  8420     IF EIBAID = DFHCLEAR
  8421        IF PI-PASS-SW = 'C'
  8422           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8423           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8424           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8425           MOVE 'Y'            TO RETURNED-FROM-B
  8426           GO TO 1000-EDIT-DATA
  8427        ELSE
  8428           GO TO 9400-CLEAR.
  8429
  8430     IF PI-PASS-SW = 'C'
  8431         MOVE MAP-NAMEB          TO MAP-NAME
  8432         IF EIBAID = DFHPF1 OR DFHPF13
  8433             GO TO 5000-UPDATE
  8434           ELSE
  8435             IF EIBAID NOT = DFHENTER
  8436                 MOVE LOW-VALUES TO EL156BI
  8437                 MOVE MAP-NAMEB  TO MAP-NAME
  8438                 MOVE ER-0029    TO EMI-ERROR
  8439                 MOVE -1         TO  ENTPFBL
  8440                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8441                 GO TO 8200-SEND-DATAONLY.
  8442
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 161
* EL156.cbl
  8444 0200-RECEIVE.
  8445     MOVE LOW-VALUES             TO EL156AI.
  8446     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8447         MOVE ER-0008            TO EMI-ERROR
  8448         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8449         IF PI-PASS-SW = 'C'
  8450             MOVE -1             TO ENTPFBL
  8451             GO TO 8200-SEND-DATAONLY
  8452         ELSE
  8453             MOVE -1             TO PMTTYPEL
  8454             GO TO 8200-SEND-DATAONLY.
  8455
  8456     IF PI-COMPANY-ID = 'DMD'
  8457         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8458
  8459     IF PI-PASS-SW = 'C'
  8460         MOVE MAP-NAMEB          TO MAP-NAME.
  8461
  8462
  8463* EXEC CICS RECEIVE
  8464*        MAP   (MAP-NAME)
  8465*        MAPSET(MAPSET-NAME)
  8466*        ASIS
  8467*        INTO  (EL156AI)
  8468*    END-EXEC.
  8469     MOVE LENGTH OF
  8470      EL156AI
  8471       TO DFHEIV11
  8472*    MOVE '8"TAI  L              ''   #00008450' TO DFHEIV0
  8473     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8474     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8475     MOVE X'2020233030303038343530' TO DFHEIV0(25:11)
  8476     CALL 'kxdfhei1' USING DFHEIV0,
  8477           MAP-NAME,
  8478           EL156AI,
  8479           DFHEIV11,
  8480           MAPSET-NAME,
  8481           DFHEIV99,
  8482           DFHEIV99
  8483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8484
  8485
  8486     IF PI-PASS-SW NOT = 'C'
  8487         GO TO 0250-MAPA.
  8488
  8489     IF ENTPFBL NOT > ZERO
  8490         MOVE MAP-NAMEB          TO MAP-NAME
  8491         MOVE ER-0029            TO EMI-ERROR
  8492         MOVE -1                 TO  ENTPFBL
  8493         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8494         GO TO 8200-SEND-DATAONLY.
  8495
  8496     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8497         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8498       ELSE
  8499         MOVE MAP-NAMEB           TO MAP-NAME
  8500         MOVE ER-0029             TO EMI-ERROR
  8501         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 162
* EL156.cbl
  8502         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8503         GO TO 8200-SEND-DATAONLY.
  8504
  8505     IF EIBAID = DFHPF1 OR DFHPF13
  8506         IF MODIFY-CAP
  8507            GO TO 5000-UPDATE
  8508          ELSE
  8509            MOVE 'UPDATE'           TO SM-READ
  8510            PERFORM 9995-SECURITY-VIOLATION
  8511            MOVE MAP-NAMEB          TO MAP-NAME
  8512            MOVE ER-0070            TO EMI-ERROR
  8513            MOVE -1                 TO  ENTPFBL
  8514            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8515            GO TO 8200-SEND-DATAONLY.
  8516
  8517 0250-MAPA.
  8518     IF ENTERPFL = 0
  8519         GO TO 0300-CHECK-PFKEYS.
  8520
  8521     IF EIBAID NOT = DFHENTER
  8522         MOVE ER-0004            TO EMI-ERROR
  8523         GO TO 0320-INPUT-ERROR.
  8524
  8525     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8526         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8527     ELSE
  8528         MOVE ER-0029            TO EMI-ERROR
  8529         GO TO 0320-INPUT-ERROR.
  8530
  8531 0300-CHECK-PFKEYS.
  8532     IF EIBAID = DFHPF7 OR DFHPF8
  8533         GO TO 8820-PF7-8.
  8534
  8535     IF EIBAID = DFHPF23
  8536         GO TO 8810-PF23.
  8537
  8538     IF EIBAID = DFHPF24
  8539         GO TO 9200-RETURN-MAIN-MENU.
  8540
  8541     IF EIBAID = DFHPF12
  8542         GO TO 9500-PF12.
  8543
  8544     IF EIBAID = DFHPF1
  8545        IF PI-PASS-SW = 'A' OR 'B'
  8546          GO TO 0330-BROWSE-FORWARD.
  8547
  8548     IF EIBAID = DFHPF2
  8549        IF PI-PASS-SW = 'A' OR 'B'
  8550          GO TO 0350-BROWSE-BACKWARD.
  8551
  8552     IF EIBAID = DFHPF6
  8553        IF PI-EOB-CODES-EXIST = 'Y'
  8554           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8555        ELSE
  8556           MOVE SPACES              TO WS-PMTNOTE2
  8557        END-IF
  8558         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8559         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 163
* EL156.cbl
  8560            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8561         END-IF
  8562         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8563         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  8564             MOVE 'EL614'        TO PGM-NAME
  8565             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8566             GO TO 9300-XCTL
  8567         ELSE
  8568             MOVE XCTL-157       TO PGM-NAME
  8569             GO TO 9300-XCTL.
  8570
  8571     IF EIBAID = DFHPF9
  8572        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8573        MOVE XCTL-141            TO PGM-NAME
  8574        GO TO 9300-XCTL.
  8575
  8576     IF EIBAID = DFHPF10
  8577        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8578        MOVE XCTL-155            TO PGM-NAME
  8579        GO TO 9300-XCTL.
  8580
  8581     MOVE SPACES                 TO ERRMSG0O
  8582                                    ERRMSG1O
  8583                                    ERRMSG2O.
  8584
  8585     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8586         IF PI-PASS-SW NOT = 'B'
  8587             MOVE ER-0422        TO EMI-ERROR
  8588             GO TO 0320-INPUT-ERROR
  8589           ELSE
  8590             GO TO 0700-TEST-FOR-CHANGES.
  8591
  8592     IF EIBAID = DFHPF11
  8593        IF PI-PASS-SW = 'C'
  8594           MOVE ER-0029          TO EMI-ERROR
  8595           GO TO 0320-INPUT-ERROR.
  8596
  8597     IF EIBAID = DFHENTER OR DFHPF11
  8598        NEXT SENTENCE
  8599     ELSE
  8600        MOVE ER-0029             TO EMI-ERROR
  8601        GO TO 0320-INPUT-ERROR.
  8602
  8603     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8604
  8605     if pi-epyfrom not = zeros
  8606        if pi-epyfrom not = ws-epyfrom
  8607           move zeros        to ws-edays
  8608        end-if
  8609     end-if
  8610
  8611     if pi-epythru not = zeros
  8612        if pi-epythru not = ws-epythru
  8613           move zeros        to ws-edays
  8614        end-if
  8615     end-if
  8616
  8617     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 164
* EL156.cbl
  8618         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8619         GO TO 1000-EDIT-DATA
  8620     ELSE
  8621         IF PI-FATAL-COUNT NOT = 0 OR
  8622            PI-FORCE-COUNT NOT = 0
  8623             GO TO 1000-EDIT-DATA
  8624         ELSE
  8625             GO TO 2000-EDIT-DONE.
  8626
  8627 0320-INPUT-ERROR.
  8628     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8629
  8630     IF ENTERPFL = 0
  8631         MOVE -1                 TO PMTTYPEL
  8632     ELSE
  8633         MOVE AL-UNBON           TO ENTERPFA
  8634         MOVE -1                 TO ENTERPFL.
  8635
  8636     GO TO 8200-SEND-DATAONLY.
  8637
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 165
* EL156.cbl
  8639 0330-BROWSE-FORWARD.
  8640
  8641     MOVE CLMNOI            TO PI-CLAIM-NO.
  8642     MOVE CARRI             TO PI-CARRIER.
  8643     MOVE CERTNOI           TO PI-CERT-PRIME.
  8644     MOVE SUFXI             TO PI-CERT-SFX.
  8645
  8646     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8647     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8648     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8649     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8650
  8651     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8652
  8653
  8654* EXEC CICS HANDLE CONDITION
  8655*         NOTFND   (0380-CLAIM-END-FILE)
  8656*         ENDFILE  (0380-CLAIM-END-FILE)
  8657*    END-EXEC.
  8658*    MOVE '"$I''                  ! # #00008624' TO DFHEIV0
  8659     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8660     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8661     MOVE X'2320233030303038363234' TO DFHEIV0(25:11)
  8662     CALL 'kxdfhei1' USING DFHEIV0
  8663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8664
  8665
  8666
  8667* EXEC CICS STARTBR
  8668*         DATASET    ('ELMSTR')
  8669*         RIDFLD     (ELMSTR-KEY)
  8670*         GTEQ
  8671*    END-EXEC.
  8672     MOVE 'ELMSTR' TO DFHEIV1
  8673     MOVE 0
  8674       TO DFHEIV11
  8675*    MOVE '&,         G          &   #00008629' TO DFHEIV0
  8676     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8677     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8678     MOVE X'2020233030303038363239' TO DFHEIV0(25:11)
  8679     CALL 'kxdfhei1' USING DFHEIV0,
  8680           DFHEIV1,
  8681           ELMSTR-KEY,
  8682           DFHEIV99,
  8683           DFHEIV11,
  8684           DFHEIV99
  8685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8686
  8687
  8688     MOVE 'Y' TO WS-BROWSE-START-SW.
  8689
  8690 0335-READNEXT.
  8691
  8692
  8693* EXEC CICS READNEXT
  8694*         DATASET    ('ELMSTR')
  8695*         RIDFLD     (ELMSTR-KEY)
  8696*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 166
* EL156.cbl
  8697*    END-EXEC.
  8698     MOVE 'ELMSTR' TO DFHEIV1
  8699     MOVE 0
  8700       TO DFHEIV11
  8701*    MOVE '&.S                   )   #00008639' TO DFHEIV0
  8702     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8703     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8704     MOVE X'2020233030303038363339' TO DFHEIV0(25:11)
  8705     CALL 'kxdfhei1' USING DFHEIV0,
  8706           DFHEIV1,
  8707           DFHEIV20,
  8708           DFHEIV99,
  8709           ELMSTR-KEY,
  8710           DFHEIV99,
  8711           DFHEIV11,
  8712           DFHEIV99,
  8713           DFHEIV99
  8714     SET ADDRESS OF CLAIM-MASTER TO
  8715         DFHEIV20
  8716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8717
  8718
  8719     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8720        GO TO 0380-CLAIM-END-FILE.
  8721
  8722     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8723        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8724        GO TO 0335-READNEXT.
  8725
  8726     IF PI-COMPANY-ID = 'CRI'
  8727         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8728            GO TO 0380-CLAIM-END-FILE.
  8729
  8730     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8731         GO TO 0335-READNEXT.
  8732
  8733     IF PI-CARRIER-SECURITY > SPACES
  8734         IF CL-CARRIER = PI-CARRIER-SECURITY
  8735             NEXT SENTENCE
  8736         ELSE
  8737             GO TO 0335-READNEXT.
  8738
  8739     IF PI-ACCOUNT-SECURITY > SPACES
  8740         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8741             NEXT SENTENCE
  8742         ELSE
  8743             GO TO 0335-READNEXT.
  8744
  8745     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8746     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8747     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8748
  8749     GO TO 0400-FIRST-TIME.
  8750
  8751 0350-BROWSE-BACKWARD.
  8752
  8753     MOVE CLMNOI            TO PI-CLAIM-NO
  8754                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 167
* EL156.cbl
  8755     MOVE CARRI             TO PI-CARRIER.
  8756     MOVE CERTNOI           TO PI-CERT-PRIME.
  8757     MOVE SUFXI             TO PI-CERT-SFX.
  8758
  8759     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8760
  8761     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8762     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8763     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8764
  8765
  8766* EXEC CICS HANDLE CONDITION
  8767*         NOTFND   (0380-CLAIM-END-FILE)
  8768*         ENDFILE  (0380-CLAIM-END-FILE)
  8769*    END-EXEC.
  8770*    MOVE '"$I''                  ! $ #00008691' TO DFHEIV0
  8771     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8772     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8773     MOVE X'2420233030303038363931' TO DFHEIV0(25:11)
  8774     CALL 'kxdfhei1' USING DFHEIV0
  8775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8776
  8777
  8778
  8779* EXEC CICS STARTBR
  8780*         DATASET    ('ELMSTR')
  8781*         RIDFLD     (ELMSTR-KEY)
  8782*         GTEQ
  8783*    END-EXEC.
  8784     MOVE 'ELMSTR' TO DFHEIV1
  8785     MOVE 0
  8786       TO DFHEIV11
  8787*    MOVE '&,         G          &   #00008696' TO DFHEIV0
  8788     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8789     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8790     MOVE X'2020233030303038363936' TO DFHEIV0(25:11)
  8791     CALL 'kxdfhei1' USING DFHEIV0,
  8792           DFHEIV1,
  8793           ELMSTR-KEY,
  8794           DFHEIV99,
  8795           DFHEIV11,
  8796           DFHEIV99
  8797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8798
  8799
  8800     MOVE 'Y' TO WS-BROWSE-START-SW.
  8801
  8802
  8803* EXEC CICS READNEXT
  8804*         DATASET    ('ELMSTR')
  8805*         RIDFLD     (ELMSTR-KEY)
  8806*         SET        (ADDRESS OF CLAIM-MASTER)
  8807*    END-EXEC.
  8808     MOVE 'ELMSTR' TO DFHEIV1
  8809     MOVE 0
  8810       TO DFHEIV11
  8811*    MOVE '&.S                   )   #00008704' TO DFHEIV0
  8812     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 168
* EL156.cbl
  8813     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8814     MOVE X'2020233030303038373034' TO DFHEIV0(25:11)
  8815     CALL 'kxdfhei1' USING DFHEIV0,
  8816           DFHEIV1,
  8817           DFHEIV20,
  8818           DFHEIV99,
  8819           ELMSTR-KEY,
  8820           DFHEIV99,
  8821           DFHEIV11,
  8822           DFHEIV99,
  8823           DFHEIV99
  8824     SET ADDRESS OF CLAIM-MASTER TO
  8825         DFHEIV20
  8826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8827
  8828
  8829
  8830* EXEC CICS READPREV
  8831*         DATASET    ('ELMSTR')
  8832*         RIDFLD     (ELMSTR-KEY)
  8833*         SET        (ADDRESS OF CLAIM-MASTER)
  8834*    END-EXEC.
  8835     MOVE 'ELMSTR' TO DFHEIV1
  8836     MOVE 0
  8837       TO DFHEIV11
  8838*    MOVE '&0S                   )   #00008710' TO DFHEIV0
  8839     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8840     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8841     MOVE X'2020233030303038373130' TO DFHEIV0(25:11)
  8842     CALL 'kxdfhei1' USING DFHEIV0,
  8843           DFHEIV1,
  8844           DFHEIV20,
  8845           DFHEIV99,
  8846           ELMSTR-KEY,
  8847           DFHEIV99,
  8848           DFHEIV11,
  8849           DFHEIV99,
  8850           DFHEIV99
  8851     SET ADDRESS OF CLAIM-MASTER TO
  8852         DFHEIV20
  8853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8854
  8855
  8856 0360-BROWSE-BACKWARD.
  8857
  8858
  8859* EXEC CICS READPREV
  8860*         DATASET    ('ELMSTR')
  8861*         RIDFLD     (ELMSTR-KEY)
  8862*         SET        (ADDRESS OF CLAIM-MASTER)
  8863*    END-EXEC.
  8864     MOVE 'ELMSTR' TO DFHEIV1
  8865     MOVE 0
  8866       TO DFHEIV11
  8867*    MOVE '&0S                   )   #00008718' TO DFHEIV0
  8868     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8869     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8870     MOVE X'2020233030303038373138' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 169
* EL156.cbl
  8871     CALL 'kxdfhei1' USING DFHEIV0,
  8872           DFHEIV1,
  8873           DFHEIV20,
  8874           DFHEIV99,
  8875           ELMSTR-KEY,
  8876           DFHEIV99,
  8877           DFHEIV11,
  8878           DFHEIV99,
  8879           DFHEIV99
  8880     SET ADDRESS OF CLAIM-MASTER TO
  8881         DFHEIV20
  8882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8883
  8884
  8885     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8886        GO TO 0380-CLAIM-END-FILE.
  8887
  8888     IF PI-COMPANY-ID = 'CRI'
  8889         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8890            GO TO 0380-CLAIM-END-FILE.
  8891
  8892     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8893         GO TO 0360-BROWSE-BACKWARD.
  8894
  8895     IF PI-CARRIER-SECURITY > SPACES
  8896         IF CL-CARRIER = PI-CARRIER-SECURITY
  8897             NEXT SENTENCE
  8898         ELSE
  8899             GO TO 0360-BROWSE-BACKWARD.
  8900
  8901     IF PI-ACCOUNT-SECURITY > SPACES
  8902         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8903             NEXT SENTENCE
  8904         ELSE
  8905             GO TO 0360-BROWSE-BACKWARD.
  8906
  8907     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8908     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8909     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8910
  8911     GO TO 0400-FIRST-TIME.
  8912
  8913 0380-CLAIM-END-FILE.
  8914
  8915     MOVE ER-0130     TO EMI-ERROR.
  8916     MOVE -1          TO CLMNOL.
  8917     MOVE AL-UABON    TO CARRA
  8918                         CLMNOA
  8919                         CERTNOA
  8920                         SUFXA.
  8921
  8922     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8923
  8924     GO TO 8200-SEND-DATAONLY.
  8925
  8926 0400-FIRST-TIME.
  8927
  8928     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 170
* EL156.cbl
  8929        MOVE 'N'         TO WS-BROWSE-START-SW
  8930
  8931* EXEC CICS ENDBR
  8932*            DATASET    ('ELMSTR')
  8933*       END-EXEC.
  8934     MOVE 'ELMSTR' TO DFHEIV1
  8935     MOVE 0
  8936       TO DFHEIV11
  8937*    MOVE '&2                    $   #00008769' TO DFHEIV0
  8938     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8939     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8940     MOVE X'2020233030303038373639' TO DFHEIV0(25:11)
  8941     CALL 'kxdfhei1' USING DFHEIV0,
  8942           DFHEIV1,
  8943           DFHEIV11,
  8944           DFHEIV99
  8945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8946
  8947
  8948     IF PI-PROCESSOR-ID = 'LGXX'
  8949         NEXT SENTENCE
  8950     ELSE
  8951
  8952* EXEC CICS READQ TS
  8953*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8954*            INTO    (SECURITY-CONTROL)
  8955*            LENGTH  (SC-COMM-LENGTH)
  8956*            ITEM    (SC-ITEM)
  8957*        END-EXEC
  8958*    MOVE '*$II   L              ''   #00008776' TO DFHEIV0
  8959     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8960     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8961     MOVE X'2020233030303038373736' TO DFHEIV0(25:11)
  8962     CALL 'kxdfhei1' USING DFHEIV0,
  8963           PI-SECURITY-TEMP-STORE-ID,
  8964           SECURITY-CONTROL,
  8965           SC-COMM-LENGTH,
  8966           SC-ITEM,
  8967           DFHEIV99,
  8968           DFHEIV99
  8969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8970         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8971         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8972
  8973     MOVE LOW-VALUES             TO EL156AI.
  8974     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8975     MOVE 'Y'                    TO FIRST-ENTRY.
  8976     GO TO 7000-SHOW-CLAIM.
  8977
  8978 0500-CREATE-TEMP-STORAGE.
  8979     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8980
  8981
  8982* EXEC CICS WRITEQ TS
  8983*        QUEUE (QID)
  8984*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8985*        LENGTH(PI-COMM-LENGTH)
  8986*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 171
* EL156.cbl
  8987*    MOVE '*"     L              ''   #00008793' TO DFHEIV0
  8988     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8989     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8990     MOVE X'2020233030303038373933' TO DFHEIV0(25:11)
  8991     CALL 'kxdfhei1' USING DFHEIV0,
  8992           QID,
  8993           PROGRAM-INTERFACE-BLOCK,
  8994           PI-COMM-LENGTH,
  8995           DFHEIV99,
  8996           DFHEIV99,
  8997           DFHEIV99
  8998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8999
  9000
  9001
  9002* EXEC CICS WRITEQ TS
  9003*        QUEUE (QID)
  9004*        FROM  (EL156AI)
  9005*        LENGTH(MAP-LENGTH)
  9006*    END-EXEC.
  9007*    MOVE '*"     L              ''   #00008799' TO DFHEIV0
  9008     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  9009     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9010     MOVE X'2020233030303038373939' TO DFHEIV0(25:11)
  9011     CALL 'kxdfhei1' USING DFHEIV0,
  9012           QID,
  9013           EL156AI,
  9014           MAP-LENGTH,
  9015           DFHEIV99,
  9016           DFHEIV99,
  9017           DFHEIV99
  9018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9019
  9020
  9021 0599-EXIT.
  9022      EXIT.
  9023
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 172
* EL156.cbl
  9025 0600-RECOVER-TEMP-STORAGE.
  9026
  9027* EXEC CICS READQ TS
  9028*        QUEUE (QID)
  9029*        INTO  (PROGRAM-INTERFACE-BLOCK)
  9030*        LENGTH(PI-COMM-LENGTH)
  9031*    END-EXEC.
  9032*    MOVE '*$I    L              ''   #00008810' TO DFHEIV0
  9033     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9034     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9035     MOVE X'2020233030303038383130' TO DFHEIV0(25:11)
  9036     CALL 'kxdfhei1' USING DFHEIV0,
  9037           QID,
  9038           PROGRAM-INTERFACE-BLOCK,
  9039           PI-COMM-LENGTH,
  9040           DFHEIV99,
  9041           DFHEIV99,
  9042           DFHEIV99
  9043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9044
  9045
  9046
  9047* EXEC CICS READQ TS
  9048*        QUEUE (QID)
  9049*        INTO  (EL156AI)
  9050*        LENGTH(MAP-LENGTH)
  9051*    END-EXEC.
  9052*    MOVE '*$I    L              ''   #00008816' TO DFHEIV0
  9053     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9054     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9055     MOVE X'2020233030303038383136' TO DFHEIV0(25:11)
  9056     CALL 'kxdfhei1' USING DFHEIV0,
  9057           QID,
  9058           EL156AI,
  9059           MAP-LENGTH,
  9060           DFHEIV99,
  9061           DFHEIV99,
  9062           DFHEIV99
  9063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9064
  9065
  9066     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  9067
  9068     IF PMTTYPEI NOT = LOW-VALUES
  9069         MOVE AL-UANON           TO PMTTYPEA.
  9070
  9071     IF PAYEEI NOT = LOW-VALUES
  9072         MOVE AL-UANON           TO PAYEEA.
  9073
  9074     IF NOTE1I NOT = LOW-VALUES
  9075         MOVE AL-UANON           TO NOTE1A.
  9076
  9077     IF (RETURNED-FROM = 'EL614')
  9078        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  9079     END-IF
  9080*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  9081*       AND (PI-EOB-CODES-EXIST = 'Y')
  9082*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 173
* EL156.cbl
  9083*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  9084     IF PI-SET-NOTE2-MDT = 'Y'
  9085         MOVE AL-SANON           TO NOTE2A
  9086     END-IF
  9087
  9088     IF OFFLINEI NOT = LOW-VALUES
  9089         MOVE AL-UANON           TO OFFLINEA.
  9090
  9091*    IF GROUPEDI NOT = LOW-VALUES
  9092*        MOVE AL-UANON           TO GROUPEDA.
  9093
  9094*    IF CASHI NOT = LOW-VALUES
  9095*        MOVE AL-UANON           TO CASHA.
  9096
  9097     IF CHECKNOI NOT = LOW-VALUES
  9098         MOVE AL-UANON           TO CHECKNOA.
  9099
  9100     IF HOLDTILI NOT = LOW-VALUES
  9101         MOVE AL-UANON           TO HOLDTILA.
  9102
  9103     IF EPYFROMI NOT = LOW-VALUES
  9104         MOVE AL-UANON           TO EPYFROMA.
  9105
  9106     IF AIGFROMI NOT = LOW-VALUES
  9107         MOVE AL-UANON           TO AIGFROMA.
  9108
  9109     IF EPYTHRUI NOT = LOW-VALUES
  9110         MOVE AL-UANON           TO EPYTHRUA.
  9111
  9112     IF EDAYSI NOT = LOW-VALUES
  9113         MOVE AL-UNNON           TO EDAYSA.
  9114
  9115     IF EPYAMTL NOT = +0
  9116         MOVE AL-UNNON           TO EPYAMTA.
  9117
  9118     IF ERESVL NOT = +0
  9119         MOVE AL-UNNON           TO ERESVA.
  9120
  9121     IF EEXPENSL NOT = +0
  9122         MOVE AL-UNNON           TO EEXPENSA.
  9123
  9124     IF ETYPEI NOT = LOW-VALUES
  9125         MOVE AL-UNNON           TO ETYPEA.
  9126
  9127     IF PROOFDTI NOT = 0
  9128         MOVE AL-UNNON           TO PROOFDTA.
  9129
  9130     IF EOBYNI = 'Y' OR 'N' OR 'S'
  9131        MOVE AL-UANON            TO EOBYNA
  9132     END-IF
  9133     IF CLMFMYNI = 'Y' OR 'N'
  9134        MOVE AL-UANON            TO CLMFMYNA
  9135     END-IF
  9136
  9137     IF SURVYYNI = 'Y' OR 'N'
  9138        IF PI-APPROVAL-LEVEL = '4' OR '5'
  9139           MOVE AL-UANON         TO SURVYYNA
  9140        END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 174
* EL156.cbl
  9141     END-IF
  9142
  9143     IF SPRELYNI = 'Y' OR 'N'
  9144        MOVE AL-UANON            TO SPRELYNA
  9145     END-IF
  9146
  9147     .
  9148 0699-EXIT.
  9149      EXIT.
  9150
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 175
* EL156.cbl
  9152 0700-TEST-FOR-CHANGES.
  9153     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  9154         MOVE ER-0433            TO EMI-ERROR
  9155         GO TO 0750-FUNCTION-ERROR.
  9156
  9157     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  9158
  9159     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9160         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9161         MOVE 'A'                TO PI-PASS-SW
  9162         GO TO 1000-EDIT-DATA.
  9163
  9164     IF PI-FATAL-COUNT NOT = 0
  9165         MOVE ER-0499            TO EMI-ERROR
  9166         GO TO 0750-FUNCTION-ERROR.
  9167
  9168     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9169         MOVE ER-0500            TO EMI-ERROR
  9170         GO TO 0750-FUNCTION-ERROR.
  9171
  9172     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9173        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9174           MOVE ER-0542          TO EMI-ERROR
  9175           MOVE -1               TO EPYAMTL
  9176           GO TO 0750-FUNCTION-ERROR.
  9177
  9178     IF PI-OFFLINE = 'Y'  OR
  9179        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9180        MOVE EIBAID              TO PI-PFKEY-USED
  9181        GO TO 5000-UPDATE.
  9182
  9183     GO TO 6000-BUILD-SCREEN-B.
  9184
  9185 0750-FUNCTION-ERROR.
  9186     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9187
  9188     IF ENTERPFL > 0
  9189         MOVE -1                 TO ENTERPFL
  9190         MOVE AL-UNBON           TO ENTERPFA
  9191         GO TO 8200-SEND-DATAONLY
  9192     ELSE
  9193         MOVE -1                 TO ENTERPFL
  9194         MOVE AL-UNNOF           TO ENTERPFA
  9195         GO TO 8200-SEND-DATAONLY.
  9196
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 176
* EL156.cbl
  9198 0800-DELETE-TS.
  9199
  9200* EXEC CICS HANDLE CONDITION
  9201*        QIDERR(0800-EXIT)
  9202*    END-EXEC.
  9203*    MOVE '"$N                   ! % #00008955' TO DFHEIV0
  9204     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9205     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9206     MOVE X'2520233030303038393535' TO DFHEIV0(25:11)
  9207     CALL 'kxdfhei1' USING DFHEIV0
  9208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9209
  9210
  9211
  9212* EXEC CICS DELETEQ TS
  9213*        QUEUE(QID)
  9214*    END-EXEC.
  9215*    MOVE '*&                    #   #00008959' TO DFHEIV0
  9216     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9217     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9218     MOVE X'2020233030303038393539' TO DFHEIV0(25:11)
  9219     CALL 'kxdfhei1' USING DFHEIV0,
  9220           QID,
  9221           DFHEIV99
  9222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9223
  9224
  9225 0800-EXIT.
  9226      EXIT.
  9227 0900-GET-DDF-LIMITS.
  9228
  9229     if cm-clp-state = zeros or spaces or low-values
  9230        move cm-state            to cm-clp-state
  9231     end-if
  9232     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9233     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9234     MOVE cm-clp-state           TO ERPDEF-STATE
  9235     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9236     evaluate true
  9237        when (cl-claim-type = 'L' or 'P')
  9238           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9239             and 'CU')
  9240           move 'L'              to erpdef-ben-type
  9241           move pi-lf-benefit-cd to erpdef-ben-code
  9242        when (cl-claim-type not = 'L' and 'P')
  9243           and (pi-ah-benefit-cd not = '00' and '  ')
  9244           move 'A'              to erpdef-ben-type
  9245           move pi-ah-benefit-cd to erpdef-ben-code
  9246        when (cl-claim-type not = 'L' and 'P')
  9247           and (pi-ah-benefit-cd = '00' or '  ')
  9248           move 'L'              to erpdef-ben-type
  9249           move pi-lf-benefit-cd to erpdef-ben-code
  9250        when (cl-claim-type = 'L' or 'P')
  9251           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9252           move 'A'              to erpdef-ben-type
  9253           move pi-ah-benefit-cd to erpdef-ben-code
  9254        when other
  9255           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 177
* EL156.cbl
  9256           move pi-ah-benefit-cd to erpdef-ben-code
  9257     end-evaluate
  9258*    if (cl-claim-type = 'L' or 'P')
  9259*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9260*          and 'CU')
  9261*       move 'L'                 to erpdef-ben-type
  9262*       move pi-lf-benefit-cd    to erpdef-ben-code
  9263*    else
  9264*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9265*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9266*    end-if
  9267     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9268
  9269     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9270
  9271
  9272* EXEC CICS STARTBR
  9273*        DATASET  ('ERPDEF')
  9274*        RIDFLD   (ERPDEF-KEY)
  9275*        GTEQ
  9276*        RESP     (WS-RESPONSE)
  9277*    END-EXEC
  9278     MOVE 'ERPDEF' TO DFHEIV1
  9279     MOVE 0
  9280       TO DFHEIV11
  9281*    MOVE '&,         G          &  N#00009009' TO DFHEIV0
  9282     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9283     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9284     MOVE X'204E233030303039303039' TO DFHEIV0(25:11)
  9285     CALL 'kxdfhei1' USING DFHEIV0,
  9286           DFHEIV1,
  9287           ERPDEF-KEY,
  9288           DFHEIV99,
  9289           DFHEIV11,
  9290           DFHEIV99
  9291     MOVE EIBRESP  TO WS-RESPONSE
  9292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9293
  9294     IF NOT WS-RESP-NORMAL
  9295        GO TO 0900-EXIT
  9296     END-IF
  9297
  9298     .
  9299 0900-READNEXT.
  9300
  9301
  9302* EXEC CICS READNEXT
  9303*       DATASET  ('ERPDEF')
  9304*       SET      (ADDRESS OF PRODUCT-MASTER)
  9305*       RIDFLD   (ERPDEF-KEY)
  9306*       RESP     (WS-RESPONSE)
  9307*    END-EXEC
  9308     MOVE 'ERPDEF' TO DFHEIV1
  9309     MOVE 0
  9310       TO DFHEIV11
  9311*    MOVE '&.S                   )  N#00009023' TO DFHEIV0
  9312     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9313     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 178
* EL156.cbl
  9314     MOVE X'204E233030303039303233' TO DFHEIV0(25:11)
  9315     CALL 'kxdfhei1' USING DFHEIV0,
  9316           DFHEIV1,
  9317           DFHEIV20,
  9318           DFHEIV99,
  9319           ERPDEF-KEY,
  9320           DFHEIV99,
  9321           DFHEIV11,
  9322           DFHEIV99,
  9323           DFHEIV99
  9324     SET ADDRESS OF PRODUCT-MASTER TO
  9325         DFHEIV20
  9326     MOVE EIBRESP  TO WS-RESPONSE
  9327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9328
  9329     IF NOT WS-RESP-NORMAL
  9330        GO TO 0900-ENDBR
  9331     END-IF
  9332
  9333     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9334        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9335           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9336        ELSE
  9337           GO TO 0900-READNEXT
  9338        END-IF
  9339     ELSE
  9340        GO TO 0900-ENDBR
  9341     END-IF
  9342
  9343     IF CM-LOAN-TERM = ZEROS
  9344        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9345     END-IF
  9346
  9347     .
  9348 0900-ENDBR.
  9349
  9350
  9351* EXEC CICS ENDBR
  9352*       DATASET  ('ERPDEF')
  9353*    END-EXEC
  9354     MOVE 'ERPDEF' TO DFHEIV1
  9355     MOVE 0
  9356       TO DFHEIV11
  9357*    MOVE '&2                    $   #00009051' TO DFHEIV0
  9358     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9359     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9360     MOVE X'2020233030303039303531' TO DFHEIV0(25:11)
  9361     CALL 'kxdfhei1' USING DFHEIV0,
  9362           DFHEIV1,
  9363           DFHEIV11,
  9364           DFHEIV99
  9365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9366
  9367     .
  9368 0900-EXIT.
  9369     EXIT.
  9370 1000-EDIT-DATA.
  9371
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 179
* EL156.cbl
  9372     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9373         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9374         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9375
  9376     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9377
  9378     IF NOT MODIFY-CAP
  9379         MOVE ER-0070            TO EMI-ERROR
  9380         MOVE -1                 TO PMTTYPEL
  9381         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9382         GO TO 2000-EDIT-DONE.
  9383
  9384     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9385                         '5' AND '6'
  9386         MOVE ER-0420            TO EMI-ERROR
  9387         MOVE -1                 TO PMTTYPEL
  9388         MOVE AL-UABON           TO PMTTYPEA
  9389         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9390     ELSE
  9391         MOVE AL-UANON           TO PMTTYPEA.
  9392
  9393*    IF PI-OFFLINE = 'Y'
  9394*       IF PI-GROUPED = 'Y'
  9395*          MOVE ER-1880         TO EMI-ERROR
  9396*          MOVE -1              TO GROUPEDL
  9397*          MOVE AL-UABON        TO GROUPEDA
  9398*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9399*
  9400*    IF GROUPEDL > +0
  9401*       IF PI-GROUPED = 'Y' OR 'N'
  9402*          MOVE AL-UANON TO GROUPEDA
  9403*       ELSE
  9404*          MOVE ER-3140            TO EMI-ERROR
  9405*          MOVE -1                 TO GROUPEDL
  9406*          MOVE AL-UABON           TO GROUPEDA
  9407*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9408*
  9409*    IF CASHL > +0
  9410*       IF PI-CASH = 'Y' OR 'N'
  9411*          MOVE AL-UANON           TO CASHA
  9412*       ELSE
  9413*          MOVE ER-3141            TO EMI-ERROR
  9414*          MOVE -1                 TO CASHL
  9415*          MOVE AL-UABON           TO CASHA
  9416*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9417
  9418     IF LOANNOL > +0
  9419         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9420
  9421 1000-EDIT-PAYEE.
  9422
  9423     IF PI-PAYEE-SEQ NOT NUMERIC
  9424         MOVE ER-0294            TO  EMI-ERROR
  9425         MOVE -1                 TO  PAYEEL
  9426         MOVE AL-UABON           TO  PAYEEA
  9427         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9428         GO TO 1000-CONT-EDIT.
  9429
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 180
* EL156.cbl
  9430     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9431                         'E' OR 'O' OR 'Q'
  9432         NEXT SENTENCE
  9433     ELSE
  9434         MOVE ER-0294            TO  EMI-ERROR
  9435         MOVE -1                 TO  PAYEEL
  9436         MOVE AL-UABON           TO  PAYEEA
  9437         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9438         GO TO 1000-CONT-EDIT.
  9439
  9440     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9441        (PI-PAYEE-SEQ NOT < '1' AND
  9442         PI-PAYEE-SEQ NOT > '9'))
  9443      OR
  9444        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9445         (PI-PAYEE-SEQ NOT > '9'))
  9446         MOVE AL-UANON            TO PAYEEA
  9447     ELSE
  9448         MOVE ER-0294            TO EMI-ERROR
  9449         MOVE -1                 TO PAYEEL
  9450         MOVE AL-UABON           TO PAYEEA
  9451         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9452
  9453     IF PI-COMPANY-ID = 'DMD'
  9454         IF PI-PAYEE-TYPE = 'B' AND
  9455            PI-PAYEE-SEQ NOT = '0'
  9456               MOVE ER-7841            TO EMI-ERROR
  9457               MOVE -1                 TO PAYEEL
  9458               MOVE AL-UABON           TO PAYEEA
  9459               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9460
  9461     IF PI-COMPANY-ID = 'JHL'
  9462         IF PI-PAYEE = 'B0'
  9463             NEXT SENTENCE
  9464           ELSE
  9465
  9466* EXEC CICS HANDLE CONDITION
  9467*            ENDFILE(1950-NOT-FOUND)
  9468*            NOTFND (1950-NOT-FOUND)
  9469*        END-EXEC
  9470*    MOVE '"$''I                  ! & #00009153' TO DFHEIV0
  9471     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9472     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9473     MOVE X'2620233030303039313533' TO DFHEIV0(25:11)
  9474     CALL 'kxdfhei1' USING DFHEIV0
  9475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9476         MOVE 'N'                    TO FOUND-TOL-SW
  9477         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9478         MOVE '2'                    TO CNTL-REC-TYPE
  9479         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9480         MOVE +0                     TO CNTL-SEQ-NO
  9481         MOVE 'PROC'                 TO FILE-SWITCH
  9482         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9483         IF PI-PAYEE = 'I1' AND
  9484            APPROVAL-LEVEL-2
  9485             NEXT SENTENCE
  9486           ELSE
  9487         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 181
* EL156.cbl
  9488             MOVE ER-3546        TO EMI-ERROR
  9489             MOVE -1             TO PAYEEL
  9490             MOVE AL-UABON       TO PAYEEA
  9491             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9492
  9493     IF PI-PAYEE-TYPE = 'E'
  9494        IF PI-PMTTYPE = '5' OR '6'
  9495            NEXT SENTENCE
  9496        ELSE
  9497            MOVE ER-3539            TO EMI-ERROR
  9498            MOVE -1                 TO PAYEEL
  9499            MOVE AL-UABON           TO PAYEEA
  9500            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9501
  9502 1000-CONT-EDIT.
  9503
  9504     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9505        IF PI-EPYAMT NOT NEGATIVE
  9506            MOVE ER-0421         TO EMI-ERROR
  9507            MOVE -1              TO OFFLINEL
  9508            MOVE AL-UABON        TO OFFLINEA
  9509            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9510        ELSE
  9511            MOVE AL-UANON        TO OFFLINEA.
  9512
  9513     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  9514        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9515           CONTINUE
  9516        ELSE
  9517           IF PI-PRINT-EOB-YN = 'S' AND
  9518              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
  9519                CONTINUE
  9520           ELSE
  9521              MOVE ER-1561       TO EMI-ERROR
  9522              MOVE -1            TO EOBYNL
  9523              MOVE AL-UABON      TO EOBYNA
  9524              PERFORM 9900-ERROR-FORMAT
  9525                                 THRU 9900-EXIT
  9526           END-IF
  9527        END-IF
  9528
  9529        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9530            MOVE ER-1566        TO EMI-ERROR
  9531            MOVE -1             TO CLMFMYNL
  9532            MOVE AL-UABON       TO CLMFMYNA
  9533            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9534        END-IF
  9535
  9536        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9537            MOVE ER-1567        TO EMI-ERROR
  9538            MOVE -1             TO SURVYYNL
  9539            MOVE AL-UABON       TO SURVYYNA
  9540            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9541        END-IF
  9542
  9543        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9544            MOVE ER-1569        TO EMI-ERROR
  9545            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 182
* EL156.cbl
  9546            MOVE AL-UABON       TO SPRELYNA
  9547            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9548        END-IF
  9549
  9550     END-IF
  9551     IF PI-EPYAMT IS NEGATIVE
  9552         IF PI-OFFLINE NOT = 'Y'
  9553             MOVE ER-0836        TO  EMI-ERROR
  9554             MOVE -1             TO  OFFLINEL
  9555             MOVE AL-UABON       TO  OFFLINEA
  9556             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9557
  9558     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9559        MOVE ER-0872             TO EMI-ERROR
  9560        MOVE -1                  TO PROOFDTL
  9561        MOVE AL-UABON            TO PROOFDTA
  9562        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9563     ELSE
  9564        MOVE '4'                TO DC-OPTION-CODE
  9565        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9566        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9567        IF DATE-CONVERSION-ERROR
  9568            MOVE ER-0873        TO EMI-ERROR
  9569            MOVE -1                  TO PROOFDTL
  9570            MOVE AL-UABON            TO PROOFDTA
  9571            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9572        ELSE
  9573            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9574            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9575                MOVE ER-0873    TO EMI-ERROR
  9576                MOVE -1                  TO PROOFDTL
  9577                MOVE AL-UABON            TO PROOFDTA
  9578                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9579            END-IF
  9580        END-IF
  9581     END-IF.
  9582
  9583     IF PI-COMPANY-ID = 'DMD'
  9584        IF NOTE1L NOT = ZEROS
  9585            MOVE ER-7844        TO  EMI-ERROR
  9586            MOVE -1             TO  NOTE1L
  9587            MOVE AL-UABON       TO  NOTE1A
  9588            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9589
  9590     IF PI-COMPANY-ID = 'DMD'
  9591        IF NOTE2L NOT = ZEROS
  9592          GO TO 1004-DMD-EOB-CHECKS.
  9593
  9594     IF NOTE1L NOT > +0
  9595         GO TO 1005-CHECK-ERRORS.
  9596
  9597     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9598         GO TO 1005-CHECK-ERRORS.
  9599
  9600     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9601         GO TO 1003-HAN-PMT-NOTES.
  9602
  9603     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 183
* EL156.cbl
  9604
  9605     IF WS-PMTOPTION NUMERIC
  9606        IF WS-PMTOPTION > '00' AND < '17'
  9607           NEXT SENTENCE
  9608        ELSE
  9609           MOVE ER-0618          TO EMI-ERROR
  9610           MOVE -1               TO NOTE1L
  9611           MOVE AL-UABON         TO NOTE1A
  9612           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9613     ELSE
  9614        GO TO 1005-CHECK-ERRORS.
  9615
  9616     IF WS-PMTOPTION = '05' AND
  9617        WS-DOCNAME = SPACES
  9618          MOVE ER-0616             TO EMI-ERROR
  9619          MOVE -1                  TO NOTE1L
  9620          MOVE AL-UABON            TO NOTE1A
  9621          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9622
  9623     IF WS-PMTOPTION = '15' OR '16'
  9624
  9625* EXEC CICS BIF DEEDIT
  9626*            FIELD (WS-AMOUNT)
  9627*            LENGTH(08)
  9628*        END-EXEC
  9629     MOVE 08
  9630       TO DFHEIV11
  9631*    MOVE '@"L                   #   #00009305' TO DFHEIV0
  9632     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9633     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9634     MOVE X'2020233030303039333035' TO DFHEIV0(25:11)
  9635     CALL 'kxdfhei1' USING DFHEIV0,
  9636           WS-AMOUNT,
  9637           DFHEIV11
  9638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9639        IF (WS-NUM-AMT = ZEROS) OR
  9640           (WS-AMOUNT NOT NUMERIC)
  9641           MOVE ER-0617          TO EMI-ERROR
  9642           MOVE -1               TO NOTE1L
  9643           MOVE AL-UABON         TO NOTE1A
  9644           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9645
  9646     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9647
  9648     GO TO 1005-CHECK-ERRORS.
  9649
  9650 1003-HAN-PMT-NOTES.
  9651
  9652     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9653
  9654     IF WS-HAN-PMT-CODE = SPACE
  9655         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9656     ELSE
  9657     IF WS-HAN-PMT-CODE = 'A'
  9658         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9659                                 TO WS-HAN-PMT-NOTE
  9660     ELSE
  9661     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 184
* EL156.cbl
  9662         MOVE ':FINAL PAYMENT / DECEASED'
  9663                                 TO WS-HAN-PMT-NOTE
  9664     ELSE
  9665     IF WS-HAN-PMT-CODE = 'C'
  9666         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9667                                 TO WS-HAN-PMT-NOTE
  9668     ELSE
  9669     IF WS-HAN-PMT-CODE = 'D'
  9670         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9671                                 TO WS-HAN-PMT-NOTE
  9672     ELSE
  9673     IF WS-HAN-PMT-CODE = 'E'
  9674         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9675                                 TO WS-HAN-PMT-NOTE
  9676     ELSE
  9677     IF WS-HAN-PMT-CODE = 'F'
  9678         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9679                                 TO WS-HAN-PMT-NOTE
  9680     ELSE
  9681     IF WS-HAN-PMT-CODE = 'P'
  9682         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9683
  9684     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9685     GO TO 1005-CHECK-ERRORS.
  9686
  9687 1004-DMD-EOB-CHECKS.
  9688
  9689     INITIALIZE PI-AT-EOB-CODES.
  9690
  9691     IF NOTE2I (20:21) > SPACES
  9692         MOVE ER-7845          TO EMI-ERROR
  9693         MOVE -1               TO NOTE2L
  9694         MOVE AL-UABON         TO NOTE2A
  9695         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9696         GO TO 1005-CHECK-ERRORS
  9697      ELSE
  9698         MOVE NOTE2I             TO W-EOB-CODES.
  9699
  9700     MOVE +1                     TO W-EOB-NDX.
  9701
  9702 1004-CHECK-EACH-EOB.
  9703
  9704     IF W-EOB-NDX > +5
  9705             OR
  9706        W-EOB-CODE (W-EOB-NDX) = SPACES
  9707         GO TO 1004-CHECK-DUP-EOB.
  9708
  9709     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9710         MOVE ER-0956            TO EMI-ERROR
  9711         MOVE -1                 TO NOTE2L
  9712         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9713         GO TO 1005-CHECK-ERRORS.
  9714
  9715     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9716     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9717     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9718     MOVE 'DLO023'               TO PGM-NAME.
  9719
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 185
* EL156.cbl
  9720
  9721* EXEC CICS LINK
  9722*        PROGRAM    (PGM-NAME)
  9723*        COMMAREA   (CD-COMMUNICATION-AREA)
  9724*        LENGTH     (CD-RCRD-LENGTH)
  9725*    END-EXEC.
  9726*    MOVE '."C                   (   #00009390' TO DFHEIV0
  9727     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9728     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9729     MOVE X'2020233030303039333930' TO DFHEIV0(25:11)
  9730     CALL 'kxdfhei1' USING DFHEIV0,
  9731           PGM-NAME,
  9732           CD-COMMUNICATION-AREA,
  9733           CD-RCRD-LENGTH,
  9734           DFHEIV99,
  9735           DFHEIV99,
  9736           DFHEIV99,
  9737           DFHEIV99
  9738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9739
  9740
  9741     IF CD-RETURN-CODE = 'OK'
  9742         GO TO 1004-CONT.
  9743
  9744     MOVE -1                     TO NOTE2L.
  9745
  9746     IF CD-RETURN-CODE = '01'
  9747         MOVE ER-8310            TO EMI-ERROR
  9748         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9749         GO TO 1005-CHECK-ERRORS.
  9750
  9751     IF CD-RETURN-CODE = '02'
  9752         MOVE ER-8311            TO EMI-ERROR
  9753         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9754         GO TO 1005-CHECK-ERRORS.
  9755
  9756     IF CD-RETURN-CODE = '03'
  9757         MOVE ER-8312            TO EMI-ERROR
  9758         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9759         GO TO 1005-CHECK-ERRORS.
  9760
  9761     IF CD-RETURN-CODE = '04'
  9762         MOVE ER-8313            TO EMI-ERROR
  9763         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9764         GO TO 1005-CHECK-ERRORS.
  9765
  9766     IF CD-RETURN-CODE = '05'
  9767         MOVE ER-8314            TO EMI-ERROR
  9768         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9769         GO TO 1005-CHECK-ERRORS.
  9770
  9771     IF CD-RETURN-CODE = '06'
  9772         MOVE ER-8315            TO EMI-ERROR
  9773         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9774         GO TO 1005-CHECK-ERRORS.
  9775
  9776     IF CD-RETURN-CODE = 'E1'
  9777         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 186
* EL156.cbl
  9778         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9779         GO TO 1005-CHECK-ERRORS.
  9780
  9781     IF CD-RETURN-CODE = 'N1'
  9782         MOVE ER-8317            TO EMI-ERROR
  9783         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9784         GO TO 1005-CHECK-ERRORS.
  9785
  9786 1004-CONT.
  9787     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9788
  9789     ADD +1 TO W-EOB-NDX.
  9790     GO TO 1004-CHECK-EACH-EOB.
  9791
  9792 1004-CHECK-DUP-EOB.
  9793     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9794         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9795                               PI-AT-EOB-CODE (3) OR
  9796                               PI-AT-EOB-CODE (4) OR
  9797                               PI-AT-EOB-CODE (5)))
  9798                  OR
  9799        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9800         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9801                               PI-AT-EOB-CODE (4) OR
  9802                               PI-AT-EOB-CODE (5)))
  9803                  OR
  9804        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9805         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9806                               PI-AT-EOB-CODE (5)))
  9807                  OR
  9808        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9809         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9810            MOVE ER-8000            TO EMI-ERROR
  9811            MOVE AL-UABON           TO NOTE2A
  9812            MOVE -1                 TO NOTE2L
  9813            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9814            GO TO 1005-CHECK-ERRORS.
  9815
  9816 1005-CHECK-ERRORS.
  9817*    IF PI-COMPANY-ID NOT = 'DMD'
  9818        GO TO 1006-CHECK-ERRORS.
  9819
  9820*********  DMD CODE START ******************
  9821*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9822*       GO TO 1006-CHECK-ERRORS.
  9823*
  9824*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9825*
  9826*    COMPUTE W-PAYMENT-TOTAL
  9827*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9828*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9829*               AND
  9830*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9831*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9832*          MOVE ER-0967    TO EMI-ERROR
  9833*          MOVE -1         TO PMTTYPEL
  9834*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9835*
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 187
* EL156.cbl
  9836*    GO TO 1006-CHECK-ERRORS.
  9837*********  DMD CODE END ******************
  9838
  9839 1006-CHECK-ERRORS.
  9840     if emi-forcable-ctr = zeros
  9841        and emi-fatal-ctr = zeros
  9842        continue
  9843     else
  9844        IF NOT EMI-NO-ERRORS
  9845           GO TO 2000-EDIT-DONE
  9846        end-if
  9847     end-if
  9848
  9849* EXEC CICS HANDLE CONDITION
  9850*        NOTFND(1950-NOT-FOUND)
  9851*    END-EXEC.
  9852*    MOVE '"$I                   ! '' #00009503' TO DFHEIV0
  9853     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9854     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9855     MOVE X'2720233030303039353033' TO DFHEIV0(25:11)
  9856     CALL 'kxdfhei1' USING DFHEIV0
  9857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9858
  9859
  9860     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9861     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9862     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9863     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9864     MOVE 'MSTR'                 TO FILE-SWITCH.
  9865
  9866     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9867
  9868     IF PI-COMPANY-ID = 'DMD'
  9869         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9870
  9871     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9872        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9873           MOVE ER-0873    TO EMI-ERROR
  9874           MOVE -1                  TO PROOFDTL
  9875           MOVE AL-UABON            TO PROOFDTA
  9876           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9877        END-IF
  9878     END-IF
  9879     if cl-benefit-period = zeros
  9880        move er-1667             to emi-error
  9881        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9882     end-if
  9883     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9884     MOVE +95                    TO TRLR-SEQ-NO
  9885
  9886* EXEC CICS READ
  9887*       DATASET  ('ELTRLR')
  9888*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9889*       RIDFLD   (ELTRLR-KEY)
  9890*       RESP     (WS-RESPONSE)
  9891*    END-EXEC
  9892     MOVE 'ELTRLR' TO DFHEIV1
  9893*    MOVE '&"S        E          (  N#00009532' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 188
* EL156.cbl
  9894     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9895     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9896     MOVE X'204E233030303039353332' TO DFHEIV0(25:11)
  9897     CALL 'kxdfhei1' USING DFHEIV0,
  9898           DFHEIV1,
  9899           DFHEIV20,
  9900           DFHEIV99,
  9901           ELTRLR-KEY,
  9902           DFHEIV99,
  9903           DFHEIV99,
  9904           DFHEIV99
  9905     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9906         DFHEIV20
  9907     MOVE EIBRESP  TO WS-RESPONSE
  9908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9909
  9910     if ws-resp-normal
  9911        perform varying s1 from +1 by +1 until
  9912           at-note-error-no (s1) = spaces
  9913           if at-note-error-no (s1) = '1662'
  9914              continue
  9915           else
  9916              move at-note-error-no (s1)
  9917                                 to emi-error
  9918              if at-note-error-no (s1) = '1653'
  9919                 evaluate true
  9920                    when cl-claim-type = 'L'
  9921                       move '  LF  '
  9922                                 to emi-claim-type
  9923                    when cl-claim-type = 'I'
  9924                       move '  IU  '
  9925                                 to emi-claim-type
  9926                    when cl-claim-type = 'A'
  9927                       move '  AH  '
  9928                                 to emi-claim-type
  9929                    when cl-claim-type = 'O'
  9930                       move '  OT  '
  9931                                 to emi-claim-type
  9932                    when other
  9933                       move ' FMLA '
  9934                                 to emi-claim-type
  9935                 end-evaluate
  9936              end-if
  9937              PERFORM 9900-ERROR-FORMAT
  9938                                 THRU 9900-EXIT
  9939           end-if
  9940        end-perform
  9941     end-if
  9942     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9943         IF PI-PMTTYPE = '5' OR '6'
  9944             NEXT SENTENCE
  9945         ELSE
  9946             MOVE ER-0555             TO EMI-ERROR
  9947             MOVE -1                  TO PMTTYPEL
  9948             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9949
  9950     IF CL-LAST-CLOSE-REASON = '2'
  9951         IF CL-CLAIM-STATUS = 'C'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 189
* EL156.cbl
  9952             MOVE ER-0760        TO  EMI-ERROR
  9953             MOVE -1             TO  PMTTYPEL
  9954             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9955
  9956     IF PI-ACTIVITY-CODE = 9
  9957         MOVE ER-3538            TO  EMI-ERROR
  9958         MOVE -1                 TO  PMTTYPEL
  9959         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9960
  9961     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9962         GO TO 1008-READ-CERT.
  9963**********************AIG LOGIC STARTS *********************
  9964     IF CL-CERT-PRIME = 'INCOMPLETE'
  9965         MOVE ER-3540            TO  EMI-ERROR
  9966         MOVE -1                 TO  PMTTYPEL
  9967         MOVE AL-UABON           TO  PMTTYPEA
  9968         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9969         GO TO 2000-EDIT-DONE.
  9970
  9971     IF PI-PMTTYPE = '4'
  9972         IF PI-EPYAMT IS NEGATIVE
  9973             IF PI-ECHECKNO-CR = 'CR'
  9974                 NEXT SENTENCE
  9975             ELSE
  9976                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9977
  9978     IF PI-PMTTYPE = '4'
  9979         IF PI-ECHECKNO-CR = 'CR'
  9980             IF PI-EPYAMT IS NEGATIVE
  9981                 NEXT SENTENCE
  9982             ELSE
  9983                 MOVE ER-0834    TO  EMI-ERROR
  9984                 MOVE -1         TO  EPYAMTL
  9985                 MOVE AL-UNBON   TO  EPYAMTA
  9986                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9987
  9988     IF PI-PMTTYPE = '4'
  9989         IF PI-EPYAMT IS NEGATIVE
  9990             IF PI-OFFLINE = 'Y'
  9991                 NEXT SENTENCE
  9992             ELSE
  9993                 MOVE 'Y'        TO  PI-OFFLINE
  9994                                     WS-OFFLINE
  9995                                     OFFLINEO
  9996                 MOVE AL-UANON   TO  OFFLINEA.
  9997
  9998*    IF PI-PMTTYPE = '4'
  9999*        IF PI-EPYAMT IS NEGATIVE
 10000*            IF PI-CASH = 'Y'
 10001*                NEXT SENTENCE
 10002*            ELSE
 10003*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
 10004*                MOVE AL-UANON   TO  CASHA
 10005*                GO TO 1007-DEFAULT-AIG-CHECKNO.
 10006*
 10007*    IF PI-CASH NOT = 'Y' AND 'N'
 10008*         IF PI-OFFLINE = 'Y'  AND
 10009*            PI-ECHECKNO-CR = 'CR'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 190
* EL156.cbl
 10010*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
 10011*              MOVE AL-UANON     TO  CASHA
 10012*              GO TO 1007-DEFAULT-AIG-CHECKNO.
 10013*
 10014*    IF PI-CASH NOT = 'Y' AND 'N'
 10015*        IF PI-PMTTYPE = '5' OR '6'
 10016*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
 10017*            MOVE AL-UANON       TO  CASHA
 10018*            GO TO 1007-DEFAULT-AIG-CHECKNO.
 10019*
 10020*    IF PI-CASH NOT = 'Y' AND 'N'
 10021*       IF CL-ASSOCIATES = 'N' OR 'A'
 10022*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
 10023*           MOVE AL-UANON        TO  CASHA
 10024*       ELSE
 10025*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
 10026*           MOVE AL-UANON        TO  CASHA.
 10027*
 10028*    IF PI-PMTTYPE = '5' OR '6'
 10029*        IF PI-CASH = 'N'
 10030*            MOVE ER-0819        TO  EMI-ERROR
 10031*            MOVE AL-UANON       TO  CASHA
 10032*            MOVE -1             TO  CASHL
 10033*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10034*
 10035*    IF CL-ASSOCIATES = 'N' OR 'A'
 10036*       IF CASHI = 'N'
 10037*        MOVE ER-3537            TO  EMI-ERROR
 10038*        MOVE AL-UANON           TO  CASHA
 10039*        MOVE -1                 TO  CASHL
 10040*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10041
 10042 1007-DEFAULT-AIG-CHECKNO.
 10043
 10044     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
 10045         MOVE ER-3532            TO  EMI-ERROR
 10046         MOVE -1                 TO  PMTTYPEL
 10047         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10048**********************AIG LOGIC ENDS ***********************
 10049
 10050 1008-READ-CERT.
 10051
 10052     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 10053     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 10054     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 10055     MOVE CL-CERT-STATE          TO CERT-STATE.
 10056     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 10057     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 10058     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 10059     MOVE 'CERT'                 TO FILE-SWITCH.
 10060
 10061     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 10062
 10063     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10064        MOVE CM-LF-LOAN-EXPIRE-DT
 10065                                 TO WS-EXP-DT PI-EXP-DT
 10066                                    ws-extended-exp-dt
 10067     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 191
* EL156.cbl
 10068        MOVE CM-AH-LOAN-EXPIRE-DT
 10069                                 TO WS-EXP-DT PI-EXP-DT
 10070                                    ws-extended-exp-dt
 10071     end-if
 10072     MOVE '6'           TO DC-OPTION-CODE
 10073     if pi-dcc-product-code not = spaces
 10074        move cm-ah-benefit-cd    to pi-ah-benefit-cd
 10075        move cm-lf-benefit-cd    to pi-lf-benefit-cd
 10076        PERFORM 0900-GET-DDF-limits
 10077                                 THRU 0900-EXIT
 10078        IF PDEF-FOUND
 10079         AND CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 10080           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10081              (P1 > +8)
 10082              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 10083           END-PERFORM
 10084           IF P1 < +9
 10085              MOVE '6'           TO DC-OPTION-CODE
 10086              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10087              IF CL-NO-OF-EXTENSIONS NUMERIC
 10088               display ' 156 - no of ext ' CL-NO-OF-EXTENSIONS
 10089                 MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10090                                             PI-MAX-EXT
 10091              ELSE
 10092                 MOVE PD-MAX-EXTENSION (P1)
 10093                                 TO DC-ELAPSED-MONTHS
 10094              END-IF
 10095              PERFORM 9700-LINK-DATE-CONVERT
 10096                                 THRU 9700-EXIT
 10097              if no-conversion-error
 10098                 move dc-bin-date-2 to ws-extended-exp-dt
 10099              end-if
 10100           else
 10101              move er-1674       to emi-error
 10102              PERFORM 9900-ERROR-FORMAT
 10103                                 THRU 9900-EXIT
 10104           end-if
 10105        ELSE
 10106           IF CL-NO-OF-EXTENSIONS NUMERIC
 10107              MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10108                                          PI-MAX-EXT
 10109           ELSE
 10110              MOVE ZERO  TO DC-ELAPSED-MONTHS
 10111           END-IF
 10112           MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10113           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10114           if no-conversion-error
 10115              move dc-bin-date-2 to ws-extended-exp-dt
 10116           end-if
 10117        end-if
 10118     ELSE
 10119        IF CL-NO-OF-EXTENSIONS NUMERIC
 10120           MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10121                                       PI-MAX-EXT
 10122        ELSE
 10123           MOVE ZERO  TO DC-ELAPSED-MONTHS
 10124        END-IF
 10125        MOVE WS-EXP-DT     TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 192
* EL156.cbl
 10126        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10127        if no-conversion-error
 10128           move dc-bin-date-2 to ws-extended-exp-dt
 10129        end-if
 10130     end-if
 10131*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10132*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
 10133
 10134     IF CL-INCURRED-DT < CM-CERT-EFF-DT
 10135         MOVE ER-0458            TO EMI-ERROR
 10136         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10137
 10138     IF (CL-INCURRED-DT > WS-EXP-DT)
 10139        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
 10140        MOVE ER-1677             TO EMI-ERROR
 10141        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
 10142     END-IF
 10143     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
 10144     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
 10145         MOVE ER-0459            TO EMI-ERROR
 10146         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10147
 10148     IF CL-REPORTED-DT = LOW-VALUES
 10149        MOVE ER-0530             TO EMI-ERROR
 10150        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10151
 10152     IF PI-COMPANY-ID = 'NCL'
 10153        IF CM-CREDIT-INTERFACE-SW-1 = '2'
 10154            MOVE ER-0770            TO EMI-ERROR
 10155            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10156
 10157     IF PI-COMPANY-ID = 'NCL'
 10158        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
 10159            MOVE ER-0737            TO EMI-ERROR
 10160            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10161
 10162     IF CM-ENTRY-STATUS = 'D' OR 'V'
 10163         MOVE ER-0768            TO  EMI-ERROR
 10164         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10165
 10166     IF CM-CREDIT-INTERFACE-SW-1 = '4'
 10167         MOVE ER-0769            TO  EMI-ERROR
 10168         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10169
 10170     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10171         GO TO 1020-DO-LIFE-EDITS
 10172     ELSE
 10173         GO TO 1030-DO-AH-EDITS.
 10174
 10175 1010-GENERAL-ERROR.
 10176     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10177
 10178     IF EMI-MESSAGE-FORMATTED
 10179         MOVE -1                 TO PMTTYPEL.
 10180
 10181 1010-EXIT.
 10182     EXIT.
 10183
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 193
* EL156.cbl
 10185 1020-DO-LIFE-EDITS.
 10186     IF CM-LF-BENEFIT-CD = '00'
 10187         IF PI-PMTTYPE = '5' OR '6'
 10188             MOVE ER-0658        TO EMI-ERROR
 10189             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10190         ELSE
 10191            if (pi-company-id = 'DCC' or 'VPP')
 10192               and (pi-dcc-product-code not = spaces)
 10193               continue
 10194            else
 10195               MOVE ER-1775      TO EMI-ERROR
 10196               PERFORM 1040-PMTTYPE-ERROR
 10197                                 THRU 1040-EXIT
 10198            end-if
 10199         end-if
 10200     end-if
 10201
 10202     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10203     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10204         MOVE ER-0460            TO EMI-ERROR
 10205         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10206
 10207     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10208     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10209     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10210     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10211     MOVE '4'                    TO  CNTL-REC-TYPE.
 10212     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10213     MOVE 'BENE'                 TO  FILE-SWITCH.
 10214     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10215     IF NO-BENEFIT-FOUND
 10216         GO TO 1950-NOT-FOUND.
 10217
 10218     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10219
 10220     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10221       AND NOT CM-LF-LUMP-SUM-DISAB
 10222         IF PI-PMTTYPE = '4'
 10223             IF (PI-LIFE-OVERRIDE-L1 = 'P' OR
 10224                PI-LF-COVERAGE-TYPE = 'P')
 10225               AND NOT CM-LF-LUMP-SUM-DISAB
 10226                 NEXT SENTENCE
 10227             ELSE
 10228                 MOVE ER-0461        TO EMI-ERROR
 10229                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10230         ELSE
 10231            NEXT SENTENCE
 10232     ELSE
 10233         IF PI-PMTTYPE = '2'
 10234            IF NOT CM-O-B-COVERAGE
 10235              AND CM-LF-CURRENT-STATUS = '7'
 10236                MOVE ER-0462     TO EMI-ERROR
 10237                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10238
 10239     IF PI-PMTTYPE = '2'
 10240         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10241            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10242             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 194
* EL156.cbl
 10243             MOVE ER-0730            TO  EMI-ERROR
 10244             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10245             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10246
 10247     IF PI-PMTTYPE = '2'
 10248         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10249            PI-LF-COVERAGE-TYPE = 'P'
 10250             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10251                 MOVE ER-0462    TO  EMI-ERROR
 10252                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10253
 10254     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10255       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10256         MOVE ER-0466            TO EMI-ERROR
 10257         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10258
 10259     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10260         IF PI-PMTTYPE = '3'
 10261             MOVE 0436           TO EMI-ERROR
 10262             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10263             GO TO 1045-EDIT-PAYEE-ADDR
 10264         ELSE
 10265             GO TO 1045-EDIT-PAYEE-ADDR.
 10266
 10267     IF CL-CLAIM-TYPE = 'O'
 10268         IF PI-PMTTYPE = '1' OR '2'
 10269             MOVE ER-1930          TO EMI-ERROR
 10270             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10271         END-IF
 10272     ELSE
 10273     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10274        PI-LF-COVERAGE-TYPE = 'P'
 10275         IF PI-PMTTYPE = '3'
 10276             MOVE ER-0436          TO  EMI-ERROR
 10277             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10278         ELSE
 10279             NEXT SENTENCE
 10280     ELSE
 10281         IF PI-PMTTYPE = '1' OR '3'
 10282             MOVE ER-0436            TO EMI-ERROR
 10283             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10284*
 10285     IF PI-COMPANY-ID = 'CID' AND
 10286        CL-CERT-STATE = 'SC'  AND
 10287        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10288           MOVE ER-0879    TO  EMI-ERROR
 10289           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10290           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10291     END-IF.
 10292     IF PI-COMPANY-ID = 'AHL'
 10293        evaluate true
 10294           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10295              MOVE ER-0879       TO  EMI-ERROR
 10296              PERFORM 1040-PMTTYPE-ERROR
 10297                                 THRU 1040-EXIT
 10298              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10299           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10300                 '6D' OR '6H' OR '6R'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 195
* EL156.cbl
 10301              MOVE ER-0879       TO  EMI-ERROR
 10302              PERFORM 1040-PMTTYPE-ERROR
 10303                                 THRU 1040-EXIT
 10304              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10305           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10306              MOVE ER-0879       TO  EMI-ERROR
 10307              PERFORM 1040-PMTTYPE-ERROR
 10308                                 THRU 1040-EXIT
 10309              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10310        end-evaluate
 10311     END-IF
 10312     GO TO 1045-EDIT-PAYEE-ADDR.
 10313
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 196
* EL156.cbl
 10315 1030-DO-AH-EDITS.
 10316     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10317     IF CM-AH-BENEFIT-CD = '00'
 10318         IF PI-PMTTYPE = '5' OR '6'
 10319             MOVE ER-0658        TO EMI-ERROR
 10320             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10321         ELSE
 10322             MOVE ER-1775        TO EMI-ERROR
 10323             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10324
 10325     IF CL-TOTAL-PAID-AMT = ZEROS
 10326         IF PI-PMTTYPE = '4'
 10327             MOVE ER-0438        TO EMI-ERROR
 10328             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10329
 10330     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10331         IF PI-PMTTYPE = '3'
 10332             MOVE ER-0463        TO EMI-ERROR
 10333             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10334         ELSE
 10335             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10336              AND CM-LF-CURRENT-STATUS = '7'
 10337                 MOVE ER-0465    TO EMI-ERROR
 10338                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10339
 10340     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10341         IF PI-PMTTYPE = '3'
 10342             MOVE ER-0464        TO EMI-ERROR
 10343             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10344         ELSE
 10345             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10346                 MOVE ER-0469    TO EMI-ERROR
 10347                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10348
 10349     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10350         IF PI-PMTTYPE = '3'
 10351             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10352                 MOVE ER-0467    TO EMI-ERROR
 10353                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10354             ELSE
 10355                 NEXT SENTENCE
 10356         ELSE
 10357             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10358                 MOVE ER-0468    TO EMI-ERROR
 10359                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10360
 10361     IF PI-PMTTYPE = '2'
 10362        PERFORM WITH TEST AFTER
 10363         VARYING SUB FROM +1 BY +5
 10364          UNTIL SUB > +60
 10365            OR PI-PMTNOTE2(SUB:1) = 'F'
 10366            OR PI-PMTNOTE2(SUB:1) NOT > SPACES
 10367        END-PERFORM
 10368        IF PI-PMTNOTE2(SUB:1) NOT = 'F'
 10369           MOVE ER-3551    TO EMI-ERROR
 10370           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10371        END-IF
 10372     END-IF.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 197
* EL156.cbl
 10373     GO TO 1045-EDIT-PAYEE-ADDR.
 10374
 10375 1040-PMTTYPE-ERROR.
 10376     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10377
 10378     IF EMI-MESSAGE-FORMATTED
 10379         MOVE -1                 TO PMTTYPEL
 10380         MOVE AL-UABON           TO PMTTYPEA.
 10381
 10382 1040-EXIT.
 10383     EXIT.
 10384
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 198
* EL156.cbl
 10386 1045-EDIT-PAYEE-ADDR.
 10387
 10388     IF PI-OFFLINE = 'N' AND
 10389        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10390           < PI-PAYEE-SEQ-NUM)
 10391        OR
 10392         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10393         (PI-PAYEE-TYPE = 'B')                 AND
 10394         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10395        OR
 10396         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10397           < PI-PAYEE-SEQ-NUM)
 10398        OR
 10399         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10400           < PI-PAYEE-SEQ-NUM)
 10401        OR
 10402         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10403           < PI-PAYEE-SEQ-NUM)
 10404        OR
 10405         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10406           < PI-PAYEE-SEQ-NUM)
 10407        OR
 10408         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10409           < PI-PAYEE-SEQ-NUM))
 10410             MOVE ER-0437        TO EMI-ERROR
 10411             MOVE -1             TO PAYEEL
 10412             MOVE AL-UABON       TO PAYEEA
 10413             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10414
 10415     IF PI-OFFLINE    = 'N' AND
 10416        PI-PAYEE-TYPE = 'B' AND
 10417        PI-PAYEE-SEQ  = '0'
 10418         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10419         IF BENE-FOUND-SW = 'N'
 10420             MOVE ER-0437        TO EMI-ERROR
 10421             MOVE -1             TO PAYEEL
 10422             MOVE AL-UABON       TO PAYEEA
 10423             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10424
 10425     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10426        IF PI-OFFLINE    = 'N'  AND
 10427           PI-PAYEE-TYPE = 'B'  AND
 10428           PI-PAYEE-SEQ  = '9'
 10429             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10430             IF BENE-FOUND-SW = 'N'
 10431                MOVE ER-0437        TO EMI-ERROR
 10432                MOVE -1             TO PAYEEL
 10433                MOVE AL-UABON       TO PAYEEA
 10434                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10435
 10436*    IF PI-COMPANY-ID = 'CRI'
 10437*        IF CL-CLAIM-TYPE = 'L'
 10438*            MOVE 'N'                TO  WS-GROUPED
 10439*                                        PI-GROUPED
 10440*                                        GROUPEDI
 10441*            MOVE AL-UANON           TO  GROUPEDA
 10442*            GO TO 1050-EDIT-CHECK-NO
 10443*        ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 199
* EL156.cbl
 10444*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10445*            IF WS-GROUP-1 = 'C'
 10446*                NEXT SENTENCE
 10447*            ELSE
 10448*                MOVE 'N'            TO  WS-GROUPED
 10449*                                        PI-GROUPED
 10450*                                        GROUPEDI
 10451*                MOVE AL-UANON       TO  GROUPEDA
 10452*                GO TO 1050-EDIT-CHECK-NO.
 10453
 10454*     IF PI-GROUPED = 'Y'
 10455*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10456*           NEXT SENTENCE
 10457*        ELSE
 10458*           MOVE ER-0437        TO EMI-ERROR
 10459*           MOVE -1             TO PAYEEL
 10460**02180            MOVE AL-UABON       TO PAYEEA
 10461*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10462*
 10463*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10464*        (PI-GROUPED    = ' ')
 10465*        NEXT SENTENCE
 10466*     ELSE
 10467*
 10468     GO TO 1050-EDIT-CHECK-NO.
 10469*     IF PI-COMPANY-ID = 'CRI'
 10470*        MOVE 'N'           TO GROUPEDI
 10471*                              PI-GROUPED
 10472*                              WS-GROUPED
 10473*        MOVE AL-UANON      TO GROUPEDA.
 10474*
 10475*     IF PI-COMPANY-ID = 'CRI'
 10476*        IF PI-PAYEE-TYPE = 'B'
 10477*           IF BENE-FOUND-SW = 'Y'
 10478*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10479*                 MOVE 'Y'           TO GROUPEDI
 10480*                                       PI-GROUPED
 10481*                                       WS-GROUPED
 10482*                 MOVE AL-UANON      TO GROUPEDA
 10483*              ELSE
 10484*                 NEXT SENTENCE
 10485*           ELSE
 10486*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10487*              IF BENE-FOUND-SW = 'Y'
 10488*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10489*                    MOVE 'Y'      TO GROUPEDI
 10490*                                     PI-GROUPED
 10491*                                     WS-GROUPED
 10492*                    MOVE AL-UANON TO GROUPEDA.
 10493*
 10494
 10495     IF PI-COMPANY-ID NOT = 'CRI'
 10496        GO TO 1050-EDIT-CHECK-NO.
 10497
 10498*************** CRI CODE START ******************
 10499     IF PI-PAYEE-TYPE NOT = 'A'
 10500        GO TO 1050-EDIT-CHECK-NO.
 10501
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 200
* EL156.cbl
 10502     MOVE LOW-VALUES             TO ERACCT-KEY.
 10503     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10504     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10505     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10506     MOVE PI-STATE               TO ACCT-STATE.
 10507     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10508     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10509     MOVE 'ACCT'                 TO FILE-SWITCH.
 10510
 10511     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10512     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10513
 10514
 10515* EXEC CICS HANDLE CONDITION
 10516*         NOTFND   (1950-NOT-FOUND)
 10517*         ENDFILE  (1950-NOT-FOUND)
 10518*    END-EXEC.
 10519*    MOVE '"$I''                  ! ( #00010143' TO DFHEIV0
 10520     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10522     MOVE X'2820233030303130313433' TO DFHEIV0(25:11)
 10523     CALL 'kxdfhei1' USING DFHEIV0
 10524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10525
 10526
 10527
 10528* EXEC CICS STARTBR
 10529*         DATASET   ('ERACCT')
 10530*         RIDFLD    (ERACCT-KEY)
 10531*         GTEQ
 10532*    END-EXEC.
 10533     MOVE 'ERACCT' TO DFHEIV1
 10534     MOVE 0
 10535       TO DFHEIV11
 10536*    MOVE '&,         G          &   #00010148' TO DFHEIV0
 10537     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10538     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10539     MOVE X'2020233030303130313438' TO DFHEIV0(25:11)
 10540     CALL 'kxdfhei1' USING DFHEIV0,
 10541           DFHEIV1,
 10542           ERACCT-KEY,
 10543           DFHEIV99,
 10544           DFHEIV11,
 10545           DFHEIV99
 10546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10547
 10548
 10549 1046-READNEXT-ERACCT.
 10550
 10551
 10552* EXEC CICS READNEXT
 10553*         DATASET   ('ERACCT')
 10554*         RIDFLD    (ERACCT-KEY)
 10555*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10556*    END-EXEC.
 10557     MOVE 'ERACCT' TO DFHEIV1
 10558     MOVE 0
 10559       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 201
* EL156.cbl
 10560*    MOVE '&.S                   )   #00010156' TO DFHEIV0
 10561     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10562     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10563     MOVE X'2020233030303130313536' TO DFHEIV0(25:11)
 10564     CALL 'kxdfhei1' USING DFHEIV0,
 10565           DFHEIV1,
 10566           DFHEIV20,
 10567           DFHEIV99,
 10568           ERACCT-KEY,
 10569           DFHEIV99,
 10570           DFHEIV11,
 10571           DFHEIV99,
 10572           DFHEIV99
 10573     SET ADDRESS OF ACCOUNT-MASTER TO
 10574         DFHEIV20
 10575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10576
 10577
 10578     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10579        IF WS-ERACCT-HOLD-RECORD = SPACES
 10580           GO TO 1950-NOT-FOUND
 10581        ELSE
 10582           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10583           GO TO 1048-CONTINUE.
 10584
 10585     IF ACCT-EXP-DT = HIGH-VALUES
 10586        NEXT SENTENCE
 10587     ELSE
 10588        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10589        GO TO 1046-READNEXT-ERACCT.
 10590
 10591 1048-CONTINUE.
 10592
 10593*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10594*       MOVE 'Y'                 TO GROUPEDI
 10595*                                   PI-GROUPED
 10596*                                   WS-GROUPED
 10597*       MOVE AL-UANON            TO GROUPEDA.
 10598*************** CRI CODE END ******************
 10599
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 202
* EL156.cbl
 10601 1050-EDIT-CHECK-NO.
 10602
 10603     IF PI-OFFLINE = 'Y'
 10604         IF PI-ECHECKNO = SPACES
 10605              MOVE ER-0439        TO EMI-ERROR
 10606              GO TO 1090-CHECK-NO-ERROR
 10607           ELSE
 10608*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10609*           IF PI-ECHECKNO-N = 'N' AND
 10610*              PI-CASH       = 'Y'
 10611*                MOVE ER-3535        TO EMI-ERROR
 10612*                GO TO 1090-CHECK-NO-ERROR
 10613*             ELSE
 10614*                MOVE AL-UANON    TO CHECKNOA
 10615*                GO TO 1100-EDIT-HOLDTIL
 10616*         ELSE
 10617            MOVE AL-UANON    TO CHECKNOA
 10618            GO TO 1100-EDIT-HOLDTIL.
 10619
 10620     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10621     MOVE '6'                    TO CNTL-REC-TYPE.
 10622
 10623     IF CONTROL-IS-ACTUAL-CARRIER
 10624         MOVE PI-CARRIER         TO WS-CARR
 10625     ELSE
 10626         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10627
 10628     IF PI-COMPANY-ID = 'FIA'
 10629         MOVE PI-CARRIER         TO WS-CARR.
 10630
 10631     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10632     MOVE 0                      TO CNTL-SEQ-NO.
 10633     MOVE 'CARR'                 TO FILE-SWITCH.
 10634
 10635     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10636
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 203
* EL156.cbl
 10638     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10639         GO TO 1051-EDIT-CHECKNO-CONT.
 10640
 10641**********************AIG LOGIC STARTS**********************
 10642     IF PI-ECHECKNO = SPACES
 10643         IF CHECK-NO-MANUAL
 10644             MOVE ER-0441        TO EMI-ERROR
 10645             GO TO 1090-CHECK-NO-ERROR
 10646         ELSE
 10647             MOVE AL-UANOF       TO CHECKNOA
 10648             GO TO 1100-EDIT-HOLDTIL.
 10649
 10650     IF PI-ECHECKNO NOT = SPACES
 10651         IF CHECK-NO-MANUAL
 10652             MOVE AL-UANON       TO CHECKNOA
 10653             GO TO 1100-EDIT-HOLDTIL.
 10654
 10655     IF PI-ECHECKNO-CR = 'CR'
 10656        IF PI-OFFLINE = 'Y'
 10657            MOVE AL-UANON       TO CHECKNOA
 10658            GO TO 1100-EDIT-HOLDTIL
 10659        ELSE
 10660            MOVE ER-3534        TO EMI-ERROR
 10661            GO TO 1090-CHECK-NO-ERROR.
 10662
 10663     IF PI-ECHECKNO-N = 'N'
 10664        IF PI-CASH = 'N'
 10665            MOVE AL-UANON       TO CHECKNOA
 10666            GO TO 1100-EDIT-HOLDTIL
 10667        ELSE
 10668            MOVE ER-3535          TO EMI-ERROR
 10669            GO TO 1090-CHECK-NO-ERROR.
 10670
 10671     MOVE ER-0442        TO EMI-ERROR
 10672     GO TO 1090-CHECK-NO-ERROR.
 10673**********************AIG LOGIC ENDS************************
 10674
 10675 1051-EDIT-CHECKNO-CONT.
 10676
 10677     IF PI-COMPANY-ID = 'DMD'
 10678        IF PI-ECHECKNO NOT = SPACES
 10679           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10680              MOVE ER-0442        TO EMI-ERROR
 10681              GO TO 1090-CHECK-NO-ERROR
 10682            ELSE
 10683              GO TO 1100-EDIT-HOLDTIL
 10684          ELSE
 10685           GO TO 1100-EDIT-HOLDTIL.
 10686
 10687     IF PI-ECHECKNO = SPACES
 10688         IF CHECK-NO-MANUAL
 10689             MOVE ER-0441        TO EMI-ERROR
 10690             GO TO 1090-CHECK-NO-ERROR
 10691         ELSE
 10692             MOVE AL-UANOF       TO CHECKNOA
 10693             GO TO 1100-EDIT-HOLDTIL
 10694     ELSE
 10695         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 204
* EL156.cbl
 10696             MOVE AL-UANON       TO CHECKNOA
 10697             GO TO 1100-EDIT-HOLDTIL
 10698         ELSE
 10699             MOVE ER-0442        TO EMI-ERROR
 10700             GO TO 1090-CHECK-NO-ERROR.
 10701
 10702 1090-CHECK-NO-ERROR.
 10703     MOVE -1                     TO CHECKNOL.
 10704     MOVE AL-UABON               TO CHECKNOA.
 10705     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10706
 10707     GO TO 2000-EDIT-DONE.
 10708
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 205
* EL156.cbl
 10710 1100-EDIT-HOLDTIL.
 10711     MOVE ZERO TO WS-TOT-AMOUNT-PAID
 10712                  WS-UNPD-HOLD-UNTIL-DT
 10713     SET HOLD-UNTIL-CHK TO TRUE
 10714     MOVE CL-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 10715     PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10716     IF CL-TOTAL-PAID-AMT NOT = WS-TOT-AMOUNT-PAID
 10717         MOVE ER-3277            TO EMI-ERROR
 10718         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10719     END-IF
 10720
 10721     MOVE SPACE TO WS-HOLD-UNTIL-SW
 10722
 10723     MOVE AL-UANON               TO HOLDTILA.
 10724
 10725     IF PI-HOLDTIL = ZEROS
 10726        IF PI-OFFLINE = 'Y'
 10727           MOVE ER-0572          TO EMI-ERROR
 10728           GO TO 1105-HOLDTIL-ERROR
 10729        ELSE
 10730           GO TO 1110-EDIT-PAID-FROM.
 10731
 10732     MOVE '4'                    TO DC-OPTION-CODE.
 10733     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10734     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10735
 10736     IF DATE-CONVERSION-ERROR
 10737         MOVE ER-0446            TO EMI-ERROR
 10738         GO TO 1105-HOLDTIL-ERROR
 10739     END-IF
 10740     IF PI-OFFLINE = 'Y'
 10741        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10742           MOVE ER-0446            TO EMI-ERROR
 10743           GO TO 1105-HOLDTIL-ERROR
 10744        END-IF
 10745     END-IF
 10746
 10747     IF DC-BIN-DATE-1 < WS-UNPD-HOLD-UNTIL-DT
 10748        MOVE ER-3278          TO EMI-ERROR
 10749        GO TO 1105-HOLDTIL-ERROR
 10750     END-IF
 10751
 10752     IF PI-OFFLINE = 'Y'
 10753        GO TO 1110-EDIT-PAID-FROM.
 10754
 10755     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10756     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10757     MOVE '1'                    TO DC-OPTION-CODE.
 10758     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10759
 10760*    IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10761     IF DC-ELAPSED-DAYS > 60 OR DATE-CONVERSION-ERROR
 10762         MOVE ER-0447            TO EMI-ERROR
 10763         GO TO 1105-HOLDTIL-ERROR.
 10764
 10765     GO TO 1110-EDIT-PAID-FROM.
 10766
 10767 1105-HOLDTIL-ERROR.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 206
* EL156.cbl
 10768     MOVE -1                     TO HOLDTILL.
 10769     MOVE AL-UNBON               TO HOLDTILA.
 10770     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10771
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 207
* EL156.cbl
 10773 1110-EDIT-PAID-FROM.
 10774     MOVE AL-UANON               TO EPYFROMA.
 10775
 10776     IF PI-EPYFROM = ZEROS
 10777         GO TO 1120-CALCULATE-PAID-FROM.
 10778
 10779     IF PI-PMTTYPE = '5' OR '6'
 10780         MOVE ER-0448            TO EMI-ERROR
 10781         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10782         MOVE AL-UNBON           TO EPYFROMA
 10783         MOVE -1                 TO EPYFROML
 10784         GO TO 1150-EDIT-PAID-THRU.
 10785
 10786     MOVE '4'                    TO DC-OPTION-CODE.
 10787     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10788     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10789
 10790     IF DATE-CONVERSION-ERROR
 10791         MOVE ER-0449            TO EMI-ERROR
 10792         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10793         MOVE AL-UNBON           TO EPYFROMA
 10794         MOVE -1                 TO EPYFROML
 10795     ELSE
 10796         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10797
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 208
* EL156.cbl
 10799 1120-CALCULATE-PAID-FROM.
 10800     IF PI-PMTTYPE = '5' OR '6'
 10801         GO TO 1150-EDIT-PAID-THRU.
 10802
 10803*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10804*       IF PI-PMTTYPE = '4'
 10805*         GO TO 1150-EDIT-PAID-THRU.
 10806
 10807     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 10808         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10809         MOVE ' '                TO DC-OPTION-CODE
 10810         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10811         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10812         GO TO 1145-TEST-PAID-FROM.
 10813
 10814     IF PI-PMTTYPE = '4'
 10815        GO TO 1150-EDIT-PAID-THRU.
 10816
 10817     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10818     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10819     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10820     MOVE '5'                    TO CNTL-REC-TYPE.
 10821     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10822     MOVE 'BENE'                 TO FILE-SWITCH.
 10823
 10824     IF WS-BEN-CD = ZEROS
 10825         GO TO 1950-NOT-FOUND.
 10826
 10827     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10828
 10829     IF NO-BENEFIT-FOUND
 10830         GO TO 1950-NOT-FOUND.
 10831
 10832     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10833     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10834
 10835     IF PI-BEN-DAYS NOT NUMERIC
 10836        MOVE ZEROS               TO PI-BEN-DAYS.
 10837
 10838     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10839
 10840     IF WS-HOLD-UNTIL-DT > CL-PAID-THRU-DT
 10841         MOVE WS-HOLD-UNTIL-DT     TO DC-BIN-DATE-1
 10842         MOVE '6'                 TO DC-OPTION-CODE
 10843         MOVE +0                  TO DC-ELAPSED-MONTHS
 10844         MOVE +1                  TO DC-ELAPSED-DAYS
 10845         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10846         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10847         GO TO 1145-TEST-PAID-FROM.
 10848
 10849     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10850        (CL-TOTAL-PAID-AMT > ZEROS)
 10851         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10852         MOVE '6'                 TO DC-OPTION-CODE
 10853         MOVE +0                  TO DC-ELAPSED-MONTHS
 10854         MOVE +1                  TO DC-ELAPSED-DAYS
 10855         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10856         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 209
* EL156.cbl
 10857         GO TO 1145-TEST-PAID-FROM.
 10858
 10859******************************************************************
 10860****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10861****** SPECIAL ENTERED DATE.
 10862******************************************************************
 10863
 10864     IF PI-AIGFROM = ZEROS
 10865         GO TO 1130-CONTINUE-PAID-FROM.
 10866
 10867     MOVE AL-UANON TO AIGFROMA.
 10868
 10869     MOVE '4'                    TO DC-OPTION-CODE.
 10870     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10871     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10872
 10873     IF DATE-CONVERSION-ERROR
 10874         MOVE ER-0449            TO EMI-ERROR
 10875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10876         MOVE AL-UNBON           TO AIGFROMA
 10877         MOVE -1                 TO AIGFROML
 10878         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10879     ELSE
 10880         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10881         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10882
 10883     GO TO 1140-CONTINUE-PAID-FROM.
 10884
 10885 1130-CONTINUE-PAID-FROM.
 10886
 10887     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10888        (CL-TOTAL-PAID-AMT = ZEROS)
 10889           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10890
 10891 1140-CONTINUE-PAID-FROM.
 10892
 10893     IF PI-BEN-TYPE = 'R'
 10894         IF PI-BEN-DAYS = ZEROS
 10895             NEXT SENTENCE
 10896         ELSE
 10897         IF PI-COMPANY-ID NOT = 'DMD'
 10898             SUBTRACT 1 FROM PI-BEN-DAYS.
 10899
 10900     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10901
 10902     IF PI-COMPANY-ID = 'DMD'
 10903         MOVE -1                 TO DC-ELAPSED-DAYS
 10904         MOVE +0                 TO DC-ELAPSED-MONTHS
 10905         MOVE '6'                TO DC-OPTION-CODE
 10906         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10907         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10908         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10909                               REMAINDER DC-ELAPSED-DAYS
 10910      ELSE
 10911         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10912         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10913
 10914     MOVE '6'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 210
* EL156.cbl
 10915     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10916     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10917
 10918     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10919
 10920     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10921         MOVE ER-0541            TO EMI-ERROR
 10922         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10923         MOVE -1                 TO EPYFROML
 10924         MOVE AL-UNBON           TO EPYFROMA.
 10925
 10926     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10927        (PI-BENEFIT-SAVE = '60E')
 10928        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10929           (CL-TOTAL-PAID-AMT = ZEROS)
 10930             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10931             MOVE 30                  TO DC-ELAPSED-DAYS
 10932             MOVE +0                  TO DC-ELAPSED-MONTHS
 10933             MOVE '6'                 TO DC-OPTION-CODE
 10934             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10935
 10936     IF PI-BEN-TYPE = 'R'
 10937         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10938     ELSE
 10939         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10940         IF WS-SV-EPYFROM = LOW-VALUES
 10941            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10942
 10943     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10944         IF WS-USE-AIG-PAYFROM   OR
 10945            WS-AIG-RECALC-PAYFROM
 10946              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10947                                      DC-BIN-DATE-1
 10948              MOVE ' '            TO  DC-OPTION-CODE
 10949              MOVE +0             TO  DC-ELAPSED-MONTHS
 10950                                      DC-ELAPSED-DAYS
 10951              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10952              IF NO-CONVERSION-ERROR
 10953                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10954
 10955     IF PI-CPYFROM < CL-INCURRED-DT
 10956        MOVE -1                  TO EPYFROML
 10957        MOVE ER-3542             TO EMI-ERROR
 10958        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10959
 10960     IF CM-ENTRY-DT < CL-INCURRED-DT
 10961        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10962        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10963        MOVE +0                     TO DC-ELAPSED-DAYS
 10964        MOVE +0                     TO DC-ELAPSED-MONTHS
 10965        MOVE '1'                    TO DC-OPTION-CODE
 10966        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10967        ELSE
 10968        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10969
 10970     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10971         NEXT SENTENCE
 10972     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 211
* EL156.cbl
 10973         IF DC-ELAPSED-MONTHS < 2
 10974             MOVE ER-3255        TO EMI-ERROR
 10975             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10976
 10977 1145-TEST-PAID-FROM.
 10978     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10979         GO TO 1150-EDIT-PAID-THRU.
 10980
 10981     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10982         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10983         MOVE ' '                TO DC-OPTION-CODE
 10984         MOVE +0                 TO DC-ELAPSED-MONTHS
 10985                                    DC-ELAPSED-DAYS
 10986         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10987         IF NO-CONVERSION-ERROR
 10988             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10989         ELSE
 10990             MOVE SPACES             TO EMI-DATE-FIELD.
 10991
 10992     IF PI-HOLDTIL NOT = ZEROS
 10993        CONTINUE
 10994     ELSE
 10995     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10996         IF CL-TOTAL-PAID-AMT = ZEROS
 10997             MOVE ER-3543            TO EMI-ERROR
 10998             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10999             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11000             IF EMI-MESSAGE-FORMATTED
 11001                MOVE -1             TO EPYFROML
 11002                MOVE AL-UNBON       TO EPYFROMA
 11003             ELSE
 11004                NEXT SENTENCE
 11005         ELSE
 11006             MOVE ER-0452            TO EMI-ERROR
 11007             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 11008             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11009             IF EMI-MESSAGE-FORMATTED
 11010                MOVE -1             TO EPYFROML
 11011                MOVE AL-UNBON       TO EPYFROMA.
 11012
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 212
* EL156.cbl
 11014 1150-EDIT-PAID-THRU.
 11015
 11016     MOVE AL-UANON               TO EPYTHRUA.
 11017
 11018     IF PI-EPYTHRU = ZEROS
 11019*        IF PI-PMTTYPE = '4' OR '5' OR '6'
 11020         IF PI-PMTTYPE = '5' OR '6'
 11021           OR (CL-CLAIM-TYPE NOT = 'L' AND 'O'
 11022             AND PI-PMTTYPE = '4')
 11023             GO TO 1200-EDIT-FIND-TOLERANCES
 11024         ELSE
 11025            IF (PI-PMTTYPE = '3') OR (PI-PMTTYPE = '4') OR
 11026               (PI-PMTTYPE = '2' AND
 11027                 CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')
 11028               GO TO 1152-CHECK-TYPE
 11029            ELSE
 11030               MOVE ER-0473      TO EMI-ERROR
 11031               GO TO 1170-PAID-THRU-FATAL-ERROR
 11032     ELSE
 11033         IF PI-PMTTYPE = '5' OR '6'
 11034             MOVE ER-0474        TO EMI-ERROR
 11035             GO TO 1170-PAID-THRU-FATAL-ERROR.
 11036
 11037     MOVE '4'                    TO DC-OPTION-CODE.
 11038     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 11039     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11040
 11041     IF DATE-CONVERSION-ERROR
 11042         MOVE ER-0475            TO EMI-ERROR
 11043         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11044
 11045     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 11046
 11047     IF PI-COMPANY-ID = 'DMD'
 11048         IF PI-PMTTYPE NOT = '2'
 11049                 AND
 11050            WS-EXP-DT > WS-SV-EPYTHRU
 11051             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 11052             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 11053             MOVE '1'              TO DC-OPTION-CODE
 11054             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11055             IF DATE-CONVERSION-ERROR
 11056                 MOVE ER-0944      TO EMI-ERROR
 11057                 GO TO 1170-PAID-THRU-FATAL-ERROR
 11058             ELSE
 11059                 IF DC-ELAPSED-MONTHS = ZEROS AND
 11060                    DC-ELAPSED-DAYS   = 1
 11061                     MOVE ER-0945  TO EMI-ERROR
 11062                     MOVE -1       TO EPYTHRUL
 11063                     MOVE AL-UABON TO EPYTHRUA
 11064                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11065
 11066     IF PI-PMTTYPE = '4'
 11067         NEXT SENTENCE
 11068     ELSE
 11069         IF WS-SV-EPYTHRU = WS-EXP-DT
 11070             IF PI-PMTTYPE NOT = '2' AND '3'
 11071                 MOVE ER-3541    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 213
* EL156.cbl
 11072                 MOVE -1         TO PMTTYPEL
 11073                 MOVE AL-UABON   TO PMTTYPEA
 11074                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11075
 11076     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 11077         MOVE ER-0501            TO EMI-ERROR
 11078         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11079
 11080     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 11081        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 11082*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11083*              MOVE ER-0540         TO EMI-ERROR
 11084*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11085*              MOVE -1              TO EPYTHRUL
 11086*              MOVE AL-UNBON        TO EPYTHRUA
 11087*          ELSE
 11088*          IF PI-COMPANY-ID = 'DMD'
 11089*              MOVE ER-7540         TO EMI-ERROR
 11090*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11091*              MOVE -1              TO EPYTHRUL
 11092*              MOVE AL-UNBON        TO EPYTHRUA
 11093*          ELSE
 11094               IF PI-PMTTYPE NOT = '2' AND '3'
 11095                  IF PI-COMPANY-ID = '???'
 11096                      MOVE ER-7540  TO EMI-ERROR
 11097                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11098                      MOVE -1       TO EPYTHRUL
 11099                      MOVE AL-UNBON TO EPYTHRUA
 11100                  ELSE
 11101                      MOVE ER-0540  TO EMI-ERROR
 11102                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11103                      MOVE -1       TO EPYTHRUL
 11104                      MOVE AL-UNBON TO EPYTHRUA.
 11105
 11106     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11107            OR
 11108        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 11109         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11110            OR
 11111        (PI-CPYFROM NOT = LOW-VALUES AND
 11112         PI-CPYFROM < CL-PAID-THRU-DT)
 11113        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT
 11114     ELSE
 11115     IF WS-SV-EPYTHRU NOT = LOW-VALUES
 11116       AND WS-SV-EPYFROM NOT = LOW-VALUES
 11117        SET CHECK-ALL-PMTS TO TRUE
 11118        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 11119
 11120     IF PI-HOLDTIL = ZEROS
 11121       AND UNPAID-HOLD-UNTIL-EXISTS
 11122       AND NOT DUPE-VOID-PMT-EXISTS
 11123        MOVE ER-3276    TO EMI-ERROR
 11124        MOVE -1         TO HOLDTILL
 11125        MOVE AL-UABON   TO HOLDTILA
 11126        GO TO 1170-PAID-THRU-FATAL-ERROR
 11127     END-IF.
 11128
 11129 1152-CHECK-TYPE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 214
* EL156.cbl
 11130     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11131        OR (PI-PMTTYPE = '5' OR '6')
 11132         GO TO 1160-EDIT-PAID-THRU-AH.
 11133
 11134 1155-EDIT-PAID-THRU-LIFE.
 11135     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11136     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11137     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11138     MOVE '4'                    TO CNTL-REC-TYPE.
 11139     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11140     MOVE 'BENE'                 TO FILE-SWITCH.
 11141
 11142     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11143
 11144     IF NO-BENEFIT-FOUND
 11145         GO TO 1950-NOT-FOUND.
 11146
 11147     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 11148
 11149     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 11150
 11151     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11152        PI-LF-COVERAGE-TYPE = 'P'
 11153         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 11154         GO TO 1200-EDIT-FIND-TOLERANCES.
 11155
 11156     IF PI-EPYTHRU = ZEROS
 11157        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 11158
 11159     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11160         MOVE ER-0476            TO EMI-ERROR
 11161         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11162
 11163     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 11164*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 11165     move cl-critical-period    to dc-elapsed-months
 11166     MOVE +0                    TO DC-ELAPSED-DAYS.
 11167     MOVE '6'                   TO DC-OPTION-CODE.
 11168     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11169
 11170     IF (NO-CONVERSION-ERROR AND
 11171         WS-SPECIAL-CALC-CD = 'C')
 11172        IF CL-INCURRED-DT > DC-BIN-DATE-2
 11173            MOVE ER-0657 TO EMI-ERROR
 11174            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11175
 11176     IF PI-COMPANY-ID = 'NCL'
 11177         IF WS-SPECIAL-CALC-CD = 'C' AND
 11178            cl-critical-period = zeros
 11179*           CM-LF-CRITICAL-PERIOD = +0
 11180             MOVE ER-0844       TO EMI-ERROR
 11181             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11182
 11183     GO TO 1200-EDIT-FIND-TOLERANCES.
 11184
 11185 1160-EDIT-PAID-THRU-AH.
 11186     IF PI-EPYTHRU = ZEROS
 11187        MOVE WS-EXP-DT           TO PI-CPYTHRU
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 215
* EL156.cbl
 11188                                    WS-SV-EPYTHRU
 11189     ELSE
 11190        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 11191
 11192     IF WS-SV-EPYTHRU < PI-CPYFROM
 11193         MOVE ER-0508            TO EMI-ERROR
 11194         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11195
 11196     perform 7975-read-acct      thru 7975-exit
 11197     move zeros                  to pi-max-ext
 11198     if PI-DCC-PRODUCT-CODE NOT = SPACES
 11199        PERFORM 0900-GET-DDF-LIMITS
 11200                                 THRU 0900-EXIT
 11201        IF PDEF-FOUND
 11202           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11203              (P1 > +8)
 11204              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11205           END-PERFORM
 11206           IF P1 < +9
 11207              MOVE PD-MAX-extension (P1)
 11208                                 TO pi-max-ext
 11209           else
 11210              move er-1674       to emi-error
 11211              PERFORM 9900-ERROR-FORMAT
 11212                                 THRU 9900-EXIT
 11213           END-IF
 11214        else
 11215           move er-1672          to emi-error
 11216           PERFORM 9900-ERROR-FORMAT
 11217                                 THRU 9900-EXIT
 11218        END-IF
 11219     end-if
 11220     move spaces                 to pi-max-ext-used
 11221     IF PI-PMTTYPE = '3'
 11222        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11223        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11224           MOVE ER-0477          TO EMI-ERROR
 11225           PERFORM 1165-PAID-THRU-ERROR
 11226                                 THRU 1165-EXIT
 11227        ELSE
 11228           continue
 11229        end-if
 11230     ELSE
 11231        IF WS-SV-EPYTHRU > WS-EXP-DT
 11232         IF PI-DCC-PRODUCT-CODE NOT > SPACES
 11233           move ws-exp-dt        to dc-bin-date-1
 11234           move ws-sv-epythru    to dc-bin-date-2
 11235           MOVE '1'              TO DC-OPTION-CODE
 11236           MOVE +0               TO DC-ELAPSED-DAYS
 11237                                    DC-ELAPSED-MONTHS
 11238           PERFORM 9700-LINK-DATE-CONVERT
 11239                                 THRU 9700-EXIT
 11240           if no-conversion-error
 11241              if dc-elapsed-days > zeros
 11242                 add +1 to dc-elapsed-months
 11243              end-if
 11244              if dc-elapsed-months > pi-max-ext
 11245                 MOVE ER-0557    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 216
* EL156.cbl
 11246                 PERFORM 1165-PAID-THRU-ERROR
 11247                                 THRU 1165-EXIT
 11248              else
 11249                 move 'Y'        to pi-max-ext-used
 11250                 move er-1670    to emi-error
 11251                 perform 9900-error-format
 11252                                 thru 9900-exit
 11253              end-if
 11254           end-if
 11255         ELSE
 11256            MOVE ER-0557    TO EMI-ERROR
 11257            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 11258         END-IF
 11259        end-if
 11260     end-if
 11261
 11262     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 11263         PI-PMTTYPE NOT = '3'
 11264         MOVE ER-0541        TO EMI-ERROR
 11265         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11266
 11267     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 11268        (PI-PMTTYPE NOT = '3')
 11269         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 11270             MOVE ER-0478        TO EMI-ERROR
 11271             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11272
 11273     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11274        (PI-PMTTYPE NOT = '4')
 11275         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11276             MOVE ER-0479        TO EMI-ERROR
 11277             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11278
 11279     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11280         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11281             MOVE ER-0545        TO EMI-ERROR
 11282             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11283
 11284     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11285         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11286             MOVE ER-0481        TO EMI-ERROR
 11287             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11288
 11289*    IF PI-COMPANY-ID = 'NCL'
 11290*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11291*           CM-AH-CRITICAL-PERIOD = +0
 11292*            MOVE ER-0844        TO  EMI-ERROR
 11293*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11294
 11295*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11296     if (cl-critical-period = zeros)
 11297        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11298          GO TO 1200-EDIT-FIND-TOLERANCES.
 11299
 11300     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11301     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11302     MOVE '1'        TO DC-OPTION-CODE.
 11303     MOVE +0         TO DC-ELAPSED-DAYS
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 217
* EL156.cbl
 11304                        DC-ELAPSED-MONTHS.
 11305     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11306
 11307*    IF NO-CONVERSION-ERROR
 11308*       COMPUTE ws-benefits-paid =
 11309*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11310*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11311*           MOVE ER-0657 TO EMI-ERROR
 11312*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11313
 11314     GO TO 1200-EDIT-FIND-TOLERANCES.
 11315
 11316 1165-PAID-THRU-ERROR.
 11317     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11318
 11319     IF EMI-MESSAGE-FORMATTED
 11320         MOVE -1                 TO EPYTHRUL
 11321         MOVE AL-UNBON           TO EPYTHRUA.
 11322
 11323 1165-EXIT.
 11324     EXIT.
 11325
 11326 1166-CHECK-ALL-TRLRS.
 11327
 11328     IF PI-PMTTYPE = '4'
 11329        GO TO 1166-TRLR-EXIT.
 11330
 11331     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11332
 11333     IF HOLD-UNTIL-CHK
 11334        CONTINUE
 11335     ELSE
 11336     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11337        WS-SV-EPYFROM = LOW-VALUES
 11338          GO TO 1166-END-CHECK.
 11339
 11340
 11341* EXEC CICS HANDLE CONDITION
 11342*        ENDFILE   (1166-END-CHECK)
 11343*        NOTFND    (1166-END-CHECK)
 11344*    END-EXEC.
 11345*    MOVE '"$''I                  ! ) #00010924' TO DFHEIV0
 11346     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11347     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11348     MOVE X'2920233030303130393234' TO DFHEIV0(25:11)
 11349     CALL 'kxdfhei1' USING DFHEIV0
 11350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11351
 11352
 11353     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11354     MOVE +100                   TO TRLR-SEQ-NO.
 11355
 11356
 11357* EXEC CICS STARTBR
 11358*         DATASET    ('ELTRLR')
 11359*         RIDFLD     (ELTRLR-KEY)
 11360*         GTEQ
 11361*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 218
* EL156.cbl
 11362     MOVE 'ELTRLR' TO DFHEIV1
 11363     MOVE 0
 11364       TO DFHEIV11
 11365*    MOVE '&,         G          &   #00010932' TO DFHEIV0
 11366     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11367     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11368     MOVE X'2020233030303130393332' TO DFHEIV0(25:11)
 11369     CALL 'kxdfhei1' USING DFHEIV0,
 11370           DFHEIV1,
 11371           ELTRLR-KEY,
 11372           DFHEIV99,
 11373           DFHEIV11,
 11374           DFHEIV99
 11375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11376
 11377
 11378     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11379
 11380 1166-READ-TRLR-NEXT.
 11381
 11382
 11383* EXEC CICS READNEXT
 11384*         DATASET    ('ELTRLR')
 11385*         RIDFLD     (ELTRLR-KEY)
 11386*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11387*    END-EXEC.
 11388     MOVE 'ELTRLR' TO DFHEIV1
 11389     MOVE 0
 11390       TO DFHEIV11
 11391*    MOVE '&.S                   )   #00010942' TO DFHEIV0
 11392     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11393     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11394     MOVE X'2020233030303130393432' TO DFHEIV0(25:11)
 11395     CALL 'kxdfhei1' USING DFHEIV0,
 11396           DFHEIV1,
 11397           DFHEIV20,
 11398           DFHEIV99,
 11399           ELTRLR-KEY,
 11400           DFHEIV99,
 11401           DFHEIV11,
 11402           DFHEIV99,
 11403           DFHEIV99
 11404     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11405         DFHEIV20
 11406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11407
 11408
 11409     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11410        TRLR-CARRIER  = MSTR-CARRIER  AND
 11411        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11412        TRLR-CERT-NO  = MSTR-CERT-NO
 11413          NEXT SENTENCE
 11414      ELSE
 11415          GO TO 1166-END-CHECK.
 11416
 11417* **  BYPASS ALL NON-PAYMENT TRAILERS
 11418
 11419     IF AT-TRAILER-TYPE = '2'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 219
* EL156.cbl
 11420        NEXT SENTENCE
 11421     ELSE
 11422        GO TO 1166-READ-TRLR-NEXT.
 11423
 11424* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11425
 11426     IF AT-PAYMENT-TYPE = '1' OR '2'
 11427        NEXT SENTENCE
 11428     ELSE
 11429        GO TO 1166-READ-TRLR-NEXT.
 11430
 11431     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11432        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11433          GO TO 1166-READ-TRLR-NEXT.
 11434* **  BYPASS ALL VOID PAYMENTS
 11435
 11436     IF AT-VOID-DT NOT = LOW-VALUES
 11437        IF WS-SV-EPYTHRU = AT-PAID-THRU-DT
 11438          AND WS-SV-EPYFROM = AT-PAID-FROM-DT
 11439            SET DUPE-VOID-PMT-EXISTS TO TRUE
 11440        END-IF
 11441        GO TO 1166-READ-TRLR-NEXT.
 11442
 11443     IF HOLD-UNTIL-CHK
 11444        IF AT-PAID-THRU-DT > WS-HOLD-UNTIL-DT
 11445          AND AT-TO-BE-WRITTEN-DT > ZERO
 11446           MOVE AT-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 11447        END-IF
 11448        IF AT-TO-BE-WRITTEN-DT > ZERO
 11449          AND AT-CHECK-WRITTEN-DT = LOW-VALUES
 11450           SET UNPAID-HOLD-UNTIL-EXISTS TO TRUE
 11451           IF AT-TO-BE-WRITTEN-DT > WS-UNPD-HOLD-UNTIL-DT
 11452              MOVE AT-TO-BE-WRITTEN-DT TO WS-UNPD-HOLD-UNTIL-DT
 11453           END-IF
 11454        END-IF
 11455        IF AT-AMOUNT-PAID NUMERIC
 11456          AND (AT-CHECK-WRITTEN-DT > LOW-VALUES
 11457             OR AT-TO-BE-WRITTEN-DT < ZERO)
 11458          AND AT-PAYMENT-TYPE  <= '4'
 11459           ADD AT-AMOUNT-PAID TO WS-TOT-AMOUNT-PAID
 11460        END-IF
 11461     END-IF
 11462
 11463     IF HOLD-UNTIL-CHK
 11464        CONTINUE
 11465     ELSE
 11466     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11467         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11468            OR
 11469        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11470         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 11471        NEXT SENTENCE
 11472     ELSE
 11473         IF WS-SV-EPYTHRU = AT-PAID-THRU-DT
 11474          AND WS-SV-EPYFROM = AT-PAID-FROM-DT
 11475             MOVE ER-3279            TO EMI-ERROR
 11476             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11477             MOVE -1                 TO EPYTHRUL
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 220
* EL156.cbl
 11478             MOVE AL-UNBON           TO EPYTHRUA
 11479         ELSE
 11480         IF CL-TOTAL-PAID-AMT > ZEROS
 11481           AND NOT CHECK-ALL-PMTS
 11482             MOVE ER-0502            TO EMI-ERROR
 11483             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11484             MOVE -1                 TO EPYTHRUL
 11485             MOVE AL-UNBON           TO EPYTHRUA.
 11486
 11487     GO TO 1166-READ-TRLR-NEXT.
 11488
 11489 1166-END-CHECK.
 11490
 11491     IF WS-BROWSE-TRLR-SW = 'Y'
 11492
 11493* EXEC CICS ENDBR
 11494*            DATASET   ('ELTRLR')
 11495*       END-EXEC.
 11496     MOVE 'ELTRLR' TO DFHEIV1
 11497     MOVE 0
 11498       TO DFHEIV11
 11499*    MOVE '&2                    $   #00011031' TO DFHEIV0
 11500     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11501     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11502     MOVE X'2020233030303131303331' TO DFHEIV0(25:11)
 11503     CALL 'kxdfhei1' USING DFHEIV0,
 11504           DFHEIV1,
 11505           DFHEIV11,
 11506           DFHEIV99
 11507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11508
 11509
 11510     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11511
 11512 1166-TRLR-EXIT.
 11513     EXIT.
 11514
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 221
* EL156.cbl
 11516 1170-PAID-THRU-FATAL-ERROR.
 11517     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11518
 11519     MOVE -1                     TO EPYTHRUL.
 11520     MOVE AL-UNBON               TO EPYTHRUA.
 11521
 11522 1200-EDIT-FIND-TOLERANCES.
 11523
 11524* EXEC CICS HANDLE CONDITION
 11525*        ENDFILE(1950-NOT-FOUND)
 11526*        NOTFND (1950-NOT-FOUND)
 11527*    END-EXEC.
 11528*    MOVE '"$''I                  ! * #00011048' TO DFHEIV0
 11529     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11530     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11531     MOVE X'2A20233030303131303438' TO DFHEIV0(25:11)
 11532     CALL 'kxdfhei1' USING DFHEIV0
 11533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11534
 11535
 11536     IF PI-PROCESSOR-ID = 'LGXX'
 11537        GO TO 1240-FIND-ACCT-TOLERANCES.
 11538
 11539     MOVE 'N'                    TO FOUND-TOL-SW.
 11540     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11541     MOVE '2'                    TO CNTL-REC-TYPE.
 11542     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11543     MOVE +0                     TO CNTL-SEQ-NO.
 11544     MOVE 'PROC'                 TO FILE-SWITCH.
 11545
 11546     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11547
 11548     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11549     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11550                                    PI-MAX-PMT-TOL.
 11551     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11552
 11553     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11554         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11555
 11556     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11557     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11558                                    PI-MAX-LF-PMT-TOL.
 11559
 11560     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11561         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11562
 11563     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11564                                    PI-MAX-EXP-PMT.
 11565
 11566 1240-FIND-ACCT-TOLERANCES.
 11567
 11568     IF WS-PMT-TOL NOT = +0
 11569         MOVE 'Y'                TO FOUND-TOL-SW.
 11570
 11571     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11572         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11573         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 222
* EL156.cbl
 11574         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11575         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11576         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11577         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11578     ELSE
 11579         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11580         MOVE PI-CARRIER             TO ACCT-CARRIER
 11581         MOVE PI-GROUPING            TO ACCT-GROUPING
 11582         MOVE PI-STATE               TO ACCT-STATE
 11583         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11584         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11585
 11586     MOVE 'ACCT'                 TO FILE-SWITCH.
 11587
 11588     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11589     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11590
 11591
 11592* EXEC CICS HANDLE CONDITION
 11593*         NOTFND   (1950-NOT-FOUND)
 11594*         ENDFILE  (1950-NOT-FOUND)
 11595*    END-EXEC.
 11596*    MOVE '"$I''                  ! + #00011108' TO DFHEIV0
 11597     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11599     MOVE X'2B20233030303131313038' TO DFHEIV0(25:11)
 11600     CALL 'kxdfhei1' USING DFHEIV0
 11601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11602
 11603
 11604
 11605* EXEC CICS STARTBR
 11606*        DATASET('ERACCT')
 11607*        RIDFLD (ERACCT-KEY)
 11608*        GTEQ
 11609*    END-EXEC.
 11610     MOVE 'ERACCT' TO DFHEIV1
 11611     MOVE 0
 11612       TO DFHEIV11
 11613*    MOVE '&,         G          &   #00011113' TO DFHEIV0
 11614     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11615     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11616     MOVE X'2020233030303131313133' TO DFHEIV0(25:11)
 11617     CALL 'kxdfhei1' USING DFHEIV0,
 11618           DFHEIV1,
 11619           ERACCT-KEY,
 11620           DFHEIV99,
 11621           DFHEIV11,
 11622           DFHEIV99
 11623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11624
 11625
 11626 1245-FIND-ACCT-TOLERANCES-LOOP.
 11627
 11628
 11629* EXEC CICS READNEXT
 11630*        DATASET('ERACCT')
 11631*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 223
* EL156.cbl
 11632*        RIDFLD (ERACCT-KEY)
 11633*    END-EXEC.
 11634     MOVE 'ERACCT' TO DFHEIV1
 11635     MOVE 0
 11636       TO DFHEIV11
 11637*    MOVE '&.S                   )   #00011121' TO DFHEIV0
 11638     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11639     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11640     MOVE X'2020233030303131313231' TO DFHEIV0(25:11)
 11641     CALL 'kxdfhei1' USING DFHEIV0,
 11642           DFHEIV1,
 11643           DFHEIV20,
 11644           DFHEIV99,
 11645           ERACCT-KEY,
 11646           DFHEIV99,
 11647           DFHEIV11,
 11648           DFHEIV99,
 11649           DFHEIV99
 11650     SET ADDRESS OF ACCOUNT-MASTER TO
 11651         DFHEIV20
 11652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11653
 11654
 11655     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11656        IF WS-ERACCT-HOLD-RECORD = SPACES
 11657           GO TO 1950-NOT-FOUND
 11658        ELSE
 11659           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11660           GO TO 1250-CONTINUE.
 11661
 11662     IF ACCT-EXP-DT = HIGH-VALUES
 11663        NEXT SENTENCE
 11664     ELSE
 11665        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11666        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11667
 11668 1250-CONTINUE.
 11669
 11670     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11671
 11672     IF FOUND-TOL-SW = 'N'
 11673         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11674
 11675********* 1260-FIND-STATE-TOLERANCES.
 11676
 11677     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11678     MOVE PI-STATE               TO WS-ST-ACCESS.
 11679     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11680     MOVE '3'                    TO CNTL-REC-TYPE.
 11681     MOVE +0                     TO CNTL-SEQ-NO.
 11682     MOVE 'STAT'                 TO FILE-SWITCH.
 11683
 11684     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11685
 11686     IF WS-PMT-TOL = +0
 11687         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11688
 11689     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 224
* EL156.cbl
 11690     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11691     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11692     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11693     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11694
 11695****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11696****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11697     IF PI-PAYEE-TYPE <> 'B'
 11698           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11699     END-IF.
 11700
 11701     IF PI-PMTTYPE      = '2'  AND
 11702        PI-SPLIT-PMT-SW = 'Y'  AND
 11703        (CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1 OR 'O')
 11704          MOVE ER-3530                TO EMI-ERROR
 11705          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11706
 11707********* 1280-FIND-BENEFIT-TOLERANCES.
 11708
 11709     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11710        OR (PI-PMTTYPE = '5' OR '6')
 11711         GO TO 1300-FIND-CARR-TOLERANCES.
 11712
 11713     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11714     MOVE '4'                    TO CNTL-REC-TYPE.
 11715     MOVE +0                     TO CNTL-SEQ-NO.
 11716     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11717     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11718     MOVE 'BENE'                 TO FILE-SWITCH.
 11719
 11720     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11721
 11722     IF NO-BENEFIT-FOUND
 11723         GO TO 1950-NOT-FOUND.
 11724
 11725     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11726     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11727     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11728
 11729
 11730* EXEC CICS HANDLE CONDITION
 11731*        NOTFND(1950-NOT-FOUND)
 11732*    END-EXEC.
 11733*    MOVE '"$I                   ! , #00011201' TO DFHEIV0
 11734     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11735     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11736     MOVE X'2C20233030303131323031' TO DFHEIV0(25:11)
 11737     CALL 'kxdfhei1' USING DFHEIV0
 11738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11739
 11740
 11741 1300-FIND-CARR-TOLERANCES.
 11742     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11743     MOVE '6'                    TO CNTL-REC-TYPE.
 11744
 11745     IF CONTROL-IS-ACTUAL-CARRIER
 11746         MOVE PI-CARRIER               TO WS-CARR
 11747     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 225
* EL156.cbl
 11748         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11749
 11750     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11751     MOVE +0                     TO CNTL-SEQ-NO.
 11752     MOVE 'CARR'                 TO FILE-SWITCH.
 11753
 11754     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11755
 11756     IF WS-DAYS-TOL = +0
 11757         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11758
 11759     IF WS-PMT-TOL = +0
 11760         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11761
 11762     IF WS-MAX-DAYS-TOL = +0
 11763         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11764
 11765     IF WS-MAX-PMT-TOL = +0
 11766         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11767                                    PI-MAX-PMT-TOL.
 11768
 11769     IF WS-MAX-LF-PMT-TOL = +0
 11770        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11771                                    PI-MAX-LF-PMT-TOL.
 11772
 11773     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11774
 11775********* 1320-FIND-COMP-TOLERANCES.
 11776
 11777     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11778     MOVE '1'                    TO CNTL-REC-TYPE.
 11779     MOVE SPACES                 TO CNTL-ACCESS.
 11780     MOVE +0                     TO CNTL-SEQ-NO.
 11781     MOVE 'COMP'                 TO FILE-SWITCH.
 11782
 11783     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11784
 11785     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11786     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11787
 11788     IF WS-PMT-TOL NOT = +0
 11789        IF WS-TOL-SEVERITY NOT = ' '
 11790         GO TO 1360-EDIT-DAYS.
 11791
 11792     IF WS-PMT-TOL = +0
 11793         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11794
 11795     IF WS-TOL-SEVERITY = ' '
 11796         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11797
 11798 1360-EDIT-DAYS.
 11799     IF PI-PMTTYPE NOT = '4'
 11800        IF PI-EDAYS NEGATIVE OR
 11801           PI-EPYAMT NEGATIVE
 11802          MOVE ER-0513             TO EMI-ERROR
 11803          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11804          MOVE -1                  TO PMTTYPEL.
 11805
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 226
* EL156.cbl
 11806     IF PI-PMTTYPE = '5' OR '6'
 11807        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11808
 11809     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11810        IF PI-PMTTYPE = '4'
 11811          MOVE PI-EDAYS          TO PI-CDAYS.
 11812
 11813     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 11814         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11815
 11816     IF PI-PMTTYPE = '4'
 11817        MOVE PI-EDAYS            TO PI-CDAYS
 11818        GO TO 1400-EDIT-PAYMENT.
 11819
 11820     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11821        GO TO 1500-EDIT-EXPENSES.
 11822
 11823*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11824*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11825*          CM-AH-BENEFIT-CD = '23'              AND
 11826*          CL-CERT-STATE    = '04'              AND
 11827*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11828*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11829*            GO TO 1362-CHECK-MAX-DAYS.
 11830
 11831     IF PI-EDAYS = ZEROS
 11832*        IF PI-COMPANY-ID = 'DMD'
 11833*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11834*            MOVE -1             TO DC-ELAPSED-DAYS
 11835*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11836*            MOVE '6'            TO DC-OPTION-CODE
 11837*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11838*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11839*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11840*            MOVE '1'            TO DC-OPTION-CODE
 11841*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11842*            IF NO-CONVERSION-ERROR
 11843*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11844*                                 + DC-ODD-DAYS-OVER
 11845*               MOVE 6           TO EDAYSL
 11846*               MOVE AL-UNNON    TO EDAYSA
 11847*            ELSE
 11848*                NEXT SENTENCE
 11849*       ELSE
 11850            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11851            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11852            MOVE '1'             TO DC-OPTION-CODE
 11853            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11854            IF NO-CONVERSION-ERROR
 11855                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11856                ADD 1                 TO PI-EDAYS
 11857                MOVE AL-UNNON         TO EDAYSA.
 11858
 11859*    IF PI-COMPANY-ID = 'DMD'
 11860*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11861*        MOVE -1                 TO DC-ELAPSED-DAYS
 11862*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11863*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 227
* EL156.cbl
 11864*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11865*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11866*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11867*        MOVE '1'                TO DC-OPTION-CODE
 11868*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11869*    ELSE
 11870         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11871         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11872         MOVE '1'                TO DC-OPTION-CODE.
 11873         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11874
 11875     IF NO-CONVERSION-ERROR
 11876        IF PI-COMPANY-ID = 'DMD'
 11877            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11878                             + DC-ODD-DAYS-OVER
 11879        ELSE
 11880            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11881            ADD 1                TO PI-CDAYS.
 11882
 11883     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11884        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11885        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11886
 11887     IF PI-EDAYS NOT NUMERIC
 11888         MOVE ER-0491            TO EMI-ERROR
 11889         GO TO 1370-DAYS-ERROR.
 11890
 11891     IF CL-NO-OF-PMTS-MADE = 0
 11892        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11893        AND CL-CERT-STATE = 'MI'
 11894        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11895            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11896     END-IF.
 11897
 11898 1362-CHECK-MAX-DAYS.
 11899
 11900     IF WS-MAX-DAYS-TOL = +999
 11901         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11902
 11903     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11904         IF PI-EDAYS = ZEROS
 11905             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11906         ELSE
 11907             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11908
 11909     IF WS-MAX-DAYS-TOL NOT = ZERO
 11910        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11911           PI-CDAYS > WS-MAX-DAYS-TOL
 11912             MOVE ER-0492          TO EMI-ERROR
 11913             GO TO 1370-DAYS-ERROR.
 11914
 11915 1365-SKIP-MAX-DAYS-EDIT.
 11916     IF PI-EDAYS = ZEROS
 11917        GO TO 1400-EDIT-PAYMENT.
 11918
 11919     IF WS-DAYS-TOL NOT = ZERO
 11920        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11921           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 228
* EL156.cbl
 11922                MOVE ER-0493     TO EMI-ERROR
 11923                GO TO 1370-DAYS-ERROR.
 11924
 11925     GO TO 1400-EDIT-PAYMENT.
 11926
 11927 1370-DAYS-ERROR.
 11928     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11929
 11930     IF EMI-MESSAGE-FORMATTED
 11931         MOVE -1                 TO EDAYSL
 11932         MOVE AL-UABON           TO EDAYSA.
 11933
 11934     GO TO 1400-EDIT-PAYMENT.
 11935
 11936 1380-EDIT-EXPENSE-PMT-AMT.
 11937     IF PI-PMTTYPE = '5' OR '6'
 11938         NEXT SENTENCE
 11939     ELSE
 11940         GO TO 1400-EDIT-PAYMENT.
 11941
 11942     IF WS-MAX-EXP-PMT NOT = ZEROS
 11943        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11944            MOVE ER-3529            TO EMI-ERROR
 11945            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11946
 11947     GO TO 1500-EDIT-EXPENSES.
 11948
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 229
* EL156.cbl
 11950
 11951 1390-CHECK-PAYMENT-DAYS.
 11952
 11953     IF PI-EDAYS = 0
 11954         MOVE PI-CDAYS TO WS-PD-DAYS
 11955     ELSE
 11956         MOVE PI-EDAYS TO WS-PD-DAYS
 11957     END-IF.
 11958
 11959     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11960         IF WS-PD-DAYS = 14
 11961            GO TO 1390-EXIT
 11962         END-IF
 11963     END-IF.
 11964
 11965     IF PI-COMPANY-ID = 'AHL'  AND
 11966        CM-AH-BENEFIT-CD = '1K'
 11967         IF WS-PD-DAYS = 14
 11968            GO TO 1390-EXIT
 11969         END-IF
 11970     END-IF.
 11971
 11972     IF WS-PD-DAYS < 30
 11973         MOVE ER-3549              TO EMI-ERROR
 11974         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11975     END-IF.
 11976
 11977 1390-EXIT.
 11978      EXIT.
 11979
 11980 1400-EDIT-PAYMENT.
 11981*    IF PI-COMPANY-ID = 'DMD'
 11982*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11983*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11984
 11985     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 11986        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11987        MOVE PI-CARRIER          TO ACCT-CARRIER
 11988        MOVE PI-GROUPING         TO ACCT-GROUPING
 11989        MOVE PI-STATE            TO ACCT-STATE
 11990        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11991        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11992        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11993        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11994
 11995
 11996* EXEC CICS READ
 11997*          DATASET ('ERACCT')
 11998*          RIDFLD  (ERACCT-KEY)
 11999*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12000*          GTEQ
 12001*          resp    (WS-RESPONSE)
 12002*       END-EXEC
 12003     MOVE 'ERACCT' TO DFHEIV1
 12004*    MOVE '&"S        G          (  N#00011459' TO DFHEIV0
 12005     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12006     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12007     MOVE X'204E233030303131343539' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 230
* EL156.cbl
 12008     CALL 'kxdfhei1' USING DFHEIV0,
 12009           DFHEIV1,
 12010           DFHEIV20,
 12011           DFHEIV99,
 12012           ERACCT-KEY,
 12013           DFHEIV99,
 12014           DFHEIV99,
 12015           DFHEIV99
 12016     SET ADDRESS OF ACCOUNT-MASTER TO
 12017         DFHEIV20
 12018     MOVE EIBRESP  TO WS-RESPONSE
 12019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12020        IF WS-RESP-NORMAL
 12021           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 12022           and pi-cert-eff-dt < am-expiration-dt
 12023           and pi-cert-eff-dt >= am-effective-dt
 12024           move am-dcc-product-code to pi-dcc-product-code
 12025        else
 12026           move spaces           to pi-dcc-product-code
 12027        end-if
 12028        if PI-DCC-PRODUCT-CODE NOT = SPACES
 12029           PERFORM 0900-GET-DDF-LIMITS
 12030                                 THRU 0900-EXIT
 12031           IF PDEF-FOUND
 12032              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12033                 (P1 > +8)
 12034                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 12035              END-PERFORM
 12036              IF P1 < +9
 12037                 if pd-ben-pct (p1) not numeric
 12038                    move zeros   to pd-ben-pct (p1)
 12039                 end-if
 12040                 if pd-ben-pct (p1) = zeros
 12041                    move +1      to ws-work-ben-pct
 12042                 else
 12043                    move pd-ben-pct (p1)
 12044                                 to ws-work-ben-pct
 12045                 end-if
 12046                 compute cm-ah-benefit-amt =
 12047                    cm-ah-benefit-amt * ws-work-ben-pct
 12048                 if cm-ah-benefit-amt > pd-max-amt (p1)
 12049                    move pd-max-amt (p1) to cm-ah-benefit-amt
 12050                 end-if
 12051              else
 12052                 move er-1674    to emi-error
 12053                 PERFORM 9900-ERROR-FORMAT
 12054                                 THRU 9900-EXIT
 12055              END-IF
 12056           else
 12057              move er-1672       to emi-error
 12058              PERFORM 9900-ERROR-FORMAT
 12059                                 THRU 9900-EXIT
 12060           END-IF
 12061        end-if
 12062     END-IF
 12063     IF PI-PMTTYPE NOT = '4'
 12064        GO TO 1405-CALC-PAYMENT.
 12065     IF PI-EDAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 231
* EL156.cbl
 12066         MOVE PI-EPYAMT           TO PI-CPYAMT
 12067         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 12068         GO TO 1430-CHECK-AH-TOLERANCE.
 12069
 12070*    IF PI-COMPANY-ID = 'FIA'
 12071*       IF CERT-ACCOUNT = '0000011043'
 12072*        COMPUTE PI-DAILY-RATE ROUNDED =
 12073*                      (CM-AH-BENEFIT-AMT * 13) / 365
 12074*        COMPUTE PI-CPYAMT ROUNDED =
 12075*                          PI-DAILY-RATE * PI-EDAYS
 12076*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 12077*        GO TO 1430-CHECK-AH-TOLERANCE.
 12078
 12079     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 12080         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12081         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 12082         GO TO 1420-CHECK-AIG-BENEFIT.
 12083
 12084     IF WS-CALC-METHOD = '2' OR  '5'
 12085         COMPUTE PI-DAILY-RATE ROUNDED =
 12086                        (CM-AH-BENEFIT-AMT * 12) / 365
 12087         COMPUTE PI-CPYAMT ROUNDED =
 12088                           PI-DAILY-RATE * PI-EDAYS
 12089        GO TO 1420-CHECK-AIG-BENEFIT.
 12090
 12091     IF WS-CALC-METHOD = '3'
 12092         COMPUTE PI-DAILY-RATE =
 12093                         (CM-AH-BENEFIT-AMT * 12) / 365
 12094         COMPUTE PI-CPYAMT ROUNDED =
 12095                           PI-DAILY-RATE * PI-EDAYS
 12096        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 232
* EL156.cbl
 12098*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 12099
 12100****************************************************************
 12101****************************************************************
 12102*                  CALCULATED FROM      PAYMENT      PAYMENT
 12103*   DATES           DATE ROUTINE        OPT  1       OPT  6
 12104* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 12105*1-01-83  1-15-83    0    15     15        15           15
 12106*1-01-83  1-30-83    0    30     30        30           30
 12107*1-01-83  1-31-83    1     0     31        30           30
 12108*1-01-83  2-01-83    1     1     32        31           31
 12109*1-01-83  2-15-83    1    15     46        45           45
 12110*1-01-83  2-28-83    2     0     59        60           60
 12111*1-01-83  3-01-83    2     1     60        61           61
 12112*1-01-83  3-31-83    3     0     90        90           90
 12113*1-15-83  1-31-83    0    17     17        17           16
 12114*1-15-83  2-01-83    0    18     18        18           17
 12115*1-15-83  2-28-83    1    14     45        44           46
 12116*1-21-83  3-09-83    1    20     48        50           49
 12117*2-05-83  3-06-83    1     2     30        32           32
 12118*2-05-83  3-23-83    1    19     47        49           49
 12119*2-15-83  2-28-83    0    14     14        14           16
 12120*2-15-83  3-01-83    0    15     15        15           17
 12121*2-21-83  3-19-83    0    27     27        27           29
 12122*2-21-83  3-20-83    1     0     28        30           30
 12123*2-21-83  4-10-83    1    18     49        30           50
 12124*2-21-83  5-19-83    2    27     88        87           89
 12125*2-21-83  5-22-83    3     2     91        92           92
 12126*3-21-83  5-19-83    1    30     60        60           59
 12127****************************************************************
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 233
* EL156.cbl
 12129 1405-CALC-PAYMENT.
 12130     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12131     MOVE ' '                    TO DC-OPTION-CODE.
 12132     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12133     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 12134     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 12135
 12136     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12137     MOVE ' '                    TO DC-OPTION-CODE.
 12138     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12139     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 12140     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 12141
 12142     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12143     MOVE -1                     TO DC-ELAPSED-DAYS.
 12144     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 12145     MOVE '6'                    TO DC-OPTION-CODE.
 12146     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12147     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 12148
 12149     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 12150     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 12151     MOVE '1'                    TO DC-OPTION-CODE.
 12152     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12153
 12154     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 12155     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 12156     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 12157
 12158******************************************************************
 12159*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 12160*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 12161*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 12162******************************************************************
 12163
 12164     IF WS-CALC-METHOD = '1'           AND
 12165        DC-ELAPSED-MONTHS > ZERO AND
 12166        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 12167        WDF-DAY > WDT-DAY
 12168          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 12169          MOVE ZEROS               TO DC-ELAPSED-DAYS
 12170          MOVE -1                  TO DC-ELAPSED-MONTHS
 12171          MOVE '6'                 TO DC-OPTION-CODE
 12172          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12173          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 12174          COMPUTE WS-SAVE-ODD-DAYS =
 12175          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 12176          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 12177
 12178     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 12179     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 12180     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 12181
 12182     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 12183     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 12184
 12185*    IF PI-COMPANY-ID = 'FIA'
 12186*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 234
* EL156.cbl
 12187*        COMPUTE PI-DAILY-RATE ROUNDED =
 12188*                          (CM-AH-BENEFIT-AMT * 13) / 365
 12189*        COMPUTE PI-CPYAMT ROUNDED =
 12190*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 12191*        GO TO 1420-CHECK-AIG-BENEFIT.
 12192
 12193*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12194*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 12195*          CM-AH-BENEFIT-CD = '23'               AND
 12196*          CL-CERT-STATE    = '04'               AND
 12197*         (PI-PMTTYPE = '1' OR '2' OR '3')
 12198*            COMPUTE WS-DAILY-RATE ROUNDED =
 12199*                               CM-AH-BENEFIT-AMT / 30
 12200*            COMPUTE PI-CPYAMT ROUNDED =
 12201*                               (WS-DAILY-RATE * PI-CDAYS)
 12202*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12203*            GO TO 1420-CHECK-AIG-BENEFIT.
 12204
 12205     IF WS-CALC-METHOD = '1'
 12206         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12207         COMPUTE PI-CPYAMT ROUNDED =
 12208             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12209             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12210         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 12211         GO TO 1420-CHECK-AIG-BENEFIT.
 12212
 12213     IF WS-CALC-METHOD = '2'
 12214         COMPUTE PI-DAILY-RATE ROUNDED =
 12215                          (CM-AH-BENEFIT-AMT * 12) / 365
 12216         COMPUTE PI-CPYAMT ROUNDED =
 12217             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12218             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12219         GO TO 1420-CHECK-AIG-BENEFIT.
 12220
 12221     IF WS-CALC-METHOD = '4'
 12222         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 12223         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 12224         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12225         COMPUTE PI-CPYAMT ROUNDED =
 12226                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 12227         GO TO 1420-CHECK-AIG-BENEFIT.
 12228
 12229     IF WS-CALC-METHOD = '5'
 12230         COMPUTE PI-DAILY-RATE ROUNDED =
 12231                            (CM-AH-BENEFIT-AMT * 12) / 365
 12232         COMPUTE PI-CPYAMT ROUNDED =
 12233                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 12234         GO TO 1420-CHECK-AIG-BENEFIT.
 12235
 12236     IF WS-CALC-METHOD NOT = '3'
 12237        GO TO 1410-CHECK-PAYMENT.
 12238
 12239******   CALCULATION METHOD  3  ROUTINE
 12240     COMPUTE PI-DAILY-RATE =
 12241                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 12242
 12243******CHECK TO SEE IF WITHIN SAME MONTH
 12244     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 235
* EL156.cbl
 12245        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 12246                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 12247         GO TO 1420-CHECK-AIG-BENEFIT.
 12248
 12249******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 12250     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 12251             SAVE-ODD-DAYS-OVER = ZEROS
 12252      COMPUTE PI-CPYAMT  ROUNDED =
 12253                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 12254      GO TO 1420-CHECK-AIG-BENEFIT.
 12255
 12256******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 12257******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 12258     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12259        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 12260        IF WDF-MONTH > 12
 12261           ADD 1                 TO WDF-YEAR
 12262           SUBTRACT 12         FROM WDF-MONTH.
 12263
 12264******CONVERT THE NEW FROM MONTH TO BINARY
 12265     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12266        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 12267        MOVE '4'              TO DC-OPTION-CODE
 12268        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12269        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 12270
 12271     IF WDF-MONTH = WDT-MONTH AND
 12272        WDF-YEAR  = WDT-YEAR
 12273          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 12274                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 12275                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 12276        ELSE
 12277          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 12278          MOVE WDT-DAY              TO THRU-PMT-DAYS
 12279          COMPUTE PI-CPYAMT ROUNDED =
 12280       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 12281       +
 12282       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 12283       +
 12284       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 12285
 12286     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 236
* EL156.cbl
 12288 1410-CHECK-PAYMENT.
 12289******PAYMENT OPTION 6
 12290******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 12291     IF SAVE-ELAPSED-MONTHS > ZERO
 12292        IF SAVE-ODD-DAYS-OVER = ZEROS
 12293           GO TO 1412-CHECK-TO-DAY
 12294        ELSE
 12295           IF WDF-DAY > WDT-DAY
 12296              IF WDF-MONTH = 02
 12297                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12298                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 12299                  GO TO 1412-CHECK-TO-DAY
 12300              ELSE
 12301                  IF FROM-DAYS-IN-MONTH = 31
 12302                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 12303                     GO TO 1412-CHECK-TO-DAY
 12304                  ELSE
 12305                     GO TO 1412-CHECK-TO-DAY
 12306           ELSE
 12307               GO TO 1412-CHECK-TO-DAY.
 12308
 12309     IF WDF-MONTH NOT = WDT-MONTH
 12310        IF WDF-MONTH = 02
 12311           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12312           IF WDF-DAY = 29
 12313              ADD 1              TO SAVE-ODD-DAYS-OVER
 12314           ELSE
 12315              ADD 2              TO SAVE-ODD-DAYS-OVER
 12316        ELSE
 12317           IF FROM-DAYS-IN-MONTH = 31
 12318              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12319
 12320 1412-CHECK-TO-DAY.
 12321        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12322           IF WDT-DAY = 28
 12323              ADD 2              TO SAVE-ODD-DAYS-OVER
 12324           ELSE
 12325              IF WDT-DAY = 29
 12326                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12327              ELSE
 12328                 NEXT SENTENCE
 12329        ELSE
 12330           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12331              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12332
 12333     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12334     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12335     COMPUTE PI-CPYAMT ROUNDED =
 12336         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12337         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12338
 12339     GO TO 1420-CHECK-AIG-BENEFIT.
 12340
 12341 1415-CHECK-LEAP-YEAR.
 12342     IF FROM-DAYS-IN-MONTH = 29
 12343        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12344
 12345 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 237
* EL156.cbl
 12346     EXIT.
 12347
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 238
* EL156.cbl
 12349 1420-CHECK-AIG-BENEFIT.
 12350
 12351     IF WS-SPECIAL-CALC-CD = 'Q'
 12352         GO TO 1425-CHECK-WHOLE-MONTH.
 12353
 12354*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12355*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12356*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12357*       (PI-PMTTYPE = '1' OR '2')
 12358*        NEXT SENTENCE
 12359*    ELSE
 12360         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12361         GO TO 1430-CHECK-AH-TOLERANCE.
 12362
 12363******************AIG LOGIC STARTS**********************
 12364*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12365*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12366*    MOVE ER-3533      TO EMI-ERROR.
 12367*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12368*    GO TO 1430-CHECK-AH-TOLERANCE.
 12369******************AIG LOGIC ENDS************************
 12370
 12371 1425-CHECK-WHOLE-MONTH.
 12372******************************************************************
 12373****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12374****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12375****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12376****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12377****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12378****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12379****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12380****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12381****          PAID * MONTHLY BENEFIT.                         ****
 12382******************************************************************
 12383
 12384     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12385
 12386     IF CL-NO-OF-PMTS-MADE > +0
 12387         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12388
 12389     IF PI-CDAYS < WS-BEN-DAYS
 12390         GO TO 1430-CHECK-AH-TOLERANCE.
 12391
 12392     IF PI-CDAYS = WS-BEN-DAYS
 12393         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12394         GO TO 1430-CHECK-AH-TOLERANCE.
 12395
 12396*    IF PI-COMPANY-ID = 'ACM'
 12397*       NEXT SENTENCE
 12398*    ELSE
 12399        GO TO 1425-NOT-ACM-W15C.
 12400
 12401*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12402*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12403*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12404*    MOVE '6'                    TO  DC-OPTION-CODE.
 12405*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12406*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 239
* EL156.cbl
 12407*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12408*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12409*       MOVE '1'                 TO  DC-OPTION-CODE
 12410*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12411*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12412*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12413*       IF NO-CONVERSION-ERROR
 12414*          IF (DC-ELAPSED-MONTHS > +0) OR
 12415*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12416*             NEXT SENTENCE
 12417*          ELSE
 12418*             MOVE +0            TO  PI-CPYAMT
 12419*             MOVE ER-0846       TO  EMI-ERROR
 12420*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12421*             GO TO 1430-CHECK-AH-TOLERANCE
 12422*       ELSE
 12423*           MOVE ER-0846         TO  EMI-ERROR
 12424*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12425*           GO TO 1430-CHECK-AH-TOLERANCE.
 12426*
 12427*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12428*       ADD +1 TO DC-ELAPSED-MONTHS.
 12429*
 12430*    COMPUTE PI-CPYAMT ROUNDED =
 12431*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12432*
 12433*    GO TO 1430-CHECK-AH-TOLERANCE.
 12434
 12435 1425-NOT-ACM-W15C.
 12436
 12437     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12438     MOVE '6'                        TO  DC-OPTION-CODE.
 12439     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12440     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12441
 12442     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12443     IF NO-CONVERSION-ERROR
 12444         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12445     ELSE
 12446         MOVE ER-0846                TO  EMI-ERROR
 12447         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12448         GO TO 1430-CHECK-AH-TOLERANCE.
 12449
 12450     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12451     MOVE '1'                        TO  DC-OPTION-CODE.
 12452     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12453     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12454     IF NO-CONVERSION-ERROR
 12455         IF DC-ODD-DAYS-OVER = +0
 12456             NEXT SENTENCE
 12457         ELSE
 12458             MOVE ER-0846            TO  EMI-ERROR
 12459             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12460             GO TO 1430-CHECK-AH-TOLERANCE
 12461     ELSE
 12462         MOVE ER-0846                TO  EMI-ERROR
 12463         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12464         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 240
* EL156.cbl
 12465
 12466     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12467         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12468
 12469     GO TO 1430-CHECK-AH-TOLERANCE.
 12470
 12471 1425-CONT-WHOLE-MONTH-PMTS.
 12472******************************************************************
 12473****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12474****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12475****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12476******************************************************************
 12477
 12478     IF PI-COMPANY-ID = 'ACM'
 12479        NEXT SENTENCE
 12480     ELSE
 12481        IF DC-ODD-DAYS-OVER = +0
 12482            NEXT SENTENCE
 12483        ELSE
 12484            MOVE ER-0845            TO  EMI-ERROR
 12485            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12486            GO TO 1430-CHECK-AH-TOLERANCE.
 12487
 12488     COMPUTE PI-CPYAMT ROUNDED =
 12489                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12490
 12491 1430-CHECK-AH-TOLERANCE.
 12492     IF PI-PMT-APPR-SW = 'G'
 12493         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12494
 12495*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12496*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12497*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12498*
 12499*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12500*      IF WDF-MONTH = 02
 12501*        IF SAVE-ELAPSED-MONTHS = 0
 12502*          NEXT SENTENCE
 12503*        ELSE
 12504*          IF SAVE-ODD-DAYS-OVER > 0
 12505*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12506*            COMPUTE WS-PMT-MOS ROUNDED =
 12507*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12508*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12509*                                     WS-PMT-MOS
 12510*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12511*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12512*          ELSE
 12513*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12514*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12515*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12516*                                     WS-PMT-MOS.
 12517
 12518     IF WS-MAX-PMT-TOL NOT = ZERO
 12519        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12520           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12521            MOVE ER-0494         TO  EMI-ERROR
 12522            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 241
* EL156.cbl
 12523            GO TO 1500-EDIT-EXPENSES.
 12524
 12525 1430-CONT-CHECK-AH-TOLERANCE.
 12526
 12527     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12528        GO TO 1500-EDIT-EXPENSES.
 12529
 12530     IF CM-O-B-COVERAGE
 12531        GO TO 1500-EDIT-EXPENSES.
 12532
 12533     IF PI-COMPANY-ID = 'NCL'
 12534       IF FOUND-TOL-SW = 'Y'
 12535         IF WS-PMT-TOL NOT = ZERO
 12536           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12537              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12538                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12539                  IF WS-NCL-PMT-OPTION = SPACES
 12540                      MOVE ER-0699 TO EMI-ERROR
 12541                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12542                  ELSE
 12543                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12544                      NEXT SENTENCE
 12545                  ELSE
 12546                  IF NOT WS-VALID-NCL-OPTION
 12547                      MOVE ER-0699 TO EMI-ERROR
 12548                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12549
 12550     IF WS-PMT-TOL NOT = ZERO
 12551        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12552           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12553           MOVE ER-0495          TO EMI-ERROR
 12554           PERFORM 1490-PAYMENT-ERROR
 12555                                 THRU 1490-EXIT
 12556        end-if
 12557     end-if
 12558
 12559     GO TO 1500-EDIT-EXPENSES.
 12560
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 242
* EL156.cbl
 12562 1440-COMPUTE-LIFE-REMAINING.
 12563
 12564     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12565        IF PI-PMTTYPE = '4'
 12566          MOVE PI-EPYAMT TO PI-CPYAMT
 12567          GO TO 1460-TEST-TYPE.
 12568
 12569     IF WS-LF-COVERAGE-TYPE = 'L'
 12570        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12571                          - CL-TOTAL-PAID-AMT
 12572        GO TO 1450-CHECK-MAX.
 12573
 12574     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12575        PI-LF-COVERAGE-TYPE = 'P'
 12576          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12577                              CM-LF-ITD-DEATH-AMT
 12578          GO TO 1450-CHECK-MAX.
 12579
 12580     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12581     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12582     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12583     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12584     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12585     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12586     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12587     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12588     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12589
 12590     PERFORM 9800-LINK-REM-TERM.
 12591
 12592     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12593     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12594     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12595     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12596     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12597     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12598     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12599     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12600     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12601     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12602     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12603     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12604     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12605     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12606     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12607     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12608     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 12609        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12610        MOVE PI-CARRIER          TO ACCT-CARRIER
 12611        MOVE PI-GROUPING         TO ACCT-GROUPING
 12612        MOVE PI-STATE            TO ACCT-STATE
 12613        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12614        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12615        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12616        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12617
 12618
 12619* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 243
* EL156.cbl
 12620*          DATASET ('ERACCT')
 12621*          RIDFLD  (ERACCT-KEY)
 12622*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12623*          GTEQ
 12624*          resp    (WS-RESPONSE)
 12625*       END-EXEC
 12626     MOVE 'ERACCT' TO DFHEIV1
 12627*    MOVE '&"S        G          (  N#00012064' TO DFHEIV0
 12628     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12629     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12630     MOVE X'204E233030303132303634' TO DFHEIV0(25:11)
 12631     CALL 'kxdfhei1' USING DFHEIV0,
 12632           DFHEIV1,
 12633           DFHEIV20,
 12634           DFHEIV99,
 12635           ERACCT-KEY,
 12636           DFHEIV99,
 12637           DFHEIV99,
 12638           DFHEIV99
 12639     SET ADDRESS OF ACCOUNT-MASTER TO
 12640         DFHEIV20
 12641     MOVE EIBRESP  TO WS-RESPONSE
 12642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12643        IF WS-RESP-NORMAL
 12644           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12645           and (pi-cert-eff-dt < am-expiration-dt)
 12646           and (pi-cert-eff-dt >= am-effective-dt)
 12647           move am-dcc-product-code to pi-dcc-product-code
 12648        else
 12649           move spaces           to pi-dcc-product-code
 12650        end-if
 12651        if pi-dcc-product-code not = spaces
 12652           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12653           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12654           PERFORM 0900-GET-DDF-limits
 12655                                 THRU 0900-EXIT
 12656           IF PDEF-FOUND
 12657              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12658                 (P1 > +8)
 12659                 OR (PD-PROD-CODE (P1) = 'L')
 12660              END-PERFORM
 12661              IF P1 < +9
 12662                 MOVE PD-MAX-AMT (P1)
 12663                                 TO CP-R-MAX-TOT-BEN
 12664              else
 12665                 move er-1674    to emi-error
 12666                 PERFORM 9900-ERROR-FORMAT
 12667                                 THRU 9900-EXIT
 12668              END-IF
 12669           else
 12670              move er-1672       to emi-error
 12671              PERFORM 9900-ERROR-FORMAT
 12672                                 THRU 9900-EXIT
 12673           END-IF
 12674        end-if
 12675     END-IF
 12676
 12677* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 244
* EL156.cbl
 12678*       PROGRAM  (LINK-REMAMT)
 12679*       COMMAREA (CALCULATION-PASS-AREA)
 12680*       LENGTH   (CP-COMM-LENGTH)
 12681*    END-EXEC.
 12682*    MOVE '."C                   (   #00012104' TO DFHEIV0
 12683     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12684     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12685     MOVE X'2020233030303132313034' TO DFHEIV0(25:11)
 12686     CALL 'kxdfhei1' USING DFHEIV0,
 12687           LINK-REMAMT,
 12688           CALCULATION-PASS-AREA,
 12689           CP-COMM-LENGTH,
 12690           DFHEIV99,
 12691           DFHEIV99,
 12692           DFHEIV99,
 12693           DFHEIV99
 12694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12695
 12696
 12697     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12698
 12699     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12700     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12701
 12702     IF PI-COMPANY-ID = 'BOA' AND
 12703        PI-PMTTYPE    = '2'   AND
 12704        PI-OFFLINE    = 'N'
 12705           GO TO 1441-COMPUTE-BOA-INTEREST.
 12706
 12707     IF PI-COMPANY-ID = 'NCL' AND
 12708        PI-PMTTYPE    = '2'   AND
 12709        PI-OFFLINE    = 'N'
 12710          GO TO 1442-COMPUTE-NCL-INTEREST
 12711       ELSE
 12712          GO TO 1445-CONTINUE.
 12713
 12714 1441-COMPUTE-BOA-INTEREST.
 12715     MOVE +0             TO WS-CALC-INT.
 12716
 12717     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12718     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12719     MOVE +0             TO DC-ELAPSED-MONTHS
 12720                            DC-ELAPSED-DAYS.
 12721     MOVE '1'            TO DC-OPTION-CODE.
 12722     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12723     IF NO-CONVERSION-ERROR
 12724         NEXT SENTENCE
 12725     ELSE
 12726         GO TO 1445-CONTINUE.
 12727
 12728     IF (PI-INT-RATE NOT > ZEROS)  AND
 12729        (DC-ELAPSED-DAYS > +30)
 12730         MOVE ER-3531            TO EMI-ERROR
 12731         MOVE -1                 TO PINTL
 12732         MOVE AL-UNBON           TO PINTA
 12733         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12734
 12735     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 245
* EL156.cbl
 12736         GO TO 1445-CONTINUE.
 12737
 12738     IF (PI-INT-RATE NOT > ZEROS)  OR
 12739        (DC-ELAPSED-DAYS NOT > +30)
 12740         MOVE PI-EPYAMT TO PI-CPYAMT
 12741         GO TO 1441-FORMAT-NOTE.
 12742
 12743     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12744                                 *  PI-INT-RATE
 12745                                 *  DC-ELAPSED-DAYS
 12746                                 /  365
 12747                                 /  100.
 12748
 12749     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12750
 12751 1441-FORMAT-NOTE.
 12752
 12753     MOVE SPACES        TO WS-BOANOTE1.
 12754     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12755     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12756     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12757     MOVE AL-UANON      TO NOTE1A.
 12758
 12759     IF WS-CALC-INT > ZEROS
 12760         MOVE SPACES        TO WS-BOANOTE2
 12761         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12762         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12763         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12764         MOVE AL-UANON      TO NOTE2A.
 12765
 12766     GO TO 1445-CONTINUE.
 12767
 12768 1442-COMPUTE-NCL-INTEREST.
 12769     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12770     MOVE PI-STATE               TO WS-ST-ACCESS.
 12771     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12772     MOVE '3'                    TO CNTL-REC-TYPE.
 12773     MOVE +0                     TO CNTL-SEQ-NO.
 12774     MOVE 'STAT'                 TO FILE-SWITCH.
 12775
 12776     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12777
 12778     MOVE +0                 TO WS-CALC-INT.
 12779
 12780     IF ST-STAT-FROM-INCURRED
 12781         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12782       ELSE
 12783     IF ST-STAT-FROM-REPORTED
 12784         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12785       ELSE
 12786         GO TO 1445-CONTINUE.
 12787
 12788     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12789     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12790     MOVE +0                 TO DC-ELAPSED-MONTHS
 12791                                DC-ELAPSED-DAYS.
 12792     MOVE '1'                TO DC-OPTION-CODE.
 12793     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 246
* EL156.cbl
 12794     IF NO-CONVERSION-ERROR
 12795         NEXT SENTENCE
 12796     ELSE
 12797         GO TO 1445-CONTINUE.
 12798
 12799     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12800        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12801         GO TO 1445-CONTINUE.
 12802
 12803     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12804                                 *  CF-ST-STAT-INTEREST.
 12805
 12806     MOVE SPACES              TO WS-NCLNOTE1.
 12807     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12808     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12809     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12810                                 PI-PMTNOTE1
 12811                                 NOTE1I.
 12812     MOVE AL-UANON            TO NOTE1A.
 12813
 12814     IF WS-CALC-INT > ZEROS
 12815         MOVE SPACES          TO WS-NCLNOTE2
 12816         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12817         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12818         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12819                                 PI-PMTNOTE2
 12820                                 NOTE2I
 12821         MOVE AL-UANON        TO NOTE2A.
 12822
 12823     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12824
 12825 1445-CONTINUE.
 12826
 12827     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12828        GO TO 1460-TEST-TYPE.
 12829
 12830     IF CM-O-B-COVERAGE
 12831        GO TO 1460-TEST-TYPE.
 12832
 12833     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12834         GO TO 1450-CHECK-MAX.
 12835
 12836     if (pi-company-id = 'DCC' or 'VPP')
 12837        and (pdef-found)
 12838        if pi-epyamt > pd-max-amt (p1)
 12839           move er-1657          to emi-error
 12840           perform 1490-payment-error
 12841                                 thru 1490-exit
 12842           go to 1460-test-type
 12843        end-if
 12844     else
 12845        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12846           > PI-EPYAMT)
 12847                         OR
 12848           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12849           < PI-EPYAMT)
 12850           MOVE ER-0594          TO EMI-ERROR
 12851           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 247
* EL156.cbl
 12852                                 THRU 1490-EXIT
 12853           GO TO 1460-TEST-TYPE
 12854        end-if
 12855     end-if
 12856     .
 12857 1450-CHECK-MAX.
 12858
 12859     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12860        PI-LF-COVERAGE-TYPE = 'P'
 12861         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12862                                   CM-LF-ITD-DEATH-AMT
 12863     ELSE
 12864         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12865                                   CL-TOTAL-PAID-AMT.
 12866
 12867     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12868          MOVE ER-0543           TO EMI-ERROR
 12869          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12870
 12871 1460-TEST-TYPE.
 12872
 12873     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12874        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 12875           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12876                                   CM-LF-ALT-BENEFIT-AMT -
 12877                                   CL-TOTAL-PAID-AMT
 12878           IF PI-EPYAMT > WS-LF-BEN-AMT
 12879               MOVE ER-0543      TO EMI-ERROR
 12880               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12881           END-IF
 12882        END-IF
 12883     END-IF
 12884
 12885     IF PI-PMT-APPR-SW = 'G'
 12886       NEXT SENTENCE
 12887     ELSE
 12888       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12889         IF PI-EPYAMT = ZERO
 12890             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12891                 MOVE ER-0494    TO  EMI-ERROR
 12892                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12893                 GO TO 1500-EDIT-EXPENSES
 12894             ELSE
 12895                 NEXT SENTENCE
 12896         ELSE
 12897             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12898                 MOVE ER-0494    TO  EMI-ERROR
 12899                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12900                 GO TO 1500-EDIT-EXPENSES.
 12901
 12902     IF PI-PMTTYPE NOT = '2' OR
 12903        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12904         GO TO 1500-EDIT-EXPENSES.
 12905
 12906     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12907     MOVE ER-0526                TO EMI-ERROR.
 12908     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12909
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 248
* EL156.cbl
 12910     IF EMI-ERROR-NUMBER (1) = '0526'
 12911        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12912
 12913     IF EMI-ERROR-NUMBER (2) = '0526'
 12914        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12915
 12916     GO TO 1500-EDIT-EXPENSES.
 12917
 12918 1490-PAYMENT-ERROR.
 12919     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12920
 12921     IF EMI-MESSAGE-FORMATTED
 12922         MOVE -1                 TO EPYAMTL
 12923         MOVE AL-UNBON           TO EPYAMTA.
 12924
 12925 1490-EXIT.
 12926      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 249
* EL156.cbl
 12928 1500-EDIT-EXPENSES.
 12929     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12930         GO TO 1500-SKIP-ERROR-0556.
 12931
 12932 1500-CONTINUE-ON.
 12933
 12934     IF CM-O-B-COVERAGE
 12935        MOVE ER-0556             TO EMI-ERROR
 12936        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12937
 12938 1500-SKIP-ERROR-0556.
 12939     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12940        IF PI-EEXPENS NOT = ZEROS
 12941           MOVE ER-0524          TO EMI-ERROR
 12942           GO TO 1590-EXPENSE-ERROR
 12943        ELSE
 12944           GO TO 1600-EDIT-RESERVES.
 12945
 12946     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12947     MOVE '6'                    TO CNTL-REC-TYPE.
 12948
 12949     IF CONTROL-IS-ACTUAL-CARRIER
 12950         MOVE PI-CARRIER         TO WS-CARR
 12951     ELSE
 12952         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12953
 12954     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12955     MOVE +0                     TO CNTL-SEQ-NO.
 12956     MOVE 'CARR'                 TO FILE-SWITCH.
 12957
 12958     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12959
 12960     IF EXPENSE-CALC-MANUAL
 12961        GO TO 1600-EDIT-RESERVES.
 12962
 12963     IF DOLLARS-PER-PMT
 12964        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12965        GO TO 1600-EDIT-RESERVES.
 12966
 12967     IF DOLLARS-PER-MONTH AND
 12968        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12969       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12970       GO TO 1600-EDIT-RESERVES.
 12971
 12972     IF PERCENT-OF-PAYMENT
 12973        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12974
 12975     GO TO 1600-EDIT-RESERVES.
 12976
 12977 1590-EXPENSE-ERROR.
 12978     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12979
 12980     IF EMI-MESSAGE-FORMATTED
 12981        MOVE -1                  TO EEXPENSL
 12982        MOVE AL-UNBON            TO EEXPENSA.
 12983
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 250
* EL156.cbl
 12985 1600-EDIT-RESERVES.
 12986     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12987        IF PI-ERESV = ZEROS
 12988           GO TO 1700-EDIT-EXPENSE-TYPE
 12989        ELSE
 12990           MOVE ER-0525          TO EMI-ERROR
 12991           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12992           GO TO 1700-EDIT-EXPENSE-TYPE.
 12993
 12994     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12995     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12996     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12997
 12998     IF NOT AT-MANUAL-RESERVES-USED
 12999        IF PI-ERESV NOT = ZEROS
 13000           MOVE ER-0518          TO EMI-ERROR
 13001           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 13002
 13003     IF AT-MANUAL-RESERVES-USED
 13004        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 13005        GO TO 1700-EDIT-EXPENSE-TYPE.
 13006
 13007     IF AT-FUTURE-RESERVES-USED
 13008        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 13009
 13010     IF AT-FUTURE-RESERVES-USED
 13011        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 13012
 13013     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 13014        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 13015
 13016     IF AT-IBNR-RESERVES-USED
 13017        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 13018
 13019     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 13020     GO TO 1700-EDIT-EXPENSE-TYPE.
 13021
 13022 1690-RESERVE-ERROR.
 13023     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13024
 13025     IF EMI-MESSAGE-FORMATTED
 13026        MOVE AL-UNBON            TO ERESVA
 13027        MOVE -1                  TO ERESVL.
 13028
 13029 1690-EXIT.
 13030      EXIT.
 13031
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 251
* EL156.cbl
 13033 1700-EDIT-EXPENSE-TYPE.
 13034     IF PI-PMTTYPE NOT = '5' AND '6'
 13035        GO TO 2000-EDIT-DONE.
 13036
 13037     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 13038                   '6' OR '7' OR '8' OR '9'
 13039        GO TO 2000-EDIT-DONE.
 13040
 13041 1705-EXPENSE-ERROR.
 13042     MOVE ER-0573                TO EMI-ERROR.
 13043     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13044
 13045     IF EMI-MESSAGE-FORMATTED
 13046        MOVE AL-UABON            TO ETYPEA
 13047        MOVE -1                  TO ETYPEL.
 13048
 13049     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 252
* EL156.cbl
 13051 1950-NOT-FOUND.
 13052     IF FILE-SWITCH = 'MSTR'
 13053        MOVE ER-0204             TO EMI-ERROR.
 13054
 13055     IF FILE-SWITCH = 'CARR'
 13056        MOVE ER-0252             TO EMI-ERROR.
 13057
 13058     IF FILE-SWITCH = 'COMP'
 13059        MOVE ER-0254             TO EMI-ERROR.
 13060
 13061     IF FILE-SWITCH = 'STAT'
 13062        MOVE ER-0149             TO EMI-ERROR.
 13063
 13064     IF FILE-SWITCH = 'PROC'
 13065        MOVE ER-0019             TO EMI-ERROR.
 13066
 13067     IF FILE-SWITCH = 'ACCT'
 13068        MOVE ER-0198             TO EMI-ERROR.
 13069
 13070     IF FILE-SWITCH = 'BENE'
 13071        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 13072           MOVE ER-0282          TO EMI-ERROR
 13073        ELSE
 13074           MOVE ER-0283          TO EMI-ERROR.
 13075
 13076     MOVE -1                     TO PMTTYPEL.
 13077     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13078
 13079     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 13080                                     WS-FORCE-CTR.
 13081
 13082     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 13083                                     WS-FATAL-CTR.
 13084
 13085     GO TO 8200-SEND-DATAONLY.
 13086
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 253
* EL156.cbl
 13088 2000-EDIT-DONE.
 13089     perform 2210-dcc-max-benes thru 2210-exit
 13090     if pi-company-id not = 'DCC' and 'VPP'
 13091        IF (WS-SPECIAL-CALC-CD = 'C')
 13092           and (cl-critical-period > 0)
 13093           IF CM-AH-BENEFIT-AMT NOT = ZERO
 13094              IF PI-EPYAMT > ZEROS
 13095                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 13096                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 13097              ELSE
 13098                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 13099                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 13100              END-IF
 13101              if ws-benefits-paid > cl-critical-period
 13102                 MOVE ER-0657          TO EMI-ERROR
 13103                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13104              END-IF
 13105           END-IF
 13106        END-IF
 13107     end-if
 13108     IF PI-HOLDTIL NOT = ZEROS
 13109        MOVE PI-HOLDTIL          TO HOLDTILO
 13110        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'
 13111        MOVE ER-3272          TO EMI-ERROR
 13112        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13113     END-IF
 13114
 13115     IF PI-EPYFROM NOT = ZEROS
 13116        MOVE PI-EPYFROM          TO EPYFROMO
 13117        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 13118
 13119     IF PI-EPYTHRU NOT = ZEROS
 13120        MOVE PI-EPYTHRU            TO EPYTHRUO
 13121        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 13122        IF PI-USES-PAID-TO
 13123           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13124           MOVE '4'                TO DC-OPTION-CODE
 13125           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13126           IF NO-CONVERSION-ERROR
 13127              MOVE +1              TO DC-ELAPSED-DAYS
 13128              MOVE +0              TO DC-ELAPSED-MONTHS
 13129              MOVE '6'             TO DC-OPTION-CODE
 13130              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13131              IF NO-CONVERSION-ERROR
 13132                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13133
 13134     MOVE PI-EDAYS               TO EDAYSO.
 13135
 13136     IF PI-AIGFROM NOT = ZEROS
 13137        MOVE PI-AIGFROM          TO AIGFROMO
 13138        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13139
 13140     MOVE PI-EPYAMT              TO EPYAMTO.
 13141     MOVE PI-ERESV               TO ERESVO.
 13142     MOVE PI-EEXPENS             TO EEXPENSO.
 13143
 13144     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13145     MOVE SPACES                 TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 254
* EL156.cbl
 13146     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13147
 13148     IF DATE-CONVERSION-ERROR
 13149        MOVE SPACES              TO CPYFROMI
 13150     ELSE
 13151        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 13152        IF PI-EPYFROM = ZEROS
 13153           MOVE AL-UANON             TO EPYFROMA
 13154           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 13155           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 13156
 13157     IF PI-USES-PAID-TO
 13158        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 13159        MOVE +1                            TO DC-ELAPSED-DAYS
 13160        MOVE +0                            TO DC-ELAPSED-MONTHS
 13161        MOVE '6'                           TO DC-OPTION-CODE
 13162        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13163        IF NO-CONVERSION-ERROR
 13164           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 13165           IF PI-EPYTHRU = ZEROS
 13166              MOVE AL-UANON                TO EPYTHRUA
 13167              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 13168              MOVE ' '                     TO DC-OPTION-CODE
 13169              MOVE +0                      TO DC-ELAPSED-DAYS
 13170                                              DC-ELAPSED-MONTHS
 13171              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13172              IF NO-CONVERSION-ERROR
 13173                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 13174                  GO TO 2001-CONTINUE
 13175              ELSE
 13176                  GO TO 2001-CONTINUE
 13177           ELSE
 13178              GO TO 2001-CONTINUE.
 13179
 13180     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13181     MOVE SPACES                 TO DC-OPTION-CODE.
 13182     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13183
 13184     IF DATE-CONVERSION-ERROR
 13185        MOVE SPACES              TO CPYTHRUI
 13186     ELSE
 13187        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13188        IF PI-EPYTHRU = ZEROS
 13189           MOVE AL-UANON TO EPYTHRUA
 13190           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 13191           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 13192
 13193 2001-CONTINUE.
 13194
 13195     MOVE PI-CDAYS               TO CDAYSO.
 13196
 13197     IF PI-EDAYS = ZEROS
 13198        MOVE AL-UNNON TO EDAYSA
 13199        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 13200
 13201     MOVE PI-CPYAMT              TO CPYAMTO.
 13202
 13203     IF PI-EPYAMT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 255
* EL156.cbl
 13204        MOVE AL-UNNON            TO EPYAMTA
 13205        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 13206
 13207     MOVE PI-CRESV               TO CRESVO.
 13208     MOVE PI-CEXPENS             TO CEXPENSO.
 13209
 13210     IF PI-EEXPENS = ZEROS
 13211        MOVE AL-UNNON TO EEXPENSA
 13212        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 13213
 13214     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13215        AND (CL-CLAIM-TYPE = 'L')
 13216        AND (PI-OFFLINE NOT EQUAL 'Y')
 13217        IF PI-PMTTYPE = '2' OR '4'
 13218           PERFORM 2200-CALC-INTEREST
 13219                                 THRU 2200-EXIT
 13220        END-IF
 13221     END-IF
 13222     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 13223     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 13224     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 13225
 13226     IF EMI-FATAL-CTR = ZEROS
 13227        MOVE 'B'                 TO PI-PASS-SW.
 13228
 13229     IF NOT EMI-MESSAGE-FORMATTED
 13230         MOVE -1                 TO EPYFROML
 13231     ELSE
 13232         IF EMI-ERROR-NUMBER (1) = '0526' AND
 13233            EMI-ERROR-NUMBER (2) = SPACES
 13234             MOVE -1             TO EPYFROML.
 13235
 13236     GO TO 8200-SEND-DATAONLY.
 13237
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 256
* EL156.cbl
 13239 2200-CALC-INTEREST.
 13240     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 13241        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 13242        MOVE '4'                 TO DC-OPTION-CODE
 13243        PERFORM 9700-LINK-DATE-CONVERT
 13244        IF DATE-CONVERSION-ERROR
 13245            MOVE LOW-VALUES      TO CP-PRF-DT
 13246        ELSE
 13247           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 13248        END-IF
 13249     END-IF
 13250     if (pi-int-to-rem-borr <> 'Y' and 'N')
 13251        if pi-rb-joint-coverage
 13252           move 'Y'              to pi-int-to-rem-borr
 13253        end-if
 13254     end-if
 13255     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 13256        IN CLAIM-INT-PASS-AREA
 13257     MOVE CL-CERT-STATE          TO CP-STATE
 13258        IN CLAIM-INT-PASS-AREA
 13259     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 13260     MOVE 'LF'                   TO CP-COVERAGE
 13261     MOVE CL-INCURRED-DT         TO CP-INC-DT
 13262     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 13263     MOVE LOW-VALUES             TO CP-LSTPD-DT
 13264     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 13265     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 13266     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 13267
 13268* EXEC CICS LINK
 13269*       PROGRAM   ('ELCLMI')
 13270*       COMMAREA  (CLAIM-INT-PASS-AREA)
 13271*       LENGTH    (CP-CLAIM-LENGTH)
 13272*    END-EXEC
 13273     MOVE 'ELCLMI' TO DFHEIV1
 13274*    MOVE '."C                   (   #00012680' TO DFHEIV0
 13275     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13276     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13277     MOVE X'2020233030303132363830' TO DFHEIV0(25:11)
 13278     CALL 'kxdfhei1' USING DFHEIV0,
 13279           DFHEIV1,
 13280           CLAIM-INT-PASS-AREA,
 13281           CP-CLAIM-LENGTH,
 13282           DFHEIV99,
 13283           DFHEIV99,
 13284           DFHEIV99,
 13285           DFHEIV99
 13286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13287     MOVE AL-PANOF               TO PINTHA
 13288                                    PINTA
 13289     if cp-clm-int-amt = zeros
 13290        move ' ' to pi-int-to-rem-borr
 13291     end-if
 13292     IF NO-CI-ERROR
 13293        MOVE CP-CLM-INT-AMT      TO PINTO
 13294                                    PI-INT-AMT
 13295        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 13296        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 257
* EL156.cbl
 13297        MOVE AL-PANOF            TO PINTHA
 13298                                    PINTA
 13299        if pi-rb-joint-coverage
 13300           and pi-int-amt > zeros
 13301           move '  INT TO'       to itrb1o
 13302           move ' REM BORR?'     to itrb2o
 13303           move pi-int-to-rem-borr
 13304                                 to itrbyno
 13305           move al-uanon         to itrbyna
 13306           move +1               to itrbynl
 13307        else
 13308           move ' '              to pi-int-to-rem-borr
 13309        end-if
 13310     ELSE
 13311        IF CI-RETURN-CODE = '8'
 13312           MOVE ER-3818          TO EMI-ERROR
 13313           MOVE -1               TO ZINTL
 13314           PERFORM 9900-ERROR-FORMAT
 13315                                 THRU 9900-EXIT
 13316           GO TO 2200-EXIT
 13317        ELSE
 13318           MOVE ZEROS            TO PINTO
 13319                                    PI-INT-AMT
 13320                                    PI-INT-DAYS
 13321                                    PI-INT-RATE-USED
 13322        END-IF
 13323     END-IF
 13324     IF PI-INT-AMT NOT = ZEROS
 13325        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 13326           AND (CL-SOC-SEC-NO NOT = ZEROS)
 13327           CONTINUE
 13328        ELSE
 13329           MOVE CL-SOC-SEC-NO (1:3)
 13330                                 TO WS-SSN (1:3)
 13331           MOVE CL-SOC-SEC-NO (5:2)
 13332                                 TO WS-SSN (4:2)
 13333           MOVE CL-SOC-SEC-NO (8:4)
 13334                                 TO WS-SSN (6:4)
 13335           IF (WS-SSN NUMERIC)
 13336              AND (WS-SSN NOT = ZEROS)
 13337              CONTINUE
 13338           ELSE
 13339              MOVE ER-2044       TO EMI-ERROR
 13340              PERFORM 9900-ERROR-FORMAT
 13341                                 THRU 9900-EXIT
 13342           END-IF
 13343        END-IF
 13344        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13345        if pi-int-to-rem-borr = 'Y'
 13346           move +61              to trlr-seq-no
 13347        else
 13348           MOVE +51              TO TRLR-SEQ-NO
 13349        end-if
 13350
 13351* EXEC CICS READ
 13352*          DATASET  ('ELTRLR')
 13353*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13354*          RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 258
* EL156.cbl
 13355*          RESP     (WS-RESPONSE)
 13356*       END-EXEC
 13357     MOVE 'ELTRLR' TO DFHEIV1
 13358*    MOVE '&"S        E          (  N#00012748' TO DFHEIV0
 13359     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13360     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13361     MOVE X'204E233030303132373438' TO DFHEIV0(25:11)
 13362     CALL 'kxdfhei1' USING DFHEIV0,
 13363           DFHEIV1,
 13364           DFHEIV20,
 13365           DFHEIV99,
 13366           ELTRLR-KEY,
 13367           DFHEIV99,
 13368           DFHEIV99,
 13369           DFHEIV99
 13370     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13371         DFHEIV20
 13372     MOVE EIBRESP  TO WS-RESPONSE
 13373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13374        IF (NOT WS-RESP-NORMAL)
 13375                    OR
 13376           ((WS-RESP-NORMAL)
 13377           AND ((AT-ADDRESS-LINE-1 = SPACES)
 13378           OR (AT-CITY-STATE = SPACES)))
 13379           MOVE ER-0874          TO EMI-ERROR
 13380           if pi-rb-joint-coverage
 13381              move -1            to itrbynl
 13382           end-if
 13383           PERFORM 9900-ERROR-FORMAT
 13384                                 THRU 9900-EXIT
 13385        else
 13386           move at-mail-to-name  to pi-int-payees-name
 13387        END-IF
 13388     END-IF
 13389     .
 13390 2200-EXIT.
 13391     EXIT.
 13392 2210-dcc-max-benes.
 13393
 13394     move pi-ah-term             to ws-max-bens
 13395     if cl-critical-period not = zeros and spaces
 13396        move cl-critical-period  to ws-max-bens
 13397     end-if
 13398     move cm-ah-benefit-amt      to ws-monthly-benefit
 13399     if pdef-found
 13400        and (pd-max-amt (p1) not = zeros)
 13401        if pd-ben-pct (p1) not numeric
 13402           move zeros            to pd-ben-pct (p1)
 13403        end-if
 13404        if pd-ben-pct (p1) = zeros
 13405           move +1               to ws-work-ben-pct
 13406        else
 13407           move pd-ben-pct (p1)  to ws-work-ben-pct
 13408        end-if
 13409*       compute ws-monthly-benefit =
 13410*          ws-monthly-benefit * ws-work-ben-pct
 13411*       if ws-monthly-benefit > pd-max-amt (p1)
 13412*          move pd-max-amt (p1) to ws-monthly-benefit
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 259
* EL156.cbl
 13413*       end-if
 13414     end-if
 13415
 13416     move cl-cert-key-data       to elcrtt-key (2:21)
 13417     move cl-company-cd          to ctrlr-comp-cd
 13418     move cl-cert-no             to ctrlr-cert-no
 13419     move 'B'                    to ctrlr-rec-type
 13420
 13421
 13422* EXEC CICS READ
 13423*       DATASET  ('ELCRTT')
 13424*       set      (address of CERTIFICATE-TRAILERS)
 13425*       RIDFLD   (ELCRTT-KEY)
 13426*       RESP     (WS-RESPONSE)
 13427*    END-EXEC
 13428     MOVE 'ELCRTT' TO DFHEIV1
 13429*    MOVE '&"S        E          (  N#00012801' TO DFHEIV0
 13430     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13431     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13432     MOVE X'204E233030303132383031' TO DFHEIV0(25:11)
 13433     CALL 'kxdfhei1' USING DFHEIV0,
 13434           DFHEIV1,
 13435           DFHEIV20,
 13436           DFHEIV99,
 13437           ELCRTT-KEY,
 13438           DFHEIV99,
 13439           DFHEIV99,
 13440           DFHEIV99
 13441     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13442         DFHEIV20
 13443     MOVE EIBRESP  TO WS-RESPONSE
 13444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13445     IF not WS-RESP-NORMAL
 13446        go to 2210-exit
 13447     end-if
 13448
 13449*    if instypei = 'P'
 13450*       move +1 to s1
 13451*    else
 13452*       MOVE +2 to s1
 13453*    end-if
 13454
 13455*    move +1 to s1
 13456*    evaluate cl-claim-type
 13457*       when 'A'
 13458*          move +1 to s2
 13459*       when 'I'
 13460*          move +2 to s2
 13461*       when 'G'
 13462*          move +3 to s2
 13463*       when 'L'
 13464*          move +4 to s2
 13465*       when 'P'
 13466*          move +5 to s2
 13467*    end-evaluate
 13468
 13469     move zeros                  to ws-prev-days-paid
 13470                                    ws-benefits-paid
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 260
* EL156.cbl
 13471                                    ws-prev-amt-paid
 13472     perform varying s1 from +1 by +1 until
 13473        (s1 > +24)
 13474        or (cs-claim-type (s1) = spaces)
 13475        if pi-company-id not = 'DCC' and 'VPP'
 13476           if cs-claim-type (s1) = cl-claim-type
 13477              compute ws-prev-days-paid =
 13478                 ws-prev-days-paid + cs-days-paid (s1)
 13479              compute ws-prev-amt-paid =
 13480                 ws-prev-amt-paid + cs-total-paid (s1)
 13481           end-if
 13482        else
 13483           if (cs-claim-type (s1) = cl-claim-type)
 13484              and (cs-benefit-period (s1) = cl-benefit-period)
 13485              and (cs-insured-type (s1) = cl-insured-type)
 13486              compute ws-prev-days-paid =
 13487                 ws-prev-days-paid + cs-days-paid (s1)
 13488              compute ws-prev-amt-paid =
 13489                 ws-prev-amt-paid + cs-total-paid (s1)
 13490           end-if
 13491        end-if
 13492     end-perform
 13493     if pi-epyamt > zeros
 13494        compute ws-benefits-paid =
 13495           (ws-prev-amt-paid + pi-epyamt)
 13496           / ws-monthly-benefit
 13497     else
 13498        compute ws-benefits-paid =
 13499           (ws-prev-amt-paid + pi-cpyamt)
 13500           / ws-monthly-benefit
 13501     end-if
 13502*    if pi-company-id = 'DCC'
 13503     if cl-claim-type not = 'L' and 'O' and 'P'
 13504        if ws-benefits-paid > ws-max-bens
 13505           move er-1658          to emi-error
 13506           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13507        end-if
 13508     end-if
 13509*    end-if
 13510*     if s1 < +25
 13511*        if pi-epyamt > zeros
 13512*           compute ws-benefits-paid =
 13513*              (cs-total-paid (s1) + PI-EPYAMT)
 13514*              / ws-monthly-benefit
 13515*        else
 13516*           compute ws-benefits-paid =
 13517*              (cs-total-paid (s1) + PI-CPYAMT)
 13518*              / ws-monthly-benefit
 13519*        end-if
 13520
 13521*       if ws-benefits-paid > pd-crit-period (p1)
 13522*        if ws-benefits-paid > ws-max-bens
 13523*           move er-1658          to emi-error
 13524*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13525*        end-if
 13526*     end-if
 13527     .
 13528 2210-exit.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 261
* EL156.cbl
 13529     exit.
 13530
 13531 2220-update-elcrtt.
 13532
 13533
 13534* EXEC CICS GETMAIN
 13535*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13536*       LENGTH   (ELCRTT-LENGTH)
 13537*       INITIMG  (GETMAIN-SPACE)
 13538*    END-EXEC
 13539*    MOVE ',"IL                  $   #00012895' TO DFHEIV0
 13540     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13541     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13542     MOVE X'2020233030303132383935' TO DFHEIV0(25:11)
 13543     CALL 'kxdfhei1' USING DFHEIV0,
 13544           DFHEIV20,
 13545           ELCRTT-LENGTH,
 13546           GETMAIN-SPACE
 13547     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13548         DFHEIV20
 13549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13550
 13551     move cl-cert-key-data       to elcrtt-key (2:21)
 13552     move cl-company-cd          to ctrlr-comp-cd
 13553     move cl-cert-no             to ctrlr-cert-no
 13554     move 'B'                    to ctrlr-rec-type
 13555
 13556
 13557* EXEC CICS READ
 13558*       UPDATE
 13559*       DATASET  (ELCRTT-DSID)
 13560*       into     (CERTIFICATE-TRAILERS)
 13561*       RIDFLD   (ELCRTT-KEY)
 13562*       RESP     (WS-RESPONSE)
 13563*    END-EXEC
 13564     MOVE LENGTH OF
 13565      CERTIFICATE-TRAILERS
 13566       TO DFHEIV11
 13567*    MOVE '&"IL       EU         (  N#00012906' TO DFHEIV0
 13568     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13569     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13570     MOVE X'204E233030303132393036' TO DFHEIV0(25:11)
 13571     CALL 'kxdfhei1' USING DFHEIV0,
 13572           ELCRTT-DSID,
 13573           CERTIFICATE-TRAILERS,
 13574           DFHEIV11,
 13575           ELCRTT-KEY,
 13576           DFHEIV99,
 13577           DFHEIV99,
 13578           DFHEIV99
 13579     MOVE EIBRESP  TO WS-RESPONSE
 13580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13581
 13582     IF WS-RESP-NORMAL
 13583        perform 2225-upd-crt-trlr thru 2225-exit
 13584
 13585* EXEC CICS REWRITE
 13586*          DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 262
* EL156.cbl
 13587*          from     (CERTIFICATE-TRAILERS)
 13588*          RESP     (WS-RESPONSE)
 13589*       END-EXEC
 13590     MOVE LENGTH OF
 13591      CERTIFICATE-TRAILERS
 13592       TO DFHEIV11
 13593*    MOVE '&& L                  %  N#00012916' TO DFHEIV0
 13594     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13595     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13596     MOVE X'204E233030303132393136' TO DFHEIV0(25:11)
 13597     CALL 'kxdfhei1' USING DFHEIV0,
 13598           ELCRTT-DSID,
 13599           CERTIFICATE-TRAILERS,
 13600           DFHEIV11,
 13601           DFHEIV99
 13602     MOVE EIBRESP  TO WS-RESPONSE
 13603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13604     else
 13605        if ws-resp-notfnd
 13606           move 'CS'             to certificate-trailers
 13607           move cl-company-cd    to cs-company-cd
 13608           move cl-cert-key-data to cs-control-primary (2:21)
 13609           move cl-cert-no       to cs-cert-no
 13610           move 'B'              to cs-trailer-type
 13611           perform varying s1 from +1 by +1 until s1 > +24
 13612              move zeros         to cs-benefit-period (s1)
 13613                                    cs-days-paid (s1)
 13614                                    cs-total-paid (s1)
 13615                                    cs-remaining-bens (s1)
 13616           end-perform
 13617           perform 2225-upd-crt-trlr
 13618                                 thru 2225-exit
 13619
 13620* EXEC CICS WRITE
 13621*             DATASET  (ELCRTT-DSID)
 13622*             from     (CERTIFICATE-TRAILERS)
 13623*             RIDFLD   (cs-control-primary)
 13624*             RESP     (WS-RESPONSE)
 13625*          END-EXEC
 13626     MOVE LENGTH OF
 13627      CERTIFICATE-TRAILERS
 13628       TO DFHEIV11
 13629*    MOVE '&$ L                  ''  N#00012936' TO DFHEIV0
 13630     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13631     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13632     MOVE X'204E233030303132393336' TO DFHEIV0(25:11)
 13633     CALL 'kxdfhei1' USING DFHEIV0,
 13634           ELCRTT-DSID,
 13635           CERTIFICATE-TRAILERS,
 13636           DFHEIV11,
 13637           cs-control-primary,
 13638           DFHEIV99,
 13639           DFHEIV99
 13640     MOVE EIBRESP  TO WS-RESPONSE
 13641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13642        end-if
 13643     END-IF
 13644
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 263
* EL156.cbl
 13645     .
 13646 2220-exit.
 13647     exit.
 13648
 13649 2225-upd-crt-trlr.
 13650
 13651*    if instypei = 'P'
 13652*       move +1 to s1
 13653*    else
 13654*       MOVE +2 to s1
 13655*    end-if
 13656
 13657*    move +1 to s1
 13658*    evaluate cl-claim-type
 13659*       when 'A'
 13660*          move +1 to s2
 13661*       when 'I'
 13662*          move +2 to s2
 13663*       when 'G'
 13664*          move +3 to s2
 13665*       when 'L'
 13666*          move +4 to s2
 13667*       when 'P'
 13668*          move +5 to s2
 13669*    end-evaluate
 13670     perform varying s1 from +1 by +1 until
 13671        (s1 > +24)
 13672        or (cl-claim-no = cs-claim-no (s1))
 13673     end-perform
 13674     if s1 < +25
 13675        compute cs-total-paid (s1) =
 13676           cs-total-paid (s1) + at-amount-paid
 13677        compute cs-days-paid (s1) =
 13678           cs-days-paid (s1) +  at-days-in-period
 13679*       compute cs-remaining-bens (s1) =
 13680*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13681        perform 2230-accum-bens-paid thru 2230-exit
 13682     end-if
 13683
 13684     .
 13685 2225-exit.
 13686     exit.
 13687 2230-accum-bens-paid.
 13688     if cl-claim-type not = 'L' and 'O' and 'P'
 13689        move pi-ah-term          to ws-max-bens
 13690        if cl-critical-period not = zeros and spaces
 13691           move cl-critical-period
 13692                                 to ws-max-bens
 13693        end-if
 13694     else
 13695        move 01                  to ws-max-bens
 13696     end-if
 13697     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13698     perform varying s2 from +1 by +1 until
 13699        (s2 > +24)
 13700        or (cs-claim-no (s2) = spaces)
 13701        if pi-company-id not = 'DCC' and 'VPP'
 13702           if cs-claim-type (s2) = cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 264
* EL156.cbl
 13703              compute ws-tot-days-paid =
 13704                 ws-tot-days-paid + cs-days-paid (s2)
 13705              compute ws-tot-amt-paid =
 13706                 ws-tot-amt-paid + cs-total-paid (s2)
 13707           end-if
 13708        else
 13709           if (cs-benefit-period (s2) = cl-benefit-period)
 13710              and (cs-claim-type (s2) = cl-claim-type)
 13711              and (cs-insured-type (s2) = cl-insured-type)
 13712              compute ws-tot-days-paid =
 13713                 ws-tot-days-paid + cs-days-paid (s2)
 13714              compute ws-tot-amt-paid =
 13715                 ws-tot-amt-paid + cs-total-paid (s2)
 13716           end-if
 13717        end-if
 13718     end-perform
 13719     if cl-claim-type = 'L' or 'P' or 'O'
 13720        if ws-tot-amt-paid > zeros
 13721           move zeros            to cs-remaining-bens (s1)
 13722        else
 13723           move 01               to cs-remaining-bens (s1)
 13724        end-if
 13725     else
 13726        compute ws-pd-bens rounded =
 13727           ws-tot-amt-paid / pi-ah-benefit-amt
 13728        compute cs-remaining-bens (s1) =
 13729           ws-max-bens - ws-pd-bens
 13730        if cs-remaining-bens (s1) < zeros
 13731           move zeros            to cs-remaining-bens (s1)
 13732        end-if
 13733     end-if
 13734     .
 13735 2230-exit.
 13736     exit.
 13737 3000-MOVE-INPUT-TO-SAVE-AREA.
 13738     IF PMTTYPEL > 0
 13739         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13740
 13741     if ws-pmttype = '4'
 13742        if pi-rb-joint-coverage
 13743           if payeel = +0
 13744              move +2            to payeel
 13745              move al-uanon      to payeea
 13746              move 'Q1'          to payeeo
 13747           else
 13748              if payeei not = 'Q1' and 'q1'
 13749                 move er-1582    to emi-error
 13750                 PERFORM 9900-ERROR-FORMAT thru 9900-exit
 13751              end-if
 13752           end-if
 13753        end-if
 13754     end-if
 13755     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13756
 13757     IF WS-PMTTYPE = '9'
 13758         MOVE 'P'                TO PI-PROVISIONAL-IND
 13759         MOVE '1'                TO WS-PMTTYPE.
 13760
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 265
* EL156.cbl
 13761     IF PAYEEL > 0
 13762         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13763         MOVE PAYEEI             TO WS-PAYEE.
 13764
 13765     IF NOTE1L > +0
 13766         MOVE NOTE1I             TO WS-PMTNOTE1
 13767                                    WS-FLI-PMTNOTE
 13768                                    WS-HAN-PMTNOTE.
 13769
 13770     IF NOTE2L > +0
 13771         MOVE NOTE2I             TO WS-PMTNOTE2.
 13772
 13773     IF OFFLINEL > 0
 13774         MOVE OFFLINEI           TO WS-OFFLINE.
 13775
 13776     IF PROOFDTL > 0
 13777         MOVE PROOFDTI            TO DATE-WORK
 13778         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13779         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13780         MOVE '4'                 TO DC-OPTION-CODE
 13781         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13782         IF NO-CONVERSION-ERROR
 13783            MOVE NUM-WORK         TO PROOFDTO
 13784            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13785            MOVE NUM-WORK         TO WS-PROOF-DATE
 13786         ELSE
 13787            MOVE ZEROS            TO WS-PROOF-DATE
 13788         END-IF
 13789     END-IF.
 13790
 13791     IF EOBYNL > +0
 13792         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13793         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13794     END-IF
 13795
 13796     IF CLMFMYNL > +0
 13797         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13798         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13799     END-IF
 13800
 13801     IF SURVYYNL > +0
 13802         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13803         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13804     END-IF
 13805
 13806     IF SPRELYNL > +0
 13807         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13808         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13809     END-IF
 13810     if itrbynl <> +0
 13811        move function upper-case(itrbyni) to itrbyni
 13812        move itrbyni             to ws-int-to-rem-borr
 13813     end-if
 13814*    IF GROUPEDL > +0
 13815*        MOVE GROUPEDI           TO WS-GROUPED.
 13816*
 13817*    IF CASHL > +0
 13818*       MOVE CASHI               TO WS-CASH.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 266
* EL156.cbl
 13819     IF LOANNOL > +0
 13820         MOVE LOANNOI            TO WS-LOAN-NO.
 13821
 13822     IF CHECKNOL > 0
 13823         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13824
 13825     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13826         IF WS-AIG-CREDIT-ENTERED
 13827             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13828             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13829             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13830             MOVE AL-UANON         TO CHECKNOA.
 13831
 13832     IF HOLDTILL > 0
 13833         MOVE HOLDTILI           TO DATE-WORK
 13834         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13835         MOVE NUM-WORK           TO WS-HOLDTIL.
 13836
 13837     IF ZINTL > +0
 13838
 13839* EXEC CICS BIF DEEDIT
 13840*           FIELD   (ZINTI)
 13841*           LENGTH  (07)
 13842*       END-EXEC
 13843     MOVE 07
 13844       TO DFHEIV11
 13845*    MOVE '@"L                   #   #00013138' TO DFHEIV0
 13846     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13847     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13848     MOVE X'2020233030303133313338' TO DFHEIV0(25:11)
 13849     CALL 'kxdfhei1' USING DFHEIV0,
 13850           ZINTI,
 13851           DFHEIV11
 13852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13853        IF ZINTI NOT NUMERIC
 13854           MOVE ER-0419          TO EMI-ERROR
 13855           PERFORM 9900-ERROR-FORMAT
 13856           MOVE AL-UABON         TO ZINTA
 13857           MOVE -1               TO ZINTL
 13858        ELSE
 13859           MOVE ZINTI            TO CP-INT-RATE
 13860                                    WS-INT-RATE
 13861           MOVE CP-INT-RATE      TO ZINTO
 13862           MOVE AL-UNNON         TO ZINTA
 13863        END-IF
 13864     ELSE
 13865        MOVE ZEROS               TO CP-INT-RATE
 13866     END-IF
 13867     IF EPYFROML > 0
 13868         MOVE EPYFROMI           TO DATE-WORK
 13869         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13870         MOVE NUM-WORK           TO WS-EPYFROM.
 13871
 13872     IF AIGFROML > 0
 13873         MOVE AIGFROMI           TO DATE-WORK
 13874         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13875         MOVE NUM-WORK           TO WS-AIGFROM
 13876     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 267
* EL156.cbl
 13877         IF (AIGFROMI = LOW-VALUES) AND
 13878            (PI-AIGFROM NOT = ZEROS)
 13879              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13880
 13881     IF EPYTHRUL > +0
 13882        MOVE EPYTHRUI           TO DATE-WORK
 13883        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13884        MOVE NUM-WORK           TO WS-EPYTHRU
 13885        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13886        MOVE '4'                TO DC-OPTION-CODE
 13887        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13888        IF NO-CONVERSION-ERROR
 13889           IF PI-USES-PAID-TO
 13890              MOVE '6'                TO DC-OPTION-CODE
 13891              MOVE -1                 TO DC-ELAPSED-DAYS
 13892              MOVE +0                 TO DC-ELAPSED-MONTHS
 13893              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13894              IF NO-CONVERSION-ERROR
 13895                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13896                 MOVE ' '             TO DC-OPTION-CODE
 13897                 MOVE +0              TO DC-ELAPSED-DAYS
 13898                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13899              IF NO-CONVERSION-ERROR
 13900                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13901
 13902*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13903*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13904     IF EDAYSL > 0
 13905
 13906* EXEC CICS BIF DEEDIT
 13907*            FIELD(EDAYSI)
 13908*            LENGTH(6)
 13909*        END-EXEC
 13910     MOVE 6
 13911       TO DFHEIV11
 13912*    MOVE '@"L                   #   #00013194' TO DFHEIV0
 13913     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13914     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13915     MOVE X'2020233030303133313934' TO DFHEIV0(25:11)
 13916     CALL 'kxdfhei1' USING DFHEIV0,
 13917           EDAYSI,
 13918           DFHEIV11
 13919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13920         MOVE EDAYSI             TO WS-DY-WORK
 13921         IF WS-DY-SIGN = SPACES
 13922            MOVE WS-DY-NUM       TO WS-EDAYS
 13923            ADD 0                TO WS-EDAYS
 13924         ELSE
 13925            MOVE EDAYSI          TO WS-EDAYS
 13926            ADD 0                TO WS-EDAYS.
 13927
 13928*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13929*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13930     IF EPYAMTL > 0
 13931
 13932* EXEC CICS BIF DEEDIT
 13933*            FIELD(EPYAMTI)
 13934*            LENGTH(10)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 268
* EL156.cbl
 13935*        END-EXEC
 13936     MOVE 10
 13937       TO DFHEIV11
 13938*    MOVE '@"L                   #   #00013209' TO DFHEIV0
 13939     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13940     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13941     MOVE X'2020233030303133323039' TO DFHEIV0(25:11)
 13942     CALL 'kxdfhei1' USING DFHEIV0,
 13943           EPYAMTI,
 13944           DFHEIV11
 13945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13946         MOVE EPYAMTI            TO WS-PY-WORK
 13947         IF WS-PY-SIGN = SPACES
 13948            MOVE WS-PY-NUM       TO WS-EPYAMT
 13949            ADD 0                TO WS-EPYAMT
 13950         ELSE
 13951            MOVE EPYAMTI         TO WS-EPYAMT
 13952            ADD 0                TO WS-EPYAMT.
 13953
 13954     IF ERESVL > 0
 13955
 13956* EXEC CICS BIF DEEDIT
 13957*            FIELD(ERESVI)
 13958*            LENGTH(9)
 13959*        END-EXEC
 13960     MOVE 9
 13961       TO DFHEIV11
 13962*    MOVE '@"L                   #   #00013222' TO DFHEIV0
 13963     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13964     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13965     MOVE X'2020233030303133323232' TO DFHEIV0(25:11)
 13966     CALL 'kxdfhei1' USING DFHEIV0,
 13967           ERESVI,
 13968           DFHEIV11
 13969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13970         MOVE ERESVI TO WS-ERESV.
 13971
 13972     IF EEXPENSL > 0
 13973
 13974* EXEC CICS BIF DEEDIT
 13975*            FIELD(EEXPENSI)
 13976*            LENGTH(8)
 13977*        END-EXEC
 13978     MOVE 8
 13979       TO DFHEIV11
 13980*    MOVE '@"L                   #   #00013229' TO DFHEIV0
 13981     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13982     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13983     MOVE X'2020233030303133323239' TO DFHEIV0(25:11)
 13984     CALL 'kxdfhei1' USING DFHEIV0,
 13985           EEXPENSI,
 13986           DFHEIV11
 13987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13988         MOVE EEXPENSI           TO WS-EEXPENS.
 13989
 13990     IF ETYPEL > ZEROS
 13991         MOVE ETYPEI             TO WS-ETYPE.
 13992
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 269
* EL156.cbl
 13993     IF PI-COMPANY-ID = 'BOA'
 13994        IF PINTL > ZEROS
 13995
 13996* EXEC CICS BIF DEEDIT
 13997*            FIELD (PINTI)
 13998*            LENGTH(05)
 13999*          END-EXEC
 14000     MOVE 05
 14001       TO DFHEIV11
 14002*    MOVE '@"L                   #   #00013240' TO DFHEIV0
 14003     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14004     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14005     MOVE X'2020233030303133323430' TO DFHEIV0(25:11)
 14006     CALL 'kxdfhei1' USING DFHEIV0,
 14007           PINTI,
 14008           DFHEIV11
 14009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14010           IF PINTI NUMERIC
 14011               MOVE AL-UNNON     TO PINTA
 14012               MOVE PINTI        TO WS-INT-RATE
 14013               MOVE WS-INT-RATE  TO PINTO.
 14014
 14015 3000-EXIT.
 14016     EXIT.
 14017
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 270
* EL156.cbl
 14019 3050-REBUILD-ENTERED.
 14020
 14021     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 14022
 14023     IF PI-PROV-PMT
 14024         MOVE '9'           TO PMTTYPEO
 14025     ELSE
 14026         MOVE PI-PMTTYPE    TO PMTTYPEO.
 14027
 14028     MOVE PI-PAYEE          TO PAYEEO.
 14029     MOVE PI-PMTNOTE1       TO NOTE1O.
 14030     MOVE PI-PMTNOTE2       TO NOTE2O.
 14031     MOVE PI-OFFLINE        TO OFFLINEO.
 14032     IF PI-PROOF-DATE NOT = ZEROS
 14033         MOVE PI-PROOF-DATE TO PROOFDTO
 14034         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 14035     END-IF.
 14036*    MOVE PI-GROUPED        TO GROUPEDO.
 14037
 14038*    MOVE PI-CASH           TO CASHO.
 14039
 14040     IF PI-INT-RATE > ZEROS
 14041        MOVE PI-INT-RATE         TO PINTO
 14042     end-if
 14043     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14044        IF PI-INT-AMT > ZEROS
 14045           MOVE PI-INT-AMT       TO PINTO
 14046           MOVE AL-PANOF         TO PINTA
 14047                                    PINTHA
 14048           if pi-rb-joint-coverage
 14049              move '  INT TO'    to itrb1o
 14050              move ' REM BORR?'  to itrb2o
 14051              move 'Y'           to itrbyno
 14052              move al-uanon      to itrbyna
 14053              move +1            to itrbynl
 14054           end-if
 14055        END-IF
 14056     END-IF
 14057     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 14058     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 14059     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 14060     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 14061     IF PI-HOLDTIL NOT = ZEROS
 14062        MOVE PI-HOLDTIL          TO HOLDTILO
 14063        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 14064
 14065     IF PI-EPYFROM NOT = ZEROS
 14066        MOVE PI-EPYFROM          TO EPYFROMO
 14067        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 14068
 14069     IF PI-AIGFROM NOT = ZEROS
 14070        MOVE PI-AIGFROM          TO AIGFROMO
 14071        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 14072
 14073     IF PI-EPYTHRU NOT = ZEROS
 14074        MOVE PI-EPYTHRU          TO EPYTHRUO
 14075        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 14076        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 271
* EL156.cbl
 14077           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 14078           MOVE '4'                TO DC-OPTION-CODE
 14079           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14080           IF NO-CONVERSION-ERROR
 14081              MOVE +1 TO DC-ELAPSED-DAYS
 14082              MOVE +0 TO DC-ELAPSED-MONTHS
 14083              MOVE '6' TO DC-OPTION-CODE
 14084              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14085              IF NO-CONVERSION-ERROR
 14086                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 14087
 14088     IF PI-EDAYS NOT = ZEROS
 14089        MOVE PI-EDAYS TO EDAYSO.
 14090
 14091     IF PI-EPYAMT NOT = ZEROS
 14092        MOVE PI-EPYAMT TO EPYAMTO.
 14093
 14094     IF PI-ERESV NOT = ZEROS
 14095        MOVE PI-ERESV TO ERESVO.
 14096
 14097     IF PI-EEXPENS NOT = ZEROS
 14098        MOVE PI-EEXPENS TO EEXPENSO.
 14099
 14100     MOVE PI-ETYPE TO ETYPEO.
 14101
 14102     IF PI-ECHECKNO NOT = SPACES
 14103        MOVE PI-ECHECKNO         TO CHECKNOO
 14104     ELSE
 14105        MOVE PI-CCHECKNO         TO CHECKNOO.
 14106
 14107     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 14108     MOVE SPACES                 TO DC-OPTION-CODE.
 14109     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14110
 14111     IF DATE-CONVERSION-ERROR
 14112        MOVE SPACES              TO CPYFROMI
 14113     ELSE
 14114        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 14115
 14116     IF PI-USES-PAID-TO
 14117        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 14118        MOVE +1                  TO DC-ELAPSED-DAYS
 14119        MOVE +0                  TO DC-ELAPSED-MONTHS
 14120        MOVE '6'                 TO DC-OPTION-CODE
 14121        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14122        IF NO-CONVERSION-ERROR
 14123           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 14124           GO TO 3051-CONTINUE.
 14125
 14126     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 14127     MOVE SPACES                 TO DC-OPTION-CODE.
 14128     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14129
 14130     IF DATE-CONVERSION-ERROR
 14131        MOVE SPACES              TO CPYTHRUI
 14132     ELSE
 14133        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 14134
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 272
* EL156.cbl
 14135 3051-CONTINUE.
 14136
 14137     IF PI-CDAYS NOT = ZEROS
 14138        MOVE PI-CDAYS TO CDAYSO.
 14139
 14140     IF PI-CPYAMT NOT = ZEROS
 14141        MOVE PI-CPYAMT TO CPYAMTO.
 14142
 14143     IF PI-CRESV NOT = ZEROS
 14144        MOVE PI-CRESV TO CRESVO.
 14145
 14146     IF PI-CEXPENS NOT = ZEROS
 14147        MOVE PI-CEXPENS TO CEXPENSO.
 14148
 14149 3059-EXIT.
 14150     EXIT.
 14151
 14152 3100-DEEDIT-DATE.
 14153
 14154* EXEC CICS BIF DEEDIT
 14155*        FIELD(DATE-WORK)
 14156*        LENGTH(8)
 14157*    END-EXEC.
 14158     MOVE 8
 14159       TO DFHEIV11
 14160*    MOVE '@"L                   #   #00013387' TO DFHEIV0
 14161     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14162     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14163     MOVE X'2020233030303133333837' TO DFHEIV0(25:11)
 14164     CALL 'kxdfhei1' USING DFHEIV0,
 14165           DATE-WORK,
 14166           DFHEIV11
 14167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14168
 14169
 14170 3100-EXIT.
 14171     EXIT.
 14172
 14173 3200-CALC-AIG-DAYS.
 14174
 14175     MOVE 'N'                    TO WS-DUE-DAY-SW.
 14176
 14177     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14178     MOVE ' '                    TO DC-OPTION-CODE.
 14179     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14180     IF NO-CONVERSION-ERROR
 14181         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 14182     ELSE
 14183         GO TO 3290-ERROR.
 14184
 14185     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14186         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14187                                WS-BIN-FROM-DT
 14188     ELSE
 14189         IF CL-TOTAL-PAID-AMT > ZEROS
 14190             IF WS-SV-EPYFROM = LOW-VALUES
 14191                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14192                                        WS-BIN-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 273
* EL156.cbl
 14193             ELSE
 14194                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14195                                        WS-BIN-FROM-DT
 14196         ELSE
 14197             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14198                                        WS-BIN-FROM-DT.
 14199
 14200 3210-CONTINUE.
 14201
 14202     MOVE ' '                    TO DC-OPTION-CODE.
 14203     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14204     IF DATE-CONVERSION-ERROR
 14205         GO TO 3290-ERROR.
 14206
 14207     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 14208
 14209     IF PI-LOAN-DUE-DAY = 31
 14210         MOVE 30              TO WS-PMT-DUE-DA
 14211                                 WS-SAVE-DUE-DA
 14212     ELSE
 14213         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 14214                                 WS-SAVE-DUE-DA.
 14215
 14216     IF (PI-LOAN-DUE-DAY > 28) AND
 14217        (WS-PMT-DUE-MO = 2)
 14218         MOVE 'Y'                TO WS-DUE-DAY-SW
 14219         MOVE 28                 TO WS-PMT-DUE-DA.
 14220
 14221     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 14222     MOVE '4'                    TO DC-OPTION-CODE.
 14223     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14224     IF NO-CONVERSION-ERROR
 14225         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 14226     ELSE
 14227         GO TO 3290-ERROR.
 14228
 14229*--------------------------------------------------------------*
 14230*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 14231*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 14232*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 14233*                                                              *
 14234*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 14235*             INCURRED DATE      - 04/15/91                    *
 14236*             PMT DUE DATE       - 04/03/91                    *
 14237*             PMT DUE DATE       - 05/03/91                    *
 14238*--------------------------------------------------------------*
 14239
 14240     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14241        (WS-SV-AIGFROM = LOW-VALUES)
 14242         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 14243            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 14244             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14245             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14246             IF NO-CONVERSION-ERROR
 14247                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14248                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14249             ELSE
 14250                 GO TO 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 274
* EL156.cbl
 14251
 14252     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14253        (WS-SV-AIGFROM = LOW-VALUES)
 14254         GO TO 3205-CONT-CALC-PMT.
 14255
 14256     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 14257     MOVE ' '                    TO DC-OPTION-CODE.
 14258     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14259     IF NO-CONVERSION-ERROR
 14260         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 14261     ELSE
 14262         GO TO 3290-ERROR.
 14263
 14264     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 14265        (WS-PMT-DUE-DA < WS-FROM-DA)
 14266          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14267          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14268          IF NO-CONVERSION-ERROR
 14269              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14270              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14271          ELSE
 14272              GO TO 3290-ERROR.
 14273
 14274 3205-CONT-CALC-PMT.
 14275
 14276*--------------------------------------------------------------*
 14277*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 14278*    BETWEEN THE PAY FROM / THRU DATES.                        *
 14279*--------------------------------------------------------------*
 14280
 14281     IF CL-TOTAL-PAID-AMT = ZEROS AND
 14282        PI-PMTTYPE = '2'
 14283          NEXT SENTENCE
 14284     ELSE
 14285        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 14286           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 14287             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 14288             MOVE ER-3527            TO EMI-ERROR
 14289             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14290             MOVE -1                 TO EPYTHRUL
 14291             MOVE AL-UNBON           TO EPYTHRUA
 14292                                        EPYFROMA
 14293             GO TO 3299-EXIT.
 14294
 14295*--------------------------------------------------------------*
 14296*    CALCULATE RETRO ELIMINATION DATE                          *
 14297*--------------------------------------------------------------*
 14298
 14299     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14300         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14301     ELSE
 14302         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 14303
 14304     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 14305     MOVE +0             TO DC-ELAPSED-MONTHS.
 14306     MOVE '6'            TO DC-OPTION-CODE.
 14307     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14308     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 275
* EL156.cbl
 14309         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 14310     ELSE
 14311         GO TO 3290-ERROR.
 14312
 14313 3210-CHECK-PMT-DATE.
 14314
 14315*--------------------------------------------------------------*
 14316*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 14317*    THE ENTERED PAY FROM DATE                                 *
 14318*--------------------------------------------------------------*
 14319
 14320     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 14321         NEXT SENTENCE
 14322     ELSE
 14323         GO TO 3220-COMPUTE-DAYS.
 14324
 14325     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 14326     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14327     IF NO-CONVERSION-ERROR
 14328         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14329         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14330         GO TO 3210-CHECK-PMT-DATE
 14331     ELSE
 14332         GO TO 3290-ERROR.
 14333
 14334 3220-COMPUTE-DAYS.
 14335
 14336     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 14337     MOVE ZEROS         TO WS-CDAYS.
 14338     MOVE 'N'           TO WS-ELIMINATION-SW.
 14339
 14340*--------------------------------------------------------------*
 14341*    COMPUTE CALIFORNIA DUE DAYS                               *
 14342*--------------------------------------------------------------*
 14343
 14344     IF CL-TOTAL-PAID-AMT > ZEROS
 14345         MOVE 'Y' TO WS-ELIMINATION-SW
 14346         GO TO 3240-FIRST-PMT-DUE
 14347     ELSE
 14348        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 14349            NEXT SENTENCE
 14350        ELSE
 14351            GO TO 3240-FIRST-PMT-DUE.
 14352
 14353 3230-NEXT-PMT-DUE.
 14354
 14355     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 14356     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14357     IF NO-CONVERSION-ERROR
 14358         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 14359         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14360     ELSE
 14361         GO TO 3290-ERROR.
 14362
 14363 3240-FIRST-PMT-DUE.
 14364
 14365     IF CL-TOTAL-PAID-AMT > ZEROS
 14366         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 276
* EL156.cbl
 14367     ELSE
 14368        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14369            GO TO 3230-NEXT-PMT-DUE.
 14370
 14371     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14372         GO TO 3250-VERIFY-ELIMINATION.
 14373
 14374     ADD +30 TO WS-CDAYS.
 14375     MOVE 'Y' TO WS-ELIMINATION-SW.
 14376     GO TO 3230-NEXT-PMT-DUE.
 14377
 14378 3250-VERIFY-ELIMINATION.
 14379
 14380     IF ELIM-SATISFIED
 14381         GO TO 3260-END-CALC.
 14382
 14383     IF PI-PMTTYPE = '1'
 14384         MOVE ZEROS TO WS-CDAYS
 14385         GO TO 3260-END-CALC.
 14386
 14387     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14388         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14389     ELSE
 14390         IF CL-TOTAL-PAID-AMT > ZEROS
 14391             IF WS-SV-EPYFROM = LOW-VALUES
 14392                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14393             ELSE
 14394                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14395         ELSE
 14396             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14397
 14398     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14399     MOVE '1'                    TO DC-OPTION-CODE.
 14400     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14401     IF NO-CONVERSION-ERROR
 14402         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14403     ELSE
 14404         GO TO 3290-ERROR.
 14405
 14406     IF CL-TOTAL-PAID-AMT > ZEROS
 14407         MOVE WS-DAYS-OFF TO WS-CDAYS
 14408     ELSE
 14409         IF PI-BEN-DAYS > WS-DAYS-OFF
 14410             MOVE ZEROS TO WS-CDAYS
 14411         ELSE
 14412             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14413
 14414 3260-END-CALC.
 14415
 14416     MOVE WS-CDAYS TO PI-CDAYS.
 14417
 14418     IF PI-EDAYS = ZEROS
 14419         MOVE PI-CDAYS TO PI-EDAYS
 14420         MOVE AL-UNNON TO EDAYSA.
 14421
 14422     GO TO 3299-EXIT.
 14423
 14424 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 277
* EL156.cbl
 14425
 14426     MOVE ER-3528            TO EMI-ERROR.
 14427     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14428     MOVE -1                 TO CDAYSL.
 14429     MOVE AL-UNBON           TO CDAYSA.
 14430
 14431 3299-EXIT.
 14432     EXIT.
 14433
 14434 3300-BUMP-DATE.
 14435
 14436     IF WS-RESTORE-DUE-DAY
 14437         MOVE 'N'              TO WS-DUE-DAY-SW
 14438         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14439         ADD 1                 TO WS-PMT-DUE-MO
 14440         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14441         MOVE '4'              TO DC-OPTION-CODE
 14442         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14443         IF NO-CONVERSION-ERROR
 14444             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14445             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14446             GO TO 3399-EXIT
 14447         ELSE
 14448             MOVE '9'          TO DC-ERROR-CODE
 14449             GO TO 3399-EXIT.
 14450
 14451     IF (WS-PMT-DUE-MO = 1) AND
 14452        (WS-SAVE-DUE-DA > 28)
 14453           MOVE 'Y' TO WS-DUE-DAY-SW.
 14454
 14455     MOVE +0                 TO DC-ELAPSED-DAYS.
 14456     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14457     MOVE '6'                TO DC-OPTION-CODE.
 14458     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14459
 14460 3399-EXIT.
 14461     EXIT.
 14462
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 278
* EL156.cbl
 14464 3400-COMPUTE-EXPIRY.
 14465
 14466     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14467     MOVE +0                    TO DC-ELAPSED-DAYS
 14468                                   DC-ODD-DAYS-OVER.
 14469     MOVE '1'                   TO DC-END-OF-MONTH.
 14470     MOVE '6'                   TO DC-OPTION-CODE.
 14471
 14472     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 14473         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14474     ELSE
 14475         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14476
 14477     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14478     IF NO-CONVERSION-ERROR
 14479         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14480     ELSE
 14481         GO TO 3390-CONTINUE.
 14482
 14483     IF CL-CLAIM-TYPE NOT = (PI-LIFE-OVERRIDE-L1 OR 'O')
 14484         GO TO 3390-CONTINUE.
 14485
 14486     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14487     MOVE '4'                    TO CNTL-REC-TYPE.
 14488     MOVE +0                     TO CNTL-SEQ-NO.
 14489     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14490     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14491     MOVE 'BENE'                 TO FILE-SWITCH.
 14492
 14493     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14494
 14495     IF NO-BENEFIT-FOUND
 14496         GO TO 3390-CONTINUE.
 14497
 14498     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 14499        IF (PI-OFFLINE = 'Y') OR
 14500           (PI-PMTTYPE = '7')
 14501           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14502                                     THRU 9870-EXIT
 14503           IF ERROR-ON-OUTPUT
 14504             MOVE -1                 TO ENTERPFL
 14505             MOVE AL-UANON           TO ENTERPFA
 14506             MOVE MAP-NAMEA          TO MAP-NAME
 14507             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14508             GO TO 8200-SEND-DATAONLY.
 14509
 14510     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')  AND
 14511        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14512        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14513          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14514          MOVE +0        TO DC-ELAPSED-DAYS
 14515          MOVE +1        TO DC-ELAPSED-MONTHS
 14516          MOVE 6         TO DC-OPTION-CODE
 14517          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14518          IF NO-CONVERSION-ERROR
 14519              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14520
 14521 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 279
* EL156.cbl
 14522
 14523      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14524         MOVE CM-AH-LOAN-EXPIRE-DT
 14525                                 TO DC-BIN-DATE-1
 14526      ELSE
 14527         MOVE CM-LF-LOAN-EXPIRE-DT
 14528                                 TO DC-BIN-DATE-1
 14529      END-IF
 14530
 14531      MOVE ' '                    TO DC-OPTION-CODE.
 14532      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14533      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14534      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14535
 14536 3499-EXIT.
 14537     EXIT.
 14538
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 280
* EL156.cbl
 14540
 14541 3600-CHECK-VERIFICATION.
 14542
 14543     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14544
 14545     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14546
 14547     IF PI-PAYEE-TYPE = 'I'
 14548        GO TO 3600-READ-TRAILER.
 14549
 14550     IF PI-PAYEE-TYPE = 'B'
 14551        ADD +10                  TO TRLR-SEQ-NO
 14552        GO TO 3600-READ-TRAILER.
 14553
 14554     IF PI-PAYEE-TYPE = 'A'
 14555        ADD +20                  TO TRLR-SEQ-NO
 14556        GO TO 3600-READ-TRAILER.
 14557
 14558     IF PI-PAYEE-TYPE = 'O'
 14559        ADD +50                  TO TRLR-SEQ-NO
 14560        GO TO 3600-READ-TRAILER.
 14561
 14562     IF PI-PAYEE-TYPE = 'Q'
 14563        ADD +60                  TO TRLR-SEQ-NO
 14564        GO TO 3600-READ-TRAILER.
 14565
 14566     IF PI-PAYEE-TYPE = 'P'
 14567        ADD +30                  TO TRLR-SEQ-NO
 14568        GO TO 3600-READ-TRAILER.
 14569
 14570     IF PI-PAYEE-TYPE = 'E'
 14571        ADD +40                  TO TRLR-SEQ-NO.
 14572
 14573 3600-READ-TRAILER.
 14574
 14575
 14576* EXEC CICS HANDLE CONDITION
 14577*         NOTFND(3600-CONTINUE)
 14578*    END-EXEC.
 14579*    MOVE '"$I                   ! - #00013797' TO DFHEIV0
 14580     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14581     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14582     MOVE X'2D20233030303133373937' TO DFHEIV0(25:11)
 14583     CALL 'kxdfhei1' USING DFHEIV0
 14584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14585
 14586
 14587     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14588
 14589 3600-CONTINUE.
 14590
 14591     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 14592         GO TO 3600-AH-VERIFY
 14593     END-IF.
 14594
 14595     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14596       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14597         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 281
* EL156.cbl
 14598           MOVE ER-7576            TO EMI-ERROR
 14599           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14600           MOVE -1                 TO PAYEEL
 14601           MOVE AL-UABON           TO PAYEEA
 14602           GO TO 3600-EXIT
 14603         END-IF
 14604       END-IF
 14605     END-IF.
 14606
 14607     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14608     MOVE 1 TO WS-SUB2
 14609     MOVE SPACES TO WS-PAYEE-NAME
 14610     PERFORM VARYING WS-SUB FROM 1 BY 1
 14611             UNTIL WS-SUB > 30
 14612         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14613            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14614                 WS-PAYEE-NAME-X (WS-SUB2)
 14615            ADD +1 TO WS-SUB2
 14616         END-IF
 14617     END-PERFORM.
 14618
 14619     STRING CL-INSURED-1ST-NAME
 14620            CL-INSURED-MID-INIT
 14621            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14622     MOVE 1 TO WS-SUB2
 14623     MOVE SPACES TO WS-INSURED-NAME
 14624     PERFORM VARYING WS-SUB FROM 1 BY 1
 14625             UNTIL WS-SUB > 30
 14626         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14627            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14628                 WS-INSURED-NAME-X (WS-SUB2)
 14629            ADD +1 TO WS-SUB2
 14630         END-IF
 14631     END-PERFORM.
 14632
 14633     IF CL-CLAIM-TYPE = 'O'
 14634        IF WS-PAYEE-NAME (1:6) = 'ESTATE'
 14635           MOVE ER-7585            TO EMI-ERROR
 14636           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14637           MOVE -1                 TO PAYEEL
 14638           MOVE AL-UABON           TO PAYEEA
 14639        ELSE
 14640           GO TO 3600-EXIT
 14641        END-IF
 14642     END-IF.
 14643     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14644        MOVE ER-7579            TO EMI-ERROR
 14645        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14646        MOVE -1                 TO PAYEEL
 14647        MOVE AL-UABON           TO PAYEEA
 14648     END-IF.
 14649
 14650     IF PI-PMTTYPE = '4'  AND
 14651        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14652        PI-PAYEE-TYPE <> 'I'
 14653          MOVE ER-7580          TO EMI-ERROR
 14654          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14655          MOVE -1               TO PAYEEL
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 282
* EL156.cbl
 14656          MOVE AL-UABON         TO PAYEEA
 14657     END-IF.
 14658
 14659     GO TO 3600-EXIT.
 14660
 14661 3600-AH-VERIFY.
 14662
 14663     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14664        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14665           MOVE ER-7583            TO EMI-ERROR
 14666           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14667           MOVE -1                 TO PAYEEL
 14668           MOVE AL-UABON           TO PAYEEA
 14669        END-IF
 14670     END-IF.
 14671
 14672
 14673 3600-EXIT.
 14674     EXIT.
 14675
 14676 5000-UPDATE.
 14677
 14678     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14679
 14680     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14681
 14682     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14683        PI-OFFLINE = 'Y'
 14684        NEXT SENTENCE
 14685     ELSE
 14686        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14687
 14688*    IF PI-COMPANY-ID = 'CRI'
 14689*       IF PI-PMTTYPE = '1' OR  '2'
 14690*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14691*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14692*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14693
 14694*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14695*       IF PI-PMTTYPE = '1'
 14696*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14697*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14698
 14699     IF PI-PMTTYPE      = '2' AND
 14700        PI-SPLIT-PMT-SW = 'Y' AND
 14701        (CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1 OR 'O')
 14702          MOVE ER-3530                TO EMI-ERROR
 14703          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14704
 14705     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14706        AND (CL-CLAIM-TYPE = 'L' OR 'O')
 14707        IF PI-PMTTYPE = '2' OR '4'
 14708           IF PI-INT-AMT NOT = ZEROS
 14709              PERFORM 7110-BUILD-PMT-TRLR
 14710                                 THRU 7130-EXIT
 14711           ELSE
 14712              IF PI-PMTTYPE = '2'
 14713                 PERFORM 7140-BUILD-NOTE-TRLR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 283
* EL156.cbl
 14714                                 THRU 7170-EXIT
 14715              END-IF
 14716           END-IF
 14717        END-IF
 14718     END-IF
 14719*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14720*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14721*            MOVE 'N'                 TO  WS-LETTER-SW.
 14722
 14723*    IF PI-COMPANY-ID = 'DMD'
 14724*        IF CL-NO-OF-PMTS-MADE = +1
 14725*                OR
 14726*           PI-PMTTYPE = '2'
 14727*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14728
 14729     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14730
 14731*    IF PI-COMPANY-ID = 'DMD'
 14732*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14733*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14734
 14735
 14736* EXEC CICS REWRITE
 14737*         DATASET('ELMSTR')
 14738*         FROM(CLAIM-MASTER)
 14739*     END-EXEC.
 14740     MOVE LENGTH OF
 14741      CLAIM-MASTER
 14742       TO DFHEIV11
 14743     MOVE 'ELMSTR' TO DFHEIV1
 14744*    MOVE '&& L                  %   #00013949' TO DFHEIV0
 14745     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14746     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14747     MOVE X'2020233030303133393439' TO DFHEIV0(25:11)
 14748     CALL 'kxdfhei1' USING DFHEIV0,
 14749           DFHEIV1,
 14750           CLAIM-MASTER,
 14751           DFHEIV11,
 14752           DFHEIV99
 14753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14754
 14755
 14756     IF WS-LETTER-SW = 'N'
 14757         GO TO 5000-END-UPDATE.
 14758
 14759 5000-GENERATE-AUTO-LETTER.
 14760
 14761
 14762* EXEC CICS LINK
 14763*        PROGRAM    (LINK-1523)
 14764*        COMMAREA   (W-1523-LINKDATA)
 14765*        LENGTH     (W-1523-COMM-LENGTH)
 14766*    END-EXEC.
 14767*    MOVE '."C                   (   #00013959' TO DFHEIV0
 14768     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14769     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14770     MOVE X'2020233030303133393539' TO DFHEIV0(25:11)
 14771     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 284
* EL156.cbl
 14772           LINK-1523,
 14773           W-1523-LINKDATA,
 14774           W-1523-COMM-LENGTH,
 14775           DFHEIV99,
 14776           DFHEIV99,
 14777           DFHEIV99,
 14778           DFHEIV99
 14779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14780
 14781
 14782     IF W-1523-FATAL-ERROR
 14783         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14784         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14785         MOVE ER-0802                TO  EMI-ERROR
 14786         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14787
 14788     IF W-1523-ERROR-CODE = 0191
 14789         MOVE ER-0803                TO  EMI-ERROR
 14790         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14791
 14792     IF PI-COMPANY-ID      = 'HAN' AND
 14793        PI-PMTTYPE         = '1'   AND
 14794        PI-3RD-PARTY-SW    = 'Y'   AND
 14795        W-1523-FORM-NUMBER = 'EOB1'
 14796           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14797           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14798           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14799           GO TO 5000-GENERATE-AUTO-LETTER.
 14800
 14801 5000-END-UPDATE.
 14802
 14803     MOVE ER-0000                TO EMI-ERROR.
 14804     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14805     GO TO 7000-SHOW-CLAIM.
 14806
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 285
* EL156.cbl
 14808 5000-MOVE-NAME.
 14809     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14810     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14811     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14812
 14813 5000-EXIT.
 14814     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 286
* EL156.cbl
 14816 5300-CREATE-DMO.
 14817
 14818     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14819     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14820     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14821
 14822
 14823* EXEC CICS HANDLE CONDITION
 14824*         NOTFND   (5300-NOTE-NOT-FOUND)
 14825*    END-EXEC.
 14826*    MOVE '"$I                   ! . #00014005' TO DFHEIV0
 14827     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14828     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14829     MOVE X'2E20233030303134303035' TO DFHEIV0(25:11)
 14830     CALL 'kxdfhei1' USING DFHEIV0
 14831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14832
 14833
 14834
 14835* EXEC CICS READ
 14836*         DATASET('ERNOTE')
 14837*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14838*         RIDFLD (W-NOTE-KEY)
 14839*    END-EXEC.
 14840     MOVE 'ERNOTE' TO DFHEIV1
 14841*    MOVE '&"S        E          (   #00014009' TO DFHEIV0
 14842     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14843     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14844     MOVE X'2020233030303134303039' TO DFHEIV0(25:11)
 14845     CALL 'kxdfhei1' USING DFHEIV0,
 14846           DFHEIV1,
 14847           DFHEIV20,
 14848           DFHEIV99,
 14849           W-NOTE-KEY,
 14850           DFHEIV99,
 14851           DFHEIV99,
 14852           DFHEIV99
 14853     SET ADDRESS OF CERTIFICATE-NOTE TO
 14854         DFHEIV20
 14855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14856
 14857
 14858     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14859     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14860     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14861
 14862     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14863         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14864     ELSE
 14865         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14866
 14867     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14868     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14869     MOVE 'DLO006'               TO PGM-NAME.
 14870
 14871
 14872* EXEC CICS LINK
 14873*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 287
* EL156.cbl
 14874*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14875*        LENGTH     (DCT-RCRD-LENGTH)
 14876*    END-EXEC.
 14877*    MOVE '."C                   (   #00014028' TO DFHEIV0
 14878     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14879     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14880     MOVE X'2020233030303134303238' TO DFHEIV0(25:11)
 14881     CALL 'kxdfhei1' USING DFHEIV0,
 14882           PGM-NAME,
 14883           DCT-COMMUNICATION-AREA,
 14884           DCT-RCRD-LENGTH,
 14885           DFHEIV99,
 14886           DFHEIV99,
 14887           DFHEIV99,
 14888           DFHEIV99
 14889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14890
 14891
 14892     IF DCT-RETURN-CODE = 'OK'
 14893         GO TO 5300-CONT.
 14894
 14895     IF DCT-RETURN-CODE = '01' OR '02'
 14896         GO TO 5300-EXIT.
 14897
 14898     IF DCT-RETURN-CODE = '03'
 14899         MOVE ER-0951            TO EMI-ERROR
 14900         GO TO 5300-BAD-EXIT.
 14901
 14902     IF DCT-RETURN-CODE = '04'
 14903         MOVE ER-0946            TO EMI-ERROR
 14904         GO TO 5300-BAD-EXIT.
 14905
 14906     IF DCT-RETURN-CODE = '05'
 14907         MOVE ER-0947            TO EMI-ERROR
 14908         GO TO 5300-BAD-EXIT.
 14909
 14910     IF DCT-RETURN-CODE = '06'
 14911         MOVE ER-0921            TO EMI-ERROR
 14912         GO TO 5300-BAD-EXIT.
 14913
 14914     IF DCT-RETURN-CODE = '07'
 14915         MOVE ER-0849            TO EMI-ERROR
 14916         GO TO 5300-BAD-EXIT.
 14917
 14918     IF DCT-RETURN-CODE = '08'
 14919         MOVE ER-0948            TO EMI-ERROR
 14920         GO TO 5300-BAD-EXIT.
 14921
 14922     IF DCT-RETURN-CODE = 'N1'
 14923         MOVE ER-0950            TO EMI-ERROR
 14924         GO TO 5300-BAD-EXIT.
 14925
 14926     IF DCT-RETURN-CODE = 'E1'
 14927         MOVE ER-0974            TO EMI-ERROR
 14928         GO TO 5300-BAD-EXIT.
 14929
 14930     IF DCT-RETURN-CODE = 'E2'
 14931         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 288
* EL156.cbl
 14932         GO TO 5300-BAD-EXIT.
 14933
 14934     IF DCT-RETURN-CODE NOT = 'OK'
 14935         MOVE ER-0949            TO EMI-ERROR
 14936         GO TO 5300-BAD-EXIT.
 14937
 14938 5300-CONT.
 14939
 14940     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14941     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14942     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14943     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14944     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14945     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14946     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14947     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14948
 14949     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14950     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14951     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14952     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14953     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14954
 14955     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14956
 14957     IF PI-PMTTYPE = '2'
 14958         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14959         MOVE '4'                TO DM-CLAIM-STATUS
 14960     ELSE
 14961         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14962         MOVE '2'                TO DM-CLAIM-STATUS.
 14963
 14964     MOVE 'DLO025'               TO PGM-NAME.
 14965
 14966
 14967* EXEC CICS LINK
 14968*        PROGRAM    (PGM-NAME)
 14969*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14970*        LENGTH     (DM-DMO-LENGTH)
 14971*    END-EXEC.
 14972*    MOVE '."C                   (   #00014108' TO DFHEIV0
 14973     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14974     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14975     MOVE X'2020233030303134313038' TO DFHEIV0(25:11)
 14976     CALL 'kxdfhei1' USING DFHEIV0,
 14977           PGM-NAME,
 14978           DMO-COMMUNICATION-AREA,
 14979           DM-DMO-LENGTH,
 14980           DFHEIV99,
 14981           DFHEIV99,
 14982           DFHEIV99,
 14983           DFHEIV99
 14984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14985
 14986
 14987     IF DM-RETURN-CODE = 'OK'
 14988         GO TO 5300-EXIT.
 14989
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 289
* EL156.cbl
 14990     IF DM-RETURN-CODE = '01'
 14991         MOVE ER-8051            TO EMI-ERROR
 14992         GO TO 5300-BAD-EXIT.
 14993
 14994     IF DM-RETURN-CODE = '02'
 14995         MOVE ER-8052            TO EMI-ERROR
 14996         GO TO 5300-BAD-EXIT.
 14997
 14998     IF DM-RETURN-CODE = '03'
 14999         MOVE ER-8053            TO EMI-ERROR
 15000         GO TO 5300-BAD-EXIT.
 15001
 15002     IF DM-RETURN-CODE = '04'
 15003         MOVE ER-8054            TO EMI-ERROR
 15004         GO TO 5300-BAD-EXIT.
 15005
 15006     IF DM-RETURN-CODE = '05'
 15007         MOVE ER-8055            TO EMI-ERROR
 15008         GO TO 5300-BAD-EXIT.
 15009
 15010     IF DM-RETURN-CODE = '06'
 15011         MOVE ER-8056            TO EMI-ERROR
 15012         GO TO 5300-BAD-EXIT.
 15013
 15014     IF DM-RETURN-CODE = '07'
 15015         MOVE ER-8057            TO EMI-ERROR
 15016         GO TO 5300-BAD-EXIT.
 15017
 15018     IF DM-RETURN-CODE = '08'
 15019         MOVE ER-8058            TO EMI-ERROR
 15020         GO TO 5300-BAD-EXIT.
 15021
 15022     IF DM-RETURN-CODE = '09'
 15023         MOVE ER-8059            TO EMI-ERROR
 15024         GO TO 5300-BAD-EXIT.
 15025
 15026     IF DM-RETURN-CODE = '10'
 15027         MOVE ER-8060            TO EMI-ERROR
 15028         GO TO 5300-BAD-EXIT.
 15029
 15030     IF DM-RETURN-CODE = '11'
 15031         MOVE ER-8061            TO EMI-ERROR
 15032         GO TO 5300-BAD-EXIT.
 15033
 15034     IF DM-RETURN-CODE = '12'
 15035         MOVE ER-8062            TO EMI-ERROR
 15036         GO TO 5300-BAD-EXIT.
 15037
 15038     IF DM-RETURN-CODE = '13'
 15039         MOVE ER-8063            TO EMI-ERROR
 15040         GO TO 5300-BAD-EXIT.
 15041
 15042     IF DM-RETURN-CODE = '14'
 15043         MOVE ER-8064            TO EMI-ERROR
 15044         GO TO 5300-BAD-EXIT.
 15045
 15046     IF DM-RETURN-CODE = '15'
 15047         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 290
* EL156.cbl
 15048         GO TO 5300-BAD-EXIT.
 15049
 15050     IF DM-RETURN-CODE = '16'
 15051         MOVE ER-8154            TO EMI-ERROR
 15052         GO TO 5300-BAD-EXIT.
 15053
 15054     IF DM-RETURN-CODE = '17'
 15055         MOVE ER-8155            TO EMI-ERROR
 15056         GO TO 5300-BAD-EXIT.
 15057
 15058     IF DM-RETURN-CODE = 'N1'
 15059         MOVE ER-8152            TO EMI-ERROR
 15060         GO TO 5300-BAD-EXIT.
 15061
 15062     IF DM-RETURN-CODE = 'E1'
 15063         MOVE ER-8153            TO EMI-ERROR
 15064         GO TO 5300-BAD-EXIT.
 15065
 15066     MOVE ER-8066            TO EMI-ERROR.
 15067     GO TO 5300-BAD-EXIT.
 15068
 15069 5300-NOTE-NOT-FOUND.
 15070
 15071     MOVE ER-0954                TO EMI-ERROR.
 15072     GO TO 5300-BAD-EXIT.
 15073
 15074 5300-BAD-EXIT.
 15075
 15076* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15077*    MOVE '6"R                   !   #00014202' TO DFHEIV0
 15078     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15079     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15080     MOVE X'2020233030303134323032' TO DFHEIV0(25:11)
 15081     CALL 'kxdfhei1' USING DFHEIV0
 15082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15083
 15084     IF MAP-NAME = 'EL156A'
 15085         MOVE -1             TO ENTERPFL
 15086       ELSE
 15087         MOVE LOW-VALUES     TO EL156BI
 15088         MOVE -1             TO ENTPFBL.
 15089
 15090     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15091     GO TO 8200-SEND-DATAONLY.
 15092
 15093 5300-EXIT.
 15094     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 291
* EL156.cbl
 15096 5350-FORMAT-LAST-NAME-1ST.
 15097*****************************************************************
 15098*             M O V E   N A M E   R O U T I N E                 *
 15099*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15100*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15101*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15102*                  FIELD                   VALUE                *
 15103*           W-NAME-LAST    (CL15)      SMITH                    *
 15104*           W-NAME-FIRST   (CL15)      JOHN                     *
 15105*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 15106*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15107*     CONTAIN                                                   *
 15108*                SMITH, JOHN ALLEN                              *
 15109*     OR                                                        *
 15110*                SMITH, JOHN A.                                 *
 15111*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15112*     COPYBOOK, ELCNWA.                                         *
 15113*****************************************************************.
 15114
 15115     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 15116     MOVE ZERO                   TO  WS-NAME-SW.
 15117     SET NWA-INDEX               TO +1.
 15118
 15119     IF W-NAME-LAST   = SPACES AND
 15120        W-NAME-MIDDLE = SPACES
 15121         MOVE +1                 TO WS-NAME-SW.
 15122
 15123     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15124     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15125
 15126     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15127     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15128
 15129     SET NWA-INDEX UP BY +1.
 15130
 15131     IF W-NAME-MIDDLE NOT = SPACES
 15132         IF W-NAME-MIDDLE-2 = SPACES
 15133             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15134             SET NWA-INDEX UP BY +1
 15135             MOVE '.'            TO WS-NW (NWA-INDEX)
 15136             SET NWA-INDEX UP BY +2
 15137         ELSE
 15138             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15139             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15140
 15141 5350-EXIT.
 15142     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 292
* EL156.cbl
 15144 5360-MOVE-NAME.
 15145
 15146     IF WS-NAME-SW > +1
 15147         GO TO 5360-EXIT.
 15148
 15149     IF WS-NAME-WORK2 = SPACES
 15150         GO TO 5360-EXIT.
 15151
 15152     SET NWA-INDEX2            TO +1.
 15153     SET NWA-INDEX3            TO +2.
 15154
 15155 5360-MOVE-NAME-CYCLE.
 15156
 15157     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 15158
 15159     IF NWA-INDEX < +30
 15160         SET NWA-INDEX UP BY +1
 15161     ELSE
 15162         ADD +2                TO  WS-NAME-SW
 15163         GO TO 5360-EXIT.
 15164
 15165     IF NWA-INDEX2 < +20
 15166         SET NWA-INDEX3 UP BY +1
 15167         SET NWA-INDEX2 UP BY +1.
 15168
 15169     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 15170        WS-NW2 (NWA-INDEX3) = SPACES
 15171         IF WS-NAME-SW = ZERO
 15172             MOVE ','            TO  WS-NW (NWA-INDEX)
 15173             SET NWA-INDEX UP BY +2
 15174             MOVE +1             TO  WS-NAME-SW
 15175             GO TO 5360-EXIT
 15176         ELSE
 15177             GO TO 5360-EXIT.
 15178
 15179     GO TO 5360-MOVE-NAME-CYCLE.
 15180
 15181 5360-EXIT.
 15182     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 293
* EL156.cbl
 15184 6000-BUILD-SCREEN-B.
 15185     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15186     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15187     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15188     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15189
 15190     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 15191
 15192 6050-BUILD-SCREEN.
 15193     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 15194     MOVE LOW-VALUES             TO EL156BI.
 15195     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15196
 15197     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 15198
 15199     IF PI-PAYEE-TYPE = 'I'
 15200        GO TO 6060-READ-TRAILER.
 15201
 15202     IF PI-PAYEE-TYPE = 'B'
 15203        ADD +10                  TO TRLR-SEQ-NO
 15204        GO TO 6060-READ-TRAILER.
 15205
 15206     IF PI-PAYEE-TYPE = 'A'
 15207        ADD +20                  TO TRLR-SEQ-NO
 15208        GO TO 6060-READ-TRAILER.
 15209
 15210     IF PI-PAYEE-TYPE = 'O'
 15211        ADD +50                  TO TRLR-SEQ-NO
 15212        GO TO 6060-READ-TRAILER.
 15213
 15214     IF PI-PAYEE-TYPE = 'Q'
 15215        ADD +60                  TO TRLR-SEQ-NO
 15216        GO TO 6060-READ-TRAILER.
 15217
 15218     IF PI-PAYEE-TYPE = 'P'
 15219        ADD +30                  TO TRLR-SEQ-NO
 15220        GO TO 6060-READ-TRAILER.
 15221
 15222     IF PI-PAYEE-TYPE = 'E'
 15223        ADD +40                  TO TRLR-SEQ-NO.
 15224
 15225 6060-READ-TRAILER.
 15226
 15227     IF PI-PAYEE-TYPE    = 'A' AND
 15228        PI-PAYEE-SEQ-NUM = 0
 15229          GO TO 6061-READ-ACCOUNT.
 15230
 15231     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 15232        (PI-PAYEE-TYPE    = 'B')             AND
 15233        (PI-PAYEE-SEQ-NUM = 9)
 15234          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15235          IF BENE-FOUND-SW = 'N'
 15236            GO TO 6065-NOT-FOUND
 15237          ELSE
 15238            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15239            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15240            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15241*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 294
* EL156.cbl
 15242            STRING BE-CITY ' ' BE-STATE
 15243               DELIMITED BY '  ' INTO CITYSTBO
 15244            END-STRING
 15245            MOVE BE-ZIP-CODE       TO ZIPBO
 15246            GO TO 6061-READ-ACCOUNT.
 15247
 15248     IF PI-PAYEE-TYPE    = 'B' AND
 15249        PI-PAYEE-SEQ-NUM = 0
 15250          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15251          IF BENE-FOUND-SW = 'N'
 15252            GO TO 6065-NOT-FOUND
 15253          ELSE
 15254            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15255            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15256            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15257*           MOVE BE-CITY-STATE     TO CITYSTBO
 15258            STRING BE-CITY ' ' BE-STATE
 15259               DELIMITED BY '  ' INTO CITYSTBO
 15260            END-STRING
 15261            MOVE BE-ZIP-CODE       TO ZIPBO
 15262            if be-ach-yes-or-no = 'Y'
 15263               move 'Y'          to pi-ach-payment
 15264            else
 15265               move 'N'          to pi-ach-payment
 15266            end-if
 15267            GO TO 6061-READ-ACCOUNT.
 15268
 15269
 15270* EXEC CICS HANDLE CONDITION
 15271*         NOTFND(6065-NOT-FOUND)
 15272*     END-EXEC.
 15273*    MOVE '"$I                   ! / #00014388' TO DFHEIV0
 15274     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15275     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15276     MOVE X'2F20233030303134333838' TO DFHEIV0(25:11)
 15277     CALL 'kxdfhei1' USING DFHEIV0
 15278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15279
 15280
 15281     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15282
 15283     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 15284     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 15285     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 15286     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 15287*    MOVE AT-CITY-STATE          TO CITYSTBO.
 15288     STRING AT-CITY ' ' AT-STATE
 15289        DELIMITED BY '  ' INTO CITYSTBO
 15290     END-STRING
 15291     MOVE AT-ZIP-CODE            TO ZIPBO.
 15292
 15293 6061-READ-ACCOUNT.
 15294
 15295* EXEC CICS HANDLE CONDITION
 15296*         NOTFND(6068-ACCT-NOT-FND)
 15297*     END-EXEC.
 15298*    MOVE '"$I                   ! 0 #00014405' TO DFHEIV0
 15299     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 295
* EL156.cbl
 15300     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15301     MOVE X'3020233030303134343035' TO DFHEIV0(25:11)
 15302     CALL 'kxdfhei1' USING DFHEIV0
 15303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15304
 15305
 15306
 15307* EXEC CICS READ
 15308*         DATASET('ERACCT')
 15309*         SET    (ADDRESS OF ACCOUNT-MASTER)
 15310*         RIDFLD (PI-ACCT-KEY)
 15311*     END-EXEC.
 15312     MOVE 'ERACCT' TO DFHEIV1
 15313*    MOVE '&"S        E          (   #00014409' TO DFHEIV0
 15314     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15315     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15316     MOVE X'2020233030303134343039' TO DFHEIV0(25:11)
 15317     CALL 'kxdfhei1' USING DFHEIV0,
 15318           DFHEIV1,
 15319           DFHEIV20,
 15320           DFHEIV99,
 15321           PI-ACCT-KEY,
 15322           DFHEIV99,
 15323           DFHEIV99,
 15324           DFHEIV99
 15325     SET ADDRESS OF ACCOUNT-MASTER TO
 15326         DFHEIV20
 15327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15328
 15329
 15330     MOVE AM-CARRIER             TO ACARRBO.
 15331     MOVE AM-GROUPING            TO GROUPBO.
 15332     MOVE AM-STATE               TO STATEBO.
 15333     MOVE AM-ACCOUNT             TO ACCTBO.
 15334     MOVE AM-NAME                TO ACCTNMBO.
 15335
 15336     IF PI-PAYEE-TYPE = 'A' AND
 15337        PI-PAYEE-SEQ-NUM = 0
 15338          MOVE AM-NAME             TO NAMEBO
 15339                                      PI-PAYEE-NAME
 15340          MOVE AM-ADDRS            TO ADDR1BO
 15341          MOVE SPACES              TO ADDR2BO
 15342*         MOVE AM-CITY             TO CITYSTBO
 15343          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 15344             DELIMITED BY '  ' INTO CITYSTBO
 15345          END-STRING
 15346          MOVE AM-ZIP-PRIME        TO WS-ZIP
 15347          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 15348          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 15349          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 15350
 15351***  We don't really need the code below because we don't do the
 15352***  AK thing anymore.  However, we may have a state special
 15353***  of some sort in the future so why not just leave it??
 15354     IF CITYSTBO EQUAL SPACES
 15355         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15356         GO TO 6070-FORMAT-DATA
 15357     END-IF.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 296
* EL156.cbl
 15358
 15359     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 15360     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 15361     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 15362     PERFORM VARYING WS-SUB FROM 30 BY -1
 15363          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 15364        IF WS-END-SUB = 0  AND
 15365           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 15366              OR LOW-VALUES  OR '.')
 15367            CONTINUE
 15368        ELSE
 15369            IF WS-END-SUB = 0
 15370                MOVE WS-SUB TO WS-END-SUB
 15371            ELSE
 15372                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 15373                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 15374                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15375                END-IF
 15376            END-IF
 15377        END-IF
 15378        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15379            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15380            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15381        END-IF
 15382     END-PERFORM.
 15383
 15384     IF WS-BEG-SUB > 0
 15385         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15386         IF WS-STATE-LENGTH = 2
 15387             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15388                  TO PI-CHECK-STATE-FOR-AK
 15389         ELSE
 15390             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15391                'ALASKA'
 15392                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15393             ELSE
 15394                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15395             END-IF
 15396         END-IF
 15397     ELSE
 15398         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15399     END-IF.
 15400
 15401     GO TO 6070-FORMAT-DATA.
 15402
 15403 6065-NOT-FOUND.
 15404     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15405     GO TO 6061-READ-ACCOUNT.
 15406
 15407 6068-ACCT-NOT-FND.
 15408     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15409
 15410 6070-FORMAT-DATA.
 15411     IF PI-HOLDTIL = ZEROS
 15412        MOVE SAVE-DATE           TO PAYDTBI
 15413       ELSE
 15414        MOVE PI-HOLDTIL          TO PAYDTBO
 15415        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 297
* EL156.cbl
 15416
 15417     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15418     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15419
 15420     IF EIBAID = DFHPF3 OR DFHPF4
 15421        NEXT SENTENCE
 15422     ELSE
 15423       GO TO 6071-CONTINUE.
 15424
 15425     MOVE PI-EPYFROM          TO PYFROMBO.
 15426     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15427
 15428     IF NOT PI-USES-PAID-TO
 15429        MOVE PI-EPYTHRU          TO PYTHRUBO
 15430        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15431     ELSE
 15432        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15433        MOVE '4'              TO DC-OPTION-CODE
 15434        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15435        IF NO-CONVERSION-ERROR
 15436           MOVE +1            TO DC-ELAPSED-DAYS
 15437           MOVE +0            TO DC-ELAPSED-MONTHS
 15438           MOVE '6'           TO DC-OPTION-CODE
 15439           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15440           IF NO-CONVERSION-ERROR
 15441              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15442
 15443     MOVE PI-EDAYS            TO DAYSBO.
 15444     MOVE PI-EPYAMT           TO PAYAMTBO.
 15445     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15446        IF PI-INT-AMT > ZEROS
 15447           MOVE PI-INT-AMT       TO INTAMTBO
 15448        END-IF
 15449     END-IF
 15450     GO TO 6072-SET-TYPE.
 15451
 15452 6071-CONTINUE.
 15453
 15454     IF PI-CPYFROM NOT = LOW-VALUES
 15455        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15456        MOVE SPACES              TO DC-OPTION-CODE
 15457        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15458        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15459
 15460     IF PI-CPYTHRU NOT = LOW-VALUES
 15461        IF NOT PI-USES-PAID-TO
 15462           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15463           MOVE SPACES             TO DC-OPTION-CODE
 15464           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15465           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15466        ELSE
 15467           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15468           MOVE '6'                TO DC-OPTION-CODE
 15469           MOVE +1                 TO DC-ELAPSED-DAYS
 15470           MOVE +0                 TO DC-ELAPSED-MONTHS
 15471           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15472           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15473
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 298
* EL156.cbl
 15474     MOVE PI-CDAYS               TO DAYSBO.
 15475     MOVE PI-CPYAMT              TO PAYAMTBO.
 15476     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15477        IF PI-INT-AMT > ZEROS
 15478           MOVE PI-INT-AMT       TO INTAMTBO
 15479        END-IF
 15480     END-IF
 15481     .
 15482 6072-SET-TYPE.
 15483     IF PI-PMTTYPE = '1'
 15484        MOVE 'PARTIAL'           TO PAYTYPBO.
 15485
 15486     IF PI-PMTTYPE = '2'
 15487        MOVE 'FINAL'             TO PAYTYPBO.
 15488
 15489     IF PI-PMTTYPE = '3'
 15490        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15491
 15492     IF PI-PMTTYPE = '4'
 15493        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15494
 15495     IF PI-PMTTYPE = '5'
 15496        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15497
 15498     IF PI-PMTTYPE = '6'
 15499        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15500
 15501     IF PI-PROV-PMT
 15502        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15503
 15504     IF PI-ECHECKNO NOT = SPACES
 15505        MOVE PI-ECHECKNO         TO CKNUMBO
 15506     ELSE
 15507        MOVE PI-CCHECKNO         TO CKNUMBO.
 15508
 15509     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 15510        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15511        MOVE +91                 TO  TRLR-SEQ-NO
 15512
 15513* EXEC CICS READ
 15514*           DATASET  ('ELTRLR')
 15515*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15516*           RIDFLD   (ELTRLR-KEY)
 15517*           RESP     (WS-RESPONSE)
 15518*       END-EXEC
 15519     MOVE 'ELTRLR' TO DFHEIV1
 15520*    MOVE '&"S        E          (  N#00014597' TO DFHEIV0
 15521     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15522     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15523     MOVE X'204E233030303134353937' TO DFHEIV0(25:11)
 15524     CALL 'kxdfhei1' USING DFHEIV0,
 15525           DFHEIV1,
 15526           DFHEIV20,
 15527           DFHEIV99,
 15528           ELTRLR-KEY,
 15529           DFHEIV99,
 15530           DFHEIV99,
 15531           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 299
* EL156.cbl
 15532     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15533         DFHEIV20
 15534     MOVE EIBRESP  TO WS-RESPONSE
 15535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15536
 15537        IF WS-RESP-NORMAL
 15538           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15539        ELSE
 15540           MOVE SPACES           TO  LOANNBO
 15541        END-IF
 15542     END-IF
 15543
 15544*       MOVE PI-LOAN-NO          TO LOANNBO
 15545
 15546     IF CKNUMBO = SPACES
 15547         MOVE SPACES             TO CKNUMHDO.
 15548
 15549     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15550     MOVE CL-CARRIER             TO CARRBO.
 15551     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15552     MOVE CL-CERT-SFX            TO SUFXBO.
 15553
 15554     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15555        EVALUATE CL-CLAIM-TYPE
 15556           WHEN 'I'
 15557              MOVE '  IU  '      TO CLMTYPBO
 15558           WHEN 'G'
 15559              MOVE ' GAP  '      TO CLMTYPBO
 15560           WHEN 'F'
 15561              MOVE ' FMLA '      TO CLMTYPBO
 15562           WHEN OTHER
 15563              MOVE PI-AH-OVERRIDE-L6
 15564                                 TO CLMTYPBO
 15565        END-EVALUATE
 15566        MOVE ZEROS               TO UNDISBO
 15567*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15568        IF PI-PMTTYPE = '5' OR '6'
 15569           GO TO 6073-GET-NOTIFY-DATA
 15570        ELSE
 15571           MOVE PI-DAILY-RATE    TO RATEBO
 15572           GO TO 6073-GET-NOTIFY-DATA.
 15573
 15574     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15575
 15576     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15577        MOVE ZEROS               TO UNDISBO
 15578     ELSE
 15579        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15580
 15581 6073-GET-NOTIFY-DATA.
 15582
 15583     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15584
 15585     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15586         MOVE SPACES             TO  NAMEB2O
 15587                                     ADDR1B2O
 15588                                     ADDR2B2O
 15589                                     CITYST2O
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 300
* EL156.cbl
 15590                                     AGTHDGO
 15591         MOVE ZEROS              TO  ZIPB2O
 15592         GO TO 6080-SET-INCURRED.
 15593
 15594     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15595     MOVE +29                    TO  TRLR-SEQ-NO.
 15596
 15597
 15598* EXEC CICS HANDLE CONDITION
 15599*        NOTFND   (6074-GET-COMP-DATA)
 15600*    END-EXEC.
 15601*    MOVE '"$I                   ! 1 #00014664' TO DFHEIV0
 15602     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15603     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15604     MOVE X'3120233030303134363634' TO DFHEIV0(25:11)
 15605     CALL 'kxdfhei1' USING DFHEIV0
 15606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15607
 15608
 15609     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15610
 15611     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15612     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15613     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15614*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15615     STRING AT-CITY ' ' AT-STATE
 15616        DELIMITED BY '  ' INTO CITYST2O
 15617     END-STRING
 15618     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15619     GO TO 6080-SET-INCURRED.
 15620
 15621 6074-GET-COMP-DATA.
 15622
 15623     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15624         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15625
 15626     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15627         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15628                                         ADDR1B2O
 15629                                         ADDR2B2O
 15630                                         CITYST2O
 15631         MOVE ZEROS                  TO  ZIPB2O
 15632         GO TO 6080-SET-INCURRED.
 15633
 15634     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15635     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15636     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15637     MOVE AM-GROUPING            TO  COMP-GROUP.
 15638     MOVE 'A'                    TO  COMP-TYPE.
 15639     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15640                                 TO  COMP-FIN-RESP.
 15641
 15642     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15643         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15644                                       'G' OR 'B' or 'S'
 15645             MOVE 'G'            TO  COMP-TYPE
 15646             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15647         ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 301
* EL156.cbl
 15648             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15649                                 TO  COMP-ACCOUNT
 15650     ELSE
 15651         MOVE 'G'                TO  COMP-TYPE
 15652         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15653
 15654     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15655
 15656     IF COMP-REC-FOUND
 15657         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15658         MOVE CO-ADDR-1          TO  ADDR1B2O
 15659         MOVE CO-ADDR-2          TO  ADDR2B2O
 15660*        MOVE CO-ADDR-3          TO  CITYST2O
 15661         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15662            DELIMITED BY '  ' INTO CITYST2O
 15663         END-STRING
 15664         MOVE CO-ZIP             TO  ZIPB2O
 15665     ELSE
 15666         MOVE 'NO COMP ADDRESS AVAILABLE'
 15667                                 TO  NAMEB2O
 15668                                     ADDR1B2O
 15669                                     ADDR2B2O
 15670                                     CITYST2O
 15671         MOVE ZEROS               TO ZIPB2O.
 15672
 15673 6080-SET-INCURRED.
 15674     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15675     MOVE SPACES                 TO DC-OPTION-CODE.
 15676     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15677     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15678     MOVE PI-PROCESSOR-ID        TO BYBO.
 15679     MOVE MAP-NAMEB              TO MAP-NAME.
 15680     MOVE 'C'                    TO PI-PASS-SW.
 15681     MOVE EIBAID                 TO PI-PFKEY-USED.
 15682     MOVE -1                     TO ENTPFBL.
 15683     GO TO 8100-SEND-INITIAL-MAP.
 15684
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 302
* EL156.cbl
 15686 6100-BUILD-PAYMENT-TRAILER.
 15687
 15688     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15689     MOVE '6'                    TO CNTL-REC-TYPE.
 15690
 15691     IF CONTROL-IS-ACTUAL-CARRIER
 15692         MOVE PI-CARRIER         TO WS-CARR
 15693     ELSE
 15694         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15695
 15696     IF PI-COMPANY-ID = 'FIA'
 15697         MOVE PI-CARRIER         TO  WS-CARR.
 15698
 15699     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15700     MOVE 0                      TO CNTL-SEQ-NO.
 15701     MOVE 'CARR'                 TO FILE-SWITCH.
 15702
 15703     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15704
 15705     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15706         IF PI-OFFLINE     = 'Y' AND
 15707            PI-ECHECKNO-CR = 'CR'
 15708              GO TO 6110-READ-CONTROL
 15709         ELSE
 15710            IF PI-CASH = 'N'
 15711                GO TO 6110-READ-CONTROL.
 15712
 15713     IF CHECK-NO-MANUAL    OR
 15714        CHECK-NO-AT-PRINT  OR
 15715        PI-OFFLINE = 'Y'
 15716          GO TO 6130-BUILD-TRAILER.
 15717     IF PI-COMPANY-ID = 'FIA'
 15718         NEXT SENTENCE
 15719     ELSE
 15720         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15721             GO TO 6110-READ-CONTROL.
 15722
 15723     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15724
 15725     IF CHECK-CNT-RESET-VALUE
 15726        MOVE +1                  TO CF-CHECK-COUNTER
 15727     ELSE
 15728        ADD +1                   TO CF-CHECK-COUNTER.
 15729
 15730     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15731
 15732     IF CHECK-NO-CARR-SEQ
 15733        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15734
 15735     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15736
 15737     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15738     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15739        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15740         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15741         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15742            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15743         MOVE WRK-NEXT-AUDIT-CHK-NO TO
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 303
* EL156.cbl
 15744                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15745     END-IF.
 15746
 15747     GO TO 6120-REWRITE.
 15748
 15749 6105-STATE-CHECK-NUMBER.
 15750     IF CHECK-NO-MANUAL    OR
 15751        CHECK-NO-AT-PRINT  OR
 15752        PI-OFFLINE = 'Y'
 15753           GO TO 6130-BUILD-TRAILER
 15754     END-IF.
 15755
 15756     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15757     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15758     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15759     MOVE '3'                TO CNTL-REC-TYPE.
 15760     MOVE +0                 TO CNTL-SEQ-NO.
 15761     MOVE 'STAT'             TO FILE-SWITCH.
 15762     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15763
 15764     IF CF-ST-CHECK-CNT-RESET
 15765         MOVE +1             TO CF-ST-CHECK-COUNTER
 15766     ELSE
 15767         ADD +1              TO CF-ST-CHECK-COUNTER
 15768     END-IF.
 15769
 15770     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15771     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15772     GO TO 6120-REWRITE.
 15773
 15774 6110-READ-CONTROL.
 15775     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15776     MOVE '1'                    TO CNTL-REC-TYPE.
 15777     MOVE SPACES                 TO CNTL-ACCESS.
 15778     MOVE 0                      TO CNTL-SEQ-NO.
 15779
 15780     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15781
 15782     IF CO-CHECK-COUNT-RESET
 15783        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15784     ELSE
 15785        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15786
 15787     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15788
 15789     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15790         IF PI-OFFLINE     = 'Y'  AND
 15791            PI-ECHECKNO-CR = 'CR'
 15792              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15793              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15794              MOVE AL-UANON           TO CHECKNOA
 15795              GO TO 6120-REWRITE
 15796         ELSE
 15797         IF PI-CASH = 'N'
 15798             MOVE 'N'                TO PI-ECHECKNO-N
 15799             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15800             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15801             MOVE AL-UANON           TO CHECKNOA
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 304
* EL156.cbl
 15802             GO TO 6120-REWRITE.
 15803
 15804     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15805
 15806 6120-REWRITE.
 15807
 15808* EXEC CICS REWRITE
 15809*         DATASET('ELCNTL')
 15810*         FROM(CONTROL-FILE)
 15811*     END-EXEC.
 15812     MOVE LENGTH OF
 15813      CONTROL-FILE
 15814       TO DFHEIV11
 15815     MOVE 'ELCNTL' TO DFHEIV1
 15816*    MOVE '&& L                  %   #00014866' TO DFHEIV0
 15817     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15818     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15819     MOVE X'2020233030303134383636' TO DFHEIV0(25:11)
 15820     CALL 'kxdfhei1' USING DFHEIV0,
 15821           DFHEIV1,
 15822           CONTROL-FILE,
 15823           DFHEIV11,
 15824           DFHEIV99
 15825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15826
 15827
 15828     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15829
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 305
* EL156.cbl
 15831 6130-BUILD-TRAILER.
 15832
 15833
 15834* EXEC CICS GETMAIN
 15835*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15836*         LENGTH    (200)
 15837*         INITIMG   (GETMAIN-SPACE)
 15838*     END-EXEC.
 15839     MOVE 200
 15840       TO DFHEIV11
 15841*    MOVE ',"IL                  $   #00014876' TO DFHEIV0
 15842     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15843     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15844     MOVE X'2020233030303134383736' TO DFHEIV0(25:11)
 15845     CALL 'kxdfhei1' USING DFHEIV0,
 15846           DFHEIV20,
 15847           DFHEIV11,
 15848           GETMAIN-SPACE
 15849     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15850         DFHEIV20
 15851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15852
 15853
 15854     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15855                                    AT-PREV-PAID-THRU-DT.
 15856     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15857     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15858     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15859     MOVE 'AT'                   TO AT-RECORD-ID.
 15860     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15861
 15862     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15863        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15864           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15865     ELSE
 15866           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15867           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15868
 15869     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15870         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15871             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15872             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15873           ELSE
 15874             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15875             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15876
 15877     MOVE '2'                    TO AT-TRAILER-TYPE.
 15878     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15879                                    AT-PAYMENT-LAST-MAINT-DT.
 15880     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15881                                    AT-PAYMENT-LAST-UPDATED-BY.
 15882     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15883     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15884     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15885     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15886
 15887     IF PI-PMT-APPROVED
 15888        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 306
* EL156.cbl
 15889           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15890
 15891     IF PI-PFKEY-USED = DFHPF5
 15892        GO TO 6140-PF5-ENTERED.
 15893
 15894     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15895     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15896
 15897     IF PI-AIG-SPECIAL-BENEFIT
 15898         IF WS-1ST-SPECIAL-PMT
 15899             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15900             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15901                                        AT-AMOUNT-PAID
 15902         ELSE
 15903             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15904
 15905     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15906
 15907     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15908     MOVE '4'                    TO DC-OPTION-CODE.
 15909     PERFORM 9700-LINK-DATE-CONVERT.
 15910
 15911     IF DATE-CONVERSION-ERROR
 15912        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15913     ELSE
 15914        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15915
 15916     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15917     MOVE '4'                    TO DC-OPTION-CODE.
 15918     PERFORM 9700-LINK-DATE-CONVERT.
 15919
 15920     IF DATE-CONVERSION-ERROR
 15921        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15922     ELSE
 15923        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15924
 15925     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD
 15926     move pi-ach-payment         to at-ach-payment
 15927     GO TO 6150-FINISH-MOVE.
 15928
 15929 6140-PF5-ENTERED.
 15930     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15931     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15932
 15933     IF PI-AIG-SPECIAL-BENEFIT
 15934         IF WS-1ST-SPECIAL-PMT
 15935             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15936             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15937                                        AT-AMOUNT-PAID
 15938         ELSE
 15939             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15940
 15941     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15942     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15943     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15944
 15945 6150-FINISH-MOVE.
 15946
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 307
* EL156.cbl
 15947     IF PI-ECHECKNO = SPACES
 15948         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15949     ELSE
 15950         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15951
 15952     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15953     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15954
 15955*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15956*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15957
 15958     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15959         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15960
 15961     IF PI-OFFLINE = 'N'
 15962        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15963        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15964     ELSE
 15965        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15966        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15967
 15968     move pi-ach-payment         to at-ach-payment
 15969     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15970
 15971     IF WS-2ND-SPECIAL-PMT
 15972         MOVE 'Y'                TO AT-CASH-PAYMENT
 15973         MOVE SPACES             TO AT-CHECK-NO
 15974         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15975         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15976         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15977         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15978
 15979     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15980                                    AT-TO-BE-WRITTEN-DT.
 15981
 15982     IF PI-HOLDTIL NOT = ZEROS
 15983        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15984        MOVE '4'                 TO DC-OPTION-CODE
 15985        PERFORM 9700-LINK-DATE-CONVERT
 15986        IF PI-OFFLINE = 'N'
 15987           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15988           MOVE 'P'              TO WS-HOLD-UNTIL-SW
 15989        ELSE
 15990           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15991
 15992     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15993     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15994                                    AT-CHECK-QUE-SEQUENCE.
 15995
 15996     IF PI-PFKEY-USED = DFHPF4
 15997        MOVE '1'                 TO AT-FORCE-CONTROL.
 15998
 15999     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 16000        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 16001        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 16002        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 16003
 16004     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 308
* EL156.cbl
 16005                                    AT-VOID-SELECT-DT
 16006                                    AT-VOID-ACCEPT-DT
 16007                                    AT-VOID-DT.
 16008     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 16009        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 16010        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 16011        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 16012        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 16013     ELSE
 16014        MOVE ZEROS               TO AT-DAILY-RATE
 16015                                    AT-ELIMINATION-DAYS
 16016        MOVE SPACES              TO AT-BENEFIT-TYPE
 16017     END-IF
 16018     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 16019     MOVE '4'                    TO DC-OPTION-CODE.
 16020     PERFORM 9700-LINK-DATE-CONVERT.
 16021     IF DATE-CONVERSION-ERROR
 16022         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 16023     ELSE
 16024         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 16025     END-IF.
 16026     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 16027     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 16028     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 16029     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 16030     IF (PI-REAUDIT-NEEDED = 'Y')
 16031        or (pi-max-ext-used = 'Y')
 16032        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 16033         PERFORM 6155-READ-CONTROL
 16034         PERFORM 6157-SET-APP-LEVEL
 16035         IF AT-APPROVAL-LEVEL-REQD < '4'
 16036            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 16037         END-IF
 16038         MOVE 'Y' TO WS-NEED-APPROVAL
 16039         GO TO 6170-WRITE
 16040     END-IF.
 16041*******************************************************
 16042     IF NOT PI-PMT-GRADUATED
 16043         GO TO 6170-WRITE.
 16044     PERFORM 6155-READ-CONTROL.
 16045
 16046     IF PAID-FOR-LIFE
 16047         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 16048             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16049                                     WS-PMT-APPROVAL-SW
 16050             GO TO 6170-WRITE.
 16051
 16052*05999      IF PAID-FOR-AH
 16053     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 16054         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 16055             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16056                                     WS-PMT-APPROVAL-SW
 16057             GO TO 6170-WRITE.
 16058
 16059     MOVE '1'                    TO AT-APPROVED-LEVEL.
 16060
 16061     PERFORM 6157-SET-APP-LEVEL.
 16062
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 309
* EL156.cbl
 16063     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 16064
 16065     IF NOT PI-PMT-GRADUATED
 16066         GO TO 6170-WRITE.
 16067
 16068
 16069* EXEC CICS HANDLE CONDITION
 16070*        NOTFND   (6170-WRITE)
 16071*    END-EXEC.
 16072*    MOVE '"$I                   ! 2 #00015096' TO DFHEIV0
 16073     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16074     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16075     MOVE X'3220233030303135303936' TO DFHEIV0(25:11)
 16076     CALL 'kxdfhei1' USING DFHEIV0
 16077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16078
 16079
 16080     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16081     MOVE '2'                    TO CNTL-REC-TYPE.
 16082     MOVE +0                     TO CNTL-SEQ-NO.
 16083     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 16084
 16085
 16086* EXEC CICS READ
 16087*         DATASET  ('ELCNTL')
 16088*         SET      (ADDRESS OF CONTROL-FILE)
 16089*         RIDFLD   (ELCNTL-KEY)
 16090*    END-EXEC.
 16091     MOVE 'ELCNTL' TO DFHEIV1
 16092*    MOVE '&"S        E          (   #00015105' TO DFHEIV0
 16093     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16094     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16095     MOVE X'2020233030303135313035' TO DFHEIV0(25:11)
 16096     CALL 'kxdfhei1' USING DFHEIV0,
 16097           DFHEIV1,
 16098           DFHEIV20,
 16099           DFHEIV99,
 16100           ELCNTL-KEY,
 16101           DFHEIV99,
 16102           DFHEIV99,
 16103           DFHEIV99
 16104     SET ADDRESS OF CONTROL-FILE TO
 16105         DFHEIV20
 16106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16107
 16108
 16109     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 16110
 16111     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 16112                         OR '4' OR '5'
 16113         NEXT SENTENCE
 16114     ELSE
 16115         MOVE 'Y' TO WS-NEED-APPROVAL
 16116         GO TO 6170-WRITE.
 16117
 16118     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 16119         MOVE 'Y' TO WS-NEED-APPROVAL
 16120         IF WS-APPROVAL-LEVEL = '1'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 310
* EL156.cbl
 16121             MOVE '2'        TO  AT-APPROVED-LEVEL
 16122                            WS-SAVE-APPROVED-LEVEL
 16123             GO TO 6170-WRITE
 16124         ELSE
 16125             IF WS-APPROVAL-LEVEL = '2'
 16126                 MOVE '3'        TO  AT-APPROVED-LEVEL
 16127                                WS-SAVE-APPROVED-LEVEL
 16128                 GO TO 6170-WRITE
 16129             ELSE IF WS-APPROVAL-LEVEL = '3'
 16130                 MOVE '4'        TO  AT-APPROVED-LEVEL
 16131                                WS-SAVE-APPROVED-LEVEL
 16132                 GO TO 6170-WRITE
 16133             ELSE IF WS-APPROVAL-LEVEL = '4'
 16134                 MOVE '5'        TO  AT-APPROVED-LEVEL
 16135                                WS-SAVE-APPROVED-LEVEL
 16136                 GO TO 6170-WRITE.
 16137
 16138     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16139                             WS-PMT-APPROVAL-SW.
 16140     MOVE SPACES         TO  AT-APPROVED-LEVEL
 16141                             AT-APPROVAL-LEVEL-REQD.
 16142
 16143*******************************************************
 16144 6155-READ-CONTROL.
 16145     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16146     MOVE '1'                    TO CNTL-REC-TYPE.
 16147     MOVE SPACES                 TO CNTL-ACCESS.
 16148     MOVE +0                     TO CNTL-SEQ-NO.
 16149     MOVE 'COMP'                 TO FILE-SWITCH.
 16150
 16151     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 16152 6157-SET-APP-LEVEL.
 16153******A&H Limits are set as a monthly payment.  Calculate the mont
 16154******equivalent of the amount paid today
 16155     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 16156        PI-SAVE-ODD-DAYS-OVER > 0
 16157           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 16158                               / 30) + PI-SAVE-ELAPSED-MONTHS
 16159           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 16160                                  WS-CALC-PMT-MONTHS
 16161     ELSE
 16162           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 16163     END-IF.
 16164*06007      IF ((PAID-FOR-AH) AND
 16165     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16166           OR PAID-FOR-FAM) AND
 16167*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16168        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 16169              OR
 16170        ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16171        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16172            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16173       ELSE
 16174*06014      IF ((PAID-FOR-AH)  AND
 16175         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16176           OR PAID-FOR-FAM) AND
 16177*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 16178           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 311
* EL156.cbl
 16179              OR
 16180        ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16181        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 16182            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16183         ELSE
 16184*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 16185           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16186                OR PAID-FOR-FAM) AND
 16187               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 16188              OR
 16189          ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16190          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 16191            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16192       ELSE
 16193           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16194                OR PAID-FOR-FAM) AND
 16195               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 16196              OR
 16197          ((PAID-FOR-LIFE OR PAID-FOR-OTH) AND
 16198          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 16199            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16200       ELSE
 16201            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16202
 16203     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16204           OR PAID-FOR-FAM) AND
 16205        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 16206        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 16207            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16208        END-IF
 16209     ELSE
 16210     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16211           OR PAID-FOR-FAM) AND
 16212        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 16213        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 16214            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16215        END-IF
 16216     ELSE
 16217     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16218           OR PAID-FOR-FAM) AND
 16219        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 16220        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 16221            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16222        END-IF
 16223     ELSE
 16224     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16225           OR PAID-FOR-FAM) AND
 16226        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 16227        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 16228            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16229        END-IF
 16230     ELSE
 16231     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16232           OR PAID-FOR-FAM)
 16233            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16234
 16235 6170-WRITE.
 16236
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 312
* EL156.cbl
 16237     if pi-company-id = 'DCC' or 'VPP'
 16238        PERFORM 0900-GET-DDF-limits
 16239                                 THRU 0900-EXIT
 16240     end-if
 16241     perform 2220-update-elcrtt  thru 2220-exit
 16242     IF PI-COMPANY-ID = 'DMD'
 16243        IF PI-AT-EOB-CODES NOT = SPACES
 16244           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16245           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16246           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16247           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16248           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16249
 16250
 16251* EXEC CICS HANDLE CONDITION
 16252*        DUPREC    (6180-DUPREC)
 16253*    END-EXEC.
 16254*    MOVE '"$%                   ! 3 #00015252' TO DFHEIV0
 16255     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16256     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16257     MOVE X'3320233030303135323532' TO DFHEIV0(25:11)
 16258     CALL 'kxdfhei1' USING DFHEIV0
 16259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16260
 16261
 16262
 16263* EXEC CICS WRITE
 16264*         DATASET       ('ELTRLR')
 16265*         FROM          (ACTIVITY-TRAILERS)
 16266*         RIDFLD        (AT-CONTROL-PRIMARY)
 16267*     END-EXEC.
 16268     MOVE LENGTH OF
 16269      ACTIVITY-TRAILERS
 16270       TO DFHEIV11
 16271     MOVE 'ELTRLR' TO DFHEIV1
 16272*    MOVE '&$ L                  ''   #00015256' TO DFHEIV0
 16273     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16274     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16275     MOVE X'2020233030303135323536' TO DFHEIV0(25:11)
 16276     CALL 'kxdfhei1' USING DFHEIV0,
 16277           DFHEIV1,
 16278           ACTIVITY-TRAILERS,
 16279           DFHEIV11,
 16280           AT-CONTROL-PRIMARY,
 16281           DFHEIV99,
 16282           DFHEIV99
 16283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16284
 16285
 16286     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 16287        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 16288*06088           GO TO 6199-EXIT.
 16289           GO TO 6176-APPROVAL-NOTE.
 16290
 16291
 16292* EXEC CICS GETMAIN
 16293*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16294*         LENGTH    (200)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 313
* EL156.cbl
 16295*         INITIMG   (GETMAIN-SPACE)
 16296*     END-EXEC.
 16297     MOVE 200
 16298       TO DFHEIV11
 16299*    MOVE ',"IL                  $   #00015267' TO DFHEIV0
 16300     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16301     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16302     MOVE X'2020233030303135323637' TO DFHEIV0(25:11)
 16303     CALL 'kxdfhei1' USING DFHEIV0,
 16304           DFHEIV20,
 16305           DFHEIV11,
 16306           GETMAIN-SPACE
 16307     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16308         DFHEIV20
 16309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16310
 16311
 16312     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16313
 16314     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 16315     MOVE 'AT'                   TO AT-RECORD-ID.
 16316     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16317     MOVE '6'                    TO AT-TRAILER-TYPE.
 16318     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16319                                    AT-GEN-INFO-LAST-MAINT-DT
 16320     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16321                                    AT-GEN-INFO-LAST-UPDATED-BY
 16322     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16323
 16324     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 16325     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 16326     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 16327
 16328     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 16329
 16330 6175-WRITE.
 16331
 16332
 16333* EXEC CICS HANDLE CONDITION
 16334*        DUPREC    (6190-DUPREC)
 16335*    END-EXEC.
 16336*    MOVE '"$%                   ! 4 #00015293' TO DFHEIV0
 16337     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16338     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16339     MOVE X'3420233030303135323933' TO DFHEIV0(25:11)
 16340     CALL 'kxdfhei1' USING DFHEIV0
 16341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16342
 16343
 16344
 16345* EXEC CICS WRITE
 16346*         DATASET     ('ELTRLR')
 16347*         FROM        (ACTIVITY-TRAILERS)
 16348*         RIDFLD      (AT-CONTROL-PRIMARY)
 16349*     END-EXEC.
 16350     MOVE LENGTH OF
 16351      ACTIVITY-TRAILERS
 16352       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 314
* EL156.cbl
 16353     MOVE 'ELTRLR' TO DFHEIV1
 16354*    MOVE '&$ L                  ''   #00015297' TO DFHEIV0
 16355     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16356     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16357     MOVE X'2020233030303135323937' TO DFHEIV0(25:11)
 16358     CALL 'kxdfhei1' USING DFHEIV0,
 16359           DFHEIV1,
 16360           ACTIVITY-TRAILERS,
 16361           DFHEIV11,
 16362           AT-CONTROL-PRIMARY,
 16363           DFHEIV99,
 16364           DFHEIV99
 16365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16366
 16367
 16368 6176-APPROVAL-NOTE.
 16369
 16370     IF NOT APPROVAL-NEEDED
 16371         GO TO 6199-EXIT.
 16372
 16373
 16374* EXEC CICS GETMAIN
 16375*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16376*        LENGTH    (200)
 16377*        INITIMG   (GETMAIN-SPACE)
 16378*    END-EXEC.
 16379     MOVE 200
 16380       TO DFHEIV11
 16381*    MOVE ',"IL                  $   #00015308' TO DFHEIV0
 16382     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16383     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16384     MOVE X'2020233030303135333038' TO DFHEIV0(25:11)
 16385     CALL 'kxdfhei1' USING DFHEIV0,
 16386           DFHEIV20,
 16387           DFHEIV11,
 16388           GETMAIN-SPACE
 16389     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16390         DFHEIV20
 16391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16392
 16393
 16394     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16395
 16396     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16397     MOVE 'AT'               TO AT-RECORD-ID
 16398     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16399     MOVE '6'                TO AT-TRAILER-TYPE
 16400     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16401                                AT-GEN-INFO-LAST-MAINT-DT
 16402     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16403                                AT-GEN-INFO-LAST-UPDATED-BY
 16404     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16405
 16406     IF PI-REAUDIT-NEEDED = 'Y'
 16407         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16408     ELSE
 16409         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 16410     END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 315
* EL156.cbl
 16411     IF PI-APPROVAL-3550-NEEDED = 'Y'
 16412         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16413     END-IF
 16414     MOVE SPACES             TO AT-INFO-LINE-2
 16415
 16416     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16417 6177-WRITE.
 16418
 16419
 16420* EXEC CICS HANDLE CONDITION
 16421*        DUPREC    (6185-DUPREC)
 16422*    END-EXEC.
 16423*    MOVE '"$%                   ! 5 #00015339' TO DFHEIV0
 16424     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16425     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16426     MOVE X'3520233030303135333339' TO DFHEIV0(25:11)
 16427     CALL 'kxdfhei1' USING DFHEIV0
 16428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16429
 16430
 16431
 16432* EXEC CICS WRITE
 16433*         DATASET     ('ELTRLR')
 16434*         FROM        (ACTIVITY-TRAILERS)
 16435*         RIDFLD      (AT-CONTROL-PRIMARY)
 16436*     END-EXEC.
 16437     MOVE LENGTH OF
 16438      ACTIVITY-TRAILERS
 16439       TO DFHEIV11
 16440     MOVE 'ELTRLR' TO DFHEIV1
 16441*    MOVE '&$ L                  ''   #00015343' TO DFHEIV0
 16442     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16443     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16444     MOVE X'2020233030303135333433' TO DFHEIV0(25:11)
 16445     CALL 'kxdfhei1' USING DFHEIV0,
 16446           DFHEIV1,
 16447           ACTIVITY-TRAILERS,
 16448           DFHEIV11,
 16449           AT-CONTROL-PRIMARY,
 16450           DFHEIV99,
 16451           DFHEIV99
 16452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16453
 16454
 16455
 16456     GO TO 6199-EXIT.
 16457
 16458 6180-DUPREC.
 16459
 16460     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16461     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16462     GO TO 6170-WRITE.
 16463
 16464 6185-DUPREC.
 16465     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16466     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16467     GO TO 6177-WRITE.
 16468
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 316
* EL156.cbl
 16469 6190-DUPREC.
 16470     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16471     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16472     GO TO 6175-WRITE.
 16473
 16474 6199-EXIT.
 16475      EXIT.
 16476
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 317
* EL156.cbl
 16478 6200-UPDATE-CLAIM-MSTR.
 16479     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16480     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16481     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16482     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16483
 16484     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16485
 16486     MOVE ZEROS                  TO W-INTEREST.
 16487
 16488     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 16489        IF (PI-OFFLINE = 'Y') OR
 16490           (PI-PMTTYPE = '7')
 16491           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16492                                 THRU 9870-EXIT
 16493        END-IF
 16494     END-IF
 16495     IF NOT ERROR-ON-OUTPUT
 16496        CONTINUE
 16497     ELSE
 16498
 16499* EXEC CICS REWRITE
 16500*          DATASET('ELMSTR')
 16501*          FROM(CLAIM-MASTER)
 16502*       END-EXEC
 16503     MOVE LENGTH OF
 16504      CLAIM-MASTER
 16505       TO DFHEIV11
 16506     MOVE 'ELMSTR' TO DFHEIV1
 16507*    MOVE '&& L                  %   #00015392' TO DFHEIV0
 16508     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16509     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16510     MOVE X'2020233030303135333932' TO DFHEIV0(25:11)
 16511     CALL 'kxdfhei1' USING DFHEIV0,
 16512           DFHEIV1,
 16513           CLAIM-MASTER,
 16514           DFHEIV11,
 16515           DFHEIV99
 16516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16517
 16518        MOVE -1                  TO ENTPFBL
 16519        MOVE AL-UANON            TO ENTPFBA
 16520        MOVE MAP-NAMEB           TO MAP-NAME
 16521        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16522        GO TO 8200-SEND-DATAONLY
 16523     END-IF
 16524
 16525     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16526
 16527     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16528
 16529     IF PI-AIG-SPECIAL-BENEFIT
 16530         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16531
 16532     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16533
 16534     IF PI-SPECIAL-BEN-SW = 'Y'
 16535         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 318
* EL156.cbl
 16536         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16537
 16538     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16539         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16540     ELSE
 16541         IF PI-PMTTYPE NOT = '4'
 16542            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16543
 16544     IF PI-PMTTYPE = '5' OR '6'
 16545        GO TO  6250-SET-MAINT.
 16546
 16547     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16548                                         CL-LAG-REPORT-CODE.
 16549
 16550     IF CL-ACTIVITY-CODE = 09
 16551         GO TO 6200-CONT-UPDATE.
 16552
 16553     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16554         IF CL-ACTIVITY-CODE = 11
 16555             GO TO 6200-CONT-UPDATE.
 16556
 16557     IF WS-ACT-REC-FOUND-SW = 'N'
 16558         GO TO 6200-CONT-UPDATE.
 16559
 16560     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16561         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16562         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16563         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16564
 16565     IF WS-UPDATE-SW = 'Y'
 16566         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16567                                         CL-NEXT-FOLLOWUP-DT.
 16568
 16569 6200-CONT-UPDATE.
 16570
 16571     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16572       IF CLAIM-IS-CLOSED
 16573         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16574           IF WS-OPEN-CLOSE-SW = '2'
 16575             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16576                                        CL-LAST-CLOSE-DT.
 16577
 16578     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16579        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16580        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16581
 16582     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16583        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16584        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16585        MOVE 'C'                 TO CL-CLAIM-STATUS
 16586        IF PI-PMTTYPE = '2'
 16587           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16588              or 'F')
 16589           CONTINUE
 16590        ELSE
 16591           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16592        END-IF
 16593     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 319
* EL156.cbl
 16594        IF PI-PMTTYPE = '2' OR '3'
 16595           IF PI-PMTTYPE = '2' AND
 16596              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16597                 or 'F')
 16598              CONTINUE
 16599           ELSE
 16600              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16601           END-IF
 16602        END-IF
 16603     END-IF
 16604
 16605     IF PI-PMTTYPE = '4'
 16606        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16607
 16608     IF PI-COMPANY-ID = 'CVL'
 16609         IF PI-LOAN-UPDATE-SW = 'Y'
 16610             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16611             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16612             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16613             MOVE CL-CERT-STATE      TO  CERT-STATE
 16614             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16615             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16616             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16617             MOVE 'CERT'             TO  FILE-SWITCH
 16618             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16619             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16620             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16621
 16622     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16623        GO TO 6220-USE-COMPUTED.
 16624
 16625     IF (PI-PMTTYPE = '4')  AND
 16626        (PI-EPYAMT < ZEROS)
 16627          COMPUTE CL-NO-OF-DAYS-PAID =
 16628                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16629          IF CL-NO-OF-DAYS-PAID < +0
 16630              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16631          ELSE
 16632              NEXT SENTENCE
 16633     ELSE
 16634          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16635
 16636     IF HOLD-UNTIL-PMT
 16637        CONTINUE
 16638     ELSE
 16639     IF PI-PROCESSOR-ID = 'FIX '
 16640        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16641           NEXT SENTENCE
 16642        ELSE
 16643           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16644     ELSE
 16645        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16646
 16647     IF PI-PMTTYPE = '4'
 16648        GO TO 6250-SET-MAINT.
 16649
 16650     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16651     MOVE '4'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 320
* EL156.cbl
 16652     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16653     IF HOLD-UNTIL-PMT
 16654        CONTINUE
 16655     ELSE
 16656     IF DATE-CONVERSION-ERROR
 16657        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16658     ELSE
 16659        ADD 1                 TO CL-NO-OF-PMTS-MADE
 16660        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16661           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16662           IF PI-AIG-SPECIAL-BENEFIT
 16663               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16664           ELSE
 16665               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16666
 16667     GO TO 6250-SET-MAINT.
 16668
 16669 6220-USE-COMPUTED.
 16670
 16671     IF (PI-PMTTYPE = '4')  AND
 16672        (PI-CPYAMT < ZEROS)
 16673          COMPUTE CL-NO-OF-DAYS-PAID =
 16674                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16675          IF CL-NO-OF-DAYS-PAID < +0
 16676              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16677          ELSE
 16678              NEXT SENTENCE
 16679     ELSE
 16680          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16681
 16682     IF NOT HOLD-UNTIL-PMT
 16683        ADD 1                    TO CL-NO-OF-PMTS-MADE
 16684        ADD PI-CPYAMT            TO CL-TOTAL-PAID-AMT.
 16685
 16686     IF PI-PMTTYPE = '4'
 16687        GO TO 6250-SET-MAINT.
 16688
 16689     IF PI-AIG-SPECIAL-BENEFIT
 16690         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16691     ELSE
 16692         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16693
 16694     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16695       AND NOT HOLD-UNTIL-PMT
 16696        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16697
 16698 6250-SET-MAINT.
 16699     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16700
 16701     IF PI-PROCESSOR-ID = 'FIX '
 16702        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16703           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16704        ELSE
 16705           NEXT SENTENCE
 16706     ELSE
 16707        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16708
 16709     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 321
* EL156.cbl
 16710     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16711     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16712
 16713 6299-EXIT.
 16714      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 322
* EL156.cbl
 16716 6300-UPDATE-CERT.
 16717
 16718*  ADD CERTNOTE FOR SC NP+6
 16719     IF PI-COMPANY-ID = 'CID' AND
 16720       (PI-PMTTYPE = '2' OR '3') AND
 16721        CL-CERT-STATE = 'SC'  AND
 16722        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16723           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16724     END-IF.
 16725
 16726     IF PI-COMPANY-ID = 'AHL' AND
 16727       (PI-PMTTYPE = '2' OR '3') AND
 16728        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16729           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16730           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16731     END-IF.
 16732
 16733     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16734     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16735     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16736     MOVE CL-CERT-STATE    TO CERT-STATE.
 16737     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16738     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16739     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16740     MOVE 'CERT'           TO FILE-SWITCH.
 16741
 16742     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16743
 16744     IF CERT-NOTE-ADDED
 16745        IF CM-NOTE-SW = ' '
 16746           MOVE '4'             TO CM-NOTE-SW
 16747        ELSE
 16748           IF CM-NOTE-SW = '1'
 16749               MOVE '5'           TO CM-NOTE-SW
 16750           ELSE
 16751              IF CM-NOTE-SW = '2'
 16752                 MOVE '6'         TO CM-NOTE-SW
 16753              ELSE
 16754                 IF CM-NOTE-SW = '3'
 16755                    MOVE '7'      TO CM-NOTE-SW
 16756                 END-IF
 16757              END-IF
 16758           END-IF
 16759        END-IF
 16760     END-IF.
 16761
 16762     IF PI-COMPANY-ID = 'CVL'
 16763         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16764         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16765
 16766     IF PI-PMTTYPE NOT = '4'
 16767        GO TO 6340-UPDATE-CERT.
 16768
 16769     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16770        IF PI-PFKEY-USED = DFHPF5
 16771           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16772        ELSE
 16773           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 323
* EL156.cbl
 16774
 16775*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16776*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16777*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16778*               PI-LF-COVERAGE-TYPE = 'P'
 16779*                GO TO 6350-REWRITE-CERT.
 16780
 16781     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16782       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16783          PI-LF-COVERAGE-TYPE = 'P'
 16784           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16785                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16786                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16787                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16788                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16789                GO TO 6350-REWRITE-CERT
 16790            ELSE
 16791                GO TO 6350-REWRITE-CERT.
 16792
 16793     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16794         GO TO 6350-REWRITE-CERT.
 16795
 16796     IF NOT CM-AH-LUMP-SUM-DISAB
 16797        GO TO 6380-UNLOCK-CERT.
 16798
 16799     IF PI-PFKEY-USED = DFHPF5
 16800        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16801                                    CM-AH-ITD-AH-PMT
 16802        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16803        GO TO 6350-REWRITE-CERT
 16804     ELSE
 16805        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16806                                    CM-AH-ITD-AH-PMT
 16807        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16808        GO TO 6350-REWRITE-CERT.
 16809
 16810 6340-UPDATE-CERT.
 16811
 16812     IF CL-CLAIM-TYPE = 'L' OR 'O'
 16813         IF PI-PFKEY-USED = DFHPF5
 16814             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16815         ELSE
 16816             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16817
 16818     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16819         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16820             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16821                PI-LF-COVERAGE-TYPE = 'P'
 16822                 GO TO 6350-REWRITE-CERT.
 16823
 16824     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 16825       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16826          PI-LF-COVERAGE-TYPE = 'P'
 16827           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16828                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16829                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16830                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16831                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 324
* EL156.cbl
 16832                GO TO 6350-REWRITE-CERT.
 16833
 16834     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16835         IF PI-LIFE-OVERRIDE-L1 = ('L' OR 'O') AND
 16836            PI-LF-COVERAGE-TYPE NOT = 'P'
 16837             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16838             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16839             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16840             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16841             GO TO 6350-REWRITE-CERT.
 16842
 16843     IF CL-CLAIM-TYPE = 'O'
 16844         IF PI-LIFE-OVERRIDE-L1 = ('L' OR 'O') AND
 16845            PI-LF-COVERAGE-TYPE NOT = 'P'
 16846             MOVE CL-INCURRED-DT         TO CM-LF-CANCEL-DT
 16847             MOVE PI-MONTH-END-SAVE      TO CM-LF-CANCEL-EXIT-DT
 16848             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-CANCEL
 16849             MOVE '6'            TO CM-LF-CURRENT-STATUS
 16850             GO TO 6350-REWRITE-CERT.
 16851
 16852     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16853         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16854         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16855         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16856         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16857         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16858         IF PI-PFKEY-USED = DFHPF5
 16859             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16860                                        CM-AH-ITD-AH-PMT
 16861             GO TO 6350-REWRITE-CERT
 16862         ELSE
 16863             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16864                                        CM-AH-ITD-AH-PMT
 16865             GO TO 6350-REWRITE-CERT.
 16866
 16867 6350-REWRITE-CERT.
 16868
 16869
 16870* EXEC CICS REWRITE
 16871*         DATASET  ('ELCERT')
 16872*         FROM(CERTIFICATE-MASTER)
 16873*     END-EXEC.
 16874     MOVE LENGTH OF
 16875      CERTIFICATE-MASTER
 16876       TO DFHEIV11
 16877     MOVE 'ELCERT' TO DFHEIV1
 16878*    MOVE '&& L                  %   #00015748' TO DFHEIV0
 16879     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16880     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16881     MOVE X'2020233030303135373438' TO DFHEIV0(25:11)
 16882     CALL 'kxdfhei1' USING DFHEIV0,
 16883           DFHEIV1,
 16884           CERTIFICATE-MASTER,
 16885           DFHEIV11,
 16886           DFHEIV99
 16887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16888
 16889
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 325
* EL156.cbl
 16890     GO TO 6399-EXIT.
 16891
 16892 6380-UNLOCK-CERT.
 16893
 16894* EXEC CICS UNLOCK
 16895*         DATASET  ('ELCERT')
 16896*     END-EXEC.
 16897     MOVE 'ELCERT' TO DFHEIV1
 16898*    MOVE '&*                    #   #00015756' TO DFHEIV0
 16899     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16900     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16901     MOVE X'2020233030303135373536' TO DFHEIV0(25:11)
 16902     CALL 'kxdfhei1' USING DFHEIV0,
 16903           DFHEIV1,
 16904           DFHEIV99
 16905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16906
 16907
 16908 6399-EXIT.
 16909      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 326
* EL156.cbl
 16911 6400-UPDATE-ZERO-TRAILER.
 16912     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16913     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16914
 16915     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16916
 16917     IF PI-EPYAMT NOT = ZEROS
 16918         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16919     ELSE
 16920         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16921
 16922     IF PI-ERESV NOT = ZEROS
 16923        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16924
 16925     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16926        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16927
 16928     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16929        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16930     ELSE
 16931        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16932
 16933     IF PI-PMTTYPE = '5'
 16934        IF PI-EPYAMT = ZEROS
 16935           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16936        ELSE
 16937           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16938
 16939     IF PI-PMTTYPE = '6'
 16940        IF PI-EPYAMT = ZEROS
 16941           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16942        ELSE
 16943           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16944
 16945 6420-CHECK-OPEN-CLOSE.
 16946     IF PI-PMTTYPE = '5' OR '6'
 16947        GO TO 6450-REWRITE.
 16948
 16949     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16950         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16951             IF CLAIM-IS-CLOSED
 16952                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16953                 MOVE 1          TO  SUB-1
 16954                 GO TO 6440-AIG-LOOP.
 16955
 16956     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16957        GO TO 6450-REWRITE.
 16958
 16959     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16960        GO TO 6450-REWRITE.
 16961
 16962     MOVE 1                      TO SUB-1.
 16963
 16964 6430-LOOP.
 16965     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16966        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16967        IF PI-PMTTYPE = '1' OR '4'
 16968           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 327
* EL156.cbl
 16969           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16970           GO TO 6450-REWRITE
 16971        ELSE
 16972           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16973           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16974           GO TO 6450-REWRITE.
 16975
 16976     IF SUB-1 = 6
 16977      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16978      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16979      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16980      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16981      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16982      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16983      GO TO 6430-LOOP.
 16984
 16985     ADD 1                       TO SUB-1.
 16986     GO TO 6430-LOOP.
 16987
 16988
 16989 6440-AIG-LOOP.
 16990
 16991     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16992       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16993       IF WS-OPEN-CLOSE-SW = '1'
 16994         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16995         IF PI-PMTTYPE = '2'
 16996           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16997           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16998         ELSE
 16999           IF PI-PMTTYPE = '3'
 17000             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17001             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 17002           ELSE
 17003             IF PI-PMTTYPE = '4'
 17004               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17005               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 17006             ELSE
 17007               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17008               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 17009       ELSE
 17010         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 17011         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 17012         GO TO 6450-REWRITE.
 17013
 17014     IF SUB-1 = 6
 17015      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 17016      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 17017      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 17018      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 17019      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 17020      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 17021      GO TO 6440-AIG-LOOP.
 17022
 17023     ADD 1                       TO SUB-1.
 17024     GO TO 6440-AIG-LOOP.
 17025
 17026 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 328
* EL156.cbl
 17027     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 17028     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 17029     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 17030
 17031     IF PI-COMPANY-ID = 'DMD'
 17032         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 17033         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 17034         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 17035         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 17036         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 17037
 17038
 17039* EXEC CICS REWRITE
 17040*         DATASET  ('ELTRLR')
 17041*         FROM     (ACTIVITY-TRAILERS)
 17042*     END-EXEC.
 17043     MOVE LENGTH OF
 17044      ACTIVITY-TRAILERS
 17045       TO DFHEIV11
 17046     MOVE 'ELTRLR' TO DFHEIV1
 17047*    MOVE '&& L                  %   #00015890' TO DFHEIV0
 17048     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17049     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17050     MOVE X'2020233030303135383930' TO DFHEIV0(25:11)
 17051     CALL 'kxdfhei1' USING DFHEIV0,
 17052           DFHEIV1,
 17053           ACTIVITY-TRAILERS,
 17054           DFHEIV11,
 17055           DFHEIV99
 17056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17057
 17058
 17059 6499-EXIT.
 17060      EXIT.
 17061
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 329
* EL156.cbl
 17063 6500-READ-DLO035.
 17064     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 17065     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 17066     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 17067     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 17068
 17069
 17070* EXEC CICS LINK
 17071*        PROGRAM    ('DLO035')
 17072*        COMMAREA   (DLO035-KEY)
 17073*        LENGTH     (DL35-LENGTH)
 17074*    END-EXEC.
 17075     MOVE 'DLO035' TO DFHEIV1
 17076*    MOVE '."C                   (   #00015905' TO DFHEIV0
 17077     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17078     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17079     MOVE X'2020233030303135393035' TO DFHEIV0(25:11)
 17080     CALL 'kxdfhei1' USING DFHEIV0,
 17081           DFHEIV1,
 17082           DLO035-KEY,
 17083           DL35-LENGTH,
 17084           DFHEIV99,
 17085           DFHEIV99,
 17086           DFHEIV99,
 17087           DFHEIV99
 17088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17089
 17090
 17091     IF DL35-RETURN-CODE = 'OK'
 17092         GO TO 6500-EXIT.
 17093
 17094     IF DL35-RETURN-CODE = '01'
 17095         MOVE ER-7830            TO EMI-ERROR
 17096         GO TO 6500-BAD-EXIT.
 17097
 17098     IF DL35-RETURN-CODE = '02'
 17099         MOVE ER-7831            TO EMI-ERROR
 17100         GO TO 6500-BAD-EXIT.
 17101
 17102     IF DL35-RETURN-CODE = '03'
 17103         MOVE ER-7832            TO EMI-ERROR
 17104         GO TO 6500-BAD-EXIT.
 17105
 17106     IF DL35-RETURN-CODE = '04'
 17107         MOVE ER-7833            TO EMI-ERROR
 17108         GO TO 6500-BAD-EXIT.
 17109
 17110     IF DL35-RETURN-CODE = '05'
 17111         MOVE ER-7834            TO EMI-ERROR
 17112         GO TO 6500-BAD-EXIT.
 17113
 17114     IF DL35-RETURN-CODE = '06'
 17115         MOVE ER-7835            TO EMI-ERROR
 17116         GO TO 6500-BAD-EXIT.
 17117
 17118     IF DL35-RETURN-CODE = '07'
 17119         MOVE ER-7836            TO EMI-ERROR
 17120         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 330
* EL156.cbl
 17121
 17122     IF DL35-RETURN-CODE = 'E1'
 17123         MOVE ER-7837            TO EMI-ERROR
 17124         GO TO 6500-BAD-EXIT.
 17125
 17126     IF DL35-RETURN-CODE NOT = 'OK'
 17127         MOVE ER-7838            TO EMI-ERROR
 17128         GO TO 6500-BAD-EXIT.
 17129
 17130 6500-EXIT.
 17131      EXIT.
 17132
 17133 6500-BAD-EXIT.
 17134
 17135* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 17136*    MOVE '6"R                   !   #00015954' TO DFHEIV0
 17137     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17138     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17139     MOVE X'2020233030303135393534' TO DFHEIV0(25:11)
 17140     CALL 'kxdfhei1' USING DFHEIV0
 17141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17142
 17143     MOVE -1                 TO PMTTYPEL.
 17144     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17145     GO TO 8200-SEND-DATAONLY.
 17146
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 331
* EL156.cbl
 17148 6600-UPDATE-DLO035.
 17149     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 17150     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 17151     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 17152     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 17153
 17154
 17155* EXEC CICS LINK
 17156*        PROGRAM    ('DLO035')
 17157*        COMMAREA   (DLO035-KEY)
 17158*        LENGTH     (DL35-LENGTH)
 17159*    END-EXEC.
 17160     MOVE 'DLO035' TO DFHEIV1
 17161*    MOVE '."C                   (   #00015966' TO DFHEIV0
 17162     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17163     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17164     MOVE X'2020233030303135393636' TO DFHEIV0(25:11)
 17165     CALL 'kxdfhei1' USING DFHEIV0,
 17166           DFHEIV1,
 17167           DLO035-KEY,
 17168           DL35-LENGTH,
 17169           DFHEIV99,
 17170           DFHEIV99,
 17171           DFHEIV99,
 17172           DFHEIV99
 17173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17174
 17175
 17176     IF DL35-RETURN-CODE = 'OK'
 17177         GO TO 6600-EXIT.
 17178
 17179     IF DL35-RETURN-CODE = '01'
 17180         MOVE ER-7830            TO EMI-ERROR
 17181         GO TO 6500-BAD-EXIT.
 17182
 17183     IF DL35-RETURN-CODE = '02'
 17184         MOVE ER-7831            TO EMI-ERROR
 17185         GO TO 6500-BAD-EXIT.
 17186
 17187     IF DL35-RETURN-CODE = '03'
 17188         MOVE ER-7832            TO EMI-ERROR
 17189         GO TO 6500-BAD-EXIT.
 17190
 17191     IF DL35-RETURN-CODE = '04'
 17192         MOVE ER-7833            TO EMI-ERROR
 17193         GO TO 6500-BAD-EXIT.
 17194
 17195     IF DL35-RETURN-CODE = '05'
 17196         MOVE ER-7834            TO EMI-ERROR
 17197         GO TO 6500-BAD-EXIT.
 17198
 17199     IF DL35-RETURN-CODE = '06'
 17200         MOVE ER-7835            TO EMI-ERROR
 17201         GO TO 6500-BAD-EXIT.
 17202
 17203     IF DL35-RETURN-CODE = '07'
 17204         MOVE ER-7836            TO EMI-ERROR
 17205         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 332
* EL156.cbl
 17206
 17207     IF DL35-RETURN-CODE = 'E1'
 17208         MOVE ER-7837            TO EMI-ERROR
 17209         GO TO 6500-BAD-EXIT.
 17210
 17211     IF DL35-RETURN-CODE NOT = 'OK'
 17212         MOVE ER-7838            TO EMI-ERROR
 17213         GO TO 6500-BAD-EXIT.
 17214
 17215 6600-EXIT.
 17216      EXIT.
 17217
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 333
* EL156.cbl
 17219 6700-UPDATE-ACTQ.
 17220***************************************************************
 17221*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 17222*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 17223*    ONE ALREADY THERE.                                       *
 17224***************************************************************
 17225
 17226
 17227* EXEC CICS HANDLE CONDITION
 17228*         NOTFND(6720-BUILD-NEW-RECORD)
 17229*     END-EXEC.
 17230*    MOVE '"$I                   ! 6 #00016022' TO DFHEIV0
 17231     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17233     MOVE X'3620233030303136303232' TO DFHEIV0(25:11)
 17234     CALL 'kxdfhei1' USING DFHEIV0
 17235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17236
 17237
 17238
 17239* EXEC CICS READ
 17240*         DATASET('ELACTQ')
 17241*         RIDFLD (ELMSTR-KEY)
 17242*         SET    (ADDRESS OF ACTIVITY-QUE)
 17243*         UPDATE
 17244*     END-EXEC.
 17245     MOVE 'ELACTQ' TO DFHEIV1
 17246*    MOVE '&"S        EU         (   #00016026' TO DFHEIV0
 17247     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17248     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17249     MOVE X'2020233030303136303236' TO DFHEIV0(25:11)
 17250     CALL 'kxdfhei1' USING DFHEIV0,
 17251           DFHEIV1,
 17252           DFHEIV20,
 17253           DFHEIV99,
 17254           ELMSTR-KEY,
 17255           DFHEIV99,
 17256           DFHEIV99,
 17257           DFHEIV99
 17258     SET ADDRESS OF ACTIVITY-QUE TO
 17259         DFHEIV20
 17260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17261
 17262
 17263     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17264
 17265     IF PI-AIG-SPECIAL-BENEFIT AND
 17266        PI-CASH = 'Y'
 17267         ADD 2                   TO AQ-PAYMENT-COUNTER
 17268     ELSE
 17269         ADD 1                   TO AQ-PAYMENT-COUNTER.
 17270
 17271     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 17272         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 17273
 17274     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 17275
 17276     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 334
* EL156.cbl
 17277         IF WS-PMT-APPROVAL-SW = 'A'
 17278             NEXT SENTENCE
 17279         ELSE
 17280            IF PI-AIG-SPECIAL-BENEFIT AND
 17281               PI-CASH = 'Y'
 17282                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17283                                     WS-PMT-UNAPPROVED-CNT
 17284            ELSE
 17285                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17286                                     WS-PMT-UNAPPROVED-CNT
 17287     ELSE
 17288         IF PI-PMT-APPR-SW = 'Y'
 17289            IF PI-AIG-SPECIAL-BENEFIT AND
 17290               PI-CASH = 'Y'
 17291                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17292                                     WS-PMT-UNAPPROVED-CNT
 17293            ELSE
 17294                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17295                                     WS-PMT-UNAPPROVED-CNT.
 17296
 17297     IF WS-PMT-UNAPPROVED-CNT > ZERO
 17298         MOVE ER-3536 TO EMI-ERROR
 17299         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17300
 17301     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 17302
 17303
 17304* EXEC CICS REWRITE
 17305*         DATASET('ELACTQ')
 17306*         FROM   (ACTIVITY-QUE)
 17307*     END-EXEC.
 17308     MOVE LENGTH OF
 17309      ACTIVITY-QUE
 17310       TO DFHEIV11
 17311     MOVE 'ELACTQ' TO DFHEIV1
 17312*    MOVE '&& L                  %   #00016073' TO DFHEIV0
 17313     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17314     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17315     MOVE X'2020233030303136303733' TO DFHEIV0(25:11)
 17316     CALL 'kxdfhei1' USING DFHEIV0,
 17317           DFHEIV1,
 17318           ACTIVITY-QUE,
 17319           DFHEIV11,
 17320           DFHEIV99
 17321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17322
 17323
 17324     GO TO 6799-EXIT.
 17325
 17326 6720-BUILD-NEW-RECORD.
 17327
 17328* EXEC CICS GETMAIN
 17329*         SET    (ADDRESS OF ACTIVITY-QUE)
 17330*         LENGTH (60)
 17331*         INITIMG(GETMAIN-SPACE)
 17332*     END-EXEC.
 17333     MOVE 60
 17334       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 335
* EL156.cbl
 17335*    MOVE ',"IL                  $   #00016081' TO DFHEIV0
 17336     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17337     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17338     MOVE X'2020233030303136303831' TO DFHEIV0(25:11)
 17339     CALL 'kxdfhei1' USING DFHEIV0,
 17340           DFHEIV20,
 17341           DFHEIV11,
 17342           GETMAIN-SPACE
 17343     SET ADDRESS OF ACTIVITY-QUE TO
 17344         DFHEIV20
 17345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17346
 17347
 17348     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 17349
 17350     IF PI-AIG-SPECIAL-BENEFIT AND
 17351        PI-CASH = 'Y'
 17352         MOVE 2                  TO AQ-PAYMENT-COUNTER
 17353     ELSE
 17354         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 17355
 17356     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 17357     MOVE 'AQ'                   TO AQ-RECORD-ID.
 17358     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 17359     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 17360                                    AQ-FOLLOWUP-DATE.
 17361     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 17362     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17363
 17364     IF PI-PMT-GRADUATED
 17365         IF WS-PMT-APPROVAL-SW = 'A'
 17366             NEXT SENTENCE
 17367         ELSE
 17368            IF PI-AIG-SPECIAL-BENEFIT AND
 17369               PI-CASH = 'Y'
 17370                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17371            ELSE
 17372                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17373     ELSE
 17374         IF PI-PMT-APPR-SW = 'Y'
 17375            IF PI-AIG-SPECIAL-BENEFIT AND
 17376               PI-CASH = 'Y'
 17377                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17378            ELSE
 17379                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 17380
 17381     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 17382         MOVE ER-3536 TO EMI-ERROR
 17383         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17384
 17385
 17386* EXEC CICS WRITE
 17387*         DATASET('ELACTQ')
 17388*         RIDFLD (ELMSTR-KEY)
 17389*         FROM   (ACTIVITY-QUE)
 17390*     END-EXEC.
 17391     MOVE LENGTH OF
 17392      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 336
* EL156.cbl
 17393       TO DFHEIV11
 17394     MOVE 'ELACTQ' TO DFHEIV1
 17395*    MOVE '&$ L                  ''   #00016124' TO DFHEIV0
 17396     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17397     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17398     MOVE X'2020233030303136313234' TO DFHEIV0(25:11)
 17399     CALL 'kxdfhei1' USING DFHEIV0,
 17400           DFHEIV1,
 17401           ACTIVITY-QUE,
 17402           DFHEIV11,
 17403           ELMSTR-KEY,
 17404           DFHEIV99,
 17405           DFHEIV99
 17406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17407
 17408
 17409 6799-EXIT.
 17410      EXIT.
 17411
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 337
* EL156.cbl
 17413 6800-BUILD-FORM-TRAILER.
 17414
 17415
 17416* EXEC CICS GETMAIN
 17417*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17418*         LENGTH   (200)
 17419*         INITIMG  (GETMAIN-SPACE)
 17420*    END-EXEC.
 17421     MOVE 200
 17422       TO DFHEIV11
 17423*    MOVE ',"IL                  $   #00016136' TO DFHEIV0
 17424     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17425     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17426     MOVE X'2020233030303136313336' TO DFHEIV0(25:11)
 17427     CALL 'kxdfhei1' USING DFHEIV0,
 17428           DFHEIV20,
 17429           DFHEIV11,
 17430           GETMAIN-SPACE
 17431     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17432         DFHEIV20
 17433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17434
 17435
 17436     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17437
 17438     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17439     MOVE 'AT'                   TO AT-RECORD-ID.
 17440     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17441
 17442     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17443     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17444                                    AT-FORM-LAST-MAINT-DT
 17445                                    AT-FORM-SEND-ON-DT.
 17446     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17447                                    AT-FORM-LAST-UPDATED-BY.
 17448     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17449     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17450     MOVE '6'                    TO DC-OPTION-CODE.
 17451     MOVE +29                    TO DC-ELAPSED-DAYS.
 17452     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17453     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17454     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17455
 17456     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17457         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17458
 17459     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17460                                    AT-FORM-RE-SEND-DT
 17461                                    AT-EMP-FORM-ANSWERED-DT
 17462                                    AT-PHY-FORM-ANSWERED-DT
 17463                                    AT-EMP-FORM-SEND-ON-DT
 17464                                    AT-PHY-FORM-SEND-ON-DT
 17465                                    AT-FORM-PRINTED-DT
 17466                                    AT-FORM-REPRINT-DT.
 17467     MOVE '2'                    TO AT-FORM-TYPE.
 17468
 17469     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17470     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 338
* EL156.cbl
 17471
 17472     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17473         NEXT SENTENCE
 17474     ELSE
 17475         IF CL-PROG-FORM-TYPE NOT = 'S'
 17476            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17477
 17478
 17479* EXEC CICS WRITE
 17480*         DATASET  ('ELTRLR')
 17481*         FROM     (ACTIVITY-TRAILERS)
 17482*         RIDFLD   (AT-CONTROL-PRIMARY)
 17483*     END-EXEC.
 17484     MOVE LENGTH OF
 17485      ACTIVITY-TRAILERS
 17486       TO DFHEIV11
 17487     MOVE 'ELTRLR' TO DFHEIV1
 17488*    MOVE '&$ L                  ''   #00016184' TO DFHEIV0
 17489     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17490     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17491     MOVE X'2020233030303136313834' TO DFHEIV0(25:11)
 17492     CALL 'kxdfhei1' USING DFHEIV0,
 17493           DFHEIV1,
 17494           ACTIVITY-TRAILERS,
 17495           DFHEIV11,
 17496           AT-CONTROL-PRIMARY,
 17497           DFHEIV99,
 17498           DFHEIV99
 17499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17500
 17501
 17502 6899-EXIT.
 17503      EXIT.
 17504
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 339
* EL156.cbl
 17506 6900-BUILD-ARCHIVE-HEADER.
 17507
 17508     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17509     MOVE '1'                    TO CNTL-REC-TYPE.
 17510     MOVE +0                     TO CNTL-SEQ-NO.
 17511     MOVE SPACES                 TO CNTL-ACCESS.
 17512
 17513
 17514* EXEC CICS READ
 17515*         DATASET  ('ELCNTL')
 17516*         SET      (ADDRESS OF CONTROL-FILE)
 17517*         RIDFLD   (ELCNTL-KEY)
 17518*         UPDATE
 17519*    END-EXEC.
 17520     MOVE 'ELCNTL' TO DFHEIV1
 17521*    MOVE '&"S        EU         (   #00016201' TO DFHEIV0
 17522     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17523     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17524     MOVE X'2020233030303136323031' TO DFHEIV0(25:11)
 17525     CALL 'kxdfhei1' USING DFHEIV0,
 17526           DFHEIV1,
 17527           DFHEIV20,
 17528           DFHEIV99,
 17529           ELCNTL-KEY,
 17530           DFHEIV99,
 17531           DFHEIV99,
 17532           DFHEIV99
 17533     SET ADDRESS OF CONTROL-FILE TO
 17534         DFHEIV20
 17535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17536
 17537
 17538     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17539     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17540
 17541
 17542* EXEC CICS REWRITE
 17543*         FROM     (CONTROL-FILE)
 17544*         DATASET  ('ELCNTL')
 17545*    END-EXEC.
 17546     MOVE LENGTH OF
 17547      CONTROL-FILE
 17548       TO DFHEIV11
 17549     MOVE 'ELCNTL' TO DFHEIV1
 17550*    MOVE '&& L                  %   #00016211' TO DFHEIV0
 17551     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17552     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17553     MOVE X'2020233030303136323131' TO DFHEIV0(25:11)
 17554     CALL 'kxdfhei1' USING DFHEIV0,
 17555           DFHEIV1,
 17556           CONTROL-FILE,
 17557           DFHEIV11,
 17558           DFHEIV99
 17559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17560
 17561
 17562
 17563* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 340
* EL156.cbl
 17564*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17565*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17566*    END-EXEC.
 17567*    MOVE '"$$%                  ! 7 #00016216' TO DFHEIV0
 17568     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17569     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17570     MOVE X'3720233030303136323136' TO DFHEIV0(25:11)
 17571     CALL 'kxdfhei1' USING DFHEIV0
 17572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17573
 17574
 17575
 17576* EXEC CICS GETMAIN
 17577*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17578*         LENGTH  (ELARCH-LENGTH)
 17579*         INITIMG (GETMAIN-SPACE)
 17580*    END-EXEC.
 17581*    MOVE ',"IL                  $   #00016221' TO DFHEIV0
 17582     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17583     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17584     MOVE X'2020233030303136323231' TO DFHEIV0(25:11)
 17585     CALL 'kxdfhei1' USING DFHEIV0,
 17586           DFHEIV20,
 17587           ELARCH-LENGTH,
 17588           GETMAIN-SPACE
 17589     SET ADDRESS OF LETTER-ARCHIVE TO
 17590         DFHEIV20
 17591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17592
 17593
 17594     MOVE 'LA'                   TO LA-RECORD-ID.
 17595     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17596                                    LA-ARCHIVE-NO-A1.
 17597     MOVE '4'                    TO LA-RECORD-TYPE
 17598                                    LA-RECORD-TYPE-A1.
 17599     MOVE +0                     TO LA-LINE-SEQ-NO
 17600                                    LA-LINE-SEQ-NO-A1.
 17601     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17602                                    LA-COMPANY-CD-A1.
 17603     MOVE CL-CARRIER             TO LA4-CARRIER.
 17604     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17605     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17606     MOVE CL-CERT-STATE          TO LA4-STATE.
 17607     MOVE +0                     TO LA4-NO-OF-COPIES.
 17608     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17609     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17610     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17611                                    LA4-INITIAL-PRINT-DATE
 17612                                    LA4-RESEND-PRINT-DATE
 17613                                    LA4-FORM-REM-PRINT-DT.
 17614     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17615     MOVE '2'                    TO LA4-FORM-TYPE.
 17616
 17617
 17618* EXEC CICS WRITE
 17619*         DATASET  ('ELARCH')
 17620*         FROM     (LETTER-ARCHIVE)
 17621*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 341
* EL156.cbl
 17622*    END-EXEC.
 17623     MOVE LENGTH OF
 17624      LETTER-ARCHIVE
 17625       TO DFHEIV11
 17626     MOVE 'ELARCH' TO DFHEIV1
 17627*    MOVE '&$ L                  ''   #00016250' TO DFHEIV0
 17628     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17629     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17630     MOVE X'2020233030303136323530' TO DFHEIV0(25:11)
 17631     CALL 'kxdfhei1' USING DFHEIV0,
 17632           DFHEIV1,
 17633           LETTER-ARCHIVE,
 17634           DFHEIV11,
 17635           LA-CONTROL-PRIMARY,
 17636           DFHEIV99,
 17637           DFHEIV99
 17638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17639
 17640
 17641 6999-EXIT.
 17642      EXIT.
 17643
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 342
* EL156.cbl
 17645 7000-SHOW-CLAIM.
 17646     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17647     MOVE 'A'                    TO PI-PASS-SW.
 17648     MOVE LOW-VALUES             TO PI-CPYFROM
 17649                                    PI-MONTH-END-SAVE
 17650                                    PI-CPYTHRU.
 17651
 17652     MOVE ZEROS                  TO PI-FATAL-COUNT
 17653                                    PI-DAILY-RATE
 17654                                    PI-BEN-DAYS
 17655                                    PI-MANUAL-SW
 17656                                    PI-SAVE-CURSOR
 17657                                    PI-FORCE-COUNT
 17658                                    PI-HOLDTIL
 17659                                    PI-EPYFROM
 17660                                    PI-EPYTHRU
 17661                                    PI-EDAYS
 17662                                    PI-EPYAMT
 17663                                    PI-ERESV
 17664                                    PI-EEXPENS
 17665                                    PI-CDAYS
 17666                                    PI-CPYAMT
 17667                                    PI-CRESV
 17668                                    PI-CEXPENS
 17669                                    PI-INT-RATE
 17670                                    PI-AIGFROM.
 17671     MOVE ZEROS                  TO PI-PROOF-DATE.
 17672     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17673                                    PI-REM-BEN-AMT
 17674                                    PI-MO-BEN-AMT
 17675                                    pi-ah-term.
 17676
 17677     MOVE LOW-VALUES             TO EL156AI.
 17678     MOVE MAP-NAMEA              TO MAP-NAME.
 17679
 17680* EXEC CICS HANDLE CONDITION
 17681*        NOTFND   (7010-BUILD-MAP)
 17682*    END-EXEC.
 17683*    MOVE '"$I                   ! 8 #00016294' TO DFHEIV0
 17684     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17685     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17686     MOVE X'3820233030303136323934' TO DFHEIV0(25:11)
 17687     CALL 'kxdfhei1' USING DFHEIV0
 17688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17689
 17690
 17691     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17692     MOVE '2'                    TO CNTL-REC-TYPE.
 17693     MOVE +0                     TO CNTL-SEQ-NO.
 17694     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17695
 17696
 17697* EXEC CICS READ
 17698*         DATASET  ('ELCNTL')
 17699*         SET      (ADDRESS OF CONTROL-FILE)
 17700*         RIDFLD   (ELCNTL-KEY)
 17701*    END-EXEC.
 17702     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 343
* EL156.cbl
 17703*    MOVE '&"S        E          (   #00016303' TO DFHEIV0
 17704     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17705     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17706     MOVE X'2020233030303136333033' TO DFHEIV0(25:11)
 17707     CALL 'kxdfhei1' USING DFHEIV0,
 17708           DFHEIV1,
 17709           DFHEIV20,
 17710           DFHEIV99,
 17711           ELCNTL-KEY,
 17712           DFHEIV99,
 17713           DFHEIV99,
 17714           DFHEIV99
 17715     SET ADDRESS OF CONTROL-FILE TO
 17716         DFHEIV20
 17717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17718
 17719
 17720     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17721
 17722     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17723         MOVE AL-UANON      TO SURVYYNA
 17724     END-IF.
 17725
 17726
 17727     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17728     MOVE '1'                    TO CNTL-REC-TYPE.
 17729     MOVE SPACES                 TO CNTL-ACCESS.
 17730     MOVE +0                     TO CNTL-SEQ-NO.
 17731
 17732
 17733* EXEC CICS READ
 17734*         DATASET  ('ELCNTL')
 17735*         SET      (ADDRESS OF CONTROL-FILE)
 17736*         RIDFLD   (ELCNTL-KEY)
 17737*    END-EXEC.
 17738     MOVE 'ELCNTL' TO DFHEIV1
 17739*    MOVE '&"S        E          (   #00016321' TO DFHEIV0
 17740     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17741     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17742     MOVE X'2020233030303136333231' TO DFHEIV0(25:11)
 17743     CALL 'kxdfhei1' USING DFHEIV0,
 17744           DFHEIV1,
 17745           DFHEIV20,
 17746           DFHEIV99,
 17747           ELCNTL-KEY,
 17748           DFHEIV99,
 17749           DFHEIV99,
 17750           DFHEIV99
 17751     SET ADDRESS OF CONTROL-FILE TO
 17752         DFHEIV20
 17753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17754
 17755
 17756     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17757
 17758 7010-BUILD-MAP.
 17759
 17760
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 344
* EL156.cbl
 17761* EXEC CICS HANDLE CONDITION
 17762*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17763*    END-EXEC.
 17764*    MOVE '"$I                   ! 9 #00016331' TO DFHEIV0
 17765     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17766     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17767     MOVE X'3920233030303136333331' TO DFHEIV0(25:11)
 17768     CALL 'kxdfhei1' USING DFHEIV0
 17769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17770
 17771
 17772     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17773     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17774     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17775     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17776     MOVE 'MSTR'                 TO FILE-SWITCH.
 17777
 17778     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17779
 17780     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17781     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17782     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17783     MOVE CL-CCN                 TO PI-SV-CCN.
 17784
 17785     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17786     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17787     MOVE CL-CLAIM-NO            TO CLMNOO.
 17788     MOVE CL-CARRIER             TO CARRO.
 17789     MOVE CL-CERT-PRIME          TO CERTNOO.
 17790     MOVE CL-CERT-SFX            TO SUFXO.
 17791
 17792     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17793        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O')
 17794        CONTINUE
 17795     ELSE
 17796        MOVE AL-SADOF            TO ZINTHA
 17797                                    ZINTA
 17798                                    PINTHA
 17799                                    PINTA
 17800     END-IF
 17801     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17802     EVALUATE TRUE
 17803     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17804         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17805     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17806         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17807
 17808     WHEN CL-CLAIM-TYPE = 'I'
 17809         MOVE '  IU  '           TO CLMTYPO
 17810     WHEN CL-CLAIM-TYPE = 'G'
 17811         MOVE ' GAP  '           TO CLMTYPO
 17812     WHEN CL-CLAIM-TYPE = 'F'
 17813         MOVE ' FMLA '           TO CLMTYPO
 17814     WHEN CL-CLAIM-TYPE = 'O'
 17815         MOVE ' OTH '           TO CLMTYPO
 17816     END-EVALUATE.
 17817     IF CL-CLAIM-TYPE = 'O'
 17818        MOVE 'S' TO EOBYNO
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 345
* EL156.cbl
 17819                    PI-PRINT-EOB-YN
 17820                    WS-PRINT-EOB-YN
 17821     END-IF
 17822     IF CLAIM-IS-OPEN
 17823         MOVE ' OPEN'            TO CLMSTATO
 17824     ELSE
 17825         MOVE 'CLOSED'           TO CLMSTATO.
 17826
 17827     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17828
 17829     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17830         MOVE SPACES             TO  PCERTNOO
 17831                                     PSUFXO
 17832                                     PRIMHDGO
 17833                                     SEQUO
 17834         MOVE AL-SADOF           TO  PCERTNOA
 17835                                     PSUFXA
 17836                                     PRIMHDGA
 17837                                     SEQUA
 17838     ELSE
 17839         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17840         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17841         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17842         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17843         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17844         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17845         MOVE AL-SANON               TO  PCERTNOA
 17846                                         PSUFXA
 17847                                         PRIMHDGA
 17848         MOVE AL-SABON               TO  SEQUA.
 17849
 17850     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17851
 17852     IF CL-NO-OF-PMTS-MADE = 0 AND
 17853        CL-TOTAL-PAID-AMT = 0
 17854         NEXT SENTENCE
 17855     ELSE
 17856         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17857             IF NOT PI-USES-PAID-TO
 17858                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17859                 MOVE ' '                 TO DC-OPTION-CODE
 17860                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17861                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17862             ELSE
 17863                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17864                 MOVE '6'                 TO DC-OPTION-CODE
 17865                 MOVE +1                  TO DC-ELAPSED-DAYS
 17866                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17867                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17868                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17869
 17870     IF MAP-NAME = 'EL156A'
 17871        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17872           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17873             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17874           end-if
 17875        end-if
 17876     end-if
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 346
* EL156.cbl
 17877     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17878         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17879         MOVE ' '                TO DC-OPTION-CODE
 17880         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17881         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17882
 17883     IF CL-INCURRED-DT NOT = LOW-VALUES
 17884         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17885         MOVE ' '                TO DC-OPTION-CODE
 17886         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17887         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17888
 17889     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17890
 17891     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17892         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17893         MOVE ' '                TO DC-OPTION-CODE
 17894         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17895         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17896
 17897     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17898         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17899         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17900     ELSE
 17901         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17902         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17903
 17904     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17905     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17906     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17907     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17908                                    PI-GROUPING.
 17909     MOVE CL-CERT-STATE          TO CERT-STATE
 17910                                    PI-STATE.
 17911     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17912                                    PI-ACCOUNT.
 17913     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17914     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17915     MOVE 'CERT'                 TO FILE-SWITCH.
 17916
 17917     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17918     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17919        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17920        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17921            MOVE 'N' TO PI-JOINT-INSURED-IND
 17922     ELSE
 17923            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17924     END-IF.
 17925
 17926     perform 7975-read-acct      thru 7975-exit
 17927     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17928     MOVE PI-STATE               TO WS-ST-ACCESS.
 17929     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17930     MOVE '3'                    TO CNTL-REC-TYPE.
 17931     MOVE +0                     TO CNTL-SEQ-NO.
 17932     MOVE 'STAT'                 TO FILE-SWITCH.
 17933
 17934     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 347
* EL156.cbl
 17935
 17936     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17937     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17938
 17939     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17940        GO TO 7020-BYPASS-BENEFIT.
 17941
 17942     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17943     MOVE '4'                    TO CNTL-REC-TYPE.
 17944     MOVE +0                     TO CNTL-SEQ-NO.
 17945     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17946     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17947     MOVE 'BENE'                 TO FILE-SWITCH.
 17948
 17949     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17950
 17951     IF NO-BENEFIT-FOUND
 17952        GO TO 7020-BYPASS-BENEFIT.
 17953
 17954     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17955     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17956     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17957
 17958 7020-BYPASS-BENEFIT.
 17959
 17960*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17961*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17962*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17963
 17964     move zeros                  to PI-MAX-BENEFIT-AMT
 17965     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17966     move cm-ah-orig-term        to pi-ah-term
 17967     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17968     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17969          'G' and 'F'
 17970         GO TO 7021-GO-TO-LIFE.
 17971
 17972     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 17973        and (acct-found)
 17974        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17975        PERFORM 0900-GET-DDF-limits
 17976                                 THRU 0900-EXIT
 17977        IF PDEF-FOUND
 17978           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17979              (P1 > +8)
 17980              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17981           END-PERFORM
 17982           IF P1 < +9
 17983              if pd-ben-pct (p1) not numeric
 17984                 move zeros      to pd-ben-pct (p1)
 17985              end-if
 17986              if pd-ben-pct (p1) = zeros
 17987                 move +1         to ws-work-ben-pct
 17988              else
 17989                 move pd-ben-pct (p1)
 17990                                 to ws-work-ben-pct
 17991              end-if
 17992              compute cm-ah-benefit-amt =
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 348
* EL156.cbl
 17993                 cm-ah-benefit-amt * ws-work-ben-pct
 17994              move pd-max-amt (p1) to pi-max-benefit-amt
 17995           END-IF
 17996        END-IF
 17997     end-if
 17998     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17999     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 18000     if (pi-max-benefit-amt not = zeros)
 18001        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 18002        move pi-max-benefit-amt  to beneo
 18003     else
 18004        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 18005     end-if
 18006     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 18007     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 18008                                    CP-ORIGINAL-TERM.
 18009     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 18010
 18011*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18012*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 18013*    ELSE
 18014         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 18015
 18016     MOVE ' '                    TO DC-OPTION-CODE.
 18017     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 18018     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 18019
 18020     IF PI-COMPANY-ID = 'DMD'
 18021         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 18022         GO TO 7023-BYPASS-REMAINING-TERM.
 18023
 18024     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 18025     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 18026     GO TO 7022-AROUND-LIFE.
 18027
 18028 7021-GO-TO-LIFE.
 18029
 18030     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 18031     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 18032     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 18033                                    CP-ORIGINAL-TERM.
 18034     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 18035     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 18036     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 18037     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 18038
 18039     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18040         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 18041     ELSE
 18042         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 18043
 18044     MOVE ' '                    TO DC-OPTION-CODE.
 18045     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 18046     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 18047
 18048 7022-AROUND-LIFE.
 18049
 18050     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 349
* EL156.cbl
 18051     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 18052     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 18053     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 18054     MOVE '4'                    TO CP-REM-TERM-METHOD.
 18055     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 18056     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 18057
 18058     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 18059
 18060     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 18061        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 18062           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 18063
 18064     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18065        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 18066           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 18067
 18068 7023-BYPASS-REMAINING-TERM.
 18069     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18070       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 18071          MOVE ZEROS                  TO BENEO
 18072       ELSE
 18073          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 18074          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 18075          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 18076          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 18077          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 18078          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 18079          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 18080          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 18081          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 18082          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 18083          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 18084          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 18085          IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 18086             AND (PI-DCC-PRODUCT-CODE not = '   ')
 18087             PERFORM 0900-GET-DDF-limits
 18088                                 THRU 0900-EXIT
 18089             IF PDEF-FOUND
 18090                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 18091                   (P1 > +8)
 18092                   OR (PD-PROD-CODE (P1) = 'L')
 18093                END-PERFORM
 18094                IF P1 < +9
 18095                   MOVE PD-MAX-AMT (P1)
 18096                                 TO CP-R-MAX-TOT-BEN
 18097                END-IF
 18098             END-IF
 18099          END-IF
 18100
 18101* EXEC CICS LINK
 18102*            PROGRAM  (LINK-REMAMT)
 18103*            COMMAREA (CALCULATION-PASS-AREA)
 18104*            LENGTH   (CP-COMM-LENGTH)
 18105*         END-EXEC
 18106*    MOVE '."C                   (   #00016663' TO DFHEIV0
 18107     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18108     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 350
* EL156.cbl
 18109     MOVE X'2020233030303136363633' TO DFHEIV0(25:11)
 18110     CALL 'kxdfhei1' USING DFHEIV0,
 18111           LINK-REMAMT,
 18112           CALCULATION-PASS-AREA,
 18113           CP-COMM-LENGTH,
 18114           DFHEIV99,
 18115           DFHEIV99,
 18116           DFHEIV99,
 18117           DFHEIV99
 18118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18119          MOVE CP-REMAINING-AMT       TO BENEO
 18120       end-if
 18121     end-if
 18122     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18123     MOVE +95                    TO TRLR-SEQ-NO
 18124
 18125* EXEC CICS READ
 18126*       DATASET  ('ELTRLR')
 18127*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18128*       RIDFLD   (ELTRLR-KEY)
 18129*       RESP     (WS-RESPONSE)
 18130*    END-EXEC
 18131     MOVE 'ELTRLR' TO DFHEIV1
 18132*    MOVE '&"S        E          (  N#00016673' TO DFHEIV0
 18133     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18134     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18135     MOVE X'204E233030303136363733' TO DFHEIV0(25:11)
 18136     CALL 'kxdfhei1' USING DFHEIV0,
 18137           DFHEIV1,
 18138           DFHEIV20,
 18139           DFHEIV99,
 18140           ELTRLR-KEY,
 18141           DFHEIV99,
 18142           DFHEIV99,
 18143           DFHEIV99
 18144     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18145         DFHEIV20
 18146     MOVE EIBRESP  TO WS-RESPONSE
 18147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18148
 18149     if ws-resp-normal
 18150        perform varying s1 from +1 by +1 until
 18151           at-note-error-no (s1) = spaces
 18152           move at-note-error-no (s1)
 18153                                 to emi-error
 18154           if at-note-error-no (s1) = '1653'
 18155              evaluate true
 18156                 when cl-claim-type = 'L'
 18157                    move '  LF  '
 18158                                 to emi-claim-type
 18159                 when cl-claim-type = 'I'
 18160                    move '  IU  '
 18161                                 to emi-claim-type
 18162                 when cl-claim-type = 'F'
 18163                    move ' FMLA '
 18164                                 to emi-claim-type
 18165                 when cl-claim-type = 'O'
 18166                    move ' OTH '
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 351
* EL156.cbl
 18167                                 to emi-claim-type
 18168                 when other
 18169                    move '  AH  '
 18170                                 to emi-claim-type
 18171              end-evaluate
 18172           end-if
 18173           PERFORM 9900-ERROR-FORMAT
 18174                                 THRU 9900-EXIT
 18175        end-perform
 18176     end-if
 18177    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 OR 'O'
 18178         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 18179            WS-LF-COVERAGE-TYPE = 'P'
 18180             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 18181                                        CM-LF-ITD-DEATH-AMT
 18182             MOVE WS-REMAINING-AMT  TO  BENEO.
 18183
 18184     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 18185     MOVE BENEO                  TO PI-REM-BEN-AMT.
 18186     MOVE WS-TERMS               TO TERMSO.
 18187
 18188     IF WS-STATUS = '6' OR '7' OR '8'
 18189         MOVE AL-SABOF           TO CRTSTATA.
 18190
 18191     IF WS-STATUS = '1' OR '4'
 18192        IF CP-REMAINING-TERM-3 = ZEROS
 18193           MOVE 'EXPIRED'        TO CRTSTATO
 18194        ELSE
 18195           MOVE 'ACTIVE  '       TO CRTSTATO.
 18196
 18197     IF WS-STATUS = '2'
 18198         MOVE 'PEND    '         TO CRTSTATO.
 18199
 18200     IF WS-STATUS = '3'
 18201         MOVE 'RESTORE '         TO CRTSTATO.
 18202
 18203     IF WS-STATUS = '5'
 18204         MOVE 'REISSUE '         TO CRTSTATO.
 18205
 18206     IF WS-STATUS = '6'
 18207         MOVE 'LMP DIS'          TO CRTSTATO.
 18208
 18209     IF WS-STATUS = '7'
 18210         MOVE 'DEATH'            TO CRTSTATO.
 18211
 18212     IF WS-STATUS = '8'
 18213         MOVE 'CANCEL'           TO CRTSTATO.
 18214
 18215     IF WS-STATUS = '9'
 18216         MOVE 'RE-ONLY '         TO CRTSTATO.
 18217
 18218     IF WS-STATUS = 'V'
 18219         MOVE 'VOID  '           TO CRTSTATO.
 18220
 18221     IF WS-STATUS = 'D'
 18222         MOVE 'DECLINE '         TO CRTSTATO.
 18223
 18224     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 352
* EL156.cbl
 18225         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 18226         MOVE '5'                TO CNTL-REC-TYPE
 18227     ELSE
 18228         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 18229         MOVE '4'                TO CNTL-REC-TYPE.
 18230
 18231     MOVE '** NONE **'           TO COVERO.
 18232     MOVE AL-SABON               TO COVERA.
 18233
 18234     IF PI-COMPANY-ID = 'CVL'
 18235         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 18236             MOVE CM-BENEFICIARY TO LOANNOO
 18237             MOVE AL-UANON       TO LOANNOA.
 18238
 18239     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 18240        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 18241        MOVE +91                 TO  TRLR-SEQ-NO
 18242
 18243* EXEC CICS READ
 18244*           DATASET  ('ELTRLR')
 18245*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18246*           RIDFLD   (ELTRLR-KEY)
 18247*           RESP     (WS-RESPONSE)
 18248*       END-EXEC
 18249     MOVE 'ELTRLR' TO DFHEIV1
 18250*    MOVE '&"S        E          (  N#00016773' TO DFHEIV0
 18251     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18252     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18253     MOVE X'204E233030303136373733' TO DFHEIV0(25:11)
 18254     CALL 'kxdfhei1' USING DFHEIV0,
 18255           DFHEIV1,
 18256           DFHEIV20,
 18257           DFHEIV99,
 18258           ELTRLR-KEY,
 18259           DFHEIV99,
 18260           DFHEIV99,
 18261           DFHEIV99
 18262     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18263         DFHEIV20
 18264     MOVE EIBRESP  TO WS-RESPONSE
 18265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18266
 18267        IF WS-RESP-NORMAL
 18268           MOVE AT-INFO-LINE-1   TO  LOANNOO
 18269        ELSE
 18270           MOVE SPACES           TO  LOANNOO
 18271        END-IF
 18272*052506
 18273*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 18274*052506
 18275     END-IF
 18276
 18277     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 18278        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 18279
 18280     IF WS-BEN-CD = ZEROS
 18281         GO TO 7050-SHOW-CONTINUE.
 18282
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 353
* EL156.cbl
 18283     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 18284     MOVE WS-ACCESS              TO CNTL-ACCESS.
 18285     MOVE +0                     TO CNTL-SEQ-NO.
 18286     MOVE 'BENE'                 TO FILE-SWITCH.
 18287
 18288     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 18289     IF BENEFIT-FOUND
 18290        MOVE CF-JOINT-INDICATOR (SUB-1)
 18291                                 TO PI-JOINT-COV-IND
 18292                                    PI-RB-JOINT-COV-IND
 18293        MOVE CF-BENEFIT-DESCRIP (SUB-1)
 18294                                 TO COVERO
 18295        MOVE AL-SANON            TO COVERA
 18296     END-IF
 18297     if (cntl-rec-type = '4')   *> Life claim
 18298        and (cm-ah-benefit-cd not = zeros) *> AH coverage
 18299        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
 18300        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD
 18301        MOVE '5'              TO CNTL-REC-TYPE
 18302        MOVE WS-ACCESS        TO CNTL-ACCESS
 18303        MOVE +0               TO CNTL-SEQ-NO
 18304        MOVE 'BENE'           TO FILE-SWITCH
 18305        PERFORM 7200-FIND-BENEFIT
 18306                              THRU 7200-EXIT
 18307        IF (BENEFIT-FOUND)
 18308           and (pi-rb-joint-cov-ind) not = 'J'
 18309           MOVE CF-JOINT-INDICATOR (SUB-1)
 18310                              TO PI-rb-JOINT-COV-IND
 18311        end-if
 18312     end-if
 18313     .
 18314 7050-SHOW-CONTINUE.
 18315
 18316     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 18317        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 18318            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 18319     END-IF
 18320
 18321     IF PI-COMPANY-ID = 'DMD'
 18322         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 18323
 18324     MOVE -1                     TO PMTTYPEL.
 18325     GO TO 8100-SEND-INITIAL-MAP.
 18326
 18327 7100-SHOW-RECORD-NOT-FOUND.
 18328     IF FILE-SWITCH = 'MSTR'
 18329         MOVE ER-0204            TO EMI-ERROR.
 18330
 18331     IF FILE-SWITCH = 'CERT'
 18332         MOVE ER-0206            TO EMI-ERROR.
 18333
 18334     IF FILE-SWITCH = 'STAT'
 18335         MOVE ER-0149            TO EMI-ERROR.
 18336
 18337     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18338
 18339     MOVE -1                     TO PMTTYPEL.
 18340     GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 354
* EL156.cbl
 18341
 18342     .
 18343 7110-BUILD-PMT-TRLR.
 18344     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18345     MOVE +51                    TO TRLR-SEQ-NO
 18346
 18347* EXEC CICS READ
 18348*        DATASET  ('ELTRLR')
 18349*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18350*        RIDFLD   (ELTRLR-KEY)
 18351*        RESP     (WS-RESPONSE)
 18352*    END-EXEC
 18353     MOVE 'ELTRLR' TO DFHEIV1
 18354*    MOVE '&"S        E          (  N#00016859' TO DFHEIV0
 18355     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18356     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18357     MOVE X'204E233030303136383539' TO DFHEIV0(25:11)
 18358     CALL 'kxdfhei1' USING DFHEIV0,
 18359           DFHEIV1,
 18360           DFHEIV20,
 18361           DFHEIV99,
 18362           ELTRLR-KEY,
 18363           DFHEIV99,
 18364           DFHEIV99,
 18365           DFHEIV99
 18366     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18367         DFHEIV20
 18368     MOVE EIBRESP  TO WS-RESPONSE
 18369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18370     IF WS-RESP-NORMAL
 18371        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 18372     END-IF
 18373     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 18374
 18375* EXEC CICS GETMAIN
 18376*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18377*         LENGTH    (200)
 18378*         INITIMG   (GETMAIN-SPACE)
 18379*     END-EXEC
 18380     MOVE 200
 18381       TO DFHEIV11
 18382*    MOVE ',"IL                  $   #00016869' TO DFHEIV0
 18383     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18384     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18385     MOVE X'2020233030303136383639' TO DFHEIV0(25:11)
 18386     CALL 'kxdfhei1' USING DFHEIV0,
 18387           DFHEIV20,
 18388           DFHEIV11,
 18389           GETMAIN-SPACE
 18390     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18391         DFHEIV20
 18392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18393     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 18394                                    AT-PREV-PAID-THRU-DT
 18395     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 18396     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18397     MOVE 'AT'                   TO AT-RECORD-ID
 18398     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 355
* EL156.cbl
 18399     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 18400     MOVE '2'                    TO AT-TRAILER-TYPE
 18401     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18402                                    AT-PAYMENT-LAST-MAINT-DT
 18403     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18404                                    AT-PAYMENT-LAST-UPDATED-BY
 18405     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18406     MOVE 'I'                    TO AT-PAYMENT-TYPE
 18407     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 18408     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 18409     MOVE +0                     TO AT-EXPENSE-PER-PMT
 18410     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 18411     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 18412     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 18413     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 18414     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 18415     if pi-int-to-rem-borr = 'Y'
 18416        move 'Q1'                to at-payee-type-cd
 18417     else
 18418        MOVE 'O1'                TO AT-PAYEE-TYPE-CD
 18419     end-if
 18420     MOVE PI-int-payees-name     TO AT-PAYEES-NAME
 18421     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 18422     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 18423     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 18424     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 18425                                    AT-TO-BE-WRITTEN-DT
 18426     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 18427                                    AT-CHECK-QUE-SEQUENCE
 18428                                    AT-ADDL-RESERVE
 18429     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 18430                                    AT-VOID-SELECT-DT
 18431                                    AT-VOID-ACCEPT-DT
 18432                                    AT-VOID-DT
 18433                                    AT-PMT-PROOF-DT
 18434                                    AT-INT-PMT-SELECT-DT
 18435     MOVE ZEROS                  TO AT-DAILY-RATE
 18436                                    AT-ELIMINATION-DAYS
 18437     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18438*    EXEC CICS HANDLE CONDITION
 18439*        DUPREC    (7120-DUPREC)
 18440*    END-EXEC
 18441     .
 18442 7115-WRITE-INT-TRLR.
 18443
 18444* EXEC CICS WRITE
 18445*         DATASET       ('ELTRLR')
 18446*         FROM          (ACTIVITY-TRAILERS)
 18447*         RIDFLD        (AT-CONTROL-PRIMARY)
 18448*         RESP          (WS-RESPONSE)
 18449*     END-EXEC
 18450     MOVE LENGTH OF
 18451      ACTIVITY-TRAILERS
 18452       TO DFHEIV11
 18453     MOVE 'ELTRLR' TO DFHEIV1
 18454*    MOVE '&$ L                  ''  N#00016924' TO DFHEIV0
 18455     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18456     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 356
* EL156.cbl
 18457     MOVE X'204E233030303136393234' TO DFHEIV0(25:11)
 18458     CALL 'kxdfhei1' USING DFHEIV0,
 18459           DFHEIV1,
 18460           ACTIVITY-TRAILERS,
 18461           DFHEIV11,
 18462           AT-CONTROL-PRIMARY,
 18463           DFHEIV99,
 18464           DFHEIV99
 18465     MOVE EIBRESP  TO WS-RESPONSE
 18466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18467      IF WS-RESP-DUPREC
 18468         GO TO 7120-DUPREC
 18469      END-IF
 18470     GO TO 7130-EXIT
 18471     .
 18472 7120-DUPREC.
 18473     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18474     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18475     GO TO 7115-WRITE-INT-TRLR
 18476     .
 18477 7130-EXIT.
 18478      EXIT.
 18479 7140-BUILD-NOTE-TRLR.
 18480
 18481
 18482* EXEC CICS GETMAIN
 18483*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18484*         LENGTH    (200)
 18485*         INITIMG   (GETMAIN-SPACE)
 18486*     END-EXEC
 18487     MOVE 200
 18488       TO DFHEIV11
 18489*    MOVE ',"IL                  $   #00016944' TO DFHEIV0
 18490     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18491     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18492     MOVE X'2020233030303136393434' TO DFHEIV0(25:11)
 18493     CALL 'kxdfhei1' USING DFHEIV0,
 18494           DFHEIV20,
 18495           DFHEIV11,
 18496           GETMAIN-SPACE
 18497     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18498         DFHEIV20
 18499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18500     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18501     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18502     MOVE 'AT'                   TO AT-RECORD-ID
 18503     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18504     MOVE '6'                    TO AT-TRAILER-TYPE
 18505     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18506                                    AT-GEN-INFO-LAST-MAINT-DT
 18507     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18508                                    AT-GEN-INFO-LAST-UPDATED-BY
 18509     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18510     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18511     .
 18512 7150-WRITE.
 18513
 18514* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 357
* EL156.cbl
 18515*        DUPREC    (7160-DUPREC)
 18516*    END-EXEC
 18517*    MOVE '"$%                   ! : #00016962' TO DFHEIV0
 18518     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18519     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18520     MOVE X'3A20233030303136393632' TO DFHEIV0(25:11)
 18521     CALL 'kxdfhei1' USING DFHEIV0
 18522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18523
 18524* EXEC CICS WRITE
 18525*         DATASET     ('ELTRLR')
 18526*         FROM        (ACTIVITY-TRAILERS)
 18527*         RIDFLD      (AT-CONTROL-PRIMARY)
 18528*         RESP        (WS-RESPONSE)
 18529*     END-EXEC
 18530     MOVE LENGTH OF
 18531      ACTIVITY-TRAILERS
 18532       TO DFHEIV11
 18533     MOVE 'ELTRLR' TO DFHEIV1
 18534*    MOVE '&$ L                  ''  N#00016965' TO DFHEIV0
 18535     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18536     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18537     MOVE X'204E233030303136393635' TO DFHEIV0(25:11)
 18538     CALL 'kxdfhei1' USING DFHEIV0,
 18539           DFHEIV1,
 18540           ACTIVITY-TRAILERS,
 18541           DFHEIV11,
 18542           AT-CONTROL-PRIMARY,
 18543           DFHEIV99,
 18544           DFHEIV99
 18545     MOVE EIBRESP  TO WS-RESPONSE
 18546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18547      IF WS-RESP-DUPREC
 18548         GO TO 7160-DUPREC
 18549      END-IF
 18550     GO TO 7170-EXIT
 18551     .
 18552 7160-DUPREC.
 18553     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18554     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18555     GO TO 7150-WRITE
 18556     .
 18557 7170-EXIT.
 18558      EXIT.
 18559
 18560 7180-ADD-CERT-NOTE.
 18561*ADD CERT NOTE FOR SC NP+6
 18562
 18563
 18564* EXEC CICS GETMAIN
 18565*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18566*         LENGTH    (150)
 18567*         INITIMG   (GETMAIN-SPACE)
 18568*     END-EXEC.
 18569     MOVE 150
 18570       TO DFHEIV11
 18571*    MOVE ',"IL                  $   #00016987' TO DFHEIV0
 18572     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 358
* EL156.cbl
 18573     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18574     MOVE X'2020233030303136393837' TO DFHEIV0(25:11)
 18575     CALL 'kxdfhei1' USING DFHEIV0,
 18576           DFHEIV20,
 18577           DFHEIV11,
 18578           GETMAIN-SPACE
 18579     SET ADDRESS OF CERT-NOTE-FILE TO
 18580         DFHEIV20
 18581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18582
 18583
 18584     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18585     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18586     MOVE +1                     TO WRK-NOTE-SEQ.
 18587     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18588     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18589     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18590     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18591     MOVE CL-CERT-STATE          TO CZ-STATE.
 18592     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18593     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18594     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18595     MOVE '2'                    TO CZ-RECORD-TYPE.
 18596     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18597     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18598     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18599     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18600     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18601     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18602     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18603     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18604     IF PI-COMPANY-ID = 'AHL'
 18605        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18606           CONTINUE
 18607        ELSE
 18608           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18609              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18610           ELSE
 18611              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18612           END-IF
 18613        END-IF
 18614     END-IF
 18615     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18616     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18617
 18618 7181-WRITE.
 18619
 18620
 18621* EXEC CICS WRITE
 18622*         DATASET     ('ERCNOT')
 18623*         FROM        (CERT-NOTE-FILE)
 18624*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18625*         RESP        (WS-RESPONSE)
 18626*    END-EXEC.
 18627     MOVE LENGTH OF
 18628      CERT-NOTE-FILE
 18629       TO DFHEIV11
 18630     MOVE 'ERCNOT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 359
* EL156.cbl
 18631*    MOVE '&$ L                  ''  N#00017029' TO DFHEIV0
 18632     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18633     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18634     MOVE X'204E233030303137303239' TO DFHEIV0(25:11)
 18635     CALL 'kxdfhei1' USING DFHEIV0,
 18636           DFHEIV1,
 18637           CERT-NOTE-FILE,
 18638           DFHEIV11,
 18639           CZ-CONTROL-PRIMARY,
 18640           DFHEIV99,
 18641           DFHEIV99
 18642     MOVE EIBRESP  TO WS-RESPONSE
 18643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18644
 18645
 18646     IF WS-RESP-DUPREC
 18647         GO TO 7182-DUPREC
 18648     END-IF.
 18649
 18650     SET CERT-NOTE-ADDED TO TRUE.
 18651
 18652     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18653         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18654     END-IF.
 18655
 18656     GO TO 7189-EXIT.
 18657
 18658 7182-DUPREC.
 18659
 18660     ADD +1                      TO  WRK-NOTE-SEQ.
 18661     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18662     GO TO 7181-WRITE.
 18663
 18664 7189-EXIT.
 18665      EXIT.
 18666
 18667 7190-ADD-ORIG-NOTE.
 18668
 18669
 18670* EXEC CICS GETMAIN
 18671*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18672*         LENGTH    (150)
 18673*         INITIMG   (GETMAIN-SPACE)
 18674*     END-EXEC.
 18675     MOVE 150
 18676       TO DFHEIV11
 18677*    MOVE ',"IL                  $   #00017059' TO DFHEIV0
 18678     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18679     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18680     MOVE X'2020233030303137303539' TO DFHEIV0(25:11)
 18681     CALL 'kxdfhei1' USING DFHEIV0,
 18682           DFHEIV20,
 18683           DFHEIV11,
 18684           GETMAIN-SPACE
 18685     SET ADDRESS OF CERT-NOTE-FILE TO
 18686         DFHEIV20
 18687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18688
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 360
* EL156.cbl
 18689
 18690     ADD +1                      TO WRK-NOTE-SEQ.
 18691     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18692     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18693     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18694     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18695     MOVE CL-CERT-STATE          TO CZ-STATE.
 18696     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18697     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18698     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18699     MOVE '2'                    TO CZ-RECORD-TYPE.
 18700     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18701     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18702     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18703     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18704     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18705     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18706
 18707 7191-WRITE.
 18708
 18709
 18710* EXEC CICS WRITE
 18711*         DATASET     ('ERCNOT')
 18712*         FROM        (CERT-NOTE-FILE)
 18713*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18714*         RESP        (WS-RESPONSE)
 18715*    END-EXEC.
 18716     MOVE LENGTH OF
 18717      CERT-NOTE-FILE
 18718       TO DFHEIV11
 18719     MOVE 'ERCNOT' TO DFHEIV1
 18720*    MOVE '&$ L                  ''  N#00017084' TO DFHEIV0
 18721     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18722     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18723     MOVE X'204E233030303137303834' TO DFHEIV0(25:11)
 18724     CALL 'kxdfhei1' USING DFHEIV0,
 18725           DFHEIV1,
 18726           CERT-NOTE-FILE,
 18727           DFHEIV11,
 18728           CZ-CONTROL-PRIMARY,
 18729           DFHEIV99,
 18730           DFHEIV99
 18731     MOVE EIBRESP  TO WS-RESPONSE
 18732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18733
 18734
 18735     IF WS-RESP-DUPREC
 18736         GO TO 7192-DUPREC
 18737     END-IF.
 18738
 18739     GO TO 7199-EXIT.
 18740
 18741 7192-DUPREC.
 18742
 18743     ADD +1                      TO  WRK-NOTE-SEQ.
 18744     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18745     GO TO 7191-WRITE.
 18746
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 361
* EL156.cbl
 18747 7199-EXIT.
 18748      EXIT.
 18749 7200-FIND-BENEFIT.
 18750     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18751
 18752
 18753* EXEC CICS HANDLE CONDITION
 18754*        ENDFILE(7200-EXIT)
 18755*        NOTFND(7200-EXIT)
 18756*    END-EXEC.
 18757*    MOVE '"$''I                  ! ; #00017108' TO DFHEIV0
 18758     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18760     MOVE X'3B20233030303137313038' TO DFHEIV0(25:11)
 18761     CALL 'kxdfhei1' USING DFHEIV0
 18762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18763
 18764
 18765
 18766* EXEC CICS READ
 18767*        DATASET('ELCNTL')
 18768*        SET(ADDRESS OF CONTROL-FILE)
 18769*        RIDFLD(ELCNTL-KEY)
 18770*        GTEQ
 18771*    END-EXEC.
 18772     MOVE 'ELCNTL' TO DFHEIV1
 18773*    MOVE '&"S        G          (   #00017113' TO DFHEIV0
 18774     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18775     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18776     MOVE X'2020233030303137313133' TO DFHEIV0(25:11)
 18777     CALL 'kxdfhei1' USING DFHEIV0,
 18778           DFHEIV1,
 18779           DFHEIV20,
 18780           DFHEIV99,
 18781           ELCNTL-KEY,
 18782           DFHEIV99,
 18783           DFHEIV99,
 18784           DFHEIV99
 18785     SET ADDRESS OF CONTROL-FILE TO
 18786         DFHEIV20
 18787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18788
 18789
 18790     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18791        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18792           GO TO 7200-EXIT.
 18793
 18794     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18795         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18796            ((SUB-1 > 8) OR
 18797            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18798
 18799     IF SUB-1 NOT = 9
 18800         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18801
 18802     GO TO 7200-EXIT.
 18803
 18804 7200-BENEFIT-DUMMY.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 362
* EL156.cbl
 18805
 18806 7200-DUMMY-EXIT.
 18807     EXIT.
 18808
 18809 7200-EXIT.
 18810     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 363
* EL156.cbl
 18812*052506
 18813*052506 7250-FIND-LETTER-TRLR.
 18814*052506     EXEC CICS HANDLE CONDITION
 18815*052506         ENDFILE  (7250-END)
 18816*052506         NOTFND   (7250-END)
 18817*052506     END-EXEC.
 18818*052506
 18819*052506     EXEC CICS STARTBR
 18820*052506         DATASET   ('ELTRLR')
 18821*052506         RIDFLD    (ELTRLR-KEY)
 18822*052506         GTEQ
 18823*052506     END-EXEC.
 18824*052506
 18825*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18826*052506
 18827*052506 7250-FIND-LOOP.
 18828*052506     EXEC CICS READNEXT
 18829*052506         DATASET   ('ELTRLR')
 18830*052506         RIDFLD    (ELTRLR-KEY)
 18831*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18832*052506     END-EXEC.
 18833*052506
 18834*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18835*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18836*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18837*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18838*052506        GO TO 7250-END
 18839*052506     END-IF.
 18840*052506
 18841*052506     IF AT-TRAILER-TYPE NOT = '4'
 18842*052506         GO TO 7250-FIND-LOOP
 18843*052506     END-IF.
 18844*052506
 18845*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18846*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18847*052506     END-IF.
 18848*052506
 18849*052506     GO TO 7250-FIND-LOOP.
 18850*052506
 18851*052506 7250-END.
 18852*052506
 18853*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18854*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18855*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18856*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18857*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18858*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18859*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18860*052506     END-IF.
 18861*052506
 18862*052506     EXEC CICS ENDBR
 18863*052506          DATASET    ('ELTRLR')
 18864*052506     END-EXEC.
 18865*052506
 18866*052506 7250-EXIT.
 18867*052506     EXIT.
 18868*052506     EJECT
 18869*052506
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 364
* EL156.cbl
 18870 7300-CHECK-AUTO-ACTIVITY.
 18871
 18872     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18873         NEXT SENTENCE
 18874     ELSE
 18875         GO TO 7399-EXIT.
 18876
 18877     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18878
 18879     IF WS-ACT-REC-FOUND-SW = 'N'
 18880         GO TO 7399-EXIT.
 18881
 18882     IF PI-ACTIVITY-CODE = 09
 18883         GO TO 7300-CONT-AUTO-ACTIVITY.
 18884
 18885     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18886        (PI-ACTIVITY-CODE = 11)
 18887         GO TO 7300-CONT-AUTO-ACTIVITY.
 18888
 18889     IF PI-PROVISIONAL-IND = 'P'
 18890         IF PI-PMTTYPE = '1'
 18891             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18892                 MOVE 'N'    TO  PI-RESET-SW
 18893                 GO TO 7399-EXIT.
 18894
 18895     IF PI-PMTTYPE = '1'
 18896         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18897             MOVE 'N'        TO  PI-RESET-SW
 18898             GO TO 7399-EXIT.
 18899
 18900     IF PI-PMTTYPE = '2' OR '3'
 18901         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18902             MOVE 'N'        TO  PI-RESET-SW
 18903             GO TO 7399-EXIT.
 18904
 18905     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18906         IF PI-PROVISIONAL-IND = 'P'
 18907             NEXT SENTENCE
 18908         ELSE
 18909             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18910
 18911 7300-CONT-AUTO-ACTIVITY.
 18912
 18913     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18914         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18915         MOVE '4'            TO DC-OPTION-CODE
 18916         MOVE +0             TO DC-ELAPSED-DAYS
 18917                                DC-ELAPSED-MONTHS
 18918         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18919         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18920         IF PI-USES-PAID-TO
 18921             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18922             IF NO-CONVERSION-ERROR
 18923                 MOVE +1     TO DC-ELAPSED-DAYS
 18924                 MOVE +0     TO DC-ELAPSED-MONTHS
 18925                 MOVE '6'    TO DC-OPTION-CODE
 18926                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18927                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 365
* EL156.cbl
 18928                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18929
 18930     IF PI-PFKEY-USED = DFHPF5
 18931         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18932         IF PI-USES-PAID-TO
 18933             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18934             MOVE +1                  TO DC-ELAPSED-DAYS
 18935             MOVE +0                  TO DC-ELAPSED-MONTHS
 18936             MOVE '6'                 TO DC-OPTION-CODE
 18937             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18938             IF NO-CONVERSION-ERROR
 18939                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18940
 18941     IF WS-CHK-THRU-DT < PI-EXP-DT
 18942         NEXT SENTENCE
 18943     ELSE
 18944         MOVE 03                     TO  WS-ACTIVITY-CODE
 18945         GO TO 7390-PROCESS-ACTIVITY.
 18946
 18947     IF PI-PROV-PMT
 18948         MOVE 09                     TO  WS-ACTIVITY-CODE
 18949     ELSE
 18950        IF PI-PMTTYPE = '1'
 18951            MOVE 02                  TO  WS-ACTIVITY-CODE
 18952        ELSE
 18953        IF PI-PMTTYPE = '2' OR '3'
 18954            MOVE 07                  TO  WS-ACTIVITY-CODE
 18955        ELSE
 18956        IF PI-PMTTYPE = '4'
 18957            MOVE 00                  TO  WS-ACTIVITY-CODE
 18958        ELSE
 18959            MOVE 'N'                 TO  PI-RESET-SW
 18960            GO TO 7399-EXIT.
 18961
 18962 7390-PROCESS-ACTIVITY.
 18963
 18964     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18965
 18966 7399-EXIT.
 18967     EXIT.
 18968
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 366
* EL156.cbl
 18970 7400-CHECK-AUTO-ACTIVITY.
 18971
 18972
 18973* EXEC CICS HANDLE CONDITION
 18974*        NOTFND   (7400-NOT-FOUND)
 18975*    END-EXEC.
 18976*    MOVE '"$I                   ! < #00017302' TO DFHEIV0
 18977     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18978     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18979     MOVE X'3C20233030303137333032' TO DFHEIV0(25:11)
 18980     CALL 'kxdfhei1' USING DFHEIV0
 18981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18982
 18983
 18984     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18985     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18986     MOVE SPACES                 TO  CNTL-ACCESS.
 18987     MOVE +0                     TO  CNTL-SEQ-NO.
 18988
 18989
 18990* EXEC CICS READ
 18991*        DATASET   ('ELCNTL')
 18992*        RIDFLD    (ELCNTL-KEY)
 18993*        SET       (ADDRESS OF CONTROL-FILE)
 18994*    END-EXEC.
 18995     MOVE 'ELCNTL' TO DFHEIV1
 18996*    MOVE '&"S        E          (   #00017311' TO DFHEIV0
 18997     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18998     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18999     MOVE X'2020233030303137333131' TO DFHEIV0(25:11)
 19000     CALL 'kxdfhei1' USING DFHEIV0,
 19001           DFHEIV1,
 19002           DFHEIV20,
 19003           DFHEIV99,
 19004           ELCNTL-KEY,
 19005           DFHEIV99,
 19006           DFHEIV99,
 19007           DFHEIV99
 19008     SET ADDRESS OF CONTROL-FILE TO
 19009         DFHEIV20
 19010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19011
 19012
 19013     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 19014     GO TO 7400-EXIT.
 19015
 19016 7400-NOT-FOUND.
 19017     MOVE 'N'                        TO  PI-RESET-SW
 19018                                         WS-LETTER-SW
 19019                                         WS-ACT-REC-FOUND-SW.
 19020
 19021     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19022
 19023 7400-EXIT.
 19024     EXIT.
 19025
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 367
* EL156.cbl
 19027 7450-FORMAT-AUTO-LETTER.
 19028
 19029     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 19030         MOVE 'Y'                    TO PI-RESET-SW
 19031         GO TO 7450-CONTINUE-PROCESS.
 19032
 19033     MOVE PI-ACTIVITY-CODE           TO  SUB.
 19034
 19035     IF SUB > 9
 19036         SUBTRACT 9 FROM SUB
 19037         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 19038     ELSE
 19039         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 19040
 19041 7450-CONTINUE-PROCESS.
 19042
 19043     IF WS-ACTIVITY-CODE = ZEROS
 19044         MOVE 'N'                    TO  WS-LETTER-SW
 19045         GO TO 7450-EXIT.
 19046
 19047     MOVE WS-ACTIVITY-CODE           TO  SUB.
 19048
 19049     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 19050         MOVE 'N'                    TO  PI-RESET-SW
 19051                                         WS-LETTER-SW
 19052         GO TO 7450-EXIT.
 19053
 19054     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 19055         MOVE 'N'                    TO  WS-LETTER-SW
 19056         GO TO 7450-EXIT.
 19057
 19058     MOVE 'Y'                        TO  WS-LETTER-SW.
 19059     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 19060     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 19061
 19062     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 19063
 19064     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 19065         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 19066         MOVE '6'                    TO  DC-OPTION-CODE
 19067         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 19068         MOVE +0                     TO  DC-ELAPSED-MONTHS
 19069         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 19070         IF NO-CONVERSION-ERROR
 19071             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 19072         ELSE
 19073              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 19074
 19075     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 19076         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 19077         MOVE '6'                    TO  DC-OPTION-CODE
 19078         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 19079         MOVE +0                     TO  DC-ELAPSED-MONTHS
 19080         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 19081         IF NO-CONVERSION-ERROR
 19082             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 19083         ELSE
 19084             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 368
* EL156.cbl
 19085
 19086 7450-EXIT.
 19087     EXIT.
 19088
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 369
* EL156.cbl
 19090 7500-RESET-AUTO-ACTIVITY.
 19091
 19092     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 19093     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 19094     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 19095     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 19096     MOVE +100                   TO  TRLR-SEQ-NO.
 19097
 19098 7500-STARTBR-TRLR.
 19099
 19100
 19101* EXEC CICS HANDLE CONDITION
 19102*        ENDFILE  (7590-END)
 19103*        NOTFND   (7590-END)
 19104*    END-EXEC.
 19105*    MOVE '"$''I                  ! = #00017404' TO DFHEIV0
 19106     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19108     MOVE X'3D20233030303137343034' TO DFHEIV0(25:11)
 19109     CALL 'kxdfhei1' USING DFHEIV0
 19110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19111
 19112
 19113
 19114* EXEC CICS STARTBR
 19115*        DATASET   ('ELTRLR')
 19116*        RIDFLD    (ELTRLR-KEY)
 19117*        GTEQ
 19118*    END-EXEC.
 19119     MOVE 'ELTRLR' TO DFHEIV1
 19120     MOVE 0
 19121       TO DFHEIV11
 19122*    MOVE '&,         G          &   #00017409' TO DFHEIV0
 19123     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19124     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19125     MOVE X'2020233030303137343039' TO DFHEIV0(25:11)
 19126     CALL 'kxdfhei1' USING DFHEIV0,
 19127           DFHEIV1,
 19128           ELTRLR-KEY,
 19129           DFHEIV99,
 19130           DFHEIV11,
 19131           DFHEIV99
 19132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19133
 19134
 19135     MOVE 'Y'                        TO  WS-BROWSE-SW.
 19136
 19137 7500-READ-NEXT.
 19138
 19139
 19140* EXEC CICS READNEXT
 19141*        DATASET   ('ELTRLR')
 19142*        RIDFLD    (ELTRLR-KEY)
 19143*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19144*    END-EXEC.
 19145     MOVE 'ELTRLR' TO DFHEIV1
 19146     MOVE 0
 19147       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 370
* EL156.cbl
 19148*    MOVE '&.S                   )   #00017419' TO DFHEIV0
 19149     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19150     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19151     MOVE X'2020233030303137343139' TO DFHEIV0(25:11)
 19152     CALL 'kxdfhei1' USING DFHEIV0,
 19153           DFHEIV1,
 19154           DFHEIV20,
 19155           DFHEIV99,
 19156           ELTRLR-KEY,
 19157           DFHEIV99,
 19158           DFHEIV11,
 19159           DFHEIV99,
 19160           DFHEIV99
 19161     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19162         DFHEIV20
 19163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19164
 19165
 19166     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 19167        PI-CARRIER    NOT = TRLR-CARRIER  OR
 19168        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 19169        PI-CERT-NO    NOT = TRLR-CERT-NO
 19170         GO TO 7590-END.
 19171
 19172     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 19173         GO TO 7500-READ-NEXT.
 19174
 19175     IF AT-TRAILER-TYPE NOT = '4'
 19176         GO TO 7500-READ-NEXT.
 19177
 19178     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 19179         GO TO 7500-READ-NEXT.
 19180
 19181     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 19182        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 19183         GO TO 7500-READ-NEXT.
 19184
 19185     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 19186        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 19187        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 19188         GO TO 7500-READ-NEXT.
 19189
 19190     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 19191                         AND
 19192        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 19193                         AND
 19194        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 19195            GO TO 7500-READ-NEXT.
 19196
 19197     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 19198
 19199
 19200* EXEC CICS ENDBR
 19201*        DATASET   ('ELTRLR')
 19202*    END-EXEC.
 19203     MOVE 'ELTRLR' TO DFHEIV1
 19204     MOVE 0
 19205       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 371
* EL156.cbl
 19206*    MOVE '&2                    $   #00017458' TO DFHEIV0
 19207     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19208     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19209     MOVE X'2020233030303137343538' TO DFHEIV0(25:11)
 19210     CALL 'kxdfhei1' USING DFHEIV0,
 19211           DFHEIV1,
 19212           DFHEIV11,
 19213           DFHEIV99
 19214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19215
 19216
 19217     MOVE 'N'                        TO  WS-BROWSE-SW.
 19218
 19219
 19220* EXEC CICS READ
 19221*        DATASET   ('ELTRLR')
 19222*        RIDFLD    (ELTRLR-KEY)
 19223*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19224*        UPDATE
 19225*    END-EXEC.
 19226     MOVE 'ELTRLR' TO DFHEIV1
 19227*    MOVE '&"S        EU         (   #00017464' TO DFHEIV0
 19228     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19229     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19230     MOVE X'2020233030303137343634' TO DFHEIV0(25:11)
 19231     CALL 'kxdfhei1' USING DFHEIV0,
 19232           DFHEIV1,
 19233           DFHEIV20,
 19234           DFHEIV99,
 19235           ELTRLR-KEY,
 19236           DFHEIV99,
 19237           DFHEIV99,
 19238           DFHEIV99
 19239     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19240         DFHEIV20
 19241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19242
 19243
 19244     MOVE 'Y'                        TO  WS-UPDATE-SW.
 19245
 19246     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 19247         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 19248     ELSE
 19249         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 19250             NEXT SENTENCE
 19251         ELSE
 19252             GO TO 7500-REWRITE-TRLR.
 19253
 19254     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 19255
 19256     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 19257     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 19258     MOVE '1'                        TO  ARCH-REC-TYPE.
 19259     MOVE +0                         TO  ARCH-SEQ.
 19260
 19261     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 19262
 19263 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 372
* EL156.cbl
 19264
 19265
 19266* EXEC CICS REWRITE
 19267*        DATASET   ('ELTRLR')
 19268*        FROM      (ACTIVITY-TRAILERS)
 19269*    END-EXEC.
 19270     MOVE LENGTH OF
 19271      ACTIVITY-TRAILERS
 19272       TO DFHEIV11
 19273     MOVE 'ELTRLR' TO DFHEIV1
 19274*    MOVE '&& L                  %   #00017492' TO DFHEIV0
 19275     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19276     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19277     MOVE X'2020233030303137343932' TO DFHEIV0(25:11)
 19278     CALL 'kxdfhei1' USING DFHEIV0,
 19279           DFHEIV1,
 19280           ACTIVITY-TRAILERS,
 19281           DFHEIV11,
 19282           DFHEIV99
 19283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19284
 19285
 19286     GO TO 7500-STARTBR-TRLR.
 19287
 19288 7590-END.
 19289
 19290     IF WS-BROWSE-SW = 'Y'
 19291         MOVE 'N'                    TO  WS-BROWSE-SW
 19292
 19293* EXEC CICS ENDBR
 19294*            DATASET   ('ELTRLR')
 19295*        END-EXEC.
 19296     MOVE 'ELTRLR' TO DFHEIV1
 19297     MOVE 0
 19298       TO DFHEIV11
 19299*    MOVE '&2                    $   #00017503' TO DFHEIV0
 19300     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19301     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19302     MOVE X'2020233030303137353033' TO DFHEIV0(25:11)
 19303     CALL 'kxdfhei1' USING DFHEIV0,
 19304           DFHEIV1,
 19305           DFHEIV11,
 19306           DFHEIV99
 19307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19308
 19309
 19310 7599-EXIT.
 19311     EXIT.
 19312
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 373
* EL156.cbl
 19314 7600-READ-ARCH-UPDATE.
 19315
 19316
 19317* EXEC CICS HANDLE CONDITION
 19318*        NOTFND   (7699-EXIT)
 19319*    END-EXEC.
 19320*    MOVE '"$I                   ! > #00017513' TO DFHEIV0
 19321     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19322     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19323     MOVE X'3E20233030303137353133' TO DFHEIV0(25:11)
 19324     CALL 'kxdfhei1' USING DFHEIV0
 19325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19326
 19327
 19328
 19329* EXEC CICS READ
 19330*        DATASET   ('ELARCH')
 19331*        RIDFLD    (ELARCH-KEY)
 19332*        SET       (ADDRESS OF LETTER-ARCHIVE)
 19333*        UPDATE
 19334*    END-EXEC.
 19335     MOVE 'ELARCH' TO DFHEIV1
 19336*    MOVE '&"S        EU         (   #00017517' TO DFHEIV0
 19337     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19338     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19339     MOVE X'2020233030303137353137' TO DFHEIV0(25:11)
 19340     CALL 'kxdfhei1' USING DFHEIV0,
 19341           DFHEIV1,
 19342           DFHEIV20,
 19343           DFHEIV99,
 19344           ELARCH-KEY,
 19345           DFHEIV99,
 19346           DFHEIV99,
 19347           DFHEIV99
 19348     SET ADDRESS OF LETTER-ARCHIVE TO
 19349         DFHEIV20
 19350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19351
 19352
 19353     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 19354
 19355
 19356* EXEC CICS REWRITE
 19357*        DATASET   ('ELARCH')
 19358*        FROM      (LETTER-ARCHIVE)
 19359*    END-EXEC.
 19360     MOVE LENGTH OF
 19361      LETTER-ARCHIVE
 19362       TO DFHEIV11
 19363     MOVE 'ELARCH' TO DFHEIV1
 19364*    MOVE '&& L                  %   #00017526' TO DFHEIV0
 19365     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19366     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19367     MOVE X'2020233030303137353236' TO DFHEIV0(25:11)
 19368     CALL 'kxdfhei1' USING DFHEIV0,
 19369           DFHEIV1,
 19370           LETTER-ARCHIVE,
 19371           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 374
* EL156.cbl
 19372           DFHEIV99
 19373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19374
 19375
 19376 7699-EXIT.
 19377     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 375
* EL156.cbl
 19379 7700-GET-DCT.
 19380
 19381     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 19382     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 19383     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 19384     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 19385                                    PI-MAX-BENEFIT-AMT
 19386                                    PI-MAX-BENEFIT-PYMT
 19387                                    PI-MIN-PAYMENT-AMT
 19388                                    PI-TIME-OF-LOSS-BAL.
 19389
 19390
 19391* EXEC CICS HANDLE CONDITION
 19392*         NOTFND (5300-NOTE-NOT-FOUND)
 19393*     END-EXEC.
 19394*    MOVE '"$I                   ! ? #00017545' TO DFHEIV0
 19395     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19396     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19397     MOVE X'3F20233030303137353435' TO DFHEIV0(25:11)
 19398     CALL 'kxdfhei1' USING DFHEIV0
 19399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19400
 19401
 19402
 19403* EXEC CICS READ
 19404*         DATASET('ERNOTE')
 19405*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 19406*         RIDFLD (W-NOTE-KEY)
 19407*     END-EXEC.
 19408     MOVE 'ERNOTE' TO DFHEIV1
 19409*    MOVE '&"S        E          (   #00017549' TO DFHEIV0
 19410     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19411     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19412     MOVE X'2020233030303137353439' TO DFHEIV0(25:11)
 19413     CALL 'kxdfhei1' USING DFHEIV0,
 19414           DFHEIV1,
 19415           DFHEIV20,
 19416           DFHEIV99,
 19417           W-NOTE-KEY,
 19418           DFHEIV99,
 19419           DFHEIV99,
 19420           DFHEIV99
 19421     SET ADDRESS OF CERTIFICATE-NOTE TO
 19422         DFHEIV20
 19423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19424
 19425
 19426     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 19427     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 19428     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 19429     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 19430     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 19431
 19432     IF PI-PAYEE-TYPE NOT = 'B'
 19433         GO TO 7700-EXIT.
 19434
 19435     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19436     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 376
* EL156.cbl
 19437     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19438
 19439     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19440         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19441     ELSE
 19442         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19443
 19444     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19445     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19446     MOVE 'DLO006'               TO PGM-NAME.
 19447
 19448
 19449* EXEC CICS LINK
 19450*        PROGRAM    (PGM-NAME)
 19451*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19452*        LENGTH     (DCT-RCRD-LENGTH)
 19453*    END-EXEC.
 19454*    MOVE '."C                   (   #00017577' TO DFHEIV0
 19455     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19456     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19457     MOVE X'2020233030303137353737' TO DFHEIV0(25:11)
 19458     CALL 'kxdfhei1' USING DFHEIV0,
 19459           PGM-NAME,
 19460           DCT-COMMUNICATION-AREA,
 19461           DCT-RCRD-LENGTH,
 19462           DFHEIV99,
 19463           DFHEIV99,
 19464           DFHEIV99,
 19465           DFHEIV99
 19466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19467
 19468
 19469     IF DCT-RETURN-CODE = 'OK'
 19470         GO TO 7700-CONT.
 19471
 19472     IF DCT-RETURN-CODE = '01' OR '02'
 19473         GO TO 7700-SET-TO-YES.
 19474
 19475     IF DCT-RETURN-CODE = '03'
 19476
 19477* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19478*    MOVE '6"R                   !   #00017590' TO DFHEIV0
 19479     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19480     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19481     MOVE X'2020233030303137353930' TO DFHEIV0(25:11)
 19482     CALL 'kxdfhei1' USING DFHEIV0
 19483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19484         MOVE ER-0951            TO EMI-ERROR
 19485         MOVE -1                 TO PMTTYPEL
 19486         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19487         GO TO 8200-SEND-DATAONLY.
 19488
 19489     IF DCT-RETURN-CODE = '04'
 19490
 19491* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19492*    MOVE '6"R                   !   #00017597' TO DFHEIV0
 19493     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19494     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 377
* EL156.cbl
 19495     MOVE X'2020233030303137353937' TO DFHEIV0(25:11)
 19496     CALL 'kxdfhei1' USING DFHEIV0
 19497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19498         MOVE ER-0946            TO EMI-ERROR
 19499         MOVE -1                 TO PMTTYPEL
 19500         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19501         GO TO 8200-SEND-DATAONLY.
 19502
 19503     IF DCT-RETURN-CODE = '05'
 19504
 19505* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19506*    MOVE '6"R                   !   #00017604' TO DFHEIV0
 19507     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19508     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19509     MOVE X'2020233030303137363034' TO DFHEIV0(25:11)
 19510     CALL 'kxdfhei1' USING DFHEIV0
 19511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19512         MOVE ER-0947            TO EMI-ERROR
 19513         MOVE -1                 TO PMTTYPEL
 19514         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19515         GO TO 8200-SEND-DATAONLY.
 19516
 19517     IF DCT-RETURN-CODE = '06'
 19518
 19519* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19520*    MOVE '6"R                   !   #00017611' TO DFHEIV0
 19521     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19523     MOVE X'2020233030303137363131' TO DFHEIV0(25:11)
 19524     CALL 'kxdfhei1' USING DFHEIV0
 19525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19526         MOVE ER-0921            TO EMI-ERROR
 19527         MOVE -1                 TO PMTTYPEL
 19528         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19529         GO TO 8200-SEND-DATAONLY.
 19530
 19531     IF DCT-RETURN-CODE = '07'
 19532
 19533* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19534*    MOVE '6"R                   !   #00017618' TO DFHEIV0
 19535     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19537     MOVE X'2020233030303137363138' TO DFHEIV0(25:11)
 19538     CALL 'kxdfhei1' USING DFHEIV0
 19539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19540         MOVE ER-0919            TO EMI-ERROR
 19541         MOVE -1                 TO PMTTYPEL
 19542         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19543         GO TO 8200-SEND-DATAONLY.
 19544
 19545     IF DCT-RETURN-CODE = '08'
 19546
 19547* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19548*    MOVE '6"R                   !   #00017625' TO DFHEIV0
 19549     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19550     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19551     MOVE X'2020233030303137363235' TO DFHEIV0(25:11)
 19552     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 378
* EL156.cbl
 19553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19554         MOVE ER-0948            TO EMI-ERROR
 19555         MOVE -1                 TO PMTTYPEL
 19556         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19557         GO TO 8200-SEND-DATAONLY.
 19558
 19559     IF DCT-RETURN-CODE = 'N1'
 19560
 19561* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19562*    MOVE '6"R                   !   #00017632' TO DFHEIV0
 19563     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19565     MOVE X'2020233030303137363332' TO DFHEIV0(25:11)
 19566     CALL 'kxdfhei1' USING DFHEIV0
 19567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19568         MOVE ER-0950            TO EMI-ERROR
 19569         MOVE -1                 TO PMTTYPEL
 19570         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19571         GO TO 8200-SEND-DATAONLY.
 19572
 19573     IF DCT-RETURN-CODE = 'E1'
 19574
 19575* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19576*    MOVE '6"R                   !   #00017639' TO DFHEIV0
 19577     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19579     MOVE X'2020233030303137363339' TO DFHEIV0(25:11)
 19580     CALL 'kxdfhei1' USING DFHEIV0
 19581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19582         MOVE ER-0974            TO EMI-ERROR
 19583         MOVE -1                 TO PMTTYPEL
 19584         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19585         GO TO 8200-SEND-DATAONLY.
 19586
 19587     IF DCT-RETURN-CODE = 'E2'
 19588
 19589* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19590*    MOVE '6"R                   !   #00017646' TO DFHEIV0
 19591     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19592     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19593     MOVE X'2020233030303137363436' TO DFHEIV0(25:11)
 19594     CALL 'kxdfhei1' USING DFHEIV0
 19595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19596         MOVE ER-0975            TO EMI-ERROR
 19597         MOVE -1                 TO PMTTYPEL
 19598         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19599         GO TO 8200-SEND-DATAONLY.
 19600
 19601     IF DCT-RETURN-CODE NOT = 'OK'
 19602
 19603* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19604*    MOVE '6"R                   !   #00017653' TO DFHEIV0
 19605     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19607     MOVE X'2020233030303137363533' TO DFHEIV0(25:11)
 19608     CALL 'kxdfhei1' USING DFHEIV0
 19609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19610         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 379
* EL156.cbl
 19611         MOVE -1                 TO PMTTYPEL
 19612         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19613         GO TO 8200-SEND-DATAONLY.
 19614
 19615 7700-CONT.
 19616
 19617*    MOVE 'N'                    TO CASHO.
 19618*    MOVE +1                     TO CASHL.
 19619*    MOVE AL-UANON               TO CASHA.
 19620
 19621     IF PI-OFFLINE = 'Y'
 19622         GO TO 7700-EXIT.
 19623
 19624     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19625     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19626     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19627     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19628     MOVE +7                     TO CHECKNOL.
 19629     MOVE AL-UANON               TO CHECKNOA.
 19630     GO TO 7700-EXIT.
 19631
 19632 7700-SET-TO-YES.
 19633
 19634*    MOVE 'Y'                    TO CASHO.
 19635*    MOVE +1                     TO CASHL.
 19636*    MOVE AL-UANON               TO CASHA.
 19637
 19638 7700-EXIT.
 19639     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 380
* EL156.cbl
 19641 7800-READ-COMP-MSTR.
 19642
 19643
 19644* EXEC CICS HANDLE CONDITION
 19645*        NOTFND   (7800-COMP-NOTFND)
 19646*    END-EXEC.
 19647*    MOVE '"$I                   ! @ #00017687' TO DFHEIV0
 19648     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19649     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19650     MOVE X'4020233030303137363837' TO DFHEIV0(25:11)
 19651     CALL 'kxdfhei1' USING DFHEIV0
 19652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19653
 19654
 19655
 19656* EXEC CICS READ
 19657*        DATASET   ('ERCOMP')
 19658*        RIDFLD    (ERCOMP-KEY)
 19659*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19660*    END-EXEC.
 19661     MOVE 'ERCOMP' TO DFHEIV1
 19662*    MOVE '&"S        E          (   #00017691' TO DFHEIV0
 19663     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19664     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19665     MOVE X'2020233030303137363931' TO DFHEIV0(25:11)
 19666     CALL 'kxdfhei1' USING DFHEIV0,
 19667           DFHEIV1,
 19668           DFHEIV20,
 19669           DFHEIV99,
 19670           ERCOMP-KEY,
 19671           DFHEIV99,
 19672           DFHEIV99,
 19673           DFHEIV99
 19674     SET ADDRESS OF COMPENSATION-MASTER TO
 19675         DFHEIV20
 19676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19677
 19678
 19679     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19680     GO TO 7800-COMP-EXIT.
 19681
 19682 7800-COMP-NOTFND.
 19683     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19684
 19685 7800-COMP-EXIT.
 19686     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 381
* EL156.cbl
 19688 7900-READ-CLAIM.
 19689
 19690* EXEC CICS READ
 19691*        DATASET  ('ELMSTR')
 19692*        SET      (ADDRESS OF CLAIM-MASTER)
 19693*        RIDFLD   (ELMSTR-KEY)
 19694*    END-EXEC.
 19695     MOVE 'ELMSTR' TO DFHEIV1
 19696*    MOVE '&"S        E          (   #00017707' TO DFHEIV0
 19697     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19698     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19699     MOVE X'2020233030303137373037' TO DFHEIV0(25:11)
 19700     CALL 'kxdfhei1' USING DFHEIV0,
 19701           DFHEIV1,
 19702           DFHEIV20,
 19703           DFHEIV99,
 19704           ELMSTR-KEY,
 19705           DFHEIV99,
 19706           DFHEIV99,
 19707           DFHEIV99
 19708     SET ADDRESS OF CLAIM-MASTER TO
 19709         DFHEIV20
 19710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19711
 19712
 19713 7900-EXIT.
 19714      EXIT.
 19715
 19716 7910-READ-CLAIM-UPDATE.
 19717
 19718* EXEC CICS READ
 19719*        DATASET  ('ELMSTR')
 19720*        SET      (ADDRESS OF CLAIM-MASTER)
 19721*        RIDFLD   (ELMSTR-KEY)
 19722*        UPDATE
 19723*    END-EXEC.
 19724     MOVE 'ELMSTR' TO DFHEIV1
 19725*    MOVE '&"S        EU         (   #00017717' TO DFHEIV0
 19726     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19727     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19728     MOVE X'2020233030303137373137' TO DFHEIV0(25:11)
 19729     CALL 'kxdfhei1' USING DFHEIV0,
 19730           DFHEIV1,
 19731           DFHEIV20,
 19732           DFHEIV99,
 19733           ELMSTR-KEY,
 19734           DFHEIV99,
 19735           DFHEIV99,
 19736           DFHEIV99
 19737     SET ADDRESS OF CLAIM-MASTER TO
 19738         DFHEIV20
 19739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19740
 19741
 19742 7910-EXIT.
 19743      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 382
* EL156.cbl
 19745 7920-READ-BENE.
 19746     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19747     MOVE 'B'                TO BENE-RECORD-TYPE.
 19748     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19749
 19750     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19751        IF PI-PAYEE-TYPE    = 'B' AND
 19752           PI-PAYEE-SEQ-NUM = 9
 19753             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19754             MOVE WS-A-BENE           TO BENE-NUMBER.
 19755
 19756
 19757* EXEC CICS HANDLE CONDITION
 19758*        NOTFND   (7920-NOT-FOUND)
 19759*    END-EXEC.
 19760*    MOVE '"$I                   ! A #00017738' TO DFHEIV0
 19761     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19762     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19763     MOVE X'4120233030303137373338' TO DFHEIV0(25:11)
 19764     CALL 'kxdfhei1' USING DFHEIV0
 19765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19766
 19767
 19768
 19769* EXEC CICS READ
 19770*        DATASET  ('ELBENE')
 19771*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19772*        RIDFLD   (ELBENE-KEY)
 19773*    END-EXEC.
 19774     MOVE 'ELBENE' TO DFHEIV1
 19775*    MOVE '&"S        E          (   #00017742' TO DFHEIV0
 19776     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19777     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19778     MOVE X'2020233030303137373432' TO DFHEIV0(25:11)
 19779     CALL 'kxdfhei1' USING DFHEIV0,
 19780           DFHEIV1,
 19781           DFHEIV20,
 19782           DFHEIV99,
 19783           ELBENE-KEY,
 19784           DFHEIV99,
 19785           DFHEIV99,
 19786           DFHEIV99
 19787     SET ADDRESS OF BENEFICIARY-MASTER TO
 19788         DFHEIV20
 19789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19790
 19791
 19792     MOVE 'Y' TO BENE-FOUND-SW.
 19793     GO TO 7920-EXIT.
 19794
 19795 7920-NOT-FOUND.
 19796     MOVE 'N'                    TO BENE-FOUND-SW.
 19797
 19798 7920-EXIT.
 19799      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 383
* EL156.cbl
 19801 7930-READ-CONTROL.
 19802
 19803* EXEC CICS READ
 19804*        DATASET  ('ELCNTL')
 19805*        SET      (ADDRESS OF CONTROL-FILE)
 19806*        RIDFLD   (ELCNTL-KEY)
 19807*    END-EXEC.
 19808     MOVE 'ELCNTL' TO DFHEIV1
 19809*    MOVE '&"S        E          (   #00017758' TO DFHEIV0
 19810     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19811     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19812     MOVE X'2020233030303137373538' TO DFHEIV0(25:11)
 19813     CALL 'kxdfhei1' USING DFHEIV0,
 19814           DFHEIV1,
 19815           DFHEIV20,
 19816           DFHEIV99,
 19817           ELCNTL-KEY,
 19818           DFHEIV99,
 19819           DFHEIV99,
 19820           DFHEIV99
 19821     SET ADDRESS OF CONTROL-FILE TO
 19822         DFHEIV20
 19823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19824
 19825
 19826 7930-EXIT.
 19827      EXIT.
 19828
 19829 7940-READ-CONTROL-UPDATE.
 19830
 19831* EXEC CICS READ
 19832*        DATASET  ('ELCNTL')
 19833*        SET      (ADDRESS OF CONTROL-FILE)
 19834*        RIDFLD   (ELCNTL-KEY)
 19835*        UPDATE
 19836*    END-EXEC.
 19837     MOVE 'ELCNTL' TO DFHEIV1
 19838*    MOVE '&"S        EU         (   #00017768' TO DFHEIV0
 19839     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19840     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19841     MOVE X'2020233030303137373638' TO DFHEIV0(25:11)
 19842     CALL 'kxdfhei1' USING DFHEIV0,
 19843           DFHEIV1,
 19844           DFHEIV20,
 19845           DFHEIV99,
 19846           ELCNTL-KEY,
 19847           DFHEIV99,
 19848           DFHEIV99,
 19849           DFHEIV99
 19850     SET ADDRESS OF CONTROL-FILE TO
 19851         DFHEIV20
 19852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19853
 19854
 19855 7940-EXIT.
 19856      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 384
* EL156.cbl
 19858 7950-READ-TRAILER.
 19859
 19860* EXEC CICS READ
 19861*        DATASET  ('ELTRLR')
 19862*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19863*        RIDFLD   (ELTRLR-KEY)
 19864*    END-EXEC.
 19865     MOVE 'ELTRLR' TO DFHEIV1
 19866*    MOVE '&"S        E          (   #00017779' TO DFHEIV0
 19867     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19869     MOVE X'2020233030303137373739' TO DFHEIV0(25:11)
 19870     CALL 'kxdfhei1' USING DFHEIV0,
 19871           DFHEIV1,
 19872           DFHEIV20,
 19873           DFHEIV99,
 19874           ELTRLR-KEY,
 19875           DFHEIV99,
 19876           DFHEIV99,
 19877           DFHEIV99
 19878     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19879         DFHEIV20
 19880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19881
 19882
 19883 7950-EXIT.
 19884      EXIT.
 19885
 19886 7960-READ-TRAILER-UPDATE.
 19887
 19888* EXEC CICS READ
 19889*        DATASET  ('ELTRLR')
 19890*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19891*        RIDFLD   (ELTRLR-KEY)
 19892*        UPDATE
 19893*    END-EXEC.
 19894     MOVE 'ELTRLR' TO DFHEIV1
 19895*    MOVE '&"S        EU         (   #00017789' TO DFHEIV0
 19896     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19897     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19898     MOVE X'2020233030303137373839' TO DFHEIV0(25:11)
 19899     CALL 'kxdfhei1' USING DFHEIV0,
 19900           DFHEIV1,
 19901           DFHEIV20,
 19902           DFHEIV99,
 19903           ELTRLR-KEY,
 19904           DFHEIV99,
 19905           DFHEIV99,
 19906           DFHEIV99
 19907     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19908         DFHEIV20
 19909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19910
 19911
 19912 7960-EXIT.
 19913      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 385
* EL156.cbl
 19915 7970-READ-CERT.
 19916
 19917* EXEC CICS READ
 19918*        DATASET  ('ELCERT')
 19919*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19920*        RIDFLD   (ELCERT-KEY)
 19921*    END-EXEC.
 19922     MOVE 'ELCERT' TO DFHEIV1
 19923*    MOVE '&"S        E          (   #00017800' TO DFHEIV0
 19924     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19925     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19926     MOVE X'2020233030303137383030' TO DFHEIV0(25:11)
 19927     CALL 'kxdfhei1' USING DFHEIV0,
 19928           DFHEIV1,
 19929           DFHEIV20,
 19930           DFHEIV99,
 19931           ELCERT-KEY,
 19932           DFHEIV99,
 19933           DFHEIV99,
 19934           DFHEIV99
 19935     SET ADDRESS OF CERTIFICATE-MASTER TO
 19936         DFHEIV20
 19937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19938
 19939
 19940 7970-EXIT.
 19941      EXIT.
 19942 7975-read-acct.
 19943
 19944     move spaces              to WS-ACCT-RECORD-SW
 19945                                 pi-dcc-product-code
 19946
 19947     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19948     MOVE PI-CARRIER          TO ACCT-CARRIER
 19949     MOVE PI-GROUPING         TO ACCT-GROUPING
 19950     MOVE PI-STATE            TO ACCT-STATE
 19951     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19952     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19953     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19954     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19955
 19956
 19957* EXEC CICS READ
 19958*       DATASET ('ERACCT')
 19959*       RIDFLD  (ERACCT-KEY)
 19960*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19961*       GTEQ
 19962*       resp    (WS-RESPONSE)
 19963*    END-EXEC
 19964     MOVE 'ERACCT' TO DFHEIV1
 19965*    MOVE '&"S        G          (  N#00017822' TO DFHEIV0
 19966     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19967     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19968     MOVE X'204E233030303137383232' TO DFHEIV0(25:11)
 19969     CALL 'kxdfhei1' USING DFHEIV0,
 19970           DFHEIV1,
 19971           DFHEIV20,
 19972           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 386
* EL156.cbl
 19973           ERACCT-KEY,
 19974           DFHEIV99,
 19975           DFHEIV99,
 19976           DFHEIV99
 19977     SET ADDRESS OF ACCOUNT-MASTER TO
 19978         DFHEIV20
 19979     MOVE EIBRESP  TO WS-RESPONSE
 19980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19981     IF WS-RESP-NORMAL
 19982        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19983        and pi-cert-eff-dt < am-expiration-dt
 19984        and pi-cert-eff-dt >= am-effective-dt
 19985        move am-dcc-product-code to pi-dcc-product-code
 19986        set acct-found to true
 19987     end-if
 19988
 19989     .
 19990 7975-exit.
 19991     exit.
 19992 7980-READ-CERT-UPDATE.
 19993
 19994* EXEC CICS READ
 19995*        DATASET  ('ELCERT')
 19996*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19997*        RIDFLD   (ELCERT-KEY)
 19998*        UPDATE
 19999*    END-EXEC.
 20000     MOVE 'ELCERT' TO DFHEIV1
 20001*    MOVE '&"S        EU         (   #00017841' TO DFHEIV0
 20002     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20003     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20004     MOVE X'2020233030303137383431' TO DFHEIV0(25:11)
 20005     CALL 'kxdfhei1' USING DFHEIV0,
 20006           DFHEIV1,
 20007           DFHEIV20,
 20008           DFHEIV99,
 20009           ELCERT-KEY,
 20010           DFHEIV99,
 20011           DFHEIV99,
 20012           DFHEIV99
 20013     SET ADDRESS OF CERTIFICATE-MASTER TO
 20014         DFHEIV20
 20015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20016
 20017
 20018 7980-EXIT.
 20019      EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 387
* EL156.cbl
 20021 8000-LOAD-ERROR-MESSAGES.
 20022     IF PI-PASS-SW = 'C'
 20023        MOVE EMI-LINE1           TO ERMSG1BO
 20024     ELSE
 20025        MOVE EMI-LINE1           TO ERRMSG1O
 20026        MOVE EMI-LINE2           TO ERRMSG2O.
 20027
 20028 8000-EXIT.
 20029     EXIT.
 20030
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 388
* EL156.cbl
 20032
 20033 8010-DMD-ERROR-CHECKS.
 20034     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 20035
 20036     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 20037         GO TO 8051-ISSUE-ERROR.
 20038
 20039     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 20040     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 20041     MOVE '3'                    TO DC-OPTION-CODE.
 20042     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 20043     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 20044         GO TO 8051-ISSUE-ERROR.
 20045
 20046     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 20047       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 20048                           OR
 20049          (CL-SSN-STATE   = CL-CERT-STATE  AND
 20050           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 20051             MOVE ER-0851         TO EMI-ERROR
 20052             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20053       END-IF
 20054       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 20055             MOVE ER-8147         TO EMI-ERROR
 20056             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20057
 20058     GO TO 8090-EXIT.
 20059
 20060 8051-ISSUE-ERROR.
 20061     MOVE ER-8146            TO EMI-ERROR.
 20062     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20063     GO TO 8090-EXIT.
 20064
 20065 8090-EXIT.
 20066      EXIT.
 20067
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 389
* EL156.cbl
 20069 8100-SEND-INITIAL-MAP.
 20070
 20071     MOVE SAVE-DATE              TO RUNDTEAO.
 20072     MOVE EIBTIME                TO TIME-IN.
 20073     MOVE TIME-OUT               TO RUNTIMAO.
 20074     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 20075
 20076     IF MAP-NAME = 'EL156A'
 20077        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 20078           MOVE 'PF6=EOB CODES'  TO PF6TITO
 20079        END-IF
 20080        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 20081           MOVE 'N'     TO SURVYYNO
 20082        END-IF
 20083     END-IF
 20084*    IF MAP-NAME = 'EL156A'
 20085*       IF PI-COMPANY-ID = 'CRI'
 20086*          NEXT SENTENCE
 20087*       ELSE
 20088*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 20089
 20090     IF MAP-NAME = 'EL156A'
 20091        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 20092           NEXT SENTENCE
 20093        ELSE
 20094           MOVE AL-SADOF TO  PINTA    PINTHA.
 20095
 20096     IF MAP-NAME = 'EL156A'
 20097        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 20098            NEXT SENTENCE
 20099        ELSE
 20100           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 20101
 20102*    IF MAP-NAME = 'EL156A'
 20103*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 20104*          NEXT SENTENCE
 20105*       ELSE
 20106*          MOVE AL-SADOF TO CASHHA CASHA.
 20107
 20108     IF MAP-NAME = 'EL156A'
 20109        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 20110                        or 'VPP'
 20111           NEXT SENTENCE
 20112        ELSE
 20113           MOVE AL-SADOF        TO  LOANHA
 20114                                    LOANNOA.
 20115
 20116     IF MAP-NAME = 'EL156A'
 20117        MOVE -1                 TO  ENTERPFL
 20118        IF PI-USES-PAID-TO
 20119           MOVE 'PAID TO DATE :' TO PTHRHDGO
 20120           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 20121           MOVE PMT-HEAD-A      TO  PMTHDGAO
 20122        ELSE
 20123           NEXT SENTENCE
 20124     ELSE
 20125        IF MAP-NAME = 'EL156B'
 20126           IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 390
* EL156.cbl
 20127              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 20128              MOVE PMT-HEAD-B     TO PMTHDGBO.
 20129
 20130
 20131* EXEC CICS SEND
 20132*        MAP   (MAP-NAME)
 20133*        MAPSET(MAPSET-NAME)
 20134*        FROM  (EL156AI)
 20135*        ERASE
 20136*        CURSOR
 20137*    END-EXEC.
 20138     MOVE LENGTH OF
 20139      EL156AI
 20140       TO DFHEIV12
 20141     MOVE -1
 20142       TO DFHEIV11
 20143*    MOVE '8$     CT  E    H L F ,   #00017960' TO DFHEIV0
 20144     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 20145     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20146     MOVE X'2020233030303137393630' TO DFHEIV0(25:11)
 20147     CALL 'kxdfhei1' USING DFHEIV0,
 20148           MAP-NAME,
 20149           EL156AI,
 20150           DFHEIV12,
 20151           MAPSET-NAME,
 20152           DFHEIV99,
 20153           DFHEIV99,
 20154           DFHEIV99,
 20155           DFHEIV11,
 20156           DFHEIV99,
 20157           DFHEIV99,
 20158           DFHEIV99
 20159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20160
 20161
 20162     GO TO 9100-RETURN-TRAN.
 20163
 20164 8200-SEND-DATAONLY.
 20165
 20166     IF FIRST-ENTRY = 'Y'
 20167         GO TO 8100-SEND-INITIAL-MAP.
 20168
 20169     IF RETURNED-FROM-B = 'Y'
 20170         GO TO 8100-SEND-INITIAL-MAP.
 20171
 20172     MOVE SAVE-DATE              TO RUNDTEAO.
 20173     MOVE EIBTIME                TO TIME-IN.
 20174     MOVE TIME-OUT               TO RUNTIMAO.
 20175
 20176     IF EIBAID = DFHPF11
 20177        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 20178        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20179        MOVE 'EL001   '          TO RETURNED-FROM
 20180        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 20181        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 20182        GO TO 8100-SEND-INITIAL-MAP.
 20183
 20184     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 391
* EL156.cbl
 20185
 20186     IF MAP-NAME =  'EL156A'
 20187        MOVE -1                 TO  ENTERPFL
 20188        IF PI-USES-PAID-TO
 20189           MOVE 'PAID TO DATE :' TO PTHRHDGO
 20190           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 20191           MOVE PMT-HEAD-A      TO  PMTHDGAO
 20192        ELSE
 20193           NEXT SENTENCE
 20194     ELSE
 20195        IF MAP-NAME = 'EL156B'
 20196           IF PI-USES-PAID-TO
 20197              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 20198              MOVE PMT-HEAD-B     TO PMTHDGBO.
 20199
 20200     IF MAP-NAME =  'EL156A'
 20201        IF PI-COMPANY-ID = 'BOA'
 20202            IF PI-INT-RATE NUMERIC
 20203                MOVE PI-INT-RATE TO PINTO.
 20204     IF MAP-NAME = 'EL156A'
 20205        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 20206           MOVE 'PF6=EOB CODES'  TO PF6TITO
 20207*          MOVE 'Y'              TO EOBYNO
 20208        END-IF
 20209     END-IF
 20210
 20211
 20212* EXEC CICS SEND
 20213*        MAP   (MAP-NAME)
 20214*        MAPSET(MAPSET-NAME)
 20215*        FROM  (EL156AI)
 20216*        DATAONLY
 20217*        CURSOR
 20218*    END-EXEC.
 20219     MOVE LENGTH OF
 20220      EL156AI
 20221       TO DFHEIV12
 20222     MOVE -1
 20223       TO DFHEIV11
 20224*    MOVE '8$D    CT       H L F ,   #00018017' TO DFHEIV0
 20225     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 20226     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20227     MOVE X'2020233030303138303137' TO DFHEIV0(25:11)
 20228     CALL 'kxdfhei1' USING DFHEIV0,
 20229           MAP-NAME,
 20230           EL156AI,
 20231           DFHEIV12,
 20232           MAPSET-NAME,
 20233           DFHEIV99,
 20234           DFHEIV99,
 20235           DFHEIV99,
 20236           DFHEIV11,
 20237           DFHEIV99,
 20238           DFHEIV99,
 20239           DFHEIV99
 20240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20241
 20242
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 392
* EL156.cbl
 20243     GO TO 9100-RETURN-TRAN.
 20244
 20245 8300-SEND-TEXT.
 20246
 20247* EXEC CICS SEND TEXT
 20248*        FROM(LOGOFF-TEXT)
 20249*        LENGTH(LOGOFF-LENGTH)
 20250*        ERASE
 20251*        FREEKB
 20252*    END-EXEC.
 20253*    MOVE '8&      T  E F  H   F -   #00018028' TO DFHEIV0
 20254     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 20255     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 20256     MOVE X'2020233030303138303238' TO DFHEIV0(25:11)
 20257     CALL 'kxdfhei1' USING DFHEIV0,
 20258           LOGOFF-TEXT,
 20259           LOGOFF-LENGTH,
 20260           DFHEIV99,
 20261           DFHEIV99,
 20262           DFHEIV99,
 20263           DFHEIV99,
 20264           DFHEIV99,
 20265           DFHEIV99,
 20266           DFHEIV99,
 20267           DFHEIV99,
 20268           DFHEIV99,
 20269           DFHEIV99
 20270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20271
 20272
 20273
 20274* EXEC CICS RETURN
 20275*    END-EXEC.
 20276*    MOVE '.(                    ''   #00018035' TO DFHEIV0
 20277     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20278     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20279     MOVE X'2020233030303138303335' TO DFHEIV0(25:11)
 20280     CALL 'kxdfhei1' USING DFHEIV0,
 20281           DFHEIV99,
 20282           DFHEIV99,
 20283           DFHEIV99,
 20284           DFHEIV99,
 20285           DFHEIV99,
 20286           DFHEIV99
 20287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20288
 20289
 20290 8500-FILE-NOTOPEN.
 20291     IF FILE-SWITCH = 'MSTR'
 20292         MOVE ER-0154            TO EMI-ERROR.
 20293     IF FILE-SWITCH = 'TRLR'
 20294         MOVE ER-0172            TO EMI-ERROR.
 20295     IF FILE-SWITCH = 'CERT'
 20296         MOVE ER-0169            TO EMI-ERROR.
 20297     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 20298                      'PROC' OR 'STAT'
 20299         MOVE ER-0042            TO EMI-ERROR.
 20300     IF FILE-SWITCH = 'ACTQ'
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 393
* EL156.cbl
 20301         MOVE ER-0338            TO EMI-ERROR.
 20302     IF FILE-SWITCH = 'ACCT'
 20303         MOVE ER-0168            TO EMI-ERROR.
 20304
 20305     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20306     MOVE -1                     TO PMTTYPEL.
 20307
 20308     IF FIRST-ENTRY = 'Y'
 20309         GO TO 8100-SEND-INITIAL-MAP.
 20310
 20311     GO TO 8200-SEND-DATAONLY.
 20312
 20313 8600-PGRM-NOT-FOUND.
 20314
 20315     MOVE ER-0923                TO EMI-ERROR.
 20316     MOVE -1                     TO ENTPFBL.
 20317     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20318
 20319     IF FIRST-ENTRY = 'Y'
 20320         GO TO 8100-SEND-INITIAL-MAP
 20321     ELSE
 20322         GO TO 8200-SEND-DATAONLY.
 20323
 20324 8800-UNAUTHORIZED-ACCESS.
 20325     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20326     GO TO 8300-SEND-TEXT.
 20327
 20328 8810-PF23.
 20329     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20330     MOVE XCTL-005               TO PGM-NAME.
 20331     GO TO 9300-XCTL.
 20332
 20333 8820-PF7-8.
 20334     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 20335     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 20336                                    PI-SAVED-PROGRAM-2
 20337                                    PI-SAVED-PROGRAM-3
 20338                                    PI-SAVED-PROGRAM-4
 20339                                    PI-SAVED-PROGRAM-5
 20340                                    PI-SAVED-PROGRAM-6
 20341                                    PI-RETURN-TO-PROGRAM.
 20342     IF EIBAID = DFHPF8
 20343        MOVE XCTL-132            TO PGM-NAME
 20344     ELSE
 20345        MOVE XCTL-130            TO PGM-NAME.
 20346
 20347     GO TO 9300-XCTL.
 20348
 20349 9100-RETURN-TRAN.
 20350     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20351     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 20352
 20353
 20354* EXEC CICS RETURN
 20355*        TRANSID(TRANS-ID)
 20356*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20357*        LENGTH(PI-COMM-LENGTH)
 20358*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 394
* EL156.cbl
 20359*    MOVE '.(CT                  ''   #00018101' TO DFHEIV0
 20360     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20361     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20362     MOVE X'2020233030303138313031' TO DFHEIV0(25:11)
 20363     CALL 'kxdfhei1' USING DFHEIV0,
 20364           TRANS-ID,
 20365           PROGRAM-INTERFACE-BLOCK,
 20366           PI-COMM-LENGTH,
 20367           DFHEIV99,
 20368           DFHEIV99,
 20369           DFHEIV99
 20370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20371
 20372
 20373 9200-RETURN-MAIN-MENU.
 20374     MOVE XCTL-126               TO PGM-NAME.
 20375     GO TO 9300-XCTL.
 20376
 20377 9300-XCTL.
 20378
 20379* EXEC CICS XCTL
 20380*        PROGRAM(PGM-NAME)
 20381*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20382*        LENGTH(PI-COMM-LENGTH)
 20383*    END-EXEC.
 20384*    MOVE '.$C                   %   #00018112' TO DFHEIV0
 20385     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20386     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20387     MOVE X'2020233030303138313132' TO DFHEIV0(25:11)
 20388     CALL 'kxdfhei1' USING DFHEIV0,
 20389           PGM-NAME,
 20390           PROGRAM-INTERFACE-BLOCK,
 20391           PI-COMM-LENGTH,
 20392           DFHEIV99
 20393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20394
 20395
 20396 9400-CLEAR.
 20397     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20398     GO TO 9300-XCTL.
 20399
 20400 9500-PF12.
 20401     MOVE XCTL-010               TO PGM-NAME.
 20402     GO TO 9300-XCTL.
 20403
 20404 9700-LINK-DATE-CONVERT.
 20405     MOVE LINK-ELDATCV           TO PGM-NAME.
 20406
 20407* EXEC CICS LINK
 20408*        PROGRAM   (PGM-NAME)
 20409*        COMMAREA  (DATE-CONVERSION-DATA)
 20410*        LENGTH    (DC-COMM-LENGTH)
 20411*    END-EXEC.
 20412*    MOVE '."C                   (   #00018128' TO DFHEIV0
 20413     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20415     MOVE X'2020233030303138313238' TO DFHEIV0(25:11)
 20416     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 395
* EL156.cbl
 20417           PGM-NAME,
 20418           DATE-CONVERSION-DATA,
 20419           DC-COMM-LENGTH,
 20420           DFHEIV99,
 20421           DFHEIV99,
 20422           DFHEIV99,
 20423           DFHEIV99
 20424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20425
 20426
 20427 9700-EXIT.
 20428     EXIT.
 20429
 20430 9800-LINK-REM-TERM.
 20431     MOVE LINK-REMTERM TO PGM-NAME.
 20432
 20433
 20434* EXEC CICS LINK
 20435*        PROGRAM   (PGM-NAME)
 20436*        COMMAREA  (CALCULATION-PASS-AREA)
 20437*        LENGTH    (CP-COMM-LENGTH)
 20438*    END-EXEC.
 20439*    MOVE '."C                   (   #00018140' TO DFHEIV0
 20440     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20441     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20442     MOVE X'2020233030303138313430' TO DFHEIV0(25:11)
 20443     CALL 'kxdfhei1' USING DFHEIV0,
 20444           PGM-NAME,
 20445           CALCULATION-PASS-AREA,
 20446           CP-COMM-LENGTH,
 20447           DFHEIV99,
 20448           DFHEIV99,
 20449           DFHEIV99,
 20450           DFHEIV99
 20451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20452
 20453
 20454 9800-EXIT.
 20455     EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 396
* EL156.cbl
 20457 9830-DMD-REMAINING-TERM.
 20458
 20459     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20460         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20461
 20462     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20463                              CM-PMT-EXTENSION-DAYS.
 20464
 20465     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20466                                  CL-NO-OF-DAYS-PAID.
 20467
 20468     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20469         GIVING W-REM REMAINDER W-REM-DAYS.
 20470
 20471     MOVE W-REM                  TO WST-REM.
 20472
 20473     IF W-REM-DAYS > ZEROS
 20474         MOVE '/'                TO WST-SLASH
 20475         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20476     ELSE
 20477         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20478
 20479 9830-EXIT.
 20480     EXIT.
 20481
 20482 9870-OUTPUT-ACTIVITY-RECORD.
 20483
 20484
 20485* EXEC CICS GETMAIN
 20486*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20487*         LENGTH(25)
 20488*         INITIMG(WS-BLANK)
 20489*    END-EXEC.
 20490     MOVE 25
 20491       TO DFHEIV11
 20492*    MOVE ',"IL                  $   #00018176' TO DFHEIV0
 20493     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20494     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20495     MOVE X'2020233030303138313736' TO DFHEIV0(25:11)
 20496     CALL 'kxdfhei1' USING DFHEIV0,
 20497           DFHEIV20,
 20498           DFHEIV11,
 20499           WS-BLANK
 20500     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20501         DFHEIV20
 20502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20503
 20504
 20505     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20506     MOVE ELMSTR-KEY             TO DA-KEY.
 20507     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20508
 20509     IF PI-PMTTYPE EQUAL '7'
 20510         MOVE 'V'                TO DA-RECORD-TYPE
 20511     ELSE
 20512         MOVE 'P'                TO DA-RECORD-TYPE.
 20513
 20514
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 397
* EL156.cbl
 20515* EXEC CICS HANDLE CONDITION
 20516*         NOTOPEN(9870-NOTOPEN)
 20517*         DUPREC(9870-EXIT)
 20518*    END-EXEC.
 20519*    MOVE '"$J%                  ! B #00018191' TO DFHEIV0
 20520     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20522     MOVE X'4220233030303138313931' TO DFHEIV0(25:11)
 20523     CALL 'kxdfhei1' USING DFHEIV0
 20524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20525
 20526
 20527
 20528* EXEC CICS WRITE
 20529*         DATASET('DLYACTV')
 20530*         RIDFLD(DA-KEY)
 20531*         FROM(DAILY-ACTIVITY-RECORD)
 20532*         LENGTH(25)
 20533*    END-EXEC.
 20534     MOVE 'DLYACTV' TO DFHEIV1
 20535     MOVE 25
 20536       TO DFHEIV11
 20537*    MOVE '&$ L                  ''   #00018196' TO DFHEIV0
 20538     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20539     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20540     MOVE X'2020233030303138313936' TO DFHEIV0(25:11)
 20541     CALL 'kxdfhei1' USING DFHEIV0,
 20542           DFHEIV1,
 20543           DAILY-ACTIVITY-RECORD,
 20544           DFHEIV11,
 20545           DA-KEY,
 20546           DFHEIV99,
 20547           DFHEIV99
 20548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20549
 20550     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20551     GO TO 9870-EXIT.
 20552
 20553 9870-NOTOPEN.
 20554
 20555     MOVE '2955'                 TO EMI-ERROR.
 20556     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20557
 20558 9870-EXIT.
 20559     EXIT.
 20560
 20561 9900-ERROR-FORMAT.
 20562
 20563     IF EMI-ERROR = ER-0923
 20564         MOVE PGM-NAME           TO W-CALLED-NAME.
 20565
 20566     MOVE LINK-001      TO PGM-NAME.
 20567     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20568
 20569
 20570* EXEC CICS LINK
 20571*        PROGRAM (PGM-NAME)
 20572*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 398
* EL156.cbl
 20573*        LENGTH  (EMI-COMM-LENGTH)
 20574*    END-EXEC.
 20575*    MOVE '."C                   (   #00018221' TO DFHEIV0
 20576     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20577     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20578     MOVE X'2020233030303138323231' TO DFHEIV0(25:11)
 20579     CALL 'kxdfhei1' USING DFHEIV0,
 20580           PGM-NAME,
 20581           ERROR-MESSAGE-INTERFACE-BLOCK,
 20582           EMI-COMM-LENGTH,
 20583           DFHEIV99,
 20584           DFHEIV99,
 20585           DFHEIV99,
 20586           DFHEIV99
 20587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20588
 20589
 20590     IF EMI-ERROR = ER-0923
 20591         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20592
 20593 9900-EXIT.
 20594     EXIT.
 20595
 20596 9990-ABEND.
 20597     MOVE LINK-004               TO PGM-NAME.
 20598     MOVE DFHEIBLK               TO EMI-LINE1.
 20599
 20600* EXEC CICS LINK
 20601*        PROGRAM   (PGM-NAME)
 20602*        COMMAREA  (EMI-LINE1)
 20603*        LENGTH    (64)
 20604*    END-EXEC.
 20605     MOVE 64
 20606       TO DFHEIV11
 20607*    MOVE '."C                   (   #00018236' TO DFHEIV0
 20608     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20609     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20610     MOVE X'2020233030303138323336' TO DFHEIV0(25:11)
 20611     CALL 'kxdfhei1' USING DFHEIV0,
 20612           PGM-NAME,
 20613           EMI-LINE1,
 20614           DFHEIV11,
 20615           DFHEIV99,
 20616           DFHEIV99,
 20617           DFHEIV99,
 20618           DFHEIV99
 20619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20620
 20621
 20622     MOVE 'EL156A'               TO  MAP-NAME.
 20623     MOVE LOW-VALUES             TO  EL156AO.
 20624     GO TO 8100-SEND-INITIAL-MAP.
 20625
 20626 9995-SECURITY-VIOLATION.
 20627*    COPY ELCSCTP.
 20628******************************************************************
 20629*                                                                *
 20630*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 399
* EL156.cbl
 20631*                            VMOD=2.001                          *
 20632*                                                                *
 20633*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20634******************************************************************
 20635
 20636
 20637     MOVE EIBDATE          TO SM-JUL-DATE.
 20638     MOVE EIBTRMID         TO SM-TERMID.
 20639     MOVE THIS-PGM         TO SM-PGM.
 20640     MOVE EIBTIME          TO TIME-IN.
 20641     MOVE TIME-OUT         TO SM-TIME.
 20642     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20643
 20644
 20645* EXEC CICS LINK
 20646*         PROGRAM  ('EL003')
 20647*         COMMAREA (SECURITY-MESSAGE)
 20648*         LENGTH   (80)
 20649*    END-EXEC.
 20650     MOVE 'EL003' TO DFHEIV1
 20651     MOVE 80
 20652       TO DFHEIV11
 20653*    MOVE '."C                   (   #00018264' TO DFHEIV0
 20654     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20655     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20656     MOVE X'2020233030303138323634' TO DFHEIV0(25:11)
 20657     CALL 'kxdfhei1' USING DFHEIV0,
 20658           DFHEIV1,
 20659           SECURITY-MESSAGE,
 20660           DFHEIV11,
 20661           DFHEIV99,
 20662           DFHEIV99,
 20663           DFHEIV99,
 20664           DFHEIV99
 20665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20666
 20667
 20668******************************************************************
 20669
 20670
 20671
 20672 9999-DFHBACK SECTION.
 20673     MOVE '9%                    "   ' TO DFHEIV0
 20674     MOVE 'EL156' TO DFHEIV1
 20675     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20676     GOBACK.
 20677 9999-DFHEXIT.
 20678     IF DFHEIGDJ EQUAL 0001
 20679         NEXT SENTENCE
 20680     ELSE IF DFHEIGDJ EQUAL 2
 20681         GO TO 9990-ABEND,
 20682               8600-PGRM-NOT-FOUND,
 20683               0400-FIRST-TIME,
 20684               6180-DUPREC,
 20685               9990-ABEND
 20686         DEPENDING ON DFHEIGDI
 20687     ELSE IF DFHEIGDJ EQUAL 3
 20688         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 400
* EL156.cbl
 20689               0380-CLAIM-END-FILE
 20690         DEPENDING ON DFHEIGDI
 20691     ELSE IF DFHEIGDJ EQUAL 4
 20692         GO TO 0380-CLAIM-END-FILE,
 20693               0380-CLAIM-END-FILE
 20694         DEPENDING ON DFHEIGDI
 20695     ELSE IF DFHEIGDJ EQUAL 5
 20696         GO TO 0800-EXIT
 20697         DEPENDING ON DFHEIGDI
 20698     ELSE IF DFHEIGDJ EQUAL 6
 20699         GO TO 1950-NOT-FOUND,
 20700               1950-NOT-FOUND
 20701         DEPENDING ON DFHEIGDI
 20702     ELSE IF DFHEIGDJ EQUAL 7
 20703         GO TO 1950-NOT-FOUND
 20704         DEPENDING ON DFHEIGDI
 20705     ELSE IF DFHEIGDJ EQUAL 8
 20706         GO TO 1950-NOT-FOUND,
 20707               1950-NOT-FOUND
 20708         DEPENDING ON DFHEIGDI
 20709     ELSE IF DFHEIGDJ EQUAL 9
 20710         GO TO 1166-END-CHECK,
 20711               1166-END-CHECK
 20712         DEPENDING ON DFHEIGDI
 20713     ELSE IF DFHEIGDJ EQUAL 10
 20714         GO TO 1950-NOT-FOUND,
 20715               1950-NOT-FOUND
 20716         DEPENDING ON DFHEIGDI
 20717     ELSE IF DFHEIGDJ EQUAL 11
 20718         GO TO 1950-NOT-FOUND,
 20719               1950-NOT-FOUND
 20720         DEPENDING ON DFHEIGDI
 20721     ELSE IF DFHEIGDJ EQUAL 12
 20722         GO TO 1950-NOT-FOUND
 20723         DEPENDING ON DFHEIGDI
 20724     ELSE IF DFHEIGDJ EQUAL 13
 20725         GO TO 3600-CONTINUE
 20726         DEPENDING ON DFHEIGDI
 20727     ELSE IF DFHEIGDJ EQUAL 14
 20728         GO TO 5300-NOTE-NOT-FOUND
 20729         DEPENDING ON DFHEIGDI
 20730     ELSE IF DFHEIGDJ EQUAL 15
 20731         GO TO 6065-NOT-FOUND
 20732         DEPENDING ON DFHEIGDI
 20733     ELSE IF DFHEIGDJ EQUAL 16
 20734         GO TO 6068-ACCT-NOT-FND
 20735         DEPENDING ON DFHEIGDI
 20736     ELSE IF DFHEIGDJ EQUAL 17
 20737         GO TO 6074-GET-COMP-DATA
 20738         DEPENDING ON DFHEIGDI
 20739     ELSE IF DFHEIGDJ EQUAL 18
 20740         GO TO 6170-WRITE
 20741         DEPENDING ON DFHEIGDI
 20742     ELSE IF DFHEIGDJ EQUAL 19
 20743         GO TO 6180-DUPREC
 20744         DEPENDING ON DFHEIGDI
 20745     ELSE IF DFHEIGDJ EQUAL 20
 20746         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 09-Apr-19 09:11 Page 401
* EL156.cbl
 20747         DEPENDING ON DFHEIGDI
 20748     ELSE IF DFHEIGDJ EQUAL 21
 20749         GO TO 6185-DUPREC
 20750         DEPENDING ON DFHEIGDI
 20751     ELSE IF DFHEIGDJ EQUAL 22
 20752         GO TO 6720-BUILD-NEW-RECORD
 20753         DEPENDING ON DFHEIGDI
 20754     ELSE IF DFHEIGDJ EQUAL 23
 20755         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20756               6900-BUILD-ARCHIVE-HEADER
 20757         DEPENDING ON DFHEIGDI
 20758     ELSE IF DFHEIGDJ EQUAL 24
 20759         GO TO 7010-BUILD-MAP
 20760         DEPENDING ON DFHEIGDI
 20761     ELSE IF DFHEIGDJ EQUAL 25
 20762         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20763         DEPENDING ON DFHEIGDI
 20764     ELSE IF DFHEIGDJ EQUAL 26
 20765         GO TO 7160-DUPREC
 20766         DEPENDING ON DFHEIGDI
 20767     ELSE IF DFHEIGDJ EQUAL 27
 20768         GO TO 7200-EXIT,
 20769               7200-EXIT
 20770         DEPENDING ON DFHEIGDI
 20771     ELSE IF DFHEIGDJ EQUAL 28
 20772         GO TO 7400-NOT-FOUND
 20773         DEPENDING ON DFHEIGDI
 20774     ELSE IF DFHEIGDJ EQUAL 29
 20775         GO TO 7590-END,
 20776               7590-END
 20777         DEPENDING ON DFHEIGDI
 20778     ELSE IF DFHEIGDJ EQUAL 30
 20779         GO TO 7699-EXIT
 20780         DEPENDING ON DFHEIGDI
 20781     ELSE IF DFHEIGDJ EQUAL 31
 20782         GO TO 5300-NOTE-NOT-FOUND
 20783         DEPENDING ON DFHEIGDI
 20784     ELSE IF DFHEIGDJ EQUAL 32
 20785         GO TO 7800-COMP-NOTFND
 20786         DEPENDING ON DFHEIGDI
 20787     ELSE IF DFHEIGDJ EQUAL 33
 20788         GO TO 7920-NOT-FOUND
 20789         DEPENDING ON DFHEIGDI
 20790     ELSE IF DFHEIGDJ EQUAL 34
 20791         GO TO 9870-NOTOPEN,
 20792               9870-EXIT
 20793         DEPENDING ON DFHEIGDI.
 20794     MOVE '9%                    "   ' TO DFHEIV0
 20795     MOVE 'EL156' TO DFHEIV1
 20796     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20797     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12812     Code:       77697
