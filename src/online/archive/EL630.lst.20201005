* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   1
* EL630.cbl
* Options: int("EL630.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL630.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL630.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL630.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL630.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/19/94 08:59:00.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.046.
     9
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   2
* EL630.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION - EXA5 - NEW BUSINESS - DATA ENTRY.
    25*
    26******************************************************************
    27*                   C H A N G E   L O G
    28*
    29* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    30*-----------------------------------------------------------------
    31*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    32* EFFECTIVE    NUMBER
    33*-----------------------------------------------------------------
    34* 103001    2001100100006  SMVA  CHECK FOR ? MARKS ANYWHERE IN
    35*                              BATCH NUMBER
    36* 072308  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
    37* 111109  CR2008100900003  AJRA  ADD NEW CERT NOTE TABLE
    38* 030310  CR2009031200002  PEMA  OPEN LOAN OFFICER ON 6301
    39* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    40* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    41******************************************************************
    42
    43 ENVIRONMENT DIVISION.
    44
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   3
* EL630.cbl
    46 DATA DIVISION.
    47 WORKING-STORAGE SECTION.
    48 01  DFH-START PIC X(04).
    49
    50 77  FILLER  PIC X(32)  VALUE '********************************'.
    51 77  FILLER  PIC X(32)  VALUE '*    EL630 WORKING STORAGE     *'.
    52 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    53
    54*    COPY ELCSCTM.
    55******************************************************************
    56*                                                                *
    57*                                                                *
    58*                            ELCSCTM                             *
    59*                            VMOD=2.001                          *
    60*                                                                *
    61*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    62*                                                                *
    63******************************************************************
    64 01  SECURITY-MESSAGE.
    65     12  FILLER                          PIC X(30)
    66            VALUE '** LOGIC SECURITY VIOLATION -'.
    67     12  SM-READ                         PIC X(6).
    68     12  FILLER                          PIC X(5)
    69            VALUE ' PGM='.
    70     12  SM-PGM                          PIC X(6).
    71     12  FILLER                          PIC X(5)
    72            VALUE ' OPR='.
    73     12  SM-PROCESSOR-ID                 PIC X(4).
    74     12  FILLER                          PIC X(6)
    75            VALUE ' TERM='.
    76     12  SM-TERMID                       PIC X(4).
    77     12  FILLER                          PIC XX   VALUE SPACE.
    78     12  SM-JUL-DATE                     PIC 9(5).
    79     12  FILLER                          PIC X    VALUE SPACE.
    80     12  SM-TIME                         PIC 99.99.
    81
    82*    COPY ELCSCRTY.
    83******************************************************************
    84*                                                                *
    85*                                                                *
    86*                            ELCSCRTY                            *
    87*                            VMOD=2.001                          *
    88*                                                                *
    89*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    90*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    91*        SAVED IN PI-SECURITY-ADDRESS.                           *
    92*                                                                *
    93******************************************************************
    94 01  SECURITY-CONTROL.
    95     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    96     12  FILLER                       PIC XX    VALUE 'SC'.
    97     12  SC-CREDIT-CODES.
    98         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    99             20  SC-CREDIT-DISPLAY    PIC X.
   100             20  SC-CREDIT-UPDATE     PIC X.
   101     12  SC-CLAIMS-CODES.
   102         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   103             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   4
* EL630.cbl
   104             20  SC-CLAIMS-UPDATE     PIC X.
   105
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   5
* EL630.cbl
   107
   108 01  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1900.
   109 01  STANDARD-AREAS.
   110     12  SC-ITEM                 PIC S9(4) COMP VALUE +1.
   111     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   112     12  MAP-NAME                PIC X(8)    VALUE 'EL630A'.
   113     12  MAPSET-NAME             PIC X(8)    VALUE 'EL630S '.
   114     12  SCREEN-NUMBER           PIC X(4)    VALUE '630A'.
   115     12  TRANS-ID                PIC X(4)    VALUE 'EXA5'.
   116     12  EDIT-TRANS              PIC X(4)    VALUE 'EXEB'.
   117     12  PASS-AREA-LEN           PIC S9(4)   COMP VALUE +16.
   118     12  THIS-PGM                PIC X(8)    VALUE 'EL630'.
   119     12  PGM-NAME                PIC X(8)    VALUE SPACES.
   120     12  TIME-IN                 PIC S9(7)   VALUE ZEROS.
   121     12  TIME-OUT-R  REDEFINES TIME-IN.
   122         16  FILLER              PIC X.
   123         16  TIME-OUT            PIC 99V99.
   124         16  FILLER              PIC X(2).
   125     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   126     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   127     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   128     12  XCTL-6301               PIC X(8)    VALUE 'EL6301'.
   129     12  XCTL-6302               PIC X(8)    VALUE 'EL6302'.
   130     12  XCTL-633                PIC X(8)    VALUE 'EL633'.
   131     12  XCTL-633DMD             PIC X(8)    VALUE 'EL633DMD'.
   132     12  XCTL-635                PIC X(8)    VALUE 'EL635'.
   133     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   134     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   135     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   136     12  ELCNTL-FILE-ID          PIC X(8)    VALUE 'ELCNTL'.
   137     12  ERPNDB-FILE-ID          PIC X(8)    VALUE 'ERPNDB'.
   138     12  ERACCT-FILE-ID          PIC X(8)    VALUE 'ERACCT'.
   139     12  ERACCT2-FILE-ID         PIC X(8)    VALUE 'ERACCT2'.
   140     12  ELCERT-FILE-ID          PIC X(8)    VALUE 'ELCERT'.
   141     12  ERNOTE-FILE-ID          PIC X(8)    VALUE 'ERNOTE'.
   142     12  ERCNOT-FILE-ID          PIC X(8)    VALUE 'ERCNOT'.
   143     12  ERMAIL-FILE-ID          PIC X(8)    VALUE 'ERMAIL'.
   144     12  ERCOMP-FILE-ID          PIC X(8)    VALUE 'ERCOMP'.
   145     12  ERPNDM-FILE-ID          PIC X(8)    VALUE 'ERPNDM'.
   146     12  ERRQST-FILE-ID          PIC X(8)    VALUE 'ERRQST'.
   147     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   148     12  WS-CURRENT-DT           PIC X(8)    VALUE SPACES.
   149     12  WS-CURRENT-YMD          PIC 9(6)    VALUE ZEROS.
   150     12  WS-SYNC-CNTR            PIC S9(3)   VALUE +0 COMP-3.
   151     12  WS-SUB1                 PIC S9(4)   VALUE +0 COMP.
   152     12  WS-SUB2                 PIC S9(4)   VALUE +0 COMP.
   153     12  PIC6-SUB                PIC S9(04)  VALUE +0 COMP.
   154     12  WS-AR-REPORTING         PIC X       VALUE SPACE.
   155         88  AR-NET-REPORT               VALUE 'N'.
   156         88  AR-GROSS-REPORT             VALUE 'G'.
   157     12  WS-COMP-MASTER-ERROR-SW PIC X       VALUE SPACE.
   158         88  WS-COMP-MASTER-ERROR        VALUE 'Y'.
   159
   160     12  WS-UPDATE-REFERENCE-SW  PIC X       VALUE SPACE.
   161         88  WS-UPDATE-REFERENCE         VALUE 'Y'.
   162
   163     12  WS-SWITCH               PIC X(01)   VALUE SPACE.
   164         88  QUESTION-MARK-FOUND             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   6
* EL630.cbl
   165
   166     12  WS-RECORD-FOUND-SW      PIC X       VALUE SPACE.
   167         88  RECORD-FOUND                VALUE 'Y'.
   168         88  RECORD-NOT-FOUND            VALUE 'N'.
   169
   170     12  WS-ON1-SW1              PIC X(01)   VALUE 'Y'.
   171     12  WS-ON1-SW2              PIC X(01)   VALUE 'Y'.
   172     12  WS-ON1-SW3              PIC X(01)   VALUE 'Y'.
   173     12  WS-ON1-SW4              PIC X(01)   VALUE 'Y'.
   174     12  WS-ON1-SW5              PIC X(01)   VALUE 'Y'.
   175     12  WS-ON1-SW6              PIC X(01)   VALUE 'Y'.
   176     12  WS-ON1-SW7              PIC X(01)   VALUE 'Y'.
   177
   178     12  WS-ERPNDB-RECORD        PIC X(585)  VALUE SPACES.
   179
   180 01  BATCH-TO-PROCESS.
   181     05  EDIT-COMPANY-CD         PIC X       VALUE LOW-VALUES.
   182     05  EDIT-BATCH              PIC X(6)    VALUE SPACES.
   183     05  EDIT-COMPANY-ID         PIC XXX     VALUE SPACES.
   184     05  EDIT-RESTART-BATCH      PIC X(6)    VALUE SPACES.
   185
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   7
* EL630.cbl
   187 01  ERROR-MESSAGES.
   188     12  ER-0008                 PIC X(4)    VALUE '0008'.
   189     12  ER-0023                 PIC X(4)    VALUE '0023'.
   190     12  ER-0029                 PIC X(4)    VALUE '0029'.
   191     12  ER-0070                 PIC X(4)    VALUE '0070'.
   192     12  ER-0194                 PIC X(4)    VALUE '0194'.
   193     12  ER-0195                 PIC X(4)    VALUE '0195'.
   194     12  ER-0196                 PIC X(4)    VALUE '0196'.
   195     12  ER-0197                 PIC X(4)    VALUE '0197'.
   196     12  ER-0340                 PIC X(4)    VALUE '0340'.
   197     12  ER-0587                 PIC X(4)    VALUE '0587'.
   198     12  ER-0905                 PIC X(4)    VALUE '0905'.
   199     12  ER-2119                 PIC X(4)    VALUE '2119'.
   200     12  ER-2126                 PIC X(4)    VALUE '2126'.
   201     12  ER-2132                 PIC X(4)    VALUE '2132'.
   202     12  ER-2201                 PIC X(4)    VALUE '2201'.
   203     12  ER-2208                 PIC X(4)    VALUE '2208'.
   204     12  ER-2209                 PIC X(4)    VALUE '2209'.
   205     12  ER-2210                 PIC X(4)    VALUE '2210'.
   206     12  ER-2211                 PIC X(4)    VALUE '2211'.
   207     12  ER-2212                 PIC X(4)    VALUE '2212'.
   208     12  ER-2213                 PIC X(4)    VALUE '2213'.
   209     12  ER-2214                 PIC X(4)    VALUE '2214'.
   210     12  ER-2215                 PIC X(4)    VALUE '2215'.
   211     12  ER-2216                 PIC X(4)    VALUE '2216'.
   212     12  ER-2229                 PIC X(4)    VALUE '2229'.
   213     12  ER-2242                 PIC X(4)    VALUE '2242'.
   214     12  ER-2248                 PIC X(4)    VALUE '2248'.
   215     12  ER-2370                 PIC X(4)    VALUE '2370'.
   216     12  ER-2371                 PIC X(4)    VALUE '2371'.
   217     12  ER-2402                 PIC X(4)    VALUE '2402'.
   218     12  ER-2422                 PIC X(4)    VALUE '2422'.
   219     12  ER-2800                 PIC X(4)    VALUE '2800'.
   220     12  ER-2880                 PIC X(4)    VALUE '2880'.
   221     12  ER-2990                 PIC X(4)    VALUE '2990'.
   222
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   8
* EL630.cbl
   224 01  ACCESS-KEYS.
   225     12  ELCNTL-KEY.
   226         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   227         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   228         16  CNTL-ACCESS.
   229             20  CNTL-STATE      PIC XX    VALUE SPACES.
   230             20  FILLER          PIC X     VALUE SPACES.
   231             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   232         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   233
   234     12  ERPNDB-KEY.
   235         16  PNDB-COMP-CD        PIC X     VALUE SPACE.
   236         16  PNDB-ENTRY-BATCH    PIC X(6)  VALUE SPACES.
   237         16  PNDB-BATCH-SEQ      PIC S9(4) VALUE +0 COMP.
   238         16  PNDB-BATCH-CHG-SEQ  PIC S9(4) VALUE +0 COMP.
   239
   240     12  ERACCT-KEY.
   241         16  ERACCT-COMP-KEY.
   242             20  ACCT-CO         PIC X     VALUE SPACES.
   243             20  ACCT-CARRIER    PIC X     VALUE SPACES.
   244             20  ACCT-GROUPING   PIC X(6)  VALUE SPACES.
   245             20  ACCT-STATE      PIC XX    VALUE SPACES.
   246             20  ACCT-ACCOUNT    PIC X(10) VALUE SPACES.
   247         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   248         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   249     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   250
   251     12  ELCERT-KEY.
   252         16  CERT-COMPANY-CD     PIC X     VALUE SPACES.
   253         16  CERT-CARRIER        PIC X     VALUE SPACES.
   254         16  CERT-GROUPING       PIC X(6)  VALUE SPACES.
   255         16  CERT-STATE          PIC XX    VALUE SPACES.
   256         16  FILLER              PIC X(23) VALUE SPACES.
   257
   258     12  ERCOMP-KEY.
   259         16  ERCOMP-COMP-CD      PIC X     VALUE SPACE.
   260         16  ERCOMP-CARRIER      PIC X     VALUE SPACES.
   261         16  ERCOMP-GROUPING     PIC X(6)  VALUE SPACES.
   262         16  ERCOMP-FIN-RESP     PIC X(10) VALUE SPACES.
   263         16  ERCOMP-ACCT         PIC X(10) VALUE SPACES.
   264         16  ERCOMP-RECORD-TYPE  PIC X     VALUE SPACES.
   265
   266     12  ERRQST-KEY.
   267         16  ERRQST-COMP-CD      PIC X     VALUE SPACE.
   268         16  ERRQST-ENTRY-BATCH  PIC X(6)  VALUE SPACES.
   269
   270     12  ERCNOT-KEY.
   271         16  ERCNOT-PART-KEY.
   272             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   273             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   274             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   275             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   276             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   277             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   278             20  ERCNOT-CERT-NO.
   279                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   280                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   281         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   9
* EL630.cbl
   282         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   283
   284
   285 01  FILLER.
   286     12  WS-DEEDIT-FIELD         PIC S9(8)V99 VALUE ZEROS.
   287     12  WS-DT-DEEDIT-FIELD REDEFINES
   288         WS-DEEDIT-FIELD         PIC X(10).
   289     12  WS-DEEDIT-FIELD-DATE  REDEFINES  WS-DEEDIT-FIELD.
   290         16   FILLER                           PIC X(04).
   291         16   WS-DEEDIT-FIELD-DATE-OUT         PIC X(06).
   292     12  QUESTION-MARKS          PIC X(6)      VALUE '??????'.
   293     12  QUESTION-MARK           PIC X(01)     VALUE '?'.
   294     12  WS-BATCH-NO             PIC 9(6)      VALUE ZEROS.
   295     12  WS-OBAL                 PIC S9(8)V99  VALUE ZEROS.
   296     12  WS-OCNT                 PIC S9(5)     VALUE ZEROS.
   297     12  WS-DELETE-CNT           PIC S9(5)     VALUE ZEROS.
   298     12  WS-PF1-SW               PIC X         VALUE SPACES.
   299         88  WS-PF1                            VALUE 'Y'.
   300
   301     12  WS-SAV-PNDB-KEY.
   302         16  WS-SAV-COMP-CD        PIC X       VALUE LOW-VALUES.
   303         16  WS-SAV-ENTRY-BATCH    PIC X(6)       VALUE SPACES.
   304         16  WS-SAV-BATCH-SEQ      PIC S9(4) COMP VALUE ZEROS.
   305         16  WS-SAV-BATCH-CHG-SEQ  PIC S9(4) COMP VALUE ZEROS.
   306
   307     12  DATE-TEST-AREA          PIC 9(6)         VALUE ZEROS.
   308     12  DATE-TEST-AREA-R  REDEFINES DATE-TEST-AREA.
   309         16  DATE-TEST-MM        PIC 99.
   310         16  DATE-TEST-DD        PIC 99.
   311         16  DATE-TEST-YY        PIC 99.
   312     12  DIVIDE-RESULT           PIC 99           VALUE ZEROS.
   313     12  DIVIDE-REMAINDER        PIC 9            VALUE 0.
   314     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   315         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   316     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   317         88 CERT-ADDRESS-PRESENT     VALUE 'Y'.
   318     12  WS-PRM-HEADER.
   319         16  WS-PRM-OVERRIDE     PIC XX           VALUE SPACES.
   320         16  FILLER              PIC X(8)  VALUE '-PREMIUM'.
   321     12  WS-REFUND-HEADER.
   322         16  WS-REFUND-OVERRIDE  PIC XX    VALUE SPACES.
   323         16  FILLER              PIC X(7)  VALUE '-REFUND'.
   324
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  10
* EL630.cbl
   326
   327*    COPY ELCDATE.
   328******************************************************************
   329*                                                                *
   330*                                                                *
   331*                            ELCDATE.                            *
   332*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   333*                            VMOD=2.003
   334*                                                                *
   335*                                                                *
   336*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   337*                 LENGTH = 200                                   *
   338******************************************************************
   339
   340 01  DATE-CONVERSION-DATA.
   341     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   342     12  DC-OPTION-CODE                PIC X.
   343         88  BIN-TO-GREG                VALUE ' '.
   344         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   345         88  EDIT-GREG-TO-BIN           VALUE '2'.
   346         88  YMD-GREG-TO-BIN            VALUE '3'.
   347         88  MDY-GREG-TO-BIN            VALUE '4'.
   348         88  JULIAN-TO-BIN              VALUE '5'.
   349         88  BIN-PLUS-ELAPSED           VALUE '6'.
   350         88  FIND-CENTURY               VALUE '7'.
   351         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   352         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   353         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   354         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   355         88  JULIAN-TO-BIN-3            VALUE 'C'.
   356         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   357         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   358         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   359         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   360         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   361         88  CHECK-LEAP-YEAR            VALUE 'H'.
   362         88  BIN-3-TO-GREG              VALUE 'I'.
   363         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   364         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   365         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   366         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   367         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   368         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   369         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   370         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   371         88  THREE-CHARACTER-BIN
   372                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   373         88  GREGORIAN-TO-BIN
   374                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   375         88  BIN-TO-GREGORIAN
   376                  VALUES ' ' '1' 'I' '8' 'G'.
   377         88  JULIAN-TO-BINARY
   378                  VALUES '5' 'C' 'E' 'F'.
   379     12  DC-ERROR-CODE                 PIC X.
   380         88  NO-CONVERSION-ERROR        VALUE ' '.
   381         88  DATE-CONVERSION-ERROR
   382                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   383         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  11
* EL630.cbl
   384         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   385         88  DATE-IS-INVALID            VALUE '3'.
   386         88  DATE1-GREATER-DATE2        VALUE '4'.
   387         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   388         88  DATE-INVALID-OPTION        VALUE '9'.
   389         88  INVALID-CENTURY            VALUE 'A'.
   390         88  ONLY-CENTURY               VALUE 'B'.
   391         88  ONLY-LEAP-YEAR             VALUE 'C'.
   392         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   393     12  DC-END-OF-MONTH               PIC X.
   394         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   395     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   396         88  USE-NORMAL-PROCESS         VALUE ' '.
   397         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   398         88  ADJUST-UP-100-YRS          VALUE '2'.
   399     12  FILLER                        PIC X.
   400     12  DC-CONVERSION-DATES.
   401         16  DC-BIN-DATE-1             PIC XX.
   402         16  DC-BIN-DATE-2             PIC XX.
   403         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   404         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   405                       DC-GREG-DATE-1-EDIT.
   406             20  DC-EDIT1-MONTH        PIC 99.
   407             20  SLASH1-1              PIC X.
   408             20  DC-EDIT1-DAY          PIC 99.
   409             20  SLASH1-2              PIC X.
   410             20  DC-EDIT1-YEAR         PIC 99.
   411         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   412         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   413                     DC-GREG-DATE-2-EDIT.
   414             20  DC-EDIT2-MONTH        PIC 99.
   415             20  SLASH2-1              PIC X.
   416             20  DC-EDIT2-DAY          PIC 99.
   417             20  SLASH2-2              PIC X.
   418             20  DC-EDIT2-YEAR         PIC 99.
   419         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   420         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   421                     DC-GREG-DATE-1-YMD.
   422             20  DC-YMD-YEAR           PIC 99.
   423             20  DC-YMD-MONTH          PIC 99.
   424             20  DC-YMD-DAY            PIC 99.
   425         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   426         16  DC-GREG-DATE-1-MDY-R REDEFINES
   427                      DC-GREG-DATE-1-MDY.
   428             20  DC-MDY-MONTH          PIC 99.
   429             20  DC-MDY-DAY            PIC 99.
   430             20  DC-MDY-YEAR           PIC 99.
   431         16  DC-GREG-DATE-1-ALPHA.
   432             20  DC-ALPHA-MONTH        PIC X(10).
   433             20  DC-ALPHA-DAY          PIC 99.
   434             20  FILLER                PIC XX.
   435             20  DC-ALPHA-CENTURY.
   436                 24 DC-ALPHA-CEN-N     PIC 99.
   437             20  DC-ALPHA-YEAR         PIC 99.
   438         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   439         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   440         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   441         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  12
* EL630.cbl
   442         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   443                                       PIC 9(05).
   444         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   445             20  DC-JULIAN-YEAR        PIC 99.
   446             20  DC-JULIAN-DAYS        PIC 999.
   447         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   448         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   449         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   450     12  DATE-CONVERSION-VARIBLES.
   451         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   452         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   453             20  FILLER                PIC 9(3).
   454             20  HOLD-CEN-1-CCYY.
   455                 24  HOLD-CEN-1-CC     PIC 99.
   456                 24  HOLD-CEN-1-YY     PIC 99.
   457             20  HOLD-CEN-1-MO         PIC 99.
   458             20  HOLD-CEN-1-DA         PIC 99.
   459         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   460             20  HOLD-CEN-1-R-MO       PIC 99.
   461             20  HOLD-CEN-1-R-DA       PIC 99.
   462             20  HOLD-CEN-1-R-CCYY.
   463                 24  HOLD-CEN-1-R-CC   PIC 99.
   464                 24  HOLD-CEN-1-R-YY   PIC 99.
   465             20  FILLER                PIC 9(3).
   466         16  HOLD-CENTURY-1-X.
   467             20  FILLER                PIC X(3)  VALUE SPACES.
   468             20  HOLD-CEN-1-X-CCYY.
   469                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   470                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   471             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   472             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   473         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   474             20  HOLD-CEN-1-R-X-MO     PIC XX.
   475             20  HOLD-CEN-1-R-X-DA     PIC XX.
   476             20  HOLD-CEN-1-R-X-CCYY.
   477                 24  HOLD-CEN-1-R-X-CC PIC XX.
   478                 24  HOLD-CEN-1-R-X-YY PIC XX.
   479             20  FILLER                PIC XXX.
   480         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   481         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   482         16  DC-JULIAN-DATE-1          PIC 9(07).
   483         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   484             20  DC-JULIAN-1-CCYY.
   485                 24  DC-JULIAN-1-CC    PIC 99.
   486                 24  DC-JULIAN-1-YR    PIC 99.
   487             20  DC-JULIAN-DA-1        PIC 999.
   488         16  DC-JULIAN-DATE-2          PIC 9(07).
   489         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   490             20  DC-JULIAN-2-CCYY.
   491                 24  DC-JULIAN-2-CC    PIC 99.
   492                 24  DC-JULIAN-2-YR    PIC 99.
   493             20  DC-JULIAN-DA-2        PIC 999.
   494         16  DC-GREG-DATE-A-EDIT.
   495             20  DC-EDITA-MONTH        PIC 99.
   496             20  SLASHA-1              PIC X VALUE '/'.
   497             20  DC-EDITA-DAY          PIC 99.
   498             20  SLASHA-2              PIC X VALUE '/'.
   499             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  13
* EL630.cbl
   500                 24  DC-EDITA-CENT     PIC 99.
   501                 24  DC-EDITA-YEAR     PIC 99.
   502         16  DC-GREG-DATE-B-EDIT.
   503             20  DC-EDITB-MONTH        PIC 99.
   504             20  SLASHB-1              PIC X VALUE '/'.
   505             20  DC-EDITB-DAY          PIC 99.
   506             20  SLASHB-2              PIC X VALUE '/'.
   507             20  DC-EDITB-CCYY.
   508                 24  DC-EDITB-CENT     PIC 99.
   509                 24  DC-EDITB-YEAR     PIC 99.
   510         16  DC-GREG-DATE-CYMD         PIC 9(08).
   511         16  DC-GREG-DATE-CYMD-R REDEFINES
   512                              DC-GREG-DATE-CYMD.
   513             20  DC-CYMD-CEN           PIC 99.
   514             20  DC-CYMD-YEAR          PIC 99.
   515             20  DC-CYMD-MONTH         PIC 99.
   516             20  DC-CYMD-DAY           PIC 99.
   517         16  DC-GREG-DATE-MDCY         PIC 9(08).
   518         16  DC-GREG-DATE-MDCY-R REDEFINES
   519                              DC-GREG-DATE-MDCY.
   520             20  DC-MDCY-MONTH         PIC 99.
   521             20  DC-MDCY-DAY           PIC 99.
   522             20  DC-MDCY-CEN           PIC 99.
   523             20  DC-MDCY-YEAR          PIC 99.
   524    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   525        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   526    12  DC-EL310-DATE                  PIC X(21).
   527    12  FILLER                         PIC X(28).
   528
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  14
* EL630.cbl
   530*    COPY ELCLOGOF.
   531******************************************************************
   532*                                                                *
   533*                                                                *
   534*                            ELCLOGOF.                           *
   535*                            VMOD=2.001                          *
   536*                                                                *
   537*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   538*                                                                *
   539******************************************************************
   540 01  CLASIC-LOGOFF.
   541     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   542     12  LOGOFF-TEXT.
   543         16  FILLER          PIC X(5)    VALUE SPACES.
   544         16  LOGOFF-MSG.
   545             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   546             20  FILLER      PIC X       VALUE SPACES.
   547             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   548         16  FILLER          PIC X(80)
   549           VALUE '* YOU ARE NOW LOGGED OFF'.
   550         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   551         16  FILLER          PIC X       VALUE QUOTE.
   552         16  LOGOFF-SYS-MSG  PIC X(17)
   553           VALUE 'S CLAS-IC SYSTEM '.
   554     12  TEXT-MESSAGES.
   555         16  UNACCESS-MSG    PIC X(29)
   556             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   557         16  PGMIDERR-MSG    PIC X(17)
   558             VALUE 'PROGRAM NOT FOUND'.
   559
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  15
* EL630.cbl
   561*    COPY ELCATTR.
   562******************************************************************
   563*                                                                *
   564*                            ELCATTR.                            *
   565*                            VMOD=2.001                          *
   566*                                                                *
   567*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   568*                                                                *
   569*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   570*                                                                *
   571*                   POS 1   P=PROTECTED                          *
   572*                           U=UNPROTECTED                        *
   573*                           S=ASKIP                              *
   574*                   POS 2   A=ALPHA/NUMERIC                      *
   575*                           N=NUMERIC                            *
   576*                   POS 3   N=NORMAL                             *
   577*                           B=BRIGHT                             *
   578*                           D=DARK                               *
   579*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   580*                           OF=MODIFIED DATA TAG OFF             *
   581*                                                                *
   582*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   583******************************************************************
   584 01  ATTRIBUTE-LIST.
   585     12  AL-PABOF            PIC X       VALUE 'Y'.
   586     12  AL-PABON            PIC X       VALUE 'Z'.
   587     12  AL-PADOF            PIC X       VALUE '%'.
   588     12  AL-PADON            PIC X       VALUE '_'.
   589     12  AL-PANOF            PIC X       VALUE '-'.
   590     12  AL-PANON            PIC X       VALUE '/'.
   591     12  AL-SABOF            PIC X       VALUE '8'.
   592     12  AL-SABON            PIC X       VALUE '9'.
   593     12  AL-SADOF            PIC X       VALUE '@'.
   594     12  AL-SADON            PIC X       VALUE QUOTE.
   595     12  AL-SANOF            PIC X       VALUE '0'.
   596     12  AL-SANON            PIC X       VALUE '1'.
   597     12  AL-UABOF            PIC X       VALUE 'H'.
   598     12  AL-UABON            PIC X       VALUE 'I'.
   599     12  AL-UADOF            PIC X       VALUE '<'.
   600     12  AL-UADON            PIC X       VALUE '('.
   601     12  AL-UANOF            PIC X       VALUE ' '.
   602     12  AL-UANON            PIC X       VALUE 'A'.
   603     12  AL-UNBOF            PIC X       VALUE 'Q'.
   604     12  AL-UNBON            PIC X       VALUE 'R'.
   605     12  AL-UNDOF            PIC X       VALUE '*'.
   606     12  AL-UNDON            PIC X       VALUE ')'.
   607     12  AL-UNNOF            PIC X       VALUE '&'.
   608     12  AL-UNNON            PIC X       VALUE 'J'.
   609
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  16
* EL630.cbl
   611*    COPY ELCEMIB.
   612******************************************************************
   613*                                                                *
   614*                                                                *
   615*                            ELCEMIB.                            *
   616*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   617*                            VMOD=2.005                          *
   618*                                                                *
   619*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   620*                                                                *
   621******************************************************************
   622 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   623     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   624     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   625     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   626     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   627     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   628     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   629     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   630     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   631     12  EMI-SWITCH1             PIC X        VALUE '1'.
   632         88  EMI-NO-ERRORS                    VALUE '1'.
   633         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   634         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   635     12  EMI-SWITCH2             PIC X        VALUE '1'.
   636         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   637     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   638         88  EMI-AREA1-EMPTY                  VALUE '1'.
   639         88  EMI-AREA1-FULL                   VALUE '2'.
   640     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   641         88  EMI-AREA2-EMPTY                  VALUE '1'.
   642         88  EMI-AREA2-FULL                   VALUE '2'.
   643     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   644         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   645         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   646         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   647         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   648         88  EMI-BYPASS-FATALS                VALUE 'X'.
   649     12  EMI-ERROR-LINES.
   650         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   651         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   652         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   653         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   654             20  EMI-ERR-CODES OCCURS 10 TIMES.
   655                 24  EMI-ERR-NUM         PIC X(4).
   656                 24  EMI-FILLER          PIC X.
   657                 24  EMI-SEV             PIC X.
   658                 24  FILLER              PIC X.
   659             20  FILLER                  PIC X(02).
   660     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   661         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   662             20  EMI-ERROR-NUMBER    PIC X(4).
   663             20  EMI-FILL            PIC X.
   664             20  EMI-SEVERITY        PIC X.
   665             20  FILLER              PIC X.
   666             20  EMI-ERROR-TEXT.
   667                 24  EMI-TEXT-VARIABLE   PIC X(10).
   668                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  17
* EL630.cbl
   669     12  EMI-SEVERITY-SAVE           PIC X.
   670         88  EMI-NOTE                    VALUE 'N'.
   671         88  EMI-WARNING                 VALUE 'W'.
   672         88  EMI-FORCABLE                VALUE 'F'.
   673         88  EMI-FATAL                   VALUE 'X'.
   674     12  EMI-MESSAGE-FLAG            PIC X.
   675         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   676         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   677     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   678     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   679         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   680         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   681         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   682     12  emi-claim-no                pic x(7).
   683     12  emi-claim-type              pic x(6).
   684     12  FILLER                      PIC X(124)  VALUE SPACES.
   685     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   686     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   687     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   688     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   689
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  18
* EL630.cbl
   691*    COPY ELCINTF.
   692******************************************************************
   693*                                                                *
   694*                                                                *
   695*                            ELCINTF.                            *
   696*                            VMOD=2.017                          *
   697*                                                                *
   698*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   699*                                                                *
   700*       LENGTH = 1024                                            *
   701*                                                                *
   702******************************************************************
   703*                   C H A N G E   L O G
   704*
   705* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   706*-----------------------------------------------------------------
   707*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   708* EFFECTIVE    NUMBER
   709*-----------------------------------------------------------------
   710* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   711******************************************************************
   712 01  PROGRAM-INTERFACE-BLOCK.
   713     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   714     12  PI-CALLING-PROGRAM              PIC X(8).
   715     12  PI-SAVED-PROGRAM-1              PIC X(8).
   716     12  PI-SAVED-PROGRAM-2              PIC X(8).
   717     12  PI-SAVED-PROGRAM-3              PIC X(8).
   718     12  PI-SAVED-PROGRAM-4              PIC X(8).
   719     12  PI-SAVED-PROGRAM-5              PIC X(8).
   720     12  PI-SAVED-PROGRAM-6              PIC X(8).
   721     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   722     12  PI-COMPANY-ID                   PIC XXX.
   723     12  PI-COMPANY-CD                   PIC X.
   724
   725     12  PI-COMPANY-PASSWORD             PIC X(8).
   726
   727     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   728
   729     12  PI-CONTROL-IN-PROGRESS.
   730         16  PI-CARRIER                  PIC X.
   731         16  PI-GROUPING                 PIC X(6).
   732         16  PI-STATE                    PIC XX.
   733         16  PI-ACCOUNT                  PIC X(10).
   734         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   735                                         PIC X(10).
   736         16  PI-CLAIM-CERT-GRP.
   737             20  PI-CLAIM-NO             PIC X(7).
   738             20  PI-CERT-NO.
   739                 25  PI-CERT-PRIME       PIC X(10).
   740                 25  PI-CERT-SFX         PIC X.
   741             20  PI-CERT-EFF-DT          PIC XX.
   742         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   743             20  PI-PLAN-CODE            PIC X(2).
   744             20  PI-REVISION-NUMBER      PIC X(3).
   745             20  PI-PLAN-EFF-DT          PIC X(2).
   746             20  PI-PLAN-EXP-DT          PIC X(2).
   747             20  FILLER                  PIC X(11).
   748         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  19
* EL630.cbl
   749             20  PI-OE-REFERENCE-1.
   750                 25  PI-OE-REF-1-PRIME   PIC X(18).
   751                 25  PI-OE-REF-1-SUFF    PIC XX.
   752
   753     12  PI-SESSION-IN-PROGRESS          PIC X.
   754         88  CLAIM-SESSION                   VALUE '1'.
   755         88  CREDIT-SESSION                  VALUE '2'.
   756         88  WARRANTY-SESSION                VALUE '3'.
   757         88  MORTGAGE-SESSION                VALUE '4'.
   758         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   759
   760
   761*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   762
   763     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   764     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   765
   766     12  PI-CREDIT-USER                  PIC X.
   767         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   768         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   769
   770     12  PI-CLAIM-USER                   PIC X.
   771         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   772         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   773
   774     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   775         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   776         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   777         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   778         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   779         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   780
   781     12  PI-PROCESSOR-ID                 PIC X(4).
   782
   783     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   784
   785     12  PI-MEMBER-CAPTION               PIC X(10).
   786
   787     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   788         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   789
   790     12  PI-LIFE-OVERRIDE-L1             PIC X.
   791     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   792     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   793     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   794
   795     12  PI-AH-OVERRIDE-L1               PIC X.
   796     12  PI-AH-OVERRIDE-L2               PIC XX.
   797     12  PI-AH-OVERRIDE-L6               PIC X(6).
   798     12  PI-AH-OVERRIDE-L12              PIC X(12).
   799
   800     12  PI-NEW-SYSTEM                   PIC X(2).
   801
   802     12  PI-PRIMARY-CERT-NO              PIC X(11).
   803     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   804         88  PI-USES-PAID-TO                 VALUE '1'.
   805     12  PI-CRDTCRD-SYSTEM.
   806         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  20
* EL630.cbl
   807             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   808             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   809         16  PI-CC-MONTH-END-DT          PIC XX.
   810     12  PI-PROCESSOR-PRINTER            PIC X(4).
   811
   812     12  PI-OE-REFERENCE-2.
   813         16  PI-OE-REF-2-PRIME           PIC X(10).
   814         16  PI-OE-REF-2-SUFF            PIC X.
   815
   816     12  PI-REM-TRM-CALC-OPTION          PIC X.
   817
   818     12  PI-LANGUAGE-TYPE                PIC X.
   819             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   820             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   821             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   822
   823     12  PI-POLICY-LINKAGE-IND           PIC X.
   824         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   825         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   826                                                   LOW-VALUES.
   827
   828     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   829     12  PI-CLAIM-PW-SESSION             PIC X(1).
   830         88  PI-CLAIM-CREDIT                 VALUE '1'.
   831         88  PI-CLAIM-CONVEN                 VALUE '2'.
   832
   833     12  PI-PROCESSOR-CSR-IND            PIC X.
   834         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   835         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   836
   837     12  FILLER                          PIC X(3).
   838
   839     12  PI-SYSTEM-LEVEL                 PIC X(145).
   840
   841     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   842         PI-SYSTEM-LEVEL.
   843
   844         16  PI-ENTRY-CODES.
   845             20  PI-ENTRY-CD-1           PIC X.
   846             20  PI-ENTRY-CD-2           PIC X.
   847
   848         16  PI-RETURN-CODES.
   849             20  PI-RETURN-CD-1          PIC X.
   850             20  PI-RETURN-CD-2          PIC X.
   851
   852         16  PI-UPDATE-STATUS-SAVE.
   853             20  PI-UPDATE-BY            PIC X(4).
   854             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   855
   856         16  PI-LOWER-CASE-LETTERS       PIC X.
   857             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   858
   859*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   860*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   861*            88  CARRIER-CLM-CNTL            VALUE '2'.
   862
   863         16  PI-CERT-ACCESS-CONTROL      PIC X.
   864             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  21
* EL630.cbl
   865             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   866             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   867             88  ACCNT-CNTL                  VALUE '3'.
   868             88  CARR-ACCNT-CNTL             VALUE '4'.
   869
   870         16  PI-PROCESSOR-CAP-LIST.
   871             20  PI-SYSTEM-CONTROLS.
   872                24 PI-SYSTEM-DISPLAY     PIC X.
   873                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   874                24 PI-SYSTEM-MODIFY      PIC X.
   875                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   876             20  FILLER                  PIC XX.
   877             20  PI-DISPLAY-CAP          PIC X.
   878                 88  DISPLAY-CAP             VALUE 'Y'.
   879             20  PI-MODIFY-CAP           PIC X.
   880                 88  MODIFY-CAP              VALUE 'Y'.
   881             20  PI-MSG-AT-LOGON-CAP     PIC X.
   882                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   883             20  PI-FORCE-CAP            PIC X.
   884                 88  FORCE-CAP               VALUE 'Y'.
   885
   886         16  PI-PROGRAM-CONTROLS.
   887             20  PI-PGM-PRINT-OPT        PIC X.
   888             20  PI-PGM-FORMAT-OPT       PIC X.
   889             20  PI-PGM-PROCESS-OPT      PIC X.
   890             20  PI-PGM-TOTALS-OPT       PIC X.
   891
   892         16  PI-HELP-INTERFACE.
   893             20  PI-LAST-ERROR-NO        PIC X(4).
   894             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   895
   896         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   897             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   898
   899         16  PI-CR-CONTROL-IN-PROGRESS.
   900             20  PI-CR-CARRIER           PIC X.
   901             20  PI-CR-GROUPING          PIC X(6).
   902             20  PI-CR-STATE             PIC XX.
   903             20  PI-CR-ACCOUNT           PIC X(10).
   904             20  PI-CR-FIN-RESP          PIC X(10).
   905             20  PI-CR-TYPE              PIC X.
   906
   907         16  PI-CR-BATCH-NUMBER          PIC X(6).
   908
   909         16  PI-CR-MONTH-END-DT          PIC XX.
   910
   911         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   912             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   913             88  PI-ZERO-CARRIER             VALUE '1'.
   914             88  PI-ZERO-GROUPING            VALUE '2'.
   915             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   916
   917         16  PI-CARRIER-SECURITY         PIC X.
   918             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   919
   920         16  PI-ACCOUNT-SECURITY         PIC X(10).
   921             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   922             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  22
* EL630.cbl
   923
   924         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   925             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   926                                         INDEXED BY PI-ACCESS-NDX
   927                                         PIC X.
   928
   929         16  PI-GA-BILLING-CONTROL       PIC X.
   930             88  PI-GA-BILLING               VALUE '1'.
   931
   932         16  PI-MAIL-PROCESSING          PIC X.
   933             88  PI-MAIL-YES                 VALUE 'Y'.
   934
   935         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   936
   937         16  PI-AR-SYSTEM.
   938             20  PI-AR-PROCESSING-CNTL   PIC X.
   939                 88  PI-AR-PROCESSING        VALUE 'Y'.
   940             20  PI-AR-SUMMARY-CODE      PIC X(6).
   941             20  PI-AR-MONTH-END-DT      PIC XX.
   942
   943         16  PI-MP-SYSTEM.
   944             20  PI-MORTGAGE-USER            PIC X.
   945                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   946                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   947             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   948                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   949                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   950                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   951                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   952                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   953             20  PI-MP-MONTH-END-DT          PIC XX.
   954             20  PI-MP-REFERENCE-NO.
   955                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   956                 24  PI-MP-REFERENCE-SFX     PIC XX.
   957
   958         16  PI-LABEL-CONTROL            PIC X(01).
   959             88  PI-CREATE-LABELS                    VALUE 'Y'.
   960             88  PI-BYPASS-LABELS                    VALUE 'N'.
   961
   962         16  PI-BILL-GROUPING-CODE       PIC X(01).
   963             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   964
   965         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   966             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   967             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   968
   969         16  FILLER                      PIC X(14).
   970
   971     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   972******************************************************************
   973*    COPY ELC630PI.
   974******************************************************************
   975*                                                                *
   976*                            ELC630PI                            *
   977*                            VMOD=2.014                          *
   978*                                                                *
   979* - PI-PROGRAM-WORK-AREA FOR THE DATA-ENTRY SUB-SYSTEM -         *
   980*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  23
* EL630.cbl
   981*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
   982*                                                                *
   983*               EL630 - EL6301 - EL6302                          *
   984******************************************************************
   985*                   C H A N G E   L O G
   986*
   987* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   988*-----------------------------------------------------------------
   989*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   990* EFFECTIVE    NUMBER
   991*-----------------------------------------------------------------
   992* 072308  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
   993* 030310  CR2009031200002  PEMA  OPEN LOAN OFFICER FIELD
   994* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   995******************************************************************
   996
   997     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   998         16  PI-AM-NAME                  PIC X(30).
   999         16  PI-MAP-NAME                 PIC X(8).
  1000         16  PI-BATCH-AMOUNTS    COMP-3.
  1001             20  PI-LF-ISS-REMITTED      PIC S9(8)V99.
  1002             20  PI-LF-ISS-ENTERED       PIC S9(8)V99.
  1003             20  PI-LF-CAN-REMITTED      PIC S9(8)V99.
  1004             20  PI-LF-CAN-ENTERED       PIC S9(8)V99.
  1005             20  PI-AH-ISS-REMITTED      PIC S9(8)V99.
  1006             20  PI-AH-ISS-ENTERED       PIC S9(8)V99.
  1007             20  PI-AH-CAN-REMITTED      PIC S9(8)V99.
  1008             20  PI-AH-CAN-ENTERED       PIC S9(8)V99.
  1009             20  PI-ISS-CNT-REMITTED     PIC S9(5).
  1010             20  PI-ISS-CNT-ENTERED      PIC S9(5).
  1011             20  PI-CAN-CNT-REMITTED     PIC S9(5).
  1012             20  PI-CAN-CNT-ENTERED      PIC S9(5).
  1013         16  PI-MAINT-FUNC               PIC X.
  1014         16  PI-ERROR-SW                 PIC X.
  1015             88  PI-DATA-ERRORS              VALUE 'Y'.
  1016         16  PI-UPDATE-SW                PIC X.
  1017             88  PI-DATA-UPDATED             VALUE 'Y'.
  1018         16  PI-DISPLAY-SW               PIC X.
  1019             88  PI-LAST-FUNC-DISPLAY        VALUE 'Y'.
  1020         16  PI-SAVE-CALLING-PGM         PIC X(8).
  1021         16  PI-LAST-SEQ-NO-ADDED        PIC S9(4) COMP.
  1022         16  PI-NEXT-DISPLAY-SEQ-NO      PIC S9(4) COMP.
  1023         16  PI-SAV-CARRIER              PIC X.
  1024         16  PI-SAV-GROUPING             PIC X(6).
  1025         16  PI-SAV-STATE                PIC XX.
  1026         16  PI-SAV-ACCOUNT              PIC X(10).
  1027         16  PI-SAV-CERT-EFF-DT          PIC XX.
  1028         16  PI-SAV-CERT-NO.
  1029             20  PI-SAV-CERT-PRIME       PIC X(14).
  1030             20  PI-SAV-CERT-SFX         PIC X.
  1031         16  PI-PYAJ-REFERENCE REDEFINES PI-SAV-CERT-NO.
  1032             20  PI-SAV-PYAJ-REFERENCE   PIC X(12).
  1033             20  FILLER                  PIC X(3).
  1034         16  PI-SAV-ENDING-ERPNDB-KEY.
  1035             20  PI-SAV-COMP-CD          PIC X.
  1036             20  PI-SAV-ENTRY-BATCH      PIC X(6).
  1037             20  PI-SAV-BATCH-SEQ        PIC S9(4) COMP.
  1038             20  PI-SAV-BATCH-CHG-SEQ    PIC S9(4) COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  24
* EL630.cbl
  1039         16  PI-SAV-REFERENCE            PIC X(12).
  1040         16  PI-SAV-FULL-CONTROL.
  1041             20  PI-SAV-FC-CARRIER       PIC X.
  1042             20  PI-SAV-FC-GROUPING      PIC X(6).
  1043             20  PI-SAV-FC-STATE         PIC XX.
  1044         16  PI-VERIFY-DELETE-SW         PIC X.
  1045             88  PI-DELETE-IS-OK             VALUE 'Y'.
  1046         16  PI-EL630-FIRST-TIME-SW      PIC X.
  1047             88  PI-EL630-FIRST-TIME         VALUE SPACE.
  1048         16  PI-CREDIT-EDIT-CONTROLS.
  1049             20  PI-MIN-PREMIUM          PIC S9(3)V99  COMP-3.
  1050             20  PI-MIN-AGE              PIC 99.
  1051             20  PI-DEFAULT-AGE          PIC 99.
  1052             20  PI-MIN-TERM             PIC S9(3)     COMP-3.
  1053             20  PI-MAX-TERM             PIC S9(3)     COMP-3.
  1054             20  PI-DEFAULT-SEX          PIC X.
  1055             20  PI-JOINT-AGE-INPUT      PIC X.
  1056                 88 PI-JOINT-AGE-IS-INPUT       VALUE '1'.
  1057             20  PI-BIRTH-DATE-INPUT     PIC X.
  1058                 88 PI-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1059         16  PI-KEYED-SWITCHES.
  1060             20  PI-ISS-SUFFIX-KEYED-SW  PIC X.
  1061                 88  PI-ISS-SUFFIX-KEYED     VALUE 'Y'.
  1062             20  PI-CAN-SUFFIX-KEYED-SW  PIC X.
  1063                 88  PI-CAN-SUFFIX-KEYED     VALUE 'Y'.
  1064             20  PI-IG-KEYED-SW          PIC X.
  1065                 88  PI-IG-KEYED             VALUE 'Y'.
  1066             20  PI-APR-KEYED-SW         PIC X.
  1067                 88  PI-APR-KEYED            VALUE 'Y'.
  1068*            20  PI-FREQ-KEYED-SW        PIC X.
  1069*                88  PI-FREQ-KEYED           VALUE 'Y'.
  1070             20  PI-VIN-KEYED-SW         PIC X.
  1071                 88  PI-VIN-KEYED            VALUE 'Y'.
  1072             20  PI-SIG-KEYED-SW         PIC X.
  1073                 88  PI-SIG-KEYED            VALUE 'Y'.
  1074             20  PI-LFRT-KEYED-SW        PIC X.
  1075                 88  PI-LFRT-KEYED           VALUE 'Y'.
  1076             20  PI-AHRT-KEYED-SW        PIC X.
  1077                 88  PI-AHRT-KEYED           VALUE 'Y'.
  1078             20  PI-SSNUM-KEYED-SW       PIC X.
  1079                 88  PI-SSNUM-KEYED          VALUE 'Y'.
  1080             20  PI-JNT-SSNUM-KEYED-SW   PIC X.
  1081                 88  PI-JNT-SSNUM-KEYED      VALUE 'Y'.
  1082             20  PI-MEMBER-KEYED-SW      PIC X.
  1083                 88  PI-MEMBER-KEYED         VALUE 'Y'.
  1084             20  PI-MODE-KEYED-SW        PIC X.
  1085                 88  PI-MODE-KEYED           VALUE 'Y'.
  1086             20  PI-PMTS-KEYED-SW        PIC X.
  1087                 88  PI-PMTS-KEYED           VALUE 'Y'.
  1088             20  PI-LN-OFFICER-KEYED-SW  PIC X.
  1089                 88  PI-LN-OFFICER-KEYED     VALUE 'Y'.
  1090             20  PI-ENTRY-KEYED-SW       PIC X.
  1091                 88  PI-ENTRY-KEYED          VALUE 'Y'.
  1092             20  PI-FORCE-KEYED-SW       PIC X.
  1093                 88  PI-FORCE-KEYED          VALUE 'Y'.
  1094             20  PI-RINCD-KEYED-SW       PIC X.
  1095                 88  PI-RINCD-KEYED          VALUE 'Y'.
  1096             20  PI-BILLCD-KEYED-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  25
* EL630.cbl
  1097                 88  PI-BILLCD-KEYED         VALUE 'Y'.
  1098             20  PI-RTCLS-KEYED-SW       PIC X.
  1099                 88  PI-RTCLS-KEYED          VALUE 'Y'.
  1100             20  PI-LNTRM-KEYED-SW       PIC X.
  1101                 88  PI-LNTRM-KEYED          VALUE 'Y'.
  1102             20  PI-EXPIR-KEYED-SW       PIC X.
  1103                 88  PI-EXPIR-KEYED          VALUE 'Y'.
  1104             20  PI-PMT-KEYED-SW         PIC X.
  1105                 88  PI-PMT-KEYED            VALUE 'Y'.
  1106             20  PI-1ST-PMT-KEYED-SW     PIC X.
  1107                 88  PI-1ST-PMT-KEYED        VALUE 'Y'.
  1108             20  PI-DAYS-KEYED-SW        PIC X.
  1109                 88  PI-DAYS-KEYED           VALUE 'Y'.
  1110             20  PI-SKPCD-KEYED-SW       PIC X.
  1111                 88  PI-SKPCD-KEYED          VALUE 'Y'.
  1112             20  PI-JNT-AGE-KEYED-SW     PIC X.
  1113                 88  PI-JNT-AGE-KEYED        VALUE 'Y'.
  1114             20  PI-JNT-NAME-KEYED-SW    PIC X.
  1115                 88  PI-JNT-NAME-KEYED       VALUE 'Y'.
  1116             20  PI-ISS-LIVES-KEYED-SW   PIC X.
  1117                 88  PI-ISS-LIVES-KEYED      VALUE 'Y'.
  1118             20  PI-CAN-LIVES-KEYED-SW   PIC X.
  1119                 88  PI-CAN-LIVES-KEYED      VALUE 'Y'.
  1120             20  PI-PAYEE-KEYED-SW       PIC X.
  1121                 88  PI-PAYEE-KEYED          VALUE 'Y'.
  1122             20  PI-CHK-REQ-KEYED-SW     PIC X.
  1123                 88  PI-CHK-REQ-KEYED        VALUE 'Y'.
  1124             20  PI-ZIP4-KEYED-SW        PIC X.
  1125                 88  PI-ZIP4-KEYED           VALUE 'Y'.
  1126             20  PI-POLICY-KEYED-SW      PIC X.
  1127                 88  PI-POLICY-KEYED         VALUE 'Y'.
  1128             20  PI-EXPIRE-KEYED-SW      PIC X.
  1129                 88  PI-EXPIRE-KEYED         VALUE 'Y'.
  1130             20  PI-CRIT-PERD-KEYED-SW    PIC X.
  1131                 88  PI-CRIT-PERD-KEYED      VALUE 'Y'.
  1132             20  PI-BENEFICIARY-KEYED-SW PIC X.
  1133                 88  PI-BENEFICIARY-KEYED    VALUE 'Y'.
  1134             20  PI-PHONE-KEYED-SW       PIC X.
  1135                 88  PI-PHONE-KEYED          VALUE 'Y'.
  1136             20  PI-ALT-BEN-KEYED-SW     PIC X.
  1137                 88  PI-ALT-BEN-KEYED        VALUE 'Y'.
  1138             20  PI-ALT-PREM-KEYED-SW    PIC X.
  1139                 88  PI-ALT-PREM-KEYED       VALUE 'Y'.
  1140             20  PI-REFUND-MTHD-KEYED-SW PIC X.
  1141                 88  PI-REFUND-MTHD-KEYED    VALUE 'Y'.
  1142         16  PI-ACCT-LOW-EFF-DT          PIC XX.
  1143         16  PI-ACCT-HIGH-EXP-DT         PIC XX.
  1144         16  PI-BATCH-EOF-SW             PIC X.
  1145             88  PI-BATCH-EOF                VALUE 'Y'.
  1146         16  PI-NB-MONTH-END-DT          PIC XX.
  1147         16  PI-ISSUE-ADDED-SW           PIC X.
  1148             88  PI-ISSUE-ADDED              VALUE 'Y'.
  1149         16  PI-BROWSE-SW                PIC X.
  1150             88  PI-BROWSE                   VALUE 'Y'.
  1151         16  PI-ACCT-AGENT-ERROR-SW      PIC X.
  1152             88  PI-ACCT-AGENT-ERROR         VALUE 'Y'.
  1153         16  PI-FIN-RESP-ERROR-SW        PIC X.
  1154             88  PI-FIN-RESP-ERROR           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  26
* EL630.cbl
  1155         16  PI-CAN-REA-KEYED-SW         PIC X.
  1156             88  PI-CAN-REA-KEYED            VALUE 'Y'.
  1157         16  PI-AM-EDIT-LOAN-OFC         PIC X.
  1158         16  PI-AM-ADDR1                 PIC X(30).
  1159         16  PI-AM-ADDR2                 PIC X(30).
  1160         16  PI-AM-CITYST.
  1161             20  PI-AM-CITY              PIC X(28).
  1162             20  PI-AM-STATE             PIC XX.
  1163         16  PI-AM-ZIP                   PIC X(9).
  1164         16  FILLER                      PIC X(290).
  1165*        16  FILLER                      PIC X(390).
  1166     12  PI-MISC.
  1167         16  PI-ACCT-DATE-RANGES OCCURS 32 TIMES.
  1168             20  PI-ACCT-EFF-DT          PIC XX.
  1169             20  PI-ACCT-EXP-DT          PIC XX.
  1170             20  PI-REMIT-AGENT          PIC X(10).
  1171             20  PI-ACCT-AGENT           PIC X(10).
  1172         16  PI-ACCOUNT-AGENT            PIC X(10).
  1173         16  PI-FIN-RESP                 PIC X(10).
  1174         16  PI-SUMMARY-CODE             PIC X(6).
  1175         16  PI-SUB                      PIC S9(4) COMP.
  1176         16  PI-COMP-CARRIER             PIC X.
  1177         16  PI-COMP-GROUPING            PIC X(6).
  1178         16  PI-ACCT-AGENT-PROCESSED-SW  PIC X.
  1179             88  PI-ACCT-AGENT-PROCESSED     VALUE 'Y'.
  1180         16  PI-CLEAR-ERROR-SW           PIC X.
  1181             88  PI-CLEAR-ERROR              VALUE 'Y'.
  1182         16  PI-AGE-KEYED-SW             PIC X.
  1183             88  PI-AGE-KEYED                VALUE 'Y'.
  1184         16  PI-BIRTHDT-KEYED-SW         PIC X.
  1185             88  PI-BIRTHDT-KEYED            VALUE 'Y'.
  1186         16  PI-RECEIVED-DT              PIC XX.
  1187         16  PI-CSR-ID                   PIC X(4).
  1188
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  27
* EL630.cbl
  1190          16  FILLER              PIC X(390).
  1191
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  28
* EL630.cbl
  1193*    COPY ELCAID.
  1194******************************************************************
  1195*                                                                *
  1196*                            ELCAID.                             *
  1197*                            VMOD=2.001                          *
  1198*                                                                *
  1199*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1200*                                                                *
  1201*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1202*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1203******************************************************************
  1204
  1205 01  DFHAID.
  1206   02  DFHNULL   PIC  X  VALUE  ' '.
  1207   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1208   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1209   02  DFHPEN    PIC  X  VALUE  '='.
  1210   02  DFHOPID   PIC  X  VALUE  'W'.
  1211   02  DFHPA1    PIC  X  VALUE  '%'.
  1212   02  DFHPA2    PIC  X  VALUE  '>'.
  1213   02  DFHPA3    PIC  X  VALUE  ','.
  1214   02  DFHPF1    PIC  X  VALUE  '1'.
  1215   02  DFHPF2    PIC  X  VALUE  '2'.
  1216   02  DFHPF3    PIC  X  VALUE  '3'.
  1217   02  DFHPF4    PIC  X  VALUE  '4'.
  1218   02  DFHPF5    PIC  X  VALUE  '5'.
  1219   02  DFHPF6    PIC  X  VALUE  '6'.
  1220   02  DFHPF7    PIC  X  VALUE  '7'.
  1221   02  DFHPF8    PIC  X  VALUE  '8'.
  1222   02  DFHPF9    PIC  X  VALUE  '9'.
  1223   02  DFHPF10   PIC  X  VALUE  ':'.
  1224   02  DFHPF11   PIC  X  VALUE  '#'.
  1225   02  DFHPF12   PIC  X  VALUE  '@'.
  1226   02  DFHPF13   PIC  X  VALUE  'A'.
  1227   02  DFHPF14   PIC  X  VALUE  'B'.
  1228   02  DFHPF15   PIC  X  VALUE  'C'.
  1229   02  DFHPF16   PIC  X  VALUE  'D'.
  1230   02  DFHPF17   PIC  X  VALUE  'E'.
  1231   02  DFHPF18   PIC  X  VALUE  'F'.
  1232   02  DFHPF19   PIC  X  VALUE  'G'.
  1233   02  DFHPF20   PIC  X  VALUE  'H'.
  1234   02  DFHPF21   PIC  X  VALUE  'I'.
  1235*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1236   02  DFHPF22   PIC  X  VALUE  '['.
  1237   02  DFHPF23   PIC  X  VALUE  '.'.
  1238   02  DFHPF24   PIC  X  VALUE  '<'.
  1239   02  DFHMSRE   PIC  X  VALUE  'X'.
  1240   02  DFHSTRF   PIC  X  VALUE  'h'.
  1241   02  DFHTRIG   PIC  X  VALUE  '"'.
  1242 01  FILLER    REDEFINES DFHAID.
  1243     12  FILLER              PIC X(8).
  1244     12  PF-VALUES           PIC X       OCCURS 2.
  1245     12  FILLER              PIC X(25).
  1246
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  29
* EL630.cbl
  1248*    COPY EL630S.
  1249 01  EL630AI.
  1250     05  FILLER            PIC  X(0012).
  1251*    -------------------------------
  1252     05  DATEL PIC S9(0004) COMP.
  1253     05  DATEF PIC  X(0001).
  1254     05  FILLER REDEFINES DATEF.
  1255         10  DATEA PIC  X(0001).
  1256     05  DATEI PIC  X(0008).
  1257*    -------------------------------
  1258     05  TIMEL PIC S9(0004) COMP.
  1259     05  TIMEF PIC  X(0001).
  1260     05  FILLER REDEFINES TIMEF.
  1261         10  TIMEA PIC  X(0001).
  1262     05  TIMEI PIC  X(0005).
  1263*    -------------------------------
  1264     05  MAINTL PIC S9(0004) COMP.
  1265     05  MAINTF PIC  X(0001).
  1266     05  FILLER REDEFINES MAINTF.
  1267         10  MAINTA PIC  X(0001).
  1268     05  MAINTI PIC  X(0001).
  1269*    -------------------------------
  1270     05  REFHDGL PIC S9(0004) COMP.
  1271     05  REFHDGF PIC  X(0001).
  1272     05  FILLER REDEFINES REFHDGF.
  1273         10  REFHDGA PIC  X(0001).
  1274     05  REFHDGI PIC  X(0015).
  1275*    -------------------------------
  1276     05  CARRHDGL PIC S9(0004) COMP.
  1277     05  CARRHDGF PIC  X(0001).
  1278     05  FILLER REDEFINES CARRHDGF.
  1279         10  CARRHDGA PIC  X(0001).
  1280     05  CARRHDGI PIC  X(0007).
  1281*    -------------------------------
  1282     05  GRPHDGL PIC S9(0004) COMP.
  1283     05  GRPHDGF PIC  X(0001).
  1284     05  FILLER REDEFINES GRPHDGF.
  1285         10  GRPHDGA PIC  X(0001).
  1286     05  GRPHDGI PIC  X(0008).
  1287*    -------------------------------
  1288     05  STHDGL PIC S9(0004) COMP.
  1289     05  STHDGF PIC  X(0001).
  1290     05  FILLER REDEFINES STHDGF.
  1291         10  STHDGA PIC  X(0001).
  1292     05  STHDGI PIC  X(0005).
  1293*    -------------------------------
  1294     05  BATCHL PIC S9(0004) COMP.
  1295     05  BATCHF PIC  X(0001).
  1296     05  FILLER REDEFINES BATCHF.
  1297         10  BATCHA PIC  X(0001).
  1298     05  BATCHI PIC  X(0006).
  1299*    -------------------------------
  1300     05  REFL PIC S9(0004) COMP.
  1301     05  REFF PIC  X(0001).
  1302     05  FILLER REDEFINES REFF.
  1303         10  REFA PIC  X(0001).
  1304     05  REFI PIC  X(0012).
  1305*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  30
* EL630.cbl
  1306     05  CARRIERL PIC S9(0004) COMP.
  1307     05  CARRIERF PIC  X(0001).
  1308     05  FILLER REDEFINES CARRIERF.
  1309         10  CARRIERA PIC  X(0001).
  1310     05  CARRIERI PIC  X(0001).
  1311*    -------------------------------
  1312     05  GROUPL PIC S9(0004) COMP.
  1313     05  GROUPF PIC  X(0001).
  1314     05  FILLER REDEFINES GROUPF.
  1315         10  GROUPA PIC  X(0001).
  1316     05  GROUPI PIC  X(0006).
  1317*    -------------------------------
  1318     05  STATEL PIC S9(0004) COMP.
  1319     05  STATEF PIC  X(0001).
  1320     05  FILLER REDEFINES STATEF.
  1321         10  STATEA PIC  X(0001).
  1322     05  STATEI PIC  X(0002).
  1323*    -------------------------------
  1324     05  ACCOUNTL PIC S9(0004) COMP.
  1325     05  ACCOUNTF PIC  X(0001).
  1326     05  FILLER REDEFINES ACCOUNTF.
  1327         10  ACCOUNTA PIC  X(0001).
  1328     05  ACCOUNTI PIC  X(0010).
  1329*    -------------------------------
  1330     05  LFPHDGL PIC S9(0004) COMP.
  1331     05  LFPHDGF PIC  X(0001).
  1332     05  FILLER REDEFINES LFPHDGF.
  1333         10  LFPHDGA PIC  X(0001).
  1334     05  LFPHDGI PIC  X(0010).
  1335*    -------------------------------
  1336     05  AHPHDGL PIC S9(0004) COMP.
  1337     05  AHPHDGF PIC  X(0001).
  1338     05  FILLER REDEFINES AHPHDGF.
  1339         10  AHPHDGA PIC  X(0001).
  1340     05  AHPHDGI PIC  X(0010).
  1341*    -------------------------------
  1342     05  LFRHDGL PIC S9(0004) COMP.
  1343     05  LFRHDGF PIC  X(0001).
  1344     05  FILLER REDEFINES LFRHDGF.
  1345         10  LFRHDGA PIC  X(0001).
  1346     05  LFRHDGI PIC  X(0009).
  1347*    -------------------------------
  1348     05  AHRHDGL PIC S9(0004) COMP.
  1349     05  AHRHDGF PIC  X(0001).
  1350     05  FILLER REDEFINES AHRHDGF.
  1351         10  AHRHDGA PIC  X(0001).
  1352     05  AHRHDGI PIC  X(0009).
  1353*    -------------------------------
  1354     05  EISSCNTL PIC S9(0004) COMP.
  1355     05  EISSCNTF PIC  X(0001).
  1356     05  FILLER REDEFINES EISSCNTF.
  1357         10  EISSCNTA PIC  X(0001).
  1358     05  EISSCNTI PIC  S9(6).
  1359*    -------------------------------
  1360     05  ELFISSL PIC S9(0004) COMP.
  1361     05  ELFISSF PIC  X(0001).
  1362     05  FILLER REDEFINES ELFISSF.
  1363         10  ELFISSA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  31
* EL630.cbl
  1364     05  ELFISSI PIC  S9(10)V9(2).
  1365*    -------------------------------
  1366     05  EAHISSL PIC S9(0004) COMP.
  1367     05  EAHISSF PIC  X(0001).
  1368     05  FILLER REDEFINES EAHISSF.
  1369         10  EAHISSA PIC  X(0001).
  1370     05  EAHISSI PIC  S9(10)V9(2).
  1371*    -------------------------------
  1372     05  ECANCNTL PIC S9(0004) COMP.
  1373     05  ECANCNTF PIC  X(0001).
  1374     05  FILLER REDEFINES ECANCNTF.
  1375         10  ECANCNTA PIC  X(0001).
  1376     05  ECANCNTI PIC  S9(6).
  1377*    -------------------------------
  1378     05  ELFCANL PIC S9(0004) COMP.
  1379     05  ELFCANF PIC  X(0001).
  1380     05  FILLER REDEFINES ELFCANF.
  1381         10  ELFCANA PIC  X(0001).
  1382     05  ELFCANI PIC  S9(8)V9(2).
  1383*    -------------------------------
  1384     05  EAHCANL PIC S9(0004) COMP.
  1385     05  EAHCANF PIC  X(0001).
  1386     05  FILLER REDEFINES EAHCANF.
  1387         10  EAHCANA PIC  X(0001).
  1388     05  EAHCANI PIC  S9(8)V9(2).
  1389*    -------------------------------
  1390     05  AISSCNTL PIC S9(0004) COMP.
  1391     05  AISSCNTF PIC  X(0001).
  1392     05  FILLER REDEFINES AISSCNTF.
  1393         10  AISSCNTA PIC  X(0001).
  1394     05  AISSCNTI PIC  S9(6).
  1395*    -------------------------------
  1396     05  ALFISSL PIC S9(0004) COMP.
  1397     05  ALFISSF PIC  X(0001).
  1398     05  FILLER REDEFINES ALFISSF.
  1399         10  ALFISSA PIC  X(0001).
  1400     05  ALFISSI PIC  S9(10)V9(2).
  1401*    -------------------------------
  1402     05  AAHISSL PIC S9(0004) COMP.
  1403     05  AAHISSF PIC  X(0001).
  1404     05  FILLER REDEFINES AAHISSF.
  1405         10  AAHISSA PIC  X(0001).
  1406     05  AAHISSI PIC  S9(10)V9(2).
  1407*    -------------------------------
  1408     05  ACANCNTL PIC S9(0004) COMP.
  1409     05  ACANCNTF PIC  X(0001).
  1410     05  FILLER REDEFINES ACANCNTF.
  1411         10  ACANCNTA PIC  X(0001).
  1412     05  ACANCNTI PIC  S9(6).
  1413*    -------------------------------
  1414     05  ALFCANL PIC S9(0004) COMP.
  1415     05  ALFCANF PIC  X(0001).
  1416     05  FILLER REDEFINES ALFCANF.
  1417         10  ALFCANA PIC  X(0001).
  1418     05  ALFCANI PIC  S9(8)V9(2).
  1419*    -------------------------------
  1420     05  AAHCANL PIC S9(0004) COMP.
  1421     05  AAHCANF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  32
* EL630.cbl
  1422     05  FILLER REDEFINES AAHCANF.
  1423         10  AAHCANA PIC  X(0001).
  1424     05  AAHCANI PIC  S9(8)V9(2).
  1425*    -------------------------------
  1426     05  OISSCNTL PIC S9(0004) COMP.
  1427     05  OISSCNTF PIC  X(0001).
  1428     05  FILLER REDEFINES OISSCNTF.
  1429         10  OISSCNTA PIC  X(0001).
  1430     05  OISSCNTI PIC  S9(6).
  1431*    -------------------------------
  1432     05  OLFISSL PIC S9(0004) COMP.
  1433     05  OLFISSF PIC  X(0001).
  1434     05  FILLER REDEFINES OLFISSF.
  1435         10  OLFISSA PIC  X(0001).
  1436     05  OLFISSI PIC  S9(10)V9(2).
  1437*    -------------------------------
  1438     05  OAHISSL PIC S9(0004) COMP.
  1439     05  OAHISSF PIC  X(0001).
  1440     05  FILLER REDEFINES OAHISSF.
  1441         10  OAHISSA PIC  X(0001).
  1442     05  OAHISSI PIC  S9(10)V9(2).
  1443*    -------------------------------
  1444     05  OCANCNTL PIC S9(0004) COMP.
  1445     05  OCANCNTF PIC  X(0001).
  1446     05  FILLER REDEFINES OCANCNTF.
  1447         10  OCANCNTA PIC  X(0001).
  1448     05  OCANCNTI PIC  S9(6).
  1449*    -------------------------------
  1450     05  OLFCANL PIC S9(0004) COMP.
  1451     05  OLFCANF PIC  X(0001).
  1452     05  FILLER REDEFINES OLFCANF.
  1453         10  OLFCANA PIC  X(0001).
  1454     05  OLFCANI PIC  S9(8)V9(2).
  1455*    -------------------------------
  1456     05  OAHCANL PIC S9(0004) COMP.
  1457     05  OAHCANF PIC  X(0001).
  1458     05  FILLER REDEFINES OAHCANF.
  1459         10  OAHCANA PIC  X(0001).
  1460     05  OAHCANI PIC  S9(8)V9(2).
  1461*    -------------------------------
  1462     05  RECEVDTL PIC S9(0004) COMP.
  1463     05  RECEVDTF PIC  X(0001).
  1464     05  FILLER REDEFINES RECEVDTF.
  1465         10  RECEVDTA PIC  X(0001).
  1466     05  RECEVDTI PIC  X(0008).
  1467*    -------------------------------
  1468     05  MNTHNDTL PIC S9(0004) COMP.
  1469     05  MNTHNDTF PIC  X(0001).
  1470     05  FILLER REDEFINES MNTHNDTF.
  1471         10  MNTHNDTA PIC  X(0001).
  1472     05  MNTHNDTI PIC  X(0008).
  1473*    -------------------------------
  1474     05  ERRMSG1L PIC S9(0004) COMP.
  1475     05  ERRMSG1F PIC  X(0001).
  1476     05  FILLER REDEFINES ERRMSG1F.
  1477         10  ERRMSG1A PIC  X(0001).
  1478     05  ERRMSG1I PIC  X(0076).
  1479*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  33
* EL630.cbl
  1480     05  ERRMSG2L PIC S9(0004) COMP.
  1481     05  ERRMSG2F PIC  X(0001).
  1482     05  FILLER REDEFINES ERRMSG2F.
  1483         10  ERRMSG2A PIC  X(0001).
  1484     05  ERRMSG2I PIC  X(0076).
  1485*    -------------------------------
  1486     05  PFENTERL PIC S9(0004) COMP.
  1487     05  PFENTERF PIC  X(0001).
  1488     05  FILLER REDEFINES PFENTERF.
  1489         10  PFENTERA PIC  X(0001).
  1490     05  PFENTERI PIC  9(2).
  1491*    -------------------------------
  1492     05  PF5L PIC S9(0004) COMP.
  1493     05  PF5F PIC  X(0001).
  1494     05  FILLER REDEFINES PF5F.
  1495         10  PF5A PIC  X(0001).
  1496     05  PF5I PIC  X(0015).
  1497 01  EL630AO REDEFINES EL630AI.
  1498     05  FILLER            PIC  X(0012).
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  DATEO PIC  X(0008).
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  TIMEO PIC  99.99.
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  MAINTO PIC  X(0001).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  REFHDGO PIC  X(0015).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  CARRHDGO PIC  X(0007).
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  GRPHDGO PIC  X(0008).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  STHDGO PIC  X(0005).
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  BATCHO PIC  X(0006).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  REFO PIC  X(0012).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  CARRIERO PIC  X(0001).
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  GROUPO PIC  X(0006).
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  STATEO PIC  X(0002).
  1535*    -------------------------------
  1536     05  FILLER            PIC  X(0003).
  1537     05  ACCOUNTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  34
* EL630.cbl
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  LFPHDGO PIC  X(0010).
  1541*    -------------------------------
  1542     05  FILLER            PIC  X(0003).
  1543     05  AHPHDGO PIC  X(0010).
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  LFRHDGO PIC  X(0009).
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  AHRHDGO PIC  X(0009).
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  EISSCNTO PIC  Z(5)-.
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  ELFISSO PIC  Z(8).99-.
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  EAHISSO PIC  Z(8).99-.
  1559*    -------------------------------
  1560     05  FILLER            PIC  X(0003).
  1561     05  ECANCNTO PIC  Z(5)-.
  1562*    -------------------------------
  1563     05  FILLER            PIC  X(0003).
  1564     05  ELFCANO PIC  Z(6).99-.
  1565*    -------------------------------
  1566     05  FILLER            PIC  X(0003).
  1567     05  EAHCANO PIC  Z(6).99-.
  1568*    -------------------------------
  1569     05  FILLER            PIC  X(0003).
  1570     05  AISSCNTO PIC  Z(5)-.
  1571*    -------------------------------
  1572     05  FILLER            PIC  X(0003).
  1573     05  ALFISSO PIC  Z(8).99-.
  1574*    -------------------------------
  1575     05  FILLER            PIC  X(0003).
  1576     05  AAHISSO PIC  Z(8).99-.
  1577*    -------------------------------
  1578     05  FILLER            PIC  X(0003).
  1579     05  ACANCNTO PIC  Z(5)-.
  1580*    -------------------------------
  1581     05  FILLER            PIC  X(0003).
  1582     05  ALFCANO PIC  Z(6).99-.
  1583*    -------------------------------
  1584     05  FILLER            PIC  X(0003).
  1585     05  AAHCANO PIC  Z(6).99-.
  1586*    -------------------------------
  1587     05  FILLER            PIC  X(0003).
  1588     05  OISSCNTO PIC  Z(5)-.
  1589*    -------------------------------
  1590     05  FILLER            PIC  X(0003).
  1591     05  OLFISSO PIC  Z(8).99-.
  1592*    -------------------------------
  1593     05  FILLER            PIC  X(0003).
  1594     05  OAHISSO PIC  Z(8).99-.
  1595*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  35
* EL630.cbl
  1596     05  FILLER            PIC  X(0003).
  1597     05  OCANCNTO PIC  Z(5)-.
  1598*    -------------------------------
  1599     05  FILLER            PIC  X(0003).
  1600     05  OLFCANO PIC  Z(6).99-.
  1601*    -------------------------------
  1602     05  FILLER            PIC  X(0003).
  1603     05  OAHCANO PIC  Z(6).99-.
  1604*    -------------------------------
  1605     05  FILLER            PIC  X(0003).
  1606     05  RECEVDTO PIC  X(0008).
  1607*    -------------------------------
  1608     05  FILLER            PIC  X(0003).
  1609     05  MNTHNDTO PIC  X(0008).
  1610*    -------------------------------
  1611     05  FILLER            PIC  X(0003).
  1612     05  ERRMSG1O PIC  X(0076).
  1613*    -------------------------------
  1614     05  FILLER            PIC  X(0003).
  1615     05  ERRMSG2O PIC  X(0076).
  1616*    -------------------------------
  1617     05  FILLER            PIC  X(0003).
  1618     05  PFENTERO PIC  X(0002).
  1619*    -------------------------------
  1620     05  FILLER            PIC  X(0003).
  1621     05  PF5O PIC  X(0015).
  1622*    -------------------------------
  1623
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  36
* EL630.cbl
  1625****************************************************************
  1626*
  1627* Copyright (c) 2007 by Clerity Solutions, Inc.
  1628* All rights reserved.
  1629*
  1630****************************************************************
  1631 01  DFHEIV.
  1632   02  DFHEIV0               PIC X(35).
  1633   02  DFHEIV1               PIC X(08).
  1634   02  DFHEIV2               PIC X(08).
  1635   02  DFHEIV3               PIC X(08).
  1636   02  DFHEIV4               PIC X(06).
  1637   02  DFHEIV5               PIC X(04).
  1638   02  DFHEIV6               PIC X(04).
  1639   02  DFHEIV7               PIC X(02).
  1640   02  DFHEIV8               PIC X(02).
  1641   02  DFHEIV9               PIC X(01).
  1642   02  DFHEIV10              PIC S9(7) COMP-3.
  1643   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1644   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1645   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1646   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1647   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1648   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1649   02  DFHEIV17              PIC X(04).
  1650   02  DFHEIV18              PIC X(04).
  1651   02  DFHEIV19              PIC X(04).
  1652   02  DFHEIV20              USAGE IS POINTER.
  1653   02  DFHEIV21              USAGE IS POINTER.
  1654   02  DFHEIV22              USAGE IS POINTER.
  1655   02  DFHEIV23              USAGE IS POINTER.
  1656   02  DFHEIV24              USAGE IS POINTER.
  1657   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1658   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1659   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1660   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1661   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1662   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1663   02  FILLER                PIC X(02).
  1664   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1665   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1666   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1667   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1668   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1669 LINKAGE  SECTION.
  1670*****************************************************************
  1671*                                                               *
  1672* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1673* All rights reserved.                                          *
  1674*                                                               *
  1675*****************************************************************
  1676 01  dfheiblk.
  1677     02  eibtime          pic s9(7) comp-3.
  1678     02  eibdate          pic s9(7) comp-3.
  1679     02  eibtrnid         pic x(4).
  1680     02  eibtaskn         pic s9(7) comp-3.
  1681     02  eibtrmid         pic x(4).
  1682     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  37
* EL630.cbl
  1683     02  eibcposn         pic s9(4) comp.
  1684     02  eibcalen         pic s9(4) comp.
  1685     02  eibaid           pic x(1).
  1686     02  eibfiller1       pic x(1).
  1687     02  eibfn            pic x(2).
  1688     02  eibfiller2       pic x(2).
  1689     02  eibrcode         pic x(6).
  1690     02  eibfiller3       pic x(2).
  1691     02  eibds            pic x(8).
  1692     02  eibreqid         pic x(8).
  1693     02  eibrsrce         pic x(8).
  1694     02  eibsync          pic x(1).
  1695     02  eibfree          pic x(1).
  1696     02  eibrecv          pic x(1).
  1697     02  eibsend          pic x(1).
  1698     02  eibatt           pic x(1).
  1699     02  eibeoc           pic x(1).
  1700     02  eibfmh           pic x(1).
  1701     02  eibcompl         pic x(1).
  1702     02  eibsig           pic x(1).
  1703     02  eibconf          pic x(1).
  1704     02  eiberr           pic x(1).
  1705     02  eibrldbk         pic x(1).
  1706     02  eiberrcd         pic x(4).
  1707     02  eibsynrb         pic x(1).
  1708     02  eibnodat         pic x(1).
  1709     02  eibfiller5       pic x(2).
  1710     02  eibresp          pic 9(09) comp.
  1711     02  eibresp2         pic 9(09) comp.
  1712     02  dfheigdj         pic s9(4) comp.
  1713     02  dfheigdk         pic s9(4) comp.
  1714 01  DFHCOMMAREA             PIC X(1900).
  1715
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  38
* EL630.cbl
  1717
  1718*    COPY ELCCNTL.
  1719******************************************************************
  1720*                                                                *
  1721*                                                                *
  1722*                            ELCCNTL.                            *
  1723*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1724*                            VMOD=2.059                          *
  1725*                                                                *
  1726*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1727*                                                                *
  1728*   FILE TYPE = VSAM,KSDS                                        *
  1729*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1730*                                                                *
  1731*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1732*       ALTERNATE INDEX = NONE                                   *
  1733*                                                                *
  1734*   LOG = YES                                                    *
  1735*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1736******************************************************************
  1737*                   C H A N G E   L O G
  1738*
  1739* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1740*-----------------------------------------------------------------
  1741*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1742* EFFECTIVE    NUMBER
  1743*-----------------------------------------------------------------
  1744* 082503                   PEMA  ADD BENEFIT GROUP
  1745* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1746* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1747* 092705    2005050300006  PEMA  ADD SPP LEASES
  1748* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1749* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1750* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1751* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1752* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1753* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1754* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1755* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1756* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1757* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1758******************************************************************
  1759*
  1760 01  CONTROL-FILE.
  1761     12  CF-RECORD-ID                       PIC XX.
  1762         88  VALID-CF-ID                        VALUE 'CF'.
  1763
  1764     12  CF-CONTROL-PRIMARY.
  1765         16  CF-COMPANY-ID                  PIC XXX.
  1766         16  CF-RECORD-TYPE                 PIC X.
  1767             88  CF-COMPANY-MASTER              VALUE '1'.
  1768             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1769             88  CF-STATE-MASTER                VALUE '3'.
  1770             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1771             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1772             88  CF-CARRIER-MASTER              VALUE '6'.
  1773             88  CF-MORTALITY-MASTER            VALUE '7'.
  1774             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  39
* EL630.cbl
  1775             88  CF-TERMINAL-MASTER             VALUE '9'.
  1776             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1777             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1778             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1779             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1780             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1781             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1782             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1783             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1784             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1785         16  CF-ACCESS-CD-GENL              PIC X(4).
  1786         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1787             20  CF-PROCESSOR               PIC X(4).
  1788         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1789             20  CF-STATE-CODE              PIC XX.
  1790             20  FILLER                     PIC XX.
  1791         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1792             20  FILLER                     PIC XX.
  1793             20  CF-HI-BEN-IN-REC           PIC XX.
  1794         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1795             20  FILLER                     PIC XXX.
  1796             20  CF-CARRIER-CNTL            PIC X.
  1797         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1798             20  FILLER                     PIC XX.
  1799             20  CF-HI-TYPE-IN-REC          PIC 99.
  1800         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1801             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1802                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1803             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1804             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1805         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1806             20  FILLER                     PIC X.
  1807             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1808         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1809             20  FILLER                     PIC XX.
  1810             20  CF-MORTGAGE-PLAN           PIC XX.
  1811         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1812
  1813     12  CF-LAST-MAINT-DT                   PIC XX.
  1814     12  CF-LAST-MAINT-BY                   PIC X(4).
  1815     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1816
  1817     12  CF-RECORD-BODY                     PIC X(728).
  1818
  1819
  1820****************************************************************
  1821*             COMPANY MASTER RECORD                            *
  1822****************************************************************
  1823
  1824     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1825         16  CF-COMPANY-ADDRESS.
  1826             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1827             20  CF-CL-IN-CARE-OF           PIC X(30).
  1828             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1829             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1830             20  CF-CL-CITY-STATE           PIC X(30).
  1831             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1832             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  40
* EL630.cbl
  1833         16  CF-COMPANY-CD                  PIC X.
  1834         16  CF-COMPANY-PASSWORD            PIC X(8).
  1835         16  CF-SECURITY-OPTION             PIC X.
  1836             88  ALL-SECURITY                   VALUE '1'.
  1837             88  COMPANY-VERIFY                 VALUE '2'.
  1838             88  PROCESSOR-VERIFY               VALUE '3'.
  1839             88  NO-SECURITY                    VALUE '4'.
  1840             88  ALL-BUT-TERM                   VALUE '5'.
  1841         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1842             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1843         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1844             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1845         16  CF-INFORCE-LOCATION            PIC X.
  1846             88  CERTS-ARE-ONLINE               VALUE '1'.
  1847             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1848             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1849         16  CF-LOWER-CASE-LETTERS          PIC X.
  1850         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1851             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1852             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1853             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1854             88  CF-ACCNT-CNTL                  VALUE '3'.
  1855             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1856
  1857         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1858         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1859
  1860         16  CF-LGX-CREDIT-USER             PIC X.
  1861             88  CO-IS-NOT-USER                 VALUE 'N'.
  1862             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1863
  1864         16 CF-CREDIT-CALC-CODES.
  1865             20  CF-CR-REM-TERM-CALC PIC X.
  1866               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1867               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1868               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1869               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1870               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1871               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1872               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1873             20  CF-CR-R78-METHOD           PIC X.
  1874               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1875               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1876
  1877         16  CF-CLAIM-CONTROL-COUNTS.
  1878             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1879                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1880
  1881             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1882                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1883
  1884             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1885                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1886
  1887             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1888                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1889
  1890         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  41
* EL630.cbl
  1891
  1892         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1893             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1894             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1895             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1896             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1897                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1898                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1899             20  CF-CO-PREM-REJECT-SW       PIC X.
  1900                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1901                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1902             20  CF-CO-REF-REJECT-SW        PIC X.
  1903                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1904                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1905
  1906         16  CF-CO-REPORTING-DT             PIC XX.
  1907         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1908         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1909           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1910           88  CF-CO-MONTH-END                  VALUE '1'.
  1911
  1912         16  CF-LGX-CLAIM-USER              PIC X.
  1913             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1914             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1915
  1916         16  CF-CREDIT-EDIT-CONTROLS.
  1917             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1918             20  CF-MIN-AGE                 PIC 99.
  1919             20  CF-DEFAULT-AGE             PIC 99.
  1920             20  CF-MIN-TERM                PIC S999      COMP-3.
  1921             20  CF-MAX-TERM                PIC S999      COMP-3.
  1922             20  CF-DEFAULT-SEX             PIC X.
  1923             20  CF-JOINT-AGE-INPUT         PIC X.
  1924                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1925             20  CF-BIRTH-DATE-INPUT        PIC X.
  1926                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1927             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1928                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1929                 88  CF-ZERO-CARRIER            VALUE '1'.
  1930                 88  CF-ZERO-GROUPING           VALUE '2'.
  1931                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1932             20  CF-EDIT-SW                 PIC X.
  1933                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1934             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1935             20  CF-CR-PR-METHOD            PIC X.
  1936               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1937               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1938             20  FILLER                     PIC X.
  1939
  1940         16  CF-CREDIT-MISC-CONTROLS.
  1941             20  CF-REIN-TABLE-SW           PIC X.
  1942                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1943             20  CF-COMP-TABLE-SW           PIC X.
  1944                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1945             20  CF-EXPERIENCE-RETENTION-AGE
  1946                                            PIC S9        COMP-3.
  1947             20  CF-CONVERSION-DT           PIC XX.
  1948             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  42
* EL630.cbl
  1949             20  CF-RUN-FREQUENCY-SW        PIC X.
  1950                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1951                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1952
  1953             20  CF-CR-CHECK-NO-CONTROL.
  1954                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1955                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1956                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1957                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1958                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1959                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1960
  1961                 24  CF-CR-CHECK-COUNT       REDEFINES
  1962                     CF-CR-CHECK-COUNTER      PIC X(4).
  1963
  1964                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1965                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1966
  1967                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1968                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1969                 24  CF-MAIL-PROCESSING       PIC X.
  1970                     88  MAIL-PROCESSING          VALUE 'Y'.
  1971
  1972         16  CF-MISC-SYSTEM-CONTROL.
  1973             20  CF-SYSTEM-C                 PIC X.
  1974                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1975             20  CF-SYSTEM-D                 PIC X.
  1976                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1977             20  CF-SOC-SEC-NO-SW            PIC X.
  1978                 88  SOC-SEC-NO-USED             VALUE '1'.
  1979             20  CF-MEMBER-NO-SW             PIC X.
  1980                 88  MEMBER-NO-USED              VALUE '1'.
  1981             20  CF-TAX-ID-NUMBER            PIC X(11).
  1982             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1983             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1984                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1985                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1986                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1987                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1988             20  CF-SYSTEM-E                 PIC X.
  1989                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1990
  1991         16  CF-LGX-LIFE-USER               PIC X.
  1992             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1993             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1994
  1995         16  CF-CR-MONTH-END-DT             PIC XX.
  1996
  1997         16  CF-FILE-MAINT-DATES.
  1998             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1999                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2000             20  CF-LAST-BATCH       REDEFINES
  2001                 CF-LAST-BATCH-NO               PIC X(4).
  2002             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2003             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2004             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2005             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2006             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  43
* EL630.cbl
  2007             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2008             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2009             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2010             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2011             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2012
  2013         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2014         16  FILLER                         PIC X.
  2015
  2016         16  CF-ALT-MORT-CODE               PIC X(4).
  2017         16  CF-MEMBER-CAPTION              PIC X(10).
  2018
  2019         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2020             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2021             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2022             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2023             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2024             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2025
  2026         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2027
  2028         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2029         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2030         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2031         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2032
  2033         16  CF-AH-OVERRIDE-L1              PIC X.
  2034         16  CF-AH-OVERRIDE-L2              PIC XX.
  2035         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2036         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2037
  2038         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2039         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2040
  2041         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2042         16  CF-AR-LAST-EL860-DT            PIC XX.
  2043         16  CF-MP-MONTH-END-DT             PIC XX.
  2044
  2045         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2046         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2047             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2048
  2049         16  CF-AR-MONTH-END-DT             PIC XX.
  2050
  2051         16  CF-CRDTCRD-USER                PIC X.
  2052             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2053             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2054
  2055         16  CF-CC-MONTH-END-DT             PIC XX.
  2056
  2057         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2058
  2059         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2060             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2061             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2062             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2063         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2064         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  44
* EL630.cbl
  2065         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2066         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2067             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2068             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2069         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2070         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2071         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2072             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2073         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2074
  2075         16  CF-CL-ZIP-CODE.
  2076             20  CF-CL-ZIP-PRIME.
  2077                 24  CF-CL-ZIP-1ST          PIC X.
  2078                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2079                 24  FILLER                 PIC X(4).
  2080             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2081         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2082             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2083             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2084             20  FILLER                     PIC XXX.
  2085
  2086         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2087         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2088         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2089         16  CF-CO-OPTION-START-DATE        PIC XX.
  2090         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2091           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2092                                                      '3' '4'.
  2093           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2094           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2095           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2096           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2097           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2098           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2099
  2100         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2101
  2102         16  CF-PAYMENT-APPROVAL-LEVELS.
  2103             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2104             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2105             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2106             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2107             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2108             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2109
  2110         16  CF-END-USER-REPORTING-USER     PIC X.
  2111             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2112             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2113
  2114         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2115             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2116             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2117
  2118         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2119
  2120         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2121         16  FILLER                         PIC X.
  2122
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  45
* EL630.cbl
  2123         16  CF-CREDIT-ARCHIVE-CNTL.
  2124             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2125             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2126             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2127
  2128         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2129
  2130         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2131             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2132             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2133
  2134         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2135             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2136             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2137
  2138         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2139
  2140         16  CF-CO-ACH-ID-CODE              PIC  X.
  2141             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2142             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2143             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2144         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2145         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2146         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2147         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2148         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2149         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2150         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2151         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2152         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2153                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2154         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2155                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2156
  2157         16  CF-CO-OVER-SHORT.
  2158             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2159             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2160
  2161*         16  FILLER                         PIC X(102).
  2162         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2163             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2164             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2165
  2166         16  CF-AH-APPROVAL-DAYS.
  2167             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2168             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2169             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2170             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2171
  2172         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2173
  2174         16  CF-APPROV-LEV-5.
  2175             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2176             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2177             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2178
  2179         16  FILLER                         PIC X(68).
  2180****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  46
* EL630.cbl
  2181*             PROCESSOR/USER RECORD                            *
  2182****************************************************************
  2183
  2184     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2185         16  CF-PROCESSOR-NAME              PIC X(30).
  2186         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2187         16  CF-PROCESSOR-TITLE             PIC X(26).
  2188         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2189                 88  MESSAGE-YES                VALUE 'Y'.
  2190                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2191
  2192*****************************************************
  2193****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2194****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2195****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2196****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2197*****************************************************
  2198
  2199         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2200             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2201             20  CF-APPLICATION-FORCE       PIC X.
  2202             20  CF-INDIVIDUAL-APP.
  2203                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2204                     28  CF-BROWSE-APP      PIC X.
  2205                     28  CF-UPDATE-APP      PIC X.
  2206
  2207         16  CF-CURRENT-TERM-ON             PIC X(4).
  2208         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2209             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2210             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2211             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2212             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2213             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2214             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2215             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2216         16  CF-PROCESSOR-CARRIER           PIC X.
  2217             88  NO-CARRIER-SECURITY            VALUE ' '.
  2218         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2219             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2220         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2221             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2222         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2223             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2224
  2225         16  CF-PROC-SYS-ACCESS-SW.
  2226             20  CF-PROC-CREDIT-CLAIMS-SW.
  2227                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2228                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2229                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2230                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2231             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2232                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2233                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2234             20  CF-PROC-LIFE-GNRLDGR-SW.
  2235                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2236                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2237                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2238                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  47
* EL630.cbl
  2239             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2240                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2241                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2242         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2243             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2244             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2245         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2246
  2247         16  CF-APPROVAL-LEVEL                  PIC X.
  2248             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2249             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2250             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2251             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2252             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2253
  2254         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2255
  2256         16  CF-LANGUAGE-TYPE                   PIC X.
  2257             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2258             88  CF-LANG-IS-FR                      VALUE 'F'.
  2259
  2260         16  CF-CSR-IND                         PIC X.
  2261         16  FILLER                             PIC X(239).
  2262
  2263****************************************************************
  2264*             PROCESSOR/REMINDERS RECORD                       *
  2265****************************************************************
  2266
  2267     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2268         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2269             20  CF-START-REMIND-DT         PIC XX.
  2270             20  CF-END-REMIND-DT           PIC XX.
  2271             20  CF-REMINDER-TEXT           PIC X(50).
  2272         16  FILLER                         PIC X(296).
  2273
  2274
  2275****************************************************************
  2276*             STATE MASTER RECORD                              *
  2277****************************************************************
  2278
  2279     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2280         16  CF-STATE-ABBREVIATION          PIC XX.
  2281         16  CF-STATE-NAME                  PIC X(25).
  2282         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2283         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2284             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2285             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2286             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2287             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2288                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2289                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2290             20  CF-ST-PREM-REJECT-SW       PIC X.
  2291                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2292                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2293             20  CF-ST-REF-REJECT-SW        PIC X.
  2294                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2295                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2296         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  48
* EL630.cbl
  2297         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2298         16  CF-ST-REFUND-RULES.
  2299             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2300             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2301             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2302         16  CF-ST-FST-PMT-EXTENSION.
  2303             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2304             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2305                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2306                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2307                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2308                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2309         16  CF-ST-STATE-CALL.
  2310             20  CF-ST-CALL-UNEARNED        PIC X.
  2311             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2312             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2313         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2314             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2315             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2316         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2317         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2318         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2319         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2320         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2321         16  FILLER                         PIC X.
  2322         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2323             20  CF-ST-BENEFIT-CD           PIC XX.
  2324             20  CF-ST-BENEFIT-KIND         PIC X.
  2325                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2326                 88  CF-ST-AH-KIND              VALUE 'A'.
  2327             20  CF-ST-REM-TERM-CALC        PIC X.
  2328                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2329                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2330                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2331                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2332                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2333                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2334                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2335                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2336
  2337             20  CF-ST-REFUND-CALC          PIC X.
  2338                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2339                 88  ST-REFD-BY-R78             VALUE '1'.
  2340                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2341                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2342                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2343                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2344                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2345                 88  ST-REFD-UTAH               VALUE '7'.
  2346                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2347                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2348                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2349
  2350             20  CF-ST-EARNING-CALC         PIC X.
  2351                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2352                 88  ST-EARN-BY-R78             VALUE '1'.
  2353                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2354                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  49
* EL630.cbl
  2355                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2356                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2357                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2358                 88  ST-EARN-MEAN               VALUE '8'.
  2359                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2360
  2361             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2362                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2363                 88  ST-OVRD-BY-R78             VALUE '1'.
  2364                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2365                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2366                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2367                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2368                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2369                 88  ST-OVRD-MEAN               VALUE '8'.
  2370                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2371             20  cf-st-extra-periods        pic 9.
  2372*            20  FILLER                     PIC X.
  2373
  2374         16  CF-ST-COMMISSION-CAPS.
  2375             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2376             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2377             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2378             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2379         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2380                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2381
  2382         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2383
  2384         16  CF-ST-STATUTORY-INTEREST.
  2385             20  CF-ST-STAT-DATE-FROM       PIC X.
  2386                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2387                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2388             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2389             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2390             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2391             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2392             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2393
  2394         16  CF-ST-OVER-SHORT.
  2395             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2396             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2397
  2398         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2399
  2400         16  CF-ST-RT-CALC                  PIC X.
  2401
  2402         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2403         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2404         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2405         16  CF-ST-RF-LR-CALC               PIC X.
  2406         16  CF-ST-RF-LL-CALC               PIC X.
  2407         16  CF-ST-RF-LN-CALC               PIC X.
  2408         16  CF-ST-RF-AH-CALC               PIC X.
  2409         16  CF-ST-RF-CP-CALC               PIC X.
  2410*        16  FILLER                         PIC X(206).
  2411*CIDMOD         16  FILLER                         PIC X(192).
  2412         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  50
* EL630.cbl
  2413             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2414         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2415         16  CF-ST-VFY-2ND-BENE             PIC X.
  2416         16  CF-ST-CAUSAL-STATE             PIC X.
  2417         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2418         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2419         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2420             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2421         16  CF-ST-NET-ONLY-STATE           PIC X.
  2422             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2423         16  FILLER                         PIC X(181).
  2424
  2425****************************************************************
  2426*             BENEFIT MASTER RECORD                            *
  2427****************************************************************
  2428
  2429     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2430         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2431             20  CF-BENEFIT-CODE            PIC XX.
  2432             20  CF-BENEFIT-NUMERIC  REDEFINES
  2433                 CF-BENEFIT-CODE            PIC XX.
  2434             20  CF-BENEFIT-ALPHA           PIC XXX.
  2435             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2436             20  CF-BENEFIT-COMMENT         PIC X(10).
  2437
  2438             20  CF-LF-COVERAGE-TYPE        PIC X.
  2439                 88  CF-REDUCING                VALUE 'R'.
  2440                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2441
  2442             20  CF-SPECIAL-CALC-CD         PIC X.
  2443                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2444                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2445                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2446                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2447                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2448                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2449                 88  CF-FARM-PLAN               VALUE 'F'.
  2450                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2451                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2452                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2453                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2454                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2455                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2456                 88  CF-PRUDENTIAL              VALUE 'P'.
  2457                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2458                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2459                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2460                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2461                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2462                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2463
  2464             20  CF-JOINT-INDICATOR         PIC X.
  2465                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2466
  2467*            20  FILLER                     PIC X(12).
  2468             20  cf-maximum-benefits        pic s999 comp-3.
  2469             20  FILLER                     PIC X(09).
  2470             20  CF-BENEFIT-CATEGORY        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  51
* EL630.cbl
  2471             20  CF-LOAN-TYPE               PIC X(8).
  2472
  2473             20  CF-CO-REM-TERM-CALC        PIC X.
  2474                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2475                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2476                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2477                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2478                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2479
  2480             20  CF-CO-EARNINGS-CALC        PIC X.
  2481                 88  CO-EARN-BY-R78             VALUE '1'.
  2482                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2483                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2484                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2485                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2486                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2487                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2488                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2489
  2490             20  CF-CO-REFUND-CALC          PIC X.
  2491                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2492                 88  CO-REFD-BY-R78             VALUE '1'.
  2493                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2494                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2495                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2496                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2497                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2498                 88  CO-REFD-MEAN               VALUE '8'.
  2499                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2500                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2501                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2502
  2503             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2504                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2505                 88  CO-OVRD-BY-R78             VALUE '1'.
  2506                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2507                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2508                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2509                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2510                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2511                 88  CO-OVRD-MEAN               VALUE '8'.
  2512                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2513
  2514             20  CF-CO-BEN-I-G-CD           PIC X.
  2515                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2516                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2517                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2518
  2519         16  FILLER                         PIC X(304).
  2520
  2521
  2522****************************************************************
  2523*             CARRIER MASTER RECORD                            *
  2524****************************************************************
  2525
  2526     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2527         16  CF-ADDRESS-DATA.
  2528             20  CF-MAIL-TO-NAME            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  52
* EL630.cbl
  2529             20  CF-IN-CARE-OF              PIC X(30).
  2530             20  CF-ADDRESS-LINE-1          PIC X(30).
  2531             20  CF-ADDRESS-LINE-2          PIC X(30).
  2532             20  CF-CITY-STATE              PIC X(30).
  2533             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2534             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2535
  2536         16  CF-CLAIM-NO-CONTROL.
  2537             20  CF-CLAIM-NO-METHOD         PIC X.
  2538                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2539                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2540                 88  CLAIM-NO-SEQ               VALUE '3'.
  2541                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2542             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2543                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2544                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2545                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2546
  2547         16  CF-CHECK-NO-CONTROL.
  2548             20  CF-CHECK-NO-METHOD         PIC X.
  2549                 88  CHECK-NO-MANUAL            VALUE '1'.
  2550                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2551                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2552                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2553             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2554                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2555
  2556         16  CF-DOMICILE-STATE              PIC XX.
  2557
  2558         16  CF-EXPENSE-CONTROLS.
  2559             20  CF-EXPENSE-METHOD          PIC X.
  2560                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2561                 88  DOLLARS-PER-PMT            VALUE '2'.
  2562                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2563                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2564             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2565             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2566
  2567         16  CF-CORRESPONDENCE-CONTROL.
  2568             20  CF-LETTER-RESEND-OPT       PIC X.
  2569                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2570                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2571             20  FILLER                     PIC X(4).
  2572
  2573         16  CF-RESERVE-CONTROLS.
  2574             20  CF-MANUAL-SW               PIC X.
  2575                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2576             20  CF-FUTURE-SW               PIC X.
  2577                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2578             20  CF-PTC-SW                  PIC X.
  2579                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2580             20  CF-IBNR-SW                 PIC X.
  2581                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2582             20  CF-PTC-LF-SW               PIC X.
  2583                 88  CF-LF-PTC-USED             VALUE '1'.
  2584             20  CF-CDT-ACCESS-METHOD       PIC X.
  2585                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2586                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  53
* EL630.cbl
  2587                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2588             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2589
  2590         16  CF-CLAIM-CALC-METHOD           PIC X.
  2591             88  360-PLUS-MONTHS                VALUE '1'.
  2592             88  365-PLUS-MONTHS                VALUE '2'.
  2593             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2594             88  360-DAILY                      VALUE '4'.
  2595             88  365-DAILY                      VALUE '5'.
  2596
  2597         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2598         16  FILLER                         PIC X(11).
  2599
  2600         16  CF-LIMIT-AMOUNTS.
  2601             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2602             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2603             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2604             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2605             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2606             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2607             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2608             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2609             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2610             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2611
  2612         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2613         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2614         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2615
  2616         16  CF-ZIP-CODE.
  2617             20  CF-ZIP-PRIME.
  2618                 24  CF-ZIP-1ST             PIC X.
  2619                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2620                 24  FILLER                 PIC X(4).
  2621             20  CF-ZIP-PLUS4               PIC X(4).
  2622         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2623             20  CF-CAN-POSTAL-1            PIC XXX.
  2624             20  CF-CAN-POSTAL-2            PIC XXX.
  2625             20  FILLER                     PIC XXX.
  2626
  2627         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2628         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2629         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2630
  2631         16  CF-RATING-SWITCH               PIC X.
  2632             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2633             88  CF-NO-RATING                   VALUE 'N'.
  2634
  2635         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2636
  2637         16  CF-CARRIER-OVER-SHORT.
  2638             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2639             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2640
  2641         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2642         16  CF-SECPAY-SWITCH               PIC X.
  2643             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2644             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  54
* EL630.cbl
  2645         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2646         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2647         16  FILLER                         PIC X(444).
  2648*        16  FILLER                         PIC X(452).
  2649
  2650
  2651****************************************************************
  2652*             MORTALITY MASTER RECORD                          *
  2653****************************************************************
  2654
  2655     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2656         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2657                                INDEXED BY CF-MORT-NDX.
  2658             20  CF-MORT-TABLE              PIC X(5).
  2659             20  CF-MORT-TABLE-TYPE         PIC X.
  2660                 88  CF-MORT-JOINT              VALUE 'J'.
  2661                 88  CF-MORT-SINGLE             VALUE 'S'.
  2662                 88  CF-MORT-COMBINED           VALUE 'C'.
  2663                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2664                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2665             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2666             20  CF-MORT-AGE-METHOD         PIC XX.
  2667                 88  CF-AGE-LAST                VALUE 'AL'.
  2668                 88  CF-AGE-NEAR                VALUE 'AN'.
  2669             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2670             20  CF-MORT-ADJUSTMENT-DIRECTION
  2671                                            PIC X.
  2672                 88  CF-MINUS                   VALUE '-'.
  2673                 88  CF-PLUS                    VALUE '+'.
  2674             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2675             20  CF-MORT-JOINT-CODE         PIC X.
  2676                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2677             20  CF-MORT-PC-Q               PIC X.
  2678                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2679             20  CF-MORT-TABLE-CODE         PIC X(4).
  2680             20  CF-MORT-COMMENTS           PIC X(15).
  2681             20  FILLER                     PIC X(14).
  2682
  2683         16  FILLER                         PIC X(251).
  2684
  2685
  2686****************************************************************
  2687*             BUSSINESS TYPE MASTER RECORD                     *
  2688****************************************************************
  2689
  2690     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2691* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2692* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2693* AND RECORD 05 IS TYPES 81-99
  2694         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2695             20  CF-BUSINESS-TITLE          PIC  X(19).
  2696             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2697                                            PIC S9V9(4) COMP-3.
  2698             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2699             20  FILLER                     PIC  X.
  2700         16  FILLER                         PIC  X(248).
  2701
  2702
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  55
* EL630.cbl
  2703****************************************************************
  2704*             TERMINAL MASTER RECORD                           *
  2705****************************************************************
  2706
  2707     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2708
  2709         16  CF-COMPANY-TERMINALS.
  2710             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2711                                  PIC X(4).
  2712         16  FILLER               PIC X(248).
  2713
  2714
  2715****************************************************************
  2716*             LIFE EDIT MASTER RECORD                          *
  2717****************************************************************
  2718
  2719     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2720         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2721             20  CF-LIFE-CODE-IN            PIC XX.
  2722             20  CF-LIFE-CODE-OUT           PIC XX.
  2723         16  FILLER                         PIC X(248).
  2724
  2725
  2726****************************************************************
  2727*             AH EDIT MASTER RECORD                            *
  2728****************************************************************
  2729
  2730     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2731         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2732             20  CF-AH-CODE-IN              PIC XXX.
  2733             20  CF-AH-CODE-OUT             PIC XX.
  2734         16  FILLER                         PIC X(248).
  2735
  2736
  2737****************************************************************
  2738*             CREDIBILITY TABLES                               *
  2739****************************************************************
  2740
  2741     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2742         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2743                             INDEXED BY CF-CRDB-NDX.
  2744             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2745             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2746             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2747         16  FILLER                         PIC  X(332).
  2748
  2749
  2750****************************************************************
  2751*             REPORT CUSTOMIZATION RECORD                      *
  2752****************************************************************
  2753
  2754     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2755         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2756             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2757             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2758             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2759**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2760****       A T-TRANSFER.                                   ****
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  56
* EL630.cbl
  2761             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2762
  2763         16  FILLER                         PIC XX.
  2764
  2765         16  CF-CARRIER-CNTL-OPT.
  2766             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2767                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2768                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2769             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2770                                            PIC X.
  2771         16  CF-GROUP-CNTL-OPT.
  2772             20  CF-GROUP-OPT-SEQ           PIC 9.
  2773                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2774                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2775             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2776                                            PIC X(6).
  2777         16  CF-STATE-CNTL-OPT.
  2778             20  CF-STATE-OPT-SEQ           PIC 9.
  2779                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2780                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2781             20  CF-STATE-SELECT OCCURS 3 TIMES
  2782                                            PIC XX.
  2783         16  CF-ACCOUNT-CNTL-OPT.
  2784             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2785                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2786                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2787             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2788                                            PIC X(10).
  2789         16  CF-BUS-TYP-CNTL-OPT.
  2790             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2791                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2792                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2793             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2794                                            PIC XX.
  2795         16  CF-LF-TYP-CNTL-OPT.
  2796             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2797                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2798                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2799             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2800                                            PIC XX.
  2801         16  CF-AH-TYP-CNTL-OPT.
  2802             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2803                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2804                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2805             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2806                                            PIC XX.
  2807         16  CF-REPTCD1-CNTL-OPT.
  2808             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2809                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2810                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2811             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2812                                            PIC X(10).
  2813         16  CF-REPTCD2-CNTL-OPT.
  2814             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2815                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2816                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2817             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2818                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  57
* EL630.cbl
  2819         16  CF-USER1-CNTL-OPT.
  2820             20  CF-USER1-OPT-SEQ           PIC 9.
  2821                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2822                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2823             20  CF-USER1-SELECT OCCURS 3 TIMES
  2824                                            PIC X(10).
  2825         16  CF-USER2-CNTL-OPT.
  2826             20  CF-USER2-OPT-SEQ           PIC 9.
  2827                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2828                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2829             20  CF-USER2-SELECT OCCURS 3 TIMES
  2830                                            PIC X(10).
  2831         16  CF-USER3-CNTL-OPT.
  2832             20  CF-USER3-OPT-SEQ           PIC 9.
  2833                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2834                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2835             20  CF-USER3-SELECT OCCURS 3 TIMES
  2836                                            PIC X(10).
  2837         16  CF-USER4-CNTL-OPT.
  2838             20  CF-USER4-OPT-SEQ           PIC 9.
  2839                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2840                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2841             20  CF-USER4-SELECT OCCURS 3 TIMES
  2842                                            PIC X(10).
  2843         16  CF-USER5-CNTL-OPT.
  2844             20  CF-USER5-OPT-SEQ           PIC 9.
  2845                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2846                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2847             20  CF-USER5-SELECT OCCURS 3 TIMES
  2848                                            PIC X(10).
  2849         16  CF-REINS-CNTL-OPT.
  2850             20  CF-REINS-OPT-SEQ           PIC 9.
  2851                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2852                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2853             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2854                 24  CF-REINS-PRIME         PIC XXX.
  2855                 24  CF-REINS-SUB           PIC XXX.
  2856
  2857         16  CF-AGENT-CNTL-OPT.
  2858             20  CF-AGENT-OPT-SEQ           PIC 9.
  2859                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2860                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2861             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2862                                            PIC X(10).
  2863
  2864         16  FILLER                         PIC X(43).
  2865
  2866         16  CF-LOSS-RATIO-SELECT.
  2867             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2868             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2869         16  CF-ENTRY-DATE-SELECT.
  2870             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2871             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2872         16  CF-EFFECTIVE-DATE-SELECT.
  2873             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2874             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2875
  2876         16  CF-EXCEPTION-LIST-IND          PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  58
* EL630.cbl
  2877             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2878
  2879         16  FILLER                         PIC X(318).
  2880
  2881****************************************************************
  2882*                  EXCEPTION REPORTING RECORD                  *
  2883****************************************************************
  2884
  2885     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2886         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2887             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2888
  2889         16  CF-COMBINED-LIFE-AH-OPT.
  2890             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2891             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2892             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2893             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2894
  2895         16  CF-LIFE-OPT.
  2896             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2897             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2898             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2899             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2900             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2901             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2902             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2903             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2904             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2905             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2906
  2907         16  CF-AH-OPT.
  2908             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2909             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2910             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2911             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2912             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2913             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2914             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2915             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2916             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2917             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2918
  2919         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2920             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2921             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2922             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2923
  2924         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2925
  2926         16  FILLER                         PIC X(673).
  2927
  2928
  2929****************************************************************
  2930*             MORTGAGE SYSTEM PLAN RECORD                      *
  2931****************************************************************
  2932
  2933     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2934         16  CF-PLAN-TYPE                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  59
* EL630.cbl
  2935             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2936             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2937             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2938         16  CF-PLAN-ABBREV                 PIC XXX.
  2939         16  CF-PLAN-DESCRIPT               PIC X(10).
  2940         16  CF-PLAN-NOTES                  PIC X(20).
  2941         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2942         16  CF-PLAN-UNDERWRITING.
  2943             20  CF-PLAN-TERM-DATA.
  2944                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2945                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2946             20  CF-PLAN-AGE-DATA.
  2947                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2948                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2949                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2950             20  CF-PLAN-BENEFIT-DATA.
  2951                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2952                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2953                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2954                                            PIC S9(7)V99  COMP-3.
  2955         16  CF-PLAN-POLICY-FORMS.
  2956             20  CF-POLICY-FORM             PIC X(12).
  2957             20  CF-MASTER-APPLICATION      PIC X(12).
  2958             20  CF-MASTER-POLICY           PIC X(12).
  2959         16  CF-PLAN-RATING.
  2960             20  CF-RATE-CODE               PIC X(5).
  2961             20  CF-SEX-RATING              PIC X.
  2962                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2963                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2964             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2965             20  CF-SUB-STD-TYPE            PIC X.
  2966                 88  CF-PCT-OF-PREM            VALUE '1'.
  2967                 88  CF-PCT-OF-BENE            VALUE '2'.
  2968         16  CF-PLAN-PREM-TOLERANCES.
  2969             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2970             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2971         16  CF-PLAN-PYMT-TOLERANCES.
  2972             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2973             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2974         16  CF-PLAN-MISC-DATA.
  2975             20  FILLER                     PIC X.
  2976             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2977             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2978         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2979         16  CF-PLAN-IND-GRP                PIC X.
  2980             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2981                                                     '1'.
  2982             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2983                                                     '2'.
  2984         16  CF-MIB-SEARCH-SW               PIC X.
  2985             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2986             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2987             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2988             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2989         16  CF-ALPHA-SEARCH-SW             PIC X.
  2990             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2991             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2992             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  60
* EL630.cbl
  2993             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2994             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2995             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2996             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2997             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2998             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2999             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3000                                                     'A' 'B' 'C'
  3001                                                     'X' 'Y' 'Z'.
  3002         16  CF-EFF-DT-RULE-SW              PIC X.
  3003             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3004             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3005             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3006             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3007             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3008         16  FILLER                         PIC X(4).
  3009         16  CF-HEALTH-QUESTIONS            PIC X.
  3010             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3011         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3012         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3013         16  CF-PLAN-SNGL-JNT               PIC X.
  3014             88  CF-COMBINED-PLAN              VALUE 'C'.
  3015             88  CF-JNT-PLAN                   VALUE 'J'.
  3016             88  CF-SNGL-PLAN                  VALUE 'S'.
  3017         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3018         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3019         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3020         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3021         16  CF-RERATE-CNTL                 PIC  X.
  3022             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3023             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3024             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3025             88  CF-AUTO-RECALC                 VALUE '4'.
  3026         16  CF-BENEFIT-TYPE                PIC  X.
  3027             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3028             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3029         16  CF-POLICY-FEE                  PIC S999V99
  3030                                                    COMP-3.
  3031         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3032         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3033         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3034         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3035         16  FILLER                         PIC  X(32).
  3036         16  CF-TERMINATION-FORM            PIC  X(04).
  3037         16  FILLER                         PIC  X(08).
  3038         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3039                                                       COMP-3.
  3040         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3041         16  CF-ISSUE-LETTER                PIC  X(4).
  3042         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3043         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3044             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3045             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3046         16  CF-MP-REFUND-CALC              PIC X.
  3047             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3048             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3049             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3050             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  61
* EL630.cbl
  3051             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3052             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3053             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3054             88  CF-MP-REFD-MEAN                VALUE '8'.
  3055         16  CF-ALT-RATE-CODE               PIC  X(5).
  3056
  3057
  3058         16  FILLER                         PIC X(498).
  3059****************************************************************
  3060*             MORTGAGE COMPANY MASTER RECORD                   *
  3061****************************************************************
  3062
  3063     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3064         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3065         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3066             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3067             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3068             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3069             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3070             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3071
  3072         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3073         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3074         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3075         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3076         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3077
  3078         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3079             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3080         16  CF-MP-RECON-USE-IND            PIC X(1).
  3081             88  CF-MP-USE-RECON             VALUE 'Y'.
  3082         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3083             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3084         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3085             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3086             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3087         16  FILLER                         PIC X(1).
  3088         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3089             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3090         16  CF-MORTG-MIB-VERSION           PIC X.
  3091             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3092             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3093             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3094         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3095             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3096                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3097             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3098                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3099             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3100                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3101             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3102                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3103             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3104                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3105             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3106                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3107         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3108         16  FILLER                         PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  62
* EL630.cbl
  3109         16  CF-MORTG-DESTINATION-SYMBOL.
  3110             20  CF-MORTG-MIB-COMM          PIC X(5).
  3111             20  CF-MORTG-MIB-TERM          PIC X(5).
  3112         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3113             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3114         16  FILLER                         PIC X(03).
  3115         16  CF-MP-CHECK-NO-CONTROL.
  3116             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3117                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3118                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3119                                                ' ' LOW-VALUES.
  3120                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3121                                               VALUE '3'.
  3122         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3123         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3124         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3125             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3126                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3127             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3128                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3129             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3130                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3131             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3132                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3133             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3134                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3135             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3136                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3137         16  CF-MORTG-BILLING-AREA.
  3138             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3139                                            PIC X.
  3140         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3141         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3142         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3143         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3144             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3145             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3146         16  FILLER                         PIC X.
  3147         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3148             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3149             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3150         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3151         16  FILLER                         PIC X(8).
  3152         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3153         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3154         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3155         16  CF-ACH-COMPANY-ID.
  3156             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3157                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3158                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3159                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3160             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3161         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3162             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3163         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3164             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3165             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3166         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  63
* EL630.cbl
  3167         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3168         16  FILLER                         PIC X(536).
  3169
  3170****************************************************************
  3171*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3172****************************************************************
  3173
  3174     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3175         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3176             20  CF-FEMALE-HEIGHT.
  3177                 24  CF-FEMALE-FT           PIC 99.
  3178                 24  CF-FEMALE-IN           PIC 99.
  3179             20  CF-FEMALE-MIN-WT           PIC 999.
  3180             20  CF-FEMALE-MAX-WT           PIC 999.
  3181         16  FILLER                         PIC X(428).
  3182
  3183     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3184         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3185             20  CF-MALE-HEIGHT.
  3186                 24  CF-MALE-FT             PIC 99.
  3187                 24  CF-MALE-IN             PIC 99.
  3188             20  CF-MALE-MIN-WT             PIC 999.
  3189             20  CF-MALE-MAX-WT             PIC 999.
  3190         16  FILLER                         PIC X(428).
  3191******************************************************************
  3192*             AUTOMATIC ACTIVITY RECORD                          *
  3193******************************************************************
  3194     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3195         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3196             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3197             20  CF-SYS-LETTER-ID           PIC X(04).
  3198             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3199             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3200             20  CF-SYS-RESET-SW            PIC X(01).
  3201             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3202             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3203
  3204         16  FILLER                         PIC X(50).
  3205
  3206         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3207             20  CF-USER-ACTIVE-SW          PIC X(01).
  3208             20  CF-USER-LETTER-ID          PIC X(04).
  3209             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3210             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3211             20  CF-USER-RESET-SW           PIC X(01).
  3212             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3213             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3214             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3215
  3216         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  64
* EL630.cbl
  3218*    COPY ERCPNDB.
  3219******************************************************************
  3220*                                                                *
  3221*                                                                *
  3222*                            ERCPNDB.                            *
  3223*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3224*                            VMOD=2.025                          *
  3225*                                                                *
  3226*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3227*                                                                *
  3228******************************************************************
  3229*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3230*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3231******************************************************************
  3232*                                                                *
  3233*                                                                *
  3234*   FILE TYPE = VSAM,KSDS                                        *
  3235*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3236*                                                                *
  3237*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3238*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3239*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3240*                                                 RKP=13,LEN=36  *
  3241*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3242*                                      AND CHG-SEQ.)             *
  3243*                                                RKP=49,LEN=11   *
  3244*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3245*                                      AND CHG-SEQ.)             *
  3246*                                                RKP=60,LEN=15   *
  3247*                                                                *
  3248*   LOG = NO                                                     *
  3249*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3250******************************************************************
  3251******************************************************************
  3252*                   C H A N G E   L O G
  3253*
  3254* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3255*-----------------------------------------------------------------
  3256*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3257* EFFECTIVE    NUMBER
  3258*-----------------------------------------------------------------
  3259* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3260* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3261* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3262* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3263* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3264* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3265* 032306                   PEMA  ADD BOW LOAN NUMBER
  3266* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3267* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3268* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3269* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3270* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3271* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3272* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3273* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3274* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3275* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  65
* EL630.cbl
  3276******************************************************************
  3277
  3278 01  PENDING-BUSINESS.
  3279     12  PB-RECORD-ID                     PIC XX.
  3280         88  VALID-PB-ID                        VALUE 'PB'.
  3281
  3282     12  PB-CONTROL-PRIMARY.
  3283         16  PB-COMPANY-CD                PIC X.
  3284         16  PB-ENTRY-BATCH               PIC X(6).
  3285         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3286         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3287
  3288     12  PB-CONTROL-BY-ACCOUNT.
  3289         16  PB-COMPANY-CD-A1             PIC X.
  3290         16  PB-CARRIER                   PIC X.
  3291         16  PB-GROUPING.
  3292             20  PB-GROUPING-PREFIX       PIC XXX.
  3293             20  PB-GROUPING-PRIME        PIC XXX.
  3294         16  PB-STATE                     PIC XX.
  3295         16  PB-ACCOUNT.
  3296             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3297             20  PB-ACCOUNT-PRIME         PIC X(6).
  3298         16  PB-CERT-EFF-DT               PIC XX.
  3299         16  PB-CERT-NO.
  3300             20  PB-CERT-PRIME            PIC X(10).
  3301             20  PB-CERT-SFX              PIC X.
  3302         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3303
  3304         16  PB-RECORD-TYPE               PIC X.
  3305             88  PB-MAILING-DATA                VALUE '0'.
  3306             88  PB-ISSUE                       VALUE '1'.
  3307             88  PB-CANCELLATION                VALUE '2'.
  3308             88  PB-BATCH-TRAILER               VALUE '9'.
  3309
  3310     12  PB-CONTROL-BY-ORIG-BATCH.
  3311         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3312         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3313         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3314         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3315
  3316     12  PB-CONTROL-BY-CSR.
  3317         16  PB-CSR-COMPANY-CD            PIC X.
  3318         16  PB-CSR-ID                    PIC X(4).
  3319         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3320         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3321         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3322******************************************************************
  3323*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3324******************************************************************
  3325
  3326     12  PB-LAST-MAINT-DT                 PIC XX.
  3327     12  PB-LAST-MAINT-BY                 PIC X(4).
  3328     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3329
  3330     12  PB-RECORD-BODY                   PIC X(375).
  3331
  3332     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3333         16  PB-CERT-ORIGIN               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  66
* EL630.cbl
  3334             88  CLASIC-CREATED-CERT         VALUE '1'.
  3335         16  PB-I-NAME.
  3336             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3337             20  PB-I-INSURED-FIRST-NAME.
  3338                 24  PB-I-INSURED-1ST-INIT PIC X.
  3339                 24  FILLER                PIC X(9).
  3340             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3341         16  PB-I-AGE                     PIC S99   COMP-3.
  3342         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3343         16  PB-I-BIRTHDAY                PIC XX.
  3344         16  PB-I-INSURED-SEX             PIC X.
  3345             88  PB-SEX-MALE     VALUE 'M'.
  3346             88  PB-SEX-FEMALE   VALUE 'F'.
  3347
  3348         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3349         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3350         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3351         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3352         16  PB-I-SKIP-CODE               PIC X.
  3353             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3354             88  PB-SKIP-JULY              VALUE '1'.
  3355             88  PB-SKIP-AUGUST            VALUE '2'.
  3356             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3357             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3358             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3359             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3360             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3361             88  PB-SKIP-JUNE              VALUE '8'.
  3362             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3363             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3364             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3365         16  PB-I-TERM-TYPE               PIC X.
  3366             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3367             88  PB-PAID-WEEKLY            VALUE 'W'.
  3368             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3369             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3370             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3371         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3372         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3373         16  PB-I-DATA-ENTRY-SW           PIC X.
  3374             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3375             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3376             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3377             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3378         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3379         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3380*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3381         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3382         16  FILLER                       PIC X.
  3383
  3384         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  3385             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3386             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3387                                                   '90' THRU '99'.
  3388         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3389                                          PIC XX.
  3390         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3391         16  PB-I-AMOUNT-FINANCED REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  67
* EL630.cbl
  3392                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3393         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3394         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3395                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3396         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3397         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3398         16  PB-I-CLP-AMOUNT REDEFINES
  3399                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3400         16  PB-I-LF-CALC-FLAG            PIC X.
  3401             88 PB-COMP-LF-PREM               VALUE '?'.
  3402         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3403         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3404         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3405         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3406         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3407         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3408         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3409         16  PB-I-LF-ABBR                 PIC XXX.
  3410         16  PB-I-LF-INPUT-CD             PIC XX.
  3411
  3412         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3413             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3414             88  PB-INVALID-AH               VALUE '  ' '00'
  3415                                                   '90' THRU '99'.
  3416         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3417         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3418         16  PB-I-AH-CALC-FLAG            PIC X.
  3419             88 PB-COMP-AH-PREM                  VALUE '?'.
  3420         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3421         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3422         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  3423         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3424         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3425         16  PB-I-AH-ABBR                 PIC XXX.
  3426         16  PB-I-AH-INPUT-CD             PIC XXX.
  3427
  3428         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3429         16  PB-I-REIN-TABLE              PIC XXX.
  3430         16  PB-I-BUSINESS-TYPE           PIC 99.
  3431         16  PB-I-INDV-GRP-CD             PIC X.
  3432         16  PB-I-MORT-CODE.
  3433             20  PB-I-TABLE               PIC X.
  3434             20  PB-I-INTEREST            PIC XX.
  3435             20  PB-I-MORT-TYP            PIC X.
  3436         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  3437         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  3438         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  3439         16  PB-I-INDV-GRP-OVRD           PIC X.
  3440         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  3441         16  PB-I-SIG-SW                  PIC X.
  3442             88  PB-POLICY-SIGNED             VALUE 'Y'.
  3443         16  PB-I-RATE-CLASS              PIC XX.
  3444         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  3445         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3446         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  3447         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3448         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3449         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  68
* EL630.cbl
  3450         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  3451         16  PB-I-BENEFIT-TYPE            PIC XXX.
  3452         16  PB-I-OB-FLAG                 PIC X.
  3453             88  PB-I-OB                      VALUE 'B'.
  3454             88  PB-I-SUMMARY                 VALUE 'Z'.
  3455         16  PB-I-ENTRY-STATUS            PIC X.
  3456             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3457                                              'M' '5' '9' '2'.
  3458             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3459             88  PB-I-POLICY-PENDING          VALUE '2'.
  3460             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3461             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3462             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  3463             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3464             88  PB-I-REIN-ONLY               VALUE '9'.
  3465             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3466             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3467             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3468             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3469         16  PB-I-INT-CODE                PIC X.
  3470             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3471             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3472         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3473         16  PB-I-SOC-SEC-NO              PIC X(11).
  3474         16  PB-I-MEMBER-NO               PIC X(12).
  3475         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3476*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3477         16  PB-I-OLD-LOF                 PIC XXX.
  3478         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3479         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3480         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3481         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3482         16  PB-I-LIFE-INDICATOR          PIC X.
  3483             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3484         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3485         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  3486                                          PIC S9(5)V99    COMP-3.
  3487         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3488             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3489             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3490         16  PB-I-1ST-PMT-DT              PIC XX.
  3491         16  PB-I-JOINT-INSURED.
  3492             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3493             20 PB-I-JOINT-FIRST-NAME.
  3494                24  PB-I-JOINT-FIRST-INIT PIC X.
  3495                24  FILLER                PIC X(9).
  3496             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3497*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3498         16  PB-I-BENEFICIARY-NAME.
  3499             20  PB-I-BANK-NUMBER         PIC X(10).
  3500             20  FILLER                   PIC X(15).
  3501         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  3502         16  PB-I-REFERENCE               PIC X(12).
  3503         16  FILLER REDEFINES PB-I-REFERENCE.
  3504             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  3505             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3506             20  PB-I-CLP-STATE           PIC XX.
  3507         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  69
* EL630.cbl
  3508             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  3509             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3510             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3511         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3512         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  3513         16  PB-I-RESIDENT-STATE          PIC XX.
  3514         16  PB-I-RATE-CODE               PIC X(4).
  3515         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3516         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3517         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3518         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3519         16  PB-I-BANK-NOCHRGB            PIC 99.
  3520         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3521         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3522
  3523     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3524         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3525             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3526         16  PB-C-CANCEL-ORIGIN           PIC X.
  3527             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3528         16  PB-C-LF-CANCEL-DT            PIC XX.
  3529         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3530         16  PB-C-LF-CALC-REQ             PIC X.
  3531             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3532         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3533         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  3534         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  3535             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  3536         16  PB-C-AH-CANCEL-DT            PIC XX.
  3537         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3538         16  PB-C-AH-CALC-REQ             PIC X.
  3539             88 PB-COMP-AH-CANCEL            VALUE '?'.
  3540         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  3541         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  3542         16  PB-C-LAST-NAME               PIC X(15).
  3543         16  PB-C-REFUND-SW               PIC X.
  3544             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  3545             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  3546         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  3547         16  PB-C-PAYEE-CODE              PIC X(6).
  3548         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  3549         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  3550         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  3551         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  3552         16  PB-C-REFERENCE               PIC X(12).
  3553         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3554         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3555         16  PB-C-POST-CARD-IND           PIC X.
  3556         16  PB-C-CANCEL-REASON           PIC X.
  3557         16  PB-C-REF-INTERFACE-SW        PIC X.
  3558         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  3559         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  3560         16  FILLER                       PIC X(01).
  3561*        16  FILLER                       PIC X(18).
  3562         16  PB-C-POLICY-FORM-NO          PIC X(12).
  3563*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  3564         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  3565         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  70
* EL630.cbl
  3566             20  PB-CI-INSURED-NAME.
  3567                 24  PB-CI-LAST-NAME      PIC X(15).
  3568                 24  PB-CI-INITIALS       PIC XX.
  3569             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  3570             20  PB-CI-INSURED-SEX        PIC X.
  3571             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  3572             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  3573             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  3574             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  3575             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3576             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  3577             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  3578             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  3579             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  3580             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3581             20  PB-CI-RATE-CLASS         PIC XX.
  3582             20  PB-CI-RATE-DEV-LF        PIC XXX.
  3583             20  PB-CI-RATE-DEV-AH        PIC XXX.
  3584             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  3585             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  3586             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  3587             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  3588             20  PB-CI-LF-ABBR            PIC X(3).
  3589             20  PB-CI-AH-ABBR            PIC X(3).
  3590             20  PB-CI-OB-FLAG            PIC X.
  3591                 88  PB-CI-OB                VALUE 'B'.
  3592             20  PB-CI-LF-POLICY-STATUS   PIC X.
  3593                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  3594                                           'M' '4' '5' '9' '2'.
  3595                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  3596                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  3597                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  3598                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  3599                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  3600                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  3601                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3602                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  3603                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3604                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  3605                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  3606                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  3607                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  3608             20  PB-CI-AH-POLICY-STATUS   PIC X.
  3609                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  3610                                           'M' '4' '5' '9' '2'.
  3611                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  3612                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  3613                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  3614                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  3615                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  3616                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  3617                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3618                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  3619                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3620                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  3621                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  3622                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  3623                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  71
* EL630.cbl
  3624             20  PB-CI-PAY-FREQUENCY      PIC 99.
  3625             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  3626             20  PB-CI-SOC-SEC-NO         PIC X(11).
  3627             20  PB-CI-MEMBER-NO          PIC X(12).
  3628             20  PB-CI-INT-CODE           PIC X.
  3629                 88  PB-CI-ADD-ON                  VALUE 'A'.
  3630                 88  PB-CI-SIMPLE                  VALUE 'S'.
  3631             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  3632             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  3633             20  PB-CI-COMP-EXCP-SW       PIC X.
  3634                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  3635                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  3636             20  PB-CI-ENTRY-STATUS       PIC X.
  3637             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  3638             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  3639             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  3640             20  PB-CI-DEATH-DT           PIC XX.
  3641             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  3642             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  3643             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3644             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3645             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  3646             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  3647             20  PB-CI-ENTRY-DT              PIC XX.
  3648             20  PB-CI-ENTRY-BATCH           PIC X(6).
  3649             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  3650             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  3651             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  3652             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  3653             20  PB-CI-OLD-LOF               PIC XXX.
  3654*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  3655             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  3656             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  3657             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  3658             20  PB-CI-INDV-GRP-CD           PIC X.
  3659             20  PB-CI-BENEFICIARY-NAME.
  3660                 24  PB-CI-BANK-NUMBER       PIC X(10).
  3661                 24  FILLER                  PIC X(15).
  3662             20  PB-CI-NOTE-SW               PIC X.
  3663             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  3664             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  3665             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  3666             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  3667             20  PB-CI-LOAN-OFFICER          PIC X(5).
  3668             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  3669             20  PB-CI-FIRST-NAME            PIC X(10).
  3670             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  3671
  3672         16  FILLER                       PIC X(13).
  3673*032306  16  FILLER                       PIC X(27).
  3674*        16  FILLER                       PIC X(46).
  3675
  3676     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  3677         16  FILLER                       PIC X(10).
  3678         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  3679         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  3680         16  PB-M-INSURED-MID-INIT        PIC X.
  3681         16  PB-M-INSURED-AGE             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  72
* EL630.cbl
  3682         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  3683         16  PB-M-INSURED-SEX             PIC X.
  3684         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  3685         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  3686         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  3687         16  PB-M-INSURED-CITY-STATE.
  3688             20  PB-M-INSURED-CITY        PIC X(28).
  3689             20  PB-M-INSURED-STATE       PIC XX.
  3690         16  PB-M-INSURED-ZIP-CODE.
  3691             20  PB-M-INSURED-ZIP-PRIME.
  3692                 24  PB-M-INSURED-ZIP-1   PIC X.
  3693                     88  PB-M-CANADIAN-POST-CODE
  3694                                             VALUE 'A' THRU 'Z'.
  3695                 24  FILLER               PIC X(4).
  3696             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  3697         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  3698                                        PB-M-INSURED-ZIP-CODE.
  3699             20  PM-M-INS-CAN-POST1       PIC XXX.
  3700             20  PM-M-INS-CAN-POST2       PIC XXX.
  3701             20  FILLER                   PIC XXX.
  3702         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  3703         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  3704         16  PB-M-CRED-BENE-NAME          PIC X(30).
  3705         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  3706         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  3707         16  PB-M-CRED-BENE-CITYST.
  3708             20  PB-M-CRED-BENE-CITY      PIC X(28).
  3709             20  PB-M-CRED-BENE-STATE     PIC XX.
  3710         16  FILLER                       PIC X(92).
  3711
  3712     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  3713         16  FILLER                       PIC X(10).
  3714         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3715         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3716         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3717         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3718         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3719         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3720         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3721         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3722         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3723         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3724         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3725         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3726         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  3727         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  3728         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  3729         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  3730         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  3731         16  PB-ACCOUNT-NAME              PIC X(30).
  3732         16  PB-PREM-REF-RPT-FLAG         PIC X.
  3733         16  PB-REFERENCE                 PIC X(12).
  3734         16  PB-B-RECEIVED-DT             PIC XX.
  3735         16  FILLER                       PIC X(234).
  3736
  3737     12  PB-RECORD-STATUS.
  3738         16  PB-CREDIT-SELECT-DT          PIC XX.
  3739         16  PB-CREDIT-ACCEPT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  73
* EL630.cbl
  3740         16  PB-BILLED-DT                 PIC XX.
  3741         16  PB-BILLING-STATUS            PIC X.
  3742             88  PB-ENTRY-REVERSED            VALUE 'R'.
  3743             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  3744             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  3745         16  PB-RECORD-BILL               PIC X.
  3746             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  3747             88  PB-RECORD-RETURNED           VALUE 'R'.
  3748             88  PB-RECORD-ENDORSED           VALUE 'E'.
  3749             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  3750             88  PB-OVERRIDE-AH               VALUE 'A'.
  3751             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  3752         16  PB-BATCH-ENTRY               PIC X.
  3753             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  3754             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  3755             88  PB-REISSUED-CERT             VALUE 'E'.
  3756             88  PB-CASH-CERT                 VALUE 'C'.
  3757             88  PB-MONTHLY-CERT              VALUE 'M'.
  3758             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  3759             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  3760             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  3761         16  PB-FORCE-CODE                PIC X.
  3762             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  3763             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  3764             88  PB-CANCEL-FORCE              VALUE '8'.
  3765             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  3766             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  3767             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  3768             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  3769             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  3770             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  3771             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  3772         16  PB-FATAL-FLAG                PIC X.
  3773             88  PB-FATAL-ERRORS              VALUE 'X'.
  3774         16  PB-FORCE-ER-CD               PIC X.
  3775             88  PB-FORCE-ERRORS              VALUE 'F'.
  3776             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  3777         16  PB-WARN-ER-CD                PIC X.
  3778             88  PB-WARNING-ERRORS            VALUE 'W'.
  3779         16  FILLER                       PIC X.
  3780         16  PB-OUT-BAL-CD                PIC X.
  3781             88  PB-OUT-OF-BAL                VALUE 'O'.
  3782         16  PB-LIFE-OVERRIDE-L1          PIC X.
  3783         16  PB-AH-OVERRIDE-L1            PIC X.
  3784         16  PB-INPUT-DT                  PIC XX.
  3785         16  PB-INPUT-BY                  PIC X(4).
  3786         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  3787         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  3788         16  PB-TOLERANCE-REJECT-SW       PIC X.
  3789         16  PB-LF-EARNING-METHOD         PIC X.
  3790         16  PB-AH-EARNING-METHOD         PIC X.
  3791         16  PB-LF-TERM-CALC-METHOD       PIC X.
  3792         16  PB-AH-TERM-CALC-METHOD       PIC X.
  3793         16  PB-REIN-CD                   PIC XXX.
  3794         16  PB-LF-REFUND-TYPE            PIC X.
  3795         16  PB-AH-REFUND-TYPE            PIC X.
  3796         16  PB-ACCT-EFF-DT               PIC XX.
  3797         16  PB-ACCT-EXP-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  74
* EL630.cbl
  3798         16  PB-COMPANY-ID                PIC X(3).
  3799         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3800         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3801         16  PB-SV-CARRIER                PIC X.
  3802         16  PB-SV-GROUPING               PIC X(6).
  3803         16  PB-SV-STATE                  PIC XX.
  3804         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  3805         16  PB-GA-BILLING-INFO.
  3806             20  PB-GA-BILL-DT OCCURS 5 TIMES
  3807                                          PIC XX.
  3808         16  PB-SV-REMIT-TO  REDEFINES
  3809             PB-GA-BILLING-INFO           PIC X(10).
  3810         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  3811         16  PB-I-LOAN-OFFICER            PIC X(5).
  3812         16  PB-I-VIN                     PIC X(17).
  3813
  3814         16  FILLER                       PIC X(04).
  3815         16  IMNET-BYPASS-SW              PIC X.
  3816
  3817******************************************************************
  3818*                COMMON EDIT ERRORS                              *
  3819******************************************************************
  3820
  3821     12  PB-COMMON-ERRORS.
  3822         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  3823                                           PIC S9(4)     COMP.
  3824
  3825******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  75
* EL630.cbl
  3827*    COPY ERCACCT.
  3828******************************************************************
  3829*                                                                *
  3830*                                                                *
  3831*                            ERCACCT                             *
  3832*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3833*                            VMOD=2.031                          *
  3834*                                                                *
  3835*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3836*                                                                *
  3837*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3838*   VSAM ACCOUNT MASTER FILES.                                   *
  3839*                                                                *
  3840*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3841*                                                                *
  3842*   FILE TYPE = VSAM,KSDS                                        *
  3843*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3844*                                                                *
  3845*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3846*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3847*                                                                *
  3848*   LOG = NO                                                     *
  3849*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3850*                                                                *
  3851*                                                                *
  3852******************************************************************
  3853*                   C H A N G E   L O G
  3854*
  3855* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3856*-----------------------------------------------------------------
  3857*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3858* EFFECTIVE    NUMBER
  3859*-----------------------------------------------------------------
  3860* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3861* 092705    2005050300006  PEMA  ADD SPP LEASES
  3862* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3863* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3864* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3865* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3866* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3867******************************************************************
  3868
  3869 01  ACCOUNT-MASTER.
  3870     12  AM-RECORD-ID                      PIC XX.
  3871         88  VALID-AM-ID                      VALUE 'AM'.
  3872
  3873     12  AM-CONTROL-PRIMARY.
  3874         16  AM-COMPANY-CD                 PIC X.
  3875         16  AM-MSTR-CNTRL.
  3876             20  AM-CONTROL-A.
  3877                 24  AM-CARRIER            PIC X.
  3878                 24  AM-GROUPING.
  3879                     28 AM-GROUPING-PREFIX PIC XXX.
  3880                     28 AM-GROUPING-PRIME  PIC XXX.
  3881                 24  AM-STATE              PIC XX.
  3882                 24  AM-ACCOUNT.
  3883                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3884                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  76
* EL630.cbl
  3885             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3886                                           PIC X(19).
  3887             20  AM-CNTRL-B.
  3888                 24  AM-EXPIRATION-DT      PIC XX.
  3889                 24  FILLER                PIC X(4).
  3890             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3891                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3892
  3893     12  AM-CONTROL-BY-VAR-GRP.
  3894         16  AM-COMPANY-CD-A1              PIC X.
  3895         16  AM-VG-CARRIER                 PIC X.
  3896         16  AM-VG-GROUPING                PIC X(6).
  3897         16  AM-VG-STATE                   PIC XX.
  3898         16  AM-VG-ACCOUNT                 PIC X(10).
  3899         16  AM-VG-DATE.
  3900             20  AM-VG-EXPIRATION-DT       PIC XX.
  3901             20  FILLER                    PIC X(4).
  3902         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3903                                           PIC 9(11)      COMP-3.
  3904     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3905         16  FILLER                        PIC X(10).
  3906         16  AM-VG-KEY3.
  3907             20  AM-VG3-ACCOUNT            PIC X(10).
  3908             20  AM-VG3-EXP-DT             PIC XX.
  3909         16  FILLER                        PIC X(4).
  3910     12  AM-MAINT-INFORMATION.
  3911         16  AM-LAST-MAINT-DT              PIC XX.
  3912         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3913         16  AM-LAST-MAINT-USER            PIC X(4).
  3914         16  FILLER                        PIC XX.
  3915
  3916     12  AM-EFFECTIVE-DT                   PIC XX.
  3917     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3918
  3919     12  AM-PREV-DATES  COMP-3.
  3920         16  AM-PREV-EXP-DT                PIC 9(11).
  3921         16  AM-PREV-EFF-DT                PIC 9(11).
  3922
  3923     12  AM-REPORT-CODE-1                  PIC X(10).
  3924     12  AM-REPORT-CODE-2                  PIC X(10).
  3925
  3926     12  AM-CITY-CODE                      PIC X(4).
  3927     12  AM-COUNTY-PARISH                  PIC X(6).
  3928
  3929     12  AM-NAME                           PIC X(30).
  3930     12  AM-PERSON                         PIC X(30).
  3931     12  AM-ADDRS                          PIC X(30).
  3932     12  AM-CITY.
  3933         16  AM-ADDR-CITY                  PIC X(28).
  3934         16  AM-ADDR-STATE                 PIC XX.
  3935     12  AM-ZIP.
  3936         16  AM-ZIP-PRIME.
  3937             20  AM-ZIP-PRI-1ST            PIC X.
  3938                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3939             20  FILLER                    PIC X(4).
  3940         16  AM-ZIP-PLUS4                  PIC X(4).
  3941     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3942         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  77
* EL630.cbl
  3943         16  AM-CAN-POSTAL-2               PIC XXX.
  3944         16  FILLER                        PIC XXX.
  3945     12  AM-TEL-NO.
  3946         16  AM-AREA-CODE                  PIC 999.
  3947         16  AM-TEL-PRE                    PIC 999.
  3948         16  AM-TEL-NBR                    PIC 9(4).
  3949     12  AM-TEL-LOC                        PIC X.
  3950         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3951         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3952
  3953     12  AM-COMM-STRUCTURE.
  3954         16  AM-DEFN-1.
  3955             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3956                 24  AM-AGT.
  3957                     28  AM-AGT-PREFIX     PIC X(4).
  3958                     28  AM-AGT-PRIME      PIC X(6).
  3959                 24  AM-COM-TYP            PIC X.
  3960                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3961                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3962                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3963                 24  AM-RECALC-LV-INDIC    PIC X.
  3964                 24  AM-RETRO-LV-INDIC     PIC X.
  3965                 24  AM-GL-CODES           PIC X.
  3966                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3967                 24  FILLER                PIC X(01).
  3968         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3969             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3970                 24  FILLER                PIC X(11).
  3971                 24  AM-L-COMA             PIC XXX.
  3972                 24  AM-J-COMA             PIC XXX.
  3973                 24  AM-A-COMA             PIC XXX.
  3974                 24  FILLER                PIC X(6).
  3975
  3976     12  AM-COMM-CHANGE-STATUS             PIC X.
  3977         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3978
  3979     12  AM-CSR-CODE                       PIC X(4).
  3980
  3981     12  AM-BILLING-STATUS                 PIC X.
  3982         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3983         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3984     12  AM-AUTO-REFUND-SW                 PIC X.
  3985         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3986         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3987     12  AM-GPCD                           PIC 99.
  3988     12  AM-IG                             PIC X.
  3989         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3990         88  AM-HAS-GROUP                     VALUE '2'.
  3991     12  AM-STATUS                         PIC X.
  3992         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3993         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3994         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3995         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3996         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3997         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3998     12  AM-REMIT-TO                       PIC 99.
  3999     12  AM-ID-NO                          PIC X(11).
  4000
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  78
* EL630.cbl
  4001     12  AM-CAL-TABLE                      PIC XX.
  4002     12  AM-LF-DEVIATION                   PIC XXX.
  4003     12  AM-AH-DEVIATION                   PIC XXX.
  4004     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4005     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4006     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4007     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4008     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4009     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4010
  4011     12  AM-USER-FIELDS.
  4012         16  AM-FLD-1                      PIC XX.
  4013         16  AM-FLD-2                      PIC XX.
  4014         16  AM-FLD-3                      PIC XX.
  4015         16  AM-FLD-4                      PIC XX.
  4016         16  AM-FLD-5                      PIC XX.
  4017
  4018     12  AM-1ST-PROD-DATE.
  4019         16  AM-1ST-PROD-YR                PIC XX.
  4020         16  AM-1ST-PROD-MO                PIC XX.
  4021         16  AM-1ST-PROD-DA                PIC XX.
  4022     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4023     12  AM-CERTS-PURGED-DATE.
  4024         16  AM-PUR-YR                     PIC XX.
  4025         16  AM-PUR-MO                     PIC XX.
  4026         16  AM-PUR-DA                     PIC XX.
  4027     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4028     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4029     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4030     12  AM-INACTIVE-DATE.
  4031         16  AM-INA-MO                     PIC 99.
  4032         16  AM-INA-DA                     PIC 99.
  4033         16  AM-INA-YR                     PIC 99.
  4034     12  AM-AR-HI-CERT-DATE                PIC XX.
  4035
  4036     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4037     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4038
  4039     12  AM-OB-PAYMENT-MODE                PIC X.
  4040         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4041         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4042         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4043         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4044
  4045     12  AM-AH-ONLY-INDICATOR              PIC X.
  4046         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4047         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4048
  4049     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4050
  4051     12  AM-OVER-SHORT.
  4052         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4053         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4054
  4055     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4056     12  AM-DCC-CLP-STATE                  PIC XX.
  4057
  4058     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  79
* EL630.cbl
  4059     12  AM-RECALC-REIN                    PIC X.
  4060
  4061     12  AM-REI-TABLE                      PIC XXX.
  4062     12  AM-REI-ET-LF                      PIC X.
  4063     12  AM-REI-ET-AH                      PIC X.
  4064     12  AM-REI-PE-LF                      PIC X.
  4065     12  AM-REI-PE-AH                      PIC X.
  4066     12  AM-REI-PRT-ST                     PIC X.
  4067     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4068     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4069     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4070     12  AM-REI-GROUP-A                    PIC X(6).
  4071     12  AM-REI-MORT                       PIC X(4).
  4072     12  AM-REI-PRT-OW                     PIC X.
  4073     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4074     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4075     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4076     12  AM-REI-GROUP-B                    PIC X(6).
  4077
  4078     12  AM-TRUST-TYPE                     PIC X(2).
  4079
  4080     12  AM-EMPLOYER-STMT-USED             PIC X.
  4081     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4082
  4083     12  AM-STD-AH-TYPE                    PIC XX.
  4084     12  AM-EARN-METHODS.
  4085         16  AM-EARN-METHOD-R              PIC X.
  4086             88 AM-REF-RL-R78                 VALUE 'R'.
  4087             88 AM-REF-RL-PR                  VALUE 'P'.
  4088             88 AM-REF-RL-MEAN                VALUE 'M'.
  4089             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4090         16  AM-EARN-METHOD-L              PIC X.
  4091             88 AM-REF-LL-R78                 VALUE 'R'.
  4092             88 AM-REF-LL-PR                  VALUE 'P'.
  4093             88 AM-REF-LL-MEAN                VALUE 'M'.
  4094             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4095         16  AM-EARN-METHOD-A              PIC X.
  4096             88 AM-REF-AH-R78                 VALUE 'R'.
  4097             88 AM-REF-AH-PR                  VALUE 'P'.
  4098             88 AM-REF-AH-MEAN                VALUE 'M'.
  4099             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4100             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4101             88 AM-REF-AH-NET                 VALUE 'N'.
  4102
  4103     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4104     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4105     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4106
  4107     12  AM-RET-Y-N                        PIC X.
  4108     12  AM-RET-P-E                        PIC X.
  4109     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4110     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4111     12  AM-RET-GRP                        PIC X(6).
  4112     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4113         16  AM-POOL-PRIME                 PIC XXX.
  4114         16  AM-POOL-SUB                   PIC XXX.
  4115     12  AM-RETRO-EARNINGS.
  4116         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  80
* EL630.cbl
  4117         16  AM-RET-EARN-L                 PIC X.
  4118         16  AM-RET-EARN-A                 PIC X.
  4119     12  AM-RET-ST-TAX-USE                 PIC X.
  4120         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4121         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4122     12  AM-RETRO-BEG-EARNINGS.
  4123         16  AM-RET-BEG-EARN-R             PIC X.
  4124         16  AM-RET-BEG-EARN-L             PIC X.
  4125         16  AM-RET-BEG-EARN-A             PIC X.
  4126     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4127     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4128
  4129     12  AM-USER-SELECT-OPTIONS.
  4130         16  AM-USER-SELECT-1              PIC X(10).
  4131         16  AM-USER-SELECT-2              PIC X(10).
  4132         16  AM-USER-SELECT-3              PIC X(10).
  4133         16  AM-USER-SELECT-4              PIC X(10).
  4134         16  AM-USER-SELECT-5              PIC X(10).
  4135
  4136     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4137
  4138     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4139
  4140     12  AM-RPT045A-SWITCH                 PIC X.
  4141         88  RPT045A-OFF                   VALUE 'N'.
  4142
  4143     12  AM-INSURANCE-LIMITS.
  4144         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4145         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4146
  4147     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4148         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4149
  4150     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4151         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4152         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4153
  4154     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4155
  4156     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4157     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4158     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4159     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4160     12  AM-DCC-UEF-STATE                  PIC XX.
  4161     12  FILLER                            PIC XXX.
  4162     12  AM-REPORT-CODE-3                  PIC X(10).
  4163*    12  FILLER                            PIC X(22).
  4164
  4165     12  AM-RESERVE-DATE.
  4166         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4167         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4168         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4169
  4170     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4171     12  AM-NOTIFICATION-TYPES.
  4172         16  AM-NOTIF-OF-LETTERS           PIC X.
  4173         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4174         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  81
* EL630.cbl
  4175         16  AM-NOTIF-OF-STATUS            PIC X.
  4176
  4177     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4178         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4179         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4180         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4181         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4182
  4183     12  AM-BENEFIT-CONTROLS.
  4184         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4185             20  AM-BENEFIT-CODE           PIC XX.
  4186             20  AM-BENEFIT-TYPE           PIC X.
  4187             20  AM-BENEFIT-REVISION       PIC XXX.
  4188             20  AM-BENEFIT-REM-TERM       PIC X.
  4189             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4190             20  FILLER                    PIC XX.
  4191         16  FILLER                        PIC X(80).
  4192
  4193     12  AM-TRANSFER-DATA.
  4194         16  AM-TRANSFERRED-FROM.
  4195             20  AM-TRNFROM-CARRIER        PIC X.
  4196             20  AM-TRNFROM-GROUPING.
  4197                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4198                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4199             20  AM-TRNFROM-STATE          PIC XX.
  4200             20  AM-TRNFROM-ACCOUNT.
  4201                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4202                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4203             20  AM-TRNFROM-DTE            PIC XX.
  4204         16  AM-TRANSFERRED-TO.
  4205             20  AM-TRNTO-CARRIER          PIC X.
  4206             20  AM-TRNTO-GROUPING.
  4207                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4208                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4209             20  AM-TRNTO-STATE            PIC XX.
  4210             20  AM-TRNTO-ACCOUNT.
  4211                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4212                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4213             20  AM-TRNTO-DTE              PIC XX.
  4214         16  FILLER                        PIC X(10).
  4215
  4216     12  AM-SAVED-REMIT-TO                 PIC 99.
  4217
  4218     12  AM-COMM-STRUCTURE-SAVED.
  4219         16  AM-DEFN-1-SAVED.
  4220             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4221                 24  AM-AGT-SV             PIC X(10).
  4222                 24  AM-COM-TYP-SV         PIC X.
  4223                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4224                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4225                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4226                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4227                 24  FILLER                PIC X.
  4228                 24  AM-GL-CODES-SV        PIC X.
  4229                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4230                 24  FILLER                PIC X.
  4231         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4232             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  82
* EL630.cbl
  4233                 24  FILLER                PIC X(11).
  4234                 24  AM-L-COMA-SV          PIC XXX.
  4235                 24  AM-J-COMA-SV          PIC XXX.
  4236                 24  AM-A-COMA-SV          PIC XXX.
  4237                 24  FILLER                PIC X(6).
  4238
  4239     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4240         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4241            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4242            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4243            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4244
  4245     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4246     12  FILLER                            PIC X(120).
  4247
  4248     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4249         16  AM-CONTROL-NAME               PIC X(30).
  4250         16  AM-EXECUTIVE-ONE.
  4251             20  AM-EXEC1-NAME             PIC X(15).
  4252             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4253                                                          COMP-3.
  4254             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4255                                                          COMP-3.
  4256         16  AM-EXECUTIVE-TWO.
  4257             20  AM-EXEC2-NAME             PIC X(15).
  4258             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4259                                                          COMP-3.
  4260             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4261                                                          COMP-3.
  4262
  4263     12  AM-RETRO-ADDITIONAL-DATA.
  4264         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4265         16  AM-RETRO-PREM-P-E             PIC X.
  4266         16  AM-RETRO-CLMS-P-I             PIC X.
  4267         16  AM-RETRO-RET-BRACKET-LF.
  4268             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4269                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4270                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4271             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4272                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4273                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4274             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4275                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4276                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4277         16  AM-RETRO-RET-BRACKET-AH.
  4278             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4279                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4280                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4281                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4282             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4283                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4284                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4285             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4286                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4287                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4288
  4289     12  AM-COMMENTS.
  4290         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  83
* EL630.cbl
  4291
  4292     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4293         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4294         16  AM-FLI-BILLING-CODE           PIC X.
  4295         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4296         16  AM-FLI-UNITED-IDENT           PIC X.
  4297         16  AM-FLI-INTEREST-LOST-DATA.
  4298             20  AM-FLI-BANK-NO            PIC X(5).
  4299             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4300             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4301             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4302         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4303             20  AM-FLI-AGT                PIC X(9).
  4304             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4305             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4306         16  FILLER                        PIC X(102).
  4307
  4308     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4309         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4310             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4311             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4312             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4313             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4314             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4315         16  FILLER                          PIC X(10).
  4316******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  84
* EL630.cbl
  4318*    COPY ELCCERT.
  4319******************************************************************
  4320*                                                                *
  4321*                            ELCCERT.                            *
  4322*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4323*                            VMOD=2.013                          *
  4324*                                                                *
  4325*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4326*                                                                *
  4327*   FILE TYPE = VSAM,KSDS                                        *
  4328*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4329*                                                                *
  4330*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4331*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4332*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4333*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4334*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4335*                                                                *
  4336*   LOG = YES                                                    *
  4337*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4338******************************************************************
  4339*                   C H A N G E   L O G
  4340*
  4341* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4342*-----------------------------------------------------------------
  4343*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4344* EFFECTIVE    NUMBER
  4345*-----------------------------------------------------------------
  4346* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4347* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4348* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4349* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4350* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4351* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4352* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4353* 032612  CR2011110200001  PEMA  AHL CHANGES
  4354* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4355* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4356******************************************************************
  4357
  4358 01  CERTIFICATE-MASTER.
  4359     12  CM-RECORD-ID                      PIC XX.
  4360         88  VALID-CM-ID                      VALUE 'CM'.
  4361
  4362     12  CM-CONTROL-PRIMARY.
  4363         16  CM-COMPANY-CD                 PIC X.
  4364         16  CM-CARRIER                    PIC X.
  4365         16  CM-GROUPING.
  4366             20  CM-GROUPING-PREFIX        PIC X(3).
  4367             20  CM-GROUPING-PRIME         PIC X(3).
  4368         16  CM-STATE                      PIC XX.
  4369         16  CM-ACCOUNT.
  4370             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4371             20  CM-ACCOUNT-PRIME          PIC X(6).
  4372         16  CM-CERT-EFF-DT                PIC XX.
  4373         16  CM-CERT-NO.
  4374             20  CM-CERT-PRIME             PIC X(10).
  4375             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  85
* EL630.cbl
  4376
  4377     12  CM-CONTROL-BY-NAME.
  4378         16  CM-COMPANY-CD-A1              PIC X.
  4379         16  CM-INSURED-LAST-NAME          PIC X(15).
  4380         16  CM-INSURED-INITIALS.
  4381             20  CM-INSURED-INITIAL1       PIC X.
  4382             20  CM-INSURED-INITIAL2       PIC X.
  4383
  4384     12  CM-CONTROL-BY-SSN.
  4385         16  CM-COMPANY-CD-A2              PIC X.
  4386         16  CM-SOC-SEC-NO.
  4387             20  CM-SSN-STATE              PIC XX.
  4388             20  CM-SSN-ACCOUNT            PIC X(6).
  4389             20  CM-SSN-LN3.
  4390                 25  CM-INSURED-INITIALS-A2.
  4391                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4392                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4393                 25 CM-PART-LAST-NAME-A2         PIC X.
  4394
  4395     12  CM-CONTROL-BY-CERT-NO.
  4396         16  CM-COMPANY-CD-A4              PIC X.
  4397         16  CM-CERT-NO-A4                 PIC X(11).
  4398
  4399     12  CM-CONTROL-BY-MEMB.
  4400         16  CM-COMPANY-CD-A5              PIC X.
  4401         16  CM-MEMBER-NO.
  4402             20  CM-MEMB-STATE             PIC XX.
  4403             20  CM-MEMB-ACCOUNT           PIC X(6).
  4404             20  CM-MEMB-LN4.
  4405                 25  CM-INSURED-INITIALS-A5.
  4406                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4407                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4408                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4409
  4410     12  CM-INSURED-PROFILE-DATA.
  4411         16  CM-INSURED-FIRST-NAME.
  4412             20  CM-INSURED-1ST-INIT       PIC X.
  4413             20  FILLER                    PIC X(9).
  4414         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4415         16  CM-INSURED-SEX                PIC X.
  4416             88  CM-SEX-MALE                  VALUE 'M'.
  4417             88  CM-SEX-FEMAL                 VALUE 'F'.
  4418         16  CM-INSURED-JOINT-AGE          PIC 99.
  4419         16  CM-JOINT-INSURED-NAME.
  4420             20  CM-JT-LAST-NAME           PIC X(15).
  4421             20  CM-JT-FIRST-NAME.
  4422                 24  CM-JT-1ST-INIT        PIC X.
  4423                 24  FILLER                PIC X(9).
  4424             20  CM-JT-INITIAL             PIC X.
  4425
  4426     12  CM-LIFE-DATA.
  4427         16  CM-LF-BENEFIT-CD              PIC XX.
  4428         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4429         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4430         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4431         16  CM-LF-DEV-CODE                PIC XXX.
  4432         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4433         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  86
* EL630.cbl
  4434         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4435         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4436         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4437         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4438         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4439         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4440         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4441         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4442         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4443         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4444         16  cm-temp-epiq                  pic xx.
  4445             88  EPIQ-CLASS                  value 'EQ'.
  4446*        16  FILLER                        PIC XX.
  4447
  4448     12  CM-AH-DATA.
  4449         16  CM-AH-BENEFIT-CD              PIC XX.
  4450         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4451         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4452         16  CM-AH-DEV-CODE                PIC XXX.
  4453         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4454         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4455         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4456         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4457         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4458         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4459         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4460         16  CM-AH-PAID-THRU-DT            PIC XX.
  4461             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4462         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4463         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4464         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4465         16  FILLER                        PIC X.
  4466
  4467     12  CM-LOAN-INFORMATION.
  4468         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4469         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4470                                           PIC S9(5)V99  COMP-3.
  4471         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4472         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4473         16  CM-PAY-FREQUENCY              PIC S99.
  4474         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4475         16  CM-RATE-CLASS                 PIC XX.
  4476         16  CM-BENEFICIARY                PIC X(25).
  4477         16  CM-POLICY-FORM-NO             PIC X(12).
  4478         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4479         16  CM-LAST-ADD-ON-DT             PIC XX.
  4480         16  CM-DEDUCTIBLE-AMOUNTS.
  4481             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4482             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4483         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4484             20  CM-RESIDENT-STATE         PIC XX.
  4485             20  CM-RATE-CODE              PIC X(4).
  4486             20  FILLER                    PIC XX.
  4487         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4488             20  CM-LOAN-OFFICER           PIC X(5).
  4489             20  FILLER                    PIC XXX.
  4490         16  CM-CSR-CODE                   PIC XXX.
  4491         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  87
* EL630.cbl
  4492             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4493         16  CM-POST-CARD-IND              PIC X.
  4494         16  CM-NH-INTERFACE-SW            PIC X.
  4495         16  CM-PREMIUM-TYPE               PIC X.
  4496             88  CM-SING-PRM                  VALUE '1'.
  4497             88  CM-O-B-COVERAGE              VALUE '2'.
  4498             88  CM-OPEN-END                  VALUE '3'.
  4499         16  CM-IND-GRP-TYPE               PIC X.
  4500             88  CM-INDIVIDUAL                VALUE 'I'.
  4501             88  CM-GROUP                     VALUE 'G'.
  4502         16  CM-SKIP-CODE                  PIC X.
  4503             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4504             88  SKIP-JULY                    VALUE '1'.
  4505             88  SKIP-AUGUST                  VALUE '2'.
  4506             88  SKIP-SEPTEMBER               VALUE '3'.
  4507             88  SKIP-JULY-AUG                VALUE '4'.
  4508             88  SKIP-AUG-SEPT                VALUE '5'.
  4509             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4510             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4511             88  SKIP-JUNE                    VALUE '8'.
  4512             88  SKIP-JUNE-JULY               VALUE '9'.
  4513             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4514             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4515         16  CM-PAYMENT-MODE               PIC X.
  4516             88  PAY-MONTHLY                  VALUE SPACE.
  4517             88  PAY-WEEKLY                   VALUE '1'.
  4518             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4519             88  PAY-BI-WEEKLY                VALUE '3'.
  4520             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4521         16  CM-LOAN-NUMBER                PIC X(8).
  4522         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4523         16  CM-OLD-LOF                    PIC XXX.
  4524*        16  CM-LOAN-OFFICER               PIC XXX.
  4525         16  CM-REIN-TABLE                 PIC XXX.
  4526         16  CM-SPECIAL-REIN-CODE          PIC X.
  4527         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4528         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4529         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4530
  4531     12  CM-STATUS-DATA.
  4532         16  CM-ENTRY-STATUS               PIC X.
  4533         16  CM-ENTRY-DT                   PIC XX.
  4534
  4535         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4536         16  CM-LF-CANCEL-DT               PIC XX.
  4537         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4538
  4539         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4540         16  CM-LF-DEATH-DT                PIC XX.
  4541         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4542
  4543         16  CM-LF-CURRENT-STATUS          PIC X.
  4544             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4545                                                'M' '4' '5' '9'.
  4546             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4547             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4548             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4549             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  88
* EL630.cbl
  4550             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4551             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4552             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4553             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4554             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4555             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4556             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4557             88  CM-LF-DECLINED               VALUE 'D'.
  4558             88  CM-LF-VOIDED                 VALUE 'V'.
  4559
  4560         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4561         16  CM-AH-CANCEL-DT               PIC XX.
  4562         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4563
  4564         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4565         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4566         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4567
  4568         16  CM-AH-CURRENT-STATUS          PIC X.
  4569             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4570                                                'M' '4' '5' '9'.
  4571             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4572             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4573             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4574             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4575             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4576             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4577             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4578             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4579             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4580             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4581             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4582             88  CM-AH-DECLINED               VALUE 'D'.
  4583             88  CM-AH-VOIDED                 VALUE 'V'.
  4584
  4585         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4586             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4587             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4588             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4589         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4590
  4591         16  CM-ENTRY-BATCH                PIC X(6).
  4592         16  CM-LF-EXIT-BATCH              PIC X(6).
  4593         16  CM-AH-EXIT-BATCH              PIC X(6).
  4594         16  CM-LAST-MONTH-END             PIC XX.
  4595
  4596     12  CM-NOTE-SW                        PIC X.
  4597         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4598         88  CERT-NOTES-PRESENT               VALUE '1'.
  4599         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4600         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4601         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4602         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4603         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4604         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4605     12  CM-COMP-EXCP-SW                   PIC X.
  4606         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4607         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  89
* EL630.cbl
  4608     12  CM-INSURED-ADDRESS-SW             PIC X.
  4609         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4610         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4611
  4612*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4613     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4614     12  FILLER                            PIC X.
  4615
  4616*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4617     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4618     12  FILLER                            PIC X.
  4619*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4620     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4621
  4622     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4623         88  CERT-ADDED-BATCH                 VALUE ' '.
  4624         88  CERT-ADDED-ONLINE                VALUE '1'.
  4625         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4626         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4627         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4628     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4629         88  CERT-AS-LOADED                   VALUE ' '.
  4630         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4631         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4632         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4633         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4634         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4635         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4636         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4637
  4638     12  CM-ACCOUNT-COMM-PCTS.
  4639         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4640         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4641
  4642     12  CM-USER-FIELD                     PIC X.
  4643     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4644     12  CM-CLP-STATE                      PIC XX.
  4645     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4646     12  CM-USER-RESERVED                  PIC XXX.
  4647     12  FILLER REDEFINES CM-USER-RESERVED.
  4648         16  CM-AH-CLASS-CD                PIC XX.
  4649         16  F                             PIC X.
  4650******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  90
* EL630.cbl
  4652*    COPY ERCNOTE.
  4653******************************************************************
  4654*                                                                *
  4655*                                                                *
  4656*                            ERCNOTE                             *
  4657*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4658*                            VMOD=2.003                          *
  4659*                                                                *
  4660*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  4661*                                                                *
  4662*        FILE TYPE= VSAM,KSDS                                    *
  4663*        RECORD SIZE = 825    RECFORM = FIXED                    *
  4664*                                                                *
  4665*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  4666*                                                                *
  4667*        LOG = YES                                               *
  4668*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  4669*                                                                *
  4670******************************************************************
  4671*                   C H A N G E   L O G
  4672*
  4673* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4674*-----------------------------------------------------------------
  4675*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4676* EFFECTIVE    NUMBER
  4677*-----------------------------------------------------------------
  4678* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  4679*                                FILE WILL CONTAIN BILLING NOTES O
  4680******************************************************************
  4681
  4682 01  CERTIFICATE-NOTE.
  4683     12  CN-RECORD-ID                PIC  XX.
  4684         88  VALID-CN-ID                  VALUE 'CN'.
  4685
  4686     12  CN-CONTROL-PRIMARY.
  4687         16  CN-COMPANY-CD           PIC X.
  4688         16  CN-CARRIER              PIC X.
  4689         16  CN-GROUPING.
  4690             20 CN-GROUPING-PREFIX   PIC XXX.
  4691             20 CN-GROUPING-PRIME    PIC XXX.
  4692         16  CN-STATE                PIC XX.
  4693         16  CN-ACCOUNT.
  4694             20 CN-ACCOUNT-PREFIX    PIC X(4).
  4695             20 CN-ACCOUNT-PRIME     PIC X(6).
  4696         16  CN-CERT-EFF-DT          PIC XX.
  4697         16  CN-CERT-NO.
  4698             20  CN-CERT-PRIME       PIC X(10).
  4699             20  CN-CERT-SFX         PIC X.
  4700
  4701     12  CN-BILLING-START-LINE-NO    PIC 99.
  4702     12  CN-BILLING-END-LINE-NO      PIC 99.
  4703
  4704     12  CN-LINES.
  4705         16  CN-LINE OCCURS 10       PIC X(77).
  4706
  4707     12  CN-LAST-MAINT-DT            PIC XX.
  4708     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  4709     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  91
* EL630.cbl
  4710     12  FILLER                      PIC X(6).
  4711******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  92
* EL630.cbl
  4713*    COPY ERCMAIL.
  4714******************************************************************
  4715*                                                                *
  4716*                                                                *
  4717*                            ERCMAIL                             *
  4718*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4719*                            VMOD=2.003                          *
  4720*                                                                *
  4721*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  4722*                                                                *
  4723*   FILE TYPE = VSAM,KSDS                                        *
  4724*   RECORD SIZE = 374   RECFORM = FIX                            *
  4725*                                                                *
  4726*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  4727*   ALTERNATE PATH    = NOT USED                                 *
  4728*                                                                *
  4729*   LOG = YES                                                    *
  4730*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4731******************************************************************
  4732*                   C H A N G E   L O G
  4733*
  4734* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4735*-----------------------------------------------------------------
  4736*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4737* EFFECTIVE    NUMBER
  4738*-----------------------------------------------------------------
  4739* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  4740* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4741* 111108                   PEMA  ADD CRED BENE ADDR2
  4742******************************************************************
  4743
  4744 01  MAILING-DATA.
  4745     12  MA-RECORD-ID                      PIC XX.
  4746         88  VALID-MA-ID                       VALUE 'MA'.
  4747
  4748     12  MA-CONTROL-PRIMARY.
  4749         16  MA-COMPANY-CD                 PIC X.
  4750         16  MA-CARRIER                    PIC X.
  4751         16  MA-GROUPING.
  4752             20  MA-GROUPING-PREFIX        PIC XXX.
  4753             20  MA-GROUPING-PRIME         PIC XXX.
  4754         16  MA-STATE                      PIC XX.
  4755         16  MA-ACCOUNT.
  4756             20  MA-ACCOUNT-PREFIX         PIC X(4).
  4757             20  MA-ACCOUNT-PRIME          PIC X(6).
  4758         16  MA-CERT-EFF-DT                PIC XX.
  4759         16  MA-CERT-NO.
  4760             20  MA-CERT-PRIME             PIC X(10).
  4761             20  MA-CERT-SFX               PIC X.
  4762
  4763     12  FILLER                            PIC XX.
  4764
  4765     12  MA-ACCESS-CONTROL.
  4766         16  MA-SOURCE-SYSTEM              PIC XX.
  4767             88  MA-FROM-CREDIT                VALUE 'CR'.
  4768             88  MA-FROM-VSI                   VALUE 'VS'.
  4769             88  MA-FROM-WARRANTY              VALUE 'WA'.
  4770             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  93
* EL630.cbl
  4771         16  MA-RECORD-ADD-DT              PIC XX.
  4772         16  MA-RECORD-ADDED-BY            PIC XXXX.
  4773         16  MA-LAST-MAINT-DT              PIC XX.
  4774         16  MA-LAST-MAINT-BY              PIC XXXX.
  4775         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4776
  4777     12  MA-PROFILE-INFO.
  4778         16  MA-QUALIFY-CODE-1             PIC XX.
  4779         16  MA-QUALIFY-CODE-2             PIC XX.
  4780         16  MA-QUALIFY-CODE-3             PIC XX.
  4781         16  MA-QUALIFY-CODE-4             PIC XX.
  4782         16  MA-QUALIFY-CODE-5             PIC XX.
  4783
  4784         16  MA-INSURED-LAST-NAME          PIC X(15).
  4785         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4786         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4787         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4788         16  MA-INSURED-BIRTH-DT           PIC XX.
  4789         16  MA-INSURED-SEX                PIC X.
  4790             88  MA-SEX-MALE                   VALUE 'M'.
  4791             88  MA-SEX-FEMALE                 VALUE 'F'.
  4792         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4793
  4794         16  MA-ADDRESS-CORRECTED          PIC X.
  4795         16  MA-JOINT-BIRTH-DT             PIC XX.
  4796*        16  FILLER                        PIC X(12).
  4797
  4798         16  MA-ADDRESS-LINE-1             PIC X(30).
  4799         16  MA-ADDRESS-LINE-2             PIC X(30).
  4800         16  MA-CITY-STATE.
  4801             20  MA-CITY                   PIC X(28).
  4802             20  MA-ADDR-STATE             PIC XX.
  4803         16  MA-ZIP.
  4804             20  MA-ZIP-CODE.
  4805                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4806                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4807                 24  FILLER                PIC X(4).
  4808             20  MA-ZIP-PLUS4              PIC X(4).
  4809         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4810             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4811             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4812             20  FILLER                    PIC X(3).
  4813
  4814         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4815
  4816         16  FILLER                        PIC XXX.
  4817*        16  FILLER                        PIC X(10).
  4818
  4819     12  MA-CRED-BENE-INFO.
  4820         16  MA-CRED-BENE-NAME                 PIC X(25).
  4821         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4822         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4823         16  MA-CRED-BENE-CTYST.
  4824             20  MA-CRED-BENE-CITY             PIC X(28).
  4825             20  MA-CRED-BENE-STATE            PIC XX.
  4826         16  MA-CRED-BENE-ZIP.
  4827             20  MA-CB-ZIP-CODE.
  4828                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  94
* EL630.cbl
  4829                     88  MA-CB-CANADIAN-POST-CODE
  4830                                           VALUE 'A' THRU 'Z'.
  4831                 24  FILLER                    PIC X(4).
  4832             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4833         16  MA-CB-CANADIAN-POSTAL-CODE
  4834                            REDEFINES MA-CRED-BENE-ZIP.
  4835             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4836             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4837             20  FILLER                        PIC X(3).
  4838     12  MA-POST-CARD-MAIL-DATA.
  4839         16  MA-MAIL-DATA OCCURS 7.
  4840             20  MA-MAIL-TYPE              PIC X.
  4841                 88  MA-12MO-MAILING           VALUE '1'.
  4842                 88  MA-EXP-MAILING            VALUE '2'.
  4843             20  MA-MAIL-STATUS            PIC X.
  4844                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4845                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4846                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4847             20  MA-MAIL-DATE              PIC XX.
  4848     12  FILLER                            PIC XX.
  4849     12  FILLER                            PIC XX.
  4850*    12  FILLER                            PIC X(30).
  4851******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  95
* EL630.cbl
  4853*    COPY ERCPNDM.
  4854******************************************************************
  4855*                                                                *
  4856*                                                                *
  4857*                            ERCPNDM                             *
  4858*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4859*                            VMOD=2.003                          *
  4860*                                                                *
  4861*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  4862*                                                                *
  4863*   FILE TYPE = VSAM,KSDS                                        *
  4864*   RECORD SIZE = 374   RECFORM = FIX                            *
  4865*                                                                *
  4866*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  4867*   ALTERNATE PATH    = NOT USED                                 *
  4868*                                                                *
  4869*   LOG = YES                                                    *
  4870*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4871******************************************************************
  4872*                   C H A N G E   L O G
  4873*
  4874* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4875*-----------------------------------------------------------------
  4876*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4877* EFFECTIVE    NUMBER
  4878*-----------------------------------------------------------------
  4879* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  4880* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  4881* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4882******************************************************************
  4883
  4884 01  PENDING-MAILING-DATA.
  4885     12  PM-RECORD-ID                      PIC XX.
  4886         88  VALID-MA-ID                       VALUE 'PM'.
  4887
  4888     12  PM-CONTROL-PRIMARY.
  4889         16  PM-COMPANY-CD                 PIC X.
  4890         16  PM-ENTRY-BATCH                PIC X(6).
  4891         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  4892         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  4893
  4894     12  FILLER                            PIC X(14).
  4895
  4896     12  PM-ACCESS-CONTROL.
  4897         16  PM-SOURCE-SYSTEM              PIC XX.
  4898             88  PM-FROM-CREDIT                VALUE 'CR'.
  4899             88  PM-FROM-VSI                   VALUE 'VS'.
  4900             88  PM-FROM-WARRANTY              VALUE 'WA'.
  4901             88  PM-FROM-OTHER                 VALUE 'OT'.
  4902         16  PM-RECORD-ADD-DT              PIC XX.
  4903         16  PM-RECORD-ADDED-BY            PIC XXXX.
  4904         16  PM-LAST-MAINT-DT              PIC XX.
  4905         16  PM-LAST-MAINT-BY              PIC XXXX.
  4906         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4907
  4908     12  PM-PROFILE-INFO.
  4909         16  PM-QUALIFY-CODE-1             PIC XX.
  4910         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  96
* EL630.cbl
  4911         16  PM-QUALIFY-CODE-3             PIC XX.
  4912         16  PM-QUALIFY-CODE-4             PIC XX.
  4913         16  PM-QUALIFY-CODE-5             PIC XX.
  4914
  4915         16  PM-INSURED-LAST-NAME          PIC X(15).
  4916         16  PM-INSURED-FIRST-NAME         PIC X(10).
  4917         16  PM-INSURED-MIDDLE-INIT        PIC X.
  4918         16  PM-INSURED-ISSUE-AGE          PIC 99.
  4919         16  PM-INSURED-BIRTH-DT           PIC XX.
  4920         16  PM-INSURED-SEX                PIC X.
  4921             88  PM-SEX-MALE                   VALUE 'M'.
  4922             88  PM-SEX-FEMALE                 VALUE 'F'.
  4923         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  4924
  4925         16  PM-ADDRESS-CORRECTED          PIC X.
  4926         16  PM-JOINT-BIRTH-DT             PIC XX.
  4927*        16  FILLER                        PIC X(12).
  4928
  4929         16  PM-ADDRESS-LINE-1             PIC X(30).
  4930         16  PM-ADDRESS-LINE-2             PIC X(30).
  4931         16  PM-CITY-STATE.
  4932             20  PM-CITY                   PIC X(28).
  4933             20  PM-STATE                  PIC XX.
  4934         16  PM-ZIP.
  4935             20  PM-ZIP-CODE.
  4936                 24  PM-ZIP-1              PIC X.
  4937                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4938                 24  FILLER                PIC X(4).
  4939             20  PM-ZIP-PLUS4              PIC X(4).
  4940         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  4941             20  PM-CAN-POST1              PIC XXX.
  4942             20  PM-CAN-POST2              PIC XXX.
  4943             20  FILLER                    PIC XXX.
  4944
  4945         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  4946
  4947         16  FILLER                        PIC X(03).
  4948
  4949     12  PM-CRED-BENE-INFO.
  4950         16  PM-CRED-BENE-NAME             PIC X(25).
  4951         16  PM-CRED-BENE-ADDR             PIC X(30).
  4952         16  PM-CRED-BENE-ADDR2            PIC X(30).
  4953         16  PM-CRED-BENE-CTYST.
  4954             20  PM-CRED-BENE-CITY         PIC X(28).
  4955             20  PM-CRED-BENE-STATE        PIC XX.
  4956         16  PM-CRED-BENE-ZIP.
  4957             20  PM-CB-ZIP-CODE.
  4958                 24  PM-CB-ZIP-1           PIC X.
  4959                     88  PM-CB-CANADIAN-POST-CODE
  4960                                  VALUE 'A' THRU 'Z'.
  4961                 24  FILLER                PIC X(4).
  4962             20  PM-CB-ZIP-PLUS4           PIC X(4).
  4963         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  4964             20  PM-CB-CAN-POST1           PIC XXX.
  4965             20  PM-CB-CAN-POST2           PIC XXX.
  4966             20  FILLER                    PIC XXX.
  4967     12  PM-POST-CARD-MAIL-DATA.
  4968         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  97
* EL630.cbl
  4969             20  PM-MAIL-TYPE              PIC X.
  4970                 88  PM-12MO-MAILING           VALUE '1'.
  4971                 88  PM-EXP-MAILING            VALUE '2'.
  4972             20  PM-MAIL-STATUS            PIC X.
  4973                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  4974                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  4975                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  4976             20  PM-MAIL-DATE              PIC XX.
  4977     12  FILLER                            PIC XX.
  4978     12  FILLER                            PIC X(12).
  4979*    12  FILLER                            PIC X(30).
  4980
  4981******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  98
* EL630.cbl
  4983*    COPY ERCCOMP.
  4984******************************************************************
  4985*                                                                *
  4986*                                                                *
  4987*                            ERCCOMP                             *
  4988*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4989*                            VMOD=2.019                          *
  4990*                                                                *
  4991*   ONLINE CREDIT SYSTEM                                         *
  4992*                                                                *
  4993*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4994*                                                                *
  4995*   FILE TYPE = VSAM,KSDS                                        *
  4996*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4997*                                                                *
  4998*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4999*       ALTERNATE PATH = NONE                                    *
  5000*                                                                *
  5001*   LOG = NO                                                     *
  5002*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5003*                                                                *
  5004******************************************************************
  5005*                   C H A N G E   L O G
  5006*
  5007* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5008*-----------------------------------------------------------------
  5009*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5010* EFFECTIVE    NUMBER
  5011*-----------------------------------------------------------------
  5012* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5013* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  5014* 092205    2005050300006  PEMA  ADD LEASE FEE
  5015* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  5016* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  5017* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  5018* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5019* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  5020* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  5021******************************************************************
  5022
  5023 01  COMPENSATION-MASTER.
  5024     12  CO-RECORD-ID                          PIC XX.
  5025         88  VALID-CO-ID                          VALUE 'CO'.
  5026
  5027     12  CO-CONTROL-PRIMARY.
  5028         16  CO-COMPANY-CD                     PIC X.
  5029         16  CO-CONTROL.
  5030             20  CO-CTL-1.
  5031                 24  CO-CARR-GROUP.
  5032                     28  CO-CARRIER            PIC X.
  5033                     28  CO-GROUPING.
  5034                         32  CO-GROUP-PREFIX   PIC XXX.
  5035                         32  CO-GROUP-PRIME    PIC XXX.
  5036                 24  CO-RESP-NO.
  5037                     28  CO-RESP-PREFIX        PIC X(4).
  5038                     28  CO-RESP-PRIME         PIC X(6).
  5039             20  CO-CTL-2.
  5040                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  99
* EL630.cbl
  5041                     28  CO-ACCT-PREFIX        PIC X(4).
  5042                     28  CO-ACCT-PRIME         PIC X(6).
  5043         16  CO-TYPE                           PIC X.
  5044             88  CO-COMPANY-TYPE                  VALUE 'C'.
  5045             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  5046             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  5047
  5048     12  CO-MAINT-INFORMATION.
  5049         16  CO-LAST-MAINT-DT                  PIC XX.
  5050         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  5051         16  CO-LAST-MAINT-USER                PIC X(4).
  5052     12  FILLER                                PIC XX.
  5053     12  CO-STMT-TYPE                          PIC XXX.
  5054     12  CO-COMP-TYPE                          PIC X.
  5055         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  5056     12  CO-STMT-OWNER                         PIC X(4).
  5057     12  CO-BALANCE-CONTROL                    PIC X.
  5058         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  5059         88  CO-NO-BALANCE                        VALUE 'N'.
  5060
  5061     12  CO-INTERNAL-CONTROL-1                 PIC X.
  5062         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  5063         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  5064         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  5065
  5066     12  CO-INTERNAL-CONTROL-2                 PIC X.
  5067         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  5068         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  5069
  5070     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  5071     12  CO-GA-DIRECT-DEP                      PIC X.
  5072     12  CO-FUTURE-SPACE                       PIC X.
  5073         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  5074
  5075     12  CO-ACCT-NAME                          PIC X(30).
  5076     12  CO-MAIL-NAME                          PIC X(30).
  5077     12  CO-ADDR-1                             PIC X(30).
  5078     12  CO-ADDR-2                             PIC X(30).
  5079     12  CO-ADDR-3.
  5080         16  CO-ADDR-CITY                      PIC X(27).
  5081         16  CO-ADDR-STATE                     PIC XX.
  5082     12  CO-CSO-1099                           PIC X.
  5083     12  CO-ZIP.
  5084         16  CO-ZIP-PRIME.
  5085             20  CO-ZIP-PRI-1ST                PIC X.
  5086                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5087             20  FILLER                        PIC X(4).
  5088         16  CO-ZIP-PLUS4                      PIC X(4).
  5089     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  5090         16  CO-CAN-POSTAL-1                   PIC XXX.
  5091         16  CO-CAN-POSTAL-2                   PIC XXX.
  5092         16  FILLER                            PIC XXX.
  5093     12  CO-SOC-SEC                            PIC X(13).
  5094     12  CO-TELEPHONE.
  5095         16  CO-AREA-CODE                      PIC XXX.
  5096         16  CO-PREFIX                         PIC XXX.
  5097         16  CO-PHONE                          PIC X(4).
  5098
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 100
* EL630.cbl
  5099     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  5100
  5101     12  CO-AR-BAL-LEVEL                       PIC X.
  5102         88  CO-AR-REF-LVL                        VALUE '1'.
  5103         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  5104         88  CO-AR-BILL-LVL                       VALUE '2'.
  5105         88  CO-AR-AGT-LVL                        VALUE '3'.
  5106         88  CO-AR-FR-LVL                         VALUE '4'.
  5107
  5108     12  CO-AR-NORMAL-PRINT                    PIC X.
  5109         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  5110         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  5111
  5112     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  5113
  5114     12  CO-AR-REPORTING                       PIC X.
  5115         88  CO-AR-NET-REPORT                     VALUE 'N'.
  5116         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  5117
  5118     12  CO-AR-PULL-CHECK                      PIC X.
  5119         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  5120         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  5121
  5122     12  CO-AR-BALANCE-PRINT                   PIC X.
  5123         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  5124
  5125     12  CO-AR-LAST-RUN-CODE                   PIC X.
  5126         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  5127         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  5128         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  5129
  5130     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  5131
  5132     12  CO-USER-CODE                          PIC X.
  5133     12  CO-REPORT-GROUP-ID                    PIC X(12).
  5134
  5135******************************************************************
  5136*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  5137*    THE LAST MONTH END RUN.
  5138******************************************************************
  5139
  5140     12  CO-LAST-ACTIVITY-DATE.
  5141         16  CO-ACT-YEAR                       PIC 99.
  5142         16  CO-ACT-MONTH                      PIC 99.
  5143         16  CO-ACT-DAY                        PIC 99.
  5144
  5145     12  CO-LAST-STMT-DT.
  5146         16  CO-LAST-STMT-YEAR                 PIC 99.
  5147         16  CO-LAST-STMT-MONTH                PIC 99.
  5148         16  CO-LAST-STMT-DAY                  PIC 99.
  5149
  5150     12  CO-MO-END-TOTALS.
  5151         16  CO-MONTHLY-TOTALS.
  5152             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  5153             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  5154             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  5155             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  5156             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 101
* EL630.cbl
  5157
  5158         16  CO-AGING-TOTALS.
  5159             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  5160             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  5161             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  5162             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  5163
  5164         16  CO-YTD-TOTALS.
  5165             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  5166             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  5167
  5168         16  CO-OVER-UNDER-TOTALS.
  5169             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5170             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5171
  5172     12  CO-MISCELLANEOUS-TOTALS.
  5173         16  CO-FICA-TOTALS.
  5174             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  5175             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  5176
  5177         16  CO-CLAIM-TOTALS.
  5178             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  5179             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  5180
  5181******************************************************************
  5182*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  5183*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  5184******************************************************************
  5185
  5186     12  CO-CURRENT-TOTALS.
  5187         16  CO-CURRENT-LAST-STMT-DT.
  5188             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  5189             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  5190             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  5191
  5192         16  CO-CURRENT-MONTHLY-TOTALS.
  5193             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  5194             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  5195             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  5196             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  5197             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  5198
  5199         16  CO-CURRENT-AGING-TOTALS.
  5200             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  5201             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  5202             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  5203             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  5204
  5205         16  CO-CURRENT-YTD-TOTALS.
  5206             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  5207             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  5208
  5209     12  CO-PAID-COMM-TOTALS.
  5210         16  CO-YTD-PAID-COMMS.
  5211             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  5212             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  5213
  5214     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 102
* EL630.cbl
  5215         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  5216         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  5217
  5218     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  5219         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  5220         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  5221         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  5222         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  5223         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  5224         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  5225         88  CO-FINAL-LETTER                  VALUE 'F'.
  5226         88  CO-RECONCILING                   VALUE 'R'.
  5227         88  CO-PHONE-CALL                    VALUE 'P'.
  5228         88  CO-LEGAL                         VALUE 'L'.
  5229         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  5230         88  CO-WRITE-OFF                     VALUE 'W'.
  5231         88  CO-NO-ACTION                     VALUE 'N' ' '.
  5232
  5233     12  CO-CSR-CODE                       PIC X(4).
  5234
  5235     12  CO-GA-STATUS-INFO.
  5236         16  CO-GA-EFFECTIVE-DT            PIC XX.
  5237         16  CO-GA-TERMINATION-DT          PIC XX.
  5238         16  CO-GA-STATUS-CODE             PIC X.
  5239             88  CO-GA-ACTIVE                 VALUE 'A'.
  5240             88  CO-GA-INACTIVE               VALUE 'I'.
  5241             88  CO-GA-PENDING                VALUE 'P'.
  5242         16  CO-GA-COMMENTS.
  5243             20  CO-GA-COMMENT-1           PIC X(40).
  5244             20  CO-GA-COMMENT-2           PIC X(40).
  5245             20  CO-GA-COMMENT-3           PIC X(40).
  5246             20  CO-GA-COMMENT-4           PIC X(40).
  5247
  5248     12  CO-RPTCD2                         PIC X(10).
  5249     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  5250         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  5251         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  5252
  5253     12  CO-TYPE-AGENT                     PIC X(01).
  5254         88  CO-CORPORATION                   VALUE 'C'.
  5255         88  CO-PARTNERSHIP                   VALUE 'P'.
  5256         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  5257         88  CO-TRUST                         VALUE 'T'.
  5258         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  5259
  5260     12  CO-FAXNO.
  5261         16  CO-FAX-AREA-CODE                  PIC XXX.
  5262         16  CO-FAX-PREFIX                     PIC XXX.
  5263         16  CO-FAX-PHONE                      PIC X(4).
  5264
  5265     12  CO-BANK-INFORMATION.
  5266         16  CO-BANK-TRANSIT-NO                PIC X(8).
  5267         16  CO-BANK-TRANSIT-NON REDEFINES
  5268             CO-BANK-TRANSIT-NO                PIC 9(8).
  5269
  5270         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  5271     12  CO-MISC-DEDUCT-INFO REDEFINES
  5272                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 103
* EL630.cbl
  5273         16  CO-MD-GL-ACCT                     PIC X(10).
  5274         16  CO-MD-DIV                         PIC XX.
  5275         16  CO-MD-CENTER                      PIC X(4).
  5276         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  5277         16  CO-CREATE-AP-CHECK                PIC X.
  5278         16  CO-DELIVER-CK-TO-MEL              PIC X.
  5279         16  FILLER                            PIC XXX.
  5280     12  CO-ACH-STATUS                         PIC X.
  5281         88  CO-ACH-ACTIVE                         VALUE 'A'.
  5282         88  CO-ACH-PENDING                        VALUE 'P'.
  5283
  5284     12  CO-BILL-SW                            PIC X.
  5285     12  CO-CONTROL-NAME                       PIC X(30).
  5286     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  5287     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  5288     12  CO-CLP-STATE                          PIC XX.
  5289     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  5290     12  CO-SPP-REFUND-EDIT                    PIC X.
  5291
  5292******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 104
* EL630.cbl
  5294*    COPY ERCRQST.
  5295******************************************************************
  5296*                                                                *
  5297*                                                                *
  5298*                            ERCRQST.                            *
  5299*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5300*                            VMOD=2.002                          *
  5301*                                                                *
  5302*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  5303*                                                                *
  5304*   FILE TYPE = VSAM,KSDS                                        *
  5305*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5306*                                                                *
  5307*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  5308*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  5309*                                   ACCOUNT, REF, BATCH)         *
  5310*                                                RKP=9, LEN=38   *
  5311*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  5312*                                   ACCOUNT, REF, BATCH)         *
  5313*                                                RKP=47, LEN=46  *
  5314*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  5315*                                   BATCH)                       *
  5316*                                                RKP=93, LEN=24  *
  5317*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  5318*                                   REF, BATCH)                  *
  5319*                                                RKP=117, LEN=35 *
  5320*   LOG = NO                                                     *
  5321*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5322******************************************************************
  5323
  5324 01  AR-REQUEST-RECORD.
  5325     12  RQ-RECORD-ID                     PIC XX.
  5326         88  VALID-RQ-ID                        VALUE 'RQ'.
  5327
  5328     12  RQ-CONTROL-PRIMARY.
  5329         16  RQ-COMPANY-CD                PIC X.
  5330         16  RQ-ENTRY-BATCH               PIC X(6).
  5331
  5332     12  RQ-CONTROL-BY-ACCT-REF.
  5333         16  RQ-COMPANY-CD-A1             PIC X.
  5334         16  RQ-CARRIER-A1                PIC X.
  5335         16  RQ-GROUPING-A1               PIC X(6).
  5336         16  RQ-STATE-A1                  PIC XX.
  5337         16  RQ-ACCOUNT-A1                PIC X(10).
  5338         16  RQ-REFERENCE-A1              PIC X(12).
  5339         16  RQ-BATCH-A1                  PIC X(6).
  5340
  5341     12  RQ-CONTROL-BY-FIN-RESP.
  5342         16  RQ-COMPANY-CD-A2             PIC X.
  5343         16  RQ-CARRIER-A2                PIC X.
  5344         16  RQ-GROUPING-A2               PIC X(6).
  5345         16  RQ-FIN-RESP-A2               PIC X(10).
  5346         16  RQ-ACCT-AGENT-A2             PIC X(10).
  5347         16  RQ-REFERENCE-A2              PIC X(12).
  5348         16  RQ-BATCH-A2                  PIC X(6).
  5349
  5350     12  RQ-CONTROL-BY-ACCT-AGENT.
  5351         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 105
* EL630.cbl
  5352         16  RQ-CARRIER-A3                PIC X.
  5353         16  RQ-GROUPING-A3               PIC X(6).
  5354         16  RQ-ACCT-AGENT-A3             PIC X(10).
  5355         16  RQ-BATCH-A3                  PIC X(6).
  5356
  5357     12  RQ-CONTROL-BY-SUMMARY.
  5358         16  RQ-COMPANY-CD-A4             PIC X.
  5359         16  RQ-SUMMARY-CODE              PIC X(6).
  5360         16  RQ-ACCOUNT-A4                PIC X(10).
  5361         16  RQ-REFERENCE-A4              PIC X(12).
  5362         16  RQ-BATCH-A4                  PIC X(6).
  5363
  5364     12  RQ-REQUEST-METHOD                PIC X.
  5365         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  5366         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  5367         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  5368         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  5369     12  FILLER                           PIC X.
  5370     12  RQ-STATUS                        PIC X.
  5371         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  5372         88  RQ-RESUBMIT                      VALUE 'R'.
  5373     12  RQ-PROCESSOR-ID                  PIC X(4).
  5374     12  RQ-ENTRY-DT                      PIC XX.
  5375     12  RQ-MO-END-DT                     PIC XX.
  5376     12  RQ-REQUEST-DT                    PIC XX.
  5377     12  RQ-STMT-DT                       PIC XX.
  5378     12  RQ-REVERSAL-DT                   PIC XX.
  5379     12  RQ-CREDIT-SELECT-DT              PIC XX.
  5380     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  5381
  5382     12  FILLER                           PIC X(27).
  5383
  5384******************************************************************
  5385
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 106
* EL630.cbl
  5387*    COPY ERCCNOT.
  5388******************************************************************
  5389*                                                                *
  5390*                            ERCCNOT                             *
  5391*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5392*                            VMOD=2.003                          *
  5393*                                                                *
  5394*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5395*                                                                *
  5396*        FILE TYPE= VSAM,KSDS                                    *
  5397*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5398*                                                                *
  5399*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5400*                                                                *
  5401*        LOG = YES                                               *
  5402*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5403*                                                                *
  5404******************************************************************
  5405*                   C H A N G E   L O G
  5406*
  5407* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5408*-----------------------------------------------------------------
  5409*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5410* EFFECTIVE    NUMBER
  5411*-----------------------------------------------------------------
  5412* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5413******************************************************************
  5414
  5415 01  CERT-NOTE-FILE.
  5416     12  CZ-RECORD-ID                PIC  XX.
  5417         88  VALID-CZ-ID                  VALUE 'CZ'.
  5418
  5419     12  CZ-CONTROL-PRIMARY.
  5420         16  CZ-COMPANY-CD           PIC X.
  5421         16  CZ-CARRIER              PIC X.
  5422         16  CZ-GROUPING.
  5423             20 CZ-GROUPING-PREFIX   PIC XXX.
  5424             20 CZ-GROUPING-PRIME    PIC XXX.
  5425         16  CZ-STATE                PIC XX.
  5426         16  CZ-ACCOUNT.
  5427             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5428             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5429         16  CZ-CERT-EFF-DT          PIC XX.
  5430         16  CZ-CERT-NO.
  5431             20  CZ-CERT-PRIME       PIC X(10).
  5432             20  CZ-CERT-SFX         PIC X.
  5433         16  CZ-RECORD-TYPE          PIC X.
  5434             88  CERT-NOTE           VALUE '1'.
  5435             88  CLAIM-CERT-NOTE     VALUE '2'.
  5436         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5437
  5438     12  CZ-LAST-MAINT-DT            PIC XX.
  5439     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5440     12  CZ-LAST-MAINT-USER          PIC X(4).
  5441
  5442     12  CZ-NOTE-INFORMATION.
  5443         16  CZ-NOTE                 PIC X(63).
  5444         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 107
* EL630.cbl
  5445******************************************************************
  5446
  5447 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5448                          PENDING-BUSINESS ACCOUNT-MASTER
  5449                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  5450                          MAILING-DATA PENDING-MAILING-DATA
  5451                          COMPENSATION-MASTER AR-REQUEST-RECORD
  5452                          CERT-NOTE-FILE.
  5453 0000-DFHEXIT SECTION.
  5454     MOVE '9#                    $   ' TO DFHEIV0.
  5455     MOVE 'EL630' TO DFHEIV1.
  5456     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5457
  5458     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5459     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  5460     IF EIBCALEN = 0
  5461         GO TO 8800-UNAUTHORIZED-ACCESS.
  5462
  5463     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  5464     MOVE '5'                    TO DC-OPTION-CODE.
  5465     PERFORM 9700-DATE-LINK.
  5466
  5467     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  5468     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT.
  5469     MOVE DC-GREG-DATE-1-YMD     TO WS-CURRENT-YMD.
  5470
  5471     MOVE PI-CALLING-PROGRAM TO PI-SAVE-CALLING-PGM.
  5472     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5473         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5474             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5475             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5476             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5477             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5478             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5479             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5480             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5481             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5482             MOVE SPACES               TO PI-PROGRAM-WORK-AREA
  5483                                          PI-MISC
  5484         ELSE
  5485             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  5486             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  5487             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  5488             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  5489             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  5490             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  5491             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  5492             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  5493
  5494     MOVE LOW-VALUES             TO EL630AI.
  5495
  5496     IF PI-SAVE-CALLING-PGM = XCTL-6302
  5497         GO TO 4000-SHOW-TOTALS.
  5498
  5499     IF PI-SAVE-CALLING-PGM = XCTL-6301 or 'VP6301'
  5500         MOVE 'N'                TO PI-EL630-FIRST-TIME-SW
  5501         IF (PI-CAN-CNT-REMITTED GREATER ZERO OR
  5502             PI-ISS-CNT-REMITTED GREATER ZERO)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 108
* EL630.cbl
  5503                 GO TO 4000-SHOW-TOTALS
  5504         ELSE
  5505         IF PI-ISS-CNT-ENTERED = ZEROS  AND
  5506            PI-CAN-CNT-ENTERED = ZEROS
  5507             MOVE 'Y'            TO PI-VERIFY-DELETE-SW
  5508             GO TO 3000-DELETE-ENTERED-BATCH
  5509         ELSE
  5510             GO TO 4000-SHOW-TOTALS.
  5511
  5512     IF EIBTRNID NOT = TRANS-ID
  5513         MOVE SPACE              TO PI-BROWSE-SW
  5514         MOVE ZEROS              TO PI-LAST-SEQ-NO-ADDED
  5515         MOVE SPACES             TO PI-CR-CONTROL-IN-PROGRESS
  5516         MOVE QUESTION-MARKS     TO BATCHI
  5517         MOVE AL-UANON           TO BATCHA
  5518         GO TO 8100-SEND-INITIAL-MAP.
  5519
  5520
  5521* EXEC CICS HANDLE CONDITION
  5522*        PGMIDERR  (9600-PGMID-ERROR)
  5523*        ERROR     (9990-ABEND)
  5524*    END-EXEC.
  5525*    MOVE '"$L.                  ! " #00005516' TO DFHEIV0
  5526     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5527     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5528     MOVE X'2220233030303035353136' TO DFHEIV0(25:11)
  5529     CALL 'kxdfhei1' USING DFHEIV0
  5530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5531
  5532
  5533     IF EIBAID = DFHCLEAR
  5534        MOVE SPACES              TO PI-ACCT-AGENT-PROCESSED-SW
  5535        GO TO 9400-CLEAR.
  5536
  5537     IF PI-PROCESSOR-ID = 'LGXX'
  5538         GO TO 0200-RECEIVE.
  5539
  5540
  5541* EXEC CICS READQ TS
  5542*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5543*        INTO   (SECURITY-CONTROL)
  5544*        LENGTH (SC-COMM-LENGTH)
  5545*        ITEM   (SC-ITEM)
  5546*    END-EXEC.
  5547*    MOVE '*$II   L              ''   #00005528' TO DFHEIV0
  5548     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5549     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5550     MOVE X'2020233030303035353238' TO DFHEIV0(25:11)
  5551     CALL 'kxdfhei1' USING DFHEIV0,
  5552           PI-SECURITY-TEMP-STORE-ID,
  5553           SECURITY-CONTROL,
  5554           SC-COMM-LENGTH,
  5555           SC-ITEM,
  5556           DFHEIV99,
  5557           DFHEIV99
  5558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5559
  5560
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 109
* EL630.cbl
  5561     MOVE SC-CREDIT-DISPLAY (11)  TO PI-DISPLAY-CAP.
  5562     MOVE SC-CREDIT-UPDATE  (11)  TO PI-MODIFY-CAP.
  5563
  5564     IF NOT DISPLAY-CAP
  5565         MOVE 'READ'          TO SM-READ
  5566         PERFORM 9995-SECURITY-VIOLATION
  5567                              THRU 9995-EXIT
  5568         MOVE ER-0070         TO  EMI-ERROR
  5569         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5570         GO TO 8100-SEND-INITIAL-MAP.
  5571
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 110
* EL630.cbl
  5573 0200-RECEIVE.
  5574     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5575         MOVE ER-0008            TO EMI-ERROR
  5576         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5577         MOVE -1                 TO MAINTL
  5578         GO TO 8200-SEND-DATAONLY.
  5579
  5580
  5581* EXEC CICS RECEIVE
  5582*        MAP      (MAP-NAME)
  5583*        MAPSET   (MAPSET-NAME)
  5584*        INTO     (EL630AI)
  5585*    END-EXEC.
  5586     MOVE LENGTH OF
  5587      EL630AI
  5588       TO DFHEIV11
  5589*    MOVE '8"T I  L              ''   #00005554' TO DFHEIV0
  5590     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5591     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5592     MOVE X'2020233030303035353534' TO DFHEIV0(25:11)
  5593     CALL 'kxdfhei1' USING DFHEIV0,
  5594           MAP-NAME,
  5595           EL630AI,
  5596           DFHEIV11,
  5597           MAPSET-NAME,
  5598           DFHEIV99,
  5599           DFHEIV99
  5600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5601
  5602
  5603     IF PFENTERL = 0
  5604         GO TO 0300-CHECK-PFKEYS.
  5605
  5606     IF PFENTERI NUMERIC
  5607        IF PFENTERI GREATER 0 AND LESS 25
  5608           MOVE PF-VALUES (PFENTERI) TO EIBAID
  5609        ELSE
  5610           MOVE ER-0029            TO EMI-ERROR
  5611           GO TO 0320-INPUT-ERROR.
  5612
  5613 0300-CHECK-PFKEYS.
  5614     IF EIBAID = DFHENTER
  5615        IF PI-CLEAR-ERROR
  5616           MOVE -1                 TO PFENTERL
  5617           MOVE ER-2213            TO EMI-ERROR
  5618           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5619           GO TO 4000-SHOW-TOTALS.
  5620
  5621     IF EIBAID = DFHPF23
  5622         GO TO 8810-PF23.
  5623     IF EIBAID = DFHPF24
  5624         GO TO 9200-RETURN-MAIN-MENU.
  5625     IF EIBAID = DFHPF12
  5626         GO TO 9500-PF12.
  5627
  5628     IF EIBAID = DFHPF1
  5629        IF PI-DATA-UPDATED
  5630           MOVE 'Y'            TO WS-PF1-SW
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 111
* EL630.cbl
  5631           MOVE SPACE          TO PI-NB-MONTH-END-DT
  5632                                  PI-CLEAR-ERROR-SW
  5633           PERFORM 2000-WRITE-BATCH-TOTAL-REC THRU 2990-EXIT
  5634           MOVE SPACES TO BATCH-TO-PROCESS
  5635           MOVE PI-COMPANY-ID  TO EDIT-COMPANY-ID
  5636           MOVE PI-COMPANY-CD  TO EDIT-COMPANY-CD
  5637           MOVE PI-SAV-ENTRY-BATCH TO EDIT-BATCH
  5638
  5639* EXEC CICS START
  5640*               TRANSID       (EDIT-TRANS)
  5641*               FROM          (BATCH-TO-PROCESS)
  5642*               LENGTH        (PASS-AREA-LEN)
  5643*          END-EXEC
  5644*    MOVE '0( LF                 1   #00005595' TO DFHEIV0
  5645     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  5646     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  5647     MOVE X'2020233030303035353935' TO DFHEIV0(25:11)
  5648     CALL 'kxdfhei1' USING DFHEIV0,
  5649           DFHEIV99,
  5650           EDIT-TRANS,
  5651           DFHEIV99,
  5652           BATCH-TO-PROCESS,
  5653           PASS-AREA-LEN,
  5654           DFHEIV99,
  5655           DFHEIV99,
  5656           DFHEIV99,
  5657           DFHEIV99,
  5658           DFHEIV99,
  5659           DFHEIV99,
  5660           DFHEIV99,
  5661           DFHEIV99,
  5662           DFHEIV99,
  5663           DFHEIV99,
  5664           DFHEIV99
  5665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5666           MOVE PI-SAV-REFERENCE TO PI-SAV-PYAJ-REFERENCE
  5667           MOVE SPACES         TO PI-UPDATE-SW
  5668                                  PI-KEYED-SWITCHES
  5669                                  PI-AGE-KEYED-SW
  5670                                  PI-BIRTHDT-KEYED-SW
  5671                                  PI-ACCT-AGENT-PROCESSED-SW
  5672                                  PI-SAV-REFERENCE
  5673           MOVE ZEROS          TO PI-ISS-CNT-ENTERED
  5674                                  PI-CAN-CNT-ENTERED
  5675           MOVE LOW-VALUES     TO EL630AO
  5676           MOVE SPACE          TO PI-BROWSE-SW
  5677           MOVE QUESTION-MARKS TO BATCHI
  5678           MOVE AL-UANON       TO BATCHA
  5679           MOVE -1             TO MAINTL
  5680           IF EMI-NO-ERRORS
  5681               MOVE ZEROS          TO EMI-ERROR
  5682               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5683               GO TO 8100-SEND-INITIAL-MAP
  5684           ELSE
  5685               GO TO 8100-SEND-INITIAL-MAP
  5686        ELSE
  5687           IF  MAINTI = 'N'
  5688               MOVE -1             TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 112
* EL630.cbl
  5689               MOVE ER-2211        TO EMI-ERROR
  5690               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5691               GO TO 8200-SEND-DATAONLY.
  5692
  5693     IF EIBAID = DFHPF1
  5694        MOVE SPACE          TO PI-NB-MONTH-END-DT
  5695                               PI-CLEAR-ERROR-SW
  5696        MOVE SPACES TO BATCH-TO-PROCESS
  5697        MOVE PI-COMPANY-ID  TO EDIT-COMPANY-ID
  5698        MOVE PI-COMPANY-CD  TO EDIT-COMPANY-CD
  5699        MOVE PI-SAV-ENTRY-BATCH TO EDIT-BATCH
  5700        IF EDIT-BATCH GREATER SPACES
  5701
  5702* EXEC CICS START
  5703*               TRANSID       (EDIT-TRANS)
  5704*               FROM          (BATCH-TO-PROCESS)
  5705*               LENGTH        (PASS-AREA-LEN)
  5706*            END-EXEC
  5707*    MOVE '0( LF                 1   #00005635' TO DFHEIV0
  5708     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  5709     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  5710     MOVE X'2020233030303035363335' TO DFHEIV0(25:11)
  5711     CALL 'kxdfhei1' USING DFHEIV0,
  5712           DFHEIV99,
  5713           EDIT-TRANS,
  5714           DFHEIV99,
  5715           BATCH-TO-PROCESS,
  5716           PASS-AREA-LEN,
  5717           DFHEIV99,
  5718           DFHEIV99,
  5719           DFHEIV99,
  5720           DFHEIV99,
  5721           DFHEIV99,
  5722           DFHEIV99,
  5723           DFHEIV99,
  5724           DFHEIV99,
  5725           DFHEIV99,
  5726           DFHEIV99,
  5727           DFHEIV99
  5728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5729             MOVE SPACES         TO PI-UPDATE-SW
  5730                                    PI-KEYED-SWITCHES
  5731                                    PI-AGE-KEYED-SW
  5732                                    PI-BIRTHDT-KEYED-SW
  5733                                    PI-ACCT-AGENT-PROCESSED-SW
  5734                                    PI-SAV-REFERENCE
  5735             MOVE ZEROS          TO PI-ISS-CNT-ENTERED
  5736                                    PI-CAN-CNT-ENTERED
  5737                                    EMI-ERROR
  5738             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5739             MOVE LOW-VALUES     TO EL630AO
  5740             MOVE SPACE          TO PI-BROWSE-SW
  5741             MOVE QUESTION-MARKS TO BATCHI
  5742             MOVE AL-UANON       TO BATCHA
  5743             MOVE -1             TO MAINTL
  5744             GO TO 8100-SEND-INITIAL-MAP
  5745        ELSE
  5746             MOVE -1             TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 113
* EL630.cbl
  5747             MOVE ER-2211        TO EMI-ERROR
  5748             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5749             GO TO 8200-SEND-DATAONLY.
  5750
  5751     IF EIBAID = DFHPF3
  5752         IF NOT PI-DATA-UPDATED
  5753             MOVE SPACE          TO PI-EL630-FIRST-TIME-SW
  5754             IF PI-AR-PROCESSING
  5755                MOVE XCTL-635       TO PGM-NAME
  5756                GO TO 9300-XCTL
  5757             ELSE
  5758                IF PI-COMPANY-ID = 'DMD'
  5759                   MOVE XCTL-633DMD TO PGM-NAME
  5760                   GO TO 9300-XCTL
  5761                ELSE
  5762                   MOVE XCTL-633    TO PGM-NAME
  5763                   GO TO 9300-XCTL
  5764         ELSE
  5765             MOVE -1             TO BATCHL
  5766             MOVE AL-UABON       TO BATCHA
  5767             MOVE ER-2213        TO EMI-ERROR
  5768             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5769             GO TO 8200-SEND-DATAONLY.
  5770
  5771     IF EIBAID = DFHPF4
  5772         IF NOT PI-EL630-FIRST-TIME
  5773             MOVE XCTL-6302      TO PGM-NAME
  5774             GO TO 9300-XCTL
  5775         ELSE
  5776             PERFORM 0400-PRIME-BATCH-TOTALS THRU 0490-EXIT
  5777             IF EMI-ERROR = ZEROS
  5778                 MOVE 'N'        TO PI-EL630-FIRST-TIME-SW
  5779                 MOVE XCTL-6302  TO PGM-NAME
  5780                 GO TO 9300-XCTL
  5781             ELSE
  5782                 GO TO 8200-SEND-DATAONLY.
  5783
  5784     IF EIBAID = DFHPF5
  5785             IF PI-EL630-FIRST-TIME
  5786                 MOVE -1         TO MAINTL
  5787                 GO TO 8200-SEND-DATAONLY
  5788             ELSE
  5789             IF PI-ISS-CNT-ENTERED = ZEROS  AND
  5790                PI-CAN-CNT-ENTERED = ZEROS
  5791                 MOVE LOW-VALUES TO     EL630AO
  5792                 MOVE QUESTION-MARKS TO BATCHI
  5793                 MOVE AL-UANON   TO     BATCHA
  5794                 MOVE -1         TO     MAINTL
  5795                 GO TO 8100-SEND-INITIAL-MAP
  5796             ELSE
  5797                 MOVE -1         TO BATCHL
  5798                 MOVE AL-UABON   TO BATCHA
  5799                 MOVE ER-2213    TO EMI-ERROR
  5800                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5801                 GO TO 4000-SHOW-TOTALS.
  5802
  5803     IF EIBAID = DFHPF2
  5804        MOVE  AL-UANON           TO  BATCHA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 114
* EL630.cbl
  5805        MOVE  BATCHI             TO PI-SAV-ENTRY-BATCH
  5806        GO TO 3000-DELETE-ENTERED-BATCH.
  5807
  5808     IF  MAINTI = 'S'
  5809         MOVE  MAINTI            TO  PI-MAINT-FUNC
  5810         PERFORM 0400-PRIME-BATCH-TOTALS  THRU  0490-EXIT
  5811             IF EMI-ERROR = ZEROS
  5812                 MOVE 'N'        TO PI-EL630-FIRST-TIME-SW
  5813                 GO TO 4000-SHOW-TOTALS
  5814             ELSE
  5815                 GO TO 8200-SEND-DATAONLY.
  5816
  5817     IF EIBAID = DFHENTER
  5818         GO TO 0330-EDIT-DATA.
  5819
  5820 0320-INPUT-ERROR.
  5821     MOVE ER-0029                TO EMI-ERROR.
  5822     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5823     MOVE AL-UNBON               TO PFENTERA.
  5824     IF PFENTERL = 0
  5825         MOVE -1                 TO MAINTL
  5826     ELSE
  5827         MOVE -1                 TO PFENTERL.
  5828
  5829     GO TO 8200-SEND-DATAONLY.
  5830
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 115
* EL630.cbl
  5832 0330-EDIT-DATA.
  5833     IF MODIFY-CAP
  5834         NEXT SENTENCE
  5835       ELSE
  5836         IF MAINTI NOT = 'S'
  5837           MOVE 'UPDATE'       TO SM-READ
  5838           PERFORM 9995-SECURITY-VIOLATION
  5839                              THRU 9995-EXIT
  5840           MOVE ER-0070        TO EMI-ERROR
  5841           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5842           GO TO 8100-SEND-INITIAL-MAP.
  5843
  5844     MOVE SPACE                  TO  PI-NB-MONTH-END-DT.
  5845
  5846     PERFORM 1250-READ-COMPANY-REC THRU 1250-EXIT.
  5847
  5848     IF MAINTI = 'N' OR 'C' OR 'B' OR 'K'
  5849         NEXT SENTENCE
  5850     ELSE
  5851         MOVE ER-0023            TO EMI-ERROR
  5852         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5853         MOVE -1                 TO MAINTL
  5854         MOVE AL-UABON           TO MAINTA
  5855         GO TO 8200-SEND-DATAONLY.
  5856
  5857     IF PI-CARRIER-SECURITY GREATER SPACES
  5858         IF CARRIERL GREATER ZEROS
  5859           IF PI-CARRIER-SECURITY = CARRIERI
  5860              MOVE AL-UANON       TO CARRIERA
  5861            ELSE
  5862              MOVE -1             TO CARRIERL
  5863              MOVE AL-UABON       TO CARRIERA
  5864              MOVE ER-2370       TO EMI-ERROR
  5865              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5866
  5867     IF PI-ACCOUNT-SECURITY GREATER SPACES
  5868         IF ACCOUNTL GREATER ZEROS
  5869             IF PI-ACCOUNT-SECURITY = ACCOUNTI
  5870                 MOVE AL-UANON   TO ACCOUNTA
  5871               ELSE
  5872                 MOVE -1         TO ACCOUNTL
  5873                 MOVE AL-UABON   TO ACCOUNTA
  5874                 MOVE ER-2371   TO EMI-ERROR
  5875                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5876
  5877     IF  NOT EMI-NO-ERRORS
  5878         GO TO 8200-SEND-DATAONLY.
  5879
  5880     MOVE MAINTI                 TO PI-MAINT-FUNC.
  5881     MOVE AL-UANON               TO MAINTA.
  5882
  5883     MOVE PI-COMPANY-CD          TO PI-SAV-COMP-CD.
  5884     MOVE ZEROS                  TO PI-SAV-BATCH-SEQ
  5885                                    PI-SAV-BATCH-CHG-SEQ.
  5886     MOVE SPACES                 TO PI-SAV-CERT-EFF-DT
  5887                                    PI-SAV-CERT-NO.
  5888
  5889     IF BATCHL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 116
* EL630.cbl
  5890         MOVE -1                 TO BATCHL
  5891         MOVE AL-UNBON           TO BATCHA
  5892         MOVE ER-2201            TO EMI-ERROR
  5893         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5894     ELSE
  5895         IF BATCHI = QUESTION-MARKS OR SPACES
  5896             IF MAINTI = 'N'
  5897                 PERFORM 1300-GET-BATCH-NO THRU 1300-EXIT
  5898             ELSE
  5899                 MOVE -1         TO BATCHL
  5900                 MOVE AL-UNBON   TO BATCHA
  5901                 MOVE ER-2201    TO EMI-ERROR
  5902                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5903         ELSE
  5904             MOVE SPACE TO WS-SWITCH
  5905             PERFORM 0335-FAT-FINGER-EDIT VARYING PIC6-SUB
  5906                 FROM +1 BY +1
  5907                 UNTIL PIC6-SUB > +6 OR QUESTION-MARK-FOUND.
  5908
  5909     IF QUESTION-MARK-FOUND
  5910         IF MAINTI = 'N'
  5911             PERFORM 1300-GET-BATCH-NO THRU 1300-EXIT
  5912         ELSE
  5913             MOVE -1         TO BATCHL
  5914             MOVE AL-UNBON   TO BATCHA
  5915             MOVE ER-2201    TO EMI-ERROR
  5916             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5917     ELSE
  5918         IF BATCHI = PI-SAV-ENTRY-BATCH
  5919             MOVE AL-UANON   TO BATCHA
  5920         ELSE
  5921             MOVE BATCHI TO PI-SAV-ENTRY-BATCH
  5922             IF MAINTI = 'C' OR 'B'
  5923                 MOVE AL-UANON TO BATCHA
  5924                 MOVE ZEROS      TO ELFISSL  ELFCANL
  5925                                    EAHISSL  EAHCANL
  5926                                    EISSCNTL ECANCNTL
  5927                                    PI-LF-ISS-REMITTED
  5928                                    PI-LF-CAN-REMITTED
  5929                                    PI-AH-ISS-REMITTED
  5930                                    PI-AH-CAN-REMITTED
  5931                                    PI-ISS-CNT-REMITTED
  5932                                    PI-CAN-CNT-REMITTED.
  5933
  5934     IF REFL GREATER ZEROS
  5935        MOVE REFI                TO PI-SAV-REFERENCE.
  5936
  5937     IF MAINTI = 'C' OR 'B'
  5938         GO TO 0340-CHECK-TOTALS.
  5939
  5940     IF CARRIERL GREATER ZEROS
  5941         MOVE AL-UANON           TO CARRIERA
  5942         PERFORM 1000-VERIFY-CARRIER-ID THRU 1000-EXIT
  5943     ELSE
  5944         IF NOT ST-ACCNT-CNTL AND NOT ACCNT-CNTL
  5945             MOVE -1             TO CARRIERL
  5946             MOVE AL-UABON       TO CARRIERA
  5947             MOVE ER-0194        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 117
* EL630.cbl
  5948             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5949
  5950     IF GROUPL GREATER ZEROS
  5951         MOVE AL-UANON           TO GROUPA
  5952     ELSE
  5953         IF CARR-GROUP-ST-ACCNT-CNTL
  5954             MOVE -1 TO          GROUPL
  5955             MOVE AL-UABON       TO GROUPA
  5956             MOVE ER-0195        TO EMI-ERROR
  5957             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5958
  5959     IF STATEL GREATER ZEROS
  5960         MOVE AL-UANON           TO STATEA
  5961         PERFORM 1100-VERIFY-STATE-ID THRU 1100-EXIT
  5962     ELSE
  5963         IF NOT ACCNT-CNTL AND NOT CARR-ACCNT-CNTL
  5964             MOVE -1             TO STATEL
  5965             MOVE AL-UABON       TO STATEA
  5966             MOVE ER-0196        TO EMI-ERROR
  5967             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5968
  5969     IF ACCOUNTL GREATER ZEROS
  5970         MOVE AL-UANON           TO ACCOUNTA
  5971         PERFORM 1200-VERIFY-ACCOUNT THRU 1200-EXIT
  5972     ELSE
  5973         MOVE -1 TO ACCOUNTL
  5974         MOVE AL-UABON           TO ACCOUNTA
  5975         MOVE ER-0197            TO EMI-ERROR
  5976         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5977
  5978 0335-FAT-FINGER-EDIT.
  5979
  5980     IF BATCHI (PIC6-SUB:1) = QUESTION-MARK
  5981         SET QUESTION-MARK-FOUND TO TRUE
  5982     END-IF.
  5983
  5984 0340-CHECK-TOTALS.
  5985******************************************************************
  5986*        IF MAINTENANCE FUNCTION = 'K' (COPY BATCH)              *
  5987*           GO TO CHECK ERRORS.                                  *
  5988******************************************************************
  5989
  5990     IF  MAINTI = 'K'
  5991         GO TO 0340-ERROR-CHECK.
  5992
  5993*    ********************************************************
  5994*    *         THE FOLLOWING FIELDS ARE NOT REQUIRED        *
  5995*    *         IF ENTERED THE ONLY REQUIREMENT IS NUMERIC   *
  5996*    ********************************************************
  5997
  5998     IF ELFISSL GREATER ZEROS
  5999         MOVE AL-UNNON           TO ELFISSA
  6000
  6001* EXEC CICS BIF DEEDIT
  6002*            FIELD   (ELFISSI)
  6003*            LENGTH  (12)
  6004*        END-EXEC
  6005     MOVE 12
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 118
* EL630.cbl
  6006       TO DFHEIV11
  6007*    MOVE '@"L                   #   #00005911' TO DFHEIV0
  6008     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6009     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6010     MOVE X'2020233030303035393131' TO DFHEIV0(25:11)
  6011     CALL 'kxdfhei1' USING DFHEIV0,
  6012           ELFISSI,
  6013           DFHEIV11
  6014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6015         MOVE ELFISSI            TO PI-LF-ISS-REMITTED
  6016     ELSE
  6017         MOVE ZEROS              TO PI-LF-ISS-REMITTED.
  6018
  6019     IF ELFCANL GREATER ZEROS
  6020         MOVE AL-UNNON           TO ELFCANA
  6021
  6022* EXEC CICS BIF DEEDIT
  6023*            FIELD   (ELFCANI)
  6024*            LENGTH  (10)
  6025*        END-EXEC
  6026     MOVE 10
  6027       TO DFHEIV11
  6028*    MOVE '@"L                   #   #00005921' TO DFHEIV0
  6029     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6030     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6031     MOVE X'2020233030303035393231' TO DFHEIV0(25:11)
  6032     CALL 'kxdfhei1' USING DFHEIV0,
  6033           ELFCANI,
  6034           DFHEIV11
  6035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6036         MOVE ELFCANI            TO PI-LF-CAN-REMITTED
  6037     ELSE
  6038         MOVE ZEROS              TO PI-LF-CAN-REMITTED.
  6039
  6040     IF EAHISSL GREATER ZEROS
  6041         MOVE AL-UNNON           TO EAHISSA
  6042
  6043* EXEC CICS BIF DEEDIT
  6044*            FIELD   (EAHISSI)
  6045*            LENGTH  (12)
  6046*        END-EXEC
  6047     MOVE 12
  6048       TO DFHEIV11
  6049*    MOVE '@"L                   #   #00005931' TO DFHEIV0
  6050     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6051     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6052     MOVE X'2020233030303035393331' TO DFHEIV0(25:11)
  6053     CALL 'kxdfhei1' USING DFHEIV0,
  6054           EAHISSI,
  6055           DFHEIV11
  6056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6057         MOVE EAHISSI            TO PI-AH-ISS-REMITTED
  6058     ELSE
  6059         MOVE ZEROS              TO PI-AH-ISS-REMITTED.
  6060
  6061     IF EAHCANL GREATER ZEROS
  6062         MOVE AL-UNNON           TO EAHCANA
  6063
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 119
* EL630.cbl
  6064* EXEC CICS BIF DEEDIT
  6065*            FIELD   (EAHCANI)
  6066*            LENGTH  (10)
  6067*        END-EXEC
  6068     MOVE 10
  6069       TO DFHEIV11
  6070*    MOVE '@"L                   #   #00005941' TO DFHEIV0
  6071     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6072     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6073     MOVE X'2020233030303035393431' TO DFHEIV0(25:11)
  6074     CALL 'kxdfhei1' USING DFHEIV0,
  6075           EAHCANI,
  6076           DFHEIV11
  6077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6078         MOVE EAHCANI            TO PI-AH-CAN-REMITTED
  6079     ELSE
  6080         MOVE ZEROS              TO PI-AH-CAN-REMITTED.
  6081
  6082     IF EISSCNTL GREATER ZEROS
  6083         MOVE AL-UNNON           TO EISSCNTA
  6084
  6085* EXEC CICS BIF DEEDIT
  6086*            FIELD (EISSCNTI)
  6087*            LENGTH(6)
  6088*        END-EXEC
  6089     MOVE 6
  6090       TO DFHEIV11
  6091*    MOVE '@"L                   #   #00005951' TO DFHEIV0
  6092     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6093     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6094     MOVE X'2020233030303035393531' TO DFHEIV0(25:11)
  6095     CALL 'kxdfhei1' USING DFHEIV0,
  6096           EISSCNTI,
  6097           DFHEIV11
  6098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6099         MOVE EISSCNTI           TO PI-ISS-CNT-REMITTED
  6100     ELSE
  6101         MOVE ZEROS              TO PI-ISS-CNT-REMITTED.
  6102
  6103     IF ECANCNTL GREATER ZEROS
  6104         MOVE AL-UNNON           TO ECANCNTA
  6105
  6106* EXEC CICS BIF DEEDIT
  6107*            FIELD  (ECANCNTI)
  6108*            LENGTH (6)
  6109*        END-EXEC
  6110     MOVE 6
  6111       TO DFHEIV11
  6112*    MOVE '@"L                   #   #00005961' TO DFHEIV0
  6113     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6114     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6115     MOVE X'2020233030303035393631' TO DFHEIV0(25:11)
  6116     CALL 'kxdfhei1' USING DFHEIV0,
  6117           ECANCNTI,
  6118           DFHEIV11
  6119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6120         MOVE ECANCNTI           TO PI-CAN-CNT-REMITTED
  6121     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 120
* EL630.cbl
  6122         MOVE ZEROS              TO PI-CAN-CNT-REMITTED.
  6123
  6124     IF MNTHNDTL GREATER ZEROS
  6125        NEXT SENTENCE
  6126       ELSE
  6127        GO TO 0340-RECEIVED-DATE.
  6128
  6129     MOVE MNTHNDTI               TO WS-DT-DEEDIT-FIELD.
  6130     PERFORM 8600-DEEDIT THRU 8600-EXIT.
  6131
  6132     MOVE WS-DEEDIT-FIELD-DATE-OUT
  6133                                 TO DC-GREG-DATE-1-MDY.
  6134     MOVE '4'          TO DC-OPTION-CODE.
  6135     PERFORM 9700-DATE-LINK.
  6136
  6137     IF DATE-CONVERSION-ERROR
  6138        GO TO 0340-MNTH-DAY-ERROR.
  6139
  6140     MOVE DC-GREG-DATE-1-EDIT    TO MNTHNDTO.
  6141     MOVE DC-BIN-DATE-1          TO PI-NB-MONTH-END-DT.
  6142     MOVE DC-GREG-DATE-1-MDY     TO DATE-TEST-AREA.
  6143
  6144     IF DATE-TEST-DD = DC-DAYS-IN-MONTH OR 01
  6145        CONTINUE
  6146     ELSE
  6147        GO TO 0340-MNTH-DAY-ERROR.
  6148
  6149 0340-RECEIVED-DATE.
  6150
  6151     IF RECEVDTL GREATER ZEROS
  6152        NEXT SENTENCE
  6153       ELSE
  6154        MOVE WS-CURRENT-DT       TO RECEVDTI.
  6155
  6156     MOVE RECEVDTI               TO WS-DT-DEEDIT-FIELD.
  6157     PERFORM 8600-DEEDIT THRU 8600-EXIT.
  6158
  6159     MOVE WS-DEEDIT-FIELD-DATE-OUT
  6160                                 TO DC-GREG-DATE-1-MDY.
  6161     MOVE '4'          TO DC-OPTION-CODE.
  6162     PERFORM 9700-DATE-LINK.
  6163
  6164     IF DATE-CONVERSION-ERROR
  6165        GO TO 0340-RECEV-DAY-ERROR.
  6166
  6167     MOVE DC-GREG-DATE-1-EDIT    TO RECEVDTO.
  6168     MOVE DC-BIN-DATE-1          TO PI-RECEIVED-DT.
  6169
  6170     GO TO 0340-ERROR-CHECK.
  6171
  6172 0340-MNTH-DAY-ERROR.
  6173
  6174     MOVE -1       TO MNTHNDTL.
  6175     MOVE AL-UABON TO MNTHNDTA.
  6176     MOVE ER-0587  TO EMI-ERROR.
  6177     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6178     GO TO 0340-ERROR-CHECK.
  6179
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 121
* EL630.cbl
  6180 0340-RECEV-DAY-ERROR.
  6181
  6182     MOVE -1       TO RECEVDTL.
  6183     MOVE AL-UABON TO RECEVDTA.
  6184     MOVE ER-0905  TO EMI-ERROR.
  6185     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6186
  6187 0340-ERROR-CHECK.
  6188
  6189     IF NOT EMI-NO-ERRORS
  6190         GO TO 8200-SEND-DATAONLY.
  6191
  6192     IF PI-NB-MONTH-END-DT EQUAL LOW-VALUES OR SPACES
  6193        GO TO 0345-END-DATE-CHECK.
  6194
  6195     IF PI-NB-MONTH-END-DT LESS THAN PI-CR-MONTH-END-DT
  6196        MOVE PI-NB-MONTH-END-DT  TO DC-BIN-DATE-1
  6197        MOVE PI-CR-MONTH-END-DT  TO DC-BIN-DATE-2
  6198     ELSE
  6199     IF PI-CR-MONTH-END-DT LESS THAN PI-NB-MONTH-END-DT
  6200        MOVE PI-NB-MONTH-END-DT  TO DC-BIN-DATE-2
  6201        MOVE PI-CR-MONTH-END-DT  TO DC-BIN-DATE-1
  6202     ELSE
  6203        GO TO 0345-END-DATE-CHECK.
  6204
  6205     MOVE  '1'                   TO  DC-OPTION-CODE.
  6206     PERFORM  9700-DATE-LINK.
  6207
  6208     IF (DATE-CONVERSION-ERROR)
  6209                   OR
  6210        ((DC-ELAPSED-MONTHS GREATER THAN +1) AND
  6211         (PI-COMPANY-ID NOT EQUAL 'DMD'))
  6212        MOVE -1       TO MNTHNDTL
  6213        MOVE AL-UABON TO MNTHNDTA
  6214        MOVE ER-0587  TO EMI-ERROR
  6215        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6216
  6217 0345-END-DATE-CHECK.
  6218
  6219     IF NOT EMI-NO-ERRORS
  6220         GO TO 8200-SEND-DATAONLY.
  6221
  6222     IF PI-DELETE-IS-OK
  6223         MOVE SPACE              TO PI-VERIFY-DELETE-SW.
  6224
  6225     IF MAINTI = 'N'
  6226       AND PI-DATA-UPDATED
  6227         MOVE 'C'                TO PI-MAINT-FUNC
  6228         GO TO 0360-XCTL-EL6301.
  6229
  6230
  6231* EXEC CICS HANDLE CONDITION
  6232*        NOTFND  (0350-NO-RECORDS)
  6233*        ENDFILE (0350-NO-RECORDS)
  6234*    END-EXEC.
  6235*    MOVE '"$I''                  ! # #00006075' TO DFHEIV0
  6236     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6237     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 122
* EL630.cbl
  6238     MOVE X'2320233030303036303735' TO DFHEIV0(25:11)
  6239     CALL 'kxdfhei1' USING DFHEIV0
  6240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6241
  6242
  6243
  6244* EXEC CICS READ
  6245*        SET     (ADDRESS OF PENDING-BUSINESS)
  6246*        DATASET (ERPNDB-FILE-ID)
  6247*        RIDFLD  (PI-SAV-ENDING-ERPNDB-KEY)
  6248*        GTEQ
  6249*    END-EXEC.
  6250*    MOVE '&"S        G          (   #00006080' TO DFHEIV0
  6251     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6252     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6253     MOVE X'2020233030303036303830' TO DFHEIV0(25:11)
  6254     CALL 'kxdfhei1' USING DFHEIV0,
  6255           ERPNDB-FILE-ID,
  6256           DFHEIV20,
  6257           DFHEIV99,
  6258           PI-SAV-ENDING-ERPNDB-KEY,
  6259           DFHEIV99,
  6260           DFHEIV99,
  6261           DFHEIV99
  6262     SET ADDRESS OF PENDING-BUSINESS TO
  6263         DFHEIV20
  6264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6265
  6266
  6267     IF PI-SAV-COMP-CD     = PB-COMPANY-CD  AND
  6268        PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH
  6269         IF MAINTI = 'N'
  6270             MOVE ER-2229        TO EMI-ERROR
  6271             MOVE -1             TO MAINTL
  6272             MOVE AL-UABON       TO MAINTA
  6273             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6274             GO TO 8200-SEND-DATAONLY
  6275         ELSE
  6276             NEXT SENTENCE
  6277     ELSE
  6278         GO TO 0350-NO-RECORDS.
  6279
  6280     IF PI-CARRIER-SECURITY GREATER SPACES
  6281        IF PB-CARRIER = PI-CARRIER-SECURITY
  6282           NEXT SENTENCE
  6283         ELSE
  6284           GO TO 0350-NO-RECORDS.
  6285
  6286     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6287        IF PB-ACCOUNT = PI-ACCOUNT-SECURITY
  6288           NEXT SENTENCE
  6289         ELSE
  6290           GO TO 0350-NO-RECORDS.
  6291
  6292     IF PB-BILLED-DT NOT = LOW-VALUES
  6293         MOVE ER-2402            TO EMI-ERROR
  6294         MOVE -1                 TO BATCHL
  6295         MOVE AL-UABON           TO BATCHA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 123
* EL630.cbl
  6296         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6297         GO TO 8200-SEND-DATAONLY.
  6298
  6299******************************************************************
  6300*        IF MAINTENANCE FUNCTION = 'K'                           *
  6301*           REWRITE ENTIRE BATCH WITH NEW ACCOUNT INFORMATION.   *
  6302******************************************************************
  6303
  6304     IF  PI-SAV-COMP-CD = PB-COMPANY-CD
  6305         IF  PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH
  6306             IF  MAINTI = 'K'
  6307                 GO TO 6000-REWRITE-ENTIRE-BATCH.
  6308
  6309     IF PI-SAV-COMP-CD     = PB-COMPANY-CD   AND
  6310        PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH  AND
  6311        MAINTI NOT = 'N'
  6312         MOVE PB-CARRIER         TO PI-SAV-CARRIER
  6313                                    ACCT-CARRIER
  6314         MOVE PB-GROUPING        TO PI-SAV-GROUPING
  6315                                    ACCT-GROUPING
  6316         MOVE PB-STATE           TO PI-SAV-STATE
  6317                                    ACCT-STATE
  6318         MOVE PB-ACCOUNT         TO PI-SAV-ACCOUNT
  6319                                    ACCT-ACCOUNT
  6320         PERFORM 1200-READ-ACCOUNT THRU 1200-EXIT
  6321         PERFORM 2000-WRITE-BATCH-TOTAL-REC THRU 2990-EXIT
  6322         MOVE 'EL630B'           TO PI-MAP-NAME.
  6323         GO TO 0360-XCTL-EL6301.
  6324
  6325 0350-NO-RECORDS.
  6326     IF MAINTI = 'N'
  6327         MOVE SPACE              TO PI-ISSUE-ADDED-SW
  6328         MOVE ZEROS              TO PI-LF-ISS-ENTERED
  6329                                    PI-LF-CAN-ENTERED
  6330                                    PI-AH-ISS-ENTERED
  6331                                    PI-AH-CAN-ENTERED
  6332                                    PI-ISS-CNT-ENTERED
  6333                                    PI-CAN-CNT-ENTERED
  6334         PERFORM 2000-WRITE-BATCH-TOTAL-REC THRU 2990-EXIT
  6335         IF PI-LF-ISS-REMITTED  = ZEROS AND
  6336            PI-AH-ISS-REMITTED  = ZEROS AND
  6337            PI-LF-CAN-REMITTED  = ZEROS AND
  6338            PI-AH-CAN-REMITTED  = ZEROS AND
  6339            PI-ISS-CNT-REMITTED = ZEROS AND
  6340            PI-CAN-CNT-REMITTED = ZEROS
  6341             MOVE 'EL630B'     TO PI-MAP-NAME
  6342             GO TO 0360-XCTL-EL6301
  6343         ELSE
  6344             IF PI-LF-ISS-REMITTED  = ZEROS AND
  6345                PI-AH-ISS-REMITTED  = ZEROS AND
  6346                PI-ISS-CNT-REMITTED = ZEROS
  6347                 MOVE 'EL630C'     TO PI-MAP-NAME
  6348                 GO TO 0360-XCTL-EL6301
  6349             ELSE
  6350                 MOVE 'EL630B'     TO PI-MAP-NAME
  6351                 GO TO 0360-XCTL-EL6301
  6352     ELSE
  6353         MOVE ER-2212            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 124
* EL630.cbl
  6354         MOVE -1                 TO BATCHL
  6355         MOVE AL-UABON           TO BATCHA
  6356         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6357         GO TO 8200-SEND-DATAONLY.
  6358
  6359 0360-XCTL-EL6301.
  6360     IF PI-MAINT-FUNC = 'N'
  6361         MOVE SPACES             TO PI-KEYED-SWITCHES
  6362                                    PI-AGE-KEYED-SW
  6363                                    PI-BIRTHDT-KEYED-SW.
  6364
  6365     if pi-company-id = 'VPP'
  6366        move 'VP6301'            to pgm-name
  6367        move 'VP630B'            to PI-MAP-NAME
  6368     else
  6369        MOVE XCTL-6301           TO PGM-NAME
  6370     end-if
  6371
  6372     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 125
* EL630.cbl
  6374 0400-PRIME-BATCH-TOTALS.
  6375
  6376* EXEC CICS HANDLE CONDITION
  6377*        NOTFND (0480-NO-BATCH-TRAILER)
  6378*    END-EXEC.
  6379*    MOVE '"$I                   ! $ #00006195' TO DFHEIV0
  6380     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6381     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6382     MOVE X'2420233030303036313935' TO DFHEIV0(25:11)
  6383     CALL 'kxdfhei1' USING DFHEIV0
  6384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6385
  6386
  6387     MOVE PI-COMPANY-CD          TO PNDB-COMP-CD.
  6388     MOVE 9999                   TO PNDB-BATCH-SEQ.
  6389     MOVE BATCHI                 TO PNDB-ENTRY-BATCH.
  6390
  6391
  6392* EXEC CICS READ
  6393*        DATASET (ERPNDB-FILE-ID)
  6394*        SET     (ADDRESS OF PENDING-BUSINESS)
  6395*        RIDFLD  (ERPNDB-KEY)
  6396*    END-EXEC.
  6397*    MOVE '&"S        E          (   #00006203' TO DFHEIV0
  6398     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6399     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6400     MOVE X'2020233030303036323033' TO DFHEIV0(25:11)
  6401     CALL 'kxdfhei1' USING DFHEIV0,
  6402           ERPNDB-FILE-ID,
  6403           DFHEIV20,
  6404           DFHEIV99,
  6405           ERPNDB-KEY,
  6406           DFHEIV99,
  6407           DFHEIV99,
  6408           DFHEIV99
  6409     SET ADDRESS OF PENDING-BUSINESS TO
  6410         DFHEIV20
  6411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6412
  6413
  6414     IF PB-BILLED-DT NOT = LOW-VALUES
  6415         MOVE ER-2402            TO EMI-ERROR
  6416         MOVE -1                 TO BATCHL
  6417         MOVE AL-UABON           TO BATCHA
  6418         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6419         GO TO 0490-EXIT.
  6420
  6421     MOVE SPACES                   TO PI-ACCT-AGENT-PROCESSED-SW.
  6422     MOVE PI-COMPANY-CD            TO PI-SAV-COMP-CD.
  6423     MOVE PB-ENTRY-BATCH           TO PI-SAV-ENTRY-BATCH.
  6424
  6425     MOVE PB-REFERENCE             TO PI-SAV-REFERENCE.
  6426     MOVE PB-CSR-ID                TO PI-CSR-ID.
  6427
  6428     MOVE PB-CARRIER               TO PI-SAV-CARRIER.
  6429     MOVE PB-GROUPING              TO PI-SAV-GROUPING.
  6430     MOVE PB-STATE                 TO PI-SAV-STATE.
  6431     MOVE PB-ACCOUNT               TO PI-SAV-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 126
* EL630.cbl
  6432     MOVE PB-B-LF-ISS-PRM-REMITTED TO PI-LF-ISS-REMITTED.
  6433     MOVE PB-B-LF-ISS-PRM-ENTERED  TO PI-LF-ISS-ENTERED.
  6434     MOVE PB-B-AH-ISS-PRM-REMITTED TO PI-AH-ISS-REMITTED.
  6435     MOVE PB-B-AH-ISS-PRM-ENTERED  TO PI-AH-ISS-ENTERED.
  6436     MOVE PB-B-LF-CAN-PRM-REMITTED TO PI-LF-CAN-REMITTED.
  6437     MOVE PB-B-LF-CAN-PRM-ENTERED  TO PI-LF-CAN-ENTERED.
  6438     MOVE PB-B-AH-CAN-PRM-REMITTED TO PI-AH-CAN-REMITTED.
  6439     MOVE PB-B-AH-CAN-PRM-ENTERED  TO PI-AH-CAN-ENTERED.
  6440     MOVE PB-B-ISSUE-CNT-REMITTED  TO PI-ISS-CNT-REMITTED.
  6441     MOVE PB-B-ISSUE-CNT-ENTERED   TO PI-ISS-CNT-ENTERED.
  6442     MOVE PB-B-CANCEL-CNT-REMITTED TO PI-CAN-CNT-REMITTED.
  6443     MOVE PB-B-CANCEL-CNT-ENTERED  TO PI-CAN-CNT-ENTERED.
  6444
  6445******************************************************************
  6446*    IF THE MONTH-END-DATE IN THE TRAILER RECORD (BATCH HEADER)  *
  6447*       IS NOT EQUAL TO THE ACCOUNTS MONTH-END-DATE PRIME THE    *
  6448*       TRAILER'S MONTH-END-DATE.                                *
  6449******************************************************************
  6450
  6451     MOVE SPACE                    TO PI-NB-MONTH-END-DT.
  6452     IF  PB-CREDIT-SELECT-DT = PI-CR-MONTH-END-DT
  6453         NEXT SENTENCE
  6454       ELSE
  6455         MOVE PB-CREDIT-SELECT-DT  TO  PI-NB-MONTH-END-DT.
  6456
  6457     IF  PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
  6458         MOVE PB-INPUT-DT          TO PI-RECEIVED-DT
  6459     ELSE
  6460         MOVE PB-B-RECEIVED-DT     TO PI-RECEIVED-DT.
  6461
  6462     GO TO 0490-EXIT.
  6463
  6464 0480-NO-BATCH-TRAILER.
  6465     MOVE ER-2212                TO EMI-ERROR.
  6466     MOVE -1                     TO BATCHL.
  6467     MOVE AL-UABON               TO BATCHA.
  6468     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6469
  6470 0490-EXIT.
  6471     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 127
* EL630.cbl
  6473 1000-VERIFY-CARRIER-ID.
  6474     MOVE SPACES                 TO ELCNTL-KEY.
  6475     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  6476     MOVE '6'                    TO CNTL-REC-TYPE.
  6477     MOVE CARRIERI               TO CNTL-CARRIER
  6478     MOVE +0                     TO CNTL-SEQ.
  6479
  6480
  6481* EXEC CICS HANDLE CONDITION
  6482*        NOTFND   (1000-NO-CARRIER)
  6483*    END-EXEC.
  6484*    MOVE '"$I                   ! % #00006275' TO DFHEIV0
  6485     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6486     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6487     MOVE X'2520233030303036323735' TO DFHEIV0(25:11)
  6488     CALL 'kxdfhei1' USING DFHEIV0
  6489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6490
  6491
  6492
  6493* EXEC CICS READ
  6494*        DATASET   (ELCNTL-FILE-ID)
  6495*        SET       (ADDRESS OF CONTROL-FILE)
  6496*        RIDFLD    (ELCNTL-KEY)
  6497*    END-EXEC.
  6498*    MOVE '&"S        E          (   #00006279' TO DFHEIV0
  6499     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6500     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6501     MOVE X'2020233030303036323739' TO DFHEIV0(25:11)
  6502     CALL 'kxdfhei1' USING DFHEIV0,
  6503           ELCNTL-FILE-ID,
  6504           DFHEIV20,
  6505           DFHEIV99,
  6506           ELCNTL-KEY,
  6507           DFHEIV99,
  6508           DFHEIV99,
  6509           DFHEIV99
  6510     SET ADDRESS OF CONTROL-FILE TO
  6511         DFHEIV20
  6512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6513
  6514
  6515     GO TO 1000-EXIT.
  6516
  6517 1000-NO-CARRIER.
  6518     MOVE ER-2208                TO EMI-ERROR
  6519     MOVE -1                     TO CARRIERL
  6520     MOVE AL-UABON               TO CARRIERA
  6521     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6522
  6523 1000-EXIT.
  6524     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 128
* EL630.cbl
  6526 1100-VERIFY-STATE-ID.
  6527     MOVE SPACES                 TO ELCNTL-KEY.
  6528     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  6529     MOVE '3'                    TO CNTL-REC-TYPE.
  6530     MOVE STATEI                 TO CNTL-STATE.
  6531     MOVE +0                     TO CNTL-SEQ.
  6532
  6533
  6534* EXEC CICS HANDLE CONDITION
  6535*        NOTFND   (1100-NO-STATE)
  6536*    END-EXEC.
  6537*    MOVE '"$I                   ! & #00006303' TO DFHEIV0
  6538     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6539     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6540     MOVE X'2620233030303036333033' TO DFHEIV0(25:11)
  6541     CALL 'kxdfhei1' USING DFHEIV0
  6542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6543
  6544
  6545
  6546* EXEC CICS READ
  6547*        DATASET   (ELCNTL-FILE-ID)
  6548*        SET       (ADDRESS OF CONTROL-FILE)
  6549*        RIDFLD    (ELCNTL-KEY)
  6550*    END-EXEC.
  6551*    MOVE '&"S        E          (   #00006307' TO DFHEIV0
  6552     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6553     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6554     MOVE X'2020233030303036333037' TO DFHEIV0(25:11)
  6555     CALL 'kxdfhei1' USING DFHEIV0,
  6556           ELCNTL-FILE-ID,
  6557           DFHEIV20,
  6558           DFHEIV99,
  6559           ELCNTL-KEY,
  6560           DFHEIV99,
  6561           DFHEIV99,
  6562           DFHEIV99
  6563     SET ADDRESS OF CONTROL-FILE TO
  6564         DFHEIV20
  6565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6566
  6567
  6568     GO TO 1100-EXIT.
  6569
  6570 1100-NO-STATE.
  6571     MOVE ER-2209                TO EMI-ERROR.
  6572     MOVE -1                     TO STATEL.
  6573     MOVE AL-UABON               TO STATEA.
  6574     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6575     GO TO 8200-SEND-DATAONLY.
  6576
  6577 1100-EXIT.
  6578     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 129
* EL630.cbl
  6580
  6581 1200-VERIFY-ACCOUNT.
  6582     IF CARRIERL GREATER ZEROS
  6583         MOVE CARRIERI           TO ACCT-CARRIER
  6584     ELSE
  6585         MOVE SPACES             TO ACCT-CARRIER.
  6586
  6587     IF GROUPL GREATER ZEROS
  6588         MOVE GROUPI             TO ACCT-GROUPING
  6589     ELSE
  6590         MOVE SPACES             TO ACCT-GROUPING.
  6591
  6592     IF STATEL GREATER ZEROS
  6593         MOVE STATEI             TO ACCT-STATE
  6594     ELSE
  6595         MOVE SPACES             TO ACCT-STATE.
  6596
  6597     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  6598
  6599 1200-READ-ACCOUNT.
  6600     MOVE PI-COMPANY-CD          TO ACCT-CO.
  6601     MOVE LOW-VALUES             TO ACCT-EXP-DATE
  6602                                    PI-ACCT-LOW-EFF-DT
  6603                                    PI-ACCT-HIGH-EXP-DT.
  6604
  6605
  6606* EXEC CICS HANDLE CONDITION
  6607*        NOTFND   (1200-ACCOUNT-INVALID)
  6608*        ENDFILE  (1200-ACCOUNT-INVALID)
  6609*    END-EXEC.
  6610*    MOVE '"$I''                  ! '' #00006350' TO DFHEIV0
  6611     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6612     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6613     MOVE X'2720233030303036333530' TO DFHEIV0(25:11)
  6614     CALL 'kxdfhei1' USING DFHEIV0
  6615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6616
  6617
  6618
  6619* EXEC CICS STARTBR
  6620*        DATASET (ERACCT2-FILE-ID)
  6621*        RIDFLD  (ERACCT-KEY)
  6622*    END-EXEC.
  6623     MOVE 0
  6624       TO DFHEIV11
  6625*    MOVE '&,         G          &   #00006355' TO DFHEIV0
  6626     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6627     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6628     MOVE X'2020233030303036333535' TO DFHEIV0(25:11)
  6629     CALL 'kxdfhei1' USING DFHEIV0,
  6630           ERACCT2-FILE-ID,
  6631           ERACCT-KEY,
  6632           DFHEIV99,
  6633           DFHEIV11,
  6634           DFHEIV99
  6635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6636
  6637
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 130
* EL630.cbl
  6638     MOVE ERACCT-KEY             TO ERACCT-SAVE-KEY.
  6639
  6640 1200-READ-LOOP.
  6641
  6642* EXEC CICS READNEXT
  6643*        DATASET   (ERACCT2-FILE-ID)
  6644*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6645*        RIDFLD    (ERACCT-KEY)
  6646*    END-EXEC.
  6647     MOVE 0
  6648       TO DFHEIV11
  6649*    MOVE '&.S                   )   #00006363' TO DFHEIV0
  6650     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6651     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6652     MOVE X'2020233030303036333633' TO DFHEIV0(25:11)
  6653     CALL 'kxdfhei1' USING DFHEIV0,
  6654           ERACCT2-FILE-ID,
  6655           DFHEIV20,
  6656           DFHEIV99,
  6657           ERACCT-KEY,
  6658           DFHEIV99,
  6659           DFHEIV11,
  6660           DFHEIV99,
  6661           DFHEIV99
  6662     SET ADDRESS OF ACCOUNT-MASTER TO
  6663         DFHEIV20
  6664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6665
  6666
  6667     IF ERACCT-COMP-KEY NOT = ERACCT-SAVE-KEY
  6668         GO TO 1200-ACCOUNT-INVALID.
  6669
  6670     IF WS-ON1-SW1 IS EQUAL TO 'Y'
  6671         MOVE 'N'                TO WS-ON1-SW1
  6672         MOVE +0                 TO WS-SUB1
  6673         MOVE AM-CARRIER         TO PI-SAV-FC-CARRIER
  6674         MOVE AM-GROUPING        TO PI-SAV-FC-GROUPING
  6675         MOVE AM-STATE           TO PI-SAV-FC-STATE
  6676         MOVE AM-VG-CARRIER      TO PI-SAV-CARRIER
  6677         MOVE AM-VG-GROUPING     TO PI-SAV-GROUPING
  6678         MOVE AM-VG-STATE        TO PI-SAV-STATE
  6679         MOVE AM-VG-ACCOUNT      TO PI-SAV-ACCOUNT
  6680         MOVE AM-EFFECTIVE-DT    TO PI-ACCT-LOW-EFF-DT.
  6681
  6682     MOVE AM-EXPIRATION-DT       TO PI-ACCT-HIGH-EXP-DT.
  6683     MOVE AM-NAME                TO PI-AM-NAME.
  6684     IF AM-EDIT-LOAN-OFC = 'Y'
  6685        MOVE 'Y'                 TO PI-AM-EDIT-LOAN-OFC
  6686     ELSE
  6687        MOVE 'N'                 TO PI-AM-EDIT-LOAN-OFC
  6688     END-IF
  6689     IF AM-GPCD = 02 OR 03 OR 04 OR 05
  6690        MOVE AM-PERSON           TO PI-AM-ADDR1
  6691        MOVE AM-ADDRS            TO PI-AM-ADDR2
  6692*       MOVE AM-CITY             TO PI-AM-CITYST
  6693        MOVE AM-ADDR-CITY        TO PI-AM-CITY
  6694        MOVE AM-ADDR-STATE       TO PI-AM-STATE
  6695        MOVE AM-ZIP              TO PI-AM-ZIP
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 131
* EL630.cbl
  6696     ELSE
  6697        MOVE SPACES TO PI-AM-ADDR1 PI-AM-ADDR2
  6698                      PI-AM-CITYST PI-AM-ZIP
  6699     END-IF
  6700
  6701     MOVE AM-CARRIER             TO PI-COMP-CARRIER.
  6702     MOVE AM-GROUPING            TO PI-COMP-GROUPING.
  6703     MOVE AM-CSR-CODE            TO PI-CSR-ID.
  6704
  6705     IF PI-AR-PROCESSING
  6706        MOVE 'Y'                 TO WS-RECORD-FOUND-SW
  6707        PERFORM 1260-FIND-ACCT-AGENT THRU 1260-EXIT
  6708        IF RECORD-NOT-FOUND
  6709           GO TO 8200-SEND-DATAONLY.
  6710
  6711     GO TO 1200-READ-LOOP.
  6712
  6713 1200-ACCOUNT-INVALID.
  6714     IF PI-ACCT-LOW-EFF-DT NOT = LOW-VALUES
  6715        MOVE 'Y'                 TO PI-ACCT-AGENT-PROCESSED-SW
  6716        GO TO 1200-EXIT.
  6717
  6718     IF CARR-GROUP-ST-ACCNT-CNTL
  6719         MOVE -1                     TO CARRIERL
  6720         MOVE AL-UABON               TO CARRIERA
  6721                                        GROUPA
  6722                                        STATEA
  6723                                        ACCOUNTA
  6724     ELSE
  6725         IF ST-ACCNT-CNTL
  6726             MOVE -1                 TO STATEL
  6727             MOVE AL-UABON           TO STATEA
  6728                                        ACCOUNTA
  6729         ELSE
  6730             IF CARR-ST-ACCNT-CNTL
  6731                 MOVE -1             TO CARRIERL
  6732                 MOVE AL-UABON       TO CARRIERA
  6733                                        STATEA
  6734                                        ACCOUNTA
  6735             ELSE
  6736                 IF ACCNT-CNTL
  6737                     MOVE -1         TO ACCOUNTL
  6738                     MOVE AL-UABON   TO ACCOUNTA
  6739                 ELSE
  6740                     MOVE -1         TO CARRIERL
  6741                     MOVE AL-UABON   TO CARRIERA
  6742                                        ACCOUNTA.
  6743
  6744     MOVE ER-2210                TO EMI-ERROR.
  6745     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6746
  6747 1200-EXIT.
  6748     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 132
* EL630.cbl
  6750 1250-READ-COMPANY-REC.
  6751     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  6752     MOVE '1'                    TO CNTL-REC-TYPE.
  6753     MOVE SPACES                 TO CNTL-ACCESS.
  6754     MOVE +0                     TO CNTL-SEQ.
  6755
  6756
  6757* EXEC CICS HANDLE CONDITION
  6758*        NOTFND   (1250-NO-COMPANY-REC)
  6759*    END-EXEC.
  6760*    MOVE '"$I                   ! ( #00006458' TO DFHEIV0
  6761     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6762     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6763     MOVE X'2820233030303036343538' TO DFHEIV0(25:11)
  6764     CALL 'kxdfhei1' USING DFHEIV0
  6765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6766
  6767
  6768
  6769* EXEC CICS READ
  6770*        DATASET   (ELCNTL-FILE-ID)
  6771*        SET       (ADDRESS OF CONTROL-FILE)
  6772*        RIDFLD    (ELCNTL-KEY)
  6773*    END-EXEC.
  6774*    MOVE '&"S        E          (   #00006462' TO DFHEIV0
  6775     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6776     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6777     MOVE X'2020233030303036343632' TO DFHEIV0(25:11)
  6778     CALL 'kxdfhei1' USING DFHEIV0,
  6779           ELCNTL-FILE-ID,
  6780           DFHEIV20,
  6781           DFHEIV99,
  6782           ELCNTL-KEY,
  6783           DFHEIV99,
  6784           DFHEIV99,
  6785           DFHEIV99
  6786     SET ADDRESS OF CONTROL-FILE TO
  6787         DFHEIV20
  6788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6789
  6790
  6791     MOVE CF-CREDIT-EDIT-CONTROLS TO PI-CREDIT-EDIT-CONTROLS.
  6792     GO TO 1250-EXIT.
  6793
  6794 1250-NO-COMPANY-REC.
  6795     MOVE ER-2248                TO EMI-ERROR.
  6796     MOVE -1                     TO BATCHL.
  6797     MOVE AL-UABON               TO CARRIERA
  6798     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6799     GO TO 8200-SEND-DATAONLY.
  6800
  6801 1250-EXIT.
  6802     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 133
* EL630.cbl
  6804
  6805 1260-FIND-ACCT-AGENT.
  6806
  6807******************************************************************
  6808*                                                                *
  6809*            F I N D   A C C O U N T   A G E N T                 *
  6810*                                                                *
  6811*    NOTE:  IT IS NECESSARY TO LOAD EVERY DATE RANGE FOR         *
  6812*           EACH ACCOUNT AGENT / FINANCIAL RESPONSIBILITY        *
  6813*           INTO THE PROGRAM INTERFACE AREA.  THE ACCOUNT        *
  6814*           DATE RANGES ARE CHECKED DURING DATA ENTRY IN         *
  6815*           EL6301.                                              *
  6816*                                                                *
  6817******************************************************************
  6818
  6819     IF PI-ACCT-AGENT-PROCESSED
  6820        GO TO 1260-EXIT.
  6821
  6822     IF WS-ON1-SW2 IS EQUAL TO 'Y'
  6823        MOVE 'N'                 TO WS-ON1-SW2
  6824     ELSE
  6825        MOVE +0                  TO WS-SUB2
  6826        GO TO 1260-CONT-FIND-ACCT-AGENT.
  6827
  6828     MOVE +0                     TO WS-SUB2.
  6829
  6830 1260-INITIALIZE-DATE-RANGES.
  6831     ADD +1                      TO WS-SUB2.
  6832
  6833     IF WS-SUB2 GREATER +32
  6834        GO TO 1260-INITIALIZE-FINISHED.
  6835
  6836     MOVE SPACES                 TO PI-ACCT-EFF-DT (WS-SUB2)
  6837                                    PI-ACCT-EXP-DT (WS-SUB2)
  6838                                    PI-REMIT-AGENT (WS-SUB2)
  6839                                    PI-ACCT-AGENT  (WS-SUB2).
  6840
  6841     GO TO 1260-INITIALIZE-DATE-RANGES.
  6842
  6843 1260-INITIALIZE-FINISHED.
  6844     MOVE SPACES                 TO PI-ACCOUNT-AGENT
  6845                                    PI-FIN-RESP.
  6846
  6847     MOVE 'N'                    TO PI-ACCT-AGENT-ERROR-SW
  6848                                    PI-FIN-RESP-ERROR-SW.
  6849
  6850     MOVE +0                     TO WS-SUB2.
  6851
  6852 1260-CONT-FIND-ACCT-AGENT.
  6853     ADD  +1                     TO WS-SUB2.
  6854
  6855     IF WS-SUB2 GREATER +10
  6856        MOVE  SPACES             TO PI-ACCT-AGENT (WS-SUB1)
  6857        GO TO 1260-EXIT.
  6858
  6859     IF AM-COM-TYP (WS-SUB2) = 'C' OR 'D' OR 'F'
  6860        NEXT SENTENCE
  6861     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 134
* EL630.cbl
  6862        GO TO 1260-CONT-FIND-ACCT-AGENT.
  6863
  6864     IF WS-SUB1 = +0
  6865        MOVE +1                   TO WS-SUB1
  6866                                     PI-SUB
  6867        MOVE AM-EFFECTIVE-DT      TO PI-ACCT-EFF-DT (WS-SUB1)
  6868        MOVE AM-EXPIRATION-DT     TO PI-ACCT-EXP-DT (WS-SUB1)
  6869        MOVE AM-AGT (WS-SUB2)     TO PI-ACCT-AGENT  (WS-SUB1)
  6870        MOVE AM-AGT (AM-REMIT-TO) TO PI-REMIT-AGENT (WS-SUB1)
  6871        GO TO 1260-EXIT.
  6872
  6873     IF AM-AGT (WS-SUB2)     = PI-ACCT-AGENT  (WS-SUB1) AND
  6874        AM-AGT (AM-REMIT-TO) = PI-REMIT-AGENT (WS-SUB1)
  6875          MOVE AM-EXPIRATION-DT  TO PI-ACCT-EXP-DT (WS-SUB1)
  6876        ELSE
  6877          ADD +1                      TO WS-SUB1
  6878          IF WS-SUB1 GREATER +32
  6879              MOVE  ER-2119             TO EMI-ERROR
  6880              MOVE -1                   TO MAINTL
  6881              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  6882              MOVE 'N'                  TO WS-RECORD-FOUND-SW
  6883              GO TO 1260-EXIT
  6884          ELSE
  6885           MOVE WS-SUB1              TO PI-SUB
  6886           MOVE AM-EFFECTIVE-DT      TO PI-ACCT-EFF-DT (WS-SUB1)
  6887           MOVE AM-EXPIRATION-DT     TO PI-ACCT-EXP-DT (WS-SUB1)
  6888           MOVE AM-AGT (WS-SUB2)     TO PI-ACCT-AGENT  (WS-SUB1)
  6889           MOVE AM-AGT (AM-REMIT-TO) TO PI-REMIT-AGENT (WS-SUB1).
  6890
  6891 1260-EXIT.
  6892      EXIT.
  6893
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 135
* EL630.cbl
  6895
  6896 1300-GET-BATCH-NO.
  6897
  6898* EXEC CICS HANDLE CONDITION
  6899*        NOTFND   (1300-NO-COMPANY-REC)
  6900*    END-EXEC.
  6901*    MOVE '"$I                   ! ) #00006574' TO DFHEIV0
  6902     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6903     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6904     MOVE X'2920233030303036353734' TO DFHEIV0(25:11)
  6905     CALL 'kxdfhei1' USING DFHEIV0
  6906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6907
  6908
  6909
  6910* EXEC CICS READ
  6911*        DATASET   (ELCNTL-FILE-ID)
  6912*        SET       (ADDRESS OF CONTROL-FILE)
  6913*        RIDFLD    (ELCNTL-KEY)
  6914*        UPDATE
  6915*    END-EXEC.
  6916*    MOVE '&"S        EU         (   #00006578' TO DFHEIV0
  6917     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6918     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6919     MOVE X'2020233030303036353738' TO DFHEIV0(25:11)
  6920     CALL 'kxdfhei1' USING DFHEIV0,
  6921           ELCNTL-FILE-ID,
  6922           DFHEIV20,
  6923           DFHEIV99,
  6924           ELCNTL-KEY,
  6925           DFHEIV99,
  6926           DFHEIV99,
  6927           DFHEIV99
  6928     SET ADDRESS OF CONTROL-FILE TO
  6929         DFHEIV20
  6930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6931
  6932
  6933 1300-ASSIGN-NUMBER-LOOP.
  6934     IF CF-LAST-BATCH-RESET
  6935         MOVE ZEROS              TO CF-LAST-BATCH-NO
  6936         ADD +1                  TO CF-LAST-BATCH-NO
  6937     ELSE
  6938         ADD +1                  TO CF-LAST-BATCH-NO.
  6939
  6940     MOVE CF-LAST-BATCH-NO       TO WS-BATCH-NO.
  6941     MOVE WS-BATCH-NO            TO PI-SAV-ENTRY-BATCH.
  6942
  6943 1300-REWRITE-COMPANY-REC.
  6944     MOVE WS-BATCH-NO            TO BATCHI.
  6945     MOVE AL-UANON               TO BATCHA.
  6946
  6947
  6948* EXEC CICS REWRITE
  6949*        DATASET (ELCNTL-FILE-ID)
  6950*        FROM    (CONTROL-FILE)
  6951*    END-EXEC.
  6952     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 136
* EL630.cbl
  6953      CONTROL-FILE
  6954       TO DFHEIV11
  6955*    MOVE '&& L                  %   #00006599' TO DFHEIV0
  6956     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6957     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6958     MOVE X'2020233030303036353939' TO DFHEIV0(25:11)
  6959     CALL 'kxdfhei1' USING DFHEIV0,
  6960           ELCNTL-FILE-ID,
  6961           CONTROL-FILE,
  6962           DFHEIV11,
  6963           DFHEIV99
  6964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6965
  6966
  6967
  6968* EXEC CICS SYNCPOINT
  6969*    END-EXEC.
  6970*    MOVE '6"                    !   #00006604' TO DFHEIV0
  6971     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  6972     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6973     MOVE X'2020233030303036363034' TO DFHEIV0(25:11)
  6974     CALL 'kxdfhei1' USING DFHEIV0
  6975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6976
  6977
  6978 1300-CHECK-FOR-DUP-BATCH.
  6979
  6980* EXEC CICS HANDLE CONDITION
  6981*        NOTFND  (1300-EXIT)
  6982*    END-EXEC.
  6983*    MOVE '"$I                   ! * #00006608' TO DFHEIV0
  6984     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6985     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6986     MOVE X'2A20233030303036363038' TO DFHEIV0(25:11)
  6987     CALL 'kxdfhei1' USING DFHEIV0
  6988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6989
  6990
  6991
  6992* EXEC CICS READ
  6993*        SET     (ADDRESS OF PENDING-BUSINESS)
  6994*        DATASET (ERPNDB-FILE-ID)
  6995*        RIDFLD  (PI-SAV-ENDING-ERPNDB-KEY)
  6996*        GTEQ
  6997*    END-EXEC.
  6998*    MOVE '&"S        G          (   #00006612' TO DFHEIV0
  6999     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7000     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7001     MOVE X'2020233030303036363132' TO DFHEIV0(25:11)
  7002     CALL 'kxdfhei1' USING DFHEIV0,
  7003           ERPNDB-FILE-ID,
  7004           DFHEIV20,
  7005           DFHEIV99,
  7006           PI-SAV-ENDING-ERPNDB-KEY,
  7007           DFHEIV99,
  7008           DFHEIV99,
  7009           DFHEIV99
  7010     SET ADDRESS OF PENDING-BUSINESS TO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 137
* EL630.cbl
  7011         DFHEIV20
  7012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7013
  7014
  7015     IF PI-SAV-COMP-CD NOT = PB-COMPANY-CD
  7016         GO TO 1300-EXIT.
  7017
  7018     IF PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH
  7019         MOVE LOW-VALUES         TO EL630AO
  7020         MOVE QUESTION-MARKS     TO BATCHO
  7021         MOVE AL-UABON           TO BATCHA
  7022         MOVE -1                 TO BATCHL
  7023         MOVE ER-2229            TO EMI-ERROR
  7024         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7025         GO TO 8100-SEND-INITIAL-MAP.
  7026
  7027     GO TO 1300-EXIT.
  7028
  7029 1300-NO-COMPANY-REC.
  7030     MOVE ER-2248                TO EMI-ERROR.
  7031     MOVE -1                     TO BATCHL.
  7032     MOVE AL-UABON               TO CARRIERA
  7033     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7034     GO TO 8200-SEND-DATAONLY.
  7035
  7036 1300-EXIT.
  7037     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 138
* EL630.cbl
  7039
  7040 1400-VERIFY-COMP-MASTER.
  7041
  7042******************************************************************
  7043*
  7044*      V E R I F Y    C O M P E N S A T I O N    M A S T E R
  7045*
  7046*       READ COMPENSATION MASTER AND SAVE SUMMARY CODE FOR
  7047*       A.R. PROCESSING.
  7048*
  7049******************************************************************
  7050
  7051
  7052* EXEC CICS HANDLE CONDITION
  7053*        NOTFND   (1470-NO-COMP-MSTR)
  7054*    END-EXEC.
  7055*    MOVE '"$I                   ! + #00006655' TO DFHEIV0
  7056     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7057     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7058     MOVE X'2B20233030303036363535' TO DFHEIV0(25:11)
  7059     CALL 'kxdfhei1' USING DFHEIV0
  7060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7061
  7062
  7063     MOVE SPACE                  TO WS-COMP-MASTER-ERROR-SW.
  7064     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  7065
  7066     IF PI-ZERO-CARRIER OR
  7067        PI-ZERO-CAR-GROUP
  7068        MOVE ZEROS               TO ERCOMP-CARRIER
  7069     ELSE
  7070        MOVE PI-COMP-CARRIER     TO ERCOMP-CARRIER.
  7071
  7072     IF PI-ZERO-GROUPING OR
  7073        PI-ZERO-CAR-GROUP
  7074        MOVE ZEROS               TO ERCOMP-GROUPING
  7075     ELSE
  7076        MOVE PI-COMP-GROUPING    TO ERCOMP-GROUPING.
  7077
  7078     MOVE PI-FIN-RESP            TO ERCOMP-FIN-RESP.
  7079     MOVE PI-ACCOUNT-AGENT       TO ERCOMP-ACCT.
  7080     MOVE 'A'                    TO ERCOMP-RECORD-TYPE.
  7081
  7082
  7083* EXEC CICS READ
  7084*        DATASET   (ERCOMP-FILE-ID)
  7085*        SET       (ADDRESS OF COMPENSATION-MASTER)
  7086*        RIDFLD    (ERCOMP-KEY)
  7087*    END-EXEC.
  7088*    MOVE '&"S        E          (   #00006678' TO DFHEIV0
  7089     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7090     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7091     MOVE X'2020233030303036363738' TO DFHEIV0(25:11)
  7092     CALL 'kxdfhei1' USING DFHEIV0,
  7093           ERCOMP-FILE-ID,
  7094           DFHEIV20,
  7095           DFHEIV99,
  7096           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 139
* EL630.cbl
  7097           DFHEIV99,
  7098           DFHEIV99,
  7099           DFHEIV99
  7100     SET ADDRESS OF COMPENSATION-MASTER TO
  7101         DFHEIV20
  7102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7103
  7104
  7105     MOVE CO-AR-SUMMARY-CODE     TO PI-SUMMARY-CODE.
  7106
  7107     IF REFL GREATER ZEROS
  7108         GO TO 1490-EXIT.
  7109
  7110     IF PI-SAV-REFERENCE GREATER SPACES
  7111         GO TO 1490-EXIT.
  7112
  7113     IF CO-AR-NET-REPORT
  7114        MOVE 'Y'                 TO WS-UPDATE-REFERENCE-SW
  7115        MOVE WS-CURRENT-YMD      TO PI-SAV-REFERENCE
  7116     ELSE
  7117        MOVE SPACES              TO PI-SAV-REFERENCE.
  7118
  7119     GO TO 1490-EXIT.
  7120
  7121 1470-NO-COMP-MSTR.
  7122     MOVE ER-2800                TO EMI-ERROR.
  7123     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7124     MOVE 'Y'                    TO WS-COMP-MASTER-ERROR-SW.
  7125
  7126 1490-EXIT.
  7127     EXIT.
  7128
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 140
* EL630.cbl
  7130
  7131******************************************************************
  7132*                                                                *
  7133*           W R I T E   R E Q U E S T   R E C O R D              *
  7134*                                                                *
  7135******************************************************************
  7136
  7137 1900-WRITE-REQUEST-RECORD.
  7138
  7139* EXEC CICS GETMAIN
  7140*         SET       (ADDRESS OF AR-REQUEST-RECORD)
  7141*         LENGTH    (200)
  7142*         INITIMG   (GETMAIN-SPACE)
  7143*    END-EXEC.
  7144     MOVE 200
  7145       TO DFHEIV11
  7146*    MOVE ',"IL                  $   #00006717' TO DFHEIV0
  7147     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7148     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7149     MOVE X'2020233030303036373137' TO DFHEIV0(25:11)
  7150     CALL 'kxdfhei1' USING DFHEIV0,
  7151           DFHEIV20,
  7152           DFHEIV11,
  7153           GETMAIN-SPACE
  7154     SET ADDRESS OF AR-REQUEST-RECORD TO
  7155         DFHEIV20
  7156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7157
  7158
  7159     MOVE 'RQ'                   TO RQ-RECORD-ID.
  7160
  7161     MOVE PI-SAV-ENTRY-BATCH     TO RQ-ENTRY-BATCH
  7162                                    RQ-BATCH-A1
  7163                                    RQ-BATCH-A2
  7164                                    RQ-BATCH-A3
  7165                                    RQ-BATCH-A4.
  7166
  7167     MOVE PI-SAV-REFERENCE       TO RQ-REFERENCE-A1
  7168                                    RQ-REFERENCE-A2
  7169                                    RQ-REFERENCE-A4.
  7170
  7171     MOVE PI-COMPANY-CD          TO RQ-COMPANY-CD
  7172                                    RQ-COMPANY-CD-A1
  7173                                    RQ-COMPANY-CD-A2
  7174                                    RQ-COMPANY-CD-A3
  7175                                    RQ-COMPANY-CD-A4.
  7176
  7177     MOVE PI-SAV-FC-CARRIER      TO RQ-CARRIER-A1
  7178                                    RQ-CARRIER-A2
  7179                                    RQ-CARRIER-A3
  7180                                    PI-CR-CARRIER.
  7181
  7182     MOVE PI-SAV-FC-GROUPING     TO RQ-GROUPING-A1
  7183                                    RQ-GROUPING-A2
  7184                                    RQ-GROUPING-A3
  7185                                    PI-CR-GROUPING.
  7186
  7187     IF PI-ZERO-CARRIER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 141
* EL630.cbl
  7188        MOVE ZERO                TO RQ-CARRIER-A2
  7189                                    PI-CR-CARRIER.
  7190
  7191     IF PI-ZERO-GROUPING
  7192        MOVE ZEROS               TO RQ-GROUPING-A2
  7193                                    PI-CR-GROUPING.
  7194
  7195     IF PI-ZERO-CAR-GROUP
  7196        MOVE ZEROS               TO RQ-CARRIER-A2
  7197                                    RQ-GROUPING-A2
  7198                                    PI-CR-CARRIER
  7199                                    PI-CR-GROUPING.
  7200
  7201     MOVE PI-SAV-FC-STATE        TO RQ-STATE-A1
  7202                                    PI-CR-STATE.
  7203
  7204     MOVE PI-SAV-ACCOUNT         TO RQ-ACCOUNT-A1
  7205                                    RQ-ACCOUNT-A4
  7206                                    PI-CR-ACCOUNT.
  7207
  7208
  7209     MOVE PI-ACCOUNT-AGENT       TO RQ-ACCT-AGENT-A2
  7210                                    RQ-ACCT-AGENT-A3.
  7211
  7212     MOVE WS-CURRENT-BIN-DT      TO RQ-ENTRY-DT.
  7213
  7214     IF  PI-NB-MONTH-END-DT GREATER SPACES
  7215         MOVE PI-NB-MONTH-END-DT TO RQ-MO-END-DT
  7216     ELSE
  7217         MOVE PI-CR-MONTH-END-DT TO RQ-MO-END-DT.
  7218
  7219     MOVE LOW-VALUES             TO RQ-REQUEST-DT
  7220                                    RQ-STMT-DT
  7221                                    RQ-REVERSAL-DT
  7222                                    RQ-CREDIT-SELECT-DT
  7223                                    RQ-CREDIT-ACCEPT-DT.
  7224
  7225     IF PI-FIN-RESP-ERROR
  7226        MOVE 'E'                 TO RQ-STATUS
  7227        MOVE 'UNKNOWN'           TO RQ-FIN-RESP-A2
  7228                                    PI-CR-FIN-RESP
  7229     ELSE
  7230        MOVE PI-FIN-RESP         TO RQ-FIN-RESP-A2
  7231                                    PI-CR-FIN-RESP.
  7232
  7233     IF PI-ACCT-AGENT-ERROR
  7234        MOVE 'E'                 TO RQ-STATUS
  7235        MOVE 'UNKNOWN'           TO RQ-ACCT-AGENT-A2
  7236                                    RQ-ACCT-AGENT-A3.
  7237
  7238     IF WS-COMP-MASTER-ERROR
  7239        MOVE 'E'                 TO RQ-STATUS
  7240        MOVE 'UNKNOWN'           TO PI-CR-FIN-RESP.
  7241
  7242     MOVE RQ-CONTROL-PRIMARY     TO ERRQST-KEY.
  7243     MOVE LOW-VALUES             TO RQ-STMT-DT
  7244                                    RQ-REQUEST-DT
  7245                                    RQ-REVERSAL-DT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 142
* EL630.cbl
  7246
  7247     MOVE CO-AR-SUMMARY-CODE     TO RQ-SUMMARY-CODE.
  7248
  7249     IF  PI-NB-MONTH-END-DT GREATER SPACES
  7250         MOVE PI-NB-MONTH-END-DT TO PB-CREDIT-SELECT-DT
  7251     ELSE
  7252         MOVE PI-CR-MONTH-END-DT TO PB-CREDIT-SELECT-DT.
  7253
  7254
  7255* EXEC CICS HANDLE CONDITION
  7256*        DUPREC (1990-EXIT)
  7257*    END-EXEC.
  7258*    MOVE '"$%                   ! , #00006818' TO DFHEIV0
  7259     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7260     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7261     MOVE X'2C20233030303036383138' TO DFHEIV0(25:11)
  7262     CALL 'kxdfhei1' USING DFHEIV0
  7263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7264
  7265
  7266
  7267* EXEC CICS WRITE
  7268*         DATASET    (ERRQST-FILE-ID)
  7269*         FROM       (AR-REQUEST-RECORD)
  7270*         RIDFLD     (ERRQST-KEY)
  7271*    END-EXEC.
  7272     MOVE LENGTH OF
  7273      AR-REQUEST-RECORD
  7274       TO DFHEIV11
  7275*    MOVE '&$ L                  ''   #00006822' TO DFHEIV0
  7276     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7277     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7278     MOVE X'2020233030303036383232' TO DFHEIV0(25:11)
  7279     CALL 'kxdfhei1' USING DFHEIV0,
  7280           ERRQST-FILE-ID,
  7281           AR-REQUEST-RECORD,
  7282           DFHEIV11,
  7283           ERRQST-KEY,
  7284           DFHEIV99,
  7285           DFHEIV99
  7286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7287
  7288
  7289 1990-EXIT.
  7290     EXIT.
  7291
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 143
* EL630.cbl
  7293 2000-WRITE-BATCH-TOTAL-REC.
  7294
  7295     MOVE PI-COMPANY-CD          TO PNDB-COMP-CD.
  7296     MOVE PI-SAV-ENTRY-BATCH     TO PNDB-ENTRY-BATCH.
  7297     MOVE 9999                   TO PNDB-BATCH-SEQ.
  7298
  7299
  7300* EXEC CICS HANDLE CONDITION
  7301*        NOTFND (2100-ADD-BATCH-TOTAL-REC)
  7302*    END-EXEC.
  7303*    MOVE '"$I                   ! - #00006838' TO DFHEIV0
  7304     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7306     MOVE X'2D20233030303036383338' TO DFHEIV0(25:11)
  7307     CALL 'kxdfhei1' USING DFHEIV0
  7308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7309
  7310
  7311
  7312* EXEC CICS READ
  7313*        SET    (ADDRESS OF PENDING-BUSINESS)
  7314*        DATASET(ERPNDB-FILE-ID)
  7315*        RIDFLD (ERPNDB-KEY)
  7316*        UPDATE
  7317*    END-EXEC.
  7318*    MOVE '&"S        EU         (   #00006842' TO DFHEIV0
  7319     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7320     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7321     MOVE X'2020233030303036383432' TO DFHEIV0(25:11)
  7322     CALL 'kxdfhei1' USING DFHEIV0,
  7323           ERPNDB-FILE-ID,
  7324           DFHEIV20,
  7325           DFHEIV99,
  7326           ERPNDB-KEY,
  7327           DFHEIV99,
  7328           DFHEIV99,
  7329           DFHEIV99
  7330     SET ADDRESS OF PENDING-BUSINESS TO
  7331         DFHEIV20
  7332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7333
  7334
  7335******************************************************************
  7336*    IF THE MONTH-END-DATE IN THE TRAILER RECORD (BATCH HEADER)  *
  7337*       IS NOT EQUAL TO THE ACCOUNTS MONTH-END-DATE AND THE      *
  7338*       OPERATOR HAS NOT ENTERED A NEW MONTH-END-DATE USE THE    *
  7339*       MONTH-END-DATE IN TRAILER RECORD FOR ALL DETAIL RECORDS. *
  7340******************************************************************
  7341
  7342     IF  PI-NB-MONTH-END-DT = SPACES
  7343         IF  PB-CREDIT-SELECT-DT = PI-CR-MONTH-END-DT
  7344             NEXT SENTENCE
  7345         ELSE
  7346             MOVE PB-CREDIT-SELECT-DT  TO  PI-NB-MONTH-END-DT.
  7347
  7348     IF PI-AR-PROCESSING
  7349        IF REFL = ZEROS
  7350           IF PB-REFERENCE GREATER SPACES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 144
* EL630.cbl
  7351              MOVE PB-REFERENCE  TO PI-SAV-REFERENCE
  7352           ELSE
  7353              NEXT SENTENCE
  7354        ELSE
  7355           IF PI-SAV-REFERENCE NOT = PB-REFERENCE
  7356              MOVE 'Y'              TO WS-UPDATE-REFERENCE-SW
  7357                                       WS-RECORD-FOUND-SW
  7358              PERFORM 7100-REWRITE-REQUEST-REC THRU 7190-EXIT
  7359              IF RECORD-NOT-FOUND
  7360                  GO TO 8200-SEND-DATAONLY
  7361              ELSE
  7362                  MOVE PI-SAV-REFERENCE TO PB-REFERENCE.
  7363
  7364     IF ELFISSL NOT = ZEROS
  7365         MOVE PI-LF-ISS-REMITTED  TO PB-B-LF-ISS-PRM-REMITTED.
  7366     IF EAHISSL NOT = ZEROS
  7367         MOVE PI-AH-ISS-REMITTED  TO PB-B-AH-ISS-PRM-REMITTED.
  7368     IF EISSCNTL NOT = ZEROS
  7369         MOVE PI-ISS-CNT-REMITTED TO PB-B-ISSUE-CNT-REMITTED.
  7370     IF ECANCNTL NOT = ZEROS
  7371         MOVE PI-CAN-CNT-REMITTED TO PB-B-CANCEL-CNT-REMITTED.
  7372     IF ELFCANL NOT = ZEROS
  7373         MOVE PI-LF-CAN-REMITTED  TO PB-B-LF-CAN-PRM-REMITTED.
  7374     IF EAHCANL NOT = ZEROS
  7375         MOVE PI-AH-CAN-REMITTED  TO PB-B-AH-CAN-PRM-REMITTED.
  7376
  7377     IF WS-PF1
  7378         MOVE PI-LF-ISS-ENTERED   TO PB-B-LF-ISS-PRM-ENTERED
  7379         MOVE PI-AH-ISS-ENTERED   TO PB-B-AH-ISS-PRM-ENTERED
  7380         MOVE PI-ISS-CNT-ENTERED  TO PB-B-ISSUE-CNT-ENTERED
  7381         MOVE PI-CAN-CNT-ENTERED  TO PB-B-CANCEL-CNT-ENTERED
  7382         MOVE PI-LF-CAN-ENTERED   TO PB-B-LF-CAN-PRM-ENTERED
  7383         MOVE PI-AH-CAN-ENTERED   TO PB-B-AH-CAN-PRM-ENTERED
  7384         MOVE PI-LAST-SEQ-NO-ADDED TO PB-B-HIGHEST-SEQ-NO.
  7385
  7386     MOVE PI-RECEIVED-DT         TO PB-B-RECEIVED-DT.
  7387
  7388     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  7389     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  7390     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
  7391
  7392     IF PI-AR-PROCESSING
  7393        IF PI-DATA-UPDATED
  7394           PERFORM 1400-VERIFY-COMP-MASTER   THRU 1490-EXIT
  7395           PERFORM 1900-WRITE-REQUEST-RECORD THRU 1990-EXIT
  7396           IF PI-MAINT-FUNC NOT = 'K'
  7397              MOVE PI-SAV-REFERENCE TO PB-REFERENCE.
  7398
  7399
  7400* EXEC CICS REWRITE
  7401*        DATASET(ERPNDB-FILE-ID)
  7402*        FROM   (PENDING-BUSINESS)
  7403*    END-EXEC.
  7404     MOVE LENGTH OF
  7405      PENDING-BUSINESS
  7406       TO DFHEIV11
  7407*    MOVE '&& L                  %   #00006913' TO DFHEIV0
  7408     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 145
* EL630.cbl
  7409     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7410     MOVE X'2020233030303036393133' TO DFHEIV0(25:11)
  7411     CALL 'kxdfhei1' USING DFHEIV0,
  7412           ERPNDB-FILE-ID,
  7413           PENDING-BUSINESS,
  7414           DFHEIV11,
  7415           DFHEIV99
  7416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7417
  7418
  7419     IF  PI-AR-PROCESSING
  7420         IF WS-UPDATE-REFERENCE
  7421            PERFORM 5000-UPDATE-ENTIRE-BATCH THRU 5900-EXIT
  7422            GO TO 2990-EXIT.
  7423
  7424     IF PI-NB-MONTH-END-DT = PB-CREDIT-SELECT-DT
  7425        GO TO 2990-EXIT.
  7426
  7427     IF PI-NB-MONTH-END-DT GREATER SPACES
  7428         PERFORM 5000-UPDATE-ENTIRE-BATCH THRU 5900-EXIT
  7429             IF PI-AR-PROCESSING
  7430                 MOVE 'Y'          TO WS-RECORD-FOUND-SW
  7431                 PERFORM 7200-REWRITE-REQUEST THRU 7299-EXIT
  7432                 IF RECORD-NOT-FOUND
  7433                     GO TO 8200-SEND-DATAONLY.
  7434
  7435     GO TO 2990-EXIT.
  7436
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 146
* EL630.cbl
  7438
  7439 2100-ADD-BATCH-TOTAL-REC.
  7440
  7441* EXEC CICS GETMAIN
  7442*        SET    (ADDRESS OF PENDING-BUSINESS)
  7443*        LENGTH (585)
  7444*        INITIMG(GETMAIN-SPACE)
  7445*    END-EXEC.
  7446     MOVE 585
  7447       TO DFHEIV11
  7448*    MOVE ',"IL                  $   #00006939' TO DFHEIV0
  7449     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7450     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7451     MOVE X'2020233030303036393339' TO DFHEIV0(25:11)
  7452     CALL 'kxdfhei1' USING DFHEIV0,
  7453           DFHEIV20,
  7454           DFHEIV11,
  7455           GETMAIN-SPACE
  7456     SET ADDRESS OF PENDING-BUSINESS TO
  7457         DFHEIV20
  7458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7459
  7460
  7461     MOVE 'PB'                   TO PB-RECORD-ID.
  7462     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD
  7463                                    PB-COMPANY-CD-A1.
  7464     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
  7465     MOVE PI-SAV-ENTRY-BATCH     TO PB-ENTRY-BATCH
  7466                                    PB-CERT-NO.
  7467     MOVE 9999                   TO PB-BATCH-SEQ-NO.
  7468     MOVE HIGH-VALUES            TO PB-CERT-EFF-DT.
  7469     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
  7470                                    PB-ALT-CHG-SEQ-NO.
  7471
  7472     IF REFL GREATER THAN +0
  7473        MOVE REFI                TO PB-REFERENCE
  7474                                    PI-SAV-REFERENCE.
  7475
  7476     IF PI-LF-ISS-REMITTED     NOT NUMERIC
  7477        MOVE +0                  TO PI-LF-ISS-REMITTED.
  7478
  7479     IF PI-LF-ISS-ENTERED      NOT NUMERIC
  7480        MOVE +0                  TO PI-LF-ISS-ENTERED.
  7481
  7482     IF PI-AH-ISS-REMITTED     NOT NUMERIC
  7483        MOVE +0                  TO PI-AH-ISS-REMITTED.
  7484
  7485     IF PI-AH-ISS-ENTERED      NOT NUMERIC
  7486        MOVE +0                  TO PI-AH-ISS-ENTERED.
  7487
  7488     IF PI-ISS-CNT-REMITTED    NOT NUMERIC
  7489        MOVE +0                  TO PI-ISS-CNT-REMITTED.
  7490
  7491     IF PI-ISS-CNT-ENTERED     NOT NUMERIC
  7492        MOVE +0                  TO PI-ISS-CNT-ENTERED.
  7493
  7494     IF PI-CAN-CNT-REMITTED    NOT NUMERIC
  7495        MOVE +0                  TO PI-CAN-CNT-REMITTED.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 147
* EL630.cbl
  7496
  7497     IF PI-CAN-CNT-ENTERED     NOT NUMERIC
  7498        MOVE +0                  TO PI-CAN-CNT-ENTERED.
  7499
  7500     IF PI-LF-CAN-REMITTED     NOT NUMERIC
  7501        MOVE +0                  TO PI-LF-CAN-REMITTED.
  7502
  7503     IF PI-LF-CAN-ENTERED      NOT NUMERIC
  7504        MOVE +0                  TO PI-LF-CAN-ENTERED.
  7505
  7506     IF PI-LF-CAN-REMITTED     NOT NUMERIC
  7507        MOVE +0                  TO PI-LF-CAN-REMITTED.
  7508
  7509     IF PI-AH-CAN-REMITTED     NOT NUMERIC
  7510        MOVE +0                  TO PI-AH-CAN-REMITTED.
  7511
  7512     IF PI-AH-CAN-ENTERED      NOT NUMERIC
  7513        MOVE +0                  TO PI-AH-CAN-ENTERED.
  7514
  7515
  7516     MOVE PI-SAV-CARRIER         TO PB-CARRIER.
  7517     MOVE PI-SAV-GROUPING        TO PB-GROUPING.
  7518     MOVE PI-SAV-STATE           TO PB-STATE.
  7519     MOVE PI-SAV-ACCOUNT         TO PB-ACCOUNT.
  7520     MOVE '9'                    TO PB-RECORD-TYPE.
  7521     MOVE PI-LF-ISS-REMITTED     TO PB-B-LF-ISS-PRM-REMITTED.
  7522     MOVE PI-LF-ISS-ENTERED      TO PB-B-LF-ISS-PRM-ENTERED.
  7523     MOVE PI-AH-ISS-REMITTED     TO PB-B-AH-ISS-PRM-REMITTED.
  7524     MOVE PI-AH-ISS-ENTERED      TO PB-B-AH-ISS-PRM-ENTERED.
  7525     MOVE PI-ISS-CNT-REMITTED    TO PB-B-ISSUE-CNT-REMITTED.
  7526     MOVE PI-ISS-CNT-ENTERED     TO PB-B-ISSUE-CNT-ENTERED.
  7527     MOVE PI-CAN-CNT-REMITTED    TO PB-B-CANCEL-CNT-REMITTED.
  7528     MOVE PI-CAN-CNT-ENTERED     TO PB-B-CANCEL-CNT-ENTERED.
  7529     MOVE PI-LF-CAN-REMITTED     TO PB-B-LF-CAN-PRM-REMITTED.
  7530     MOVE PI-LF-CAN-ENTERED      TO PB-B-LF-CAN-PRM-ENTERED.
  7531     MOVE PI-AH-CAN-REMITTED     TO PB-B-AH-CAN-PRM-REMITTED.
  7532     MOVE PI-AH-CAN-ENTERED      TO PB-B-AH-CAN-PRM-ENTERED.
  7533     MOVE ZEROS                  TO PB-B-LF-ISS-PRM-COMPUTED
  7534                                    PB-B-LF-CAN-PRM-COMPUTED
  7535                                    PB-B-AH-ISS-PRM-COMPUTED
  7536                                    PB-B-AH-CAN-PRM-COMPUTED
  7537                                    PB-LF-BILLED-AMTS
  7538                                    PB-AH-BILLED-AMTS
  7539                                    PB-CHG-COUNT
  7540                                    PB-CALC-TOLERANCE.
  7541     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
  7542                                    PB-BILLED-DT
  7543                                    PB-ACCT-EFF-DT
  7544                                    PB-ACCT-EXP-DT.
  7545
  7546     IF  PI-NB-MONTH-END-DT GREATER SPACES
  7547         MOVE PI-NB-MONTH-END-DT TO PB-CREDIT-SELECT-DT
  7548        ELSE
  7549         MOVE PI-CR-MONTH-END-DT TO PB-CREDIT-SELECT-DT.
  7550
  7551     MOVE PI-LAST-SEQ-NO-ADDED   TO PB-B-HIGHEST-SEQ-NO.
  7552
  7553     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 148
* EL630.cbl
  7554                                    PB-INPUT-BY.
  7555     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  7556     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
  7557                                    PB-INPUT-DT.
  7558
  7559     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
  7560
  7561     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
  7562     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
  7563     MOVE PI-CSR-ID              TO PB-CSR-ID.
  7564     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
  7565     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
  7566
  7567     MOVE PI-RECEIVED-DT         TO PB-B-RECEIVED-DT.
  7568
  7569     MOVE PI-AM-NAME             TO  PB-ACCOUNT-NAME.
  7570     MOVE PI-SAV-FC-CARRIER      TO  PB-SV-CARRIER.
  7571     MOVE PI-SAV-FC-GROUPING     TO  PB-SV-GROUPING.
  7572     MOVE PI-SAV-FC-STATE        TO  PB-SV-STATE.
  7573
  7574     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-KEY.
  7575
  7576
  7577* EXEC CICS WRITE
  7578*        DATASET(ERPNDB-FILE-ID)
  7579*        FROM   (PENDING-BUSINESS)
  7580*        RIDFLD (PB-CONTROL-PRIMARY)
  7581*    END-EXEC.
  7582     MOVE LENGTH OF
  7583      PENDING-BUSINESS
  7584       TO DFHEIV11
  7585*    MOVE '&$ L                  ''   #00007060' TO DFHEIV0
  7586     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7587     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7588     MOVE X'2020233030303037303630' TO DFHEIV0(25:11)
  7589     CALL 'kxdfhei1' USING DFHEIV0,
  7590           ERPNDB-FILE-ID,
  7591           PENDING-BUSINESS,
  7592           DFHEIV11,
  7593           PB-CONTROL-PRIMARY,
  7594           DFHEIV99,
  7595           DFHEIV99
  7596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7597
  7598
  7599 2990-EXIT.
  7600     EXIT.
  7601
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 149
* EL630.cbl
  7603 3000-DELETE-ENTERED-BATCH.
  7604     MOVE SPACE          TO PI-NB-MONTH-END-DT
  7605                            PI-SAV-REFERENCE.
  7606
  7607     IF NOT PI-DELETE-IS-OK
  7608         MOVE 'Y'                TO PI-VERIFY-DELETE-SW
  7609         GO TO 3300-FIRST-PF2.
  7610
  7611     MOVE SPACE                  TO PI-ACCT-AGENT-PROCESSED-SW
  7612                                    PI-VERIFY-DELETE-SW.
  7613     MOVE PI-COMPANY-CD          TO PNDB-COMP-CD.
  7614     MOVE PI-SAV-ENTRY-BATCH     TO PNDB-ENTRY-BATCH.
  7615     MOVE 1                      TO PNDB-BATCH-SEQ.
  7616
  7617
  7618* EXEC CICS SYNCPOINT
  7619*    END-EXEC.
  7620*    MOVE '6"                    !   #00007084' TO DFHEIV0
  7621     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7622     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7623     MOVE X'2020233030303037303834' TO DFHEIV0(25:11)
  7624     CALL 'kxdfhei1' USING DFHEIV0
  7625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7626
  7627
  7628
  7629* EXEC CICS HANDLE CONDITION
  7630*        NOTFND(3200-NO-RECORDS)
  7631*    END-EXEC.
  7632*    MOVE '"$I                   ! . #00007087' TO DFHEIV0
  7633     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7634     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7635     MOVE X'2E20233030303037303837' TO DFHEIV0(25:11)
  7636     CALL 'kxdfhei1' USING DFHEIV0
  7637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7638
  7639
  7640
  7641* EXEC CICS STARTBR
  7642*        DATASET(ERPNDB-FILE-ID)
  7643*        RIDFLD(ERPNDB-KEY)
  7644*    END-EXEC.
  7645     MOVE 0
  7646       TO DFHEIV11
  7647*    MOVE '&,         G          &   #00007091' TO DFHEIV0
  7648     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7649     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7650     MOVE X'2020233030303037303931' TO DFHEIV0(25:11)
  7651     CALL 'kxdfhei1' USING DFHEIV0,
  7652           ERPNDB-FILE-ID,
  7653           ERPNDB-KEY,
  7654           DFHEIV99,
  7655           DFHEIV11,
  7656           DFHEIV99
  7657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7658
  7659
  7660 3000-GET-NEXT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 150
* EL630.cbl
  7661
  7662* EXEC CICS HANDLE CONDITION
  7663*        NOTFND(3120-END-ROUTINE)
  7664*    END-EXEC.
  7665*    MOVE '"$I                   ! / #00007097' TO DFHEIV0
  7666     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7667     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7668     MOVE X'2F20233030303037303937' TO DFHEIV0(25:11)
  7669     CALL 'kxdfhei1' USING DFHEIV0
  7670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7671
  7672
  7673     ADD +1                      TO  WS-SYNC-CNTR.
  7674
  7675     IF WS-SYNC-CNTR GREATER +100
  7676         MOVE +0                 TO  WS-SYNC-CNTR
  7677
  7678* EXEC  CICS SYNCPOINT
  7679*        END-EXEC.
  7680*    MOVE '6"                    !   #00007105' TO DFHEIV0
  7681     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7683     MOVE X'2020233030303037313035' TO DFHEIV0(25:11)
  7684     CALL 'kxdfhei1' USING DFHEIV0
  7685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7686
  7687
  7688     IF WS-ON1-SW3 IS EQUAL TO 'Y'
  7689         MOVE 'N'                TO  WS-ON1-SW3
  7690         GO TO 3005-READ-NEXT-RECORD.
  7691
  7692
  7693* EXEC CICS STARTBR
  7694*        DATASET(ERPNDB-FILE-ID)
  7695*        RIDFLD (ERPNDB-KEY)
  7696*    END-EXEC.
  7697     MOVE 0
  7698       TO DFHEIV11
  7699*    MOVE '&,         G          &   #00007112' TO DFHEIV0
  7700     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7701     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7702     MOVE X'2020233030303037313132' TO DFHEIV0(25:11)
  7703     CALL 'kxdfhei1' USING DFHEIV0,
  7704           ERPNDB-FILE-ID,
  7705           ERPNDB-KEY,
  7706           DFHEIV99,
  7707           DFHEIV11,
  7708           DFHEIV99
  7709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7710
  7711
  7712
  7713* EXEC CICS HANDLE CONDITION
  7714*        NOTFND (3100-STOP-BROWSE)
  7715*        ENDFILE(3100-STOP-BROWSE)
  7716*    END-EXEC.
  7717*    MOVE '"$I''                  ! 0 #00007117' TO DFHEIV0
  7718     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 151
* EL630.cbl
  7719     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7720     MOVE X'3020233030303037313137' TO DFHEIV0(25:11)
  7721     CALL 'kxdfhei1' USING DFHEIV0
  7722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7723
  7724
  7725 3005-READ-NEXT-RECORD.
  7726
  7727* EXEC CICS READNEXT
  7728*        SET    (ADDRESS OF PENDING-BUSINESS)
  7729*        DATASET(ERPNDB-FILE-ID)
  7730*        RIDFLD (ERPNDB-KEY)
  7731*    END-EXEC.
  7732     MOVE 0
  7733       TO DFHEIV11
  7734*    MOVE '&.S                   )   #00007123' TO DFHEIV0
  7735     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7736     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7737     MOVE X'2020233030303037313233' TO DFHEIV0(25:11)
  7738     CALL 'kxdfhei1' USING DFHEIV0,
  7739           ERPNDB-FILE-ID,
  7740           DFHEIV20,
  7741           DFHEIV99,
  7742           ERPNDB-KEY,
  7743           DFHEIV99,
  7744           DFHEIV11,
  7745           DFHEIV99,
  7746           DFHEIV99
  7747     SET ADDRESS OF PENDING-BUSINESS TO
  7748         DFHEIV20
  7749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7750
  7751
  7752     IF PB-COMPANY-CD  = PI-SAV-COMP-CD AND
  7753        PB-ENTRY-BATCH = PI-SAV-ENTRY-BATCH
  7754         NEXT SENTENCE
  7755     ELSE
  7756         GO TO 3100-STOP-BROWSE.
  7757
  7758     IF PB-BILLED-DT NOT = LOW-VALUES
  7759
  7760* EXEC CICS SYNCPOINT ROLLBACK
  7761*        END-EXEC
  7762*    MOVE '6"R                   !   #00007136' TO DFHEIV0
  7763     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  7764     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7765     MOVE X'2020233030303037313336' TO DFHEIV0(25:11)
  7766     CALL 'kxdfhei1' USING DFHEIV0
  7767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7768         MOVE ER-2402            TO EMI-ERROR
  7769         MOVE -1                 TO BATCHL
  7770         MOVE AL-UABON           TO BATCHA
  7771         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7772         GO TO 8200-SEND-DATAONLY.
  7773
  7774******************************************************************
  7775*                DELETE PENDING ADDRESS RECORD                   *
  7776******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 152
* EL630.cbl
  7777
  7778     IF PB-I-MAIL-ADDRS-PRESENT
  7779        NEXT SENTENCE
  7780       ELSE
  7781        GO TO 3006-DELETE-CERTIFICATE.
  7782
  7783
  7784* EXEC CICS HANDLE CONDITION
  7785*         NOTOPEN  (3006-DELETE-CERTIFICATE)
  7786*         NOTFND   (3006-DELETE-CERTIFICATE)
  7787*    END-EXEC.
  7788*    MOVE '"$JI                  ! 1 #00007153' TO DFHEIV0
  7789     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7790     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7791     MOVE X'3120233030303037313533' TO DFHEIV0(25:11)
  7792     CALL 'kxdfhei1' USING DFHEIV0
  7793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7794
  7795
  7796
  7797* EXEC CICS READ
  7798*        EQUAL
  7799*        DATASET   (ERPNDM-FILE-ID)
  7800*        SET       (ADDRESS OF PENDING-MAILING-DATA)
  7801*        RIDFLD    (ERPNDB-KEY)
  7802*        UPDATE
  7803*    END-EXEC.
  7804*    MOVE '&"S        EU         (   #00007158' TO DFHEIV0
  7805     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7806     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7807     MOVE X'2020233030303037313538' TO DFHEIV0(25:11)
  7808     CALL 'kxdfhei1' USING DFHEIV0,
  7809           ERPNDM-FILE-ID,
  7810           DFHEIV20,
  7811           DFHEIV99,
  7812           ERPNDB-KEY,
  7813           DFHEIV99,
  7814           DFHEIV99,
  7815           DFHEIV99
  7816     SET ADDRESS OF PENDING-MAILING-DATA TO
  7817         DFHEIV20
  7818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7819
  7820
  7821
  7822* EXEC CICS DELETE
  7823*        DATASET   (ERPNDM-FILE-ID)
  7824*    END-EXEC.
  7825*    MOVE '&(                    &   #00007166' TO DFHEIV0
  7826     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7827     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7828     MOVE X'2020233030303037313636' TO DFHEIV0(25:11)
  7829     CALL 'kxdfhei1' USING DFHEIV0,
  7830           ERPNDM-FILE-ID,
  7831           DFHEIV99,
  7832           DFHEIV99,
  7833           DFHEIV99,
  7834           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 153
* EL630.cbl
  7835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7836
  7837
  7838 3006-DELETE-CERTIFICATE.
  7839     IF PB-BATCH-TRAILER
  7840        GO TO 3020-CONTINUE-DELETE.
  7841
  7842
  7843* EXEC CICS HANDLE CONDITION
  7844*         NOTFND  (3020-CONTINUE-DELETE)
  7845*    END-EXEC.
  7846*    MOVE '"$I                   ! 2 #00007174' TO DFHEIV0
  7847     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7848     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7849     MOVE X'3220233030303037313734' TO DFHEIV0(25:11)
  7850     CALL 'kxdfhei1' USING DFHEIV0
  7851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7852
  7853
  7854     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
  7855     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7856     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7857     MOVE PB-SV-STATE            TO CERT-STATE.
  7858
  7859* EXEC CICS READ
  7860*        SET     (ADDRESS OF CERTIFICATE-MASTER)
  7861*        DATASET (ELCERT-FILE-ID)
  7862*        RIDFLD  (ELCERT-KEY)
  7863*        UPDATE
  7864*    END-EXEC.
  7865*    MOVE '&"S        EU         (   #00007182' TO DFHEIV0
  7866     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7867     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7868     MOVE X'2020233030303037313832' TO DFHEIV0(25:11)
  7869     CALL 'kxdfhei1' USING DFHEIV0,
  7870           ELCERT-FILE-ID,
  7871           DFHEIV20,
  7872           DFHEIV99,
  7873           ELCERT-KEY,
  7874           DFHEIV99,
  7875           DFHEIV99,
  7876           DFHEIV99
  7877     SET ADDRESS OF CERTIFICATE-MASTER TO
  7878         DFHEIV20
  7879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7880
  7881
  7882     IF INSURED-ADDR-PRESENT
  7883        MOVE 'Y'                  TO WS-CERT-ADDRESS-SW
  7884     ELSE
  7885        MOVE ' '                  TO WS-CERT-ADDRESS-SW.
  7886
  7887     IF  CERT-NOTES-ARE-NOT-PRESENT
  7888         MOVE ' '                TO WS-CERT-NOTE-SW
  7889     ELSE
  7890         MOVE 'Y'                TO WS-CERT-NOTE-SW.
  7891
  7892     IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 154
* EL630.cbl
  7893        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  7894           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7895           MOVE ZERO                  TO CM-LF-ITD-CANCEL-AMT
  7896           MOVE LOW-VALUES            TO CM-LF-CANCEL-EXIT-DT
  7897                                         CM-LF-CANCEL-DT
  7898           MOVE SPACE                 TO CM-LF-EXIT-BATCH
  7899        ELSE
  7900           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7901           MOVE PB-CI-LF-CANCEL-AMT   TO CM-LF-ITD-CANCEL-AMT
  7902           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
  7903           MOVE PB-CI-LIVES              TO CM-LIVES.
  7904
  7905     IF PB-CANCELLATION
  7906        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  7907           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL SPACE
  7908               MOVE CM-LF-STATUS-AT-CANCEL
  7909                                        TO CM-LF-CURRENT-STATUS
  7910               MOVE SPACE
  7911                                        TO CM-LF-STATUS-AT-CANCEL
  7912            ELSE
  7913               MOVE PB-CI-LF-POLICY-STATUS
  7914                                        TO CM-LF-CURRENT-STATUS
  7915        ELSE
  7916            MOVE PB-CI-LF-POLICY-STATUS TO CM-LF-CURRENT-STATUS.
  7917
  7918     IF PB-CANCELLATION
  7919        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  7920           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7921           MOVE ZERO                  TO CM-AH-ITD-CANCEL-AMT
  7922           MOVE LOW-VALUES            TO CM-AH-CANCEL-EXIT-DT
  7923                                         CM-AH-CANCEL-DT
  7924           MOVE SPACE                 TO CM-AH-EXIT-BATCH
  7925        ELSE
  7926           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7927           MOVE PB-CI-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT
  7928           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
  7929           MOVE PB-CI-LIVES           TO CM-LIVES.
  7930
  7931     IF PB-CANCELLATION
  7932        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  7933           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL SPACE
  7934               MOVE CM-AH-STATUS-AT-CANCEL
  7935                                        TO CM-AH-CURRENT-STATUS
  7936               MOVE SPACE
  7937                                        TO CM-AH-STATUS-AT-CANCEL
  7938               GO TO 3010-REWRITE-CERT
  7939            ELSE
  7940               MOVE PB-CI-AH-POLICY-STATUS
  7941                                        TO CM-AH-CURRENT-STATUS
  7942               GO TO 3010-REWRITE-CERT
  7943        ELSE
  7944            MOVE PB-CI-AH-POLICY-STATUS TO CM-AH-CURRENT-STATUS
  7945            GO TO 3010-REWRITE-CERT.
  7946
  7947******************************************************************
  7948******************************************************************
  7949******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
  7950******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 155
* EL630.cbl
  7951******************************************************************
  7952******************************************************************
  7953
  7954     IF CERT-ADDED-BATCH AND
  7955        (NOT NO-CLAIM-ATTACHED
  7956         OR
  7957         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
  7958        GO TO 3010-REWRITE-CERT.
  7959
  7960******************************************************************
  7961******************************************************************
  7962
  7963     IF CERT-ADDED-BATCH  AND
  7964        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
  7965        GO TO 3010-REWRITE-CERT.
  7966
  7967     IF NO-CLAIM-ATTACHED
  7968         NEXT SENTENCE
  7969       ELSE
  7970         MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
  7971         MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
  7972         GO TO 3010-REWRITE-CERT.
  7973
  7974
  7975* EXEC CICS DELETE
  7976*            DATASET    (ELCERT-FILE-ID)
  7977*       END-EXEC.
  7978*    MOVE '&(                    &   #00007281' TO DFHEIV0
  7979     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7980     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7981     MOVE X'2020233030303037323831' TO DFHEIV0(25:11)
  7982     CALL 'kxdfhei1' USING DFHEIV0,
  7983           ELCERT-FILE-ID,
  7984           DFHEIV99,
  7985           DFHEIV99,
  7986           DFHEIV99,
  7987           DFHEIV99
  7988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7989
  7990
  7991******************************************************************
  7992*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
  7993******************************************************************
  7994
  7995     IF CERT-NOTES-ARE-PRESENT
  7996        NEXT SENTENCE
  7997     ELSE
  7998        GO TO 3007-DELETE-MAILING-DATA.
  7999
  8000
  8001* EXEC CICS HANDLE CONDITION
  8002*         NOTFND  (3006-DELETE-ERNOTE)
  8003*    END-EXEC.
  8004*    MOVE '"$I                   ! 3 #00007294' TO DFHEIV0
  8005     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8006     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8007     MOVE X'3320233030303037323934' TO DFHEIV0(25:11)
  8008     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 156
* EL630.cbl
  8009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8010
  8011
  8012     MOVE ELCERT-KEY            TO ERCNOT-KEY.
  8013     MOVE '0'                   TO ERCNOT-REC-TYPE.
  8014     MOVE 0                     TO ERCNOT-SEQUENCE.
  8015
  8016 3006-DELETE-ERCNOT-LOOP.
  8017
  8018
  8019* EXEC CICS READ
  8020*        GTEQ
  8021*        DATASET   (ERCNOT-FILE-ID)
  8022*        SET       (ADDRESS OF CERT-NOTE-FILE)
  8023*        RIDFLD    (ERCNOT-KEY)
  8024*    END-EXEC.
  8025*    MOVE '&"S        G          (   #00007304' TO DFHEIV0
  8026     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8027     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8028     MOVE X'2020233030303037333034' TO DFHEIV0(25:11)
  8029     CALL 'kxdfhei1' USING DFHEIV0,
  8030           ERCNOT-FILE-ID,
  8031           DFHEIV20,
  8032           DFHEIV99,
  8033           ERCNOT-KEY,
  8034           DFHEIV99,
  8035           DFHEIV99,
  8036           DFHEIV99
  8037     SET ADDRESS OF CERT-NOTE-FILE TO
  8038         DFHEIV20
  8039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8040
  8041
  8042     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
  8043     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
  8044         GO TO 3006-DELETE-ERNOTE
  8045     END-IF.
  8046
  8047
  8048* EXEC CICS DELETE
  8049*        DATASET   (ERCNOT-FILE-ID)
  8050*        RIDFLD    (ERCNOT-KEY)
  8051*        END-EXEC.
  8052*    MOVE '&(  R                 &   #00007316' TO DFHEIV0
  8053     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8054     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8055     MOVE X'2020233030303037333136' TO DFHEIV0(25:11)
  8056     CALL 'kxdfhei1' USING DFHEIV0,
  8057           ERCNOT-FILE-ID,
  8058           ERCNOT-KEY,
  8059           DFHEIV99,
  8060           DFHEIV99,
  8061           DFHEIV99
  8062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8063
  8064
  8065     GO TO 3006-DELETE-ERCNOT-LOOP.
  8066
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 157
* EL630.cbl
  8067 3006-DELETE-ERNOTE.
  8068
  8069
  8070* EXEC CICS HANDLE CONDITION
  8071*         NOTFND   (3007-DELETE-MAILING-DATA)
  8072*    END-EXEC.
  8073*    MOVE '"$I                   ! 4 #00007325' TO DFHEIV0
  8074     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8075     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8076     MOVE X'3420233030303037333235' TO DFHEIV0(25:11)
  8077     CALL 'kxdfhei1' USING DFHEIV0
  8078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8079
  8080
  8081
  8082* EXEC CICS READ
  8083*        EQUAL
  8084*        DATASET   (ERNOTE-FILE-ID)
  8085*        SET       (ADDRESS OF CERTIFICATE-NOTE)
  8086*        RIDFLD    (ELCERT-KEY)
  8087*        UPDATE
  8088*    END-EXEC.
  8089*    MOVE '&"S        EU         (   #00007329' TO DFHEIV0
  8090     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8091     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8092     MOVE X'2020233030303037333239' TO DFHEIV0(25:11)
  8093     CALL 'kxdfhei1' USING DFHEIV0,
  8094           ERNOTE-FILE-ID,
  8095           DFHEIV20,
  8096           DFHEIV99,
  8097           ELCERT-KEY,
  8098           DFHEIV99,
  8099           DFHEIV99,
  8100           DFHEIV99
  8101     SET ADDRESS OF CERTIFICATE-NOTE TO
  8102         DFHEIV20
  8103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8104
  8105
  8106
  8107* EXEC CICS DELETE
  8108*        DATASET   (ERNOTE-FILE-ID)
  8109*    END-EXEC.
  8110*    MOVE '&(                    &   #00007337' TO DFHEIV0
  8111     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8112     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8113     MOVE X'2020233030303037333337' TO DFHEIV0(25:11)
  8114     CALL 'kxdfhei1' USING DFHEIV0,
  8115           ERNOTE-FILE-ID,
  8116           DFHEIV99,
  8117           DFHEIV99,
  8118           DFHEIV99,
  8119           DFHEIV99
  8120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8121
  8122
  8123******************************************************************
  8124*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 158
* EL630.cbl
  8125******************************************************************
  8126
  8127 3007-DELETE-MAILING-DATA.
  8128     IF CERT-ADDRESS-PRESENT
  8129        NEXT SENTENCE
  8130     ELSE
  8131        GO TO 3020-CONTINUE-DELETE.
  8132
  8133
  8134* EXEC CICS HANDLE CONDITION
  8135*         NOTOPEN  (3020-CONTINUE-DELETE)
  8136*         NOTFND   (3020-CONTINUE-DELETE)
  8137*    END-EXEC.
  8138*    MOVE '"$JI                  ! 5 #00007351' TO DFHEIV0
  8139     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8140     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8141     MOVE X'3520233030303037333531' TO DFHEIV0(25:11)
  8142     CALL 'kxdfhei1' USING DFHEIV0
  8143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8144
  8145
  8146
  8147* EXEC CICS READ
  8148*        EQUAL
  8149*        DATASET   (ERMAIL-FILE-ID)
  8150*        SET       (ADDRESS OF MAILING-DATA)
  8151*        RIDFLD    (ELCERT-KEY)
  8152*        UPDATE
  8153*    END-EXEC.
  8154*    MOVE '&"S        EU         (   #00007356' TO DFHEIV0
  8155     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8156     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8157     MOVE X'2020233030303037333536' TO DFHEIV0(25:11)
  8158     CALL 'kxdfhei1' USING DFHEIV0,
  8159           ERMAIL-FILE-ID,
  8160           DFHEIV20,
  8161           DFHEIV99,
  8162           ELCERT-KEY,
  8163           DFHEIV99,
  8164           DFHEIV99,
  8165           DFHEIV99
  8166     SET ADDRESS OF MAILING-DATA TO
  8167         DFHEIV20
  8168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8169
  8170
  8171
  8172* EXEC CICS DELETE
  8173*        DATASET   (ERMAIL-FILE-ID)
  8174*    END-EXEC.
  8175*    MOVE '&(                    &   #00007364' TO DFHEIV0
  8176     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8177     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8178     MOVE X'2020233030303037333634' TO DFHEIV0(25:11)
  8179     CALL 'kxdfhei1' USING DFHEIV0,
  8180           ERMAIL-FILE-ID,
  8181           DFHEIV99,
  8182           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 159
* EL630.cbl
  8183           DFHEIV99,
  8184           DFHEIV99
  8185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8186
  8187
  8188     GO TO 3020-CONTINUE-DELETE.
  8189
  8190 3010-REWRITE-CERT.
  8191
  8192
  8193* EXEC CICS REWRITE
  8194*        DATASET    (ELCERT-FILE-ID)
  8195*        FROM       (CERTIFICATE-MASTER)
  8196*    END-EXEC.
  8197     MOVE LENGTH OF
  8198      CERTIFICATE-MASTER
  8199       TO DFHEIV11
  8200*    MOVE '&& L                  %   #00007372' TO DFHEIV0
  8201     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8202     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8203     MOVE X'2020233030303037333732' TO DFHEIV0(25:11)
  8204     CALL 'kxdfhei1' USING DFHEIV0,
  8205           ELCERT-FILE-ID,
  8206           CERTIFICATE-MASTER,
  8207           DFHEIV11,
  8208           DFHEIV99
  8209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8210
  8211
  8212 3020-CONTINUE-DELETE.
  8213
  8214
  8215* EXEC CICS ENDBR
  8216*        DATASET(ERPNDB-FILE-ID)
  8217*    END-EXEC.
  8218     MOVE 0
  8219       TO DFHEIV11
  8220*    MOVE '&2                    $   #00007379' TO DFHEIV0
  8221     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8222     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8223     MOVE X'2020233030303037333739' TO DFHEIV0(25:11)
  8224     CALL 'kxdfhei1' USING DFHEIV0,
  8225           ERPNDB-FILE-ID,
  8226           DFHEIV11,
  8227           DFHEIV99
  8228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8229
  8230
  8231
  8232* EXEC CICS DELETE
  8233*        DATASET(ERPNDB-FILE-ID)
  8234*        RIDFLD (ERPNDB-KEY)
  8235*    END-EXEC.
  8236*    MOVE '&(  R                 &   #00007383' TO DFHEIV0
  8237     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8238     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8239     MOVE X'2020233030303037333833' TO DFHEIV0(25:11)
  8240     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 160
* EL630.cbl
  8241           ERPNDB-FILE-ID,
  8242           ERPNDB-KEY,
  8243           DFHEIV99,
  8244           DFHEIV99,
  8245           DFHEIV99
  8246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8247
  8248
  8249     ADD 1   TO WS-DELETE-CNT.
  8250     GO TO 3000-GET-NEXT-RECORD.
  8251
  8252 3100-STOP-BROWSE.
  8253
  8254* EXEC CICS ENDBR
  8255*        DATASET(ERPNDB-FILE-ID)
  8256*    END-EXEC.
  8257     MOVE 0
  8258       TO DFHEIV11
  8259*    MOVE '&2                    $   #00007392' TO DFHEIV0
  8260     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8261     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8262     MOVE X'2020233030303037333932' TO DFHEIV0(25:11)
  8263     CALL 'kxdfhei1' USING DFHEIV0,
  8264           ERPNDB-FILE-ID,
  8265           DFHEIV11,
  8266           DFHEIV99
  8267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8268
  8269
  8270 3120-END-ROUTINE.
  8271     MOVE SPACE                  TO PI-UPDATE-SW.
  8272
  8273     IF WS-DELETE-CNT NOT GREATER ZERO
  8274         GO TO 3200-NO-RECORDS.
  8275
  8276     IF PI-AR-PROCESSING
  8277        MOVE 'Y'                 TO WS-RECORD-FOUND-SW
  8278        PERFORM 7000-VERIFY-REQUEST-REC THRU 7090-EXIT
  8279        IF RECORD-NOT-FOUND
  8280           GO TO 8200-SEND-DATAONLY.
  8281
  8282     IF PI-SAVE-CALLING-PGM NOT = XCTL-6301 and 'VP6301'
  8283         MOVE ZEROS              TO EMI-ERROR
  8284         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8285
  8286     MOVE SPACE                  TO PI-BROWSE-SW.
  8287     MOVE LOW-VALUES             TO EL630AO.
  8288     MOVE QUESTION-MARKS         TO BATCHI.
  8289     MOVE AL-UANON               TO BATCHA.
  8290     MOVE -1                     TO MAINTL.
  8291     GO TO 8100-SEND-INITIAL-MAP.
  8292
  8293 3200-NO-RECORDS.
  8294     MOVE ER-2242                TO EMI-ERROR.
  8295     MOVE -1 TO BATCHL
  8296     MOVE AL-UABON               TO BATCHA.
  8297     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8298     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 161
* EL630.cbl
  8299
  8300 3300-FIRST-PF2.
  8301     MOVE SPACE                  TO PI-CLEAR-ERROR-SW.
  8302     MOVE ER-2422                TO EMI-ERROR.
  8303     MOVE -1                     TO PFENTERL.
  8304     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8305     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 162
* EL630.cbl
  8307
  8308 4000-SHOW-TOTALS.
  8309
  8310     MOVE LOW-VALUES             TO EL630AI.
  8311     MOVE PI-SAV-ENTRY-BATCH     TO BATCHO.
  8312     MOVE PI-SAV-REFERENCE       TO REFO.
  8313
  8314     IF PI-DATA-UPDATED
  8315        MOVE 'C'                TO PI-MAINT-FUNC.
  8316
  8317     MOVE PI-MAINT-FUNC          TO MAINTO.
  8318
  8319     IF PI-SAV-CARRIER NOT = SPACES
  8320         MOVE PI-SAV-CARRIER     TO CARRIERO.
  8321
  8322     IF PI-SAV-GROUPING NOT = SPACES
  8323         MOVE PI-SAV-GROUPING    TO GROUPO.
  8324
  8325     IF PI-SAV-STATE NOT = SPACES
  8326         MOVE PI-SAV-STATE       TO STATEO.
  8327
  8328     MOVE PI-SAV-ACCOUNT         TO ACCOUNTO.
  8329
  8330     IF PI-DATA-UPDATED
  8331         MOVE AL-SANON           TO BATCHA
  8332                                    MAINTA
  8333                                    CARRIERA
  8334                                    GROUPA
  8335                                    STATEA
  8336                                    ACCOUNTA
  8337     ELSE
  8338         MOVE AL-UANON           TO BATCHA
  8339                                    MAINTA
  8340                                    CARRIERA
  8341                                    GROUPA
  8342                                    STATEA
  8343                                    ACCOUNTA.
  8344
  8345     MOVE PI-LF-ISS-ENTERED      TO ALFISSO.
  8346     IF PI-LF-ISS-REMITTED NOT = ZEROS
  8347         MOVE PI-LF-ISS-REMITTED TO ELFISSO
  8348         MOVE AL-UNNON           TO ELFISSA
  8349         COMPUTE WS-OBAL = PI-LF-ISS-REMITTED - PI-LF-ISS-ENTERED
  8350         IF WS-OBAL NOT = ZEROS
  8351             MOVE WS-OBAL        TO OLFISSO.
  8352
  8353     MOVE PI-LF-CAN-ENTERED      TO ALFCANO.
  8354     IF PI-LF-CAN-REMITTED NOT = ZEROS
  8355         MOVE PI-LF-CAN-REMITTED TO ELFCANO
  8356         MOVE AL-UNNON           TO ELFCANA
  8357         COMPUTE WS-OBAL = PI-LF-CAN-REMITTED - PI-LF-CAN-ENTERED
  8358         IF WS-OBAL NOT = ZEROS
  8359             MOVE WS-OBAL        TO OLFCANO.
  8360
  8361     MOVE PI-AH-ISS-ENTERED      TO AAHISSO.
  8362     IF PI-AH-ISS-REMITTED NOT = ZEROS
  8363         MOVE PI-AH-ISS-REMITTED TO EAHISSO
  8364         MOVE AL-UNNON           TO EAHISSA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 163
* EL630.cbl
  8365         COMPUTE WS-OBAL = PI-AH-ISS-REMITTED - PI-AH-ISS-ENTERED
  8366         IF WS-OBAL NOT = ZEROS
  8367             MOVE WS-OBAL        TO OAHISSO.
  8368
  8369     MOVE PI-AH-CAN-ENTERED      TO AAHCANO.
  8370     IF PI-AH-CAN-REMITTED NOT = ZEROS
  8371         MOVE PI-AH-CAN-REMITTED TO EAHCANO
  8372         MOVE AL-UNNON           TO EAHCANA
  8373         COMPUTE WS-OBAL = PI-AH-CAN-REMITTED - PI-AH-CAN-ENTERED
  8374         IF WS-OBAL NOT = ZEROS
  8375             MOVE WS-OBAL        TO OAHCANO.
  8376
  8377     MOVE PI-ISS-CNT-ENTERED     TO AISSCNTO.
  8378     IF PI-ISS-CNT-REMITTED NOT = ZEROS
  8379         MOVE PI-ISS-CNT-REMITTED TO EISSCNTO
  8380         MOVE AL-UNNON            TO EISSCNTA
  8381         COMPUTE WS-OCNT = PI-ISS-CNT-REMITTED -
  8382                                PI-ISS-CNT-ENTERED
  8383         IF WS-OCNT NOT = ZEROS
  8384             MOVE WS-OCNT        TO OISSCNTO.
  8385
  8386     MOVE PI-CAN-CNT-ENTERED     TO ACANCNTO.
  8387     IF PI-CAN-CNT-REMITTED NOT = ZEROS
  8388         MOVE PI-CAN-CNT-REMITTED TO ECANCNTO
  8389         MOVE AL-UNNON            TO ECANCNTA
  8390         COMPUTE WS-OCNT = PI-CAN-CNT-REMITTED -
  8391                                PI-CAN-CNT-ENTERED
  8392         IF WS-OCNT NOT = ZEROS
  8393             MOVE WS-OCNT        TO OCANCNTO.
  8394
  8395     IF  PI-NB-MONTH-END-DT GREATER SPACES
  8396         MOVE PI-NB-MONTH-END-DT TO DC-BIN-DATE-1
  8397       ELSE
  8398         MOVE PI-CR-MONTH-END-DT TO DC-BIN-DATE-1.
  8399
  8400     MOVE  SPACE                 TO  DC-OPTION-CODE.
  8401     PERFORM  9700-DATE-LINK.
  8402
  8403     IF  DATE-CONVERSION-ERROR
  8404         MOVE LOW-VALUES TO MNTHNDTO
  8405         GO TO 0490-EXIT.
  8406
  8407     MOVE DC-GREG-DATE-1-EDIT    TO  MNTHNDTO.
  8408     MOVE AL-UANON               TO  MNTHNDTA.
  8409
  8410     IF  PI-NB-MONTH-END-DT GREATER SPACES
  8411         MOVE PI-NB-MONTH-END-DT TO DC-BIN-DATE-1
  8412       ELSE
  8413         MOVE PI-CR-MONTH-END-DT TO DC-BIN-DATE-1.
  8414
  8415     MOVE  SPACE                 TO  DC-OPTION-CODE.
  8416     PERFORM  9700-DATE-LINK.
  8417
  8418     IF  DATE-CONVERSION-ERROR
  8419         MOVE LOW-VALUES TO MNTHNDTO
  8420     ELSE
  8421         MOVE DC-GREG-DATE-1-EDIT    TO  MNTHNDTO
  8422         MOVE AL-UANON               TO  MNTHNDTA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 164
* EL630.cbl
  8423
  8424     MOVE PI-RECEIVED-DT         TO DC-BIN-DATE-1.
  8425
  8426     MOVE  SPACE                 TO  DC-OPTION-CODE.
  8427     PERFORM  9700-DATE-LINK.
  8428
  8429     IF  DATE-CONVERSION-ERROR
  8430         MOVE LOW-VALUES TO RECEVDTO
  8431     ELSE
  8432         MOVE DC-GREG-DATE-1-EDIT    TO  RECEVDTO
  8433         MOVE AL-UANON               TO  RECEVDTA.
  8434
  8435     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 165
* EL630.cbl
  8437
  8438*****************************************************************
  8439*            U P D A T E   E N T I R E   B A T C H              *
  8440*  THIS SECTION UPDATES AN ENTIRE BATCH WITH A NEW MONTH END    *
  8441*  DATE.                                                        *
  8442*****************************************************************
  8443
  8444 5000-UPDATE-ENTIRE-BATCH.
  8445
  8446     MOVE ZEROS                  TO  PNDB-BATCH-SEQ
  8447                                     PNDB-BATCH-CHG-SEQ.
  8448
  8449
  8450* EXEC CICS HANDLE CONDITION
  8451*        NOTFND(5900-EXIT)
  8452*    END-EXEC.
  8453*    MOVE '"$I                   ! 6 #00007575' TO DFHEIV0
  8454     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8455     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8456     MOVE X'3620233030303037353735' TO DFHEIV0(25:11)
  8457     CALL 'kxdfhei1' USING DFHEIV0
  8458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8459
  8460
  8461
  8462* EXEC CICS STARTBR
  8463*        DATASET(ERPNDB-FILE-ID)
  8464*        RIDFLD (ERPNDB-KEY)
  8465*    END-EXEC.
  8466     MOVE 0
  8467       TO DFHEIV11
  8468*    MOVE '&,         G          &   #00007579' TO DFHEIV0
  8469     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8470     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8471     MOVE X'2020233030303037353739' TO DFHEIV0(25:11)
  8472     CALL 'kxdfhei1' USING DFHEIV0,
  8473           ERPNDB-FILE-ID,
  8474           ERPNDB-KEY,
  8475           DFHEIV99,
  8476           DFHEIV11,
  8477           DFHEIV99
  8478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8479
  8480
  8481 5010-GET-NEXT-RECORD.
  8482
  8483* EXEC CICS HANDLE CONDITION
  8484*        NOTFND (5100-STOP-BROWSE)
  8485*        ENDFILE(5100-STOP-BROWSE)
  8486*    END-EXEC.
  8487*    MOVE '"$I''                  ! 7 #00007585' TO DFHEIV0
  8488     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8489     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8490     MOVE X'3720233030303037353835' TO DFHEIV0(25:11)
  8491     CALL 'kxdfhei1' USING DFHEIV0
  8492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8493
  8494
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 166
* EL630.cbl
  8495 5020-READ-NEXT-RECORD.
  8496
  8497* EXEC CICS READNEXT
  8498*        SET    (ADDRESS OF PENDING-BUSINESS)
  8499*        DATASET(ERPNDB-FILE-ID)
  8500*        RIDFLD (ERPNDB-KEY)
  8501*    END-EXEC.
  8502     MOVE 0
  8503       TO DFHEIV11
  8504*    MOVE '&.S                   )   #00007591' TO DFHEIV0
  8505     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8506     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8507     MOVE X'2020233030303037353931' TO DFHEIV0(25:11)
  8508     CALL 'kxdfhei1' USING DFHEIV0,
  8509           ERPNDB-FILE-ID,
  8510           DFHEIV20,
  8511           DFHEIV99,
  8512           ERPNDB-KEY,
  8513           DFHEIV99,
  8514           DFHEIV11,
  8515           DFHEIV99,
  8516           DFHEIV99
  8517     SET ADDRESS OF PENDING-BUSINESS TO
  8518         DFHEIV20
  8519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8520
  8521
  8522     IF WS-ON1-SW4 IS EQUAL TO 'Y'
  8523         MOVE 'N'                    TO  WS-ON1-SW4
  8524         MOVE PB-CONTROL-PRIMARY     TO  WS-SAV-PNDB-KEY
  8525         GO TO 5030-READ-FOR-UPDATE.
  8526
  8527     IF ERPNDB-KEY = WS-SAV-PNDB-KEY
  8528        GO TO 5020-READ-NEXT-RECORD.
  8529
  8530     IF PB-COMPANY-CD  = WS-SAV-COMP-CD  AND
  8531        PB-ENTRY-BATCH = WS-SAV-ENTRY-BATCH
  8532         NEXT SENTENCE
  8533     ELSE
  8534         GO TO 5100-STOP-BROWSE.
  8535
  8536     IF PB-ISSUE
  8537        IF PB-I-REFERENCE NOT = PI-SAV-REFERENCE
  8538           GO TO 5030-READ-FOR-UPDATE.
  8539
  8540     IF PB-CANCELLATION
  8541        IF PB-C-REFERENCE NOT = PI-SAV-REFERENCE
  8542           GO TO 5030-READ-FOR-UPDATE.
  8543
  8544     IF PB-CREDIT-SELECT-DT = PI-NB-MONTH-END-DT
  8545         GO TO 5010-GET-NEXT-RECORD.
  8546
  8547 5030-READ-FOR-UPDATE.
  8548
  8549* EXEC CICS ENDBR
  8550*        DATASET(ERPNDB-FILE-ID)
  8551*    END-EXEC.
  8552     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 167
* EL630.cbl
  8553       TO DFHEIV11
  8554*    MOVE '&2                    $   #00007623' TO DFHEIV0
  8555     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8556     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8557     MOVE X'2020233030303037363233' TO DFHEIV0(25:11)
  8558     CALL 'kxdfhei1' USING DFHEIV0,
  8559           ERPNDB-FILE-ID,
  8560           DFHEIV11,
  8561           DFHEIV99
  8562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8563
  8564
  8565
  8566* EXEC CICS READ
  8567*        SET     (ADDRESS OF PENDING-BUSINESS)
  8568*        DATASET (ERPNDB-FILE-ID)
  8569*        RIDFLD  (ERPNDB-KEY)
  8570*        UPDATE
  8571*    END-EXEC.
  8572*    MOVE '&"S        EU         (   #00007627' TO DFHEIV0
  8573     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8574     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8575     MOVE X'2020233030303037363237' TO DFHEIV0(25:11)
  8576     CALL 'kxdfhei1' USING DFHEIV0,
  8577           ERPNDB-FILE-ID,
  8578           DFHEIV20,
  8579           DFHEIV99,
  8580           ERPNDB-KEY,
  8581           DFHEIV99,
  8582           DFHEIV99,
  8583           DFHEIV99
  8584     SET ADDRESS OF PENDING-BUSINESS TO
  8585         DFHEIV20
  8586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8587
  8588
  8589     MOVE ERPNDB-KEY                  TO WS-SAV-PNDB-KEY.
  8590
  8591     IF PI-NB-MONTH-END-DT GREATER THAN SPACES
  8592        MOVE  PI-NB-MONTH-END-DT TO PB-CREDIT-SELECT-DT.
  8593
  8594     IF PB-ISSUE
  8595        IF PB-I-REFERENCE NOT = PI-SAV-REFERENCE
  8596           MOVE PI-SAV-REFERENCE TO PB-I-REFERENCE.
  8597
  8598     IF PB-CANCELLATION
  8599        IF PB-C-REFERENCE NOT = PI-SAV-REFERENCE
  8600           MOVE PI-SAV-REFERENCE TO PB-C-REFERENCE.
  8601
  8602 5050-REWRITE-PENDING-BUS.
  8603
  8604* EXEC CICS REWRITE
  8605*         DATASET    (ERPNDB-FILE-ID)
  8606*         FROM       (PENDING-BUSINESS)
  8607*     END-EXEC.
  8608     MOVE LENGTH OF
  8609      PENDING-BUSINESS
  8610       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 168
* EL630.cbl
  8611*    MOVE '&& L                  %   #00007648' TO DFHEIV0
  8612     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8613     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8614     MOVE X'2020233030303037363438' TO DFHEIV0(25:11)
  8615     CALL 'kxdfhei1' USING DFHEIV0,
  8616           ERPNDB-FILE-ID,
  8617           PENDING-BUSINESS,
  8618           DFHEIV11,
  8619           DFHEIV99
  8620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8621
  8622
  8623
  8624* EXEC CICS STARTBR
  8625*        DATASET(ERPNDB-FILE-ID)
  8626*        RIDFLD (ERPNDB-KEY)
  8627*    END-EXEC.
  8628     MOVE 0
  8629       TO DFHEIV11
  8630*    MOVE '&,         G          &   #00007653' TO DFHEIV0
  8631     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8632     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8633     MOVE X'2020233030303037363533' TO DFHEIV0(25:11)
  8634     CALL 'kxdfhei1' USING DFHEIV0,
  8635           ERPNDB-FILE-ID,
  8636           ERPNDB-KEY,
  8637           DFHEIV99,
  8638           DFHEIV11,
  8639           DFHEIV99
  8640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8641
  8642
  8643     GO TO 5010-GET-NEXT-RECORD.
  8644
  8645 5100-STOP-BROWSE.
  8646
  8647* EXEC CICS ENDBR
  8648*        DATASET(ERPNDB-FILE-ID)
  8649*    END-EXEC.
  8650     MOVE 0
  8651       TO DFHEIV11
  8652*    MOVE '&2                    $   #00007661' TO DFHEIV0
  8653     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8654     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8655     MOVE X'2020233030303037363631' TO DFHEIV0(25:11)
  8656     CALL 'kxdfhei1' USING DFHEIV0,
  8657           ERPNDB-FILE-ID,
  8658           DFHEIV11,
  8659           DFHEIV99
  8660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8661
  8662
  8663 5900-EXIT.
  8664      EXIT.
  8665
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 169
* EL630.cbl
  8667
  8668******************************************************************
  8669*          R E W R I T E   E N T I R E   B A T C H              *
  8670*  THIS SECTION REWRITES AN ENTIRE BATCH WITH NEW ACCOUNT INFO. *
  8671*  1.  DELETE THE PENDING BUSINESS RECORD                       *
  8672*  2.  IF THE PENDING RECORD IS AN ISSUE, AND THE CERTIFICATE   *
  8673*      HAS NOT BEEN ADDED TO BATCH OR A CLAIM IS NOT ATTACHED,  *
  8674*      DELETE THE CERTIFICATE,CERTIFICATE NOTES, AND MAILING    *
  8675*      RECORDS                                                  *
  8676*  3.  IF THE PENDING RECORD HAS BEEN ADDED TO BATCH OR A CLAIM *
  8677*      IS ATTACHED MOVE SPACE TO CM-CREDIT-INTERFACE-SW-1 AND   *
  8678*      REWRITE THE CERTIFICATE.                                 *
  8679*  4.  IF THE PENDING RECORD IS CANCELLATION, BACKOUT THE       *
  8680*      CANCELLATION INFORMATION IN THE CERTIFICATE RECORD       *
  8681*      AND REWRITE THE CERTIFICATE.                             *
  8682*  5.  WRITE A NEW PENDING BUSINESS RECORD WITH THE NEW ACCOUNT *
  8683*      INFORMATION.                                             *
  8684*  6.  AFTER EACH DETAIL RECORD IS PROCESSED REWRITE THE BATCH  *
  8685*      RECORD WITH THE NEW ACCOUNT INFORMATION.                 *
  8686*  7.  ONCE THE BATCH IS REWRITTEN FORCE THE OPERATOR TO        *
  8687*      RE-EDITED THE BATCH.                                     *
  8688*  NOTE:  THE PENDING BUSINESS RECORDS ARE DELETED AND ADDED    *
  8689*         TO RESET THE ALTERNATE INDEX.                         *
  8690******************************************************************
  8691 6000-REWRITE-ENTIRE-BATCH.
  8692     IF  NOT EMI-NO-ERRORS
  8693         GO TO 8200-SEND-DATAONLY.
  8694
  8695     PERFORM 0400-PRIME-BATCH-TOTALS  THRU  0490-EXIT.
  8696
  8697     IF  EMI-ERROR = ZEROS
  8698         MOVE 'N'                TO  PI-EL630-FIRST-TIME-SW
  8699       ELSE
  8700         GO TO 8200-SEND-DATAONLY.
  8701
  8702     MOVE PI-SAV-COMP-CD         TO  PNDB-COMP-CD.
  8703     MOVE PI-SAV-ENTRY-BATCH     TO  PNDB-ENTRY-BATCH.
  8704
  8705     MOVE ZEROS                  TO  PNDB-BATCH-SEQ
  8706                                     PNDB-BATCH-CHG-SEQ.
  8707
  8708
  8709* EXEC CICS GETMAIN
  8710*        SET    (ADDRESS OF PENDING-BUSINESS)
  8711*        LENGTH (585)
  8712*        INITIMG(GETMAIN-SPACE)
  8713*    END-EXEC.
  8714     MOVE 585
  8715       TO DFHEIV11
  8716*    MOVE ',"IL                  $   #00007710' TO DFHEIV0
  8717     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8718     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8719     MOVE X'2020233030303037373130' TO DFHEIV0(25:11)
  8720     CALL 'kxdfhei1' USING DFHEIV0,
  8721           DFHEIV20,
  8722           DFHEIV11,
  8723           GETMAIN-SPACE
  8724     SET ADDRESS OF PENDING-BUSINESS TO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 170
* EL630.cbl
  8725         DFHEIV20
  8726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8727
  8728
  8729
  8730* EXEC CICS HANDLE CONDITION
  8731*        NOTFND(6500-NO-RECORDS)
  8732*    END-EXEC.
  8733*    MOVE '"$I                   ! 8 #00007716' TO DFHEIV0
  8734     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8735     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8736     MOVE X'3820233030303037373136' TO DFHEIV0(25:11)
  8737     CALL 'kxdfhei1' USING DFHEIV0
  8738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8739
  8740
  8741 6010-GET-NEXT-RECORD.
  8742     IF WS-ON1-SW5 IS EQUAL TO 'Y'
  8743         MOVE 'N'                TO  WS-ON1-SW5
  8744         GO TO 6015-START-BROWSE.
  8745
  8746
  8747* EXEC CICS HANDLE CONDITION
  8748*        NOTFND (6400-STOP-BROWSE)
  8749*        ENDFILE(6400-STOP-BROWSE)
  8750*    END-EXEC.
  8751*    MOVE '"$I''                  ! 9 #00007725' TO DFHEIV0
  8752     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8754     MOVE X'3920233030303037373235' TO DFHEIV0(25:11)
  8755     CALL 'kxdfhei1' USING DFHEIV0
  8756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8757
  8758
  8759 6015-START-BROWSE.
  8760
  8761* EXEC CICS STARTBR
  8762*        DATASET(ERPNDB-FILE-ID)
  8763*        RIDFLD (ERPNDB-KEY)
  8764*    END-EXEC.
  8765     MOVE 0
  8766       TO DFHEIV11
  8767*    MOVE '&,         G          &   #00007731' TO DFHEIV0
  8768     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8769     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8770     MOVE X'2020233030303037373331' TO DFHEIV0(25:11)
  8771     CALL 'kxdfhei1' USING DFHEIV0,
  8772           ERPNDB-FILE-ID,
  8773           ERPNDB-KEY,
  8774           DFHEIV99,
  8775           DFHEIV11,
  8776           DFHEIV99
  8777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8778
  8779
  8780 6020-READ-NEXT-RECORD.
  8781
  8782* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 171
* EL630.cbl
  8783*        INTO   (PENDING-BUSINESS)
  8784*        DATASET(ERPNDB-FILE-ID)
  8785*        RIDFLD (ERPNDB-KEY)
  8786*    END-EXEC.
  8787     MOVE LENGTH OF
  8788      PENDING-BUSINESS
  8789       TO DFHEIV12
  8790     MOVE 0
  8791       TO DFHEIV11
  8792*    MOVE '&.IL                  )   #00007737' TO DFHEIV0
  8793     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8794     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8795     MOVE X'2020233030303037373337' TO DFHEIV0(25:11)
  8796     CALL 'kxdfhei1' USING DFHEIV0,
  8797           ERPNDB-FILE-ID,
  8798           PENDING-BUSINESS,
  8799           DFHEIV12,
  8800           ERPNDB-KEY,
  8801           DFHEIV99,
  8802           DFHEIV11,
  8803           DFHEIV99,
  8804           DFHEIV99
  8805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8806
  8807
  8808     IF WS-ON1-SW6 IS EQUAL TO 'Y'
  8809         MOVE 'N'                    TO WS-ON1-SW6
  8810         MOVE PB-CONTROL-PRIMARY     TO WS-SAV-PNDB-KEY
  8811         GO TO 6030-READ-FOR-UPDATE.
  8812
  8813     IF ERPNDB-KEY = WS-SAV-PNDB-KEY
  8814         GO TO 6020-READ-NEXT-RECORD.
  8815
  8816     IF PB-COMPANY-CD  = WS-SAV-COMP-CD  AND
  8817        PB-ENTRY-BATCH = WS-SAV-ENTRY-BATCH
  8818         NEXT SENTENCE
  8819     ELSE
  8820         GO TO 6400-STOP-BROWSE.
  8821
  8822 6030-READ-FOR-UPDATE.
  8823
  8824* EXEC CICS ENDBR
  8825*        DATASET(ERPNDB-FILE-ID)
  8826*    END-EXEC.
  8827     MOVE 0
  8828       TO DFHEIV11
  8829*    MOVE '&2                    $   #00007758' TO DFHEIV0
  8830     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8831     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8832     MOVE X'2020233030303037373538' TO DFHEIV0(25:11)
  8833     CALL 'kxdfhei1' USING DFHEIV0,
  8834           ERPNDB-FILE-ID,
  8835           DFHEIV11,
  8836           DFHEIV99
  8837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8838
  8839
  8840
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 172
* EL630.cbl
  8841* EXEC CICS READ
  8842*        INTO (PENDING-BUSINESS)
  8843*        DATASET (ERPNDB-FILE-ID)
  8844*        RIDFLD  (ERPNDB-KEY)
  8845*        UPDATE
  8846*    END-EXEC.
  8847     MOVE LENGTH OF
  8848      PENDING-BUSINESS
  8849       TO DFHEIV11
  8850*    MOVE '&"IL       EU         (   #00007762' TO DFHEIV0
  8851     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8852     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8853     MOVE X'2020233030303037373632' TO DFHEIV0(25:11)
  8854     CALL 'kxdfhei1' USING DFHEIV0,
  8855           ERPNDB-FILE-ID,
  8856           PENDING-BUSINESS,
  8857           DFHEIV11,
  8858           ERPNDB-KEY,
  8859           DFHEIV99,
  8860           DFHEIV99,
  8861           DFHEIV99
  8862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8863
  8864
  8865     MOVE ERPNDB-KEY                  TO WS-SAV-PNDB-KEY.
  8866
  8867     MOVE PENDING-BUSINESS       TO WS-ERPNDB-RECORD.
  8868
  8869 6050-DELETE-PENDING-BUS.
  8870
  8871* EXEC CICS DELETE
  8872*        DATASET    (ERPNDB-FILE-ID)
  8873*    END-EXEC.
  8874*    MOVE '&(                    &   #00007774' TO DFHEIV0
  8875     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8876     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8877     MOVE X'2020233030303037373734' TO DFHEIV0(25:11)
  8878     CALL 'kxdfhei1' USING DFHEIV0,
  8879           ERPNDB-FILE-ID,
  8880           DFHEIV99,
  8881           DFHEIV99,
  8882           DFHEIV99,
  8883           DFHEIV99
  8884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8885
  8886
  8887     MOVE WS-ERPNDB-RECORD       TO PENDING-BUSINESS.
  8888
  8889     IF  PB-BATCH-TRAILER
  8890         GO TO 6300-WRITE-PNDB-RECORD.
  8891
  8892     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
  8893     IF  PB-SV-CARRIER GREATER SPACES
  8894         MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8895     IF  PB-SV-GROUPING GREATER SPACES
  8896         MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8897     IF  PB-SV-STATE GREATER SPACES
  8898         MOVE PB-SV-STATE            TO CERT-STATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 173
* EL630.cbl
  8899
  8900     IF PB-ISSUE
  8901         NEXT SENTENCE
  8902       ELSE
  8903         GO TO 6200-PROCESS-CANCELS.
  8904
  8905
  8906* EXEC CICS HANDLE CONDITION
  8907*         NOTFND  (6300-WRITE-PNDB-RECORD)
  8908*    END-EXEC.
  8909*    MOVE '"$I                   ! : #00007796' TO DFHEIV0
  8910     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8911     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8912     MOVE X'3A20233030303037373936' TO DFHEIV0(25:11)
  8913     CALL 'kxdfhei1' USING DFHEIV0
  8914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8915
  8916
  8917
  8918* EXEC CICS READ
  8919*        SET     (ADDRESS OF CERTIFICATE-MASTER)
  8920*        DATASET (ELCERT-FILE-ID)
  8921*        RIDFLD  (ELCERT-KEY)
  8922*        UPDATE
  8923*    END-EXEC.
  8924*    MOVE '&"S        EU         (   #00007800' TO DFHEIV0
  8925     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8926     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8927     MOVE X'2020233030303037383030' TO DFHEIV0(25:11)
  8928     CALL 'kxdfhei1' USING DFHEIV0,
  8929           ELCERT-FILE-ID,
  8930           DFHEIV20,
  8931           DFHEIV99,
  8932           ELCERT-KEY,
  8933           DFHEIV99,
  8934           DFHEIV99,
  8935           DFHEIV99
  8936     SET ADDRESS OF CERTIFICATE-MASTER TO
  8937         DFHEIV20
  8938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8939
  8940
  8941     IF INSURED-ADDR-PRESENT
  8942        MOVE 'Y'                  TO WS-CERT-ADDRESS-SW
  8943     ELSE
  8944        MOVE ' '                  TO WS-CERT-ADDRESS-SW.
  8945
  8946     IF  CERT-NOTES-ARE-NOT-PRESENT
  8947         MOVE ' '                TO WS-CERT-NOTE-SW
  8948     ELSE
  8949         MOVE 'Y'                TO WS-CERT-NOTE-SW.
  8950
  8951     IF  CERT-ADDED-BATCH
  8952
  8953* EXEC CICS UNLOCK
  8954*             DATASET (ELCERT-FILE-ID)
  8955*        END-EXEC
  8956*    MOVE '&*                    #   #00007818' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 174
* EL630.cbl
  8957     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8958     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8959     MOVE X'2020233030303037383138' TO DFHEIV0(25:11)
  8960     CALL 'kxdfhei1' USING DFHEIV0,
  8961           ELCERT-FILE-ID,
  8962           DFHEIV99
  8963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8964         GO TO 6300-WRITE-PNDB-RECORD.
  8965
  8966     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
  8967         NEXT SENTENCE
  8968        ELSE
  8969         GO TO 6060-DELETE-CERTIFICATE.
  8970
  8971     MOVE SPACE                 TO  CM-CREDIT-INTERFACE-SW-1.
  8972     MOVE '2'                   TO  CM-CLAIM-INTERFACE-SW.
  8973
  8974
  8975* EXEC CICS REWRITE
  8976*         DATASET    (ELCERT-FILE-ID)
  8977*         FROM       (CERTIFICATE-MASTER)
  8978*    END-EXEC.
  8979     MOVE LENGTH OF
  8980      CERTIFICATE-MASTER
  8981       TO DFHEIV11
  8982*    MOVE '&& L                  %   #00007831' TO DFHEIV0
  8983     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8984     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8985     MOVE X'2020233030303037383331' TO DFHEIV0(25:11)
  8986     CALL 'kxdfhei1' USING DFHEIV0,
  8987           ELCERT-FILE-ID,
  8988           CERTIFICATE-MASTER,
  8989           DFHEIV11,
  8990           DFHEIV99
  8991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8992
  8993
  8994     GO TO 6300-WRITE-PNDB-RECORD.
  8995
  8996 6060-DELETE-CERTIFICATE.
  8997
  8998
  8999* EXEC CICS DELETE
  9000*         DATASET    (ELCERT-FILE-ID)
  9001*    END-EXEC.
  9002*    MOVE '&(                    &   #00007840' TO DFHEIV0
  9003     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9004     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9005     MOVE X'2020233030303037383430' TO DFHEIV0(25:11)
  9006     CALL 'kxdfhei1' USING DFHEIV0,
  9007           ELCERT-FILE-ID,
  9008           DFHEIV99,
  9009           DFHEIV99,
  9010           DFHEIV99,
  9011           DFHEIV99
  9012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9013
  9014
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 175
* EL630.cbl
  9015******************************************************************
  9016*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
  9017******************************************************************
  9018
  9019     IF CERT-NOTES-ARE-PRESENT
  9020        NEXT SENTENCE
  9021     ELSE
  9022        GO TO 6070-DELETE-MAILING.
  9023
  9024
  9025* EXEC CICS HANDLE CONDITION
  9026*         NOTFND  (6070-DELETE-MAILING)
  9027*    END-EXEC.
  9028*    MOVE '"$I                   ! ; #00007853' TO DFHEIV0
  9029     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9030     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9031     MOVE X'3B20233030303037383533' TO DFHEIV0(25:11)
  9032     CALL 'kxdfhei1' USING DFHEIV0
  9033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9034
  9035
  9036
  9037* EXEC CICS READ
  9038*        EQUAL
  9039*        DATASET   (ERNOTE-FILE-ID)
  9040*        SET       (ADDRESS OF CERTIFICATE-NOTE)
  9041*        RIDFLD    (ELCERT-KEY)
  9042*        UPDATE
  9043*    END-EXEC.
  9044*    MOVE '&"S        EU         (   #00007857' TO DFHEIV0
  9045     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9046     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9047     MOVE X'2020233030303037383537' TO DFHEIV0(25:11)
  9048     CALL 'kxdfhei1' USING DFHEIV0,
  9049           ERNOTE-FILE-ID,
  9050           DFHEIV20,
  9051           DFHEIV99,
  9052           ELCERT-KEY,
  9053           DFHEIV99,
  9054           DFHEIV99,
  9055           DFHEIV99
  9056     SET ADDRESS OF CERTIFICATE-NOTE TO
  9057         DFHEIV20
  9058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9059
  9060
  9061
  9062* EXEC CICS DELETE
  9063*        DATASET   (ERNOTE-FILE-ID)
  9064*    END-EXEC.
  9065*    MOVE '&(                    &   #00007865' TO DFHEIV0
  9066     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9067     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9068     MOVE X'2020233030303037383635' TO DFHEIV0(25:11)
  9069     CALL 'kxdfhei1' USING DFHEIV0,
  9070           ERNOTE-FILE-ID,
  9071           DFHEIV99,
  9072           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 176
* EL630.cbl
  9073           DFHEIV99,
  9074           DFHEIV99
  9075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9076
  9077
  9078******************************************************************
  9079*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
  9080******************************************************************
  9081
  9082 6070-DELETE-MAILING.
  9083     IF CERT-ADDRESS-PRESENT
  9084        NEXT SENTENCE
  9085     ELSE
  9086        GO TO 6300-WRITE-PNDB-RECORD.
  9087
  9088
  9089* EXEC CICS HANDLE CONDITION
  9090*         NOTOPEN (6300-WRITE-PNDB-RECORD)
  9091*         NOTFND  (6300-WRITE-PNDB-RECORD)
  9092*    END-EXEC.
  9093*    MOVE '"$JI                  ! < #00007879' TO DFHEIV0
  9094     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9096     MOVE X'3C20233030303037383739' TO DFHEIV0(25:11)
  9097     CALL 'kxdfhei1' USING DFHEIV0
  9098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9099
  9100
  9101
  9102* EXEC CICS READ
  9103*        EQUAL
  9104*        DATASET   (ERMAIL-FILE-ID)
  9105*        SET       (ADDRESS OF MAILING-DATA)
  9106*        RIDFLD    (ELCERT-KEY)
  9107*        UPDATE
  9108*    END-EXEC.
  9109*    MOVE '&"S        EU         (   #00007884' TO DFHEIV0
  9110     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9111     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9112     MOVE X'2020233030303037383834' TO DFHEIV0(25:11)
  9113     CALL 'kxdfhei1' USING DFHEIV0,
  9114           ERMAIL-FILE-ID,
  9115           DFHEIV20,
  9116           DFHEIV99,
  9117           ELCERT-KEY,
  9118           DFHEIV99,
  9119           DFHEIV99,
  9120           DFHEIV99
  9121     SET ADDRESS OF MAILING-DATA TO
  9122         DFHEIV20
  9123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9124
  9125
  9126
  9127* EXEC CICS DELETE
  9128*        DATASET   (ERMAIL-FILE-ID)
  9129*    END-EXEC.
  9130*    MOVE '&(                    &   #00007892' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 177
* EL630.cbl
  9131     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9132     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9133     MOVE X'2020233030303037383932' TO DFHEIV0(25:11)
  9134     CALL 'kxdfhei1' USING DFHEIV0,
  9135           ERMAIL-FILE-ID,
  9136           DFHEIV99,
  9137           DFHEIV99,
  9138           DFHEIV99,
  9139           DFHEIV99
  9140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9141
  9142
  9143     GO TO 6300-WRITE-PNDB-RECORD.
  9144
  9145 6200-PROCESS-CANCELS.
  9146
  9147* EXEC CICS HANDLE CONDITION
  9148*         NOTFND  (6300-WRITE-PNDB-RECORD)
  9149*    END-EXEC.
  9150*    MOVE '"$I                   ! = #00007899' TO DFHEIV0
  9151     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9152     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9153     MOVE X'3D20233030303037383939' TO DFHEIV0(25:11)
  9154     CALL 'kxdfhei1' USING DFHEIV0
  9155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9156
  9157
  9158
  9159* EXEC CICS READ
  9160*        SET     (ADDRESS OF CERTIFICATE-MASTER)
  9161*        DATASET (ELCERT-FILE-ID)
  9162*        RIDFLD  (ELCERT-KEY)
  9163*        UPDATE
  9164*    END-EXEC.
  9165*    MOVE '&"S        EU         (   #00007903' TO DFHEIV0
  9166     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9167     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9168     MOVE X'2020233030303037393033' TO DFHEIV0(25:11)
  9169     CALL 'kxdfhei1' USING DFHEIV0,
  9170           ELCERT-FILE-ID,
  9171           DFHEIV20,
  9172           DFHEIV99,
  9173           ELCERT-KEY,
  9174           DFHEIV99,
  9175           DFHEIV99,
  9176           DFHEIV99
  9177     SET ADDRESS OF CERTIFICATE-MASTER TO
  9178         DFHEIV20
  9179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9180
  9181
  9182     IF PB-CANCELLATION
  9183        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  9184           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9185           MOVE ZERO                   TO CM-LF-ITD-CANCEL-AMT
  9186           MOVE LOW-VALUES             TO CM-LF-CANCEL-EXIT-DT
  9187                                          CM-LF-CANCEL-DT
  9188        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 178
* EL630.cbl
  9189           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9190           MOVE PB-CI-LF-CANCEL-AMT    TO CM-LF-ITD-CANCEL-AMT
  9191           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
  9192           MOVE PB-CI-LIVES            TO CM-LIVES.
  9193
  9194     IF PB-CANCELLATION
  9195        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  9196           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL SPACE
  9197               MOVE CM-LF-STATUS-AT-CANCEL
  9198                                        TO CM-LF-CURRENT-STATUS
  9199               MOVE SPACE
  9200                                        TO CM-LF-STATUS-AT-CANCEL
  9201            ELSE
  9202               MOVE PB-CI-LF-POLICY-STATUS
  9203                                        TO CM-LF-CURRENT-STATUS
  9204        ELSE
  9205            MOVE PB-CI-LF-POLICY-STATUS TO CM-LF-CURRENT-STATUS.
  9206
  9207     IF PB-CANCELLATION
  9208        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  9209           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9210           MOVE ZERO                   TO CM-AH-ITD-CANCEL-AMT
  9211           MOVE LOW-VALUES             TO CM-AH-CANCEL-EXIT-DT
  9212                                          CM-AH-CANCEL-DT
  9213        ELSE
  9214           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9215           MOVE PB-CI-AH-CANCEL-AMT    TO CM-AH-ITD-CANCEL-AMT
  9216           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
  9217           MOVE PB-CI-LIVES            TO CM-LIVES.
  9218
  9219     IF PB-CANCELLATION
  9220        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  9221           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL SPACE
  9222               MOVE CM-AH-STATUS-AT-CANCEL
  9223                                        TO CM-AH-CURRENT-STATUS
  9224               MOVE SPACE
  9225                                        TO CM-AH-STATUS-AT-CANCEL
  9226            ELSE
  9227               MOVE PB-CI-AH-POLICY-STATUS
  9228                                        TO CM-AH-CURRENT-STATUS
  9229        ELSE
  9230            MOVE PB-CI-AH-POLICY-STATUS TO CM-AH-CURRENT-STATUS.
  9231
  9232 6255-REWRITE-CERT.
  9233
  9234
  9235* EXEC CICS REWRITE
  9236*        DATASET    (ELCERT-FILE-ID)
  9237*        FROM       (CERTIFICATE-MASTER)
  9238*    END-EXEC.
  9239     MOVE LENGTH OF
  9240      CERTIFICATE-MASTER
  9241       TO DFHEIV11
  9242*    MOVE '&& L                  %   #00007962' TO DFHEIV0
  9243     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9244     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9245     MOVE X'2020233030303037393632' TO DFHEIV0(25:11)
  9246     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 179
* EL630.cbl
  9247           ELCERT-FILE-ID,
  9248           CERTIFICATE-MASTER,
  9249           DFHEIV11,
  9250           DFHEIV99
  9251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9252
  9253
  9254 6300-WRITE-PNDB-RECORD.
  9255
  9256     MOVE 'X'                    TO  PB-FATAL-FLAG.
  9257
  9258     MOVE SPACES                 TO  PB-I-RATE-DEVIATION-LF
  9259                                     PB-I-RATE-DEVIATION-AH
  9260                                     PB-REIN-CD
  9261                                     PB-SV-CARRIER
  9262                                     PB-SV-GROUPING
  9263                                     PB-SV-STATE.
  9264
  9265     IF PB-BATCH-TRAILER
  9266         MOVE PI-AM-NAME         TO  PB-ACCOUNT-NAME
  9267         MOVE PI-SAV-FC-CARRIER  TO  PB-SV-CARRIER
  9268         MOVE PI-SAV-FC-GROUPING TO  PB-SV-GROUPING
  9269         MOVE PI-SAV-FC-STATE    TO  PB-SV-STATE.
  9270
  9271     MOVE LOW-VALUES             TO  PB-ACCT-EFF-DT
  9272                                     PB-ACCT-EXP-DT.
  9273
  9274     MOVE ZEROS                  TO  PB-CALC-TOLERANCE.
  9275
  9276     IF  CARRIERL GREATER ZEROS
  9277         MOVE CARRIERI           TO PB-CARRIER
  9278        ELSE
  9279         MOVE SPACES             TO PB-CARRIER.
  9280
  9281     IF  GROUPL   GREATER ZEROS
  9282         MOVE GROUPI             TO PB-GROUPING
  9283        ELSE
  9284         MOVE SPACES             TO PB-GROUPING.
  9285
  9286     IF  STATEL   GREATER ZEROS
  9287         MOVE STATEI             TO PB-STATE
  9288        ELSE
  9289         MOVE SPACES             TO PB-STATE.
  9290
  9291     IF  ACCOUNTL GREATER ZEROS
  9292         MOVE ACCOUNTI           TO PB-ACCOUNT
  9293        ELSE
  9294         MOVE SPACES             TO PB-ACCOUNT.
  9295
  9296     IF WS-ON1-SW7 IS EQUAL TO 'Y'
  9297         MOVE 'N'                TO WS-ON1-SW7
  9298         MOVE PB-GROUPING        TO PI-SAV-GROUPING
  9299         MOVE PB-STATE           TO PI-SAV-STATE
  9300         MOVE PB-ACCOUNT         TO PI-SAV-ACCOUNT.
  9301
  9302
  9303* EXEC CICS WRITE
  9304*        DATASET(ERPNDB-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 180
* EL630.cbl
  9305*        FROM   (PENDING-BUSINESS)
  9306*        RIDFLD (PB-CONTROL-PRIMARY)
  9307*    END-EXEC.
  9308     MOVE LENGTH OF
  9309      PENDING-BUSINESS
  9310       TO DFHEIV11
  9311*    MOVE '&$ L                  ''   #00008015' TO DFHEIV0
  9312     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9313     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9314     MOVE X'2020233030303038303135' TO DFHEIV0(25:11)
  9315     CALL 'kxdfhei1' USING DFHEIV0,
  9316           ERPNDB-FILE-ID,
  9317           PENDING-BUSINESS,
  9318           DFHEIV11,
  9319           PB-CONTROL-PRIMARY,
  9320           DFHEIV99,
  9321           DFHEIV99
  9322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9323
  9324
  9325     GO TO 6010-GET-NEXT-RECORD.
  9326
  9327 6400-STOP-BROWSE.
  9328
  9329* EXEC CICS ENDBR
  9330*        DATASET(ERPNDB-FILE-ID)
  9331*    END-EXEC.
  9332     MOVE 0
  9333       TO DFHEIV11
  9334*    MOVE '&2                    $   #00008024' TO DFHEIV0
  9335     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9336     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9337     MOVE X'2020233030303038303234' TO DFHEIV0(25:11)
  9338     CALL 'kxdfhei1' USING DFHEIV0,
  9339           ERPNDB-FILE-ID,
  9340           DFHEIV11,
  9341           DFHEIV99
  9342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9343
  9344
  9345     MOVE 'Y'                    TO  PI-UPDATE-SW.
  9346
  9347     IF PI-AR-PROCESSING
  9348        PERFORM 6600-REWRITE-REQUEST THRU 6690-EXIT.
  9349
  9350     MOVE ER-2990                TO EMI-ERROR.
  9351     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9352     MOVE -1                     TO MAINTL.
  9353     MOVE AL-SANON               TO MAINTA.
  9354     MOVE PI-SAV-REFERENCE       TO REFO.
  9355     GO TO 8200-SEND-DATAONLY.
  9356
  9357 6500-NO-RECORDS.
  9358     MOVE ER-2242                TO EMI-ERROR.
  9359     MOVE -1                     TO BATCHL.
  9360     MOVE AL-UABON               TO BATCHA.
  9361     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9362     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 181
* EL630.cbl
  9363
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 182
* EL630.cbl
  9365
  9366******************************************************************
  9367*                                                                *
  9368*          R E W R I T E   R E Q U E S T   R E C O R D           *
  9369*                                                                *
  9370******************************************************************
  9371
  9372 6600-REWRITE-REQUEST.
  9373
  9374
  9375* EXEC CICS HANDLE CONDITION
  9376*        NOTFND (6690-EXIT)
  9377*    END-EXEC.
  9378*    MOVE '"$I                   ! > #00008057' TO DFHEIV0
  9379     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9380     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9381     MOVE X'3E20233030303038303537' TO DFHEIV0(25:11)
  9382     CALL 'kxdfhei1' USING DFHEIV0
  9383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9384
  9385
  9386     MOVE PI-COMPANY-CD          TO  ERRQST-COMP-CD.
  9387     MOVE PI-SAV-ENTRY-BATCH     TO  ERRQST-ENTRY-BATCH.
  9388
  9389
  9390* EXEC CICS READ
  9391*         DATASET    (ERRQST-FILE-ID)
  9392*         SET        (ADDRESS OF AR-REQUEST-RECORD)
  9393*         RIDFLD     (ERRQST-KEY)
  9394*         UPDATE
  9395*    END-EXEC.
  9396*    MOVE '&"S        EU         (   #00008064' TO DFHEIV0
  9397     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9398     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9399     MOVE X'2020233030303038303634' TO DFHEIV0(25:11)
  9400     CALL 'kxdfhei1' USING DFHEIV0,
  9401           ERRQST-FILE-ID,
  9402           DFHEIV20,
  9403           DFHEIV99,
  9404           ERRQST-KEY,
  9405           DFHEIV99,
  9406           DFHEIV99,
  9407           DFHEIV99
  9408     SET ADDRESS OF AR-REQUEST-RECORD TO
  9409         DFHEIV20
  9410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9411
  9412
  9413     IF  CARRIERL GREATER ZEROS
  9414         MOVE CARRIERI           TO RQ-CARRIER-A1
  9415                                    RQ-CARRIER-A2
  9416                                    RQ-CARRIER-A2.
  9417
  9418     IF  GROUPL   GREATER ZEROS
  9419         MOVE GROUPI             TO RQ-GROUPING-A1
  9420                                    RQ-GROUPING-A2
  9421                                    RQ-GROUPING-A3.
  9422
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 183
* EL630.cbl
  9423     IF  STATEL   GREATER ZEROS
  9424         MOVE STATEI             TO RQ-STATE-A1.
  9425
  9426     IF  ACCOUNTL GREATER ZEROS
  9427         MOVE ACCOUNTI           TO RQ-ACCOUNT-A1
  9428                                    RQ-ACCOUNT-A4.
  9429
  9430     IF PI-ZERO-CARRIER
  9431        MOVE ZERO                TO RQ-CARRIER-A2.
  9432
  9433     IF PI-ZERO-GROUPING
  9434        MOVE ZEROS               TO RQ-GROUPING-A2.
  9435
  9436     IF PI-ZERO-CAR-GROUP
  9437        MOVE ZEROS               TO RQ-CARRIER-A2
  9438                                    RQ-GROUPING-A2.
  9439
  9440     MOVE PI-REMIT-AGENT (PI-SUB) TO RQ-FIN-RESP-A2
  9441                                     PI-FIN-RESP.
  9442
  9443     MOVE PI-ACCT-AGENT  (PI-SUB) TO RQ-ACCT-AGENT-A2
  9444                                     PI-ACCOUNT-AGENT.
  9445
  9446
  9447* EXEC CICS REWRITE
  9448*         DATASET    (ERRQST-FILE-ID)
  9449*         FROM       (AR-REQUEST-RECORD)
  9450*    END-EXEC.
  9451     MOVE LENGTH OF
  9452      AR-REQUEST-RECORD
  9453       TO DFHEIV11
  9454*    MOVE '&& L                  %   #00008104' TO DFHEIV0
  9455     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9456     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9457     MOVE X'2020233030303038313034' TO DFHEIV0(25:11)
  9458     CALL 'kxdfhei1' USING DFHEIV0,
  9459           ERRQST-FILE-ID,
  9460           AR-REQUEST-RECORD,
  9461           DFHEIV11,
  9462           DFHEIV99
  9463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9464
  9465
  9466 6690-EXIT.
  9467     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 184
* EL630.cbl
  9469
  9470******************************************************************
  9471*                                                                *
  9472*           V E R I F Y   R E Q U E S T   R E C O R D            *
  9473*                                                                *
  9474******************************************************************
  9475
  9476 7000-VERIFY-REQUEST-REC.
  9477
  9478* EXEC CICS HANDLE CONDITION
  9479*        NOTFND(7090-EXIT)
  9480*    END-EXEC.
  9481*    MOVE '"$I                   ! ? #00008120' TO DFHEIV0
  9482     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9484     MOVE X'3F20233030303038313230' TO DFHEIV0(25:11)
  9485     CALL 'kxdfhei1' USING DFHEIV0
  9486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9487
  9488
  9489     MOVE PI-COMPANY-CD          TO ERRQST-COMP-CD.
  9490     MOVE PI-SAV-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
  9491
  9492
  9493* EXEC CICS READ
  9494*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9495*        DATASET(ERRQST-FILE-ID)
  9496*        RIDFLD (ERRQST-KEY)
  9497*    END-EXEC.
  9498*    MOVE '&"S        E          (   #00008127' TO DFHEIV0
  9499     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9500     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9501     MOVE X'2020233030303038313237' TO DFHEIV0(25:11)
  9502     CALL 'kxdfhei1' USING DFHEIV0,
  9503           ERRQST-FILE-ID,
  9504           DFHEIV20,
  9505           DFHEIV99,
  9506           ERRQST-KEY,
  9507           DFHEIV99,
  9508           DFHEIV99,
  9509           DFHEIV99
  9510     SET ADDRESS OF AR-REQUEST-RECORD TO
  9511         DFHEIV20
  9512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9513
  9514
  9515     IF RQ-STMT-DT NOT = LOW-VALUES
  9516        MOVE ER-2126        TO EMI-ERROR
  9517        MOVE -1             TO BATCHL
  9518        MOVE AL-UABON       TO BATCHA
  9519        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  9520        MOVE 'N'            TO WS-RECORD-FOUND-SW
  9521        GO TO 7090-EXIT.
  9522
  9523******************************************************************
  9524*                                                                *
  9525*   IF THE BATCH IS BEING DELETED (PF2), DELETE REQUEST RECORD.  *
  9526*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 185
* EL630.cbl
  9527******************************************************************
  9528
  9529     IF EIBAID = DFHPF2
  9530        NEXT SENTENCE
  9531     ELSE
  9532        GO TO 7090-EXIT.
  9533
  9534
  9535* EXEC CICS READ
  9536*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9537*        DATASET(ERRQST-FILE-ID)
  9538*        RIDFLD (ERRQST-KEY)
  9539*        UPDATE
  9540*    END-EXEC.
  9541*    MOVE '&"S        EU         (   #00008152' TO DFHEIV0
  9542     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9543     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9544     MOVE X'2020233030303038313532' TO DFHEIV0(25:11)
  9545     CALL 'kxdfhei1' USING DFHEIV0,
  9546           ERRQST-FILE-ID,
  9547           DFHEIV20,
  9548           DFHEIV99,
  9549           ERRQST-KEY,
  9550           DFHEIV99,
  9551           DFHEIV99,
  9552           DFHEIV99
  9553     SET ADDRESS OF AR-REQUEST-RECORD TO
  9554         DFHEIV20
  9555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9556
  9557
  9558
  9559* EXEC CICS DELETE
  9560*        DATASET(ERRQST-FILE-ID)
  9561*    END-EXEC.
  9562*    MOVE '&(                    &   #00008159' TO DFHEIV0
  9563     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9564     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9565     MOVE X'2020233030303038313539' TO DFHEIV0(25:11)
  9566     CALL 'kxdfhei1' USING DFHEIV0,
  9567           ERRQST-FILE-ID,
  9568           DFHEIV99,
  9569           DFHEIV99,
  9570           DFHEIV99,
  9571           DFHEIV99
  9572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9573
  9574
  9575 7090-EXIT.
  9576      EXIT.
  9577
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 186
* EL630.cbl
  9579
  9580 7100-REWRITE-REQUEST-REC.
  9581
  9582
  9583* EXEC CICS HANDLE CONDITION
  9584*        NOTFND(7180-NO-REQUEST-REC)
  9585*    END-EXEC.
  9586*    MOVE '"$I                   ! @ #00008170' TO DFHEIV0
  9587     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9589     MOVE X'4020233030303038313730' TO DFHEIV0(25:11)
  9590     CALL 'kxdfhei1' USING DFHEIV0
  9591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9592
  9593
  9594
  9595     MOVE PI-COMPANY-CD          TO ERRQST-COMP-CD.
  9596     MOVE PI-SAV-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
  9597
  9598
  9599* EXEC CICS READ
  9600*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9601*        DATASET(ERRQST-FILE-ID)
  9602*        RIDFLD (ERRQST-KEY)
  9603*        UPDATE
  9604*    END-EXEC.
  9605*    MOVE '&"S        EU         (   #00008178' TO DFHEIV0
  9606     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9607     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9608     MOVE X'2020233030303038313738' TO DFHEIV0(25:11)
  9609     CALL 'kxdfhei1' USING DFHEIV0,
  9610           ERRQST-FILE-ID,
  9611           DFHEIV20,
  9612           DFHEIV99,
  9613           ERRQST-KEY,
  9614           DFHEIV99,
  9615           DFHEIV99,
  9616           DFHEIV99
  9617     SET ADDRESS OF AR-REQUEST-RECORD TO
  9618         DFHEIV20
  9619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9620
  9621
  9622     IF RQ-STMT-DT NOT = LOW-VALUES
  9623        MOVE ER-2126        TO EMI-ERROR
  9624        MOVE -1             TO BATCHL
  9625        MOVE AL-UABON       TO BATCHA
  9626        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  9627        MOVE 'N'            TO WS-RECORD-FOUND-SW
  9628        GO TO 7190-EXIT.
  9629
  9630     MOVE PI-SAV-REFERENCE  TO RQ-REFERENCE-A1
  9631                               RQ-REFERENCE-A2
  9632                               RQ-REFERENCE-A4.
  9633
  9634
  9635* EXEC CICS REWRITE
  9636*        DATASET(ERRQST-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 187
* EL630.cbl
  9637*        FROM   (AR-REQUEST-RECORD)
  9638*    END-EXEC.
  9639     MOVE LENGTH OF
  9640      AR-REQUEST-RECORD
  9641       TO DFHEIV11
  9642*    MOVE '&& L                  %   #00008197' TO DFHEIV0
  9643     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9644     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9645     MOVE X'2020233030303038313937' TO DFHEIV0(25:11)
  9646     CALL 'kxdfhei1' USING DFHEIV0,
  9647           ERRQST-FILE-ID,
  9648           AR-REQUEST-RECORD,
  9649           DFHEIV11,
  9650           DFHEIV99
  9651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9652
  9653
  9654     GO TO 7190-EXIT.
  9655
  9656 7180-NO-REQUEST-REC.
  9657     MOVE ER-2132        TO EMI-ERROR.
  9658     MOVE -1             TO BATCHL.
  9659     MOVE AL-UABON       TO BATCHA.
  9660     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9661     MOVE 'N'            TO WS-RECORD-FOUND-SW.
  9662     GO TO 7190-EXIT.
  9663
  9664 7190-EXIT.
  9665     EXIT.
  9666
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 188
* EL630.cbl
  9668
  9669******************************************************************
  9670*
  9671*     7200-REWRITE IS USED TO REWRITE THE REQUEST FILE WHEN
  9672*     THE EOM DATE IS CHANGED.
  9673*
  9674******************************************************************
  9675
  9676 7200-REWRITE-REQUEST.
  9677
  9678* EXEC CICS HANDLE CONDITION
  9679*        NOTFND(7280-NO-REQUEST-REC)
  9680*    END-EXEC.
  9681*    MOVE '"$I                   ! A #00008225' TO DFHEIV0
  9682     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9683     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9684     MOVE X'4120233030303038323235' TO DFHEIV0(25:11)
  9685     CALL 'kxdfhei1' USING DFHEIV0
  9686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9687
  9688
  9689     MOVE PI-COMPANY-CD          TO ERRQST-COMP-CD.
  9690     MOVE PI-SAV-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
  9691
  9692
  9693* EXEC CICS READ
  9694*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9695*        DATASET(ERRQST-FILE-ID)
  9696*        RIDFLD (ERRQST-KEY)
  9697*        UPDATE
  9698*    END-EXEC.
  9699*    MOVE '&"S        EU         (   #00008232' TO DFHEIV0
  9700     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9701     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9702     MOVE X'2020233030303038323332' TO DFHEIV0(25:11)
  9703     CALL 'kxdfhei1' USING DFHEIV0,
  9704           ERRQST-FILE-ID,
  9705           DFHEIV20,
  9706           DFHEIV99,
  9707           ERRQST-KEY,
  9708           DFHEIV99,
  9709           DFHEIV99,
  9710           DFHEIV99
  9711     SET ADDRESS OF AR-REQUEST-RECORD TO
  9712         DFHEIV20
  9713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9714
  9715
  9716     IF RQ-STMT-DT NOT = LOW-VALUES
  9717        MOVE ER-2126        TO EMI-ERROR
  9718        MOVE -1             TO BATCHL
  9719        MOVE AL-UABON       TO BATCHA
  9720        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9721        MOVE 'N'            TO WS-RECORD-FOUND-SW
  9722        GO TO 7299-EXIT.
  9723
  9724
  9725     IF PI-NB-MONTH-END-DT NOT = RQ-MO-END-DT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 189
* EL630.cbl
  9726        MOVE PI-NB-MONTH-END-DT  TO  RQ-MO-END-DT.
  9727
  9728     IF PI-SAV-REFERENCE NOT = RQ-REFERENCE-A1
  9729        MOVE PI-SAV-REFERENCE    TO RQ-REFERENCE-A1
  9730                                    RQ-REFERENCE-A2
  9731                                    RQ-REFERENCE-A4.
  9732
  9733
  9734* EXEC CICS REWRITE
  9735*        DATASET(ERRQST-FILE-ID)
  9736*        FROM   (AR-REQUEST-RECORD)
  9737*    END-EXEC.
  9738     MOVE LENGTH OF
  9739      AR-REQUEST-RECORD
  9740       TO DFHEIV11
  9741*    MOVE '&& L                  %   #00008256' TO DFHEIV0
  9742     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9743     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9744     MOVE X'2020233030303038323536' TO DFHEIV0(25:11)
  9745     CALL 'kxdfhei1' USING DFHEIV0,
  9746           ERRQST-FILE-ID,
  9747           AR-REQUEST-RECORD,
  9748           DFHEIV11,
  9749           DFHEIV99
  9750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9751
  9752
  9753     GO TO 7299-EXIT.
  9754
  9755 7280-NO-REQUEST-REC.
  9756     MOVE ER-2132        TO EMI-ERROR.
  9757     MOVE -1             TO BATCHL.
  9758     MOVE AL-UABON       TO BATCHA.
  9759     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9760     MOVE 'N'            TO WS-RECORD-FOUND-SW.
  9761
  9762 7299-EXIT.
  9763     EXIT.
  9764
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 190
* EL630.cbl
  9766
  9767 8100-SEND-INITIAL-MAP.
  9768     MOVE WS-CURRENT-DT          TO DATEO.
  9769     MOVE EIBTIME                TO TIME-IN.
  9770     MOVE TIME-OUT               TO TIMEO.
  9771     MOVE -1                     TO MAINTL.
  9772     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  9773     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  9774
  9775     MOVE PI-LIFE-OVERRIDE-L2    TO WS-PRM-OVERRIDE
  9776                                    WS-REFUND-OVERRIDE.
  9777     MOVE WS-PRM-HEADER          TO LFPHDGO.
  9778     MOVE WS-REFUND-HEADER       TO LFRHDGO.
  9779
  9780     MOVE PI-AH-OVERRIDE-L2      TO WS-PRM-OVERRIDE
  9781                                    WS-REFUND-OVERRIDE.
  9782     MOVE WS-PRM-HEADER          TO AHPHDGO.
  9783     MOVE WS-REFUND-HEADER       TO AHRHDGO.
  9784
  9785     IF NOT PI-AR-PROCESSING
  9786        MOVE AL-SADOF            TO REFHDGA
  9787                                    REFA.
  9788
  9789     MOVE AL-SANOF               TO PF5A.
  9790
  9791     IF CARR-GROUP-ST-ACCNT-CNTL
  9792         NEXT SENTENCE
  9793     ELSE
  9794         IF ST-ACCNT-CNTL
  9795             MOVE AL-SADOF       TO CARRHDGA
  9796                                    GRPHDGA
  9797             MOVE AL-SANOF       TO CARRIERA
  9798                                    GROUPA
  9799         ELSE
  9800             IF CARR-ST-ACCNT-CNTL
  9801                 MOVE AL-SADOF   TO GRPHDGA
  9802                 MOVE AL-SANOF   TO GROUPA
  9803             ELSE
  9804                 IF ACCNT-CNTL
  9805                     MOVE AL-SADOF TO CARRHDGA
  9806                                      GRPHDGA
  9807                                      STHDGA
  9808                     MOVE AL-SANOF TO CARRIERA
  9809                                      GROUPA
  9810                                      STATEA
  9811                 ELSE
  9812                     IF CARR-ACCNT-CNTL
  9813                         MOVE AL-SADOF TO GRPHDGA
  9814                                          STHDGA
  9815                         MOVE AL-SANOF TO GROUPA
  9816                                          STATEA.
  9817
  9818* EXEC CICS SEND
  9819*        MAP      (MAP-NAME)
  9820*        MAPSET   (MAPSET-NAME)
  9821*        FROM     (EL630AO)
  9822*        ERASE
  9823*        CURSOR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 191
* EL630.cbl
  9824*    END-EXEC.
  9825     MOVE LENGTH OF
  9826      EL630AO
  9827       TO DFHEIV12
  9828     MOVE -1
  9829       TO DFHEIV11
  9830*    MOVE '8$     CT  E    H L F ,   #00008325' TO DFHEIV0
  9831     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9832     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9833     MOVE X'2020233030303038333235' TO DFHEIV0(25:11)
  9834     CALL 'kxdfhei1' USING DFHEIV0,
  9835           MAP-NAME,
  9836           EL630AO,
  9837           DFHEIV12,
  9838           MAPSET-NAME,
  9839           DFHEIV99,
  9840           DFHEIV99,
  9841           DFHEIV99,
  9842           DFHEIV11,
  9843           DFHEIV99,
  9844           DFHEIV99,
  9845           DFHEIV99
  9846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9847
  9848
  9849     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 192
* EL630.cbl
  9851
  9852 8200-SEND-DATAONLY.
  9853     MOVE WS-CURRENT-DT          TO DATEO.
  9854     MOVE EIBTIME                TO TIME-IN.
  9855     MOVE TIME-OUT               TO TIMEO.
  9856     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  9857     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  9858
  9859* EXEC CICS SEND
  9860*        MAP      (MAP-NAME)
  9861*        MAPSET   (MAPSET-NAME)
  9862*        FROM     (EL630AO)
  9863*        DATAONLY
  9864*        ERASEAUP
  9865*        CURSOR
  9866*    END-EXEC.
  9867     MOVE LENGTH OF
  9868      EL630AO
  9869       TO DFHEIV12
  9870     MOVE -1
  9871       TO DFHEIV11
  9872*    MOVE '8$D    CT  A    H L F ,   #00008342' TO DFHEIV0
  9873     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  9874     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9875     MOVE X'2020233030303038333432' TO DFHEIV0(25:11)
  9876     CALL 'kxdfhei1' USING DFHEIV0,
  9877           MAP-NAME,
  9878           EL630AO,
  9879           DFHEIV12,
  9880           MAPSET-NAME,
  9881           DFHEIV99,
  9882           DFHEIV99,
  9883           DFHEIV99,
  9884           DFHEIV11,
  9885           DFHEIV99,
  9886           DFHEIV99,
  9887           DFHEIV99
  9888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9889
  9890
  9891     GO TO 9100-RETURN-TRAN.
  9892
  9893 8300-SEND-TEXT.
  9894
  9895* EXEC CICS SEND TEXT
  9896*        FROM     (LOGOFF-TEXT)
  9897*        LENGTH   (LOGOFF-LENGTH)
  9898*        ERASE
  9899*        FREEKB
  9900*    END-EXEC.
  9901*    MOVE '8&      T  E F  H   F -   #00008354' TO DFHEIV0
  9902     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9903     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9904     MOVE X'2020233030303038333534' TO DFHEIV0(25:11)
  9905     CALL 'kxdfhei1' USING DFHEIV0,
  9906           LOGOFF-TEXT,
  9907           LOGOFF-LENGTH,
  9908           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 193
* EL630.cbl
  9909           DFHEIV99,
  9910           DFHEIV99,
  9911           DFHEIV99,
  9912           DFHEIV99,
  9913           DFHEIV99,
  9914           DFHEIV99,
  9915           DFHEIV99,
  9916           DFHEIV99,
  9917           DFHEIV99
  9918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9919
  9920
  9921
  9922* EXEC CICS RETURN
  9923*    END-EXEC.
  9924*    MOVE '.(                    ''   #00008361' TO DFHEIV0
  9925     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9926     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9927     MOVE X'2020233030303038333631' TO DFHEIV0(25:11)
  9928     CALL 'kxdfhei1' USING DFHEIV0,
  9929           DFHEIV99,
  9930           DFHEIV99,
  9931           DFHEIV99,
  9932           DFHEIV99,
  9933           DFHEIV99,
  9934           DFHEIV99
  9935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9936
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 194
* EL630.cbl
  9938 8600-DEEDIT.
  9939
  9940* EXEC CICS BIF DEEDIT
  9941*        FIELD (WS-DEEDIT-FIELD)
  9942*        LENGTH(10)
  9943*     END-EXEC.
  9944     MOVE 10
  9945       TO DFHEIV11
  9946*    MOVE '@"L                   #   #00008365' TO DFHEIV0
  9947     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9948     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9949     MOVE X'2020233030303038333635' TO DFHEIV0(25:11)
  9950     CALL 'kxdfhei1' USING DFHEIV0,
  9951           WS-DEEDIT-FIELD,
  9952           DFHEIV11
  9953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9954
  9955
  9956 8600-EXIT.
  9957     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 195
* EL630.cbl
  9959 8800-UNAUTHORIZED-ACCESS.
  9960     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  9961     GO TO 8300-SEND-TEXT.
  9962
  9963 8810-PF23.
  9964     IF NOT PI-DATA-UPDATED
  9965         NEXT SENTENCE
  9966     ELSE
  9967         MOVE -1                 TO PFENTERL
  9968         MOVE ER-2213            TO EMI-ERROR
  9969         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9970         GO TO 4000-SHOW-TOTALS.
  9971
  9972     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  9973     MOVE XCTL-005               TO PGM-NAME.
  9974     GO TO 9300-XCTL.
  9975
  9976 9100-RETURN-TRAN.
  9977     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  9978     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  9979
  9980* EXEC CICS RETURN
  9981*        TRANSID    (TRANS-ID)
  9982*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  9983*        LENGTH     (WS-COMM-LENGTH)
  9984*    END-EXEC.
  9985*    MOVE '.(CT                  ''   #00008393' TO DFHEIV0
  9986     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9987     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9988     MOVE X'2020233030303038333933' TO DFHEIV0(25:11)
  9989     CALL 'kxdfhei1' USING DFHEIV0,
  9990           TRANS-ID,
  9991           PROGRAM-INTERFACE-BLOCK,
  9992           WS-COMM-LENGTH,
  9993           DFHEIV99,
  9994           DFHEIV99,
  9995           DFHEIV99
  9996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9997
  9998
  9999     MOVE ZEROS  TO RETURN-CODE.
 10000
 10001* GOBACK.
 10002     MOVE '9%                    "   ' TO DFHEIV0
 10003     MOVE 'EL630' TO DFHEIV1
 10004     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10005     GOBACK.
 10006
 10007 9200-RETURN-MAIN-MENU.
 10008     IF NOT PI-DATA-UPDATED
 10009         NEXT SENTENCE
 10010     ELSE
 10011         MOVE -1                 TO PFENTERL
 10012         MOVE ER-2213            TO EMI-ERROR
 10013         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10014         GO TO 4000-SHOW-TOTALS.
 10015
 10016     MOVE XCTL-626               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 196
* EL630.cbl
 10017     GO TO 9300-XCTL.
 10018
 10019 9300-XCTL.
 10020
 10021* EXEC CICS XCTL
 10022*        PROGRAM    (PGM-NAME)
 10023*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10024*        LENGTH     (WS-COMM-LENGTH)
 10025*    END-EXEC.
 10026*    MOVE '.$C                   %   #00008415' TO DFHEIV0
 10027     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10028     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10029     MOVE X'2020233030303038343135' TO DFHEIV0(25:11)
 10030     CALL 'kxdfhei1' USING DFHEIV0,
 10031           PGM-NAME,
 10032           PROGRAM-INTERFACE-BLOCK,
 10033           WS-COMM-LENGTH,
 10034           DFHEIV99
 10035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10036
 10037     MOVE ZEROS  TO RETURN-CODE.
 10038
 10039* GOBACK.
 10040     MOVE '9%                    "   ' TO DFHEIV0
 10041     MOVE 'EL630' TO DFHEIV1
 10042     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10043     GOBACK.
 10044
 10045 9400-CLEAR.
 10046     IF NOT PI-DATA-UPDATED
 10047         NEXT SENTENCE
 10048     ELSE
 10049         MOVE 'Y'                TO PI-CLEAR-ERROR-SW
 10050         MOVE -1                 TO PFENTERL
 10051         MOVE ER-2213            TO EMI-ERROR
 10052         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10053         GO TO 4000-SHOW-TOTALS.
 10054
 10055     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 10056     GO TO 9300-XCTL.
 10057
 10058 9500-PF12.
 10059     MOVE XCTL-010               TO PGM-NAME.
 10060     GO TO 9300-XCTL.
 10061
 10062 9600-PGMID-ERROR.
 10063
 10064* EXEC CICS HANDLE CONDITION
 10065*        PGMIDERR    (8300-SEND-TEXT)
 10066*    END-EXEC.
 10067*    MOVE '"$L                   ! B #00008441' TO DFHEIV0
 10068     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10069     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10070     MOVE X'4220233030303038343431' TO DFHEIV0(25:11)
 10071     CALL 'kxdfhei1' USING DFHEIV0
 10072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10073
 10074
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 197
* EL630.cbl
 10075     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10076     MOVE ' '                    TO PI-ENTRY-CD-1.
 10077     MOVE XCTL-005               TO PGM-NAME.
 10078     MOVE PGM-NAME               TO LOGOFF-PGM.
 10079     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 10080     GO TO 9300-XCTL.
 10081
 10082 9700-DATE-LINK.
 10083     MOVE LINK-ELDATCV           TO PGM-NAME.
 10084
 10085* EXEC CICS LINK
 10086*        PROGRAM    (PGM-NAME)
 10087*        COMMAREA   (DATE-CONVERSION-DATA)
 10088*        LENGTH     (DC-COMM-LENGTH)
 10089*    END-EXEC.
 10090*    MOVE '."C                   (   #00008454' TO DFHEIV0
 10091     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10092     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10093     MOVE X'2020233030303038343534' TO DFHEIV0(25:11)
 10094     CALL 'kxdfhei1' USING DFHEIV0,
 10095           PGM-NAME,
 10096           DATE-CONVERSION-DATA,
 10097           DC-COMM-LENGTH,
 10098           DFHEIV99,
 10099           DFHEIV99,
 10100           DFHEIV99,
 10101           DFHEIV99
 10102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10103
 10104
 10105 9900-ERROR-FORMAT.
 10106     IF NOT EMI-ERRORS-COMPLETE
 10107         MOVE LINK-001           TO PGM-NAME
 10108
 10109* EXEC CICS LINK
 10110*            PROGRAM    (PGM-NAME)
 10111*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10112*            LENGTH     (EMI-COMM-LENGTH)
 10113*        END-EXEC.
 10114*    MOVE '."C                   (   #00008463' TO DFHEIV0
 10115     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10116     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10117     MOVE X'2020233030303038343633' TO DFHEIV0(25:11)
 10118     CALL 'kxdfhei1' USING DFHEIV0,
 10119           PGM-NAME,
 10120           ERROR-MESSAGE-INTERFACE-BLOCK,
 10121           EMI-COMM-LENGTH,
 10122           DFHEIV99,
 10123           DFHEIV99,
 10124           DFHEIV99,
 10125           DFHEIV99
 10126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10127
 10128
 10129 9900-EXIT.
 10130     EXIT.
 10131
 10132 9990-ABEND.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 198
* EL630.cbl
 10133     MOVE LINK-004               TO PGM-NAME.
 10134     MOVE DFHEIBLK               TO EMI-LINE1.
 10135
 10136* EXEC CICS LINK
 10137*        PROGRAM   (PGM-NAME)
 10138*        COMMAREA  (EMI-LINE1)
 10139*        LENGTH    (72)
 10140*    END-EXEC.
 10141     MOVE 72
 10142       TO DFHEIV11
 10143*    MOVE '."C                   (   #00008475' TO DFHEIV0
 10144     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10145     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10146     MOVE X'2020233030303038343735' TO DFHEIV0(25:11)
 10147     CALL 'kxdfhei1' USING DFHEIV0,
 10148           PGM-NAME,
 10149           EMI-LINE1,
 10150           DFHEIV11,
 10151           DFHEIV99,
 10152           DFHEIV99,
 10153           DFHEIV99,
 10154           DFHEIV99
 10155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10156
 10157
 10158     MOVE -1                     TO PFENTERL.
 10159     GO TO 8200-SEND-DATAONLY.
 10160
 10161 9995-SECURITY-VIOLATION.
 10162*                            COPY ELCSCTP.
 10163******************************************************************
 10164*                                                                *
 10165*                            ELCSCTP                             *
 10166*                            VMOD=2.001                          *
 10167*                                                                *
 10168*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10169******************************************************************
 10170
 10171
 10172     MOVE EIBDATE          TO SM-JUL-DATE.
 10173     MOVE EIBTRMID         TO SM-TERMID.
 10174     MOVE THIS-PGM         TO SM-PGM.
 10175     MOVE EIBTIME          TO TIME-IN.
 10176     MOVE TIME-OUT         TO SM-TIME.
 10177     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10178
 10179
 10180* EXEC CICS LINK
 10181*         PROGRAM  ('EL003')
 10182*         COMMAREA (SECURITY-MESSAGE)
 10183*         LENGTH   (80)
 10184*    END-EXEC.
 10185     MOVE 'EL003' TO DFHEIV1
 10186     MOVE 80
 10187       TO DFHEIV11
 10188*    MOVE '."C                   (   #00008502' TO DFHEIV0
 10189     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 199
* EL630.cbl
 10191     MOVE X'2020233030303038353032' TO DFHEIV0(25:11)
 10192     CALL 'kxdfhei1' USING DFHEIV0,
 10193           DFHEIV1,
 10194           SECURITY-MESSAGE,
 10195           DFHEIV11,
 10196           DFHEIV99,
 10197           DFHEIV99,
 10198           DFHEIV99,
 10199           DFHEIV99
 10200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10201
 10202
 10203******************************************************************
 10204
 10205
 10206 9995-EXIT.
 10207     EXIT.
 10208
 10209
 10210 9999-DFHBACK SECTION.
 10211     MOVE '9%                    "   ' TO DFHEIV0
 10212     MOVE 'EL630' TO DFHEIV1
 10213     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10214     GOBACK.
 10215 9999-DFHEXIT.
 10216     IF DFHEIGDJ EQUAL 0001
 10217         NEXT SENTENCE
 10218     ELSE IF DFHEIGDJ EQUAL 2
 10219         GO TO 9600-PGMID-ERROR,
 10220               9990-ABEND
 10221         DEPENDING ON DFHEIGDI
 10222     ELSE IF DFHEIGDJ EQUAL 3
 10223         GO TO 0350-NO-RECORDS,
 10224               0350-NO-RECORDS
 10225         DEPENDING ON DFHEIGDI
 10226     ELSE IF DFHEIGDJ EQUAL 4
 10227         GO TO 0480-NO-BATCH-TRAILER
 10228         DEPENDING ON DFHEIGDI
 10229     ELSE IF DFHEIGDJ EQUAL 5
 10230         GO TO 1000-NO-CARRIER
 10231         DEPENDING ON DFHEIGDI
 10232     ELSE IF DFHEIGDJ EQUAL 6
 10233         GO TO 1100-NO-STATE
 10234         DEPENDING ON DFHEIGDI
 10235     ELSE IF DFHEIGDJ EQUAL 7
 10236         GO TO 1200-ACCOUNT-INVALID,
 10237               1200-ACCOUNT-INVALID
 10238         DEPENDING ON DFHEIGDI
 10239     ELSE IF DFHEIGDJ EQUAL 8
 10240         GO TO 1250-NO-COMPANY-REC
 10241         DEPENDING ON DFHEIGDI
 10242     ELSE IF DFHEIGDJ EQUAL 9
 10243         GO TO 1300-NO-COMPANY-REC
 10244         DEPENDING ON DFHEIGDI
 10245     ELSE IF DFHEIGDJ EQUAL 10
 10246         GO TO 1300-EXIT
 10247         DEPENDING ON DFHEIGDI
 10248     ELSE IF DFHEIGDJ EQUAL 11
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 200
* EL630.cbl
 10249         GO TO 1470-NO-COMP-MSTR
 10250         DEPENDING ON DFHEIGDI
 10251     ELSE IF DFHEIGDJ EQUAL 12
 10252         GO TO 1990-EXIT
 10253         DEPENDING ON DFHEIGDI
 10254     ELSE IF DFHEIGDJ EQUAL 13
 10255         GO TO 2100-ADD-BATCH-TOTAL-REC
 10256         DEPENDING ON DFHEIGDI
 10257     ELSE IF DFHEIGDJ EQUAL 14
 10258         GO TO 3200-NO-RECORDS
 10259         DEPENDING ON DFHEIGDI
 10260     ELSE IF DFHEIGDJ EQUAL 15
 10261         GO TO 3120-END-ROUTINE
 10262         DEPENDING ON DFHEIGDI
 10263     ELSE IF DFHEIGDJ EQUAL 16
 10264         GO TO 3100-STOP-BROWSE,
 10265               3100-STOP-BROWSE
 10266         DEPENDING ON DFHEIGDI
 10267     ELSE IF DFHEIGDJ EQUAL 17
 10268         GO TO 3006-DELETE-CERTIFICATE,
 10269               3006-DELETE-CERTIFICATE
 10270         DEPENDING ON DFHEIGDI
 10271     ELSE IF DFHEIGDJ EQUAL 18
 10272         GO TO 3020-CONTINUE-DELETE
 10273         DEPENDING ON DFHEIGDI
 10274     ELSE IF DFHEIGDJ EQUAL 19
 10275         GO TO 3006-DELETE-ERNOTE
 10276         DEPENDING ON DFHEIGDI
 10277     ELSE IF DFHEIGDJ EQUAL 20
 10278         GO TO 3007-DELETE-MAILING-DATA
 10279         DEPENDING ON DFHEIGDI
 10280     ELSE IF DFHEIGDJ EQUAL 21
 10281         GO TO 3020-CONTINUE-DELETE,
 10282               3020-CONTINUE-DELETE
 10283         DEPENDING ON DFHEIGDI
 10284     ELSE IF DFHEIGDJ EQUAL 22
 10285         GO TO 5900-EXIT
 10286         DEPENDING ON DFHEIGDI
 10287     ELSE IF DFHEIGDJ EQUAL 23
 10288         GO TO 5100-STOP-BROWSE,
 10289               5100-STOP-BROWSE
 10290         DEPENDING ON DFHEIGDI
 10291     ELSE IF DFHEIGDJ EQUAL 24
 10292         GO TO 6500-NO-RECORDS
 10293         DEPENDING ON DFHEIGDI
 10294     ELSE IF DFHEIGDJ EQUAL 25
 10295         GO TO 6400-STOP-BROWSE,
 10296               6400-STOP-BROWSE
 10297         DEPENDING ON DFHEIGDI
 10298     ELSE IF DFHEIGDJ EQUAL 26
 10299         GO TO 6300-WRITE-PNDB-RECORD
 10300         DEPENDING ON DFHEIGDI
 10301     ELSE IF DFHEIGDJ EQUAL 27
 10302         GO TO 6070-DELETE-MAILING
 10303         DEPENDING ON DFHEIGDI
 10304     ELSE IF DFHEIGDJ EQUAL 28
 10305         GO TO 6300-WRITE-PNDB-RECORD,
 10306               6300-WRITE-PNDB-RECORD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page 201
* EL630.cbl
 10307         DEPENDING ON DFHEIGDI
 10308     ELSE IF DFHEIGDJ EQUAL 29
 10309         GO TO 6300-WRITE-PNDB-RECORD
 10310         DEPENDING ON DFHEIGDI
 10311     ELSE IF DFHEIGDJ EQUAL 30
 10312         GO TO 6690-EXIT
 10313         DEPENDING ON DFHEIGDI
 10314     ELSE IF DFHEIGDJ EQUAL 31
 10315         GO TO 7090-EXIT
 10316         DEPENDING ON DFHEIGDI
 10317     ELSE IF DFHEIGDJ EQUAL 32
 10318         GO TO 7180-NO-REQUEST-REC
 10319         DEPENDING ON DFHEIGDI
 10320     ELSE IF DFHEIGDJ EQUAL 33
 10321         GO TO 7280-NO-REQUEST-REC
 10322         DEPENDING ON DFHEIGDI
 10323     ELSE IF DFHEIGDJ EQUAL 34
 10324         GO TO 8300-SEND-TEXT
 10325         DEPENDING ON DFHEIGDI.
 10326     MOVE '9%                    "   ' TO DFHEIV0
 10327     MOVE 'EL630' TO DFHEIV1
 10328     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10329     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6372     Code:       27759
