* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    40* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    41* 031715  CR2015022700002  PEMA  CHECK CHG IN DIAGNOSIS
    42* 031815    2015021700001  TANA  BENE EDIT IF A PAYMENT PENDING
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 040617  CR2017022200003  TANA  INCREASE CHG INC DT TO 180 DAYS
    45* 062217  CR2017050300002  TANA  ADD AUTH RCVD FIELD
    46* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    47* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    48* 021418  CR2017110200001  TANA  EDIT NAME CHANGE AGST INSRD TYPE
    49******************************************************************
    50
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page   3
* EL131.cbl
    52 ENVIRONMENT DIVISION.
    53
    54 DATA DIVISION.
    55
    56 WORKING-STORAGE SECTION.
    57 01  DFH-START PIC X(04).
    58
    59 77  FILLER  PIC X(32)  VALUE '********************************'.
    60 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    61 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    62 77  s1                          pic s999 comp-3 value+0.
    63 77  s2                          pic s999 comp-3 value+0.
    64 77  a1                          pic s999 comp-3 value+0.
    65 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    66 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    67 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    68 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    69 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    70 77  ws-max-extension            pic s999 comp-3 value +0.
    71 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    72 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    73 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    74     88  ERPDEF-FOUND                 VALUE 'Y'.
    75 77  WS-TRLR-FILE-EOF            PIC X     VALUE ' '.
    76     88  TRLR-FILE-EOF                VALUE 'Y'.
    77 77  WS-PAYMENT-PENDING          PIC X     VALUE ' '.
    78     88  PAYMENT-PENDING              VALUE 'Y'.
    79 77  WS-AUTH-RCVD                PIC X     VALUE ' '.
    80     88  AUTH-RCVD                    VALUE 'Y'.
    81     88  NO-AUTH-RCVD                 VALUE 'N'.
    82 77  ws-eracct-sw                pic x  value ' '.
    83     88  acct-found                value 'Y'.
    84 77  ws-benper-sw                pic x   value ' '.
    85     88  good-benper               value 'Y'.
    86 77  ws-claim-type               pic x value ' '.
    87 77  ws-ben-per                  pic 99 value 00.
    88 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    89 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    90 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    91 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    92
    93 01  LCP-TIME-OF-DAY-XX.
    94     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    95     05  FILLER                    PIC 99.
    96 01  LCP-CICS-TIME                 PIC 9(15).
    97*                            COPY ELCSCTM.
    98******************************************************************
    99*                                                                *
   100*                                                                *
   101*                            ELCSCTM                             *
   102*                            VMOD=2.001                          *
   103*                                                                *
   104*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   105*                                                                *
   106******************************************************************
   107 01  SECURITY-MESSAGE.
   108     12  FILLER                          PIC X(30)
   109            VALUE '** LOGIC SECURITY VIOLATION -'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page   4
* EL131.cbl
   110     12  SM-READ                         PIC X(6).
   111     12  FILLER                          PIC X(5)
   112            VALUE ' PGM='.
   113     12  SM-PGM                          PIC X(6).
   114     12  FILLER                          PIC X(5)
   115            VALUE ' OPR='.
   116     12  SM-PROCESSOR-ID                 PIC X(4).
   117     12  FILLER                          PIC X(6)
   118            VALUE ' TERM='.
   119     12  SM-TERMID                       PIC X(4).
   120     12  FILLER                          PIC XX   VALUE SPACE.
   121     12  SM-JUL-DATE                     PIC 9(5).
   122     12  FILLER                          PIC X    VALUE SPACE.
   123     12  SM-TIME                         PIC 99.99.
   124
   125
   126*                            COPY ELCSCRTY.
   127******************************************************************
   128*                                                                *
   129*                                                                *
   130*                            ELCSCRTY                            *
   131*                            VMOD=2.001                          *
   132*                                                                *
   133*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   134*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   135*        SAVED IN PI-SECURITY-ADDRESS.                           *
   136*                                                                *
   137******************************************************************
   138 01  SECURITY-CONTROL.
   139     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   140     12  FILLER                       PIC XX    VALUE 'SC'.
   141     12  SC-CREDIT-CODES.
   142         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   143             20  SC-CREDIT-DISPLAY    PIC X.
   144             20  SC-CREDIT-UPDATE     PIC X.
   145     12  SC-CLAIMS-CODES.
   146         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   147             20  SC-CLAIMS-DISPLAY    PIC X.
   148             20  SC-CLAIMS-UPDATE     PIC X.
   149
   150*                            COPY ELCNWA.
   151*****************************************************************
   152*                                                               *
   153*                                                               *
   154*                            ELCNWA.                            *
   155*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   156*                            VMOD=2.003                         *
   157*                                                               *
   158*            M O V E   N A M E   W O R K   A R E A.             *
   159*                                                               *
   160*****************************************************************.
   161
   162 01  WS-NAME-WORK-AREA.
   163     05  WS-INSURED-LAST-NAME        PIC X(15).
   164     05  WS-INSURED-1ST-NAME         PIC X(12).
   165     05  WS-INSURED-MID-INIT         PIC X.
   166
   167     05  WS-NAME-WORK.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page   5
* EL131.cbl
   168         10  WS-NW                   PIC X
   169             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   170
   171     05  WS-NAME-WORK2.
   172         10  WS-NW2                  PIC X
   173             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   174                                        NWA-INDEX0.
   175
   176     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   177                                     COMP-3.
   178
   179
   180 01  ws-dcc-error-line.
   181     05  filler occurs 15.
   182         10  ws-error-no        pic x(4).
   183 01  WS-DATE-AREA.
   184     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   185     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   186     12  SAVE-DATE-CCYYMMDD.
   187         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   188         16  SAVE-DATE-YMD.
   189             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   190             20  FILLER         PIC X(4)    VALUE SPACES.
   191
   192 01  WS-BLANK                   PIC X       VALUE ' '.
   193
   194 01  CSO-WORK-FIELDS.
   195     05  WS-HOLD-CLAIM-STATUS    PIC X.
   196     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   197     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   198         10  WS-RECURRENT-YN     PIC X.
   199         10  FILLER              PIC X.
   200
   201 01  LITERALS-NUMBERS.
   202     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   203     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   204     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   205     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   206     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   207     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   208     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   209     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   210
   211     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   212     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   213     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   214     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   215     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   216     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   217     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   218     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   219     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   220     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   221
   222     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   223
   224     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   225
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page   6
* EL131.cbl
   226     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   227     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   228     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   229     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   230     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   231     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   232     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   233     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   234     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   235     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   236     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   237     12  WS-CONTEST-NOTE      PIC X(44)
   238         VALUE 'CONTRACT NOW CONTESTABLE - INC/RPT DT CHGD'.
   239
   240     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   241     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   242     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   243     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   244         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   245     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   246     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   247     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   248     12  WS-ICD-CODE-1           PIC X(8).
   249     12  WS-ICD-CODE-2           PIC X(8).
   250     12  WS-CLAIM-SEQU.
   251         16  FILLER              PIC X VALUE '('.
   252         16  WS-CURRENT-SEQU     PIC Z9.
   253         16  FILLER              PIC X(04) VALUE ' OF '.
   254         16  WS-OF-SEQU          PIC Z9.
   255         16  FILLER              PIC X VALUE ')'.
   256     12  WS-EDIT-BEN-CODE        PIC XX.
   257         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   258                                          '90' THRU '99'.
   259
   260     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   261     12  WS-EDIT-NUMBER          PIC ZZZ9.
   262
   263     12  WS-RESPONSE             PIC S9(8)   COMP.
   264         88  WS-RESP-NORMAL              VALUE +00.
   265         88  WS-RESP-ERROR               VALUE +01.
   266         88  WS-RESP-NOTFND              VALUE +13.
   267         88  WS-RESP-DUPKEY              VALUE +15.
   268         88  WS-RESP-NOTOPEN             VALUE +19.
   269         88  WS-RESP-ENDFILE             VALUE +20.
   270
   271     12  WS-MOS-PAID             PIC 999.
   272     12  WS-ODD-DAYS             PIC 99.
   273     12  WS-REM-MOS              PIC 999.
   274     12  WS-REM-DAYS             PIC 99.
   275     12  WS-TERM-IN-DAYS         PIC 9(4).
   276     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   277
   278     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   279     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   280     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   281     12  WS-RESET-SW             PIC X       VALUE 'N'.
   282     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   283     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page   7
* EL131.cbl
   284     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   285
   286 01  DMD-DATE-YYYYMMDD.
   287     12  DMD-DECADE          PIC XX      VALUE SPACES.
   288     12  DMD-YYMMDD.
   289         16  DMD-YY          PIC XX      VALUE SPACES.
   290         16  DMD-MM          PIC XX      VALUE SPACES.
   291         16  DMD-DD          PIC XX      VALUE SPACES.
   292
   293 01  DMD-DATE-MMDDYYYY.
   294     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   295     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   296     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   297     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   298     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   299     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   300
   301 01  WS-MAIL-CODE.
   302     12  FILLER              PIC X.
   303     12  DMD-MAIL-CODE.
   304         16  WS-MAIL-4       PIC X(4).
   305         16  WS-MAIL-5       PIC X.
   306     12  FILLER              PIC X(4).
   307
   308     12  W-NAME-LAST             PIC  X(15).
   309     12  W-NAME-FIRST            PIC  X(15).
   310     12  W-NAME-MIDDLE.
   311         16  FILLER              PIC  X.
   312         16  W-NAME-MIDDLE-2     PIC  X.
   313         16  FILLER              PIC  X(13).
   314
   315*    COPY ELCDCTB.
   316******************************************************************
   317*                                                                *
   318*                                                                *
   319*                            ELCDCTB.                            *
   320*                            VMOD=2.002                          *
   321*                                                                *
   322*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   323*       COMMUNICATIONS AREA                                      *
   324*                                                                *
   325******************************************************************
   326 01  DCT-COMMUNICATION-AREA.
   327     12  DCT-BILLING-BANK-ID      PIC  X(05).
   328     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   329     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   330     12  DCT-PRODUCT-CODE         PIC  X(02).
   331     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   332     12  DCT-RETURN-CODE          PIC  X(02).
   333     12  DCT-MAIL-CODE            PIC  X(05).
   334     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   335     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page   8
* EL131.cbl
   337 01  ERROR-SWITCHES.
   338     12  ERROR-SWITCH            PIC X.
   339         88  SCREEN-ERROR                    VALUE 'X'.
   340     12  MSTR-KEY-SWITCH         PIC X.
   341         88  MSTR-KEY-CHANGED                VALUE 'X'.
   342     12  CERT-KEY-SWITCH         PIC X.
   343*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   344         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   345*********SET TO Y IF PRIMARY KEY WILL CHANGE
   346         88  CERT-KEY-CHANGED                VALUE 'Y'.
   347     12  MSTR-SWITCH             PIC X.
   348         88  MSTR-UPDATES                    VALUE 'X'.
   349     12  crtt-switch             pic x value spaces.
   350         88  crtt-update             value 'X'.
   351     12  CERT-SWITCH             PIC X.
   352         88  CERT-UPDATES                    VALUE 'X'.
   353     12  UPDATE-SWITCH           PIC X.
   354         88  UPDATES-PRESENT                 VALUE 'X'.
   355     12  TRLR-SWITCH             PIC X.
   356         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   357         88  UPDATE-MADE                     VALUE 'Y'.
   358     12  NINETY-TRLR-SWITCH      PIC X.
   359         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   360     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   361         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   362     12  EARNINGS-CALC-SWITCH    PIC X.
   363         88  TEX-REG                         VALUE '4'.
   364         88  NET-PAY                         VALUE '5'.
   365     12  DLYACTV-SW              PIC X       VALUE 'N'.
   366         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page   9
* EL131.cbl
   368 01  EDIT-WORK-AREA.
   369     12  COUNT-2                 PIC 9.
   370     12  CALL-PGM                PIC X(8).
   371     12  TRANS-ID                PIC X(4).
   372     12  CHECK-PFKEYS            PIC 99.
   373     12  CHECK-MAINT             PIC X.
   374         88  ADD-ALPHA-RECORD                VALUE 'A'.
   375         88  CHANGE-CLAIM                    VALUE 'C'.
   376         88  DELETE-CLAIM                    VALUE 'D'.
   377         88  CHANGE-NAME                     VALUE 'N'.
   378         88  VALID-OPTIONS                   VALUE 'A' 'C'
   379                                                   'D' 'N'.
   380
   381     12  HOLD-BENEFIT            PIC XX.
   382     12  HOLD-FREQ               PIC XX.
   383     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   384     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   385     12  HOLD-PDTHRU             PIC XX.
   386     12  HOLD-ADDON              PIC XX.
   387     12  HOLD-NODAYS             PIC 9(4).
   388     12  HOLD-NOPMTS             PIC 9(3).
   389     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   390     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   391     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   392     12  HOLD-BIRTH              PIC XX.
   393     12  HOLD-END                PIC XX.
   394     12  HOLD-EFF                PIC XX.
   395     12  HOLD-ENTRY              PIC XX.
   396     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   397     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   398     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   399     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   400     12  HOLD-LF-CV-CAN          PIC XX.
   401     12  HOLD-AH-CV-CAN          PIC XX.
   402     12  DIVIDE-QUOT             PIC 9(3).
   403     12  DIVIDE-REM              PIC 9(3).
   404
   405     12  WS-ALPHA-DATE.
   406         16  WS-ALPHA-YEAR.
   407             20  WS-ALPHA-YY-1   PIC 99.
   408             20  WS-ALPHA-YY-2   PIC 99.
   409         16  WS-ALPHA-MM         PIC 99.
   410         16  WS-ALPHA-DD         PIC 99.
   411
   412     12  BUILD-VALID-DATE.
   413         16  BUILD-MONTH         PIC 99.
   414         16  BUILD-DAY           PIC 99.
   415         16  BUILD-YEAR          PIC 99.
   416     12  DEEDIT-MMYY-INPUT.
   417         16  FILLER              PIC X.
   418         16  DEEDIT-MONTH        PIC XX.
   419         16  DEEDIT-YEAR         PIC XX.
   420     12  DEEDIT-BEN              PIC 9(9)V99.
   421     12  DEEDIT-DATE-INPUT.
   422         16  FILLER              PIC XX.
   423         16  DEEDIT-DATE         PIC X(6).
   424     12  WORK-DATE-MDY.
   425         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  10
* EL131.cbl
   426         16  FILLER              PIC X(4).
   427         16  YEAR-WORK           PIC XX.
   428     12  WORK-DATE-MY.
   429         16  WORK-MONTH          PIC XX.
   430         16  WORK-SLASH          PIC X       VALUE '/'.
   431         16  WORK-YEAR           PIC XX.
   432     12  HOLD-DATE.
   433         16  HOLD-MONTH          PIC 99.
   434         16  FILLER              PIC X(4).
   435         16  HOLD-YEAR           PIC 99.
   436     12  SPLIT-INFO-LINE-1.
   437         16  SPLIT-INFO-DESC     PIC X(15).
   438         16  FILLER              PIC X(5)    VALUE ' OLD='.
   439         16  SPLIT-INFO-OLD      PIC X(40).
   440     12  EFF-TERM-MO             PIC 9(4).
   441     12  CURR-MO                 PIC 9(4).
   442     12  WS-BIN-CURRENT-DT       PIC XX.
   443     12  WS-CALC-METHOD          PIC X.
   444     12  WS-INITIALS.
   445         16  WS-INIT-1           PIC X.
   446         16  WS-INIT-2           PIC X.
   447     12  WS-REIN-TABLE.
   448         16  WS-REIN-1           PIC X.
   449         16  WS-REIN-2           PIC X.
   450         16  WS-REIN-3           PIC X.
   451     12  PI-KEY.
   452         16  PI-TERM             PIC X(4).
   453         16  PI-QUAL             PIC X(4).
   454     12  CHECK-KEY               PIC X(20).
   455     12  SAVE-ACCT-KEY           PIC X(20).
   456     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   457     12  WS-SOC-SEC-NUMBER.
   458         16  WS-SOC-SEC-NO       PIC 9(9).
   459         16  WS-SOC-SEC-BLANK    PIC X(2).
   460     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   461         16  WS-SSN-1-3          PIC 9(3).
   462         16  WS-SSN-DASH1        PIC X(1).
   463         16  WS-SSN-4-5          PIC 9(2).
   464         16  WS-SSN-DASH2        PIC X(1).
   465         16  WS-SSN-6-9          PIC 9(4).
   466     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   467     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   468
   469 01  WS-SAVE-FIELDS.
   470     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   471     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   472     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   473     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   474     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   475     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   476     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   477     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   478     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   479     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   480     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   481     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   482     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   483     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  11
* EL131.cbl
   484     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   485     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   486     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   487     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   488     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   489     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   490     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   491     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   492     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   493     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   494     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   495     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   496     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   497     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   498     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   499     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   500     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   501     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   502     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   503     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   504     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   505     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   506     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   507     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   508     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   509     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   510     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   511     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   512     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   513     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   514     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   515     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   516     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   517     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   518     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   519     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   520     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   521     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   522     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   523     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   524     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   525
   526 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   527     12  M                   PIC S9(7)V99           VALUE ZEROS.
   528     12  L                   PIC S9(7)V99           VALUE ZEROS.
   529     12  N                   PIC S9(3)              VALUE ZEROS.
   530     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   531     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   532     12  I                   PIC S99V9(5)           VALUE ZEROS.
   533     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   534     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   535     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   536     12  R                   PIC S9(3)              VALUE ZEROS.
   537     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   538     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   539     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   540     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   541     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  12
* EL131.cbl
   542     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   543     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   544     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   545     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   546
   547 01  TERM-CALC-WORK-AREA.
   548     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   549     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   550     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   551     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   552     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   553     12  V-EXPONENTS.
   554        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   555     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   556
   557 01  TIME-IN.
   558     12  UN-HOURS                PIC XX.
   559     12  UN-MINUTES              PIC XX.
   560     12  FILLER                  PIC XX.
   561
   562 01  TIME-OUT.
   563     12  FOR-HOURS               PIC XX.
   564     12  FILLER                  PIC X       VALUE '.'.
   565     12  FOR-MINUTES             PIC XX.
   566
   567 01  ERROR-NUMBERS.
   568     12  ER-0000                 PIC X(4)    VALUE '0000'.
   569     12  ER-0004                 PIC X(4)    VALUE '0004'.
   570     12  ER-0008                 PIC X(4)    VALUE '0008'.
   571     12  ER-0023                 PIC X(4)    VALUE '0023'.
   572     12  ER-0029                 PIC X(4)    VALUE '0029'.
   573     12  ER-0068                 PIC X(4)    VALUE '0068'.
   574     12  ER-0070                 PIC X(4)    VALUE '0070'.
   575     12  ER-0149                 PIC X(4)    VALUE '0149'.
   576     12  ER-0154                 PIC X(4)    VALUE '0154'.
   577     12  ER-0169                 PIC X(4)    VALUE '0169'.
   578     12  ER-0192                 PIC X(4)    VALUE '0192'.
   579     12  ER-0199                 PIC X(4)    VALUE '0199'.
   580     12  ER-0203                 PIC X(4)    VALUE '0203'.
   581     12  ER-0204                 PIC X(4)    VALUE '0204'.
   582     12  ER-0205                 PIC X(4)    VALUE '0205'.
   583     12  ER-0206                 PIC X(4)    VALUE '0206'.
   584     12  ER-0208                 PIC X(4)    VALUE '0208'.
   585     12  ER-0210                 PIC X(4)    VALUE '0210'.
   586     12  ER-0215                 PIC X(4)    VALUE '0215'.
   587     12  ER-0219                 PIC X(4)    VALUE '0219'.
   588     12  ER-0220                 PIC X(4)    VALUE '0220'.
   589     12  ER-0222                 PIC X(4)    VALUE '0222'.
   590     12  ER-0223                 PIC X(4)    VALUE '0223'.
   591     12  ER-0224                 PIC X(4)    VALUE '0224'.
   592     12  ER-0227                 PIC X(4)    VALUE '0227'.
   593     12  ER-0230                 PIC X(4)    VALUE '0230'.
   594     12  ER-0232                 PIC X(4)    VALUE '0232'.
   595     12  ER-0233                 PIC X(4)    VALUE '0233'.
   596     12  ER-0236                 PIC X(4)    VALUE '0236'.
   597     12  ER-0237                 PIC X(4)    VALUE '0237'.
   598     12  ER-0238                 PIC X(4)    VALUE '0238'.
   599     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  13
* EL131.cbl
   600     12  ER-0241                 PIC X(4)    VALUE '0241'.
   601     12  ER-0243                 PIC X(4)    VALUE '0243'.
   602     12  ER-0244                 PIC X(4)    VALUE '0244'.
   603     12  ER-0246                 PIC X(4)    VALUE '0246'.
   604     12  ER-0247                 PIC X(4)    VALUE '0247'.
   605     12  ER-0248                 PIC X(4)    VALUE '0248'.
   606     12  ER-0250                 PIC X(4)    VALUE '0250'.
   607     12  ER-0251                 PIC X(4)    VALUE '0251'.
   608     12  ER-0253                 PIC X(4)    VALUE '0253'.
   609     12  ER-0256                 PIC X(4)    VALUE '0256'.
   610     12  ER-0257                 PIC X(4)    VALUE '0257'.
   611     12  ER-0258                 PIC X(4)    VALUE '0258'.
   612     12  ER-0259                 PIC X(4)    VALUE '0259'.
   613     12  ER-0260                 PIC X(4)    VALUE '0260'.
   614     12  ER-0261                 PIC X(4)    VALUE '0261'.
   615     12  ER-0262                 PIC X(4)    VALUE '0262'.
   616     12  ER-0263                 PIC X(4)    VALUE '0263'.
   617     12  ER-0273                 PIC X(4)    VALUE '0273'.
   618     12  ER-0274                 PIC X(4)    VALUE '0274'.
   619     12  ER-0276                 PIC X(4)    VALUE '0276'.
   620     12  ER-0282                 PIC X(4)    VALUE '0282'.
   621     12  ER-0283                 PIC X(4)    VALUE '0283'.
   622     12  ER-0309                 PIC X(4)    VALUE '0309'.
   623     12  ER-0310                 PIC X(4)    VALUE '0310'.
   624     12  ER-0311                 PIC X(4)    VALUE '0311'.
   625     12  ER-0333                 PIC X(4)    VALUE '0333'.
   626     12  ER-0360                 PIC X(4)    VALUE '0360'.
   627     12  ER-0377                 PIC X(4)    VALUE '0377'.
   628     12  ER-0402                 PIC X(4)    VALUE '0402'.
   629     12  ER-0416                 PIC X(4)    VALUE '0416'.
   630     12  ER-0426                 PIC X(4)    VALUE '0426'.
   631     12  ER-0427                 PIC X(4)    VALUE '0427'.
   632     12  ER-0428                 PIC X(4)    VALUE '0428'.
   633     12  ER-0429                 PIC X(4)    VALUE '0429'.
   634     12  ER-0430                 PIC X(4)    VALUE '0430'.
   635     12  ER-0458                 PIC X(4)    VALUE '0458'.
   636     12  ER-0475                 PIC X(4)    VALUE '0475'.
   637     12  ER-0491                 PIC X(4)    VALUE '0491'.
   638     12  ER-0509                 PIC X(4)    VALUE '0509'.
   639     12  ER-0510                 PIC X(4)    VALUE '0510'.
   640     12  ER-0511                 PIC X(4)    VALUE '0511'.
   641     12  ER-0512                 PIC X(4)    VALUE '0512'.
   642     12  ER-0519                 PIC X(4)    VALUE '0519'.
   643     12  ER-0520                 PIC X(4)    VALUE '0520'.
   644     12  ER-0521                 PIC X(4)    VALUE '0521'.
   645     12  ER-0547                 PIC X(4)    VALUE '0547'.
   646     12  ER-0548                 PIC X(4)    VALUE '0548'.
   647     12  ER-0549                 PIC X(4)    VALUE '0549'.
   648     12  ER-0565                 PIC X(4)    VALUE '0565'.
   649     12  ER-0598                 PIC X(4)    VALUE '0598'.
   650     12  ER-0639                 PIC X(4)    VALUE '0639'.
   651     12  ER-0797                 PIC X(4)    VALUE '0797'.
   652     12  ER-0802                 PIC X(4)    VALUE '0802'.
   653     12  ER-0803                 PIC X(4)    VALUE '0803'.
   654     12  ER-0849                 PIC X(4)    VALUE '0849'.
   655     12  ER-0885                 PIC X(4)    VALUE '0885'.
   656     12  ER-0887                 PIC X(4)    VALUE '0887'.
   657     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  14
* EL131.cbl
   658     12  ER-0921                 PIC X(4)    VALUE '0921'.
   659     12  ER-0938                 PIC X(4)    VALUE '0938'.
   660     12  ER-0946                 PIC X(4)    VALUE '0946'.
   661     12  ER-0947                 PIC X(4)    VALUE '0947'.
   662     12  ER-0948                 PIC X(4)    VALUE '0948'.
   663     12  ER-0949                 PIC X(4)    VALUE '0949'.
   664     12  ER-0950                 PIC X(4)    VALUE '0950'.
   665     12  ER-0951                 PIC X(4)    VALUE '0951'.
   666     12  ER-0954                 PIC X(4)    VALUE '0954'.
   667     12  ER-0974                 PIC X(4)    VALUE '0974'.
   668     12  ER-0975                 PIC X(4)    VALUE '0975'.
   669     12  ER-0992                 PIC X(4)    VALUE '0992'.
   670     12  er-1581                 pic x(4)    value '1581'.
   671     12  ER-1651                 PIC X(4)    VALUE '1651'.
   672     12  ER-1652                 PIC X(4)    VALUE '1652'.
   673     12  ER-1653                 PIC X(4)    VALUE '1653'.
   674     12  ER-1654                 PIC X(4)    VALUE '1654'.
   675     12  ER-1655                 PIC X(4)    VALUE '1655'.
   676     12  er-1656                 pic x(4)    value '1656'.
   677     12  ER-1661                 PIC X(4)    VALUE '1661'.
   678     12  ER-1662                 PIC X(4)    VALUE '1662'.
   679     12  ER-1663                 PIC X(4)    VALUE '1663'.
   680     12  er-1664                 pic x(4)    value '1664'.
   681     12  er-1665                 pic x(4)    value '1665'.
   682     12  er-1666                 pic x(4)    value '1666'.
   683     12  er-1668                 pic x(4)    value '1668'.
   684     12  er-1669                 pic x(4)    value '1669'.
   685     12  er-1675                 pic x(4)    value '1675'.
   686     12  er-1676                 pic x(4)    value '1676'.
   687     12  ER-1678                 PIC X(4)    VALUE '1678'.
   688     12  ER-1679                 PIC X(4)    VALUE '1679'.
   689     12  ER-1772                 PIC X(4)    VALUE '1772'.
   690     12  ER-1773                 PIC X(4)    VALUE '1773'.
   691     12  ER-1778                 PIC X(4)    VALUE '1778'.
   692     12  ER-2280                 PIC X(4)    VALUE '2280'.
   693     12  ER-2878                 PIC X(4)    VALUE '2878'.
   694     12  ER-7641                 PIC X(4)    VALUE '7641'.
   695     12  ER-7642                 PIC X(4)    VALUE '7642'.
   696     12  ER-7650                 PIC X(4)    VALUE '7650'.
   697     12  ER-7651                 PIC X(4)    VALUE '7651'.
   698     12  ER-7687                 PIC X(4)    VALUE '7687'.
   699     12  ER-7689                 PIC X(4)    VALUE '7689'.
   700     12  ER-7690                 PIC X(4)    VALUE '7690'.
   701     12  ER-7691                 PIC X(4)    VALUE '7691'.
   702     12  ER-8003                 PIC X(4)    VALUE '8003'.
   703     12  ER-8051                 PIC X(4)    VALUE '8051'.
   704     12  ER-8052                 PIC X(4)    VALUE '8052'.
   705     12  ER-8053                 PIC X(4)    VALUE '8053'.
   706     12  ER-8054                 PIC X(4)    VALUE '8054'.
   707     12  ER-8055                 PIC X(4)    VALUE '8055'.
   708     12  ER-8056                 PIC X(4)    VALUE '8056'.
   709     12  ER-8057                 PIC X(4)    VALUE '8057'.
   710     12  ER-8058                 PIC X(4)    VALUE '8058'.
   711     12  ER-8059                 PIC X(4)    VALUE '8059'.
   712     12  ER-8060                 PIC X(4)    VALUE '8060'.
   713     12  ER-8061                 PIC X(4)    VALUE '8061'.
   714     12  ER-8062                 PIC X(4)    VALUE '8062'.
   715     12  ER-8063                 PIC X(4)    VALUE '8063'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  15
* EL131.cbl
   716     12  ER-8064                 PIC X(4)    VALUE '8064'.
   717     12  ER-8065                 PIC X(4)    VALUE '8065'.
   718     12  ER-8066                 PIC X(4)    VALUE '8066'.
   719     12  ER-8152                 PIC X(4)    VALUE '8152'.
   720     12  ER-8153                 PIC X(4)    VALUE '8153'.
   721     12  ER-8154                 PIC X(4)    VALUE '8154'.
   722     12  ER-8155                 PIC X(4)    VALUE '8155'.
   723 01  ERPDEF-KEY-SAVE             PIC X(18).
   724 01  ERPDEF-KEY.
   725     12  ERPDEF-COMPANY-CD       PIC X.
   726     12  ERPDEF-STATE            PIC XX.
   727     12  ERPDEF-PROD-CD          PIC XXX.
   728     12  F                       PIC X(7).
   729     12  ERPDEF-BEN-TYPE         PIC X.
   730     12  ERPDEF-BEN-CODE         PIC XX.
   731     12  ERPDEF-EXP-DT           PIC XX.
   732 01  MSTR-KEY.
   733     12  COMPANY-CODE            PIC X.
   734     12  CARRIER-CODE            PIC X.
   735     12  CLAIM-NO                PIC X(7).
   736     12  CERT-NO.
   737         16  CERT-NO-PRIME       PIC X(10).
   738         16  CERT-NO-SUFX        PIC X.
   739
   740 01  WS-SAVE-CLAIM-KEY.
   741     12  WS-SAVE-COMPANY-CD      PIC X.
   742     12  WS-SAVE-CARRIER         PIC X.
   743     12  WS-SAVE-CLAIM-NO        PIC X(7).
   744     12  WS-SAVE-CERT-NO.
   745         16  WS-CERT-NO-PRIME    PIC X(10).
   746         16  WS-CERT-NO-SUFX     PIC X.
   747
   748 01  CERT-KEY.
   749     12  CERT-COMPANY-CODE       PIC X.
   750     12  CERT-CARRIER            PIC X.
   751     12  CERT-GROUP              PIC X(6).
   752     12  CERT-STATE              PIC XX.
   753     12  CERT-ACCOUNT            PIC X(10).
   754     12  CERT-DATE               PIC XX.
   755     12  CERT-CERT.
   756         16  CERT-CERT-PRIME     PIC X(10).
   757         16  CERT-CERT-SUFX      PIC X.
   758
   759 01  ELCRTT-KEY.
   760     05  CTRLR-COMP-CD       PIC X.
   761     05  CTRLR-CARRIER       PIC X.
   762     05  CTRLR-GROUPING      PIC X(6).
   763     05  CTRLR-STATE         PIC X(2).
   764     05  CTRLR-ACCOUNT       PIC X(10).
   765     05  CTRLR-EFF-DT        PIC XX.
   766     05  CTRLR-CERT-NO       PIC X(11).
   767     05  CTRLR-REC-TYPE      PIC X.
   768 01  NOTE-KEY.
   769     12  NOTE-COMP-CD            PIC X.
   770     12  NOTE-CERT-KEY.
   771         16  NOTE-CARRIER        PIC X.
   772         16  NOTE-GROUP          PIC X(6).
   773         16  NOTE-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  16
* EL131.cbl
   774         16  NOTE-ACCOUNT        PIC X(10).
   775         16  NOTE-DATE           PIC XX.
   776         16  NOTE-CERT-NO        PIC X(11).
   777
   778 01  TRLR-KEY.
   779     12  TRLR-MAIN-KEY.
   780         16  TRLR-COMPANY-CD     PIC X.
   781         16  TRLR-CARRIER        PIC X.
   782         16  TRLR-CLAIM-NO       PIC X(07).
   783         16  TRLR-CERT-NO        PIC X(11).
   784     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   785
   786 01  BENEFIT-KEY.
   787     12  BEN-CO-ID               PIC X(3).
   788     12  BEN-REC-TYPE            PIC X.
   789     12  FILLER                  PIC XX.
   790     12  BEN-ACC-CD              PIC XX.
   791     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   792
   793 01  CNTL-KEY.
   794     12  CNTL-CO-ID              PIC X(3).
   795     12  CNTL-REC-TYPE           PIC X.
   796     12  CNTL-PROC-ID            PIC X(4).
   797     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   798         16  CNTL-STATE-NUMBER   PIC XX.
   799         16  FILLER              PIC XX.
   800     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   801         16  FILLER              PIC X(3).
   802         16  CNTL-CARRIER        PIC X.
   803     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   804
   805 01  ACTQ-KEY                    PIC X(20).
   806
   807 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   808
   809 01  CHKQ-KEY.
   810     12  CHKQ-COMPANY-CODE       PIC X.
   811     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   812     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   813
   814 01  ARCH-KEY.
   815     12  ARCH-COMPANY-CODE       PIC X.
   816     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   817     12  ARCH-RECORD-TYPE        PIC X.
   818     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   819
   820 01  ACCT-KEY.
   821     05  ACCT-PARTIAL-KEY.
   822         12  ACCT-COMPANY-CODE   PIC X.
   823         12  ACCT-CARRIER        PIC X.
   824         12  ACCT-GROUP          PIC X(6).
   825         12  ACCT-STATE          PIC XX.
   826         12  ACCT-ACCOUNT        PIC X(10).
   827     05  ACCT-DATE               PIC XX.
   828
   829 01  WS-ELBENE-KEY.
   830     12  WS-ELBENE-COMPANY-CD    PIC X.
   831     12  WS-ELBENE-RECORD-TYPE   PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  17
* EL131.cbl
   832     12  WS-ELBENE-ID            PIC X(10).
   833
   834 01  ELALPH-KEY.
   835     12  ELALPH-COMPANY-CD       PIC X.
   836     12  ELALPH-SOURCE           PIC X.
   837     12  ELALPH-NAME.
   838         16  ELALPH-LAST-NAME    PIC X(15).
   839         16  ELALPH-FIRST-NAME.
   840             20  ELALPH-FIRST-INIT   PIC X.
   841             20  FILLER              PIC X(11).
   842         16  ELALPH-MIDDLE-INIT  PIC X.
   843     12  ELALPH-DATE             PIC X(08).
   844     12  ELALPH-TIME             PIC S9(04)    COMP.
   845
   846 01  COMP-LENGTHS.
   847     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   848     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   849     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   850     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   851     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   852     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   853     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   854     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   855     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   856     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   857     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   858     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   859     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   860     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  18
* EL131.cbl
   862*                                COPY ELCLNKLT.
   863******************************************************************
   864*                                                                *
   865*                                                                *
   866*                           ELCLNKLT                             *
   867*                            VMOD=2.003                          *
   868*                                                                *
   869*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   870*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   871*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   872*                                                                *
   873*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   874*   COMPLETING THE REQUIRED FIELDS.                              *
   875*                                                                *
   876*   THE CALLING PROGRAM SHOULD CHECK:                            *
   877*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   878*                              9999 INDICATES AN UNKNOWN ABEND   *
   879*                                   WAS DETECTED.                *
   880*                              ALL OTHER VALUES ARE NORMAL ERROR *
   881*                              CODES FOUND IN THE ERROR FILE.    *
   882******************************************************************
   883 01  W-1523-LINKDATA.
   884     12  W-1523-COMMON-PI-DATA.
   885         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   886         16  FILLER              PIC  X(67).
   887         16  W-1523-COMPANY-CD   PIC  X(01).
   888         16  FILLER              PIC  X(10).
   889         16  W-1523-CONTROL-IN-PROGRESS.
   890             20  W-1523-CARRIER  PIC  X(01).
   891             20  W-1523-GROUPING PIC  X(06).
   892             20  W-1523-STATE    PIC  X(02).
   893             20  W-1523-ACCOUNT  PIC  X(10).
   894             20  W-1523-CLAIM-CERT-GRP.
   895                 24  W-1523-CLAIM-NO
   896                                 PIC  X(07).
   897                 24  W-1523-CERT-NO.
   898                     28  W-1523-CERT-PRIME
   899                                 PIC  X(10).
   900                     28  W-1523-CERT-SFX
   901                                 PIC  X(01).
   902                 24  W-1523-CERT-EFF-DT
   903                                 PIC  X(02).
   904         16  FILLER              PIC X(265).
   905
   906     12  W-1523-WORK-AREA.
   907         16  W-1523-FORM-NUMBER  PIC  X(04).
   908         16  W-1523-NUMBER-COPIES
   909                                 PIC  9(01).
   910         16  W-1523-ADDR-TYPE    PIC  X(02).
   911         16  W-1523-FOLLOW-UP-DATE
   912                                 PIC  X(02).
   913         16  W-1523-RESEND-DATE  PIC  X(02).
   914         16  W-1523-ERROR-CODE   PIC  9(04).
   915             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   916             88  W-1523-FATAL-ERROR
   917                                    VALUES  0006 0013 0042
   918                                            0154 0168 0169
   919                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  19
* EL131.cbl
   920                                            0179 0186 0281
   921                                            0332 2055 3697
   922                                            3698 3699 3770
   923                                            3771 3772 7675
   924                                            9106 9808 9883
   925                                            9887.
   926             88  W-1523-STOP-ERRORS
   927                                    VALUES  0013 0042 0154
   928                                            0168 0169 0172
   929                                            0281 0332 2055
   930                                            3698 3699 7675
   931                                            9106 9808 9883
   932                                            9999.
   933         16  W-1523-REASON       PIC  X(70).
   934         16  W-1523-ARCHIVE-NUMBER
   935                                 PIC  9(08).
   936     12  W-1523-POINTER-AREA.
   937         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   938         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   939         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   940         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   941         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  20
* EL131.cbl
   943*                                COPY ELCINTF.
   944******************************************************************
   945*                                                                *
   946*                                                                *
   947*                            ELCINTF.                            *
   948*                            VMOD=2.017                          *
   949*                                                                *
   950*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   951*                                                                *
   952*       LENGTH = 1024                                            *
   953*                                                                *
   954******************************************************************
   955*                   C H A N G E   L O G
   956*
   957* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   958*-----------------------------------------------------------------
   959*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   960* EFFECTIVE    NUMBER
   961*-----------------------------------------------------------------
   962* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   963******************************************************************
   964 01  PROGRAM-INTERFACE-BLOCK.
   965     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   966     12  PI-CALLING-PROGRAM              PIC X(8).
   967     12  PI-SAVED-PROGRAM-1              PIC X(8).
   968     12  PI-SAVED-PROGRAM-2              PIC X(8).
   969     12  PI-SAVED-PROGRAM-3              PIC X(8).
   970     12  PI-SAVED-PROGRAM-4              PIC X(8).
   971     12  PI-SAVED-PROGRAM-5              PIC X(8).
   972     12  PI-SAVED-PROGRAM-6              PIC X(8).
   973     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   974     12  PI-COMPANY-ID                   PIC XXX.
   975     12  PI-COMPANY-CD                   PIC X.
   976
   977     12  PI-COMPANY-PASSWORD             PIC X(8).
   978
   979     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   980
   981     12  PI-CONTROL-IN-PROGRESS.
   982         16  PI-CARRIER                  PIC X.
   983         16  PI-GROUPING                 PIC X(6).
   984         16  PI-STATE                    PIC XX.
   985         16  PI-ACCOUNT                  PIC X(10).
   986         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   987                                         PIC X(10).
   988         16  PI-CLAIM-CERT-GRP.
   989             20  PI-CLAIM-NO             PIC X(7).
   990             20  PI-CERT-NO.
   991                 25  PI-CERT-PRIME       PIC X(10).
   992                 25  PI-CERT-SFX         PIC X.
   993             20  PI-CERT-EFF-DT          PIC XX.
   994         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   995             20  PI-PLAN-CODE            PIC X(2).
   996             20  PI-REVISION-NUMBER      PIC X(3).
   997             20  PI-PLAN-EFF-DT          PIC X(2).
   998             20  PI-PLAN-EXP-DT          PIC X(2).
   999             20  FILLER                  PIC X(11).
  1000         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  21
* EL131.cbl
  1001             20  PI-OE-REFERENCE-1.
  1002                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1003                 25  PI-OE-REF-1-SUFF    PIC XX.
  1004
  1005     12  PI-SESSION-IN-PROGRESS          PIC X.
  1006         88  CLAIM-SESSION                   VALUE '1'.
  1007         88  CREDIT-SESSION                  VALUE '2'.
  1008         88  WARRANTY-SESSION                VALUE '3'.
  1009         88  MORTGAGE-SESSION                VALUE '4'.
  1010         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1011
  1012
  1013*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1014
  1015     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1016     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1017
  1018     12  PI-CREDIT-USER                  PIC X.
  1019         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1020         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1021
  1022     12  PI-CLAIM-USER                   PIC X.
  1023         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1024         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1025
  1026     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1027         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1028         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1029         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1030         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1031         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1032
  1033     12  PI-PROCESSOR-ID                 PIC X(4).
  1034
  1035     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1036
  1037     12  PI-MEMBER-CAPTION               PIC X(10).
  1038
  1039     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1040         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1041
  1042     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1043     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1044     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1045     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1046
  1047     12  PI-AH-OVERRIDE-L1               PIC X.
  1048     12  PI-AH-OVERRIDE-L2               PIC XX.
  1049     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1050     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1051
  1052     12  PI-NEW-SYSTEM                   PIC X(2).
  1053
  1054     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1055     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1056         88  PI-USES-PAID-TO                 VALUE '1'.
  1057     12  PI-CRDTCRD-SYSTEM.
  1058         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  22
* EL131.cbl
  1059             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1060             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1061         16  PI-CC-MONTH-END-DT          PIC XX.
  1062     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1063
  1064     12  PI-OE-REFERENCE-2.
  1065         16  PI-OE-REF-2-PRIME           PIC X(10).
  1066         16  PI-OE-REF-2-SUFF            PIC X.
  1067
  1068     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1069
  1070     12  PI-LANGUAGE-TYPE                PIC X.
  1071             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1072             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1073             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1074
  1075     12  PI-POLICY-LINKAGE-IND           PIC X.
  1076         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1077         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1078                                                   LOW-VALUES.
  1079
  1080     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1081     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1082         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1083         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1084
  1085     12  PI-PROCESSOR-CSR-IND            PIC X.
  1086         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1087         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1088
  1089     12  FILLER                          PIC X(3).
  1090
  1091     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1092
  1093     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1094         PI-SYSTEM-LEVEL.
  1095
  1096         16  PI-ENTRY-CODES.
  1097             20  PI-ENTRY-CD-1           PIC X.
  1098             20  PI-ENTRY-CD-2           PIC X.
  1099
  1100         16  PI-RETURN-CODES.
  1101             20  PI-RETURN-CD-1          PIC X.
  1102             20  PI-RETURN-CD-2          PIC X.
  1103
  1104         16  PI-UPDATE-STATUS-SAVE.
  1105             20  PI-UPDATE-BY            PIC X(4).
  1106             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1107
  1108         16  PI-LOWER-CASE-LETTERS       PIC X.
  1109             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1110
  1111*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1112*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1113*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1114
  1115         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1116             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  23
* EL131.cbl
  1117             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1118             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1119             88  ACCNT-CNTL                  VALUE '3'.
  1120             88  CARR-ACCNT-CNTL             VALUE '4'.
  1121
  1122         16  PI-PROCESSOR-CAP-LIST.
  1123             20  PI-SYSTEM-CONTROLS.
  1124                24 PI-SYSTEM-DISPLAY     PIC X.
  1125                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1126                24 PI-SYSTEM-MODIFY      PIC X.
  1127                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1128             20  FILLER                  PIC XX.
  1129             20  PI-DISPLAY-CAP          PIC X.
  1130                 88  DISPLAY-CAP             VALUE 'Y'.
  1131             20  PI-MODIFY-CAP           PIC X.
  1132                 88  MODIFY-CAP              VALUE 'Y'.
  1133             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1134                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1135             20  PI-FORCE-CAP            PIC X.
  1136                 88  FORCE-CAP               VALUE 'Y'.
  1137
  1138         16  PI-PROGRAM-CONTROLS.
  1139             20  PI-PGM-PRINT-OPT        PIC X.
  1140             20  PI-PGM-FORMAT-OPT       PIC X.
  1141             20  PI-PGM-PROCESS-OPT      PIC X.
  1142             20  PI-PGM-TOTALS-OPT       PIC X.
  1143
  1144         16  PI-HELP-INTERFACE.
  1145             20  PI-LAST-ERROR-NO        PIC X(4).
  1146             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1147
  1148         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1149             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1150
  1151         16  PI-CR-CONTROL-IN-PROGRESS.
  1152             20  PI-CR-CARRIER           PIC X.
  1153             20  PI-CR-GROUPING          PIC X(6).
  1154             20  PI-CR-STATE             PIC XX.
  1155             20  PI-CR-ACCOUNT           PIC X(10).
  1156             20  PI-CR-FIN-RESP          PIC X(10).
  1157             20  PI-CR-TYPE              PIC X.
  1158
  1159         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1160
  1161         16  PI-CR-MONTH-END-DT          PIC XX.
  1162
  1163         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1164             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1165             88  PI-ZERO-CARRIER             VALUE '1'.
  1166             88  PI-ZERO-GROUPING            VALUE '2'.
  1167             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1168
  1169         16  PI-CARRIER-SECURITY         PIC X.
  1170             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1171
  1172         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1173             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1174             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  24
* EL131.cbl
  1175
  1176         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1177             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1178                                         INDEXED BY PI-ACCESS-NDX
  1179                                         PIC X.
  1180
  1181         16  PI-GA-BILLING-CONTROL       PIC X.
  1182             88  PI-GA-BILLING               VALUE '1'.
  1183
  1184         16  PI-MAIL-PROCESSING          PIC X.
  1185             88  PI-MAIL-YES                 VALUE 'Y'.
  1186
  1187         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1188
  1189         16  PI-AR-SYSTEM.
  1190             20  PI-AR-PROCESSING-CNTL   PIC X.
  1191                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1192             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1193             20  PI-AR-MONTH-END-DT      PIC XX.
  1194
  1195         16  PI-MP-SYSTEM.
  1196             20  PI-MORTGAGE-USER            PIC X.
  1197                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1198                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1199             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1200                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1201                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1202                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1203                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1204                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1205             20  PI-MP-MONTH-END-DT          PIC XX.
  1206             20  PI-MP-REFERENCE-NO.
  1207                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1208                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1209
  1210         16  PI-LABEL-CONTROL            PIC X(01).
  1211             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1212             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1213
  1214         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1215             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1216
  1217         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1218             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1219             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1220
  1221         16  FILLER                      PIC X(14).
  1222
  1223     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1224******************************************************************
  1225     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1226         16  PI-NO-PMTS                    PIC 9(4).
  1227         16  PI-CERT-SWITCH                PIC X.
  1228             88  CREATED-CERT              VALUE '2'.
  1229         16  PI-PREM-TYPE                  PIC X.
  1230         16  PI-SAVE-CERT-NO.
  1231             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1232             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  25
* EL131.cbl
  1233         16  FILLER                        PIC X(46).
  1234         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1235         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1236         16  PI-REC-FOUND-SW               PIC X.
  1237         16  PI-LETTER-SW                  PIC X.
  1238         16  PI-PREV-TRLR-KEY              PIC X(22).
  1239         16  pi-claim-type                 pic x.
  1240         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1241         16  pi-approval-level             pic x.
  1242         16  FILLER                        PIC X(543).
  1243
  1244 01  SAVE-RECORD                 PIC X(450).
  1245
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  26
* EL131.cbl
  1247*                                COPY ELCLOGOF SUPPRESS.
  1248******************************************************************
  1249*                                                                *
  1250*                                                                *
  1251*                            ELCLOGOF.                           *
  1252*                            VMOD=2.001                          *
  1253*                                                                *
  1254*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1255*                                                                *
  1256******************************************************************
  1257 01  CLASIC-LOGOFF.
  1258     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1259     12  LOGOFF-TEXT.
  1260         16  FILLER          PIC X(5)    VALUE SPACES.
  1261         16  LOGOFF-MSG.
  1262             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1263             20  FILLER      PIC X       VALUE SPACES.
  1264             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1265         16  FILLER          PIC X(80)
  1266           VALUE '* YOU ARE NOW LOGGED OFF'.
  1267         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1268         16  FILLER          PIC X       VALUE QUOTE.
  1269         16  LOGOFF-SYS-MSG  PIC X(17)
  1270           VALUE 'S CLAS-IC SYSTEM '.
  1271     12  TEXT-MESSAGES.
  1272         16  UNACCESS-MSG    PIC X(29)
  1273             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1274         16  PGMIDERR-MSG    PIC X(17)
  1275             VALUE 'PROGRAM NOT FOUND'.
  1276
  1277*                                COPY ELCATTR SUPPRESS.
  1278******************************************************************
  1279*                                                                *
  1280*                            ELCATTR.                            *
  1281*                            VMOD=2.001                          *
  1282*                                                                *
  1283*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1284*                                                                *
  1285*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1286*                                                                *
  1287*                   POS 1   P=PROTECTED                          *
  1288*                           U=UNPROTECTED                        *
  1289*                           S=ASKIP                              *
  1290*                   POS 2   A=ALPHA/NUMERIC                      *
  1291*                           N=NUMERIC                            *
  1292*                   POS 3   N=NORMAL                             *
  1293*                           B=BRIGHT                             *
  1294*                           D=DARK                               *
  1295*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1296*                           OF=MODIFIED DATA TAG OFF             *
  1297*                                                                *
  1298*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1299******************************************************************
  1300 01  ATTRIBUTE-LIST.
  1301     12  AL-PABOF            PIC X       VALUE 'Y'.
  1302     12  AL-PABON            PIC X       VALUE 'Z'.
  1303     12  AL-PADOF            PIC X       VALUE '%'.
  1304     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  27
* EL131.cbl
  1305     12  AL-PANOF            PIC X       VALUE '-'.
  1306     12  AL-PANON            PIC X       VALUE '/'.
  1307     12  AL-SABOF            PIC X       VALUE '8'.
  1308     12  AL-SABON            PIC X       VALUE '9'.
  1309     12  AL-SADOF            PIC X       VALUE '@'.
  1310     12  AL-SADON            PIC X       VALUE QUOTE.
  1311     12  AL-SANOF            PIC X       VALUE '0'.
  1312     12  AL-SANON            PIC X       VALUE '1'.
  1313     12  AL-UABOF            PIC X       VALUE 'H'.
  1314     12  AL-UABON            PIC X       VALUE 'I'.
  1315     12  AL-UADOF            PIC X       VALUE '<'.
  1316     12  AL-UADON            PIC X       VALUE '('.
  1317     12  AL-UANOF            PIC X       VALUE ' '.
  1318     12  AL-UANON            PIC X       VALUE 'A'.
  1319     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1320     12  AL-UNBON            PIC X       VALUE 'R'.
  1321     12  AL-UNDOF            PIC X       VALUE '*'.
  1322     12  AL-UNDON            PIC X       VALUE ')'.
  1323     12  AL-UNNOF            PIC X       VALUE '&'.
  1324     12  AL-UNNON            PIC X       VALUE 'J'.
  1325
  1326*                                COPY ELCAID SUPPRESS.
  1327******************************************************************
  1328*                                                                *
  1329*                            ELCAID.                             *
  1330*                            VMOD=2.001                          *
  1331*                                                                *
  1332*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1333*                                                                *
  1334*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1335*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1336******************************************************************
  1337
  1338 01  DFHAID.
  1339   02  DFHNULL   PIC  X  VALUE  ' '.
  1340   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1341   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1342   02  DFHPEN    PIC  X  VALUE  '='.
  1343   02  DFHOPID   PIC  X  VALUE  'W'.
  1344   02  DFHPA1    PIC  X  VALUE  '%'.
  1345   02  DFHPA2    PIC  X  VALUE  '>'.
  1346   02  DFHPA3    PIC  X  VALUE  ','.
  1347   02  DFHPF1    PIC  X  VALUE  '1'.
  1348   02  DFHPF2    PIC  X  VALUE  '2'.
  1349   02  DFHPF3    PIC  X  VALUE  '3'.
  1350   02  DFHPF4    PIC  X  VALUE  '4'.
  1351   02  DFHPF5    PIC  X  VALUE  '5'.
  1352   02  DFHPF6    PIC  X  VALUE  '6'.
  1353   02  DFHPF7    PIC  X  VALUE  '7'.
  1354   02  DFHPF8    PIC  X  VALUE  '8'.
  1355   02  DFHPF9    PIC  X  VALUE  '9'.
  1356   02  DFHPF10   PIC  X  VALUE  ':'.
  1357   02  DFHPF11   PIC  X  VALUE  '#'.
  1358   02  DFHPF12   PIC  X  VALUE  '@'.
  1359   02  DFHPF13   PIC  X  VALUE  'A'.
  1360   02  DFHPF14   PIC  X  VALUE  'B'.
  1361   02  DFHPF15   PIC  X  VALUE  'C'.
  1362   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  28
* EL131.cbl
  1363   02  DFHPF17   PIC  X  VALUE  'E'.
  1364   02  DFHPF18   PIC  X  VALUE  'F'.
  1365   02  DFHPF19   PIC  X  VALUE  'G'.
  1366   02  DFHPF20   PIC  X  VALUE  'H'.
  1367   02  DFHPF21   PIC  X  VALUE  'I'.
  1368*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1369   02  DFHPF22   PIC  X  VALUE  '['.
  1370   02  DFHPF23   PIC  X  VALUE  '.'.
  1371   02  DFHPF24   PIC  X  VALUE  '<'.
  1372   02  DFHMSRE   PIC  X  VALUE  'X'.
  1373   02  DFHSTRF   PIC  X  VALUE  'h'.
  1374   02  DFHTRIG   PIC  X  VALUE  '"'.
  1375 01  FILLER REDEFINES DFHAID.
  1376     12  FILLER                  PIC X(8).
  1377     12  AID-KEYS OCCURS 24 TIMES.
  1378         16  FILLER              PIC X.
  1379
  1380*                                COPY EL131S.
  1381 01  EL131AI.
  1382     05  FILLER            PIC  X(0012).
  1383*    -------------------------------
  1384     05  DATEL PIC S9(0004) COMP.
  1385     05  DATEF PIC  X(0001).
  1386     05  FILLER REDEFINES DATEF.
  1387         10  DATEA PIC  X(0001).
  1388     05  DATEI PIC  X(0008).
  1389*    -------------------------------
  1390     05  TIMEL PIC S9(0004) COMP.
  1391     05  TIMEF PIC  X(0001).
  1392     05  FILLER REDEFINES TIMEF.
  1393         10  TIMEA PIC  X(0001).
  1394     05  TIMEI PIC  X(0005).
  1395*    -------------------------------
  1396     05  SEQUL PIC S9(0004) COMP.
  1397     05  SEQUF PIC  X(0001).
  1398     05  FILLER REDEFINES SEQUF.
  1399         10  SEQUA PIC  X(0001).
  1400     05  SEQUI PIC  X(0010).
  1401*    -------------------------------
  1402     05  COMPL PIC S9(0004) COMP.
  1403     05  COMPF PIC  X(0001).
  1404     05  FILLER REDEFINES COMPF.
  1405         10  COMPA PIC  X(0001).
  1406     05  COMPI PIC  X(0003).
  1407*    -------------------------------
  1408     05  USERIDL PIC S9(0004) COMP.
  1409     05  USERIDF PIC  X(0001).
  1410     05  FILLER REDEFINES USERIDF.
  1411         10  USERIDA PIC  X(0001).
  1412     05  USERIDI PIC  X(0004).
  1413*    -------------------------------
  1414     05  LABEL1L PIC S9(0004) COMP.
  1415     05  LABEL1F PIC  X(0001).
  1416     05  FILLER REDEFINES LABEL1F.
  1417         10  LABEL1A PIC  X(0001).
  1418     05  LABEL1I PIC  X(0011).
  1419*    -------------------------------
  1420     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  29
* EL131.cbl
  1421     05  PCERTNOF PIC  X(0001).
  1422     05  FILLER REDEFINES PCERTNOF.
  1423         10  PCERTNOA PIC  X(0001).
  1424     05  PCERTNOI PIC  X(0010).
  1425*    -------------------------------
  1426     05  PSUFXL PIC S9(0004) COMP.
  1427     05  PSUFXF PIC  X(0001).
  1428     05  FILLER REDEFINES PSUFXF.
  1429         10  PSUFXA PIC  X(0001).
  1430     05  PSUFXI PIC  X(0001).
  1431*    -------------------------------
  1432     05  CCNOL PIC S9(0004) COMP.
  1433     05  CCNOF PIC  X(0001).
  1434     05  FILLER REDEFINES CCNOF.
  1435         10  CCNOA PIC  X(0001).
  1436     05  CCNOI PIC  X(0016).
  1437*    -------------------------------
  1438     05  MAINTL PIC S9(0004) COMP.
  1439     05  MAINTF PIC  X(0001).
  1440     05  FILLER REDEFINES MAINTF.
  1441         10  MAINTA PIC  X(0001).
  1442     05  MAINTI PIC  X(0001).
  1443*    -------------------------------
  1444     05  CLAIML PIC S9(0004) COMP.
  1445     05  CLAIMF PIC  X(0001).
  1446     05  FILLER REDEFINES CLAIMF.
  1447         10  CLAIMA PIC  X(0001).
  1448     05  CLAIMI PIC  X(0007).
  1449*    -------------------------------
  1450     05  CARRL PIC S9(0004) COMP.
  1451     05  CARRF PIC  X(0001).
  1452     05  FILLER REDEFINES CARRF.
  1453         10  CARRA PIC  X(0001).
  1454     05  CARRI PIC  X(0001).
  1455*    -------------------------------
  1456     05  CERTL PIC S9(0004) COMP.
  1457     05  CERTF PIC  X(0001).
  1458     05  FILLER REDEFINES CERTF.
  1459         10  CERTA PIC  X(0001).
  1460     05  CERTI PIC  X(0010).
  1461*    -------------------------------
  1462     05  SUFXL PIC S9(0004) COMP.
  1463     05  SUFXF PIC  X(0001).
  1464     05  FILLER REDEFINES SUFXF.
  1465         10  SUFXA PIC  X(0001).
  1466     05  SUFXI PIC  X(0001).
  1467*    -------------------------------
  1468     05  TYPEL PIC S9(0004) COMP.
  1469     05  TYPEF PIC  X(0001).
  1470     05  FILLER REDEFINES TYPEF.
  1471         10  TYPEA PIC  X(0001).
  1472     05  TYPEI PIC  X(0001).
  1473*    -------------------------------
  1474     05  BENPERL PIC S9(0004) COMP.
  1475     05  BENPERF PIC  X(0001).
  1476     05  FILLER REDEFINES BENPERF.
  1477         10  BENPERA PIC  X(0001).
  1478     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  30
* EL131.cbl
  1479*    -------------------------------
  1480     05  INSTYPEL PIC S9(0004) COMP.
  1481     05  INSTYPEF PIC  X(0001).
  1482     05  FILLER REDEFINES INSTYPEF.
  1483         10  INSTYPEA PIC  X(0001).
  1484     05  INSTYPEI PIC  X(0001).
  1485*    -------------------------------
  1486     05  STATUSL PIC S9(0004) COMP.
  1487     05  STATUSF PIC  X(0001).
  1488     05  FILLER REDEFINES STATUSF.
  1489         10  STATUSA PIC  X(0001).
  1490     05  STATUSI PIC  X(0006).
  1491*    -------------------------------
  1492     05  INCL PIC S9(0004) COMP.
  1493     05  INCF PIC  X(0001).
  1494     05  FILLER REDEFINES INCF.
  1495         10  INCA PIC  X(0001).
  1496     05  INCI PIC  X(0008).
  1497*    -------------------------------
  1498     05  REPL PIC S9(0004) COMP.
  1499     05  REPF PIC  X(0001).
  1500     05  FILLER REDEFINES REPF.
  1501         10  REPA PIC  X(0001).
  1502     05  REPI PIC  X(0008).
  1503*    -------------------------------
  1504     05  ICD1L PIC S9(0004) COMP.
  1505     05  ICD1F PIC  X(0001).
  1506     05  FILLER REDEFINES ICD1F.
  1507         10  ICD1A PIC  X(0001).
  1508     05  ICD1I PIC  X(0008).
  1509*    -------------------------------
  1510     05  ICD2L PIC S9(0004) COMP.
  1511     05  ICD2F PIC  X(0001).
  1512     05  FILLER REDEFINES ICD2F.
  1513         10  ICD2A PIC  X(0001).
  1514     05  ICD2I PIC  X(0008).
  1515*    -------------------------------
  1516     05  DIAGL PIC S9(0004) COMP.
  1517     05  DIAGF PIC  X(0001).
  1518     05  FILLER REDEFINES DIAGF.
  1519         10  DIAGA PIC  X(0001).
  1520     05  DIAGI PIC  X(0060).
  1521*    -------------------------------
  1522     05  ACCSWL PIC S9(0004) COMP.
  1523     05  ACCSWF PIC  X(0001).
  1524     05  FILLER REDEFINES ACCSWF.
  1525         10  ACCSWA PIC  X(0001).
  1526     05  ACCSWI PIC  X(0001).
  1527*    -------------------------------
  1528     05  BENEL PIC S9(0004) COMP.
  1529     05  BENEF PIC  X(0001).
  1530     05  FILLER REDEFINES BENEF.
  1531         10  BENEA PIC  X(0001).
  1532     05  BENEI PIC  X(0010).
  1533*    -------------------------------
  1534     05  BIRTHL PIC S9(0004) COMP.
  1535     05  BIRTHF PIC  X(0001).
  1536     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  31
* EL131.cbl
  1537         10  BIRTHA PIC  X(0001).
  1538     05  BIRTHI PIC  X(0008).
  1539*    -------------------------------
  1540     05  SOCIALL PIC S9(0004) COMP.
  1541     05  SOCIALF PIC  X(0001).
  1542     05  FILLER REDEFINES SOCIALF.
  1543         10  SOCIALA PIC  X(0001).
  1544     05  SOCIALI PIC  X(0011).
  1545*    -------------------------------
  1546     05  SEXL PIC S9(0004) COMP.
  1547     05  SEXF PIC  X(0001).
  1548     05  FILLER REDEFINES SEXF.
  1549         10  SEXA PIC  X(0001).
  1550     05  SEXI PIC  X(0001).
  1551*    -------------------------------
  1552     05  MLNAMEL PIC S9(0004) COMP.
  1553     05  MLNAMEF PIC  X(0001).
  1554     05  FILLER REDEFINES MLNAMEF.
  1555         10  MLNAMEA PIC  X(0001).
  1556     05  MLNAMEI PIC  X(0015).
  1557*    -------------------------------
  1558     05  MFNAMEL PIC S9(0004) COMP.
  1559     05  MFNAMEF PIC  X(0001).
  1560     05  FILLER REDEFINES MFNAMEF.
  1561         10  MFNAMEA PIC  X(0001).
  1562     05  MFNAMEI PIC  X(0012).
  1563*    -------------------------------
  1564     05  MMINITL PIC S9(0004) COMP.
  1565     05  MMINITF PIC  X(0001).
  1566     05  FILLER REDEFINES MMINITF.
  1567         10  MMINITA PIC  X(0001).
  1568     05  MMINITI PIC  X(0001).
  1569*    -------------------------------
  1570     05  AUTHRCVL PIC S9(0004) COMP.
  1571     05  AUTHRCVF PIC  X(0001).
  1572     05  FILLER REDEFINES AUTHRCVF.
  1573         10  AUTHRCVA PIC  X(0001).
  1574     05  AUTHRCVI PIC  X(0001).
  1575*    -------------------------------
  1576     05  CRTLNMEL PIC S9(0004) COMP.
  1577     05  CRTLNMEF PIC  X(0001).
  1578     05  FILLER REDEFINES CRTLNMEF.
  1579         10  CRTLNMEA PIC  X(0001).
  1580     05  CRTLNMEI PIC  X(0015).
  1581*    -------------------------------
  1582     05  CRTFNMEL PIC S9(0004) COMP.
  1583     05  CRTFNMEF PIC  X(0001).
  1584     05  FILLER REDEFINES CRTFNMEF.
  1585         10  CRTFNMEA PIC  X(0001).
  1586     05  CRTFNMEI PIC  X(0012).
  1587*    -------------------------------
  1588     05  CRTINITL PIC S9(0004) COMP.
  1589     05  CRTINITF PIC  X(0001).
  1590     05  FILLER REDEFINES CRTINITF.
  1591         10  CRTINITA PIC  X(0001).
  1592     05  CRTINITI PIC  X(0001).
  1593*    -------------------------------
  1594     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  32
* EL131.cbl
  1595     05  LOANBALF PIC  X(0001).
  1596     05  FILLER REDEFINES LOANBALF.
  1597         10  LOANBALA PIC  X(0001).
  1598     05  LOANBALI PIC  9(7)V99.
  1599*    -------------------------------
  1600     05  PROCL PIC S9(0004) COMP.
  1601     05  PROCF PIC  X(0001).
  1602     05  FILLER REDEFINES PROCF.
  1603         10  PROCA PIC  X(0001).
  1604     05  PROCI PIC  X(0004).
  1605*    -------------------------------
  1606     05  SUPVL PIC S9(0004) COMP.
  1607     05  SUPVF PIC  X(0001).
  1608     05  FILLER REDEFINES SUPVF.
  1609         10  SUPVA PIC  X(0001).
  1610     05  SUPVI PIC  X(0001).
  1611*    -------------------------------
  1612     05  PRICDL PIC S9(0004) COMP.
  1613     05  PRICDF PIC  X(0001).
  1614     05  FILLER REDEFINES PRICDF.
  1615         10  PRICDA PIC  X(0001).
  1616     05  PRICDI PIC  X(0001).
  1617*    -------------------------------
  1618     05  CRITPL PIC S9(0004) COMP.
  1619     05  CRITPF PIC  X(0001).
  1620     05  FILLER REDEFINES CRITPF.
  1621         10  CRITPA PIC  X(0001).
  1622     05  CRITPI PIC  X(0002).
  1623*    -------------------------------
  1624     05  EXTENSL PIC S9(0004) COMP.
  1625     05  EXTENSF PIC  X(0001).
  1626     05  FILLER REDEFINES EXTENSF.
  1627         10  EXTENSA PIC  X(0001).
  1628     05  EXTENSI PIC  99.
  1629*    -------------------------------
  1630     05  FILETOL PIC S9(0004) COMP.
  1631     05  FILETOF PIC  X(0001).
  1632     05  FILLER REDEFINES FILETOF.
  1633         10  FILETOA PIC  X(0001).
  1634     05  FILETOI PIC  X(0004).
  1635*    -------------------------------
  1636     05  PTHRHDGL PIC S9(0004) COMP.
  1637     05  PTHRHDGF PIC  X(0001).
  1638     05  FILLER REDEFINES PTHRHDGF.
  1639         10  PTHRHDGA PIC  X(0001).
  1640     05  PTHRHDGI PIC  X(0010).
  1641*    -------------------------------
  1642     05  PDTHRUL PIC S9(0004) COMP.
  1643     05  PDTHRUF PIC  X(0001).
  1644     05  FILLER REDEFINES PDTHRUF.
  1645         10  PDTHRUA PIC  X(0001).
  1646     05  PDTHRUI PIC  X(0008).
  1647*    -------------------------------
  1648     05  PDAMTL PIC S9(0004) COMP.
  1649     05  PDAMTF PIC  X(0001).
  1650     05  FILLER REDEFINES PDAMTF.
  1651         10  PDAMTA PIC  X(0001).
  1652     05  PDAMTI PIC  9(7)V99.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  33
* EL131.cbl
  1653*    -------------------------------
  1654     05  NODAYSL PIC S9(0004) COMP.
  1655     05  NODAYSF PIC  X(0001).
  1656     05  FILLER REDEFINES NODAYSF.
  1657         10  NODAYSA PIC  X(0001).
  1658     05  NODAYSI PIC  9(5).
  1659*    -------------------------------
  1660     05  NOPMTSL PIC S9(0004) COMP.
  1661     05  NOPMTSF PIC  X(0001).
  1662     05  FILLER REDEFINES NOPMTSF.
  1663         10  NOPMTSA PIC  X(0001).
  1664     05  NOPMTSI PIC  9(4).
  1665*    -------------------------------
  1666     05  FORMTYPL PIC S9(0004) COMP.
  1667     05  FORMTYPF PIC  X(0001).
  1668     05  FILLER REDEFINES FORMTYPF.
  1669         10  FORMTYPA PIC  X(0001).
  1670     05  FORMTYPI PIC  X(0001).
  1671*    -------------------------------
  1672     05  ESTL PIC S9(0004) COMP.
  1673     05  ESTF PIC  X(0001).
  1674     05  FILLER REDEFINES ESTF.
  1675         10  ESTA PIC  X(0001).
  1676     05  ESTI PIC  X(0008).
  1677*    -------------------------------
  1678     05  AUIDL PIC S9(0004) COMP.
  1679     05  AUIDF PIC  X(0001).
  1680     05  FILLER REDEFINES AUIDF.
  1681         10  AUIDA PIC  X(0001).
  1682     05  AUIDI PIC  X(0004).
  1683*    -------------------------------
  1684     05  OCCL PIC S9(0004) COMP.
  1685     05  OCCF PIC  X(0001).
  1686     05  FILLER REDEFINES OCCF.
  1687         10  OCCA PIC  X(0001).
  1688     05  OCCI PIC  X(0006).
  1689*    -------------------------------
  1690     05  MNTDTL PIC S9(0004) COMP.
  1691     05  MNTDTF PIC  X(0001).
  1692     05  FILLER REDEFINES MNTDTF.
  1693         10  MNTDTA PIC  X(0001).
  1694     05  MNTDTI PIC  X(0008).
  1695*    -------------------------------
  1696     05  MNTTYPEL PIC S9(0004) COMP.
  1697     05  MNTTYPEF PIC  X(0001).
  1698     05  FILLER REDEFINES MNTTYPEF.
  1699         10  MNTTYPEA PIC  X(0001).
  1700     05  MNTTYPEI PIC  X(0006).
  1701*    -------------------------------
  1702     05  CERTCARL PIC S9(0004) COMP.
  1703     05  CERTCARF PIC  X(0001).
  1704     05  FILLER REDEFINES CERTCARF.
  1705         10  CERTCARA PIC  X(0001).
  1706     05  CERTCARI PIC  X(0001).
  1707*    -------------------------------
  1708     05  CERTGRPL PIC S9(0004) COMP.
  1709     05  CERTGRPF PIC  X(0001).
  1710     05  FILLER REDEFINES CERTGRPF.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  34
* EL131.cbl
  1711         10  CERTGRPA PIC  X(0001).
  1712     05  CERTGRPI PIC  X(0006).
  1713*    -------------------------------
  1714     05  CERTSTL PIC S9(0004) COMP.
  1715     05  CERTSTF PIC  X(0001).
  1716     05  FILLER REDEFINES CERTSTF.
  1717         10  CERTSTA PIC  X(0001).
  1718     05  CERTSTI PIC  X(0002).
  1719*    -------------------------------
  1720     05  CERTACTL PIC S9(0004) COMP.
  1721     05  CERTACTF PIC  X(0001).
  1722     05  FILLER REDEFINES CERTACTF.
  1723         10  CERTACTA PIC  X(0001).
  1724     05  CERTACTI PIC  X(0010).
  1725*    -------------------------------
  1726     05  CERTEFFL PIC S9(0004) COMP.
  1727     05  CERTEFFF PIC  X(0001).
  1728     05  FILLER REDEFINES CERTEFFF.
  1729         10  CERTEFFA PIC  X(0001).
  1730     05  CERTEFFI PIC  X(0008).
  1731*    -------------------------------
  1732     05  ISSAGEL PIC S9(0004) COMP.
  1733     05  ISSAGEF PIC  X(0001).
  1734     05  FILLER REDEFINES ISSAGEF.
  1735         10  ISSAGEA PIC  X(0001).
  1736     05  ISSAGEI PIC  X(0002).
  1737*    -------------------------------
  1738     05  APRL PIC S9(0004) COMP.
  1739     05  APRF PIC  X(0001).
  1740     05  FILLER REDEFINES APRF.
  1741         10  APRA PIC  X(0001).
  1742     05  APRI PIC  9(4)V9(4).
  1743*    -------------------------------
  1744     05  PMTFREQL PIC S9(0004) COMP.
  1745     05  PMTFREQF PIC  X(0001).
  1746     05  FILLER REDEFINES PMTFREQF.
  1747         10  PMTFREQA PIC  X(0001).
  1748     05  PMTFREQI PIC  99.
  1749*    -------------------------------
  1750     05  INDGRPL PIC S9(0004) COMP.
  1751     05  INDGRPF PIC  X(0001).
  1752     05  FILLER REDEFINES INDGRPF.
  1753         10  INDGRPA PIC  X(0001).
  1754     05  INDGRPI PIC  X(0001).
  1755*    -------------------------------
  1756     05  PREMTYPL PIC S9(0004) COMP.
  1757     05  PREMTYPF PIC  X(0001).
  1758     05  FILLER REDEFINES PREMTYPF.
  1759         10  PREMTYPA PIC  X(0001).
  1760     05  PREMTYPI PIC  X(0001).
  1761*    -------------------------------
  1762     05  REINCDL PIC S9(0004) COMP.
  1763     05  REINCDF PIC  X(0001).
  1764     05  FILLER REDEFINES REINCDF.
  1765         10  REINCDA PIC  X(0001).
  1766     05  REINCDI PIC  X(0001).
  1767*    -------------------------------
  1768     05  JNTLNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  35
* EL131.cbl
  1769     05  JNTLNMEF PIC  X(0001).
  1770     05  FILLER REDEFINES JNTLNMEF.
  1771         10  JNTLNMEA PIC  X(0001).
  1772     05  JNTLNMEI PIC  X(0015).
  1773*    -------------------------------
  1774     05  JNTFNMEL PIC S9(0004) COMP.
  1775     05  JNTFNMEF PIC  X(0001).
  1776     05  FILLER REDEFINES JNTFNMEF.
  1777         10  JNTFNMEA PIC  X(0001).
  1778     05  JNTFNMEI PIC  X(0012).
  1779*    -------------------------------
  1780     05  JNTINITL PIC S9(0004) COMP.
  1781     05  JNTINITF PIC  X(0001).
  1782     05  FILLER REDEFINES JNTINITF.
  1783         10  JNTINITA PIC  X(0001).
  1784     05  JNTINITI PIC  X(0001).
  1785*    -------------------------------
  1786     05  JNTAGEL PIC S9(0004) COMP.
  1787     05  JNTAGEF PIC  X(0001).
  1788     05  FILLER REDEFINES JNTAGEF.
  1789         10  JNTAGEA PIC  X(0001).
  1790     05  JNTAGEI PIC  X(0002).
  1791*    -------------------------------
  1792     05  ADDONDTL PIC S9(0004) COMP.
  1793     05  ADDONDTF PIC  X(0001).
  1794     05  FILLER REDEFINES ADDONDTF.
  1795         10  ADDONDTA PIC  X(0001).
  1796     05  ADDONDTI PIC  X(0008).
  1797*    -------------------------------
  1798     05  LCVDSCRL PIC S9(0004) COMP.
  1799     05  LCVDSCRF PIC  X(0001).
  1800     05  FILLER REDEFINES LCVDSCRF.
  1801         10  LCVDSCRA PIC  X(0001).
  1802     05  LCVDSCRI PIC  X(0006).
  1803*    -------------------------------
  1804     05  LCVKINDL PIC S9(0004) COMP.
  1805     05  LCVKINDF PIC  X(0001).
  1806     05  FILLER REDEFINES LCVKINDF.
  1807         10  LCVKINDA PIC  X(0001).
  1808     05  LCVKINDI PIC  X(0003).
  1809*    -------------------------------
  1810     05  LCVCDL PIC S9(0004) COMP.
  1811     05  LCVCDF PIC  X(0001).
  1812     05  FILLER REDEFINES LCVCDF.
  1813         10  LCVCDA PIC  X(0001).
  1814     05  LCVCDI PIC  X(0002).
  1815*    -------------------------------
  1816     05  LCVOTRML PIC S9(0004) COMP.
  1817     05  LCVOTRMF PIC  X(0001).
  1818     05  FILLER REDEFINES LCVOTRMF.
  1819         10  LCVOTRMA PIC  X(0001).
  1820     05  LCVOTRMI PIC  999.
  1821*    -------------------------------
  1822     05  LCVRTRML PIC S9(0004) COMP.
  1823     05  LCVRTRMF PIC  X(0001).
  1824     05  FILLER REDEFINES LCVRTRMF.
  1825         10  LCVRTRMA PIC  X(0001).
  1826     05  LCVRTRMI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  36
* EL131.cbl
  1827*    -------------------------------
  1828     05  LCVRATEL PIC S9(0004) COMP.
  1829     05  LCVRATEF PIC  X(0001).
  1830     05  FILLER REDEFINES LCVRATEF.
  1831         10  LCVRATEA PIC  X(0001).
  1832     05  LCVRATEI PIC  9999V99.
  1833*    -------------------------------
  1834     05  LCVBENEL PIC S9(0004) COMP.
  1835     05  LCVBENEF PIC  X(0001).
  1836     05  FILLER REDEFINES LCVBENEF.
  1837         10  LCVBENEA PIC  X(0001).
  1838     05  LCVBENEI PIC  9(9)V99.
  1839*    -------------------------------
  1840     05  LCVFORML PIC S9(0004) COMP.
  1841     05  LCVFORMF PIC  X(0001).
  1842     05  FILLER REDEFINES LCVFORMF.
  1843         10  LCVFORMA PIC  X(0001).
  1844     05  LCVFORMI PIC  X(0012).
  1845*    -------------------------------
  1846     05  LCVCNDTL PIC S9(0004) COMP.
  1847     05  LCVCNDTF PIC  X(0001).
  1848     05  FILLER REDEFINES LCVCNDTF.
  1849         10  LCVCNDTA PIC  X(0001).
  1850     05  LCVCNDTI PIC  X(0008).
  1851*    -------------------------------
  1852     05  LCVEXITL PIC S9(0004) COMP.
  1853     05  LCVEXITF PIC  X(0001).
  1854     05  FILLER REDEFINES LCVEXITF.
  1855         10  LCVEXITA PIC  X(0001).
  1856     05  LCVEXITI PIC  X(0008).
  1857*    -------------------------------
  1858     05  LCVSTATL PIC S9(0004) COMP.
  1859     05  LCVSTATF PIC  X(0001).
  1860     05  FILLER REDEFINES LCVSTATF.
  1861         10  LCVSTATA PIC  X(0001).
  1862     05  LCVSTATI PIC  X(0006).
  1863*    -------------------------------
  1864     05  ACVDSCRL PIC S9(0004) COMP.
  1865     05  ACVDSCRF PIC  X(0001).
  1866     05  FILLER REDEFINES ACVDSCRF.
  1867         10  ACVDSCRA PIC  X(0001).
  1868     05  ACVDSCRI PIC  X(0006).
  1869*    -------------------------------
  1870     05  ACVKINDL PIC S9(0004) COMP.
  1871     05  ACVKINDF PIC  X(0001).
  1872     05  FILLER REDEFINES ACVKINDF.
  1873         10  ACVKINDA PIC  X(0001).
  1874     05  ACVKINDI PIC  X(0003).
  1875*    -------------------------------
  1876     05  ACVCDL PIC S9(0004) COMP.
  1877     05  ACVCDF PIC  X(0001).
  1878     05  FILLER REDEFINES ACVCDF.
  1879         10  ACVCDA PIC  X(0001).
  1880     05  ACVCDI PIC  X(0002).
  1881*    -------------------------------
  1882     05  ACVOTRML PIC S9(0004) COMP.
  1883     05  ACVOTRMF PIC  X(0001).
  1884     05  FILLER REDEFINES ACVOTRMF.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  37
* EL131.cbl
  1885         10  ACVOTRMA PIC  X(0001).
  1886     05  ACVOTRMI PIC  999.
  1887*    -------------------------------
  1888     05  ACVRTRML PIC S9(0004) COMP.
  1889     05  ACVRTRMF PIC  X(0001).
  1890     05  FILLER REDEFINES ACVRTRMF.
  1891         10  ACVRTRMA PIC  X(0001).
  1892     05  ACVRTRMI PIC  X(0003).
  1893*    -------------------------------
  1894     05  ACVRATEL PIC S9(0004) COMP.
  1895     05  ACVRATEF PIC  X(0001).
  1896     05  FILLER REDEFINES ACVRATEF.
  1897         10  ACVRATEA PIC  X(0001).
  1898     05  ACVRATEI PIC  9999V99.
  1899*    -------------------------------
  1900     05  ACVBENEL PIC S9(0004) COMP.
  1901     05  ACVBENEF PIC  X(0001).
  1902     05  FILLER REDEFINES ACVBENEF.
  1903         10  ACVBENEA PIC  X(0001).
  1904     05  ACVBENEI PIC  9(9)V99.
  1905*    -------------------------------
  1906     05  ACVFORML PIC S9(0004) COMP.
  1907     05  ACVFORMF PIC  X(0001).
  1908     05  FILLER REDEFINES ACVFORMF.
  1909         10  ACVFORMA PIC  X(0001).
  1910     05  ACVFORMI PIC  X(0012).
  1911*    -------------------------------
  1912     05  ACVCNDTL PIC S9(0004) COMP.
  1913     05  ACVCNDTF PIC  X(0001).
  1914     05  FILLER REDEFINES ACVCNDTF.
  1915         10  ACVCNDTA PIC  X(0001).
  1916     05  ACVCNDTI PIC  X(0008).
  1917*    -------------------------------
  1918     05  ACVEXITL PIC S9(0004) COMP.
  1919     05  ACVEXITF PIC  X(0001).
  1920     05  FILLER REDEFINES ACVEXITF.
  1921         10  ACVEXITA PIC  X(0001).
  1922     05  ACVEXITI PIC  X(0008).
  1923*    -------------------------------
  1924     05  ACVSTATL PIC S9(0004) COMP.
  1925     05  ACVSTATF PIC  X(0001).
  1926     05  FILLER REDEFINES ACVSTATF.
  1927         10  ACVSTATA PIC  X(0001).
  1928     05  ACVSTATI PIC  X(0006).
  1929*    -------------------------------
  1930     05  LABEL2L PIC S9(0004) COMP.
  1931     05  LABEL2F PIC  X(0001).
  1932     05  FILLER REDEFINES LABEL2F.
  1933         10  LABEL2A PIC  X(0001).
  1934     05  LABEL2I PIC  X(0014).
  1935*    -------------------------------
  1936     05  BCERT1L PIC S9(0004) COMP.
  1937     05  BCERT1F PIC  X(0001).
  1938     05  FILLER REDEFINES BCERT1F.
  1939         10  BCERT1A PIC  X(0001).
  1940     05  BCERT1I PIC  X(0010).
  1941*    -------------------------------
  1942     05  BSUFX1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  38
* EL131.cbl
  1943     05  BSUFX1F PIC  X(0001).
  1944     05  FILLER REDEFINES BSUFX1F.
  1945         10  BSUFX1A PIC  X(0001).
  1946     05  BSUFX1I PIC  X(0001).
  1947*    -------------------------------
  1948     05  BCERT2L PIC S9(0004) COMP.
  1949     05  BCERT2F PIC  X(0001).
  1950     05  FILLER REDEFINES BCERT2F.
  1951         10  BCERT2A PIC  X(0001).
  1952     05  BCERT2I PIC  X(0010).
  1953*    -------------------------------
  1954     05  BSUFX2L PIC S9(0004) COMP.
  1955     05  BSUFX2F PIC  X(0001).
  1956     05  FILLER REDEFINES BSUFX2F.
  1957         10  BSUFX2A PIC  X(0001).
  1958     05  BSUFX2I PIC  X(0001).
  1959*    -------------------------------
  1960     05  BCERT3L PIC S9(0004) COMP.
  1961     05  BCERT3F PIC  X(0001).
  1962     05  FILLER REDEFINES BCERT3F.
  1963         10  BCERT3A PIC  X(0001).
  1964     05  BCERT3I PIC  X(0010).
  1965*    -------------------------------
  1966     05  BSUFX3L PIC S9(0004) COMP.
  1967     05  BSUFX3F PIC  X(0001).
  1968     05  FILLER REDEFINES BSUFX3F.
  1969         10  BSUFX3A PIC  X(0001).
  1970     05  BSUFX3I PIC  X(0001).
  1971*    -------------------------------
  1972     05  BCERT4L PIC S9(0004) COMP.
  1973     05  BCERT4F PIC  X(0001).
  1974     05  FILLER REDEFINES BCERT4F.
  1975         10  BCERT4A PIC  X(0001).
  1976     05  BCERT4I PIC  X(0010).
  1977*    -------------------------------
  1978     05  BSUFX4L PIC S9(0004) COMP.
  1979     05  BSUFX4F PIC  X(0001).
  1980     05  FILLER REDEFINES BSUFX4F.
  1981         10  BSUFX4A PIC  X(0001).
  1982     05  BSUFX4I PIC  X(0001).
  1983*    -------------------------------
  1984     05  BCERT5L PIC S9(0004) COMP.
  1985     05  BCERT5F PIC  X(0001).
  1986     05  FILLER REDEFINES BCERT5F.
  1987         10  BCERT5A PIC  X(0001).
  1988     05  BCERT5I PIC  X(0010).
  1989*    -------------------------------
  1990     05  BSUFX5L PIC S9(0004) COMP.
  1991     05  BSUFX5F PIC  X(0001).
  1992     05  FILLER REDEFINES BSUFX5F.
  1993         10  BSUFX5A PIC  X(0001).
  1994     05  BSUFX5I PIC  X(0001).
  1995*    -------------------------------
  1996     05  MSG1L PIC S9(0004) COMP.
  1997     05  MSG1F PIC  X(0001).
  1998     05  FILLER REDEFINES MSG1F.
  1999         10  MSG1A PIC  X(0001).
  2000     05  MSG1I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  39
* EL131.cbl
  2001*    -------------------------------
  2002     05  MSG2L PIC S9(0004) COMP.
  2003     05  MSG2F PIC  X(0001).
  2004     05  FILLER REDEFINES MSG2F.
  2005         10  MSG2A PIC  X(0001).
  2006     05  MSG2I PIC  X(0072).
  2007*    -------------------------------
  2008     05  PFKEYL PIC S9(0004) COMP.
  2009     05  PFKEYF PIC  X(0001).
  2010     05  FILLER REDEFINES PFKEYF.
  2011         10  PFKEYA PIC  X(0001).
  2012     05  PFKEYI PIC  99.
  2013*    -------------------------------
  2014     05  PFKEY6L PIC S9(0004) COMP.
  2015     05  PFKEY6F PIC  X(0001).
  2016     05  FILLER REDEFINES PFKEY6F.
  2017         10  PFKEY6A PIC  X(0001).
  2018     05  PFKEY6I PIC  X(0016).
  2019 01  EL131AO REDEFINES EL131AI.
  2020     05  FILLER            PIC  X(0012).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  DATEO PIC  X(0008).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  TIMEO PIC  99.99.
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  SEQUO PIC  X(0010).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  COMPO PIC  X(0003).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  USERIDO PIC  X(0004).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  LABEL1O PIC  X(0011).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  PCERTNOO PIC  X(0010).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  PSUFXO PIC  X(0001).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  CCNOO PIC  X(0016).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  MAINTO PIC  X(0001).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  CLAIMO PIC  X(0007).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  CARRO PIC  X(0001).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  40
* EL131.cbl
  2059     05  CERTO PIC  X(0010).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  SUFXO PIC  X(0001).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  TYPEO PIC  X(0001).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  BENPERO PIC  X(0002).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  INSTYPEO PIC  X(0001).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  STATUSO PIC  X(0006).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  INCO PIC  X(0008).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  REPO PIC  X(0008).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  ICD1O PIC  X(0008).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  ICD2O PIC  X(0008).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  DIAGO PIC  X(0060).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  ACCSWO PIC  X(0001).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  BENEO PIC  X(0010).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  BIRTHO PIC  X(0008).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  SOCIALO PIC  X(0011).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  SEXO PIC  X(0001).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  MLNAMEO PIC  X(0015).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  MFNAMEO PIC  X(0012).
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  MMINITO PIC  X(0001).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  AUTHRCVO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  41
* EL131.cbl
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  CRTLNMEO PIC  X(0015).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  CRTFNMEO PIC  X(0012).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  CRTINITO PIC  X(0001).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  LOANBALO PIC  ZZZZZ9.99.
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  PROCO PIC  X(0004).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  SUPVO PIC  X(0001).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  PRICDO PIC  X(0001).
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  CRITPO PIC  X(0002).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  EXTENSO PIC  X(0002).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  FILETOO PIC  X(0004).
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  PTHRHDGO PIC  X(0010).
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  PDTHRUO PIC  X(0008).
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  PDAMTO PIC  Z(06).99.
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  NODAYSO PIC  ZZZ99.
  2159*    -------------------------------
  2160     05  FILLER            PIC  X(0003).
  2161     05  NOPMTSO PIC  ZZ99.
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  FORMTYPO PIC  X(0001).
  2165*    -------------------------------
  2166     05  FILLER            PIC  X(0003).
  2167     05  ESTO PIC  X(0008).
  2168*    -------------------------------
  2169     05  FILLER            PIC  X(0003).
  2170     05  AUIDO PIC  X(0004).
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  OCCO PIC  X(0006).
  2174*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  42
* EL131.cbl
  2175     05  FILLER            PIC  X(0003).
  2176     05  MNTDTO PIC  X(0008).
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  MNTTYPEO PIC  X(0006).
  2180*    -------------------------------
  2181     05  FILLER            PIC  X(0003).
  2182     05  CERTCARO PIC  X(0001).
  2183*    -------------------------------
  2184     05  FILLER            PIC  X(0003).
  2185     05  CERTGRPO PIC  X(0006).
  2186*    -------------------------------
  2187     05  FILLER            PIC  X(0003).
  2188     05  CERTSTO PIC  X(0002).
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  CERTACTO PIC  X(0010).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  CERTEFFO PIC  X(0008).
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  ISSAGEO PIC  X(0002).
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  APRO PIC  9(3).9(4).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
  2203     05  PMTFREQO PIC  99.
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
  2206     05  INDGRPO PIC  X(0001).
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
  2209     05  PREMTYPO PIC  X(0001).
  2210*    -------------------------------
  2211     05  FILLER            PIC  X(0003).
  2212     05  REINCDO PIC  X(0001).
  2213*    -------------------------------
  2214     05  FILLER            PIC  X(0003).
  2215     05  JNTLNMEO PIC  X(0015).
  2216*    -------------------------------
  2217     05  FILLER            PIC  X(0003).
  2218     05  JNTFNMEO PIC  X(0012).
  2219*    -------------------------------
  2220     05  FILLER            PIC  X(0003).
  2221     05  JNTINITO PIC  X(0001).
  2222*    -------------------------------
  2223     05  FILLER            PIC  X(0003).
  2224     05  JNTAGEO PIC  X(0002).
  2225*    -------------------------------
  2226     05  FILLER            PIC  X(0003).
  2227     05  ADDONDTO PIC  X(0008).
  2228*    -------------------------------
  2229     05  FILLER            PIC  X(0003).
  2230     05  LCVDSCRO PIC  X(0006).
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  43
* EL131.cbl
  2233     05  LCVKINDO PIC  X(0003).
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  LCVCDO PIC  X(0002).
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  LCVOTRMO PIC  999.
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
  2242     05  LCVRTRMO PIC  999.
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
  2245     05  LCVRATEO PIC  ZZZ.ZZ.
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  LCVFORMO PIC  X(0012).
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  LCVCNDTO PIC  X(0008).
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  LCVEXITO PIC  X(0008).
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  LCVSTATO PIC  X(0006).
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  ACVDSCRO PIC  X(0006).
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  ACVKINDO PIC  X(0003).
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  ACVCDO PIC  X(0002).
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  ACVOTRMO PIC  999.
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  ACVRTRMO PIC  999.
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  ACVRATEO PIC  ZZZ.ZZ.
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  ACVFORMO PIC  X(0012).
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  ACVCNDTO PIC  X(0008).
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  ACVEXITO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  44
* EL131.cbl
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  ACVSTATO PIC  X(0006).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  LABEL2O PIC  X(0014).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  BCERT1O PIC  X(0010).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  BSUFX1O PIC  X(0001).
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  BCERT2O PIC  X(0010).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  BSUFX2O PIC  X(0001).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  BCERT3O PIC  X(0010).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  BSUFX3O PIC  X(0001).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  BCERT4O PIC  X(0010).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  BSUFX4O PIC  X(0001).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  BCERT5O PIC  X(0010).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  BSUFX5O PIC  X(0001).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  MSG1O PIC  X(0072).
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  MSG2O PIC  X(0072).
  2333*    -------------------------------
  2334     05  FILLER            PIC  X(0003).
  2335     05  PFKEYO PIC  X(0002).
  2336*    -------------------------------
  2337     05  FILLER            PIC  X(0003).
  2338     05  PFKEY6O PIC  X(0016).
  2339*    -------------------------------
  2340
  2341*                                COPY ELCEMIB SUPPRESS.
  2342******************************************************************
  2343*                                                                *
  2344*                                                                *
  2345*                            ELCEMIB.                            *
  2346*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2347*                            VMOD=2.005                          *
  2348*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  45
* EL131.cbl
  2349*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2350*                                                                *
  2351******************************************************************
  2352 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2353     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2354     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2355     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2356     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2357     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2358     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2359     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2360     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2361     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2362         88  EMI-NO-ERRORS                    VALUE '1'.
  2363         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2364         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2365     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2366         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2367     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2368         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2369         88  EMI-AREA1-FULL                   VALUE '2'.
  2370     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2371         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2372         88  EMI-AREA2-FULL                   VALUE '2'.
  2373     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2374         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2375         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2376         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2377         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2378         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2379     12  EMI-ERROR-LINES.
  2380         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2381         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2382         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2383         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2384             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2385                 24  EMI-ERR-NUM         PIC X(4).
  2386                 24  EMI-FILLER          PIC X.
  2387                 24  EMI-SEV             PIC X.
  2388                 24  FILLER              PIC X.
  2389             20  FILLER                  PIC X(02).
  2390     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2391         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2392             20  EMI-ERROR-NUMBER    PIC X(4).
  2393             20  EMI-FILL            PIC X.
  2394             20  EMI-SEVERITY        PIC X.
  2395             20  FILLER              PIC X.
  2396             20  EMI-ERROR-TEXT.
  2397                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2398                 24  FILLER          PIC X(55).
  2399     12  EMI-SEVERITY-SAVE           PIC X.
  2400         88  EMI-NOTE                    VALUE 'N'.
  2401         88  EMI-WARNING                 VALUE 'W'.
  2402         88  EMI-FORCABLE                VALUE 'F'.
  2403         88  EMI-FATAL                   VALUE 'X'.
  2404     12  EMI-MESSAGE-FLAG            PIC X.
  2405         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2406         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  46
* EL131.cbl
  2407     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2408     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2409         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2410         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2411         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2412     12  emi-claim-no                pic x(7).
  2413     12  emi-claim-type              pic x(6).
  2414     12  FILLER                      PIC X(124)  VALUE SPACES.
  2415     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2416     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2417     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2418     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2419
  2420*                                COPY ELCJPFX SUPPRESS.
  2421******************************************************************
  2422*                                                                *
  2423*                                                                *
  2424*                            ELCJPFX.                            *
  2425*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2426*                            VMOD=2.002                          *
  2427*                                                                *
  2428*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2429*                                                                *
  2430*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2431*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2432*        ELCNTL - CONTROL FILE                                   *
  2433*        ELMSTR - CLAIM MASTERS                                  *
  2434*        ELTRLR - ACTIVITY TRAILERS                              *
  2435*        ELCHKQ - CHECK QUE                                      *
  2436******************************************************************
  2437 01  JOURNAL-RECORD.
  2438     12  jp-date                     pic s9(5) comp-3.
  2439     12  jp-time                     pic s9(7) comp-3.
  2440     12  JP-USER-ID                  PIC X(4).
  2441     12  JP-FILE-ID                  PIC X(8).
  2442     12  JP-PROGRAM-ID               PIC X(8).
  2443     12  JP-RECORD-TYPE              PIC X.
  2444         88 JP-ADD              VALUE 'A'.
  2445         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2446         88 JP-AFTER-CHANGE     VALUE 'C'.
  2447         88 JP-DELETE           VALUE 'D'.
  2448         88 JP-GENERIC-DELETE   VALUE 'G'.
  2449         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2450         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2451     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2452     12  JP-RECORD-AREA
  2453
  2454
  2455                                 PIC X(750).
  2456
  2457*                                COPY ELCCALC.
  2458******************************************************************
  2459*                                                                *
  2460*                           ELCCALC.                            *
  2461*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2462*                            VMOD=2.025                          *
  2463*                                                                *
  2464*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  47
* EL131.cbl
  2465*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2466*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2467*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2468*                                                                *
  2469*  PASSED TO ELRTRM                                              *
  2470*  -----------------                                             *
  2471*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2472*  ORIGINAL TERM                                                 *
  2473*  BEGINNING DATE                                                *
  2474*  ENDING DATE                                                   *
  2475*  COMPANY I.D.                                                  *
  2476*  ACCOUNT MASTER USER FIELD                                     *
  2477*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2478*  FREE LOOK DAYS                                                *
  2479*                                                                *
  2480*  RETURNED FROM ELRTRM                                          *
  2481*  ---------------------                                         *
  2482*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2483*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2484*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2485*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2486*----------------------------------------------------------------*
  2487*  PASSED TO ELRAMT                                              *
  2488*  ----------------                                              *
  2489*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2490*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2491*  ORIGINAL AMOUNT                                               *
  2492*  ALTERNATE BENEFIT (BALLON)                                    *
  2493*  A.P.R. - NET PAY ONLY                                         *
  2494*  METHOD
  2495*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2496*  COMPANY I.D.                                                  *
  2497*  BENEFIT TYPE                                                  *
  2498*                                                                *
  2499*  RETURNED FROM ELRAMT                                          *
  2500*  --------------------                                          *
  2501*  REMAINING AMOUNT 1 - CURRENT                                  *
  2502*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2503*  REMAINING AMOUNT FACTOR
  2504*----------------------------------------------------------------*
  2505*  PASSED TO ELRESV                                              *
  2506*  -----------------                                             *
  2507*  CERTIFICATE EFFECTIVE DATE                                    *
  2508*  VALUATION DATE                                                *
  2509*  PAID THRU DATE                                                *
  2510*  BENEFIT                                                       *
  2511*  INCURRED DATE                                                 *
  2512*  REPORTED DATE                                                 *
  2513*  ISSUE AGE                                                     *
  2514*  TERM                                                          *
  2515*  CDT PERCENT                                                   *
  2516*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2517* *CLAIM TYPE (LIFE, A/H)                                        *
  2518* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2519* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2520*                                                                *
  2521*  RETURNED FROM ELRESV                                          *
  2522*  --------------------                                          *
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  48
* EL131.cbl
  2523*  CDT TABLE USED                                                *
  2524*  CDT FACTOR USED                                               *
  2525*  PAY TO CURRENT RESERVE                                        *
  2526*  I.B.N.R. - A/H ONLY                                           *
  2527*  FUTURE (ACCRUED) AH ONLY                                      *
  2528*----------------------------------------------------------------*
  2529*  PASSED TO ELRATE                                              *
  2530*  ----------------                                              *
  2531*  CERT ISSUE DATE                                               *
  2532*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2533*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2534*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2535*  STATE CODE (CLIENT DEFINED)                                   *
  2536*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2537*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2538*  DEVIATION CODE                                                *
  2539*  ISSUE AGE                                                     *
  2540*  ORIGINAL BENEFIT AMOUNT                                       *
  2541*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2542*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2543*  BENEFIT KIND (LIFE OR A/H)                                    *
  2544*  A.P.R.                                                        *
  2545*  METHOD
  2546*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2547*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2548*  COMPANY I.D. (3 CHARACTER)                                    *
  2549*  BENEFIT CODE                                                  *
  2550*  BENEFIT OVERRIDE CODE                                         *
  2551*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2552*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2553*  JOINT INDICATOR (CSL ONLY)                                    *
  2554*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2555*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2556*                                                                *
  2557*  RETURNED FROM ELRATE                                          *
  2558*  --------------------                                          *
  2559*  CALCULATED PREMIUM                                            *
  2560*  PREMIUM RATE                                                  *
  2561*  MORTALITY CODE                                                *
  2562*  MAX ATTAINED AGE                                              *
  2563*  MAX AGE                                                       *
  2564*  MAX TERM                                                      *
  2565*  MAX MONTHLY BENEFIT                                           *
  2566*  MAX TOTAL BENIFIT                                             *
  2567*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2568*----------------------------------------------------------------*
  2569*  PASSED TO ELRFND                                              *
  2570*  ----------------                                              *
  2571*  CERT ISSUE DATE                                               *
  2572*  REFUND DATE                                                   *
  2573*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2574*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2575*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2576*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2577*  STATE CODE (CLIENT DEFINED)                                   *
  2578*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2579*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2580*  DEVIATION CODE                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  49
* EL131.cbl
  2581*  ISSUE AGE                                                     *
  2582*  ORIGINAL BENEFIT AMOUNT                                       *
  2583*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2584*  PROCESS TYPE (CANCEL)                                         *
  2585*  BENEFIT KIND (LIFE OR A/H)                                    *
  2586*  A.P.R.                                                        *
  2587*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2588*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2589*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2590*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2591*  COMPANY I.D. (3 CHARACTER)                                    *
  2592*  BENEFIT CODE                                                  *
  2593*  BENEFIT OVERRIDE CODE                                         *
  2594*                                                                *
  2595*  RETURNED FROM ELRFND                                          *
  2596*  --------------------                                          *
  2597*  CALCULATED REFUND                                             *
  2598*----------------------------------------------------------------*
  2599*  PASSED TO ELEARN                                              *
  2600*  ----------------                                              *
  2601*  CERT ISSUE DATE                                               *
  2602*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2603*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2604*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2605*  STATE CODE (CLIENT DEFINED)                                   *
  2606*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2607*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2608*  DEVIATION CODE                                                *
  2609*  ISSUE AGE                                                     *
  2610*  ORIGINAL BENEFIT AMOUNT                                       *
  2611*  BENEFIT KIND (LIFE OR A/H)                                    *
  2612*  A.P.R.                                                        *
  2613*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2614*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2615*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2616*  COMPANY I.D. (3 CHARACTER)                                    *
  2617*  BENEFIT CODE                                                  *
  2618*  BENEFIT OVERRIDE CODE                                         *
  2619*                                                                *
  2620*  RETURNED FROM ELEARN                                          *
  2621*  --------------------                                          *
  2622*  INDICATED  EARNINGS                                           *
  2623*----------------------------------------------------------------*
  2624*                 LENGTH = 450                                   *
  2625*                                                                *
  2626******************************************************************
  2627******************************************************************
  2628*                   C H A N G E   L O G
  2629*
  2630* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2631*-----------------------------------------------------------------
  2632*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2633* EFFECTIVE    NUMBER
  2634*-----------------------------------------------------------------
  2635* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2636* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2637* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2638* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  50
* EL131.cbl
  2639* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2640* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2641* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2642* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2643* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2644* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2645* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2646******************************************************************
  2647
  2648 01  CALCULATION-PASS-AREA.
  2649     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2650                                     COMP.
  2651
  2652     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2653       88  NO-CP-ERROR                             VALUE ZERO.
  2654       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2655                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2656       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2657       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2658       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2659       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2660       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2661       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2662       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2663       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2664       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2665       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2666       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2667       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2668       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2669       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2670       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2671       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2672       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2673
  2674     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2675       88  NO-CP-ERROR-2                           VALUE ZERO.
  2676***********************  INPUT AREAS ****************************
  2677
  2678     12  CP-CALCULATION-AREA.
  2679         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2680         16  CP-CERT-EFF-DT        PIC XX.
  2681         16  CP-VALUATION-DT       PIC XX.
  2682         16  CP-PAID-THRU-DT       PIC XX.
  2683         16  CP-BENEFIT-TYPE       PIC X.
  2684           88  CP-AH                               VALUE 'A' 'D'
  2685                                                   'I' 'U'.
  2686           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2687           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2688         16  CP-INCURRED-DT        PIC XX.
  2689         16  CP-REPORTED-DT        PIC XX.
  2690         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2691         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2692         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2693                                     COMP-3.
  2694         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2695                                     COMP-3.
  2696         16  CP-CDT-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  51
* EL131.cbl
  2697           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2698           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2699           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2700         16  CP-CLAIM-TYPE         PIC X.
  2701           88  CP-AH-CLAIM                         VALUE 'A'.
  2702           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2703         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2704                                     COMP-3.
  2705         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2706                                     COMP-3.
  2707         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2708                                     COMP-3.
  2709         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2710                                     COMP-3.
  2711         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2712                                     COMP-3.
  2713         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2714                                     COMP-3.
  2715         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2716                                     COMP-3.
  2717         16  CP-REM-TERM-METHOD    PIC X.
  2718           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2719           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2720           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2721           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2722           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2723           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2724           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2725         16  CP-EARNING-METHOD     PIC X.
  2726           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2727           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2728           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2729           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2730           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2731           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2732           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2733           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2734           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2735           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2736           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2737           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2738           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2739           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2740         16  CP-PROCESS-TYPE       PIC X.
  2741           88  CP-CLAIM                            VALUE '1'.
  2742           88  CP-CANCEL                           VALUE '2'.
  2743           88  CP-ISSUE                            VALUE '3'.
  2744         16  CP-SPECIAL-CALC-CD    PIC X.
  2745           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2746           88  CP-1-MTH-INTEREST               VALUE ' '.
  2747           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2748           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2749           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2750           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2751           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2752           88  CP-FARM-PLAN                    VALUE 'F'.
  2753           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2754           88  CP-2-MTH-INTEREST               VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  52
* EL131.cbl
  2755           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2756           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2757           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2758           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2759           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2760           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2761           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2762           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2763                                                     'W' 'X'.
  2764           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2765           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2766           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2767           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2768           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2769           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2770           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2771           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2772           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2773           88  CP-CSL-METH-1                   VALUE '5'.
  2774           88  CP-CSL-METH-2                   VALUE '6'.
  2775           88  CP-CSL-METH-3                   VALUE '7'.
  2776           88  CP-CSL-METH-4                   VALUE '8'.
  2777
  2778         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2779                                     COMP-3.
  2780         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2781         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2782         16  CP-STATE              PIC XX          VALUE SPACE.
  2783         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2784         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2785           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2786               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2787         16  CP-R78-OPTION         PIC X.
  2788           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2789           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2790
  2791         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2792         16  CP-IBNR-RESERVE-SW    PIC X.
  2793         16  CP-CLAIM-STATUS       PIC X.
  2794         16  CP-RATE-FILE          PIC X.
  2795         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2796                                     COMP-3.
  2797
  2798         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2799         16  CP-AH-OVERRIDE-CODE   PIC X.
  2800
  2801         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2802                                     COMP-3.
  2803         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2804                                   PIC S9(5)V99 COMP-3.
  2805         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2806                                     COMP-3.
  2807         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2808                                     COMP-3.
  2809         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2810                                     COMP-3.
  2811         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2812                                  PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  53
* EL131.cbl
  2813
  2814         16  CP-PAID-FROM-DATE     PIC X(02).
  2815         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2816         16  CP-EXT-DAYS-CALC      PIC X.
  2817           88  CP-EXT-NO-CHG                   VALUE ' '.
  2818           88  CP-EXT-CHG-LF                   VALUE '1'.
  2819           88  CP-EXT-CHG-AH                   VALUE '2'.
  2820           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2821         16  CP-DOMICILE-STATE     PIC XX.
  2822         16  CP-CARRIER            PIC X.
  2823         16  CP-REIN-FLAG          PIC X.
  2824         16  CP-REM-TRM-CALC-OPTION PIC X.
  2825           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2826                      '2' '3' '4' '5'.
  2827           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2828           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2829           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2830           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2831           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2832           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2833           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2834           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2835         16  CP-SIG-SWITCH         PIC X.
  2836         16  CP-RATING-METHOD      PIC X.
  2837           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2838           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2839           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2840           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2841           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2842           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2843           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2844           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2845           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2846         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2847                                     COMP-3.
  2848         16  CP-BEN-CATEGORY       PIC X.
  2849         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2850         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2851                                   PIC S99V9(5) COMP-3.
  2852         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2853         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2854                                   PIC S99V9(5) COMP-3.
  2855         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2856         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2857         16  CP-EXPIRE-DT          PIC XX.
  2858         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2859         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2860         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2861         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2862         16  CP-DDF-SPEC-CALC      PIC X.
  2863             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2864             88  CP-CALC-CLP              VALUE 'C'.
  2865         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2866         16  CP-CANCEL-REASON      PIC X.
  2867         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2868         16  CP-PMT-MODE           PIC X.
  2869         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2870         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  54
* EL131.cbl
  2871         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2872         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2873         16  FILLER                PIC X.
  2874
  2875***************    OUTPUT FROM ELRESV   ************************
  2876
  2877         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2878
  2879         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2880                                     COMP-3.
  2881         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2882                                     COMP-3.
  2883         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2884                                     COMP-3.
  2885         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2886                                     COMP-3.
  2887         16  FILLER                PIC X(09).
  2888***************    OUTPUT FROM ELRTRM   *************************
  2889
  2890         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2891                                     COMP-3.
  2892         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2893                                     COMP-3.
  2894         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2895                                     COMP-3.
  2896         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2897                                     COMP-3.
  2898         16  FILLER                PIC X(12).
  2899
  2900***************    OUTPUT FROM ELRAMT   *************************
  2901
  2902         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2903                                     COMP-3.
  2904         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2905                                     COMP-3.
  2906         16  FILLER                PIC X(12).
  2907
  2908***************    OUTPUT FROM ELRATE   *************************
  2909
  2910         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2911                                     COMP-3.
  2912         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2913                                     COMP-3.
  2914         16  CP-MORTALITY-CODE     PIC X(4).
  2915         16  CP-RATE-EDIT-FLAG     PIC X.
  2916             88  CP-RATES-NEED-APR                  VALUE '1'.
  2917         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2918                                     COMP-3.
  2919         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2920         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2921         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2922                                   PIC S9(7)V99 COMP-3.
  2923         16  FILLER                PIC X(07).
  2924
  2925***************    OUTPUT FROM ELRFND   *************************
  2926
  2927         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2928                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  55
* EL131.cbl
  2929         16  CP-REFUND-TYPE-USED   PIC X.
  2930           88  CP-R-AS-R78                         VALUE '1'.
  2931           88  CP-R-AS-PRORATA                     VALUE '2'.
  2932           88  CP-R-AS-CALIF                       VALUE '3'.
  2933           88  CP-R-AS-TEXAS                       VALUE '4'.
  2934           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2935           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2936           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2937           88  CP-R-AS-MEAN                        VALUE '8'.
  2938           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2939           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2940           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2941           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2942           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2943           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2944         16  FILLER                PIC X(12).
  2945
  2946***************    OUTPUT FROM ELEARN   *************************
  2947
  2948         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2949                                     COMP-3.
  2950         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2951                                     COMP-3.
  2952         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2953                                     COMP-3.
  2954         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2955                                     COMP-3.
  2956         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2957                                     COMP-3.
  2958         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2959                                     COMP-3.
  2960         16  CP-EARNING-TYPE-USED  PIC X.
  2961           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2962           88  CP-E-AS-R78                         VALUE '1'.
  2963           88  CP-E-AS-PRORATA                     VALUE '2'.
  2964           88  CP-E-AS-TEXAS                       VALUE '4'.
  2965           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2966           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2967           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2968           88  CP-E-AS-MEAN                        VALUE '8'.
  2969           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2970         16  FILLER                PIC X(12).
  2971
  2972***************    OUTPUT FROM ELPMNT   *************************
  2973
  2974         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2975                                     COMP-3.
  2976         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2977                                     COMP-3.
  2978         16  FILLER                PIC X(12).
  2979
  2980***************   MISC WORK AREAS    *****************************
  2981         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2982                                     COMP-3.
  2983         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2984                                     COMP-3.
  2985         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2986                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  56
* EL131.cbl
  2987         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2988                                     COMP-3.
  2989         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2990                                     COMP-3.
  2991         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2992                                     COMP-3.
  2993         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2994             88  OPEN-RATE-FILE                   VALUE 'O'.
  2995             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2996             88  IO-ERROR                         VALUE 'E'.
  2997
  2998         16  CP-FIRST-PAY-DATE     PIC XX.
  2999
  3000         16  CP-JOINT-INDICATOR    PIC X.
  3001
  3002         16  CP-RESERVE-REMAINING-TERM
  3003                                   PIC S9(4)V9    VALUE ZERO
  3004                                     COMP-3.
  3005
  3006         16  CP-INSURED-BIRTH-DT   PIC XX.
  3007
  3008         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3009                                     COMP-3.
  3010
  3011         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3012                                     COMP-3.
  3013
  3014         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3015                                     COMP-3.
  3016
  3017         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3018                                     COMP-3.
  3019
  3020         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3021                                     COMP-3.
  3022
  3023         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3024                                     COMP-3.
  3025
  3026         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3027                                     COMP-3.
  3028
  3029         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3030             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3031
  3032         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3033                                     COMP-3.
  3034         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3035                                     COMP-3.
  3036         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3037         16  cp-extra-periods      pic 9 value zeros.
  3038         16  cp-net-only-state     pic x value spaces.
  3039         16  FILLER                PIC X(13).
  3040******************************************************************
  3041
  3042*                                COPY ELCDATE.
  3043******************************************************************
  3044*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  57
* EL131.cbl
  3045*                                                                *
  3046*                            ELCDATE.                            *
  3047*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3048*                            VMOD=2.003
  3049*                                                                *
  3050*                                                                *
  3051*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3052*                 LENGTH = 200                                   *
  3053******************************************************************
  3054
  3055 01  DATE-CONVERSION-DATA.
  3056     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3057     12  DC-OPTION-CODE                PIC X.
  3058         88  BIN-TO-GREG                VALUE ' '.
  3059         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3060         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3061         88  YMD-GREG-TO-BIN            VALUE '3'.
  3062         88  MDY-GREG-TO-BIN            VALUE '4'.
  3063         88  JULIAN-TO-BIN              VALUE '5'.
  3064         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3065         88  FIND-CENTURY               VALUE '7'.
  3066         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3067         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3068         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3069         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3070         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3071         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3072         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3073         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3074         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3075         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3076         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3077         88  BIN-3-TO-GREG              VALUE 'I'.
  3078         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3079         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3080         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3081         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3082         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3083         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3084         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3085         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3086         88  THREE-CHARACTER-BIN
  3087                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3088         88  GREGORIAN-TO-BIN
  3089                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3090         88  BIN-TO-GREGORIAN
  3091                  VALUES ' ' '1' 'I' '8' 'G'.
  3092         88  JULIAN-TO-BINARY
  3093                  VALUES '5' 'C' 'E' 'F'.
  3094     12  DC-ERROR-CODE                 PIC X.
  3095         88  NO-CONVERSION-ERROR        VALUE ' '.
  3096         88  DATE-CONVERSION-ERROR
  3097                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3098         88  DATE-IS-ZERO               VALUE '1'.
  3099         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3100         88  DATE-IS-INVALID            VALUE '3'.
  3101         88  DATE1-GREATER-DATE2        VALUE '4'.
  3102         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  58
* EL131.cbl
  3103         88  DATE-INVALID-OPTION        VALUE '9'.
  3104         88  INVALID-CENTURY            VALUE 'A'.
  3105         88  ONLY-CENTURY               VALUE 'B'.
  3106         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3107         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3108     12  DC-END-OF-MONTH               PIC X.
  3109         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3110     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3111         88  USE-NORMAL-PROCESS         VALUE ' '.
  3112         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3113         88  ADJUST-UP-100-YRS          VALUE '2'.
  3114     12  FILLER                        PIC X.
  3115     12  DC-CONVERSION-DATES.
  3116         16  DC-BIN-DATE-1             PIC XX.
  3117         16  DC-BIN-DATE-2             PIC XX.
  3118         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3119         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3120                       DC-GREG-DATE-1-EDIT.
  3121             20  DC-EDIT1-MONTH        PIC 99.
  3122             20  SLASH1-1              PIC X.
  3123             20  DC-EDIT1-DAY          PIC 99.
  3124             20  SLASH1-2              PIC X.
  3125             20  DC-EDIT1-YEAR         PIC 99.
  3126         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3127         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3128                     DC-GREG-DATE-2-EDIT.
  3129             20  DC-EDIT2-MONTH        PIC 99.
  3130             20  SLASH2-1              PIC X.
  3131             20  DC-EDIT2-DAY          PIC 99.
  3132             20  SLASH2-2              PIC X.
  3133             20  DC-EDIT2-YEAR         PIC 99.
  3134         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3135         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3136                     DC-GREG-DATE-1-YMD.
  3137             20  DC-YMD-YEAR           PIC 99.
  3138             20  DC-YMD-MONTH          PIC 99.
  3139             20  DC-YMD-DAY            PIC 99.
  3140         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3141         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3142                      DC-GREG-DATE-1-MDY.
  3143             20  DC-MDY-MONTH          PIC 99.
  3144             20  DC-MDY-DAY            PIC 99.
  3145             20  DC-MDY-YEAR           PIC 99.
  3146         16  DC-GREG-DATE-1-ALPHA.
  3147             20  DC-ALPHA-MONTH        PIC X(10).
  3148             20  DC-ALPHA-DAY          PIC 99.
  3149             20  FILLER                PIC XX.
  3150             20  DC-ALPHA-CENTURY.
  3151                 24 DC-ALPHA-CEN-N     PIC 99.
  3152             20  DC-ALPHA-YEAR         PIC 99.
  3153         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3154         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3155         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3156         16  DC-JULIAN-DATE            PIC 9(05).
  3157         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3158                                       PIC 9(05).
  3159         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3160             20  DC-JULIAN-YEAR        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  59
* EL131.cbl
  3161             20  DC-JULIAN-DAYS        PIC 999.
  3162         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3163         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3164         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3165     12  DATE-CONVERSION-VARIBLES.
  3166         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3167         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3168             20  FILLER                PIC 9(3).
  3169             20  HOLD-CEN-1-CCYY.
  3170                 24  HOLD-CEN-1-CC     PIC 99.
  3171                 24  HOLD-CEN-1-YY     PIC 99.
  3172             20  HOLD-CEN-1-MO         PIC 99.
  3173             20  HOLD-CEN-1-DA         PIC 99.
  3174         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3175             20  HOLD-CEN-1-R-MO       PIC 99.
  3176             20  HOLD-CEN-1-R-DA       PIC 99.
  3177             20  HOLD-CEN-1-R-CCYY.
  3178                 24  HOLD-CEN-1-R-CC   PIC 99.
  3179                 24  HOLD-CEN-1-R-YY   PIC 99.
  3180             20  FILLER                PIC 9(3).
  3181         16  HOLD-CENTURY-1-X.
  3182             20  FILLER                PIC X(3)  VALUE SPACES.
  3183             20  HOLD-CEN-1-X-CCYY.
  3184                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3185                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3186             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3187             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3188         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3189             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3190             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3191             20  HOLD-CEN-1-R-X-CCYY.
  3192                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3193                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3194             20  FILLER                PIC XXX.
  3195         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3196         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3197         16  DC-JULIAN-DATE-1          PIC 9(07).
  3198         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3199             20  DC-JULIAN-1-CCYY.
  3200                 24  DC-JULIAN-1-CC    PIC 99.
  3201                 24  DC-JULIAN-1-YR    PIC 99.
  3202             20  DC-JULIAN-DA-1        PIC 999.
  3203         16  DC-JULIAN-DATE-2          PIC 9(07).
  3204         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3205             20  DC-JULIAN-2-CCYY.
  3206                 24  DC-JULIAN-2-CC    PIC 99.
  3207                 24  DC-JULIAN-2-YR    PIC 99.
  3208             20  DC-JULIAN-DA-2        PIC 999.
  3209         16  DC-GREG-DATE-A-EDIT.
  3210             20  DC-EDITA-MONTH        PIC 99.
  3211             20  SLASHA-1              PIC X VALUE '/'.
  3212             20  DC-EDITA-DAY          PIC 99.
  3213             20  SLASHA-2              PIC X VALUE '/'.
  3214             20  DC-EDITA-CCYY.
  3215                 24  DC-EDITA-CENT     PIC 99.
  3216                 24  DC-EDITA-YEAR     PIC 99.
  3217         16  DC-GREG-DATE-B-EDIT.
  3218             20  DC-EDITB-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  60
* EL131.cbl
  3219             20  SLASHB-1              PIC X VALUE '/'.
  3220             20  DC-EDITB-DAY          PIC 99.
  3221             20  SLASHB-2              PIC X VALUE '/'.
  3222             20  DC-EDITB-CCYY.
  3223                 24  DC-EDITB-CENT     PIC 99.
  3224                 24  DC-EDITB-YEAR     PIC 99.
  3225         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3226         16  DC-GREG-DATE-CYMD-R REDEFINES
  3227                              DC-GREG-DATE-CYMD.
  3228             20  DC-CYMD-CEN           PIC 99.
  3229             20  DC-CYMD-YEAR          PIC 99.
  3230             20  DC-CYMD-MONTH         PIC 99.
  3231             20  DC-CYMD-DAY           PIC 99.
  3232         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3233         16  DC-GREG-DATE-MDCY-R REDEFINES
  3234                              DC-GREG-DATE-MDCY.
  3235             20  DC-MDCY-MONTH         PIC 99.
  3236             20  DC-MDCY-DAY           PIC 99.
  3237             20  DC-MDCY-CEN           PIC 99.
  3238             20  DC-MDCY-YEAR          PIC 99.
  3239    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3240        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3241    12  DC-EL310-DATE                  PIC X(21).
  3242    12  FILLER                         PIC X(28).
  3243
  3244*                                COPY ELCDMO.
  3245******************************************************************
  3246*                                                                *
  3247*                                                                *
  3248*                            ELCDMO.                             *
  3249*                            VMOD=2.004                          *
  3250*                                                                *
  3251*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3252*        COMMUNICATION AREA                                      *
  3253*   FILE TYPE = NA                                               *
  3254*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3255*                                                                *
  3256******************************************************************
  3257 01  DMO-COMMUNICATION-AREA.
  3258     12  DM-RECORD-TYPE                  PIC  X(02).
  3259             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3260             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3261             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3262     12  DM-DIST-CODE                    PIC  X(04).
  3263     12  DM-MAIL-CODE                    PIC  X(05).
  3264     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3265     12  DM-INSURED-NAME                 PIC  X(30).
  3266     12  DM-CLAIM-NO                     PIC  X(07).
  3267     12  DM-CLAIM-TYPE                   PIC  X.
  3268
  3269     12  DM-STATUS-DATA-AREA.
  3270         16  DM-CLAIM-STATUS             PIC  X.
  3271             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3272             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3273             88  DM-CLOSED                        VALUE '3'.
  3274             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3275             88  DM-DEFAULT                       VALUE '9'.
  3276         16  DM-STATUS-DATE              PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  61
* EL131.cbl
  3277******YYYYMMDD
  3278         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3279             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3280             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3281             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3282             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3283             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3284             88  DM-RE-OPENED                     VALUE 'R'.
  3285             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3286             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3287             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3288         16  DM-STAT-CARRIER             PIC X.
  3289
  3290     12  DM-DRAFT-DATA-AREA.
  3291         16  DM-PAYMENT-TYPE             PIC  X.
  3292             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3293         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3294         16  DM-PAYMENT-DATE             PIC  X(08).
  3295******YYYYMMDD
  3296         16  DM-CERT-NO                  PIC  X(11).
  3297         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3298         16  DM-CARRIER                  PIC  X.
  3299
  3300     12  DM-RETURN-CODE                  PIC  XX.
  3301*                                COPY ERCPDEF.
  3302******************************************************************
  3303*                                                                *
  3304*                                                                *
  3305*                            ERCPDEF.                            *
  3306*                                                                *
  3307*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3308*                                                                *
  3309*    FILE TYPE = VSAM,KSDS                                       *
  3310*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3311*                                                                *
  3312*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3313*                                                                *
  3314*    LOG = YES                                                   *
  3315*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3316******************************************************************
  3317*                   C H A N G E   L O G
  3318*
  3319* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3320*-----------------------------------------------------------------
  3321*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3322* EFFECTIVE    NUMBER
  3323*-----------------------------------------------------------------
  3324* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3325* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3326* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3327******************************************************************
  3328 01  PRODUCT-MASTER.
  3329    12  PD-RECORD-ID                 PIC X(02).
  3330        88  VALID-PD-ID                  VALUE 'PD'.
  3331    12  PD-CONTROL-PRIMARY.
  3332        16  PD-COMPANY-CD            PIC X.
  3333        16  PD-STATE                 PIC XX.
  3334        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  62
* EL131.cbl
  3335        16  PD-FILLER                PIC X(7).
  3336        16  PD-BEN-TYPE              PIC X.
  3337        16  PD-BEN-CODE              PIC XX.
  3338        16  PD-PROD-EXP-DT           PIC XX.
  3339    12  FILLER                       PIC X(50).
  3340    12  PD-PRODUCT-DATA OCCURS 8.
  3341        16  PD-PROD-CODE             PIC X.
  3342            88  PD-PROD-LIFE           VALUE 'L'.
  3343            88  PD-PROD-PROP           VALUE 'P'.
  3344            88  PD-PROD-AH             VALUE 'A'.
  3345            88  PD-PROD-IU             VALUE 'I'.
  3346            88  PD-PROD-GAP            VALUE 'G'.
  3347            88  PD-PROD-FAML           VALUE 'F'.
  3348        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3349        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3350        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3351        16  PD-MAX-TERM              PIC S999        COMP-3.
  3352        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3353        16  FILLER                   PIC X.
  3354        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3355        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3356        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3357        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3358        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3359        16  PD-REC-CRIT-PERIOD       PIC 99.
  3360        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3361            20  PD-RECURRING-YN      PIC X.
  3362            20  FILLER               PIC X.
  3363        16  PD-RTW-MOS               PIC 99.
  3364        16  PD-MAX-EXTENSION         PIC 99.
  3365        16  pd-ben-pct               pic sv999 comp-3.
  3366*       16  FILLER                   PIC XX.
  3367    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3368    12  PD-TERM-LIMITS OCCURS 15.
  3369        16  PD-LOW-TERM              PIC S999        COMP-3.
  3370        16  PD-HI-TERM               PIC S999        COMP-3.
  3371*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3372    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3373        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3374        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3375    12  PD-EARN-FACTORS.
  3376        16  FILLER OCCURS 15.
  3377            20  FILLER OCCURS 15.
  3378                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3379    12  PD-PRODUCT-DESC              PIC X(80).
  3380    12  PD-TRUNCATED                 PIC X.
  3381    12  FILLER                       PIC X(59).
  3382    12  PD-MAINT-INFORMATION.
  3383        16  PD-LAST-MAINT-DT         PIC X(02).
  3384        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3385        16  PD-LAST-MAINT-BY         PIC X(04).
  3386*                                COPY ELCCRTT.
  3387******************************************************************
  3388*                                                                *
  3389*                            ELCCRTT.                            *
  3390*                                                                *
  3391*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3392*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  63
* EL131.cbl
  3393*   FILE TYPE = VSAM,KSDS                                        *
  3394*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3395*                                                                *
  3396*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3397*                                                                *
  3398*   LOG = YES                                                    *
  3399*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3400******************************************************************
  3401*                   C H A N G E   L O G
  3402*
  3403* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3404*-----------------------------------------------------------------
  3405*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3406* EFFECTIVE    NUMBER
  3407*-----------------------------------------------------------------
  3408* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3409* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3410* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3411* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3412* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3413* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3414* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3415* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3416* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3417******************************************************************
  3418
  3419 01  CERTIFICATE-TRAILERS.
  3420     12  CS-RECORD-ID                      PIC XX.
  3421         88  VALID-CS-ID                      VALUE 'CS'.
  3422
  3423     12  CS-CONTROL-PRIMARY.
  3424         16  CS-COMPANY-CD                 PIC X.
  3425         16  CS-CARRIER                    PIC X.
  3426         16  CS-GROUPING                   PIC X(6).
  3427         16  CS-STATE                      PIC XX.
  3428         16  CS-ACCOUNT                    PIC X(10).
  3429         16  CS-CERT-EFF-DT                PIC XX.
  3430         16  CS-CERT-NO.
  3431             20  CS-CERT-PRIME             PIC X(10).
  3432             20  CS-CERT-SFX               PIC X.
  3433         16  CS-TRAILER-TYPE               PIC X.
  3434             88  COMM-TRLR           VALUE 'A'.
  3435             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3436             88  CERT-DATA-TRLR      VALUE 'C'.
  3437
  3438     12  CS-DATA-AREA                      PIC X(516).
  3439
  3440     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3441         16  CS-BANK-COMMISSION-AREA.
  3442             20  CS-BANK-COMMS       OCCURS 10.
  3443                 24  CS-AGT                PIC X(10).
  3444                 24  CS-COM-TYP            PIC X.
  3445                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3446                 24  CS-RECALC-LV-INDIC    PIC X.
  3447                 24  FILLER                PIC X(10).
  3448         16  FILLER                        PIC X(256).
  3449
  3450     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  64
* EL131.cbl
  3451****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3452         16  CS-MB-CLAIM-DATA OCCURS 24.
  3453             20  CS-CLAIM-NO               PIC X(7).
  3454             20  CS-CLAIM-TYPE             PIC X.
  3455                 88  CS-AH-CLM               VALUE 'A'.
  3456                 88  CS-IU-CLM               VALUE 'I'.
  3457                 88  CS-GP-CLM               VALUE 'G'.
  3458                 88  CS-LF-CLM               VALUE 'L'.
  3459                 88  CS-PR-CLM               VALUE 'P'.
  3460                 88  CS-FL-CLM               VALUE 'F'.
  3461             20  CS-INSURED-TYPE           PIC X.
  3462                 88  CS-PRIM-INSURED          VALUE 'P'.
  3463                 88  CS-CO-BORROWER           VALUE 'C'.
  3464             20  CS-BENEFIT-PERIOD         PIC 99.
  3465             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3466             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3467             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3468         16  FILLER                        PIC X(12).
  3469     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3470         16  CS-VIN-NUMBER                 PIC X(17).
  3471         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3472         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3473         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3474         16  cs-agent-name.
  3475             20  cs-agent-fname            pic x(20).
  3476             20  cs-agent-mi               pic x.
  3477             20  cs-agent-lname            pic x(25).
  3478         16  cs-license-no                 pic x(15).
  3479         16  cs-npn-number                 pic x(10).
  3480         16  cs-agent-edit-status          pic x.
  3481             88  cs-ae-refer-to-manager      value 'M'.
  3482             88  cs-ae-cover-sheet           value 'C'.
  3483             88  cs-ae-sig-form              value 'S'.
  3484             88  cs-ae-verified              value 'V'.
  3485             88  cs-unidentified-signature   value 'U'.
  3486             88  cs-cert-returned            value 'R'.
  3487             88  cs-accept-no-commission     value 'N'.
  3488         16  cs-year                       pic 9999.
  3489         16  cs-make                       pic x(20).
  3490         16  cs-model                      pic x(20).
  3491         16  cs-future                     pic x(20).
  3492         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3493         16  FILLER                        PIC X(356). *> was 420
  3494*        16  FILLER                        PIC X(496).
  3495
  3496****************************************************************
  3497*
  3498* Copyright (c) 2007-2013 Dell Inc.
  3499* All rights reserved.
  3500*
  3501****************************************************************
  3502 01  DFHEIV.
  3503   02  DFHEIV0               PIC X(35).
  3504   02  DFHEIV1               PIC X(08).
  3505   02  DFHEIV2               PIC X(08).
  3506   02  DFHEIV3               PIC X(08).
  3507   02  DFHEIV4               PIC X(06).
  3508   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  65
* EL131.cbl
  3509   02  DFHEIV6               PIC X(04).
  3510   02  DFHEIV7               PIC X(02).
  3511   02  DFHEIV8               PIC X(02).
  3512   02  DFHEIV9               PIC X(01).
  3513   02  DFHEIV10              PIC S9(7) COMP-3.
  3514   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3515   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3516   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3517   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3518   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3519   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3520   02  DFHEIV17              PIC X(04).
  3521   02  DFHEIV18              PIC X(04).
  3522   02  DFHEIV19              PIC X(04).
  3523   02  DFHEIV20              USAGE IS POINTER.
  3524   02  DFHEIV21              USAGE IS POINTER.
  3525   02  DFHEIV22              USAGE IS POINTER.
  3526   02  DFHEIV23              USAGE IS POINTER.
  3527   02  DFHEIV24              USAGE IS POINTER.
  3528   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3529   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3530   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3531   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3532   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3533   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3534   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3535   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3536   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3537   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3538   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3539   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3540   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3541   02  FILLER                PIC X(02).
  3542   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3543   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3544   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3545   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3546   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3547   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3548   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3549 LINKAGE  SECTION.
  3550*****************************************************************
  3551*                                                               *
  3552* Copyright (c) 2007-2013 Dell Inc.                             *
  3553* All rights reserved.                                          *
  3554*                                                               *
  3555*****************************************************************
  3556 01  dfheiblk.
  3557     02  eibtime          pic s9(7) comp-3.
  3558     02  eibdate          pic s9(7) comp-3.
  3559     02  eibtrnid         pic x(4).
  3560     02  eibtaskn         pic s9(7) comp-3.
  3561     02  eibtrmid         pic x(4).
  3562     02  dfheigdi         pic s9(4) comp.
  3563     02  eibcposn         pic s9(4) comp.
  3564     02  eibcalen         pic s9(4) comp.
  3565     02  eibaid           pic x(1).
  3566     02  eibfiller1       pic x(1).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  66
* EL131.cbl
  3567     02  eibfn            pic x(2).
  3568     02  eibfiller2       pic x(2).
  3569     02  eibrcode         pic x(6).
  3570     02  eibfiller3       pic x(2).
  3571     02  eibds            pic x(8).
  3572     02  eibreqid         pic x(8).
  3573     02  eibrsrce         pic x(8).
  3574     02  eibsync          pic x(1).
  3575     02  eibfree          pic x(1).
  3576     02  eibrecv          pic x(1).
  3577     02  eibsend          pic x(1).
  3578     02  eibatt           pic x(1).
  3579     02  eibeoc           pic x(1).
  3580     02  eibfmh           pic x(1).
  3581     02  eibcompl         pic x(1).
  3582     02  eibsig           pic x(1).
  3583     02  eibconf          pic x(1).
  3584     02  eiberr           pic x(1).
  3585     02  eibrldbk         pic x(1).
  3586     02  eiberrcd         pic x(4).
  3587     02  eibsynrb         pic x(1).
  3588     02  eibnodat         pic x(1).
  3589     02  eibfiller5       pic x(2).
  3590     02  eibresp          pic s9(8) comp.
  3591     02  eibresp2         pic s9(8) comp.
  3592     02  dfheigdj         pic s9(4) comp.
  3593     02  dfheigdk         pic s9(4) comp.
  3594 01  DFHCOMMAREA                 PIC X(1024).
  3595
  3596*                                COPY ELCMSTR.
  3597******************************************************************
  3598*                                                                *
  3599*                            ELCMSTR.                            *
  3600*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3601*                            VMOD=2.012                          *
  3602*                                                                *
  3603*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3604*                                                                *
  3605*   FILE TYPE = VSAM,KSDS                                        *
  3606*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3607*                                                                *
  3608*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3609*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3610*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3611*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3612*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3613*                                                 RKP=75,LEN=21  *
  3614*                                                                *
  3615*   **** NOTE ****                                               *
  3616*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3617*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3618*                                                                *
  3619*   LOG = YES                                                    *
  3620*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3621******************************************************************
  3622*                   C H A N G E   L O G
  3623*
  3624* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  67
* EL131.cbl
  3625*-----------------------------------------------------------------
  3626*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3627* EFFECTIVE    NUMBER
  3628*-----------------------------------------------------------------
  3629* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3630* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3631* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3632* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3633* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3634* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3635******************************************************************
  3636 01  CLAIM-MASTER.
  3637     12  CL-RECORD-ID                PIC XX.
  3638         88  VALID-CL-ID         VALUE 'CL'.
  3639
  3640     12  CL-CONTROL-PRIMARY.
  3641         16  CL-COMPANY-CD           PIC X.
  3642         16  CL-CARRIER              PIC X.
  3643         16  CL-CLAIM-NO             PIC X(7).
  3644         16  CL-CERT-NO.
  3645             20  CL-CERT-PRIME       PIC X(10).
  3646             20  CL-CERT-SFX         PIC X.
  3647
  3648     12  CL-CONTROL-BY-NAME.
  3649         16  CL-COMPANY-CD-A1        PIC X.
  3650         16  CL-INSURED-LAST-NAME    PIC X(15).
  3651         16  CL-INSURED-NAME.
  3652             20  CL-INSURED-1ST-NAME PIC X(12).
  3653             20  CL-INSURED-MID-INIT PIC X.
  3654
  3655     12  CL-CONTROL-BY-SSN.
  3656         16  CL-COMPANY-CD-A2        PIC X.
  3657         16  CL-SOC-SEC-NO.
  3658             20  CL-SSN-STATE        PIC XX.
  3659             20  CL-SSN-ACCOUNT      PIC X(6).
  3660             20  CL-SSN-LN3          PIC X(3).
  3661
  3662     12  CL-CONTROL-BY-CERT-NO.
  3663         16  CL-COMPANY-CD-A4        PIC X.
  3664         16  CL-CERT-NO-A4.
  3665             20  CL-CERT-A4-PRIME    PIC X(10).
  3666             20  CL-CERT-A4-SFX      PIC X.
  3667
  3668     12  CL-CONTROL-BY-CCN.
  3669         16  CL-COMPANY-CD-A5        PIC X.
  3670         16  CL-CCN-A5.
  3671             20  CL-CCN.
  3672                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3673                 24  CL-CCN-PRIME-A5 PIC X(12).
  3674             20  CL-CCN-FILLER-A5    PIC X(4).
  3675
  3676     12  CL-INSURED-PROFILE-DATA.
  3677         16  CL-INSURED-BIRTH-DT     PIC XX.
  3678         16  CL-INSURED-SEX-CD       PIC X.
  3679             88  INSURED-IS-MALE        VALUE 'M'.
  3680             88  INSURED-IS-FEMALE      VALUE 'F'.
  3681             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3682         16  CL-INSURED-OCC-CD       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  68
* EL131.cbl
  3683         16  FILLER                  PIC X(5).
  3684
  3685     12  CL-PROCESSING-INFO.
  3686         16  CL-PROCESSOR-ID         PIC X(4).
  3687         16  CL-CLAIM-STATUS         PIC X.
  3688             88  CLAIM-IS-OPEN          VALUE 'O'.
  3689             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3690         16  CL-CLAIM-TYPE           PIC X.
  3691*            88  AH-CLAIM               VALUE 'A'.
  3692*            88  LIFE-CLAIM             VALUE 'L'.
  3693*            88  PROPERTY-CLAIM         VALUE 'P'.
  3694*            88  IUI-CLAIM              VALUE 'I'.
  3695*            88  GAP-CLAIM              VALUE 'G'.
  3696*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3697         16  CL-CLAIM-PREM-TYPE      PIC X.
  3698             88  SINGLE-PREMIUM         VALUE '1'.
  3699             88  O-B-COVERAGE           VALUE '2'.
  3700             88  OPEN-END-COVERAGE      VALUE '3'.
  3701         16  CL-INCURRED-DT          PIC XX.
  3702         16  CL-REPORTED-DT          PIC XX.
  3703         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3704         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3705         16  CL-LAST-PMT-DT          PIC XX.
  3706         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3707         16  CL-PAID-THRU-DT         PIC XX.
  3708         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3709         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3710         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3711         16  CL-PMT-CALC-METHOD      PIC X.
  3712             88  CL-360-DAY-YR          VALUE '1'.
  3713             88  CL-365-DAY-YR          VALUE '2'.
  3714             88  CL-FULL-MONTHS         VALUE '3'.
  3715         16  CL-CAUSE-CD             PIC X(6).
  3716
  3717         16  CL-PRIME-CERT-NO.
  3718             20  CL-PRIME-CERT-PRIME PIC X(10).
  3719             20  CL-PRIME-CERT-SFX   PIC X.
  3720
  3721         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3722             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3723             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3724
  3725         16  CL-MICROFILM-NO         PIC X(10).
  3726         16  FILLER REDEFINES CL-MICROFILM-NO.
  3727             20  CL-BENEFIT-PERIOD   PIC 99.
  3728             20  FILLER              PIC X(8).
  3729         16  CL-PROG-FORM-TYPE       PIC X.
  3730         16  CL-LAST-ADD-ON-DT       PIC XX.
  3731
  3732         16  CL-LAST-REOPEN-DT       PIC XX.
  3733         16  CL-LAST-CLOSE-DT        PIC XX.
  3734         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3735             88  FINAL-PAID             VALUE '1'.
  3736             88  CLAIM-DENIED           VALUE '2'.
  3737             88  AUTO-CLOSE             VALUE '3'.
  3738             88  MANUAL-CLOSE           VALUE '4'.
  3739             88  BENEFITS-CHANGED       VALUE 'C'.
  3740             88  SETUP-ERRORS           VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  69
* EL131.cbl
  3741         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3742         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3743         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3744             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3745         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3746         16  FILLER                  PIC X.
  3747
  3748     12  CL-CERTIFICATE-DATA.
  3749         16  CL-CERT-ORIGIN          PIC X.
  3750             88  CERT-WAS-ONLINE        VALUE '1'.
  3751             88  CERT-WAS-CREATED       VALUE '2'.
  3752             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3753         16  CL-CERT-KEY-DATA.
  3754             20  CL-CERT-CARRIER     PIC X.
  3755             20  CL-CERT-GROUPING    PIC X(6).
  3756             20  CL-CERT-STATE       PIC XX.
  3757             20  CL-CERT-ACCOUNT.
  3758                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3759                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3760             20  CL-CERT-EFF-DT      PIC XX.
  3761
  3762     12  CL-STATUS-CONTROLS.
  3763         16  CL-PRIORITY-CD          PIC X.
  3764             88  CONFIDENTIAL-DATA      VALUE '8'.
  3765             88  HIGHEST-PRIORITY       VALUE '9'.
  3766         16  CL-SUPV-ATTN-CD         PIC X.
  3767             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3768             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3769         16  CL-PURGED-DT            PIC XX.
  3770         16  CL-RESTORED-DT          PIC XX.
  3771         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3772         16  CL-NEXT-RESEND-DT       PIC XX.
  3773         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3774         16  CL-CRITICAL-PERIOD      PIC 99.
  3775*        16  FILLER                  PIC XX.
  3776         16  CL-LAST-MAINT-DT        PIC XX.
  3777         16  CL-LAST-MAINT-USER      PIC X(4).
  3778         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3779         16  CL-LAST-MAINT-TYPE      PIC X.
  3780             88  CLAIM-SET-UP           VALUE ' '.
  3781             88  PAYMENT-MADE           VALUE '1'.
  3782             88  LETTER-SENT            VALUE '2'.
  3783             88  MASTER-WAS-ALTERED     VALUE '3'.
  3784             88  MASTER-WAS-RESTORED    VALUE '4'.
  3785             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3786             88  FILE-CONVERTED         VALUE '6'.
  3787             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3788             88  ERROR-CORRECTION       VALUE 'E'.
  3789         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3790         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3791         16  CL-BENEFICIARY          PIC X(10).
  3792         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3793         16  CL-DENIAL-TYPE          PIC X.
  3794             88  CL-TYPE-DENIAL          VALUE '1'.
  3795             88  CL-TYPE-RESCISSION      VALUE '2'.
  3796             88  CL-TYPE-REFORMATION     VALUE '3'.
  3797             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3798             88  CL-TYPE-RECONSIDERED    VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  70
* EL131.cbl
  3799         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3800         16  filler                  pic x(3).
  3801*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3802*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3803*        16  CL-RTW-DT               PIC XX.
  3804
  3805     12  CL-TRAILER-CONTROLS.
  3806         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3807             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3808             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3809             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3810         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3811         16  FILLER                  PIC XX.
  3812         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3813         16  CL-ADDRESS-TRAILER-CNT.
  3814             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3815                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3816             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3817                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3818             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3819                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3820             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3821                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3822             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3823                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3824             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3825                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3826             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3827                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3828
  3829     12  CL-CV-REFERENCE-NO.
  3830         16  CL-CV-REFNO-PRIME       PIC X(18).
  3831         16  CL-CV-REFNO-SFX         PIC XX.
  3832
  3833     12  CL-FILE-LOCATION            PIC X(4).
  3834
  3835     12  CL-PROCESS-ERRORS.
  3836         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3837             88  NO-FATAL-ERRORS        VALUE ZERO.
  3838         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3839             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3840
  3841     12  CL-PRODUCT-CD               PIC X.
  3842
  3843     12  CL-CURRENT-KEY-DATA.
  3844         16  CL-CURRENT-CARRIER      PIC X.
  3845         16  CL-CURRENT-GROUPING     PIC X(6).
  3846         16  CL-CURRENT-STATE        PIC XX.
  3847         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3848
  3849     12  CL-ASSOCIATES               PIC X.
  3850         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3851         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3852         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3853         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3854
  3855     12  CL-ACTIVITY-CODE            PIC 99.
  3856     12  CL-ACTIVITY-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  71
* EL131.cbl
  3857     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3858
  3859     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3860     12  CL-LAG-REPORT-CODE          PIC 9.
  3861     12  CL-LOAN-TYPE                PIC XX.
  3862     12  CL-LEGAL-STATE              PIC XX.
  3863
  3864     12  CL-YESNOSW                  PIC X.
  3865     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3866         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3867         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3868         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3869     12  cl-insured-type             pic x.
  3870         88  cl-claim-on-primary         value 'P'.
  3871         88  cl-claim-on-co-borrower     value 'C'.
  3872     12  cl-benefit-expiration-dt    PIC XX.
  3873
  3874*                                COPY ELCCERT.
  3875******************************************************************
  3876*                                                                *
  3877*                            ELCCERT.                            *
  3878*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3879*                            VMOD=2.013                          *
  3880*                                                                *
  3881*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3882*                                                                *
  3883*   FILE TYPE = VSAM,KSDS                                        *
  3884*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3885*                                                                *
  3886*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3887*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3888*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3889*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3890*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3891*                                                                *
  3892*   LOG = YES                                                    *
  3893*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3894******************************************************************
  3895*                   C H A N G E   L O G
  3896*
  3897* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3898*-----------------------------------------------------------------
  3899*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3900* EFFECTIVE    NUMBER
  3901*-----------------------------------------------------------------
  3902* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3903* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3904* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3905* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3906* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3907* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3908* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3909* 032612  CR2011110200001  PEMA  AHL CHANGES
  3910* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  3911* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3912******************************************************************
  3913
  3914 01  CERTIFICATE-MASTER.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  72
* EL131.cbl
  3915     12  CM-RECORD-ID                      PIC XX.
  3916         88  VALID-CM-ID                      VALUE 'CM'.
  3917
  3918     12  CM-CONTROL-PRIMARY.
  3919         16  CM-COMPANY-CD                 PIC X.
  3920         16  CM-CARRIER                    PIC X.
  3921         16  CM-GROUPING.
  3922             20  CM-GROUPING-PREFIX        PIC X(3).
  3923             20  CM-GROUPING-PRIME         PIC X(3).
  3924         16  CM-STATE                      PIC XX.
  3925         16  CM-ACCOUNT.
  3926             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3927             20  CM-ACCOUNT-PRIME          PIC X(6).
  3928         16  CM-CERT-EFF-DT                PIC XX.
  3929         16  CM-CERT-NO.
  3930             20  CM-CERT-PRIME             PIC X(10).
  3931             20  CM-CERT-SFX               PIC X.
  3932
  3933     12  CM-CONTROL-BY-NAME.
  3934         16  CM-COMPANY-CD-A1              PIC X.
  3935         16  CM-INSURED-LAST-NAME          PIC X(15).
  3936         16  CM-INSURED-INITIALS.
  3937             20  CM-INSURED-INITIAL1       PIC X.
  3938             20  CM-INSURED-INITIAL2       PIC X.
  3939
  3940     12  CM-CONTROL-BY-SSN.
  3941         16  CM-COMPANY-CD-A2              PIC X.
  3942         16  CM-SOC-SEC-NO.
  3943             20  CM-SSN-STATE              PIC XX.
  3944             20  CM-SSN-ACCOUNT            PIC X(6).
  3945             20  CM-SSN-LN3.
  3946                 25  CM-INSURED-INITIALS-A2.
  3947                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3948                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3949                 25 CM-PART-LAST-NAME-A2         PIC X.
  3950
  3951     12  CM-CONTROL-BY-CERT-NO.
  3952         16  CM-COMPANY-CD-A4              PIC X.
  3953         16  CM-CERT-NO-A4                 PIC X(11).
  3954
  3955     12  CM-CONTROL-BY-MEMB.
  3956         16  CM-COMPANY-CD-A5              PIC X.
  3957         16  CM-MEMBER-NO.
  3958             20  CM-MEMB-STATE             PIC XX.
  3959             20  CM-MEMB-ACCOUNT           PIC X(6).
  3960             20  CM-MEMB-LN4.
  3961                 25  CM-INSURED-INITIALS-A5.
  3962                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3963                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3964                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3965
  3966     12  CM-INSURED-PROFILE-DATA.
  3967         16  CM-INSURED-FIRST-NAME.
  3968             20  CM-INSURED-1ST-INIT       PIC X.
  3969             20  FILLER                    PIC X(9).
  3970         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3971         16  CM-INSURED-SEX                PIC X.
  3972             88  CM-SEX-MALE                  VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  73
* EL131.cbl
  3973             88  CM-SEX-FEMAL                 VALUE 'F'.
  3974         16  CM-INSURED-JOINT-AGE          PIC 99.
  3975         16  CM-JOINT-INSURED-NAME.
  3976             20  CM-JT-LAST-NAME           PIC X(15).
  3977             20  CM-JT-FIRST-NAME.
  3978                 24  CM-JT-1ST-INIT        PIC X.
  3979                 24  FILLER                PIC X(9).
  3980             20  CM-JT-INITIAL             PIC X.
  3981
  3982     12  CM-LIFE-DATA.
  3983         16  CM-LF-BENEFIT-CD              PIC XX.
  3984         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3985         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3986         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3987         16  CM-LF-DEV-CODE                PIC XXX.
  3988         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3989         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3990         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3991         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3992         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3993         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3994         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3995         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3996         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3997         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3998         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3999         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4000         16  cm-temp-epiq                  pic xx.
  4001             88  EPIQ-CLASS                  value 'EQ'.
  4002*        16  FILLER                        PIC XX.
  4003
  4004     12  CM-AH-DATA.
  4005         16  CM-AH-BENEFIT-CD              PIC XX.
  4006         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4007         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4008         16  CM-AH-DEV-CODE                PIC XXX.
  4009         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4010         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4011         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4012         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4013         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4014         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4015         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4016         16  CM-AH-PAID-THRU-DT            PIC XX.
  4017             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4018         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4019         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4020         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4021         16  FILLER                        PIC X.
  4022
  4023     12  CM-LOAN-INFORMATION.
  4024         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4025         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4026                                           PIC S9(5)V99  COMP-3.
  4027         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4028         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4029         16  CM-PAY-FREQUENCY              PIC S99.
  4030         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  74
* EL131.cbl
  4031         16  CM-RATE-CLASS                 PIC XX.
  4032         16  CM-BENEFICIARY                PIC X(25).
  4033         16  CM-POLICY-FORM-NO             PIC X(12).
  4034         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4035         16  CM-LAST-ADD-ON-DT             PIC XX.
  4036         16  CM-DEDUCTIBLE-AMOUNTS.
  4037             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4038             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4039         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4040             20  CM-RESIDENT-STATE         PIC XX.
  4041             20  CM-RATE-CODE              PIC X(4).
  4042             20  FILLER                    PIC XX.
  4043         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4044             20  CM-LOAN-OFFICER           PIC X(5).
  4045             20  FILLER                    PIC XXX.
  4046         16  CM-CSR-CODE                   PIC XXX.
  4047         16  CM-UNDERWRITING-CODE          PIC X.
  4048             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4049         16  CM-POST-CARD-IND              PIC X.
  4050         16  CM-NH-INTERFACE-SW            PIC X.
  4051         16  CM-PREMIUM-TYPE               PIC X.
  4052             88  CM-SING-PRM                  VALUE '1'.
  4053             88  CM-O-B-COVERAGE              VALUE '2'.
  4054             88  CM-OPEN-END                  VALUE '3'.
  4055         16  CM-IND-GRP-TYPE               PIC X.
  4056             88  CM-INDIVIDUAL                VALUE 'I'.
  4057             88  CM-GROUP                     VALUE 'G'.
  4058         16  CM-SKIP-CODE                  PIC X.
  4059             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4060             88  SKIP-JULY                    VALUE '1'.
  4061             88  SKIP-AUGUST                  VALUE '2'.
  4062             88  SKIP-SEPTEMBER               VALUE '3'.
  4063             88  SKIP-JULY-AUG                VALUE '4'.
  4064             88  SKIP-AUG-SEPT                VALUE '5'.
  4065             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4066             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4067             88  SKIP-JUNE                    VALUE '8'.
  4068             88  SKIP-JUNE-JULY               VALUE '9'.
  4069             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4070             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4071         16  CM-PAYMENT-MODE               PIC X.
  4072             88  PAY-MONTHLY                  VALUE SPACE.
  4073             88  PAY-WEEKLY                   VALUE '1'.
  4074             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4075             88  PAY-BI-WEEKLY                VALUE '3'.
  4076             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4077         16  CM-LOAN-NUMBER                PIC X(8).
  4078         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4079         16  CM-OLD-LOF                    PIC XXX.
  4080*        16  CM-LOAN-OFFICER               PIC XXX.
  4081         16  CM-REIN-TABLE                 PIC XXX.
  4082         16  CM-SPECIAL-REIN-CODE          PIC X.
  4083         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4084         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4085         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4086
  4087     12  CM-STATUS-DATA.
  4088         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  75
* EL131.cbl
  4089         16  CM-ENTRY-DT                   PIC XX.
  4090
  4091         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4092         16  CM-LF-CANCEL-DT               PIC XX.
  4093         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4094
  4095         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4096         16  CM-LF-DEATH-DT                PIC XX.
  4097         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4098
  4099         16  CM-LF-CURRENT-STATUS          PIC X.
  4100             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4101                                                'M' '4' '5' '9'.
  4102             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4103             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4104             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4105             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4106             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4107             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4108             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4109             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4110             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4111             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4112             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4113             88  CM-LF-DECLINED               VALUE 'D'.
  4114             88  CM-LF-VOIDED                 VALUE 'V'.
  4115
  4116         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4117         16  CM-AH-CANCEL-DT               PIC XX.
  4118         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4119
  4120         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4121         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4122         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4123
  4124         16  CM-AH-CURRENT-STATUS          PIC X.
  4125             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4126                                                'M' '4' '5' '9'.
  4127             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4128             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4129             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4130             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4131             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4132             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4133             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4134             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4135             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4136             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4137             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4138             88  CM-AH-DECLINED               VALUE 'D'.
  4139             88  CM-AH-VOIDED                 VALUE 'V'.
  4140
  4141         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4142             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4143             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4144             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4145         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4146
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  76
* EL131.cbl
  4147         16  CM-ENTRY-BATCH                PIC X(6).
  4148         16  CM-LF-EXIT-BATCH              PIC X(6).
  4149         16  CM-AH-EXIT-BATCH              PIC X(6).
  4150         16  CM-LAST-MONTH-END             PIC XX.
  4151
  4152     12  CM-NOTE-SW                        PIC X.
  4153         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4154         88  CERT-NOTES-PRESENT               VALUE '1'.
  4155         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4156         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4157         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4158         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4159         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4160         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4161     12  CM-COMP-EXCP-SW                   PIC X.
  4162         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4163         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4164     12  CM-INSURED-ADDRESS-SW             PIC X.
  4165         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4166         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4167
  4168*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4169     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4170     12  FILLER                            PIC X.
  4171
  4172*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4173     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4174     12  FILLER                            PIC X.
  4175*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4176     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4177
  4178     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4179         88  CERT-ADDED-BATCH                 VALUE ' '.
  4180         88  CERT-ADDED-ONLINE                VALUE '1'.
  4181         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4182         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4183         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4184     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4185         88  CERT-AS-LOADED                   VALUE ' '.
  4186         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4187         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4188         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4189         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4190         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4191         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4192         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4193
  4194     12  CM-ACCOUNT-COMM-PCTS.
  4195         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4196         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4197
  4198     12  CM-USER-FIELD                     PIC X.
  4199     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4200     12  CM-CLP-STATE                      PIC XX.
  4201     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4202     12  CM-USER-RESERVED                  PIC XXX.
  4203     12  FILLER REDEFINES CM-USER-RESERVED.
  4204         16  CM-AH-CLASS-CD                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  77
* EL131.cbl
  4205         16  F                             PIC X.
  4206******************************************************************
  4207
  4208*                                COPY ELCTRLR.
  4209******************************************************************
  4210*                                                                *
  4211*                            ELCTRLR.                            *
  4212*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4213*                            VMOD=2.014                          *
  4214*                                                                *
  4215*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4216*                                                                *
  4217*   FILE TYPE = VSAM,KSDS                                        *
  4218*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4219*                                                                *
  4220*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4221*       ALTERNATE INDEX = NONE                                   *
  4222*                                                                *
  4223*   LOG = YES                                                    *
  4224*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4225******************************************************************
  4226*                   C H A N G E   L O G
  4227*
  4228* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4229*-----------------------------------------------------------------
  4230*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4231* EFFECTIVE    NUMBER
  4232*-----------------------------------------------------------------
  4233* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4234* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4235* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4236* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4237* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4238* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4239* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4240* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4241* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4242* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4243* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4244* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4245* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4246* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4247* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4248* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4249* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4250* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4251* 040814    2014030500002  AJRA  ADD ICD CODES
  4252* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4253* 013017  CR2016053100001  PEMA  ACH PROCESSING
  4254* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  4255******************************************************************
  4256 01  ACTIVITY-TRAILERS.
  4257     12  AT-RECORD-ID                    PIC XX.
  4258         88  VALID-AT-ID                       VALUE 'AT'.
  4259
  4260     12  AT-CONTROL-PRIMARY.
  4261         16  AT-COMPANY-CD               PIC X.
  4262         16  AT-CARRIER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  78
* EL131.cbl
  4263         16  AT-CLAIM-NO                 PIC X(7).
  4264         16  AT-CERT-NO.
  4265             20  AT-CERT-PRIME           PIC X(10).
  4266             20  AT-CERT-SFX             PIC X.
  4267         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4268             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4269             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4270             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4271             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4272             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4273             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4274             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4275             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4276             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4277             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4278             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4279             88  AT-BENEFICIARY-TRL           VALUE +91.
  4280             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4281             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4282             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4283             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4284
  4285     12  AT-TRAILER-TYPE                 PIC X.
  4286         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4287         88  PAYMENT-TR                       VALUE '2'.
  4288         88  AUTO-PAY-TR                      VALUE '3'.
  4289         88  CORRESPONDENCE-TR                VALUE '4'.
  4290         88  ADDRESS-TR                       VALUE '5'.
  4291         88  GENERAL-INFO-TR                  VALUE '6'.
  4292         88  AUTO-PROMPT-TR                   VALUE '7'.
  4293         88  DENIAL-TR                        VALUE '8'.
  4294         88  INCURRED-CHG-TR                  VALUE '9'.
  4295         88  FORM-CONTROL-TR                  VALUE 'A'.
  4296
  4297     12  AT-RECORDED-DT                  PIC XX.
  4298     12  AT-RECORDED-BY                  PIC X(4).
  4299     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4300
  4301     12  AT-TRAILER-BODY                 PIC X(165).
  4302
  4303     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4304         16  AT-RESERVE-CONTROLS.
  4305             20  AT-MANUAL-SW            PIC X.
  4306                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4307             20  AT-FUTURE-SW            PIC X.
  4308                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4309             20  AT-PTC-SW               PIC X.
  4310                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4311             20  AT-IBNR-SW              PIC X.
  4312                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4313             20  AT-PTC-LF-SW            PIC X.
  4314                 88  AT-LF-PTC-USED          VALUE '1'.
  4315             20  AT-CDT-ACCESS-METHOD    PIC X.
  4316                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4317                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4318                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4319             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4320         16  AT-LAST-COMPUTED-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  79
* EL131.cbl
  4321         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4322         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4323         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4324         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4325         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4326         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4327         16  AT-EXPENSE-CONTROLS.
  4328             20  AT-EXPENSE-METHOD       PIC X.
  4329                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4330                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4331                 88  PERCENT-OF-PMT           VALUE '3'.
  4332                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4333             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4334             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4335         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4336         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4337
  4338         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4339         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4340
  4341*        16  FILLER                      PIC X(53).
  4342         16  FILLER                      PIC X(47).
  4343
  4344         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4345         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4346
  4347         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4348             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4349             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4350*                    C = CLOSED
  4351*                    O = OPEN
  4352             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4353*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4354
  4355     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4356         16  AT-PAYMENT-TYPE             PIC X.
  4357             88  PARTIAL-PAYMENT                VALUE '1'.
  4358             88  FINAL-PAYMENT                  VALUE '2'.
  4359             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4360             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4361             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4362             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4363             88  VOIDED-PAYMENT                 VALUE '9'.
  4364             88  TRANSFER                       VALUE 'T'.
  4365             88  LIFE-INTEREST                  VALUE 'I'.
  4366
  4367         16  AT-CLAIM-TYPE               PIC X.
  4368             88  PAID-FOR-AH                    VALUE 'A'.
  4369             88  PAID-FOR-LIFE                  VALUE 'L'.
  4370             88  PAID-FOR-IUI                   VALUE 'I'.
  4371             88  PAID-FOR-GAP                   VALUE 'G'.
  4372             88  PAID-FOR-FAM                   VALUE 'F'.
  4373         16  AT-CLAIM-PREM-TYPE          PIC X.
  4374             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4375             88  AT-O-B-COVERAGE                VALUE '2'.
  4376             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4377         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4378         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  80
* EL131.cbl
  4379         16  AT-PAID-FROM-DT             PIC XX.
  4380         16  AT-PAID-THRU-DT             PIC XX.
  4381         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4382         16  AT-ACH-PAYMENT              PIC X.
  4383*        16  FILLER                      PIC X.
  4384         16  AT-PAYEES-NAME              PIC X(30).
  4385         16  AT-PAYMENT-ORIGIN           PIC X.
  4386             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4387             88  ONLINE-AUTO-PMT                VALUE '2'.
  4388             88  OFFLINE-PMT                    VALUE '3'.
  4389         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4390         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4391         16  AT-VOID-DATA.
  4392             20  AT-VOID-DT              PIC XX.
  4393*00144       20  AT-VOID-REASON          PIC X(30).
  4394             20  AT-VOID-REASON          PIC X(26).
  4395         16  AT-PMT-APPROVED-BY          PIC X(04).
  4396         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4397         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4398         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4399                                         PIC S99V9(5)  COMP-3.
  4400         16  AT-CREDIT-INTERFACE.
  4401             20  AT-PMT-SELECT-DT        PIC XX.
  4402                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4403             20  AT-PMT-ACCEPT-DT        PIC XX.
  4404                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4405             20  AT-VOID-SELECT-DT       PIC XX.
  4406                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4407             20  AT-VOID-ACCEPT-DT       PIC XX.
  4408                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4409
  4410         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4411                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4412                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4413         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4414
  4415         16  AT-FORCE-CONTROL            PIC X.
  4416             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4417         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4418         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4419         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4420         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4421         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4422         16  AT-BENEFIT-TYPE             PIC X.
  4423
  4424         16  AT-EXPENSE-TYPE             PIC X.
  4425         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4426
  4427         16  AT-PAYEE-TYPE-CD.
  4428             20  AT-PAYEE-TYPE           PIC X.
  4429                 88  INSURED-PAID           VALUE 'I'.
  4430                 88  BENEFICIARY-PAID       VALUE 'B'.
  4431                 88  ACCOUNT-PAID           VALUE 'A'.
  4432                 88  OTHER-1-PAID           VALUE 'O'.
  4433                 88  OTHER-2-PAID           VALUE 'Q'.
  4434                 88  DOCTOR-PAID            VALUE 'P'.
  4435                 88  EMPLOYER-PAID          VALUE 'E'.
  4436             20  AT-PAYEE-SEQ            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  81
* EL131.cbl
  4437
  4438         16  AT-CASH-PAYMENT             PIC X.
  4439         16  AT-GROUPED-PAYMENT          PIC X.
  4440         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4441         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4442         16  AT-APPROVED-LEVEL           PIC X.
  4443         16  AT-VOID-TYPE                PIC X.
  4444             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4445             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4446         16  AT-AIG-UNEMP-IND            PIC X.
  4447             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4448         16  AT-ASSOCIATES               PIC X.
  4449             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4450             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4451
  4452         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4453         16  AT-CV-PMT-CODE              PIC X.
  4454             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4455             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4456             88  FULL-ADD-PAYMENT           VALUE '3'.
  4457             88  HALF-ADD-PAYMENT           VALUE '4'.
  4458             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4459             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4460             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4461             88  ADDL-PAYMENT               VALUE '8'.
  4462
  4463         16  AT-EOB-CODE1                PIC XXX.
  4464         16  AT-EOB-CODE2                PIC XXX.
  4465         16  AT-EOB-CODE3                PIC XXX.
  4466         16  FILLER REDEFINES AT-EOB-CODE3.
  4467             20  AT-PRINT-CLM-FORM       PIC X.
  4468             20  AT-PRINT-SURVEY         PIC X.
  4469             20  AT-SPECIAL-RELEASE      PIC X.
  4470         16  AT-EOB-CODE4                PIC XXX.
  4471         16  FILLER REDEFINES AT-EOB-CODE4.
  4472             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4473             20  FILLER                  PIC X.
  4474         16  AT-EOB-CODE5                PIC XXX.
  4475         16  FILLER REDEFINES AT-EOB-CODE5.
  4476             20  AT-PMT-PROOF-DT         PIC XX.
  4477             20  FILLER                  PIC X.
  4478
  4479         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4480             88  AT-PRINT-EOB            VALUE 'Y'.
  4481
  4482         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4483         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4484
  4485     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4486         16  AT-SCHEDULE-START-DT        PIC XX.
  4487         16  AT-SCHEDULE-END-DT          PIC XX.
  4488         16  AT-TERMINATED-DT            PIC XX.
  4489         16  AT-LAST-PMT-TYPE            PIC X.
  4490             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4491             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4492         16  AT-FIRST-PMT-DATA.
  4493             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4494             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  82
* EL131.cbl
  4495             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4496         16  AT-REGULAR-PMT-DATA.
  4497             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4498             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4499             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4500         16  AT-AUTO-PAYEE-CD.
  4501             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4502                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4503                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4504                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4505                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4506                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4507             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4508         16  AT-AUTO-PAY-DAY             PIC 99.
  4509         16  AT-AUTO-CASH                PIC X.
  4510             88  AT-CASH                      VALUE 'Y'.
  4511             88  AT-NON-CASH                  VALUE 'N'.
  4512*        16  FILLER                      PIC X(129).
  4513         16  AT-AUTO-END-LETTER          PIC X(4).
  4514         16  FILLER                      PIC X(125).
  4515
  4516         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4517         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4518
  4519     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4520         16  AT-LETTER-SENT-DT           PIC XX.
  4521         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4522         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4523         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4524         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4525         16  AT-LETTER-ORIGIN            PIC X.
  4526             88  ONLINE-CREATION              VALUE '1' '3'.
  4527             88  OFFLINE-CREATION             VALUE '2' '4'.
  4528             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4529             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4530         16  AT-STD-LETTER-FORM          PIC X(4).
  4531         16  AT-REASON-TEXT              PIC X(70).
  4532         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4533         16  AT-ADDRESEE-TYPE            PIC X.
  4534              88  INSURED-ADDRESEE            VALUE 'I'.
  4535              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4536              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4537              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4538              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4539              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4540              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4541         16  AT-ADDRESSEE-NAME           PIC X(30).
  4542         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4543         16  AT-RESEND-PRINT-DATE        PIC XX.
  4544         16  AT-CORR-SOL-UNSOL           PIC X.
  4545         16  AT-LETTER-PURGED-DT         PIC XX.
  4546*
  4547*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4548*
  4549         16  AT-CSO-REDEFINITION.
  4550             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4551             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4552             20  AT-LETTER-TO-BENE       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  83
* EL131.cbl
  4553             20  AT-STOP-LETTER-DT       PIC X(2).
  4554             20  AT-AUTH-RCVD            PIC X(1).
  4555             20  FILLER                  PIC X(18).
  4556*             20  FILLER                  PIC X(27).
  4557             20  AT-CSO-LETTER-STATUS    PIC X.
  4558                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4559                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4560                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4561             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4562             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4563*
  4564*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4565*
  4566*        16  FILLER                      PIC X(26).
  4567*
  4568*        16  AT-DMD-BSR-CODE             PIC X.
  4569*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4570*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4571*
  4572*        16  AT-DMD-LETTER-STATUS        PIC X.
  4573*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4574*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4575*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4576*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4577*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4578
  4579         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4580         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4581
  4582     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4583         16  AT-ADDRESS-TYPE             PIC X.
  4584             88  INSURED-ADDRESS               VALUE 'I'.
  4585             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4586             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4587             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4588             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4589             88  OTHER-ADDRESS-1               VALUE 'O'.
  4590             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4591         16  AT-MAIL-TO-NAME             PIC X(30).
  4592         16  AT-ADDRESS-LINE-1           PIC X(30).
  4593         16  AT-ADDRESS-LINE-2           PIC X(30).
  4594         16  AT-CITY-STATE.
  4595             20  AT-CITY                 PIC X(28).
  4596             20  AT-STATE                PIC XX.
  4597         16  AT-ZIP.
  4598             20  AT-ZIP-CODE.
  4599                 24  AT-ZIP-1ST          PIC X.
  4600                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4601                 24  FILLER              PIC X(4).
  4602             20  AT-ZIP-PLUS4            PIC X(4).
  4603         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4604             20  AT-CAN-POSTAL-1         PIC XXX.
  4605             20  AT-CAN-POSTAL-2         PIC XXX.
  4606             20  FILLER                  PIC XXX.
  4607         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4608*         16  FILLER                      PIC X(23).
  4609         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4610         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  84
* EL131.cbl
  4611         16  FILLER                      PIC X(13).
  4612         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4613         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4614
  4615     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4616         16  AT-INFO-LINE-1              PIC X(60).
  4617         16  FILLER REDEFINES AT-INFO-LINE-1.
  4618             20  AT-NOTE-ERROR-NO OCCURS 15
  4619                                         PIC X(4).
  4620         16  AT-INFO-LINE-2              PIC X(60).
  4621         16  FILLER REDEFINES AT-INFO-LINE-2.
  4622             20  AT-ICD-CODE-1           PIC X(8).
  4623             20  AT-ICD-CODE-2           PIC X(8).
  4624             20  FILLER                  PIC X(44).
  4625         16  AT-INFO-TRAILER-TYPE        PIC X.
  4626             88  AT-ERRORS-NOTE          VALUE 'E'.
  4627             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4628             88  AT-CALL-NOTE            VALUE 'C'.
  4629             88  AT-MAINT-NOTE           VALUE 'M'.
  4630             88  AT-CERT-CHANGE          VALUE 'X'.
  4631             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4632             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4633             88  AT-CERT-CANCELLED       VALUE 'T'.
  4634         16  AT-CALL-TYPE                PIC X.
  4635             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4636             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4637         16  AT-NOTE-CONTINUATION        PIC X.
  4638             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4639         16  AT-EOB-CODES-EXIST          PIC X.
  4640             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4641         16  FILLER                      PIC X(35).
  4642         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4643         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4644
  4645     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4646         16  AT-PROMPT-LINE-1            PIC X(60).
  4647         16  AT-PROMPT-LINE-2            PIC X(60).
  4648         16  AT-PROMPT-START-DT          PIC XX.
  4649         16  AT-PROMPT-END-DT            PIC XX.
  4650         16  FILLER                      PIC X(35).
  4651         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4652         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4653
  4654     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4655         16  AT-DENIAL-INFO-1            PIC X(60).
  4656         16  AT-DENIAL-INFO-2            PIC X(60).
  4657         16  AT-DENIAL-DT                PIC XX.
  4658         16  AT-RETRACTION-DT            PIC XX.
  4659         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4660*         16  FILLER                      PIC X(31).
  4661         16  AT-DENIAL-PROOF-DT          PIC XX.
  4662         16  FILLER                      PIC X(29).
  4663         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4664         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4665
  4666     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4667         16  AT-OLD-INCURRED-DT          PIC XX.
  4668         16  AT-OLD-REPORTED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  85
* EL131.cbl
  4669         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4670         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4671         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4672         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4673         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4674         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4675         16  FILLER                      PIC X(26).
  4676         16  AT-OLD-DIAG-CODE            PIC X(6).
  4677         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4678         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4679         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4680         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4681         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4682         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4683         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4684         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4685         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4686         16  FILLER                      PIC X(9).
  4687         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4688
  4689     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4690         16  AT-FORM-SEND-ON-DT          PIC XX.
  4691         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4692         16  AT-FORM-RE-SEND-DT          PIC XX.
  4693         16  AT-FORM-ANSWERED-DT         PIC XX.
  4694         16  AT-FORM-PRINTED-DT          PIC XX.
  4695         16  AT-FORM-REPRINT-DT          PIC XX.
  4696         16  AT-FORM-TYPE                PIC X.
  4697             88  INITIAL-FORM                  VALUE '1'.
  4698             88  PROGRESS-FORM                 VALUE '2'.
  4699         16  AT-INSTRUCT-LN-1            PIC X(28).
  4700         16  AT-INSTRUCT-LN-2            PIC X(28).
  4701         16  AT-INSTRUCT-LN-3            PIC X(28).
  4702         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4703         16  AT-FORM-ADDRESS             PIC X.
  4704             88  FORM-TO-INSURED              VALUE 'I'.
  4705             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4706             88  FORM-TO-OTHER-1              VALUE 'O'.
  4707             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4708         16  AT-RELATED-1.
  4709             20 AT-REL-CARR-1            PIC X.
  4710             20 AT-REL-CLAIM-1           PIC X(7).
  4711             20 AT-REL-CERT-1            PIC X(11).
  4712         16  AT-RELATED-2.
  4713             20 AT-REL-CARR-2            PIC X.
  4714             20 AT-REL-CLAIM-2           PIC X(7).
  4715             20 AT-REL-CERT-2            PIC X(11).
  4716         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4717         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4718         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4719         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4720         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4721         16  AT-STOP-FORM-DT             PIC X(2).
  4722
  4723         16  FILLER                      PIC X(09).
  4724         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4725         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4726******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  86
* EL131.cbl
  4727
  4728*                                COPY ELCCNTL.
  4729******************************************************************
  4730*                                                                *
  4731*                                                                *
  4732*                            ELCCNTL.                            *
  4733*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4734*                            VMOD=2.059                          *
  4735*                                                                *
  4736*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4737*                                                                *
  4738*   FILE TYPE = VSAM,KSDS                                        *
  4739*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4740*                                                                *
  4741*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4742*       ALTERNATE INDEX = NONE                                   *
  4743*                                                                *
  4744*   LOG = YES                                                    *
  4745*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4746******************************************************************
  4747*                   C H A N G E   L O G
  4748*
  4749* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4750*-----------------------------------------------------------------
  4751*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4752* EFFECTIVE    NUMBER
  4753*-----------------------------------------------------------------
  4754* 082503                   PEMA  ADD BENEFIT GROUP
  4755* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4756* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4757* 092705    2005050300006  PEMA  ADD SPP LEASES
  4758* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4759* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4760* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4761* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4762* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4763* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4764* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4765* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4766* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4767* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4768* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4769******************************************************************
  4770*
  4771 01  CONTROL-FILE.
  4772     12  CF-RECORD-ID                       PIC XX.
  4773         88  VALID-CF-ID                        VALUE 'CF'.
  4774
  4775     12  CF-CONTROL-PRIMARY.
  4776         16  CF-COMPANY-ID                  PIC XXX.
  4777         16  CF-RECORD-TYPE                 PIC X.
  4778             88  CF-COMPANY-MASTER              VALUE '1'.
  4779             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4780             88  CF-STATE-MASTER                VALUE '3'.
  4781             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4782             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4783             88  CF-CARRIER-MASTER              VALUE '6'.
  4784             88  CF-MORTALITY-MASTER            VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  87
* EL131.cbl
  4785             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4786             88  CF-TERMINAL-MASTER             VALUE '9'.
  4787             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4788             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4789             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4790             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4791             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4792             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4793             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4794             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4795             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4796         16  CF-ACCESS-CD-GENL              PIC X(4).
  4797         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4798             20  CF-PROCESSOR               PIC X(4).
  4799         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4800             20  CF-STATE-CODE              PIC XX.
  4801             20  FILLER                     PIC XX.
  4802         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4803             20  FILLER                     PIC XX.
  4804             20  CF-HI-BEN-IN-REC           PIC XX.
  4805         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4806             20  FILLER                     PIC XXX.
  4807             20  CF-CARRIER-CNTL            PIC X.
  4808         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4809             20  FILLER                     PIC XX.
  4810             20  CF-HI-TYPE-IN-REC          PIC 99.
  4811         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4812             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4813                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4814             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4815             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4816         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4817             20  FILLER                     PIC X.
  4818             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4819         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4820             20  FILLER                     PIC XX.
  4821             20  CF-MORTGAGE-PLAN           PIC XX.
  4822         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4823
  4824     12  CF-LAST-MAINT-DT                   PIC XX.
  4825     12  CF-LAST-MAINT-BY                   PIC X(4).
  4826     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4827
  4828     12  CF-RECORD-BODY                     PIC X(728).
  4829
  4830
  4831****************************************************************
  4832*             COMPANY MASTER RECORD                            *
  4833****************************************************************
  4834
  4835     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4836         16  CF-COMPANY-ADDRESS.
  4837             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4838             20  CF-CL-IN-CARE-OF           PIC X(30).
  4839             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4840             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4841             20  CF-CL-CITY-STATE           PIC X(30).
  4842             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  88
* EL131.cbl
  4843             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4844         16  CF-COMPANY-CD                  PIC X.
  4845         16  CF-COMPANY-PASSWORD            PIC X(8).
  4846         16  CF-SECURITY-OPTION             PIC X.
  4847             88  ALL-SECURITY                   VALUE '1'.
  4848             88  COMPANY-VERIFY                 VALUE '2'.
  4849             88  PROCESSOR-VERIFY               VALUE '3'.
  4850             88  NO-SECURITY                    VALUE '4'.
  4851             88  ALL-BUT-TERM                   VALUE '5'.
  4852         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4853             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4854         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4855             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4856         16  CF-INFORCE-LOCATION            PIC X.
  4857             88  CERTS-ARE-ONLINE               VALUE '1'.
  4858             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4859             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4860         16  CF-LOWER-CASE-LETTERS          PIC X.
  4861         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4862             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4863             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4864             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4865             88  CF-ACCNT-CNTL                  VALUE '3'.
  4866             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4867
  4868         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4869         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4870
  4871         16  CF-LGX-CREDIT-USER             PIC X.
  4872             88  CO-IS-NOT-USER                 VALUE 'N'.
  4873             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4874
  4875         16 CF-CREDIT-CALC-CODES.
  4876             20  CF-CR-REM-TERM-CALC PIC X.
  4877               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4878               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4879               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4880               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4881               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4882               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4883               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4884             20  CF-CR-R78-METHOD           PIC X.
  4885               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4886               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4887
  4888         16  CF-CLAIM-CONTROL-COUNTS.
  4889             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4890                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4891
  4892             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4893                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4894
  4895             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4896                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4897
  4898             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4899                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4900
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  89
* EL131.cbl
  4901         16  CF-CURRENT-MONTH-END           PIC XX.
  4902
  4903         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4904             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4905             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4906             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4907             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4908                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4909                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4910             20  CF-CO-PREM-REJECT-SW       PIC X.
  4911                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4912                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4913             20  CF-CO-REF-REJECT-SW        PIC X.
  4914                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4915                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4916
  4917         16  CF-CO-REPORTING-DT             PIC XX.
  4918         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4919         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4920           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4921           88  CF-CO-MONTH-END                  VALUE '1'.
  4922
  4923         16  CF-LGX-CLAIM-USER              PIC X.
  4924             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4925             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4926
  4927         16  CF-CREDIT-EDIT-CONTROLS.
  4928             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4929             20  CF-MIN-AGE                 PIC 99.
  4930             20  CF-DEFAULT-AGE             PIC 99.
  4931             20  CF-MIN-TERM                PIC S999      COMP-3.
  4932             20  CF-MAX-TERM                PIC S999      COMP-3.
  4933             20  CF-DEFAULT-SEX             PIC X.
  4934             20  CF-JOINT-AGE-INPUT         PIC X.
  4935                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4936             20  CF-BIRTH-DATE-INPUT        PIC X.
  4937                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4938             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4939                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4940                 88  CF-ZERO-CARRIER            VALUE '1'.
  4941                 88  CF-ZERO-GROUPING           VALUE '2'.
  4942                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4943             20  CF-EDIT-SW                 PIC X.
  4944                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4945             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4946             20  CF-CR-PR-METHOD            PIC X.
  4947               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4948               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4949             20  FILLER                     PIC X.
  4950
  4951         16  CF-CREDIT-MISC-CONTROLS.
  4952             20  CF-REIN-TABLE-SW           PIC X.
  4953                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4954             20  CF-COMP-TABLE-SW           PIC X.
  4955                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4956             20  CF-EXPERIENCE-RETENTION-AGE
  4957                                            PIC S9        COMP-3.
  4958             20  CF-CONVERSION-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  90
* EL131.cbl
  4959             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4960             20  CF-RUN-FREQUENCY-SW        PIC X.
  4961                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4962                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4963
  4964             20  CF-CR-CHECK-NO-CONTROL.
  4965                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4966                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4967                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4968                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4969                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4970                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4971
  4972                 24  CF-CR-CHECK-COUNT       REDEFINES
  4973                     CF-CR-CHECK-COUNTER      PIC X(4).
  4974
  4975                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4976                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4977
  4978                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4979                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4980                 24  CF-MAIL-PROCESSING       PIC X.
  4981                     88  MAIL-PROCESSING          VALUE 'Y'.
  4982
  4983         16  CF-MISC-SYSTEM-CONTROL.
  4984             20  CF-SYSTEM-C                 PIC X.
  4985                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4986             20  CF-SYSTEM-D                 PIC X.
  4987                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4988             20  CF-SOC-SEC-NO-SW            PIC X.
  4989                 88  SOC-SEC-NO-USED             VALUE '1'.
  4990             20  CF-MEMBER-NO-SW             PIC X.
  4991                 88  MEMBER-NO-USED              VALUE '1'.
  4992             20  CF-TAX-ID-NUMBER            PIC X(11).
  4993             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4994             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4995                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4996                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4997                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4998                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4999             20  CF-SYSTEM-E                 PIC X.
  5000                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5001
  5002         16  CF-LGX-LIFE-USER               PIC X.
  5003             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5004             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5005
  5006         16  CF-CR-MONTH-END-DT             PIC XX.
  5007
  5008         16  CF-FILE-MAINT-DATES.
  5009             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5010                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5011             20  CF-LAST-BATCH       REDEFINES
  5012                 CF-LAST-BATCH-NO               PIC X(4).
  5013             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5014             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5015             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5016             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  91
* EL131.cbl
  5017             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5018             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5019             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5020             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5021             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5022             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5023
  5024         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5025         16  FILLER                         PIC X.
  5026
  5027         16  CF-ALT-MORT-CODE               PIC X(4).
  5028         16  CF-MEMBER-CAPTION              PIC X(10).
  5029
  5030         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5031             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5032             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5033             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5034             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5035             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5036
  5037         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5038
  5039         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5040         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5041         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5042         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5043
  5044         16  CF-AH-OVERRIDE-L1              PIC X.
  5045         16  CF-AH-OVERRIDE-L2              PIC XX.
  5046         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5047         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5048
  5049         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5050         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5051
  5052         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5053         16  CF-AR-LAST-EL860-DT            PIC XX.
  5054         16  CF-MP-MONTH-END-DT             PIC XX.
  5055
  5056         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5057         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5058             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5059
  5060         16  CF-AR-MONTH-END-DT             PIC XX.
  5061
  5062         16  CF-CRDTCRD-USER                PIC X.
  5063             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5064             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5065
  5066         16  CF-CC-MONTH-END-DT             PIC XX.
  5067
  5068         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5069
  5070         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5071             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5072             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5073             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5074         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  92
* EL131.cbl
  5075         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5076         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5077         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5078             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5079             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5080         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5081         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5082         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5083             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5084         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5085
  5086         16  CF-CL-ZIP-CODE.
  5087             20  CF-CL-ZIP-PRIME.
  5088                 24  CF-CL-ZIP-1ST          PIC X.
  5089                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5090                 24  FILLER                 PIC X(4).
  5091             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5092         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5093             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5094             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5095             20  FILLER                     PIC XXX.
  5096
  5097         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5098         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5099         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5100         16  CF-CO-OPTION-START-DATE        PIC XX.
  5101         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5102           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5103                                                      '3' '4'.
  5104           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5105           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5106           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5107           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5108           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5109           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5110
  5111         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5112
  5113         16  CF-PAYMENT-APPROVAL-LEVELS.
  5114             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5115             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5116             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5117             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5118             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5119             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5120
  5121         16  CF-END-USER-REPORTING-USER     PIC X.
  5122             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5123             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5124
  5125         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5126             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5127             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5128
  5129         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5130
  5131         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5132         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  93
* EL131.cbl
  5133
  5134         16  CF-CREDIT-ARCHIVE-CNTL.
  5135             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5136             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5137             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5138
  5139         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5140
  5141         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5142             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5143             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5144
  5145         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5146             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5147             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5148
  5149         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5150
  5151         16  CF-CO-ACH-ID-CODE              PIC  X.
  5152             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5153             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5154             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5155         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5156         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5157         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5158         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5159         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5160         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5161         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5162         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5163         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5164                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5165         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5166                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5167
  5168         16  CF-CO-OVER-SHORT.
  5169             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5170             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5171
  5172*         16  FILLER                         PIC X(102).
  5173         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5174             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5175             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5176
  5177         16  CF-AH-APPROVAL-DAYS.
  5178             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5179             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5180             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5181             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5182
  5183         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5184
  5185         16  CF-APPROV-LEV-5.
  5186             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5187             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5188             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5189
  5190         16  FILLER                         PIC X(68).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  94
* EL131.cbl
  5191****************************************************************
  5192*             PROCESSOR/USER RECORD                            *
  5193****************************************************************
  5194
  5195     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5196         16  CF-PROCESSOR-NAME              PIC X(30).
  5197         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5198         16  CF-PROCESSOR-TITLE             PIC X(26).
  5199         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5200                 88  MESSAGE-YES                VALUE 'Y'.
  5201                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5202
  5203*****************************************************
  5204****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5205****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5206****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5207****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5208*****************************************************
  5209
  5210         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5211             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5212             20  CF-APPLICATION-FORCE       PIC X.
  5213             20  CF-INDIVIDUAL-APP.
  5214                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5215                     28  CF-BROWSE-APP      PIC X.
  5216                     28  CF-UPDATE-APP      PIC X.
  5217
  5218         16  CF-CURRENT-TERM-ON             PIC X(4).
  5219         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5220             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5221             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5222             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5223             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5224             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5225             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5226             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5227         16  CF-PROCESSOR-CARRIER           PIC X.
  5228             88  NO-CARRIER-SECURITY            VALUE ' '.
  5229         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5230             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5231         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5232             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5233         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5234             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5235
  5236         16  CF-PROC-SYS-ACCESS-SW.
  5237             20  CF-PROC-CREDIT-CLAIMS-SW.
  5238                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5239                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5240                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5241                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5242             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5243                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5244                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5245             20  CF-PROC-LIFE-GNRLDGR-SW.
  5246                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5247                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5248                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  95
* EL131.cbl
  5249                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5250             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5251                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5252                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5253         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5254             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5255             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5256         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5257
  5258         16  CF-APPROVAL-LEVEL                  PIC X.
  5259             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5260             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5261             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5262             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5263             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5264
  5265         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5266
  5267         16  CF-LANGUAGE-TYPE                   PIC X.
  5268             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5269             88  CF-LANG-IS-FR                      VALUE 'F'.
  5270
  5271         16  CF-CSR-IND                         PIC X.
  5272         16  FILLER                             PIC X(239).
  5273
  5274****************************************************************
  5275*             PROCESSOR/REMINDERS RECORD                       *
  5276****************************************************************
  5277
  5278     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5279         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5280             20  CF-START-REMIND-DT         PIC XX.
  5281             20  CF-END-REMIND-DT           PIC XX.
  5282             20  CF-REMINDER-TEXT           PIC X(50).
  5283         16  FILLER                         PIC X(296).
  5284
  5285
  5286****************************************************************
  5287*             STATE MASTER RECORD                              *
  5288****************************************************************
  5289
  5290     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5291         16  CF-STATE-ABBREVIATION          PIC XX.
  5292         16  CF-STATE-NAME                  PIC X(25).
  5293         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5294         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5295             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5296             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5297             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5298             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5299                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5300                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5301             20  CF-ST-PREM-REJECT-SW       PIC X.
  5302                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5303                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5304             20  CF-ST-REF-REJECT-SW        PIC X.
  5305                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5306                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  96
* EL131.cbl
  5307         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5308         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5309         16  CF-ST-REFUND-RULES.
  5310             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5311             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5312             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5313         16  CF-ST-FST-PMT-EXTENSION.
  5314             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5315             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5316                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5317                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5318                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5319                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5320         16  CF-ST-STATE-CALL.
  5321             20  CF-ST-CALL-UNEARNED        PIC X.
  5322             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5323             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5324         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5325             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5326             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5327         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5328         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5329         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5330         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5331         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5332         16  FILLER                         PIC X.
  5333         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5334             20  CF-ST-BENEFIT-CD           PIC XX.
  5335             20  CF-ST-BENEFIT-KIND         PIC X.
  5336                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5337                 88  CF-ST-AH-KIND              VALUE 'A'.
  5338             20  CF-ST-REM-TERM-CALC        PIC X.
  5339                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5340                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5341                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5342                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5343                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5344                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5345                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5346                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5347
  5348             20  CF-ST-REFUND-CALC          PIC X.
  5349                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5350                 88  ST-REFD-BY-R78             VALUE '1'.
  5351                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5352                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5353                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5354                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5355                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5356                 88  ST-REFD-UTAH               VALUE '7'.
  5357                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5358                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5359                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5360
  5361             20  CF-ST-EARNING-CALC         PIC X.
  5362                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5363                 88  ST-EARN-BY-R78             VALUE '1'.
  5364                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  97
* EL131.cbl
  5365                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5366                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5367                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5368                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5369                 88  ST-EARN-MEAN               VALUE '8'.
  5370                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5371
  5372             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5373                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5374                 88  ST-OVRD-BY-R78             VALUE '1'.
  5375                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5376                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5377                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5378                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5379                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5380                 88  ST-OVRD-MEAN               VALUE '8'.
  5381                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5382             20  cf-st-extra-periods        pic 9.
  5383*            20  FILLER                     PIC X.
  5384
  5385         16  CF-ST-COMMISSION-CAPS.
  5386             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5387             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5388             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5389             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5390         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5391                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5392                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5393                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5394
  5395         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5396
  5397         16  CF-ST-STATUTORY-INTEREST.
  5398             20  CF-ST-STAT-DATE-FROM       PIC X.
  5399                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5400                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5401             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5402             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5403             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5404             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5405             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5406
  5407         16  CF-ST-OVER-SHORT.
  5408             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5409             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5410
  5411         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5412
  5413         16  CF-ST-RT-CALC                  PIC X.
  5414
  5415         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5416         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5417         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5418         16  CF-ST-RF-LR-CALC               PIC X.
  5419         16  CF-ST-RF-LL-CALC               PIC X.
  5420         16  CF-ST-RF-LN-CALC               PIC X.
  5421         16  CF-ST-RF-AH-CALC               PIC X.
  5422         16  CF-ST-RF-CP-CALC               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  98
* EL131.cbl
  5423*        16  FILLER                         PIC X(206).
  5424*CIDMOD         16  FILLER                         PIC X(192).
  5425         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5426             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5427         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5428         16  CF-ST-VFY-2ND-BENE             PIC X.
  5429         16  CF-ST-CAUSAL-STATE             PIC X.
  5430         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5431         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5432         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5433             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5434         16  CF-ST-NET-ONLY-STATE           PIC X.
  5435             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5436         16  cf-commission-cap-required     pic x.
  5437         16  CF-ST-GA-COMMISSION-CAPS.
  5438             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5439             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5440             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5441             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5442         16  CF-ST-TOT-COMMISSION-CAPS.
  5443             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5444             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5445             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5446             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5447         16  FILLER                         PIC X(156).
  5448
  5449****************************************************************
  5450*             BENEFIT MASTER RECORD                            *
  5451****************************************************************
  5452
  5453     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5454         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5455             20  CF-BENEFIT-CODE            PIC XX.
  5456             20  CF-BENEFIT-NUMERIC  REDEFINES
  5457                 CF-BENEFIT-CODE            PIC XX.
  5458             20  CF-BENEFIT-ALPHA           PIC XXX.
  5459             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5460             20  CF-BENEFIT-COMMENT         PIC X(10).
  5461
  5462             20  CF-LF-COVERAGE-TYPE        PIC X.
  5463                 88  CF-REDUCING                VALUE 'R'.
  5464                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5465
  5466             20  CF-SPECIAL-CALC-CD         PIC X.
  5467                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5468                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5469                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5470                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5471                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5472                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5473                 88  CF-FARM-PLAN               VALUE 'F'.
  5474                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5475                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5476                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5477                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5478                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5479                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5480                 88  CF-PRUDENTIAL              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page  99
* EL131.cbl
  5481                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5482                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5483                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5484                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5485                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5486                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5487
  5488             20  CF-JOINT-INDICATOR         PIC X.
  5489                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5490
  5491*            20  FILLER                     PIC X(12).
  5492             20  cf-maximum-benefits        pic s999 comp-3.
  5493             20  FILLER                     PIC X(09).
  5494             20  CF-BENEFIT-CATEGORY        PIC X.
  5495             20  CF-LOAN-TYPE               PIC X(8).
  5496
  5497             20  CF-CO-REM-TERM-CALC        PIC X.
  5498                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5499                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5500                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5501                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5502                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5503
  5504             20  CF-CO-EARNINGS-CALC        PIC X.
  5505                 88  CO-EARN-BY-R78             VALUE '1'.
  5506                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5507                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5508                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5509                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5510                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5511                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5512                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5513
  5514             20  CF-CO-REFUND-CALC          PIC X.
  5515                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5516                 88  CO-REFD-BY-R78             VALUE '1'.
  5517                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5518                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5519                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5520                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5521                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5522                 88  CO-REFD-MEAN               VALUE '8'.
  5523                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5524                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5525                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5526
  5527             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5528                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5529                 88  CO-OVRD-BY-R78             VALUE '1'.
  5530                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5531                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5532                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5533                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5534                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5535                 88  CO-OVRD-MEAN               VALUE '8'.
  5536                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5537
  5538             20  CF-CO-BEN-I-G-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 100
* EL131.cbl
  5539                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5540                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5541                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5542
  5543         16  FILLER                         PIC X(304).
  5544
  5545
  5546****************************************************************
  5547*             CARRIER MASTER RECORD                            *
  5548****************************************************************
  5549
  5550     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5551         16  CF-ADDRESS-DATA.
  5552             20  CF-MAIL-TO-NAME            PIC X(30).
  5553             20  CF-IN-CARE-OF              PIC X(30).
  5554             20  CF-ADDRESS-LINE-1          PIC X(30).
  5555             20  CF-ADDRESS-LINE-2          PIC X(30).
  5556             20  CF-CITY-STATE              PIC X(30).
  5557             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5558             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5559
  5560         16  CF-CLAIM-NO-CONTROL.
  5561             20  CF-CLAIM-NO-METHOD         PIC X.
  5562                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5563                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5564                 88  CLAIM-NO-SEQ               VALUE '3'.
  5565                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5566             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5567                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5568                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5569                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5570
  5571         16  CF-CHECK-NO-CONTROL.
  5572             20  CF-CHECK-NO-METHOD         PIC X.
  5573                 88  CHECK-NO-MANUAL            VALUE '1'.
  5574                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5575                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5576                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5577             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5578                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5579
  5580         16  CF-DOMICILE-STATE              PIC XX.
  5581
  5582         16  CF-EXPENSE-CONTROLS.
  5583             20  CF-EXPENSE-METHOD          PIC X.
  5584                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5585                 88  DOLLARS-PER-PMT            VALUE '2'.
  5586                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5587                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5588             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5589             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5590
  5591         16  CF-CORRESPONDENCE-CONTROL.
  5592             20  CF-LETTER-RESEND-OPT       PIC X.
  5593                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5594                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5595             20  FILLER                     PIC X(4).
  5596
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 101
* EL131.cbl
  5597         16  CF-RESERVE-CONTROLS.
  5598             20  CF-MANUAL-SW               PIC X.
  5599                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5600             20  CF-FUTURE-SW               PIC X.
  5601                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5602             20  CF-PTC-SW                  PIC X.
  5603                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5604             20  CF-IBNR-SW                 PIC X.
  5605                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5606             20  CF-PTC-LF-SW               PIC X.
  5607                 88  CF-LF-PTC-USED             VALUE '1'.
  5608             20  CF-CDT-ACCESS-METHOD       PIC X.
  5609                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5610                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5611                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5612             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5613
  5614         16  CF-CLAIM-CALC-METHOD           PIC X.
  5615             88  360-PLUS-MONTHS                VALUE '1'.
  5616             88  365-PLUS-MONTHS                VALUE '2'.
  5617             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5618             88  360-DAILY                      VALUE '4'.
  5619             88  365-DAILY                      VALUE '5'.
  5620
  5621         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5622         16  FILLER                         PIC X(11).
  5623
  5624         16  CF-LIMIT-AMOUNTS.
  5625             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5626             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5627             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5628             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5629             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5630             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5631             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5632             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5633             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5634             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5635
  5636         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5637         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5638         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5639
  5640         16  CF-ZIP-CODE.
  5641             20  CF-ZIP-PRIME.
  5642                 24  CF-ZIP-1ST             PIC X.
  5643                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5644                 24  FILLER                 PIC X(4).
  5645             20  CF-ZIP-PLUS4               PIC X(4).
  5646         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5647             20  CF-CAN-POSTAL-1            PIC XXX.
  5648             20  CF-CAN-POSTAL-2            PIC XXX.
  5649             20  FILLER                     PIC XXX.
  5650
  5651         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5652         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5653         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5654
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 102
* EL131.cbl
  5655         16  CF-RATING-SWITCH               PIC X.
  5656             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5657             88  CF-NO-RATING                   VALUE 'N'.
  5658
  5659         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5660
  5661         16  CF-CARRIER-OVER-SHORT.
  5662             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5663             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5664
  5665         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5666         16  CF-SECPAY-SWITCH               PIC X.
  5667             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5668             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5669         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5670         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5671         16  FILLER                         PIC X(444).
  5672*        16  FILLER                         PIC X(452).
  5673
  5674
  5675****************************************************************
  5676*             MORTALITY MASTER RECORD                          *
  5677****************************************************************
  5678
  5679     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5680         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5681                                INDEXED BY CF-MORT-NDX.
  5682             20  CF-MORT-TABLE              PIC X(5).
  5683             20  CF-MORT-TABLE-TYPE         PIC X.
  5684                 88  CF-MORT-JOINT              VALUE 'J'.
  5685                 88  CF-MORT-SINGLE             VALUE 'S'.
  5686                 88  CF-MORT-COMBINED           VALUE 'C'.
  5687                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5688                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5689             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5690             20  CF-MORT-AGE-METHOD         PIC XX.
  5691                 88  CF-AGE-LAST                VALUE 'AL'.
  5692                 88  CF-AGE-NEAR                VALUE 'AN'.
  5693             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5694             20  CF-MORT-ADJUSTMENT-DIRECTION
  5695                                            PIC X.
  5696                 88  CF-MINUS                   VALUE '-'.
  5697                 88  CF-PLUS                    VALUE '+'.
  5698             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5699             20  CF-MORT-JOINT-CODE         PIC X.
  5700                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5701             20  CF-MORT-PC-Q               PIC X.
  5702                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5703             20  CF-MORT-TABLE-CODE         PIC X(4).
  5704             20  CF-MORT-COMMENTS           PIC X(15).
  5705             20  FILLER                     PIC X(14).
  5706
  5707         16  FILLER                         PIC X(251).
  5708
  5709
  5710****************************************************************
  5711*             BUSSINESS TYPE MASTER RECORD                     *
  5712****************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 103
* EL131.cbl
  5713
  5714     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5715* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5716* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5717* AND RECORD 05 IS TYPES 81-99
  5718         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5719             20  CF-BUSINESS-TITLE          PIC  X(19).
  5720             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5721                                            PIC S9V9(4) COMP-3.
  5722             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5723             20  FILLER                     PIC  X.
  5724         16  FILLER                         PIC  X(248).
  5725
  5726
  5727****************************************************************
  5728*             TERMINAL MASTER RECORD                           *
  5729****************************************************************
  5730
  5731     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5732
  5733         16  CF-COMPANY-TERMINALS.
  5734             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5735                                  PIC X(4).
  5736         16  FILLER               PIC X(248).
  5737
  5738
  5739****************************************************************
  5740*             LIFE EDIT MASTER RECORD                          *
  5741****************************************************************
  5742
  5743     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5744         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5745             20  CF-LIFE-CODE-IN            PIC XX.
  5746             20  CF-LIFE-CODE-OUT           PIC XX.
  5747         16  FILLER                         PIC X(248).
  5748
  5749
  5750****************************************************************
  5751*             AH EDIT MASTER RECORD                            *
  5752****************************************************************
  5753
  5754     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5755         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5756             20  CF-AH-CODE-IN              PIC XXX.
  5757             20  CF-AH-CODE-OUT             PIC XX.
  5758         16  FILLER                         PIC X(248).
  5759
  5760
  5761****************************************************************
  5762*             CREDIBILITY TABLES                               *
  5763****************************************************************
  5764
  5765     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5766         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5767                             INDEXED BY CF-CRDB-NDX.
  5768             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5769             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5770             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 104
* EL131.cbl
  5771         16  FILLER                         PIC  X(332).
  5772
  5773
  5774****************************************************************
  5775*             REPORT CUSTOMIZATION RECORD                      *
  5776****************************************************************
  5777
  5778     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5779         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5780             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5781             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5782             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5783**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5784****       A T-TRANSFER.                                   ****
  5785             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5786
  5787         16  FILLER                         PIC XX.
  5788
  5789         16  CF-CARRIER-CNTL-OPT.
  5790             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5791                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5792                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5793             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5794                                            PIC X.
  5795         16  CF-GROUP-CNTL-OPT.
  5796             20  CF-GROUP-OPT-SEQ           PIC 9.
  5797                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5798                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5799             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5800                                            PIC X(6).
  5801         16  CF-STATE-CNTL-OPT.
  5802             20  CF-STATE-OPT-SEQ           PIC 9.
  5803                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5804                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5805             20  CF-STATE-SELECT OCCURS 3 TIMES
  5806                                            PIC XX.
  5807         16  CF-ACCOUNT-CNTL-OPT.
  5808             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5809                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5810                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5811             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5812                                            PIC X(10).
  5813         16  CF-BUS-TYP-CNTL-OPT.
  5814             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5815                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5816                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5817             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5818                                            PIC XX.
  5819         16  CF-LF-TYP-CNTL-OPT.
  5820             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5821                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5822                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5823             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5824                                            PIC XX.
  5825         16  CF-AH-TYP-CNTL-OPT.
  5826             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5827                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5828                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 105
* EL131.cbl
  5829             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5830                                            PIC XX.
  5831         16  CF-REPTCD1-CNTL-OPT.
  5832             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5833                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5834                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5835             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5836                                            PIC X(10).
  5837         16  CF-REPTCD2-CNTL-OPT.
  5838             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5839                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5840                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5841             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5842                                            PIC X(10).
  5843         16  CF-USER1-CNTL-OPT.
  5844             20  CF-USER1-OPT-SEQ           PIC 9.
  5845                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5846                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5847             20  CF-USER1-SELECT OCCURS 3 TIMES
  5848                                            PIC X(10).
  5849         16  CF-USER2-CNTL-OPT.
  5850             20  CF-USER2-OPT-SEQ           PIC 9.
  5851                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5852                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5853             20  CF-USER2-SELECT OCCURS 3 TIMES
  5854                                            PIC X(10).
  5855         16  CF-USER3-CNTL-OPT.
  5856             20  CF-USER3-OPT-SEQ           PIC 9.
  5857                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5858                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5859             20  CF-USER3-SELECT OCCURS 3 TIMES
  5860                                            PIC X(10).
  5861         16  CF-USER4-CNTL-OPT.
  5862             20  CF-USER4-OPT-SEQ           PIC 9.
  5863                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5864                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5865             20  CF-USER4-SELECT OCCURS 3 TIMES
  5866                                            PIC X(10).
  5867         16  CF-USER5-CNTL-OPT.
  5868             20  CF-USER5-OPT-SEQ           PIC 9.
  5869                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5870                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5871             20  CF-USER5-SELECT OCCURS 3 TIMES
  5872                                            PIC X(10).
  5873         16  CF-REINS-CNTL-OPT.
  5874             20  CF-REINS-OPT-SEQ           PIC 9.
  5875                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5876                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5877             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5878                 24  CF-REINS-PRIME         PIC XXX.
  5879                 24  CF-REINS-SUB           PIC XXX.
  5880
  5881         16  CF-AGENT-CNTL-OPT.
  5882             20  CF-AGENT-OPT-SEQ           PIC 9.
  5883                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5884                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5885             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5886                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 106
* EL131.cbl
  5887
  5888         16  FILLER                         PIC X(43).
  5889
  5890         16  CF-LOSS-RATIO-SELECT.
  5891             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5892             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5893         16  CF-ENTRY-DATE-SELECT.
  5894             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5895             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5896         16  CF-EFFECTIVE-DATE-SELECT.
  5897             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5898             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5899
  5900         16  CF-EXCEPTION-LIST-IND          PIC X.
  5901             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5902
  5903         16  FILLER                         PIC X(318).
  5904
  5905****************************************************************
  5906*                  EXCEPTION REPORTING RECORD                  *
  5907****************************************************************
  5908
  5909     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5910         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5911             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5912
  5913         16  CF-COMBINED-LIFE-AH-OPT.
  5914             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5915             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5916             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5917             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5918
  5919         16  CF-LIFE-OPT.
  5920             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5921             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5922             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5923             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5924             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5925             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5926             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5927             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5928             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5929             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5930
  5931         16  CF-AH-OPT.
  5932             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5933             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5934             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5935             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5936             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5937             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5938             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5939             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5940             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5941             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5942
  5943         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5944             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 107
* EL131.cbl
  5945             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5946             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5947
  5948         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5949
  5950         16  FILLER                         PIC X(673).
  5951
  5952
  5953****************************************************************
  5954*             MORTGAGE SYSTEM PLAN RECORD                      *
  5955****************************************************************
  5956
  5957     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5958         16  CF-PLAN-TYPE                   PIC X.
  5959             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5960             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5961             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5962         16  CF-PLAN-ABBREV                 PIC XXX.
  5963         16  CF-PLAN-DESCRIPT               PIC X(10).
  5964         16  CF-PLAN-NOTES                  PIC X(20).
  5965         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5966         16  CF-PLAN-UNDERWRITING.
  5967             20  CF-PLAN-TERM-DATA.
  5968                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5969                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5970             20  CF-PLAN-AGE-DATA.
  5971                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5972                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5973                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5974             20  CF-PLAN-BENEFIT-DATA.
  5975                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5976                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5977                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5978                                            PIC S9(7)V99  COMP-3.
  5979         16  CF-PLAN-POLICY-FORMS.
  5980             20  CF-POLICY-FORM             PIC X(12).
  5981             20  CF-MASTER-APPLICATION      PIC X(12).
  5982             20  CF-MASTER-POLICY           PIC X(12).
  5983         16  CF-PLAN-RATING.
  5984             20  CF-RATE-CODE               PIC X(5).
  5985             20  CF-SEX-RATING              PIC X.
  5986                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5987                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5988             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5989             20  CF-SUB-STD-TYPE            PIC X.
  5990                 88  CF-PCT-OF-PREM            VALUE '1'.
  5991                 88  CF-PCT-OF-BENE            VALUE '2'.
  5992         16  CF-PLAN-PREM-TOLERANCES.
  5993             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5994             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5995         16  CF-PLAN-PYMT-TOLERANCES.
  5996             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5997             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5998         16  CF-PLAN-MISC-DATA.
  5999             20  FILLER                     PIC X.
  6000             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6001             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6002         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 108
* EL131.cbl
  6003         16  CF-PLAN-IND-GRP                PIC X.
  6004             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6005                                                     '1'.
  6006             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6007                                                     '2'.
  6008         16  CF-MIB-SEARCH-SW               PIC X.
  6009             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6010             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6011             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6012             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6013         16  CF-ALPHA-SEARCH-SW             PIC X.
  6014             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6015             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6016             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6017             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6018             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6019             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6020             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6021             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6022             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6023             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6024                                                     'A' 'B' 'C'
  6025                                                     'X' 'Y' 'Z'.
  6026         16  CF-EFF-DT-RULE-SW              PIC X.
  6027             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6028             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6029             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6030             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6031             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6032         16  FILLER                         PIC X(4).
  6033         16  CF-HEALTH-QUESTIONS            PIC X.
  6034             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6035         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6036         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6037         16  CF-PLAN-SNGL-JNT               PIC X.
  6038             88  CF-COMBINED-PLAN              VALUE 'C'.
  6039             88  CF-JNT-PLAN                   VALUE 'J'.
  6040             88  CF-SNGL-PLAN                  VALUE 'S'.
  6041         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6042         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6043         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6044         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6045         16  CF-RERATE-CNTL                 PIC  X.
  6046             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6047             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6048             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6049             88  CF-AUTO-RECALC                 VALUE '4'.
  6050         16  CF-BENEFIT-TYPE                PIC  X.
  6051             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6052             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6053         16  CF-POLICY-FEE                  PIC S999V99
  6054                                                    COMP-3.
  6055         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6056         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6057         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6058         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6059         16  FILLER                         PIC  X(32).
  6060         16  CF-TERMINATION-FORM            PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 109
* EL131.cbl
  6061         16  FILLER                         PIC  X(08).
  6062         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6063                                                       COMP-3.
  6064         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6065         16  CF-ISSUE-LETTER                PIC  X(4).
  6066         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6067         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6068             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6069             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6070         16  CF-MP-REFUND-CALC              PIC X.
  6071             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6072             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6073             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6074             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6075             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6076             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6077             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6078             88  CF-MP-REFD-MEAN                VALUE '8'.
  6079         16  CF-ALT-RATE-CODE               PIC  X(5).
  6080
  6081
  6082         16  FILLER                         PIC X(498).
  6083****************************************************************
  6084*             MORTGAGE COMPANY MASTER RECORD                   *
  6085****************************************************************
  6086
  6087     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6088         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6089         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6090             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6091             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6092             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6093             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6094             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6095
  6096         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6097         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6098         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6099         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6100         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6101
  6102         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6103             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6104         16  CF-MP-RECON-USE-IND            PIC X(1).
  6105             88  CF-MP-USE-RECON             VALUE 'Y'.
  6106         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6107             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6108         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6109             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6110             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6111         16  FILLER                         PIC X(1).
  6112         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6113             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6114         16  CF-MORTG-MIB-VERSION           PIC X.
  6115             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6116             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6117             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6118         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 110
* EL131.cbl
  6119             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6120                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6121             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6122                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6123             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6124                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6125             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6126                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6127             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6128                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6129             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6130                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6131         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6132         16  FILLER                         PIC X(7).
  6133         16  CF-MORTG-DESTINATION-SYMBOL.
  6134             20  CF-MORTG-MIB-COMM          PIC X(5).
  6135             20  CF-MORTG-MIB-TERM          PIC X(5).
  6136         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6137             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6138         16  FILLER                         PIC X(03).
  6139         16  CF-MP-CHECK-NO-CONTROL.
  6140             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6141                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6142                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6143                                                ' ' LOW-VALUES.
  6144                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6145                                               VALUE '3'.
  6146         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6147         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6148         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6149             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6150                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6151             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6152                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6153             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6154                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6155             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6156                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6157             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6158                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6159             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6160                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6161         16  CF-MORTG-BILLING-AREA.
  6162             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6163                                            PIC X.
  6164         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6165         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6166         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6167         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6168             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6169             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6170         16  FILLER                         PIC X.
  6171         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6172             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6173             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6174         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6175         16  FILLER                         PIC X(8).
  6176         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 111
* EL131.cbl
  6177         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6178         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6179         16  CF-ACH-COMPANY-ID.
  6180             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6181                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6182                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6183                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6184             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6185         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6186             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6187         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6188             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6189             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6190         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6191         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6192         16  FILLER                         PIC X(536).
  6193
  6194****************************************************************
  6195*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6196****************************************************************
  6197
  6198     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6199         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6200             20  CF-FEMALE-HEIGHT.
  6201                 24  CF-FEMALE-FT           PIC 99.
  6202                 24  CF-FEMALE-IN           PIC 99.
  6203             20  CF-FEMALE-MIN-WT           PIC 999.
  6204             20  CF-FEMALE-MAX-WT           PIC 999.
  6205         16  FILLER                         PIC X(428).
  6206
  6207     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6208         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6209             20  CF-MALE-HEIGHT.
  6210                 24  CF-MALE-FT             PIC 99.
  6211                 24  CF-MALE-IN             PIC 99.
  6212             20  CF-MALE-MIN-WT             PIC 999.
  6213             20  CF-MALE-MAX-WT             PIC 999.
  6214         16  FILLER                         PIC X(428).
  6215******************************************************************
  6216*             AUTOMATIC ACTIVITY RECORD                          *
  6217******************************************************************
  6218     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6219         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6220             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6221             20  CF-SYS-LETTER-ID           PIC X(04).
  6222             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6223             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6224             20  CF-SYS-RESET-SW            PIC X(01).
  6225             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6226             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6227
  6228         16  FILLER                         PIC X(50).
  6229
  6230         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6231             20  CF-USER-ACTIVE-SW          PIC X(01).
  6232             20  CF-USER-LETTER-ID          PIC X(04).
  6233             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6234             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 112
* EL131.cbl
  6235             20  CF-USER-RESET-SW           PIC X(01).
  6236             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6237             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6238             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6239
  6240         16  FILLER                         PIC X(246).
  6241
  6242*                                COPY ELCACTQ.
  6243******************************************************************
  6244*                                                                *
  6245*                            ELCACTQ.                            *
  6246*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6247*                            VMOD=2.004                          *
  6248*                                                                *
  6249*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6250*                                                                *
  6251*   FILE TYPE = VSAM,KSDS                                        *
  6252*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6253*                                                                *
  6254*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6255*       ALTERNATE INDEX = NONE                                   *
  6256*                                                                *
  6257*   LOG = YES                                                    *
  6258*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6259*                                                                *
  6260*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6261******************************************************************
  6262
  6263 01  ACTIVITY-QUE.
  6264     12  AQ-RECORD-ID                PIC XX.
  6265         88  VALID-AQ-ID                VALUE 'AQ'.
  6266
  6267     12  AQ-CONTROL-PRIMARY.
  6268         16  AQ-COMPANY-CD           PIC X.
  6269         16  AQ-CARRIER              PIC X.
  6270         16  AQ-CLAIM-NO             PIC X(7).
  6271         16  AQ-CERT-NO.
  6272             20  AQ-CERT-PRIME       PIC X(10).
  6273             20  AQ-CERT-SFX         PIC X.
  6274
  6275     12  AQ-PENDING-ACTIVITY-FLAGS.
  6276         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6277         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6278             88  PENDING-PAYMENTS       VALUE '1'.
  6279         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6280             88  PENDING-FULL-PRINT     VALUE '1'.
  6281             88  PENDING-PART-PRINT     VALUE '2'.
  6282         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6283             88  PENDING-LETTERS        VALUE '1'.
  6284         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6285             88  PENDING-RESTORE        VALUE 'C'.
  6286             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6287
  6288     12  FILLER                      PIC X(20).
  6289
  6290     12  AQ-RESEND-DATE              PIC XX.
  6291     12  AQ-FOLLOWUP-DATE            PIC XX.
  6292     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 113
* EL131.cbl
  6293     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6294     12  AQ-AUTO-LETTER              PIC X(4).
  6295     12  FILLER                      PIC XX.
  6296     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6297*****************************************************************
  6298
  6299*                                COPY ERCACCT.
  6300******************************************************************
  6301*                                                                *
  6302*                                                                *
  6303*                            ERCACCT                             *
  6304*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6305*                            VMOD=2.031                          *
  6306*                                                                *
  6307*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6308*                                                                *
  6309*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6310*   VSAM ACCOUNT MASTER FILES.                                   *
  6311*                                                                *
  6312*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6313*                                                                *
  6314*   FILE TYPE = VSAM,KSDS                                        *
  6315*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6316*                                                                *
  6317*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6318*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6319*                                                                *
  6320*   LOG = NO                                                     *
  6321*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6322*                                                                *
  6323*                                                                *
  6324******************************************************************
  6325*                   C H A N G E   L O G
  6326*
  6327* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6328*-----------------------------------------------------------------
  6329*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6330* EFFECTIVE    NUMBER
  6331*-----------------------------------------------------------------
  6332* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6333* 092705    2005050300006  PEMA  ADD SPP LEASES
  6334* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6335* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6336* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6337* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6338* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6339* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6340******************************************************************
  6341
  6342 01  ACCOUNT-MASTER.
  6343     12  AM-RECORD-ID                      PIC XX.
  6344         88  VALID-AM-ID                      VALUE 'AM'.
  6345
  6346     12  AM-CONTROL-PRIMARY.
  6347         16  AM-COMPANY-CD                 PIC X.
  6348         16  AM-MSTR-CNTRL.
  6349             20  AM-CONTROL-A.
  6350                 24  AM-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 114
* EL131.cbl
  6351                 24  AM-GROUPING.
  6352                     28 AM-GROUPING-PREFIX PIC XXX.
  6353                     28 AM-GROUPING-PRIME  PIC XXX.
  6354                 24  AM-STATE              PIC XX.
  6355                 24  AM-ACCOUNT.
  6356                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6357                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6358             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6359                                           PIC X(19).
  6360             20  AM-CNTRL-B.
  6361                 24  AM-EXPIRATION-DT      PIC XX.
  6362                 24  FILLER                PIC X(4).
  6363             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6364                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6365
  6366     12  AM-CONTROL-BY-VAR-GRP.
  6367         16  AM-COMPANY-CD-A1              PIC X.
  6368         16  AM-VG-CARRIER                 PIC X.
  6369         16  AM-VG-GROUPING                PIC X(6).
  6370         16  AM-VG-STATE                   PIC XX.
  6371         16  AM-VG-ACCOUNT                 PIC X(10).
  6372         16  AM-VG-DATE.
  6373             20  AM-VG-EXPIRATION-DT       PIC XX.
  6374             20  FILLER                    PIC X(4).
  6375         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6376                                           PIC 9(11)      COMP-3.
  6377     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6378         16  FILLER                        PIC X(10).
  6379         16  AM-VG-KEY3.
  6380             20  AM-VG3-ACCOUNT            PIC X(10).
  6381             20  AM-VG3-EXP-DT             PIC XX.
  6382         16  FILLER                        PIC X(4).
  6383     12  AM-MAINT-INFORMATION.
  6384         16  AM-LAST-MAINT-DT              PIC XX.
  6385         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6386         16  AM-LAST-MAINT-USER            PIC X(4).
  6387         16  FILLER                        PIC XX.
  6388
  6389     12  AM-EFFECTIVE-DT                   PIC XX.
  6390     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6391
  6392     12  AM-PREV-DATES  COMP-3.
  6393         16  AM-PREV-EXP-DT                PIC 9(11).
  6394         16  AM-PREV-EFF-DT                PIC 9(11).
  6395
  6396     12  AM-REPORT-CODE-1                  PIC X(10).
  6397     12  AM-REPORT-CODE-2                  PIC X(10).
  6398
  6399     12  AM-CITY-CODE                      PIC X(4).
  6400     12  AM-COUNTY-PARISH                  PIC X(6).
  6401
  6402     12  AM-NAME                           PIC X(30).
  6403     12  AM-PERSON                         PIC X(30).
  6404     12  AM-ADDRS                          PIC X(30).
  6405     12  AM-CITY.
  6406         16  AM-ADDR-CITY                  PIC X(28).
  6407         16  AM-ADDR-STATE                 PIC XX.
  6408     12  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 115
* EL131.cbl
  6409         16  AM-ZIP-PRIME.
  6410             20  AM-ZIP-PRI-1ST            PIC X.
  6411                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6412             20  FILLER                    PIC X(4).
  6413         16  AM-ZIP-PLUS4                  PIC X(4).
  6414     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6415         16  AM-CAN-POSTAL-1               PIC XXX.
  6416         16  AM-CAN-POSTAL-2               PIC XXX.
  6417         16  FILLER                        PIC XXX.
  6418     12  AM-TEL-NO.
  6419         16  AM-AREA-CODE                  PIC 999.
  6420         16  AM-TEL-PRE                    PIC 999.
  6421         16  AM-TEL-NBR                    PIC 9(4).
  6422     12  AM-TEL-LOC                        PIC X.
  6423         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6424         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6425
  6426     12  AM-COMM-STRUCTURE.
  6427         16  AM-DEFN-1.
  6428             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6429                 24  AM-AGT.
  6430                     28  AM-AGT-PREFIX     PIC X(4).
  6431                     28  AM-AGT-PRIME      PIC X(6).
  6432                 24  AM-COM-TYP            PIC X.
  6433                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6434                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6435                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6436                 24  AM-RECALC-LV-INDIC    PIC X.
  6437                 24  AM-RETRO-LV-INDIC     PIC X.
  6438                 24  AM-GL-CODES           PIC X.
  6439                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6440                 24  FILLER                PIC X(01).
  6441         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6442             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6443                 24  FILLER                PIC X(11).
  6444                 24  AM-L-COMA             PIC XXX.
  6445                 24  AM-J-COMA             PIC XXX.
  6446                 24  AM-A-COMA             PIC XXX.
  6447                 24  FILLER                PIC X(6).
  6448
  6449     12  AM-COMM-CHANGE-STATUS             PIC X.
  6450         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6451
  6452     12  AM-CSR-CODE                       PIC X(4).
  6453
  6454     12  AM-BILLING-STATUS                 PIC X.
  6455         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6456         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6457     12  AM-AUTO-REFUND-SW                 PIC X.
  6458         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6459         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6460     12  AM-GPCD                           PIC 99.
  6461     12  AM-IG                             PIC X.
  6462         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6463         88  AM-HAS-GROUP                     VALUE '2'.
  6464     12  AM-STATUS                         PIC X.
  6465         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6466         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 116
* EL131.cbl
  6467         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6468         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6469         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6470         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6471         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6472         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  6473         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6474         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6475     12  AM-REMIT-TO                       PIC 99.
  6476     12  AM-ID-NO                          PIC X(11).
  6477
  6478     12  AM-CAL-TABLE                      PIC XX.
  6479     12  AM-LF-DEVIATION                   PIC XXX.
  6480     12  AM-AH-DEVIATION                   PIC XXX.
  6481     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6482     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6483     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6484     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6485     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6486     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6487
  6488     12  AM-USER-FIELDS.
  6489         16  AM-FLD-1                      PIC XX.
  6490         16  AM-FLD-2                      PIC XX.
  6491         16  AM-FLD-3                      PIC XX.
  6492         16  AM-FLD-4                      PIC XX.
  6493         16  AM-FLD-5                      PIC XX.
  6494
  6495     12  AM-1ST-PROD-DATE.
  6496         16  AM-1ST-PROD-YR                PIC XX.
  6497         16  AM-1ST-PROD-MO                PIC XX.
  6498         16  AM-1ST-PROD-DA                PIC XX.
  6499     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6500     12  AM-CERTS-PURGED-DATE.
  6501         16  AM-PUR-YR                     PIC XX.
  6502         16  AM-PUR-MO                     PIC XX.
  6503         16  AM-PUR-DA                     PIC XX.
  6504     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6505     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6506     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6507     12  AM-INACTIVE-DATE.
  6508         16  AM-INA-MO                     PIC 99.
  6509         16  AM-INA-DA                     PIC 99.
  6510         16  AM-INA-YR                     PIC 99.
  6511     12  AM-AR-HI-CERT-DATE                PIC XX.
  6512
  6513     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6514     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6515
  6516     12  AM-OB-PAYMENT-MODE                PIC X.
  6517         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6518         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6519         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6520         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6521
  6522     12  AM-AH-ONLY-INDICATOR              PIC X.
  6523         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6524         88  AM-NO-AH-ONLY                    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 117
* EL131.cbl
  6525
  6526     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6527
  6528     12  AM-OVER-SHORT.
  6529         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6530         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6531
  6532     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6533     12  AM-DCC-CLP-STATE                  PIC XX.
  6534
  6535     12  AM-RECALC-COMM                    PIC X.
  6536     12  AM-RECALC-REIN                    PIC X.
  6537
  6538     12  AM-REI-TABLE                      PIC XXX.
  6539     12  AM-REI-ET-LF                      PIC X.
  6540     12  AM-REI-ET-AH                      PIC X.
  6541     12  AM-REI-PE-LF                      PIC X.
  6542     12  AM-REI-PE-AH                      PIC X.
  6543     12  AM-REI-PRT-ST                     PIC X.
  6544     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6545     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6546     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6547     12  AM-REI-GROUP-A                    PIC X(6).
  6548     12  AM-REI-MORT                       PIC X(4).
  6549     12  AM-REI-PRT-OW                     PIC X.
  6550     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6551     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6552     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6553     12  AM-REI-GROUP-B                    PIC X(6).
  6554
  6555     12  AM-TRUST-TYPE                     PIC X(2).
  6556
  6557     12  AM-EMPLOYER-STMT-USED             PIC X.
  6558     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6559
  6560     12  AM-STD-AH-TYPE                    PIC XX.
  6561     12  AM-EARN-METHODS.
  6562         16  AM-EARN-METHOD-R              PIC X.
  6563             88 AM-REF-RL-R78                 VALUE 'R'.
  6564             88 AM-REF-RL-PR                  VALUE 'P'.
  6565             88 AM-REF-RL-MEAN                VALUE 'M'.
  6566             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6567         16  AM-EARN-METHOD-L              PIC X.
  6568             88 AM-REF-LL-R78                 VALUE 'R'.
  6569             88 AM-REF-LL-PR                  VALUE 'P'.
  6570             88 AM-REF-LL-MEAN                VALUE 'M'.
  6571             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6572         16  AM-EARN-METHOD-A              PIC X.
  6573             88 AM-REF-AH-R78                 VALUE 'R'.
  6574             88 AM-REF-AH-PR                  VALUE 'P'.
  6575             88 AM-REF-AH-MEAN                VALUE 'M'.
  6576             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6577             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6578             88 AM-REF-AH-NET                 VALUE 'N'.
  6579
  6580     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6581     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6582     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 118
* EL131.cbl
  6583
  6584     12  AM-RET-Y-N                        PIC X.
  6585     12  AM-RET-P-E                        PIC X.
  6586     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6587     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6588     12  AM-RET-GRP                        PIC X(6).
  6589     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6590         16  AM-POOL-PRIME                 PIC XXX.
  6591         16  AM-POOL-SUB                   PIC XXX.
  6592     12  AM-RETRO-EARNINGS.
  6593         16  AM-RET-EARN-R                 PIC X.
  6594         16  AM-RET-EARN-L                 PIC X.
  6595         16  AM-RET-EARN-A                 PIC X.
  6596     12  AM-RET-ST-TAX-USE                 PIC X.
  6597         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6598         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6599     12  AM-RETRO-BEG-EARNINGS.
  6600         16  AM-RET-BEG-EARN-R             PIC X.
  6601         16  AM-RET-BEG-EARN-L             PIC X.
  6602         16  AM-RET-BEG-EARN-A             PIC X.
  6603     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6604     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6605
  6606     12  AM-USER-SELECT-OPTIONS.
  6607         16  AM-USER-SELECT-1              PIC X(10).
  6608         16  AM-USER-SELECT-2              PIC X(10).
  6609         16  AM-USER-SELECT-3              PIC X(10).
  6610         16  AM-USER-SELECT-4              PIC X(10).
  6611         16  AM-USER-SELECT-5              PIC X(10).
  6612
  6613     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6614
  6615     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6616
  6617     12  AM-RPT045A-SWITCH                 PIC X.
  6618         88  RPT045A-OFF                   VALUE 'N'.
  6619
  6620     12  AM-INSURANCE-LIMITS.
  6621         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6622         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6623
  6624     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6625         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6626
  6627     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6628         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6629         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6630
  6631     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6632
  6633     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6634     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6635     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6636     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6637     12  AM-DCC-UEF-STATE                  PIC XX.
  6638     12  FILLER                            PIC XXX.
  6639     12  AM-REPORT-CODE-3                  PIC X(10).
  6640*    12  FILLER                            PIC X(22).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 119
* EL131.cbl
  6641
  6642     12  AM-RESERVE-DATE.
  6643         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6644         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6645         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6646
  6647     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6648     12  AM-NOTIFICATION-TYPES.
  6649         16  AM-NOTIF-OF-LETTERS           PIC X.
  6650         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6651         16  AM-NOTIF-OF-REPORTS           PIC X.
  6652         16  AM-NOTIF-OF-STATUS            PIC X.
  6653
  6654     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6655         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6656         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6657         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6658         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6659
  6660     12  AM-BENEFIT-CONTROLS.
  6661         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6662             20  AM-BENEFIT-CODE           PIC XX.
  6663             20  AM-BENEFIT-TYPE           PIC X.
  6664             20  AM-BENEFIT-REVISION       PIC XXX.
  6665             20  AM-BENEFIT-REM-TERM       PIC X.
  6666             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6667             20  FILLER                    PIC XX.
  6668         16  FILLER                        PIC X(80).
  6669
  6670     12  AM-TRANSFER-DATA.
  6671         16  AM-TRANSFERRED-FROM.
  6672             20  AM-TRNFROM-CARRIER        PIC X.
  6673             20  AM-TRNFROM-GROUPING.
  6674                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6675                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6676             20  AM-TRNFROM-STATE          PIC XX.
  6677             20  AM-TRNFROM-ACCOUNT.
  6678                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6679                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6680             20  AM-TRNFROM-DTE            PIC XX.
  6681         16  AM-TRANSFERRED-TO.
  6682             20  AM-TRNTO-CARRIER          PIC X.
  6683             20  AM-TRNTO-GROUPING.
  6684                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6685                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6686             20  AM-TRNTO-STATE            PIC XX.
  6687             20  AM-TRNTO-ACCOUNT.
  6688                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6689                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6690             20  AM-TRNTO-DTE              PIC XX.
  6691         16  FILLER                        PIC X(10).
  6692
  6693     12  AM-SAVED-REMIT-TO                 PIC 99.
  6694
  6695     12  AM-COMM-STRUCTURE-SAVED.
  6696         16  AM-DEFN-1-SAVED.
  6697             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6698                 24  AM-AGT-SV             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 120
* EL131.cbl
  6699                 24  AM-COM-TYP-SV         PIC X.
  6700                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6701                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6702                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6703                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6704                 24  FILLER                PIC X.
  6705                 24  AM-GL-CODES-SV        PIC X.
  6706                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6707                 24  FILLER                PIC X.
  6708         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6709             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6710                 24  FILLER                PIC X(11).
  6711                 24  AM-L-COMA-SV          PIC XXX.
  6712                 24  AM-J-COMA-SV          PIC XXX.
  6713                 24  AM-A-COMA-SV          PIC XXX.
  6714                 24  FILLER                PIC X(6).
  6715
  6716     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6717         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6718            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6719            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6720            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6721
  6722     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6723     12  FILLER                            PIC X(120).
  6724
  6725     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6726         16  AM-CONTROL-NAME               PIC X(30).
  6727         16  AM-EXECUTIVE-ONE.
  6728             20  AM-EXEC1-NAME             PIC X(15).
  6729             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6730                                                          COMP-3.
  6731             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6732                                                          COMP-3.
  6733         16  AM-EXECUTIVE-TWO.
  6734             20  AM-EXEC2-NAME             PIC X(15).
  6735             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6736                                                          COMP-3.
  6737             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6738                                                          COMP-3.
  6739
  6740     12  AM-RETRO-ADDITIONAL-DATA.
  6741         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6742         16  AM-RETRO-PREM-P-E             PIC X.
  6743         16  AM-RETRO-CLMS-P-I             PIC X.
  6744         16  AM-RETRO-RET-BRACKET-LF.
  6745             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6746                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6747                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6748             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6749                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6750                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6751             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6752                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6753                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6754         16  AM-RETRO-RET-BRACKET-AH.
  6755             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6756                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 121
* EL131.cbl
  6757                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6758                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6759             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6760                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6761                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6762             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6763                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6764                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6765
  6766     12  AM-COMMENTS.
  6767         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6768
  6769     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6770         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6771         16  AM-FLI-BILLING-CODE           PIC X.
  6772         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6773         16  AM-FLI-UNITED-IDENT           PIC X.
  6774         16  AM-FLI-INTEREST-LOST-DATA.
  6775             20  AM-FLI-BANK-NO            PIC X(5).
  6776             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6777             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6778             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6779         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6780             20  AM-FLI-AGT                PIC X(9).
  6781             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6782             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6783         16  FILLER                        PIC X(102).
  6784
  6785     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6786         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6787             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6788             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6789             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6790             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6791             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6792         16  FILLER                          PIC X(10).
  6793******************************************************************
  6794
  6795*                                COPY ELCCHKQ.
  6796******************************************************************
  6797*                                                                *
  6798*                                                                *
  6799*                            ELCCHKQ.                            *
  6800*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6801*                            VMOD=2.007                          *
  6802*                                                                *
  6803*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6804*                                                                *
  6805*   FILE TYPE = VSAM,KSDS                                        *
  6806*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6807*                                                                *
  6808*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6809*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6810*                                                                *
  6811*   LOG = YES                                                    *
  6812*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6813******************************************************************
  6814 01  CHECK-QUE.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 122
* EL131.cbl
  6815     12  CQ-RECORD-ID                PIC XX.
  6816         88  VALID-CQ-ID         VALUE 'CQ'.
  6817
  6818     12  CQ-CONTROL-PRIMARY.
  6819         16  CQ-COMPANY-CD           PIC X.
  6820         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6821         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6822
  6823     12  CQ-CONTROL-BY-PAYEE.
  6824         16  CQ-CONTROL-BY-NUMBER.
  6825             20  CQ-COMPANY-CD-A1     PIC X.
  6826             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6827         16  CQ-PAYEE-CARRIER        PIC X.
  6828         16  CQ-PAYEE-GROUPING       PIC X(6).
  6829         16  CQ-PAYEE-STATE          PIC XX.
  6830         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6831         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6832
  6833     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6834         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6835         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6836         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6837         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6838         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6839         16  FILLER                  PIC X(3).
  6840
  6841     12  CQ-ENTRY-TYPE               PIC X.
  6842             88  CHECK-ON-QUE           VALUE 'Q'.
  6843             88  ALIGNMENT-CHECK        VALUE 'A'.
  6844             88  SPOILED-CHECK          VALUE 'S'.
  6845             88  PAYMENT-ABORTED        VALUE 'X'.
  6846
  6847     12  CQ-CLAIM-MAST-CNTL.
  6848         16  CQ-CARRIER              PIC X.
  6849         16  CQ-CLAIM-NO             PIC X(7).
  6850         16  CQ-CERT-NO.
  6851             20  CQ-CERT-PRIME       PIC X(10).
  6852             20  CQ-CERT-SFX         PIC X.
  6853         16  CQ-CLAIM-TYPE           PIC X.
  6854             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6855             88  CQ-AH-CLAIM            VALUE 'A'.
  6856         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6857             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6858             88  CQ-O-B-COVERAGE        VALUE '2'.
  6859             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6860
  6861     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6862     12  CQ-CHECK-NUMBER             PIC X(7).
  6863     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6864     12  CQ-PAYMENT-TYPE             PIC X.
  6865             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6866             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6867             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6868             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6869             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6870             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6871             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6872             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 123
* EL131.cbl
  6873     12  CQ-VOID-INDICATOR           PIC X.
  6874             88  CHECK-IS-STOPPED          VALUE 'S'.
  6875             88  CHECK-IS-VOID             VALUE 'V'.
  6876     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6877     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6878     12  CQ-CHECK-BY-USER            PIC X(4).
  6879     12  CQ-PRE-NUMBERING-SW         PIC X.
  6880       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6881       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6882
  6883     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6884     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6885     12  CQ-LEDGER-FLAG              PIC X(01).
  6886     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6887     12  CQ-LAST-UPDATED-DT          PIC XX.
  6888     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6889     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6890
  6891     12  FILLER                      PIC X(04).
  6892
  6893******************************************************************
  6894
  6895*                                COPY ELCARCH.
  6896******************************************************************
  6897*                                                                *
  6898*                            ELCARCH.                            *
  6899*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6900*                            VMOD=2.007                          *
  6901*                                                                *
  6902*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6903*                                                                *
  6904*   FILE TYPE = VSAM,KSDS                                        *
  6905*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6906*                                                                *
  6907*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6908*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6909*                                                                *
  6910*   LOG = NO                                                     *
  6911*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6912*                                                                *
  6913*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6914******************************************************************
  6915 01  LETTER-ARCHIVE.
  6916     12  LA-RECORD-ID                PIC XX.
  6917         88  VALID-LA-ID                VALUE 'LA'.
  6918
  6919     12  LA-CONTROL-PRIMARY.
  6920         16  LA-COMPANY-CD           PIC X.
  6921         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6922         16  LA-RECORD-TYPE          PIC X.
  6923             88  LA-HEADER-DATA         VALUE '1'.
  6924             88  LA-ADDRESS-DATA        VALUE '2'.
  6925             88  LA-TEXT-DATA           VALUE '3'.
  6926             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6927         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6928
  6929     12  LA-CONTROL-BY-TYPE.
  6930         16  LA-COMPANY-CD-A1        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 124
* EL131.cbl
  6931         16  LA-RECORD-TYPE-A1       PIC X.
  6932         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6933         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6934
  6935     12  LA-TEXT-RECORD.
  6936         16  LA-SKIP-CONTROL         PIC XX.
  6937             88  NO-LINES-SKIPPED       VALUE SPACES.
  6938             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6939         16  LA-TEXT-LINE            PIC X(70).
  6940
  6941     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6942         16  FILLER                  PIC XX.
  6943         16  LA-ADDRESS-LINE         PIC X(30).
  6944         16  FILLER                  PIC X(40).
  6945
  6946     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6947         16  FILLER                  PIC XX.
  6948         16  LA-CARRIER              PIC X.
  6949         16  LA-CLAIM-NO             PIC X(7).
  6950         16  LA-CERT-NO.
  6951             20  LA-CERT-PRIME       PIC X(10).
  6952             20  LA-CERT-SFX         PIC X.
  6953         16  LA-NO-OF-COPIES         PIC S9.
  6954         16  LA-RESEND-DATE          PIC XX.
  6955         16  LA-PROCESSOR-CD         PIC X(4).
  6956         16  LA-CREATION-DT          PIC XX.
  6957         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6958         16  LA-RESEND-PRINT-DATE    PIC XX.
  6959         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6960         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6961*
  6962* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6963*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6964*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6965*   I        20  LA-DMD-RES-ST           PIC XX.
  6966*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6967*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6968*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6969*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6970*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6971*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6972*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6973*   I        20  LA-DMD-UND-CODE         PIC XX.
  6974*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6975*   V    16  FILLER                  PIC X(15).
  6976* -----
  6977*
  6978* REINSERTED  CSO  MODS
  6979*
  6980         16  FILLER.
  6981             20  FILLER                  PIC X(29).
  6982             20  LA-CSO-LETTER-STATUS    PIC X.
  6983                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6984                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6985                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6986             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6987             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6988*
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 125
* EL131.cbl
  6989
  6990     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6991         16  FILLER                  PIC XX.
  6992         16  LA4-CARRIER             PIC X.
  6993         16  LA4-CLAIM-NO            PIC X(7).
  6994         16  LA4-CERT-NO.
  6995             20  LA4-CERT-PRIME      PIC X(10).
  6996             20  LA4-CERT-SFX        PIC X.
  6997         16  LA4-NO-OF-COPIES        PIC S9.
  6998         16  LA4-RESEND-DATE         PIC XX.
  6999         16  LA4-PROCESSOR-CD        PIC X(4).
  7000         16  LA4-CREATION-DT         PIC XX.
  7001         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7002         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7003         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7004         16  LA4-FORM-TYPE           PIC X.
  7005             88  LA4-INITIAL-FORM    VALUE '1'.
  7006             88  LA4-PROGRESS-FORM   VALUE '2'.
  7007         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7008         16  LA4-STATE               PIC X(02).
  7009         16  FILLER                  PIC X(31).
  7010******************************************************************
  7011
  7012*                                COPY ELCBENE.
  7013******************************************************************
  7014*                                                                *
  7015*                            ELCBENE.                            *
  7016*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7017*                            VMOD=2.006                          *
  7018*                                                                *
  7019*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7020*                                                                *
  7021*   FILE TYPE = VSAM,KSDS                                        *
  7022*   RECORD SIZE = 500   RECFORM = FIX                            *
  7023*                                                                *
  7024*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7025*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7026*                                                                *
  7027*   LOG = YES                                                    *
  7028*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7029*                                                                *
  7030*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7031******************************************************************
  7032*                   C H A N G E   L O G
  7033*
  7034* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7035*-----------------------------------------------------------------
  7036*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7037* EFFECTIVE    NUMBER
  7038*-----------------------------------------------------------------
  7039* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7040* 082317  CR2017082100003  PEMA  Add sub type
  7041******************************************************************
  7042
  7043 01  BENEFICIARY-MASTER.
  7044     12  BE-RECORD-ID                PIC XX.
  7045         88  VALID-BE-ID                VALUE 'BE'.
  7046
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 126
* EL131.cbl
  7047     12  BE-CONTROL-PRIMARY.
  7048         16  BE-COMPANY-CD           PIC X.
  7049         16  BE-RECORD-TYPE          PIC X.
  7050             88  BENEFICIARY-RECORD  VALUE 'B'.
  7051             88  ADJUSTOR-RECORD     VALUE 'A'.
  7052         16  BE-BENEFICIARY          PIC X(10).
  7053     12  BE-CONTROL-BY-NAME.
  7054         16  BE-COMPANY-CD-A1        PIC X.
  7055         16  BE-RECORD-TYPE-A1       PIC X.
  7056         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7057         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7058
  7059     12  BE-LAST-MAINT-DT            PIC XX.
  7060     12  BE-LAST-MAINT-BY            PIC X(4).
  7061     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7062
  7063     12  BE-ADDRESS-DATA.
  7064         16  BE-MAIL-TO-NAME         PIC X(30).
  7065         16  BE-ADDRESS-LINE-1       PIC X(30).
  7066         16  BE-ADDRESS-LINE-2       PIC X(30).
  7067         16  BE-ADDRESS-LINE-3       PIC X(30).
  7068         16  BE-CITY-STATE.
  7069             20  BE-CITY             PIC X(28).
  7070             20  BE-STATE            PIC XX.
  7071         16  BE-ZIP-CODE.
  7072             20  BE-ZIP-PRIME.
  7073                 24  BE-ZIP-1ST      PIC X.
  7074                     88  BE-CANADIAN-POST-CODE
  7075                                         VALUE 'A' THRU 'Z'.
  7076                 24  FILLER          PIC X(4).
  7077             20  BE-ZIP-PLUS4        PIC X(4).
  7078         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7079             20  BE-CAN-POSTAL-1     PIC XXX.
  7080             20  BE-CAN-POSTAL-2     PIC XXX.
  7081             20  FILLER              PIC XXX.
  7082         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7083         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7084
  7085******************************************************************
  7086*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7087*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7088******************************************************************
  7089     12  BE-CARRIER                  PIC X.
  7090
  7091     12  BE-ADDRESS-DATA2.
  7092         16  BE-MAIL-TO-NAME2        PIC X(30).
  7093         16  BE-ADDRESS-LINE-12      PIC X(30).
  7094         16  BE-ADDRESS-LINE-22      PIC X(30).
  7095         16  BE-ADDRESS-LINE-32      PIC X(30).
  7096         16  BE-CITY-STATE2.
  7097             20  BE-CITY2            PIC X(28).
  7098             20  BE-STATE2           PIC XX.
  7099         16  BE-ZIP-CODE2.
  7100             20  BE-ZIP-PRIME2.
  7101                 24  BE-ZIP-1ST2     PIC X.
  7102                     88  BE-CANADIAN-POST-CODE2
  7103                                         VALUE 'A' THRU 'Z'.
  7104                 24  FILLER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 127
* EL131.cbl
  7105             20  BE-ZIP-PLUS42       PIC X(4).
  7106         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7107             20  BE-CAN-POSTAL-12    PIC XXX.
  7108             20  BE-CAN-POSTAL-22    PIC XXX.
  7109             20  FILLER              PIC XXX.
  7110         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7111         16  BE-ACH-DATA.
  7112             20  BE-ACH-YES-OR-NO    PIC X.
  7113                 88  BE-ON-ACH       VALUE 'Y'.
  7114                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7115             20  BE-ACH-ABA-ROUTING-NUMBER
  7116                                     PIC X(15).
  7117             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7118                                     PIC X(20).
  7119             20  BE-ACH-SUB-TYPE     PIC XX.
  7120             20  FILLER              PIC X(23).
  7121         16  BE-BILLING-STMT-DATA.
  7122*            20  BE-BSR              PIC X.
  7123*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7124*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7125*            20  BE-BSR-FROM         PIC X(30).
  7126*            20  BE-BSR-DEPT         PIC X(30).
  7127             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7128             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7129             20  BE-OUTPUT-TYPE      PIC X.
  7130                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7131                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7132
  7133     12  FILLER                      PIC X(28).
  7134******************************************************************
  7135
  7136*                                COPY ELCDAR.
  7137******************************************************************
  7138*                                                                *
  7139*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7140*   FILE TYPE = VSAM,KSDS                                        *
  7141*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7142*   BASE CLUSTER = DLYACTV                                       *
  7143*   LOG = YES                                                    *
  7144*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7145*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7146*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7147*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7148*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7149*               BY PROGRAM "LGINFCE".                            *
  7150*                                                                *
  7151******************************************************************
  7152 01  DAILY-ACTIVITY-RECORD.
  7153     05  DA-KEY.
  7154         10  DA-COMP-CD          PIC X.
  7155         10  DA-CARRIER          PIC X.
  7156         10  DA-CLAIM-NO         PIC X(7).
  7157         10  DA-CERT-NO.
  7158             15  DA-CERT-PRIME   PIC X(10).
  7159             15  DA-CERT-SFX     PIC X.
  7160     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7161     05  DA-RECORD-TYPE          PIC X.
  7162     05  FILLER                  PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 128
* EL131.cbl
  7163******************************************************************
  7164
  7165*                                COPY ELCALPH.
  7166******************************************************************
  7167*                                                                *
  7168*                            ELCALPH.                            *
  7169*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7170*                            VMOD=2.003                          *
  7171*                                                                *
  7172*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7173*                                                                *
  7174*   FILE TYPE = VSAM,KSDS                                        *
  7175*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7176*                                                                *
  7177*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7178*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  7179*                                                                *
  7180*   LOG = YES                                                    *
  7181*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7182*                                                                *
  7183*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7184******************************************************************
  7185
  7186 01  ALPHA-INDEX.
  7187     12  AI-RECORD-ID                         PIC XX.
  7188         88  VALID-AI-ID                  VALUE 'AI'.
  7189     12  AI-CONTROL-PRIMARY.
  7190         16  AI-COMPANY-CD                     PIC X.
  7191         16  AI-SOURCE                         PIC X.
  7192             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  7193             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7194         16  AI-NAME.
  7195             20  AI-LAST-NAME                  PIC X(15).
  7196             20  AI-FIRST-NAME.
  7197                 24  AI-FIRST-INITIAL          PIC X.
  7198                 24  FILLER                    PIC X(11).
  7199             20  AI-MIDDLE-INIT                PIC X.
  7200         16  AI-DATE                           PIC X(8).
  7201         16  AI-TIME                           PIC S9(07) COMP-3.
  7202
  7203     12  AI-CONTROL-BY-ADMIN-KEY.
  7204         16  AI-CM-COMPANY-CD                  PIC X.
  7205         16  AI-CM-SOURCE                      PIC X.
  7206         16  AI-CM-CARRIER                     PIC X.
  7207         16  AI-CM-GROUPING.
  7208             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7209             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7210         16  AI-CM-STATE                       PIC XX.
  7211         16  AI-CM-PRODUCER.
  7212             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7213             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7214         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7215         16  AI-CM-CERTIFICATE-NUMBER.
  7216             20  AI-CM-CERT-PRIME              PIC X(10).
  7217             20  AI-CM-CERT-SFX                PIC X.
  7218         16  AI-CM-DATE                        PIC X(8).
  7219         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7220         16  FILLER                            PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 129
* EL131.cbl
  7221
  7222     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7223         AI-CONTROL-BY-ADMIN-KEY.
  7224         16  AI-CL-COMPANY-CD                  PIC X.
  7225         16  AI-CL-SOURCE                      PIC X.
  7226         16  AI-CL-CARRIER                     PIC X.
  7227         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7228         16  AI-CL-CERTIFICATE-NUMBER.
  7229             20  AI-CL-CERT-PRIME              PIC X(10).
  7230             20  AI-CL-CERT-SFX                PIC X.
  7231         16  AI-CL-DATE                        PIC X(8).
  7232         16  AI-CL-INCURRED-DATE               PIC XX.
  7233         16  AI-CL-CLOSE-DATE                  PIC XX.
  7234         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7235         16  AI-CREDIT-CARD-NUMBER.
  7236             20  AI-CCN.
  7237                 24  AI-CCN-PREFIX             PIC X(4).
  7238                 24  AI-CCN-PRIME              PIC X(12).
  7239             20  AI-CCN-FILLER                 PIC X(4).
  7240
  7241     12  AI-MAINT-INFO.
  7242         16  AI-LAST-MAINT-BY                  PIC X(4).
  7243         16  AI-LAST-MAINT-DT                  PIC XX.
  7244         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7245
  7246     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7247
  7248     12  FILLER                                PIC X(15).
  7249
  7250
  7251*                                COPY ERCDMDNT.
  7252******************************************************************
  7253*                                                                *
  7254*                            ERCDMDNT                            *
  7255*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7256*                            VMOD=2.005                          *
  7257*                                                                *
  7258*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7259*                                                                *
  7260*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7261*                                                                *
  7262*        FILE TYPE= VSAM,KSDS                                    *
  7263*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7264*                                                                *
  7265*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7266*                                                                *
  7267*        LOG = YES                                               *
  7268*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7269*                                                                *
  7270******************************************************************
  7271
  7272 01  CERTIFICATE-NOTE.
  7273     12  CN-RECORD-ID                     PIC  XX.
  7274         88  VALID-CN-ID                      VALUE 'CN'.
  7275
  7276     12  CN-CONTROL-PRIMARY.
  7277         16  CN-COMPANY-CD                PIC X.
  7278         16  CN-CERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 130
* EL131.cbl
  7279             20  CN-CARRIER               PIC X.
  7280             20  CN-GROUPING.
  7281                 24  CN-GROUPING-PREFIX   PIC XXX.
  7282                 24  CN-GROUPING-PRIME    PIC XXX.
  7283             20  CN-STATE                 PIC XX.
  7284             20  CN-ACCOUNT.
  7285                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7286                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7287             20  CN-CERT-EFF-DT           PIC XX.
  7288             20  CN-CERT-NO.
  7289                 24  CN-CERT-PRIME        PIC X(10).
  7290                 24  CN-CERT-SFX          PIC X.
  7291
  7292     12  CN-BILLING-START-LINE-NO         PIC 99.
  7293     12  CN-BILLING-END-LINE-NO           PIC 99.
  7294
  7295     12  CN-LINES.
  7296         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7297
  7298     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7299         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7300         16  CN-CSI-GENERAL-DATA-AREA.
  7301             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7302
  7303         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7304             CN-CSI-GENERAL-DATA-AREA.
  7305             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7306             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7307             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7308             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7309             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7310             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7311             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7312             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7313             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7314             20  FILLER                       PIC XX.
  7315             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7316             20  FILLER                       PIC X(38).
  7317
  7318         16  CN-CSI-PRODUCT-DATA-AREA.
  7319             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7320
  7321         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7322             CN-CSI-PRODUCT-DATA-AREA.
  7323             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7324             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7325             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7326             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7327             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7328             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7329             20  FILLER                   PIC XX.
  7330             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7331             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7332             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7333             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7334             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7335             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7336             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 131
* EL131.cbl
  7337             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7338             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7339             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7340             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7341             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7342             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7343             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7344             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7345             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7346             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7347             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7348             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7349             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7350             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7351             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7352             20  FILLER                   PIC X(25).
  7353
  7354         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7355             CN-CSI-CREDIT-CARD-DATA.
  7356             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7357             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7358             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7359             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7360             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7361             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7362             20  FILLER                   PIC XX.
  7363             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7364             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7365             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7366             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7367             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7368             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7369             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7370             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7371             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7372             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7373             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7374             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7375             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7376             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7377             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7378             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7379             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7380             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7381             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7382             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7383             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7384             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7385             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7386             20  FILLER                   PIC X(17).
  7387
  7388         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7389             CN-CSI-FAMILY-LEAVE-DATA.
  7390             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7391             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7392             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7393             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7394             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 132
* EL131.cbl
  7395             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7396             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7397             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7398             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7399             20  CN-CSI-SL-INT-ON-PROCEEDS
  7400                                          PIC S9(5)V99  COMP-3.
  7401             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7402             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7403             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7404             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7405             20  CN-CSI-SL-POLICY-BENEFITS
  7406                                          PIC S9(5)V99  COMP-3.
  7407             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7408             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7409             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7410             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7411             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7412             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7413             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7414             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7415             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7416             20  CN-CSI-SL-STATE-NOT      PIC X.
  7417             20  FILLER                   PIC XX.
  7418
  7419         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7420             CN-CSI-SENIOR-LIFE-DATA.
  7421             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7422             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7423             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7424                                          PIC S9(5)V99  COMP-3.
  7425             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7426             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7427             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7428             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7429             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7430             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7431             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7432             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7433             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7434             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7435             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7436             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7437             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7438             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7439             20  CN-CSI-PP-REPAIR         PIC X.
  7440             20  CN-CSI-PP-REPLACE        PIC X.
  7441             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7442             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7443             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7444             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7445             20  FILLER                   PIC X(5).
  7446
  7447         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7448             CN-CSI-PURCH-PROP-DATA.
  7449             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7450             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7451             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7452             20  CN-CSI-EW-CANCEL-CD      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 133
* EL131.cbl
  7453             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7454             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7455             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7456             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7457             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7458             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7459             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7460             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7461             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7462             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7463             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7464             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7465             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7466             20  CN-CSI-EW-REPLACE        PIC X.
  7467             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7468             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7469             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7470             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7471             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7472             20  FILLER                   PIC X(4).
  7473
  7474     12  CN-LAST-MAINT-DT                 PIC XX.
  7475     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7476     12  CN-LAST-MAINT-USER               PIC X(4).
  7477     12  FILLER                           PIC X(6).
  7478
  7479******************************************************************
  7480
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 134
* EL131.cbl
  7482 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7483                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7484                          CONTROL-FILE ACTIVITY-QUE
  7485                          ACCOUNT-MASTER CHECK-QUE
  7486                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7487                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7488                          CERTIFICATE-NOTE.
  7489 0000-DFHEXIT SECTION.
  7490     MOVE '9#                    $   ' TO DFHEIV0.
  7491     MOVE 'EL131' TO DFHEIV1.
  7492     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7493
  7494     IF EIBCALEN = ZERO
  7495         GO TO 8800-UNAUTHORIZED-ACCESS.
  7496
  7497     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7498     MOVE '5'                    TO DC-OPTION-CODE.
  7499     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7500     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7501     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7502     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7503
  7504     IF SAVE-DATE-YY GREATER 70
  7505         MOVE 19                 TO SAVE-DATE-CC
  7506      ELSE
  7507         MOVE 20                 TO SAVE-DATE-CC.
  7508
  7509
  7510* EXEC CICS HANDLE CONDITION
  7511*        PGMIDERR (8820-XCTL-ERROR)
  7512*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7513*        ERROR    (9990-ABEND)
  7514*    END-EXEC.
  7515*    MOVE '"$LI.                 ! " #00007505' TO DFHEIV0
  7516     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7517     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7518     MOVE X'2220233030303037353035' TO DFHEIV0(25:11)
  7519     CALL 'kxdfhei1' USING DFHEIV0
  7520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7521
  7522
  7523     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7524     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7525     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7526
  7527     INITIALIZE    EDIT-WORK-AREA.
  7528     MOVE '/'                    TO WORK-SLASH.
  7529     MOVE SPACES                 TO ERROR-SWITCHES.
  7530
  7531     MOVE TRAN-ID                TO TRANS-ID.
  7532     MOVE EIBTRMID               TO PI-TERM.
  7533     MOVE MAP-ID                 TO PI-QUAL.
  7534
  7535     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7536
  7537     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7538         MOVE LOW-VALUES         TO EL131AO
  7539         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 135
* EL131.cbl
  7540         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7541         MOVE -1                 TO MAINTL
  7542         GO TO 8110-SEND-DATA.
  7543
  7544     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7545         MOVE LOW-VALUES         TO EL131AO
  7546         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7547         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7548         MOVE 'X'                TO PI-RETURN-CD-1
  7549         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7550         MOVE -1                 TO MAINTL
  7551         IF WS-RETURNED-FROM = XCTL-EL114
  7552             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7553         END-IF
  7554         GO TO 8100-SEND-MAP.
  7555
  7556     IF EIBAID = DFHCLEAR
  7557         GO TO 8200-RETURN-PRIOR.
  7558
  7559     IF PI-PROCESSOR-ID = 'LGXX'
  7560         NEXT SENTENCE
  7561     ELSE
  7562
  7563* EXEC CICS READQ TS
  7564*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7565*            INTO    (SECURITY-CONTROL)
  7566*            LENGTH  (SC-COMM-LENGTH)
  7567*            ITEM    (SC-ITEM)
  7568*        END-EXEC
  7569*    MOVE '*$II   L              ''   #00007550' TO DFHEIV0
  7570     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7571     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7572     MOVE X'2020233030303037353530' TO DFHEIV0(25:11)
  7573     CALL 'kxdfhei1' USING DFHEIV0,
  7574           PI-SECURITY-TEMP-STORE-ID,
  7575           SECURITY-CONTROL,
  7576           SC-COMM-LENGTH,
  7577           SC-ITEM,
  7578           DFHEIV99,
  7579           DFHEIV99
  7580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7581         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7582         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7583         IF NOT DISPLAY-CAP
  7584             MOVE 'READ'               TO  SM-READ
  7585             PERFORM 9995-SECURITY-VIOLATION
  7586             MOVE ER-0070              TO  EMI-ERROR
  7587             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7588             GO TO 8100-SEND-MAP.
  7589
  7590
  7591* EXEC CICS RECEIVE
  7592*        MAP    ('EL131A')
  7593*        MAPSET ('EL131S')
  7594*    END-EXEC.
  7595     MOVE 'EL131A' TO DFHEIV1
  7596     MOVE 'EL131S' TO DFHEIV2
  7597*    MOVE '8"T                   ''   #00007565' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 136
* EL131.cbl
  7598     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7599     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7600     MOVE X'2020233030303037353635' TO DFHEIV0(25:11)
  7601     CALL 'kxdfhei1' USING DFHEIV0,
  7602           DFHEIV1,
  7603           EL131AI,
  7604           DFHEIV99,
  7605           DFHEIV2,
  7606           DFHEIV99,
  7607           DFHEIV99
  7608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7609
  7610
  7611     IF PFKEYL GREATER THAN ZERO
  7612         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7613
  7614     IF SCREEN-ERROR
  7615         MOVE ER-0004 TO EMI-ERROR
  7616         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7617         MOVE -1 TO MAINTL
  7618         GO TO 8110-SEND-DATA.
  7619
  7620     IF EIBAID = DFHPF3
  7621         GO TO 8500-TRLR-MNT.
  7622
  7623     IF EIBAID = DFHPF4
  7624         GO TO 8600-ADDR-MNT.
  7625
  7626     IF EIBAID = DFHPF5
  7627         GO TO 8700-CERT-MNT.
  7628
  7629     IF PI-COMPANY-ID = 'DMD'
  7630       IF EIBAID = DFHPF6
  7631         GO TO 8750-DMD-CLM-FIX.
  7632
  7633     IF EIBAID = DFHPF7
  7634         GO TO 4000-FORCE-ERRORS.
  7635
  7636     IF EIBAID = DFHPF12
  7637         GO TO 8300-GET-HELP.
  7638
  7639     IF EIBAID = DFHPF15
  7640         GO TO 8725-BENEFICIARY-MNT
  7641     END-IF.
  7642
  7643     IF EIBAID = DFHPF23
  7644         GO TO 8810-PF23-ENTERED.
  7645
  7646     IF EIBAID = DFHPF24
  7647         GO TO 8400-RETURN-MASTER.
  7648
  7649     IF EIBAID NOT = DFHENTER
  7650         MOVE ER-0029            TO EMI-ERROR
  7651         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7652         MOVE -1                 TO MAINTL
  7653         GO TO 8110-SEND-DATA.
  7654
  7655     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 137
* EL131.cbl
  7656         MOVE ER-0311            TO EMI-ERROR
  7657         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7658         MOVE -1                 TO MAINTL
  7659         GO TO 8110-SEND-DATA.
  7660
  7661     IF MAINTI = 'A'
  7662         GO TO 0500-ADD-ALPHA-ONLY.
  7663
  7664     IF MAINTI = 'N'
  7665         GO TO 0600-CHANGE-NAME.
  7666
  7667     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7668     PERFORM 1030-EDIT-NAME THRU 1030-EXIT.
  7669
  7670     IF SCREEN-ERROR
  7671         GO TO 8110-SEND-DATA.
  7672
  7673     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7674         MOVE ER-0276            TO EMI-ERROR
  7675         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7676         MOVE -1                 TO MAINTL
  7677         GO TO 8110-SEND-DATA.
  7678
  7679     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7680
  7681     IF SCREEN-ERROR
  7682         GO TO 8110-SEND-DATA.
  7683
  7684     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7685
  7686     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7687
  7688     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7689         GO TO 8110-SEND-DATA.
  7690
  7691     IF EMI-FATAL-CTR GREATER THAN ZERO
  7692         GO TO 8110-SEND-DATA.
  7693
  7694     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7695
  7696     IF WS-OPEN-CLOSE-SW = 'Y'
  7697         IF PI-LETTER-SW = 'Y'
  7698             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7699             MOVE 'T'            TO  CNTL-REC-TYPE
  7700             MOVE SPACES         TO  CNTL-PROC-ID
  7701             MOVE +0             TO  CNTL-SEQ-NO
  7702
  7703* EXEC CICS READ
  7704*                DATASET   (CNTL-FILE-ID)
  7705*                RIDFLD    (CNTL-KEY)
  7706*                SET       (ADDRESS OF CONTROL-FILE)
  7707*            END-EXEC
  7708*    MOVE '&"S        E          (   #00007661' TO DFHEIV0
  7709     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7710     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7711     MOVE X'2020233030303037363631' TO DFHEIV0(25:11)
  7712     CALL 'kxdfhei1' USING DFHEIV0,
  7713           CNTL-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 138
* EL131.cbl
  7714           DFHEIV20,
  7715           DFHEIV99,
  7716           CNTL-KEY,
  7717           DFHEIV99,
  7718           DFHEIV99,
  7719           DFHEIV99
  7720     SET ADDRESS OF CONTROL-FILE TO
  7721         DFHEIV20
  7722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7723             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7724
  7725     MOVE ER-0000                TO EMI-ERROR.
  7726     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7727
  7728     MOVE SPACE                  TO MAINTO.
  7729     MOVE -1                     TO MAINTL.
  7730     GO TO 8100-SEND-MAP.
  7731
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 139
* EL131.cbl
  7733 0100-UPDATE-PI.
  7734
  7735     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7736     IF WS-RETURNED-FROM = XCTL-EL114
  7737***sometimes there is crap in positions 7-10 when no code was sele
  7738        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7739          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7740        END-IF
  7741     END-IF.
  7742
  7743     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7744         GO TO 0110-UPDATE-UP.
  7745
  7746     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7747     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7748     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7749     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7750     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7751     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7752     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7753     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7754     GO TO 0120-UPDATE-PI-EXIT.
  7755
  7756 0110-UPDATE-UP.
  7757     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7758     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7759     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7760     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7761     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7762     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7763     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7764     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7765
  7766
  7767* EXEC CICS HANDLE CONDITION
  7768*         QIDERR    (0130-TS-ERROR)
  7769*         ITEMERR   (0130-TS-ERROR)
  7770*    END-EXEC.
  7771*    MOVE '"$N<                  ! # #00007709' TO DFHEIV0
  7772     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7773     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7774     MOVE X'2320233030303037373039' TO DFHEIV0(25:11)
  7775     CALL 'kxdfhei1' USING DFHEIV0
  7776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7777
  7778
  7779     IF WS-RETURNED-FROM = XCTL-EL114
  7780
  7781* EXEC CICS READQ TS
  7782*            QUEUE    (PI-KEY)
  7783*            INTO     (EL131AI)
  7784*            LENGTH   (MAP-LENGTH)
  7785*       END-EXEC
  7786*    MOVE '*$I    L              ''   #00007715' TO DFHEIV0
  7787     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7788     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7789     MOVE X'2020233030303037373135' TO DFHEIV0(25:11)
  7790     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 140
* EL131.cbl
  7791           PI-KEY,
  7792           EL131AI,
  7793           MAP-LENGTH,
  7794           DFHEIV99,
  7795           DFHEIV99,
  7796           DFHEIV99
  7797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7798
  7799        IF WS-SAVE-BENEFICIARY > SPACES
  7800            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7801            MOVE +10            TO BENEL
  7802            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7803        END-IF
  7804        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7805     END-IF.
  7806
  7807
  7808* EXEC CICS READQ TS
  7809*         QUEUE    (PI-KEY)
  7810*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7811*         LENGTH   (PI-COMM-LENGTH)
  7812*    END-EXEC.
  7813*    MOVE '*$I    L              ''   #00007729' TO DFHEIV0
  7814     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7815     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7816     MOVE X'2020233030303037373239' TO DFHEIV0(25:11)
  7817     CALL 'kxdfhei1' USING DFHEIV0,
  7818           PI-KEY,
  7819           PROGRAM-INTERFACE-BLOCK,
  7820           PI-COMM-LENGTH,
  7821           DFHEIV99,
  7822           DFHEIV99,
  7823           DFHEIV99
  7824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7825
  7826
  7827
  7828* EXEC CICS DELETEQ TS
  7829*         QUEUE    (PI-KEY)
  7830*    END-EXEC.
  7831*    MOVE '*&                    #   #00007735' TO DFHEIV0
  7832     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7833     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7834     MOVE X'2020233030303037373335' TO DFHEIV0(25:11)
  7835     CALL 'kxdfhei1' USING DFHEIV0,
  7836           PI-KEY,
  7837           DFHEIV99
  7838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7839
  7840
  7841 0120-UPDATE-PI-EXIT.
  7842     EXIT.
  7843
  7844 0130-TS-ERROR.
  7845     MOVE LOW-VALUES             TO EL131AO.
  7846     MOVE ER-0192                TO EMI-ERROR.
  7847
  7848     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 141
* EL131.cbl
  7849
  7850     GO TO 8100-SEND-MAP.
  7851
  7852 0200-TRANS-PF.
  7853     IF EIBAID NOT = DFHENTER
  7854         MOVE 'X'                TO ERROR-SWITCH
  7855         GO TO 0210-EXIT.
  7856
  7857     IF PFKEYI NOT NUMERIC
  7858         MOVE 'X'                TO ERROR-SWITCH
  7859         GO TO 0210-EXIT.
  7860
  7861     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7862
  7863     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7864         MOVE 'X' TO ERROR-SWITCH
  7865         GO TO 0210-EXIT.
  7866
  7867     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7868
  7869 0210-EXIT.
  7870     EXIT.
  7871
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 142
* EL131.cbl
  7873 0500-ADD-ALPHA-ONLY.
  7874******************************************************************
  7875*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7876*    RECORD.                                                     *
  7877******************************************************************
  7878
  7879     IF MLNAMEL = +0 AND
  7880        MFNAMEL = +0 AND
  7881        MMINITL = +0
  7882         MOVE ER-0797                TO  EMI-ERROR
  7883         MOVE -1                     TO  MAINTL
  7884         MOVE AL-UABON               TO  MAINTA
  7885         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7886         GO TO 8110-SEND-DATA.
  7887
  7888     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7889     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7890     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7891     MOVE PI-CERT-NO                 TO  CERT-NO.
  7892
  7893
  7894* EXEC CICS READ
  7895*        DATASET   (CLMS-FILE-ID)
  7896*        RIDFLD    (MSTR-KEY)
  7897*        SET       (ADDRESS OF CLAIM-MASTER)
  7898*    END-EXEC.
  7899*    MOVE '&"S        E          (   #00007791' TO DFHEIV0
  7900     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7901     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7902     MOVE X'2020233030303037373931' TO DFHEIV0(25:11)
  7903     CALL 'kxdfhei1' USING DFHEIV0,
  7904           CLMS-FILE-ID,
  7905           DFHEIV20,
  7906           DFHEIV99,
  7907           MSTR-KEY,
  7908           DFHEIV99,
  7909           DFHEIV99,
  7910           DFHEIV99
  7911     SET ADDRESS OF CLAIM-MASTER TO
  7912         DFHEIV20
  7913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7914
  7915
  7916
  7917* EXEC CICS GETMAIN
  7918*        SET       (ADDRESS OF ALPHA-INDEX)
  7919*        LENGTH    (ALPH-LENGTH)
  7920*        INITIMG   (GETMAIN-SPACE)
  7921*    END-EXEC.
  7922*    MOVE ',"IL                  $   #00007797' TO DFHEIV0
  7923     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7924     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7925     MOVE X'2020233030303037373937' TO DFHEIV0(25:11)
  7926     CALL 'kxdfhei1' USING DFHEIV0,
  7927           DFHEIV20,
  7928           ALPH-LENGTH,
  7929           GETMAIN-SPACE
  7930     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 143
* EL131.cbl
  7931         DFHEIV20
  7932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7933
  7934
  7935     MOVE 'AI'                       TO  AI-RECORD-ID.
  7936     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7937                                         AI-CL-COMPANY-CD.
  7938     MOVE 'C'                        TO  AI-SOURCE
  7939                                         AI-CL-SOURCE.
  7940
  7941     IF MLNAMEL IS GREATER THAN +0
  7942         MOVE MLNAMEI                TO  AI-LAST-NAME
  7943     ELSE
  7944         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7945
  7946     IF MFNAMEL IS GREATER THAN +0
  7947         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7948     ELSE
  7949         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7950
  7951     IF MMINITL IS GREATER THAN +0
  7952         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7953     ELSE
  7954         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7955
  7956     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7957     MOVE '5'                        TO  DC-OPTION-CODE.
  7958     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7959     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7960     IF BUILD-YEAR IS GREATER THAN 50
  7961         MOVE '19'                   TO  WS-ALPHA-YY-1
  7962         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7963         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7964         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7965     ELSE
  7966         MOVE '20'                   TO  WS-ALPHA-YY-1
  7967         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7968         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7969         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7970
  7971     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7972                                         AI-CL-DATE.
  7973
  7974     MOVE EIBTIME                    TO  AI-TIME
  7975                                         AI-CL-TIME.
  7976
  7977     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7978     MOVE 'C'                        TO  AI-CL-SOURCE.
  7979     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7980     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7981     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7982     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7983     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7984
  7985     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7986     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7987     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7988
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 144
* EL131.cbl
  7989
  7990* EXEC CICS WRITE
  7991*        DATASET   (ALPH-FILE-ID)
  7992*        RIDFLD    (AI-CONTROL-PRIMARY)
  7993*        FROM      (ALPHA-INDEX)
  7994*    END-EXEC.
  7995     MOVE LENGTH OF
  7996      ALPHA-INDEX
  7997       TO DFHEIV11
  7998*    MOVE '&$ L                  ''   #00007857' TO DFHEIV0
  7999     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8000     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8001     MOVE X'2020233030303037383537' TO DFHEIV0(25:11)
  8002     CALL 'kxdfhei1' USING DFHEIV0,
  8003           ALPH-FILE-ID,
  8004           ALPHA-INDEX,
  8005           DFHEIV11,
  8006           AI-CONTROL-PRIMARY,
  8007           DFHEIV99,
  8008           DFHEIV99
  8009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8010
  8011
  8012     MOVE LOW-VALUES                 TO  EL131AO.
  8013     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8014     MOVE ER-0000                    TO  EMI-ERROR.
  8015     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8016     MOVE -1                         TO  MAINTL.
  8017     GO TO 8100-SEND-MAP.
  8018
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 145
* EL131.cbl
  8020 0600-CHANGE-NAME.
  8021******************************************************************
  8022*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  8023*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  8024******************************************************************
  8025
  8026     IF MLNAMEL = +0 AND
  8027        MFNAMEL = +0 AND
  8028        MMINITL = +0
  8029         MOVE ER-0276                TO  EMI-ERROR
  8030         MOVE -1                     TO  MAINTL
  8031         MOVE AL-UABON               TO  MAINTA
  8032         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8033         GO TO 8110-SEND-DATA.
  8034
  8035     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  8036     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  8037     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  8038     MOVE PI-CERT-NO                 TO  CERT-NO.
  8039
  8040
  8041* EXEC CICS READ
  8042*        DATASET   (CLMS-FILE-ID)
  8043*        RIDFLD    (MSTR-KEY)
  8044*        SET       (ADDRESS OF CLAIM-MASTER)
  8045*    END-EXEC.
  8046*    MOVE '&"S        E          (   #00007891' TO DFHEIV0
  8047     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8048     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8049     MOVE X'2020233030303037383931' TO DFHEIV0(25:11)
  8050     CALL 'kxdfhei1' USING DFHEIV0,
  8051           CLMS-FILE-ID,
  8052           DFHEIV20,
  8053           DFHEIV99,
  8054           MSTR-KEY,
  8055           DFHEIV99,
  8056           DFHEIV99,
  8057           DFHEIV99
  8058     SET ADDRESS OF CLAIM-MASTER TO
  8059         DFHEIV20
  8060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8061
  8062
  8063
  8064* EXEC CICS GETMAIN
  8065*        SET       (ADDRESS OF ALPHA-INDEX)
  8066*        LENGTH    (ALPH-LENGTH)
  8067*        INITIMG   (GETMAIN-SPACE)
  8068*    END-EXEC.
  8069*    MOVE ',"IL                  $   #00007897' TO DFHEIV0
  8070     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8071     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8072     MOVE X'2020233030303037383937' TO DFHEIV0(25:11)
  8073     CALL 'kxdfhei1' USING DFHEIV0,
  8074           DFHEIV20,
  8075           ALPH-LENGTH,
  8076           GETMAIN-SPACE
  8077     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 146
* EL131.cbl
  8078         DFHEIV20
  8079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8080
  8081
  8082     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  8083     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  8084     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  8085     MOVE CL-CERT-STATE          TO CERT-STATE
  8086     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  8087     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  8088     MOVE CL-CERT-NO             TO CERT-CERT
  8089
  8090
  8091* EXEC CICS READ
  8092*       DATASET   (CERT-FILE-ID)
  8093*       RIDFLD    (CERT-KEY)
  8094*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  8095*       RESP      (WS-RESPONSE)
  8096*    END-EXEC
  8097*    MOVE '&"S        E          (  N#00007911' TO DFHEIV0
  8098     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8099     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8100     MOVE X'204E233030303037393131' TO DFHEIV0(25:11)
  8101     CALL 'kxdfhei1' USING DFHEIV0,
  8102           CERT-FILE-ID,
  8103           DFHEIV20,
  8104           DFHEIV99,
  8105           CERT-KEY,
  8106           DFHEIV99,
  8107           DFHEIV99,
  8108           DFHEIV99
  8109     SET ADDRESS OF CERTIFICATE-MASTER TO
  8110         DFHEIV20
  8111     MOVE EIBRESP  TO WS-RESPONSE
  8112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8113
  8114     IF INSTYPEL > ZEROS
  8115        MOVE INSTYPEI TO CL-INSURED-TYPE
  8116     END-IF
  8117
  8118     IF MFNAMEL > +0
  8119        IF CL-INSURED-TYPE = 'C'
  8120          AND (CM-INSURED-FIRST-NAME = MFNAMEI(1:10))
  8121           MOVE ER-1675             TO EMI-ERROR
  8122           MOVE -1                  TO MFNAMEL
  8123           MOVE AL-UABON            TO MFNAMEA
  8124           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8125           GO TO 8110-SEND-DATA
  8126        ELSE
  8127          IF CL-INSURED-TYPE = 'P'
  8128            AND (CM-INSURED-FIRST-NAME <> MFNAMEI(1:10))
  8129             MOVE ER-1676             TO EMI-ERROR
  8130             MOVE -1                  TO MFNAMEL
  8131             MOVE AL-UABON            TO MFNAMEA
  8132             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8133             GO TO 8110-SEND-DATA
  8134          END-IF
  8135        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 147
* EL131.cbl
  8136     END-IF
  8137     MOVE 'AI'                       TO  AI-RECORD-ID.
  8138     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  8139                                         AI-CL-COMPANY-CD.
  8140     MOVE 'C'                        TO  AI-SOURCE
  8141                                         AI-CL-SOURCE.
  8142
  8143     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  8144     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  8145     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  8146
  8147     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  8148     MOVE '5'                        TO  DC-OPTION-CODE.
  8149     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8150     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  8151     IF BUILD-YEAR IS GREATER THAN 50
  8152         MOVE '19'                   TO  WS-ALPHA-YY-1
  8153         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8154         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8155         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8156     ELSE
  8157         MOVE '20'                   TO  WS-ALPHA-YY-1
  8158         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8159         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8160         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8161
  8162     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8163                                         AI-CL-DATE.
  8164
  8165     MOVE EIBTIME                    TO  AI-TIME
  8166                                         AI-CL-TIME.
  8167
  8168     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8169     MOVE 'C'                        TO  AI-CL-SOURCE.
  8170     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8171     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8172     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8173     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8174     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8175
  8176     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8177     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8178     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8179
  8180     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8181         MOVE 'Y'                TO CL-YESNOSW
  8182     END-IF.
  8183
  8184
  8185* EXEC CICS WRITE
  8186*        DATASET   (ALPH-FILE-ID)
  8187*        RIDFLD    (AI-CONTROL-PRIMARY)
  8188*        FROM      (ALPHA-INDEX)
  8189*    END-EXEC.
  8190     MOVE LENGTH OF
  8191      ALPHA-INDEX
  8192       TO DFHEIV11
  8193*    MOVE '&$ L                  ''   #00007988' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 148
* EL131.cbl
  8194     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8195     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8196     MOVE X'2020233030303037393838' TO DFHEIV0(25:11)
  8197     CALL 'kxdfhei1' USING DFHEIV0,
  8198           ALPH-FILE-ID,
  8199           ALPHA-INDEX,
  8200           DFHEIV11,
  8201           AI-CONTROL-PRIMARY,
  8202           DFHEIV99,
  8203           DFHEIV99
  8204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8205
  8206
  8207
  8208* EXEC CICS READ
  8209*        DATASET   (CLMS-FILE-ID)
  8210*        RIDFLD    (MSTR-KEY)
  8211*        SET       (ADDRESS OF CLAIM-MASTER)
  8212*        UPDATE
  8213*    END-EXEC.
  8214*    MOVE '&"S        EU         (   #00007994' TO DFHEIV0
  8215     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8216     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8217     MOVE X'2020233030303037393934' TO DFHEIV0(25:11)
  8218     CALL 'kxdfhei1' USING DFHEIV0,
  8219           CLMS-FILE-ID,
  8220           DFHEIV20,
  8221           DFHEIV99,
  8222           MSTR-KEY,
  8223           DFHEIV99,
  8224           DFHEIV99,
  8225           DFHEIV99
  8226     SET ADDRESS OF CLAIM-MASTER TO
  8227         DFHEIV20
  8228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8229
  8230
  8231     if (cl-priority-cd = '8')
  8232        and (pi-processor-id not = 'PEMA'and 'JMS '
  8233             AND 'AMWA' AND 'KMSB')
  8234        MOVE ER-8003             TO EMI-ERROR
  8235        PERFORM 9900-ERROR-FORMAT
  8236                                 THRU 9900-EXIT
  8237        MOVE -1                  TO MAINTL
  8238        GO TO 8110-SEND-DATA
  8239     end-if
  8240
  8241     IF MLNAMEL IS GREATER THAN +0
  8242         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8243
  8244     IF MFNAMEL IS GREATER THAN +0
  8245         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8246
  8247     IF MMINITL IS GREATER THAN +0
  8248         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
  8249
  8250     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8251     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 149
* EL131.cbl
  8252     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8253     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8254
  8255     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8256         MOVE 'Y'                TO CL-YESNOSW
  8257     END-IF.
  8258
  8259
  8260* EXEC CICS HANDLE CONDITION
  8261*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8262*    END-EXEC.
  8263*    MOVE '"$$                   ! $ #00008029' TO DFHEIV0
  8264     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8265     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8266     MOVE X'2420233030303038303239' TO DFHEIV0(25:11)
  8267     CALL 'kxdfhei1' USING DFHEIV0
  8268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8269
  8270
  8271
  8272* EXEC CICS REWRITE
  8273*        DATASET   (CLMS-FILE-ID)
  8274*        FROM      (CLAIM-MASTER)
  8275*    END-EXEC.
  8276     MOVE LENGTH OF
  8277      CLAIM-MASTER
  8278       TO DFHEIV11
  8279*    MOVE '&& L                  %   #00008033' TO DFHEIV0
  8280     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8281     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8282     MOVE X'2020233030303038303333' TO DFHEIV0(25:11)
  8283     CALL 'kxdfhei1' USING DFHEIV0,
  8284           CLMS-FILE-ID,
  8285           CLAIM-MASTER,
  8286           DFHEIV11,
  8287           DFHEIV99
  8288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8289
  8290
  8291 0600-CONTINUE-NAME-UPDATE.
  8292
  8293     MOVE LOW-VALUES                 TO  EL131AO.
  8294     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8295     MOVE ER-0000                    TO  EMI-ERROR.
  8296     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8297     MOVE -1                         TO  MAINTL.
  8298     GO TO 8100-SEND-MAP.
  8299
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 150
* EL131.cbl
  8301 1000-EDIT-SCREEN.
  8302
  8303     MOVE MAINTI                 TO CHECK-MAINT.
  8304
  8305     IF NOT VALID-OPTIONS
  8306         MOVE 'X'                TO ERROR-SWITCH
  8307         MOVE -1                 TO MAINTL
  8308         MOVE AL-UABON           TO MAINTA
  8309         MOVE ER-0023            TO EMI-ERROR
  8310         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8311         GO TO 1010-EXIT.
  8312
  8313     IF NOT MODIFY-CAP
  8314         MOVE 'UPDATE'           TO  SM-READ
  8315         PERFORM 9995-SECURITY-VIOLATION
  8316         MOVE ER-0070               TO  EMI-ERROR
  8317         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8318         GO TO 8100-SEND-MAP.
  8319
  8320     IF DELETE-CLAIM
  8321         MOVE AL-UANON TO MAINTA
  8322         GO TO 1010-EXIT.
  8323
  8324     MOVE AL-UANON               TO MAINTA.
  8325
  8326     IF CCNOI GREATER THAN LOW-VALUES
  8327         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8328
  8329     IF PI-COMPANY-ID = 'CSL'
  8330        CONTINUE
  8331     ELSE
  8332        IF TYPEL > ZERO
  8333           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8334              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8335                    PI-LIFE-OVERRIDE-L1))
  8336                       OR
  8337              ((PI-COMPANY-ID = 'DCC' OR 'VPP')
  8338              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8339                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
  8340              MOVE AL-UANON      TO TYPEA
  8341              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8342           ELSE
  8343              MOVE ER-0199       TO EMI-ERROR
  8344              PERFORM 9900-ERROR-FORMAT
  8345                                 THRU 9900-EXIT
  8346              MOVE AL-UABON      TO TYPEA
  8347              MOVE -1            TO TYPEL
  8348              MOVE 'X'           TO ERROR-SWITCH
  8349           END-IF
  8350        ELSE
  8351           MOVE AL-UANOF         TO TYPEA
  8352        END-IF
  8353     END-IF
  8354     IF STATUSI GREATER THAN LOW-VALUES
  8355         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8356             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8357             MOVE AL-UANON       TO STATUSA
  8358             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 151
* EL131.cbl
  8359             MOVE 'Y'            TO DLYACTV-SW
  8360         ELSE
  8361             MOVE ER-0333        TO EMI-ERROR
  8362             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8363             MOVE AL-UABON       TO STATUSA
  8364             MOVE -1             TO STATUSL
  8365             MOVE 'X'            TO ERROR-SWITCH
  8366         END-IF
  8367     ELSE
  8368         MOVE SPACE              TO TRLR-SWITCH
  8369         MOVE 'N'                TO DLYACTV-SW
  8370         MOVE AL-UANOF           TO STATUSA.
  8371
  8372     IF PROCI GREATER THAN LOW-VALUES
  8373         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8374     ELSE
  8375         MOVE AL-UANOF TO PROCA.
  8376
  8377     IF SEXI GREATER THAN LOW-VALUES
  8378         IF SEXI = 'F' OR 'M'
  8379             MOVE AL-UANON       TO SEXA
  8380             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8381           ELSE
  8382             MOVE ER-0219        TO EMI-ERROR
  8383             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8384             MOVE AL-UABON       TO SEXA
  8385             MOVE -1             TO SEXL
  8386             MOVE 'X'            TO ERROR-SWITCH
  8387       ELSE
  8388         MOVE AL-UANOF           TO SEXA.
  8389
  8390     IF BIRTHL = +0
  8391         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8392         MOVE AL-UANOF           TO  BIRTHA
  8393         GO TO 1000-CONTINUE-EDITS.
  8394
  8395     IF BIRTHI = SPACES
  8396         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8397         MOVE 'X'                TO  UPDATE-SWITCH
  8398                                     MSTR-SWITCH
  8399         GO TO 1000-CONTINUE-EDITS.
  8400
  8401     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8402     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8403     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8404     MOVE '4'                    TO  DC-OPTION-CODE.
  8405     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8406     IF DATE-CONVERSION-ERROR
  8407         MOVE ER-0220            TO  EMI-ERROR
  8408         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8409         MOVE AL-UABON           TO  BIRTHA
  8410         MOVE -1                 TO  BIRTHL
  8411         MOVE 'X'                TO  ERROR-SWITCH
  8412         GO TO 1000-CONTINUE-EDITS.
  8413
  8414******************************************************************
  8415**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8416**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 152
* EL131.cbl
  8417**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8418******************************************************************
  8419     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8420         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8421         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8422         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8423         MOVE '4'                TO  DC-OPTION-CODE
  8424         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8425         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8426                                     DC-ELAPSED-DAYS
  8427         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8428         IF DATE-CONVERSION-ERROR
  8429             MOVE ER-0220        TO  EMI-ERROR
  8430             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8431             MOVE AL-UABON       TO  BIRTHA
  8432             MOVE -1             TO  BIRTHL
  8433             MOVE 'X'            TO  ERROR-SWITCH
  8434             GO TO 1000-CONTINUE-EDITS.
  8435
  8436     MOVE AL-UANON               TO  BIRTHA.
  8437     MOVE 'X'                    TO  UPDATE-SWITCH
  8438                                     MSTR-SWITCH.
  8439     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8440     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8441     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8442
  8443 1000-CONTINUE-EDITS.
  8444
  8445     IF SOCIALI GREATER THAN LOW-VALUES
  8446         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8447         IF WS-SOC-SEC-NO NUMERIC AND
  8448           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8449             NEXT SENTENCE
  8450         ELSE
  8451            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8452               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8453               WS-SSN-DASH2 = '-'
  8454                 NEXT SENTENCE
  8455            ELSE
  8456                 MOVE ER-0887        TO  EMI-ERROR
  8457                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8458                 MOVE AL-UABON       TO  SOCIALA
  8459                 MOVE -1             TO  SOCIALL
  8460                 MOVE 'X'            TO  ERROR-SWITCH
  8461            END-IF
  8462        END-IF
  8463     END-IF.
  8464     if critpl > zeros
  8465        and critpi numeric
  8466        move al-uanon            to critpa
  8467        move 'X'                 to update-switch
  8468     end-if
  8469     IF SOCIALI GREATER THAN LOW-VALUES
  8470         MOVE AL-UANON           TO SOCIALA
  8471         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8472     ELSE
  8473         MOVE AL-UANOF           TO SOCIALA.
  8474
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 153
* EL131.cbl
  8475     IF OCCI GREATER THAN LOW-VALUES
  8476         MOVE AL-UANON           TO OCCA
  8477         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8478     ELSE
  8479         MOVE AL-UANOF           TO OCCA.
  8480
  8481     IF BENEL NOT GREATER THAN ZERO
  8482            GO TO 1005-CONTINUE-EDITS.
  8483
  8484     IF BENEI = SPACES
  8485        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8486           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8487           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8488           IF AUTO-PAY-TO-BENE = 'Y'
  8489               MOVE ER-1773      TO  EMI-ERROR
  8490               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8491               MOVE 'X'          TO ERROR-SWITCH
  8492               MOVE AL-UABON     TO BENEA
  8493               MOVE -1           TO BENEL
  8494           ELSE
  8495               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8496           END-IF
  8497        ELSE
  8498           PERFORM 1050-EDIT-BENE THRU 1050-EXIT
  8499           IF PAYMENT-PENDING
  8500               MOVE ER-1772      TO  EMI-ERROR
  8501               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8502               MOVE 'X'          TO ERROR-SWITCH
  8503               MOVE AL-UABON     TO BENEA
  8504               MOVE -1           TO BENEL
  8505           END-IF
  8506           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8507        END-IF
  8508        GO TO 1005-CONTINUE-EDITS.
  8509
  8510
  8511* EXEC CICS HANDLE CONDITION
  8512*        NOTFND (1004-BENE-NOT-FOUND)
  8513*    END-EXEC.
  8514*    MOVE '"$I                   ! % #00008257' TO DFHEIV0
  8515     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8516     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8517     MOVE X'2520233030303038323537' TO DFHEIV0(25:11)
  8518     CALL 'kxdfhei1' USING DFHEIV0
  8519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8520
  8521
  8522     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8523     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8524     MOVE BENEI                  TO  WS-ELBENE-ID.
  8525
  8526
  8527* EXEC CICS READ
  8528*        DATASET ('ELBENE')
  8529*        RIDFLD  (WS-ELBENE-KEY)
  8530*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8531*    END-EXEC.
  8532     MOVE 'ELBENE' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 154
* EL131.cbl
  8533*    MOVE '&"S        E          (   #00008265' TO DFHEIV0
  8534     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8536     MOVE X'2020233030303038323635' TO DFHEIV0(25:11)
  8537     CALL 'kxdfhei1' USING DFHEIV0,
  8538           DFHEIV1,
  8539           DFHEIV20,
  8540           DFHEIV99,
  8541           WS-ELBENE-KEY,
  8542           DFHEIV99,
  8543           DFHEIV99,
  8544           DFHEIV99
  8545     SET ADDRESS OF BENEFICIARY-MASTER TO
  8546         DFHEIV20
  8547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8548
  8549
  8550     MOVE AL-UANON               TO  BENEA.
  8551     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8552
  8553     GO TO 1005-CONTINUE-EDITS.
  8554
  8555 1004-BENE-NOT-FOUND.
  8556     MOVE ER-0565                TO  EMI-ERROR.
  8557
  8558     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8559     MOVE 'X'                    TO ERROR-SWITCH.
  8560     MOVE AL-UABON               TO BENEA.
  8561     MOVE -1                     TO BENEL.
  8562
  8563 1005-CONTINUE-EDITS.
  8564
  8565     IF DIAGI GREATER THAN LOW-VALUES
  8566         MOVE AL-UANON           TO DIAGA
  8567         MOVE 'X'                TO UPDATE-SWITCH
  8568                                    NINETY-TRLR-SWITCH
  8569     ELSE
  8570         MOVE AL-UANOF           TO DIAGA.
  8571
  8572     IF ICD1I GREATER THAN LOW-VALUES
  8573         IF (ICD1I GREATER THAN SPACES) AND
  8574            (ICD1I(4:1) NOT = '.')
  8575             IF ICD1I(4:1) = ' '
  8576                 MOVE '.' TO ICD1I(4:1)
  8577             ELSE
  8578                 IF ICD1I(8:1) = ' '
  8579                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8580                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8581                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8582                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8583                     MOVE '.'        TO ICD1I(4:1)
  8584                 END-IF
  8585             END-IF
  8586         END-IF
  8587         IF (ICD1I GREATER THAN SPACES) AND
  8588            (ICD1I(1:1) NOT > ' ' OR
  8589             ICD1I(2:1) NOT > ' ' OR
  8590             ICD1I(3:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 155
* EL131.cbl
  8591             ICD1I(4:1) NOT = '.')
  8592              MOVE ER-0992        TO  EMI-ERROR
  8593              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8594              MOVE 'X'            TO ERROR-SWITCH
  8595              MOVE AL-UABON       TO ICD1A
  8596              MOVE -1             TO ICD1L
  8597         ELSE
  8598             MOVE AL-UANON       TO ICD1A
  8599             MOVE 'X'            TO UPDATE-SWITCH
  8600                                    NINETY-TRLR-SWITCH
  8601         END-IF
  8602     ELSE
  8603         MOVE AL-UANOF           TO ICD1A
  8604     END-IF.
  8605
  8606     IF ICD2I GREATER THAN LOW-VALUES
  8607         IF (ICD2I GREATER THAN SPACES) AND
  8608            (ICD2I(4:1) NOT = '.')
  8609             IF ICD2I(4:1) = ' '
  8610                 MOVE '.' TO ICD2I(4:1)
  8611             ELSE
  8612                 IF ICD2I(8:1) = ' '
  8613                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8614                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8615                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8616                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8617                     MOVE '.'        TO ICD2I(4:1)
  8618                 END-IF
  8619             END-IF
  8620         END-IF
  8621         IF (ICD2I GREATER THAN SPACES) AND
  8622            (ICD2I(1:1) NOT > ' ' OR
  8623             ICD2I(2:1) NOT > ' ' OR
  8624             ICD2I(3:1) NOT > ' ' OR
  8625             ICD2I(4:1) NOT = '.')
  8626              MOVE ER-0992        TO EMI-ERROR
  8627              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8628              MOVE 'X'            TO ERROR-SWITCH
  8629              MOVE AL-UABON       TO ICD2A
  8630              MOVE -1             TO ICD2L
  8631         ELSE
  8632             MOVE AL-UANON       TO ICD2A
  8633             MOVE 'X'            TO UPDATE-SWITCH
  8634                                    NINETY-TRLR-SWITCH
  8635         END-IF
  8636     ELSE
  8637         MOVE AL-UANOF           TO ICD2A
  8638     END-IF.
  8639
  8640*    IF CAUSEI GREATER THAN LOW-VALUES
  8641*        MOVE AL-UANON           TO CAUSEA
  8642*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8643*    ELSE
  8644*        MOVE AL-UANOF           TO CAUSEA.
  8645
  8646*    IF ENDL GREATER THAN ZERO
  8647*        MOVE LOW-VALUES         TO HOLD-END
  8648*        IF ENDI = SPACES
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 156
* EL131.cbl
  8649*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8650*        ELSE
  8651*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8652*            EXEC CICS BIF DEEDIT
  8653*                FIELD    (DEEDIT-DATE-INPUT)
  8654*                LENGTH   (DATE-LENGTH)
  8655*            END-EXEC
  8656*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8657*            MOVE '4'            TO DC-OPTION-CODE
  8658*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8659*            IF NOT DATE-CONVERSION-ERROR
  8660*                MOVE DC-BIN-DATE-1      TO HOLD-END
  8661*                MOVE AL-UANON   TO ENDA
  8662*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8663*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8664*            ELSE
  8665*                MOVE ER-0224    TO EMI-ERROR
  8666*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8667*                MOVE AL-UABON   TO ENDA
  8668*                MOVE -1         TO ENDL
  8669*                MOVE 'X'        TO ERROR-SWITCH
  8670*      ELSE
  8671*          MOVE AL-UANOF         TO ENDA.
  8672
  8673     IF INCL GREATER THAN ZERO
  8674         MOVE LOW-VALUES         TO HOLD-INCUR
  8675         IF INCI = SPACES
  8676             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8677         ELSE
  8678             MOVE INCI           TO DEEDIT-DATE-INPUT
  8679
  8680* EXEC CICS BIF DEEDIT
  8681*                FIELD    (DEEDIT-DATE-INPUT)
  8682*                LENGTH   (DATE-LENGTH)
  8683*            END-EXEC
  8684*    MOVE '@"L                   #   #00008400' TO DFHEIV0
  8685     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8686     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8687     MOVE X'2020233030303038343030' TO DFHEIV0(25:11)
  8688     CALL 'kxdfhei1' USING DFHEIV0,
  8689           DEEDIT-DATE-INPUT,
  8690           DATE-LENGTH
  8691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8692             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8693             MOVE '4'            TO DC-OPTION-CODE
  8694             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8695             IF NOT DATE-CONVERSION-ERROR
  8696                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8697                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8698                 MOVE AL-UANON           TO INCA
  8699                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8700             ELSE
  8701                 MOVE ER-0222    TO EMI-ERROR
  8702                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8703                 MOVE AL-UABON   TO INCA
  8704                 MOVE -1         TO INCL
  8705                 MOVE 'X'        TO ERROR-SWITCH
  8706       ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 157
* EL131.cbl
  8707           IF PI-NO-PMTS = ZEROS
  8708               MOVE AL-UANOF     TO INCA.
  8709
  8710     IF REPL GREATER THAN ZERO
  8711         MOVE LOW-VALUES         TO HOLD-REPORTED
  8712         IF REPI = SPACES
  8713             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8714         ELSE
  8715             MOVE REPI           TO DEEDIT-DATE-INPUT
  8716
  8717* EXEC CICS BIF DEEDIT
  8718*                FIELD    (DEEDIT-DATE-INPUT)
  8719*                LENGTH   (DATE-LENGTH)
  8720*            END-EXEC
  8721*    MOVE '@"L                   #   #00008428' TO DFHEIV0
  8722     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8723     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8724     MOVE X'2020233030303038343238' TO DFHEIV0(25:11)
  8725     CALL 'kxdfhei1' USING DFHEIV0,
  8726           DEEDIT-DATE-INPUT,
  8727           DATE-LENGTH
  8728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8729             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8730             MOVE '4'            TO DC-OPTION-CODE
  8731             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8732             IF NOT DATE-CONVERSION-ERROR
  8733                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8734                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8735                 MOVE AL-UANON   TO REPA
  8736                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8737             ELSE
  8738                 MOVE ER-0223    TO EMI-ERROR
  8739                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8740                 MOVE AL-UABON   TO REPA
  8741                 MOVE -1         TO REPL
  8742                 MOVE 'X'        TO ERROR-SWITCH
  8743       ELSE
  8744         MOVE AL-UANOF TO REPA.
  8745
  8746     IF PDTHRUI GREATER THAN LOW-VALUES
  8747        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8748        IF PDTHRUI = SPACES
  8749           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8750        ELSE
  8751           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8752
  8753* EXEC CICS BIF DEEDIT
  8754*               FIELD    (DEEDIT-DATE-INPUT)
  8755*               LENGTH   (DATE-LENGTH)
  8756*          END-EXEC
  8757*    MOVE '@"L                   #   #00008455' TO DFHEIV0
  8758     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8759     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8760     MOVE X'2020233030303038343535' TO DFHEIV0(25:11)
  8761     CALL 'kxdfhei1' USING DFHEIV0,
  8762           DEEDIT-DATE-INPUT,
  8763           DATE-LENGTH
  8764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 158
* EL131.cbl
  8765           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8766           MOVE '4'            TO DC-OPTION-CODE
  8767           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8768           IF NOT DATE-CONVERSION-ERROR
  8769              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8770              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8771              MOVE AL-UANON   TO PDTHRUA
  8772              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8773              IF PI-USES-PAID-TO
  8774                 MOVE '6'            TO DC-OPTION-CODE
  8775                 MOVE -1             TO DC-ELAPSED-DAYS
  8776                 MOVE +0             TO DC-ELAPSED-MONTHS
  8777                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8778                 IF NO-CONVERSION-ERROR
  8779                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8780                 ELSE
  8781                    NEXT SENTENCE
  8782              ELSE
  8783                 NEXT SENTENCE
  8784           ELSE
  8785              MOVE ER-0475    TO EMI-ERROR
  8786              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8787              MOVE AL-UABON   TO PDTHRUA
  8788              MOVE -1         TO PDTHRUL
  8789              MOVE 'X'        TO ERROR-SWITCH
  8790     ELSE
  8791        IF MODIFY-CAP
  8792           MOVE AL-UANOF        TO PDTHRUA.
  8793
  8794     IF PDAMTL GREATER THAN +0
  8795         MOVE ZEROS              TO HOLD-PDAMT
  8796
  8797* EXEC CICS BIF DEEDIT
  8798*            FIELD    (PDAMTI)
  8799*            LENGTH   (9)
  8800*        END-EXEC
  8801     MOVE 9
  8802       TO DFHEIV11
  8803*    MOVE '@"L                   #   #00008490' TO DFHEIV0
  8804     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8805     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8806     MOVE X'2020233030303038343930' TO DFHEIV0(25:11)
  8807     CALL 'kxdfhei1' USING DFHEIV0,
  8808           PDAMTI,
  8809           DFHEIV11
  8810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8811         IF PDAMTI NUMERIC
  8812             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8813             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8814             MOVE AL-UNNON       TO PDAMTA
  8815         ELSE
  8816             MOVE ER-0547        TO EMI-ERROR
  8817             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8818             MOVE AL-UNBON       TO PDAMTA
  8819             MOVE -1             TO PDAMTL
  8820             MOVE 'X'            TO ERROR-SWITCH
  8821     ELSE
  8822         IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 159
* EL131.cbl
  8823            MOVE AL-UNNOF        TO PDAMTA.
  8824
  8825     IF NODAYSI GREATER THAN LOW-VALUES
  8826         MOVE ZEROS              TO HOLD-NODAYS
  8827
  8828* EXEC CICS BIF DEEDIT
  8829*            FIELD (NODAYSI)
  8830*            LENGTH (5)
  8831*        END-EXEC
  8832     MOVE 5
  8833       TO DFHEIV11
  8834*    MOVE '@"L                   #   #00008510' TO DFHEIV0
  8835     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8836     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8837     MOVE X'2020233030303038353130' TO DFHEIV0(25:11)
  8838     CALL 'kxdfhei1' USING DFHEIV0,
  8839           NODAYSI,
  8840           DFHEIV11
  8841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8842         IF NODAYSI NUMERIC
  8843             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8844             MOVE AL-UNNON       TO NODAYSA
  8845             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8846         ELSE
  8847             MOVE ER-0491        TO EMI-ERROR
  8848             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8849             MOVE AL-UNBON       TO NODAYSA
  8850             MOVE -1             TO NODAYSL
  8851             MOVE 'X'            TO ERROR-SWITCH
  8852     ELSE
  8853         IF MODIFY-CAP
  8854            MOVE AL-UNNOF        TO NODAYSA.
  8855
  8856     IF NOPMTSI GREATER THAN LOW-VALUES
  8857         MOVE ZEROS              TO HOLD-NOPMTS
  8858
  8859* EXEC CICS BIF DEEDIT
  8860*            FIELD (NOPMTSI)
  8861*            LENGTH (4)
  8862*        END-EXEC
  8863     MOVE 4
  8864       TO DFHEIV11
  8865*    MOVE '@"L                   #   #00008530' TO DFHEIV0
  8866     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8867     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8868     MOVE X'2020233030303038353330' TO DFHEIV0(25:11)
  8869     CALL 'kxdfhei1' USING DFHEIV0,
  8870           NOPMTSI,
  8871           DFHEIV11
  8872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8873         IF NOPMTSI NUMERIC
  8874             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8875             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8876             MOVE AL-UNNON       TO NOPMTSA
  8877           ELSE
  8878             MOVE ER-0548        TO EMI-ERROR
  8879             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8880             MOVE AL-UNBON       TO NOPMTSA
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 160
* EL131.cbl
  8881             MOVE -1             TO NOPMTSL
  8882             MOVE 'X'            TO ERROR-SWITCH
  8883       ELSE
  8884         IF MODIFY-CAP
  8885            MOVE AL-UNNOF        TO NOPMTSA.
  8886
  8887     IF FORMTYPI GREATER THAN LOW-VALUES
  8888         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8889             MOVE AL-UANON       TO FORMTYPA
  8890             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8891           ELSE
  8892             MOVE ER-7650        TO EMI-ERROR
  8893             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8894             MOVE AL-UABON       TO FORMTYPA
  8895             MOVE -1             TO FORMTYPL
  8896             MOVE 'X'            TO ERROR-SWITCH
  8897       ELSE
  8898         MOVE AL-UANOF           TO FORMTYPA.
  8899
  8900     IF PRICDL GREATER THAN ZERO
  8901         IF (PRICDI = ' ') OR
  8902            (PRICDI GREATER THAN ZERO   AND
  8903             PRICDI NOT GREATER THAN '9')
  8904             MOVE AL-UANON       TO PRICDA
  8905             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8906         ELSE
  8907             MOVE ER-0274        TO EMI-ERROR
  8908             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8909             MOVE AL-UABON       TO PRICDA
  8910             MOVE -1             TO PRICDL
  8911             MOVE 'X'            TO ERROR-SWITCH
  8912     ELSE
  8913         MOVE AL-UANOF TO PRICDA.
  8914
  8915     IF PI-COMPANY-ID = 'DMD'
  8916     IF PRICDL GREATER THAN ZERO
  8917       IF SYSTEM-MODIFY-CAP  OR
  8918          PI-PROCESSOR-ID = 'LGXX'
  8919             NEXT SENTENCE
  8920           ELSE
  8921            IF CL-PRIORITY-CD = '9'  OR
  8922               PRICDI         = '9'
  8923                  MOVE ER-0938        TO EMI-ERROR
  8924                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8925                  MOVE AL-UABON       TO PRICDA
  8926                  MOVE -1             TO PRICDL
  8927                  MOVE 'X'            TO ERROR-SWITCH.
  8928
  8929     IF FILETOL GREATER THAN ZERO
  8930         MOVE AL-UANON           TO FILETOA
  8931         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8932     ELSE
  8933         MOVE AL-UANOF TO FILETOA.
  8934
  8935     IF SUPVL GREATER THAN ZERO
  8936         IF SUPVI = 'Y' OR 'N' OR SPACE
  8937             MOVE AL-UANON       TO SUPVA
  8938             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 161
* EL131.cbl
  8939         ELSE
  8940             MOVE ER-0230        TO EMI-ERROR
  8941             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8942             MOVE AL-UABON       TO SUPVA
  8943             MOVE -1             TO SUPVL
  8944             MOVE 'X'            TO ERROR-SWITCH
  8945     ELSE
  8946         MOVE AL-UANOF           TO SUPVA.
  8947
  8948     IF MLNAMEL GREATER THAN ZERO
  8949         IF MLNAMEI GREATER THAN SPACES
  8950            MOVE AL-UANON        TO MLNAMEA
  8951            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8952                                     MSTR-KEY-SWITCH
  8953         ELSE
  8954            MOVE ER-0236         TO EMI-ERROR
  8955            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8956            MOVE AL-UABON        TO MLNAMEA
  8957            MOVE -1              TO MLNAMEL
  8958            MOVE 'X'             TO ERROR-SWITCH
  8959     ELSE
  8960         MOVE AL-UANOF           TO MLNAMEA.
  8961
  8962     IF MFNAMEI GREATER THAN LOW-VALUES
  8963         MOVE AL-UANON           TO MFNAMEA
  8964         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8965     ELSE
  8966         MOVE AL-UANOF           TO MFNAMEA.
  8967
  8968     IF MMINITI GREATER THAN LOW-VALUES
  8969         MOVE AL-UANON           TO MMINITA
  8970         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8971     ELSE
  8972         MOVE AL-UANOF           TO MMINITA.
  8973
  8974     IF CRTLNMEI GREATER THAN LOW-VALUES
  8975         IF CRTLNMEI NOT = SPACES
  8976            MOVE AL-UANON        TO CRTLNMEA
  8977            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8978                                     CERT-KEY-SWITCH
  8979        ELSE
  8980            MOVE ER-0236         TO EMI-ERROR
  8981            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8982            MOVE AL-UABON        TO CRTLNMEA
  8983            MOVE -1              TO CRTLNMEL
  8984            MOVE 'X'             TO ERROR-SWITCH
  8985     ELSE
  8986         MOVE AL-UANOF           TO CRTLNMEA.
  8987
  8988     IF CRTFNMEI GREATER THAN LOW-VALUES
  8989         MOVE AL-UANON           TO CRTFNMEA
  8990         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8991     ELSE
  8992         MOVE AL-UANOF           TO CRTFNMEA.
  8993
  8994     IF CRTINITI GREATER THAN LOW-VALUES
  8995         MOVE AL-UANON           TO CRTINITA
  8996         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 162
* EL131.cbl
  8997     ELSE
  8998         MOVE AL-UANOF           TO CRTINITA.
  8999
  9000     IF ISSAGEL GREATER THAN ZERO
  9001         IF ISSAGEI NUMERIC
  9002            MOVE AL-UANON        TO ISSAGEA
  9003            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9004         ELSE
  9005            MOVE ER-0237         TO EMI-ERROR
  9006            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9007            MOVE AL-UABON        TO ISSAGEA
  9008            MOVE -1              TO ISSAGEL
  9009            MOVE 'X'             TO ERROR-SWITCH
  9010     ELSE
  9011         MOVE AL-UANOF           TO ISSAGEA.
  9012
  9013     IF JNTFNMEI GREATER THAN LOW-VALUES
  9014         MOVE AL-UANON           TO JNTFNMEA
  9015         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9016     ELSE
  9017         MOVE AL-UANOF           TO JNTFNMEA.
  9018
  9019     IF JNTLNMEI GREATER THAN LOW-VALUES
  9020         MOVE AL-UANON           TO JNTLNMEA
  9021         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9022     ELSE
  9023         MOVE AL-UANOF           TO JNTLNMEA.
  9024
  9025     IF JNTINITI GREATER THAN LOW-VALUES
  9026         MOVE AL-UANON           TO JNTINITA
  9027         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9028     ELSE
  9029         MOVE AL-UANOF           TO JNTINITA.
  9030
  9031     IF JNTAGEL GREATER THAN ZERO
  9032         IF JNTAGEI NUMERIC
  9033            MOVE AL-UANON        TO JNTAGEA
  9034            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9035         ELSE
  9036            MOVE ER-0238         TO EMI-ERROR
  9037            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9038            MOVE AL-UABON        TO JNTAGEA
  9039            MOVE -1              TO JNTAGEL
  9040            MOVE 'X'             TO ERROR-SWITCH
  9041     ELSE
  9042         MOVE AL-UANOF           TO JNTAGEA.
  9043
  9044     IF ADDONDTI GREATER THAN LOW-VALUES
  9045         MOVE LOW-VALUES         TO HOLD-ADDON
  9046         IF ADDONDTI = SPACES
  9047             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  9048         ELSE
  9049             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  9050
  9051* EXEC CICS BIF DEEDIT
  9052*                FIELD    (DEEDIT-DATE-INPUT)
  9053*                LENGTH   (DATE-LENGTH)
  9054*            END-EXEC
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 163
* EL131.cbl
  9055*    MOVE '@"L                   #   #00008711' TO DFHEIV0
  9056     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9057     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9058     MOVE X'2020233030303038373131' TO DFHEIV0(25:11)
  9059     CALL 'kxdfhei1' USING DFHEIV0,
  9060           DEEDIT-DATE-INPUT,
  9061           DATE-LENGTH
  9062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9063             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9064             MOVE '4'            TO DC-OPTION-CODE
  9065             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9066             IF NOT DATE-CONVERSION-ERROR
  9067                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  9068                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  9069                                                  CERT-SWITCH
  9070                 MOVE AL-UANON   TO ADDONDTA
  9071                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  9072             ELSE
  9073                 MOVE ER-7651    TO EMI-ERROR
  9074                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9075                 MOVE AL-UABON   TO ADDONDTA
  9076                 MOVE -1         TO ADDONDTL
  9077                 MOVE 'X'        TO ERROR-SWITCH
  9078       ELSE
  9079         MOVE AL-UANOF TO ADDONDTA.
  9080
  9081     IF LCVCDI GREATER THAN LOW-VALUES
  9082         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  9083         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  9084     ELSE
  9085         MOVE AL-UANOF           TO LCVCDA.
  9086
  9087     IF ACVCDI GREATER THAN LOW-VALUES
  9088         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  9089         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  9090     ELSE
  9091         MOVE AL-UANOF           TO ACVCDA.
  9092
  9093     IF LCVOTRMI GREATER THAN LOW-VALUES
  9094
  9095* EXEC CICS BIF DEEDIT
  9096*            FIELD (LCVOTRMI)
  9097*            LENGTH(3)
  9098*        END-EXEC
  9099     MOVE 3
  9100       TO DFHEIV11
  9101*    MOVE '@"L                   #   #00008746' TO DFHEIV0
  9102     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9103     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9104     MOVE X'2020233030303038373436' TO DFHEIV0(25:11)
  9105     CALL 'kxdfhei1' USING DFHEIV0,
  9106           LCVOTRMI,
  9107           DFHEIV11
  9108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9109         IF LCVOTRMI IS NUMERIC
  9110             MOVE LCVOTRMI       TO LCVOTRMO
  9111             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9112             MOVE AL-UANON       TO LCVOTRMA
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 164
* EL131.cbl
  9113         ELSE
  9114             MOVE ER-0241        TO EMI-ERROR
  9115             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9116             MOVE AL-UNBON       TO LCVOTRMA
  9117             MOVE 'X'            TO ERROR-SWITCH
  9118             MOVE -1             TO LCVOTRML
  9119     ELSE
  9120         MOVE AL-UANOF           TO LCVOTRMA.
  9121
  9122     IF ACVOTRMI GREATER THAN LOW-VALUES
  9123
  9124* EXEC CICS BIF DEEDIT
  9125*            FIELD (ACVOTRMI)
  9126*            LENGTH(3)
  9127*        END-EXEC
  9128     MOVE 3
  9129       TO DFHEIV11
  9130*    MOVE '@"L                   #   #00008764' TO DFHEIV0
  9131     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9132     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9133     MOVE X'2020233030303038373634' TO DFHEIV0(25:11)
  9134     CALL 'kxdfhei1' USING DFHEIV0,
  9135           ACVOTRMI,
  9136           DFHEIV11
  9137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9138         IF ACVOTRMI IS NUMERIC
  9139             MOVE ACVOTRMI       TO ACVOTRMO
  9140             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9141             MOVE AL-UANON       TO ACVOTRMA
  9142         ELSE
  9143             MOVE ER-0241        TO EMI-ERROR
  9144             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9145             MOVE AL-UNBON       TO ACVOTRMA
  9146             MOVE 'X'            TO ERROR-SWITCH
  9147             MOVE -1             TO ACVOTRML
  9148     ELSE
  9149         MOVE AL-UANOF           TO ACVOTRMA.
  9150
  9151     IF LCVRATEL GREATER THAN +0
  9152
  9153* EXEC CICS BIF DEEDIT
  9154*            FIELD (LCVRATEI)
  9155*            LENGTH(6)
  9156*        END-EXEC
  9157     MOVE 6
  9158       TO DFHEIV11
  9159*    MOVE '@"L                   #   #00008782' TO DFHEIV0
  9160     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9161     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9162     MOVE X'2020233030303038373832' TO DFHEIV0(25:11)
  9163     CALL 'kxdfhei1' USING DFHEIV0,
  9164           LCVRATEI,
  9165           DFHEIV11
  9166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9167         IF LCVRATEI IS NUMERIC
  9168             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  9169             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9170             MOVE AL-UNNON       TO LCVRATEA
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 165
* EL131.cbl
  9171         ELSE
  9172             MOVE ER-2280        TO EMI-ERROR
  9173             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9174             MOVE AL-UNBON       TO LCVRATEA
  9175             MOVE 'X'            TO ERROR-SWITCH
  9176             MOVE -1             TO LCVRATEL
  9177     ELSE
  9178         MOVE AL-UNNOF           TO LCVRATEA.
  9179
  9180     IF ACVRATEL GREATER THAN +0
  9181
  9182* EXEC CICS BIF DEEDIT
  9183*            FIELD (ACVRATEI)
  9184*            LENGTH(6)
  9185*        END-EXEC
  9186     MOVE 6
  9187       TO DFHEIV11
  9188*    MOVE '@"L                   #   #00008800' TO DFHEIV0
  9189     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9190     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9191     MOVE X'2020233030303038383030' TO DFHEIV0(25:11)
  9192     CALL 'kxdfhei1' USING DFHEIV0,
  9193           ACVRATEI,
  9194           DFHEIV11
  9195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9196         IF ACVRATEI IS NUMERIC
  9197             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9198             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9199             MOVE AL-UNNON       TO ACVRATEA
  9200         ELSE
  9201             MOVE ER-2280        TO EMI-ERROR
  9202             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9203             MOVE AL-UNBON       TO ACVRATEA
  9204             MOVE 'X'            TO ERROR-SWITCH
  9205             MOVE -1             TO ACVRATEL
  9206     ELSE
  9207         MOVE AL-UNNOF           TO ACVRATEA.
  9208
  9209     IF LCVBENEL GREATER THAN ZERO
  9210
  9211* EXEC CICS BIF DEEDIT
  9212*            FIELD (LCVBENEI)
  9213*            LENGTH (11)
  9214*        END-EXEC
  9215     MOVE 11
  9216       TO DFHEIV11
  9217*    MOVE '@"L                   #   #00008818' TO DFHEIV0
  9218     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9219     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9220     MOVE X'2020233030303038383138' TO DFHEIV0(25:11)
  9221     CALL 'kxdfhei1' USING DFHEIV0,
  9222           LCVBENEI,
  9223           DFHEIV11
  9224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9225         IF LCVBENEI IS NUMERIC
  9226            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9227            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9228            MOVE AL-UNNON        TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 166
* EL131.cbl
  9229         ELSE
  9230            MOVE ER-0243         TO EMI-ERROR
  9231            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9232            MOVE AL-UNBON        TO LCVBENEA
  9233            MOVE -1              TO LCVBENEL
  9234            MOVE 'X'             TO ERROR-SWITCH
  9235     ELSE
  9236         MOVE AL-UANOF           TO LCVBENEA.
  9237
  9238     IF ACVBENEL GREATER THAN ZERO
  9239
  9240* EXEC CICS BIF DEEDIT
  9241*            FIELD (ACVBENEI)
  9242*            LENGTH (11)
  9243*        END-EXEC
  9244     MOVE 11
  9245       TO DFHEIV11
  9246*    MOVE '@"L                   #   #00008836' TO DFHEIV0
  9247     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9248     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9249     MOVE X'2020233030303038383336' TO DFHEIV0(25:11)
  9250     CALL 'kxdfhei1' USING DFHEIV0,
  9251           ACVBENEI,
  9252           DFHEIV11
  9253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9254         IF ACVBENEI IS NUMERIC
  9255            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9256            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9257            MOVE AL-UNNON        TO ACVBENEA
  9258         ELSE
  9259            MOVE ER-0243         TO EMI-ERROR
  9260            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9261            MOVE AL-UNBON        TO ACVBENEA
  9262            MOVE -1              TO ACVBENEL
  9263            MOVE 'X'             TO ERROR-SWITCH
  9264     ELSE
  9265         MOVE AL-UANOF           TO ACVBENEA.
  9266
  9267     IF LCVFORMI GREATER THAN LOW-VALUES
  9268        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9269        MOVE AL-UANON            TO LCVFORMA
  9270     ELSE
  9271        MOVE AL-UANOF            TO LCVFORMA.
  9272
  9273     IF ACVFORMI GREATER THAN LOW-VALUES
  9274        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9275        MOVE AL-UANON            TO ACVFORMA
  9276     ELSE
  9277        MOVE AL-UANOF            TO ACVFORMA.
  9278
  9279     IF LCVCNDTL GREATER THAN ZERO
  9280         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9281         IF LCVCNDTI = SPACES
  9282             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9283         ELSE
  9284             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9285             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9286             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 167
* EL131.cbl
  9287             MOVE '4'            TO DC-OPTION-CODE
  9288             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9289             IF NOT DATE-CONVERSION-ERROR
  9290                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9291                 MOVE AL-UANON   TO LCVCNDTA
  9292                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9293                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9294             ELSE
  9295                 MOVE ER-0246    TO EMI-ERROR
  9296                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9297                 MOVE AL-UABON   TO LCVCNDTA
  9298                 MOVE -1         TO LCVCNDTL
  9299                 MOVE 'X'        TO ERROR-SWITCH
  9300     ELSE
  9301         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9302         MOVE AL-UANOF           TO LCVCNDTA.
  9303
  9304     IF ACVCNDTL GREATER THAN ZERO
  9305         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9306         IF ACVCNDTI = SPACES
  9307             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9308         ELSE
  9309             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9310             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9311             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9312             MOVE '4'            TO DC-OPTION-CODE
  9313             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9314             IF NOT DATE-CONVERSION-ERROR
  9315                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9316                 MOVE AL-UANON   TO ACVCNDTA
  9317                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9318                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9319             ELSE
  9320                 MOVE ER-0246    TO EMI-ERROR
  9321                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9322                 MOVE AL-UABON   TO ACVCNDTA
  9323                 MOVE -1         TO ACVCNDTL
  9324                 MOVE 'X'        TO ERROR-SWITCH
  9325     ELSE
  9326         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9327         MOVE AL-UANOF           TO ACVCNDTA.
  9328
  9329     IF APRL GREATER THAN +0
  9330
  9331* EXEC CICS BIF DEEDIT
  9332*            FIELD    (APRI)
  9333*            LENGTH   (8)
  9334*        END-EXEC
  9335     MOVE 8
  9336       TO DFHEIV11
  9337*    MOVE '@"L                   #   #00008916' TO DFHEIV0
  9338     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9339     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9340     MOVE X'2020233030303038393136' TO DFHEIV0(25:11)
  9341     CALL 'kxdfhei1' USING DFHEIV0,
  9342           APRI,
  9343           DFHEIV11
  9344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 168
* EL131.cbl
  9345         IF APRI NUMERIC
  9346            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9347            MOVE APRI            TO HOLD-APR APRO
  9348            MOVE AL-UANON        TO APRA
  9349          ELSE
  9350            MOVE ER-0259         TO EMI-ERROR
  9351            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9352            MOVE AL-UABON        TO APRA
  9353            MOVE -1              TO APRL
  9354            MOVE 'X'             TO ERROR-SWITCH
  9355     ELSE
  9356         MOVE AL-UANOF           TO APRA.
  9357
  9358     IF PMTFREQL GREATER THAN ZERO
  9359
  9360* EXEC CICS BIF DEEDIT
  9361*            FIELD    (PMTFREQI)
  9362*            LENGTH   (2)
  9363*        END-EXEC
  9364     MOVE 2
  9365       TO DFHEIV11
  9366*    MOVE '@"L                   #   #00008934' TO DFHEIV0
  9367     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9368     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9369     MOVE X'2020233030303038393334' TO DFHEIV0(25:11)
  9370     CALL 'kxdfhei1' USING DFHEIV0,
  9371           PMTFREQI,
  9372           DFHEIV11
  9373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9374         IF PMTFREQI NUMERIC
  9375            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9376            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9377            MOVE AL-UANON        TO PMTFREQA
  9378          ELSE
  9379            MOVE ER-0427         TO EMI-ERROR
  9380            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9381            MOVE AL-UABON        TO PMTFREQA
  9382            MOVE -1              TO PMTFREQL
  9383            MOVE 'X'             TO ERROR-SWITCH
  9384     ELSE
  9385         MOVE AL-UANOF           TO PMTFREQA.
  9386
  9387     IF INDGRPL GREATER THAN ZERO
  9388         IF INDGRPI = 'I' OR 'G' OR SPACE
  9389             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9390             MOVE AL-UANON       TO INDGRPA
  9391          ELSE
  9392             MOVE ER-0260        TO EMI-ERROR
  9393             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9394             MOVE AL-UABON       TO INDGRPA
  9395             MOVE -1             TO INDGRPL
  9396             MOVE 'X'            TO ERROR-SWITCH
  9397     ELSE
  9398         MOVE AL-UANOF           TO INDGRPA.
  9399
  9400     IF PREMTYPL GREATER THAN ZERO
  9401         IF PREMTYPI = '1' OR '2' OR '3'
  9402            MOVE PREMTYPI        TO PI-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 169
* EL131.cbl
  9403            MOVE AL-UNNON        TO PREMTYPA
  9404            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9405          ELSE
  9406            MOVE ER-0227         TO EMI-ERROR
  9407            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9408            MOVE AL-UNBON        TO PREMTYPA
  9409            MOVE -1              TO PREMTYPL
  9410            MOVE 'X'             TO ERROR-SWITCH
  9411     ELSE
  9412         MOVE AL-UANOF           TO PREMTYPA.
  9413
  9414     IF LOANBALL GREATER THAN ZERO
  9415
  9416* EXEC CICS BIF DEEDIT
  9417*             FIELD    (LOANBALI)
  9418*             LENGTH   (9)
  9419*        END-EXEC
  9420     MOVE 9
  9421       TO DFHEIV11
  9422*    MOVE '@"L                   #   #00008979' TO DFHEIV0
  9423     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9424     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9425     MOVE X'2020233030303038393739' TO DFHEIV0(25:11)
  9426     CALL 'kxdfhei1' USING DFHEIV0,
  9427           LOANBALI,
  9428           DFHEIV11
  9429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9430         IF LOANBALI NUMERIC
  9431             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9432             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9433             MOVE AL-UNNON TO LOANBALA
  9434         ELSE
  9435             MOVE ER-0639        TO EMI-ERROR
  9436             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9437             MOVE AL-UNBON       TO LOANBALA
  9438             MOVE -1             TO LOANBALL
  9439             MOVE 'X'            TO ERROR-SWITCH
  9440     ELSE
  9441         MOVE AL-UNNOF           TO LOANBALA.
  9442
  9443*    IF LOANNOL GREATER THAN ZERO
  9444*          MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9445*          MOVE AL-UANON            TO LOANNOA
  9446*       ELSE
  9447*          MOVE AL-UANOF            TO LOANNOA.
  9448
  9449     IF REINCDI GREATER THAN LOW-VALUES
  9450        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9451        MOVE AL-UANON            TO REINCDA
  9452     ELSE
  9453        MOVE AL-UANOF            TO REINCDA.
  9454
  9455     IF CERTI GREATER THAN LOW-VALUES
  9456         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9457     ELSE
  9458         MOVE AL-UANOF           TO CERTA.
  9459
  9460     IF CERTEFFI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 170
* EL131.cbl
  9461         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9462     ELSE
  9463         MOVE AL-UANOF           TO CERTEFFA.
  9464
  9465     IF CERTACTI GREATER THAN LOW-VALUES
  9466         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9467     ELSE
  9468         MOVE AL-UANOF           TO CERTACTA.
  9469
  9470     IF CERTSTI GREATER THAN LOW-VALUES
  9471         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9472     ELSE
  9473         MOVE AL-UANOF           TO CERTSTA.
  9474
  9475     IF CERTCARI GREATER THAN LOW-VALUES
  9476         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9477     ELSE
  9478         MOVE AL-UANOF           TO CERTCARA.
  9479
  9480     IF DLYACTV-RECORD-NEEDED
  9481         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9482                 1150-EXIT
  9483     END-IF.
  9484
  9485     IF CERTEFFI GREATER LOW-VALUES OR
  9486        CERTACTI GREATER LOW-VALUES OR
  9487        CERTSTI  GREATER LOW-VALUES OR
  9488        CERTCARI GREATER LOW-VALUES OR
  9489        CERTGRPI GREATER LOW-VALUES
  9490        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9491
  9492*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9493*      IF PI-PREM-TYPE NOT = '1'  AND
  9494*         PI-NO-PMTS = ZEROS
  9495*          IF LOANBALL GREATER +0 OR
  9496*             ACVBENEL GREATER +0
  9497*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9498     if not acct-found
  9499        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9500     end-if
  9501     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9502     MOVE PI-CARRIER             TO CARRIER-CODE
  9503     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9504     MOVE PI-CERT-NO             TO CERT-NO
  9505
  9506* EXEC CICS READ
  9507*        DATASET   (CLMS-FILE-ID)
  9508*        RIDFLD    (MSTR-KEY)
  9509*        SET       (ADDRESS OF CLAIM-MASTER)
  9510*        RESP      (WS-RESPONSE)
  9511*    END-EXEC
  9512*    MOVE '&"S        E          (  N#00009058' TO DFHEIV0
  9513     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9514     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9515     MOVE X'204E233030303039303538' TO DFHEIV0(25:11)
  9516     CALL 'kxdfhei1' USING DFHEIV0,
  9517           CLMS-FILE-ID,
  9518           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 171
* EL131.cbl
  9519           DFHEIV99,
  9520           MSTR-KEY,
  9521           DFHEIV99,
  9522           DFHEIV99,
  9523           DFHEIV99
  9524     SET ADDRESS OF CLAIM-MASTER TO
  9525         DFHEIV20
  9526     MOVE EIBRESP  TO WS-RESPONSE
  9527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9528     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9529     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9530     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  9531     MOVE CL-CERT-STATE          TO CERT-STATE
  9532     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9533     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9534     MOVE CL-CERT-NO             TO CERT-CERT
  9535
  9536* EXEC CICS READ
  9537*       DATASET   (CERT-FILE-ID)
  9538*       RIDFLD    (CERT-KEY)
  9539*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9540*       RESP      (WS-RESPONSE)
  9541*    END-EXEC
  9542*    MOVE '&"S        E          (  N#00009071' TO DFHEIV0
  9543     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9544     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9545     MOVE X'204E233030303039303731' TO DFHEIV0(25:11)
  9546     CALL 'kxdfhei1' USING DFHEIV0,
  9547           CERT-FILE-ID,
  9548           DFHEIV20,
  9549           DFHEIV99,
  9550           CERT-KEY,
  9551           DFHEIV99,
  9552           DFHEIV99,
  9553           DFHEIV99
  9554     SET ADDRESS OF CERTIFICATE-MASTER TO
  9555         DFHEIV20
  9556     MOVE EIBRESP  TO WS-RESPONSE
  9557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9558     if mfnamei > low-values
  9559        move mfnamei to w-name-first
  9560     else
  9561        move cl-insured-1st-name to w-name-first
  9562     end-if
  9563     if mlnamei > low-values
  9564        move mlnamei to w-name-last
  9565     else
  9566        move cl-insured-last-name to w-name-last
  9567     end-if
  9568     if instypel > zeros
  9569        evaluate true
  9570           when cl-no-of-days-paid > zeros
  9571              move er-1668       to emi-error
  9572              perform 9900-error-format
  9573                                 thru 9900-exit
  9574              move al-uabon      to instypea
  9575              move -1            to instypel
  9576              move 'X'           to error-switch
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 172
* EL131.cbl
  9577           when instypei = 'C'
  9578              if w-name-first (1:10) = cm-insured-first-name
  9579                 move er-1666    to emi-error
  9580                 PERFORM 9900-ERROR-FORMAT
  9581                                 THRU 9900-EXIT
  9582                 move al-uabon   to instypea
  9583                 move -1         to instypel
  9584                 move 'X'        to error-switch
  9585              end-if
  9586           when instypei = 'P'
  9587              if (w-name-first (1:10) <> cm-insured-first-name)
  9588                 or (w-name-last <> cm-insured-last-name)
  9589                 move er-1676    to emi-error
  9590                 PERFORM 9900-ERROR-FORMAT
  9591                                 THRU 9900-EXIT
  9592                 move al-uabon   to instypea
  9593                 move -1         to instypel
  9594                 move 'X'        to error-switch
  9595              end-if
  9596        end-evaluate
  9597     end-if
  9598*    if (instypel > zeros)
  9599*       and (cl-no-of-days-paid > zero)
  9600*       move er-1668             to emi-error
  9601*       perform 9900-error-format thru 9900-exit
  9602*       move al-uabon            to instypea
  9603*       move -1                  to instypel
  9604*       move 'X'                 to error-switch
  9605*    end-if
  9606*
  9607*    if instypel > zero
  9608*       if instypei = 'C'
  9609*          if w-name-first (1:10) = cm-insured-first-name
  9610*             move er-1666          to emi-error
  9611*             PERFORM 9900-ERROR-FORMAT
  9612*                                   THRU 9900-EXIT
  9613*             move al-uabon         to instypea
  9614*             move -1               to instypel
  9615*             move 'X'              to error-switch
  9616*          end-if
  9617*       end-if
  9618*    end-if
  9619     if (pi-company-id = 'DCC' OR 'VPP')
  9620        and (acct-found)
  9621        perform 2120-check-pdef  thru 2120-exit
  9622        IF EXTENSL > ZERO
  9623           IF EXTENSI NUMERIC
  9624              IF EXTENSI >  WS-MAX-EXTENSION
  9625                AND ERPDEF-FOUND
  9626                 MOVE ER-1678          TO EMI-ERROR
  9627                 PERFORM 9900-ERROR-FORMAT
  9628                                       THRU 9900-EXIT
  9629                 MOVE AL-UABON         TO EXTENSA
  9630                 MOVE -1               TO EXTENSL
  9631                 MOVE 'X'              TO ERROR-SWITCH
  9632              ELSE
  9633                 MOVE 'X'              TO UPDATE-SWITCH
  9634              END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 173
* EL131.cbl
  9635           ELSE
  9636              MOVE ER-1778          TO EMI-ERROR
  9637              PERFORM 9900-ERROR-FORMAT
  9638                                    THRU 9900-EXIT
  9639              MOVE AL-UABON         TO EXTENSA
  9640              MOVE -1               TO EXTENSL
  9641              MOVE 'X'              TO ERROR-SWITCH
  9642           END-IF
  9643        END-IF
  9644     end-if
  9645     if benperl > zeros
  9646        move al-uanon            to benpera
  9647     end-if
  9648     if benperl > zeros
  9649        if benperi numeric
  9650           perform 1015-edit-benefit-period
  9651                                 thru 1015-exit
  9652        else
  9653           move er-1669          to emi-error
  9654           PERFORM 9900-ERROR-FORMAT
  9655                                 THRU 9900-EXIT
  9656           move al-uabon         to benpera
  9657           move -1               to benperl
  9658           move 'X'              to error-switch
  9659        end-if
  9660    end-if
  9661     if instypel > zeros
  9662        if instypei = 'P' OR 'C'
  9663           move 'X'              to update-switch
  9664                                    mstr-switch
  9665           move al-uanon         to instypea
  9666        else
  9667            move er-1654          to emi-error
  9668           PERFORM 9900-ERROR-FORMAT
  9669                                 THRU 9900-EXIT
  9670           move al-uabon         to instypea
  9671           move -1               to instypel
  9672           move 'X'              to error-switch
  9673        end-if
  9674    end-if
  9675     if accswl > zeros
  9676        if accswi = 'Y' OR 'N'
  9677           MOVE 'X'              TO UPDATE-SWITCH
  9678                                    MSTR-SWITCH
  9679           MOVE AL-UANON         TO accswa
  9680*       else
  9681*          move er-1656          to emi-error
  9682*          PERFORM 9900-ERROR-FORMAT
  9683*                                THRU 9900-EXIT
  9684*          move al-uabon         to accswa
  9685*          move -1               to accswl
  9686*          move 'X'              to error-switch
  9687*          move al-uanof         to accswa
  9688        end-if
  9689     end-if
  9690     IF CERTL = ZEROS AND
  9691        SUFXL = ZEROS
  9692          GO TO 1010-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 174
* EL131.cbl
  9693
  9694     IF CERTL GREATER THAN ZEROS
  9695         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9696             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9697             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9698             MOVE 'X'            TO ERROR-SWITCH
  9699             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9700
  9701     IF SUFXL GREATER THAN ZEROS
  9702         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9703             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9704             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9705             MOVE 'X'            TO ERROR-SWITCH
  9706             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9707
  9708 1010-EXIT.
  9709     EXIT.
  9710
  9711 1015-edit-benefit-period.
  9712     move ' '                    to ws-benper-sw
  9713     evaluate true
  9714        when not erpdef-found
  9715           set good-benper       to true
  9716        when pd-recurring-yn (a1) = 'Y'
  9717           set good-benper       to true
  9718        when pd-recurring-yn (a1) = 'N'
  9719           if benperi < 02
  9720              set good-benper    to true
  9721           end-if
  9722        when pd-rec-crit-period (a1) numeric
  9723           if benperi <= pd-rec-crit-period (a1)
  9724              set good-benper    to true
  9725           end-if
  9726     end-evaluate
  9727     MOVE CERT-KEY               TO ELCRTT-KEY
  9728     MOVE 'B'                    TO CTRLR-REC-TYPE
  9729
  9730* EXEC CICS READ
  9731*       DATASET   ('ELCRTT')
  9732*       RIDFLD    (ELCRTT-KEY)
  9733*       INTO      (CERTIFICATE-TRAILERS)
  9734*       RESP      (WS-RESPONSE)
  9735*    END-EXEC
  9736     MOVE LENGTH OF
  9737      CERTIFICATE-TRAILERS
  9738       TO DFHEIV11
  9739     MOVE 'ELCRTT' TO DFHEIV1
  9740*    MOVE '&"IL       E          (  N#00009248' TO DFHEIV0
  9741     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9742     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9743     MOVE X'204E233030303039323438' TO DFHEIV0(25:11)
  9744     CALL 'kxdfhei1' USING DFHEIV0,
  9745           DFHEIV1,
  9746           CERTIFICATE-TRAILERS,
  9747           DFHEIV11,
  9748           ELCRTT-KEY,
  9749           DFHEIV99,
  9750           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 175
* EL131.cbl
  9751           DFHEIV99
  9752     MOVE EIBRESP  TO WS-RESPONSE
  9753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9754     IF WS-RESP-NORMAL
  9755        perform varying s1 from +1 by +1 until
  9756           (s1 > +24)
  9757           or ((cs-claim-type (s1) = cl-claim-type)
  9758           and (cs-insured-type (s1) = cl-insured-type)
  9759           and (cs-benefit-period (s1) > benperi))
  9760        end-perform
  9761        if s1 < +25
  9762           move er-1665          to emi-error
  9763           PERFORM 9900-ERROR-FORMAT
  9764                                 THRU 9900-EXIT
  9765           move al-uabon         to benpera
  9766           move -1               to benperl
  9767           move 'X'              to error-switch
  9768           go to 1015-exit
  9769*       else
  9770*          set good-benper       to true
  9771        end-if
  9772     end-if
  9773     if good-benper
  9774        move 'X'                 to update-switch
  9775                                    mstr-switch
  9776        move al-uanon            to benpera
  9777     else
  9778        move er-1669             to emi-error
  9779        PERFORM 9900-ERROR-FORMAT
  9780                                 THRU 9900-EXIT
  9781        move al-uabon            to benpera
  9782        move -1                  to benperl
  9783        move 'X'                 to error-switch
  9784     end-if
  9785     .
  9786 1015-exit.
  9787     exit.
  9788 1030-EDIT-NAME.
  9789     IF INSTYPEL > ZEROS
  9790        MOVE INSTYPEI TO CL-INSURED-TYPE
  9791     END-IF
  9792     IF MFNAMEL > +0
  9793        IF CL-INSURED-TYPE = 'C'
  9794          AND (CM-INSURED-FIRST-NAME = MFNAMEI(1:10))
  9795           MOVE ER-1675             TO EMI-ERROR
  9796           MOVE -1                  TO MFNAMEL
  9797           MOVE AL-UABON            TO MFNAMEA
  9798           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9799           MOVE 'X'                 TO ERROR-SWITCH
  9800        ELSE
  9801          IF CL-INSURED-TYPE = 'P'
  9802            AND (CM-INSURED-FIRST-NAME <> MFNAMEI(1:10))
  9803             MOVE ER-1676             TO EMI-ERROR
  9804             MOVE -1                  TO MFNAMEL
  9805             MOVE AL-UABON            TO MFNAMEA
  9806             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9807             MOVE 'X'                 TO ERROR-SWITCH
  9808          END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 176
* EL131.cbl
  9809        END-IF
  9810     END-IF.
  9811
  9812 1030-EXIT.
  9813     EXIT.
  9814 1050-EDIT-BENE.
  9815     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
  9816     MOVE PI-CARRIER         TO TRLR-CARRIER.
  9817     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
  9818     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
  9819     MOVE 1000               TO TRLR-SEQ-NO.
  9820
  9821
  9822* EXEC CICS HANDLE CONDITION
  9823*         NOTFND    (1052-DONE)
  9824*         ENDFILE   (1052-DONE)
  9825*    END-EXEC.
  9826*    MOVE '"$I''                  ! & #00009321' TO DFHEIV0
  9827     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9828     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9829     MOVE X'2620233030303039333231' TO DFHEIV0(25:11)
  9830     CALL 'kxdfhei1' USING DFHEIV0
  9831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9832
  9833
  9834
  9835* EXEC CICS STARTBR
  9836*        DATASET (TRLR-FILE-ID)
  9837*        RIDFLD  (TRLR-KEY)
  9838*    END-EXEC
  9839     MOVE 0
  9840       TO DFHEIV11
  9841*    MOVE '&,         G          &   #00009326' TO DFHEIV0
  9842     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9843     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9844     MOVE X'2020233030303039333236' TO DFHEIV0(25:11)
  9845     CALL 'kxdfhei1' USING DFHEIV0,
  9846           TRLR-FILE-ID,
  9847           TRLR-KEY,
  9848           DFHEIV99,
  9849           DFHEIV11,
  9850           DFHEIV99
  9851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9852
  9853
  9854     MOVE SPACES TO WS-TRLR-FILE-EOF
  9855                    WS-PAYMENT-PENDING
  9856     PERFORM 1052-READ-TRLR THRU 1052-EXIT
  9857       UNTIL  TRLR-FILE-EOF
  9858         OR PAYMENT-PENDING
  9859
  9860
  9861* EXEC CICS ENDBR
  9862*        DATASET (TRLR-FILE-ID)
  9863*    END-EXEC.
  9864     MOVE 0
  9865       TO DFHEIV11
  9866*    MOVE '&2                    $   #00009338' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 177
* EL131.cbl
  9867     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9868     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9869     MOVE X'2020233030303039333338' TO DFHEIV0(25:11)
  9870     CALL 'kxdfhei1' USING DFHEIV0,
  9871           TRLR-FILE-ID,
  9872           DFHEIV11,
  9873           DFHEIV99
  9874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9875
  9876 1050-EXIT.
  9877     EXIT.
  9878
  9879 1052-READ-TRLR.
  9880
  9881* EXEC CICS READNEXT
  9882*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9883*         DATASET  (TRLR-FILE-ID)
  9884*         RIDFLD   (TRLR-KEY)
  9885*    END-EXEC.
  9886     MOVE 0
  9887       TO DFHEIV11
  9888*    MOVE '&.S                   )   #00009345' TO DFHEIV0
  9889     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9890     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9891     MOVE X'2020233030303039333435' TO DFHEIV0(25:11)
  9892     CALL 'kxdfhei1' USING DFHEIV0,
  9893           TRLR-FILE-ID,
  9894           DFHEIV20,
  9895           DFHEIV99,
  9896           TRLR-KEY,
  9897           DFHEIV99,
  9898           DFHEIV11,
  9899           DFHEIV99,
  9900           DFHEIV99
  9901     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9902         DFHEIV20
  9903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9904
  9905
  9906     IF PI-COMPANY-CD   = TRLR-COMPANY-CD
  9907       AND PI-CARRIER  = TRLR-CARRIER
  9908       AND PI-CLAIM-NO = TRLR-CLAIM-NO
  9909       AND PI-CERT-NO  = TRLR-CERT-NO
  9910        CONTINUE
  9911     ELSE
  9912        GO TO 1052-DONE
  9913     END-IF.
  9914
  9915     IF PAYMENT-TR
  9916       AND BENEFICIARY-PAID
  9917       AND AT-VOID-DT = LOW-VALUES
  9918       AND AT-CHECK-WRITTEN-DT NOT > SPACES
  9919         SET PAYMENT-PENDING TO TRUE
  9920     END-IF.
  9921
  9922     IF CORRESPONDENCE-TR
  9923        IF AT-AUTH-RCVD = 'Y'
  9924           SET AUTH-RCVD TO TRUE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 178
* EL131.cbl
  9925        ELSE
  9926        IF AT-AUTH-RCVD = 'N'
  9927           SET NO-AUTH-RCVD TO TRUE
  9928        END-IF
  9929        END-IF
  9930     END-IF.
  9931
  9932     GO TO 1052-EXIT.
  9933
  9934 1052-DONE.
  9935     SET TRLR-FILE-EOF TO TRUE.
  9936 1052-EXIT.
  9937     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 179
* EL131.cbl
  9939 1120-EDIT-PROC.
  9940     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9941     MOVE '2'                    TO CNTL-REC-TYPE.
  9942     MOVE PROCI                  TO CNTL-PROC-ID.
  9943     MOVE ZERO                   TO CNTL-SEQ-NO.
  9944
  9945
  9946* EXEC CICS HANDLE CONDITION
  9947*         NOTFND    (1120-CNTL-NOTFND)
  9948*    END-EXEC.
  9949*    MOVE '"$I                   ! '' #00009390' TO DFHEIV0
  9950     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9951     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9952     MOVE X'2720233030303039333930' TO DFHEIV0(25:11)
  9953     CALL 'kxdfhei1' USING DFHEIV0
  9954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9955
  9956
  9957
  9958* EXEC CICS READ
  9959*         SET      (ADDRESS OF CONTROL-FILE)
  9960*         DATASET  (CNTL-FILE-ID)
  9961*         RIDFLD   (CNTL-KEY)
  9962*    END-EXEC.
  9963*    MOVE '&"S        E          (   #00009394' TO DFHEIV0
  9964     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9965     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9966     MOVE X'2020233030303039333934' TO DFHEIV0(25:11)
  9967     CALL 'kxdfhei1' USING DFHEIV0,
  9968           CNTL-FILE-ID,
  9969           DFHEIV20,
  9970           DFHEIV99,
  9971           CNTL-KEY,
  9972           DFHEIV99,
  9973           DFHEIV99,
  9974           DFHEIV99
  9975     SET ADDRESS OF CONTROL-FILE TO
  9976         DFHEIV20
  9977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9978
  9979
  9980     MOVE AL-UANON               TO PROCA.
  9981     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9982     GO TO 1120-EXIT.
  9983
  9984 1120-CNTL-NOTFND.
  9985     MOVE ER-0273                TO EMI-ERROR.
  9986     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9987     MOVE AL-UABON               TO PROCA.
  9988     MOVE -1                     TO PROCL.
  9989     MOVE 'X'                    TO ERROR-SWITCH.
  9990
  9991 1120-EXIT.
  9992     EXIT.
  9993
  9994*************************************************************
  9995*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9996*************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 180
* EL131.cbl
  9997
  9998 1150-OUTPUT-ACTIVITY-RECORD.
  9999
 10000
 10001* EXEC CICS GETMAIN
 10002*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 10003*        LENGTH (25)
 10004*        INITIMG (WS-BLANK)
 10005*    END-EXEC.
 10006     MOVE 25
 10007       TO DFHEIV11
 10008*    MOVE ',"IL                  $   #00009420' TO DFHEIV0
 10009     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10010     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10011     MOVE X'2020233030303039343230' TO DFHEIV0(25:11)
 10012     CALL 'kxdfhei1' USING DFHEIV0,
 10013           DFHEIV20,
 10014           DFHEIV11,
 10015           WS-BLANK
 10016     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 10017         DFHEIV20
 10018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10019
 10020
 10021     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 10022     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 10023     MOVE PI-CARRIER             TO DA-CARRIER.
 10024     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
 10025     MOVE PI-CERT-NO             TO DA-CERT-NO.
 10026     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
 10027     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
 10028
 10029
 10030* EXEC CICS HANDLE CONDITION
 10031*        NOTOPEN (1150-NOTOPEN-ERROR)
 10032*        DUPREC (1150-EXIT)
 10033*    END-EXEC.
 10034*    MOVE '"$J%                  ! ( #00009434' TO DFHEIV0
 10035     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 10036     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10037     MOVE X'2820233030303039343334' TO DFHEIV0(25:11)
 10038     CALL 'kxdfhei1' USING DFHEIV0
 10039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10040
 10041     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
 10042     MOVE 'DLYACTV'              TO JP-FILE-ID.
 10043     MOVE 'A'                    TO JP-RECORD-TYPE.
 10044     MOVE +48                    TO JOURNAL-LENGTH.
 10045
 10046
 10047* EXEC CICS WRITE
 10048*        DATASET ('DLYACTV')
 10049*        RIDFLD (DA-KEY)
 10050*        FROM (DAILY-ACTIVITY-RECORD)
 10051*        LENGTH (25)
 10052*    END-EXEC.
 10053     MOVE 'DLYACTV' TO DFHEIV1
 10054     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 181
* EL131.cbl
 10055       TO DFHEIV11
 10056*    MOVE '&$ L                  ''   #00009443' TO DFHEIV0
 10057     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10058     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10059     MOVE X'2020233030303039343433' TO DFHEIV0(25:11)
 10060     CALL 'kxdfhei1' USING DFHEIV0,
 10061           DFHEIV1,
 10062           DAILY-ACTIVITY-RECORD,
 10063           DFHEIV11,
 10064           DA-KEY,
 10065           DFHEIV99,
 10066           DFHEIV99
 10067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10068
 10069
 10070     GO TO 1150-EXIT.
 10071
 10072 1150-NOTOPEN-ERROR.
 10073
 10074     MOVE '2955'                 TO EMI-ERROR.
 10075     MOVE -1                     TO MAINTL.
 10076     MOVE AL-UANON               TO MAINTA.
 10077     MOVE 'X'                    TO ERROR-SWITCH.
 10078     PERFORM 9900-ERROR-FORMAT THRU
 10079             9900-EXIT.
 10080
 10081 1150-EXIT.
 10082     EXIT.
 10083
 10084*************************************************************
 10085*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
 10086*************************************************************
 10087
 10088 1240-EDIT-LIFE-CODE.
 10089
 10090     IF INVALID-BENEFIT-CODE
 10091         GO TO 1240-SET-ERROR.
 10092
 10093     MOVE SPACES                 TO BENEFIT-KEY.
 10094     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10095     MOVE '4'                    TO BEN-REC-TYPE.
 10096     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10097     MOVE ZERO                   TO BEN-SEQ-NO.
 10098
 10099
 10100* EXEC CICS READ GTEQ
 10101*         DATASET  (CNTL-FILE-ID)
 10102*         RIDFLD   (BENEFIT-KEY)
 10103*         SET      (ADDRESS OF CONTROL-FILE)
 10104*    END-EXEC.
 10105*    MOVE '&"S        G          (   #00009479' TO DFHEIV0
 10106     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10107     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10108     MOVE X'2020233030303039343739' TO DFHEIV0(25:11)
 10109     CALL 'kxdfhei1' USING DFHEIV0,
 10110           CNTL-FILE-ID,
 10111           DFHEIV20,
 10112           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 182
* EL131.cbl
 10113           BENEFIT-KEY,
 10114           DFHEIV99,
 10115           DFHEIV99,
 10116           DFHEIV99
 10117     SET ADDRESS OF CONTROL-FILE TO
 10118         DFHEIV20
 10119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10120
 10121
 10122     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10123        CF-RECORD-TYPE NOT = '4'
 10124         GO TO 1240-SET-ERROR.
 10125
 10126     MOVE ZERO                   TO COUNT-2.
 10127     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10128
 10129     IF SCREEN-ERROR
 10130         GO TO 1240-SET-ERROR.
 10131
 10132 1240-SET-CODE-SWITCHES.
 10133     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10134     MOVE AL-UANON               TO LCVCDA.
 10135     GO TO 1240-EXIT.
 10136
 10137 1240-SET-ERROR.
 10138     MOVE ER-0240                TO EMI-ERROR.
 10139     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10140     MOVE 'X'                    TO ERROR-SWITCH.
 10141     MOVE AL-UABON               TO LCVCDA.
 10142     MOVE -1                     TO LCVCDL.
 10143
 10144 1240-EXIT.
 10145     EXIT.
 10146
 10147 1310-EDIT-AH-CODE.
 10148     IF INVALID-BENEFIT-CODE
 10149         GO TO 1310-SET-ERROR.
 10150
 10151     MOVE SPACES                 TO BENEFIT-KEY.
 10152     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10153     MOVE '5'                    TO BEN-REC-TYPE.
 10154     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10155     MOVE ZERO                   TO BEN-SEQ-NO.
 10156
 10157
 10158* EXEC CICS READ GTEQ
 10159*         DATASET  (CNTL-FILE-ID)
 10160*         RIDFLD   (BENEFIT-KEY)
 10161*         SET      (ADDRESS OF CONTROL-FILE)
 10162*    END-EXEC.
 10163*    MOVE '&"S        G          (   #00009520' TO DFHEIV0
 10164     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10165     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10166     MOVE X'2020233030303039353230' TO DFHEIV0(25:11)
 10167     CALL 'kxdfhei1' USING DFHEIV0,
 10168           CNTL-FILE-ID,
 10169           DFHEIV20,
 10170           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 183
* EL131.cbl
 10171           BENEFIT-KEY,
 10172           DFHEIV99,
 10173           DFHEIV99,
 10174           DFHEIV99
 10175     SET ADDRESS OF CONTROL-FILE TO
 10176         DFHEIV20
 10177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10178
 10179
 10180     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10181        CF-RECORD-TYPE NOT = '5'
 10182         GO TO 1310-SET-ERROR.
 10183
 10184     MOVE ZERO                   TO COUNT-2.
 10185     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10186     IF SCREEN-ERROR
 10187         GO TO 1310-SET-ERROR.
 10188
 10189 1310-SET-CODE-SWITCHES.
 10190     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10191     MOVE AL-UANON               TO ACVCDA.
 10192     GO TO 1310-EXIT.
 10193
 10194 1310-SET-ERROR.
 10195     MOVE ER-0250                TO EMI-ERROR.
 10196     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10197     MOVE AL-UABON               TO ACVCDA.
 10198     MOVE 'X'                    TO ERROR-SWITCH.
 10199     MOVE -1                     TO ACVCDL.
 10200
 10201 1310-EXIT.
 10202     EXIT.
 10203
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 184
* EL131.cbl
 10205 1460-EDIT-CERT-NO.
 10206     MOVE CERTI                  TO WS-CERT-NO-PRIME.
 10207     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
 10208
 10209     IF WS-SAVE-CERT-NO = SPACES
 10210         MOVE ER-0203            TO EMI-ERROR
 10211         GO TO 1460-CERT-NO-ERROR.
 10212
 10213     IF WS-CERT-NO-PRIME = SPACES AND
 10214        WS-CERT-NO-SUFX GREATER THAN SPACE
 10215            MOVE ER-0210         TO EMI-ERROR
 10216            GO TO 1460-CERT-NO-ERROR.
 10217
 10218     MOVE 'X'                    TO UPDATE-SWITCH.
 10219     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10220     MOVE AL-UANON               TO CERTA.
 10221
 10222     IF SUFXL IS GREATER THAN 0
 10223         MOVE AL-UANON           TO SUFXA.
 10224
 10225     GO TO 1460-EXIT.
 10226
 10227 1460-CERT-NO-ERROR.
 10228     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10229     MOVE AL-UABON               TO SUFXA.
 10230     MOVE AL-UABON               TO CERTA.
 10231     MOVE -1                     TO CERTL.
 10232     MOVE 'X'                    TO ERROR-SWITCH.
 10233
 10234 1460-EXIT.
 10235     EXIT.
 10236
 10237 1470-EDIT-EFF.
 10238     IF CERTEFFI = SPACES
 10239         GO TO 1470-DATE-ERROR.
 10240
 10241     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
 10242     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
 10243     IF DEEDIT-DATE = ZERO
 10244         GO TO 1470-DATE-ERROR.
 10245
 10246     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
 10247     MOVE '4'                    TO DC-OPTION-CODE.
 10248     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 10249     IF NOT DATE-CONVERSION-ERROR
 10250         MOVE DC-BIN-DATE-1      TO HOLD-EFF
 10251         MOVE AL-UANON           TO CERTEFFA
 10252         MOVE 'X'                TO UPDATE-SWITCH
 10253         MOVE 'Y'                TO CERT-KEY-SWITCH
 10254         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
 10255         GO TO 1470-EXIT.
 10256
 10257 1470-DATE-ERROR.
 10258     MOVE ER-0215                TO EMI-ERROR.
 10259     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10260     MOVE AL-UABON               TO CERTEFFA.
 10261     MOVE -1                     TO CERTEFFL.
 10262     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 185
* EL131.cbl
 10263
 10264 1470-EXIT.
 10265     EXIT.
 10266
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 186
* EL131.cbl
 10268 1480-EDIT-ACCT.
 10269     IF CERTACTI = SPACES
 10270         MOVE ER-0232            TO EMI-ERROR
 10271         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10272         MOVE AL-UABON           TO CERTACTA
 10273         MOVE -1                 TO CERTACTL
 10274         MOVE 'X'                TO ERROR-SWITCH
 10275     ELSE
 10276         MOVE 'X'                TO UPDATE-SWITCH
 10277         MOVE 'Y'                TO CERT-KEY-SWITCH.
 10278
 10279 1480-EXIT.
 10280     EXIT.
 10281
 10282 1490-EDIT-STATE.
 10283     IF CERTSTI = SPACES
 10284         MOVE ER-0233            TO EMI-ERROR
 10285         GO TO 1490-STATE-ERROR.
 10286
 10287     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10288     MOVE '3'                    TO CNTL-REC-TYPE.
 10289     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 10290     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
 10291     MOVE ZERO                   TO CNTL-SEQ-NO.
 10292
 10293
 10294* EXEC CICS HANDLE CONDITION
 10295*         NOTFND (1490-STATE-NOTFND)
 10296*    END-EXEC.
 10297*    MOVE '"$I                   ! ) #00009639' TO DFHEIV0
 10298     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10299     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10300     MOVE X'2920233030303039363339' TO DFHEIV0(25:11)
 10301     CALL 'kxdfhei1' USING DFHEIV0
 10302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10303
 10304
 10305
 10306* EXEC CICS READ
 10307*         SET        (ADDRESS OF CONTROL-FILE)
 10308*         DATASET    ('ELCNTL')
 10309*         RIDFLD     (CNTL-KEY)
 10310*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10311*         GENERIC
 10312*    END-EXEC.
 10313     MOVE 'ELCNTL' TO DFHEIV1
 10314*    MOVE '&"S  KG    E          (   #00009643' TO DFHEIV0
 10315     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10316     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10317     MOVE X'2020233030303039363433' TO DFHEIV0(25:11)
 10318     CALL 'kxdfhei1' USING DFHEIV0,
 10319           DFHEIV1,
 10320           DFHEIV20,
 10321           DFHEIV99,
 10322           CNTL-KEY,
 10323           CNTL-GENERIC-LENGTH,
 10324           DFHEIV99,
 10325           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 187
* EL131.cbl
 10326     SET ADDRESS OF CONTROL-FILE TO
 10327         DFHEIV20
 10328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10329
 10330
 10331     MOVE AL-UANON               TO CERTSTA.
 10332     MOVE 'X'                    TO UPDATE-SWITCH.
 10333     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10334     GO TO 1490-EXIT.
 10335
 10336 1490-STATE-NOTFND.
 10337     MOVE ER-0149                TO EMI-ERROR.
 10338
 10339 1490-STATE-ERROR.
 10340     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10341     MOVE AL-UABON               TO CERTSTA.
 10342     MOVE -1                     TO CERTSTL.
 10343     MOVE 'X'                    TO ERROR-SWITCH.
 10344
 10345 1490-EXIT.
 10346     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 188
* EL131.cbl
 10348 1500-EDIT-CARR.
 10349     IF CERTCARI = SPACES
 10350         GO TO 1500-CARR-NOTFND.
 10351
 10352     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10353     MOVE '6'                    TO CNTL-REC-TYPE.
 10354     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
 10355     MOVE CERTCARI               TO CNTL-CARRIER.
 10356     MOVE ZERO                   TO CNTL-SEQ-NO.
 10357
 10358
 10359* EXEC CICS HANDLE CONDITION
 10360*         NOTFND   (1500-CARR-NOTFND)
 10361*    END-EXEC.
 10362*    MOVE '"$I                   ! * #00009678' TO DFHEIV0
 10363     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10364     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10365     MOVE X'2A20233030303039363738' TO DFHEIV0(25:11)
 10366     CALL 'kxdfhei1' USING DFHEIV0
 10367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10368
 10369
 10370
 10371* EXEC CICS READ
 10372*         SET        (ADDRESS OF CONTROL-FILE)
 10373*         DATASET    ('ELCNTL')
 10374*         RIDFLD     (CNTL-KEY)
 10375*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10376*         GENERIC
 10377*    END-EXEC.
 10378     MOVE 'ELCNTL' TO DFHEIV1
 10379*    MOVE '&"S  KG    E          (   #00009682' TO DFHEIV0
 10380     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10381     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10382     MOVE X'2020233030303039363832' TO DFHEIV0(25:11)
 10383     CALL 'kxdfhei1' USING DFHEIV0,
 10384           DFHEIV1,
 10385           DFHEIV20,
 10386           DFHEIV99,
 10387           CNTL-KEY,
 10388           CNTL-GENERIC-LENGTH,
 10389           DFHEIV99,
 10390           DFHEIV99
 10391     SET ADDRESS OF CONTROL-FILE TO
 10392         DFHEIV20
 10393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10394
 10395
 10396     MOVE AL-UANON               TO CERTCARA.
 10397     MOVE 'X'                    TO UPDATE-SWITCH.
 10398     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10399     GO TO 1500-EXIT.
 10400
 10401 1500-CARR-NOTFND.
 10402     MOVE ER-0360                TO EMI-ERROR.
 10403     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10404     MOVE AL-UABON               TO CERTCARA.
 10405     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 189
* EL131.cbl
 10406     MOVE 'X'                    TO ERROR-SWITCH.
 10407
 10408 1500-EXIT.
 10409     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 190
* EL131.cbl
 10411 1510-DEEDIT-DATE.
 10412
 10413* EXEC CICS BIF DEEDIT
 10414*         FIELD    (DEEDIT-DATE-INPUT)
 10415*         LENGTH   (DATE-LENGTH)
 10416*    END-EXEC.
 10417*    MOVE '@"L                   #   #00009706' TO DFHEIV0
 10418     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10419     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10420     MOVE X'2020233030303039373036' TO DFHEIV0(25:11)
 10421     CALL 'kxdfhei1' USING DFHEIV0,
 10422           DEEDIT-DATE-INPUT,
 10423           DATE-LENGTH
 10424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10425
 10426
 10427 1510-EXIT.
 10428     EXIT.
 10429
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 191
* EL131.cbl
 10431 1620-VERIFY-ACCT.
 10432
 10433     move ' '                    to ws-eracct-sw
 10434     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10435     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10436     MOVE PI-GROUPING            TO ACCT-GROUP.
 10437     MOVE PI-STATE               TO ACCT-STATE.
 10438     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10439
 10440     IF CERTEFFI GREATER THAN LOW-VALUES
 10441         MOVE HOLD-EFF           TO ACCT-DATE
 10442     ELSE
 10443         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10444
 10445     IF CERTACTI GREATER THAN LOW-VALUES
 10446         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10447     IF CERTSTI GREATER THAN LOW-VALUES
 10448         MOVE CERTSTI            TO  ACCT-STATE.
 10449     IF CERTCARI GREATER THAN LOW-VALUES
 10450         MOVE CERTCARI           TO  ACCT-CARRIER.
 10451     IF CERTGRPI GREATER THAN LOW-VALUES
 10452         MOVE CERTGRPI           TO ACCT-GROUP.
 10453
 10454     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10455
 10456
 10457* EXEC CICS HANDLE CONDITION
 10458*         NOTFND  (1620-ACCT-NOTFND)
 10459*    END-EXEC.
 10460*    MOVE '"$I                   ! + #00009740' TO DFHEIV0
 10461     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10462     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10463     MOVE X'2B20233030303039373430' TO DFHEIV0(25:11)
 10464     CALL 'kxdfhei1' USING DFHEIV0
 10465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10466
 10467
 10468
 10469* EXEC CICS STARTBR
 10470*         DATASET   (ACCT-FILE-ID)
 10471*         RIDFLD    (ACCT-KEY)
 10472*    END-EXEC.
 10473     MOVE 0
 10474       TO DFHEIV11
 10475*    MOVE '&,         G          &   #00009744' TO DFHEIV0
 10476     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10477     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10478     MOVE X'2020233030303039373434' TO DFHEIV0(25:11)
 10479     CALL 'kxdfhei1' USING DFHEIV0,
 10480           ACCT-FILE-ID,
 10481           ACCT-KEY,
 10482           DFHEIV99,
 10483           DFHEIV11,
 10484           DFHEIV99
 10485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10486
 10487
 10488 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 192
* EL131.cbl
 10489
 10490
 10491* EXEC CICS READNEXT
 10492*         DATASET  (ACCT-FILE-ID)
 10493*         RIDFLD   (ACCT-KEY)
 10494*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10495*    END-EXEC.
 10496     MOVE 0
 10497       TO DFHEIV11
 10498*    MOVE '&.S                   )   #00009751' TO DFHEIV0
 10499     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10500     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10501     MOVE X'2020233030303039373531' TO DFHEIV0(25:11)
 10502     CALL 'kxdfhei1' USING DFHEIV0,
 10503           ACCT-FILE-ID,
 10504           DFHEIV20,
 10505           DFHEIV99,
 10506           ACCT-KEY,
 10507           DFHEIV99,
 10508           DFHEIV11,
 10509           DFHEIV99,
 10510           DFHEIV99
 10511     SET ADDRESS OF ACCOUNT-MASTER TO
 10512         DFHEIV20
 10513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10514
 10515
 10516     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10517         GO TO 1620-ACCT-NOTFND.
 10518
 10519     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10520        HOLD-EFF     LESS AM-EXPIRATION-DT
 10521         NEXT SENTENCE
 10522     ELSE
 10523         GO TO 1620-ACCT-LOOP.
 10524
 10525     set acct-found to true
 10526     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10527         GO TO 1620-ACCT-END-BROWSE.
 10528
 10529     IF LOANBALL GREATER THAN +0
 10530         IF AM-MAX-TOT-BEN NUMERIC  AND
 10531            AM-MAX-TOT-BEN GREATER THAN ZERO
 10532             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10533                 MOVE AL-UNBON     TO LOANBALA
 10534                 MOVE -1           TO LOANBALL
 10535                 MOVE 'X'          TO ERROR-SWITCH
 10536                 MOVE ER-7641      TO EMI-ERROR
 10537                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10538
 10539     IF ACVBENEL GREATER THAN +0
 10540         IF AM-MAX-MON-BEN NUMERIC  AND
 10541            AM-MAX-MON-BEN GREATER THAN ZERO
 10542             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10543                 MOVE AL-UNBON     TO ACVBENEA
 10544                 MOVE -1           TO ACVBENEL
 10545                 MOVE 'X'          TO ERROR-SWITCH
 10546                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 193
* EL131.cbl
 10547                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10548
 10549 1620-ACCT-END-BROWSE.
 10550
 10551
 10552* EXEC CICS ENDBR
 10553*         DATASET (ACCT-FILE-ID)
 10554*    END-EXEC.
 10555     MOVE 0
 10556       TO DFHEIV11
 10557*    MOVE '&2                    $   #00009792' TO DFHEIV0
 10558     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10559     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10560     MOVE X'2020233030303039373932' TO DFHEIV0(25:11)
 10561     CALL 'kxdfhei1' USING DFHEIV0,
 10562           ACCT-FILE-ID,
 10563           DFHEIV11,
 10564           DFHEIV99
 10565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10566
 10567
 10568     GO TO 1620-EXIT.
 10569
 10570 1620-ACCT-NOTFND.
 10571
 10572     MOVE -1                     TO MAINTL.
 10573     MOVE 'X'                    TO ERROR-SWITCH.
 10574     MOVE ER-0426                TO EMI-ERROR.
 10575     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10576
 10577 1620-EXIT.
 10578     EXIT.
 10579
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 194
* EL131.cbl
 10581 2000-UPDATE-CLAIM.
 10582
 10583     MOVE SPACES                 TO ERROR-SWITCH.
 10584     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10585     MOVE PI-CARRIER             TO CARRIER-CODE.
 10586     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10587     MOVE PI-CERT-NO             TO CERT-NO.
 10588
 10589     IF DELETE-CLAIM
 10590         GO TO 3000-DELETE-CLAIM.
 10591
 10592     IF  NOT MODIFY-CAP
 10593         MOVE ER-0070            TO EMI-ERROR
 10594         MOVE 'X'                TO ERROR-SWITCH
 10595         MOVE -1                 TO MAINTL
 10596         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10597         GO TO 2000-EXIT.
 10598
 10599     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10600     MOVE ZERO                   TO TRLR-SEQ-NO.
 10601
 10602
 10603* EXEC CICS READ UPDATE
 10604*         SET       (ADDRESS OF CLAIM-MASTER)
 10605*         DATASET   (CLMS-FILE-ID)
 10606*         RIDFLD    (MSTR-KEY)
 10607*    END-EXEC.
 10608*    MOVE '&"S        EU         (   #00009830' TO DFHEIV0
 10609     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10610     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10611     MOVE X'2020233030303039383330' TO DFHEIV0(25:11)
 10612     CALL 'kxdfhei1' USING DFHEIV0,
 10613           CLMS-FILE-ID,
 10614           DFHEIV20,
 10615           DFHEIV99,
 10616           MSTR-KEY,
 10617           DFHEIV99,
 10618           DFHEIV99,
 10619           DFHEIV99
 10620     SET ADDRESS OF CLAIM-MASTER TO
 10621         DFHEIV20
 10622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10623
 10624
 10625     if (incl > zeros)
 10626        and (cl-no-of-pmts-made > 0)
 10627        and (hold-incur > low-values)
 10628        and (hold-incur not = cl-incurred-dt)
 10629        if hold-incur > cl-incurred-dt
 10630           move cl-incurred-dt   to dc-bin-date-1
 10631           move hold-incur       to dc-bin-date-2
 10632        else
 10633           move hold-incur       to dc-bin-date-1
 10634           move cl-incurred-dt   to dc-bin-date-2
 10635        end-if
 10636        move '1'                 to dc-option-code
 10637        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10638        if dc-elapsed-days > +180
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 195
* EL131.cbl
 10639           MOVE ER-1663             TO EMI-ERROR
 10640           PERFORM 9900-ERROR-FORMAT
 10641                                 THRU 9900-EXIT
 10642           MOVE -1                  TO MAINTL
 10643           GO TO 8110-SEND-DATA
 10644        end-if
 10645     end-if
 10646     IF (CL-PRIORITY-CD = '8')
 10647        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10648             AND 'AMWA' AND 'KMSB')
 10649        MOVE ER-8003             TO EMI-ERROR
 10650        PERFORM 9900-ERROR-FORMAT
 10651                                 THRU 9900-EXIT
 10652        MOVE -1                  TO MAINTL
 10653        GO TO 8110-SEND-DATA
 10654     END-IF
 10655
 10656     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10657         MOVE ER-0068            TO EMI-ERROR
 10658         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10659         GO TO 2000-EXIT.
 10660
 10661     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10662         MOVE ER-0068            TO EMI-ERROR
 10663         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10664         GO TO 2000-EXIT.
 10665
 10666     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10667         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10668
 10669     IF CL-PURGED-DT NOT = LOW-VALUES
 10670         MOVE ER-7691            TO EMI-ERROR
 10671         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10672         GO TO 2000-EXIT.
 10673
 10674     IF CERT-KEY-CHANGED
 10675         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10676
 10677     IF SCREEN-ERROR
 10678         MOVE ER-0068            TO EMI-ERROR
 10679         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10680         GO TO 2000-EXIT.
 10681
 10682     IF NINETY-TRLR-UPDATED
 10683         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10684
 10685     IF MSTR-KEY-CHANGED
 10686         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10687        ELSE
 10688         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10689
 10690     IF TRLR-UPDATE-REQUIRED
 10691         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10692
 10693 2000-CHECK-CERT.
 10694     IF NOT CERT-UPDATES
 10695         GO TO 2000-EXIT.
 10696
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 196
* EL131.cbl
 10697     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10698     MOVE PI-CARRIER             TO CERT-CARRIER.
 10699     MOVE PI-GROUPING            TO CERT-GROUP.
 10700     MOVE PI-STATE               TO CERT-STATE.
 10701     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10702     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10703     MOVE PI-CERT-NO             TO CERT-CERT.
 10704
 10705     IF CERT-ALT-KEY-CHANGED
 10706         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10707     ELSE
 10708         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10709
 10710 2000-EXIT.
 10711     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 197
* EL131.cbl
 10713 2010-RELEASE-REC.
 10714
 10715* EXEC CICS UNLOCK
 10716*         DATASET  (CLMS-FILE-ID)
 10717*    END-EXEC
 10718*    MOVE '&*                    #   #00009925' TO DFHEIV0
 10719     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10720     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10721     MOVE X'2020233030303039393235' TO DFHEIV0(25:11)
 10722     CALL 'kxdfhei1' USING DFHEIV0,
 10723           CLMS-FILE-ID,
 10724           DFHEIV99
 10725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10726
 10727     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10728     MOVE 'X'                    TO ERROR-SWITCH.
 10729
 10730 2010-EXIT.
 10731     EXIT.
 10732
 10733 2020-NORMAL-UPDATE.
 10734     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10735
 10736     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10737
 10738     IF WS-OPEN-CLOSE-SW = 'Y'
 10739       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10740       IF PI-REC-FOUND-SW = 'Y'
 10741         IF CL-ACTIVITY-CODE = 09
 10742           NEXT SENTENCE
 10743         ELSE
 10744           IF WS-RESET-SW = 'Y'
 10745             IF CL-CLAIM-STATUS = 'C'
 10746               MOVE 07               TO  CL-ACTIVITY-CODE
 10747               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10748               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10749             ELSE
 10750               MOVE 08               TO  CL-ACTIVITY-CODE
 10751               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10752               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10753
 10754     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10755         MOVE 'Y'                TO CL-YESNOSW
 10756     END-IF.
 10757
 10758     if pi-company-id = 'DCC' OR 'VPP'
 10759        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10760        perform 2120-check-pdef  thru 2120-exit
 10761     end-if
 10762     if ((benperl <> zeros)
 10763        and (benperi numeric))
 10764                  or
 10765            (instypel <> zeros)
 10766        perform 2140-update-elcrtt thru 2140-exit
 10767     end-if
 10768
 10769* EXEC CICS HANDLE CONDITION
 10770*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 198
* EL131.cbl
 10771*    END-EXEC.
 10772*    MOVE '"$$                   ! , #00009970' TO DFHEIV0
 10773     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10775     MOVE X'2C20233030303039393730' TO DFHEIV0(25:11)
 10776     CALL 'kxdfhei1' USING DFHEIV0
 10777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10778
 10779
 10780
 10781* EXEC CICS REWRITE
 10782*         DATASET   (CLMS-FILE-ID)
 10783*         FROM      (CLAIM-MASTER)
 10784*    END-EXEC.
 10785     MOVE LENGTH OF
 10786      CLAIM-MASTER
 10787       TO DFHEIV11
 10788*    MOVE '&& L                  %   #00009974' TO DFHEIV0
 10789     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10790     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10791     MOVE X'2020233030303039393734' TO DFHEIV0(25:11)
 10792     CALL 'kxdfhei1' USING DFHEIV0,
 10793           CLMS-FILE-ID,
 10794           CLAIM-MASTER,
 10795           DFHEIV11,
 10796           DFHEIV99
 10797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10798
 10799
 10800 2020-EXIT.
 10801     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 199
* EL131.cbl
 10803 2030-KEY-UPDATE.
 10804     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10805
 10806
 10807* EXEC CICS DELETE
 10808*        DATASET  (CLMS-FILE-ID)
 10809*    END-EXEC.
 10810*    MOVE '&(                    &   #00009985' TO DFHEIV0
 10811     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10812     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10813     MOVE X'2020233030303039393835' TO DFHEIV0(25:11)
 10814     CALL 'kxdfhei1' USING DFHEIV0,
 10815           CLMS-FILE-ID,
 10816           DFHEIV99,
 10817           DFHEIV99,
 10818           DFHEIV99,
 10819           DFHEIV99
 10820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10821
 10822
 10823
 10824* EXEC CICS GETMAIN
 10825*         SET      (ADDRESS OF CLAIM-MASTER)
 10826*         LENGTH   (MSTR-LENGTH)
 10827*         INITIMG  (GETMAIN-SPACE)
 10828*    END-EXEC.
 10829*    MOVE ',"IL                  $   #00009989' TO DFHEIV0
 10830     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10831     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10832     MOVE X'2020233030303039393839' TO DFHEIV0(25:11)
 10833     CALL 'kxdfhei1' USING DFHEIV0,
 10834           DFHEIV20,
 10835           MSTR-LENGTH,
 10836           GETMAIN-SPACE
 10837     SET ADDRESS OF CLAIM-MASTER TO
 10838         DFHEIV20
 10839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10840
 10841
 10842     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10843
 10844     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10845
 10846     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10847
 10848     IF WS-OPEN-CLOSE-SW = 'Y'
 10849       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10850         IF PI-REC-FOUND-SW = 'Y'
 10851           IF CL-ACTIVITY-CODE = 09
 10852             NEXT SENTENCE
 10853           ELSE
 10854             IF WS-RESET-SW = 'Y'
 10855               IF CL-CLAIM-STATUS = 'C'
 10856                 MOVE 07             TO  CL-ACTIVITY-CODE
 10857                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10858                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10859               ELSE
 10860                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 200
* EL131.cbl
 10861                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10862                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10863
 10864
 10865* EXEC CICS HANDLE CONDITION
 10866*         DUPKEY    (2030-EXIT)
 10867*    END-EXEC.
 10868*    MOVE '"$$                   ! - #00010017' TO DFHEIV0
 10869     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10871     MOVE X'2D20233030303130303137' TO DFHEIV0(25:11)
 10872     CALL 'kxdfhei1' USING DFHEIV0
 10873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10874
 10875
 10876** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10877*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10878
 10879     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10880         MOVE 'Y'                TO CL-YESNOSW
 10881     END-IF.
 10882
 10883
 10884* EXEC CICS WRITE
 10885*         DATASET   (CLMS-FILE-ID)
 10886*         RIDFLD    (MSTR-KEY)
 10887*         FROM      (CLAIM-MASTER)
 10888*    END-EXEC.
 10889     MOVE LENGTH OF
 10890      CLAIM-MASTER
 10891       TO DFHEIV11
 10892*    MOVE '&$ L                  ''   #00010028' TO DFHEIV0
 10893     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10894     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10895     MOVE X'2020233030303130303238' TO DFHEIV0(25:11)
 10896     CALL 'kxdfhei1' USING DFHEIV0,
 10897           CLMS-FILE-ID,
 10898           CLAIM-MASTER,
 10899           DFHEIV11,
 10900           MSTR-KEY,
 10901           DFHEIV99,
 10902           DFHEIV99
 10903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10904
 10905
 10906 2030-EXIT.
 10907     EXIT.
 10908
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 201
* EL131.cbl
 10910 2040-NORMAL-UPDATE.
 10911
 10912* EXEC CICS READ UPDATE
 10913*         DATASET  (CERT-FILE-ID)
 10914*         RIDFLD   (CERT-KEY)
 10915*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10916*    END-EXEC.
 10917*    MOVE '&"S        EU         (   #00010039' TO DFHEIV0
 10918     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10919     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10920     MOVE X'2020233030303130303339' TO DFHEIV0(25:11)
 10921     CALL 'kxdfhei1' USING DFHEIV0,
 10922           CERT-FILE-ID,
 10923           DFHEIV20,
 10924           DFHEIV99,
 10925           CERT-KEY,
 10926           DFHEIV99,
 10927           DFHEIV99,
 10928           DFHEIV99
 10929     SET ADDRESS OF CERTIFICATE-MASTER TO
 10930         DFHEIV20
 10931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10932
 10933
 10934     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10935
 10936
 10937* EXEC CICS HANDLE CONDITION
 10938*         DUPKEY   (2040-EXIT)
 10939*    END-EXEC.
 10940*    MOVE '"$$                   ! . #00010047' TO DFHEIV0
 10941     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10942     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10943     MOVE X'2E20233030303130303437' TO DFHEIV0(25:11)
 10944     CALL 'kxdfhei1' USING DFHEIV0
 10945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10946
 10947
 10948
 10949* EXEC CICS REWRITE
 10950*         DATASET  (CERT-FILE-ID)
 10951*         FROM     (CERTIFICATE-MASTER)
 10952*    END-EXEC.
 10953     MOVE LENGTH OF
 10954      CERTIFICATE-MASTER
 10955       TO DFHEIV11
 10956*    MOVE '&& L                  %   #00010051' TO DFHEIV0
 10957     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10958     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10959     MOVE X'2020233030303130303531' TO DFHEIV0(25:11)
 10960     CALL 'kxdfhei1' USING DFHEIV0,
 10961           CERT-FILE-ID,
 10962           CERTIFICATE-MASTER,
 10963           DFHEIV11,
 10964           DFHEIV99
 10965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10966
 10967
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 202
* EL131.cbl
 10968 2040-EXIT.
 10969     EXIT.
 10970
 10971 2050-KEY-UPDATE.
 10972
 10973* EXEC CICS READ UPDATE
 10974*         DATASET  (CERT-FILE-ID)
 10975*         RIDFLD   (CERT-KEY)
 10976*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10977*    END-EXEC.
 10978*    MOVE '&"S        EU         (   #00010060' TO DFHEIV0
 10979     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10980     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10981     MOVE X'2020233030303130303630' TO DFHEIV0(25:11)
 10982     CALL 'kxdfhei1' USING DFHEIV0,
 10983           CERT-FILE-ID,
 10984           DFHEIV20,
 10985           DFHEIV99,
 10986           CERT-KEY,
 10987           DFHEIV99,
 10988           DFHEIV99,
 10989           DFHEIV99
 10990     SET ADDRESS OF CERTIFICATE-MASTER TO
 10991         DFHEIV20
 10992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10993
 10994
 10995     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10996
 10997
 10998* EXEC CICS DELETE
 10999*         DATASET   (CERT-FILE-ID)
 11000*    END-EXEC.
 11001*    MOVE '&(                    &   #00010068' TO DFHEIV0
 11002     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11003     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11004     MOVE X'2020233030303130303638' TO DFHEIV0(25:11)
 11005     CALL 'kxdfhei1' USING DFHEIV0,
 11006           CERT-FILE-ID,
 11007           DFHEIV99,
 11008           DFHEIV99,
 11009           DFHEIV99,
 11010           DFHEIV99
 11011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11012
 11013
 11014
 11015* EXEC CICS GETMAIN
 11016*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11017*         LENGTH    (CERT-LENGTH)
 11018*         INITIMG   (GETMAIN-SPACE)
 11019*    END-EXEC.
 11020*    MOVE ',"IL                  $   #00010072' TO DFHEIV0
 11021     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11022     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11023     MOVE X'2020233030303130303732' TO DFHEIV0(25:11)
 11024     CALL 'kxdfhei1' USING DFHEIV0,
 11025           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 203
* EL131.cbl
 11026           CERT-LENGTH,
 11027           GETMAIN-SPACE
 11028     SET ADDRESS OF CERTIFICATE-MASTER TO
 11029         DFHEIV20
 11030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11031
 11032
 11033     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 11034
 11035     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11036
 11037
 11038* EXEC CICS HANDLE CONDITION
 11039*         DUPKEY (2050-EXIT)
 11040*    END-EXEC.
 11041*    MOVE '"$$                   ! / #00010082' TO DFHEIV0
 11042     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11043     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11044     MOVE X'2F20233030303130303832' TO DFHEIV0(25:11)
 11045     CALL 'kxdfhei1' USING DFHEIV0
 11046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11047
 11048
 11049
 11050* EXEC CICS WRITE
 11051*         DATASET  (CERT-FILE-ID)
 11052*         RIDFLD   (CERT-KEY)
 11053*         FROM     (CERTIFICATE-MASTER)
 11054*    END-EXEC.
 11055     MOVE LENGTH OF
 11056      CERTIFICATE-MASTER
 11057       TO DFHEIV11
 11058*    MOVE '&$ L                  ''   #00010086' TO DFHEIV0
 11059     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11060     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11061     MOVE X'2020233030303130303836' TO DFHEIV0(25:11)
 11062     CALL 'kxdfhei1' USING DFHEIV0,
 11063           CERT-FILE-ID,
 11064           CERTIFICATE-MASTER,
 11065           DFHEIV11,
 11066           CERT-KEY,
 11067           DFHEIV99,
 11068           DFHEIV99
 11069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11070
 11071
 11072 2050-EXIT.
 11073     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 204
* EL131.cbl
 11075 2060-CHANGE-CERT.
 11076     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11077     MOVE PI-CARRIER             TO CERT-CARRIER.
 11078     MOVE PI-GROUPING            TO CERT-GROUP.
 11079     MOVE PI-STATE               TO CERT-STATE.
 11080     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11081     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11082     MOVE PI-CERT-NO             TO CERT-CERT.
 11083     IF CERTEFFI GREATER THAN LOW-VALUES
 11084         MOVE HOLD-EFF           TO CERT-DATE.
 11085     IF CERTACTI GREATER THAN LOW-VALUES
 11086         MOVE CERTACTI           TO CERT-ACCOUNT.
 11087     IF CERTSTI GREATER THAN LOW-VALUES
 11088         MOVE CERTSTI            TO CERT-STATE.
 11089     IF CERTCARI GREATER THAN LOW-VALUES
 11090         MOVE CERTCARI           TO CERT-CARRIER.
 11091     IF CERTGRPI GREATER THAN LOW-VALUES
 11092         MOVE CERTGRPI           TO CERT-GROUP.
 11093     IF CERTI GREATER THAN LOW-VALUES
 11094         MOVE CERTI              TO CERT-CERT-PRIME.
 11095     IF SUFXI GREATER THAN LOW-VALUES
 11096         MOVE SUFXI              TO CERT-CERT-SUFX.
 11097
 11098
 11099* EXEC CICS HANDLE CONDITION
 11100*         NOTFND   (2060-CERT-NOTFND)
 11101*    END-EXEC.
 11102*    MOVE '"$I                   ! 0 #00010118' TO DFHEIV0
 11103     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11104     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11105     MOVE X'3020233030303130313138' TO DFHEIV0(25:11)
 11106     CALL 'kxdfhei1' USING DFHEIV0
 11107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11108
 11109
 11110
 11111* EXEC CICS READ UPDATE
 11112*         DATASET  (CERT-FILE-ID)
 11113*         RIDFLD   (CERT-KEY)
 11114*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11115*    END-EXEC.
 11116*    MOVE '&"S        EU         (   #00010122' TO DFHEIV0
 11117     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11118     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11119     MOVE X'2020233030303130313232' TO DFHEIV0(25:11)
 11120     CALL 'kxdfhei1' USING DFHEIV0,
 11121           CERT-FILE-ID,
 11122           DFHEIV20,
 11123           DFHEIV99,
 11124           CERT-KEY,
 11125           DFHEIV99,
 11126           DFHEIV99,
 11127           DFHEIV99
 11128     SET ADDRESS OF CERTIFICATE-MASTER TO
 11129         DFHEIV20
 11130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11131
 11132
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 205
* EL131.cbl
 11133     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 11134
 11135     IF CM-CLAIM-INTERFACE-SW = SPACES
 11136        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11137
 11138
 11139* EXEC CICS HANDLE CONDITION
 11140*         DUPKEY   (2060-DUPKEY)
 11141*    END-EXEC.
 11142*    MOVE '"$$                   ! 1 #00010133' TO DFHEIV0
 11143     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11145     MOVE X'3120233030303130313333' TO DFHEIV0(25:11)
 11146     CALL 'kxdfhei1' USING DFHEIV0
 11147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11148
 11149
 11150
 11151* EXEC CICS REWRITE
 11152*         DATASET  (CERT-FILE-ID)
 11153*         FROM     (CERTIFICATE-MASTER)
 11154*    END-EXEC.
 11155     MOVE LENGTH OF
 11156      CERTIFICATE-MASTER
 11157       TO DFHEIV11
 11158*    MOVE '&& L                  %   #00010137' TO DFHEIV0
 11159     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11160     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11161     MOVE X'2020233030303130313337' TO DFHEIV0(25:11)
 11162     CALL 'kxdfhei1' USING DFHEIV0,
 11163           CERT-FILE-ID,
 11164           CERTIFICATE-MASTER,
 11165           DFHEIV11,
 11166           DFHEIV99
 11167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11168
 11169
 11170 2060-DUPKEY.
 11171
 11172     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11173
 11174 2060-CHANGE-TRLR-ACTQ.
 11175     IF SCREEN-ERROR
 11176         GO TO 2060-EXIT.
 11177
 11178     IF CERTI    GREATER LOW-VALUES OR
 11179        SUFXI    GREATER LOW-VALUES OR
 11180        CERTCARI GREATER LOW-VALUES
 11181         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 11182         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 11183
 11184     MOVE SPACES                 TO CERT-KEY-SWITCH
 11185                                    CERT-SWITCH
 11186                                    TRLR-SWITCH
 11187                                    NINETY-TRLR-SWITCH.
 11188     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 11189     GO TO 2060-EXIT.
 11190
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 206
* EL131.cbl
 11191 2060-CERT-NOTFND.
 11192     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11193
 11194     IF WS-REC-FOUND-SW = 'N'
 11195         MOVE ER-0206            TO  EMI-ERROR
 11196         MOVE -1                 TO  MAINTL
 11197         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11198
 11199* EXEC CICS UNLOCK
 11200*            DATASET   (CLMS-FILE-ID)
 11201*        END-EXEC
 11202*    MOVE '&*                    #   #00010170' TO DFHEIV0
 11203     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11204     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11205     MOVE X'2020233030303130313730' TO DFHEIV0(25:11)
 11206     CALL 'kxdfhei1' USING DFHEIV0,
 11207           CLMS-FILE-ID,
 11208           DFHEIV99
 11209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11210         GO TO 8110-SEND-DATA.
 11211
 11212     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 11213
 11214     GO TO 2060-CHANGE-TRLR-ACTQ.
 11215
 11216 2060-EXIT.
 11217     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 207
* EL131.cbl
 11219 2070-CHECK-OLD.
 11220
 11221
 11222* EXEC CICS HANDLE CONDITION
 11223*        NOTFND   (2070-NOT-FOUND)
 11224*    END-EXEC.
 11225*    MOVE '"$I                   ! 2 #00010184' TO DFHEIV0
 11226     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11227     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11228     MOVE X'3220233030303130313834' TO DFHEIV0(25:11)
 11229     CALL 'kxdfhei1' USING DFHEIV0
 11230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11231
 11232
 11233     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11234     MOVE PI-CARRIER             TO CERT-CARRIER.
 11235     MOVE PI-GROUPING            TO CERT-GROUP.
 11236     MOVE PI-STATE               TO CERT-STATE.
 11237     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11238     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11239     MOVE PI-CERT-NO             TO CERT-CERT.
 11240
 11241
 11242* EXEC CICS READ UPDATE
 11243*         DATASET  (CERT-FILE-ID)
 11244*         RIDFLD   (CERT-KEY)
 11245*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11246*    END-EXEC.
 11247*    MOVE '&"S        EU         (   #00010196' TO DFHEIV0
 11248     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11249     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11250     MOVE X'2020233030303130313936' TO DFHEIV0(25:11)
 11251     CALL 'kxdfhei1' USING DFHEIV0,
 11252           CERT-FILE-ID,
 11253           DFHEIV20,
 11254           DFHEIV99,
 11255           CERT-KEY,
 11256           DFHEIV99,
 11257           DFHEIV99,
 11258           DFHEIV99
 11259     SET ADDRESS OF CERTIFICATE-MASTER TO
 11260         DFHEIV20
 11261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11262
 11263
 11264     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 11265     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 11266     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 11267
 11268     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 11269         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 11270
 11271     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11272       AND
 11273        CERT-WAS-CREATED-FOR-CLAIM
 11274         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 11275
 11276* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 208
* EL131.cbl
 11277*             DATASET   (CERT-FILE-ID)
 11278*        END-EXEC
 11279*    MOVE '&(                    &   #00010213' TO DFHEIV0
 11280     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11281     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11282     MOVE X'2020233030303130323133' TO DFHEIV0(25:11)
 11283     CALL 'kxdfhei1' USING DFHEIV0,
 11284           CERT-FILE-ID,
 11285           DFHEIV99,
 11286           DFHEIV99,
 11287           DFHEIV99,
 11288           DFHEIV99
 11289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11290         GO TO 2070-EXIT.
 11291
 11292     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11293         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11294
 11295
 11296* EXEC CICS HANDLE CONDITION
 11297*         DUPKEY   (2070-EXIT)
 11298*    END-EXEC.
 11299*    MOVE '"$$                   ! 3 #00010221' TO DFHEIV0
 11300     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11301     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11302     MOVE X'3320233030303130323231' TO DFHEIV0(25:11)
 11303     CALL 'kxdfhei1' USING DFHEIV0
 11304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11305
 11306
 11307
 11308* EXEC CICS REWRITE
 11309*         DATASET  (CERT-FILE-ID)
 11310*         FROM     (CERTIFICATE-MASTER)
 11311*    END-EXEC.
 11312     MOVE LENGTH OF
 11313      CERTIFICATE-MASTER
 11314       TO DFHEIV11
 11315*    MOVE '&& L                  %   #00010225' TO DFHEIV0
 11316     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11317     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11318     MOVE X'2020233030303130323235' TO DFHEIV0(25:11)
 11319     CALL 'kxdfhei1' USING DFHEIV0,
 11320           CERT-FILE-ID,
 11321           CERTIFICATE-MASTER,
 11322           DFHEIV11,
 11323           DFHEIV99
 11324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11325
 11326
 11327     GO TO 2070-EXIT.
 11328
 11329 2070-NOT-FOUND.
 11330     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 11331
 11332 2070-EXIT.
 11333     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 209
* EL131.cbl
 11335 2080-CREATE-CERT.
 11336
 11337* EXEC CICS GETMAIN
 11338*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11339*         LENGTH    (CERT-LENGTH)
 11340*         INITIMG   (GETMAIN-SPACE)
 11341*    END-EXEC.
 11342*    MOVE ',"IL                  $   #00010239' TO DFHEIV0
 11343     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11344     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11345     MOVE X'2020233030303130323339' TO DFHEIV0(25:11)
 11346     CALL 'kxdfhei1' USING DFHEIV0,
 11347           DFHEIV20,
 11348           CERT-LENGTH,
 11349           GETMAIN-SPACE
 11350     SET ADDRESS OF CERTIFICATE-MASTER TO
 11351         DFHEIV20
 11352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11353
 11354
 11355     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 11356
 11357     IF CERTEFFI GREATER THAN LOW-VALUES
 11358         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11359                                    DC-BIN-DATE-1
 11360         MOVE '6'                TO DC-OPTION-CODE
 11361         MOVE +1                 TO DC-ELAPSED-MONTHS
 11362         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11363         IF NO-CONVERSION-ERROR
 11364             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11365
 11366     IF CERTACTI GREATER THAN LOW-VALUES
 11367         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11368     IF CERTSTI GREATER THAN LOW-VALUES
 11369         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11370     IF CERTCARI GREATER THAN LOW-VALUES
 11371         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11372     IF CERTGRPI GREATER THAN LOW-VALUES
 11373         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11374     IF CERTI GREATER THAN LOW-VALUES
 11375         MOVE CERTI              TO CERT-CERT-PRIME
 11376                                    CM-CERT-PRIME
 11377         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11378
 11379     IF SUFXI GREATER THAN LOW-VALUES
 11380         MOVE SUFXI              TO CERT-CERT-SUFX
 11381                                    CM-CERT-SFX
 11382         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11383
 11384     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11385
 11386     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11387
 11388     MOVE SPACES                 TO CM-ENTRY-BATCH
 11389                                    CM-LF-EXIT-BATCH
 11390                                    CM-AH-EXIT-BATCH
 11391                                    CM-CREDIT-INTERFACE-SW-1
 11392                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 210
* EL131.cbl
 11393
 11394     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11395                               '9' OR 'D' OR 'V'
 11396         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11397
 11398     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11399                               '9' OR 'D' OR 'V'
 11400         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11401
 11402     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11403                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11404     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11405
 11406
 11407* EXEC CICS HANDLE CONDITION
 11408*         DUPKEY (2080-EXIT)
 11409*    END-EXEC.
 11410*    MOVE '"$$                   ! 4 #00010296' TO DFHEIV0
 11411     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11412     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11413     MOVE X'3420233030303130323936' TO DFHEIV0(25:11)
 11414     CALL 'kxdfhei1' USING DFHEIV0
 11415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11416
 11417
 11418
 11419* EXEC CICS WRITE
 11420*         DATASET  (CERT-FILE-ID)
 11421*         RIDFLD   (CERT-KEY)
 11422*         FROM     (CERTIFICATE-MASTER)
 11423*    END-EXEC.
 11424     MOVE LENGTH OF
 11425      CERTIFICATE-MASTER
 11426       TO DFHEIV11
 11427*    MOVE '&$ L                  ''   #00010300' TO DFHEIV0
 11428     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11429     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11430     MOVE X'2020233030303130333030' TO DFHEIV0(25:11)
 11431     CALL 'kxdfhei1' USING DFHEIV0,
 11432           CERT-FILE-ID,
 11433           CERTIFICATE-MASTER,
 11434           DFHEIV11,
 11435           CERT-KEY,
 11436           DFHEIV99,
 11437           DFHEIV99
 11438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11439
 11440
 11441 2080-EXIT.
 11442     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 211
* EL131.cbl
 11444 2100-MOVE-MSTR.
 11445     IF TYPEI GREATER THAN LOW-VALUES
 11446         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11447
 11448     IF STATUSI = LOW-VALUES
 11449         GO TO 2100-NO-STATUS-CHANGE.
 11450
 11451     IF STATUSI = 'OPEN' OR 'O'
 11452         IF CL-CLAIM-STATUS = 'O'
 11453             MOVE SPACES         TO TRLR-SWITCH
 11454                 GO TO 2100-NO-STATUS-CHANGE.
 11455
 11456     IF STATUSI = 'CLOSED' OR 'C'
 11457         IF CL-CLAIM-STATUS = 'C'
 11458             MOVE SPACES         TO TRLR-SWITCH
 11459                 GO TO 2100-NO-STATUS-CHANGE.
 11460
 11461     IF PI-COMPANY-ID = 'DMD'
 11462        IF STATUSI = 'OPEN' OR 'O'
 11463           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11464              MOVE ZERO       TO STATUSL
 11465              MOVE LOW-VALUES TO STATUSI
 11466              GO TO 2100-NO-STATUS-CHANGE.
 11467
 11468     IF PI-COMPANY-ID = 'DMD'
 11469         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11470
 11471     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11472
 11473 2100-NO-STATUS-CHANGE.
 11474
 11475     IF CCNOI GREATER THAN LOW-VALUES
 11476         MOVE CCNOI              TO CL-CCN.
 11477
 11478     IF PROCI GREATER THAN LOW-VALUES
 11479         MOVE PROCI              TO CL-PROCESSOR-ID.
 11480
 11481     if (accswi > low-values)
 11482        and (accswi = 'Y' OR 'N')
 11483        move accswi              to cl-accident-claim-sw
 11484     end-if
 11485     if benperi > low-values
 11486        and benperi numeric
 11487        move benperi             to cl-benefit-period
 11488     end-if
 11489     if instypei > low-values
 11490        move instypei            to cl-insured-type
 11491     end-if
 11492     IF SEXI GREATER THAN LOW-VALUES
 11493         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11494
 11495     IF BIRTHI GREATER THAN LOW-VALUES
 11496         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11497
 11498     IF SOCIALI GREATER THAN LOW-VALUES
 11499       AND
 11500        SOCIALI = SPACES
 11501         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 212
* EL131.cbl
 11502         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11503         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11504     ELSE
 11505         IF SOCIALI GREATER THAN LOW-VALUES
 11506             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11507
 11508     IF OCCI GREATER THAN LOW-VALUES
 11509         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11510
 11511     IF BENEL GREATER THAN ZERO
 11512         MOVE BENEI              TO CL-BENEFICIARY.
 11513
 11514     IF DIAGI GREATER THAN LOW-VALUES
 11515         MOVE DIAGI              TO WS-DIAGNOSIS.
 11516
 11517     IF ICD1I GREATER THAN LOW-VALUES
 11518         MOVE ICD1I              TO WS-ICD-CODE-1
 11519     END-IF.
 11520
 11521     IF ICD2I GREATER THAN LOW-VALUES
 11522         MOVE ICD2I              TO WS-ICD-CODE-2
 11523     END-IF.
 11524
 11525     IF PREMTYPI GREATER THAN LOW-VALUES
 11526         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11527
 11528*    IF CAUSEI GREATER THAN LOW-VALUES
 11529*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11530
 11531*    IF ENDI GREATER THAN LOW-VALUES
 11532*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11533
 11534     IF PDTHRUI GREATER THAN LOW-VALUES
 11535        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11536
 11537     IF PDAMTL GREATER THAN +0
 11538        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11539
 11540     IF NODAYSI GREATER THAN LOW-VALUES
 11541        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11542
 11543     IF NOPMTSI GREATER THAN LOW-VALUES
 11544        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11545
 11546     IF FORMTYPI GREATER THAN LOW-VALUES
 11547        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11548
 11549     IF INCI GREATER THAN LOW-VALUES
 11550        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11551
 11552     IF REPI GREATER THAN LOW-VALUES
 11553        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11554
 11555     IF ADDONDTI GREATER THAN LOW-VALUES
 11556        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11557
 11558     IF PRICDI GREATER THAN LOW-VALUES
 11559         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 213
* EL131.cbl
 11560
 11561     IF CRITPL  > ZEROS
 11562        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11563     END-IF
 11564
 11565     IF EXTENSL  > ZEROS
 11566        MOVE EXTENSI             TO CL-NO-OF-EXTENSIONS
 11567     END-IF
 11568*    IF CRITPTL > ZEROS
 11569*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11570*    END-IF
 11571
 11572*    IF RTWMOSL > ZEROS
 11573*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11574*    END-IF
 11575     IF FILETOI GREATER THAN LOW-VALUES
 11576         MOVE FILETOI            TO CL-FILE-LOCATION.
 11577
 11578     IF SUPVI GREATER THAN LOW-VALUES
 11579         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11580
 11581     IF MLNAMEI GREATER THAN LOW-VALUES
 11582         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11583
 11584     IF MFNAMEI GREATER THAN LOW-VALUES
 11585         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11586
 11587     IF MMINITI GREATER THAN LOW-VALUES
 11588         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11589
 11590     IF CERTEFFI GREATER THAN LOW-VALUES
 11591         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11592
 11593     IF CERTACTI GREATER THAN LOW-VALUES
 11594         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11595
 11596     IF CERTSTI GREATER THAN LOW-VALUES
 11597         MOVE CERTSTI            TO CL-CERT-STATE.
 11598
 11599     IF CERTCARI GREATER THAN LOW-VALUES
 11600         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11601                                    CL-CARRIER.
 11602
 11603     IF CERTGRPI GREATER THAN LOW-VALUES
 11604         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11605
 11606     IF CERTI GREATER THAN LOW-VALUES
 11607         MOVE CERTI              TO CERT-NO-PRIME.
 11608
 11609     IF SUFXI GREATER THAN LOW-VALUES
 11610         MOVE SUFXI              TO CERT-NO-SUFX.
 11611
 11612     MOVE CERT-NO                TO CL-CERT-NO
 11613                                    CL-CERT-NO-A4.
 11614
 11615     IF PI-COMPANY-ID = 'FLA'
 11616          NEXT SENTENCE
 11617     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 214
* EL131.cbl
 11618         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11619         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11620         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 11621         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11622
 11623     IF TRLR-UPDATE-REQUIRED
 11624        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11625        MOVE ZEROS              TO TRLR-SEQ-NO
 11626
 11627* EXEC CICS READ
 11628*            DATASET   (TRLR-FILE-ID)
 11629*            RIDFLD    (TRLR-KEY)
 11630*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11631*       END-EXEC
 11632*    MOVE '&"S        E          (   #00010491' TO DFHEIV0
 11633     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11634     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11635     MOVE X'2020233030303130343931' TO DFHEIV0(25:11)
 11636     CALL 'kxdfhei1' USING DFHEIV0,
 11637           TRLR-FILE-ID,
 11638           DFHEIV20,
 11639           DFHEIV99,
 11640           TRLR-KEY,
 11641           DFHEIV99,
 11642           DFHEIV99,
 11643           DFHEIV99
 11644     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11645         DFHEIV20
 11646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11647        IF AT-TRAILER-TYPE = '1'
 11648           MOVE +1 TO MISC-SUB
 11649           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11650           MISC-SUB GREATER THAN +6 OR
 11651           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11652           IF MISC-SUB GREATER THAN +1
 11653              SUBTRACT +1 FROM MISC-SUB
 11654              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11655                 GO TO 2100-BYPASS-LAST-UPDATE.
 11656
 11657     IF TRLR-UPDATE-REQUIRED AND
 11658        CLAIM-IS-OPEN
 11659         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11660     ELSE
 11661         IF TRLR-UPDATE-REQUIRED AND
 11662            CLAIM-IS-CLOSED
 11663             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11664             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11665
 11666 2100-BYPASS-LAST-UPDATE.
 11667     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11668     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11669
 11670     GO TO 2100-EXIT.
 11671
 11672 2100-BUMP-OPEN-CLOSE-HIST.
 11673     ADD +1                      TO MISC-SUB.
 11674
 11675 2100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 215
* EL131.cbl
 11676     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 216
* EL131.cbl
 11678 2120-check-pdef.
 11679     move +0                     to s1
 11680     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11681     move spaces                 to ws-dcc-error-line
 11682     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11683     IF ERPDEF-FOUND
 11684        perform 2130-check-trlr  thru 2130-exit
 11685        move +1                  to s1
 11686*       if cl-accident-claim-sw = ' '
 11687*          move er-1655             to ws-error-no (s1)
 11688*          add +1 to s1
 11689*       end-if
 11690        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11691        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11692        if (hold-incur > low-values)
 11693           and (incl > zeros)
 11694           and (hold-incur not = cl-incurred-dt)
 11695           move hold-incur       to dc-bin-date-2
 11696        end-if
 11697        MOVE '1'                 TO DC-OPTION-CODE
 11698        MOVE +0                  TO DC-ELAPSED-MONTHS
 11699                                    DC-ELAPSED-DAYS
 11700        PERFORM 9800-CONVERT-DATE
 11701                                 THRU 9800-EXIT
 11702        IF NO-CONVERSION-ERROR
 11703           MOVE DC-ELAPSED-MONTHS
 11704                                 TO WS-MONTHS-BETWEEN
 11705           IF DC-ELAPSED-DAYS > 1
 11706              ADD 1 TO WS-MONTHS-BETWEEN
 11707           END-IF
 11708        ELSE
 11709           display ' dte conv error ' dc-error-code
 11710           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11711        END-IF
 11712        IF (WS-EXCL-PERIOD = ZEROS)
 11713           OR (WS-MONTHS-BETWEEN = ZEROS)
 11714           CONTINUE
 11715        ELSE
 11716           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11717              MOVE ER-1651       TO ws-error-no (s1)
 11718              add +1             to s1
 11719           END-IF
 11720        END-IF
 11721        IF (WS-COV-ENDS = ZEROS)
 11722           OR (WS-MONTHS-BETWEEN = ZEROS)
 11723           CONTINUE
 11724        ELSE
 11725           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11726              MOVE -1            TO MAINTL
 11727              MOVE ER-1653       TO ws-error-no (s1)
 11728              add +1 to s1
 11729           END-IF
 11730        END-IF
 11731        IF (WS-ACC-PERIOD = ZEROS)
 11732           OR (WS-MONTHS-BETWEEN = ZEROS)
 11733           CONTINUE
 11734        ELSE
 11735           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 217
* EL131.cbl
 11736              and (accswi = spaces or low-values)
 11737*             and (cl-accident-claim-sw = ' ')
 11738              move er-1655       to ws-error-no (s1)
 11739              add +1             to s1
 11740           end-if
 11741           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11742*             if (cl-accident-claim-sw not = 'Y')
 11743              if (accswi not = 'Y')
 11744                 MOVE ER-1652    TO ws-error-no (s1)
 11745              else
 11746                 move er-1662    to ws-error-no (s1)
 11747              end-if
 11748              MOVE -1            TO MAINTL
 11749              add +1             to s1
 11750           END-IF
 11751        END-IF
 11752        if cl-claim-type  = 'I'
 11753           move er-1661          to ws-error-no (s1)
 11754           add +1                to s1
 11755        end-if
 11756        perform 2130-check-trlr  thru 2130-exit
 11757     END-IF
 11758
 11759     .
 11760 2120-exit.
 11761     exit.
 11762
 11763 2130-check-trlr.
 11764
 11765     evaluate true
 11766        when s1 = +0
 11767           move cl-control-primary
 11768                                 to trlr-key
 11769           MOVE +95              TO TRLR-SEQ-NO
 11770
 11771* EXEC CICS READ
 11772*             update
 11773*             DATASET  ('ELTRLR')
 11774*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11775*             RIDFLD   (TRLR-KEY)
 11776*             RESP     (WS-RESPONSE)
 11777*          END-EXEC
 11778     MOVE 'ELTRLR' TO DFHEIV1
 11779*    MOVE '&"S        EU         (  N#00010619' TO DFHEIV0
 11780     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11781     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11782     MOVE X'204E233030303130363139' TO DFHEIV0(25:11)
 11783     CALL 'kxdfhei1' USING DFHEIV0,
 11784           DFHEIV1,
 11785           DFHEIV20,
 11786           DFHEIV99,
 11787           TRLR-KEY,
 11788           DFHEIV99,
 11789           DFHEIV99,
 11790           DFHEIV99
 11791     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11792         DFHEIV20
 11793     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 218
* EL131.cbl
 11794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11795           if ws-resp-normal
 11796              move spaces        to at-info-line-1
 11797           end-if
 11798        when s1 = +1
 11799           if ws-resp-normal
 11800
 11801* exec cics rewrite
 11802*                dataset   ('ELTRLR')
 11803*                from      (activity-trailers)
 11804*             end-exec
 11805     MOVE LENGTH OF
 11806      activity-trailers
 11807       TO DFHEIV11
 11808     MOVE 'ELTRLR' TO DFHEIV1
 11809*    MOVE '&& L                  %   #00010631' TO DFHEIV0
 11810     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11811     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11812     MOVE X'2020233030303130363331' TO DFHEIV0(25:11)
 11813     CALL 'kxdfhei1' USING DFHEIV0,
 11814           DFHEIV1,
 11815           activity-trailers,
 11816           DFHEIV11,
 11817           DFHEIV99
 11818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11819           end-if
 11820        when s1 > +1
 11821           if ws-resp-normal
 11822              move ws-dcc-error-line
 11823                                 to at-info-line-1
 11824
 11825* exec cics rewrite
 11826*                dataset   ('ELTRLR')
 11827*                from      (activity-trailers)
 11828*             end-exec
 11829     MOVE LENGTH OF
 11830      activity-trailers
 11831       TO DFHEIV11
 11832     MOVE 'ELTRLR' TO DFHEIV1
 11833*    MOVE '&& L                  %   #00010640' TO DFHEIV0
 11834     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11835     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11836     MOVE X'2020233030303130363430' TO DFHEIV0(25:11)
 11837     CALL 'kxdfhei1' USING DFHEIV0,
 11838           DFHEIV1,
 11839           activity-trailers,
 11840           DFHEIV11,
 11841           DFHEIV99
 11842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11843           else
 11844
 11845* EXEC CICS GETMAIN
 11846*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11847*                LENGTH   (TRLR-LENGTH)
 11848*                INITIMG  (GETMAIN-SPACE)
 11849*             END-EXEC
 11850*    MOVE ',"IL                  $   #00010645' TO DFHEIV0
 11851     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 219
* EL131.cbl
 11852     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11853     MOVE X'2020233030303130363435' TO DFHEIV0(25:11)
 11854     CALL 'kxdfhei1' USING DFHEIV0,
 11855           DFHEIV20,
 11856           TRLR-LENGTH,
 11857           GETMAIN-SPACE
 11858     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11859         DFHEIV20
 11860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11861              move 'AT'          to at-record-id
 11862              move cl-control-primary
 11863                                 to at-control-primary
 11864              move +95           to at-sequence-no
 11865              move '6'           to at-trailer-type
 11866              move ws-dcc-error-line
 11867                                 to at-info-line-1
 11868              move 'E'           to at-info-trailer-type
 11869              move save-bin-date to at-recorded-dt
 11870                                    at-gen-info-last-maint-dt
 11871              move pi-processor-id
 11872                                 to at-recorded-by
 11873                                    at-gen-info-last-updated-by
 11874              move eibtime       to at-last-maint-hhmmss
 11875
 11876* exec cics write
 11877*                dataset   ('ELTRLR')
 11878*                from      (activity-trailers)
 11879*                ridfld    (trlr-key)
 11880*             end-exec
 11881     MOVE LENGTH OF
 11882      activity-trailers
 11883       TO DFHEIV11
 11884     MOVE 'ELTRLR' TO DFHEIV1
 11885*    MOVE '&$ L                  ''   #00010664' TO DFHEIV0
 11886     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11887     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11888     MOVE X'2020233030303130363634' TO DFHEIV0(25:11)
 11889     CALL 'kxdfhei1' USING DFHEIV0,
 11890           DFHEIV1,
 11891           activity-trailers,
 11892           DFHEIV11,
 11893           trlr-key,
 11894           DFHEIV99,
 11895           DFHEIV99
 11896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11897              perform varying s1 from +1 by +1 until
 11898                 ws-error-no (s1) = spaces
 11899                 move ws-error-no (s1)
 11900                                 to emi-error
 11901                 PERFORM 9900-ERROR-FORMAT
 11902                                 THRU 9900-EXIT
 11903              end-perform
 11904           end-if
 11905     end-evaluate
 11906
 11907     .
 11908 2130-exit.
 11909     exit.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 220
* EL131.cbl
 11910 2140-update-elcrtt.
 11911     move ' '                    to crtt-switch
 11912     MOVE CERT-KEY               TO ELCRTT-KEY
 11913     MOVE 'B'                    TO CTRLR-REC-TYPE
 11914
 11915* EXEC CICS READ
 11916*       UPDATE
 11917*       DATASET   ('ELCRTT')
 11918*       RIDFLD    (ELCRTT-KEY)
 11919*       INTO      (CERTIFICATE-TRAILERS)
 11920*       RESP      (WS-RESPONSE)
 11921*    END-EXEC
 11922     MOVE LENGTH OF
 11923      CERTIFICATE-TRAILERS
 11924       TO DFHEIV11
 11925     MOVE 'ELCRTT' TO DFHEIV1
 11926*    MOVE '&"IL       EU         (  N#00010686' TO DFHEIV0
 11927     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11928     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11929     MOVE X'204E233030303130363836' TO DFHEIV0(25:11)
 11930     CALL 'kxdfhei1' USING DFHEIV0,
 11931           DFHEIV1,
 11932           CERTIFICATE-TRAILERS,
 11933           DFHEIV11,
 11934           ELCRTT-KEY,
 11935           DFHEIV99,
 11936           DFHEIV99,
 11937           DFHEIV99
 11938     MOVE EIBRESP  TO WS-RESPONSE
 11939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11940     IF WS-RESP-NORMAL
 11941        perform varying s1 from +1 by +1 until
 11942           (s1 > +24)
 11943           or (cs-claim-no (s1) = cl-claim-no)
 11944        end-perform
 11945        if (s1 < +25)
 11946           if (benperl <> zeros)
 11947              and (cs-benefit-period (s1) not = benperi)
 11948              move benperi       to cs-benefit-period (s1)
 11949              set crtt-update    to true
 11950          end-if
 11951          if (instypel <> zeros)
 11952             and (instypei not = cs-insured-type (s1))
 11953             move instypei      to cs-insured-type (s1)
 11954             set crtt-update    to true
 11955          end-if
 11956          move cs-claim-type (s1) to ws-claim-type
 11957          move cs-benefit-period (s1) to ws-ben-per
 11958        end-if
 11959        if crtt-update
 11960           perform 2150-accum    thru 2150-exit
 11961
 11962* EXEC CICS REWRITE
 11963*             DATASET   ('ELCRTT')
 11964*             FROM      (CERTIFICATE-TRAILERS)
 11965*          END-EXEC
 11966     MOVE LENGTH OF
 11967      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 221
* EL131.cbl
 11968       TO DFHEIV11
 11969     MOVE 'ELCRTT' TO DFHEIV1
 11970*    MOVE '&& L                  %   #00010714' TO DFHEIV0
 11971     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11972     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11973     MOVE X'2020233030303130373134' TO DFHEIV0(25:11)
 11974     CALL 'kxdfhei1' USING DFHEIV0,
 11975           DFHEIV1,
 11976           CERTIFICATE-TRAILERS,
 11977           DFHEIV11,
 11978           DFHEIV99
 11979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11980        else
 11981
 11982* exec cics unlock
 11983*             dataset   ('ELCRTT')
 11984*          end-exec
 11985     MOVE 'ELCRTT' TO DFHEIV1
 11986*    MOVE '&*                    #   #00010719' TO DFHEIV0
 11987     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11988     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11989     MOVE X'2020233030303130373139' TO DFHEIV0(25:11)
 11990     CALL 'kxdfhei1' USING DFHEIV0,
 11991           DFHEIV1,
 11992           DFHEIV99
 11993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11994        end-if
 11995     end-if
 11996     .
 11997 2140-exit.
 11998     exit.
 11999 2150-accum.
 12000     if not erpdef-found
 12001        perform 3997-get-erpdef  thru 3997-exit
 12002     end-if
 12003     if (erpdef-found)
 12004        and (ws-max-moben not = zeros)
 12005        and (ws-max-moben < cm-ah-benefit-amt)
 12006        continue
 12007     else
 12008        move cm-ah-benefit-amt   to ws-max-moben
 12009     end-if
 12010     move cm-ah-orig-term        to ws-max-bens
 12011     if cl-critical-period not = zeros and spaces
 12012        move cl-critical-period  to ws-max-bens
 12013     end-if
 12014     move zeros to ws-tot-days-paid ws-tot-amt-paid
 12015     perform varying s2 from +1 by +1 until
 12016        (s2 > +24)
 12017        or (cs-claim-no (s2) = spaces)
 12018        if (cs-benefit-period (s2) = ws-ben-per)
 12019           and (cs-claim-type (s2) = ws-claim-type)
 12020           and (cs-insured-type (s2) = cl-insured-type)
 12021*          compute ws-tot-days-paid =
 12022*             ws-tot-days-paid + cs-days-paid (s2)
 12023           compute ws-tot-amt-paid =
 12024              ws-tot-amt-paid + cs-total-paid (s2)
 12025        end-if
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 222
* EL131.cbl
 12026     end-perform
 12027     if s2 < +25
 12028        compute ws-pd-bens rounded =
 12029           ws-tot-amt-paid / ws-max-moben
 12030        compute cs-remaining-bens (s1) =
 12031           ws-max-bens - ws-pd-bens
 12032        if cs-remaining-bens (s1) < zeros
 12033           move zeros            to cs-remaining-bens (s1)
 12034        end-if
 12035     end-if
 12036     .
 12037 2150-exit.
 12038     exit.
 12039 2200-MOVE-CERT.
 12040     IF CRTLNMEI GREATER THAN LOW-VALUES
 12041         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 12042
 12043     IF CRTFNMEI GREATER THAN LOW-VALUES
 12044         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 12045         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 12046
 12047     IF CRTINITI GREATER THAN LOW-VALUES
 12048         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 12049
 12050     IF CM-INSURED-INITIALS = SPACES
 12051         MOVE '**'               TO CM-INSURED-INITIALS.
 12052
 12053     IF ISSAGEI GREATER THAN LOW-VALUES
 12054         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 12055
 12056     IF JNTFNMEI GREATER THAN LOW-VALUES
 12057         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 12058
 12059     IF JNTLNMEI GREATER THAN LOW-VALUES
 12060         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 12061
 12062     IF JNTINITI GREATER THAN LOW-VALUES
 12063         MOVE JNTINITI           TO CM-JT-INITIAL.
 12064
 12065     IF JNTAGEI GREATER THAN LOW-VALUES
 12066         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 12067
 12068     IF ADDONDTI GREATER THAN LOW-VALUES
 12069        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 12070
 12071     IF LCVCDI GREATER THAN LOW-VALUES
 12072        IF LCVCDI = SPACES OR ZEROS
 12073           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 12074        ELSE
 12075           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 12076
 12077     IF LCVOTRMI GREATER THAN LOW-VALUES
 12078         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 12079
 12080     IF LCVRATEL GREATER THAN +0
 12081         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 12082
 12083     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 223
* EL131.cbl
 12084         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 12085
 12086     IF LCVFORMI GREATER THAN LOW-VALUES
 12087         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 12088
 12089     IF LCVCNDTI = LOW-VALUES
 12090        GO TO 2210-SET-STATUS.
 12091
 12092     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 12093        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 12094        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 12095        GO TO 2210-SET-STATUS.
 12096
 12097     IF CM-LF-CURRENT-STATUS = '7'
 12098        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 12099        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 12100        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12101                                    CM-LF-DEATH-DT
 12102        GO TO 2210-SET-STATUS.
 12103
 12104     IF CM-LF-CURRENT-STATUS = '8'
 12105        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 12106        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12107                                    CM-LF-CANCEL-DT.
 12108
 12109 2210-SET-STATUS.
 12110
 12111     IF CM-LF-CURRENT-STATUS = SPACES
 12112         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 12113
 12114     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 12115         MOVE '6'                TO DC-OPTION-CODE
 12116         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12117         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12118         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12119         IF NO-CONVERSION-ERROR
 12120             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 12121         ELSE
 12122             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 12123     ELSE
 12124         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 12125
 12126 2215-PROCESS-AH-SIDE.
 12127
 12128     IF ACVCDI GREATER THAN LOW-VALUES
 12129        IF ACVCDI = SPACES OR ZEROS
 12130           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 12131        ELSE
 12132           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 12133
 12134     IF ACVOTRMI GREATER THAN LOW-VALUES
 12135         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 12136
 12137     IF ACVRATEL GREATER THAN +0
 12138         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 12139
 12140     IF ACVBENEL GREATER THAN +0
 12141         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 224
* EL131.cbl
 12142                                    PI-PAYMENT-AMT.
 12143
 12144     IF ACVFORMI GREATER THAN LOW-VALUES
 12145         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 12146
 12147     IF ACVCNDTI = LOW-VALUES
 12148        GO TO 2220-SET-STATUS.
 12149
 12150     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 12151        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 12152        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 12153        GO TO 2220-SET-STATUS.
 12154
 12155     IF CM-AH-CURRENT-STATUS = '6'
 12156        MOVE CM-AH-STATUS-AT-SETTLEMENT
 12157                                 TO CM-AH-CURRENT-STATUS
 12158        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 12159        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12160                                    CM-AH-SETTLEMENT-DT
 12161        GO TO 2220-SET-STATUS.
 12162
 12163     IF CM-AH-CURRENT-STATUS = '8'
 12164        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 12165        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12166                                    CM-AH-CANCEL-DT.
 12167
 12168 2220-SET-STATUS.
 12169     IF CM-AH-CURRENT-STATUS = SPACES
 12170         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 12171
 12172     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 12173         MOVE '6'                TO DC-OPTION-CODE
 12174         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12175         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12176         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12177         IF NO-CONVERSION-ERROR
 12178             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 12179         ELSE
 12180             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 12181     ELSE
 12182         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 12183
 12184 2225-FINISH-CERT.
 12185     IF APRL GREATER THAN +0
 12186         MOVE HOLD-APR           TO CM-LOAN-APR.
 12187
 12188     IF PMTFREQI GREATER THAN LOW-VALUES
 12189         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 12190
 12191     IF INDGRPI GREATER THAN LOW-VALUES
 12192         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 12193
 12194*    IF LOANNOI GREATER THAN LOW-VALUES
 12195*       MOVE LOANNOI             TO CM-LOAN-NUMBER.
 12196
 12197     IF LOANBALL GREATER THAN +0
 12198        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 12199
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 225
* EL131.cbl
 12200     IF PREMTYPI GREATER THAN LOW-VALUES
 12201         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 12202
 12203     IF REINCDI GREATER THAN LOW-VALUES
 12204         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 12205                                    WS-REIN-1
 12206                                    WS-REIN-2
 12207                                    WS-REIN-3
 12208         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 12209
 12210     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 12211
 12212     MOVE ZEROS                  TO CM-LOAN-TERM
 12213                                    CM-LIFE-COMM-PCT
 12214                                    CM-AH-COMM-PCT.
 12215
 12216*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 12217*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 12218*         PI-NO-PMTS = ZEROS
 12219*          IF LOANBALL GREATER THAN +0          OR
 12220*             ACVBENEL GREATER THAN +0          OR
 12221*             APRL     GREATER THAN +0          OR
 12222*             LCVRATEL GREATER THAN +0          OR
 12223*             ACVRATEL GREATER THAN +0
 12224*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 12225
 12226 2200-EXIT.
 12227     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 226
* EL131.cbl
 12229 2300-UPDATE-TRLR.
 12230     MOVE ZERO                   TO TRLR-SEQ-NO.
 12231
 12232* EXEC CICS READ UPDATE
 12233*         DATASET  (TRLR-FILE-ID)
 12234*         RIDFLD   (TRLR-KEY)
 12235*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12236*    END-EXEC.
 12237*    MOVE '&"S        EU         (   #00010959' TO DFHEIV0
 12238     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12239     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12240     MOVE X'2020233030303130393539' TO DFHEIV0(25:11)
 12241     CALL 'kxdfhei1' USING DFHEIV0,
 12242           TRLR-FILE-ID,
 12243           DFHEIV20,
 12244           DFHEIV99,
 12245           TRLR-KEY,
 12246           DFHEIV99,
 12247           DFHEIV99,
 12248           DFHEIV99
 12249     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12250         DFHEIV20
 12251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12252
 12253
 12254     MOVE ZERO                   TO COUNT-2.
 12255
 12256     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12257         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12258
 12259     IF NOT UPDATE-MADE
 12260         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12261
 12262
 12263* EXEC CICS REWRITE
 12264*         DATASET  (TRLR-FILE-ID)
 12265*         FROM     (ACTIVITY-TRAILERS)
 12266*    END-EXEC.
 12267     MOVE LENGTH OF
 12268      ACTIVITY-TRAILERS
 12269       TO DFHEIV11
 12270*    MOVE '&& L                  %   #00010973' TO DFHEIV0
 12271     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12272     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12273     MOVE X'2020233030303130393733' TO DFHEIV0(25:11)
 12274     CALL 'kxdfhei1' USING DFHEIV0,
 12275           TRLR-FILE-ID,
 12276           ACTIVITY-TRAILERS,
 12277           DFHEIV11,
 12278           DFHEIV99
 12279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12280
 12281
 12282 2300-EXIT.
 12283     EXIT.
 12284
 12285 2310-INS-STATUS.
 12286     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 227
* EL131.cbl
 12287     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 12288         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 12289         MOVE 'Y'                TO TRLR-SWITCH.
 12290
 12291 2310-EXIT.
 12292     EXIT.
 12293
 12294 2320-SHIFT-STATUS.
 12295     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 12296        MOVE 6                   TO COUNT-2
 12297        GO TO 2320-EXIT.
 12298
 12299     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 12300     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 12301     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 12302     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 12303     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 12304     MOVE 6       TO COUNT-2.
 12305     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 12306
 12307 2320-EXIT.
 12308     EXIT.
 12309
 12310 2330-ADD-UPDATE.
 12311
 12312     IF COUNT-2 GREATER THAN 1
 12313        COMPUTE MISC-SUB = (COUNT-2 - 1)
 12314        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 12315           GO TO 2330-EXIT.
 12316
 12317     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 12318                                   AT-RESERVES-LAST-MAINT-DT
 12319
 12320     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 12321     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 12322     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 12323     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 12324
 12325 2330-EXIT.
 12326     EXIT.
 12327
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 228
* EL131.cbl
 12329 2400-UPDATE-TRLR.
 12330
 12331* EXEC CICS HANDLE CONDITION
 12332*         NOTFND    (2400-TRLR-NOTFND)
 12333*         ENDFILE   (2410-EXIT)
 12334*    END-EXEC.
 12335*    MOVE '"$I''                  ! 5 #00011026' TO DFHEIV0
 12336     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12337     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12338     MOVE X'3520233030303131303236' TO DFHEIV0(25:11)
 12339     CALL 'kxdfhei1' USING DFHEIV0
 12340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12341
 12342
 12343
 12344* EXEC CICS STARTBR
 12345*        DATASET (TRLR-FILE-ID)
 12346*        RIDFLD  (TRLR-KEY)
 12347*    END-EXEC.
 12348     MOVE 0
 12349       TO DFHEIV11
 12350*    MOVE '&,         G          &   #00011031' TO DFHEIV0
 12351     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12352     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12353     MOVE X'2020233030303131303331' TO DFHEIV0(25:11)
 12354     CALL 'kxdfhei1' USING DFHEIV0,
 12355           TRLR-FILE-ID,
 12356           TRLR-KEY,
 12357           DFHEIV99,
 12358           DFHEIV11,
 12359           DFHEIV99
 12360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12361
 12362
 12363
 12364* EXEC CICS GETMAIN
 12365*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12366*         LENGTH    (TRLR-LENGTH)
 12367*         INITIMG   (GETMAIN-SPACE)
 12368*    END-EXEC.
 12369*    MOVE ',"IL                  $   #00011036' TO DFHEIV0
 12370     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12371     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12372     MOVE X'2020233030303131303336' TO DFHEIV0(25:11)
 12373     CALL 'kxdfhei1' USING DFHEIV0,
 12374           DFHEIV20,
 12375           TRLR-LENGTH,
 12376           GETMAIN-SPACE
 12377     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12378         DFHEIV20
 12379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12380
 12381
 12382     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12383
 12384
 12385* EXEC CICS ENDBR
 12386*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 229
* EL131.cbl
 12387*    END-EXEC.
 12388     MOVE 0
 12389       TO DFHEIV11
 12390*    MOVE '&2                    $   #00011044' TO DFHEIV0
 12391     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12392     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12393     MOVE X'2020233030303131303434' TO DFHEIV0(25:11)
 12394     CALL 'kxdfhei1' USING DFHEIV0,
 12395           TRLR-FILE-ID,
 12396           DFHEIV11,
 12397           DFHEIV99
 12398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12399
 12400
 12401     GO TO 2400-EXIT.
 12402
 12403 2400-TRLR-NOTFND.
 12404     MOVE ER-0205                TO EMI-ERROR.
 12405     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12406     MOVE 'X'                    TO ERROR-SWITCH.
 12407
 12408 2400-EXIT.
 12409     EXIT.
 12410
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 230
* EL131.cbl
 12412 2410-CHANGE-TRLR.
 12413
 12414* EXEC CICS READNEXT
 12415*        DATASET (TRLR-FILE-ID)
 12416*        RIDFLD  (TRLR-KEY)
 12417*        INTO    (ACTIVITY-TRAILERS)
 12418*    END-EXEC.
 12419     MOVE LENGTH OF
 12420      ACTIVITY-TRAILERS
 12421       TO DFHEIV12
 12422     MOVE 0
 12423       TO DFHEIV11
 12424*    MOVE '&.IL                  )   #00011060' TO DFHEIV0
 12425     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12426     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12427     MOVE X'2020233030303131303630' TO DFHEIV0(25:11)
 12428     CALL 'kxdfhei1' USING DFHEIV0,
 12429           TRLR-FILE-ID,
 12430           ACTIVITY-TRAILERS,
 12431           DFHEIV12,
 12432           TRLR-KEY,
 12433           DFHEIV99,
 12434           DFHEIV11,
 12435           DFHEIV99,
 12436           DFHEIV99
 12437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12438
 12439
 12440     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12441        GO TO 2410-CHANGE-TRLR.
 12442
 12443     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12444                                    CHECK-KEY.
 12445
 12446     IF CHECK-KEY NOT = MSTR-KEY
 12447         GO TO 2410-EXIT.
 12448
 12449
 12450* EXEC CICS ENDBR
 12451*        DATASET (TRLR-FILE-ID)
 12452*    END-EXEC.
 12453     MOVE 0
 12454       TO DFHEIV11
 12455*    MOVE '&2                    $   #00011075' TO DFHEIV0
 12456     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12457     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12458     MOVE X'2020233030303131303735' TO DFHEIV0(25:11)
 12459     CALL 'kxdfhei1' USING DFHEIV0,
 12460           TRLR-FILE-ID,
 12461           DFHEIV11,
 12462           DFHEIV99
 12463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12464
 12465
 12466
 12467* EXEC CICS READ UPDATE
 12468*        DATASET (TRLR-FILE-ID)
 12469*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 231
* EL131.cbl
 12470*        INTO    (ACTIVITY-TRAILERS)
 12471*    END-EXEC.
 12472     MOVE LENGTH OF
 12473      ACTIVITY-TRAILERS
 12474       TO DFHEIV11
 12475*    MOVE '&"IL       EU         (   #00011079' TO DFHEIV0
 12476     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12477     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12478     MOVE X'2020233030303131303739' TO DFHEIV0(25:11)
 12479     CALL 'kxdfhei1' USING DFHEIV0,
 12480           TRLR-FILE-ID,
 12481           ACTIVITY-TRAILERS,
 12482           DFHEIV11,
 12483           TRLR-KEY,
 12484           DFHEIV99,
 12485           DFHEIV99,
 12486           DFHEIV99
 12487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12488
 12489
 12490
 12491* EXEC CICS DELETE
 12492*        DATASET (TRLR-FILE-ID)
 12493*    END-EXEC.
 12494*    MOVE '&(                    &   #00011085' TO DFHEIV0
 12495     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12496     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12497     MOVE X'2020233030303131303835' TO DFHEIV0(25:11)
 12498     CALL 'kxdfhei1' USING DFHEIV0,
 12499           TRLR-FILE-ID,
 12500           DFHEIV99,
 12501           DFHEIV99,
 12502           DFHEIV99,
 12503           DFHEIV99
 12504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12505
 12506
 12507     IF AT-SEQUENCE-NO = ZERO AND
 12508        TRLR-UPDATE-REQUIRED
 12509         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12510
 12511     IF CERTI GREATER THAN LOW-VALUES
 12512        MOVE CERTI               TO AT-CERT-PRIME.
 12513
 12514     IF SUFXI GREATER THAN LOW-VALUES
 12515        MOVE SUFXI               TO AT-CERT-SFX.
 12516
 12517     IF CERTCARI GREATER THAN LOW-VALUES
 12518        MOVE CERTCARI            TO AT-CARRIER.
 12519
 12520     IF PAYMENT-TR
 12521        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12522           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12523              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12524
 12525     IF CORRESPONDENCE-TR
 12526        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12527           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 232
* EL131.cbl
 12528
 12529
 12530* EXEC CICS WRITE
 12531*         DATASET  (TRLR-FILE-ID)
 12532*         RIDFLD   (AT-CONTROL-PRIMARY)
 12533*         FROM     (ACTIVITY-TRAILERS)
 12534*    END-EXEC.
 12535     MOVE LENGTH OF
 12536      ACTIVITY-TRAILERS
 12537       TO DFHEIV11
 12538*    MOVE '&$ L                  ''   #00011111' TO DFHEIV0
 12539     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12540     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12541     MOVE X'2020233030303131313131' TO DFHEIV0(25:11)
 12542     CALL 'kxdfhei1' USING DFHEIV0,
 12543           TRLR-FILE-ID,
 12544           ACTIVITY-TRAILERS,
 12545           DFHEIV11,
 12546           AT-CONTROL-PRIMARY,
 12547           DFHEIV99,
 12548           DFHEIV99
 12549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12550
 12551
 12552
 12553* EXEC CICS STARTBR
 12554*         DATASET  (TRLR-FILE-ID)
 12555*         RIDFLD   (TRLR-KEY)
 12556*    END-EXEC.
 12557     MOVE 0
 12558       TO DFHEIV11
 12559*    MOVE '&,         G          &   #00011117' TO DFHEIV0
 12560     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12561     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12562     MOVE X'2020233030303131313137' TO DFHEIV0(25:11)
 12563     CALL 'kxdfhei1' USING DFHEIV0,
 12564           TRLR-FILE-ID,
 12565           TRLR-KEY,
 12566           DFHEIV99,
 12567           DFHEIV11,
 12568           DFHEIV99
 12569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12570
 12571
 12572     GO TO 2410-CHANGE-TRLR.
 12573
 12574 2410-EXIT.
 12575     EXIT.
 12576
 12577 2420-UPDATE-TRLR.
 12578     MOVE ZERO TO COUNT-2.
 12579     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12580         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12581
 12582     IF NOT UPDATE-MADE
 12583         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12584
 12585 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 233
* EL131.cbl
 12586     EXIT.
 12587
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 234
* EL131.cbl
 12589 2425-UPDATE-NINETY-TRLR.
 12590
 12591     MOVE +90                    TO TRLR-SEQ-NO.
 12592
 12593
 12594* EXEC CICS HANDLE CONDITION
 12595*         NOTFND    (2425-NINETY-NOTFND)
 12596*         ENDFILE   (2425-NINETY-NOTFND)
 12597*    END-EXEC.
 12598*    MOVE '"$I''                  ! 6 #00011143' TO DFHEIV0
 12599     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12600     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12601     MOVE X'3620233030303131313433' TO DFHEIV0(25:11)
 12602     CALL 'kxdfhei1' USING DFHEIV0
 12603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12604
 12605
 12606
 12607* EXEC CICS READ UPDATE
 12608*        DATASET (TRLR-FILE-ID)
 12609*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12610*        RIDFLD  (TRLR-KEY)
 12611*    END-EXEC.
 12612*    MOVE '&"S        EU         (   #00011148' TO DFHEIV0
 12613     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12614     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12615     MOVE X'2020233030303131313438' TO DFHEIV0(25:11)
 12616     CALL 'kxdfhei1' USING DFHEIV0,
 12617           TRLR-FILE-ID,
 12618           DFHEIV20,
 12619           DFHEIV99,
 12620           TRLR-KEY,
 12621           DFHEIV99,
 12622           DFHEIV99,
 12623           DFHEIV99
 12624     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12625         DFHEIV20
 12626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12627
 12628     if (diagi > low-values)
 12629        and (diagi not = at-info-line-1)
 12630        and (cl-total-paid-amt > zeros)
 12631        move cl-cert-eff-dt      to dc-bin-date-1
 12632        move cl-paid-thru-dt     to dc-bin-date-2
 12633        move '1'                 to dc-option-code
 12634        perform 9800-convert-date
 12635                                 thru 9800-exit
 12636        if no-conversion-error
 12637           and dc-elapsed-months < +24
 12638           and (not emi-bypass-forcables)
 12639           move er-1581          to emi-error
 12640           perform 9900-error-format
 12641                                thru 9900-exit
 12642           move -1              to diagl
 12643           go to 8110-send-data
 12644        end-if
 12645     end-if
 12646     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 235
* EL131.cbl
 12647     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12648     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12649
 12650     IF DIAGI GREATER THAN LOW-VALUES
 12651         MOVE DIAGI             TO AT-INFO-LINE-1
 12652     END-IF.
 12653
 12654     IF ICD1I GREATER THAN LOW-VALUES
 12655         MOVE ICD1I             TO AT-ICD-CODE-1
 12656     END-IF.
 12657
 12658     IF ICD2I GREATER THAN LOW-VALUES
 12659         MOVE ICD2I             TO AT-ICD-CODE-2
 12660     END-IF.
 12661
 12662
 12663* EXEC CICS REWRITE
 12664*        DATASET (TRLR-FILE-ID)
 12665*        FROM    (ACTIVITY-TRAILERS)
 12666*    END-EXEC.
 12667     MOVE LENGTH OF
 12668      ACTIVITY-TRAILERS
 12669       TO DFHEIV11
 12670*    MOVE '&& L                  %   #00011187' TO DFHEIV0
 12671     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12672     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12673     MOVE X'2020233030303131313837' TO DFHEIV0(25:11)
 12674     CALL 'kxdfhei1' USING DFHEIV0,
 12675           TRLR-FILE-ID,
 12676           ACTIVITY-TRAILERS,
 12677           DFHEIV11,
 12678           DFHEIV99
 12679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12680
 12681
 12682     IF DIAGI GREATER THAN LOW-VALUES
 12683       AND DIAGI NOT = WS-DIAGNOSIS
 12684         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12685         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12686         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12687
 12688     IF ICD1I GREATER THAN LOW-VALUES
 12689       AND ICD1I NOT = WS-ICD-CODE-1
 12690         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12691         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12692         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12693     END-IF.
 12694
 12695     IF ICD2I GREATER THAN LOW-VALUES
 12696       AND ICD2I NOT = WS-ICD-CODE-2
 12697         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12698         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12699         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12700     END-IF.
 12701
 12702     GO TO 2425-EXIT.
 12703
 12704 2425-NINETY-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 236
* EL131.cbl
 12705
 12706
 12707* EXEC CICS GETMAIN
 12708*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12709*         LENGTH    (TRLR-LENGTH)
 12710*         INITIMG   (GETMAIN-SPACE)
 12711*    END-EXEC.
 12712*    MOVE ',"IL                  $   #00011216' TO DFHEIV0
 12713     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12714     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12715     MOVE X'2020233030303131323136' TO DFHEIV0(25:11)
 12716     CALL 'kxdfhei1' USING DFHEIV0,
 12717           DFHEIV20,
 12718           TRLR-LENGTH,
 12719           GETMAIN-SPACE
 12720     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12721         DFHEIV20
 12722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12723
 12724
 12725     MOVE +90                  TO TRLR-SEQ-NO.
 12726     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12727
 12728     MOVE 'AT'                 TO AT-RECORD-ID
 12729     MOVE '6'                  TO AT-TRAILER-TYPE
 12730     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12731                                  AT-GEN-INFO-LAST-MAINT-DT
 12732     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12733                                  AT-GEN-INFO-LAST-UPDATED-BY
 12734     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12735     MOVE DIAGI                TO AT-INFO-LINE-1.
 12736     MOVE ICD1I                TO AT-ICD-CODE-1.
 12737     MOVE ICD2I                TO AT-ICD-CODE-2.
 12738
 12739
 12740* EXEC CICS WRITE
 12741*        DATASET (TRLR-FILE-ID)
 12742*        FROM    (ACTIVITY-TRAILERS)
 12743*        RIDFLD  (TRLR-KEY)
 12744*    END-EXEC.
 12745     MOVE LENGTH OF
 12746      ACTIVITY-TRAILERS
 12747       TO DFHEIV11
 12748*    MOVE '&$ L                  ''   #00011236' TO DFHEIV0
 12749     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12750     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12751     MOVE X'2020233030303131323336' TO DFHEIV0(25:11)
 12752     CALL 'kxdfhei1' USING DFHEIV0,
 12753           TRLR-FILE-ID,
 12754           ACTIVITY-TRAILERS,
 12755           DFHEIV11,
 12756           TRLR-KEY,
 12757           DFHEIV99,
 12758           DFHEIV99
 12759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12760
 12761
 12762 2425-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 237
* EL131.cbl
 12763     EXIT.
 12764
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 238
* EL131.cbl
 12766 2430-UPDATE-ACTQ.
 12767
 12768* EXEC CICS HANDLE CONDITION
 12769*         NOTFND    (2430-EXIT)
 12770*         ENDFILE   (2440-EXIT)
 12771*    END-EXEC.
 12772*    MOVE '"$I''                  ! 7 #00011247' TO DFHEIV0
 12773     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12775     MOVE X'3720233030303131323437' TO DFHEIV0(25:11)
 12776     CALL 'kxdfhei1' USING DFHEIV0
 12777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12778
 12779
 12780
 12781* EXEC CICS STARTBR
 12782*         DATASET  (ACTQ-FILE-ID)
 12783*         RIDFLD   (ACTQ-KEY)
 12784*    END-EXEC.
 12785     MOVE 0
 12786       TO DFHEIV11
 12787*    MOVE '&,         G          &   #00011252' TO DFHEIV0
 12788     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12789     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12790     MOVE X'2020233030303131323532' TO DFHEIV0(25:11)
 12791     CALL 'kxdfhei1' USING DFHEIV0,
 12792           ACTQ-FILE-ID,
 12793           ACTQ-KEY,
 12794           DFHEIV99,
 12795           DFHEIV11,
 12796           DFHEIV99
 12797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12798
 12799
 12800
 12801* EXEC CICS GETMAIN
 12802*         SET      (ADDRESS OF ACTIVITY-QUE)
 12803*         LENGTH   (ACTQ-LENGTH)
 12804*         INITIMG  (GETMAIN-SPACE)
 12805*    END-EXEC.
 12806*    MOVE ',"IL                  $   #00011257' TO DFHEIV0
 12807     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12808     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12809     MOVE X'2020233030303131323537' TO DFHEIV0(25:11)
 12810     CALL 'kxdfhei1' USING DFHEIV0,
 12811           DFHEIV20,
 12812           ACTQ-LENGTH,
 12813           GETMAIN-SPACE
 12814     SET ADDRESS OF ACTIVITY-QUE TO
 12815         DFHEIV20
 12816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12817
 12818
 12819     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12820
 12821 2430-EXIT.
 12822     EXIT.
 12823
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 239
* EL131.cbl
 12824 2440-CHANGE-ACTQ.
 12825
 12826
 12827* EXEC CICS READNEXT
 12828*         DATASET  (ACTQ-FILE-ID)
 12829*         RIDFLD   (ACTQ-KEY)
 12830*         INTO     (ACTIVITY-QUE)
 12831*    END-EXEC.
 12832     MOVE LENGTH OF
 12833      ACTIVITY-QUE
 12834       TO DFHEIV12
 12835     MOVE 0
 12836       TO DFHEIV11
 12837*    MOVE '&.IL                  )   #00011270' TO DFHEIV0
 12838     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12839     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12840     MOVE X'2020233030303131323730' TO DFHEIV0(25:11)
 12841     CALL 'kxdfhei1' USING DFHEIV0,
 12842           ACTQ-FILE-ID,
 12843           ACTIVITY-QUE,
 12844           DFHEIV12,
 12845           ACTQ-KEY,
 12846           DFHEIV99,
 12847           DFHEIV11,
 12848           DFHEIV99,
 12849           DFHEIV99
 12850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12851
 12852
 12853
 12854* EXEC CICS ENDBR
 12855*         DATASET (ACTQ-FILE-ID)
 12856*    END-EXEC.
 12857     MOVE 0
 12858       TO DFHEIV11
 12859*    MOVE '&2                    $   #00011276' TO DFHEIV0
 12860     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12861     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12862     MOVE X'2020233030303131323736' TO DFHEIV0(25:11)
 12863     CALL 'kxdfhei1' USING DFHEIV0,
 12864           ACTQ-FILE-ID,
 12865           DFHEIV11,
 12866           DFHEIV99
 12867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12868
 12869
 12870     IF ACTQ-KEY NOT = MSTR-KEY
 12871         GO TO 2440-EXIT.
 12872
 12873
 12874* EXEC CICS READ UPDATE
 12875*         DATASET  (ACTQ-FILE-ID)
 12876*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12877*         SET      (ADDRESS OF ACTIVITY-QUE)
 12878*    END-EXEC.
 12879*    MOVE '&"S        EU         (   #00011283' TO DFHEIV0
 12880     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12881     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 240
* EL131.cbl
 12882     MOVE X'2020233030303131323833' TO DFHEIV0(25:11)
 12883     CALL 'kxdfhei1' USING DFHEIV0,
 12884           ACTQ-FILE-ID,
 12885           DFHEIV20,
 12886           DFHEIV99,
 12887           AQ-CONTROL-PRIMARY,
 12888           DFHEIV99,
 12889           DFHEIV99,
 12890           DFHEIV99
 12891     SET ADDRESS OF ACTIVITY-QUE TO
 12892         DFHEIV20
 12893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12894
 12895
 12896     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12897
 12898
 12899* EXEC CICS DELETE
 12900*         DATASET (ACTQ-FILE-ID)
 12901*    END-EXEC.
 12902*    MOVE '&(                    &   #00011291' TO DFHEIV0
 12903     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12904     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12905     MOVE X'2020233030303131323931' TO DFHEIV0(25:11)
 12906     CALL 'kxdfhei1' USING DFHEIV0,
 12907           ACTQ-FILE-ID,
 12908           DFHEIV99,
 12909           DFHEIV99,
 12910           DFHEIV99,
 12911           DFHEIV99
 12912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12913
 12914
 12915     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12916     IF CERTI GREATER THAN LOW-VALUES
 12917        MOVE CERTI               TO AQ-CERT-PRIME.
 12918     IF SUFXI GREATER THAN LOW-VALUES
 12919        MOVE SUFXI               TO AQ-CERT-SFX.
 12920     IF CERTCARI GREATER THAN LOW-VALUES
 12921        MOVE CERTCARI            TO AQ-CARRIER.
 12922
 12923
 12924* EXEC CICS HANDLE CONDITION
 12925*         DUPREC   (2440-EXIT)
 12926*    END-EXEC.
 12927*    MOVE '"$%                   ! 8 #00011303' TO DFHEIV0
 12928     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12929     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12930     MOVE X'3820233030303131333033' TO DFHEIV0(25:11)
 12931     CALL 'kxdfhei1' USING DFHEIV0
 12932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12933
 12934
 12935
 12936* EXEC CICS WRITE
 12937*         DATASET  (ACTQ-FILE-ID)
 12938*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12939*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 241
* EL131.cbl
 12940*    END-EXEC.
 12941     MOVE LENGTH OF
 12942      ACTIVITY-QUE
 12943       TO DFHEIV11
 12944*    MOVE '&$ L                  ''   #00011307' TO DFHEIV0
 12945     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12946     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12947     MOVE X'2020233030303131333037' TO DFHEIV0(25:11)
 12948     CALL 'kxdfhei1' USING DFHEIV0,
 12949           ACTQ-FILE-ID,
 12950           ACTIVITY-QUE,
 12951           DFHEIV11,
 12952           AQ-CONTROL-PRIMARY,
 12953           DFHEIV99,
 12954           DFHEIV99
 12955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12956
 12957
 12958 2440-EXIT.
 12959     EXIT.
 12960
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 242
* EL131.cbl
 12962 2460-UPDATE-CHECKQ.
 12963
 12964* EXEC CICS HANDLE CONDITION
 12965*         NOTFND   (2460-EXIT)
 12966*    END-EXEC.
 12967*    MOVE '"$I                   ! 9 #00011318' TO DFHEIV0
 12968     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12969     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12970     MOVE X'3920233030303131333138' TO DFHEIV0(25:11)
 12971     CALL 'kxdfhei1' USING DFHEIV0
 12972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12973
 12974
 12975     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12976     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12977     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12978
 12979
 12980* EXEC CICS READ UPDATE
 12981*         DATASET   (CHKQ-FILE-ID)
 12982*         RIDFLD    (CHKQ-KEY)
 12983*         SET       (ADDRESS OF CHECK-QUE)
 12984*    END-EXEC.
 12985*    MOVE '&"S        EU         (   #00011326' TO DFHEIV0
 12986     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12987     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12988     MOVE X'2020233030303131333236' TO DFHEIV0(25:11)
 12989     CALL 'kxdfhei1' USING DFHEIV0,
 12990           CHKQ-FILE-ID,
 12991           DFHEIV20,
 12992           DFHEIV99,
 12993           CHKQ-KEY,
 12994           DFHEIV99,
 12995           DFHEIV99,
 12996           DFHEIV99
 12997     SET ADDRESS OF CHECK-QUE TO
 12998         DFHEIV20
 12999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13000
 13001
 13002     IF CERTI GREATER THAN LOW-VALUES
 13003        MOVE CERTI               TO CQ-CERT-PRIME.
 13004     IF SUFXI GREATER THAN LOW-VALUES
 13005        MOVE SUFXI               TO CQ-CERT-SFX.
 13006     IF CERTCARI GREATER THAN LOW-VALUES
 13007        MOVE CERTCARI            TO CQ-CARRIER.
 13008
 13009
 13010* EXEC CICS REWRITE
 13011*         DATASET  (CHKQ-FILE-ID)
 13012*         FROM     (CHECK-QUE)
 13013*    END-EXEC.
 13014     MOVE LENGTH OF
 13015      CHECK-QUE
 13016       TO DFHEIV11
 13017*    MOVE '&& L                  %   #00011339' TO DFHEIV0
 13018     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13019     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 243
* EL131.cbl
 13020     MOVE X'2020233030303131333339' TO DFHEIV0(25:11)
 13021     CALL 'kxdfhei1' USING DFHEIV0,
 13022           CHKQ-FILE-ID,
 13023           CHECK-QUE,
 13024           DFHEIV11,
 13025           DFHEIV99
 13026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13027
 13028
 13029 2460-EXIT.
 13030     EXIT.
 13031
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 244
* EL131.cbl
 13033 2475-UPDATE-LETTER.
 13034
 13035* EXEC CICS HANDLE CONDITION
 13036*         NOTFND   (2475-EXIT)
 13037*    END-EXEC.
 13038*    MOVE '"$I                   ! : #00011349' TO DFHEIV0
 13039     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13040     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13041     MOVE X'3A20233030303131333439' TO DFHEIV0(25:11)
 13042     CALL 'kxdfhei1' USING DFHEIV0
 13043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13044
 13045
 13046     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 13047     MOVE '1'                    TO ARCH-RECORD-TYPE.
 13048     MOVE ZEROS                  TO ARCH-SEQ-NO.
 13049     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 13050
 13051
 13052* EXEC CICS READ UPDATE
 13053*         DATASET   (ARCH-FILE-ID)
 13054*         RIDFLD    (ARCH-KEY)
 13055*         SET       (ADDRESS OF LETTER-ARCHIVE)
 13056*    END-EXEC.
 13057*    MOVE '&"S        EU         (   #00011358' TO DFHEIV0
 13058     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13059     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13060     MOVE X'2020233030303131333538' TO DFHEIV0(25:11)
 13061     CALL 'kxdfhei1' USING DFHEIV0,
 13062           ARCH-FILE-ID,
 13063           DFHEIV20,
 13064           DFHEIV99,
 13065           ARCH-KEY,
 13066           DFHEIV99,
 13067           DFHEIV99,
 13068           DFHEIV99
 13069     SET ADDRESS OF LETTER-ARCHIVE TO
 13070         DFHEIV20
 13071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13072
 13073
 13074* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 13075* TO THIS MASTER-KEY INFORMATION.
 13076
 13077     IF LA-CARRIER  = CARRIER-CODE AND
 13078        LA-CLAIM-NO = CLAIM-NO     AND
 13079        LA-CERT-NO  = CERT-NO
 13080        NEXT SENTENCE
 13081     ELSE
 13082        GO TO 2475-UNLOCK.
 13083
 13084     IF CERTI GREATER THAN LOW-VALUES
 13085        MOVE CERTI               TO LA-CERT-PRIME.
 13086     IF SUFXI GREATER THAN LOW-VALUES
 13087        MOVE SUFXI               TO LA-CERT-SFX.
 13088     IF CERTCARI GREATER THAN LOW-VALUES
 13089        MOVE CERTCARI            TO LA-CARRIER.
 13090
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 245
* EL131.cbl
 13091
 13092* EXEC CICS REWRITE
 13093*         DATASET  (ARCH-FILE-ID)
 13094*         FROM     (LETTER-ARCHIVE)
 13095*    END-EXEC.
 13096     MOVE LENGTH OF
 13097      LETTER-ARCHIVE
 13098       TO DFHEIV11
 13099*    MOVE '&& L                  %   #00011381' TO DFHEIV0
 13100     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13101     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13102     MOVE X'2020233030303131333831' TO DFHEIV0(25:11)
 13103     CALL 'kxdfhei1' USING DFHEIV0,
 13104           ARCH-FILE-ID,
 13105           LETTER-ARCHIVE,
 13106           DFHEIV11,
 13107           DFHEIV99
 13108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13109
 13110
 13111     GO TO 2475-EXIT.
 13112
 13113 2475-UNLOCK.
 13114
 13115* EXEC CICS UNLOCK
 13116*         DATASET  (ARCH-FILE-ID)
 13117*    END-EXEC.
 13118*    MOVE '&*                    #   #00011389' TO DFHEIV0
 13119     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13120     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13121     MOVE X'2020233030303131333839' TO DFHEIV0(25:11)
 13122     CALL 'kxdfhei1' USING DFHEIV0,
 13123           ARCH-FILE-ID,
 13124           DFHEIV99
 13125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13126
 13127
 13128 2475-EXIT.
 13129     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 246
* EL131.cbl
 13131 2600-CREATE-MAINT-NOTE.
 13132     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 13133     MOVE '1'                    TO CNTL-REC-TYPE.
 13134     MOVE SPACES                 TO CNTL-PROC-ID.
 13135     MOVE ZERO                   TO CNTL-SEQ-NO.
 13136
 13137
 13138* EXEC CICS READ
 13139*         SET        (ADDRESS OF CONTROL-FILE)
 13140*         DATASET    ('ELCNTL')
 13141*         RIDFLD     (CNTL-KEY)
 13142*    END-EXEC.
 13143     MOVE 'ELCNTL' TO DFHEIV1
 13144*    MOVE '&"S        E          (   #00011402' TO DFHEIV0
 13145     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13146     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13147     MOVE X'2020233030303131343032' TO DFHEIV0(25:11)
 13148     CALL 'kxdfhei1' USING DFHEIV0,
 13149           DFHEIV1,
 13150           DFHEIV20,
 13151           DFHEIV99,
 13152           CNTL-KEY,
 13153           DFHEIV99,
 13154           DFHEIV99,
 13155           DFHEIV99
 13156     SET ADDRESS OF CONTROL-FILE TO
 13157         DFHEIV20
 13158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13159
 13160
 13161     IF CO-NO-USE-AUDIT-CHANGES
 13162         GO TO 2600-EXIT.
 13163
 13164     IF PROCL GREATER ZERO
 13165     IF PROCI NOT = LOW-VALUES
 13166     IF PROCI NOT = CL-PROCESSOR-ID
 13167         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 13168         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 13169         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13170
 13171     IF SEXL GREATER ZERO
 13172     IF SEXI NOT = LOW-VALUES
 13173     IF SEXI NOT = CL-INSURED-SEX-CD
 13174         MOVE 'SEX'                TO SPLIT-INFO-DESC
 13175         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 13176         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13177
 13178     IF BIRTHL GREATER ZERO
 13179     IF HOLD-BIRTH NOT = LOW-VALUES
 13180     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 13181         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 13182         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 13183         MOVE SPACES               TO DC-OPTION-CODE
 13184         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13185         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13186         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13187
 13188     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 247
* EL131.cbl
 13189     IF SOCIALI NOT = LOW-VALUES
 13190     IF SOCIALI NOT = CL-SOC-SEC-NO
 13191         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 13192         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 13193         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13194
 13195     IF OCCL GREATER ZERO
 13196     IF OCCI NOT = LOW-VALUES
 13197     IF OCCI NOT = CL-INSURED-OCC-CD
 13198         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 13199         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 13200         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13201
 13202     IF BENEL GREATER ZERO
 13203     IF BENEI NOT = LOW-VALUES
 13204     IF BENEI NOT = CL-BENEFICIARY
 13205         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 13206         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 13207         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13208
 13209     IF PREMTYPL GREATER ZERO
 13210     IF PREMTYPI NOT = LOW-VALUES
 13211     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 13212         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 13213         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 13214         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13215
 13216*    IF CAUSEL GREATER ZERO
 13217*    IF CAUSEI NOT = LOW-VALUES
 13218*    IF CAUSEI NOT = CL-CAUSE-CD
 13219*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 13220*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 13221*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13222
 13223*    IF ENDL GREATER ZERO
 13224*    IF HOLD-END NOT = LOW-VALUES
 13225*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 13226*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 13227*        MOVE CL-EST-END-OF-DISAB-DT
 13228*                                  TO DC-BIN-DATE-1
 13229*        MOVE SPACES               TO DC-OPTION-CODE
 13230*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13231*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13232*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13233
 13234     IF PDTHRUL GREATER ZERO
 13235     IF HOLD-PDTHRU NOT = LOW-VALUES
 13236     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 13237         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 13238         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 13239         MOVE SPACES               TO DC-OPTION-CODE
 13240         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13241         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13242         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13243
 13244     IF PDAMTL GREATER ZERO
 13245     IF HOLD-PDAMT NOT = ZEROS
 13246     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 248
* EL131.cbl
 13247         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 13248         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 13249         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 13250         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13251
 13252     IF NODAYSL GREATER ZERO
 13253     IF HOLD-NODAYS NOT = ZEROS
 13254     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 13255         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 13256         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 13257         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13258         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13259
 13260     IF NOPMTSL GREATER ZERO
 13261     IF HOLD-NOPMTS NOT = ZEROS
 13262     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 13263         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 13264         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 13265         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13266         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13267
 13268     IF FORMTYPL GREATER ZERO
 13269     IF FORMTYPI NOT = LOW-VALUES
 13270     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 13271         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 13272         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 13273         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13274
 13275     IF REPL GREATER ZERO
 13276     IF HOLD-REPORTED NOT = LOW-VALUES
 13277     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 13278         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 13279         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 13280         MOVE SPACES               TO DC-OPTION-CODE
 13281         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13282         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13283         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13284
 13285     IF ADDONDTL GREATER ZERO
 13286     IF HOLD-ADDON NOT = LOW-VALUES
 13287     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 13288         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 13289         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 13290         MOVE SPACES               TO DC-OPTION-CODE
 13291         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13292         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13293         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13294
 13295     IF PRICDL GREATER ZERO
 13296     IF PRICDI NOT = LOW-VALUES
 13297     IF PRICDI NOT = CL-PRIORITY-CD
 13298         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 13299         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 13300         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13301
 13302     IF FILETOL GREATER ZERO
 13303     IF FILETOI NOT = LOW-VALUES
 13304     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 249
* EL131.cbl
 13305         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 13306         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 13307         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13308
 13309     IF SUPVL GREATER ZERO
 13310     IF SUPVI NOT = LOW-VALUES
 13311     IF SUPVI NOT = CL-SUPV-ATTN-CD
 13312         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 13313         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 13314         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13315*    IF (CRITPTL > ZERO)
 13316*       AND (CRITPTI NOT = LOW-VALUES)
 13317*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 13318*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 13319*       MOVE CL-CRIT-PER-RECURRENT
 13320*                                TO SPLIT-INFO-OLD
 13321*       PERFORM 2650-WRITE-MAINT-NOTE
 13322*                                THRU 2650-EXIT
 13323*    END-IF
 13324
 13325*    IF (RTWMOSL > ZERO)
 13326*       AND (RTWMOSI NOT = LOW-VALUES)
 13327*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 13328*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 13329*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 13330*       PERFORM 2650-WRITE-MAINT-NOTE
 13331*                                THRU 2650-EXIT
 13332*    END-IF
 13333     IF MLNAMEL GREATER ZERO
 13334     IF MLNAMEI NOT = LOW-VALUES
 13335     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 13336         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 13337         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 13338         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13339
 13340     IF MFNAMEL GREATER ZERO
 13341     IF MFNAMEI NOT = LOW-VALUES
 13342     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 13343         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 13344         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 13345         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13346
 13347     IF MMINITL GREATER ZERO
 13348     IF MMINITI NOT = LOW-VALUES
 13349     IF MMINITI NOT = CL-INSURED-MID-INIT
 13350         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 13351         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 13352         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13353
 13354     IF CERTEFFL GREATER ZERO
 13355     IF HOLD-EFF NOT = LOW-VALUES
 13356     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 13357         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 13358         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 13359         MOVE SPACES               TO DC-OPTION-CODE
 13360         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13361         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13362         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 250
* EL131.cbl
 13363
 13364     IF CERTACTL GREATER ZERO
 13365     IF CERTACTI NOT = LOW-VALUES
 13366     IF CERTACTI NOT = CL-CERT-ACCOUNT
 13367         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 13368         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 13369         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13370
 13371     IF CERTSTL GREATER ZERO
 13372     IF CERTSTI NOT = LOW-VALUES
 13373     IF CERTSTI NOT = CL-CERT-STATE
 13374         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 13375         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 13376         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13377
 13378     IF CERTCARL GREATER ZERO
 13379     IF CERTCARI NOT = LOW-VALUES
 13380     IF CERTCARI NOT = CL-CERT-CARRIER
 13381         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13382         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13383         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13384
 13385     IF CERTGRPL GREATER ZERO
 13386     IF CERTGRPI NOT = LOW-VALUES
 13387     IF CERTGRPI NOT = CL-CERT-GROUPING
 13388         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13389         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13390         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13391
 13392     IF CERTL GREATER ZERO OR
 13393        SUFXL GREATER ZERO
 13394     IF (CERTI NOT = LOW-VALUES AND
 13395                     CL-CERT-PRIME)
 13396                OR
 13397        (SUFXI NOT = LOW-VALUES AND
 13398                     CL-CERT-SFX)
 13399         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13400         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13401         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13402     IF incl > zeros
 13403        IF (HOLD-INCUR NOT = LOW-VALUES)
 13404           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13405           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13406           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13407           MOVE SPACES           TO DC-OPTION-CODE
 13408           PERFORM 9800-CONVERT-DATE
 13409                                 THRU 9800-EXIT
 13410           MOVE DC-GREG-DATE-1-EDIT
 13411                                 TO SPLIT-INFO-OLD
 13412           PERFORM 2650-WRITE-MAINT-NOTE
 13413                                 THRU 2650-EXIT
 13414        END-IF
 13415     END-IF
 13416     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 13417       IF (REPL GREATER ZERO
 13418         AND HOLD-REPORTED NOT = LOW-VALUES
 13419         AND HOLD-REPORTED NOT = CL-REPORTED-DT)
 13420        OR (incl > zeros
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 251
* EL131.cbl
 13421          AND (HOLD-INCUR NOT = LOW-VALUES)
 13422             AND (HOLD-INCUR NOT = CL-INCURRED-DT))
 13423          PERFORM 2610-CHECK-2-YEAR-CONTESTABLE THRU 2610-EXIT
 13424       END-IF
 13425     END-IF
 13426     .
 13427 2600-EXIT.
 13428      EXIT.
 13429 2610-CHECK-2-YEAR-CONTESTABLE.
 13430     SET ELAPSED-BETWEEN-BIN TO TRUE
 13431     MOVE ZERO               TO DC-ELAPSED-MONTHS
 13432                                DC-ELAPSED-DAYS
 13433
 13434     MOVE HOLD-EFF TO DC-BIN-DATE-1.
 13435     IF HOLD-INCUR > SPACES
 13436        MOVE HOLD-INCUR TO DC-BIN-DATE-2
 13437     ELSE
 13438        MOVE CL-INCURRED-DT TO DC-BIN-DATE-2
 13439     END-IF
 13440     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 13441     IF DC-ODD-DAYS-OVER > ZERO
 13442        ADD 1 TO DC-ELAPSED-MONTHS
 13443     END-IF
 13444
 13445     IF DC-ELAPSED-MONTHS <= 24
 13446        IF HOLD-REPORTED > SPACES
 13447           MOVE HOLD-REPORTED TO DC-BIN-DATE-2
 13448        ELSE
 13449           MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
 13450        END-IF
 13451        MOVE ZERO           TO DC-ELAPSED-MONTHS
 13452                               DC-ELAPSED-DAYS
 13453        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13454        IF DC-ODD-DAYS-OVER > ZERO
 13455           ADD 1 TO DC-ELAPSED-MONTHS
 13456        END-IF
 13457        IF DC-ELAPSED-MONTHS > 24
 13458           MOVE ER-1679            TO EMI-ERROR
 13459           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13460        END-IF
 13461     END-IF.
 13462
 13463     PERFORM 2615-CHECK-TRLR THRU 2615-EXIT.
 13464
 13465 2610-EXIT.
 13466     EXIT.
 13467 2615-CHECK-TRLR.
 13468
 13469     MOVE CL-CONTROL-PRIMARY   TO TRLR-KEY
 13470     MOVE +96              TO TRLR-SEQ-NO
 13471
 13472* EXEC CICS READ
 13473*       UPDATE
 13474*       DATASET  ('ELTRLR')
 13475*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13476*       RIDFLD   (TRLR-KEY)
 13477*       RESP     (WS-RESPONSE)
 13478*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 252
* EL131.cbl
 13479     MOVE 'ELTRLR' TO DFHEIV1
 13480*    MOVE '&"S        EU         (  N#00011718' TO DFHEIV0
 13481     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13482     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13483     MOVE X'204E233030303131373138' TO DFHEIV0(25:11)
 13484     CALL 'kxdfhei1' USING DFHEIV0,
 13485           DFHEIV1,
 13486           DFHEIV20,
 13487           DFHEIV99,
 13488           TRLR-KEY,
 13489           DFHEIV99,
 13490           DFHEIV99,
 13491           DFHEIV99
 13492     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13493         DFHEIV20
 13494     MOVE EIBRESP  TO WS-RESPONSE
 13495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13496     IF WS-RESP-NORMAL
 13497        IF EMI-ERROR =  ER-1679
 13498           IF EMI-ERROR-NUMBER(1) = ER-1679
 13499              MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13500           ELSE
 13501           IF EMI-ERROR-NUMBER(2) = ER-1679
 13502              MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13503           ELSE
 13504           IF EMI-ERROR-NUMBER(3) = ER-1679
 13505              MOVE EMI-LINE3 TO AT-INFO-LINE-1
 13506           END-IF
 13507           END-IF
 13508           END-IF
 13509
 13510* EXEC CICS REWRITE
 13511*             DATASET   ('ELTRLR')
 13512*             FROM      (ACTIVITY-TRAILERS)
 13513*          END-EXEC
 13514     MOVE LENGTH OF
 13515      ACTIVITY-TRAILERS
 13516       TO DFHEIV11
 13517     MOVE 'ELTRLR' TO DFHEIV1
 13518*    MOVE '&& L                  %   #00011738' TO DFHEIV0
 13519     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13520     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13521     MOVE X'2020233030303131373338' TO DFHEIV0(25:11)
 13522     CALL 'kxdfhei1' USING DFHEIV0,
 13523           DFHEIV1,
 13524           ACTIVITY-TRAILERS,
 13525           DFHEIV11,
 13526           DFHEIV99
 13527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13528        ELSE
 13529           MOVE WS-CONTEST-NOTE TO AT-INFO-LINE-1
 13530
 13531* EXEC CICS REWRITE
 13532*                DATASET   ('ELTRLR')
 13533*                FROM      (ACTIVITY-TRAILERS)
 13534*             END-EXEC
 13535     MOVE LENGTH OF
 13536      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 253
* EL131.cbl
 13537       TO DFHEIV11
 13538     MOVE 'ELTRLR' TO DFHEIV1
 13539*    MOVE '&& L                  %   #00011744' TO DFHEIV0
 13540     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13541     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13542     MOVE X'2020233030303131373434' TO DFHEIV0(25:11)
 13543     CALL 'kxdfhei1' USING DFHEIV0,
 13544           DFHEIV1,
 13545           ACTIVITY-TRAILERS,
 13546           DFHEIV11,
 13547           DFHEIV99
 13548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13549        END-IF
 13550     ELSE
 13551
 13552* EXEC CICS GETMAIN
 13553*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13554*          LENGTH   (TRLR-LENGTH)
 13555*          INITIMG  (GETMAIN-SPACE)
 13556*       END-EXEC
 13557*    MOVE ',"IL                  $   #00011750' TO DFHEIV0
 13558     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13559     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13560     MOVE X'2020233030303131373530' TO DFHEIV0(25:11)
 13561     CALL 'kxdfhei1' USING DFHEIV0,
 13562           DFHEIV20,
 13563           TRLR-LENGTH,
 13564           GETMAIN-SPACE
 13565     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13566         DFHEIV20
 13567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13568        MOVE 'AT'          TO AT-RECORD-ID
 13569        MOVE CL-CONTROL-PRIMARY
 13570                           TO AT-CONTROL-PRIMARY
 13571        MOVE +96           TO AT-SEQUENCE-NO
 13572        MOVE '6'           TO AT-TRAILER-TYPE
 13573        MOVE SPACES             TO AT-GENERAL-INFO-TR
 13574        INITIALIZE AT-GENERAL-INFO-TR
 13575        IF EMI-ERROR-NUMBER(1) = ER-1679
 13576           MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13577        ELSE
 13578        IF EMI-ERROR-NUMBER(2) = ER-1679
 13579           MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13580        ELSE
 13581        IF EMI-ERROR-NUMBER(3) = ER-1679
 13582           MOVE EMI-LINE3 TO AT-INFO-LINE-1
 13583        END-IF
 13584        END-IF
 13585        END-IF
 13586        MOVE SPACE           TO AT-INFO-TRAILER-TYPE
 13587        MOVE SAVE-BIN-DATE TO AT-RECORDED-DT
 13588                              AT-GEN-INFO-LAST-MAINT-DT
 13589        MOVE PI-PROCESSOR-ID
 13590                           TO AT-RECORDED-BY
 13591                              AT-GEN-INFO-LAST-UPDATED-BY
 13592        MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
 13593
 13594* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 254
* EL131.cbl
 13595*          DATASET   ('ELTRLR')
 13596*          FROM      (ACTIVITY-TRAILERS)
 13597*          RIDFLD    (TRLR-KEY)
 13598*       END-EXEC
 13599     MOVE LENGTH OF
 13600      ACTIVITY-TRAILERS
 13601       TO DFHEIV11
 13602     MOVE 'ELTRLR' TO DFHEIV1
 13603*    MOVE '&$ L                  ''   #00011780' TO DFHEIV0
 13604     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13605     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13606     MOVE X'2020233030303131373830' TO DFHEIV0(25:11)
 13607     CALL 'kxdfhei1' USING DFHEIV0,
 13608           DFHEIV1,
 13609           ACTIVITY-TRAILERS,
 13610           DFHEIV11,
 13611           TRLR-KEY,
 13612           DFHEIV99,
 13613           DFHEIV99
 13614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13615     END-IF
 13616     .
 13617 2615-EXIT.
 13618     EXIT.
 13619
 13620
 13621 2650-WRITE-MAINT-NOTE.
 13622
 13623* EXEC CICS GETMAIN
 13624*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13625*         LENGTH   (TRLR-LENGTH)
 13626*         INITIMG  (GETMAIN-SPACE)
 13627*    END-EXEC.
 13628*    MOVE ',"IL                  $   #00011792' TO DFHEIV0
 13629     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13630     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13631     MOVE X'2020233030303131373932' TO DFHEIV0(25:11)
 13632     CALL 'kxdfhei1' USING DFHEIV0,
 13633           DFHEIV20,
 13634           TRLR-LENGTH,
 13635           GETMAIN-SPACE
 13636     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13637         DFHEIV20
 13638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13639
 13640
 13641
 13642* EXEC CICS HANDLE CONDITION
 13643*         DUPREC   (2650-EXIT)
 13644*    END-EXEC.
 13645*    MOVE '"$%                   ! ; #00011798' TO DFHEIV0
 13646     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13647     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13648     MOVE X'3B20233030303131373938' TO DFHEIV0(25:11)
 13649     CALL 'kxdfhei1' USING DFHEIV0
 13650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13651
 13652
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 255
* EL131.cbl
 13653     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13654
 13655     IF CERTL GREATER ZERO
 13656         MOVE CERTI          TO CL-CERT-PRIME.
 13657
 13658     IF SUFXL GREATER ZERO
 13659         MOVE SUFXI          TO CL-CERT-SFX.
 13660
 13661     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13662
 13663     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13664     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13665
 13666     MOVE 'AT'               TO AT-RECORD-ID.
 13667
 13668     MOVE '6'                TO AT-TRAILER-TYPE.
 13669     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13670                                AT-GEN-INFO-LAST-MAINT-DT.
 13671     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13672                                AT-GEN-INFO-LAST-UPDATED-BY.
 13673     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13674     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13675     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13676
 13677
 13678* EXEC CICS WRITE
 13679*         DATASET  (TRLR-FILE-ID)
 13680*         RIDFLD   (AT-CONTROL-PRIMARY)
 13681*         FROM     (ACTIVITY-TRAILERS)
 13682*    END-EXEC.
 13683     MOVE LENGTH OF
 13684      ACTIVITY-TRAILERS
 13685       TO DFHEIV11
 13686*    MOVE '&$ L                  ''   #00011826' TO DFHEIV0
 13687     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13688     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13689     MOVE X'2020233030303131383236' TO DFHEIV0(25:11)
 13690     CALL 'kxdfhei1' USING DFHEIV0,
 13691           TRLR-FILE-ID,
 13692           ACTIVITY-TRAILERS,
 13693           DFHEIV11,
 13694           AT-CONTROL-PRIMARY,
 13695           DFHEIV99,
 13696           DFHEIV99
 13697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13698
 13699
 13700 2650-EXIT.
 13701      EXIT.
 13702
 13703 2800-CHECK-AUTO-PAY.
 13704
 13705     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13706     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13707     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13708     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13709     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13710
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 256
* EL131.cbl
 13711
 13712* EXEC CICS HANDLE CONDITION
 13713*         NOTFND    (2800-EXIT)
 13714*         ENDFILE   (2800-EXIT)
 13715*    END-EXEC.
 13716*    MOVE '"$I''                  ! < #00011843' TO DFHEIV0
 13717     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13718     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13719     MOVE X'3C20233030303131383433' TO DFHEIV0(25:11)
 13720     CALL 'kxdfhei1' USING DFHEIV0
 13721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13722
 13723
 13724
 13725* EXEC CICS READ
 13726*        DATASET (TRLR-FILE-ID)
 13727*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13728*        RIDFLD  (TRLR-KEY)
 13729*    END-EXEC.
 13730*    MOVE '&"S        E          (   #00011848' TO DFHEIV0
 13731     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13732     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13733     MOVE X'2020233030303131383438' TO DFHEIV0(25:11)
 13734     CALL 'kxdfhei1' USING DFHEIV0,
 13735           TRLR-FILE-ID,
 13736           DFHEIV20,
 13737           DFHEIV99,
 13738           TRLR-KEY,
 13739           DFHEIV99,
 13740           DFHEIV99,
 13741           DFHEIV99
 13742     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13743         DFHEIV20
 13744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13745
 13746
 13747     IF BENEFICIARY-PAID-AUTO
 13748         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13749     END-IF.
 13750
 13751 2800-EXIT.
 13752      EXIT.
 13753
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 257
* EL131.cbl
 13755 3000-DELETE-CLAIM.
 13756     IF  NOT MODIFY-CAP
 13757         MOVE ER-0070            TO EMI-ERROR
 13758         MOVE -1                 TO MAINTL
 13759         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13760         GO TO 8110-SEND-DATA.
 13761
 13762
 13763* EXEC CICS READ
 13764*         SET      (ADDRESS OF CLAIM-MASTER)
 13765*         DATASET  (CLMS-FILE-ID)
 13766*         RIDFLD   (MSTR-KEY)
 13767*    END-EXEC.
 13768*    MOVE '&"S        E          (   #00011869' TO DFHEIV0
 13769     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13770     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13771     MOVE X'2020233030303131383639' TO DFHEIV0(25:11)
 13772     CALL 'kxdfhei1' USING DFHEIV0,
 13773           CLMS-FILE-ID,
 13774           DFHEIV20,
 13775           DFHEIV99,
 13776           MSTR-KEY,
 13777           DFHEIV99,
 13778           DFHEIV99,
 13779           DFHEIV99
 13780     SET ADDRESS OF CLAIM-MASTER TO
 13781         DFHEIV20
 13782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13783
 13784
 13785     IF CL-1ST-TRL-AVAIL
 13786         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 13787     ELSE
 13788        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 13789        MOVE 0                   TO TRLR-SEQ-NO
 13790
 13791* EXEC CICS STARTBR
 13792*            DATASET (TRLR-FILE-ID)
 13793*            RIDFLD  (TRLR-KEY)
 13794*        END-EXEC
 13795     MOVE 0
 13796       TO DFHEIV11
 13797*    MOVE '&,         G          &   #00011880' TO DFHEIV0
 13798     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13799     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13800     MOVE X'2020233030303131383830' TO DFHEIV0(25:11)
 13801     CALL 'kxdfhei1' USING DFHEIV0,
 13802           TRLR-FILE-ID,
 13803           TRLR-KEY,
 13804           DFHEIV99,
 13805           DFHEIV11,
 13806           DFHEIV99
 13807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13808         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 13809
 13810* EXEC CICS ENDBR
 13811*            DATASET (TRLR-FILE-ID)
 13812*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 258
* EL131.cbl
 13813     MOVE 0
 13814       TO DFHEIV11
 13815*    MOVE '&2                    $   #00011885' TO DFHEIV0
 13816     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13817     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13818     MOVE X'2020233030303131383835' TO DFHEIV0(25:11)
 13819     CALL 'kxdfhei1' USING DFHEIV0,
 13820           TRLR-FILE-ID,
 13821           DFHEIV11,
 13822           DFHEIV99
 13823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13824        IF SCREEN-ERROR
 13825            MOVE ER-0208         TO EMI-ERROR
 13826            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13827            MOVE -1              TO MAINTL
 13828            GO TO 8110-SEND-DATA
 13829        ELSE
 13830            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 13831
 13832     IF SCREEN-ERROR
 13833         MOVE -1                 TO MAINTL
 13834         GO TO 8110-SEND-DATA.
 13835
 13836     MOVE -1                     TO ONE-OR-MIN1.
 13837     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 13838
 13839     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 13840         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 13841                                    WS-SAVE-CLAIM-KEY
 13842         MOVE +1                 TO ONE-OR-MIN1
 13843         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 13844
 13845     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 13846
 13847     MOVE LOW-VALUES             TO EL131AO.
 13848     MOVE ER-0000                TO EMI-ERROR.
 13849     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13850     MOVE 'X'                    TO PI-RETURN-CD-1.
 13851     MOVE -1                     TO MAINTL.
 13852     GO TO 8100-SEND-MAP.
 13853
 13854 3010-DEL-MSTR-TRLR.
 13855
 13856* EXEC CICS READ UPDATE
 13857*         SET       (ADDRESS OF CLAIM-MASTER)
 13858*         DATASET   (CLMS-FILE-ID)
 13859*         RIDFLD    (MSTR-KEY)
 13860*    END-EXEC.
 13861*    MOVE '&"S        EU         (   #00011919' TO DFHEIV0
 13862     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13863     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13864     MOVE X'2020233030303131393139' TO DFHEIV0(25:11)
 13865     CALL 'kxdfhei1' USING DFHEIV0,
 13866           CLMS-FILE-ID,
 13867           DFHEIV20,
 13868           DFHEIV99,
 13869           MSTR-KEY,
 13870           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 259
* EL131.cbl
 13871           DFHEIV99,
 13872           DFHEIV99
 13873     SET ADDRESS OF CLAIM-MASTER TO
 13874         DFHEIV20
 13875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13876
 13877
 13878     if (cl-priority-cd = '8')
 13879        and (pi-processor-id not = 'PEMA' and 'JMS '
 13880             AND 'AMWA')
 13881        MOVE ER-8003             TO EMI-ERROR
 13882        PERFORM 9900-ERROR-FORMAT
 13883                                 THRU 9900-EXIT
 13884        MOVE -1                  TO MAINTL
 13885        GO TO 8110-SEND-DATA
 13886     end-if
 13887
 13888     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 13889     MOVE ZERO                   TO TRLR-SEQ-NO.
 13890
 13891
 13892* EXEC CICS HANDLE CONDITION
 13893*         NOTFND    (3010-DEL-ACTQ)
 13894*         ENDFILE   (3040-EXIT)
 13895*    END-EXEC.
 13896*    MOVE '"$I''                  ! = #00011938' TO DFHEIV0
 13897     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13898     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13899     MOVE X'3D20233030303131393338' TO DFHEIV0(25:11)
 13900     CALL 'kxdfhei1' USING DFHEIV0
 13901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13902
 13903
 13904     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 13905
 13906 3010-DEL-ACTQ.
 13907
 13908
 13909* EXEC CICS HANDLE CONDITION
 13910*         NOTFND    (3010-NO-ACTIVITY)
 13911*         ENDFILE   (3050-EXIT)
 13912*    END-EXEC.
 13913*    MOVE '"$I''                  ! > #00011947' TO DFHEIV0
 13914     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13915     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13916     MOVE X'3E20233030303131393437' TO DFHEIV0(25:11)
 13917     CALL 'kxdfhei1' USING DFHEIV0
 13918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13919
 13920
 13921
 13922* EXEC CICS STARTBR
 13923*         DATASET  (ACTQ-FILE-ID)
 13924*         RIDFLD   (ACTQ-KEY)
 13925*    END-EXEC.
 13926     MOVE 0
 13927       TO DFHEIV11
 13928*    MOVE '&,         G          &   #00011952' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 260
* EL131.cbl
 13929     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13930     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13931     MOVE X'2020233030303131393532' TO DFHEIV0(25:11)
 13932     CALL 'kxdfhei1' USING DFHEIV0,
 13933           ACTQ-FILE-ID,
 13934           ACTQ-KEY,
 13935           DFHEIV99,
 13936           DFHEIV11,
 13937           DFHEIV99
 13938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13939
 13940
 13941
 13942* EXEC CICS GETMAIN
 13943*         SET      (ADDRESS OF ACTIVITY-QUE)
 13944*         LENGTH   (ACTQ-LENGTH)
 13945*         INITIMG  (GETMAIN-SPACE)
 13946*    END-EXEC.
 13947*    MOVE ',"IL                  $   #00011957' TO DFHEIV0
 13948     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13949     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13950     MOVE X'2020233030303131393537' TO DFHEIV0(25:11)
 13951     CALL 'kxdfhei1' USING DFHEIV0,
 13952           DFHEIV20,
 13953           ACTQ-LENGTH,
 13954           GETMAIN-SPACE
 13955     SET ADDRESS OF ACTIVITY-QUE TO
 13956         DFHEIV20
 13957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13958
 13959
 13960     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 13961
 13962
 13963* EXEC CICS ENDBR
 13964*         DATASET (ACTQ-FILE-ID)
 13965*    END-EXEC.
 13966     MOVE 0
 13967       TO DFHEIV11
 13968*    MOVE '&2                    $   #00011965' TO DFHEIV0
 13969     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13970     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13971     MOVE X'2020233030303131393635' TO DFHEIV0(25:11)
 13972     CALL 'kxdfhei1' USING DFHEIV0,
 13973           ACTQ-FILE-ID,
 13974           DFHEIV11,
 13975           DFHEIV99
 13976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13977
 13978
 13979 3010-NO-ACTIVITY.
 13980
 13981
 13982* EXEC CICS HANDLE CONDITION
 13983*        NOTFND   (3010-CERT-NOT-FOUND)
 13984*    END-EXEC.
 13985*    MOVE '"$I                   ! ? #00011971' TO DFHEIV0
 13986     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 261
* EL131.cbl
 13987     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13988     MOVE X'3F20233030303131393731' TO DFHEIV0(25:11)
 13989     CALL 'kxdfhei1' USING DFHEIV0
 13990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13991
 13992
 13993     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 13994     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 13995     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 13996     MOVE CL-CERT-STATE          TO CERT-STATE.
 13997     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 13998     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 13999     MOVE CL-CERT-NO             TO CERT-CERT.
 14000
 14001
 14002* EXEC CICS READ
 14003*        DATASET   (CERT-FILE-ID)
 14004*        RIDFLD    (CERT-KEY)
 14005*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14006*    END-EXEC.
 14007*    MOVE '&"S        E          (   #00011983' TO DFHEIV0
 14008     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14009     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14010     MOVE X'2020233030303131393833' TO DFHEIV0(25:11)
 14011     CALL 'kxdfhei1' USING DFHEIV0,
 14012           CERT-FILE-ID,
 14013           DFHEIV20,
 14014           DFHEIV99,
 14015           CERT-KEY,
 14016           DFHEIV99,
 14017           DFHEIV99,
 14018           DFHEIV99
 14019     SET ADDRESS OF CERTIFICATE-MASTER TO
 14020         DFHEIV20
 14021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14022
 14023
 14024     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 14025       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 14026         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 14027     ELSE
 14028         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 14029
 14030 3010-UPDATE-CERT-TRLR.
 14031
 14032     MOVE CERT-KEY               TO ELCRTT-KEY
 14033     MOVE 'B'                    TO CTRLR-REC-TYPE
 14034
 14035* EXEC CICS READ
 14036*       UPDATE
 14037*       DATASET   ('ELCRTT')
 14038*       RIDFLD    (ELCRTT-KEY)
 14039*       INTO      (CERTIFICATE-TRAILERS)
 14040*       RESP      (WS-RESPONSE)
 14041*    END-EXEC
 14042     MOVE LENGTH OF
 14043      CERTIFICATE-TRAILERS
 14044       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 262
* EL131.cbl
 14045     MOVE 'ELCRTT' TO DFHEIV1
 14046*    MOVE '&"IL       EU         (  N#00011999' TO DFHEIV0
 14047     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14048     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14049     MOVE X'204E233030303131393939' TO DFHEIV0(25:11)
 14050     CALL 'kxdfhei1' USING DFHEIV0,
 14051           DFHEIV1,
 14052           CERTIFICATE-TRAILERS,
 14053           DFHEIV11,
 14054           ELCRTT-KEY,
 14055           DFHEIV99,
 14056           DFHEIV99,
 14057           DFHEIV99
 14058     MOVE EIBRESP  TO WS-RESPONSE
 14059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14060     IF WS-RESP-NORMAL
 14061        perform varying s1 from +1 by +1 until
 14062           (s1 > +24)
 14063           or (cs-claim-no (s1) = cl-claim-no)
 14064        end-perform
 14065        if s1 < +25
 14066           move spaces           to cs-claim-no (s1)
 14067                                    cs-claim-type (s1)
 14068                                    cs-insured-type (s1)
 14069           move zeros            to cs-days-paid (s1)
 14070                                    cs-total-paid (s1)
 14071                                    cs-benefit-period (s1)
 14072           if s1 not = +24
 14073              compute s2 = s1 + +1
 14074              perform 3015-bump  thru 3015-exit
 14075           end-if
 14076
 14077* EXEC CICS REWRITE
 14078*             DATASET   ('ELCRTT')
 14079*             FROM      (CERTIFICATE-TRAILERS)
 14080*          END-EXEC
 14081     MOVE LENGTH OF
 14082      CERTIFICATE-TRAILERS
 14083       TO DFHEIV11
 14084     MOVE 'ELCRTT' TO DFHEIV1
 14085*    MOVE '&& L                  %   #00012022' TO DFHEIV0
 14086     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14087     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14088     MOVE X'2020233030303132303232' TO DFHEIV0(25:11)
 14089     CALL 'kxdfhei1' USING DFHEIV0,
 14090           DFHEIV1,
 14091           CERTIFICATE-TRAILERS,
 14092           DFHEIV11,
 14093           DFHEIV99
 14094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14095        end-if
 14096     end-if
 14097     .
 14098 3010-CERT-NOT-FOUND.
 14099
 14100
 14101* EXEC CICS DELETE
 14102*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 263
* EL131.cbl
 14103*    END-EXEC.
 14104*    MOVE '&(                    &   #00012031' TO DFHEIV0
 14105     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14106     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14107     MOVE X'2020233030303132303331' TO DFHEIV0(25:11)
 14108     CALL 'kxdfhei1' USING DFHEIV0,
 14109           CLMS-FILE-ID,
 14110           DFHEIV99,
 14111           DFHEIV99,
 14112           DFHEIV99,
 14113           DFHEIV99
 14114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14115
 14116
 14117 3010-EXIT.
 14118      EXIT.
 14119
 14120 3015-bump.
 14121     perform varying s2 from s2 by +1 until s2 > +24
 14122        move cs-mb-claim-data (s2)
 14123                                 to cs-mb-claim-data (s1)
 14124        move spaces              to cs-mb-claim-data (s2)
 14125        add +1 to s1
 14126     end-perform
 14127     .
 14128 3015-exit.
 14129     exit.
 14130 3020-UPDATE-CERT.
 14131
 14132* EXEC CICS READ UPDATE
 14133*         DATASET  (CERT-FILE-ID)
 14134*         RIDFLD   (CERT-KEY)
 14135*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14136*    END-EXEC.
 14137*    MOVE '&"S        EU         (   #00012049' TO DFHEIV0
 14138     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14139     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14140     MOVE X'2020233030303132303439' TO DFHEIV0(25:11)
 14141     CALL 'kxdfhei1' USING DFHEIV0,
 14142           CERT-FILE-ID,
 14143           DFHEIV20,
 14144           DFHEIV99,
 14145           CERT-KEY,
 14146           DFHEIV99,
 14147           DFHEIV99,
 14148           DFHEIV99
 14149     SET ADDRESS OF CERTIFICATE-MASTER TO
 14150         DFHEIV20
 14151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14152
 14153
 14154     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 14155
 14156
 14157* EXEC CICS HANDLE CONDITION
 14158*         DUPKEY   (3020-EXIT)
 14159*    END-EXEC.
 14160*    MOVE '"$$                   ! @ #00012057' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 264
* EL131.cbl
 14161     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 14162     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14163     MOVE X'4020233030303132303537' TO DFHEIV0(25:11)
 14164     CALL 'kxdfhei1' USING DFHEIV0
 14165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14166
 14167
 14168
 14169* EXEC CICS REWRITE
 14170*         DATASET  (CERT-FILE-ID)
 14171*         FROM     (CERTIFICATE-MASTER)
 14172*    END-EXEC.
 14173     MOVE LENGTH OF
 14174      CERTIFICATE-MASTER
 14175       TO DFHEIV11
 14176*    MOVE '&& L                  %   #00012061' TO DFHEIV0
 14177     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14178     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14179     MOVE X'2020233030303132303631' TO DFHEIV0(25:11)
 14180     CALL 'kxdfhei1' USING DFHEIV0,
 14181           CERT-FILE-ID,
 14182           CERTIFICATE-MASTER,
 14183           DFHEIV11,
 14184           DFHEIV99
 14185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14186
 14187
 14188 3020-EXIT.
 14189     EXIT.
 14190
 14191 3030-DELETE-CERT.
 14192
 14193* EXEC CICS READ UPDATE
 14194*         DATASET  (CERT-FILE-ID)
 14195*         RIDFLD   (CERT-KEY)
 14196*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14197*    END-EXEC.
 14198*    MOVE '&"S        EU         (   #00012070' TO DFHEIV0
 14199     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14200     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14201     MOVE X'2020233030303132303730' TO DFHEIV0(25:11)
 14202     CALL 'kxdfhei1' USING DFHEIV0,
 14203           CERT-FILE-ID,
 14204           DFHEIV20,
 14205           DFHEIV99,
 14206           CERT-KEY,
 14207           DFHEIV99,
 14208           DFHEIV99,
 14209           DFHEIV99
 14210     SET ADDRESS OF CERTIFICATE-MASTER TO
 14211         DFHEIV20
 14212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14213
 14214
 14215
 14216* EXEC CICS DELETE
 14217*         DATASET   (CERT-FILE-ID)
 14218*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 265
* EL131.cbl
 14219*    MOVE '&(                    &   #00012076' TO DFHEIV0
 14220     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14221     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14222     MOVE X'2020233030303132303736' TO DFHEIV0(25:11)
 14223     CALL 'kxdfhei1' USING DFHEIV0,
 14224           CERT-FILE-ID,
 14225           DFHEIV99,
 14226           DFHEIV99,
 14227           DFHEIV99,
 14228           DFHEIV99
 14229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14230
 14231
 14232 3030-EXIT.
 14233     EXIT.
 14234
 14235 3040-DELETE-TRLR.
 14236
 14237* EXEC CICS READ
 14238*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14239*         DATASET  (TRLR-FILE-ID)
 14240*         RIDFLD   (TRLR-KEY)
 14241*         GTEQ
 14242*    END-EXEC.
 14243*    MOVE '&"S        G          (   #00012084' TO DFHEIV0
 14244     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14245     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14246     MOVE X'2020233030303132303834' TO DFHEIV0(25:11)
 14247     CALL 'kxdfhei1' USING DFHEIV0,
 14248           TRLR-FILE-ID,
 14249           DFHEIV20,
 14250           DFHEIV99,
 14251           TRLR-KEY,
 14252           DFHEIV99,
 14253           DFHEIV99,
 14254           DFHEIV99
 14255     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14256         DFHEIV20
 14257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14258
 14259
 14260     IF PI-COMPANY-CD = AT-COMPANY-CD
 14261        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 14262        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14263           GO TO 3040-EXIT
 14264        ELSE
 14265           NEXT SENTENCE
 14266     ELSE
 14267        GO TO 3040-EXIT.
 14268
 14269
 14270* EXEC CICS DELETE
 14271*         DATASET  (TRLR-FILE-ID)
 14272*         RIDFLD   (TRLR-KEY)
 14273*    END-EXEC.
 14274*    MOVE '&(  R                 &   #00012100' TO DFHEIV0
 14275     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14276     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 266
* EL131.cbl
 14277     MOVE X'2020233030303132313030' TO DFHEIV0(25:11)
 14278     CALL 'kxdfhei1' USING DFHEIV0,
 14279           TRLR-FILE-ID,
 14280           TRLR-KEY,
 14281           DFHEIV99,
 14282           DFHEIV99,
 14283           DFHEIV99
 14284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14285
 14286
 14287     GO TO 3040-DELETE-TRLR.
 14288
 14289 3040-EXIT.
 14290     EXIT.
 14291
 14292 3050-DELETE-ACTQ.
 14293
 14294* EXEC CICS READNEXT
 14295*         DATASET  (ACTQ-FILE-ID)
 14296*         RIDFLD   (ACTQ-KEY)
 14297*         INTO     (ACTIVITY-QUE)
 14298*    END-EXEC.
 14299     MOVE LENGTH OF
 14300      ACTIVITY-QUE
 14301       TO DFHEIV12
 14302     MOVE 0
 14303       TO DFHEIV11
 14304*    MOVE '&.IL                  )   #00012111' TO DFHEIV0
 14305     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14306     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14307     MOVE X'2020233030303132313131' TO DFHEIV0(25:11)
 14308     CALL 'kxdfhei1' USING DFHEIV0,
 14309           ACTQ-FILE-ID,
 14310           ACTIVITY-QUE,
 14311           DFHEIV12,
 14312           ACTQ-KEY,
 14313           DFHEIV99,
 14314           DFHEIV11,
 14315           DFHEIV99,
 14316           DFHEIV99
 14317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14318
 14319
 14320     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 14321         GO TO 3050-EXIT.
 14322
 14323
 14324* EXEC CICS ENDBR
 14325*         DATASET  (ACTQ-FILE-ID)
 14326*    END-EXEC.
 14327     MOVE 0
 14328       TO DFHEIV11
 14329*    MOVE '&2                    $   #00012120' TO DFHEIV0
 14330     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14331     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14332     MOVE X'2020233030303132313230' TO DFHEIV0(25:11)
 14333     CALL 'kxdfhei1' USING DFHEIV0,
 14334           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 267
* EL131.cbl
 14335           DFHEIV11,
 14336           DFHEIV99
 14337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14338
 14339
 14340
 14341* EXEC CICS DELETE
 14342*         DATASET   (ACTQ-FILE-ID)
 14343*         RIDFLD    (ACTQ-KEY)
 14344*    END-EXEC.
 14345*    MOVE '&(  R                 &   #00012124' TO DFHEIV0
 14346     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14347     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14348     MOVE X'2020233030303132313234' TO DFHEIV0(25:11)
 14349     CALL 'kxdfhei1' USING DFHEIV0,
 14350           ACTQ-FILE-ID,
 14351           ACTQ-KEY,
 14352           DFHEIV99,
 14353           DFHEIV99,
 14354           DFHEIV99
 14355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14356
 14357
 14358
 14359* EXEC CICS STARTBR
 14360*         DATASET   (ACTQ-FILE-ID)
 14361*         RIDFLD    (ACTQ-KEY)
 14362*    END-EXEC.
 14363     MOVE 0
 14364       TO DFHEIV11
 14365*    MOVE '&,         G          &   #00012129' TO DFHEIV0
 14366     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14367     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14368     MOVE X'2020233030303132313239' TO DFHEIV0(25:11)
 14369     CALL 'kxdfhei1' USING DFHEIV0,
 14370           ACTQ-FILE-ID,
 14371           ACTQ-KEY,
 14372           DFHEIV99,
 14373           DFHEIV11,
 14374           DFHEIV99
 14375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14376
 14377
 14378     GO TO 3050-DELETE-ACTQ.
 14379
 14380 3050-EXIT.
 14381     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 268
* EL131.cbl
 14383 3060-READ-TRLR.
 14384
 14385* EXEC CICS HANDLE CONDITION
 14386*         NOTFND    (3060-EXIT)
 14387*         ENDFILE   (3060-EXIT)
 14388*    END-EXEC.
 14389*    MOVE '"$I''                  ! A #00012140' TO DFHEIV0
 14390     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14391     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14392     MOVE X'4120233030303132313430' TO DFHEIV0(25:11)
 14393     CALL 'kxdfhei1' USING DFHEIV0
 14394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14395
 14396
 14397 3060-LOOP.
 14398
 14399* EXEC CICS READNEXT
 14400*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14401*         DATASET  (TRLR-FILE-ID)
 14402*         RIDFLD   (TRLR-KEY)
 14403*    END-EXEC.
 14404     MOVE 0
 14405       TO DFHEIV11
 14406*    MOVE '&.S                   )   #00012146' TO DFHEIV0
 14407     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14408     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14409     MOVE X'2020233030303132313436' TO DFHEIV0(25:11)
 14410     CALL 'kxdfhei1' USING DFHEIV0,
 14411           TRLR-FILE-ID,
 14412           DFHEIV20,
 14413           DFHEIV99,
 14414           TRLR-KEY,
 14415           DFHEIV99,
 14416           DFHEIV11,
 14417           DFHEIV99,
 14418           DFHEIV99
 14419     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14420         DFHEIV20
 14421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14422
 14423
 14424     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14425         GO TO 3060-EXIT.
 14426
 14427     IF FORM-CONTROL-TR
 14428         IF AT-RECORDED-DT = SAVE-BIN-DATE
 14429             NEXT SENTENCE
 14430         ELSE
 14431             MOVE 'X'            TO ERROR-SWITCH
 14432             GO TO 3060-EXIT
 14433     ELSE
 14434         IF PAYMENT-TR OR CORRESPONDENCE-TR
 14435            MOVE 'X'                 TO ERROR-SWITCH
 14436            GO TO 3060-EXIT.
 14437
 14438     GO TO 3060-LOOP.
 14439
 14440 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 269
* EL131.cbl
 14441     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 270
* EL131.cbl
 14443 3997-GET-ERPDEF.
 14444
 14445     move cl-company-cd          to cert-company-code
 14446     move cl-cert-key-data       to cert-key (2:21)
 14447     move cl-cert-no             to cert-cert
 14448
 14449
 14450* EXEC CICS READ
 14451*        DATASET   (CERT-FILE-ID)
 14452*        RIDFLD    (CERT-KEY)
 14453*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14454*        resp      (ws-response)
 14455*    END-EXEC
 14456*    MOVE '&"S        E          (  N#00012177' TO DFHEIV0
 14457     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14458     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14459     MOVE X'204E233030303132313737' TO DFHEIV0(25:11)
 14460     CALL 'kxdfhei1' USING DFHEIV0,
 14461           CERT-FILE-ID,
 14462           DFHEIV20,
 14463           DFHEIV99,
 14464           CERT-KEY,
 14465           DFHEIV99,
 14466           DFHEIV99,
 14467           DFHEIV99
 14468     SET ADDRESS OF CERTIFICATE-MASTER TO
 14469         DFHEIV20
 14470     MOVE EIBRESP  TO ws-response
 14471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14472
 14473     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 14474                                    WS-ERPDEF-SW
 14475     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 14476                                    WS-CRIT-PER-RTW-MOS
 14477
 14478     if cm-clp-state = spaces or low-values or zeros
 14479        move cm-state            to cm-clp-state
 14480     end-if
 14481     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 14482     MOVE CM-clp-state           TO ERPDEF-STATE
 14483     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 14484     evaluate true
 14485        when (cl-claim-type = 'L' or 'P')
 14486           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14487             and 'CU')
 14488           move 'L'              to erpdef-ben-type
 14489           move cm-lf-benefit-cd to erpdef-ben-code
 14490        when (cl-claim-type not = 'L' and 'P')
 14491           and (cm-ah-benefit-cd not = '00' and '  ')
 14492           move 'A'              to erpdef-ben-type
 14493           move cm-ah-benefit-cd to erpdef-ben-code
 14494        when (cl-claim-type not = 'L' and 'P')
 14495           and (cm-ah-benefit-cd = '00' or '  ')
 14496           move 'L'              to erpdef-ben-type
 14497           move cm-lf-benefit-cd to erpdef-ben-code
 14498        when (cl-claim-type = 'L' or 'P')
 14499           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 14500           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 271
* EL131.cbl
 14501           move cm-ah-benefit-cd to erpdef-ben-code
 14502        when other
 14503           move 'A'              to erpdef-ben-type
 14504           move cm-ah-benefit-cd to erpdef-ben-code
 14505     end-evaluate
 14506
 14507*    if (cl-claim-type = 'L' or 'P')
 14508*       and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14509*          and 'CU')
 14510*       move 'L'                 to erpdef-ben-type
 14511*       move cm-lf-benefit-cd    to erpdef-ben-code
 14512*    else
 14513*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
 14514*       MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 14515*    end-if
 14516     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 14517     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 14518
 14519
 14520* EXEC CICS STARTBR
 14521*        DATASET  ('ERPDEF')
 14522*        RIDFLD   (ERPDEF-KEY)
 14523*        GTEQ
 14524*        RESP     (WS-RESPONSE)
 14525*    END-EXEC
 14526     MOVE 'ERPDEF' TO DFHEIV1
 14527     MOVE 0
 14528       TO DFHEIV11
 14529*    MOVE '&,         G          &  N#00012230' TO DFHEIV0
 14530     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14531     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14532     MOVE X'204E233030303132323330' TO DFHEIV0(25:11)
 14533     CALL 'kxdfhei1' USING DFHEIV0,
 14534           DFHEIV1,
 14535           ERPDEF-KEY,
 14536           DFHEIV99,
 14537           DFHEIV11,
 14538           DFHEIV99
 14539     MOVE EIBRESP  TO WS-RESPONSE
 14540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14541
 14542     IF WS-RESP-NORMAL
 14543
 14544* EXEC CICS READNEXT
 14545*          DATASET  ('ERPDEF')
 14546*          INTO     (PRODUCT-MASTER)
 14547*          RIDFLD   (ERPDEF-KEY)
 14548*          RESP     (WS-RESPONSE)
 14549*       END-EXEC
 14550     MOVE LENGTH OF
 14551      PRODUCT-MASTER
 14552       TO DFHEIV12
 14553     MOVE 'ERPDEF' TO DFHEIV1
 14554     MOVE 0
 14555       TO DFHEIV11
 14556*    MOVE '&.IL                  )  N#00012238' TO DFHEIV0
 14557     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14558     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 272
* EL131.cbl
 14559     MOVE X'204E233030303132323338' TO DFHEIV0(25:11)
 14560     CALL 'kxdfhei1' USING DFHEIV0,
 14561           DFHEIV1,
 14562           PRODUCT-MASTER,
 14563           DFHEIV12,
 14564           ERPDEF-KEY,
 14565           DFHEIV99,
 14566           DFHEIV11,
 14567           DFHEIV99,
 14568           DFHEIV99
 14569     MOVE EIBRESP  TO WS-RESPONSE
 14570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14571        IF WS-RESP-NORMAL
 14572           IF (ERPDEF-KEY-SAVE (1:16) =
 14573              PD-CONTROL-PRIMARY (1:16))
 14574              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 14575              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 14576                 (A1 > +8)
 14577                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 14578              END-PERFORM
 14579              IF A1 < +9
 14580                 SET ERPDEF-FOUND TO TRUE
 14581                 MOVE PD-CRIT-PERIOD (A1)
 14582                              TO WS-CRITICAL-PERIOD
 14583                 MOVE PD-REC-CRIT-PERIOD (A1)
 14584                              TO WS-CRIT-PER-RECURRENT
 14585                 IF PD-RTW-MOS (A1) NUMERIC
 14586                    MOVE PD-RTW-MOS (A1)
 14587                              TO WS-CRIT-PER-RTW-MOS
 14588                 ELSE
 14589                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 14590                 END-IF
 14591                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 14592                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 14593                                 TO WS-EXCL-PERIOD
 14594                 END-IF
 14595                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 14596                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 14597                                 TO WS-COV-ENDS
 14598                 END-IF
 14599                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 14600                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 14601                                 TO WS-ACC-PERIOD
 14602                 END-IF
 14603                 if pd-max-extension (a1) numeric
 14604                    move pd-max-extension (a1)
 14605                                 to ws-max-extension
 14606                 end-if
 14607                 if pd-max-amt (a1) numeric
 14608                    move pd-max-amt (a1)
 14609                                 to ws-max-moben
 14610                 end-if
 14611              END-IF
 14612           END-IF
 14613        END-IF
 14614     END-IF
 14615
 14616     .
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 273
* EL131.cbl
 14617 3997-EXIT.
 14618     EXIT.
 14619 4000-FORCE-ERRORS.
 14620     IF PI-RETURN-CD-1 = 'X'
 14621         MOVE ER-0311            TO EMI-ERROR
 14622         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14623         MOVE -1                 TO MAINTL
 14624         GO TO 8110-SEND-DATA.
 14625
 14626     IF NOT FORCE-CAP
 14627         MOVE ER-0416            TO EMI-ERROR
 14628         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14629         MOVE -1                 TO MAINTL
 14630         GO TO 8110-SEND-DATA.
 14631
 14632     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14633     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14634     IF EMI-FATAL-CTR GREATER THAN ZERO
 14635         GO TO 4000-FATAL-ERRORS.
 14636
 14637     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14638
 14639     IF EMI-FATAL-CTR GREATER THAN ZERO
 14640         GO TO 4000-FATAL-ERRORS.
 14641
 14642     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14643
 14644     IF EMI-FATAL-CTR GREATER THAN ZERO
 14645         GO TO 4000-FATAL-ERRORS.
 14646
 14647     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14648     MOVE AL-UANOF               TO CERTA.
 14649     MOVE ER-0000 TO EMI-ERROR.
 14650     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14651
 14652 4000-FATAL-ERRORS.
 14653     MOVE -1                     TO MAINTL.
 14654     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 274
* EL131.cbl
 14656
 14657 4100-SAVE-CHANGES.
 14658     IF MAINTL > 0
 14659         MOVE MAINTI  TO WS-SAVE-MAINTI
 14660         MOVE MAINTL  TO WS-SAVE-MAINTL
 14661     END-IF
 14662     IF STATUSL > 0
 14663         MOVE STATUSI  TO WS-SAVE-STATUSI
 14664         MOVE STATUSL  TO WS-SAVE-STATUSL
 14665     END-IF
 14666     IF REPL > 0
 14667         MOVE REPI  TO WS-SAVE-REPI
 14668         MOVE REPL  TO WS-SAVE-REPL
 14669     END-IF
 14670*    IF CAUSEL > 0
 14671*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14672*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14673*    END-IF
 14674*    IF ENDL > 0
 14675*        MOVE ENDI  TO WS-SAVE-ENDI
 14676*        MOVE ENDL  TO WS-SAVE-ENDL
 14677*    END-IF
 14678     IF DIAGL > 0
 14679         MOVE DIAGI  TO WS-SAVE-DIAGI
 14680         MOVE DIAGL  TO WS-SAVE-DIAGL
 14681     END-IF
 14682     IF ICD1L > 0
 14683         MOVE ICD1I  TO WS-SAVE-ICD1I
 14684         MOVE ICD1L  TO WS-SAVE-ICD1L
 14685     END-IF
 14686     IF ICD2L > 0
 14687         MOVE ICD2I  TO WS-SAVE-ICD2I
 14688         MOVE ICD2L  TO WS-SAVE-ICD2L
 14689     END-IF
 14690     IF BENEL > 0
 14691         MOVE BENEI  TO WS-SAVE-BENEI
 14692         MOVE BENEL  TO WS-SAVE-BENEL
 14693     END-IF
 14694     IF BIRTHL > 0
 14695         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14696         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14697     END-IF
 14698     IF SOCIALL > 0
 14699         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14700         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14701     END-IF
 14702     IF SEXL > 0
 14703         MOVE SEXI  TO WS-SAVE-SEXI
 14704         MOVE SEXL  TO WS-SAVE-SEXL
 14705     END-IF
 14706     IF MLNAMEL > 0
 14707         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14708         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14709     END-IF
 14710     IF MFNAMEL > 0
 14711         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14712         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14713     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 275
* EL131.cbl
 14714     IF MMINITL > 0
 14715         MOVE MMINITI  TO WS-SAVE-MMINITI
 14716         MOVE MMINITL  TO WS-SAVE-MMINITL
 14717     END-IF
 14718*    IF LOANNOL > 0
 14719*        MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14720*        MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14721*    END-IF
 14722     IF LOANBALL > 0
 14723         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14724         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14725     END-IF
 14726     IF PROCL > 0
 14727         MOVE PROCI  TO WS-SAVE-PROCI
 14728         MOVE PROCL  TO WS-SAVE-PROCL
 14729     END-IF
 14730     IF SUPVL > 0
 14731         MOVE SUPVI  TO WS-SAVE-SUPVI
 14732         MOVE SUPVL  TO WS-SAVE-SUPVL
 14733     END-IF
 14734     IF PRICDL > 0
 14735         MOVE PRICDI  TO WS-SAVE-PRICDI
 14736         MOVE PRICDL  TO WS-SAVE-PRICDL
 14737     END-IF
 14738     IF FILETOL > 0
 14739         MOVE FILETOI  TO WS-SAVE-FILETOI
 14740         MOVE FILETOL  TO WS-SAVE-FILETOL
 14741     END-IF
 14742     IF PDTHRUL > 0
 14743         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14744         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14745     END-IF
 14746     IF PDAMTL > 0
 14747         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14748         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14749     END-IF
 14750     IF NODAYSL > 0
 14751         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14752         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14753     END-IF
 14754     IF NOPMTSL > 0
 14755         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14756         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14757     END-IF
 14758     IF FORMTYPL > 0
 14759         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14760         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14761     END-IF
 14762     IF OCCL > 0
 14763         MOVE OCCI  TO WS-SAVE-OCCI
 14764         MOVE OCCL  TO WS-SAVE-OCCL
 14765     END-IF.
 14766 4100-EXIT.
 14767      EXIT.
 14768
 14769 4200-LOAD-CHANGES.
 14770     IF WS-SAVE-MAINTL > 0
 14771         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 276
* EL131.cbl
 14772         MOVE WS-SAVE-MAINTL  TO MAINTL
 14773         MOVE AL-UANON        TO MAINTA
 14774     END-IF
 14775     IF WS-SAVE-STATUSL > 0
 14776         MOVE WS-SAVE-STATUSI  TO STATUSI
 14777         MOVE WS-SAVE-STATUSL  TO STATUSL
 14778         MOVE AL-UANON         TO STATUSA
 14779     END-IF
 14780     IF WS-SAVE-REPL > 0
 14781         MOVE WS-SAVE-REPI  TO REPI
 14782         MOVE WS-SAVE-REPL  TO REPL
 14783         MOVE AL-UANON      TO REPA
 14784     END-IF
 14785*    IF WS-SAVE-CAUSEL > 0
 14786*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 14787*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 14788*        MOVE AL-UANON        TO CAUSEA
 14789*    END-IF
 14790*    IF WS-SAVE-ENDL > 0
 14791*        MOVE WS-SAVE-ENDI  TO ENDI
 14792*        MOVE WS-SAVE-ENDL  TO ENDL
 14793*        MOVE AL-UANON      TO ENDA
 14794*    END-IF
 14795     IF WS-SAVE-DIAGL > 0
 14796         MOVE WS-SAVE-DIAGI  TO DIAGI
 14797         MOVE WS-SAVE-DIAGL  TO DIAGL
 14798         MOVE AL-UANON       TO DIAGA
 14799     END-IF
 14800     IF WS-SAVE-ICD1L > 0
 14801         MOVE WS-SAVE-ICD1I  TO ICD1I
 14802         MOVE WS-SAVE-ICD1L  TO ICD1L
 14803         MOVE AL-UANON       TO ICD1A
 14804     END-IF
 14805     IF WS-SAVE-ICD2L > 0
 14806         MOVE WS-SAVE-ICD2I  TO ICD2I
 14807         MOVE WS-SAVE-ICD2L  TO ICD2L
 14808         MOVE AL-UANON       TO ICD2A
 14809     END-IF
 14810     IF WS-SAVE-BENEL > 0
 14811         MOVE WS-SAVE-BENEI  TO BENEI
 14812         MOVE WS-SAVE-BENEL  TO BENEL
 14813         MOVE AL-UANON       TO BENEA
 14814     END-IF
 14815     IF WS-SAVE-BIRTHL > 0
 14816         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 14817         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 14818         MOVE AL-UANON        TO BIRTHA
 14819     END-IF
 14820     IF WS-SAVE-SOCIALL > 0
 14821         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 14822         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 14823         MOVE AL-UANON         TO SOCIALA
 14824     END-IF
 14825     IF WS-SAVE-SEXL > 0
 14826         MOVE WS-SAVE-SEXI  TO SEXI
 14827         MOVE WS-SAVE-SEXL  TO SEXL
 14828         MOVE AL-UANON      TO SEXA
 14829     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 277
* EL131.cbl
 14830     IF WS-SAVE-MLNAMEL > 0
 14831         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 14832         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 14833         MOVE AL-UANON         TO MLNAMEA
 14834     END-IF
 14835     IF WS-SAVE-MFNAMEL > 0
 14836         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 14837         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 14838         MOVE AL-UANON         TO MFNAMEA
 14839     END-IF
 14840     IF WS-SAVE-MMINITL > 0
 14841         MOVE WS-SAVE-MMINITI  TO MMINITI
 14842         MOVE WS-SAVE-MMINITL  TO MMINITL
 14843         MOVE AL-UANON         TO MMINITA
 14844     END-IF
 14845*    IF WS-SAVE-LOANNOL > 0
 14846*        MOVE WS-SAVE-LOANNOI  TO LOANNOI
 14847*        MOVE WS-SAVE-LOANNOL  TO LOANNOL
 14848*        MOVE AL-UANON         TO LOANNOA
 14849*    END-IF
 14850     IF WS-SAVE-LOANBALL > 0
 14851         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 14852         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 14853         MOVE AL-UANON          TO LOANBALA
 14854     END-IF
 14855     IF WS-SAVE-PROCL > 0
 14856         MOVE WS-SAVE-PROCI  TO PROCI
 14857         MOVE WS-SAVE-PROCL  TO PROCL
 14858         MOVE AL-UANON       TO PROCA
 14859     END-IF
 14860     IF WS-SAVE-SUPVL > 0
 14861         MOVE WS-SAVE-SUPVI  TO SUPVI
 14862         MOVE WS-SAVE-SUPVL  TO SUPVL
 14863         MOVE AL-UANON       TO SUPVA
 14864     END-IF
 14865     IF WS-SAVE-PRICDL > 0
 14866         MOVE WS-SAVE-PRICDI  TO PRICDI
 14867         MOVE WS-SAVE-PRICDL  TO PRICDL
 14868         MOVE AL-UANON        TO PRICDA
 14869     END-IF
 14870     IF WS-SAVE-FILETOL > 0
 14871         MOVE WS-SAVE-FILETOI  TO FILETOI
 14872         MOVE WS-SAVE-FILETOL  TO FILETOL
 14873         MOVE AL-UANON         TO FILETOA
 14874     END-IF
 14875     IF WS-SAVE-PDTHRUL > 0
 14876         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 14877         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 14878         MOVE AL-UANON         TO PDTHRUA
 14879     END-IF
 14880     IF WS-SAVE-PDAMTL > 0
 14881         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 14882         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 14883         MOVE AL-UANON        TO PDAMTA
 14884     END-IF
 14885     IF WS-SAVE-NODAYSL > 0
 14886         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 14887         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 278
* EL131.cbl
 14888         MOVE AL-UANON         TO NODAYSA
 14889     END-IF
 14890     IF WS-SAVE-NOPMTSL > 0
 14891         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 14892         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 14893         MOVE AL-UANON         TO NOPMTSA
 14894     END-IF
 14895     IF WS-SAVE-FORMTYPL > 0
 14896         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 14897         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 14898         MOVE AL-UANON          TO FORMTYPA
 14899     END-IF
 14900     IF WS-SAVE-OCCL > 0
 14901         MOVE WS-SAVE-OCCI  TO OCCI
 14902         MOVE WS-SAVE-OCCL  TO OCCL
 14903         MOVE AL-UANON      TO OCCA
 14904     END-IF.
 14905 4200-EXIT.
 14906      EXIT.
 14907
 14908 5000-BUILD-MAP.
 14909     IF PI-RETURN-CD-1 = SPACE
 14910         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 14911
 14912     MOVE SPACE                  TO PI-RETURN-CD-1.
 14913
 14914     MOVE LOW-VALUES             TO EL131AI.
 14915
 14916     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 14917     MOVE PI-CARRIER             TO CARRIER-CODE.
 14918     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 14919     MOVE PI-CERT-NO             TO CERT-NO.
 14920
 14921 5000-READ-CLAIM-MASTER.
 14922
 14923
 14924* EXEC CICS READ
 14925*         SET      (ADDRESS OF CLAIM-MASTER)
 14926*         DATASET  (CLMS-FILE-ID)
 14927*         RIDFLD   (MSTR-KEY)
 14928*    END-EXEC.
 14929*    MOVE '&"S        E          (   #00012596' TO DFHEIV0
 14930     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14931     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14932     MOVE X'2020233030303132353936' TO DFHEIV0(25:11)
 14933     CALL 'kxdfhei1' USING DFHEIV0,
 14934           CLMS-FILE-ID,
 14935           DFHEIV20,
 14936           DFHEIV99,
 14937           MSTR-KEY,
 14938           DFHEIV99,
 14939           DFHEIV99,
 14940           DFHEIV99
 14941     SET ADDRESS OF CLAIM-MASTER TO
 14942         DFHEIV20
 14943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14944
 14945
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 279
* EL131.cbl
 14946     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 14947
 14948 5000-READ-DIAGNOSIS-TRAILER.
 14949
 14950
 14951* EXEC CICS HANDLE CONDITION
 14952*         NOTFND (5000-TRLR-NOT-FOUND)
 14953*    END-EXEC.
 14954*    MOVE '"$I                   ! B #00012606' TO DFHEIV0
 14955     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14957     MOVE X'4220233030303132363036' TO DFHEIV0(25:11)
 14958     CALL 'kxdfhei1' USING DFHEIV0
 14959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14960
 14961
 14962     MOVE MSTR-KEY               TO TRLR-KEY.
 14963     MOVE NINETY                 TO TRLR-SEQ-NO.
 14964
 14965
 14966* EXEC CICS READ
 14967*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14968*         DATASET  (TRLR-FILE-ID)
 14969*         RIDFLD   (TRLR-KEY)
 14970*    END-EXEC.
 14971*    MOVE '&"S        E          (   #00012613' TO DFHEIV0
 14972     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14973     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14974     MOVE X'2020233030303132363133' TO DFHEIV0(25:11)
 14975     CALL 'kxdfhei1' USING DFHEIV0,
 14976           TRLR-FILE-ID,
 14977           DFHEIV20,
 14978           DFHEIV99,
 14979           TRLR-KEY,
 14980           DFHEIV99,
 14981           DFHEIV99,
 14982           DFHEIV99
 14983     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14984         DFHEIV20
 14985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14986
 14987
 14988     MOVE AT-INFO-LINE-1         TO DIAGO.
 14989     MOVE AT-ICD-CODE-1          TO ICD1O.
 14990     MOVE AT-ICD-CODE-2          TO ICD2O.
 14991
 14992 5000-READ-CERTIFICATE-MASTER.
 14993
 14994     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 14995     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 14996     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 14997     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 14998     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 14999     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 15000     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 15001
 15002
 15003* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 280
* EL131.cbl
 15004*         NOTFND (5000-CERT-NOT-FOUND)
 15005*    END-EXEC.
 15006*    MOVE '"$I                   ! C #00012633' TO DFHEIV0
 15007     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15008     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15009     MOVE X'4320233030303132363333' TO DFHEIV0(25:11)
 15010     CALL 'kxdfhei1' USING DFHEIV0
 15011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15012
 15013
 15014
 15015* EXEC CICS READ
 15016*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 15017*         DATASET  (CERT-FILE-ID)
 15018*         RIDFLD   (CERT-KEY)
 15019*    END-EXEC.
 15020*    MOVE '&"S        E          (   #00012637' TO DFHEIV0
 15021     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15022     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15023     MOVE X'2020233030303132363337' TO DFHEIV0(25:11)
 15024     CALL 'kxdfhei1' USING DFHEIV0,
 15025           CERT-FILE-ID,
 15026           DFHEIV20,
 15027           DFHEIV99,
 15028           CERT-KEY,
 15029           DFHEIV99,
 15030           DFHEIV99,
 15031           DFHEIV99
 15032     SET ADDRESS OF CERTIFICATE-MASTER TO
 15033         DFHEIV20
 15034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15035
 15036
 15037     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 15038     PERFORM 5100-LOAD-CORR-TRLR THRU 5100-EXIT.
 15039     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 15040
 15041     GO TO 5000-EXIT.
 15042
 15043 5000-TRLR-NOT-FOUND.
 15044     MOVE ER-7687                TO EMI-ERROR.
 15045     MOVE -1                     TO DIAGL.
 15046     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15047     GO TO 5000-EXIT.
 15048
 15049 5000-CERT-NOT-FOUND.
 15050     MOVE ER-0206                TO EMI-ERROR.
 15051     MOVE -1                     TO CERTL.
 15052     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15053
 15054 5000-EXIT.
 15055     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 281
* EL131.cbl
 15057 5010-RESET-PI-AREA.
 15058     IF CERTI GREATER THAN LOW-VALUES
 15059         MOVE CERTI              TO PI-CERT-PRIME.
 15060
 15061     IF SUFXI GREATER THAN LOW-VALUES
 15062         MOVE SUFXI              TO PI-CERT-SFX.
 15063
 15064     IF CERTEFFI GREATER THAN LOW-VALUES
 15065         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 15066
 15067     IF CERTACTI GREATER THAN LOW-VALUES
 15068         MOVE CERTACTI           TO PI-ACCOUNT.
 15069
 15070     IF CERTSTI GREATER THAN LOW-VALUES
 15071         MOVE CERTSTI            TO PI-STATE.
 15072
 15073     IF CERTCARI GREATER THAN LOW-VALUES
 15074         MOVE CERTCARI           TO PI-CARRIER.
 15075
 15076     IF CERTGRPI GREATER THAN LOW-VALUES
 15077         MOVE CERTGRPI           TO PI-GROUPING.
 15078
 15079 5010-EXIT.
 15080     EXIT.
 15081
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 282
* EL131.cbl
 15083 5020-MOVE-MSTR.
 15084
 15085     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 15086     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 15087     MOVE WS-CLAIM-SEQU          TO SEQUO.
 15088     MOVE AL-SABON               TO SEQUA.
 15089     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 15090     MOVE CL-CLAIM-TYPE          TO TYPEO
 15091                                    pi-claim-type
 15092
 15093     IF CL-TOTAL-PAID-AMT  = +0 AND
 15094        CL-LAST-PMT-AMT    = +0 AND
 15095        CL-NO-OF-PMTS-MADE = +0
 15096          MOVE AL-UANON          TO TYPEA.
 15097
 15098     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 15099     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 15100     MOVE CL-CERT-PRIME          TO CERTO.
 15101     MOVE CL-CERT-SFX            TO SUFXO.
 15102     MOVE CL-CERT-CARRIER        TO CARRO.
 15103
 15104     IF CL-CLAIM-STATUS = 'C'
 15105         MOVE 'CLOSED'           TO STATUSO
 15106     ELSE
 15107         MOVE 'OPEN  '           TO STATUSO.
 15108
 15109     move cl-accident-claim-sw   to accswo
 15110     if cl-benefit-period not numeric
 15111        move zeros               to cl-benefit-period
 15112     end-if
 15113     move cl-benefit-period      to benpero
 15114     move cl-insured-type        to instypeo
 15115     MOVE CL-PROCESSOR-ID        TO PROCO.
 15116
 15117     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 15118     MOVE CL-CCN                 TO CCNOO.
 15119
 15120     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 15121     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 15122     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 15123     MOVE CL-INSURED-SEX-CD      TO SEXO.
 15124
 15125     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 15126         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 15127         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15128         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15129         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 15130     ELSE
 15131         MOVE SPACES             TO BIRTHO.
 15132
 15133     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 15134        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 15135         NEXT SENTENCE
 15136       ELSE
 15137         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 15138
 15139     IF PI-COMPANY-ID = 'DMD'
 15140       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 283
* EL131.cbl
 15141          IF SOCIALO = SPACES OR LOW-VALUES
 15142            MOVE ER-0885         TO EMI-ERROR
 15143            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15144
 15145     MOVE CL-INSURED-OCC-CD      TO OCCO.
 15146*    MOVE CL-CAUSE-CD            TO CAUSEO.
 15147
 15148*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 15149*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 15150*        MOVE SPACES                 TO DC-OPTION-CODE
 15151*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15152*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 15153*    ELSE
 15154*        MOVE SPACES             TO ENDO.
 15155
 15156     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 15157        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15158        MOVE SPACES             TO DC-OPTION-CODE
 15159        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15160        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15161        IF PI-USES-PAID-TO
 15162           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15163           MOVE '6'                TO DC-OPTION-CODE
 15164           MOVE +1                 TO DC-ELAPSED-DAYS
 15165           MOVE +0                 TO DC-ELAPSED-MONTHS
 15166           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15167           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15168        ELSE
 15169           NEXT SENTENCE
 15170     ELSE
 15171        MOVE SPACES             TO PDTHRUO.
 15172
 15173     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 15174     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 15175     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 15176     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 15177
 15178     IF MODIFY-CAP
 15179        MOVE AL-UNNOF            TO PDAMTA
 15180                                    NODAYSA
 15181                                    NOPMTSA
 15182        MOVE AL-UANOF            TO PDTHRUA.
 15183     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 15184     MOVE '2'                    TO CNTL-REC-TYPE
 15185     MOVE +0                     TO CNTL-SEQ-NO
 15186     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 15187
 15188
 15189* EXEC CICS READ
 15190*         DATASET  (CNTL-FILE-ID)
 15191*         SET      (ADDRESS OF CONTROL-FILE)
 15192*         RIDFLD   (CNTL-KEY)
 15193*         RESP     (WS-RESPONSE)
 15194*    END-EXEC
 15195*    MOVE '&"S        E          (  N#00012794' TO DFHEIV0
 15196     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15197     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15198     MOVE X'204E233030303132373934' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 284
* EL131.cbl
 15199     CALL 'kxdfhei1' USING DFHEIV0,
 15200           CNTL-FILE-ID,
 15201           DFHEIV20,
 15202           DFHEIV99,
 15203           CNTL-KEY,
 15204           DFHEIV99,
 15205           DFHEIV99,
 15206           DFHEIV99
 15207     SET ADDRESS OF CONTROL-FILE TO
 15208         DFHEIV20
 15209     MOVE EIBRESP  TO WS-RESPONSE
 15210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15211
 15212     IF WS-RESP-NORMAL
 15213        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 15214     end-if
 15215     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 15216         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 15217         MOVE SPACES             TO DC-OPTION-CODE
 15218         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15219         MOVE DC-GREG-DATE-1-EDIT TO INCO
 15220     ELSE
 15221         MOVE SPACES             TO INCO.
 15222
 15223     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 15224        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 15225        MOVE AL-UANOF            TO INCA
 15226     end-if
 15227     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 15228
 15229     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 15230         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 15231         MOVE SPACES             TO DC-OPTION-CODE
 15232         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15233         MOVE DC-GREG-DATE-1-EDIT TO REPO
 15234     ELSE
 15235         MOVE SPACES             TO REPO.
 15236
 15237     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 15238         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 15239         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15240         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15241         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 15242     ELSE
 15243         MOVE SPACES             TO ESTO.
 15244
 15245     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 15246         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 15247         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15248         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15249         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 15250     ELSE
 15251         MOVE SPACES             TO MNTDTO.
 15252
 15253
 15254     IF CL-LAST-MAINT-TYPE = SPACE
 15255         MOVE 'SET-UP'           TO MNTTYPEO
 15256     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 285
* EL131.cbl
 15257     IF CL-LAST-MAINT-TYPE = '1'
 15258         MOVE 'PAYMNT'           TO MNTTYPEO
 15259     ELSE
 15260     IF CL-LAST-MAINT-TYPE = '2'
 15261         MOVE 'LETTER'           TO MNTTYPEO
 15262     ELSE
 15263     IF CL-LAST-MAINT-TYPE = '3'
 15264         MOVE 'UPDATE'           TO MNTTYPEO
 15265     ELSE
 15266     IF CL-LAST-MAINT-TYPE = '4'
 15267         MOVE 'RESTOR'           TO MNTTYPEO
 15268     ELSE
 15269     IF CL-LAST-MAINT-TYPE = '5'
 15270         MOVE 'INC DT'           TO MNTTYPEO
 15271     ELSE
 15272     IF CL-LAST-MAINT-TYPE = '6'
 15273         MOVE ' CONV'            TO MNTTYPEO
 15274     ELSE
 15275     IF CL-LAST-MAINT-TYPE = 'C'
 15276         MOVE 'CHGBEN'           TO MNTTYPEO
 15277     ELSE
 15278     IF CL-LAST-MAINT-TYPE = 'E'
 15279         MOVE 'ERRCOR'           TO MNTTYPEO
 15280     ELSE
 15281         MOVE SPACES             TO MNTTYPEO.
 15282
 15283     MOVE CL-BENEFICIARY         TO BENEO.
 15284     MOVE CL-FILE-LOCATION       TO FILETOO.
 15285     IF CL-CRITICAL-PERIOD NOT NUMERIC
 15286        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 15287     END-IF
 15288     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 15289     IF CL-NO-OF-EXTENSIONS NOT NUMERIC
 15290        MOVE ZEROS               TO CL-NO-OF-EXTENSIONS
 15291     END-IF
 15292     MOVE CL-NO-OF-EXTENSIONS    TO EXTENSO
 15293*    MOVE CL-CRIT-PER-RECURRENT
 15294*                                TO CRITPTO
 15295*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 15296*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 15297*    END-IF
 15298*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 15299     MOVE CL-PRIORITY-CD         TO PRICDO.
 15300     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 15301     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 15302     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 15303     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 15304
 15305 5020-EXIT.
 15306     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 286
* EL131.cbl
 15308 5030-MOVE-CERT.
 15309
 15310     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 15311         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 15312         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15313         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15314         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 15315       ELSE
 15316         MOVE SPACES             TO CERTEFFO
 15317         MOVE ZERO               TO HOLD-DATE.
 15318
 15319     MOVE CM-ACCOUNT             TO CERTACTO.
 15320     MOVE CM-STATE               TO CERTSTO PI-STATE.
 15321     MOVE CM-GROUPING            TO CERTGRPO.
 15322     MOVE CM-CARRIER             TO CERTCARO.
 15323     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 15324     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 15325     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 15326     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 15327     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 15328     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 15329     MOVE CM-JT-INITIAL          TO JNTINITO.
 15330     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 15331
 15332*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 15333     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 15334     MOVE '3'                    TO CNTL-REC-TYPE.
 15335     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 15336     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 15337     MOVE ZERO                   TO CNTL-SEQ-NO.
 15338
 15339
 15340* EXEC CICS READ
 15341*         SET        (ADDRESS OF CONTROL-FILE)
 15342*         DATASET    ('ELCNTL')
 15343*         RIDFLD     (CNTL-KEY)
 15344*         RESP       (WS-RESPONSE)
 15345*    END-EXEC.
 15346     MOVE 'ELCNTL' TO DFHEIV1
 15347*    MOVE '&"S        E          (  N#00012928' TO DFHEIV0
 15348     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15349     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15350     MOVE X'204E233030303132393238' TO DFHEIV0(25:11)
 15351     CALL 'kxdfhei1' USING DFHEIV0,
 15352           DFHEIV1,
 15353           DFHEIV20,
 15354           DFHEIV99,
 15355           CNTL-KEY,
 15356           DFHEIV99,
 15357           DFHEIV99,
 15358           DFHEIV99
 15359     SET ADDRESS OF CONTROL-FILE TO
 15360         DFHEIV20
 15361     MOVE EIBRESP  TO WS-RESPONSE
 15362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15363
 15364
 15365     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 287
* EL131.cbl
 15366        MOVE ZERO                TO CP-FREE-LOOK
 15367     ELSE
 15368        MOVE CF-ST-FREE-LOOK-PERIOD
 15369                                 TO CP-FREE-LOOK.
 15370
 15371     IF CM-LF-BENEFIT-CD = '00'
 15372        GO TO 5030-MOVE-CERT-AH.
 15373
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 288
* EL131.cbl
 15375     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 15376     MOVE '5'                    TO DC-OPTION-CODE
 15377     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15378     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 15379     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15380     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 15381     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 15382     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15383     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15384     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 15385     MOVE '4'                    TO CP-REM-TERM-METHOD
 15386     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 15387     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15388     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15389
 15390     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 15391     IF CM-LF-PREMIUM-RATE NUMERIC
 15392         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 15393     ELSE
 15394         MOVE ZEROS              TO LCVRATEO.
 15395
 15396     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 15397         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 15398
 15399     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 15400
 15401     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 15402
 15403     IF CM-LF-CURRENT-STATUS = '8'
 15404        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 15405            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 15406            MOVE ' '             TO DC-OPTION-CODE
 15407            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15408            IF NOT DATE-CONVERSION-ERROR
 15409                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15410
 15411     IF CM-LF-CURRENT-STATUS = '7'
 15412        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 15413            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 15414            MOVE ' '             TO DC-OPTION-CODE
 15415            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15416            IF NOT DATE-CONVERSION-ERROR
 15417                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15418
 15419     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15420         MOVE ' '                TO DC-OPTION-CODE
 15421         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 15422         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15423         IF NOT DATE-CONVERSION-ERROR
 15424             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 15425             MOVE HOLD-MONTH     TO WORK-MONTH
 15426             MOVE HOLD-YEAR      TO WORK-YEAR
 15427             MOVE WORK-DATE-MY   TO LCVEXITO.
 15428
 15429     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15430        IF CP-REMAINING-TERM-3 = ZEROS
 15431           MOVE 'EXPIRED'        TO LCVSTATO
 15432        ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 289
* EL131.cbl
 15433           MOVE 'ACTIVE'         TO LCVSTATO.
 15434
 15435     IF CM-LF-CURRENT-STATUS = '2'
 15436        MOVE 'PEND   '           TO LCVSTATO.
 15437     IF CM-LF-CURRENT-STATUS = '3'
 15438        MOVE 'RESTORE'           TO LCVSTATO.
 15439     IF CM-LF-CURRENT-STATUS = '5'
 15440        MOVE 'REISSUE'           TO LCVSTATO.
 15441     IF CM-LF-CURRENT-STATUS = '6'
 15442        MOVE 'LMP DIS'           TO LCVSTATO.
 15443     IF CM-LF-CURRENT-STATUS = '7'
 15444        MOVE 'DEATH  '           TO LCVSTATO.
 15445     IF CM-LF-CURRENT-STATUS = '8'
 15446        MOVE 'CANCEL '           TO LCVSTATO.
 15447     IF CM-LF-CURRENT-STATUS = '9'
 15448        MOVE 'RE-ONLY'           TO LCVSTATO.
 15449     IF CM-LF-CURRENT-STATUS = 'V'
 15450        MOVE 'VOID   '           TO LCVSTATO.
 15451     IF CM-LF-CURRENT-STATUS = 'D'
 15452        MOVE 'DECLINE'           TO LCVSTATO.
 15453
 15454     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15455     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15456     MOVE '4'                    TO BEN-REC-TYPE.
 15457     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 15458     MOVE ZERO                   TO BEN-SEQ-NO.
 15459
 15460
 15461* EXEC CICS READ GTEQ
 15462*         DATASET  (CNTL-FILE-ID)
 15463*         RIDFLD   (BENEFIT-KEY)
 15464*         SET      (ADDRESS OF CONTROL-FILE)
 15465*    END-EXEC.
 15466*    MOVE '&"S        G          (   #00013030' TO DFHEIV0
 15467     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15468     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15469     MOVE X'2020233030303133303330' TO DFHEIV0(25:11)
 15470     CALL 'kxdfhei1' USING DFHEIV0,
 15471           CNTL-FILE-ID,
 15472           DFHEIV20,
 15473           DFHEIV99,
 15474           BENEFIT-KEY,
 15475           DFHEIV99,
 15476           DFHEIV99,
 15477           DFHEIV99
 15478     SET ADDRESS OF CONTROL-FILE TO
 15479         DFHEIV20
 15480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15481
 15482
 15483     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15484        CF-RECORD-TYPE NOT = '4'
 15485         MOVE ER-0240            TO EMI-ERROR
 15486         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15487         GO TO 5030-MOVE-CERT-FINISH.
 15488
 15489     MOVE ZERO                   TO COUNT-2.
 15490     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 290
* EL131.cbl
 15491
 15492     IF SCREEN-ERROR
 15493         MOVE ER-0282            TO EMI-ERROR
 15494         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15495        ELSE
 15496         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 15497
 15498 5030-MOVE-CERT-AH.
 15499
 15500     IF CM-LF-BENEFIT-CD = '00'
 15501         IF CM-AH-BENEFIT-CD = '00'
 15502             GO TO 5030-MOVE-CERT-FINISH.
 15503
 15504     IF CM-AH-BENEFIT-CD = '00'
 15505        MOVE SPACES             TO ACVKINDO
 15506        COMPUTE PI-PAYMENT-AMT =
 15507                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 15508        GO TO 5030-MOVE-CERT-FINISH.
 15509
 15510     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15511     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 15512     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 15513     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 15514     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15515     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15516     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15517     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 15518
 15519**DMD **********************************************
 15520     IF PI-COMPANY-ID = 'DMD'
 15521         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 15522                                   CM-PMT-EXTENSION-DAYS
 15523         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 15524                                      CL-NO-OF-DAYS-PAID
 15525         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 15526             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 15527         MOVE WS-REM-MOS         TO ACVRTRMO
 15528                                    CP-REMAINING-TERM-3
 15529*        MOVE WS-REM-DAYS        TO DAYSPO
 15530         GO TO 5030-SKIP-RTRM.
 15531**DMD **********************************************
 15532
 15533     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15534     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15535     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15536     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15537
 15538 5030-SKIP-RTRM.
 15539     IF CM-AH-PREMIUM-RATE NUMERIC
 15540         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15541     ELSE
 15542         MOVE ZEROS              TO ACVRATEO.
 15543
 15544     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 15545     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 15546
 15547     IF CM-AH-CURRENT-STATUS = '8'
 15548        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 291
* EL131.cbl
 15549            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15550            MOVE ' '             TO DC-OPTION-CODE
 15551            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15552            IF NOT DATE-CONVERSION-ERROR
 15553                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15554
 15555     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15556        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15557            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 15558            MOVE ' '             TO DC-OPTION-CODE
 15559            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15560            IF NOT DATE-CONVERSION-ERROR
 15561                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15562
 15563     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15564        IF CP-REMAINING-TERM-3 = ZEROS
 15565           MOVE 'EXPIRED'        TO ACVSTATO
 15566        ELSE
 15567           MOVE 'ACTIVE'         TO ACVSTATO.
 15568
 15569     IF CM-AH-CURRENT-STATUS = '2'
 15570        MOVE 'PEND   '           TO ACVSTATO.
 15571     IF CM-AH-CURRENT-STATUS = '3'
 15572        MOVE 'RESTORE'           TO ACVSTATO.
 15573     IF CM-AH-CURRENT-STATUS = '5'
 15574        MOVE 'REISSUE'           TO ACVSTATO.
 15575     IF CM-AH-CURRENT-STATUS = '6'
 15576        MOVE 'LMP DIS'           TO ACVSTATO.
 15577     IF CM-AH-CURRENT-STATUS = '7'
 15578        MOVE 'DEATH  '           TO ACVSTATO.
 15579     IF CM-AH-CURRENT-STATUS = '8'
 15580        MOVE 'CANCEL '           TO ACVSTATO.
 15581     IF CM-AH-CURRENT-STATUS = '9'
 15582        MOVE 'RE-ONLY'           TO ACVSTATO.
 15583     IF CM-AH-CURRENT-STATUS = 'V'
 15584        MOVE 'VOID   '           TO ACVSTATO.
 15585     IF CM-AH-CURRENT-STATUS = '9'
 15586        MOVE 'DECLINE'           TO ACVSTATO.
 15587
 15588     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15589         MOVE ' '                TO DC-OPTION-CODE
 15590         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15591         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15592         IF NOT DATE-CONVERSION-ERROR
 15593             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 15594             MOVE HOLD-MONTH     TO WORK-MONTH
 15595             MOVE HOLD-YEAR      TO WORK-YEAR
 15596             MOVE WORK-DATE-MY   TO ACVEXITO.
 15597
 15598     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15599
 15600     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15601     MOVE '5'                    TO BEN-REC-TYPE.
 15602     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 15603     MOVE ZERO                   TO BEN-SEQ-NO.
 15604
 15605
 15606* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 292
* EL131.cbl
 15607*         DATASET  (CNTL-FILE-ID)
 15608*         RIDFLD   (BENEFIT-KEY)
 15609*         SET      (ADDRESS OF CONTROL-FILE)
 15610*    END-EXEC.
 15611*    MOVE '&"S        G          (   #00013158' TO DFHEIV0
 15612     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15613     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15614     MOVE X'2020233030303133313538' TO DFHEIV0(25:11)
 15615     CALL 'kxdfhei1' USING DFHEIV0,
 15616           CNTL-FILE-ID,
 15617           DFHEIV20,
 15618           DFHEIV99,
 15619           BENEFIT-KEY,
 15620           DFHEIV99,
 15621           DFHEIV99,
 15622           DFHEIV99
 15623     SET ADDRESS OF CONTROL-FILE TO
 15624         DFHEIV20
 15625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15626
 15627
 15628     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15629        CF-RECORD-TYPE NOT = '5'
 15630         MOVE ER-0250            TO EMI-ERROR
 15631         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15632         GO TO 5030-MOVE-CERT-FINISH.
 15633
 15634     MOVE ZERO                   TO COUNT-2.
 15635     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15636
 15637     IF SCREEN-ERROR
 15638         MOVE ER-0283            TO EMI-ERROR
 15639         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15640       ELSE
 15641         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15642
 15643 5030-MOVE-CERT-FINISH.
 15644
 15645     MOVE CM-LOAN-APR            TO APRO.
 15646     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15647     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15648     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15649*    MOVE CM-LOAN-NUMBER         TO LOANNOO
 15650     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15651     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15652
 15653     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15654         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15655         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15656         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15657         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15658     ELSE
 15659         MOVE SPACES               TO ADDONDTO.
 15660
 15661     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15662
 15663 5030-EXIT.
 15664     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 293
* EL131.cbl
 15666 5040-FIND-BENEFIT.
 15667     ADD 1                       TO COUNT-2.
 15668     IF COUNT-2 GREATER THAN 8
 15669         GO TO 5050-BENEFIT-NOTFND.
 15670
 15671     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15672         GO TO 5060-EXIT.
 15673
 15674     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15675         GO TO 5050-BENEFIT-NOTFND.
 15676
 15677     GO TO 5040-FIND-BENEFIT.
 15678
 15679 5050-BENEFIT-NOTFND.
 15680     MOVE 'X'                    TO ERROR-SWITCH.
 15681
 15682 5060-EXIT.
 15683     EXIT.
 15684 5100-LOAD-CORR-TRLR.
 15685     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 15686     MOVE PI-CARRIER         TO TRLR-CARRIER.
 15687     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 15688     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 15689     MOVE 1000               TO TRLR-SEQ-NO.
 15690
 15691
 15692* EXEC CICS HANDLE CONDITION
 15693*         NOTFND    (1052-DONE)
 15694*         ENDFILE   (1052-DONE)
 15695*    END-EXEC.
 15696*    MOVE '"$I''                  ! D #00013227' TO DFHEIV0
 15697     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 15698     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15699     MOVE X'4420233030303133323237' TO DFHEIV0(25:11)
 15700     CALL 'kxdfhei1' USING DFHEIV0
 15701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15702
 15703
 15704
 15705* EXEC CICS STARTBR
 15706*        DATASET (TRLR-FILE-ID)
 15707*        RIDFLD  (TRLR-KEY)
 15708*    END-EXEC
 15709     MOVE 0
 15710       TO DFHEIV11
 15711*    MOVE '&,         G          &   #00013232' TO DFHEIV0
 15712     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15713     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15714     MOVE X'2020233030303133323332' TO DFHEIV0(25:11)
 15715     CALL 'kxdfhei1' USING DFHEIV0,
 15716           TRLR-FILE-ID,
 15717           TRLR-KEY,
 15718           DFHEIV99,
 15719           DFHEIV11,
 15720           DFHEIV99
 15721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15722
 15723
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 294
* EL131.cbl
 15724     MOVE SPACES TO WS-TRLR-FILE-EOF
 15725                    WS-AUTH-RCVD
 15726     PERFORM 1052-READ-TRLR THRU 1052-EXIT
 15727       UNTIL  TRLR-FILE-EOF
 15728         OR WS-AUTH-RCVD > SPACES.
 15729
 15730
 15731* EXEC CICS ENDBR
 15732*        DATASET (TRLR-FILE-ID)
 15733*    END-EXEC.
 15734     MOVE 0
 15735       TO DFHEIV11
 15736*    MOVE '&2                    $   #00013244' TO DFHEIV0
 15737     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15738     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15739     MOVE X'2020233030303133323434' TO DFHEIV0(25:11)
 15740     CALL 'kxdfhei1' USING DFHEIV0,
 15741           TRLR-FILE-ID,
 15742           DFHEIV11,
 15743           DFHEIV99
 15744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15745
 15746
 15747     IF AUTH-RCVD
 15748        MOVE 'Y' TO AUTHRCVO
 15749     ELSE
 15750        MOVE 'N' TO AUTHRCVO
 15751     END-IF.
 15752
 15753
 15754 5100-EXIT.
 15755     EXIT.
 15756
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 295
* EL131.cbl
 15758 6000-CALCULATE-CERT-TERM.
 15759
 15760     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15761         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15762     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15763         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15764     IF CM-LOAN-APR NOT NUMERIC
 15765         MOVE ZEROS              TO CM-LOAN-APR.
 15766
 15767*    IF WS-CALC-METHOD  = 'G'
 15768         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15769*     ELSE
 15770*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15771
 15772     IF N GREATER 120
 15773         MOVE 120                TO N.
 15774
 15775     MOVE '6'                    TO DC-OPTION-CODE.
 15776     MOVE N                      TO DC-ELAPSED-MONTHS.
 15777     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 15778     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 15779
 15780     IF CM-LF-BENEFIT-CD NOT = ZERO
 15781         MOVE N                  TO CM-LF-ORIG-TERM
 15782         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 15783         IF NO-CONVERSION-ERROR
 15784             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 15785
 15786     IF CM-AH-BENEFIT-CD NOT = ZERO
 15787         MOVE N                  TO CM-AH-ORIG-TERM
 15788         IF NO-CONVERSION-ERROR
 15789             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 15790
 15791 6000-EXIT.
 15792      EXIT.
 15793
 15794 6100-CALC-GROSS-TERM.
 15795     MOVE CM-LOAN-BALANCE         TO L.
 15796     MOVE PI-PAYMENT-AMT          TO M.
 15797
 15798     COMPUTE N = L / M.
 15799     IF N LESS 1
 15800         MOVE 1  TO N.
 15801
 15802     IF CM-LF-BENEFIT-CD NOT = ZERO
 15803         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 15804     ELSE
 15805         MOVE ZEROS               TO WS-LF-RATE.
 15806
 15807     IF CM-AH-BENEFIT-CD NOT = ZERO
 15808         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 15809     ELSE
 15810         MOVE ZEROS               TO WS-AH-RATE.
 15811
 15812     COMPUTE I = CM-LOAN-APR / +1200.
 15813
 15814 6105-LOOP.
 15815     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 296
* EL131.cbl
 15816         GO TO 6200-EXIT.
 15817     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 15818     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 15819         ADD 1 TO N
 15820         GO TO 6105-LOOP.
 15821
 15822 6200-EXIT.
 15823      EXIT.
 15824
 15825 6210-CALC-LEFT-RIGHTONE.
 15826      MOVE L         TO LEFT-TOT-1.
 15827      SUBTRACT 1 FROM N.
 15828      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15829      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 15830      ADD 1 TO N.
 15831 6211-CALC-TERM1.
 15832      MOVE N         TO TERM1.
 15833      MULTIPLY M BY TERM1.
 15834 6212-LOOP.
 15835      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 15836      ADD 1 TO A-N.
 15837      MULTIPLY A-N BY TERM1.
 15838      SUBTRACT 1 FROM A-N.
 15839      ADD TERM1 TO LEFT-TOT-1.
 15840 6213-CALC-TERM2.
 15841      MOVE M         TO TERM2.
 15842      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 15843      MULTIPLY IA-N BY TERM2.
 15844      SUBTRACT TERM2 FROM LEFT-TOT-1.
 15845 6215-CALC-RIGHTONE.
 15846      MOVE M         TO RIGHT-TOT-1.
 15847      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15848      MULTIPLY A-N BY RIGHT-TOT-1.
 15849 6220-EXIT.
 15850      EXIT.
 15851
 15852 6300-CALC-A-N.
 15853     IF N LESS 1
 15854         MOVE 0     TO A-N
 15855         GO TO 6300-EXIT.
 15856     IF I = 0
 15857         MOVE .00001 TO I.
 15858     ADD 1 TO I.
 15859     DIVIDE I INTO 1 GIVING V.
 15860     SUBTRACT 1 FROM I.
 15861     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15862     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 15863     DIVIDE I INTO TERM3 GIVING A-N.
 15864 6300-EXIT.
 15865      EXIT.
 15866
 15867 6350-CALC-IA-N.
 15868     IF N LESS 1
 15869         MOVE 0      TO IA-N
 15870         GO TO 6400-EXIT.
 15871     ADD 1 TO N.
 15872     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15873     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 297
* EL131.cbl
 15874     MULTIPLY N BY V-EX-N GIVING TERM3.
 15875     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 15876     SUBTRACT V FROM 1 GIVING TERM4.
 15877     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 15878 6400-EXIT.
 15879      EXIT.
 15880
 15881 6450-CALC-V-EX-N.
 15882     IF N LESS 1
 15883         MOVE 1    TO V-EX-N
 15884         GO TO 6490-EXIT.
 15885     MOVE N        TO NV-STORE.
 15886     IF V-EX-ONETIME = 1  OR
 15887        V NOT = V-EXPONENT (1)
 15888          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 15889 6460-LOOP.
 15890     IF N GREATER 248
 15891         MOVE 248 TO N.
 15892     IF N = 1
 15893         MOVE V               TO V-EX-N
 15894      ELSE
 15895         MOVE V-EXPONENT (N)  TO V-EX-N.
 15896     GO TO 6490-EXIT.
 15897
 15898 6470-BUILD-V-EX-TABLE.
 15899     MOVE 2      TO N.
 15900     MOVE V      TO V-EXPONENT (1)
 15901                    V-EX-N.
 15902 6471-LOOP.
 15903     MULTIPLY V BY V-EX-N.
 15904     MOVE V-EX-N   TO V-EXPONENT (N).
 15905     ADD 1 TO N.
 15906     IF N LESS 248
 15907         GO TO 6471-LOOP.
 15908     MOVE NV-STORE     TO N.
 15909     MOVE 0            TO V-EX-ONETIME.
 15910 6480-EXIT.
 15911      EXIT.
 15912
 15913 6490-EXIT.
 15914      EXIT.
 15915
 15916 6500-CALC-NET-TERM.
 15917     MOVE CM-LOAN-BALANCE         TO L.
 15918     MOVE PI-PAYMENT-AMT          TO M.
 15919
 15920     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 15921     IF WS-REMAIN GREATER ZERO
 15922         ADD 1 TO N.
 15923     IF N = 0
 15924         MOVE 1 TO N.
 15925
 15926 6700-EXIT.
 15927      EXIT.
 15928
 15929 6999-CALC-TERM-EXIT.
 15930     EXIT.
 15931
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 298
* EL131.cbl
 15933 7000-RESET-ATTRIBUTE.
 15934
 15935     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 15936                                    CERTSTA   CERTCARA
 15937                                    CERTGRPA.
 15938     MOVE -1                     TO CERTCARL.
 15939
 15940 7000-EXIT.
 15941     EXIT.
 15942
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 299
* EL131.cbl
 15944 7600-BROWSE-CLAIM.
 15945
 15946
 15947* EXEC CICS READ
 15948*        DATASET(CLMS-FILE-ID)
 15949*        SET    (ADDRESS OF CLAIM-MASTER)
 15950*        RIDFLD (MSTR-KEY)
 15951*        GENERIC
 15952*        EQUAL
 15953*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15954*    END-EXEC.
 15955*    MOVE '&"S  KG    E          (   #00013447' TO DFHEIV0
 15956     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15957     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15958     MOVE X'2020233030303133343437' TO DFHEIV0(25:11)
 15959     CALL 'kxdfhei1' USING DFHEIV0,
 15960           CLMS-FILE-ID,
 15961           DFHEIV20,
 15962           DFHEIV99,
 15963           MSTR-KEY,
 15964           ELMSTR-GENERIC-LENGTH,
 15965           DFHEIV99,
 15966           DFHEIV99
 15967     SET ADDRESS OF CLAIM-MASTER TO
 15968         DFHEIV20
 15969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15970
 15971
 15972     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 15973
 15974     if cl-assoc-cert-total = 0
 15975        move 1 to cl-assoc-cert-total
 15976     end-if
 15977     IF CL-ASSOC-CERT-SEQU = 0
 15978        MOVE 1 TO CL-ASSOC-CERT-SEQU
 15979     END-IF
 15980
 15981     IF CL-ASSOC-CERT-TOTAL = 1
 15982         MOVE AL-SADOF           TO BCERT1A
 15983                                    BSUFX1A
 15984                                    BCERT2A
 15985                                    BSUFX2A
 15986                                    BCERT3A
 15987                                    BSUFX3A
 15988                                    BCERT4A
 15989                                    BSUFX4A
 15990                                    BCERT5A
 15991                                    BSUFX5A
 15992                                    PCERTNOA
 15993                                    PSUFXA
 15994                                    LABEL1A
 15995                                    LABEL2A
 15996         GO TO 7699-EXIT.
 15997
 15998 7610-BROWSE-CLAIM-LOOP.
 15999
 16000     MOVE LOW-VALUES             TO BCERT1O
 16001                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 300
* EL131.cbl
 16002                                    BCERT2O
 16003                                    BSUFX2O
 16004                                    BCERT3O
 16005                                    BSUFX3O
 16006                                    BCERT4O
 16007                                    BSUFX4O
 16008                                    BCERT5O
 16009                                    BSUFX5O.
 16010
 16011
 16012* EXEC CICS HANDLE CONDITION
 16013*        ENDFILE  (7630-END-BROWSE)
 16014*    END-EXEC.
 16015*    MOVE '"$''                   ! E #00013495' TO DFHEIV0
 16016     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 16017     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16018     MOVE X'4520233030303133343935' TO DFHEIV0(25:11)
 16019     CALL 'kxdfhei1' USING DFHEIV0
 16020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16021
 16022
 16023
 16024* EXEC CICS STARTBR
 16025*        DATASET    (CLMS-FILE-ID)
 16026*        RIDFLD     (MSTR-KEY)
 16027*    END-EXEC.
 16028     MOVE 0
 16029       TO DFHEIV11
 16030*    MOVE '&,         G          &   #00013499' TO DFHEIV0
 16031     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16032     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16033     MOVE X'2020233030303133343939' TO DFHEIV0(25:11)
 16034     CALL 'kxdfhei1' USING DFHEIV0,
 16035           CLMS-FILE-ID,
 16036           MSTR-KEY,
 16037           DFHEIV99,
 16038           DFHEIV11,
 16039           DFHEIV99
 16040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16041
 16042
 16043     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 16044
 16045 7620-READ-CLAIM-LOOP.
 16046
 16047
 16048* EXEC CICS READNEXT
 16049*        DATASET   (CLMS-FILE-ID)
 16050*        SET       (ADDRESS OF CLAIM-MASTER)
 16051*        RIDFLD    (MSTR-KEY)
 16052*    END-EXEC.
 16053     MOVE 0
 16054       TO DFHEIV11
 16055*    MOVE '&.S                   )   #00013508' TO DFHEIV0
 16056     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16057     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16058     MOVE X'2020233030303133353038' TO DFHEIV0(25:11)
 16059     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 301
* EL131.cbl
 16060           CLMS-FILE-ID,
 16061           DFHEIV20,
 16062           DFHEIV99,
 16063           MSTR-KEY,
 16064           DFHEIV99,
 16065           DFHEIV11,
 16066           DFHEIV99,
 16067           DFHEIV99
 16068     SET ADDRESS OF CLAIM-MASTER TO
 16069         DFHEIV20
 16070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16071
 16072
 16073     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 16074        CL-CARRIER     NOT = CARRI           OR
 16075        CL-CLAIM-NO    NOT = CLAIMI
 16076        GO TO 7630-END-BROWSE.
 16077
 16078     IF WS-ASSOCIATED-CERTS = 1
 16079         MOVE CL-CERT-PRIME      TO BCERT1O
 16080         MOVE CL-CERT-SFX        TO BSUFX1O.
 16081
 16082     IF WS-ASSOCIATED-CERTS = 2
 16083         MOVE CL-CERT-PRIME      TO BCERT2O
 16084         MOVE CL-CERT-SFX        TO BSUFX2O.
 16085
 16086     IF WS-ASSOCIATED-CERTS = 3
 16087         MOVE CL-CERT-PRIME      TO BCERT3O
 16088         MOVE CL-CERT-SFX        TO BSUFX3O.
 16089
 16090     IF WS-ASSOCIATED-CERTS = 4
 16091         MOVE CL-CERT-PRIME      TO BCERT4O
 16092         MOVE CL-CERT-SFX        TO BSUFX4O.
 16093
 16094     IF WS-ASSOCIATED-CERTS = 5
 16095         MOVE CL-CERT-PRIME      TO BCERT5O
 16096         MOVE CL-CERT-SFX        TO BSUFX5O
 16097     ELSE
 16098         ADD +1                  TO WS-ASSOCIATED-CERTS
 16099         GO TO 7620-READ-CLAIM-LOOP.
 16100
 16101 7630-END-BROWSE.
 16102
 16103
 16104* EXEC CICS ENDBR
 16105*        DATASET   (CLMS-FILE-ID)
 16106*    END-EXEC.
 16107     MOVE 0
 16108       TO DFHEIV11
 16109*    MOVE '&2                    $   #00013544' TO DFHEIV0
 16110     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16111     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16112     MOVE X'2020233030303133353434' TO DFHEIV0(25:11)
 16113     CALL 'kxdfhei1' USING DFHEIV0,
 16114           CLMS-FILE-ID,
 16115           DFHEIV11,
 16116           DFHEIV99
 16117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 302
* EL131.cbl
 16118
 16119
 16120 7640-HIGHLIGHT-CERT-DISPLAYED.
 16121
 16122     MOVE AL-SANON               TO BCERT1A
 16123                                    BSUFX1A
 16124                                    BCERT2A
 16125                                    BSUFX2A
 16126                                    BCERT3A
 16127                                    BSUFX3A
 16128                                    BCERT4A
 16129                                    BSUFX4A
 16130                                    BCERT5A
 16131                                    BSUFX5A.
 16132
 16133     IF BCERT1O = CERTI AND
 16134        BSUFX1O = SUFXI
 16135            MOVE AL-SABON        TO BCERT1A
 16136                                    BSUFX1A.
 16137
 16138     IF BCERT2O = CERTI AND
 16139        BSUFX2O = SUFXI
 16140            MOVE AL-SABON        TO BCERT2A
 16141                                    BSUFX2A.
 16142
 16143     IF BCERT3O = CERTI AND
 16144        BSUFX3O = SUFXI
 16145            MOVE AL-SABON        TO BCERT3A
 16146                                    BSUFX3A.
 16147
 16148     IF BCERT4O = CERTI AND
 16149        BSUFX4O = SUFXI
 16150            MOVE AL-SABON        TO BCERT4A
 16151                                    BSUFX4A.
 16152
 16153     IF BCERT5O = CERTI AND
 16154        BSUFX5O = SUFXI
 16155            MOVE AL-SABON        TO BCERT5A
 16156                                    BSUFX5A.
 16157
 16158 7699-EXIT.
 16159     EXIT.
 16160
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 303
* EL131.cbl
 16162 7700-CHECK-SEQUENCE.
 16163
 16164
 16165* EXEC CICS HANDLE CONDITION
 16166*        ENDFILE  (7799-EXIT)
 16167*        NOTFND   (7799-EXIT)
 16168*    END-EXEC.
 16169*    MOVE '"$''I                  ! F #00013592' TO DFHEIV0
 16170     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16171     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16172     MOVE X'4620233030303133353932' TO DFHEIV0(25:11)
 16173     CALL 'kxdfhei1' USING DFHEIV0
 16174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16175
 16176
 16177
 16178* EXEC CICS READ
 16179*        DATASET(CLMS-FILE-ID)
 16180*        SET    (ADDRESS OF CLAIM-MASTER)
 16181*        RIDFLD (MSTR-KEY)
 16182*        GENERIC
 16183*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 16184*    END-EXEC.
 16185*    MOVE '&"S  KG    E          (   #00013597' TO DFHEIV0
 16186     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 16187     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16188     MOVE X'2020233030303133353937' TO DFHEIV0(25:11)
 16189     CALL 'kxdfhei1' USING DFHEIV0,
 16190           CLMS-FILE-ID,
 16191           DFHEIV20,
 16192           DFHEIV99,
 16193           MSTR-KEY,
 16194           ELMSTR-GENERIC-LENGTH,
 16195           DFHEIV99,
 16196           DFHEIV99
 16197     SET ADDRESS OF CLAIM-MASTER TO
 16198         DFHEIV20
 16199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16200
 16201
 16202     COMPUTE WS-ASSOC-CERT-TOTAL =
 16203             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 16204
 16205     GO TO 7799-EXIT.
 16206
 16207 7710-RESEQUENCE-CLAIMS.
 16208
 16209
 16210* EXEC CICS HANDLE CONDITION
 16211*        ENDFILE  (7799-EXIT)
 16212*    END-EXEC.
 16213*    MOVE '"$''                   ! G #00013612' TO DFHEIV0
 16214     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 16215     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16216     MOVE X'4720233030303133363132' TO DFHEIV0(25:11)
 16217     CALL 'kxdfhei1' USING DFHEIV0
 16218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16219
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 304
* EL131.cbl
 16220
 16221
 16222* EXEC CICS STARTBR
 16223*        DATASET(CLMS-FILE-ID)
 16224*        RIDFLD (MSTR-KEY)
 16225*    END-EXEC.
 16226     MOVE 0
 16227       TO DFHEIV11
 16228*    MOVE '&,         G          &   #00013616' TO DFHEIV0
 16229     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16230     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16231     MOVE X'2020233030303133363136' TO DFHEIV0(25:11)
 16232     CALL 'kxdfhei1' USING DFHEIV0,
 16233           CLMS-FILE-ID,
 16234           MSTR-KEY,
 16235           DFHEIV99,
 16236           DFHEIV11,
 16237           DFHEIV99
 16238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16239
 16240
 16241     COMPUTE WS-ASSOC-CERT-SEQU =
 16242             WS-ASSOC-CERT-SEQU + 1.
 16243
 16244     COMPUTE WS-READNEXT-SWITCH =
 16245             WS-READNEXT-SWITCH + 1.
 16246
 16247 7720-READ-CLAIM-LOOP.
 16248
 16249
 16250* EXEC CICS READNEXT
 16251*        DATASET(CLMS-FILE-ID)
 16252*        SET    (ADDRESS OF CLAIM-MASTER)
 16253*        RIDFLD (MSTR-KEY)
 16254*    END-EXEC.
 16255     MOVE 0
 16256       TO DFHEIV11
 16257*    MOVE '&.S                   )   #00013629' TO DFHEIV0
 16258     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16259     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16260     MOVE X'2020233030303133363239' TO DFHEIV0(25:11)
 16261     CALL 'kxdfhei1' USING DFHEIV0,
 16262           CLMS-FILE-ID,
 16263           DFHEIV20,
 16264           DFHEIV99,
 16265           MSTR-KEY,
 16266           DFHEIV99,
 16267           DFHEIV11,
 16268           DFHEIV99,
 16269           DFHEIV99
 16270     SET ADDRESS OF CLAIM-MASTER TO
 16271         DFHEIV20
 16272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16273
 16274
 16275     IF WS-READNEXT-SWITCH = 1
 16276         ADD 1                   TO WS-READNEXT-SWITCH
 16277         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 305
* EL131.cbl
 16278
 16279 7730-END-BROWSE.
 16280
 16281
 16282* EXEC CICS ENDBR
 16283*        DATASET(CLMS-FILE-ID)
 16284*    END-EXEC.
 16285     MOVE 0
 16286       TO DFHEIV11
 16287*    MOVE '&2                    $   #00013641' TO DFHEIV0
 16288     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16289     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16290     MOVE X'2020233030303133363431' TO DFHEIV0(25:11)
 16291     CALL 'kxdfhei1' USING DFHEIV0,
 16292           CLMS-FILE-ID,
 16293           DFHEIV11,
 16294           DFHEIV99
 16295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16296
 16297
 16298 7740-READ-CLAIM-UPDATE.
 16299
 16300     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 16301        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 16302        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 16303        GO TO 7799-EXIT
 16304     ELSE
 16305        MOVE ZERO                TO WS-READNEXT-SWITCH.
 16306
 16307
 16308* EXEC CICS READ
 16309*        DATASET(CLMS-FILE-ID)
 16310*        SET    (ADDRESS OF CLAIM-MASTER)
 16311*        RIDFLD (MSTR-KEY)
 16312*        UPDATE
 16313*    END-EXEC.
 16314*    MOVE '&"S        EU         (   #00013654' TO DFHEIV0
 16315     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16316     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16317     MOVE X'2020233030303133363534' TO DFHEIV0(25:11)
 16318     CALL 'kxdfhei1' USING DFHEIV0,
 16319           CLMS-FILE-ID,
 16320           DFHEIV20,
 16321           DFHEIV99,
 16322           MSTR-KEY,
 16323           DFHEIV99,
 16324           DFHEIV99,
 16325           DFHEIV99
 16326     SET ADDRESS OF CLAIM-MASTER TO
 16327         DFHEIV20
 16328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16329
 16330
 16331     if (cl-priority-cd = '8')
 16332        and (pi-processor-id not = 'PEMA' and 'JMS '
 16333             AND 'AMWA')
 16334        MOVE ER-8003             TO EMI-ERROR
 16335        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 306
* EL131.cbl
 16336                                 THRU 9900-EXIT
 16337        MOVE -1                  TO MAINTL
 16338        GO TO 8110-SEND-DATA
 16339     end-if
 16340
 16341     IF PI-COMPANY-ID = 'CID' or 'AHL'
 16342         MOVE 'Y'                TO CL-YESNOSW
 16343     END-IF.
 16344
 16345     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 16346     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 16347
 16348
 16349* EXEC CICS REWRITE
 16350*         DATASET(CLMS-FILE-ID)
 16351*         FROM   (CLAIM-MASTER)
 16352*    END-EXEC.
 16353     MOVE LENGTH OF
 16354      CLAIM-MASTER
 16355       TO DFHEIV11
 16356*    MOVE '&& L                  %   #00013678' TO DFHEIV0
 16357     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16358     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16359     MOVE X'2020233030303133363738' TO DFHEIV0(25:11)
 16360     CALL 'kxdfhei1' USING DFHEIV0,
 16361           CLMS-FILE-ID,
 16362           CLAIM-MASTER,
 16363           DFHEIV11,
 16364           DFHEIV99
 16365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16366
 16367
 16368     GO TO 7710-RESEQUENCE-CLAIMS.
 16369
 16370 7799-EXIT.
 16371     EXIT.
 16372
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 307
* EL131.cbl
 16374 7800-CHECK-AUTO-ACTIVITY.
 16375
 16376
 16377* EXEC CICS HANDLE CONDITION
 16378*        NOTFND   (7800-NOT-FOUND)
 16379*    END-EXEC.
 16380*    MOVE '"$I                   ! H #00013691' TO DFHEIV0
 16381     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16382     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16383     MOVE X'4820233030303133363931' TO DFHEIV0(25:11)
 16384     CALL 'kxdfhei1' USING DFHEIV0
 16385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16386
 16387
 16388     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 16389     MOVE 'T'                        TO  CNTL-REC-TYPE.
 16390     MOVE SPACES                     TO  CNTL-PROC-ID.
 16391     MOVE +0                         TO  CNTL-SEQ-NO.
 16392
 16393
 16394* EXEC CICS READ
 16395*        DATASET   (CNTL-FILE-ID)
 16396*        RIDFLD    (CNTL-KEY)
 16397*        SET       (ADDRESS OF CONTROL-FILE)
 16398*    END-EXEC.
 16399*    MOVE '&"S        E          (   #00013700' TO DFHEIV0
 16400     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16401     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16402     MOVE X'2020233030303133373030' TO DFHEIV0(25:11)
 16403     CALL 'kxdfhei1' USING DFHEIV0,
 16404           CNTL-FILE-ID,
 16405           DFHEIV20,
 16406           DFHEIV99,
 16407           CNTL-KEY,
 16408           DFHEIV99,
 16409           DFHEIV99,
 16410           DFHEIV99
 16411     SET ADDRESS OF CONTROL-FILE TO
 16412         DFHEIV20
 16413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16414
 16415
 16416     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 16417         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 16418
 16419     IF CL-ACTIVITY-CODE NOT = ZEROS
 16420         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 16421         IF MISC-SUB IS GREATER THAN +9
 16422             SUBTRACT +9 FROM MISC-SUB
 16423             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 16424         ELSE
 16425             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 16426     ELSE
 16427         MOVE 'Y'                              TO  WS-RESET-SW.
 16428
 16429     IF STATUSI = 'C' OR 'CLOSED'
 16430         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 16431             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 308
* EL131.cbl
 16432                                         PI-LETTER-SW
 16433             GO TO 7800-EXIT.
 16434
 16435     IF STATUSI = 'C' OR 'CLOSED'
 16436         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 16437             MOVE 'N'                TO  PI-LETTER-SW
 16438         ELSE
 16439             MOVE 'Y'                TO  PI-LETTER-SW.
 16440
 16441     IF STATUSI = 'O' OR 'OPEN'
 16442         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 16443             MOVE 'N'                TO  PI-REC-FOUND-SW
 16444                                         PI-LETTER-SW
 16445             GO TO 7800-EXIT.
 16446
 16447     IF STATUSI = 'O' OR 'OPEN'
 16448         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 16449             MOVE 'N'                TO  PI-LETTER-SW
 16450         ELSE
 16451             MOVE 'Y'                TO  PI-LETTER-SW.
 16452
 16453     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 16454     GO TO 7800-EXIT.
 16455
 16456 7800-NOT-FOUND.
 16457
 16458     MOVE 'N'                        TO  PI-REC-FOUND-SW
 16459                                         PI-LETTER-SW.
 16460
 16461 7800-EXIT.
 16462     EXIT.
 16463
 16464 7850-AUTO-LETTER-WRITER.
 16465
 16466     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16467     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16468
 16469     IF STATUSI = 'C' OR 'CLOSED'
 16470         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 16471     ELSE
 16472         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 16473
 16474     IF STATUSI = 'C' OR 'CLOSED'
 16475         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 16476             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16477             MOVE '6'                TO  DC-OPTION-CODE
 16478             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 16479             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16480             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16481             IF NO-CONVERSION-ERROR
 16482                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16483             ELSE
 16484                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16485
 16486     IF STATUSI = 'C' OR 'CLOSED'
 16487         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 16488             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16489             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 309
* EL131.cbl
 16490             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 16491             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16492             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16493             IF NO-CONVERSION-ERROR
 16494                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16495             ELSE
 16496                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16497
 16498     IF STATUSI = 'O' OR 'OPEN'
 16499         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 16500             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16501             MOVE '6'                TO  DC-OPTION-CODE
 16502             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 16503             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16504             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16505             IF NO-CONVERSION-ERROR
 16506                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16507             ELSE
 16508                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16509
 16510     IF STATUSI = 'O' OR 'OPEN'
 16511         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 16512             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16513             MOVE '6'                TO  DC-OPTION-CODE
 16514             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 16515             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16516             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16517             IF NO-CONVERSION-ERROR
 16518                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16519             ELSE
 16520                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16521
 16522
 16523* EXEC CICS LINK
 16524*        PROGRAM    (LINK-1523)
 16525*        COMMAREA   (W-1523-LINKDATA)
 16526*        LENGTH     (W-1523-COMM-LENGTH)
 16527*    END-EXEC.
 16528*    MOVE '."C                   (   #00013812' TO DFHEIV0
 16529     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16530     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16531     MOVE X'2020233030303133383132' TO DFHEIV0(25:11)
 16532     CALL 'kxdfhei1' USING DFHEIV0,
 16533           LINK-1523,
 16534           W-1523-LINKDATA,
 16535           W-1523-COMM-LENGTH,
 16536           DFHEIV99,
 16537           DFHEIV99,
 16538           DFHEIV99,
 16539           DFHEIV99
 16540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16541
 16542
 16543     IF W-1523-ERROR-CODE = ZEROS
 16544         GO TO 7850-EXIT.
 16545
 16546     IF W-1523-FATAL-ERROR
 16547         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 310
* EL131.cbl
 16548         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16549
 16550     IF W-1523-ERROR-CODE = 0191
 16551         MOVE ER-0803                TO  EMI-ERROR
 16552         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16553
 16554 7850-EXIT.
 16555     EXIT.
 16556
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 311
* EL131.cbl
 16558 8000-CREATE-DMO-REC.
 16559     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 16560     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 16561     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 16562
 16563
 16564* EXEC CICS HANDLE CONDITION
 16565*         NOTFND   (8000-NOTE-NOT-FOUND)
 16566*    END-EXEC.
 16567*    MOVE '"$I                   ! I #00013838' TO DFHEIV0
 16568     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16569     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16570     MOVE X'4920233030303133383338' TO DFHEIV0(25:11)
 16571     CALL 'kxdfhei1' USING DFHEIV0
 16572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16573
 16574
 16575
 16576* EXEC CICS READ
 16577*         DATASET(NOTE-FILE-ID)
 16578*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 16579*         RIDFLD (NOTE-KEY)
 16580*    END-EXEC.
 16581*    MOVE '&"S        E          (   #00013842' TO DFHEIV0
 16582     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16583     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16584     MOVE X'2020233030303133383432' TO DFHEIV0(25:11)
 16585     CALL 'kxdfhei1' USING DFHEIV0,
 16586           NOTE-FILE-ID,
 16587           DFHEIV20,
 16588           DFHEIV99,
 16589           NOTE-KEY,
 16590           DFHEIV99,
 16591           DFHEIV99,
 16592           DFHEIV99
 16593     SET ADDRESS OF CERTIFICATE-NOTE TO
 16594         DFHEIV20
 16595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16596
 16597
 16598     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 16599     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 16600     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 16601
 16602     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 16603         MOVE 'CC'               TO DCT-PRODUCT-CODE
 16604     ELSE
 16605         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 16606
 16607     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 16608     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 16609
 16610
 16611* EXEC CICS LINK
 16612*        PROGRAM    ('DLO006')
 16613*        COMMAREA   (DCT-COMMUNICATION-AREA)
 16614*        LENGTH     (WS-DCT-LENGTH)
 16615*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 312
* EL131.cbl
 16616     MOVE 'DLO006' TO DFHEIV1
 16617*    MOVE '."C                   (   #00013860' TO DFHEIV0
 16618     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16619     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16620     MOVE X'2020233030303133383630' TO DFHEIV0(25:11)
 16621     CALL 'kxdfhei1' USING DFHEIV0,
 16622           DFHEIV1,
 16623           DCT-COMMUNICATION-AREA,
 16624           WS-DCT-LENGTH,
 16625           DFHEIV99,
 16626           DFHEIV99,
 16627           DFHEIV99,
 16628           DFHEIV99
 16629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16630
 16631
 16632     IF  DCT-RETURN-CODE = 'OK'
 16633         GO TO 8000-CONT.
 16634
 16635     IF DCT-RETURN-CODE = '01' OR '02'
 16636         GO TO 8000-EXIT.
 16637
 16638     IF DCT-RETURN-CODE = '03'
 16639         MOVE ER-0951            TO EMI-ERROR
 16640         MOVE -1                 TO MAINTL
 16641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16642         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16643         GO TO 8110-SEND-DATA.
 16644
 16645     IF DCT-RETURN-CODE = '04'
 16646         MOVE ER-0946            TO EMI-ERROR
 16647         MOVE -1                 TO MAINTL
 16648         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16649         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16650         GO TO 8110-SEND-DATA.
 16651
 16652     IF DCT-RETURN-CODE = '05'
 16653         MOVE ER-0947            TO EMI-ERROR
 16654         MOVE -1                 TO MAINTL
 16655         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16656         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16657         GO TO 8110-SEND-DATA.
 16658
 16659     IF DCT-RETURN-CODE = '06'
 16660         MOVE ER-0921            TO EMI-ERROR
 16661         MOVE -1                 TO MAINTL
 16662         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16663         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16664         GO TO 8110-SEND-DATA.
 16665
 16666     IF DCT-RETURN-CODE = '07'
 16667         MOVE ER-0919            TO EMI-ERROR
 16668         MOVE -1                 TO MAINTL
 16669         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16670         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16671         GO TO 8110-SEND-DATA.
 16672
 16673     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 313
* EL131.cbl
 16674         MOVE ER-0948            TO EMI-ERROR
 16675         MOVE -1                 TO MAINTL
 16676         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16677         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16678         GO TO 8110-SEND-DATA.
 16679
 16680     IF DCT-RETURN-CODE = 'N1'
 16681         MOVE ER-0950            TO EMI-ERROR
 16682         MOVE -1                 TO MAINTL
 16683         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16684         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16685         GO TO 8110-SEND-DATA.
 16686
 16687     IF DCT-RETURN-CODE = 'E1'
 16688         MOVE ER-0974            TO EMI-ERROR
 16689         MOVE -1                 TO MAINTL
 16690         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16691         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16692         GO TO 8110-SEND-DATA.
 16693
 16694     IF DCT-RETURN-CODE = 'E2'
 16695         MOVE ER-0975            TO EMI-ERROR
 16696         MOVE -1                 TO MAINTL
 16697         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16698         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16699         GO TO 8110-SEND-DATA.
 16700
 16701     IF DCT-RETURN-CODE NOT = 'OK'
 16702         MOVE ER-0949            TO EMI-ERROR
 16703         MOVE -1                 TO MAINTL
 16704         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16705         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16706         GO TO 8110-SEND-DATA.
 16707
 16708 8000-CONT.
 16709
 16710     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16711     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16712     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16713     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16714     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16715     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16716     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16717     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16718
 16719     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16720     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16721     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16722     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16723     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16724
 16725     IF STATUSI = 'OPEN' OR 'O'
 16726         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16727      ELSE
 16728         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16729
 16730     IF STATUSI = 'OPEN' OR 'O'
 16731        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 314
* EL131.cbl
 16732         MOVE '1'                TO DM-CLAIM-STATUS
 16733      ELSE
 16734         MOVE '2'                TO DM-CLAIM-STATUS.
 16735
 16736     IF STATUSI = 'CLOSED' OR 'C'
 16737        IF NOT FINAL-PAID
 16738         MOVE '3'                TO DM-CLAIM-STATUS
 16739      ELSE
 16740         MOVE '4'                TO DM-CLAIM-STATUS.
 16741
 16742     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16743
 16744
 16745* EXEC CICS LINK
 16746*        PROGRAM    ('DLO025')
 16747*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16748*        LENGTH     (WS-DMO-LENGTH)
 16749*    END-EXEC.
 16750     MOVE 'DLO025' TO DFHEIV1
 16751*    MOVE '."C                   (   #00013978' TO DFHEIV0
 16752     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16753     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16754     MOVE X'2020233030303133393738' TO DFHEIV0(25:11)
 16755     CALL 'kxdfhei1' USING DFHEIV0,
 16756           DFHEIV1,
 16757           DMO-COMMUNICATION-AREA,
 16758           WS-DMO-LENGTH,
 16759           DFHEIV99,
 16760           DFHEIV99,
 16761           DFHEIV99,
 16762           DFHEIV99
 16763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16764
 16765
 16766     IF  DM-RETURN-CODE = 'OK'
 16767         GO TO 8000-EXIT.
 16768
 16769     IF DM-RETURN-CODE = '01'
 16770         MOVE ER-8051            TO EMI-ERROR
 16771         MOVE -1                 TO MAINTL
 16772         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16773         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16774         GO TO 8110-SEND-DATA.
 16775
 16776     IF DM-RETURN-CODE = '02'
 16777         MOVE ER-8052            TO EMI-ERROR
 16778         MOVE -1                 TO MAINTL
 16779         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16780         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16781         GO TO 8110-SEND-DATA.
 16782
 16783     IF DM-RETURN-CODE = '03'
 16784         MOVE ER-8053            TO EMI-ERROR
 16785         MOVE -1                 TO MAINTL
 16786         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16787         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16788         GO TO 8110-SEND-DATA.
 16789
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 315
* EL131.cbl
 16790     IF DM-RETURN-CODE = '04'
 16791         MOVE ER-8054            TO EMI-ERROR
 16792         MOVE -1                 TO MAINTL
 16793         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16794         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16795         GO TO 8110-SEND-DATA.
 16796
 16797     IF DM-RETURN-CODE = '05'
 16798         MOVE ER-8055            TO EMI-ERROR
 16799         MOVE -1                 TO MAINTL
 16800         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16801         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16802         GO TO 8110-SEND-DATA.
 16803
 16804     IF DM-RETURN-CODE = '06'
 16805         MOVE ER-8056            TO EMI-ERROR
 16806         MOVE -1                 TO MAINTL
 16807         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16808         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16809         GO TO 8110-SEND-DATA.
 16810
 16811     IF DM-RETURN-CODE = '07'
 16812         MOVE ER-8057            TO EMI-ERROR
 16813         MOVE -1                 TO MAINTL
 16814         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16815         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16816         GO TO 8110-SEND-DATA.
 16817
 16818     IF DM-RETURN-CODE = '08'
 16819         MOVE ER-8058            TO EMI-ERROR
 16820         MOVE -1                 TO MAINTL
 16821         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16822         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16823         GO TO 8110-SEND-DATA.
 16824
 16825     IF DM-RETURN-CODE = '09'
 16826         MOVE ER-8059            TO EMI-ERROR
 16827         MOVE -1                 TO MAINTL
 16828         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16829         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16830         GO TO 8110-SEND-DATA.
 16831
 16832     IF DM-RETURN-CODE = '10'
 16833         MOVE ER-8060            TO EMI-ERROR
 16834         MOVE -1                 TO MAINTL
 16835         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16836         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16837         GO TO 8110-SEND-DATA.
 16838
 16839     IF DM-RETURN-CODE = '11'
 16840         MOVE ER-8061            TO EMI-ERROR
 16841         MOVE -1                 TO MAINTL
 16842         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16843         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16844         GO TO 8110-SEND-DATA.
 16845
 16846     IF DM-RETURN-CODE = '12'
 16847         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 316
* EL131.cbl
 16848         MOVE -1                 TO MAINTL
 16849         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16850         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16851         GO TO 8110-SEND-DATA.
 16852
 16853     IF DM-RETURN-CODE = '13'
 16854         MOVE ER-8063            TO EMI-ERROR
 16855         MOVE -1                 TO MAINTL
 16856         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16857         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16858         GO TO 8110-SEND-DATA.
 16859
 16860     IF DM-RETURN-CODE = '14'
 16861         MOVE ER-8064            TO EMI-ERROR
 16862         MOVE -1                 TO MAINTL
 16863         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16864         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16865         GO TO 8110-SEND-DATA.
 16866
 16867     IF DM-RETURN-CODE = '15'
 16868         MOVE ER-8065            TO EMI-ERROR
 16869         MOVE -1                 TO MAINTL
 16870         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16871         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16872         GO TO 8110-SEND-DATA.
 16873
 16874     IF DM-RETURN-CODE = '16'
 16875         MOVE ER-8154            TO EMI-ERROR
 16876         MOVE -1                 TO MAINTL
 16877         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16878         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16879         GO TO 8110-SEND-DATA.
 16880
 16881     IF DM-RETURN-CODE = '17'
 16882         MOVE ER-8155            TO EMI-ERROR
 16883         MOVE -1                 TO MAINTL
 16884         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16885         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16886         GO TO 8110-SEND-DATA.
 16887
 16888     IF DM-RETURN-CODE = 'N1'
 16889         MOVE ER-8152            TO EMI-ERROR
 16890         MOVE -1                 TO MAINTL
 16891         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16892         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16893         GO TO 8110-SEND-DATA.
 16894
 16895     IF DM-RETURN-CODE = 'E1'
 16896         MOVE ER-8153            TO EMI-ERROR
 16897         MOVE -1                 TO MAINTL
 16898         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16899         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16900         GO TO 8110-SEND-DATA.
 16901
 16902     MOVE ER-8066                TO EMI-ERROR.
 16903     MOVE -1                     TO MAINTL.
 16904     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16905     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 317
* EL131.cbl
 16906     GO TO 8110-SEND-DATA.
 16907
 16908 8000-NOTE-NOT-FOUND.
 16909
 16910* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16911*    MOVE '6"R                   !   #00014127' TO DFHEIV0
 16912     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16913     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16914     MOVE X'2020233030303134313237' TO DFHEIV0(25:11)
 16915     CALL 'kxdfhei1' USING DFHEIV0
 16916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16917
 16918     MOVE ER-0954                TO EMI-ERROR.
 16919     MOVE -1                     TO MAINTL.
 16920     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16921     GO TO 8110-SEND-DATA.
 16922
 16923 8000-EXIT.
 16924     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 318
* EL131.cbl
 16926 8050-FORMAT-LAST-NAME-1ST.
 16927*****************************************************************
 16928*             M O V E   N A M E   R O U T I N E                 *
 16929*                                                               *
 16930*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 16931*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 16932*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 16933*                                                               *
 16934*                  FIELD               VALUE                    *
 16935*                  -----               -----                    *
 16936*           W-NAME-LAST    (CL15)      SMITH                    *
 16937*           W-NAME-FIRST   (CL15)      JOHN                     *
 16938*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 16939*                                                               *
 16940*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 16941*                SMITH, JOHN ALLEN                              *
 16942*                     OR                                        *
 16943*                SMITH, JOHN A.                                 *
 16944*                                                               *
 16945*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 16946*     COPYBOOK, ELCNWA.                                         *
 16947*****************************************************************.
 16948
 16949     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 16950     MOVE ZERO                   TO WS-NAME-SW.
 16951     SET NWA-INDEX               TO +1.
 16952
 16953     IF W-NAME-LAST   = SPACES  AND
 16954        W-NAME-MIDDLE = SPACES
 16955          MOVE +1                TO WS-NAME-SW.
 16956
 16957     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 16958     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16959
 16960     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 16961     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16962
 16963     SET NWA-INDEX UP BY +1.
 16964
 16965     IF W-NAME-MIDDLE NOT = SPACES
 16966         IF W-NAME-MIDDLE-2 = SPACES
 16967             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 16968             SET NWA-INDEX UP BY +1
 16969             MOVE '.'            TO WS-NW (NWA-INDEX)
 16970             SET NWA-INDEX UP BY +2
 16971         ELSE
 16972             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 16973             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16974
 16975 8050-EXIT.
 16976     EXIT.
 16977
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 319
* EL131.cbl
 16979 8060-MOVE-NAME.
 16980     IF WS-NAME-SW GREATER THAN +1
 16981         GO TO 8060-EXIT.
 16982
 16983     IF WS-NAME-WORK2 = SPACES
 16984         GO TO 8060-EXIT.
 16985
 16986     SET NWA-INDEX2            TO +1.
 16987     SET NWA-INDEX3            TO +2.
 16988
 16989 8060-MOVE-NAME-CYCLE.
 16990     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 16991
 16992     IF NWA-INDEX LESS THAN +30
 16993         SET NWA-INDEX UP BY +1
 16994     ELSE
 16995         ADD +2 TO  WS-NAME-SW
 16996         GO TO 8060-EXIT.
 16997
 16998     IF NWA-INDEX2 LESS THAN +20
 16999         SET NWA-INDEX3 UP BY +1
 17000         SET NWA-INDEX2 UP BY +1.
 17001
 17002     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 17003        WS-NW2 (NWA-INDEX3) = SPACES
 17004         IF WS-NAME-SW = ZERO
 17005             MOVE ','            TO WS-NW (NWA-INDEX)
 17006             SET NWA-INDEX UP BY +2
 17007             MOVE +1             TO WS-NAME-SW
 17008             GO TO 8060-EXIT
 17009         ELSE
 17010             GO TO 8060-EXIT.
 17011
 17012     GO TO 8060-MOVE-NAME-CYCLE.
 17013
 17014 8060-EXIT.
 17015     EXIT.
 17016
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 320
* EL131.cbl
 17018
 17019 8070-UNLOCK-CLAIM-MSTR.
 17020
 17021* EXEC CICS UNLOCK
 17022*        DATASET   (CLMS-FILE-ID)
 17023*    END-EXEC.
 17024*    MOVE '&*                    #   #00014230' TO DFHEIV0
 17025     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 17026     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17027     MOVE X'2020233030303134323330' TO DFHEIV0(25:11)
 17028     CALL 'kxdfhei1' USING DFHEIV0,
 17029           CLMS-FILE-ID,
 17030           DFHEIV99
 17031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17032
 17033
 17034 8070-EXIT.
 17035      EXIT.
 17036
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 321
* EL131.cbl
 17038 8100-SEND-MAP.
 17039     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 17040
 17041     move al-uanon               to accswa
 17042     IF NOT PI-NO-CARRIER-SECURITY
 17043        MOVE AL-SANOF            TO CERTCARA.
 17044     IF NOT PI-NO-ACCOUNT-SECURITY
 17045        MOVE AL-SANOF            TO CERTACTA.
 17046
 17047     IF PI-PROCESSOR-ID = 'LGXX'
 17048        MOVE AL-UANON            TO CCNOA.
 17049
 17050     IF PI-COMPANY-ID = 'DMD'
 17051        NEXT SENTENCE
 17052     ELSE
 17053        MOVE AL-SADOF            TO PFKEY6A.
 17054     IF NOT (PI-COMPANY-ID = 'DCC' OR 'VPP')
 17055        MOVE AL-SANOF TO EXTENSA
 17056     END-IF
 17057
 17058     IF PI-USES-PAID-TO
 17059        MOVE 'PAID TO  :' TO PTHRHDGO.
 17060
 17061
 17062* EXEC CICS SEND
 17063*         MAP     ('EL131A')
 17064*         MAPSET  ('EL131S')
 17065*         ERASE
 17066*         FREEKB
 17067*         CURSOR
 17068*    END-EXEC.
 17069     MOVE 'EL131A' TO DFHEIV1
 17070     MOVE -1
 17071       TO DFHEIV11
 17072     MOVE 'EL131S' TO DFHEIV2
 17073*    MOVE '8$     CT  E F  H     ,   #00014261' TO DFHEIV0
 17074     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17075     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 17076     MOVE X'2020233030303134323631' TO DFHEIV0(25:11)
 17077     CALL 'kxdfhei1' USING DFHEIV0,
 17078           DFHEIV1,
 17079           EL131AO,
 17080           DFHEIV99,
 17081           DFHEIV2,
 17082           DFHEIV99,
 17083           DFHEIV99,
 17084           DFHEIV99,
 17085           DFHEIV11,
 17086           DFHEIV99,
 17087           DFHEIV99,
 17088           DFHEIV99
 17089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17090
 17091
 17092     GO TO 9000-RETURN-TRANS.
 17093
 17094 8110-SEND-DATA.
 17095     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 322
* EL131.cbl
 17096
 17097     IF PI-USES-PAID-TO
 17098        MOVE 'PAID TO  :' TO PTHRHDGO.
 17099
 17100     IF PI-PROCESSOR-ID = 'LGXX'
 17101        MOVE AL-UANON            TO CCNOA.
 17102
 17103     IF PI-COMPANY-ID = 'DMD'
 17104        NEXT SENTENCE
 17105     ELSE
 17106        MOVE AL-SADOF            TO PFKEY6A.
 17107
 17108
 17109* EXEC CICS SEND
 17110*         MAP      ('EL131A')
 17111*         MAPSET   ('EL131S')
 17112*         DATAONLY
 17113*         FREEKB
 17114*         CURSOR
 17115*    END-EXEC.
 17116     MOVE 'EL131A' TO DFHEIV1
 17117     MOVE -1
 17118       TO DFHEIV11
 17119     MOVE 'EL131S' TO DFHEIV2
 17120*    MOVE '8$D    CT    F  H     ,   #00014285' TO DFHEIV0
 17121     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 17122     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 17123     MOVE X'2020233030303134323835' TO DFHEIV0(25:11)
 17124     CALL 'kxdfhei1' USING DFHEIV0,
 17125           DFHEIV1,
 17126           EL131AO,
 17127           DFHEIV99,
 17128           DFHEIV2,
 17129           DFHEIV99,
 17130           DFHEIV99,
 17131           DFHEIV99,
 17132           DFHEIV11,
 17133           DFHEIV99,
 17134           DFHEIV99,
 17135           DFHEIV99
 17136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17137
 17138
 17139     GO TO 9000-RETURN-TRANS.
 17140
 17141 8120-FORMAT-TIME-DATE.
 17142     perform 8140-check-for-prev-errors
 17143                                 thru 8140-exit
 17144     IF SKIP-ATTRIBUTE = 'Y'
 17145        MOVE SPACES              TO SKIP-ATTRIBUTE
 17146        MOVE ER-0598             TO EMI-ERROR
 17147        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17148        GO TO 8125-SKIP-ATTRIBUTE.
 17149
 17150*     IF PI-COMPANY-ID = 'DMD'
 17151      IF PI-PROCESSOR-ID <> 'EMER'
 17152         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 17153                                    CERTCARA  CERTGRPA CERTA SUFXA
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 323
* EL131.cbl
 17154
 17155     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 17156                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 17157                                    JNTINITA  JNTAGEA   APRA
 17158                                    LCVCDA    LCVOTRMA  LCVRTRMA
 17159                                    LCVBENEA  LCVFORMA  LCVCNDTA
 17160                                    LCVEXITA  LCVSTATA  LCVKINDA
 17161                                    ACVCDA    ACVOTRMA  ACVRTRMA
 17162                                    ACVBENEA  ACVFORMA  ACVCNDTA
 17163                                    ACVEXITA  ACVSTATA  ACVKINDA
 17164                                    PMTFREQA  INDGRPA   PREMTYPA
 17165                                    REINCDA   LCVRATEA  ACVRATEA
 17166                                    ADDONDTA.
 17167
 17168*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 17169*       IF PI-COMPANY-ID = 'DMD'
 17170*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 17171*                                   SUFXA
 17172*                                   PDAMTA    NODAYSA   NOPMTSA
 17173*                                   INCA      OCCA
 17174*          IF NOT SYSTEM-MODIFY-CAP
 17175*              MOVE AL-SANOF         TO PDTHRUA.
 17176
 17177     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 17178         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 17179
 17180 8125-SKIP-ATTRIBUTE.
 17181
 17182     MOVE SAVE-DATE              TO DATEO.
 17183
 17184* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 17185*    END-EXEC
 17186*    MOVE '0"A                   "   #00014337' TO DFHEIV0
 17187     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 17188     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 17189     MOVE X'2020233030303134333337' TO DFHEIV0(25:11)
 17190     CALL 'kxdfhei1' USING DFHEIV0,
 17191           LCP-CICS-TIME
 17192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17193
 17194* EXEC CICS FORMATTIME
 17195*              ABSTIME(LCP-CICS-TIME)
 17196*              TIME(LCP-TIME-OF-DAY-XX)
 17197*    END-EXEC
 17198*    MOVE 'j$(     (             #   #00014339' TO DFHEIV0
 17199     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 17200     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17201     MOVE X'2020233030303134333339' TO DFHEIV0(25:11)
 17202     CALL 'kxdfhei1' USING DFHEIV0,
 17203           LCP-CICS-TIME,
 17204           LCP-TIME-OF-DAY-XX
 17205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17206     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 17207     MOVE UN-HOURS               TO FOR-HOURS.
 17208     MOVE UN-MINUTES             TO FOR-MINUTES.
 17209     MOVE TIME-OUT               TO TIMEO.
 17210     MOVE PI-COMPANY-ID          TO COMPO.
 17211     MOVE PI-PROCESSOR-ID        TO USERIDO.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 324
* EL131.cbl
 17212     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 17213     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 17214     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 17215     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 17216
 17217 8130-EXIT.
 17218     EXIT.
 17219
 17220 8140-check-for-prev-errors.
 17221
 17222     MOVE PI-COMPANY-CD          TO trlr-company-cd
 17223     MOVE PI-CARRIER             TO trlr-carrier
 17224     MOVE PI-CLAIM-NO            TO trlr-claim-no
 17225     MOVE PI-CERT-NO             TO trlr-cert-no
 17226     MOVE +95                    TO TRLR-SEQ-NO
 17227
 17228
 17229* EXEC CICS READ
 17230*       DATASET  ('ELTRLR')
 17231*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17232*       RIDFLD   (TRLR-KEY)
 17233*       RESP     (WS-RESPONSE)
 17234*    END-EXEC
 17235     MOVE 'ELTRLR' TO DFHEIV1
 17236*    MOVE '&"S        E          (  N#00014365' TO DFHEIV0
 17237     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17238     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17239     MOVE X'204E233030303134333635' TO DFHEIV0(25:11)
 17240     CALL 'kxdfhei1' USING DFHEIV0,
 17241           DFHEIV1,
 17242           DFHEIV20,
 17243           DFHEIV99,
 17244           TRLR-KEY,
 17245           DFHEIV99,
 17246           DFHEIV99,
 17247           DFHEIV99
 17248     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17249         DFHEIV20
 17250     MOVE EIBRESP  TO WS-RESPONSE
 17251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17252
 17253     if ws-resp-normal
 17254        perform varying s1 from +1 by +1 until
 17255           at-note-error-no (s1) = spaces
 17256           if at-note-error-no (s1) = '1652'
 17257              continue
 17258           else
 17259              move at-note-error-no (s1)
 17260                                 to emi-error
 17261              move -1 to maintl
 17262              if at-note-error-no (s1) = '1653'
 17263                 evaluate true
 17264                    when pi-claim-type = 'L'
 17265                       move '  LF  '
 17266                        to emi-claim-type
 17267                    when pi-claim-type = 'I'
 17268                       move '  IU  '
 17269                        to emi-claim-type
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 325
* EL131.cbl
 17270                    WHEN PI-CLAIM-TYPE = 'F'
 17271                       MOVE '  FL  '
 17272                        TO EMI-CLAIM-TYPE
 17273                    when other
 17274                       move '  AH  '
 17275                        to emi-claim-type
 17276                 end-evaluate
 17277              end-if
 17278              PERFORM 9900-ERROR-FORMAT
 17279                                 THRU 9900-EXIT
 17280           end-if
 17281*          if at-note-error-no (s1) = '1653'
 17282*             perform varying emi-sub from 1 by 1 until
 17283*                emi-sub > 3
 17284*                if emi-error-number (emi-sub) = '1653'
 17285*                   evaluate true
 17286*                      when pi-claim-type = 'L'
 17287*                         move '  LF  '
 17288*                          to emi-claim-type
 17289*                      when pi-claim-type = 'I'
 17290*                         move '  IU  '
 17291*                          to emi-claim-type
 17292*                      when other
 17293*                         move '  AH  '
 17294*                          to emi-claim-type
 17295*                   end-evaluate
 17296*                end-if
 17297*             end-perform
 17298*          end-if
 17299        end-perform
 17300     else
 17301        display ' resp not normal ' ws-response ' '
 17302        trlr-key (2:19)
 17303     end-if
 17304
 17305     .
 17306 8140-exit.
 17307     exit.
 17308 8150-ENTERED-CLAIM-NOTFOUND.
 17309
 17310     MOVE ER-0204                TO EMI-ERROR.
 17311     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17312     MOVE -1                     TO MAINTL.
 17313     GO TO 8100-SEND-MAP.
 17314
 17315 8200-RETURN-PRIOR.
 17316     MOVE SPACE                  TO PI-RETURN-CD-1.
 17317     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 17318     GO TO 9200-XCTL.
 17319
 17320 8300-GET-HELP.
 17321     MOVE XCTL-EL010             TO CALL-PGM.
 17322     GO TO 9200-XCTL.
 17323
 17324 8400-RETURN-MASTER.
 17325     MOVE SPACE                  TO PI-RETURN-CD-1.
 17326     MOVE XCTL-EL126             TO CALL-PGM.
 17327     GO TO 9200-XCTL.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 326
* EL131.cbl
 17328
 17329 8500-TRLR-MNT.
 17330     IF PI-RETURN-CD-1 = 'X'
 17331         MOVE ER-0311            TO EMI-ERROR
 17332         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17333         MOVE -1                 TO MAINTL
 17334         GO TO 8110-SEND-DATA.
 17335
 17336
 17337* EXEC CICS WRITEQ TS
 17338*         QUEUE     (PI-KEY)
 17339*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17340*         LENGTH    (PI-COMM-LENGTH)
 17341*    END-EXEC.
 17342*    MOVE '*"     L              ''   #00014455' TO DFHEIV0
 17343     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17344     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17345     MOVE X'2020233030303134343535' TO DFHEIV0(25:11)
 17346     CALL 'kxdfhei1' USING DFHEIV0,
 17347           PI-KEY,
 17348           PROGRAM-INTERFACE-BLOCK,
 17349           PI-COMM-LENGTH,
 17350           DFHEIV99,
 17351           DFHEIV99,
 17352           DFHEIV99
 17353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17354
 17355
 17356     MOVE XCTL-EL142             TO CALL-PGM.
 17357     GO TO 9200-XCTL.
 17358
 17359 8600-ADDR-MNT.
 17360     IF PI-RETURN-CD-1 = 'X'
 17361         MOVE ER-0311            TO EMI-ERROR
 17362         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17363         MOVE -1                 TO MAINTL
 17364         GO TO 8110-SEND-DATA.
 17365
 17366
 17367* EXEC CICS WRITEQ TS
 17368*         QUEUE     (PI-KEY)
 17369*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17370*         LENGTH    (PI-COMM-LENGTH)
 17371*    END-EXEC.
 17372*    MOVE '*"     L              ''   #00014471' TO DFHEIV0
 17373     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17374     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17375     MOVE X'2020233030303134343731' TO DFHEIV0(25:11)
 17376     CALL 'kxdfhei1' USING DFHEIV0,
 17377           PI-KEY,
 17378           PROGRAM-INTERFACE-BLOCK,
 17379           PI-COMM-LENGTH,
 17380           DFHEIV99,
 17381           DFHEIV99,
 17382           DFHEIV99
 17383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17384
 17385
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 327
* EL131.cbl
 17386     MOVE XCTL-EL141             TO CALL-PGM.
 17387     GO TO 9200-XCTL.
 17388
 17389 8700-CERT-MNT.
 17390     IF PI-RETURN-CD-1 = 'X'
 17391         MOVE ER-7690            TO EMI-ERROR
 17392         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17393         MOVE -1                 TO MAINTL
 17394         GO TO 8110-SEND-DATA.
 17395
 17396
 17397* EXEC CICS WRITEQ TS
 17398*         QUEUE     (PI-KEY)
 17399*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17400*         LENGTH    (PI-COMM-LENGTH)
 17401*    END-EXEC.
 17402*    MOVE '*"     L              ''   #00014487' TO DFHEIV0
 17403     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17404     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17405     MOVE X'2020233030303134343837' TO DFHEIV0(25:11)
 17406     CALL 'kxdfhei1' USING DFHEIV0,
 17407           PI-KEY,
 17408           PROGRAM-INTERFACE-BLOCK,
 17409           PI-COMM-LENGTH,
 17410           DFHEIV99,
 17411           DFHEIV99,
 17412           DFHEIV99
 17413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17414
 17415
 17416     MOVE XCTL-EL1273            TO CALL-PGM.
 17417     GO TO 9200-XCTL.
 17418
 17419 8725-BENEFICIARY-MNT.
 17420     IF PI-RETURN-CD-1 = 'X'
 17421         MOVE ER-0311            TO EMI-ERROR
 17422         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17423         MOVE -1                 TO MAINTL
 17424         GO TO 8110-SEND-DATA.
 17425
 17426
 17427* EXEC CICS WRITEQ TS
 17428*         QUEUE     (PI-KEY)
 17429*         FROM      (EL131AI)
 17430*         LENGTH    (MAP-LENGTH)
 17431*    END-EXEC.
 17432*    MOVE '*"     L              ''   #00014503' TO DFHEIV0
 17433     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17434     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17435     MOVE X'2020233030303134353033' TO DFHEIV0(25:11)
 17436     CALL 'kxdfhei1' USING DFHEIV0,
 17437           PI-KEY,
 17438           EL131AI,
 17439           MAP-LENGTH,
 17440           DFHEIV99,
 17441           DFHEIV99,
 17442           DFHEIV99
 17443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 328
* EL131.cbl
 17444
 17445
 17446
 17447* EXEC CICS WRITEQ TS
 17448*         QUEUE     (PI-KEY)
 17449*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17450*         LENGTH    (PI-COMM-LENGTH)
 17451*    END-EXEC.
 17452*    MOVE '*"     L              ''   #00014509' TO DFHEIV0
 17453     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17454     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17455     MOVE X'2020233030303134353039' TO DFHEIV0(25:11)
 17456     CALL 'kxdfhei1' USING DFHEIV0,
 17457           PI-KEY,
 17458           PROGRAM-INTERFACE-BLOCK,
 17459           PI-COMM-LENGTH,
 17460           DFHEIV99,
 17461           DFHEIV99,
 17462           DFHEIV99
 17463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17464
 17465
 17466     MOVE XCTL-EL114             TO CALL-PGM.
 17467     GO TO 9200-XCTL.
 17468
 17469 8750-DMD-CLM-FIX.
 17470
 17471* EXEC CICS WRITEQ TS
 17472*         QUEUE     (PI-KEY)
 17473*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17474*         LENGTH    (PI-COMM-LENGTH)
 17475*    END-EXEC.
 17476*    MOVE '*"     L              ''   #00014519' TO DFHEIV0
 17477     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17478     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17479     MOVE X'2020233030303134353139' TO DFHEIV0(25:11)
 17480     CALL 'kxdfhei1' USING DFHEIV0,
 17481           PI-KEY,
 17482           PROGRAM-INTERFACE-BLOCK,
 17483           PI-COMM-LENGTH,
 17484           DFHEIV99,
 17485           DFHEIV99,
 17486           DFHEIV99
 17487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17488
 17489
 17490     MOVE XCTL-EL400DMD          TO CALL-PGM.
 17491     GO TO 9200-XCTL.
 17492
 17493 8800-UNAUTHORIZED-ACCESS.
 17494     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 17495     GO TO 8990-SEND-TEXT.
 17496
 17497 8810-PF23-ENTERED.
 17498     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 17499     MOVE XCTL-EL005             TO CALL-PGM.
 17500     GO TO 9200-XCTL.
 17501
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 329
* EL131.cbl
 17502 8820-XCTL-ERROR.
 17503
 17504* EXEC CICS HANDLE CONDITION
 17505*        PGMIDERR (8990-SEND-TEXT)
 17506*    END-EXEC.
 17507*    MOVE '"$L                   ! J #00014538' TO DFHEIV0
 17508     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17509     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17510     MOVE X'4A20233030303134353338' TO DFHEIV0(25:11)
 17511     CALL 'kxdfhei1' USING DFHEIV0
 17512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17513
 17514
 17515     MOVE SPACE                 TO PI-ENTRY-CD-1.
 17516     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 17517     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 17518     MOVE XCTL-EL005            TO CALL-PGM.
 17519     GO TO 9200-XCTL.
 17520
 17521 8990-SEND-TEXT.
 17522
 17523* EXEC CICS SEND TEXT
 17524*         FROM      (LOGOFF-TEXT)
 17525*         LENGTH    (LOGOFF-LENGTH)
 17526*         ERASE
 17527*         FREEKB
 17528*    END-EXEC.
 17529*    MOVE '8&      T  E F  H   F -   #00014549' TO DFHEIV0
 17530     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17531     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17532     MOVE X'2020233030303134353439' TO DFHEIV0(25:11)
 17533     CALL 'kxdfhei1' USING DFHEIV0,
 17534           LOGOFF-TEXT,
 17535           LOGOFF-LENGTH,
 17536           DFHEIV99,
 17537           DFHEIV99,
 17538           DFHEIV99,
 17539           DFHEIV99,
 17540           DFHEIV99,
 17541           DFHEIV99,
 17542           DFHEIV99,
 17543           DFHEIV99,
 17544           DFHEIV99,
 17545           DFHEIV99
 17546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17547
 17548
 17549     GO TO 9100-RETURN-CICS.
 17550
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 330
* EL131.cbl
 17552 9000-RETURN-TRANS.
 17553
 17554* EXEC CICS RETURN
 17555*         TRANSID   (TRANS-ID)
 17556*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 17557*         LENGTH    (PI-COMM-LENGTH)
 17558*    END-EXEC.
 17559*    MOVE '.(CT                  ''   #00014560' TO DFHEIV0
 17560     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17561     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17562     MOVE X'2020233030303134353630' TO DFHEIV0(25:11)
 17563     CALL 'kxdfhei1' USING DFHEIV0,
 17564           TRANS-ID,
 17565           PROGRAM-INTERFACE-BLOCK,
 17566           PI-COMM-LENGTH,
 17567           DFHEIV99,
 17568           DFHEIV99,
 17569           DFHEIV99
 17570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17571
 17572
 17573
 17574* GOBACK.
 17575     MOVE '9%                    "   ' TO DFHEIV0
 17576     MOVE 'EL131' TO DFHEIV1
 17577     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17578     GOBACK.
 17579
 17580 9100-RETURN-CICS.
 17581
 17582* EXEC CICS RETURN
 17583*    END-EXEC.
 17584*    MOVE '.(                    ''   #00014569' TO DFHEIV0
 17585     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 17586     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17587     MOVE X'2020233030303134353639' TO DFHEIV0(25:11)
 17588     CALL 'kxdfhei1' USING DFHEIV0,
 17589           DFHEIV99,
 17590           DFHEIV99,
 17591           DFHEIV99,
 17592           DFHEIV99,
 17593           DFHEIV99,
 17594           DFHEIV99
 17595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17596
 17597
 17598
 17599* GOBACK.
 17600     MOVE '9%                    "   ' TO DFHEIV0
 17601     MOVE 'EL131' TO DFHEIV1
 17602     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17603     GOBACK.
 17604
 17605 9200-XCTL.
 17606
 17607* EXEC CICS XCTL
 17608*         PROGRAM    (CALL-PGM)
 17609*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 331
* EL131.cbl
 17610*         LENGTH     (PI-COMM-LENGTH)
 17611*    END-EXEC.
 17612*    MOVE '.$C                   %   #00014575' TO DFHEIV0
 17613     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17614     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17615     MOVE X'2020233030303134353735' TO DFHEIV0(25:11)
 17616     CALL 'kxdfhei1' USING DFHEIV0,
 17617           CALL-PGM,
 17618           PROGRAM-INTERFACE-BLOCK,
 17619           PI-COMM-LENGTH,
 17620           DFHEIV99
 17621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17622
 17623
 17624 9700-LINK-RTRM-FILE-ID.
 17625
 17626* EXEC CICS LINK
 17627*        PROGRAM  (RTRM-FILE-ID)
 17628*        COMMAREA (CALCULATION-PASS-AREA)
 17629*        LENGTH   (CP-COMM-LENGTH)
 17630*    END-EXEC.
 17631*    MOVE '."C                   (   #00014582' TO DFHEIV0
 17632     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17633     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17634     MOVE X'2020233030303134353832' TO DFHEIV0(25:11)
 17635     CALL 'kxdfhei1' USING DFHEIV0,
 17636           RTRM-FILE-ID,
 17637           CALCULATION-PASS-AREA,
 17638           CP-COMM-LENGTH,
 17639           DFHEIV99,
 17640           DFHEIV99,
 17641           DFHEIV99,
 17642           DFHEIV99
 17643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17644
 17645
 17646 9700-EXIT.
 17647      EXIT.
 17648
 17649 9800-CONVERT-DATE.
 17650     MOVE SPACES TO DC-ERROR-CODE.
 17651
 17652* EXEC CICS LINK
 17653*         PROGRAM    (DATE-CONV)
 17654*         COMMAREA   (DATE-CONVERSION-DATA)
 17655*         LENGTH     (DC-COMM-LENGTH)
 17656*    END-EXEC.
 17657*    MOVE '."C                   (   #00014593' TO DFHEIV0
 17658     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17659     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17660     MOVE X'2020233030303134353933' TO DFHEIV0(25:11)
 17661     CALL 'kxdfhei1' USING DFHEIV0,
 17662           DATE-CONV,
 17663           DATE-CONVERSION-DATA,
 17664           DC-COMM-LENGTH,
 17665           DFHEIV99,
 17666           DFHEIV99,
 17667           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 332
* EL131.cbl
 17668           DFHEIV99
 17669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17670
 17671
 17672 9800-EXIT.
 17673     EXIT.
 17674
 17675 9900-ERROR-FORMAT.
 17676
 17677* EXEC CICS LINK
 17678*         PROGRAM    (XCTL-EL001)
 17679*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17680*         LENGTH     (EMI-COMM-LENGTH)
 17681*    END-EXEC.
 17682*    MOVE '."C                   (   #00014603' TO DFHEIV0
 17683     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17684     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17685     MOVE X'2020233030303134363033' TO DFHEIV0(25:11)
 17686     CALL 'kxdfhei1' USING DFHEIV0,
 17687           XCTL-EL001,
 17688           ERROR-MESSAGE-INTERFACE-BLOCK,
 17689           EMI-COMM-LENGTH,
 17690           DFHEIV99,
 17691           DFHEIV99,
 17692           DFHEIV99,
 17693           DFHEIV99
 17694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17695
 17696
 17697 9900-EXIT.
 17698     EXIT.
 17699
 17700 9990-ABEND.
 17701     MOVE DFHEIBLK               TO EMI-LINE1.
 17702
 17703* EXEC CICS LINK
 17704*         PROGRAM   (XCTL-EL004)
 17705*         COMMAREA  (EMI-LINE1)
 17706*         LENGTH    (72)
 17707*     END-EXEC.
 17708     MOVE 72
 17709       TO DFHEIV11
 17710*    MOVE '."C                   (   #00014614' TO DFHEIV0
 17711     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17712     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17713     MOVE X'2020233030303134363134' TO DFHEIV0(25:11)
 17714     CALL 'kxdfhei1' USING DFHEIV0,
 17715           XCTL-EL004,
 17716           EMI-LINE1,
 17717           DFHEIV11,
 17718           DFHEIV99,
 17719           DFHEIV99,
 17720           DFHEIV99,
 17721           DFHEIV99
 17722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17723
 17724
 17725     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 333
* EL131.cbl
 17726
 17727     GO TO 8110-SEND-DATA.
 17728
 17729 9995-SECURITY-VIOLATION.
 17730*           COPY ELCSCTP.
 17731******************************************************************
 17732*                                                                *
 17733*                            ELCSCTP                             *
 17734*                            VMOD=2.001                          *
 17735*                                                                *
 17736*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17737******************************************************************
 17738
 17739
 17740     MOVE EIBDATE          TO SM-JUL-DATE.
 17741     MOVE EIBTRMID         TO SM-TERMID.
 17742     MOVE THIS-PGM         TO SM-PGM.
 17743     MOVE EIBTIME          TO TIME-IN.
 17744     MOVE TIME-OUT         TO SM-TIME.
 17745     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17746
 17747
 17748* EXEC CICS LINK
 17749*         PROGRAM  ('EL003')
 17750*         COMMAREA (SECURITY-MESSAGE)
 17751*         LENGTH   (80)
 17752*    END-EXEC.
 17753     MOVE 'EL003' TO DFHEIV1
 17754     MOVE 80
 17755       TO DFHEIV11
 17756*    MOVE '."C                   (   #00014642' TO DFHEIV0
 17757     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17758     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17759     MOVE X'2020233030303134363432' TO DFHEIV0(25:11)
 17760     CALL 'kxdfhei1' USING DFHEIV0,
 17761           DFHEIV1,
 17762           SECURITY-MESSAGE,
 17763           DFHEIV11,
 17764           DFHEIV99,
 17765           DFHEIV99,
 17766           DFHEIV99,
 17767           DFHEIV99
 17768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17769
 17770
 17771******************************************************************
 17772
 17773
 17774
 17775 9999-DFHBACK SECTION.
 17776     MOVE '9%                    "   ' TO DFHEIV0
 17777     MOVE 'EL131' TO DFHEIV1
 17778     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17779     GOBACK.
 17780 9999-DFHEXIT.
 17781     IF DFHEIGDJ EQUAL 0001
 17782         NEXT SENTENCE
 17783     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 334
* EL131.cbl
 17784         GO TO 8820-XCTL-ERROR,
 17785               8150-ENTERED-CLAIM-NOTFOUND,
 17786               9990-ABEND
 17787         DEPENDING ON DFHEIGDI
 17788     ELSE IF DFHEIGDJ EQUAL 3
 17789         GO TO 0130-TS-ERROR,
 17790               0130-TS-ERROR
 17791         DEPENDING ON DFHEIGDI
 17792     ELSE IF DFHEIGDJ EQUAL 4
 17793         GO TO 0600-CONTINUE-NAME-UPDATE
 17794         DEPENDING ON DFHEIGDI
 17795     ELSE IF DFHEIGDJ EQUAL 5
 17796         GO TO 1004-BENE-NOT-FOUND
 17797         DEPENDING ON DFHEIGDI
 17798     ELSE IF DFHEIGDJ EQUAL 6
 17799         GO TO 1052-DONE,
 17800               1052-DONE
 17801         DEPENDING ON DFHEIGDI
 17802     ELSE IF DFHEIGDJ EQUAL 7
 17803         GO TO 1120-CNTL-NOTFND
 17804         DEPENDING ON DFHEIGDI
 17805     ELSE IF DFHEIGDJ EQUAL 8
 17806         GO TO 1150-NOTOPEN-ERROR,
 17807               1150-EXIT
 17808         DEPENDING ON DFHEIGDI
 17809     ELSE IF DFHEIGDJ EQUAL 9
 17810         GO TO 1490-STATE-NOTFND
 17811         DEPENDING ON DFHEIGDI
 17812     ELSE IF DFHEIGDJ EQUAL 10
 17813         GO TO 1500-CARR-NOTFND
 17814         DEPENDING ON DFHEIGDI
 17815     ELSE IF DFHEIGDJ EQUAL 11
 17816         GO TO 1620-ACCT-NOTFND
 17817         DEPENDING ON DFHEIGDI
 17818     ELSE IF DFHEIGDJ EQUAL 12
 17819         GO TO 2020-EXIT
 17820         DEPENDING ON DFHEIGDI
 17821     ELSE IF DFHEIGDJ EQUAL 13
 17822         GO TO 2030-EXIT
 17823         DEPENDING ON DFHEIGDI
 17824     ELSE IF DFHEIGDJ EQUAL 14
 17825         GO TO 2040-EXIT
 17826         DEPENDING ON DFHEIGDI
 17827     ELSE IF DFHEIGDJ EQUAL 15
 17828         GO TO 2050-EXIT
 17829         DEPENDING ON DFHEIGDI
 17830     ELSE IF DFHEIGDJ EQUAL 16
 17831         GO TO 2060-CERT-NOTFND
 17832         DEPENDING ON DFHEIGDI
 17833     ELSE IF DFHEIGDJ EQUAL 17
 17834         GO TO 2060-DUPKEY
 17835         DEPENDING ON DFHEIGDI
 17836     ELSE IF DFHEIGDJ EQUAL 18
 17837         GO TO 2070-NOT-FOUND
 17838         DEPENDING ON DFHEIGDI
 17839     ELSE IF DFHEIGDJ EQUAL 19
 17840         GO TO 2070-EXIT
 17841         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 335
* EL131.cbl
 17842     ELSE IF DFHEIGDJ EQUAL 20
 17843         GO TO 2080-EXIT
 17844         DEPENDING ON DFHEIGDI
 17845     ELSE IF DFHEIGDJ EQUAL 21
 17846         GO TO 2400-TRLR-NOTFND,
 17847               2410-EXIT
 17848         DEPENDING ON DFHEIGDI
 17849     ELSE IF DFHEIGDJ EQUAL 22
 17850         GO TO 2425-NINETY-NOTFND,
 17851               2425-NINETY-NOTFND
 17852         DEPENDING ON DFHEIGDI
 17853     ELSE IF DFHEIGDJ EQUAL 23
 17854         GO TO 2430-EXIT,
 17855               2440-EXIT
 17856         DEPENDING ON DFHEIGDI
 17857     ELSE IF DFHEIGDJ EQUAL 24
 17858         GO TO 2440-EXIT
 17859         DEPENDING ON DFHEIGDI
 17860     ELSE IF DFHEIGDJ EQUAL 25
 17861         GO TO 2460-EXIT
 17862         DEPENDING ON DFHEIGDI
 17863     ELSE IF DFHEIGDJ EQUAL 26
 17864         GO TO 2475-EXIT
 17865         DEPENDING ON DFHEIGDI
 17866     ELSE IF DFHEIGDJ EQUAL 27
 17867         GO TO 2650-EXIT
 17868         DEPENDING ON DFHEIGDI
 17869     ELSE IF DFHEIGDJ EQUAL 28
 17870         GO TO 2800-EXIT,
 17871               2800-EXIT
 17872         DEPENDING ON DFHEIGDI
 17873     ELSE IF DFHEIGDJ EQUAL 29
 17874         GO TO 3010-DEL-ACTQ,
 17875               3040-EXIT
 17876         DEPENDING ON DFHEIGDI
 17877     ELSE IF DFHEIGDJ EQUAL 30
 17878         GO TO 3010-NO-ACTIVITY,
 17879               3050-EXIT
 17880         DEPENDING ON DFHEIGDI
 17881     ELSE IF DFHEIGDJ EQUAL 31
 17882         GO TO 3010-CERT-NOT-FOUND
 17883         DEPENDING ON DFHEIGDI
 17884     ELSE IF DFHEIGDJ EQUAL 32
 17885         GO TO 3020-EXIT
 17886         DEPENDING ON DFHEIGDI
 17887     ELSE IF DFHEIGDJ EQUAL 33
 17888         GO TO 3060-EXIT,
 17889               3060-EXIT
 17890         DEPENDING ON DFHEIGDI
 17891     ELSE IF DFHEIGDJ EQUAL 34
 17892         GO TO 5000-TRLR-NOT-FOUND
 17893         DEPENDING ON DFHEIGDI
 17894     ELSE IF DFHEIGDJ EQUAL 35
 17895         GO TO 5000-CERT-NOT-FOUND
 17896         DEPENDING ON DFHEIGDI
 17897     ELSE IF DFHEIGDJ EQUAL 36
 17898         GO TO 1052-DONE,
 17899               1052-DONE
* Micro Focus Server Express         V5.1 revision 000 14-Feb-18 10:29 Page 336
* EL131.cbl
 17900         DEPENDING ON DFHEIGDI
 17901     ELSE IF DFHEIGDJ EQUAL 37
 17902         GO TO 7630-END-BROWSE
 17903         DEPENDING ON DFHEIGDI
 17904     ELSE IF DFHEIGDJ EQUAL 38
 17905         GO TO 7799-EXIT,
 17906               7799-EXIT
 17907         DEPENDING ON DFHEIGDI
 17908     ELSE IF DFHEIGDJ EQUAL 39
 17909         GO TO 7799-EXIT
 17910         DEPENDING ON DFHEIGDI
 17911     ELSE IF DFHEIGDJ EQUAL 40
 17912         GO TO 7800-NOT-FOUND
 17913         DEPENDING ON DFHEIGDI
 17914     ELSE IF DFHEIGDJ EQUAL 41
 17915         GO TO 8000-NOTE-NOT-FOUND
 17916         DEPENDING ON DFHEIGDI
 17917     ELSE IF DFHEIGDJ EQUAL 42
 17918         GO TO 8990-SEND-TEXT
 17919         DEPENDING ON DFHEIGDI.
 17920     MOVE '9%                    "   ' TO DFHEIV0
 17921     MOVE 'EL131' TO DFHEIV1
 17922     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17923     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14196     Code:       62868
