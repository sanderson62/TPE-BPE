* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49******************************************************************
    50 ENVIRONMENT DIVISION.
    51
    52 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   3
* EL050.cbl
    54 WORKING-STORAGE SECTION.
    55 01  DFH-START PIC X(04).
    56
    57 77  FILLER   PIC X(32) VALUE '********************************'.
    58 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    59 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    60
    61 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    62 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    63                                   USAGE POINTER.
    64 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    65 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    67                                   USAGE IS POINTER.
    68 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    69 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    70                                   USAGE IS POINTER.
    71 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    72 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    73                                   USAGE IS POINTER.
    74
    75 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    76 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    77                                   USAGE IS POINTER.
    78
    79*    COPY ELC50WS.
    80*****************************************************************
    81*                                                               *
    82*                            ELC50WS.                           *
    83*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    84*                            VMOD=2.061.                        *
    85*                                                               *
    86*   THIS IS THE WORKING STORAGE FOR EL050                       *
    87*                                   EL517                       *
    88*****************************************************************
    89******************************************************************
    90*                   C H A N G E   L O G
    91*
    92* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    93*-----------------------------------------------------------------
    94*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    95* EFFECTIVE    NUMBER
    96*-----------------------------------------------------------------
    97* 123102                   PEMA  ADD DCC PROCESSING
    98* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    99* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   100* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   101* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   102* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   103* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   104* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   105* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   106* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   107* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   108* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   109* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   110* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   111* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   4
* EL050.cbl
   112* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   113* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   114* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   115* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   116* 030309  CR2009021700001  PEMA  ADD ER-2883
   117* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   118* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   119* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   120* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   121* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   122* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   123* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   124* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   125* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   126* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   127* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   128* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   129* 061412  CR2011022800001  AJRA  NAPERSOFT
   130* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   131* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   132* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   133* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   134* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   135* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   136* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   137*-----------------------------------------------------------------
   138
   139 01  WORK-AREAS.
   140
   141*****************************************************************
   142*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   143*****************************************************************
   144
   145     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   146     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   147     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   148     12  WS-NAME-EDIT-WORK-AREA.
   149         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   150         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   151             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   152         16  WS-WORK-NAME.
   153             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   154             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   155             20  FILLER           PIC X(10)     VALUE SPACES.
   156         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   157             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   158
   159*****************************************************************
   160*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   161*****************************************************************
   162
   163     12  WS-ERRESC-KEY.
   164         16 WS-ERRESC-SEARCH-KEY.
   165             20  WS-ERRESC-COMPANY-CD PIC  X.
   166             20  WS-ERRESC-CARRIER    PIC  X.
   167             20  WS-ERRESC-GROUP      PIC X(6).
   168             20  WS-ERRESC-STATE      PIC XX.
   169             20  WS-ERRESC-ACCOUNT    PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   5
* EL050.cbl
   170         16 WS-ERRESC-RESIDUAL-KEY.
   171             20  WS-ERRESC-AGENT      PIC X(10).
   172             20  WS-ERRESC-RES-STATE  PIC XX.
   173             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   174*                                          YYYYMMDD
   175     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   176     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   177
   178*RESIDENT STATE TAX MASTER(ERRESS)
   179*
   180     12  WS-ERRESS-KEY.
   181         16  WS-ERRESS-COMPANY-CD      PIC  X.
   182         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   183         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   184         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   185*                                          YYYYMMDD
   186
   187     12  WS-CONTRACT-DATE              PIC 9(8).
   188*                                          YYYYMMDD
   189     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   190     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   191         16 WS-YEAR-YY                 PIC   9999.
   192         16 FILLER                     PIC 9(4).
   193*                                          YYYYMMDD
   194     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   195     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   196     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   197     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   198
   199     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   200         88  DPRB-1ST-TIME                      VALUE ' '.
   201
   202*****************************************************************
   203*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   204*****************************************************************
   205
   206     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   207     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   208     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   209     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   210     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   211     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   212     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   213     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   214     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   215     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   216         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   217         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   218     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   219         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   220         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   221     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   222
   223     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   224     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   225
   226     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   227     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   6
* EL050.cbl
   228     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   230     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   231     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   232     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   233     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   237     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   238     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   239     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   240     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   241     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   249     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   250     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   257     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   258     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   259     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   260     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   261     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   262     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   263     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   264     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   265     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   266     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   267     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   268     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   269     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   270     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   271     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   272     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   273     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   274     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   275     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   276     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   277     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   278     12  WS-2671-SW               PIC X         VALUE SPACE.
   279     12  WS-2672-SW               PIC X         VALUE SPACE.
   280     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   281         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   282     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   283         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   284     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   285
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   7
* EL050.cbl
   286     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   287         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   288         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   289         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   290         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   291
   292     12  WS-CREDIT-EDIT-CONTROLS.
   293         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   294         16  WS-MIN-AGE           PIC 99                VALUE  0.
   295         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   296         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   297         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   298         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   299
   300     12  WS-AGE-FIELDS.
   301         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   302         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   303         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   304         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   305
   306     12  WS-SAVE-ALLOWABLE-BENEFIT.
   307         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   308         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   309         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   310         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   311         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   312         16  FILLER                      PIC XX.
   313
   314     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   315     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   316     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   317     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   318     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   319     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   320     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   321     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   322     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   323     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   324
   325     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   326     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   327     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   328     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   329     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   330     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   331     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   332     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   333         88  WS-REDUCING              VALUE 'R'.
   334         88  WS-LEVEL                 VALUE 'L' 'P'.
   335     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   336
   337     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   338     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   339     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   340     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   341     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   342     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   343     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   8
* EL050.cbl
   344     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   345     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   346
   347     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   348     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   349     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   350     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   351     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   352     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   353     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   354     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   355     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   356     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   357     12  WS-ACCT-SIG-SW.
   358         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   359         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   360     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   361     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   362     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   363     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   364     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   365     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   366     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   367     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   368     12  WS-INITIALS.
   369         16  WS-INIT-1            PIC X         VALUE SPACES.
   370         16  WS-INIT-2            PIC X         VALUE SPACES.
   371
   372     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   373     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   374     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   375     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   376     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   377*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   378     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   379     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   380     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   381     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   382     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   383     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   384     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   385     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   386     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   387     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   388     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   389     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   390     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   391     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   392     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   393     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   394     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   395     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   396     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   397     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   398     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   399     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   400******** FLA
   401     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page   9
* EL050.cbl
   402     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   403     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   404     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   405     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   406********
   407     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   408     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   409     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   410     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   411     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   412     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   413     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   414     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   415     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   416     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   417
   418     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   419         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   420                                         '0' THRU '9'.
   421
   422     12  NUMBER-OF-MONTHS.
   423         16  SK-MO OCCURS 12 TIMES PIC X.
   424
   425     12  WS-WORK-DATE.
   426         16  WS-YEAR            PIC 99    VALUE 00.
   427         16  WS-MONTH           PIC 99    VALUE 00.
   428         16  WS-DAY             PIC 99    VALUE 00.
   429
   430     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   431     12  WS-WORK-CRIT-DEV       REDEFINES
   432         WS-WORK-LF-CRIT-PER    PIC X(03).
   433
   434     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   435     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   436
   437     12  WS-WORK-DATE-FROM.
   438         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   439         16  FILLER             PIC X  VALUE SPACE.
   440         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   441         16  FILLER             PIC X         VALUE SPACE.
   442         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   443
   444     12  WS-WORK-DATE-THRU.
   445         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   446         16  FILLER             PIC X         VALUE SPACE.
   447         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   448         16  FILLER             PIC X         VALUE SPACE.
   449         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   450
   451     12  WS-LF-INPUT-CD.
   452         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   453         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   454
   455     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   456     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   457         16  WS-AH-INPUT-CD-1   PIC X.
   458         16  WS-AH-INPUT-CD-2-3 PIC XX.
   459
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  10
* EL050.cbl
   460     12  WS-SWITCHES.
   461         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   462         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   463             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   464         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   465             88  BANK-ACCT-FOUND          VALUE 'Y'.
   466         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   467             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   468         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   469             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   470         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   471             88  COMP-MASTER-FOUND        VALUE 'Y'.
   472         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   473             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   474         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   475             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   476         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   477             88  STAT-MASTER-FOUND        VALUE 'Y'.
   478         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   479             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   480         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   481             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   482         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   483             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   484         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   485             88  FORM-MASTER-FOUND        VALUE 'Y'.
   486         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   487             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   488         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   489             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   490         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   491             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   492         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   493             88  NO-BENEFIT-FOUND         VALUE 'N'.
   494         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   495             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   496         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   497             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   498         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   499             88  AH-BENEFIT-FOUND         VALUE ' '.
   500             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   501         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   502             88  LF-BENEFIT-FOUND         VALUE ' '.
   503             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   504         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   505             88  NO-STATE-RECORD          VALUE '1'.
   506         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   507             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   508         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   509             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   510         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   511             88  CERT-WAS-FOUND           VALUE ' '.
   512             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   513         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   514             88  BROWSE-STARTED           VALUE 'Y'.
   515         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   516             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   517         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  11
* EL050.cbl
   518             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   519         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   520             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   521         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   522             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   523         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   524             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   525         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   526             88  APP-CERT-USED            VALUE 'Y' 'A'.
   527         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   528             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   529             88  FIRST-TIME-THROUGH       VALUE '1'.
   530             88  CTBL-NOT-FOUND           VALUE '2'.
   531
   532         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   533             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   534
   535         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   536             88  DLO-ERROR-FOUND          VALUE 'Y'.
   537
   538********FLA
   539     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   540     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   541********
   542     12  RC-SW-1                  PIC X           VALUE '0'.
   543     12  RC-SW-2                  PIC X           VALUE '0'.
   544     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   545     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   546     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   547     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   548     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   549     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   550     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   551     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   552     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   553     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   554     12  LIT-SPACES               PIC X           VALUE SPACES.
   555     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   556     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   557     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   558     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   559     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   560     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   561     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   562         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   563         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   564     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   565         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   566
   567 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   568     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   569     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   570 01  WS-CRI-SSN-WORK-AREA.
   571     05  WS-CRI-SOC-SEC-NO.
   572         10  WS-SS-REPT-CD       PIC X(5).
   573         10  WS-SS-LAST-NAME     PIC X(5).
   574         10  WS-SS-INITIAL       PIC X.
   575
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  12
* EL050.cbl
   576     05  WS-CRI-REPORT-CODE.
   577         10  FILLER              PIC X(5).
   578         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   579
   580     05  WS-CRI-LAST-NAME.
   581         10  WS-CRI-NAME-MOVE    PIC X(5).
   582         10  FILLER              PIC X(10).
   583
   584 01  WS-NUM-TABLE                PIC X(26)  VALUE
   585     '12345678012345070923456789'.
   586 01  FILLER REDEFINES WS-NUM-TABLE.
   587     05  WS-NUM OCCURS 26        PIC 9.
   588 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   589 01  V1                          PIC S999 COMP-3.
   590 01  V2                          PIC S999 COMP-3.
   591 01  V3                          PIC S999 COMP-3.
   592 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   593 01  FILLER REDEFINES WS-WORK-VIN.
   594     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   595 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   596 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   597 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   598 01  WS-HEX-WORK.
   599     05  FILLER                  PIC X  VALUE LOW-VALUES.
   600     05  WS-HEX-BYTE             PIC X.
   601 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   602 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   603 01  WS-WORK-HIN-ROW-B.
   604     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   605
   606 01  ws-benefit-cd-chg-sw      pic x value spaces.
   607     88  benefit-code-chg           value 'Y'.
   608 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   609 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   610     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   611 01  WS-ROW-D-TABLE.
   612     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   613
   614 01  WS-HIN-TABLE-B.
   615     05  F                       PIC XX VALUE 'A2'.
   616     05  F                       PIC XX VALUE 'B3'.
   617     05  F                       PIC XX VALUE 'C4'.
   618     05  F                       PIC XX VALUE 'D5'.
   619     05  F                       PIC XX VALUE 'E6'.
   620     05  F                       PIC XX VALUE 'F7'.
   621     05  F                       PIC XX VALUE 'G8'.
   622     05  F                       PIC XX VALUE 'H9'.
   623     05  F                       PIC XX VALUE 'I1'.
   624     05  F                       PIC XX VALUE 'J2'.
   625     05  F                       PIC XX VALUE 'K3'.
   626     05  F                       PIC XX VALUE 'L4'.
   627     05  F                       PIC XX VALUE 'M5'.
   628     05  F                       PIC XX VALUE 'N6'.
   629     05  F                       PIC XX VALUE 'O0'.
   630     05  F                       PIC XX VALUE 'P7'.
   631     05  F                       PIC XX VALUE 'Q0'.
   632     05  F                       PIC XX VALUE 'R8'.
   633     05  F                       PIC XX VALUE 'S9'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  13
* EL050.cbl
   634     05  F                       PIC XX VALUE 'T2'.
   635     05  F                       PIC XX VALUE 'U3'.
   636     05  F                       PIC XX VALUE 'V4'.
   637     05  F                       PIC XX VALUE 'W5'.
   638     05  F                       PIC XX VALUE 'X6'.
   639     05  F                       PIC XX VALUE 'Y7'.
   640     05  F                       PIC XX VALUE 'Z8'.
   641 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   642     05  WS-VAL-IN               PIC X.
   643     05  WS-VAL-OUT              PIC 9.
   644 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   645 01  WS-COMPARE-BINARY-DATES.
   646     05  WS-971231                PIC XX VALUE X'92FF'.
   647     05  WS-931231                PIC XX VALUE X'8CFF'.
   648     05  WS-791231                PIC XX VALUE X'77FF'.
   649     05  WS-771001                PIC XX VALUE X'74A1'.
   650     05  WS-820301                PIC XX VALUE X'7B41'.
   651     05  WS-831031                PIC XX VALUE X'7DBF'.
   652     05  WS-831231                PIC XX VALUE X'7DFF'.
   653     05  WS-810831                PIC XX VALUE X'7A7F'.
   654     05  WS-830901                PIC XX VALUE X'7D81'.
   655
   656 01  FILE-ACCESS-IDS.
   657     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   658     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   659     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   660     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   661     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   662     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   663     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   664     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   665     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   666     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   667     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   668     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   669     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   670     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   671     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   672     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   673     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   674 01  DD-IU-SW                    PIC X   VALUE ' '.
   675     88  DD-IU-PRESENT                 VALUE 'Y'.
   676
   677 01  ACCESS-KEYS.
   678     12  ELMSTR-KEY.
   679         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   680         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   681     12  W-CLAIM-KEY.
   682         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   683         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   684
   685     12  ELCNTL-KEY.
   686         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   687         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   688         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   689         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   690
   691     12  ELCERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  14
* EL050.cbl
   692         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   693         16  CERT-CARRIER         PIC X       VALUE SPACE.
   694         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   695         16  CERT-STATE           PIC XX      VALUE SPACES.
   696         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   697         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   698         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   699
   700     12  ELCERT2-KEY.
   701         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   702         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   703
   704     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   705
   706     12  ELCERT-SAVE.
   707         16  FILLER                      PIC XX    VALUE SPACES.
   708
   709         16  WCS-CONTROL-PRIMARY.
   710             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   711             20  WCS-CARRIER             PIC X     VALUE SPACE.
   712             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   713             20  WCS-STATE               PIC XX    VALUE SPACES.
   714             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   715             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   716             20  WCS-CERT-NO.
   717                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   718                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   719
   720         16  CS-CONTROL-BY-NAME.
   721             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   722             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   723             20  CS-INSURED-INITIALS.
   724                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   725                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   726
   727         16  CS-CONTROL-BY-SSN.
   728             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   729             20  CS-SOC-SEC-NO.
   730                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   731                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   732                 24  CS-SSN-LN3.
   733                     28 CS-INSURED-INITIALS-A2   PIC XX
   734                                     VALUE SPACES.
   735                     28 CS-PART-LAST-NAME-A2     PIC X
   736                                     VALUE SPACE.
   737
   738         16  CS-CONTROL-BY-CERT-NO.
   739             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   740             20  CS-CERT-NO-A4           PIC X(11)
   741                                     VALUE SPACES.
   742
   743         16  CS-CONTROL-BY-MEMB.
   744             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   745             20  CS-MEMBER-NO.
   746                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   747                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   748                 24  CS-MEMB-LN4.
   749                     28 CS-INSURED-INITIALS-A5   PIC XX
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  15
* EL050.cbl
   750                                      VALUE SPACES.
   751                     28 CS-PART-LAST-NAME-A5     PIC XX
   752                                      VALUE SPACES.
   753
   754         16  FILLER              PIC X(360) VALUE SPACES.
   755
   756     12  ERACCT-KEY.
   757         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   758         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   759         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   760         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   761         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   762         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   763
   764     12  ERCOMP-KEY.
   765         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   766         16  COMP-CARRIER         PIC X     VALUE SPACES.
   767         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   768         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   769         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   770         16  COMP-TYPE            PIC X     VALUE SPACES.
   771
   772     12  ERLOFC-KEY.
   773         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   774         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   775         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   776         16  LOFC-STATE           PIC XX    VALUE SPACES.
   777         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   778         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   779
   780     12  WS-ELCRTT-KEY.
   781         16  WS-ELCRTT-PRIMARY       PIC X(33).
   782         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   783
   784     12  ERBXRF-KEY.
   785         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   786         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   787         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   788         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   789
   790     12  ERAGTC-KEY.
   791         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   792         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   793         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   794         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   795         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   796         16  AGTC-TYPE            PIC X     VALUE SPACES.
   797
   798     12  ERPLAN-KEY.
   799         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   800         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   801         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   802         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   803         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   804         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   805         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   806         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   807
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  16
* EL050.cbl
   808     12  ERFORM-KEY.
   809         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   810         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   811         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   812         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   813
   814     12  ERREIN-KEY.
   815         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   816         16  REIN-TYPE            PIC X     VALUE SPACES.
   817         16  REIN-TABLE-CO.
   818             20  REIN-CODE-1      PIC X     VALUE SPACE.
   819             20  REIN-CODE-2      PIC X     VALUE SPACE.
   820             20  REIN-CODE-3      PIC X     VALUE SPACE.
   821         16  FILLER               PIC X(3)  VALUE SPACES.
   822
   823     12  ERCTBL-KEY.
   824         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   825         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   826         16  CTBL-CNTRL-2.
   827             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   828             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   829
   830     12  ELCRTO-KEY.
   831         16  ELCRTO-COMPANY-CD       PIC X.
   832         16  ELCRTO-CARRIER          PIC X.
   833         16  ELCRTO-GROUPING         PIC X(6).
   834         16  ELCRTO-STATE            PIC XX.
   835         16  ELCRTO-ACCOUNT          PIC X(10).
   836         16  ELCRTO-CERT-EFF-DT      PIC XX.
   837         16  ELCRTO-CERT-NO.
   838             20  ELCRTO-CERT-PRIME   PIC X(10).
   839             20  ELCRTO-CERT-SFX     PIC X.
   840         16  ELCRTO-RECORD-TYPE      PIC X.
   841         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   842
   843
   844     12  WS-ACCESS.
   845         16  FILLER               PIC XX    VALUE SPACES.
   846         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   847
   848     12  WS-CARR-ACCESS.
   849         16  FILLER               PIC X(3)  VALUE SPACES.
   850         16  WS-CARR              PIC X     VALUE SPACE.
   851*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   852*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   853     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   854         88  WS-DMD-LF-RATING   VALUE 'Y'.
   855         88  WS-DMD-AH-RATING   VALUE 'Y'.
   856         88  WS-DMD-NO-RATING   VALUE 'N'.
   857
   858     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   859         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   860                                         'NJ' 'NL'
   861                                         'PJ' 'PL'
   862                                         'SJ' 'SL'.
   863     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   864         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   865                                         'NI' 'NJ' 'NL' 'NU'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  17
* EL050.cbl
   866                                         'PJ' 'PL' 'PI' 'PU'
   867                                         'SI' 'SJ' 'SL' 'SU'
   868                                         'MX' 'MY' 'MZ'.
   869 01  ERPDEF-KEY-SAVE             PIC X(18).
   870 01  ERPDEF-KEY.
   871     12  ERPDEF-COMPANY-CD       PIC X.
   872     12  ERPDEF-STATE            PIC XX.
   873     12  ERPDEF-PROD-CD          PIC XXX.
   874     12  F                       PIC X(7).
   875     12  ERPDEF-BEN-TYPE         PIC X.
   876     12  ERPDEF-BEN-CODE         PIC XX.
   877     12  ERPDEF-EXP-DT           PIC XX.
   878
   879 01  ELSTAT-KEY-SAVE             PIC X(20).
   880 01  ELSTAT-KEY.
   881     12  ELSTAT-COMPANY-ID       PIC XXX.
   882     12  ELSTAT-CARRIER          PIC X.
   883     12  ELSTAT-GROUP            PIC X(6).
   884     12  ELSTAT-STATE            PIC XX.
   885     12  ELSTAT-EXP-DT           PIC 9(8).
   886 01  WS-ERROR-VALUES.
   887     12  ER-1570                     PIC S9(4)   VALUE +1570.
   888     12  ER-1571                     PIC S9(4)   VALUE +1571.
   889     12  er-1572                     pic s9(4)   value +1572.
   890     12  er-1573                     pic s9(4)   value +1573.
   891     12  er-1574                     pic s9(4)   value +1574.
   892     12  ER-1575                     PIC S9(4)   VALUE +1575.
   893     12  ER-1891                     PIC S9(4)   VALUE +1891.
   894     12  ER-1892                     PIC S9(4)   VALUE +1892.
   895     12  ER-1893                     PIC S9(4)   VALUE +1893.
   896     12  ER-1894                     PIC S9(4)   VALUE +1894.
   897     12  ER-1895                     PIC S9(4)   VALUE +1895.
   898     12  ER-1896                     PIC S9(4)   VALUE +1896.
   899     12  ER-1897                     PIC S9(4)   VALUE +1897.
   900     12  ER-1898                     PIC S9(4)   VALUE +1898.
   901     12  ER-1899                     PIC S9(4)   VALUE +1899.
   902     12  ER-1900                     PIC S9(4)   VALUE +1900.
   903     12  ER-1901                     PIC S9(4)   VALUE +1901.
   904     12  ER-1902                     PIC S9(4)   VALUE +1902.
   905     12  ER-1903                     PIC S9(4)   VALUE +1903.
   906     12  ER-1904                     PIC S9(4)   VALUE +1904.
   907     12  ER-1905                     PIC S9(4)   VALUE +1905.
   908     12  ER-1906                     PIC S9(4)   VALUE +1906.
   909     12  ER-1907                     PIC S9(4)   VALUE +1907.
   910     12  ER-1909                     PIC S9(4)   VALUE +1909.
   911     12  ER-1910                     PIC S9(4)   VALUE +1910.
   912     12  ER-1911                     PIC S9(4)   VALUE +1911.
   913     12  ER-1912                     PIC S9(4)   VALUE +1912.
   914     12  ER-1913                     PIC S9(4)   VALUE +1913.
   915     12  ER-1914                     PIC S9(4)   VALUE +1914.
   916     12  ER-1915                     PIC S9(4)   VALUE +1915.
   917     12  ER-1916                     PIC S9(4)   VALUE +1916.
   918     12  ER-1917                     PIC S9(4)   VALUE +1917.
   919     12  ER-1918                     PIC S9(4)   VALUE +1918.
   920     12  ER-1919                     PIC S9(4)   VALUE +1919.
   921     12  ER-1920                     PIC S9(4)   VALUE +1920.
   922     12  ER-1921                     PIC S9(4)   VALUE +1921.
   923     12  ER-1922                     PIC S9(4)   VALUE +1922.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  18
* EL050.cbl
   924     12  ER-1923                     PIC S9(4)   VALUE +1923.
   925     12  ER-1924                     PIC S9(4)   VALUE +1924.
   926     12  ER-1925                     PIC S9(4)   VALUE +1925.
   927     12  ER-1926                     PIC S9(4)   VALUE +1926.
   928     12  ER-1927                     PIC S9(4)   VALUE +1927.
   929     12  ER-2393                     PIC S9(4)   VALUE +2393.
   930     12  ER-2600                     PIC S9(4)   VALUE +2600.
   931     12  ER-2601                     PIC S9(4)   VALUE +2601.
   932     12  ER-2602                     PIC S9(4)   VALUE +2602.
   933     12  ER-2603                     PIC S9(4)   VALUE +2603.
   934     12  ER-2604                     PIC S9(4)   VALUE +2604.
   935     12  ER-2605                     PIC S9(4)   VALUE +2605.
   936     12  ER-2606                     PIC S9(4)   VALUE +2606.
   937     12  ER-2607                     PIC S9(4)   VALUE +2607.
   938     12  ER-2608                     PIC S9(4)   VALUE +2608.
   939     12  ER-2609                     PIC S9(4)   VALUE +2609.
   940     12  ER-2610                     PIC S9(4)   VALUE +2610.
   941     12  ER-2611                     PIC S9(4)   VALUE +2611.
   942     12  ER-2612                     PIC S9(4)   VALUE +2612.
   943     12  ER-2613                     PIC S9(4)   VALUE +2613.
   944     12  ER-2614                     PIC S9(4)   VALUE +2614.
   945     12  ER-2615                     PIC S9(4)   VALUE +2615.
   946     12  ER-2616                     PIC S9(4)   VALUE +2616.
   947     12  ER-2617                     PIC S9(4)   VALUE +2617.
   948     12  ER-2618                     PIC S9(4)   VALUE +2618.
   949     12  ER-2619                     PIC S9(4)   VALUE +2619.
   950     12  ER-2620                     PIC S9(4)   VALUE +2620.
   951     12  ER-2621                     PIC S9(4)   VALUE +2621.
   952     12  ER-2622                     PIC S9(4)   VALUE +2622.
   953     12  ER-2623                     PIC S9(4)   VALUE +2623.
   954     12  ER-2624                     PIC S9(4)   VALUE +2624.
   955     12  ER-2625                     PIC S9(4)   VALUE +2625.
   956     12  ER-2626                     PIC S9(4)   VALUE +2626.
   957     12  ER-2627                     PIC S9(4)   VALUE +2627.
   958     12  ER-2628                     PIC S9(4)   VALUE +2628.
   959     12  ER-2629                     PIC S9(4)   VALUE +2629.
   960     12  ER-2630                     PIC S9(4)   VALUE +2630.
   961     12  ER-2631                     PIC S9(4)   VALUE +2631.
   962     12  ER-2632                     PIC S9(4)   VALUE +2632.
   963     12  ER-2633                     PIC S9(4)   VALUE +2633.
   964     12  ER-2634                     PIC S9(4)   VALUE +2634.
   965     12  ER-2635                     PIC S9(4)   VALUE +2635.
   966     12  ER-2636                     PIC S9(4)   VALUE +2636.
   967     12  ER-2637                     PIC S9(4)   VALUE +2637.
   968     12  ER-2638                     PIC S9(4)   VALUE +2638.
   969     12  ER-2639                     PIC S9(4)   VALUE +2639.
   970     12  ER-2640                     PIC S9(4)   VALUE +2640.
   971     12  ER-2641                     PIC S9(4)   VALUE +2641.
   972     12  ER-2642                     PIC S9(4)   VALUE +2642.
   973     12  ER-2643                     PIC S9(4)   VALUE +2643.
   974     12  ER-2644                     PIC S9(4)   VALUE +2644.
   975     12  ER-2645                     PIC S9(4)   VALUE +2645.
   976     12  ER-2646                     PIC S9(4)   VALUE +2646.
   977     12  ER-2647                     PIC S9(4)   VALUE +2647.
   978     12  ER-2648                     PIC S9(4)   VALUE +2648.
   979     12  ER-2649                     PIC S9(4)   VALUE +2649.
   980     12  ER-2650                     PIC S9(4)   VALUE +2650.
   981     12  ER-2651                     PIC S9(4)   VALUE +2651.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  19
* EL050.cbl
   982     12  ER-2652                     PIC S9(4)   VALUE +2652.
   983     12  ER-2653                     PIC S9(4)   VALUE +2653.
   984     12  ER-2654                     PIC S9(4)   VALUE +2654.
   985     12  ER-2655                     PIC S9(4)   VALUE +2655.
   986     12  ER-2656                     PIC S9(4)   VALUE +2656.
   987     12  ER-2657                     PIC S9(4)   VALUE +2657.
   988     12  ER-2658                     PIC S9(4)   VALUE +2658.
   989     12  ER-2659                     PIC S9(4)   VALUE +2659.
   990     12  ER-2660                     PIC S9(4)   VALUE +2660.
   991     12  ER-2661                     PIC S9(4)   VALUE +2661.
   992     12  ER-2662                     PIC S9(4)   VALUE +2662.
   993     12  ER-2663                     PIC S9(4)   VALUE +2663.
   994     12  ER-2664                     PIC S9(4)   VALUE +2664.
   995     12  ER-2665                     PIC S9(4)   VALUE +2665.
   996     12  ER-2666                     PIC S9(4)   VALUE +2666.
   997     12  ER-2667                     PIC S9(4)   VALUE +2667.
   998     12  ER-2668                     PIC S9(4)   VALUE +2668.
   999     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1000     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1001     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1002     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1003     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1004     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1005     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1006     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1007     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1008     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1009     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1010     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1011     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1012     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1013     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1014     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1015     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1016     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1017     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1018     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1019     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1020     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1021     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1022     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1023     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1024     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1025     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1026     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1027     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1028     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1029     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1030     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1031     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1032     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1033     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1034     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1035     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1036     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1037     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1038     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1039     12  ER-2718                     PIC S9(4)   VALUE +2718.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  20
* EL050.cbl
  1040     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1041     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1042     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1043     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1044     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1045     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1046     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1047     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1048     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1049     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1050     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1051     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1052     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1053     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1054     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1055     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1056     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1057     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1058     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1059     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1060     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1061     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1062     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1063     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1064     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1065     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1066     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1067     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1068     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1069     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1070     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1071     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1072     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1073     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1074     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1075     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1076     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1077     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1078     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1079     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1080     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1081     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1082     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1083     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1084     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1085     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1086     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1087     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1088     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1089     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1090     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1091     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1092     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1093     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1094     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1095     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1096     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1097     12  ER-2777                     PIC S9(4)   VALUE +2777.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  21
* EL050.cbl
  1098     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1099     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1100     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1101     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1102     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1103     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1104     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1105     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1106     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1107     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1108     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1109     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1110     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1111     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1112     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1113     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1114     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1115     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1116     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1117     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1118     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1119     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1120     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1121     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1122     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1123     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1124     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1125     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1126     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1127     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1128     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1129     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1130     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1131     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1132     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1133     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1134     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1135     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1136     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1137     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1138     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1139     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1140     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1141     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1142     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1143     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1144     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1145     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1146     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1147     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1148     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1149     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1150     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1151     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1152     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1153     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1154     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1155     12  ER-7818                     PIC S9(4)   VALUE +7818.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  22
* EL050.cbl
  1156     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1157     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1158     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1159     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1160     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1161     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1162     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1163     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1164     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1165     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1166     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1167     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1168     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1169     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1170     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1171     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1172     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1173     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1174     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1175     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1176     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1177     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1178     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1179     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1180     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1181     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1182     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1183     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1184     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1185     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1186     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1187     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1188     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1189     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1190     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1191     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1192     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1193     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1194     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1195     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1196     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1197     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1198     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1199     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1200     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1201     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1202     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1203     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1204     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1205     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1206     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1207     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1208     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1209     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1210     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1211     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1212     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1213     12  ER-8148                     PIC S9(4)   VALUE +8148.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  23
* EL050.cbl
  1214     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1215     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1216     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1217     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1218     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1219     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1220     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1221     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1222     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1223     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1224     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1225     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1226     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1227     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1228     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1229     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1230     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1231     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1232     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1233******************************************************************
  1234***************   END OF ELC50WS     ****************************
  1235******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  24
* EL050.cbl
  1238 01  WORKING-STORAGE-WORK-AREAS.
  1239     12  WS-RESPONSE             PIC S9(8)  COMP.
  1240         88  WS-RESP-NORMAL           VALUE +00.
  1241         88  WS-RESP-ERROR            VALUE +01.
  1242         88  WS-RESP-NOTFND           VALUE +13.
  1243         88  WS-RESP-DUPREC           VALUE +14.
  1244         88  WS-RESP-ENDFILE          VALUE +20.
  1245     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1246     12  WORK-AREAS.
  1247         16  WK-CONV-GREG.
  1248             24  WCG-CENT             PIC XX.
  1249             24  WCG-REST             PIC X(4).
  1250         16  WORK-GREGORIAN-DATE.
  1251             24  WK-GREG-CENT         PIC XX.
  1252             24  WK-GREG-DATE-YYMMDD.
  1253                 28  WK-GREG-YYMM     PIC X(4).
  1254                 28  WK-GREG-DD       PIC XX.
  1255
  1256         16  WORK-SELECT-DATE.
  1257             24  WK-SELECT-CENT            PIC XX.
  1258             24  WK-SELECT-DATE-YYMMDD.
  1259                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1260                 28  FILLER                PIC XX.
  1261
  1262         16  WK-FORM-NO.
  1263             24  WK-FORM-BANK-ID       PIC X(5).
  1264             24  WK-FORM-UNDRWRTR      PIC X(1).
  1265             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1266
  1267         16  WK-MEMBER-NO.
  1268             24  WK-MEMBER-1-6        PIC X(6).
  1269             24  WK-MEMBER-7-12       PIC X(6).
  1270
  1271         16  WK-FULL-CERT-NO.
  1272             24  WK-CERT-POS-1-2      PIC X(2).
  1273             24  WK-CERT-POS-3        PIC X(1).
  1274             24  WK-CERT-POS-4        PIC X(1).
  1275             24  WK-CERT-POS-5-6      PIC X(2).
  1276             24  WK-CERT-POS-7        PIC X(1).
  1277             24  WK-CERT-POS-8-11     PIC X(4).
  1278
  1279         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1280             88  VALID-RATE-CODE        VALUE 'Y'.
  1281             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1282
  1283         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1284         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1285         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1286         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1287         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1288         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1289         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1290         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1291         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1292         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1293
  1294* DLO001
  1295 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  25
* EL050.cbl
  1296     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1297     12  DMPF-RETURN-CODE          PIC XX.
  1298         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1299         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1300         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1301         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1302         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1303         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1304
  1305* DLO002
  1306 01  WS-DLO-INTERNAL-POLICY-FORM.
  1307     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1308     12  DIPF-RETURN-CODE          PIC XX.
  1309         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1310         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1311         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1312         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1313         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1314         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1315
  1316* DLO003
  1317 01  WS-DLO-VALID-BANK-ID.
  1318     12  DVBI-BANK-ID              PIC X(5).
  1319     12  DVBI-BANK-ID-TYPE         PIC X.
  1320         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1321         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1322         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1323         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1324         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1325     12  DVBI-RETURN-CODE          PIC XX.
  1326         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1327         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1328         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1329         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1330         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1331         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1332         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1333         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1334         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1335
  1336* DLO007
  1337 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1338     12  DCUA-RES-STATE            PIC XX.
  1339     12  DCUA-BEN-TYPE             PIC XX.
  1340     12  DCUA-SYS-IDENT            PIC X.
  1341         88  DCUA-CLAIM                        VALUE 'C'.
  1342         88  DCUA-PREMIUM                      VALUE 'P'.
  1343     12  DCUA-COVERAGE-RULE        PIC X.
  1344     12  DCUA-CLIENT-ID            PIC X(10).
  1345     12  DCUA-EFF-DATE             PIC X(8).
  1346     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1347     12  DCUA-RETURN-CODE          PIC XX.
  1348         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1349     12  DCUA-CERT-NUMBER          PIC X(11).
  1350     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1351     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1352
  1353* DLO011
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  26
* EL050.cbl
  1354 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1355     12  DPRB-RATE-CODE            PIC X(4).
  1356     12  DPRB-COVERAGE-CATEG       PIC X.
  1357     12  DPRB-RETURN-CODE          PIC XX.
  1358         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1359         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1360         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1361         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1362         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1363         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1364         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1365         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1366         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1367     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1368     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1369     12  DPRB-BEN-TYPE             PIC XX.
  1370
  1371* DLO017
  1372 01  WS-DLO-VALID-RATE-CODE.
  1373     12  DVRC-RATE-CODE            PIC X(4).
  1374     12  DVRC-RETURN-CODE          PIC XX.
  1375         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1376         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1377         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1378         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1379         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1380         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1381
  1382* DLO019
  1383 01  WS-DLO-ORIG-COV-CAT.
  1384     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1385     12  DOCC-RETURN-CODE          PIC XX.
  1386     12  DOCC-ORIG-COV-CAT         PIC X.
  1387     12  DOCC-UNDERWITER           PIC XX.
  1388     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1389     12  DOCC-FILLER               PIC X(6).
  1390
  1391* DLO021
  1392 01  WS-DLO-VALID-LOAN-OFFICER.
  1393     12  DVLO-LOAN-OFFICER.
  1394         16  DVLO-BILL-TYPE        PIC X.
  1395         16  DVLO-BILL-SOURCE      PIC X.
  1396         16  DVLO-BATCH-TYPE       PIC X.
  1397     12  DVLO-RETURN-CODE          PIC XX.
  1398         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1399         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1400         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1401         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1402         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1403         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1404
  1405* DLO022
  1406 01  WS-DLO-VALID-STATE-CODE.
  1407     12  DVSC-STATE-CODE           PIC XX.
  1408     12  DVSC-RETURN-CODE          PIC XX.
  1409         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1410
  1411* DLO023
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  27
* EL050.cbl
  1412 01  WS-DLO-VALID-CODE-VALUES.
  1413     12  DVCV-SYSTEM-ID            PIC XX.
  1414         88  DVCV-CLAIMS                       VALUE 'CL'.
  1415         88  DVCV-CREDIT                       VALUE 'CR'.
  1416     12  DVCV-RECORD-TYPE          PIC XX.
  1417         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1418         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1419         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1420         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1421         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1422         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1423         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1424         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1425     12  DVCV-RECORD-KEY           PIC X(6).
  1426     12  DVCV-RETURN-CODE          PIC XX.
  1427         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1428         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1429         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1430         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1431         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1432         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1433         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1434     12  DVCV-CODE-DESC            PIC X(60).
  1435     12  DVCV-GEN-DESC-1           PIC X(20).
  1436     12  DVCV-GEN-DESC-2           PIC X(20).
  1437     12  DVCV-GEN-DESC-3           PIC X(20).
  1438
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  28
* EL050.cbl
  1440*    COPY ERCBXRF.
  1441******************************************************************
  1442*                                                                *
  1443*                                                                *
  1444*                            ERCBXRF                             *
  1445*                                                                *
  1446*   ONLINE CREDIT SYSTEM                                         *
  1447*                                                                *
  1448*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1449*                                                                *
  1450*   FILE TYPE = VSAM,KSDS                                        *
  1451*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1452*                                                                *
  1453*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1454*       ALTERNATE PATH = NONE                                    *
  1455*                                                                *
  1456*   LOG = NO                                                     *
  1457*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1458*                                                                *
  1459******************************************************************
  1460
  1461 01  BANK-CROSS-REFERENCE.
  1462     12  BK-RECORD-ID                PIC XX.
  1463         88  VALID-BK-ID             VALUE 'BK'.
  1464
  1465     12  BK-CONTROL-PRIMARY.
  1466         16  BK-COMPANY-CD           PIC X.
  1467         16  BK-CARRIER              PIC X.
  1468         16  BK-GROUPING             PIC X(6).
  1469         16  BK-BANK-NO              PIC X(10).
  1470
  1471     12  BK-MAINT-INFORMATION.
  1472         16  BK-LAST-MAINT-DT        PIC XX.
  1473         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1474         16  BK-LAST-MAINT-USER      PIC X(4).
  1475         16  FILLER                  PIC X(9).
  1476
  1477     12  FILLER                      PIC X(37).
  1478
  1479     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1480
  1481     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1482                            DEPENDING ON BK-BANK-POINTER-CNT.
  1483         16  BK-AM-ACCOUNT           PIC X(10).
  1484         16  BK-AM-EXP-DT            PIC XX.
  1485         16  BK-AM-EFF-DT            PIC XX.
  1486         16  BK-AM-STATE             PIC XX.
  1487         16  FILLER                  PIC X(20).
  1488
  1489******************************************************************
  1490
  1491*    COPY ERCCOMP.
  1492******************************************************************
  1493*                                                                *
  1494*                                                                *
  1495*                            ERCCOMP                             *
  1496*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1497*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  29
* EL050.cbl
  1498*                                                                *
  1499*   ONLINE CREDIT SYSTEM                                         *
  1500*                                                                *
  1501*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1502*                                                                *
  1503*   FILE TYPE = VSAM,KSDS                                        *
  1504*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1505*                                                                *
  1506*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1507*       ALTERNATE PATH = NONE                                    *
  1508*                                                                *
  1509*   LOG = NO                                                     *
  1510*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1511*                                                                *
  1512******************************************************************
  1513*                   C H A N G E   L O G
  1514*
  1515* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1516*-----------------------------------------------------------------
  1517*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1518* EFFECTIVE    NUMBER
  1519*-----------------------------------------------------------------
  1520* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1521* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1522* 092205    2005050300006  PEMA  ADD LEASE FEE
  1523* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1524* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1525* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1526* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1527* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1528* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1529******************************************************************
  1530
  1531 01  COMPENSATION-MASTER.
  1532     12  CO-RECORD-ID                          PIC XX.
  1533         88  VALID-CO-ID                          VALUE 'CO'.
  1534
  1535     12  CO-CONTROL-PRIMARY.
  1536         16  CO-COMPANY-CD                     PIC X.
  1537         16  CO-CONTROL.
  1538             20  CO-CTL-1.
  1539                 24  CO-CARR-GROUP.
  1540                     28  CO-CARRIER            PIC X.
  1541                     28  CO-GROUPING.
  1542                         32  CO-GROUP-PREFIX   PIC XXX.
  1543                         32  CO-GROUP-PRIME    PIC XXX.
  1544                 24  CO-RESP-NO.
  1545                     28  CO-RESP-PREFIX        PIC X(4).
  1546                     28  CO-RESP-PRIME         PIC X(6).
  1547             20  CO-CTL-2.
  1548                 24  CO-ACCOUNT.
  1549                     28  CO-ACCT-PREFIX        PIC X(4).
  1550                     28  CO-ACCT-PRIME         PIC X(6).
  1551         16  CO-TYPE                           PIC X.
  1552             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1553             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1554             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1555
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  30
* EL050.cbl
  1556     12  CO-MAINT-INFORMATION.
  1557         16  CO-LAST-MAINT-DT                  PIC XX.
  1558         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1559         16  CO-LAST-MAINT-USER                PIC X(4).
  1560     12  FILLER                                PIC XX.
  1561     12  CO-STMT-TYPE                          PIC XXX.
  1562     12  CO-COMP-TYPE                          PIC X.
  1563         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1564     12  CO-STMT-OWNER                         PIC X(4).
  1565     12  CO-BALANCE-CONTROL                    PIC X.
  1566         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1567         88  CO-NO-BALANCE                        VALUE 'N'.
  1568
  1569     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1570         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1571         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1572         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1573
  1574     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1575         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1576         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1577
  1578     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1579     12  CO-GA-DIRECT-DEP                      PIC X.
  1580     12  CO-FUTURE-SPACE                       PIC X.
  1581         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1582
  1583     12  CO-ACCT-NAME                          PIC X(30).
  1584     12  CO-MAIL-NAME                          PIC X(30).
  1585     12  CO-ADDR-1                             PIC X(30).
  1586     12  CO-ADDR-2                             PIC X(30).
  1587     12  CO-ADDR-3.
  1588         16  CO-ADDR-CITY                      PIC X(27).
  1589         16  CO-ADDR-STATE                     PIC XX.
  1590     12  CO-CSO-1099                           PIC X.
  1591     12  CO-ZIP.
  1592         16  CO-ZIP-PRIME.
  1593             20  CO-ZIP-PRI-1ST                PIC X.
  1594                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1595             20  FILLER                        PIC X(4).
  1596         16  CO-ZIP-PLUS4                      PIC X(4).
  1597     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1598         16  CO-CAN-POSTAL-1                   PIC XXX.
  1599         16  CO-CAN-POSTAL-2                   PIC XXX.
  1600         16  FILLER                            PIC XXX.
  1601     12  CO-SOC-SEC                            PIC X(13).
  1602     12  CO-TELEPHONE.
  1603         16  CO-AREA-CODE                      PIC XXX.
  1604         16  CO-PREFIX                         PIC XXX.
  1605         16  CO-PHONE                          PIC X(4).
  1606
  1607     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1608
  1609     12  CO-AR-BAL-LEVEL                       PIC X.
  1610         88  CO-AR-REF-LVL                        VALUE '1'.
  1611         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1612         88  CO-AR-BILL-LVL                       VALUE '2'.
  1613         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  31
* EL050.cbl
  1614         88  CO-AR-FR-LVL                         VALUE '4'.
  1615
  1616     12  CO-AR-NORMAL-PRINT                    PIC X.
  1617         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1618         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1619
  1620     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1621
  1622     12  CO-AR-REPORTING                       PIC X.
  1623         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1624         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1625
  1626     12  CO-AR-PULL-CHECK                      PIC X.
  1627         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1628         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1629
  1630     12  CO-AR-BALANCE-PRINT                   PIC X.
  1631         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1632
  1633     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1634         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1635         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1636         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1637
  1638     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1639
  1640     12  CO-USER-CODE                          PIC X.
  1641     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1642
  1643******************************************************************
  1644*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1645*    THE LAST MONTH END RUN.
  1646******************************************************************
  1647
  1648     12  CO-LAST-ACTIVITY-DATE.
  1649         16  CO-ACT-YEAR                       PIC 99.
  1650         16  CO-ACT-MONTH                      PIC 99.
  1651         16  CO-ACT-DAY                        PIC 99.
  1652
  1653     12  CO-LAST-STMT-DT.
  1654         16  CO-LAST-STMT-YEAR                 PIC 99.
  1655         16  CO-LAST-STMT-MONTH                PIC 99.
  1656         16  CO-LAST-STMT-DAY                  PIC 99.
  1657
  1658     12  CO-MO-END-TOTALS.
  1659         16  CO-MONTHLY-TOTALS.
  1660             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1661             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1662             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1663             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1664             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1665
  1666         16  CO-AGING-TOTALS.
  1667             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1668             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1669             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1670             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1671
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  32
* EL050.cbl
  1672         16  CO-YTD-TOTALS.
  1673             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1674             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1675
  1676         16  CO-OVER-UNDER-TOTALS.
  1677             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1678             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1679
  1680     12  CO-MISCELLANEOUS-TOTALS.
  1681         16  CO-FICA-TOTALS.
  1682             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1683             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1684
  1685         16  CO-CLAIM-TOTALS.
  1686             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1687             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1688
  1689******************************************************************
  1690*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1691*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1692******************************************************************
  1693
  1694     12  CO-CURRENT-TOTALS.
  1695         16  CO-CURRENT-LAST-STMT-DT.
  1696             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1697             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1698             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1699
  1700         16  CO-CURRENT-MONTHLY-TOTALS.
  1701             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1702             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1703             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1704             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1705             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1706
  1707         16  CO-CURRENT-AGING-TOTALS.
  1708             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1709             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1710             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1711             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1712
  1713         16  CO-CURRENT-YTD-TOTALS.
  1714             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1715             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1716
  1717     12  CO-PAID-COMM-TOTALS.
  1718         16  CO-YTD-PAID-COMMS.
  1719             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1720             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1721
  1722     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1723         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1724         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1725
  1726     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1727         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1728         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1729         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  33
* EL050.cbl
  1730         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1731         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1732         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1733         88  CO-FINAL-LETTER                  VALUE 'F'.
  1734         88  CO-RECONCILING                   VALUE 'R'.
  1735         88  CO-PHONE-CALL                    VALUE 'P'.
  1736         88  CO-LEGAL                         VALUE 'L'.
  1737         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1738         88  CO-WRITE-OFF                     VALUE 'W'.
  1739         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1740
  1741     12  CO-CSR-CODE                       PIC X(4).
  1742
  1743     12  CO-GA-STATUS-INFO.
  1744         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1745         16  CO-GA-TERMINATION-DT          PIC XX.
  1746         16  CO-GA-STATUS-CODE             PIC X.
  1747             88  CO-GA-ACTIVE                 VALUE 'A'.
  1748             88  CO-GA-INACTIVE               VALUE 'I'.
  1749             88  CO-GA-PENDING                VALUE 'P'.
  1750         16  CO-GA-COMMENTS.
  1751             20  CO-GA-COMMENT-1           PIC X(40).
  1752             20  CO-GA-COMMENT-2           PIC X(40).
  1753             20  CO-GA-COMMENT-3           PIC X(40).
  1754             20  CO-GA-COMMENT-4           PIC X(40).
  1755
  1756     12  CO-RPTCD2                         PIC X(10).
  1757     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1758         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1759         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1760
  1761     12  CO-TYPE-AGENT                     PIC X(01).
  1762         88  CO-CORPORATION                   VALUE 'C'.
  1763         88  CO-PARTNERSHIP                   VALUE 'P'.
  1764         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1765         88  CO-TRUST                         VALUE 'T'.
  1766         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1767
  1768     12  CO-FAXNO.
  1769         16  CO-FAX-AREA-CODE                  PIC XXX.
  1770         16  CO-FAX-PREFIX                     PIC XXX.
  1771         16  CO-FAX-PHONE                      PIC X(4).
  1772
  1773     12  CO-BANK-INFORMATION.
  1774         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1775         16  CO-BANK-TRANSIT-NON REDEFINES
  1776             CO-BANK-TRANSIT-NO                PIC 9(8).
  1777
  1778         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1779     12  CO-MISC-DEDUCT-INFO REDEFINES
  1780                  CO-BANK-INFORMATION.
  1781         16  CO-MD-GL-ACCT                     PIC X(10).
  1782         16  CO-MD-DIV                         PIC XX.
  1783         16  CO-MD-CENTER                      PIC X(4).
  1784         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1785         16  CO-CREATE-AP-CHECK                PIC X.
  1786         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1787         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  34
* EL050.cbl
  1788     12  CO-ACH-STATUS                         PIC X.
  1789         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1790         88  CO-ACH-PENDING                        VALUE 'P'.
  1791
  1792     12  CO-BILL-SW                            PIC X.
  1793     12  CO-CONTROL-NAME                       PIC X(30).
  1794     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1795     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1796     12  CO-CLP-STATE                          PIC XX.
  1797     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1798     12  CO-SPP-REFUND-EDIT                    PIC X.
  1799
  1800******************************************************************
  1801
  1802*    COPY ERCAGTC.
  1803******************************************************************
  1804*                                                                *
  1805*                                                                *
  1806*                            ERCAGTC                             *
  1807*                            VMOD=2.001                          *
  1808*                                                                *
  1809*   ONLINE CREDIT SYSTEM                                         *
  1810*                                                                *
  1811*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1812*                                                                *
  1813*   FILE TYPE = VSAM,KSDS                                        *
  1814*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1815*                                                                *
  1816*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1817*       ALTERNATE PATH = NONE                                    *
  1818*                                                                *
  1819*   LOG = NO                                                     *
  1820*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1821*                                                                *
  1822******************************************************************
  1823*                   C H A N G E   L O G
  1824*
  1825* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1826*-----------------------------------------------------------------
  1827*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1828* EFFECTIVE    NUMBER
  1829*-----------------------------------------------------------------
  1830* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1831* 111004                         NEW FILE AND COPYBOOK
  1832* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1833******************************************************************
  1834 01  AGENT-COMMISSIONS.
  1835     12  AG-RECORD-ID                          PIC XX.
  1836         88  VALID-CO-ID                          VALUE 'AG'.
  1837     12  AG-CONTROL-PRIMARY.
  1838         16  AG-COMPANY-CD                     PIC X.
  1839         16  AG-CONTROL.
  1840             20  AG-CTL-1.
  1841                 24  AG-CARR-GROUP.
  1842                     28  AG-CARRIER            PIC X.
  1843                     28  AG-GROUPING           PIC X(6).
  1844                 24  AG-BANK                   PIC X(10).
  1845             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  35
* EL050.cbl
  1846                 24  AG-EXP-DT                 PIC XX.
  1847         16  AG-TYPE                           PIC X.
  1848             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1849             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1850     12  AG-MAINT-INFORMATION.
  1851         16  AG-LAST-MAINT-DT                  PIC XX.
  1852         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1853         16  AG-LAST-MAINT-USER                PIC X(4).
  1854         16  FILLER                            PIC X(10).
  1855     12  AG-EFF-DT                             PIC XX.
  1856     12  AG-COMM-STRUCTURE.
  1857         16  AG-AGT-COMMS OCCURS 10.
  1858             20  AG-AGT                PIC X(10).
  1859             20  AG-COM-TYP            PIC X.
  1860             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1861             20  AG-RECALC-LV-INDIC    PIC X.
  1862             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1863             20  AG-LRCALC-LV-INDIC    PIC X.
  1864             20  FILLER                PIC X(05).
  1865     12  FILLER                  PIC X(145).
  1866******************************************************************
  1867*    COPY ERCRESS.
  1868******************************************************************
  1869*                                                                *
  1870*                            ERCRESS                             *
  1871*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1872*                            VMOD=2.002                          *
  1873*                                                                *
  1874*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1875*                                                                *
  1876*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1877*   VSAM RESIDENT STATE TAX MASTER                              *
  1878*                                                                *
  1879*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1880*                                                                *
  1881*   FILE TYPE = VSAM,KSDS                                        *
  1882*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1883*                                                                *
  1884*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1885*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1886*                                                                *
  1887*   LOG = NO                                                     *
  1888*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1889*                                                                *
  1890*                                                                *
  1891******************************************************************
  1892
  1893 01  RESIDENT-STATE-TAX-MASTER.
  1894
  1895     10  ERRESS-PRIMARY-KEY.
  1896         15  RES-COMPANY-CD        PIC X.
  1897         15  RES-RESIDENT-STATE    PIC XX.
  1898         15  RES-COVERAGE-CATEGORY PIC X.
  1899         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1900*                                      YYYYMMDD
  1901*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1902
  1903     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  36
* EL050.cbl
  1904
  1905         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1906         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1907         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1908         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1909
  1910     10 RES-RECALC-SW              PIC   X.
  1911         88 RECALC                VALUE 'Y'.
  1912         88 NO-RECALC             VALUE 'N'.
  1913     10  RES-MAINT-BY              PIC X(4).
  1914     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1915     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1916*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  37
* EL050.cbl
  1918*    COPY ERCRESC.
  1919******************************************************************
  1920*                                                                *
  1921*                            ERCRESC                             *
  1922*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1923*                            VMOD=2.003                          *
  1924*                                                                *
  1925*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1926*                                                                *
  1927*   FILE TYPE = VSAM,KSDS                                        *
  1928*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1929*                                                                *
  1930*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1931*       ALTERNATE PATH1 = NONE                                   *
  1932*                                                                *
  1933*   LOG = NO                                                     *
  1934*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1935*                                                                *
  1936******************************************************************
  1937
  1938 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1939
  1940     10  ERRESC-RECORD-KEY.
  1941         15  RESC-COMPANY-CD           PIC   X.
  1942         15  RESC-CARRIER              PIC   X.
  1943         15  RESC-GROUP                PIC   X(6).
  1944         15  RESC-STATE                PIC   XX.
  1945         15  RESC-ACCOUNT              PIC   X(10).
  1946         15  RESC-AGENT                PIC   X(10).
  1947         15  RESC-RESIDENT-STATE       PIC   XX.
  1948         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1949*                                           YYYYMMDD
  1950     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1951
  1952     10  RESC-COMM-RECORD-DATA.
  1953         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1954             20 RESC-COVERAGE-CAT      PIC    X.
  1955             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1956             20 RESC-COMMISSION-TAB REDEFINES
  1957                RESC-COMMISSION-PER    PIC  XXX.
  1958
  1959     10  RESC-MAINT-BY                 PIC X(4).
  1960     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1961     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1962*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  38
* EL050.cbl
  1964*    COPY ERCPLAN.
  1965******************************************************************
  1966*                                                                *
  1967*                                                                *
  1968*                            ERCPLAN                             *
  1969*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1970*                            VMOD=2.003                          *
  1971*                                                                *
  1972*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1973*                                                                *
  1974*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1975*   PLAN MASTER                                                  *
  1976*                                                                *
  1977*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1978*                                                                *
  1979*   FILE TYPE = VSAM,KSDS                                        *
  1980*   RECORD SIZE = 420   RECFORM = FIX                            *
  1981*                                                                *
  1982*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1983*       ALTERNATE PATH1 = N/A                                    *
  1984*                                                                *
  1985*   LOG = NO                                                     *
  1986*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1987*                                                                *
  1988*                                                                *
  1989******************************************************************
  1990
  1991 01  PLAN-MASTER.
  1992     12  PL-RECORD-ID                      PIC XX.
  1993         88  VALID-PL-ID                      VALUE 'PL'.
  1994
  1995     12  PL-CONTROL-PRIMARY.
  1996         16  PL-COMPANY-CD                 PIC X.
  1997         16  PL-MSTR-CNTRL.
  1998             20  PL-CONTROL-A.
  1999                 24  PL-CARRIER            PIC X.
  2000                 24  PL-GROUPING           PIC X(6).
  2001                 24  PL-STATE              PIC XX.
  2002                 24  PL-ACCOUNT            PIC X(10).
  2003             20  PL-BENEFIT-TYPE           PIC X.
  2004             20  PL-BENEFIT-CODE           PIC XX.
  2005             20  PL-REVISION-NO            PIC X(3).
  2006
  2007     12  PL-CONTROL-BY-VAR-GRP.
  2008         16  PL-COMPANY-CD-A1              PIC X.
  2009         16  PL-VG-CARRIER                 PIC X.
  2010         16  PL-VG-GROUPING                PIC X(6).
  2011         16  PL-VG-STATE                   PIC XX.
  2012         16  PL-VG-ACCOUNT                 PIC X(10).
  2013         16  PL-BENEFIT-TYPE-A1            PIC X.
  2014         16  PL-BENEFIT-CODE-A1            PIC XX.
  2015         16  PL-REVISION-NO-A1             PIC 999.
  2016
  2017     12  PL-MAINT-INFORMATION.
  2018         16  PL-LAST-MAINT-DT              PIC XX.
  2019         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2020         16  PL-LAST-MAINT-USER            PIC X(4).
  2021         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  39
* EL050.cbl
  2022
  2023     12  PL-LIABILITY-LIMITS.
  2024         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2025         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2026             20  PL-LM-AGE                 PIC S99        COMP-3.
  2027             20  PL-LM-DUR                 PIC S999       COMP-3.
  2028             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2029             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2030
  2031     12  FILLER                            PIC X(30).
  2032
  2033     12  PL-GL-ACCOUNT-NOS.
  2034         16  PL-PREMIUM-GL                 PIC X(8).
  2035         16  PL-COMM-GL                    PIC X(8).
  2036         16  PL-CLAIM-GL                   PIC X(8).
  2037     12  FILLER                            PIC X(24).
  2038     12  PL-TOLERANCES.
  2039         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2040         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2041         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2042         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2043         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2044         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2045     12  PL-OVER-SHORT.
  2046         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2047         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2048     12  FILLER                            PIC X(24).
  2049     12  PLAN-MISC.
  2050         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2051         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2052         16  PL-IG                         PIC X.
  2053         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2054         16  PL-POLICY-FORM                PIC X(12).
  2055         16  PL-EDIT-FOR-FORM              PIC X(01).
  2056         16  PL-DEV-CODE                   PIC XXX.
  2057         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2058         16  PL-CALC-METHOD                PIC X.
  2059         16  PL-BENEFIT-GROUP              PIC X(05).
  2060         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2061
  2062         16  FILLER                        PIC X(99).
  2063******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  40
* EL050.cbl
  2065*    COPY ELCCERT.
  2066******************************************************************
  2067*                                                                *
  2068*                            ELCCERT.                            *
  2069*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2070*                            VMOD=2.013                          *
  2071*                                                                *
  2072*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2073*                                                                *
  2074*   FILE TYPE = VSAM,KSDS                                        *
  2075*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2076*                                                                *
  2077*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2078*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2079*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2080*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2081*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2082*                                                                *
  2083*   LOG = YES                                                    *
  2084*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2085******************************************************************
  2086*                   C H A N G E   L O G
  2087*
  2088* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2089*-----------------------------------------------------------------
  2090*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2091* EFFECTIVE    NUMBER
  2092*-----------------------------------------------------------------
  2093* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2094* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2095* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2096* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2097* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2098* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2099* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2100* 032612  CR2011110200001  PEMA  AHL CHANGES
  2101******************************************************************
  2102
  2103 01  CERTIFICATE-MASTER.
  2104     12  CM-RECORD-ID                      PIC XX.
  2105         88  VALID-CM-ID                      VALUE 'CM'.
  2106
  2107     12  CM-CONTROL-PRIMARY.
  2108         16  CM-COMPANY-CD                 PIC X.
  2109         16  CM-CARRIER                    PIC X.
  2110         16  CM-GROUPING.
  2111             20  CM-GROUPING-PREFIX        PIC X(3).
  2112             20  CM-GROUPING-PRIME         PIC X(3).
  2113         16  CM-STATE                      PIC XX.
  2114         16  CM-ACCOUNT.
  2115             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2116             20  CM-ACCOUNT-PRIME          PIC X(6).
  2117         16  CM-CERT-EFF-DT                PIC XX.
  2118         16  CM-CERT-NO.
  2119             20  CM-CERT-PRIME             PIC X(10).
  2120             20  CM-CERT-SFX               PIC X.
  2121
  2122     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  41
* EL050.cbl
  2123         16  CM-COMPANY-CD-A1              PIC X.
  2124         16  CM-INSURED-LAST-NAME          PIC X(15).
  2125         16  CM-INSURED-INITIALS.
  2126             20  CM-INSURED-INITIAL1       PIC X.
  2127             20  CM-INSURED-INITIAL2       PIC X.
  2128
  2129     12  CM-CONTROL-BY-SSN.
  2130         16  CM-COMPANY-CD-A2              PIC X.
  2131         16  CM-SOC-SEC-NO.
  2132             20  CM-SSN-STATE              PIC XX.
  2133             20  CM-SSN-ACCOUNT            PIC X(6).
  2134             20  CM-SSN-LN3.
  2135                 25  CM-INSURED-INITIALS-A2.
  2136                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2137                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2138                 25 CM-PART-LAST-NAME-A2         PIC X.
  2139
  2140     12  CM-CONTROL-BY-CERT-NO.
  2141         16  CM-COMPANY-CD-A4              PIC X.
  2142         16  CM-CERT-NO-A4                 PIC X(11).
  2143
  2144     12  CM-CONTROL-BY-MEMB.
  2145         16  CM-COMPANY-CD-A5              PIC X.
  2146         16  CM-MEMBER-NO.
  2147             20  CM-MEMB-STATE             PIC XX.
  2148             20  CM-MEMB-ACCOUNT           PIC X(6).
  2149             20  CM-MEMB-LN4.
  2150                 25  CM-INSURED-INITIALS-A5.
  2151                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2152                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2153                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2154
  2155     12  CM-INSURED-PROFILE-DATA.
  2156         16  CM-INSURED-FIRST-NAME.
  2157             20  CM-INSURED-1ST-INIT       PIC X.
  2158             20  FILLER                    PIC X(9).
  2159         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2160         16  CM-INSURED-SEX                PIC X.
  2161             88  CM-SEX-MALE                  VALUE 'M'.
  2162             88  CM-SEX-FEMAL                 VALUE 'F'.
  2163         16  CM-INSURED-JOINT-AGE          PIC 99.
  2164         16  CM-JOINT-INSURED-NAME.
  2165             20  CM-JT-LAST-NAME           PIC X(15).
  2166             20  CM-JT-FIRST-NAME.
  2167                 24  CM-JT-1ST-INIT        PIC X.
  2168                 24  FILLER                PIC X(9).
  2169             20  CM-JT-INITIAL             PIC X.
  2170
  2171     12  CM-LIFE-DATA.
  2172         16  CM-LF-BENEFIT-CD              PIC XX.
  2173         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2174         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2175         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2176         16  CM-LF-DEV-CODE                PIC XXX.
  2177         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2178         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2179         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2180         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  42
* EL050.cbl
  2181         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2182         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2183         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2184         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2185         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2186         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2187         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2188         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2189         16  FILLER                        PIC XX.
  2190
  2191     12  CM-AH-DATA.
  2192         16  CM-AH-BENEFIT-CD              PIC XX.
  2193         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2194         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2195         16  CM-AH-DEV-CODE                PIC XXX.
  2196         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2197         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2198         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2199         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2200         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2201         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2202         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2203         16  CM-AH-PAID-THRU-DT            PIC XX.
  2204             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2205         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2206         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2207         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2208         16  FILLER                        PIC X.
  2209
  2210     12  CM-LOAN-INFORMATION.
  2211         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2212         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2213                                           PIC S9(5)V99  COMP-3.
  2214         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2215         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2216         16  CM-PAY-FREQUENCY              PIC S99.
  2217         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2218         16  CM-RATE-CLASS                 PIC XX.
  2219         16  CM-BENEFICIARY                PIC X(25).
  2220         16  CM-POLICY-FORM-NO             PIC X(12).
  2221         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2222         16  CM-LAST-ADD-ON-DT             PIC XX.
  2223         16  CM-DEDUCTIBLE-AMOUNTS.
  2224             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2225             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2226         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2227             20  CM-RESIDENT-STATE         PIC XX.
  2228             20  CM-RATE-CODE              PIC X(4).
  2229             20  FILLER                    PIC XX.
  2230         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2231             20  CM-LOAN-OFFICER           PIC X(5).
  2232             20  FILLER                    PIC XXX.
  2233         16  CM-CSR-CODE                   PIC XXX.
  2234         16  CM-UNDERWRITING-CODE          PIC X.
  2235             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2236         16  CM-POST-CARD-IND              PIC X.
  2237         16  CM-NH-INTERFACE-SW            PIC X.
  2238         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  43
* EL050.cbl
  2239             88  CM-SING-PRM                  VALUE '1'.
  2240             88  CM-O-B-COVERAGE              VALUE '2'.
  2241             88  CM-OPEN-END                  VALUE '3'.
  2242         16  CM-IND-GRP-TYPE               PIC X.
  2243             88  CM-INDIVIDUAL                VALUE 'I'.
  2244             88  CM-GROUP                     VALUE 'G'.
  2245         16  CM-SKIP-CODE                  PIC X.
  2246             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2247             88  SKIP-JULY                    VALUE '1'.
  2248             88  SKIP-AUGUST                  VALUE '2'.
  2249             88  SKIP-SEPTEMBER               VALUE '3'.
  2250             88  SKIP-JULY-AUG                VALUE '4'.
  2251             88  SKIP-AUG-SEPT                VALUE '5'.
  2252             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2253             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2254             88  SKIP-JUNE                    VALUE '8'.
  2255             88  SKIP-JUNE-JULY               VALUE '9'.
  2256             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2257             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2258         16  CM-PAYMENT-MODE               PIC X.
  2259             88  PAY-MONTHLY                  VALUE SPACE.
  2260             88  PAY-WEEKLY                   VALUE '1'.
  2261             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2262             88  PAY-BI-WEEKLY                VALUE '3'.
  2263             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2264         16  CM-LOAN-NUMBER                PIC X(8).
  2265         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2266         16  CM-OLD-LOF                    PIC XXX.
  2267*        16  CM-LOAN-OFFICER               PIC XXX.
  2268         16  CM-REIN-TABLE                 PIC XXX.
  2269         16  CM-SPECIAL-REIN-CODE          PIC X.
  2270         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2271         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2272         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2273
  2274     12  CM-STATUS-DATA.
  2275         16  CM-ENTRY-STATUS               PIC X.
  2276         16  CM-ENTRY-DT                   PIC XX.
  2277
  2278         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2279         16  CM-LF-CANCEL-DT               PIC XX.
  2280         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2281
  2282         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2283         16  CM-LF-DEATH-DT                PIC XX.
  2284         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2285
  2286         16  CM-LF-CURRENT-STATUS          PIC X.
  2287             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2288                                                'M' '4' '5' '9'.
  2289             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2290             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2291             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2292             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2293             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2294             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2295             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2296             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  44
* EL050.cbl
  2297             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2298             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2299             88  CM-LF-DECLINED               VALUE 'D'.
  2300             88  CM-LF-VOIDED                 VALUE 'V'.
  2301
  2302         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2303         16  CM-AH-CANCEL-DT               PIC XX.
  2304         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2305
  2306         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2307         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2308         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2309
  2310         16  CM-AH-CURRENT-STATUS          PIC X.
  2311             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2312                                                'M' '4' '5' '9'.
  2313             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2314             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2315             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2316             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2317             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2318             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2319             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2320             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2321             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2322             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2323             88  CM-AH-DECLINED               VALUE 'D'.
  2324             88  CM-AH-VOIDED                 VALUE 'V'.
  2325
  2326         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2327             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2328             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2329             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2330         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2331
  2332         16  CM-ENTRY-BATCH                PIC X(6).
  2333         16  CM-LF-EXIT-BATCH              PIC X(6).
  2334         16  CM-AH-EXIT-BATCH              PIC X(6).
  2335         16  CM-LAST-MONTH-END             PIC XX.
  2336
  2337     12  CM-NOTE-SW                        PIC X.
  2338         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2339         88  CERT-NOTES-PRESENT               VALUE '1'.
  2340         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2341         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2342         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2343         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2344         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2345         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2346     12  CM-COMP-EXCP-SW                   PIC X.
  2347         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2348         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2349     12  CM-INSURED-ADDRESS-SW             PIC X.
  2350         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2351         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2352
  2353*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2354     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  45
* EL050.cbl
  2355     12  FILLER                            PIC X.
  2356
  2357*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2358     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2359     12  FILLER                            PIC X.
  2360*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2361     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2362
  2363     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2364         88  CERT-ADDED-BATCH                 VALUE ' '.
  2365         88  CERT-ADDED-ONLINE                VALUE '1'.
  2366         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2367         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2368         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2369     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2370         88  CERT-AS-LOADED                   VALUE ' '.
  2371         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2372         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2373         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2374         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2375         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2376         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2377         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2378
  2379     12  CM-ACCOUNT-COMM-PCTS.
  2380         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2381         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2382
  2383     12  CM-USER-FIELD                     PIC X.
  2384     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2385     12  CM-CLP-STATE                      PIC XX.
  2386     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2387     12  CM-USER-RESERVED                  PIC XXX.
  2388     12  FILLER REDEFINES CM-USER-RESERVED.
  2389         16  CM-AH-CLASS-CD                PIC XX.
  2390         16  F                             PIC X.
  2391******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  46
* EL050.cbl
  2393*    COPY ERCMAIL.
  2394******************************************************************
  2395*                                                                *
  2396*                                                                *
  2397*                            ERCMAIL                             *
  2398*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2399*                            VMOD=2.003                          *
  2400*                                                                *
  2401*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2402*                                                                *
  2403*   FILE TYPE = VSAM,KSDS                                        *
  2404*   RECORD SIZE = 374   RECFORM = FIX                            *
  2405*                                                                *
  2406*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2407*   ALTERNATE PATH    = NOT USED                                 *
  2408*                                                                *
  2409*   LOG = YES                                                    *
  2410*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2411******************************************************************
  2412*                   C H A N G E   L O G
  2413*
  2414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2415*-----------------------------------------------------------------
  2416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2417* EFFECTIVE    NUMBER
  2418*-----------------------------------------------------------------
  2419* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2420* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2421* 111108                   PEMA  ADD CRED BENE ADDR2
  2422******************************************************************
  2423
  2424 01  MAILING-DATA.
  2425     12  MA-RECORD-ID                      PIC XX.
  2426         88  VALID-MA-ID                       VALUE 'MA'.
  2427
  2428     12  MA-CONTROL-PRIMARY.
  2429         16  MA-COMPANY-CD                 PIC X.
  2430         16  MA-CARRIER                    PIC X.
  2431         16  MA-GROUPING.
  2432             20  MA-GROUPING-PREFIX        PIC XXX.
  2433             20  MA-GROUPING-PRIME         PIC XXX.
  2434         16  MA-STATE                      PIC XX.
  2435         16  MA-ACCOUNT.
  2436             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2437             20  MA-ACCOUNT-PRIME          PIC X(6).
  2438         16  MA-CERT-EFF-DT                PIC XX.
  2439         16  MA-CERT-NO.
  2440             20  MA-CERT-PRIME             PIC X(10).
  2441             20  MA-CERT-SFX               PIC X.
  2442
  2443     12  FILLER                            PIC XX.
  2444
  2445     12  MA-ACCESS-CONTROL.
  2446         16  MA-SOURCE-SYSTEM              PIC XX.
  2447             88  MA-FROM-CREDIT                VALUE 'CR'.
  2448             88  MA-FROM-VSI                   VALUE 'VS'.
  2449             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2450             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  47
* EL050.cbl
  2451         16  MA-RECORD-ADD-DT              PIC XX.
  2452         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2453         16  MA-LAST-MAINT-DT              PIC XX.
  2454         16  MA-LAST-MAINT-BY              PIC XXXX.
  2455         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2456
  2457     12  MA-PROFILE-INFO.
  2458         16  MA-QUALIFY-CODE-1             PIC XX.
  2459         16  MA-QUALIFY-CODE-2             PIC XX.
  2460         16  MA-QUALIFY-CODE-3             PIC XX.
  2461         16  MA-QUALIFY-CODE-4             PIC XX.
  2462         16  MA-QUALIFY-CODE-5             PIC XX.
  2463
  2464         16  MA-INSURED-LAST-NAME          PIC X(15).
  2465         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2466         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2467         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2468         16  MA-INSURED-BIRTH-DT           PIC XX.
  2469         16  MA-INSURED-SEX                PIC X.
  2470             88  MA-SEX-MALE                   VALUE 'M'.
  2471             88  MA-SEX-FEMALE                 VALUE 'F'.
  2472         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2473
  2474         16  MA-ADDRESS-CORRECTED          PIC X.
  2475         16  MA-JOINT-BIRTH-DT             PIC XX.
  2476*        16  FILLER                        PIC X(12).
  2477
  2478         16  MA-ADDRESS-LINE-1             PIC X(30).
  2479         16  MA-ADDRESS-LINE-2             PIC X(30).
  2480         16  MA-CITY-STATE.
  2481             20  MA-CITY                   PIC X(28).
  2482             20  MA-ADDR-STATE             PIC XX.
  2483         16  MA-ZIP.
  2484             20  MA-ZIP-CODE.
  2485                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2486                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2487                 24  FILLER                PIC X(4).
  2488             20  MA-ZIP-PLUS4              PIC X(4).
  2489         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2490             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2491             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2492             20  FILLER                    PIC X(3).
  2493
  2494         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2495
  2496         16  FILLER                        PIC XXX.
  2497*        16  FILLER                        PIC X(10).
  2498
  2499     12  MA-CRED-BENE-INFO.
  2500         16  MA-CRED-BENE-NAME                 PIC X(25).
  2501         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2502         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2503         16  MA-CRED-BENE-CTYST.
  2504             20  MA-CRED-BENE-CITY             PIC X(28).
  2505             20  MA-CRED-BENE-STATE            PIC XX.
  2506         16  MA-CRED-BENE-ZIP.
  2507             20  MA-CB-ZIP-CODE.
  2508                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  48
* EL050.cbl
  2509                     88  MA-CB-CANADIAN-POST-CODE
  2510                                           VALUE 'A' THRU 'Z'.
  2511                 24  FILLER                    PIC X(4).
  2512             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2513         16  MA-CB-CANADIAN-POSTAL-CODE
  2514                            REDEFINES MA-CRED-BENE-ZIP.
  2515             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2516             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2517             20  FILLER                        PIC X(3).
  2518     12  MA-POST-CARD-MAIL-DATA.
  2519         16  MA-MAIL-DATA OCCURS 7.
  2520             20  MA-MAIL-TYPE              PIC X.
  2521                 88  MA-12MO-MAILING           VALUE '1'.
  2522                 88  MA-EXP-MAILING            VALUE '2'.
  2523             20  MA-MAIL-STATUS            PIC X.
  2524                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2525                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2526                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2527             20  MA-MAIL-DATE              PIC XX.
  2528     12  FILLER                            PIC XX.
  2529     12  FILLER                            PIC XX.
  2530*    12  FILLER                            PIC X(30).
  2531******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  49
* EL050.cbl
  2533*    COPY ERCPNDM.
  2534******************************************************************
  2535*                                                                *
  2536*                                                                *
  2537*                            ERCPNDM                             *
  2538*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2539*                            VMOD=2.003                          *
  2540*                                                                *
  2541*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2542*                                                                *
  2543*   FILE TYPE = VSAM,KSDS                                        *
  2544*   RECORD SIZE = 374   RECFORM = FIX                            *
  2545*                                                                *
  2546*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2547*   ALTERNATE PATH    = NOT USED                                 *
  2548*                                                                *
  2549*   LOG = YES                                                    *
  2550*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2551******************************************************************
  2552*                   C H A N G E   L O G
  2553*
  2554* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2555*-----------------------------------------------------------------
  2556*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2557* EFFECTIVE    NUMBER
  2558*-----------------------------------------------------------------
  2559* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2560* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2561* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2562******************************************************************
  2563
  2564 01  PENDING-MAILING-DATA.
  2565     12  PM-RECORD-ID                      PIC XX.
  2566         88  VALID-MA-ID                       VALUE 'PM'.
  2567
  2568     12  PM-CONTROL-PRIMARY.
  2569         16  PM-COMPANY-CD                 PIC X.
  2570         16  PM-ENTRY-BATCH                PIC X(6).
  2571         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2572         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2573
  2574     12  FILLER                            PIC X(14).
  2575
  2576     12  PM-ACCESS-CONTROL.
  2577         16  PM-SOURCE-SYSTEM              PIC XX.
  2578             88  PM-FROM-CREDIT                VALUE 'CR'.
  2579             88  PM-FROM-VSI                   VALUE 'VS'.
  2580             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2581             88  PM-FROM-OTHER                 VALUE 'OT'.
  2582         16  PM-RECORD-ADD-DT              PIC XX.
  2583         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2584         16  PM-LAST-MAINT-DT              PIC XX.
  2585         16  PM-LAST-MAINT-BY              PIC XXXX.
  2586         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2587
  2588     12  PM-PROFILE-INFO.
  2589         16  PM-QUALIFY-CODE-1             PIC XX.
  2590         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  50
* EL050.cbl
  2591         16  PM-QUALIFY-CODE-3             PIC XX.
  2592         16  PM-QUALIFY-CODE-4             PIC XX.
  2593         16  PM-QUALIFY-CODE-5             PIC XX.
  2594
  2595         16  PM-INSURED-LAST-NAME          PIC X(15).
  2596         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2597         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2598         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2599         16  PM-INSURED-BIRTH-DT           PIC XX.
  2600         16  PM-INSURED-SEX                PIC X.
  2601             88  PM-SEX-MALE                   VALUE 'M'.
  2602             88  PM-SEX-FEMALE                 VALUE 'F'.
  2603         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2604
  2605         16  PM-ADDRESS-CORRECTED          PIC X.
  2606         16  PM-JOINT-BIRTH-DT             PIC XX.
  2607*        16  FILLER                        PIC X(12).
  2608
  2609         16  PM-ADDRESS-LINE-1             PIC X(30).
  2610         16  PM-ADDRESS-LINE-2             PIC X(30).
  2611         16  PM-CITY-STATE.
  2612             20  PM-CITY                   PIC X(28).
  2613             20  PM-STATE                  PIC XX.
  2614         16  PM-ZIP.
  2615             20  PM-ZIP-CODE.
  2616                 24  PM-ZIP-1              PIC X.
  2617                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2618                 24  FILLER                PIC X(4).
  2619             20  PM-ZIP-PLUS4              PIC X(4).
  2620         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2621             20  PM-CAN-POST1              PIC XXX.
  2622             20  PM-CAN-POST2              PIC XXX.
  2623             20  FILLER                    PIC XXX.
  2624
  2625         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2626
  2627         16  FILLER                        PIC X(03).
  2628
  2629     12  PM-CRED-BENE-INFO.
  2630         16  PM-CRED-BENE-NAME             PIC X(25).
  2631         16  PM-CRED-BENE-ADDR             PIC X(30).
  2632         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2633         16  PM-CRED-BENE-CTYST.
  2634             20  PM-CRED-BENE-CITY         PIC X(28).
  2635             20  PM-CRED-BENE-STATE        PIC XX.
  2636         16  PM-CRED-BENE-ZIP.
  2637             20  PM-CB-ZIP-CODE.
  2638                 24  PM-CB-ZIP-1           PIC X.
  2639                     88  PM-CB-CANADIAN-POST-CODE
  2640                                  VALUE 'A' THRU 'Z'.
  2641                 24  FILLER                PIC X(4).
  2642             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2643         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2644             20  PM-CB-CAN-POST1           PIC XXX.
  2645             20  PM-CB-CAN-POST2           PIC XXX.
  2646             20  FILLER                    PIC XXX.
  2647     12  PM-POST-CARD-MAIL-DATA.
  2648         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  51
* EL050.cbl
  2649             20  PM-MAIL-TYPE              PIC X.
  2650                 88  PM-12MO-MAILING           VALUE '1'.
  2651                 88  PM-EXP-MAILING            VALUE '2'.
  2652             20  PM-MAIL-STATUS            PIC X.
  2653                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2654                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2655                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2656             20  PM-MAIL-DATE              PIC XX.
  2657     12  FILLER                            PIC XX.
  2658     12  FILLER                            PIC X(12).
  2659*    12  FILLER                            PIC X(30).
  2660
  2661******************************************************************
  2662*                                COPY ERCLOFC.
  2663******************************************************************
  2664*                                                                *
  2665*                                                                *
  2666*                            ERCLOFC                             *
  2667*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2668*                            VMOD=2.003                          *
  2669*                                                                *
  2670*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2671*                                                                *
  2672*   FILE TYPE = VSAM,KSDS                                        *
  2673*   RECORD SIZE = 670   RECFORM = FIX                            *
  2674*                                                                *
  2675*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2676*                                                                *
  2677*   LOG = YES                                                    *
  2678*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2679*                                                                *
  2680******************************************************************
  2681
  2682 01  LOAN-OFFICER-MASTER.
  2683     12  LO-RECORD-ID                PIC XX.
  2684         88  VALID-LO-ID                VALUE 'LO'.
  2685
  2686     12  LO-CONTROL-PRIMARY.
  2687         16  LO-COMPANY-CD           PIC X.
  2688         16  LO-CARRIER              PIC X.
  2689         16  LO-GROUPING.
  2690             20  LO-GROUPING-PREFIX  PIC XXX.
  2691             20  LO-GROUPING-PRIME   PIC XXX.
  2692         16  LO-STATE                PIC XX.
  2693         16  LO-ACCOUNT.
  2694             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2695             20  LO-ACCOUNT-PRIME    PIC X(6).
  2696         16  LO-OFFICER-CODE         PIC X(5).
  2697
  2698     12  LO-OFFICER-NAME             PIC X(30).
  2699
  2700     12  LO-LAST-MAINT-DT            PIC XX.
  2701     12  LO-LAST-USER                PIC X(4).
  2702     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2703
  2704     12  LO-COMP-CONTROL             PIC X.
  2705             88  LO-SHOW-COMP           VALUE 'Y'.
  2706             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  52
* EL050.cbl
  2707     12  LO-DETAIL-CONTROL           PIC X.
  2708             88  LO-PRINT-DETAIL        VALUE 'D'.
  2709             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2710
  2711     12  LO-SV-CARRIER               PIC X.
  2712     12  LO-SV-GROUPING              PIC X(6).
  2713     12  LO-SV-STATE                 PIC XX.
  2714
  2715     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2716     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2717
  2718     12  LO-OFFICER-INFO.
  2719         16  FILLER OCCURS 12 TIMES.
  2720             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2721             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2722             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2723             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2724             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2725             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2726             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2727             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2728     12  FILLER                      PIC X(198).
  2729******************************************************************
  2730*                                COPY ERCPDEF.
  2731******************************************************************
  2732*                                                                *
  2733*                                                                *
  2734*                            ERCPDEF.                            *
  2735*                                                                *
  2736*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2737*                                                                *
  2738*    FILE TYPE = VSAM,KSDS                                       *
  2739*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2740*                                                                *
  2741*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2742*                                                                *
  2743*    LOG = YES                                                   *
  2744*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2745******************************************************************
  2746*                   C H A N G E   L O G
  2747*
  2748* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2749*-----------------------------------------------------------------
  2750*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2751* EFFECTIVE    NUMBER
  2752*-----------------------------------------------------------------
  2753* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2754******************************************************************
  2755 01  PRODUCT-MASTER.
  2756    12  PD-RECORD-ID                 PIC X(02).
  2757        88  VALID-PD-ID                  VALUE 'PD'.
  2758    12  PD-CONTROL-PRIMARY.
  2759        16  PD-COMPANY-CD            PIC X.
  2760        16  PD-STATE                 PIC XX.
  2761        16  PD-PRODUCT-CD            PIC XXX.
  2762        16  PD-FILLER                PIC X(7).
  2763        16  PD-BEN-TYPE              PIC X.
  2764        16  PD-BEN-CODE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  53
* EL050.cbl
  2765        16  PD-PROD-EXP-DT           PIC XX.
  2766    12  FILLER                       PIC X(50).
  2767    12  PD-PRODUCT-DATA OCCURS 8.
  2768        16  PD-PROD-CODE             PIC X.
  2769            88  PD-PROD-LIFE           VALUE 'L'.
  2770            88  PD-PROD-PROP           VALUE 'P'.
  2771            88  PD-PROD-AH             VALUE 'A'.
  2772            88  PD-PROD-IU             VALUE 'I'.
  2773            88  PD-PROD-GAP            VALUE 'G'.
  2774            88  PD-PROD-FMLA           VALUE 'F'.
  2775        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2776        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2777        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2778        16  PD-MAX-TERM              PIC S999        COMP-3.
  2779        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2780        16  FILLER                   PIC X.
  2781        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2782        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2783        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2784        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2785        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2786        16  PD-REC-CRIT-PERIOD       PIC 99.
  2787        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2788            20  PD-RECURRING-YN      PIC X.
  2789            20  FILLER               PIC X.
  2790        16  PD-RTW-MOS               PIC 99.
  2791        16  PD-MAX-EXTENSION         PIC 99.
  2792        16  FILLER                   PIC XX.
  2793    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2794    12  PD-TERM-LIMITS OCCURS 15.
  2795        16  PD-LOW-TERM              PIC S999        COMP-3.
  2796        16  PD-HI-TERM               PIC S999        COMP-3.
  2797*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2798    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2799        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2800        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2801    12  PD-EARN-FACTORS.
  2802        16  FILLER OCCURS 15.
  2803            20  FILLER OCCURS 15.
  2804                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2805    12  PD-PRODUCT-DESC              PIC X(80).
  2806    12  PD-TRUNCATED                 PIC X.
  2807    12  FILLER                       PIC X(59).
  2808    12  PD-MAINT-INFORMATION.
  2809        16  PD-LAST-MAINT-DT         PIC X(02).
  2810        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2811        16  PD-LAST-MAINT-BY         PIC X(04).
  2812*                                COPY ELCSTATE.
  2813******************************************************************
  2814*                                                                *
  2815*                                                                *
  2816*                            ELCSTATE.                           *
  2817*                                                                *
  2818*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2819*                                                                *
  2820*   FILE TYPE = VSAM,KSDS                                        *
  2821*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2822*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  54
* EL050.cbl
  2823*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2824*       ALTERNATE INDEX = NONE                                   *
  2825*                                                                *
  2826*   LOG = YES                                                    *
  2827*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2828******************************************************************
  2829*                   C H A N G E   L O G
  2830*
  2831* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2832*-----------------------------------------------------------------
  2833*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2834* EFFECTIVE    NUMBER
  2835*-----------------------------------------------------------------
  2836* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2837******************************************************************
  2838*
  2839 01  STATE-FILE.
  2840     12  SF-RECORD-ID                       PIC XX.
  2841         88  VALID-CF-ID                        VALUE 'SF'.
  2842     12  SF-CONTROL-PRIMARY.
  2843         16  SF-COMPANY-ID                  PIC XXX.
  2844         16  SF-CARRIER-CODE                PIC X.
  2845         16  SF-GROUPING                    PIC X(6).
  2846         16  SF-STATE-CODE                  PIC XX.
  2847         16  SF-EXPIRE-DATE                 PIC 9(8).
  2848****************************************************************
  2849*             STATE CONTROLS
  2850****************************************************************
  2851     12  SF-LAST-MAINT-DT                   PIC XX.
  2852     12  SF-LAST-MAINT-BY                   PIC X(4).
  2853     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2854     12  SF-STATE-RT-CONTROLS.
  2855         16  SF-ST-RT-CALC                  PIC X.
  2856     12  SF-ST-TAX-CONTROLS.
  2857         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2858         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2859         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2860     12  SF-ST-REFUND-OPTIONS.
  2861         16  SF-ST-RF-LR-CALC               PIC X.
  2862         16  SF-ST-RF-LL-CALC               PIC X.
  2863         16  SF-ST-RF-LN-CALC               PIC X.
  2864         16  SF-ST-RF-AH-CALC               PIC X.
  2865         16  SF-ST-RF-CP-CALC               PIC X.
  2866     12  SF-ST-UNEARN-PREM-OPTIONS.
  2867         16  SF-ST-LUEP-R78                 PIC X.
  2868         16  SF-ST-LUEP-PRO                 PIC X.
  2869         16  SF-ST-LUEP-ST                  PIC X.
  2870         16  SF-ST-LUEP-DOM                 PIC X.
  2871         16  SF-ST-AUEP-R78                 PIC X.
  2872         16  SF-ST-AUEP-PRO                 PIC X.
  2873         16  SF-ST-AUEP-ST                  PIC X.
  2874         16  SF-ST-AUEP-DOM                 PIC X.
  2875         16  SF-ST-CUEP-R78                 PIC X.
  2876         16  SF-ST-CUEP-PRO                 PIC X.
  2877         16  SF-ST-CUEP-ST                  PIC X.
  2878         16  SF-ST-CUEP-DOM                 PIC X.
  2879     12  SF-ST-EARN-PREM-OPTIONS.
  2880         16  SF-ST-LEP-R78                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  55
* EL050.cbl
  2881         16  SF-ST-LEP-PRO                  PIC X.
  2882         16  SF-ST-LEP-ST                   PIC X.
  2883         16  SF-ST-LEP-DOM                  PIC X.
  2884         16  SF-ST-AEP-R78                  PIC X.
  2885         16  SF-ST-AEP-PRO                  PIC X.
  2886         16  SF-ST-AEP-ST                   PIC X.
  2887         16  SF-ST-AEP-DOM                  PIC X.
  2888         16  SF-ST-CEP-R78                  PIC X.
  2889         16  SF-ST-CEP-PRO                  PIC X.
  2890         16  SF-ST-CEP-ST                   PIC X.
  2891         16  SF-ST-CEP-DOM                  PIC X.
  2892     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  56
* EL050.cbl
  2894*    COPY ELCCRTT.
  2895******************************************************************
  2896*                                                                *
  2897*                            ELCCRTT.                            *
  2898*                                                                *
  2899*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2900*                                                                *
  2901*   FILE TYPE = VSAM,KSDS                                        *
  2902*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2903*                                                                *
  2904*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2905*                                                                *
  2906*   LOG = YES                                                    *
  2907*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2908******************************************************************
  2909*                   C H A N G E   L O G
  2910*
  2911* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2912*-----------------------------------------------------------------
  2913*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2914* EFFECTIVE    NUMBER
  2915*-----------------------------------------------------------------
  2916* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2917* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2918* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2919* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2920* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2921* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2922******************************************************************
  2923
  2924 01  CERTIFICATE-TRAILERS.
  2925     12  CS-RECORD-ID                      PIC XX.
  2926         88  VALID-CS-ID                      VALUE 'CS'.
  2927
  2928     12  CS-CONTROL-PRIMARY.
  2929         16  CS-COMPANY-CD                 PIC X.
  2930         16  CS-CARRIER                    PIC X.
  2931         16  CS-GROUPING                   PIC X(6).
  2932         16  CS-STATE                      PIC XX.
  2933         16  CS-ACCOUNT                    PIC X(10).
  2934         16  CS-CERT-EFF-DT                PIC XX.
  2935         16  CS-CERT-NO.
  2936             20  CS-CERT-PRIME             PIC X(10).
  2937             20  CS-CERT-SFX               PIC X.
  2938         16  CS-TRAILER-TYPE               PIC X.
  2939             88  COMM-TRLR           VALUE 'A'.
  2940             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2941             88  CERT-DATA-TRLR      VALUE 'C'.
  2942
  2943     12  CS-DATA-AREA                      PIC X(516).
  2944
  2945     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2946         16  CS-BANK-COMMISSION-AREA.
  2947             20  CS-BANK-COMMS       OCCURS 10.
  2948                 24  CS-AGT                PIC X(10).
  2949                 24  CS-COM-TYP            PIC X.
  2950                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2951                 24  CS-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  57
* EL050.cbl
  2952                 24  FILLER                PIC X(10).
  2953         16  FILLER                        PIC X(256).
  2954
  2955     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2956****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2957         16  CS-MB-CLAIM-DATA OCCURS 24.
  2958             20  CS-CLAIM-NO               PIC X(7).
  2959             20  CS-CLAIM-TYPE             PIC X.
  2960                 88  CS-AH-CLM               VALUE 'A'.
  2961                 88  CS-IU-CLM               VALUE 'I'.
  2962                 88  CS-GP-CLM               VALUE 'G'.
  2963                 88  CS-LF-CLM               VALUE 'L'.
  2964                 88  CS-PR-CLM               VALUE 'P'.
  2965             20  CS-INSURED-TYPE           PIC X.
  2966                 88  CS-PRIM-INSURED          VALUE 'P'.
  2967                 88  CS-CO-BORROWER           VALUE 'C'.
  2968             20  CS-BENEFIT-PERIOD         PIC 99.
  2969             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2970             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2971             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2972         16  FILLER                        PIC X(12).
  2973     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2974         16  CS-VIN-NUMBER                 PIC X(17).
  2975         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2976         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2977         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2978         16  FILLER                        PIC X(496).
  2979*    COPY ELCCRTO.
  2980******************************************************************
  2981*                                                                *
  2982*                            ELCCRTO.                            *
  2983*                                                                *
  2984*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2985*                                                                *
  2986*   FILE TYPE = VSAM,KSDS                                        *
  2987*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2988*                                                                *
  2989*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2990*                                                                *
  2991*   LOG = YES                                                    *
  2992*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2993******************************************************************
  2994*                   C H A N G E   L O G
  2995*
  2996* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2997*-----------------------------------------------------------------
  2998*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2999* EFFECTIVE    NUMBER
  3000*-----------------------------------------------------------------
  3001* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3002* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3003* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3004* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3005* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3006******************************************************************
  3007 01  ORIGINAL-CERTIFICATE.
  3008     12  OC-RECORD-ID                      PIC XX.
  3009         88  VALID-OC-ID                      VALUE 'OC'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  58
* EL050.cbl
  3010     12  OC-CONTROL-PRIMARY.
  3011         16  OC-COMPANY-CD                 PIC X.
  3012         16  OC-CARRIER                    PIC X.
  3013         16  OC-GROUPING                   PIC X(6).
  3014         16  OC-STATE                      PIC XX.
  3015         16  OC-ACCOUNT                    PIC X(10).
  3016         16  OC-CERT-EFF-DT                PIC XX.
  3017         16  OC-CERT-NO.
  3018             20  OC-CERT-PRIME             PIC X(10).
  3019             20  OC-CERT-SFX               PIC X.
  3020         16  OC-RECORD-TYPE                PIC X.
  3021         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3022     12  OC-LAST-MAINT-DT                  PIC XX.
  3023     12  OC-LAST-MAINT-BY                  PIC X(4).
  3024     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3025     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3026     12  FILLER                            PIC X(49).
  3027     12  OC-ORIG-REC.
  3028         16  OC-INS-LAST-NAME              PIC X(15).
  3029         16  OC-INS-FIRST-NAME             PIC X(10).
  3030         16  OC-INS-MIDDLE-INIT            PIC X.
  3031         16  OC-INS-AGE                    PIC S999     COMP-3.
  3032         16  OC-JNT-LAST-NAME              PIC X(15).
  3033         16  OC-JNT-FIRST-NAME             PIC X(10).
  3034         16  OC-JNT-MIDDLE-INIT            PIC X.
  3035         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3036         16  OC-LF-BENCD                   PIC XX.
  3037         16  OC-LF-TERM                    PIC S999      COMP-3.
  3038         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3039         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3040         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3041         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3042         16  OC-LF-EXP-DT                  PIC XX.
  3043         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3044         16  OC-LF-CANCEL-DT               PIC XX.
  3045         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3046         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3047         16  OC-AH-BENCD                   PIC XX.
  3048         16  OC-AH-TERM                    PIC S999      COMP-3.
  3049         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3050         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3051         16  OC-AH-EXP-DT                  PIC XX.
  3052         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3053         16  OC-AH-CP                      PIC 99.
  3054         16  OC-AH-CANCEL-DT               PIC XX.
  3055         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3056         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3057         16  OC-CRED-BENE-NAME             PIC X(25).
  3058         16  OC-1ST-PMT-DT                 PIC XX.
  3059         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3060         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3061         16  OC-ISSUE-TRAN-IND             PIC X.
  3062         16  OC-CANCEL-TRAN-IND            PIC X.
  3063         16  FILLER                        PIC X(211).
  3064
  3065     12  FILLER                            PIC X(50).
  3066******************************************************************
  3067
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  59
* EL050.cbl
  3068*    COPY ELCDATE.
  3069******************************************************************
  3070*                                                                *
  3071*                                                                *
  3072*                            ELCDATE.                            *
  3073*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3074*                            VMOD=2.003
  3075*                                                                *
  3076*                                                                *
  3077*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3078*                 LENGTH = 200                                   *
  3079******************************************************************
  3080
  3081 01  DATE-CONVERSION-DATA.
  3082     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3083     12  DC-OPTION-CODE                PIC X.
  3084         88  BIN-TO-GREG                VALUE ' '.
  3085         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3086         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3087         88  YMD-GREG-TO-BIN            VALUE '3'.
  3088         88  MDY-GREG-TO-BIN            VALUE '4'.
  3089         88  JULIAN-TO-BIN              VALUE '5'.
  3090         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3091         88  FIND-CENTURY               VALUE '7'.
  3092         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3093         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3094         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3095         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3096         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3097         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3098         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3099         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3100         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3101         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3102         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3103         88  BIN-3-TO-GREG              VALUE 'I'.
  3104         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3105         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3106         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3107         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3108         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3109         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3110         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3111         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3112         88  THREE-CHARACTER-BIN
  3113                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3114         88  GREGORIAN-TO-BIN
  3115                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3116         88  BIN-TO-GREGORIAN
  3117                  VALUES ' ' '1' 'I' '8' 'G'.
  3118         88  JULIAN-TO-BINARY
  3119                  VALUES '5' 'C' 'E' 'F'.
  3120     12  DC-ERROR-CODE                 PIC X.
  3121         88  NO-CONVERSION-ERROR        VALUE ' '.
  3122         88  DATE-CONVERSION-ERROR
  3123                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3124         88  DATE-IS-ZERO               VALUE '1'.
  3125         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  60
* EL050.cbl
  3126         88  DATE-IS-INVALID            VALUE '3'.
  3127         88  DATE1-GREATER-DATE2        VALUE '4'.
  3128         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3129         88  DATE-INVALID-OPTION        VALUE '9'.
  3130         88  INVALID-CENTURY            VALUE 'A'.
  3131         88  ONLY-CENTURY               VALUE 'B'.
  3132         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3133         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3134     12  DC-END-OF-MONTH               PIC X.
  3135         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3136     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3137         88  USE-NORMAL-PROCESS         VALUE ' '.
  3138         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3139         88  ADJUST-UP-100-YRS          VALUE '2'.
  3140     12  FILLER                        PIC X.
  3141     12  DC-CONVERSION-DATES.
  3142         16  DC-BIN-DATE-1             PIC XX.
  3143         16  DC-BIN-DATE-2             PIC XX.
  3144         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3145         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3146                       DC-GREG-DATE-1-EDIT.
  3147             20  DC-EDIT1-MONTH        PIC 99.
  3148             20  SLASH1-1              PIC X.
  3149             20  DC-EDIT1-DAY          PIC 99.
  3150             20  SLASH1-2              PIC X.
  3151             20  DC-EDIT1-YEAR         PIC 99.
  3152         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3153         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3154                     DC-GREG-DATE-2-EDIT.
  3155             20  DC-EDIT2-MONTH        PIC 99.
  3156             20  SLASH2-1              PIC X.
  3157             20  DC-EDIT2-DAY          PIC 99.
  3158             20  SLASH2-2              PIC X.
  3159             20  DC-EDIT2-YEAR         PIC 99.
  3160         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3161         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3162                     DC-GREG-DATE-1-YMD.
  3163             20  DC-YMD-YEAR           PIC 99.
  3164             20  DC-YMD-MONTH          PIC 99.
  3165             20  DC-YMD-DAY            PIC 99.
  3166         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3167         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3168                      DC-GREG-DATE-1-MDY.
  3169             20  DC-MDY-MONTH          PIC 99.
  3170             20  DC-MDY-DAY            PIC 99.
  3171             20  DC-MDY-YEAR           PIC 99.
  3172         16  DC-GREG-DATE-1-ALPHA.
  3173             20  DC-ALPHA-MONTH        PIC X(10).
  3174             20  DC-ALPHA-DAY          PIC 99.
  3175             20  FILLER                PIC XX.
  3176             20  DC-ALPHA-CENTURY.
  3177                 24 DC-ALPHA-CEN-N     PIC 99.
  3178             20  DC-ALPHA-YEAR         PIC 99.
  3179         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3180         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3181         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3182         16  DC-JULIAN-DATE            PIC 9(05).
  3183         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  61
* EL050.cbl
  3184                                       PIC 9(05).
  3185         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3186             20  DC-JULIAN-YEAR        PIC 99.
  3187             20  DC-JULIAN-DAYS        PIC 999.
  3188         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3189         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3190         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3191     12  DATE-CONVERSION-VARIBLES.
  3192         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3193         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3194             20  FILLER                PIC 9(3).
  3195             20  HOLD-CEN-1-CCYY.
  3196                 24  HOLD-CEN-1-CC     PIC 99.
  3197                 24  HOLD-CEN-1-YY     PIC 99.
  3198             20  HOLD-CEN-1-MO         PIC 99.
  3199             20  HOLD-CEN-1-DA         PIC 99.
  3200         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3201             20  HOLD-CEN-1-R-MO       PIC 99.
  3202             20  HOLD-CEN-1-R-DA       PIC 99.
  3203             20  HOLD-CEN-1-R-CCYY.
  3204                 24  HOLD-CEN-1-R-CC   PIC 99.
  3205                 24  HOLD-CEN-1-R-YY   PIC 99.
  3206             20  FILLER                PIC 9(3).
  3207         16  HOLD-CENTURY-1-X.
  3208             20  FILLER                PIC X(3)  VALUE SPACES.
  3209             20  HOLD-CEN-1-X-CCYY.
  3210                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3211                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3212             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3213             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3214         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3215             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3216             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3217             20  HOLD-CEN-1-R-X-CCYY.
  3218                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3219                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3220             20  FILLER                PIC XXX.
  3221         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3222         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3223         16  DC-JULIAN-DATE-1          PIC 9(07).
  3224         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3225             20  DC-JULIAN-1-CCYY.
  3226                 24  DC-JULIAN-1-CC    PIC 99.
  3227                 24  DC-JULIAN-1-YR    PIC 99.
  3228             20  DC-JULIAN-DA-1        PIC 999.
  3229         16  DC-JULIAN-DATE-2          PIC 9(07).
  3230         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3231             20  DC-JULIAN-2-CCYY.
  3232                 24  DC-JULIAN-2-CC    PIC 99.
  3233                 24  DC-JULIAN-2-YR    PIC 99.
  3234             20  DC-JULIAN-DA-2        PIC 999.
  3235         16  DC-GREG-DATE-A-EDIT.
  3236             20  DC-EDITA-MONTH        PIC 99.
  3237             20  SLASHA-1              PIC X VALUE '/'.
  3238             20  DC-EDITA-DAY          PIC 99.
  3239             20  SLASHA-2              PIC X VALUE '/'.
  3240             20  DC-EDITA-CCYY.
  3241                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  62
* EL050.cbl
  3242                 24  DC-EDITA-YEAR     PIC 99.
  3243         16  DC-GREG-DATE-B-EDIT.
  3244             20  DC-EDITB-MONTH        PIC 99.
  3245             20  SLASHB-1              PIC X VALUE '/'.
  3246             20  DC-EDITB-DAY          PIC 99.
  3247             20  SLASHB-2              PIC X VALUE '/'.
  3248             20  DC-EDITB-CCYY.
  3249                 24  DC-EDITB-CENT     PIC 99.
  3250                 24  DC-EDITB-YEAR     PIC 99.
  3251         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3252         16  DC-GREG-DATE-CYMD-R REDEFINES
  3253                              DC-GREG-DATE-CYMD.
  3254             20  DC-CYMD-CEN           PIC 99.
  3255             20  DC-CYMD-YEAR          PIC 99.
  3256             20  DC-CYMD-MONTH         PIC 99.
  3257             20  DC-CYMD-DAY           PIC 99.
  3258         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3259         16  DC-GREG-DATE-MDCY-R REDEFINES
  3260                              DC-GREG-DATE-MDCY.
  3261             20  DC-MDCY-MONTH         PIC 99.
  3262             20  DC-MDCY-DAY           PIC 99.
  3263             20  DC-MDCY-CEN           PIC 99.
  3264             20  DC-MDCY-YEAR          PIC 99.
  3265    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3266        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3267    12  DC-EL310-DATE                  PIC X(21).
  3268    12  FILLER                         PIC X(28).
  3269
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  63
* EL050.cbl
  3271*    COPY ELCCALC.
  3272******************************************************************
  3273*                                                                *
  3274*                           ELCCALC.                            *
  3275*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3276*                            VMOD=2.025                          *
  3277*                                                                *
  3278*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3279*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3280*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3281*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3282*                                                                *
  3283*  PASSED TO ELRTRM                                              *
  3284*  -----------------                                             *
  3285*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3286*  ORIGINAL TERM                                                 *
  3287*  BEGINNING DATE                                                *
  3288*  ENDING DATE                                                   *
  3289*  COMPANY I.D.                                                  *
  3290*  ACCOUNT MASTER USER FIELD                                     *
  3291*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3292*  FREE LOOK DAYS                                                *
  3293*                                                                *
  3294*  RETURNED FROM ELRTRM                                          *
  3295*  ---------------------                                         *
  3296*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3297*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3298*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3299*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3300*----------------------------------------------------------------*
  3301*  PASSED TO ELRAMT                                              *
  3302*  ----------------                                              *
  3303*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3304*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3305*  ORIGINAL AMOUNT                                               *
  3306*  ALTERNATE BENEFIT (BALLON)                                    *
  3307*  A.P.R. - NET PAY ONLY                                         *
  3308*  METHOD
  3309*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3310*  COMPANY I.D.                                                  *
  3311*  BENEFIT TYPE                                                  *
  3312*                                                                *
  3313*  RETURNED FROM ELRAMT                                          *
  3314*  --------------------                                          *
  3315*  REMAINING AMOUNT 1 - CURRENT                                  *
  3316*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3317*  REMAINING AMOUNT FACTOR
  3318*----------------------------------------------------------------*
  3319*  PASSED TO ELRESV                                              *
  3320*  -----------------                                             *
  3321*  CERTIFICATE EFFECTIVE DATE                                    *
  3322*  VALUATION DATE                                                *
  3323*  PAID THRU DATE                                                *
  3324*  BENEFIT                                                       *
  3325*  INCURRED DATE                                                 *
  3326*  REPORTED DATE                                                 *
  3327*  ISSUE AGE                                                     *
  3328*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  64
* EL050.cbl
  3329*  CDT PERCENT                                                   *
  3330*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3331* *CLAIM TYPE (LIFE, A/H)                                        *
  3332* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3333* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3334*                                                                *
  3335*  RETURNED FROM ELRESV                                          *
  3336*  --------------------                                          *
  3337*  CDT TABLE USED                                                *
  3338*  CDT FACTOR USED                                               *
  3339*  PAY TO CURRENT RESERVE                                        *
  3340*  I.B.N.R. - A/H ONLY                                           *
  3341*  FUTURE (ACCRUED) AH ONLY                                      *
  3342*----------------------------------------------------------------*
  3343*  PASSED TO ELRATE                                              *
  3344*  ----------------                                              *
  3345*  CERT ISSUE DATE                                               *
  3346*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3347*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3348*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3349*  STATE CODE (CLIENT DEFINED)                                   *
  3350*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3351*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3352*  DEVIATION CODE                                                *
  3353*  ISSUE AGE                                                     *
  3354*  ORIGINAL BENEFIT AMOUNT                                       *
  3355*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3356*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3357*  BENEFIT KIND (LIFE OR A/H)                                    *
  3358*  A.P.R.                                                        *
  3359*  METHOD
  3360*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3361*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3362*  COMPANY I.D. (3 CHARACTER)                                    *
  3363*  BENEFIT CODE                                                  *
  3364*  BENEFIT OVERRIDE CODE                                         *
  3365*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3366*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3367*  JOINT INDICATOR (CSL ONLY)                                    *
  3368*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3369*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3370*                                                                *
  3371*  RETURNED FROM ELRATE                                          *
  3372*  --------------------                                          *
  3373*  CALCULATED PREMIUM                                            *
  3374*  PREMIUM RATE                                                  *
  3375*  MORTALITY CODE                                                *
  3376*  MAX ATTAINED AGE                                              *
  3377*  MAX AGE                                                       *
  3378*  MAX TERM                                                      *
  3379*  MAX MONTHLY BENEFIT                                           *
  3380*  MAX TOTAL BENIFIT                                             *
  3381*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3382*----------------------------------------------------------------*
  3383*  PASSED TO ELRFND                                              *
  3384*  ----------------                                              *
  3385*  CERT ISSUE DATE                                               *
  3386*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  65
* EL050.cbl
  3387*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3388*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3389*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3390*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3391*  STATE CODE (CLIENT DEFINED)                                   *
  3392*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3393*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3394*  DEVIATION CODE                                                *
  3395*  ISSUE AGE                                                     *
  3396*  ORIGINAL BENEFIT AMOUNT                                       *
  3397*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3398*  PROCESS TYPE (CANCEL)                                         *
  3399*  BENEFIT KIND (LIFE OR A/H)                                    *
  3400*  A.P.R.                                                        *
  3401*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3402*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3403*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3404*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3405*  COMPANY I.D. (3 CHARACTER)                                    *
  3406*  BENEFIT CODE                                                  *
  3407*  BENEFIT OVERRIDE CODE                                         *
  3408*                                                                *
  3409*  RETURNED FROM ELRFND                                          *
  3410*  --------------------                                          *
  3411*  CALCULATED REFUND                                             *
  3412*----------------------------------------------------------------*
  3413*  PASSED TO ELEARN                                              *
  3414*  ----------------                                              *
  3415*  CERT ISSUE DATE                                               *
  3416*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3417*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3418*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3419*  STATE CODE (CLIENT DEFINED)                                   *
  3420*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3421*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3422*  DEVIATION CODE                                                *
  3423*  ISSUE AGE                                                     *
  3424*  ORIGINAL BENEFIT AMOUNT                                       *
  3425*  BENEFIT KIND (LIFE OR A/H)                                    *
  3426*  A.P.R.                                                        *
  3427*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3428*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3429*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3430*  COMPANY I.D. (3 CHARACTER)                                    *
  3431*  BENEFIT CODE                                                  *
  3432*  BENEFIT OVERRIDE CODE                                         *
  3433*                                                                *
  3434*  RETURNED FROM ELEARN                                          *
  3435*  --------------------                                          *
  3436*  INDICATED  EARNINGS                                           *
  3437*----------------------------------------------------------------*
  3438*                 LENGTH = 450                                   *
  3439*                                                                *
  3440******************************************************************
  3441******************************************************************
  3442*                   C H A N G E   L O G
  3443*
  3444* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  66
* EL050.cbl
  3445*-----------------------------------------------------------------
  3446*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3447* EFFECTIVE    NUMBER
  3448*-----------------------------------------------------------------
  3449* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3450* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3451* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3452* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3453* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3454* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3455* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3456* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3457* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3458******************************************************************
  3459
  3460 01  CALCULATION-PASS-AREA.
  3461     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3462                                     COMP.
  3463
  3464     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3465       88  NO-CP-ERROR                             VALUE ZERO.
  3466       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3467                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3468       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3469       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3470       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3471       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3472       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3473       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3474       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3475       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3476       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3477       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3478       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3479       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3480       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3481       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3482       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3483       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3484       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3485
  3486     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3487       88  NO-CP-ERROR-2                           VALUE ZERO.
  3488***********************  INPUT AREAS ****************************
  3489
  3490     12  CP-CALCULATION-AREA.
  3491         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3492         16  CP-CERT-EFF-DT        PIC XX.
  3493         16  CP-VALUATION-DT       PIC XX.
  3494         16  CP-PAID-THRU-DT       PIC XX.
  3495         16  CP-BENEFIT-TYPE       PIC X.
  3496           88  CP-AH                               VALUE 'A' 'D'
  3497                                                   'I' 'U'.
  3498           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3499           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3500         16  CP-INCURRED-DT        PIC XX.
  3501         16  CP-REPORTED-DT        PIC XX.
  3502         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  67
* EL050.cbl
  3503         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3504         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3505                                     COMP-3.
  3506         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3507                                     COMP-3.
  3508         16  CP-CDT-METHOD         PIC X.
  3509           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3510           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3511           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3512         16  CP-CLAIM-TYPE         PIC X.
  3513           88  CP-AH-CLAIM                         VALUE 'A'.
  3514           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3515         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3516                                     COMP-3.
  3517         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3518                                     COMP-3.
  3519         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3520                                     COMP-3.
  3521         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3522                                     COMP-3.
  3523         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3524                                     COMP-3.
  3525         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3526                                     COMP-3.
  3527         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3528                                     COMP-3.
  3529         16  CP-REM-TERM-METHOD    PIC X.
  3530           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3531           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3532           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3533           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3534           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3535           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3536           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3537         16  CP-EARNING-METHOD     PIC X.
  3538           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3539           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3540           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3541           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3542           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3543           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3544           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3545           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3546           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3547           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3548           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3549           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3550           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3551           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3552         16  CP-PROCESS-TYPE       PIC X.
  3553           88  CP-CLAIM                            VALUE '1'.
  3554           88  CP-CANCEL                           VALUE '2'.
  3555           88  CP-ISSUE                            VALUE '3'.
  3556         16  CP-SPECIAL-CALC-CD    PIC X.
  3557           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3558           88  CP-1-MTH-INTEREST               VALUE ' '.
  3559           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3560           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  68
* EL050.cbl
  3561           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3562           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3563           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3564           88  CP-FARM-PLAN                    VALUE 'F'.
  3565           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3566           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3567           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3568           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3569           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3570           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3571           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3572           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3573           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3574           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3575                                                     'W' 'X'.
  3576           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3577           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3578           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3579           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3580           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3581           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3582           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3583           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3584           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3585           88  CP-CSL-METH-1                   VALUE '5'.
  3586           88  CP-CSL-METH-2                   VALUE '6'.
  3587           88  CP-CSL-METH-3                   VALUE '7'.
  3588           88  CP-CSL-METH-4                   VALUE '8'.
  3589
  3590         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3591                                     COMP-3.
  3592         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3593         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3594         16  CP-STATE              PIC XX          VALUE SPACE.
  3595         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3596         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3597           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3598               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3599         16  CP-R78-OPTION         PIC X.
  3600           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3601           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3602
  3603         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3604         16  CP-IBNR-RESERVE-SW    PIC X.
  3605         16  CP-CLAIM-STATUS       PIC X.
  3606         16  CP-RATE-FILE          PIC X.
  3607         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3608                                     COMP-3.
  3609
  3610         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3611         16  CP-AH-OVERRIDE-CODE   PIC X.
  3612
  3613         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3614                                     COMP-3.
  3615         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3616                                   PIC S9(5)V99 COMP-3.
  3617         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3618                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  69
* EL050.cbl
  3619         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3620                                     COMP-3.
  3621         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3622                                     COMP-3.
  3623         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3624                                  PIC S9(7)V99 COMP-3.
  3625
  3626         16  CP-PAID-FROM-DATE     PIC X(02).
  3627         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3628         16  CP-EXT-DAYS-CALC      PIC X.
  3629           88  CP-EXT-NO-CHG                   VALUE ' '.
  3630           88  CP-EXT-CHG-LF                   VALUE '1'.
  3631           88  CP-EXT-CHG-AH                   VALUE '2'.
  3632           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3633         16  CP-DOMICILE-STATE     PIC XX.
  3634         16  CP-CARRIER            PIC X.
  3635         16  CP-REIN-FLAG          PIC X.
  3636         16  CP-REM-TRM-CALC-OPTION PIC X.
  3637           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3638                      '2' '3' '4' '5'.
  3639           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3640           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3641           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3642           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3643           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3644           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3645           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3646           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3647         16  CP-SIG-SWITCH         PIC X.
  3648         16  CP-RATING-METHOD      PIC X.
  3649           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3650           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3651           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3652           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3653           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3654           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3655           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3656           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3657           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3658         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3659                                     COMP-3.
  3660         16  CP-BEN-CATEGORY       PIC X.
  3661         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3662         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3663                                   PIC S99V9(5) COMP-3.
  3664         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3665         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3666                                   PIC S99V9(5) COMP-3.
  3667         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3668         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3669         16  CP-EXPIRE-DT          PIC XX.
  3670         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3671         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3672         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3673         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3674         16  CP-DDF-SPEC-CALC      PIC X.
  3675             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3676             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  70
* EL050.cbl
  3677         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3678         16  CP-CANCEL-REASON      PIC X.
  3679         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3680         16  CP-PMT-MODE           PIC X.
  3681         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3682         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3683         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3684         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3685         16  FILLER                PIC X.
  3686
  3687***************    OUTPUT FROM ELRESV   ************************
  3688
  3689         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3690
  3691         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3692                                     COMP-3.
  3693         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3694                                     COMP-3.
  3695         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3696                                     COMP-3.
  3697         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3698                                     COMP-3.
  3699         16  FILLER                PIC X(09).
  3700***************    OUTPUT FROM ELRTRM   *************************
  3701
  3702         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3703                                     COMP-3.
  3704         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3705                                     COMP-3.
  3706         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3707                                     COMP-3.
  3708         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3709                                     COMP-3.
  3710         16  FILLER                PIC X(12).
  3711
  3712***************    OUTPUT FROM ELRAMT   *************************
  3713
  3714         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3715                                     COMP-3.
  3716         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3717                                     COMP-3.
  3718         16  FILLER                PIC X(12).
  3719
  3720***************    OUTPUT FROM ELRATE   *************************
  3721
  3722         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3723                                     COMP-3.
  3724         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3725                                     COMP-3.
  3726         16  CP-MORTALITY-CODE     PIC X(4).
  3727         16  CP-RATE-EDIT-FLAG     PIC X.
  3728             88  CP-RATES-NEED-APR                  VALUE '1'.
  3729         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3730                                     COMP-3.
  3731         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3732         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3733         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3734                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  71
* EL050.cbl
  3735         16  FILLER                PIC X(07).
  3736
  3737***************    OUTPUT FROM ELRFND   *************************
  3738
  3739         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3740                                     COMP-3.
  3741         16  CP-REFUND-TYPE-USED   PIC X.
  3742           88  CP-R-AS-R78                         VALUE '1'.
  3743           88  CP-R-AS-PRORATA                     VALUE '2'.
  3744           88  CP-R-AS-CALIF                       VALUE '3'.
  3745           88  CP-R-AS-TEXAS                       VALUE '4'.
  3746           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3747           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3748           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3749           88  CP-R-AS-MEAN                        VALUE '8'.
  3750           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3751           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3752           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3753           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3754           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3755           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3756         16  FILLER                PIC X(12).
  3757
  3758***************    OUTPUT FROM ELEARN   *************************
  3759
  3760         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3761                                     COMP-3.
  3762         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3763                                     COMP-3.
  3764         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3765                                     COMP-3.
  3766         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3767                                     COMP-3.
  3768         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3769                                     COMP-3.
  3770         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3771                                     COMP-3.
  3772         16  CP-EARNING-TYPE-USED  PIC X.
  3773           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3774           88  CP-E-AS-R78                         VALUE '1'.
  3775           88  CP-E-AS-PRORATA                     VALUE '2'.
  3776           88  CP-E-AS-TEXAS                       VALUE '4'.
  3777           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3778           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3779           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3780           88  CP-E-AS-MEAN                        VALUE '8'.
  3781           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3782         16  FILLER                PIC X(12).
  3783
  3784***************    OUTPUT FROM ELPMNT   *************************
  3785
  3786         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3787                                     COMP-3.
  3788         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3789                                     COMP-3.
  3790         16  FILLER                PIC X(12).
  3791
  3792***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  72
* EL050.cbl
  3793         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3794                                     COMP-3.
  3795         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3796                                     COMP-3.
  3797         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3798                                     COMP-3.
  3799         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3800                                     COMP-3.
  3801         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3802                                     COMP-3.
  3803         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3804                                     COMP-3.
  3805         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3806             88  OPEN-RATE-FILE                   VALUE 'O'.
  3807             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3808             88  IO-ERROR                         VALUE 'E'.
  3809
  3810         16  CP-FIRST-PAY-DATE     PIC XX.
  3811
  3812         16  CP-JOINT-INDICATOR    PIC X.
  3813
  3814         16  CP-RESERVE-REMAINING-TERM
  3815                                   PIC S9(4)V9    VALUE ZERO
  3816                                     COMP-3.
  3817
  3818         16  CP-INSURED-BIRTH-DT   PIC XX.
  3819
  3820         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3821                                     COMP-3.
  3822
  3823         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3824                                     COMP-3.
  3825
  3826         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3827                                     COMP-3.
  3828
  3829         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3830                                     COMP-3.
  3831
  3832         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3833                                     COMP-3.
  3834
  3835         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3836                                     COMP-3.
  3837
  3838         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3839                                     COMP-3.
  3840
  3841         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3842             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3843
  3844         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3845                                     COMP-3.
  3846         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3847                                     COMP-3.
  3848         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3849         16  FILLER                PIC X(15).
  3850******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  73
* EL050.cbl
  3852******************************************************************
  3853*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3854*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3855*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3856*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3857*** MODIFICATION.                                              ***
  3858*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3859*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3860******************************************************************
  3861*    COPY ERCPNDB.
  3862******************************************************************
  3863*                                                                *
  3864*                                                                *
  3865*                            ERCPNDB.                            *
  3866*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3867*                            VMOD=2.025                          *
  3868*                                                                *
  3869*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3870*                                                                *
  3871******************************************************************
  3872*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3873*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3874******************************************************************
  3875*                                                                *
  3876*                                                                *
  3877*   FILE TYPE = VSAM,KSDS                                        *
  3878*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3879*                                                                *
  3880*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3881*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3882*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3883*                                                 RKP=13,LEN=36  *
  3884*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3885*                                      AND CHG-SEQ.)             *
  3886*                                                RKP=49,LEN=11   *
  3887*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3888*                                      AND CHG-SEQ.)             *
  3889*                                                RKP=60,LEN=15   *
  3890*                                                                *
  3891*   LOG = NO                                                     *
  3892*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3893******************************************************************
  3894******************************************************************
  3895*                   C H A N G E   L O G
  3896*
  3897* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3898*-----------------------------------------------------------------
  3899*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3900* EFFECTIVE    NUMBER
  3901*-----------------------------------------------------------------
  3902* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3903* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3904* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3905* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3906* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3907* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3908* 032306                   PEMA  ADD BOW LOAN NUMBER
  3909* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  74
* EL050.cbl
  3910* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3911* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3912* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3913* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3914* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3915* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3916* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3917******************************************************************
  3918
  3919 01  PENDING-BUSINESS.
  3920     12  PB-RECORD-ID                     PIC XX.
  3921         88  VALID-PB-ID                        VALUE 'PB'.
  3922
  3923     12  PB-CONTROL-PRIMARY.
  3924         16  PB-COMPANY-CD                PIC X.
  3925         16  PB-ENTRY-BATCH               PIC X(6).
  3926         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3927         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3928
  3929     12  PB-CONTROL-BY-ACCOUNT.
  3930         16  PB-COMPANY-CD-A1             PIC X.
  3931         16  PB-CARRIER                   PIC X.
  3932         16  PB-GROUPING.
  3933             20  PB-GROUPING-PREFIX       PIC XXX.
  3934             20  PB-GROUPING-PRIME        PIC XXX.
  3935         16  PB-STATE                     PIC XX.
  3936         16  PB-ACCOUNT.
  3937             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3938             20  PB-ACCOUNT-PRIME         PIC X(6).
  3939         16  PB-CERT-EFF-DT               PIC XX.
  3940         16  PB-CERT-NO.
  3941             20  PB-CERT-PRIME            PIC X(10).
  3942             20  PB-CERT-SFX              PIC X.
  3943         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3944
  3945         16  PB-RECORD-TYPE               PIC X.
  3946             88  PB-MAILING-DATA                VALUE '0'.
  3947             88  PB-ISSUE                       VALUE '1'.
  3948             88  PB-CANCELLATION                VALUE '2'.
  3949             88  PB-BATCH-TRAILER               VALUE '9'.
  3950
  3951     12  PB-CONTROL-BY-ORIG-BATCH.
  3952         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3953         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3954         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3955         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3956
  3957     12  PB-CONTROL-BY-CSR.
  3958         16  PB-CSR-COMPANY-CD            PIC X.
  3959         16  PB-CSR-ID                    PIC X(4).
  3960         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3961         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3962         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3963******************************************************************
  3964*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3965******************************************************************
  3966
  3967     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  75
* EL050.cbl
  3968     12  PB-LAST-MAINT-BY                 PIC X(4).
  3969     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3970
  3971     12  PB-RECORD-BODY                   PIC X(375).
  3972
  3973     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3974         16  PB-CERT-ORIGIN               PIC X.
  3975             88  CLASIC-CREATED-CERT         VALUE '1'.
  3976         16  PB-I-NAME.
  3977             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3978             20  PB-I-INSURED-FIRST-NAME.
  3979                 24  PB-I-INSURED-1ST-INIT PIC X.
  3980                 24  FILLER                PIC X(9).
  3981             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3982         16  PB-I-AGE                     PIC S99   COMP-3.
  3983         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3984         16  PB-I-BIRTHDAY                PIC XX.
  3985         16  PB-I-INSURED-SEX             PIC X.
  3986             88  PB-SEX-MALE     VALUE 'M'.
  3987             88  PB-SEX-FEMALE   VALUE 'F'.
  3988
  3989         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3990         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3991         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3992         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3993         16  PB-I-SKIP-CODE               PIC X.
  3994             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3995             88  PB-SKIP-JULY              VALUE '1'.
  3996             88  PB-SKIP-AUGUST            VALUE '2'.
  3997             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3998             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3999             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4000             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4001             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4002             88  PB-SKIP-JUNE              VALUE '8'.
  4003             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4004             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4005             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4006         16  PB-I-TERM-TYPE               PIC X.
  4007             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4008             88  PB-PAID-WEEKLY            VALUE 'W'.
  4009             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4010             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4011             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4012         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4013         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4014         16  PB-I-DATA-ENTRY-SW           PIC X.
  4015             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4016             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4017             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4018             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4019         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4020         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4021*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4022         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4023         16  FILLER                       PIC X.
  4024
  4025         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  76
* EL050.cbl
  4026             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4027             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4028                                                   '90' THRU '99'.
  4029         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4030                                          PIC XX.
  4031         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4032         16  PB-I-AMOUNT-FINANCED REDEFINES
  4033                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4034         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4035         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4036                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4037         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4038         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4039         16  PB-I-CLP-AMOUNT REDEFINES
  4040                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4041         16  PB-I-LF-CALC-FLAG            PIC X.
  4042             88 PB-COMP-LF-PREM               VALUE '?'.
  4043         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4044         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4045         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4046         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4047         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4048         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4049         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4050         16  PB-I-LF-ABBR                 PIC XXX.
  4051         16  PB-I-LF-INPUT-CD             PIC XX.
  4052
  4053         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4054             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4055             88  PB-INVALID-AH               VALUE '  ' '00'
  4056                                                   '90' THRU '99'.
  4057         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4058         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4059         16  PB-I-AH-CALC-FLAG            PIC X.
  4060             88 PB-COMP-AH-PREM                  VALUE '?'.
  4061         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4062         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4063         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4064         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4065         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4066         16  PB-I-AH-ABBR                 PIC XXX.
  4067         16  PB-I-AH-INPUT-CD             PIC XXX.
  4068
  4069         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4070         16  PB-I-REIN-TABLE              PIC XXX.
  4071         16  PB-I-BUSINESS-TYPE           PIC 99.
  4072         16  PB-I-INDV-GRP-CD             PIC X.
  4073         16  PB-I-MORT-CODE.
  4074             20  PB-I-TABLE               PIC X.
  4075             20  PB-I-INTEREST            PIC XX.
  4076             20  PB-I-MORT-TYP            PIC X.
  4077         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4078         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4079         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4080         16  PB-I-INDV-GRP-OVRD           PIC X.
  4081         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4082         16  PB-I-SIG-SW                  PIC X.
  4083             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  77
* EL050.cbl
  4084         16  PB-I-RATE-CLASS              PIC XX.
  4085         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4086         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4087         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4088         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4089         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4090         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4091         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4092         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4093         16  PB-I-OB-FLAG                 PIC X.
  4094             88  PB-I-OB                      VALUE 'B'.
  4095             88  PB-I-SUMMARY                 VALUE 'Z'.
  4096         16  PB-I-ENTRY-STATUS            PIC X.
  4097             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4098                                              'M' '5' '9' '2'.
  4099             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4100             88  PB-I-POLICY-PENDING          VALUE '2'.
  4101             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4102             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4103             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4104             88  PB-I-REIN-ONLY               VALUE '9'.
  4105             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4106             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4107             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4108             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4109         16  PB-I-INT-CODE                PIC X.
  4110             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4111             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4112         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4113         16  PB-I-SOC-SEC-NO              PIC X(11).
  4114         16  PB-I-MEMBER-NO               PIC X(12).
  4115         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4116*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4117         16  PB-I-OLD-LOF                 PIC XXX.
  4118         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4119         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4120         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4121         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4122         16  PB-I-LIFE-INDICATOR          PIC X.
  4123             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4124         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4125         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4126                                          PIC S9(5)V99    COMP-3.
  4127         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4128             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4129             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4130         16  PB-I-1ST-PMT-DT              PIC XX.
  4131         16  PB-I-JOINT-INSURED.
  4132             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4133             20 PB-I-JOINT-FIRST-NAME.
  4134                24  PB-I-JOINT-FIRST-INIT PIC X.
  4135                24  FILLER                PIC X(9).
  4136             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4137*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4138         16  PB-I-BENEFICIARY-NAME.
  4139             20  PB-I-BANK-NUMBER         PIC X(10).
  4140             20  FILLER                   PIC X(15).
  4141         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  78
* EL050.cbl
  4142         16  PB-I-REFERENCE               PIC X(12).
  4143         16  FILLER REDEFINES PB-I-REFERENCE.
  4144             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4145             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4146             20  PB-I-CLP-STATE           PIC XX.
  4147         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4148             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4149             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4150             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4151         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4152         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4153         16  PB-I-RESIDENT-STATE          PIC XX.
  4154         16  PB-I-RATE-CODE               PIC X(4).
  4155         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4156         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4157         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4158         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4159         16  PB-I-BANK-NOCHRGB            PIC 99.
  4160         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4161         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4162
  4163     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4164         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4165             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4166         16  PB-C-CANCEL-ORIGIN           PIC X.
  4167             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4168         16  PB-C-LF-CANCEL-DT            PIC XX.
  4169         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4170         16  PB-C-LF-CALC-REQ             PIC X.
  4171             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4172         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4173         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4174         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4175             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4176         16  PB-C-AH-CANCEL-DT            PIC XX.
  4177         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4178         16  PB-C-AH-CALC-REQ             PIC X.
  4179             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4180         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4181         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4182         16  PB-C-LAST-NAME               PIC X(15).
  4183         16  PB-C-REFUND-SW               PIC X.
  4184             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4185             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4186         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4187         16  PB-C-PAYEE-CODE              PIC X(6).
  4188         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4189         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4190         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4191         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4192         16  PB-C-REFERENCE               PIC X(12).
  4193         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4194         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4195         16  PB-C-POST-CARD-IND           PIC X.
  4196         16  PB-C-CANCEL-REASON           PIC X.
  4197         16  PB-C-REF-INTERFACE-SW        PIC X.
  4198         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4199         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  79
* EL050.cbl
  4200         16  FILLER                       PIC X(01).
  4201*        16  FILLER                       PIC X(18).
  4202         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4203*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4204         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4205         16  PB-CANCELED-CERT-DATA.
  4206             20  PB-CI-INSURED-NAME.
  4207                 24  PB-CI-LAST-NAME      PIC X(15).
  4208                 24  PB-CI-INITIALS       PIC XX.
  4209             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4210             20  PB-CI-INSURED-SEX        PIC X.
  4211             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4212             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4213             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4214             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4215             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4216             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4217             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4218             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4219             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4220             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4221             20  PB-CI-RATE-CLASS         PIC XX.
  4222             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4223             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4224             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4225             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4226             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4227             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4228             20  PB-CI-LF-ABBR            PIC X(3).
  4229             20  PB-CI-AH-ABBR            PIC X(3).
  4230             20  PB-CI-OB-FLAG            PIC X.
  4231                 88  PB-CI-OB                VALUE 'B'.
  4232             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4233                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4234                                           'M' '4' '5' '9' '2'.
  4235                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4236                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4237                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4238                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4239                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4240                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4241                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4242                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4243                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4244                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4245                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4246                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4247             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4248                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4249                                           'M' '4' '5' '9' '2'.
  4250                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4251                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4252                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4253                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4254                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4255                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4256                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4257                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  80
* EL050.cbl
  4258                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4259                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4260                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4261                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4262             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4263             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4264             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4265             20  PB-CI-MEMBER-NO          PIC X(12).
  4266             20  PB-CI-INT-CODE           PIC X.
  4267                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4268                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4269             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4270             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4271             20  PB-CI-COMP-EXCP-SW       PIC X.
  4272                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4273                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4274             20  PB-CI-ENTRY-STATUS       PIC X.
  4275             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4276             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4277             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4278             20  PB-CI-DEATH-DT           PIC XX.
  4279             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4280             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4281             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4282             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4283             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4284             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4285             20  PB-CI-ENTRY-DT              PIC XX.
  4286             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4287             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4288             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4289             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4290             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4291             20  PB-CI-OLD-LOF               PIC XXX.
  4292*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4293             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4294             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4295             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4296             20  PB-CI-INDV-GRP-CD           PIC X.
  4297             20  PB-CI-BENEFICIARY-NAME.
  4298                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4299                 24  FILLER                  PIC X(15).
  4300             20  PB-CI-NOTE-SW               PIC X.
  4301             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4302             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4303             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4304             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4305             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4306             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4307             20  PB-CI-FIRST-NAME            PIC X(10).
  4308             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4309
  4310         16  FILLER                       PIC X(13).
  4311*032306  16  FILLER                       PIC X(27).
  4312*        16  FILLER                       PIC X(46).
  4313
  4314     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4315         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  81
* EL050.cbl
  4316         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4317         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4318         16  PB-M-INSURED-MID-INIT        PIC X.
  4319         16  PB-M-INSURED-AGE             PIC 99.
  4320         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4321         16  PB-M-INSURED-SEX             PIC X.
  4322         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4323         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4324         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4325         16  PB-M-INSURED-CITY-STATE.
  4326             20  PB-M-INSURED-CITY        PIC X(28).
  4327             20  PB-M-INSURED-STATE       PIC XX.
  4328         16  PB-M-INSURED-ZIP-CODE.
  4329             20  PB-M-INSURED-ZIP-PRIME.
  4330                 24  PB-M-INSURED-ZIP-1   PIC X.
  4331                     88  PB-M-CANADIAN-POST-CODE
  4332                                             VALUE 'A' THRU 'Z'.
  4333                 24  FILLER               PIC X(4).
  4334             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4335         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4336                                        PB-M-INSURED-ZIP-CODE.
  4337             20  PM-M-INS-CAN-POST1       PIC XXX.
  4338             20  PM-M-INS-CAN-POST2       PIC XXX.
  4339             20  FILLER                   PIC XXX.
  4340         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4341         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4342         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4343         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4344         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4345         16  PB-M-CRED-BENE-CITYST.
  4346             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4347             20  PB-M-CRED-BENE-STATE     PIC XX.
  4348         16  FILLER                       PIC X(92).
  4349
  4350     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4351         16  FILLER                       PIC X(10).
  4352         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4353         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4354         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4355         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4356         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4357         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4358         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4359         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4360         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4361         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4362         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4363         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4364         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4365         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4366         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4367         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4368         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4369         16  PB-ACCOUNT-NAME              PIC X(30).
  4370         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4371         16  PB-REFERENCE                 PIC X(12).
  4372         16  PB-B-RECEIVED-DT             PIC XX.
  4373         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  82
* EL050.cbl
  4374
  4375     12  PB-RECORD-STATUS.
  4376         16  PB-CREDIT-SELECT-DT          PIC XX.
  4377         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4378         16  PB-BILLED-DT                 PIC XX.
  4379         16  PB-BILLING-STATUS            PIC X.
  4380             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4381             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4382             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4383         16  PB-RECORD-BILL               PIC X.
  4384             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4385             88  PB-RECORD-RETURNED           VALUE 'R'.
  4386             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4387             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4388             88  PB-OVERRIDE-AH               VALUE 'A'.
  4389             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4390         16  PB-BATCH-ENTRY               PIC X.
  4391             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4392             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4393             88  PB-REISSUED-CERT             VALUE 'E'.
  4394             88  PB-MONTHLY-CERT              VALUE 'M'.
  4395             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4396             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4397             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4398         16  PB-FORCE-CODE                PIC X.
  4399             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4400             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4401             88  PB-CANCEL-FORCE              VALUE '8'.
  4402             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4403             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4404             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4405             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4406             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4407             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4408             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4409         16  PB-FATAL-FLAG                PIC X.
  4410             88  PB-FATAL-ERRORS              VALUE 'X'.
  4411         16  PB-FORCE-ER-CD               PIC X.
  4412             88  PB-FORCE-ERRORS              VALUE 'F'.
  4413             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4414         16  PB-WARN-ER-CD                PIC X.
  4415             88  PB-WARNING-ERRORS            VALUE 'W'.
  4416         16  FILLER                       PIC X.
  4417         16  PB-OUT-BAL-CD                PIC X.
  4418             88  PB-OUT-OF-BAL                VALUE 'O'.
  4419         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4420         16  PB-AH-OVERRIDE-L1            PIC X.
  4421         16  PB-INPUT-DT                  PIC XX.
  4422         16  PB-INPUT-BY                  PIC X(4).
  4423         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4424         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4425         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4426         16  PB-LF-EARNING-METHOD         PIC X.
  4427         16  PB-AH-EARNING-METHOD         PIC X.
  4428         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4429         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4430         16  PB-REIN-CD                   PIC XXX.
  4431         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  83
* EL050.cbl
  4432         16  PB-AH-REFUND-TYPE            PIC X.
  4433         16  PB-ACCT-EFF-DT               PIC XX.
  4434         16  PB-ACCT-EXP-DT               PIC XX.
  4435         16  PB-COMPANY-ID                PIC X(3).
  4436         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4437         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4438         16  PB-SV-CARRIER                PIC X.
  4439         16  PB-SV-GROUPING               PIC X(6).
  4440         16  PB-SV-STATE                  PIC XX.
  4441         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4442         16  PB-GA-BILLING-INFO.
  4443             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4444                                          PIC XX.
  4445         16  PB-SV-REMIT-TO  REDEFINES
  4446             PB-GA-BILLING-INFO           PIC X(10).
  4447         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4448         16  PB-I-LOAN-OFFICER            PIC X(5).
  4449         16  PB-I-VIN                     PIC X(17).
  4450
  4451         16  FILLER                       PIC X(04).
  4452         16  IMNET-BYPASS-SW              PIC X.
  4453
  4454******************************************************************
  4455*                COMMON EDIT ERRORS                              *
  4456******************************************************************
  4457
  4458     12  PB-COMMON-ERRORS.
  4459         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4460                                           PIC S9(4)     COMP.
  4461
  4462******************************************************************
  4463
  4464* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4465*    COPY ELC50W1.
  4466******************************************************************
  4467*                                                                *
  4468*                                                                *
  4469*                             ELC50W1                            *
  4470*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4471*                            VMOD=2.004                          *
  4472*                                                                *
  4473*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4474*                                                                *
  4475*                                                                *
  4476******************************************************************
  4477
  4478     12  WK-WORK-AREA.
  4479         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4480         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4481         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4482         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4483         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4484         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4485         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4486         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4487         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4488         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4489         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  84
* EL050.cbl
  4490         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4491         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4492         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4493         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4494         16  WK-CREDIT-EDIT-CONTROLS.
  4495             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4496             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4497             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4498             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4499             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4500             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4501         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4502         16  WK-SAVE-REIN-DATA.
  4503             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4504             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4505             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4506         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4507             88  ENTRY-FROM-EL6311       VALUE '6'.
  4508         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4509         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4510     12  WK-RECORD-ADDRESSES.
  4511         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4512         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4513         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4514         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4515         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4516         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4517         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4518         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4519     12  WK-OVER-SHORT-AREA.
  4520         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4521         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4522         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4523             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4524         16  FILLER                   PIC X(5) VALUE SPACES.
  4525
  4526*    COPY ELCEDITC.
  4527******************************************************************
  4528*                                                                *
  4529*                                                                *
  4530*                            ELCEDITC                            *
  4531*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4532*                            VMOD=2.012                          *
  4533*                                                                *
  4534*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4535*                     EL6313, EL050 AND EL517.                   *
  4536*                                                                *
  4537******************************************************************
  4538******************************************************************
  4539*                   C H A N G E   L O G
  4540*
  4541* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4542*-----------------------------------------------------------------
  4543*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4544* EFFECTIVE    NUMBER
  4545*-----------------------------------------------------------------
  4546* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4547******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  85
* EL050.cbl
  4548
  4549     12  EDIT-CRITERIA-DATA.
  4550         16  EC-CO-MONTH-END-DT       PIC XX.
  4551         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4552         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4553         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4554         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4555         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4556         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4557         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4558         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4559         16  EC-CO-REM-TERM-CALC      PIC X.
  4560               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4561               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4562               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4563               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4564
  4565         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4566               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4567               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4568               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4569               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4570               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4571               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4572               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4573               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4574               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4575               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4576
  4577         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4578               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4579               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4580               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4581               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4582               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4583               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4584               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4585               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4586
  4587         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4588                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4589                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4590
  4591         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4592                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4593                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4594                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4595                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4596                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4597                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4598                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4599                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4600
  4601         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4602               88  EC-BR-REDUCING                   VALUE 'R'.
  4603               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4604
  4605         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  86
* EL050.cbl
  4606         16  EC-BR-LF-DESC             PIC X(10).
  4607         16  EC-BR-AH-DESC             PIC X(10).
  4608         16  EC-BR-LF-COMMENT          PIC X(10).
  4609         16  EC-BR-AH-COMMENT          PIC X(10).
  4610
  4611         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4612               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4613               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4614               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4615               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4616
  4617         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4618               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4619               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4620               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4621               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4622
  4623         16  EC-BR-LF-REFUND-CALC      PIC X.
  4624                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4625                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4626                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4627                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4628                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4629                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4630                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4631
  4632         16  EC-BR-AH-REFUND-CALC      PIC X.
  4633                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4634                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4635                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4636                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4637                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4638                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4639                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4640                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4641
  4642         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4643                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4644                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4645                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4646
  4647         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4648                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4649                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4650                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4651
  4652         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4653         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4654         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4655         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4656
  4657         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4658         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4659                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4660                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4661                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4662                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4663
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  87
* EL050.cbl
  4664         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4665               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4666               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4667               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4668               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4669               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4670
  4671         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4672               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4673               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4674               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4675               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4676               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4677
  4678         16  EC-ST-LF-REFUND-CALC      PIC X.
  4679                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4680                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4681                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4682                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4683                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4684                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4685                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4686                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4687
  4688         16  EC-ST-AH-REFUND-CALC      PIC X.
  4689                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4690                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4691                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4692                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4693                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4694                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4695                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4696                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4697
  4698         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4699         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4700         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4701         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4702         16  EC-AM-EXPIRATION-DT       PIC XX.
  4703         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4704         16  EC-AM-CLASS-CD            PIC XX.
  4705         16  EC-AM-LF-DEVIATION        PIC XXX.
  4706         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4707         16  EC-AM-AH-DEVIATION        PIC XXX.
  4708         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4709         16  EC-AM-PHONE-NO            PIC X(10).
  4710
  4711         16  EC-AM-LF-REFUND-CALC      PIC X.
  4712                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4713                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4714                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4715                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4716                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4717                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4718                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4719
  4720         16  EC-AM-AH-REFUND-CALC      PIC X.
  4721                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  88
* EL050.cbl
  4722                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4723                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4724                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4725                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4726                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4727                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4728
  4729         16  EC-AM-BEN-I-G-CD          PIC X.
  4730                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4731                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4732                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4733
  4734         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4735         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4736         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4737         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4738         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4739         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4740         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4741         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4742         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4743
  4744         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4745         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4746         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4747         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4748         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4749         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4750         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4751         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4752         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4753         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4754         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4755         16  EC-RT-LF-NSP-ST           PIC XX.
  4756         16  EC-RT-AH-NSP-ST           PIC XX.
  4757         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4758         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4759
  4760         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4761             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4762                                             'M' '5' '9' '2'.
  4763             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4764             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4765             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4766             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4767             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4768             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4769             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4770             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4771             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4772             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4773
  4774         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4775             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4776                                             'M' '5' '9' '2'.
  4777             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4778             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4779             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  89
* EL050.cbl
  4780             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4781             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4782             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4783             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4784             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4785             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4786             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4787
  4788         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4789         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4790         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4791         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4792         16  EC-CM-DEATH-DT            PIC XX.
  4793
  4794*DMD CUSTOM CODING FIELDS BELOW
  4795*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4796         16  EC-BR-DMD-RATING-SW       PIC X.
  4797                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4798                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4799                 88  NO-DMD-RATING               VALUE 'N'.
  4800
  4801         16  EC-NEW-CERT               PIC X(11).
  4802         16  EC-NEW-STATE              PIC XX.
  4803         16  FILLER                    PIC X.
  4804*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4805         16  OVER-SHORT-EDIT-FIELDS.
  4806             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4807             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4808             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4809             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4810             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4811             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4812             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4813             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4814             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4815         16  FILLER                    PIC X(71).
  4816******************************************************************
  4817
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  90
* EL050.cbl
  4819*    COPY ELCDIFRD.
  4820******************************************************************
  4821*                                                                *
  4822*                                                                *
  4823*                            ELCDIFRD.                           *
  4824*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4825*                            VMOD=2.004                          *
  4826*                                                                *
  4827*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4828*                                                                *
  4829******************************************************************
  4830*
  4831  01  WS-DIFFERENCE-CALCULATION.
  4832        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4833        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4834        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4835        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4836        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4837        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4838        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4839        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4840        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4841        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4842        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4843
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  91
* EL050.cbl
  4845****************************************************************
  4846*
  4847* Copyright (c) 2007 by Clerity Solutions, Inc.
  4848* All rights reserved.
  4849*
  4850****************************************************************
  4851 01  DFHEIV.
  4852   02  DFHEIV0               PIC X(35).
  4853   02  DFHEIV1               PIC X(08).
  4854   02  DFHEIV2               PIC X(08).
  4855   02  DFHEIV3               PIC X(08).
  4856   02  DFHEIV4               PIC X(06).
  4857   02  DFHEIV5               PIC X(04).
  4858   02  DFHEIV6               PIC X(04).
  4859   02  DFHEIV7               PIC X(02).
  4860   02  DFHEIV8               PIC X(02).
  4861   02  DFHEIV9               PIC X(01).
  4862   02  DFHEIV10              PIC S9(7) COMP-3.
  4863   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4864   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4865   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4866   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4867   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4868   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4869   02  DFHEIV17              PIC X(04).
  4870   02  DFHEIV18              PIC X(04).
  4871   02  DFHEIV19              PIC X(04).
  4872   02  DFHEIV20              USAGE IS POINTER.
  4873   02  DFHEIV21              USAGE IS POINTER.
  4874   02  DFHEIV22              USAGE IS POINTER.
  4875   02  DFHEIV23              USAGE IS POINTER.
  4876   02  DFHEIV24              USAGE IS POINTER.
  4877   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4878   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4879   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4880   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4881   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4882   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4883   02  FILLER                PIC X(02).
  4884   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4885   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4886   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4887   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4888   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4889 LINKAGE  SECTION.
  4890*****************************************************************
  4891*                                                               *
  4892* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4893* All rights reserved.                                          *
  4894*                                                               *
  4895*****************************************************************
  4896 01  dfheiblk.
  4897     02  eibtime          pic s9(7) comp-3.
  4898     02  eibdate          pic s9(7) comp-3.
  4899     02  eibtrnid         pic x(4).
  4900     02  eibtaskn         pic s9(7) comp-3.
  4901     02  eibtrmid         pic x(4).
  4902     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  92
* EL050.cbl
  4903     02  eibcposn         pic s9(4) comp.
  4904     02  eibcalen         pic s9(4) comp.
  4905     02  eibaid           pic x(1).
  4906     02  eibfiller1       pic x(1).
  4907     02  eibfn            pic x(2).
  4908     02  eibfiller2       pic x(2).
  4909     02  eibrcode         pic x(6).
  4910     02  eibfiller3       pic x(2).
  4911     02  eibds            pic x(8).
  4912     02  eibreqid         pic x(8).
  4913     02  eibrsrce         pic x(8).
  4914     02  eibsync          pic x(1).
  4915     02  eibfree          pic x(1).
  4916     02  eibrecv          pic x(1).
  4917     02  eibsend          pic x(1).
  4918     02  eibatt           pic x(1).
  4919     02  eibeoc           pic x(1).
  4920     02  eibfmh           pic x(1).
  4921     02  eibcompl         pic x(1).
  4922     02  eibsig           pic x(1).
  4923     02  eibconf          pic x(1).
  4924     02  eiberr           pic x(1).
  4925     02  eibrldbk         pic x(1).
  4926     02  eiberrcd         pic x(4).
  4927     02  eibsynrb         pic x(1).
  4928     02  eibnodat         pic x(1).
  4929     02  eibfiller5       pic x(2).
  4930     02  eibresp          pic 9(09) comp.
  4931     02  eibresp2         pic 9(09) comp.
  4932     02  dfheigdj         pic s9(4) comp.
  4933     02  dfheigdk         pic s9(4) comp.
  4934
  4935 01  DFHCOMMAREA                   PIC X(1036).
  4936
  4937*01 PARMLIST .
  4938*    02  FILLER                    PIC S9(8)   COMP.
  4939*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4940*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4941*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4942*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4943*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4944*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4945*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4946
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  93
* EL050.cbl
  4948*    COPY ELCCNTL.
  4949******************************************************************
  4950*                                                                *
  4951*                                                                *
  4952*                            ELCCNTL.                            *
  4953*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4954*                            VMOD=2.059                          *
  4955*                                                                *
  4956*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4957*                                                                *
  4958*   FILE TYPE = VSAM,KSDS                                        *
  4959*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4960*                                                                *
  4961*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4962*       ALTERNATE INDEX = NONE                                   *
  4963*                                                                *
  4964*   LOG = YES                                                    *
  4965*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4966******************************************************************
  4967*                   C H A N G E   L O G
  4968*
  4969* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4970*-----------------------------------------------------------------
  4971*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4972* EFFECTIVE    NUMBER
  4973*-----------------------------------------------------------------
  4974* 082503                   PEMA  ADD BENEFIT GROUP
  4975* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4976* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4977* 092705    2005050300006  PEMA  ADD SPP LEASES
  4978* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4979* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4980* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4981* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4982* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4983* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4984* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4985* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4986* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4987* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4988******************************************************************
  4989*
  4990 01  CONTROL-FILE.
  4991     12  CF-RECORD-ID                       PIC XX.
  4992         88  VALID-CF-ID                        VALUE 'CF'.
  4993
  4994     12  CF-CONTROL-PRIMARY.
  4995         16  CF-COMPANY-ID                  PIC XXX.
  4996         16  CF-RECORD-TYPE                 PIC X.
  4997             88  CF-COMPANY-MASTER              VALUE '1'.
  4998             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4999             88  CF-STATE-MASTER                VALUE '3'.
  5000             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5001             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5002             88  CF-CARRIER-MASTER              VALUE '6'.
  5003             88  CF-MORTALITY-MASTER            VALUE '7'.
  5004             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5005             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  94
* EL050.cbl
  5006             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5007             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5008             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5009             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5010             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5011             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5012             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5013             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5014             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5015         16  CF-ACCESS-CD-GENL              PIC X(4).
  5016         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5017             20  CF-PROCESSOR               PIC X(4).
  5018         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5019             20  CF-STATE-CODE              PIC XX.
  5020             20  FILLER                     PIC XX.
  5021         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5022             20  FILLER                     PIC XX.
  5023             20  CF-HI-BEN-IN-REC           PIC XX.
  5024         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5025             20  FILLER                     PIC XXX.
  5026             20  CF-CARRIER-CNTL            PIC X.
  5027         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5028             20  FILLER                     PIC XX.
  5029             20  CF-HI-TYPE-IN-REC          PIC 99.
  5030         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5031             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5032                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5033             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5034             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5035         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5036             20  FILLER                     PIC X.
  5037             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5038         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5039             20  FILLER                     PIC XX.
  5040             20  CF-MORTGAGE-PLAN           PIC XX.
  5041         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5042
  5043     12  CF-LAST-MAINT-DT                   PIC XX.
  5044     12  CF-LAST-MAINT-BY                   PIC X(4).
  5045     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5046
  5047     12  CF-RECORD-BODY                     PIC X(728).
  5048
  5049
  5050****************************************************************
  5051*             COMPANY MASTER RECORD                            *
  5052****************************************************************
  5053
  5054     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5055         16  CF-COMPANY-ADDRESS.
  5056             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5057             20  CF-CL-IN-CARE-OF           PIC X(30).
  5058             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5059             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5060             20  CF-CL-CITY-STATE           PIC X(30).
  5061             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5062             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5063         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  95
* EL050.cbl
  5064         16  CF-COMPANY-PASSWORD            PIC X(8).
  5065         16  CF-SECURITY-OPTION             PIC X.
  5066             88  ALL-SECURITY                   VALUE '1'.
  5067             88  COMPANY-VERIFY                 VALUE '2'.
  5068             88  PROCESSOR-VERIFY               VALUE '3'.
  5069             88  NO-SECURITY                    VALUE '4'.
  5070             88  ALL-BUT-TERM                   VALUE '5'.
  5071         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5072             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5073         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5074             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5075         16  CF-INFORCE-LOCATION            PIC X.
  5076             88  CERTS-ARE-ONLINE               VALUE '1'.
  5077             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5078             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5079         16  CF-LOWER-CASE-LETTERS          PIC X.
  5080         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5081             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5082             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5083             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5084             88  CF-ACCNT-CNTL                  VALUE '3'.
  5085             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5086
  5087         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5088         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5089
  5090         16  CF-LGX-CREDIT-USER             PIC X.
  5091             88  CO-IS-NOT-USER                 VALUE 'N'.
  5092             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5093
  5094         16 CF-CREDIT-CALC-CODES.
  5095             20  CF-CR-REM-TERM-CALC PIC X.
  5096               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5097               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5098               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5099               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5100               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5101               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5102               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5103             20  CF-CR-R78-METHOD           PIC X.
  5104               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5105               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5106
  5107         16  CF-CLAIM-CONTROL-COUNTS.
  5108             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5109                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5110
  5111             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5112                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5113
  5114             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5115                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5116
  5117             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5118                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5119
  5120         16  CF-CURRENT-MONTH-END           PIC XX.
  5121
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  96
* EL050.cbl
  5122         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5123             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5124             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5125             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5126             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5127                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5128                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5129             20  CF-CO-PREM-REJECT-SW       PIC X.
  5130                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5131                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5132             20  CF-CO-REF-REJECT-SW        PIC X.
  5133                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5134                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5135
  5136         16  CF-CO-REPORTING-DT             PIC XX.
  5137         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5138         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5139           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5140           88  CF-CO-MONTH-END                  VALUE '1'.
  5141
  5142         16  CF-LGX-CLAIM-USER              PIC X.
  5143             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5144             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5145
  5146         16  CF-CREDIT-EDIT-CONTROLS.
  5147             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5148             20  CF-MIN-AGE                 PIC 99.
  5149             20  CF-DEFAULT-AGE             PIC 99.
  5150             20  CF-MIN-TERM                PIC S999      COMP-3.
  5151             20  CF-MAX-TERM                PIC S999      COMP-3.
  5152             20  CF-DEFAULT-SEX             PIC X.
  5153             20  CF-JOINT-AGE-INPUT         PIC X.
  5154                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5155             20  CF-BIRTH-DATE-INPUT        PIC X.
  5156                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5157             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5158                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5159                 88  CF-ZERO-CARRIER            VALUE '1'.
  5160                 88  CF-ZERO-GROUPING           VALUE '2'.
  5161                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5162             20  CF-EDIT-SW                 PIC X.
  5163                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5164             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5165             20  CF-CR-PR-METHOD            PIC X.
  5166               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5167               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5168             20  FILLER                     PIC X.
  5169
  5170         16  CF-CREDIT-MISC-CONTROLS.
  5171             20  CF-REIN-TABLE-SW           PIC X.
  5172                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5173             20  CF-COMP-TABLE-SW           PIC X.
  5174                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5175             20  CF-EXPERIENCE-RETENTION-AGE
  5176                                            PIC S9        COMP-3.
  5177             20  CF-CONVERSION-DT           PIC XX.
  5178             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5179             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  97
* EL050.cbl
  5180                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5181                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5182
  5183             20  CF-CR-CHECK-NO-CONTROL.
  5184                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5185                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5186                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5187                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5188                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5189                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5190
  5191                 24  CF-CR-CHECK-COUNT       REDEFINES
  5192                     CF-CR-CHECK-COUNTER      PIC X(4).
  5193
  5194                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5195                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5196
  5197                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5198                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5199                 24  CF-MAIL-PROCESSING       PIC X.
  5200                     88  MAIL-PROCESSING          VALUE 'Y'.
  5201
  5202         16  CF-MISC-SYSTEM-CONTROL.
  5203             20  CF-SYSTEM-C                 PIC X.
  5204                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5205             20  CF-SYSTEM-D                 PIC X.
  5206                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5207             20  CF-SOC-SEC-NO-SW            PIC X.
  5208                 88  SOC-SEC-NO-USED             VALUE '1'.
  5209             20  CF-MEMBER-NO-SW             PIC X.
  5210                 88  MEMBER-NO-USED              VALUE '1'.
  5211             20  CF-TAX-ID-NUMBER            PIC X(11).
  5212             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5213             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5214                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5215                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5216                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5217                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5218             20  CF-SYSTEM-E                 PIC X.
  5219                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5220
  5221         16  CF-LGX-LIFE-USER               PIC X.
  5222             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5223             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5224
  5225         16  CF-CR-MONTH-END-DT             PIC XX.
  5226
  5227         16  CF-FILE-MAINT-DATES.
  5228             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5229                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5230             20  CF-LAST-BATCH       REDEFINES
  5231                 CF-LAST-BATCH-NO               PIC X(4).
  5232             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5233             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5234             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5235             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5236             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5237             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  98
* EL050.cbl
  5238             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5239             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5240             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5241             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5242
  5243         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5244         16  FILLER                         PIC X.
  5245
  5246         16  CF-ALT-MORT-CODE               PIC X(4).
  5247         16  CF-MEMBER-CAPTION              PIC X(10).
  5248
  5249         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5250             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5251             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5252             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5253             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5254             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5255
  5256         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5257
  5258         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5259         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5260         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5261         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5262
  5263         16  CF-AH-OVERRIDE-L1              PIC X.
  5264         16  CF-AH-OVERRIDE-L2              PIC XX.
  5265         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5266         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5267
  5268         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5269         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5270
  5271         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5272         16  CF-AR-LAST-EL860-DT            PIC XX.
  5273         16  CF-MP-MONTH-END-DT             PIC XX.
  5274
  5275         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5276         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5277             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5278
  5279         16  CF-AR-MONTH-END-DT             PIC XX.
  5280
  5281         16  CF-CRDTCRD-USER                PIC X.
  5282             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5283             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5284
  5285         16  CF-CC-MONTH-END-DT             PIC XX.
  5286
  5287         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5288
  5289         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5290             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5291             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5292             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5293         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5294         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5295         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page  99
* EL050.cbl
  5296         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5297             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5298             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5299         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5300         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5301         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5302             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5303         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5304
  5305         16  CF-CL-ZIP-CODE.
  5306             20  CF-CL-ZIP-PRIME.
  5307                 24  CF-CL-ZIP-1ST          PIC X.
  5308                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5309                 24  FILLER                 PIC X(4).
  5310             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5311         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5312             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5313             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5314             20  FILLER                     PIC XXX.
  5315
  5316         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5317         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5318         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5319         16  CF-CO-OPTION-START-DATE        PIC XX.
  5320         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5321           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5322                                                      '3' '4'.
  5323           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5324           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5325           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5326           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5327           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5328           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5329
  5330         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5331
  5332         16  CF-PAYMENT-APPROVAL-LEVELS.
  5333             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5334             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5335             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5336             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5337             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5338             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5339
  5340         16  CF-END-USER-REPORTING-USER     PIC X.
  5341             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5342             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5343
  5344         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5345             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5346             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5347
  5348         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5349
  5350         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5351         16  FILLER                         PIC X.
  5352
  5353         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 100
* EL050.cbl
  5354             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5355             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5356             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5357
  5358         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5359
  5360         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5361             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5362             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5363
  5364         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5365             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5366             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5367
  5368         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5369
  5370         16  CF-CO-ACH-ID-CODE              PIC  X.
  5371             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5372             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5373             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5374         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5375         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5376         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5377         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5378         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5379         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5380         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5381         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5382         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5383                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5384         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5385                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5386
  5387         16  CF-CO-OVER-SHORT.
  5388             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5389             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5390
  5391*         16  FILLER                         PIC X(102).
  5392         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5393             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5394             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5395
  5396         16  CF-AH-APPROVAL-DAYS.
  5397             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5398             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5399             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5400             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5401
  5402         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5403
  5404         16  CF-APPROV-LEV-5.
  5405             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5406             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5407             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5408
  5409         16  FILLER                         PIC X(68).
  5410****************************************************************
  5411*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 101
* EL050.cbl
  5412****************************************************************
  5413
  5414     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5415         16  CF-PROCESSOR-NAME              PIC X(30).
  5416         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5417         16  CF-PROCESSOR-TITLE             PIC X(26).
  5418         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5419                 88  MESSAGE-YES                VALUE 'Y'.
  5420                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5421
  5422*****************************************************
  5423****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5424****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5425****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5426****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5427*****************************************************
  5428
  5429         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5430             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5431             20  CF-APPLICATION-FORCE       PIC X.
  5432             20  CF-INDIVIDUAL-APP.
  5433                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5434                     28  CF-BROWSE-APP      PIC X.
  5435                     28  CF-UPDATE-APP      PIC X.
  5436
  5437         16  CF-CURRENT-TERM-ON             PIC X(4).
  5438         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5439             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5440             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5441             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5442             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5443             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5444             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5445             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5446         16  CF-PROCESSOR-CARRIER           PIC X.
  5447             88  NO-CARRIER-SECURITY            VALUE ' '.
  5448         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5449             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5450         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5451             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5452         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5453             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5454
  5455         16  CF-PROC-SYS-ACCESS-SW.
  5456             20  CF-PROC-CREDIT-CLAIMS-SW.
  5457                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5458                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5459                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5460                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5461             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5462                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5463                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5464             20  CF-PROC-LIFE-GNRLDGR-SW.
  5465                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5466                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5467                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5468                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5469             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 102
* EL050.cbl
  5470                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5471                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5472         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5473             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5474             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5475         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5476
  5477         16  CF-APPROVAL-LEVEL                  PIC X.
  5478             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5479             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5480             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5481             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5482             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5483
  5484         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5485
  5486         16  CF-LANGUAGE-TYPE                   PIC X.
  5487             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5488             88  CF-LANG-IS-FR                      VALUE 'F'.
  5489
  5490         16  CF-CSR-IND                         PIC X.
  5491         16  FILLER                             PIC X(239).
  5492
  5493****************************************************************
  5494*             PROCESSOR/REMINDERS RECORD                       *
  5495****************************************************************
  5496
  5497     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5498         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5499             20  CF-START-REMIND-DT         PIC XX.
  5500             20  CF-END-REMIND-DT           PIC XX.
  5501             20  CF-REMINDER-TEXT           PIC X(50).
  5502         16  FILLER                         PIC X(296).
  5503
  5504
  5505****************************************************************
  5506*             STATE MASTER RECORD                              *
  5507****************************************************************
  5508
  5509     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5510         16  CF-STATE-ABBREVIATION          PIC XX.
  5511         16  CF-STATE-NAME                  PIC X(25).
  5512         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5513         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5514             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5515             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5516             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5517             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5518                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5519                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5520             20  CF-ST-PREM-REJECT-SW       PIC X.
  5521                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5522                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5523             20  CF-ST-REF-REJECT-SW        PIC X.
  5524                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5525                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5526         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5527         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 103
* EL050.cbl
  5528         16  CF-ST-REFUND-RULES.
  5529             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5530             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5531             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5532         16  CF-ST-FST-PMT-EXTENSION.
  5533             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5534             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5535                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5536                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5537                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5538                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5539         16  CF-ST-STATE-CALL.
  5540             20  CF-ST-CALL-UNEARNED        PIC X.
  5541             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5542             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5543         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5544             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5545             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5546         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5547         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5548         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5549         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5550         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5551         16  FILLER                         PIC X.
  5552         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5553             20  CF-ST-BENEFIT-CD           PIC XX.
  5554             20  CF-ST-BENEFIT-KIND         PIC X.
  5555                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5556                 88  CF-ST-AH-KIND              VALUE 'A'.
  5557             20  CF-ST-REM-TERM-CALC        PIC X.
  5558                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5559                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5560                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5561                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5562                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5563                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5564                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5565                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5566
  5567             20  CF-ST-REFUND-CALC          PIC X.
  5568                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5569                 88  ST-REFD-BY-R78             VALUE '1'.
  5570                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5571                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5572                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5573                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5574                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5575                 88  ST-REFD-UTAH               VALUE '7'.
  5576                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5577                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5578                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5579
  5580             20  CF-ST-EARNING-CALC         PIC X.
  5581                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5582                 88  ST-EARN-BY-R78             VALUE '1'.
  5583                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5584                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5585                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 104
* EL050.cbl
  5586                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5587                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5588                 88  ST-EARN-MEAN               VALUE '8'.
  5589                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5590
  5591             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5592                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5593                 88  ST-OVRD-BY-R78             VALUE '1'.
  5594                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5595                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5596                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5597                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5598                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5599                 88  ST-OVRD-MEAN               VALUE '8'.
  5600                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5601             20  FILLER                     PIC X.
  5602
  5603         16  CF-ST-COMMISSION-CAPS.
  5604             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5605             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5606             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5607             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5608         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5609                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5610
  5611         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5612
  5613         16  CF-ST-STATUTORY-INTEREST.
  5614             20  CF-ST-STAT-DATE-FROM       PIC X.
  5615                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5616                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5617             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5618             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5619             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5620             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5621             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5622
  5623         16  CF-ST-OVER-SHORT.
  5624             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5625             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5626
  5627         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5628
  5629         16  CF-ST-RT-CALC                  PIC X.
  5630
  5631         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5632         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5633         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5634         16  CF-ST-RF-LR-CALC               PIC X.
  5635         16  CF-ST-RF-LL-CALC               PIC X.
  5636         16  CF-ST-RF-LN-CALC               PIC X.
  5637         16  CF-ST-RF-AH-CALC               PIC X.
  5638         16  CF-ST-RF-CP-CALC               PIC X.
  5639*        16  FILLER                         PIC X(206).
  5640*CIDMOD         16  FILLER                         PIC X(192).
  5641         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5642             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5643         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 105
* EL050.cbl
  5644         16  CF-ST-VFY-2ND-BENE             PIC X.
  5645         16  CF-ST-CAUSAL-STATE             PIC X.
  5646         16  FILLER                         PIC X(185).
  5647
  5648****************************************************************
  5649*             BENEFIT MASTER RECORD                            *
  5650****************************************************************
  5651
  5652     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5653         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5654             20  CF-BENEFIT-CODE            PIC XX.
  5655             20  CF-BENEFIT-NUMERIC  REDEFINES
  5656                 CF-BENEFIT-CODE            PIC XX.
  5657             20  CF-BENEFIT-ALPHA           PIC XXX.
  5658             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5659             20  CF-BENEFIT-COMMENT         PIC X(10).
  5660
  5661             20  CF-LF-COVERAGE-TYPE        PIC X.
  5662                 88  CF-REDUCING                VALUE 'R'.
  5663                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5664
  5665             20  CF-SPECIAL-CALC-CD         PIC X.
  5666                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5667                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5668                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5669                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5670                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5671                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5672                 88  CF-FARM-PLAN               VALUE 'F'.
  5673                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5674                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5675                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5676                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5677                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5678                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5679                 88  CF-PRUDENTIAL              VALUE 'P'.
  5680                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5681                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5682                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5683                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5684                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5685                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5686
  5687             20  CF-JOINT-INDICATOR         PIC X.
  5688                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5689
  5690*            20  FILLER                     PIC X(12).
  5691             20  cf-maximum-benefits        pic s999 comp-3.
  5692             20  FILLER                     PIC X(09).
  5693             20  CF-BENEFIT-CATEGORY        PIC X.
  5694             20  CF-LOAN-TYPE               PIC X(8).
  5695
  5696             20  CF-CO-REM-TERM-CALC        PIC X.
  5697                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5698                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5699                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5700                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5701                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 106
* EL050.cbl
  5702
  5703             20  CF-CO-EARNINGS-CALC        PIC X.
  5704                 88  CO-EARN-BY-R78             VALUE '1'.
  5705                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5706                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5707                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5708                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5709                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5710                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5711                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5712
  5713             20  CF-CO-REFUND-CALC          PIC X.
  5714                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5715                 88  CO-REFD-BY-R78             VALUE '1'.
  5716                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5717                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5718                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5719                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5720                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5721                 88  CO-REFD-MEAN               VALUE '8'.
  5722                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5723                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5724                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5725
  5726             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5727                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5728                 88  CO-OVRD-BY-R78             VALUE '1'.
  5729                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5730                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5731                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5732                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5733                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5734                 88  CO-OVRD-MEAN               VALUE '8'.
  5735                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5736
  5737             20  CF-CO-BEN-I-G-CD           PIC X.
  5738                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5739                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5740                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5741
  5742         16  FILLER                         PIC X(304).
  5743
  5744
  5745****************************************************************
  5746*             CARRIER MASTER RECORD                            *
  5747****************************************************************
  5748
  5749     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5750         16  CF-ADDRESS-DATA.
  5751             20  CF-MAIL-TO-NAME            PIC X(30).
  5752             20  CF-IN-CARE-OF              PIC X(30).
  5753             20  CF-ADDRESS-LINE-1          PIC X(30).
  5754             20  CF-ADDRESS-LINE-2          PIC X(30).
  5755             20  CF-CITY-STATE              PIC X(30).
  5756             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5757             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5758
  5759         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 107
* EL050.cbl
  5760             20  CF-CLAIM-NO-METHOD         PIC X.
  5761                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5762                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5763                 88  CLAIM-NO-SEQ               VALUE '3'.
  5764                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5765             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5766                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5767                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5768                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5769
  5770         16  CF-CHECK-NO-CONTROL.
  5771             20  CF-CHECK-NO-METHOD         PIC X.
  5772                 88  CHECK-NO-MANUAL            VALUE '1'.
  5773                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5774                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5775                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5776             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5777                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5778
  5779         16  CF-DOMICILE-STATE              PIC XX.
  5780
  5781         16  CF-EXPENSE-CONTROLS.
  5782             20  CF-EXPENSE-METHOD          PIC X.
  5783                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5784                 88  DOLLARS-PER-PMT            VALUE '2'.
  5785                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5786                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5787             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5788             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5789
  5790         16  CF-CORRESPONDENCE-CONTROL.
  5791             20  CF-LETTER-RESEND-OPT       PIC X.
  5792                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5793                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5794             20  FILLER                     PIC X(4).
  5795
  5796         16  CF-RESERVE-CONTROLS.
  5797             20  CF-MANUAL-SW               PIC X.
  5798                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5799             20  CF-FUTURE-SW               PIC X.
  5800                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5801             20  CF-PTC-SW                  PIC X.
  5802                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5803             20  CF-IBNR-SW                 PIC X.
  5804                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5805             20  CF-PTC-LF-SW               PIC X.
  5806                 88  CF-LF-PTC-USED             VALUE '1'.
  5807             20  CF-CDT-ACCESS-METHOD       PIC X.
  5808                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5809                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5810                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5811             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5812
  5813         16  CF-CLAIM-CALC-METHOD           PIC X.
  5814             88  360-PLUS-MONTHS                VALUE '1'.
  5815             88  365-PLUS-MONTHS                VALUE '2'.
  5816             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5817             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 108
* EL050.cbl
  5818             88  365-DAILY                      VALUE '5'.
  5819
  5820         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5821         16  FILLER                         PIC X(11).
  5822
  5823         16  CF-LIMIT-AMOUNTS.
  5824             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5825             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5826             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5827             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5828             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5829             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5830             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5831             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5832             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5833             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5834
  5835         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5836         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5837         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5838
  5839         16  CF-ZIP-CODE.
  5840             20  CF-ZIP-PRIME.
  5841                 24  CF-ZIP-1ST             PIC X.
  5842                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5843                 24  FILLER                 PIC X(4).
  5844             20  CF-ZIP-PLUS4               PIC X(4).
  5845         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5846             20  CF-CAN-POSTAL-1            PIC XXX.
  5847             20  CF-CAN-POSTAL-2            PIC XXX.
  5848             20  FILLER                     PIC XXX.
  5849
  5850         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5851         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5852         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5853
  5854         16  CF-RATING-SWITCH               PIC X.
  5855             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5856             88  CF-NO-RATING                   VALUE 'N'.
  5857
  5858         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5859
  5860         16  CF-CARRIER-OVER-SHORT.
  5861             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5862             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5863
  5864         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5865         16  CF-SECPAY-SWITCH               PIC X.
  5866             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5867             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5868         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5869         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5870         16  FILLER                         PIC X(444).
  5871*        16  FILLER                         PIC X(452).
  5872
  5873
  5874****************************************************************
  5875*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 109
* EL050.cbl
  5876****************************************************************
  5877
  5878     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5879         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5880                                INDEXED BY CF-MORT-NDX.
  5881             20  CF-MORT-TABLE              PIC X(5).
  5882             20  CF-MORT-TABLE-TYPE         PIC X.
  5883                 88  CF-MORT-JOINT              VALUE 'J'.
  5884                 88  CF-MORT-SINGLE             VALUE 'S'.
  5885                 88  CF-MORT-COMBINED           VALUE 'C'.
  5886                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5887                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5888             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5889             20  CF-MORT-AGE-METHOD         PIC XX.
  5890                 88  CF-AGE-LAST                VALUE 'AL'.
  5891                 88  CF-AGE-NEAR                VALUE 'AN'.
  5892             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5893             20  CF-MORT-ADJUSTMENT-DIRECTION
  5894                                            PIC X.
  5895                 88  CF-MINUS                   VALUE '-'.
  5896                 88  CF-PLUS                    VALUE '+'.
  5897             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5898             20  CF-MORT-JOINT-CODE         PIC X.
  5899                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5900             20  CF-MORT-PC-Q               PIC X.
  5901                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5902             20  CF-MORT-TABLE-CODE         PIC X(4).
  5903             20  CF-MORT-COMMENTS           PIC X(15).
  5904             20  FILLER                     PIC X(14).
  5905
  5906         16  FILLER                         PIC X(251).
  5907
  5908
  5909****************************************************************
  5910*             BUSSINESS TYPE MASTER RECORD                     *
  5911****************************************************************
  5912
  5913     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5914* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5915* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5916* AND RECORD 05 IS TYPES 81-99
  5917         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5918             20  CF-BUSINESS-TITLE          PIC  X(19).
  5919             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5920                                            PIC S9V9(4) COMP-3.
  5921             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5922             20  FILLER                     PIC  X.
  5923         16  FILLER                         PIC  X(248).
  5924
  5925
  5926****************************************************************
  5927*             TERMINAL MASTER RECORD                           *
  5928****************************************************************
  5929
  5930     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5931
  5932         16  CF-COMPANY-TERMINALS.
  5933             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 110
* EL050.cbl
  5934                                  PIC X(4).
  5935         16  FILLER               PIC X(248).
  5936
  5937
  5938****************************************************************
  5939*             LIFE EDIT MASTER RECORD                          *
  5940****************************************************************
  5941
  5942     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5943         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5944             20  CF-LIFE-CODE-IN            PIC XX.
  5945             20  CF-LIFE-CODE-OUT           PIC XX.
  5946         16  FILLER                         PIC X(248).
  5947
  5948
  5949****************************************************************
  5950*             AH EDIT MASTER RECORD                            *
  5951****************************************************************
  5952
  5953     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5954         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5955             20  CF-AH-CODE-IN              PIC XXX.
  5956             20  CF-AH-CODE-OUT             PIC XX.
  5957         16  FILLER                         PIC X(248).
  5958
  5959
  5960****************************************************************
  5961*             CREDIBILITY TABLES                               *
  5962****************************************************************
  5963
  5964     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5965         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5966                             INDEXED BY CF-CRDB-NDX.
  5967             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5968             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5969             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5970         16  FILLER                         PIC  X(332).
  5971
  5972
  5973****************************************************************
  5974*             REPORT CUSTOMIZATION RECORD                      *
  5975****************************************************************
  5976
  5977     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5978         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5979             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5980             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5981             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5982**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5983****       A T-TRANSFER.                                   ****
  5984             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5985
  5986         16  FILLER                         PIC XX.
  5987
  5988         16  CF-CARRIER-CNTL-OPT.
  5989             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5990                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5991                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 111
* EL050.cbl
  5992             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5993                                            PIC X.
  5994         16  CF-GROUP-CNTL-OPT.
  5995             20  CF-GROUP-OPT-SEQ           PIC 9.
  5996                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5997                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5998             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5999                                            PIC X(6).
  6000         16  CF-STATE-CNTL-OPT.
  6001             20  CF-STATE-OPT-SEQ           PIC 9.
  6002                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6003                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6004             20  CF-STATE-SELECT OCCURS 3 TIMES
  6005                                            PIC XX.
  6006         16  CF-ACCOUNT-CNTL-OPT.
  6007             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6008                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6009                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6010             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6011                                            PIC X(10).
  6012         16  CF-BUS-TYP-CNTL-OPT.
  6013             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6014                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6015                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6016             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6017                                            PIC XX.
  6018         16  CF-LF-TYP-CNTL-OPT.
  6019             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6020                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6021                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6022             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6023                                            PIC XX.
  6024         16  CF-AH-TYP-CNTL-OPT.
  6025             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6026                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6027                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6028             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6029                                            PIC XX.
  6030         16  CF-REPTCD1-CNTL-OPT.
  6031             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6032                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6033                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6034             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6035                                            PIC X(10).
  6036         16  CF-REPTCD2-CNTL-OPT.
  6037             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6038                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6039                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6040             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6041                                            PIC X(10).
  6042         16  CF-USER1-CNTL-OPT.
  6043             20  CF-USER1-OPT-SEQ           PIC 9.
  6044                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6045                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6046             20  CF-USER1-SELECT OCCURS 3 TIMES
  6047                                            PIC X(10).
  6048         16  CF-USER2-CNTL-OPT.
  6049             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 112
* EL050.cbl
  6050                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6051                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6052             20  CF-USER2-SELECT OCCURS 3 TIMES
  6053                                            PIC X(10).
  6054         16  CF-USER3-CNTL-OPT.
  6055             20  CF-USER3-OPT-SEQ           PIC 9.
  6056                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6057                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6058             20  CF-USER3-SELECT OCCURS 3 TIMES
  6059                                            PIC X(10).
  6060         16  CF-USER4-CNTL-OPT.
  6061             20  CF-USER4-OPT-SEQ           PIC 9.
  6062                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6063                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6064             20  CF-USER4-SELECT OCCURS 3 TIMES
  6065                                            PIC X(10).
  6066         16  CF-USER5-CNTL-OPT.
  6067             20  CF-USER5-OPT-SEQ           PIC 9.
  6068                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6069                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6070             20  CF-USER5-SELECT OCCURS 3 TIMES
  6071                                            PIC X(10).
  6072         16  CF-REINS-CNTL-OPT.
  6073             20  CF-REINS-OPT-SEQ           PIC 9.
  6074                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6075                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6076             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6077                 24  CF-REINS-PRIME         PIC XXX.
  6078                 24  CF-REINS-SUB           PIC XXX.
  6079
  6080         16  CF-AGENT-CNTL-OPT.
  6081             20  CF-AGENT-OPT-SEQ           PIC 9.
  6082                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6083                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6084             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6085                                            PIC X(10).
  6086
  6087         16  FILLER                         PIC X(43).
  6088
  6089         16  CF-LOSS-RATIO-SELECT.
  6090             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6091             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6092         16  CF-ENTRY-DATE-SELECT.
  6093             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6094             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6095         16  CF-EFFECTIVE-DATE-SELECT.
  6096             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6097             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6098
  6099         16  CF-EXCEPTION-LIST-IND          PIC X.
  6100             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6101
  6102         16  FILLER                         PIC X(318).
  6103
  6104****************************************************************
  6105*                  EXCEPTION REPORTING RECORD                  *
  6106****************************************************************
  6107
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 113
* EL050.cbl
  6108     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6109         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6110             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6111
  6112         16  CF-COMBINED-LIFE-AH-OPT.
  6113             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6114             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6115             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6116             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6117
  6118         16  CF-LIFE-OPT.
  6119             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6120             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6121             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6122             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6123             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6124             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6125             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6126             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6127             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6128             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6129
  6130         16  CF-AH-OPT.
  6131             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6132             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6133             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6134             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6135             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6136             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6137             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6138             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6139             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6140             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6141
  6142         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6143             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6144             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6145             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6146
  6147         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6148
  6149         16  FILLER                         PIC X(673).
  6150
  6151
  6152****************************************************************
  6153*             MORTGAGE SYSTEM PLAN RECORD                      *
  6154****************************************************************
  6155
  6156     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6157         16  CF-PLAN-TYPE                   PIC X.
  6158             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6159             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6160             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6161         16  CF-PLAN-ABBREV                 PIC XXX.
  6162         16  CF-PLAN-DESCRIPT               PIC X(10).
  6163         16  CF-PLAN-NOTES                  PIC X(20).
  6164         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6165         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 114
* EL050.cbl
  6166             20  CF-PLAN-TERM-DATA.
  6167                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6168                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6169             20  CF-PLAN-AGE-DATA.
  6170                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6171                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6172                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6173             20  CF-PLAN-BENEFIT-DATA.
  6174                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6175                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6176                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6177                                            PIC S9(7)V99  COMP-3.
  6178         16  CF-PLAN-POLICY-FORMS.
  6179             20  CF-POLICY-FORM             PIC X(12).
  6180             20  CF-MASTER-APPLICATION      PIC X(12).
  6181             20  CF-MASTER-POLICY           PIC X(12).
  6182         16  CF-PLAN-RATING.
  6183             20  CF-RATE-CODE               PIC X(5).
  6184             20  CF-SEX-RATING              PIC X.
  6185                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6186                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6187             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6188             20  CF-SUB-STD-TYPE            PIC X.
  6189                 88  CF-PCT-OF-PREM            VALUE '1'.
  6190                 88  CF-PCT-OF-BENE            VALUE '2'.
  6191         16  CF-PLAN-PREM-TOLERANCES.
  6192             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6193             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6194         16  CF-PLAN-PYMT-TOLERANCES.
  6195             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6196             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6197         16  CF-PLAN-MISC-DATA.
  6198             20  FILLER                     PIC X.
  6199             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6200             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6201         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6202         16  CF-PLAN-IND-GRP                PIC X.
  6203             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6204                                                     '1'.
  6205             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6206                                                     '2'.
  6207         16  CF-MIB-SEARCH-SW               PIC X.
  6208             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6209             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6210             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6211             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6212         16  CF-ALPHA-SEARCH-SW             PIC X.
  6213             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6214             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6215             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6216             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6217             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6218             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6219             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6220             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6221             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6222             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6223                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 115
* EL050.cbl
  6224                                                     'X' 'Y' 'Z'.
  6225         16  CF-EFF-DT-RULE-SW              PIC X.
  6226             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6227             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6228             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6229             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6230             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6231         16  FILLER                         PIC X(4).
  6232         16  CF-HEALTH-QUESTIONS            PIC X.
  6233             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6234         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6235         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6236         16  CF-PLAN-SNGL-JNT               PIC X.
  6237             88  CF-COMBINED-PLAN              VALUE 'C'.
  6238             88  CF-JNT-PLAN                   VALUE 'J'.
  6239             88  CF-SNGL-PLAN                  VALUE 'S'.
  6240         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6241         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6242         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6243         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6244         16  CF-RERATE-CNTL                 PIC  X.
  6245             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6246             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6247             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6248             88  CF-AUTO-RECALC                 VALUE '4'.
  6249         16  CF-BENEFIT-TYPE                PIC  X.
  6250             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6251             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6252         16  CF-POLICY-FEE                  PIC S999V99
  6253                                                    COMP-3.
  6254         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6255         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6256         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6257         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6258         16  FILLER                         PIC  X(32).
  6259         16  CF-TERMINATION-FORM            PIC  X(04).
  6260         16  FILLER                         PIC  X(08).
  6261         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6262                                                       COMP-3.
  6263         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6264         16  CF-ISSUE-LETTER                PIC  X(4).
  6265         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6266         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6267             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6268             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6269         16  CF-MP-REFUND-CALC              PIC X.
  6270             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6271             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6272             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6273             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6274             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6275             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6276             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6277             88  CF-MP-REFD-MEAN                VALUE '8'.
  6278         16  CF-ALT-RATE-CODE               PIC  X(5).
  6279
  6280
  6281         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 116
* EL050.cbl
  6282****************************************************************
  6283*             MORTGAGE COMPANY MASTER RECORD                   *
  6284****************************************************************
  6285
  6286     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6287         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6288         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6289             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6290             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6291             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6292             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6293             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6294
  6295         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6296         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6297         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6298         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6299         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6300
  6301         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6302             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6303         16  CF-MP-RECON-USE-IND            PIC X(1).
  6304             88  CF-MP-USE-RECON             VALUE 'Y'.
  6305         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6306             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6307         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6308             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6309             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6310         16  FILLER                         PIC X(1).
  6311         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6312             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6313         16  CF-MORTG-MIB-VERSION           PIC X.
  6314             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6315             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6316             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6317         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6318             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6319                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6320             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6321                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6322             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6323                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6324             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6325                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6326             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6327                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6328             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6329                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6330         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6331         16  FILLER                         PIC X(7).
  6332         16  CF-MORTG-DESTINATION-SYMBOL.
  6333             20  CF-MORTG-MIB-COMM          PIC X(5).
  6334             20  CF-MORTG-MIB-TERM          PIC X(5).
  6335         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6336             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6337         16  FILLER                         PIC X(03).
  6338         16  CF-MP-CHECK-NO-CONTROL.
  6339             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 117
* EL050.cbl
  6340                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6341                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6342                                                ' ' LOW-VALUES.
  6343                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6344                                               VALUE '3'.
  6345         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6346         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6347         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6348             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6349                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6350             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6351                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6352             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6353                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6354             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6355                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6356             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6357                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6358             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6359                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6360         16  CF-MORTG-BILLING-AREA.
  6361             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6362                                            PIC X.
  6363         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6364         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6365         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6366         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6367             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6368             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6369         16  FILLER                         PIC X.
  6370         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6371             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6372             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6373         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6374         16  FILLER                         PIC X(8).
  6375         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6376         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6377         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6378         16  CF-ACH-COMPANY-ID.
  6379             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6380                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6381                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6382                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6383             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6384         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6385             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6386         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6387             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6388             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6389         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6390         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6391         16  FILLER                         PIC X(536).
  6392
  6393****************************************************************
  6394*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6395****************************************************************
  6396
  6397     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 118
* EL050.cbl
  6398         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6399             20  CF-FEMALE-HEIGHT.
  6400                 24  CF-FEMALE-FT           PIC 99.
  6401                 24  CF-FEMALE-IN           PIC 99.
  6402             20  CF-FEMALE-MIN-WT           PIC 999.
  6403             20  CF-FEMALE-MAX-WT           PIC 999.
  6404         16  FILLER                         PIC X(428).
  6405
  6406     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6407         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6408             20  CF-MALE-HEIGHT.
  6409                 24  CF-MALE-FT             PIC 99.
  6410                 24  CF-MALE-IN             PIC 99.
  6411             20  CF-MALE-MIN-WT             PIC 999.
  6412             20  CF-MALE-MAX-WT             PIC 999.
  6413         16  FILLER                         PIC X(428).
  6414******************************************************************
  6415*             AUTOMATIC ACTIVITY RECORD                          *
  6416******************************************************************
  6417     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6418         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6419             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6420             20  CF-SYS-LETTER-ID           PIC X(04).
  6421             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6422             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6423             20  CF-SYS-RESET-SW            PIC X(01).
  6424             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6425             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6426
  6427         16  FILLER                         PIC X(50).
  6428
  6429         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6430             20  CF-USER-ACTIVE-SW          PIC X(01).
  6431             20  CF-USER-LETTER-ID          PIC X(04).
  6432             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6433             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6434             20  CF-USER-RESET-SW           PIC X(01).
  6435             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6436             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6437             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6438
  6439         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 119
* EL050.cbl
  6441*    COPY ERCACCT.
  6442******************************************************************
  6443*                                                                *
  6444*                                                                *
  6445*                            ERCACCT                             *
  6446*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6447*                            VMOD=2.031                          *
  6448*                                                                *
  6449*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6450*                                                                *
  6451*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6452*   VSAM ACCOUNT MASTER FILES.                                   *
  6453*                                                                *
  6454*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6455*                                                                *
  6456*   FILE TYPE = VSAM,KSDS                                        *
  6457*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6458*                                                                *
  6459*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6460*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6461*                                                                *
  6462*   LOG = NO                                                     *
  6463*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6464*                                                                *
  6465*                                                                *
  6466******************************************************************
  6467*                   C H A N G E   L O G
  6468*
  6469* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6470*-----------------------------------------------------------------
  6471*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6472* EFFECTIVE    NUMBER
  6473*-----------------------------------------------------------------
  6474* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6475* 092705    2005050300006  PEMA  ADD SPP LEASES
  6476* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6477* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6478* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6479* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6480* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6481******************************************************************
  6482
  6483 01  ACCOUNT-MASTER.
  6484     12  AM-RECORD-ID                      PIC XX.
  6485         88  VALID-AM-ID                      VALUE 'AM'.
  6486
  6487     12  AM-CONTROL-PRIMARY.
  6488         16  AM-COMPANY-CD                 PIC X.
  6489         16  AM-MSTR-CNTRL.
  6490             20  AM-CONTROL-A.
  6491                 24  AM-CARRIER            PIC X.
  6492                 24  AM-GROUPING.
  6493                     28 AM-GROUPING-PREFIX PIC XXX.
  6494                     28 AM-GROUPING-PRIME  PIC XXX.
  6495                 24  AM-STATE              PIC XX.
  6496                 24  AM-ACCOUNT.
  6497                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6498                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 120
* EL050.cbl
  6499             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6500                                           PIC X(19).
  6501             20  AM-CNTRL-B.
  6502                 24  AM-EXPIRATION-DT      PIC XX.
  6503                 24  FILLER                PIC X(4).
  6504             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6505                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6506
  6507     12  AM-CONTROL-BY-VAR-GRP.
  6508         16  AM-COMPANY-CD-A1              PIC X.
  6509         16  AM-VG-CARRIER                 PIC X.
  6510         16  AM-VG-GROUPING                PIC X(6).
  6511         16  AM-VG-STATE                   PIC XX.
  6512         16  AM-VG-ACCOUNT                 PIC X(10).
  6513         16  AM-VG-DATE.
  6514             20  AM-VG-EXPIRATION-DT       PIC XX.
  6515             20  FILLER                    PIC X(4).
  6516         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6517                                           PIC 9(11)      COMP-3.
  6518     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6519         16  FILLER                        PIC X(10).
  6520         16  AM-VG-KEY3.
  6521             20  AM-VG3-ACCOUNT            PIC X(10).
  6522             20  AM-VG3-EXP-DT             PIC XX.
  6523         16  FILLER                        PIC X(4).
  6524     12  AM-MAINT-INFORMATION.
  6525         16  AM-LAST-MAINT-DT              PIC XX.
  6526         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6527         16  AM-LAST-MAINT-USER            PIC X(4).
  6528         16  FILLER                        PIC XX.
  6529
  6530     12  AM-EFFECTIVE-DT                   PIC XX.
  6531     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6532
  6533     12  AM-PREV-DATES  COMP-3.
  6534         16  AM-PREV-EXP-DT                PIC 9(11).
  6535         16  AM-PREV-EFF-DT                PIC 9(11).
  6536
  6537     12  AM-REPORT-CODE-1                  PIC X(10).
  6538     12  AM-REPORT-CODE-2                  PIC X(10).
  6539
  6540     12  AM-CITY-CODE                      PIC X(4).
  6541     12  AM-COUNTY-PARISH                  PIC X(6).
  6542
  6543     12  AM-NAME                           PIC X(30).
  6544     12  AM-PERSON                         PIC X(30).
  6545     12  AM-ADDRS                          PIC X(30).
  6546     12  AM-CITY.
  6547         16  AM-ADDR-CITY                  PIC X(28).
  6548         16  AM-ADDR-STATE                 PIC XX.
  6549     12  AM-ZIP.
  6550         16  AM-ZIP-PRIME.
  6551             20  AM-ZIP-PRI-1ST            PIC X.
  6552                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6553             20  FILLER                    PIC X(4).
  6554         16  AM-ZIP-PLUS4                  PIC X(4).
  6555     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6556         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 121
* EL050.cbl
  6557         16  AM-CAN-POSTAL-2               PIC XXX.
  6558         16  FILLER                        PIC XXX.
  6559     12  AM-TEL-NO.
  6560         16  AM-AREA-CODE                  PIC 999.
  6561         16  AM-TEL-PRE                    PIC 999.
  6562         16  AM-TEL-NBR                    PIC 9(4).
  6563     12  AM-TEL-LOC                        PIC X.
  6564         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6565         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6566
  6567     12  AM-COMM-STRUCTURE.
  6568         16  AM-DEFN-1.
  6569             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6570                 24  AM-AGT.
  6571                     28  AM-AGT-PREFIX     PIC X(4).
  6572                     28  AM-AGT-PRIME      PIC X(6).
  6573                 24  AM-COM-TYP            PIC X.
  6574                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6575                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6576                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6577                 24  AM-RECALC-LV-INDIC    PIC X.
  6578                 24  AM-RETRO-LV-INDIC     PIC X.
  6579                 24  AM-GL-CODES           PIC X.
  6580                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6581                 24  FILLER                PIC X(01).
  6582         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6583             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6584                 24  FILLER                PIC X(11).
  6585                 24  AM-L-COMA             PIC XXX.
  6586                 24  AM-J-COMA             PIC XXX.
  6587                 24  AM-A-COMA             PIC XXX.
  6588                 24  FILLER                PIC X(6).
  6589
  6590     12  AM-COMM-CHANGE-STATUS             PIC X.
  6591         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6592
  6593     12  AM-CSR-CODE                       PIC X(4).
  6594
  6595     12  AM-BILLING-STATUS                 PIC X.
  6596         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6597         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6598     12  AM-AUTO-REFUND-SW                 PIC X.
  6599         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6600         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6601     12  AM-GPCD                           PIC 99.
  6602     12  AM-IG                             PIC X.
  6603         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6604         88  AM-HAS-GROUP                     VALUE '2'.
  6605     12  AM-STATUS                         PIC X.
  6606         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6607         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6608         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6609         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6610         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6611         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6612     12  AM-REMIT-TO                       PIC 99.
  6613     12  AM-ID-NO                          PIC X(11).
  6614
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 122
* EL050.cbl
  6615     12  AM-CAL-TABLE                      PIC XX.
  6616     12  AM-LF-DEVIATION                   PIC XXX.
  6617     12  AM-AH-DEVIATION                   PIC XXX.
  6618     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6619     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6620     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6621     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6622     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6623     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6624
  6625     12  AM-USER-FIELDS.
  6626         16  AM-FLD-1                      PIC XX.
  6627         16  AM-FLD-2                      PIC XX.
  6628         16  AM-FLD-3                      PIC XX.
  6629         16  AM-FLD-4                      PIC XX.
  6630         16  AM-FLD-5                      PIC XX.
  6631
  6632     12  AM-1ST-PROD-DATE.
  6633         16  AM-1ST-PROD-YR                PIC XX.
  6634         16  AM-1ST-PROD-MO                PIC XX.
  6635         16  AM-1ST-PROD-DA                PIC XX.
  6636     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6637     12  AM-CERTS-PURGED-DATE.
  6638         16  AM-PUR-YR                     PIC XX.
  6639         16  AM-PUR-MO                     PIC XX.
  6640         16  AM-PUR-DA                     PIC XX.
  6641     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6642     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6643     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6644     12  AM-INACTIVE-DATE.
  6645         16  AM-INA-MO                     PIC 99.
  6646         16  AM-INA-DA                     PIC 99.
  6647         16  AM-INA-YR                     PIC 99.
  6648     12  AM-AR-HI-CERT-DATE                PIC XX.
  6649
  6650     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6651     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6652
  6653     12  AM-OB-PAYMENT-MODE                PIC X.
  6654         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6655         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6656         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6657         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6658
  6659     12  AM-AH-ONLY-INDICATOR              PIC X.
  6660         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6661         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6662
  6663     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6664
  6665     12  AM-OVER-SHORT.
  6666         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6667         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6668
  6669     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6670     12  AM-DCC-CLP-STATE                  PIC XX.
  6671
  6672     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 123
* EL050.cbl
  6673     12  AM-RECALC-REIN                    PIC X.
  6674
  6675     12  AM-REI-TABLE                      PIC XXX.
  6676     12  AM-REI-ET-LF                      PIC X.
  6677     12  AM-REI-ET-AH                      PIC X.
  6678     12  AM-REI-PE-LF                      PIC X.
  6679     12  AM-REI-PE-AH                      PIC X.
  6680     12  AM-REI-PRT-ST                     PIC X.
  6681     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6682     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6683     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6684     12  AM-REI-GROUP-A                    PIC X(6).
  6685     12  AM-REI-MORT                       PIC X(4).
  6686     12  AM-REI-PRT-OW                     PIC X.
  6687     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6688     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6689     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6690     12  AM-REI-GROUP-B                    PIC X(6).
  6691
  6692     12  AM-TRUST-TYPE                     PIC X(2).
  6693
  6694     12  AM-EMPLOYER-STMT-USED             PIC X.
  6695     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6696
  6697     12  AM-STD-AH-TYPE                    PIC XX.
  6698     12  AM-EARN-METHODS.
  6699         16  AM-EARN-METHOD-R              PIC X.
  6700             88 AM-REF-RL-R78                 VALUE 'R'.
  6701             88 AM-REF-RL-PR                  VALUE 'P'.
  6702             88 AM-REF-RL-MEAN                VALUE 'M'.
  6703             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6704         16  AM-EARN-METHOD-L              PIC X.
  6705             88 AM-REF-LL-R78                 VALUE 'R'.
  6706             88 AM-REF-LL-PR                  VALUE 'P'.
  6707             88 AM-REF-LL-MEAN                VALUE 'M'.
  6708             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6709         16  AM-EARN-METHOD-A              PIC X.
  6710             88 AM-REF-AH-R78                 VALUE 'R'.
  6711             88 AM-REF-AH-PR                  VALUE 'P'.
  6712             88 AM-REF-AH-MEAN                VALUE 'M'.
  6713             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6714             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6715             88 AM-REF-AH-NET                 VALUE 'N'.
  6716
  6717     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6718     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6719     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6720
  6721     12  AM-RET-Y-N                        PIC X.
  6722     12  AM-RET-P-E                        PIC X.
  6723     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6724     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6725     12  AM-RET-GRP                        PIC X(6).
  6726     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6727         16  AM-POOL-PRIME                 PIC XXX.
  6728         16  AM-POOL-SUB                   PIC XXX.
  6729     12  AM-RETRO-EARNINGS.
  6730         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 124
* EL050.cbl
  6731         16  AM-RET-EARN-L                 PIC X.
  6732         16  AM-RET-EARN-A                 PIC X.
  6733     12  AM-RET-ST-TAX-USE                 PIC X.
  6734         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6735         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6736     12  AM-RETRO-BEG-EARNINGS.
  6737         16  AM-RET-BEG-EARN-R             PIC X.
  6738         16  AM-RET-BEG-EARN-L             PIC X.
  6739         16  AM-RET-BEG-EARN-A             PIC X.
  6740     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6741     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6742
  6743     12  AM-USER-SELECT-OPTIONS.
  6744         16  AM-USER-SELECT-1              PIC X(10).
  6745         16  AM-USER-SELECT-2              PIC X(10).
  6746         16  AM-USER-SELECT-3              PIC X(10).
  6747         16  AM-USER-SELECT-4              PIC X(10).
  6748         16  AM-USER-SELECT-5              PIC X(10).
  6749
  6750     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6751
  6752     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6753
  6754     12  AM-RPT045A-SWITCH                 PIC X.
  6755         88  RPT045A-OFF                   VALUE 'N'.
  6756
  6757     12  AM-INSURANCE-LIMITS.
  6758         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6759         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6760
  6761     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6762         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6763
  6764     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6765         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6766         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6767
  6768     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6769
  6770     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6771     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6772     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6773     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6774     12  AM-DCC-UEF-STATE                  PIC XX.
  6775     12  FILLER                            PIC XXX.
  6776     12  AM-REPORT-CODE-3                  PIC X(10).
  6777*    12  FILLER                            PIC X(22).
  6778
  6779     12  AM-RESERVE-DATE.
  6780         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6781         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6782         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6783
  6784     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6785     12  AM-NOTIFICATION-TYPES.
  6786         16  AM-NOTIF-OF-LETTERS           PIC X.
  6787         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6788         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 125
* EL050.cbl
  6789         16  AM-NOTIF-OF-STATUS            PIC X.
  6790
  6791     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6792         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6793         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6794         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6795         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6796
  6797     12  AM-BENEFIT-CONTROLS.
  6798         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6799             20  AM-BENEFIT-CODE           PIC XX.
  6800             20  AM-BENEFIT-TYPE           PIC X.
  6801             20  AM-BENEFIT-REVISION       PIC XXX.
  6802             20  AM-BENEFIT-REM-TERM       PIC X.
  6803             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6804             20  FILLER                    PIC XX.
  6805         16  FILLER                        PIC X(80).
  6806
  6807     12  AM-TRANSFER-DATA.
  6808         16  AM-TRANSFERRED-FROM.
  6809             20  AM-TRNFROM-CARRIER        PIC X.
  6810             20  AM-TRNFROM-GROUPING.
  6811                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6812                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6813             20  AM-TRNFROM-STATE          PIC XX.
  6814             20  AM-TRNFROM-ACCOUNT.
  6815                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6816                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6817             20  AM-TRNFROM-DTE            PIC XX.
  6818         16  AM-TRANSFERRED-TO.
  6819             20  AM-TRNTO-CARRIER          PIC X.
  6820             20  AM-TRNTO-GROUPING.
  6821                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6822                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6823             20  AM-TRNTO-STATE            PIC XX.
  6824             20  AM-TRNTO-ACCOUNT.
  6825                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6826                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6827             20  AM-TRNTO-DTE              PIC XX.
  6828         16  FILLER                        PIC X(10).
  6829
  6830     12  AM-SAVED-REMIT-TO                 PIC 99.
  6831
  6832     12  AM-COMM-STRUCTURE-SAVED.
  6833         16  AM-DEFN-1-SAVED.
  6834             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6835                 24  AM-AGT-SV             PIC X(10).
  6836                 24  AM-COM-TYP-SV         PIC X.
  6837                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6838                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6839                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6840                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6841                 24  FILLER                PIC X.
  6842                 24  AM-GL-CODES-SV        PIC X.
  6843                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6844                 24  FILLER                PIC X.
  6845         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6846             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 126
* EL050.cbl
  6847                 24  FILLER                PIC X(11).
  6848                 24  AM-L-COMA-SV          PIC XXX.
  6849                 24  AM-J-COMA-SV          PIC XXX.
  6850                 24  AM-A-COMA-SV          PIC XXX.
  6851                 24  FILLER                PIC X(6).
  6852
  6853     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6854         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6855            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6856            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6857            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6858
  6859     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6860     12  FILLER                            PIC X(120).
  6861
  6862     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6863         16  AM-CONTROL-NAME               PIC X(30).
  6864         16  AM-EXECUTIVE-ONE.
  6865             20  AM-EXEC1-NAME             PIC X(15).
  6866             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6867                                                          COMP-3.
  6868             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6869                                                          COMP-3.
  6870         16  AM-EXECUTIVE-TWO.
  6871             20  AM-EXEC2-NAME             PIC X(15).
  6872             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6873                                                          COMP-3.
  6874             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6875                                                          COMP-3.
  6876
  6877     12  AM-RETRO-ADDITIONAL-DATA.
  6878         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6879         16  AM-RETRO-PREM-P-E             PIC X.
  6880         16  AM-RETRO-CLMS-P-I             PIC X.
  6881         16  AM-RETRO-RET-BRACKET-LF.
  6882             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6883                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6884                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6885             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6886                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6887                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6888             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6889                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6890                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6891         16  AM-RETRO-RET-BRACKET-AH.
  6892             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6893                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6894                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6895                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6896             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6897                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6898                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6899             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6900                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6901                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6902
  6903     12  AM-COMMENTS.
  6904         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 127
* EL050.cbl
  6905
  6906     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6907         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6908         16  AM-FLI-BILLING-CODE           PIC X.
  6909         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6910         16  AM-FLI-UNITED-IDENT           PIC X.
  6911         16  AM-FLI-INTEREST-LOST-DATA.
  6912             20  AM-FLI-BANK-NO            PIC X(5).
  6913             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6914             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6915             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6916         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6917             20  AM-FLI-AGT                PIC X(9).
  6918             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6919             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6920         16  FILLER                        PIC X(102).
  6921
  6922     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6923         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6924             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6925             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6926             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6927             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6928             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6929         16  FILLER                          PIC X(10).
  6930******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 128
* EL050.cbl
  6932*    COPY ERCREIN.
  6933******************************************************************
  6934*                                                                *
  6935*                            ERCREIN                             *
  6936*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6937*                            VMOD=2.010                          *
  6938*                                                                *
  6939*   ONLINE CREDIT SYSTEM                                         *
  6940*                                                                *
  6941*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6942*                                                                *
  6943*   FILE TYPE = VSAM,KSDS                                        *
  6944*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6945*                                                                *
  6946*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6947*       ALTERNATE PATH = NONE                                    *
  6948*                                                                *
  6949*   LOG = NO                                                     *
  6950*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6951*                                                                *
  6952******************************************************************
  6953*                   C H A N G E   L O G
  6954*
  6955* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6956*-----------------------------------------------------------------
  6957*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6958* EFFECTIVE    NUMBER
  6959*-----------------------------------------------------------------
  6960* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6961* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6962******************************************************************
  6963 01  REINSURANCE-RECORD.
  6964     12  RE-RECORD-ID                      PIC XX.
  6965         88  VALID-RE-ID                      VALUE 'RE'.
  6966
  6967     12  RE-CONTROL-PRIMARY.
  6968         16  RE-COMPANY-CD                 PIC X.
  6969         16  RE-KEY.
  6970             20  RE-CODE                   PIC X.
  6971                 88  RE-TABLE-RECORD          VALUE 'A'.
  6972                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6973             20  RE-TABLE                  PIC XXX.
  6974             20  FILLER                    PIC XXX.
  6975         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6976             20  FILLER                    PIC X.
  6977             20  RE-COMPANY.
  6978                 24  RE-COMP-PRIME         PIC XXX.
  6979                 24  RE-COMP-SUB           PIC XXX.
  6980
  6981     12  RE-MAINT-INFORMATION.
  6982         16  RE-LAST-MAINT-DT              PIC XX.
  6983         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6984         16  RE-LAST-MAINT-USER            PIC X(4).
  6985         16  FILLER                        PIC X(10).
  6986
  6987     12  RE-TABLE-DATA.
  6988         16  RE-100-COMP                   PIC 99.
  6989
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 129
* EL050.cbl
  6990         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6991             20  RE-REI-COMP-NO.
  6992                 24  RE-REI-COMP           PIC XXX.
  6993                 24  RE-REI-COMP-SUB       PIC XXX.
  6994             20  RE-LF-QC                  PIC X.
  6995             20  RE-AH-QC                  PIC X.
  6996             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6997             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6998             20  RE-LFAGE-LO               PIC 99.
  6999             20  RE-LFAGE-HI               PIC 99.
  7000             20  RE-AHAGE-LO               PIC 99.
  7001             20  RE-AHAGE-HI               PIC 99.
  7002             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7003             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7004             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7005             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7006             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7007             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7008             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7009             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7010             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7011             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7012             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7013             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7014             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7015             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7016             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7017             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7018             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7019             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7020             20  RE-LF-BEN-CODE            PIC X.
  7021             20  RE-AH-BEN-CODE            PIC X.
  7022             20  RE-INTERACTIVE            PIC X.
  7023             20  RE-REMAINING              PIC X.
  7024             20  RE-LF-RUNOFF-SW           PIC X.
  7025             20  RE-AH-RUNOFF-SW           PIC X.
  7026             20  FILLER                    PIC X(19).
  7027
  7028         16  RE-COMP-INFO-END              PIC X(6).
  7029         16  RE-NSP-ST-CD-LF               PIC XX.
  7030         16  RE-NSP-ST-CD-AH               PIC XX.
  7031         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7032             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7033
  7034         16  FILLER                        PIC X(27).
  7035
  7036     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7037         16  RE-NAME                       PIC X(30).
  7038         16  RE-LF-PE                      PIC X.
  7039         16  RE-AH-PE                      PIC X.
  7040         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7041         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7042         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7043         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7044         16  RE-PRT-ST                     PIC X.
  7045         16  RE-PRT-OW                     PIC X.
  7046         16  RE-MORT-CODE                  PIC X(4).
  7047         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 130
* EL050.cbl
  7048         16  RE-ZERO-LF-FEE                PIC X.
  7049         16  RE-ZERO-AH-FEE                PIC X.
  7050         16  RE-CEDE-NAME                  PIC X(30).
  7051         16  RE-LF-COMM                    PIC X.
  7052         16  RE-AH-COMM                    PIC X.
  7053         16  RE-LF-TAX                     PIC X.
  7054         16  RE-AH-TAX                     PIC X.
  7055         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7056         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7057         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7058
  7059         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7060             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7061
  7062         16  RE-LF-CEDING-FEE-BRACKETS.
  7063             20  RE-LF-FEE-METHOD          PIC X.
  7064                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7065                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7066                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7067                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7068             20  RE-LF-FEE-BASIS           PIC X.
  7069                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7070                 88  RE-LF-NET-CEDED               VALUE '2'.
  7071                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7072                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7073                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7074                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7075                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7076                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7077             20  FILLER                    PIC XXX.
  7078             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7079                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7080                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7081
  7082         16  RE-AH-CEDING-FEE-BRACKETS.
  7083             20  RE-AH-FEE-METHOD          PIC X.
  7084                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7085                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7086                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7087                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7088             20  RE-AH-FEE-BASIS           PIC X.
  7089                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7090                 88  RE-AH-NET-CEDED               VALUE '2'.
  7091                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7092                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7093                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7094                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7095                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7096                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7097             20  FILLER                    PIC XXX.
  7098             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7099                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7100                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7101
  7102         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7103
  7104         16  RE-OLD-CEDING-STMT            PIC X.
  7105
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 131
* EL050.cbl
  7106         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7107         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7108         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7109         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7110         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7111         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7112         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7113         16  RE-MORT-SW                    PIC X.
  7114         16  RE-CEDING-TYPE-FLAG           PIC X.
  7115             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7116             88  RE-CEDED                          VALUE 'C'.
  7117             88  RE-ASSUMED                        VALUE 'A'.
  7118             88  RE-PHANTOM                        VALUE 'P'.
  7119
  7120         16  RE-CEDING-STMT-OPT-A          PIC X.
  7121             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7122         16  RE-CEDING-STMT-OPT-B          PIC X.
  7123             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7124         16  RE-CEDING-STMT-OPT-C          PIC X.
  7125             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7126         16  RE-CEDING-STMT-OPT-D          PIC X.
  7127             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7128         16  RE-CEDING-STMT-OPT-E          PIC X.
  7129             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7130
  7131         16  RE-PRT-CRSV                   PIC X.
  7132
  7133         16  RE-GL-CENTER                  PIC X(4).
  7134
  7135         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7136
  7137         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7138
  7139         16  RE-EARN-STOP-CODE             PIC X.
  7140             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7141             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7142
  7143         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7144             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7145
  7146         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7147         16  FILLER                        PIC X(2281).
  7148
  7149         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7150
  7151******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 132
* EL050.cbl
  7153*    COPY ERCCTBL.
  7154******************************************************************
  7155*                                                                *
  7156*                                                                *
  7157*                            ERCCTBL                             *
  7158*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7159*                            VMOD=2.003
  7160*                                                                *
  7161*   ONLINE CREDIT SYSTEM                                         *
  7162*                                                                *
  7163*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7164*                                                                *
  7165*   FILE TYPE = VSAM,KSDS                                        *
  7166*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7167*                                                                *
  7168*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7169*       ALTERNATE PATH = NONE                                    *
  7170*                                                                *
  7171*   LOG = NO                                                     *
  7172*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7173*                                                                *
  7174*                                                                *
  7175******************************************************************
  7176
  7177 01  COMM-TABLE-RECORD.
  7178     12  CT-RECORD-ID                      PIC XX.
  7179         88  VALID-CT-ID                      VALUE 'CT'.
  7180
  7181     12  CT-CONTROL-PRIMARY.
  7182         16  CT-COMPANY-CD                 PIC X.
  7183         16  CT-TABLE                      PIC XXX.
  7184         16  CT-CNTRL-2.
  7185             20  CT-BEN-TYPE               PIC X.
  7186             20  CT-BEN-CODE               PIC XX.
  7187
  7188     12  CT-MAINT-INFORMATION.
  7189         16  CT-LAST-MAINT-DT              PIC XX.
  7190         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7191         16  CT-LAST-MAINT-USER            PIC X(4).
  7192         16  FILLER                        PIC X(31).
  7193
  7194     12  CT-LIMITS.
  7195         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7196
  7197         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7198
  7199         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7200
  7201     12  CT-RATES.
  7202         16  CT-RTX          OCCURS 27 TIMES.
  7203             20  CT-RT                     PIC SV9(5)     COMP-3.
  7204             20  CT-RT-R   REDEFINES
  7205                 CT-RT                     PIC XXX.
  7206
  7207     12  FILLER                            PIC  X(42).
  7208
  7209******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 133
* EL050.cbl
  7211*    COPY ERCFORM.
  7212******************************************************************
  7213*                                                                *
  7214*                                                                *
  7215*                            ERCFORM.                            *
  7216*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7217*                            VMOD=2.003                          *
  7218*                                                                *
  7219*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7220*                                                                *
  7221*    FILE TYPE = VSAM,KSDS                                       *
  7222*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7223*                                                                *
  7224*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7225*                                                                *
  7226*    LOG = YES                                                   *
  7227*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7228******************************************************************
  7229 01  FORM-MASTER.
  7230    12  FO-RECORD-ID                 PIC X(02).
  7231        88  VALID-FO-ID                  VALUE 'FO'.
  7232
  7233    12  FO-CONTROL-PRIMARY.
  7234        16  FO-COMPANY-CD            PIC X(01).
  7235        16  FO-STATE                 PIC X(02).
  7236        16  FO-FORM-ID               PIC X(12).
  7237        16  FO-FORM-EXP-DT           PIC X(02).
  7238
  7239    12  FO-POLICY-FORM-DATA.
  7240        16  FO-IND-GRP-CD            PIC X(01).
  7241        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7242        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7243        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7244        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7245        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7246        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7247        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7248        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7249        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7250        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7251        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7252        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7253        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7254        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7255        16  FO-APP-CERT-USE-CD       PIC X(01).
  7256
  7257    12  FILLER                       PIC X(29).
  7258
  7259    12  FO-FORM-PLAN-TABLE.
  7260        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7261            20  FO-PLAN-TYPE         PIC X(01).
  7262            20  FO-PLAN-ID           PIC X(02).
  7263            20  FO-PLAN-TERM         PIC 9(03).
  7264            20  FO-PLAN-REFUND-METHOD
  7265                                     PIC X.
  7266
  7267    12  FILLER                       PIC X(30).
  7268
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 134
* EL050.cbl
  7269    12  FO-COMMENTS-AREA.
  7270        16  FO-COMMENT-LINE-1        PIC X(78).
  7271
  7272    12  FILLER                       PIC X(20).
  7273
  7274    12  FO-MAINT-INFORMATION.
  7275        16  FO-LAST-MAINT-DT         PIC X(02).
  7276        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7277        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 135
* EL050.cbl
  7279*    COPY ELCMSTR.
  7280******************************************************************
  7281*                                                                *
  7282*                            ELCMSTR.                            *
  7283*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7284*                            VMOD=2.012                          *
  7285*                                                                *
  7286*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7287*                                                                *
  7288*   FILE TYPE = VSAM,KSDS                                        *
  7289*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7290*                                                                *
  7291*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7292*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7293*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7294*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7295*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7296*                                                 RKP=75,LEN=21  *
  7297*                                                                *
  7298*   **** NOTE ****                                               *
  7299*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7300*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7301*                                                                *
  7302*   LOG = YES                                                    *
  7303*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7304******************************************************************
  7305*                   C H A N G E   L O G
  7306*
  7307* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7308*-----------------------------------------------------------------
  7309*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7310* EFFECTIVE    NUMBER
  7311*-----------------------------------------------------------------
  7312* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7313* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7314* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7315* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7316******************************************************************
  7317 01  CLAIM-MASTER.
  7318     12  CL-RECORD-ID                PIC XX.
  7319         88  VALID-CL-ID         VALUE 'CL'.
  7320
  7321     12  CL-CONTROL-PRIMARY.
  7322         16  CL-COMPANY-CD           PIC X.
  7323         16  CL-CARRIER              PIC X.
  7324         16  CL-CLAIM-NO             PIC X(7).
  7325         16  CL-CERT-NO.
  7326             20  CL-CERT-PRIME       PIC X(10).
  7327             20  CL-CERT-SFX         PIC X.
  7328
  7329     12  CL-CONTROL-BY-NAME.
  7330         16  CL-COMPANY-CD-A1        PIC X.
  7331         16  CL-INSURED-LAST-NAME    PIC X(15).
  7332         16  CL-INSURED-NAME.
  7333             20  CL-INSURED-1ST-NAME PIC X(12).
  7334             20  CL-INSURED-MID-INIT PIC X.
  7335
  7336     12  CL-CONTROL-BY-SSN.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 136
* EL050.cbl
  7337         16  CL-COMPANY-CD-A2        PIC X.
  7338         16  CL-SOC-SEC-NO.
  7339             20  CL-SSN-STATE        PIC XX.
  7340             20  CL-SSN-ACCOUNT      PIC X(6).
  7341             20  CL-SSN-LN3          PIC X(3).
  7342
  7343     12  CL-CONTROL-BY-CERT-NO.
  7344         16  CL-COMPANY-CD-A4        PIC X.
  7345         16  CL-CERT-NO-A4.
  7346             20  CL-CERT-A4-PRIME    PIC X(10).
  7347             20  CL-CERT-A4-SFX      PIC X.
  7348
  7349     12  CL-CONTROL-BY-CCN.
  7350         16  CL-COMPANY-CD-A5        PIC X.
  7351         16  CL-CCN-A5.
  7352             20  CL-CCN.
  7353                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7354                 24  CL-CCN-PRIME-A5 PIC X(12).
  7355             20  CL-CCN-FILLER-A5    PIC X(4).
  7356
  7357     12  CL-INSURED-PROFILE-DATA.
  7358         16  CL-INSURED-BIRTH-DT     PIC XX.
  7359         16  CL-INSURED-SEX-CD       PIC X.
  7360             88  INSURED-IS-MALE        VALUE 'M'.
  7361             88  INSURED-IS-FEMALE      VALUE 'F'.
  7362             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7363         16  CL-INSURED-OCC-CD       PIC X(6).
  7364         16  FILLER                  PIC X(5).
  7365
  7366     12  CL-PROCESSING-INFO.
  7367         16  CL-PROCESSOR-ID         PIC X(4).
  7368         16  CL-CLAIM-STATUS         PIC X.
  7369             88  CLAIM-IS-OPEN          VALUE 'O'.
  7370             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7371         16  CL-CLAIM-TYPE           PIC X.
  7372*            88  AH-CLAIM               VALUE 'A'.
  7373*            88  LIFE-CLAIM             VALUE 'L'.
  7374*            88  PROPERTY-CLAIM         VALUE 'P'.
  7375*            88  IUI-CLAIM              VALUE 'I'.
  7376*            88  GAP-CLAIM              VALUE 'G'.
  7377         16  CL-CLAIM-PREM-TYPE      PIC X.
  7378             88  SINGLE-PREMIUM         VALUE '1'.
  7379             88  O-B-COVERAGE           VALUE '2'.
  7380             88  OPEN-END-COVERAGE      VALUE '3'.
  7381         16  CL-INCURRED-DT          PIC XX.
  7382         16  CL-REPORTED-DT          PIC XX.
  7383         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7384         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7385         16  CL-LAST-PMT-DT          PIC XX.
  7386         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7387         16  CL-PAID-THRU-DT         PIC XX.
  7388         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7389         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7390         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7391         16  CL-PMT-CALC-METHOD      PIC X.
  7392             88  CL-360-DAY-YR          VALUE '1'.
  7393             88  CL-365-DAY-YR          VALUE '2'.
  7394             88  CL-FULL-MONTHS         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 137
* EL050.cbl
  7395         16  CL-CAUSE-CD             PIC X(6).
  7396
  7397         16  CL-PRIME-CERT-NO.
  7398             20  CL-PRIME-CERT-PRIME PIC X(10).
  7399             20  CL-PRIME-CERT-SFX   PIC X.
  7400
  7401         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7402             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7403             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7404
  7405         16  CL-MICROFILM-NO         PIC X(10).
  7406         16  FILLER REDEFINES CL-MICROFILM-NO.
  7407             20  CL-BENEFIT-PERIOD   PIC 99.
  7408             20  FILLER              PIC X(8).
  7409         16  CL-PROG-FORM-TYPE       PIC X.
  7410         16  CL-LAST-ADD-ON-DT       PIC XX.
  7411
  7412         16  CL-LAST-REOPEN-DT       PIC XX.
  7413         16  CL-LAST-CLOSE-DT        PIC XX.
  7414         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7415             88  FINAL-PAID             VALUE '1'.
  7416             88  CLAIM-DENIED           VALUE '2'.
  7417             88  AUTO-CLOSE             VALUE '3'.
  7418             88  MANUAL-CLOSE           VALUE '4'.
  7419             88  BENEFITS-CHANGED       VALUE 'C'.
  7420             88  SETUP-ERRORS           VALUE 'E'.
  7421         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7422         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7423         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7424             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7425         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7426         16  FILLER                  PIC X.
  7427
  7428     12  CL-CERTIFICATE-DATA.
  7429         16  CL-CERT-ORIGIN          PIC X.
  7430             88  CERT-WAS-ONLINE        VALUE '1'.
  7431             88  CERT-WAS-CREATED       VALUE '2'.
  7432             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7433         16  CL-CERT-KEY-DATA.
  7434             20  CL-CERT-CARRIER     PIC X.
  7435             20  CL-CERT-GROUPING    PIC X(6).
  7436             20  CL-CERT-STATE       PIC XX.
  7437             20  CL-CERT-ACCOUNT.
  7438                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7439                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7440             20  CL-CERT-EFF-DT      PIC XX.
  7441
  7442     12  CL-STATUS-CONTROLS.
  7443         16  CL-PRIORITY-CD          PIC X.
  7444             88  CONFIDENTIAL-DATA      VALUE '8'.
  7445             88  HIGHEST-PRIORITY       VALUE '9'.
  7446         16  CL-SUPV-ATTN-CD         PIC X.
  7447             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7448             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7449         16  CL-PURGED-DT            PIC XX.
  7450         16  CL-RESTORED-DT          PIC XX.
  7451         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7452         16  CL-NEXT-RESEND-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 138
* EL050.cbl
  7453         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7454         16  CL-CRITICAL-PERIOD      PIC 99.
  7455*        16  FILLER                  PIC XX.
  7456         16  CL-LAST-MAINT-DT        PIC XX.
  7457         16  CL-LAST-MAINT-USER      PIC X(4).
  7458         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7459         16  CL-LAST-MAINT-TYPE      PIC X.
  7460             88  CLAIM-SET-UP           VALUE ' '.
  7461             88  PAYMENT-MADE           VALUE '1'.
  7462             88  LETTER-SENT            VALUE '2'.
  7463             88  MASTER-WAS-ALTERED     VALUE '3'.
  7464             88  MASTER-WAS-RESTORED    VALUE '4'.
  7465             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7466             88  FILE-CONVERTED         VALUE '6'.
  7467             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7468             88  ERROR-CORRECTION       VALUE 'E'.
  7469         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7470         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7471         16  CL-BENEFICIARY          PIC X(10).
  7472         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7473         16  CL-DENIAL-TYPE          PIC X.
  7474             88  CL-TYPE-DENIAL          VALUE '1'.
  7475             88  CL-TYPE-RESCISSION      VALUE '2'.
  7476             88  CL-TYPE-REFORMATION     VALUE '3'.
  7477             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7478             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7479         16  filler                  pic x(5).
  7480*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7481*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7482*        16  CL-RTW-DT               PIC XX.
  7483
  7484     12  CL-TRAILER-CONTROLS.
  7485         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7486             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7487             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7488             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7489         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7490         16  FILLER                  PIC XX.
  7491         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7492         16  CL-ADDRESS-TRAILER-CNT.
  7493             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7494                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7495             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7496                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7497             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7498                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7499             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7500                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7501             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7502                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7503             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7504                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7505             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7506                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7507
  7508     12  CL-CV-REFERENCE-NO.
  7509         16  CL-CV-REFNO-PRIME       PIC X(18).
  7510         16  CL-CV-REFNO-SFX         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 139
* EL050.cbl
  7511
  7512     12  CL-FILE-LOCATION            PIC X(4).
  7513
  7514     12  CL-PROCESS-ERRORS.
  7515         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7516             88  NO-FATAL-ERRORS        VALUE ZERO.
  7517         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7518             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7519
  7520     12  CL-PRODUCT-CD               PIC X.
  7521
  7522     12  CL-CURRENT-KEY-DATA.
  7523         16  CL-CURRENT-CARRIER      PIC X.
  7524         16  CL-CURRENT-GROUPING     PIC X(6).
  7525         16  CL-CURRENT-STATE        PIC XX.
  7526         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7527
  7528     12  CL-ASSOCIATES               PIC X.
  7529         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7530         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7531         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7532         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7533
  7534     12  CL-ACTIVITY-CODE            PIC 99.
  7535     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7536     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7537
  7538     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7539     12  CL-LAG-REPORT-CODE          PIC 9.
  7540     12  CL-LOAN-TYPE                PIC XX.
  7541     12  CL-LEGAL-STATE              PIC XX.
  7542
  7543     12  CL-YESNOSW                  PIC X.
  7544     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7545         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7546         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7547         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7548     12  cl-insured-type             pic x.
  7549         88  cl-claim-on-primary         value 'P'.
  7550         88  cl-claim-on-co-borrower     value 'C'.
  7551     12  cl-benefit-expiration-dt    PIC XX.
  7552
  7553 01  PLAN-RECORDS.
  7554     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7555     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7556
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 140
* EL050.cbl
  7558 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7559                          ACCOUNT-MASTER REINSURANCE-RECORD
  7560                          COMM-TABLE-RECORD FORM-MASTER
  7561                          CLAIM-MASTER PLAN-RECORDS.
  7562 0000-DFHEXIT SECTION.
  7563     MOVE '9#                    $   ' TO DFHEIV0.
  7564     MOVE 'EL050' TO DFHEIV1.
  7565     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7566
  7567     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7568
  7569
  7570* EXEC CICS  HANDLE CONDITION
  7571*           ERROR    (9300-ABEND)
  7572*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7573*    END-EXEC.
  7574*    MOVE '"$.J                  ! " #00007565' TO DFHEIV0
  7575     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7576     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7577     MOVE X'2220233030303037353635' TO DFHEIV0(25:11)
  7578     CALL 'kxdfhei1' USING DFHEIV0
  7579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7580
  7581
  7582 0000-COPY-PROCEDURE-DIV.
  7583*                          COPY ELC50PD.
  7584******************************************************************
  7585*                                                                *
  7586*                            ELC50PD                             *
  7587*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7588*                            VMOD=2.188                          *
  7589*                                                                *
  7590******************************************************************
  7591*                   C H A N G E   L O G
  7592*
  7593* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7594*-----------------------------------------------------------------
  7595*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7596* EFFECTIVE    NUMBER
  7597*-----------------------------------------------------------------
  7598* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7599* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7600* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7601*                             2709 AND 2718
  7602* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7603* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7604* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7605* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7606* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7607*                                IS OPEN OR CNC DT < PD THRU
  7608* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7609* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7610* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7611* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7612* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7613* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7614* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7615* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 141
* EL050.cbl
  7616* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7617* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7618* 020906                   PEMA  EXPAND LOAN OFFICER
  7619* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7620* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7621* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7622* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7623* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7624* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7625* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7626* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7627* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7628* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7629* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7630* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7631* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7632* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7633* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7634* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7635* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7636* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7637* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7638* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7639* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7640* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7641* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7642* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7643* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7644*                                UPDATE VIN ON CERT TRAILER
  7645* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7646* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7647* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7648* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7649* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7650* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7651* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7652* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7653* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7654* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7655* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7656* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7657* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7658* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7659* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7660* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7661* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7662* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7663* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7664* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7665* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7666* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7667* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7668* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7669* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7670* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7671* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7672* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7673* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 142
* EL050.cbl
  7674* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7675* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7676* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7677* 032912  CR2011110200001  PEMA  AHL CHANGES
  7678* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7679* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7680* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7681* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7682* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7683* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7684* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7685* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7686* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7687* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7688* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7689* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7690* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7691* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7692* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7693* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7694* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7695* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7696* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7697* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7698* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7699* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7700******************************************************************
  7701************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7702******************************************************************
  7703
  7704     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7705
  7706     MOVE SPACES                 TO PB-FATAL-FLAG
  7707                                    PB-FORCE-ER-CD
  7708                                    PB-WARN-ER-CD
  7709                                    PB-OUT-BAL-CD.
  7710
  7711     MOVE SPACE                  TO WS-IG-OVRD-AH
  7712                                    WS-IG-OVRD-LF
  7713                                    WS-IG-OVRD-AM
  7714                                    WS-IG-OVRD
  7715                                    WS-IG-OVRD-AH-PL
  7716                                    WS-IG-OVRD-LF-PL
  7717                                    WS-IG-OVRD-AH-BEN
  7718                                    WS-IG-OVRD-LF-BEN.
  7719
  7720******************************************************************
  7721*************       INITIALIZE COMMON ERRORS       ***************
  7722******************************************************************
  7723
  7724     MOVE +0                     TO PB-NO-OF-ERRORS.
  7725     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7726
  7727******************************************************************
  7728
  7729     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7730     SET JULIAN-TO-BIN           TO TRUE.
  7731*    MOVE 5                      TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 143
* EL050.cbl
  7732     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7733     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7734
  7735     MOVE ZERO                   TO  SUB4.
  7736
  7737 0040-INITIALIZE-GA-BILL-DT.
  7738
  7739     ADD +1                      TO  SUB4.
  7740
  7741     IF  SUB4 GREATER THAN +5
  7742         GO TO 0050-CHECK-CNTL-FOUND.
  7743
  7744     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7745         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7746
  7747     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7748
  7749 0050-CHECK-CNTL-FOUND.
  7750
  7751     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7752        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7753                                         WS-AH-REM-TERM-CALC
  7754                                         EC-CO-REM-TERM-CALC
  7755        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7756        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7757        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7758                                         WS-TOL-AH-CLAIM
  7759        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7760                                         WS-TOL-AH-PREM
  7761                                         EC-CO-TOL-PREM
  7762        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7763                                         WS-TOL-AH-REFUND
  7764                                         EC-CO-TOL-REFUND
  7765        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7766                                         WS-AH-REFUND-OVS-AMT
  7767                                         EC-CO-OVR-SHT-AMT
  7768        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7769                                         WS-TOL-AH-PREM-PCT
  7770                                         EC-CO-TOL-PREM-PCT
  7771        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7772                                         WS-TOL-AH-REFUND-PCT
  7773                                         EC-CO-TOL-REFUND-PCT
  7774        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7775                                         WS-AH-REFUND-OVS-PCT
  7776                                         EC-CO-OVR-SHT-PCT
  7777        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7778        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7779        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7780        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7781        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7782        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7783        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7784        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7785        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7786        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7787        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7788        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7789                                         EC-CO-MONTH-END-DT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 144
* EL050.cbl
  7790        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7791          GO TO 0100-READ-ACCT.
  7792
  7793     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7794     MOVE SPACES                 TO CNTL-ACCESS.
  7795     MOVE '1'                    TO CNTL-REC-TYPE.
  7796     MOVE +0                     TO CNTL-SEQ-NO.
  7797
  7798     MOVE '1' TO RC-SW-1.
  7799     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7800     IF NOT CF-COMPANY-MASTER
  7801         MOVE ZEROS             TO WK-CO-TOL-PREM
  7802                                   WK-CO-TOL-CLAIM
  7803                                   WK-CO-TOL-REFUND
  7804                                   WK-REFUND-OVS-AMT
  7805                                   WK-REFUND-OVS-PCT
  7806                                   WK-CO-TOL-PREM-PCT
  7807                                   WK-CO-TOL-REFUND-PCT
  7808                                   WK-DEFAULT-APR
  7809                                   WK-CO-MAX-CAP
  7810        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7811                                   WK-CR-R78-METHOD
  7812                                   WK-CO-REF-REJECT-SW
  7813                                   WK-CO-PREM-REJECT-SW
  7814                                   WK-REM-TRM-CALC-OPTION
  7815                                   WK-BIRTH-DATE-INPUT
  7816                                   WK-JOINT-AGE-INPUT
  7817        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7818        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7819        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7820        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7821          GO TO 0099-COMPANY-NOT-FOUND.
  7822
  7823     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7824        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7825     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7826        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7827     IF CF-CO-TOL-CAP NOT NUMERIC
  7828        MOVE +0                    TO CF-CO-TOL-CAP.
  7829     IF CF-DEFAULT-APR NOT NUMERIC
  7830        MOVE +0                    TO CF-DEFAULT-APR.
  7831
  7832     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7833     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7834     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7835     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7836     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7837     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7838     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7839     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7840     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7841     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7842     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7843     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7844
  7845     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7846          CF-CO-OVR-SHT-AMT > +0
  7847        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 145
* EL050.cbl
  7848
  7849     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7850          CF-CO-OVR-SHT-PCT > +0
  7851        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7852
  7853     IF CF-VALID-REM-TRM-OPTION
  7854         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7855     ELSE
  7856         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7857
  7858     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7859     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7860     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7861     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7862
  7863     GO TO 0050-CHECK-CNTL-FOUND.
  7864
  7865 0099-COMPANY-NOT-FOUND.
  7866
  7867     MOVE ER-2616                TO WS-ERROR.
  7868     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7869
  7870 0100-READ-ACCT.
  7871
  7872     MOVE SPACES                 TO DATE-RANGE-SW.
  7873
  7874     IF WK-ACCT-ADDR = ZEROS
  7875        GO TO 0102-ACCT-GETMAIN.
  7876
  7877     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7878     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7879     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7880
  7881     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7882        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7883        GO TO 0105-READ-ACCT
  7884     END-IF
  7885
  7886     IF PB-CARRIER NOT = SPACES
  7887        IF PB-CARRIER NOT = AM-VG-CARRIER
  7888           GO TO 0105-READ-ACCT.
  7889
  7890     IF PB-STATE NOT = SPACES
  7891        IF PB-STATE NOT = AM-VG-STATE
  7892           GO TO 0105-READ-ACCT.
  7893
  7894     IF PB-GROUPING NOT = SPACES
  7895        IF PB-GROUPING NOT = AM-VG-GROUPING
  7896           GO TO 0105-READ-ACCT.
  7897
  7898     MOVE 'X'                 TO DATE-RANGE-SW.
  7899
  7900     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7901        MOVE 'X'                 TO DATE-RANGE-SW
  7902        GO TO 0105-READ-ACCT.
  7903
  7904     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7905        GO TO 0105-READ-ACCT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 146
* EL050.cbl
  7906
  7907     GO TO 0180-ACCOUNT-FOUND.
  7908
  7909 0102-ACCT-GETMAIN.
  7910     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7911     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7912
  7913 0105-READ-ACCT.
  7914     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7915     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7916     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7917     MOVE PB-STATE               TO ACCT-STATE.
  7918     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7919     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7920
  7921     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7922
  7923     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7924
  7925 0110-FIND-ACCT-TOLERANCES-LOOP.
  7926     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7927
  7928     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7929        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7930        GO TO 0199-ACCT-NOT-FOUND
  7931     END-IF
  7932     IF PB-CARRIER NOT = SPACES
  7933        IF PB-CARRIER NOT = AM-VG-CARRIER
  7934           GO TO 0199-ACCT-NOT-FOUND.
  7935
  7936     IF PB-STATE NOT = SPACES
  7937        IF PB-STATE NOT = AM-VG-STATE
  7938           GO TO 0199-ACCT-NOT-FOUND.
  7939
  7940     IF PB-GROUPING NOT = SPACES
  7941        IF PB-GROUPING NOT = AM-VG-GROUPING
  7942           GO TO 0199-ACCT-NOT-FOUND.
  7943
  7944     MOVE 'X'                    TO DATE-RANGE-SW.
  7945
  7946     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7947        MOVE 'X'                 TO DATE-RANGE-SW
  7948        GO TO 0199-ACCT-NOT-FOUND.
  7949
  7950     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7951        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7952
  7953 0180-ACCOUNT-FOUND.
  7954     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7955     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7956     MOVE AM-STATE               TO PB-SV-STATE.
  7957     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7958
  7959     IF AM-CANCEL-FEE  NOT NUMERIC
  7960        MOVE ZEROS TO AM-CANCEL-FEE.
  7961
  7962     IF AM-MAX-MON-BEN NOT NUMERIC
  7963        MOVE ZEROS TO AM-MAX-MON-BEN.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 147
* EL050.cbl
  7964
  7965     IF AM-MAX-TOT-BEN NOT NUMERIC
  7966        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7967
  7968     IF AM-CLP-TOL-PCT NOT NUMERIC
  7969        MOVE +0                  TO AM-CLP-TOL-PCT
  7970     END-IF
  7971     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7972        MOVE +0                  TO AM-SPP-LEASE-COMM
  7973     END-IF
  7974     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7975        MOVE ER-2611             TO   WS-ERROR
  7976        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7977
  7978     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7979        MOVE ER-2621             TO   WS-ERROR
  7980        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7981
  7982     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7983        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7984        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7985        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7986         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7987
  7988     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7989     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7990     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7991     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7992     IF AM-CLP-TOL-PCT NOT = ZEROS
  7993        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7994     END-IF
  7995     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7996        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7997     END-IF
  7998*    IF PB-COMPANY-ID = 'DCC'
  7999*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8000*                                   WS-ADMIN-FEES
  8001*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8002*          (SUB5 > +10)
  8003*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8004*             AND (AM-A-COM (SUB5) NUMERIC)
  8005*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8006*                + (AM-A-COM (SUB5) * 1000)
  8007*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8008*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8009*                + (AM-A-COM (SUB5) * 1000)
  8010*             END-IF
  8011*             IF AM-COM-TYP (SUB5) = 'N'
  8012*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8013*                + (AM-A-COM (SUB5) * 1000)
  8014*             END-IF
  8015*          END-IF
  8016*       END-PERFORM
  8017*    END-IF
  8018     IF (PB-COMPANY-ID = 'DCC')
  8019        AND (PB-ISSUE)
  8020        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8021        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 148
* EL050.cbl
  8022           (SUB5 > +10)
  8023           MOVE +0 TO WS-WK-RATE
  8024           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8025              IF (AM-A-COM (SUB5) NUMERIC)
  8026                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8027                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8028              ELSE
  8029                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8030                 IF PB-ISSUE
  8031                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8032                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8033                 ELSE
  8034                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8035                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8036                 END-IF
  8037                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8038                 MOVE ZEROS             TO WS-SUB1
  8039                                           WS-COMMISSION
  8040                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8041                 MOVE '0530'               TO CTBL-SW
  8042                 MOVE ' '                  TO WS-CTBL-READ-SW
  8043                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8044                 IF FIRST-TIME-THROUGH
  8045                    MOVE 'AA'              TO CTBL-BEN-CODE
  8046                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8047                 END-IF
  8048                 IF CTBL-TABLE-FOUND
  8049                    IF PB-ISSUE
  8050                       COMPUTE WS-COMM-CK-AMT =
  8051                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8052                    ELSE
  8053                       COMPUTE WS-COMM-CK-AMT =
  8054                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8055                    END-IF
  8056                    PERFORM 8800-GET-COMP-RATE
  8057                              THRU 8800-EXIT
  8058                 END-IF
  8059              END-IF
  8060              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8061                + (WS-WK-RATE * 1000)
  8062           END-IF
  8063        END-PERFORM
  8064     END-IF
  8065     IF PB-COMPANY-ID EQUAL 'CRI'
  8066         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8067
  8068     IF PB-COMPANY-ID EQUAL 'NCL'
  8069         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8070     END-IF
  8071
  8072     GO TO 0200-READ-CERT.
  8073
  8074 0199-ACCT-NOT-FOUND.
  8075
  8076     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8077
  8078     IF DATE-RANGE-SW NOT = SPACES
  8079        MOVE ER-2601             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 149
* EL050.cbl
  8080        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8081     ELSE
  8082        MOVE ER-2619             TO WS-ERROR
  8083        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8084
  8085     GO TO 9990-RETURN.
  8086
  8087 0200-READ-CERT.
  8088
  8089     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8090     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8091     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8092     MOVE PB-SV-STATE            TO CERT-STATE.
  8093     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8094     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8095     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8096
  8097     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8098
  8099     IF CERT-WAS-NOT-FOUND
  8100        GO TO 0299-CERT-NOT-FOUND.
  8101
  8102     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8103        MOVE ER-2759             TO WS-ERROR
  8104        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8105        GO TO 0298-UNLOCK-RETURN.
  8106
  8107     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8108         MOVE ER-2758            TO WS-ERROR
  8109         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8110         GO TO 0298-UNLOCK-RETURN.
  8111
  8112     IF PB-ISSUE
  8113        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8114           IF CERT-WAS-CREATED-FOR-CLAIM
  8115              NEXT SENTENCE
  8116            ELSE
  8117              MOVE ER-2626       TO WS-ERROR
  8118              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8119              GO TO 0298-UNLOCK-RETURN.
  8120
  8121     IF NOT PB-CANCELLATION
  8122        GO TO 0300-CONTINUE-EDIT.
  8123
  8124     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8125     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8126     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8127     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8128     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8129     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8130
  8131     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8132     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8133     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8134     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8135     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8136     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8137     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 150
* EL050.cbl
  8138     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8139     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8140
  8141     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8142     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8143     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8144     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8145     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8146     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8147     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8148
  8149     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8150     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8151
  8152     MOVE CM-CREDIT-INTERFACE-SW-1
  8153                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8154     MOVE CM-CREDIT-INTERFACE-SW-2
  8155                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8156
  8157     IF CM-O-B-COVERAGE
  8158         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8159
  8160     IF CM-LIVES NOT NUMERIC
  8161         MOVE ZERO                TO CM-LIVES.
  8162
  8163     IF CM-BILLED NOT NUMERIC
  8164         MOVE ZERO                TO CM-BILLED.
  8165
  8166     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8167         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8168         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8169         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8170         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8171         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8172         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8173         MOVE CM-LIVES             TO PB-CI-LIVES
  8174*The next line causes a problem with my change  I dont think it is
  8175*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8176
  8177     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8178     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8179     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8180     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8181     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8182     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8183
  8184     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8185     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8186     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8187     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8188
  8189     IF CM-LIFE-COMM-PCT NUMERIC
  8190         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8191     ELSE
  8192         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8193
  8194     IF CM-AH-COMM-PCT NUMERIC
  8195         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 151
* EL050.cbl
  8196     ELSE
  8197         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8198
  8199     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8200
  8201     IF CM-LOAN-APR       NOT NUMERIC
  8202           MOVE ZERO               TO CM-LOAN-APR.
  8203
  8204     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8205           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8206
  8207     IF CM-LOAN-TERM      NOT NUMERIC
  8208           MOVE ZERO               TO CM-LOAN-TERM.
  8209
  8210     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8211           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8212
  8213     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8214           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8215
  8216     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8217     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8218     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8219     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8220     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8221     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8222     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8223     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8224     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8225     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8226     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8227     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8228
  8229     IF CM-STATE = CM-SSN-STATE
  8230         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8231
  8232     IF CM-STATE NOT = CM-MEMB-STATE
  8233         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8234
  8235     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8236
  8237     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8238        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8239        IF CM-ADDL-CLP NOT NUMERIC
  8240           MOVE +0               TO CM-ADDL-CLP
  8241        END-IF
  8242        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8243        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8244           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8245        END-IF
  8246     END-IF
  8247     IF PB-COMPANY-ID = 'DCC'
  8248        MOVE +0                  TO WS-ADMIN-FEES
  8249                                    WS-CSO-ADMIN-FEE
  8250                                    WS-COMM-AND-MFEE
  8251                                    WS-1ST-YR-ALLOW
  8252        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8253           (SUB5 > +10)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 152
* EL050.cbl
  8254           MOVE +0 TO WS-WK-RATE
  8255           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8256              IF (AM-A-COM (SUB5) NUMERIC)
  8257                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8258                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8259              ELSE
  8260                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8261                 IF PB-ISSUE
  8262                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8263                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8264                 ELSE
  8265                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8266                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8267                 END-IF
  8268                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8269                 MOVE ZEROS             TO WS-SUB1
  8270                                           WS-COMMISSION
  8271                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8272                 MOVE '0530'               TO CTBL-SW
  8273                 MOVE ' '                  TO WS-CTBL-READ-SW
  8274                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8275                 IF FIRST-TIME-THROUGH
  8276                    MOVE 'AA'              TO CTBL-BEN-CODE
  8277                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8278                 END-IF
  8279                 IF CTBL-TABLE-FOUND
  8280                    IF PB-ISSUE
  8281                       COMPUTE WS-COMM-CK-AMT =
  8282                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8283                    ELSE
  8284                       COMPUTE WS-COMM-CK-AMT =
  8285                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8286                    END-IF
  8287                    PERFORM 8800-GET-COMP-RATE
  8288                              THRU 8800-EXIT
  8289                 END-IF
  8290              END-IF
  8291              IF AM-COM-TYP (SUB5) = 'I'
  8292                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8293                   + (WS-WK-RATE * 1000)
  8294              END-IF
  8295              IF AM-COM-TYP (SUB5) = 'N'
  8296                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8297                   + (WS-WK-RATE * 1000)
  8298              END-IF
  8299              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8300                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8301                   + (WS-WK-RATE * 1000)
  8302              END-IF
  8303              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8304                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8305                   + (WS-WK-RATE * 1000)
  8306              END-IF
  8307           END-IF
  8308        END-PERFORM
  8309     END-IF
  8310     GO TO 0300-CONTINUE-EDIT.
  8311
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 153
* EL050.cbl
  8312 0298-UNLOCK-RETURN.
  8313      PERFORM 9250-UNLOCK-RETURN
  8314      GO TO 9990-RETURN.
  8315
  8316 0299-CERT-NOT-FOUND.
  8317
  8318     MOVE '1'                     TO CERT-STATUS-SW.
  8319
  8320     IF PB-COMPANY-ID = 'UCL'
  8321         IF WS-ERROR = ER-2799
  8322             GO TO 3000-CONTINUE-EDIT.
  8323
  8324     IF NOT PB-CANCELLATION
  8325         GO TO 0300-CONTINUE-EDIT.
  8326
  8327     MOVE ER-2726                  TO  WS-ERROR.
  8328     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8329     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8330     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8331                                    PB-CI-LF-TERM
  8332                                    PB-C-LF-REM-TERM
  8333                                    PB-CI-AH-TERM
  8334                                    PB-C-AH-REM-TERM
  8335                                    PB-CI-LF-BENEFIT-CD
  8336                                    PB-CI-LF-BENEFIT-AMT
  8337                                    PB-CI-LF-ALT-BENEFIT-AMT
  8338                                    PB-CI-LF-PREMIUM-AMT
  8339                                    PB-CI-LF-ALT-PREMIUM-AMT
  8340                                    PB-CI-AH-BENEFIT-CD
  8341                                    PB-CI-AH-BENEFIT-AMT
  8342                                    PB-CI-AH-PREMIUM-AMT
  8343                                    PB-CI-PAY-FREQUENCY
  8344                                    PB-CI-LOAN-APR
  8345                                    PB-CI-LOAN-TERM
  8346                                    PB-CI-LIFE-COMMISSION
  8347                                    PB-CI-AH-COMMISSION
  8348                                    PB-CI-CURR-SEQ
  8349                                    PB-CI-AH-CANCEL-AMT
  8350                                    PB-CI-LF-CANCEL-AMT
  8351                                    PB-CI-RATE-DEV-PCT-LF
  8352                                    PB-CI-RATE-DEV-PCT-AH
  8353                                    PB-CI-EXTENTION-DAYS
  8354                                    PB-CI-TERM-IN-DAYS
  8355                                    PB-CI-LIVES
  8356                                    PB-CI-LF-CRIT-PER
  8357                                    PB-CI-AH-CRIT-PER
  8358                                    PB-CI-ADDL-CLP
  8359                                    PB-CI-DDF-IU-RATE-UP.
  8360
  8361     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8362                                    PB-CI-AH-SETTLEMENT-DT
  8363                                    PB-CI-DEATH-DT
  8364                                    PB-CI-LF-PRIOR-CANCEL-DT
  8365                                    PB-CI-AH-PRIOR-CANCEL-DT
  8366                                    PB-CI-ENTRY-DT
  8367                                    PB-CI-LF-EXPIRE-DT
  8368                                    PB-CI-AH-EXPIRE-DT
  8369                                    PB-CI-LOAN-1ST-PMT-DT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 154
* EL050.cbl
  8370
  8371     IF ACCOUNT-MAST-FOUND
  8372        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8373        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8374
  8375
  8376 0300-CONTINUE-EDIT.
  8377
  8378     IF PB-ISSUE
  8379        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8380            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8381
  8382     IF PB-ISSUE
  8383        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8384            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8385
  8386     IF PB-ISSUE
  8387       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8388          (AM-NO-AH-ONLY)
  8389           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8390               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8391                   MOVE ER-2679 TO WS-ERROR
  8392                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8393
  8394     IF PB-ISSUE
  8395        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8396        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8397        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8398     ELSE
  8399        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8400        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8401        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8402
  8403     MOVE 'N'                    TO PLAN-MASTER-SW
  8404                                    PLAN-MASTER-LIFE-SW
  8405                                    FORM-MASTER-SW
  8406                                    WS-APP-CERT-SW.
  8407
  8408     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8409                                    WS-PL-TOL-LF-REFUND
  8410                                    WS-PL-REF-OVS-AMT
  8411                                    WS-PL-TOL-LF-PREM-PCT
  8412                                    WS-PL-TOL-LF-REFUND-PCT
  8413                                    WS-PL-REF-OVS-PCT
  8414                                    WS-PL-TOL-LF-CLAIM.
  8415
  8416     IF PB-COMPANY-ID = 'NCL'
  8417       IF PB-ISSUE
  8418         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8419             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8420             IF FORM-MASTER-FOUND
  8421                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8422
  8423     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8424        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8425
  8426********************** MON CODE **********************
  8427     IF PB-COMPANY-ID = 'MON'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 155
* EL050.cbl
  8428     IF PB-ISSUE
  8429     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8430        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8431             PB-I-LOAN-APR = ZERO)
  8432               MOVE 14.0         TO PB-I-LOAN-APR.
  8433******************************************************
  8434
  8435     IF PB-COMPANY-ID = 'NCL'
  8436       IF PB-ISSUE
  8437           IF FORM-MASTER-FOUND
  8438             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8439                AM-DISMBR-COVERAGE
  8440                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8441                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8442                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8443                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8444                                           PB-I-LIFE-BENEFIT-CD.
  8445
  8446     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8447
  8448     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8449         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8450         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8451         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8452         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8453         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8454           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8455             GO TO 0301-LIFE-BENEFIT-SEARCH
  8456         ELSE
  8457             NEXT SENTENCE
  8458     ELSE
  8459         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8460
  8461     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8462     MOVE '4'                    TO CNTL-REC-TYPE.
  8463     MOVE +0                     TO CNTL-SEQ-NO.
  8464     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8465
  8466     MOVE '1' TO RC-SW-2.
  8467     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8468
  8469     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8470        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8471         GO TO 0305-BENEFIT-NOT-FOUND.
  8472
  8473     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8474
  8475 0301-LIFE-BENEFIT-SEARCH.
  8476
  8477     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8478
  8479     IF NO-BENEFIT-FOUND
  8480        GO TO 0305-BENEFIT-NOT-FOUND.
  8481
  8482     IF WS-BEN-CD = '99'
  8483        GO TO 0305-BENEFIT-NOT-FOUND.
  8484
  8485     IF PB-COMPANY-ID = 'NCL'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 156
* EL050.cbl
  8486         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8487             GO TO 0304-LIFE-BENEFIT-FOUND.
  8488
  8489     MOVE +1                     TO SUB5.
  8490     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8491
  8492* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8493* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8494     IF PB-COMPANY-ID = 'DMD'
  8495         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8496
  8497 0302-EDIT-ACCT-LF-BENEFITS.
  8498
  8499     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8500        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8501           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8502                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8503           GO TO 03XX-GET-LIFE-ERPLAN.
  8504
  8505     IF SUB5 LESS THAN +20
  8506        ADD +1                   TO SUB5
  8507        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8508
  8509     MOVE +1                     TO SUB5.
  8510
  8511     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8512        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8513
  8514 0303-EDIT-DMD-EXTRA-BENEFITS.
  8515
  8516     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8517        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8518           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8519                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8520           GO TO 03XX-GET-LIFE-ERPLAN.
  8521
  8522     IF SUB5 LESS THAN +30
  8523        ADD +1                   TO SUB5
  8524        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8525
  8526     MOVE +1                     TO SUB5.
  8527
  8528 03XX-EDIT-FOR-NINETY-LF.
  8529
  8530***************************************************************
  8531*                                                             *
  8532*    NINETY BENEFIT PLAN TYPES:                               *
  8533*                                                             *
  8534*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8535*      92 = ALL GROUP REDUCING BENEFITS                       *
  8536*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8537*      94 = ALL GROUP LEVEL BENEFITS                          *
  8538*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8539*           BENEFIT CONTROLS.                                 *
  8540*      99 = ALL BENEFITS                                      *
  8541*                                                             *
  8542***************************************************************
  8543
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 157
* EL050.cbl
  8544     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8545                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8546
  8547     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8548       AND
  8549        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8550        GO TO 03XX-GET-LIFE-ERPLAN.
  8551
  8552     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8553       AND
  8554        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8555        IF CF-REDUCING (SUB3)
  8556           IF (PB-I-INDV-GRP-OVRD = 'I')
  8557              OR
  8558           ((AM-IG = '1') AND
  8559           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8560              OR
  8561           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8562           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8563           (AM-IG NOT = '2'))
  8564              GO TO 03XX-GET-LIFE-ERPLAN.
  8565
  8566     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8567       AND
  8568        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8569        IF CF-REDUCING (SUB3)
  8570           IF (PB-I-INDV-GRP-OVRD = 'G')
  8571              OR
  8572           ((AM-IG = '2') AND
  8573           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8574              OR
  8575           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8576           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8577           (AM-IG NOT = '1'))
  8578              GO TO 03XX-GET-LIFE-ERPLAN.
  8579
  8580     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8581       AND
  8582        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8583        IF CF-LEVEL    (SUB3)
  8584           IF (PB-I-INDV-GRP-OVRD = 'I')
  8585              OR
  8586           ((AM-IG = '1') AND
  8587           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8588              OR
  8589           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8590           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8591            (AM-IG NOT = '2'))
  8592              GO TO 03XX-GET-LIFE-ERPLAN.
  8593
  8594     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8595       AND
  8596        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8597        IF CF-LEVEL    (SUB3)
  8598           IF (PB-I-INDV-GRP-OVRD = 'G')
  8599              OR
  8600           ((AM-IG = '2') AND
  8601           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 158
* EL050.cbl
  8602              OR
  8603           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8604           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8605           (AM-IG NOT = '1'))
  8606              GO TO 03XX-GET-LIFE-ERPLAN.
  8607
  8608     IF SUB5 LESS THAN +20
  8609        ADD +1                   TO SUB5
  8610        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8611
  8612     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8613
  8614     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8615        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8616
  8617     MOVE +1                     TO SUB5.
  8618
  8619 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8620
  8621     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8622                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8623
  8624     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8625       AND
  8626        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8627        GO TO 03XX-GET-LIFE-ERPLAN.
  8628
  8629     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8630       AND
  8631        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8632        IF CF-REDUCING (SUB3)
  8633           IF (PB-I-INDV-GRP-OVRD = 'I')
  8634              OR
  8635           ((AM-IG = '1') AND
  8636           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8637              OR
  8638           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8639           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8640           (AM-IG NOT = '2'))
  8641              GO TO 03XX-GET-LIFE-ERPLAN.
  8642
  8643     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8644       AND
  8645        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8646        IF CF-REDUCING (SUB3)
  8647           IF (PB-I-INDV-GRP-OVRD = 'G')
  8648              OR
  8649           ((AM-IG = '2') AND
  8650           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8651              OR
  8652           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8653           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8654           (AM-IG NOT = '1'))
  8655              GO TO 03XX-GET-LIFE-ERPLAN.
  8656
  8657     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8658       AND
  8659        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 159
* EL050.cbl
  8660        IF CF-LEVEL    (SUB3)
  8661           IF (PB-I-INDV-GRP-OVRD = 'I')
  8662              OR
  8663           ((AM-IG = '1') AND
  8664           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8665              OR
  8666           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8667           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8668            (AM-IG NOT = '2'))
  8669              GO TO 03XX-GET-LIFE-ERPLAN.
  8670
  8671     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8672       AND
  8673        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8674        IF CF-LEVEL    (SUB3)
  8675           IF (PB-I-INDV-GRP-OVRD = 'G')
  8676              OR
  8677           ((AM-IG = '2') AND
  8678           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8679              OR
  8680           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8681           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8682           (AM-IG NOT = '1'))
  8683              GO TO 03XX-GET-LIFE-ERPLAN.
  8684
  8685     IF SUB5 LESS THAN +30
  8686        ADD +1                   TO SUB5
  8687        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8688
  8689     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8690
  8691 03XX-EDIT-FOR-NINETY-LF-CONT.
  8692
  8693     MOVE +99                    TO SUB5.
  8694
  8695     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8696        IF PB-ISSUE
  8697           MOVE ER-1924          TO  WS-ERROR
  8698           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8699
  8700     GO TO 0304-LIFE-BENEFIT-FOUND.
  8701
  8702 03XX-GET-LIFE-ERPLAN.
  8703
  8704     IF WK-PLAN-ADDR EQUAL +0
  8705        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8706
  8707     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8708     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8709     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8710     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8711     MOVE 'Y'                    TO PLAN-MASTER-SW
  8712                                    PLAN-MASTER-LIFE-SW.
  8713     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8714
  8715 03XX-ERPLAN-LIFE-GETMAIN.
  8716
  8717     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 160
* EL050.cbl
  8718     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8719
  8720 03XX-ERPLAN-LIFE-READ.
  8721
  8722     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8723     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8724     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8725     MOVE PB-SV-STATE            TO PLAN-STATE.
  8726     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8727     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8728     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8729     MOVE WS-SAVE-BENEFIT-REVISION
  8730                                 TO PLAN-REVISION-NO.
  8731
  8732     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8733     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8734
  8735     IF PB-COMPANY-ID = 'NCL'
  8736       IF NOT LF-PLAN-MASTER-FOUND
  8737         IF NOT PB-POLICY-IS-DECLINED  AND
  8738            NOT PB-POLICY-IS-VOIDED
  8739             MOVE  ER-1921         TO  WS-ERROR
  8740             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8741             GO TO 0304-LIFE-BENEFIT-FOUND.
  8742
  8743     IF NOT LF-PLAN-MASTER-FOUND
  8744        GO TO 0304-LIFE-BENEFIT-FOUND.
  8745
  8746 XXXX-CHECK-LF-PLAN-KEY.
  8747
  8748     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8749        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8750        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8751        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8752        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8753        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8754        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8755        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8756        MOVE 'N'                 TO PLAN-MASTER-SW
  8757          GO TO 03XX-ERPLAN-LIFE-READ.
  8758
  8759     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8760
  8761     IF  PB-CANCELLATION
  8762         GO TO  0303-LF-ACCT-BEN-FOUND.
  8763
  8764     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8765        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8766           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8767           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8768              MOVE ER-2644             TO WS-ERROR
  8769              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8770           ELSE
  8771              NEXT SENTENCE
  8772        ELSE
  8773           IF PB-COMPANY-ID NOT = 'NCL'
  8774              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8775                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 161
* EL050.cbl
  8776
  8777 0303-LF-ACCT-BEN-FOUND.
  8778
  8779     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8780
  8781     IF PL-DEV-CODE NOT = SPACES
  8782        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8783
  8784     IF PL-DEV-PCT NUMERIC AND
  8785        PL-DEV-PCT NOT = ZEROS
  8786        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8787
  8788     IF PL-TOL-PREM-AMT GREATER THAN +0
  8789        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8790
  8791     IF PL-TOL-REF-AMT GREATER THAN +0
  8792        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8793
  8794     IF PL-TOL-PREM-PCT GREATER THAN +0
  8795        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8796
  8797     IF PL-TOL-REF-PCT GREATER THAN +0
  8798        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8799
  8800     IF PL-TOL-CLM-AMT GREATER THAN +0
  8801        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8802
  8803     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8804                          PL-OVER-SHORT-AMT > +0
  8805        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8806
  8807     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8808                          PL-OVER-SHORT-PCT > +0
  8809        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8810
  8811     IF PL-SALES-TAX NUMERIC AND
  8812                          PL-SALES-TAX > +0
  8813         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8814
  8815     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8816        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8817                                    WS-IG-OVRD-AM.
  8818
  8819 0304-LIFE-BENEFIT-FOUND.
  8820
  8821     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8822
  8823     IF PB-ISSUE
  8824        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8825     ELSE
  8826        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8827
  8828     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8829     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8830     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8831     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8832     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8833                                         WS-LF-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 162
* EL050.cbl
  8834     if (ws-lf-earnings-calc = '5')
  8835        and (pb-i-loan-apr = zeros)
  8836        and (benefit-code-chg)
  8837        move +99.9999 to pb-i-loan-apr
  8838     end-if
  8839
  8840     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8841        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8842
  8843     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8844        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8845     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8846
  8847     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8848     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8849     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8850     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8851     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8852     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8853
  8854     IF PB-COMPANY-ID = 'NCL'  AND
  8855        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8856         NEXT SENTENCE
  8857     ELSE
  8858         IF SUB5 NOT GREATER THAN +20
  8859            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8860               MOVE WS-SAVE-BENEFIT-REM-TERM
  8861                                      TO WS-AM-LF-BENE-REM-TERM
  8862                                         EC-BR-LF-REM-TERM-CALC.
  8863
  8864     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8865     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8866
  8867     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8868
  8869 0305-BENEFIT-NOT-FOUND.
  8870
  8871     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8872     MOVE ER-2604                TO WS-ERROR.
  8873     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8874
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 163
* EL050.cbl
  8876
  8877 0310-FIND-AH-BENEFIT-RECORD.
  8878
  8879     MOVE 'N'                    TO PLAN-MASTER-SW
  8880                                    PLAN-MASTER-AH-SW.
  8881
  8882     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8883                                    WS-PL-TOL-AH-REFUND
  8884                                    WS-AH-PL-REF-OVS-AMT
  8885                                    WS-PL-TOL-AH-PREM-PCT
  8886                                    WS-PL-TOL-AH-REFUND-PCT
  8887                                    WS-AH-PL-REF-OVS-PCT
  8888                                    WS-PL-TOL-AH-CLAIM.
  8889     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8890
  8891
  8892     if pb-issue
  8893        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8894           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8895        end-if
  8896        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8897           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8898           GO TO 0399-BENEFIT-NOT-FOUND
  8899        end-if
  8900     end-if
  8901
  8902     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8903        GO TO 0400-FIND-CARRIER.
  8904
  8905     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8906
  8907     IF WK-AH-BEN-ADDR NOT = ZEROS
  8908         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8909         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8910         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8911         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8912           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8913             GO TO 0311-AH-BENEFIT-SEARCH
  8914         ELSE
  8915             NEXT SENTENCE
  8916     ELSE
  8917         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8918
  8919     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8920     MOVE '5'                    TO CNTL-REC-TYPE.
  8921     MOVE +0                     TO CNTL-SEQ-NO.
  8922     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8923
  8924     MOVE '2' TO RC-SW-2.
  8925     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8926
  8927     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8928        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8929          GO TO 0399-BENEFIT-NOT-FOUND.
  8930
  8931     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8932
  8933 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 164
* EL050.cbl
  8934
  8935     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8936
  8937     IF NO-BENEFIT-FOUND
  8938         GO TO 0399-BENEFIT-NOT-FOUND.
  8939
  8940     IF WS-BEN-CD = '99'
  8941        GO TO 0399-BENEFIT-NOT-FOUND.
  8942
  8943     IF PB-COMPANY-ID  =  'NCL'
  8944         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8945             GO TO 0314-A-H-BENEFIT-FOUND.
  8946
  8947     MOVE +1                     TO SUB5.
  8948     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8949
  8950* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8951* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8952     IF PB-COMPANY-ID = 'DMD'
  8953         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8954
  8955 0312-EDIT-ACCT-AH-BENEFITS.
  8956
  8957     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8958        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8959           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8960                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8961           GO TO 03XX-GET-AH-ERPLAN.
  8962
  8963     IF SUB5 LESS THAN +20
  8964        ADD +1                   TO SUB5
  8965        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8966
  8967     MOVE +1                     TO SUB5.
  8968
  8969     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8970        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8971
  8972 0313-EDIT-DMD-EXTRA-BENEFITS.
  8973
  8974     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8975        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8976           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8977                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8978           GO TO 03XX-GET-AH-ERPLAN.
  8979
  8980     IF SUB5 LESS THAN +30
  8981        ADD +1                   TO SUB5
  8982        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8983
  8984     MOVE +1                     TO SUB5.
  8985
  8986 03XX-EDIT-FOR-NINETY-AH.
  8987
  8988***************************************************************
  8989*                                                             *
  8990*    NINETY BENEFIT PLAN TYPES:                               *
  8991*                                                             *
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 165
* EL050.cbl
  8992*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8993*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8994*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8995*           BENEFIT CONTROLS.                                 *
  8996*      99 = ALL BENEFITS.                                     *
  8997*                                                             *
  8998***************************************************************
  8999
  9000     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9001                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9002
  9003     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9004       AND
  9005        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9006        GO TO 03XX-GET-AH-ERPLAN.
  9007
  9008     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9009       AND
  9010        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9011           IF (PB-I-INDV-GRP-OVRD = 'I')
  9012              OR
  9013           ((AM-IG = '1') AND
  9014           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9015              OR
  9016           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9017           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9018           (AM-IG NOT = '2'))
  9019              GO TO 03XX-GET-AH-ERPLAN.
  9020
  9021     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9022       AND
  9023        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9024           IF (PB-I-INDV-GRP-OVRD = 'G')
  9025              OR
  9026           ((AM-IG = '2') AND
  9027           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9028              OR
  9029           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9030           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9031           (AM-IG NOT = '1'))
  9032              GO TO 03XX-GET-AH-ERPLAN.
  9033
  9034     IF SUB5 LESS THAN +20
  9035        ADD +1                   TO SUB5
  9036        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9037
  9038     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9039        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9040
  9041     MOVE +1                    TO SUB5.
  9042
  9043 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9044
  9045     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9046                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9047
  9048     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9049       AND
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 166
* EL050.cbl
  9050        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9051        GO TO 03XX-GET-AH-ERPLAN.
  9052
  9053     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9054       AND
  9055        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9056           IF (PB-I-INDV-GRP-OVRD = 'I')
  9057              OR
  9058           ((AM-IG = '1') AND
  9059           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9060              OR
  9061           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9062           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9063           (AM-IG NOT = '2'))
  9064              GO TO 03XX-GET-AH-ERPLAN.
  9065
  9066     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9067       AND
  9068        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9069           IF (PB-I-INDV-GRP-OVRD = 'G')
  9070              OR
  9071           ((AM-IG = '2') AND
  9072           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9073              OR
  9074           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9075           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9076           (AM-IG NOT = '1'))
  9077              GO TO 03XX-GET-AH-ERPLAN.
  9078
  9079     IF SUB5 LESS THAN +30
  9080        ADD +1                   TO SUB5
  9081        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9082
  9083 03XX-EDIT-FOR-NINETY-AH-CONT.
  9084
  9085     MOVE +99                    TO SUB5.
  9086
  9087     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9088
  9089     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9090        IF PB-ISSUE
  9091           MOVE ER-1925          TO  WS-ERROR
  9092           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9093
  9094     GO TO 0314-A-H-BENEFIT-FOUND.
  9095
  9096 03XX-GET-AH-ERPLAN.
  9097
  9098     IF WK-PLAN-ADDR EQUAL +0
  9099         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9100
  9101     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9102     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9103     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9104     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9105     MOVE 'Y'                    TO PLAN-MASTER-SW
  9106                                    PLAN-MASTER-AH-SW.
  9107*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 167
* EL050.cbl
  9108     GO TO 03XX-ERPLAN-AH-READ.
  9109
  9110 03XX-ERPLAN-AH-GETMAIN.
  9111
  9112     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9113     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9114
  9115 03XX-ERPLAN-AH-READ.
  9116
  9117     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9118     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9119     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9120     MOVE PB-SV-STATE            TO PLAN-STATE.
  9121     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9122     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9123     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9124     MOVE WS-SAVE-BENEFIT-REVISION
  9125                                 TO PLAN-REVISION-NO.
  9126
  9127     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9128     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9129
  9130     IF PB-COMPANY-ID = 'NCL'
  9131       IF NOT AH-PLAN-MASTER-FOUND
  9132         IF NOT PB-POLICY-IS-DECLINED  AND
  9133            NOT PB-POLICY-IS-VOIDED
  9134             MOVE  ER-1922         TO  WS-ERROR
  9135             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9136             GO TO 0314-A-H-BENEFIT-FOUND.
  9137
  9138     IF NOT AH-PLAN-MASTER-FOUND
  9139        GO TO 0314-A-H-BENEFIT-FOUND.
  9140
  9141 XXXX-CHECK-AH-PLAN-KEY.
  9142
  9143     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9144        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9145        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9146        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9147        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9148        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9149        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9150        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9151        MOVE 'N'                 TO PLAN-MASTER-SW
  9152          GO TO 03XX-ERPLAN-AH-READ.
  9153
  9154     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9155
  9156     IF  PB-CANCELLATION
  9157         GO TO  0313-AH-ACCT-BEN-FOUND.
  9158
  9159     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9160       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9161          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9162          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9163             MOVE ER-2644             TO WS-ERROR
  9164             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9165          ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 168
* EL050.cbl
  9166             NEXT SENTENCE
  9167       ELSE
  9168          IF PB-COMPANY-ID NOT = 'NCL'
  9169             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9170                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9171
  9172 0313-AH-ACCT-BEN-FOUND.
  9173
  9174     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9175
  9176     IF PL-DEV-CODE NOT = SPACES
  9177        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9178
  9179     IF PL-DEV-PCT NUMERIC AND
  9180        PL-DEV-PCT NOT = ZEROS
  9181        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9182
  9183     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9184        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9185
  9186     IF PL-TOL-REF-AMT NOT EQUAL +0
  9187        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9188
  9189     IF PL-TOL-PREM-PCT GREATER THAN +0
  9190        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9191
  9192     IF PL-TOL-REF-PCT GREATER THAN +0
  9193        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9194
  9195     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9196        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9197
  9198     IF PL-OVER-SHORT-AMT NUMERIC AND
  9199                          PL-OVER-SHORT-AMT > +0
  9200        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9201
  9202     IF PL-OVER-SHORT-PCT NUMERIC AND
  9203                          PL-OVER-SHORT-PCT > +0
  9204        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9205
  9206     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9207        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9208        IF WS-IG-OVRD-AM EQUAL SPACES
  9209            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9210
  9211 0314-A-H-BENEFIT-FOUND.
  9212
  9213     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9214
  9215     IF PB-ISSUE
  9216        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9217       ELSE
  9218        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9219
  9220     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9221     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9222     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9223     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 169
* EL050.cbl
  9224                                         WS-AH-REFUND-CALC.
  9225
  9226     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9227        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9228
  9229     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9230        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9231     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9232
  9233     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9234     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9235     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9236     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9237     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9238     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9239
  9240     IF PB-COMPANY-ID = 'NCL'  AND
  9241        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9242         NEXT SENTENCE
  9243     ELSE
  9244         IF SUB5 NOT GREATER THAN +20
  9245            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9246                MOVE WS-SAVE-BENEFIT-REM-TERM
  9247                                      TO WS-AM-AH-BENE-REM-TERM
  9248                                         EC-BR-AH-REM-TERM-CALC.
  9249
  9250     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9251     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9252
  9253     GO TO 0400-FIND-CARRIER.
  9254
  9255 0399-BENEFIT-NOT-FOUND.
  9256
  9257     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9258     MOVE ER-2605                TO WS-ERROR.
  9259     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9260
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 170
* EL050.cbl
  9262
  9263 0400-FIND-CARRIER.
  9264
  9265     MOVE PB-SV-CARRIER          TO WS-CARR.
  9266
  9267     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9268     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9269     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9270     MOVE '6'                    TO CNTL-REC-TYPE.
  9271
  9272*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9273     MOVE SPACE                  TO WS-DMD-RATING-SW
  9274                                    EC-BR-DMD-RATING-SW.
  9275
  9276     MOVE '2'                    TO RC-SW-1.
  9277     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9278
  9279     IF NOT CF-CARRIER-MASTER
  9280        GO TO 0400-CARRIER-NOT-FOUND.
  9281
  9282 0400-BUILD-CARR-TOL.
  9283
  9284     IF CF-CR-TOL-PREM NUMERIC AND
  9285        CF-CR-TOL-PREM GREATER THAN +0
  9286        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9287                                    WS-TOL-AH-PREM.
  9288
  9289     IF CF-CR-TOL-REFUND NUMERIC AND
  9290        CF-CR-TOL-REFUND GREATER THAN +0
  9291        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9292                                    WS-TOL-AH-REFUND.
  9293
  9294     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9295        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9296        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9297                                    WS-AH-REFUND-OVS-AMT.
  9298
  9299     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9300        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9301        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9302                                    WS-AH-REFUND-OVS-PCT.
  9303
  9304     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9305        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9306        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9307                                    WS-TOL-AH-PREM-PCT.
  9308
  9309     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9310        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9311        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9312                                     WS-TOL-AH-REFUND-PCT.
  9313
  9314     IF CF-COMPANY-ID EQUAL 'DMD'
  9315         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9316                                    EC-BR-DMD-RATING-SW.
  9317
  9318     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9319     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 171
* EL050.cbl
  9320        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9321     END-IF
  9322     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9323        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9324     END-IF
  9325     IF WS-TOL-CLP-PCT = ZEROS
  9326        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9327     END-IF
  9328
  9329     IF WS-SPP-LEASE-COMM = ZEROS
  9330        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9331     END-IF
  9332     GO TO 0400-FIND-ERPDEF.
  9333
  9334 0400-CARRIER-NOT-FOUND.
  9335
  9336     MOVE ER-2602                TO WS-ERROR.
  9337     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9338
  9339 0400-FIND-ERPDEF.
  9340     IF PB-COMPANY-ID = 'DCC'
  9341        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9342        CONTINUE
  9343     ELSE
  9344        GO TO 0400-FIND-ERCOMP
  9345     END-IF
  9346     MOVE ' '                    TO PDEF-MASTER-SW
  9347     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9348     MOVE PB-STATE               TO ERPDEF-STATE
  9349     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9350     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9351     IF PB-ISSUE
  9352        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9353     ELSE
  9354        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9355     END-IF
  9356     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9357     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9358     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9359     IF PDEF-MASTER-FOUND
  9360        MOVE 'N'                 TO PDEF-MASTER-SW
  9361        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9362        IF PDEF-MASTER-FOUND
  9363           IF (ERPDEF-KEY-SAVE (1:16) =
  9364                        PD-CONTROL-PRIMARY (1:16))
  9365              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9366              CONTINUE
  9367           ELSE
  9368              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9369              IF (ERPDEF-KEY-SAVE (1:16) =
  9370                        PD-CONTROL-PRIMARY (1:16))
  9371                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9372                 CONTINUE
  9373              ELSE
  9374                 MOVE 'N'        TO PDEF-MASTER-SW
  9375              END-IF
  9376           END-IF
  9377        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 172
* EL050.cbl
  9378        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9379     END-IF
  9380     IF PDEF-MASTER-FOUND
  9381        IF PD-TRUNCATED = 'Y'
  9382           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9383        END-IF
  9384     END-IF
  9385     .
  9386 0400-FIND-ERCOMP.
  9387     IF PB-COMPANY-ID = 'DCC'
  9388        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9389           (WS-SUB1 > +10)
  9390           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9391                 OR 'A' OR 'N'
  9392              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9393              MOVE PB-CARRIER    TO COMP-CARRIER
  9394              MOVE PB-GROUPING   TO COMP-GROUPING
  9395              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9396              MOVE AM-AGT (WS-SUB1)
  9397                                 TO COMP-FIN-RESP
  9398              MOVE 'G'           TO COMP-TYPE
  9399              PERFORM 8582-READ-COMPENSATION-MASTER
  9400                                 THRU 8582-EXIT
  9401              IF COMP-MASTER-FOUND
  9402                 IF CO-GA-INACTIVE
  9403                    MOVE ER-2763 TO WS-ERROR
  9404                    PERFORM 9900-ERROR-FORMAT
  9405                                 THRU 9900-EXIT
  9406                    MOVE +11     TO WS-SUB1
  9407                 END-IF
  9408                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9409                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9410                    MOVE ER-2788 TO WS-ERROR
  9411                    PERFORM 9900-ERROR-FORMAT
  9412                                 THRU 9900-EXIT
  9413                    MOVE +11     TO WS-SUB1
  9414                 END-IF
  9415              END-IF
  9416           END-IF
  9417        END-PERFORM
  9418     END-IF
  9419     IF PB-COMPANY-ID = 'DCC'
  9420        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9421           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9422                                    WS-CLP-STATE
  9423        ELSE
  9424           MOVE SPACES           TO PB-I-CLP-STATE
  9425                                    WS-CLP-STATE
  9426        END-IF
  9427     END-IF
  9428
  9429     IF (PB-COMPANY-ID = 'DCC')
  9430        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9431        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9432        CONTINUE
  9433     ELSE
  9434        GO TO 0400-FIND-STATE-RECORD
  9435     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 173
* EL050.cbl
  9436     MOVE SPACES                 TO WS-CLP-STATE
  9437     MOVE +0                     TO WS-BANK-FEE
  9438                                    WS-BANK-LFEE
  9439                                    WS-BANK-NOCHRGB
  9440
  9441     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9442     IF (PB-ISSUE)
  9443        AND (PB-I-BANK-NUMBER NOT =
  9444            SPACES AND ZEROS AND LOW-VALUES)
  9445        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9446     ELSE
  9447        IF (PB-CANCELLATION)
  9448           AND (PB-CI-BANK-NUMBER NOT =
  9449                SPACES AND ZEROS AND LOW-VALUES)
  9450           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9451        END-IF
  9452     END-IF
  9453     IF COMP-FIN-RESP NOT = LOW-VALUES
  9454        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9455        MOVE PB-CARRIER          TO COMP-CARRIER
  9456        MOVE PB-GROUPING         TO COMP-GROUPING
  9457        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9458        MOVE 'B'                 TO COMP-TYPE
  9459        PERFORM 8582-READ-COMPENSATION-MASTER
  9460                                 THRU 8582-EXIT
  9461        IF COMP-MASTER-FOUND
  9462           IF CO-MAX-BANK-FEE NOT NUMERIC
  9463              MOVE +0            TO CO-MAX-BANK-FEE
  9464           END-IF
  9465           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9466              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9467           END-IF
  9468           IF CO-GA-INACTIVE
  9469              MOVE ER-2763       TO WS-ERROR
  9470              PERFORM 9900-ERROR-FORMAT
  9471                                 THRU 9900-EXIT
  9472           END-IF
  9473           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9474              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9475              MOVE ER-2788 TO WS-ERROR
  9476              PERFORM 9900-ERROR-FORMAT
  9477                                 THRU 9900-EXIT
  9478              MOVE +11     TO WS-SUB1
  9479           END-IF
  9480           IF WS-AH-BEN-CATEGORY = 'G'
  9481              MOVE CO-MAX-BANK-FEE
  9482                                 TO WS-BANK-FEE
  9483                                    PB-I-BANK-FEE
  9484           ELSE
  9485              MOVE CO-MAX-BANK-FEE-LEASE
  9486                                 TO WS-BANK-LFEE
  9487                                    PB-I-BANK-FEE
  9488           END-IF
  9489           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9490              AND (WS-AH-REFUND-CALC = 'G'))
  9491                        OR
  9492              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9493              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 174
* EL050.cbl
  9494              CONTINUE
  9495           ELSE
  9496              MOVE ER-2789 TO WS-ERROR
  9497              PERFORM 9900-ERROR-FORMAT
  9498                                 THRU 9900-EXIT
  9499           END-IF
  9500           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9501                                    PB-I-CLP-STATE
  9502           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9503           MOVE CO-CARRIER       TO BXRF-CARRIER
  9504           MOVE CO-GROUPING      TO BXRF-GROUPING
  9505           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9506           MOVE BXRF-MAX-REC-LENGTH
  9507                                 TO BXRF-REC-LENGTH
  9508           PERFORM 8584-READ-BANK-CROSS-REF
  9509                                 THRU 8584-EXIT
  9510           IF BXRF-MASTER-FOUND
  9511              MOVE ' '           TO BANK-ACCT-SW
  9512              MOVE BK-BANK-POINTER-CNT
  9513                                 TO BK-BANK-POINTER-CNT
  9514              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9515                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9516                 OR (BANK-ACCT-FOUND)
  9517                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9518                    AND (BK-AM-EXP-DT (WS-SUB1)
  9519                                 > PB-CERT-EFF-DT)
  9520                    AND (BK-AM-EFF-DT (WS-SUB1)
  9521                                 NOT > PB-CERT-EFF-DT)
  9522                    SET BANK-ACCT-FOUND TO TRUE
  9523                 END-IF
  9524              END-PERFORM
  9525              IF NOT BANK-ACCT-FOUND
  9526                 MOVE ZEROS      TO WS-BANK-FEE
  9527                                    WS-BANK-LFEE
  9528                 MOVE ER-2869    TO WS-ERROR
  9529                 PERFORM 9900-ERROR-FORMAT
  9530                                 THRU 9900-EXIT
  9531              ELSE
  9532                 PERFORM 5000-PROCESS-REPS
  9533                                 THRU 5000-EXIT
  9534                 IF AGENT-MASTER-FOUND
  9535                    MOVE +0      TO WS-BANK-FEE
  9536                                    WS-BANK-LFEE
  9537*                   MOVE AG-SPP-FEES (1)
  9538*                                TO PB-I-BANK-FEE
  9539*                                   WS-BANK-FEE
  9540                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9541                       (WS-SUB1 > +10)
  9542                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9543                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9544                       END-IF
  9545                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9546                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9547                       END-IF
  9548                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9549                          AG-SPP-FEES (WS-SUB1)
  9550                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9551                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 175
* EL050.cbl
  9552                    END-PERFORM
  9553                    IF WS-AH-BEN-CATEGORY = 'G'
  9554                       MOVE WS-BANK-FEE
  9555                                 TO PB-I-BANK-FEE
  9556                    ELSE
  9557                       MOVE WS-BANK-LFEE
  9558                                 TO PB-I-BANK-FEE
  9559                    END-IF
  9560                 END-IF
  9561              END-IF
  9562           END-IF
  9563        ELSE
  9564           MOVE ER-2879          TO WS-ERROR
  9565           PERFORM 9900-ERROR-FORMAT
  9566                                 THRU 9900-EXIT
  9567        END-IF
  9568     ELSE
  9569        MOVE ER-2879             TO WS-ERROR
  9570        PERFORM 9900-ERROR-FORMAT
  9571                                 THRU 9900-EXIT
  9572     END-IF
  9573     IF WS-AH-BEN-CATEGORY = 'G'
  9574        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9575        + WS-BANK-FEE
  9576     ELSE
  9577        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9578        + WS-BANK-LFEE
  9579     END-IF
  9580     .
  9581 0400-FIND-STATE-RECORD.
  9582
  9583     IF WK-STATE-ADDR NOT = ZEROS
  9584         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9585         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9586         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9587         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9588         IF PB-SV-STATE = CF-STATE-CODE
  9589             GO TO 0405-CONTINUE-EDIT
  9590         ELSE
  9591             NEXT SENTENCE
  9592     ELSE
  9593         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9594
  9595     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9596     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9597     MOVE '3'                    TO CNTL-REC-TYPE.
  9598     MOVE +0                     TO CNTL-SEQ-NO.
  9599
  9600     MOVE '3'                    TO RC-SW-2.
  9601     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9602
  9603     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9604        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9605        PB-SV-STATE   NOT = CF-STATE-CODE)
  9606        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9607                                    WS-TOL-AH-CLAIM
  9608                                    WS-MINIMUM-REFUND
  9609                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 176
* EL050.cbl
  9610                                    WS-TOL-AH-PREM
  9611                                    WS-TOL-LF-REFUND
  9612                                    WS-TOL-AH-REFUND
  9613                                    EC-ST-TOL-PREM-PCT
  9614                                    WS-TOL-LF-PREM-PCT
  9615                                    WS-TOL-AH-PREM-PCT
  9616                                    EC-ST-TOL-REFUND-PCT
  9617                                    WS-TOL-LF-REFUND-PCT
  9618                                    WS-TOL-AH-REFUND-PCT
  9619                                    EC-ST-TOL-PREM
  9620                                    EC-ST-TOL-REFUND
  9621                                    EC-ST-FST-PMT-DAYS-MAX
  9622                                    WS-FREE-LOOK-PERIOD
  9623                                    WS-ST-LF-PREM-TAX
  9624                                    WS-ST-AH-PREM-TAX-I
  9625                                    WS-ST-AH-PREM-TAX-G
  9626                                    WS-BANK-FEE
  9627                                    WS-BANK-LFEE
  9628                                    WS-TOL-CLP-PCT
  9629                                    WS-SPP-LEASE-COMM
  9630        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9631                                    EC-ST-FST-PMT-DAYS-CHG
  9632                                    WS-LF-REM-TERM-CALC
  9633                                    WS-LF-REFUND-CALC
  9634                                    EC-ST-LF-REM-TERM-CALC
  9635                                    EC-ST-LF-REFUND-CALC
  9636                                    WS-AH-REM-TERM-CALC
  9637                                    WS-AH-REFUND-CALC
  9638                                    WS-LF-BEN-CATEGORY
  9639                                    WS-AH-BEN-CATEGORY
  9640                                    WS-CLP-STATE
  9641                                    WS-ST-REFUND-CLAIM-FLAG
  9642                                    EC-ST-AH-REM-TERM-CALC
  9643                                    EC-ST-AH-REFUND-CALC
  9644          GO TO 0499-STATE-NOT-FOUND.
  9645
  9646     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9647
  9648 0405-CONTINUE-EDIT.
  9649
  9650     if pb-company-id = 'AHL'
  9651        continue
  9652     else
  9653        IF PB-CERT-PRIME NOT NUMERIC
  9654           MOVE ER-2722          TO WS-ERROR
  9655           PERFORM 9900-ERROR-FORMAT
  9656                                 THRU 9900-EXIT
  9657        end-if
  9658     END-IF
  9659*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9660*       MOVE +0                  TO SUB3
  9661*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9662*       IF SUB3 > +0
  9663*          MOVE ER-2722          TO WS-ERROR
  9664*          PERFORM 9900-ERROR-FORMAT
  9665*                                THRU 9900-EXIT
  9666*       END-IF
  9667*    END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 177
* EL050.cbl
  9668*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9669*       IF PB-CERT-PRIME NOT NUMERIC
  9670*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9671*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9672*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9673*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9674*
  9675*          MOVE ER-2722          TO WS-ERROR
  9676*          PERFORM 9900-ERROR-FORMAT
  9677*                                THRU 9900-EXIT
  9678*       END-IF
  9679*    END-IF
  9680
  9681     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9682
  9683     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9684        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9685                                    WS-TOL-AH-CLAIM.
  9686
  9687     IF CF-ST-REFUND-MIN NOT NUMERIC
  9688        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9689
  9690     IF CF-ST-REFUND-MIN NOT = ZEROS
  9691        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9692
  9693     IF CF-ST-TOL-PREM  NOT = ZEROS
  9694        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9695                                    WS-TOL-AH-PREM
  9696        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9697
  9698     IF CF-ST-TOL-REFUND NOT = ZEROS
  9699        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9700                                    WS-TOL-AH-REFUND
  9701        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9702
  9703     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9704        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9705        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9706                                    WS-AH-REFUND-OVS-AMT
  9707                                    EC-ST-OVR-SHT-AMT.
  9708
  9709     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9710        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9711        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9712                                    WS-TOL-LF-PREM-PCT
  9713                                    WS-TOL-AH-PREM-PCT.
  9714
  9715     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9716        CF-ST-TOL-REF-PCT GREATER THAN +0
  9717        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9718                                    WS-TOL-LF-REFUND-PCT
  9719                                    WS-TOL-AH-REFUND-PCT.
  9720
  9721     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9722        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9723        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9724                                    WS-AH-REFUND-OVS-PCT
  9725                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 178
* EL050.cbl
  9726
  9727     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9728     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9729
  9730     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9731          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9732
  9733     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9734     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9735     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9736
  9737     IF CF-ST-LF-PREM-TAX NUMERIC
  9738        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9739     END-IF
  9740     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9741        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9742     END-IF
  9743     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9744        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9745     END-IF
  9746
  9747     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9748         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9749     END-IF.
  9750
  9751     IF WS-LF-BENEFIT-CD = ZEROS
  9752        GO TO 0410-CHECK-AH.
  9753
  9754     IF CF-ST-RT-CALC NOT = SPACES
  9755        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9756                                    EC-ST-LF-REM-TERM-CALC
  9757     END-IF
  9758
  9759     IF WS-LF-COVERAGE-TYPE = 'R'
  9760        IF WS-LF-EARNINGS-CALC = '5'
  9761           IF CF-ST-RF-LN-CALC > '0'
  9762              MOVE CF-ST-RF-LN-CALC
  9763                                 TO WS-LF-REFUND-CALC
  9764                                    EC-ST-LF-REFUND-CALC
  9765           END-IF
  9766        ELSE
  9767           IF CF-ST-RF-LR-CALC > '0'
  9768              MOVE CF-ST-RF-LR-CALC
  9769                                 TO WS-LF-REFUND-CALC
  9770                                    EC-ST-LF-REFUND-CALC
  9771           END-IF
  9772        END-IF
  9773     ELSE
  9774        IF CF-ST-RF-LL-CALC > '0'
  9775           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9776                                    EC-ST-LF-REFUND-CALC
  9777        END-IF
  9778     END-IF
  9779
  9780     IF CF-ST-RT-CALC NOT = SPACES
  9781        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9782                                    EC-ST-LF-REM-TERM-CALC
  9783     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 179
* EL050.cbl
  9784
  9785     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9786     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9787
  9788     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9789
  9790     IF NO-BENEFIT-FOUND
  9791        GO TO 0410-CHECK-AH.
  9792
  9793     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9794        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9795                                 TO EC-ST-LF-REM-TERM-CALC
  9796                                    WS-LF-REM-TERM-CALC
  9797     END-IF
  9798
  9799     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9800        MOVE CF-ST-REFUND-CALC (SUB3)
  9801                                 TO WS-LF-REFUND-CALC
  9802                                    EC-ST-LF-REFUND-CALC
  9803     END-IF
  9804*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9805
  9806     .
  9807 0410-CHECK-AH.
  9808
  9809     IF WS-AH-BENEFIT-CD = ZEROS
  9810        GO TO 0500-SET-ACCOUNT.
  9811
  9812     IF CF-ST-RT-CALC NOT = SPACES
  9813        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9814                                    EC-ST-AH-REM-TERM-CALC
  9815     END-IF
  9816
  9817     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9818        IF CF-ST-RF-CP-CALC > '0'
  9819           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9820                                    EC-ST-AH-REFUND-CALC
  9821        END-IF
  9822     ELSE
  9823        IF CF-ST-RF-AH-CALC > '0'
  9824           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9825                                    EC-ST-AH-REFUND-CALC
  9826        END-IF
  9827     END-IF
  9828     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9829     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9830
  9831     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9832
  9833     IF NO-BENEFIT-FOUND
  9834        GO TO 0500-SET-ACCOUNT.
  9835
  9836     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9837        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9838                                 TO WS-AH-REM-TERM-CALC
  9839                                    EC-ST-AH-REM-TERM-CALC
  9840     END-IF
  9841
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 180
* EL050.cbl
  9842     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9843        MOVE CF-ST-REFUND-CALC (SUB3)
  9844                                 TO WS-AH-REFUND-CALC
  9845                                    EC-ST-AH-REFUND-CALC
  9846     END-IF
  9847
  9848*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9849
  9850     GO TO 0500-SET-ACCOUNT.
  9851
  9852 0499-STATE-NOT-FOUND.
  9853
  9854     MOVE ER-2603                TO WS-ERROR.
  9855     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9856
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 181
* EL050.cbl
  9858
  9859 0500-SET-ACCOUNT.
  9860*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9861     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9862        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9863        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9864        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9865        MOVE '3'                 TO CNTL-REC-TYPE
  9866        MOVE +0                  TO CNTL-SEQ-NO
  9867
  9868        MOVE '3'                 TO RC-SW-2
  9869        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9870
  9871        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9872           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9873           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9874           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9875                                    WS-ST-AH-PREM-TAX-I
  9876                                    WS-ST-AH-PREM-TAX-G
  9877        ELSE
  9878           IF CF-ST-LF-PREM-TAX NUMERIC
  9879              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9880           END-IF
  9881           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9882              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9883           END-IF
  9884           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9885              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9886           END-IF
  9887        END-IF
  9888        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9889     END-IF
  9890*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9891*  FOR DCC ONLY
  9892     IF PB-COMPANY-ID = 'DCC'
  9893
  9894     MOVE ' '                    TO STAT-MASTER-SW
  9895     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9896     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9897     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9898     MOVE PB-STATE               TO ELSTAT-STATE
  9899     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9900        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9901     END-IF
  9902
  9903     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9904     SET BIN-TO-GREG             TO TRUE
  9905     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9906     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9907     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9908
  9909     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9910     IF STAT-MASTER-FOUND
  9911        MOVE 'N'                 TO STAT-MASTER-SW
  9912        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9913        IF STAT-MASTER-FOUND
  9914           IF (ELSTAT-KEY-SAVE (1:12) =
  9915                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 182
* EL050.cbl
  9916              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9917                 MOVE 'F'        TO STAT-MASTER-SW
  9918              ELSE
  9919                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9920                 IF (STAT-MASTER-FOUND)
  9921                    AND (ELSTAT-KEY-SAVE (1:12) =
  9922                        SF-CONTROL-PRIMARY (1:12))
  9923                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9924                    MOVE 'F'     TO STAT-MASTER-SW
  9925                 END-IF
  9926              END-IF
  9927           END-IF
  9928        END-IF
  9929     END-IF
  9930
  9931     IF STAT-MASTER-SW = 'F'
  9932        IF SF-ST-LF-PREM-TAX NUMERIC
  9933           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9934        END-IF
  9935        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9936           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9937        END-IF
  9938        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9939           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9940        END-IF
  9941     END-IF
  9942
  9943     END-IF
  9944     IF (PB-COMPANY-ID = 'DCC')
  9945        AND (PB-ISSUE)
  9946        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9947        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9948        AND (AM-GPCD = 06)
  9949        MOVE 'Y'                 TO WS-GOOD-HIN
  9950        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9951           MOVE PB-I-VIN         TO WS-WORK-VIN
  9952           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9953              (V1 > 16)
  9954              IF WS-WORK-VIN (V1:1) NUMERIC
  9955                 MOVE WS-WORK-VIN-N (V1)
  9956                                 TO WS-ROW-B-VAL (V1)
  9957              ELSE
  9958                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9959                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9960                    OR (V2 > 26)
  9961                 END-PERFORM
  9962                 IF V2 < 27
  9963                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9964                 ELSE
  9965                    MOVE 'N'     TO WS-GOOD-HIN
  9966                 END-IF
  9967              END-IF
  9968              COMPUTE WS-ROW-D-VAL (V1) =
  9969                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9970              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9971                 WS-ROW-D-VAL (V1)
  9972           END-PERFORM
  9973           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 183
* EL050.cbl
  9974           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9975             REMAINDER WS-VIN-REMAINDER
  9976           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9977              CONTINUE
  9978           ELSE
  9979              MOVE 'N'           TO WS-GOOD-HIN
  9980           END-IF
  9981        ELSE
  9982           MOVE 'N'              TO WS-GOOD-HIN
  9983        END-IF
  9984        IF WS-GOOD-HIN NOT = 'Y'
  9985           MOVE ER-3826           TO WS-ERROR
  9986           PERFORM 9900-ERROR-FORMAT
  9987                                 THRU 9900-EXIT
  9988        END-IF
  9989     END-IF
  9990     IF (PB-COMPANY-ID = 'DCC')
  9991        AND (PB-ISSUE)
  9992        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9993        AND (AM-GPCD NOT = 06)
  9994        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9995          MOVE PB-I-VIN          TO WS-WORK-VIN
  9996          MOVE +8                TO V2
  9997          MOVE ZEROS             TO WS-VIN-TOTAL
  9998          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9999           (V1 > 17)
 10000             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 10001                MOVE ER-3825     TO WS-ERROR
 10002                PERFORM 9900-ERROR-FORMAT
 10003                                 THRU 9900-EXIT
 10004             ELSE
 10005                IF V1 = 8
 10006                   MOVE 10       TO V2
 10007                END-IF
 10008                IF V1 = 9
 10009                   MOVE 0        TO V2
 10010                END-IF
 10011                IF V1 = 10
 10012                   MOVE 9        TO V2
 10013                END-IF
 10014                IF WS-WORK-VIN (V1:1) NUMERIC
 10015                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10016                    + (WS-WORK-VIN-N (V1) * V2)
 10017                ELSE
 10018                   MOVE WS-WORK-VIN (V1:1)
 10019                                 TO WS-HEX-BYTE
 10020                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 10021                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10022                    + (WS-NUM (V3) * V2)
 10023                END-IF
 10024                COMPUTE V2 = V2 - 1
 10025             END-IF
 10026          END-PERFORM
 10027          MOVE ZEROS TO WS-VIN-REMAINDER
 10028          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 10029             REMAINDER WS-VIN-REMAINDER
 10030          IF ((WS-WORK-VIN (9:1) = 'X')
 10031             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 184
* EL050.cbl
 10032                     OR
 10033             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10034             CONTINUE
 10035          ELSE
 10036             MOVE ER-3826        TO WS-ERROR
 10037             PERFORM 9900-ERROR-FORMAT
 10038                                 THRU 9900-EXIT
 10039          END-IF
 10040        ELSE
 10041          MOVE ER-3826           TO WS-ERROR
 10042          PERFORM 9900-ERROR-FORMAT
 10043                                 THRU 9900-EXIT
 10044        END-IF
 10045     END-IF
 10046******************************************************************
 10047******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10048******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10049******* METHODS.
 10050******************************************************************
 10051     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10052        IF PB-CANCELLATION
 10053           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10054              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10055                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10056                IF FORM-MASTER-FOUND
 10057                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10058******************************************************************
 10059
 10060     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10061     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10062
 10063     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10064     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10065     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10066     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10067
 10068
 10069     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10070     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10071     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10072
 10073     IF AM-LF-OB-RATE NOT NUMERIC
 10074         MOVE ZERO               TO AM-LF-OB-RATE.
 10075
 10076     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10077         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10078
 10079     IF AM-AH-OB-RATE NOT NUMERIC
 10080         MOVE ZERO               TO AM-AH-OB-RATE.
 10081
 10082     IF WS-LF-JOINT-INDICATOR = 'J'
 10083         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10084     ELSE
 10085         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10086
 10087     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10088
 10089     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 185
* EL050.cbl
 10090         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10091
 10092     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10093         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10094                                       WS-IG-OVRD
 10095     ELSE
 10096         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10097             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10098                                       WS-IG-OVRD
 10099         ELSE
 10100             MOVE AM-IG             TO WS-IG-OVRD-AH
 10101                                       WS-IG-OVRD.
 10102
 10103     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10104         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10105                                       WS-IG-OVRD
 10106     ELSE
 10107         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10108             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10109                                       WS-IG-OVRD
 10110         ELSE
 10111             MOVE AM-IG             TO WS-IG-OVRD-LF
 10112                                       WS-IG-OVRD.
 10113
 10114     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10115     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10116     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10117     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10118     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10119
 10120     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10121     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10122     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10123     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10124
 10125     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10126     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10127     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10128     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10129     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10130     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10131     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10132
 10133     IF WS-ACCT-AH-DEV-PCT > +0
 10134        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10135     ELSE
 10136        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10137
 10138     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10139        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10140     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10141        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10142
 10143        IF AM-EARN-METHOD-L = 'S'
 10144            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10145                                        WS-LF-REFUND-CALC.
 10146
 10147        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 186
* EL050.cbl
 10148            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10149                                        WS-LF-REFUND-CALC.
 10150
 10151     IF WS-LF-COVERAGE-TYPE = 'R'
 10152         IF AM-EARN-METHOD-R = 'R'
 10153            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10154                                    WS-LF-REFUND-CALC.
 10155     IF WS-LF-COVERAGE-TYPE = 'R'
 10156         IF AM-EARN-METHOD-R = 'P'
 10157            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10158                                    WS-LF-REFUND-CALC.
 10159     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10160         IF AM-EARN-METHOD-L = 'R'
 10161            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10162                                    WS-LF-REFUND-CALC.
 10163     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10164         IF AM-EARN-METHOD-L = 'P'
 10165            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10166                                    WS-LF-REFUND-CALC.
 10167     IF WS-LF-COVERAGE-TYPE = 'R'
 10168         IF AM-EARN-METHOD-R = 'A'
 10169            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10170                                    WS-LF-REFUND-CALC.
 10171     IF WS-LF-COVERAGE-TYPE = 'R'
 10172         IF AM-EARN-METHOD-R = 'M'
 10173            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10174                                    WS-LF-REFUND-CALC.
 10175     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10176         IF AM-EARN-METHOD-L = 'A'
 10177            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10178                                    WS-LF-REFUND-CALC.
 10179     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10180         IF AM-EARN-METHOD-L = 'M'
 10181            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10182                                    WS-LF-REFUND-CALC.
 10183
 10184     IF AM-EARN-METHOD-A = 'R'
 10185        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10186                                    WS-AH-REFUND-CALC.
 10187     IF AM-EARN-METHOD-A = 'P'
 10188        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10189                                    WS-AH-REFUND-CALC.
 10190     IF AM-EARN-METHOD-A = 'C'
 10191        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10192                                    WS-AH-REFUND-CALC.
 10193     IF AM-EARN-METHOD-A = 'A'
 10194        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10195                                    WS-AH-REFUND-CALC.
 10196     IF AM-EARN-METHOD-A = 'M'
 10197        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10198                                    WS-AH-REFUND-CALC.
 10199     IF AM-EARN-METHOD-A = 'N'
 10200        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10201                                    WS-AH-REFUND-CALC.
 10202     IF AM-EARN-METHOD-A = 'S'
 10203        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10204                                    WS-AH-REFUND-CALC.
 10205
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 187
* EL050.cbl
 10206     IF AM-TOL-PREM NOT = ZEROS
 10207        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10208                                    WS-TOL-AH-PREM.
 10209
 10210     IF AM-OVR-SHT-AMT NUMERIC AND
 10211                  AM-OVR-SHT-AMT > 0
 10212        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10213                                    EC-AM-LF-OVR-SHT-AMT
 10214                                    WS-AH-REFUND-OVS-AMT
 10215                                    EC-AM-AH-OVR-SHT-AMT.
 10216
 10217     IF AM-OVR-SHT-PCT NUMERIC AND
 10218                    AM-OVR-SHT-PCT > 0
 10219        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10220                                    EC-AM-LF-OVR-SHT-PCT
 10221                                    WS-AH-REFUND-OVS-PCT
 10222                                    EC-AM-AH-OVR-SHT-PCT.
 10223
 10224     IF AM-TOL-REF-PCT NUMERIC AND
 10225                  AM-TOL-REF-PCT > 0
 10226        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10227                                    WS-TOL-AH-REFUND-PCT.
 10228
 10229     IF AM-TOL-REF  NOT = ZEROS  AND
 10230                  AM-TOL-REF NUMERIC
 10231        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10232                                    EC-AM-LF-TOL-REFUND
 10233                                    WS-TOL-AH-REFUND
 10234                                    EC-AM-AH-TOL-REFUND.
 10235
 10236     IF AM-TOL-CLM  NOT = ZEROS
 10237        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10238                                    WS-TOL-AH-CLAIM.
 10239
 10240     IF AM-CLP-TOL-PCT NOT NUMERIC
 10241        MOVE +0                  TO AM-CLP-TOL-PCT
 10242     END-IF
 10243
 10244     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10245        MOVE +0                  TO AM-SPP-LEASE-COMM
 10246     END-IF
 10247     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10248        MOVE WS-PL-TOL-LF-PREM-PCT
 10249                                 TO WS-TOL-LF-PREM-PCT.
 10250
 10251     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10252        MOVE WS-PL-TOL-AH-PREM-PCT
 10253                                 TO WS-TOL-AH-PREM-PCT.
 10254
 10255     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10256        MOVE WS-PL-TOL-LF-REFUND-PCT
 10257                                 TO WS-TOL-LF-REFUND-PCT.
 10258
 10259     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10260        MOVE WS-PL-TOL-AH-REFUND-PCT
 10261                                 TO WS-TOL-AH-REFUND-PCT.
 10262
 10263     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 188
* EL050.cbl
 10264        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10265
 10266     IF WS-PL-REF-OVS-PCT > +0
 10267        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10268
 10269     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10270        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10271     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10272        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10273     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10274        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10275     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10276        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10277     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10278        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10279     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10280        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10281
 10282     IF WS-AH-PL-REF-OVS-AMT > +0
 10283        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10284
 10285     IF WS-AH-PL-REF-OVS-PCT > +0
 10286        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10287
 10288     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10289     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10290
 10291     IF PB-CANCELLATION
 10292        GO TO 3000-CONTINUE-EDIT.
 10293
 10294     MOVE +1 TO SUB1.
 10295     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10296     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10297
 10298     IF CF-COMPANY-ID = 'DMD'
 10299       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10300         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10301        ELSE
 10302         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10303
 10304  0525-FIND-ACCT-COMM.
 10305     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10306        NEXT SENTENCE
 10307      ELSE
 10308         ADD +1 TO SUB1
 10309         IF SUB1 LESS +11
 10310            GO TO 0525-FIND-ACCT-COMM
 10311          ELSE
 10312             GO TO 0560-EDIT-CONTINUE.
 10313
 10314     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10315     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10316                                    PB-I-LIFE-COMMISSION.
 10317***  IF PB-COMPANY-ID = 'CRI'
 10318     IF PB-PREM-ACCTNG-ONLY
 10319         GO TO 0560-EDIT-CONTINUE.
 10320
 10321     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 189
* EL050.cbl
 10322     MOVE ' '    TO WS-CTBL-READ-SW.
 10323
 10324
 10325 0530-GET-AH-COMP.
 10326     IF NO-AH-COVERAGE  OR
 10327        NO-AH-BENEFIT-MATCH
 10328           GO TO 0540-NEXT-READ-STEP.
 10329
 10330     IF AM-A-COM (SUB1) NUMERIC
 10331        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10332         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10333         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10334         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10335         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10336     ELSE
 10337          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10338          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10339          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10340          MOVE ZEROS             TO WS-SUB1
 10341                                    WS-COMMISSION
 10342          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10343          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10344          IF WS-COMMISSION > ZEROS
 10345             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10346             GO TO 0540-NEXT-READ-STEP
 10347          END-IF
 10348          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10349          IF CTBL-TABLE-FOUND
 10350             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10351                                        PB-I-AH-TERM
 10352             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10353             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10354             GO TO 0540-NEXT-READ-STEP
 10355          ELSE
 10356             IF FIRST-TIME-THROUGH
 10357                 GO TO 0530-GET-AH-COMP
 10358             ELSE
 10359                 MOVE ER-2609                TO WS-ERROR
 10360                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10361
 10362 0540-NEXT-READ-STEP.
 10363     MOVE '0540' TO CTBL-SW.
 10364     MOVE ' '    TO WS-CTBL-READ-SW.
 10365
 10366 0540-GET-LF-COMP.
 10367     IF NO-LIFE-COVERAGE  OR
 10368        NO-LF-BENEFIT-MATCH
 10369           GO TO 0560-EDIT-CONTINUE.
 10370
 10371     IF WS-LF-JOINT-INDICATOR = 'J'
 10372        IF AM-J-COM (SUB1) NUMERIC
 10373           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10374           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10375           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10376           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10377           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10378        ELSE
 10379           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 190
* EL050.cbl
 10380           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10381           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10382           MOVE ZEROS                TO WS-SUB1
 10383                                        WS-COMMISSION
 10384           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10385           IF WS-COMMISSION > ZEROS
 10386              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10387              GO TO 0560-EDIT-CONTINUE
 10388           END-IF
 10389           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10390           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10391           IF CTBL-TABLE-FOUND
 10392              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10393              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10394              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10395              GO TO 0560-EDIT-CONTINUE
 10396           ELSE
 10397              IF FIRST-TIME-THROUGH
 10398                  GO TO 0540-GET-LF-COMP
 10399              ELSE
 10400                  MOVE ER-2609                TO WS-ERROR
 10401                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10402                  GO TO 0560-EDIT-CONTINUE.
 10403
 10404     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10405        IF AM-L-COM (SUB1) NUMERIC
 10406           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10407           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10408           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10409           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10410           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10411        ELSE
 10412           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10413           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10414           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10415           MOVE ZEROS                TO WS-SUB1
 10416                                        WS-COMMISSION
 10417           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10418           IF WS-COMMISSION IS GREATER THAN ZEROS
 10419              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10420              GO TO 0560-EDIT-CONTINUE
 10421           END-IF
 10422           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10423           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10424           IF CTBL-TABLE-FOUND
 10425              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10426              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10427              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10428              GO TO 0560-EDIT-CONTINUE
 10429           ELSE
 10430              IF FIRST-TIME-THROUGH
 10431                  GO TO 0540-GET-LF-COMP
 10432              ELSE
 10433                  MOVE ER-2609                TO WS-ERROR
 10434                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10435
 10436*    GO TO 0560-EDIT-CONTINUE.
 10437
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 191
* EL050.cbl
 10438 0560-EDIT-CONTINUE.
 10439     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10440                                    WS-AH-PMF-COMM
 10441*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10442*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10443     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10444        (SUB1 > +10)
 10445        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10446           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10447           MOVE '0530'           TO CTBL-SW
 10448           MOVE ' '              TO WS-CTBL-READ-SW
 10449           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10450           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10451           MOVE '0540'           TO CTBL-SW
 10452           MOVE ' '              TO WS-CTBL-READ-SW
 10453           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10454        END-IF
 10455     END-PERFORM
 10456     GO TO 0564-EDIT-CONTINUE
 10457     .
 10458 0561-CHECK-AH.
 10459     IF (NO-AH-COVERAGE)
 10460        OR (NO-AH-BENEFIT-MATCH)
 10461        CONTINUE
 10462     ELSE
 10463        IF (AM-A-COM (SUB1) NUMERIC)
 10464           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10465           IF (AM-COM-TYP (SUB1) = 'A')
 10466              AND (WS-AH-PMF-COMM = ZEROS)
 10467              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10468           END-IF
 10469           CONTINUE
 10470        ELSE
 10471           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10472           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10473           MOVE PB-AH-OVERRIDE-L1
 10474                                 TO CTBL-BEN-TYPE
 10475           MOVE ZEROS            TO WS-SUB1
 10476                                    WS-COMMISSION
 10477           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10478           PERFORM 8300-READ-CTBL-TABLE
 10479                                 THRU 8300-EXIT
 10480           IF CTBL-TABLE-FOUND
 10481              IF (AM-COM-TYP (SUB1) = 'A')
 10482                 AND (WS-AH-PMF-COMM = ZEROS)
 10483                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10484                                        PB-I-AH-TERM
 10485                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10486                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10487              END-IF
 10488              CONTINUE
 10489           ELSE
 10490              IF FIRST-TIME-THROUGH
 10491                 GO TO 0561-CHECK-AH
 10492              ELSE
 10493                 MOVE ER-2609    TO WS-ERROR
 10494                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10495              END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 192
* EL050.cbl
 10496           END-IF
 10497        END-IF
 10498     END-IF
 10499     .
 10500 0561-EXIT.
 10501     EXIT.
 10502 0563-CHECK-LF.
 10503     IF (NO-LIFE-COVERAGE)
 10504        OR (NO-LF-BENEFIT-MATCH)
 10505        CONTINUE
 10506     ELSE
 10507        IF WS-LF-JOINT-INDICATOR = 'J'
 10508           IF AM-J-COM (SUB1) NUMERIC
 10509              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10510              IF (AM-COM-TYP (SUB1) = 'A')
 10511                 AND (WS-LF-PMF-COMM = ZEROS)
 10512                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10513              END-IF
 10514              CONTINUE
 10515           ELSE
 10516              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10517              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10518              MOVE PB-LIFE-OVERRIDE-L1
 10519                                 TO CTBL-BEN-TYPE
 10520              MOVE ZEROS         TO WS-SUB1
 10521                                    WS-COMMISSION
 10522              MOVE AM-J-COMA (SUB1)
 10523                                 TO CTBL-TABLE
 10524              PERFORM 8300-READ-CTBL-TABLE
 10525                                 THRU 8300-EXIT
 10526              IF CTBL-TABLE-FOUND
 10527                 IF (AM-COM-TYP (SUB1) = 'A')
 10528                    AND (WS-LF-PMF-COMM = ZEROS)
 10529                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10530                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10531                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10532                 END-IF
 10533                 CONTINUE
 10534              ELSE
 10535                 IF FIRST-TIME-THROUGH
 10536                    GO TO 0563-CHECK-LF
 10537                 ELSE
 10538                    MOVE ER-2609 TO WS-ERROR
 10539                    PERFORM 9900-ERROR-FORMAT
 10540                                 THRU 9900-EXIT
 10541*                   GO TO 0560-EDIT-CONTINUE
 10542                 END-IF
 10543              END-IF
 10544           END-IF
 10545        ELSE
 10546           IF AM-L-COM (SUB1) NUMERIC
 10547              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10548              IF (AM-COM-TYP (SUB1) = 'A')
 10549                 AND (WS-LF-PMF-COMM = ZEROS)
 10550                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10551              END-IF
 10552              CONTINUE
 10553           ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 193
* EL050.cbl
 10554              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10555              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10556              MOVE PB-LIFE-OVERRIDE-L1
 10557                                 TO CTBL-BEN-TYPE
 10558              MOVE ZEROS         TO WS-SUB1
 10559                                    WS-COMMISSION
 10560              MOVE AM-L-COMA (SUB1)
 10561                                 TO CTBL-TABLE
 10562              PERFORM 8300-READ-CTBL-TABLE
 10563                                 THRU 8300-EXIT
 10564              IF CTBL-TABLE-FOUND
 10565                 CONTINUE
 10566              ELSE
 10567                 IF FIRST-TIME-THROUGH
 10568                    GO TO 0563-CHECK-LF
 10569                 ELSE
 10570                    MOVE ER-2609 TO WS-ERROR
 10571                    PERFORM 9900-ERROR-FORMAT
 10572                                 THRU 9900-EXIT
 10573                 END-IF
 10574              END-IF
 10575           END-IF
 10576        END-IF
 10577     END-IF
 10578     .
 10579 0563-EXIT.
 10580     EXIT.
 10581 0564-EDIT-CONTINUE.
 10582
 10583     IF  PB-COMPANY-ID EQUAL 'DMD'
 10584         IF PB-I-NUM-BILLED EQUAL ZEROS
 10585            MOVE ER-8148       TO WS-ERROR
 10586            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10587
 10588*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10589*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10590*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10591*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10592*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10593*         IF NO-CONVERSION-ERROR
 10594*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10595*         ELSE
 10596*             IF PB-COMPANY-ID EQUAL 'HAN'
 10597*                 MOVE ZEROS     TO PB-I-AGE.
 10598     IF PB-I-BIRTHDAY > LOW-VALUES
 10599        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10600        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10601        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10602        PERFORM 8500-DATE-CONVERT
 10603                                 THRU 8500-EXIT
 10604        IF NO-CONVERSION-ERROR
 10605           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10606           IF PB-I-AGE > ZEROS
 10607              IF WS-WORK-AGE NOT = PB-I-AGE
 10608                 MOVE ER-9501    TO WS-ERROR
 10609                 PERFORM 9900-ERROR-FORMAT
 10610                                 THRU 9900-EXIT
 10611              END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 194
* EL050.cbl
 10612           ELSE
 10613              MOVE WS-WORK-AGE   TO PB-I-AGE
 10614           END-IF
 10615        END-IF
 10616     END-IF
 10617     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10618                                   WS-INS-AGE-SET
 10619     IF PB-I-AGE = ZEROS
 10620        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10621           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10622                                   WS-INS-AGE-SET
 10623           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10624
 10625     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10626                                   WS-AH-EDIT-AGE.
 10627
 10628     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10629        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10630        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10631        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10632        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10633        IF NO-CONVERSION-ERROR
 10634           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10635           IF PB-I-JOINT-AGE > 0
 10636              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10637                 MOVE ER-9503    TO WS-ERROR
 10638                 PERFORM 9900-ERROR-FORMAT
 10639                                 THRU 9900-EXIT
 10640              END-IF
 10641           ELSE
 10642              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10643           END-IF
 10644        ELSE
 10645           MOVE ZEROS            TO PB-I-JOINT-AGE
 10646        END-IF
 10647     END-IF
 10648     IF PB-I-JOINT-AGE NOT NUMERIC
 10649        MOVE ZERO               TO PB-I-JOINT-AGE.
 10650
 10651     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10652                                   WS-JNT-AGE-SET
 10653     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10654        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10655           (WS-AH-JOINT-INDICATOR = 'J')
 10656           IF PB-I-JOINT-AGE = ZEROS
 10657               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10658                                          WS-JNT-AGE-SET
 10659               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10660           END-IF
 10661        END-IF
 10662     END-IF
 10663
 10664     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10665     IF WS-LF-JOINT-INDICATOR = 'J'
 10666        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10667        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10668            IF  PB-I-JOINT-AGE = ZERO
 10669                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 195
* EL050.cbl
 10670                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10671            ELSE
 10672                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10673                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10674                    IF PB-COMPANY-ID NOT = 'LBL'
 10675                        MOVE ER-2685    TO WS-ERROR
 10676                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10677
 10678     IF WS-AH-JOINT-INDICATOR = 'J'
 10679        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10680            IF  PB-I-JOINT-AGE = ZERO
 10681                MOVE ER-2686       TO WS-ERROR
 10682                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10683            ELSE
 10684                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10685                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10686                                           WS-EDIT-AGE
 10687                    IF PB-COMPANY-ID NOT = 'LBL'
 10688                        MOVE ER-2685    TO WS-ERROR
 10689                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10690
 10691******************************************************************
 10692*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10693******************************************************************
 10694
 10695     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10696        (WS-AH-SPECIAL-CALC-CD = 'O')
 10697        NEXT SENTENCE
 10698     ELSE
 10699        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10700          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10701           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10702            WS-AH-JOINT-INDICATOR = 'J')  AND
 10703           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10704            MOVE ER-2627             TO WS-ERROR
 10705            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10706
 10707     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10708        (WS-AH-SPECIAL-CALC-CD = 'O')
 10709         NEXT SENTENCE
 10710     ELSE
 10711         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10712            WS-AH-JOINT-INDICATOR = 'J'
 10713             IF PB-I-JOINT-INSURED = SPACES
 10714                 IF PB-COMPANY-ID NOT = 'JAL'
 10715                     MOVE ER-2696    TO WS-ERROR
 10716                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10717
 10718     IF PB-COMPANY-ID NOT = 'BOA'
 10719        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10720           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10721           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10722               PB-I-JOINT-INSURED NOT = SPACES)
 10723                MOVE ER-2691         TO WS-ERROR
 10724                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10725
 10726     IF PB-COMPANY-ID = 'BOA'
 10727        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 196
* EL050.cbl
 10728           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10729            IF PB-I-JOINT-AGE NOT = ZEROS
 10730                MOVE ER-2691         TO WS-ERROR
 10731                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10732
 10733     IF PB-COMPANY-ID = 'CRI'
 10734        IF PB-I-SIG-SW = 'J'
 10735           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10736              WS-AH-JOINT-INDICATOR NOT = 'J'
 10737              MOVE ER-2675       TO WS-ERROR
 10738              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10739
 10740     IF PB-COMPANY-ID = 'CRI'
 10741        IF PB-I-SIG-SW = 'S'
 10742           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10743              WS-AH-JOINT-INDICATOR = 'J'
 10744              MOVE ER-2676       TO WS-ERROR
 10745              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10746
 10747     IF PB-COMPANY-ID = 'CVL'
 10748         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10749            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10750              MOVE ER-2783           TO WS-ERROR
 10751              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10752     IF (WS-LF-JOINT-INDICATOR = 'J')
 10753        AND (WS-AH-JOINT-INDICATOR = 'J')
 10754        AND (PB-I-LF-TERM > 120)
 10755        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10756        MOVE ER-2783             TO WS-ERROR
 10757        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10758     END-IF
 10759     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10760
 10761     IF PB-I-INDV-GRP-OVRD = 'I'
 10762        MOVE ER-2666             TO WS-ERROR
 10763        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10764        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10765
 10766     IF PB-I-INDV-GRP-OVRD = 'G'
 10767        MOVE ER-2666             TO WS-ERROR
 10768        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10769        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10770
 10771     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10772        NEXT SENTENCE
 10773     ELSE
 10774        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10775
 10776     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10777        IF WS-ERROR = ER-2666
 10778           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10779           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10780
 10781     IF PB-COMPANY-ID = 'CID'
 10782        IF PB-STATE = 'UT' OR 'MO'
 10783           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10784                 OR '76' OR '77')
 10785                      OR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 197
* EL050.cbl
 10786               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10787                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10788                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10789                   OR '2K' OR '2L'))
 10790              AND PB-I-INDV-GRP-CD = 'I'
 10791              MOVE ER-2721             TO WS-ERROR
 10792              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10793           END-IF
 10794        END-IF
 10795     END-IF
 10796
 10797     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10798     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10799        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10800     ELSE
 10801        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10802     END-IF
 10803
 10804*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10805*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10806     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10807                                    ACCOUNT-AH-CK-SW.
 10808
 10809     IF PB-REISSUED-CERT       OR
 10810        PB-REIN-ONLY-CERT      OR
 10811        PB-POLICY-IS-DECLINED  OR
 10812        PB-POLICY-IS-VOIDED
 10813*       OR PB-MONTHLY-CERT
 10814         GO TO 3000-CONTINUE-EDIT.
 10815
 10816     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10817        IF WS-EDIT-AGE           > +65
 10818           MOVE ER-2709          TO WS-ERROR
 10819           PERFORM 9900-ERROR-FORMAT
 10820                                 THRU 9900-EXIT
 10821        ELSE
 10822           IF WS-EDIT-AGE        > +55
 10823              MOVE ER-2718       TO WS-ERROR
 10824              PERFORM 9900-ERROR-FORMAT
 10825                                 THRU 9900-EXIT
 10826           END-IF
 10827        END-IF
 10828     IF PB-COMPANY-ID = 'DCC'
 10829        IF WS-EDIT-AGE           > +65
 10830           MOVE ER-2709          TO WS-ERROR
 10831           PERFORM 9900-ERROR-FORMAT
 10832                                 THRU 9900-EXIT
 10833        END-IF
 10834     END-IF
 10835     .
 10836
 10837 0565-LIFE-PLAN-LIMIT-EDITS.
 10838
 10839     IF NOT LF-PLAN-MASTER-FOUND
 10840        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10841                                    EC-AM-LF-MAX-TOT-BEN
 10842        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10843
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 198
* EL050.cbl
 10844     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10845
 10846     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10847         IF PL-LM-AGE (1) = ZEROS
 10848             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10849
 10850     IF NO-LF-BENEFIT-MATCH          OR
 10851        WS-LF-BENEFIT-CD = ZEROS     OR
 10852        WS-LF-SPECIAL-CALC-CD = 'M'
 10853        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10854
 10855     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10856     MOVE +1                     TO SUB2.
 10857
 10858     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10859        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10860           MOVE +5   TO SUB2
 10861           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10862              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10863              (PL-LM-AGE (SUB2) EQUAL +0)
 10864              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10865              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10866
 10867     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10868
 10869     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10870                               + PB-I-LF-ALT-BENEFIT-AMT.
 10871
 10872 0568-CHECK-LIFE-ATT-AGE.
 10873
 10874     IF PL-ATT-AGE NUMERIC AND
 10875        PL-ATT-AGE > +0
 10876        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10877     END-IF
 10878*    IF PL-ATT-AGE NUMERIC AND
 10879*       PL-ATT-AGE > +0
 10880*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10881*       IF PB-I-BIRTHDAY > LOW-VALUES
 10882*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10883*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10884*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10885*          SET BIN-PLUS-ELAPSED  TO TRUE
 10886*          PERFORM 8500-DATE-CONVERT
 10887*                                THRU 8500-EXIT
 10888*          IF NO-CONVERSION-ERROR
 10889*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10890*             MOVE ER-2669       TO WS-ERROR
 10891*             PERFORM 9900-ERROR-FORMAT
 10892*                                THRU 9900-EXIT
 10893*          END-IF
 10894*       ELSE
 10895*          IF WS-ATT-AGE >= PL-ATT-AGE
 10896*             MOVE ER-2669       TO WS-ERROR
 10897*             PERFORM 9900-ERROR-FORMAT
 10898*                                THRU 9900-EXIT
 10899*          END-IF
 10900*       END-IF
 10901*    END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 199
* EL050.cbl
 10902     .
 10903 0570-CHECK-LIFE-LIMITS.
 10904
 10905     IF PB-COMPANY-ID EQUAL 'CRI'
 10906        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10907           IF SUB2 GREATER THAN +4
 10908              MOVE ER-2637 TO WS-ERROR
 10909              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10910              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10911
 10912     IF PB-COMPANY-ID  =  'NCL'
 10913        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10914            SUB2 GREATER THAN +8
 10915             MOVE 'U'         TO PB-BATCH-ENTRY
 10916             MOVE ER-2637     TO WS-ERROR
 10917             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10918             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10919
 10920     IF SUB2 > +8
 10921        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10922           AND (PB-I-SIG-SW = 'Y')
 10923           CONTINUE
 10924        ELSE
 10925           MOVE ER-2637          TO WS-ERROR
 10926           PERFORM 9900-ERROR-FORMAT
 10927                                 THRU 9900-EXIT
 10928        END-IF
 10929        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10930     END-IF
 10931     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10932     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10933     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10934
 10935     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10936        ADD +1  TO SUB2
 10937        GO TO 0570-CHECK-LIFE-LIMITS.
 10938
 10939     IF PB-COMPANY-ID = 'NCL'
 10940         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10941
 10942     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10943        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10944        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10945           AND (PB-I-SIG-SW = 'Y')
 10946           CONTINUE
 10947        ELSE
 10948           MOVE ER-2637          TO WS-ERROR
 10949           PERFORM 9900-ERROR-FORMAT
 10950                                 THRU 9900-EXIT
 10951        END-IF
 10952     END-IF
 10953     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10954
 10955
 10956 0570-CHECK-NCL-LIFE-LIMITS.
 10957
 10958     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10959        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 200
* EL050.cbl
 10960         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10961
 10962     IF APP-CERT-USED
 10963         IF SUB2  LESS THAN  +5
 10964             MOVE +5          TO SUB2
 10965             GO TO 0570-CHECK-LIFE-LIMITS.
 10966
 10967     MOVE ER-2637             TO WS-ERROR.
 10968     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10969
 10970     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10971
 10972 0575-CHECK-NCL-SIG-SWITCH.
 10973
 10974     IF NOT APP-CERT-USED
 10975         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10976
 10977     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10978        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10979        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10980        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10981         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10982
 10983     IF SUB2 GREATER THAN +4
 10984         IF PL-LM-AGE (5) = ZEROS  AND
 10985            PL-LM-AGE (6) = ZEROS  AND
 10986            PL-LM-AGE (7) = ZEROS  AND
 10987            PL-LM-AGE (8) = ZEROS
 10988             MOVE  ER-1927        TO WS-ERROR
 10989             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10990             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10991         ELSE
 10992             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10993                 MOVE  ER-1920    TO WS-ERROR
 10994                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10995
 10996     IF PB-I-SIG-SW  = 'Y'
 10997       IF NOT PB-I-POLICY-ACCEPTED  AND
 10998          NOT PB-I-POLICY-DECLINED
 10999           MOVE 'U'               TO PB-BATCH-ENTRY
 11000           MOVE  ER-1926          TO WS-ERROR
 11001           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11002
 11003
 11004 0580-AH-PLAN-LIMIT-EDITS.
 11005
 11006     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11007        IF PB-I-AH-BENEFIT-AMT > +1250
 11008           MOVE ER-2702          TO WS-ERROR
 11009           PERFORM 9900-ERROR-FORMAT
 11010                                 THRU 9900-EXIT
 11011        END-IF
 11012     END-IF
 11013
 11014     IF (PB-COMPANY-ID = 'DCC')
 11015        AND (PB-MONTHLY-CERT)
 11016        IF PB-I-AH-BENEFIT-AMT > +3000
 11017           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 201
* EL050.cbl
 11018           PERFORM 9900-ERROR-FORMAT
 11019                                 THRU 9900-EXIT
 11020        END-IF
 11021     END-IF
 11022     IF NOT AH-PLAN-MASTER-FOUND
 11023        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11024        GO TO 3000-CONTINUE-EDIT.
 11025
 11026     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11027
 11028     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11029         IF PL-LM-AGE (1) = ZEROS
 11030             GO TO 3000-CONTINUE-EDIT.
 11031
 11032     IF NO-AH-BENEFIT-MATCH          OR
 11033        WS-AH-BENEFIT-CD = ZEROS     OR
 11034        WS-AH-SPECIAL-CALC-CD = 'M'
 11035        GO TO 3000-CONTINUE-EDIT.
 11036
 11037     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11038     MOVE +1                     TO SUB2.
 11039
 11040     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11041        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11042           MOVE +5 TO SUB2
 11043           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11044              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11045              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11046              (PL-LM-AGE (SUB2) EQUAL +0)
 11047              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11048              GO TO 3000-CONTINUE-EDIT.
 11049
 11050     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11051
 11052 0590-CHECK-AH-ATT-AGE.
 11053
 11054     IF PL-ATT-AGE NUMERIC AND
 11055        PL-ATT-AGE GREATER THAN +0
 11056        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11057     END-IF
 11058*       IF WS-ATT-AGE >= PL-ATT-AGE
 11059*          MOVE ER-3054          TO WS-ERROR
 11060*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11061     .
 11062 0597-CHECK-AH-LIMITS.
 11063
 11064     IF PB-COMPANY-ID EQUAL 'CRI'
 11065        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11066           IF SUB2 GREATER THAN +4
 11067              MOVE ER-2638       TO WS-ERROR
 11068              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11069              GO TO 3000-CONTINUE-EDIT.
 11070
 11071     IF PB-COMPANY-ID  =  'NCL'
 11072        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11073            SUB2 GREATER THAN +8
 11074             MOVE 'U'            TO PB-BATCH-ENTRY
 11075             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 202
* EL050.cbl
 11076             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11077             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11078
 11079     IF SUB2 > +8
 11080        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11081           AND (PB-I-SIG-SW = 'Y')
 11082           CONTINUE
 11083        ELSE
 11084           MOVE ER-2638          TO WS-ERROR
 11085           PERFORM 9900-ERROR-FORMAT
 11086                                 THRU 9900-EXIT
 11087        END-IF
 11088        GO TO 3000-CONTINUE-EDIT
 11089     END-IF
 11090
 11091     IF PB-COMPANY-ID = 'CRI'
 11092        IF WS-ERROR = ER-2638
 11093           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11094
 11095     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11096     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11097     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11098     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11099
 11100     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11101        ADD +1                   TO SUB2
 11102        GO TO 0597-CHECK-AH-LIMITS.
 11103
 11104     IF PB-COMPANY-ID = 'NCL'
 11105         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11106
 11107     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11108        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11109        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11110                                 > PL-LM-AMT (SUB2))
 11111        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11112           AND (PB-I-SIG-SW = 'Y')
 11113           CONTINUE
 11114        ELSE
 11115           MOVE ER-2638          TO WS-ERROR
 11116           PERFORM 9900-ERROR-FORMAT
 11117                                 THRU 9900-EXIT
 11118        END-IF
 11119     END-IF
 11120
 11121     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11122         IF  WS-ERROR    EQUAL    ER-2638
 11123             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11124                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11125                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11126                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11127                MOVE  ER-1910    TO  WS-ERROR
 11128                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11129
 11130     IF PB-COMPANY-ID = 'CRI'
 11131        IF WS-ERROR = ER-2638
 11132            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11133            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 203
* EL050.cbl
 11134            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11135
 11136     GO TO 3000-CONTINUE-EDIT.
 11137
 11138 0597-CHECK-NCL-AH-LIMITS.
 11139
 11140     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11141        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11142        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11143                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11144         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11145
 11146     IF APP-CERT-USED
 11147         IF SUB2  LESS THAN  +5
 11148             MOVE +5             TO SUB2
 11149             GO TO 0597-CHECK-AH-LIMITS.
 11150
 11151     MOVE ER-2638                TO WS-ERROR.
 11152     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11153
 11154     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11155
 11156 0599-CHECK-NCL-SIG-SWITCH.
 11157
 11158     IF NOT APP-CERT-USED
 11159         GO TO 3000-CONTINUE-EDIT.
 11160
 11161     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11162        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11163        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11164        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11165         GO TO 3000-CONTINUE-EDIT.
 11166
 11167     IF SUB2 GREATER THAN +4
 11168         IF PL-LM-AGE (5) = ZEROS  AND
 11169            PL-LM-AGE (6) = ZEROS  AND
 11170            PL-LM-AGE (7) = ZEROS  AND
 11171            PL-LM-AGE (8) = ZEROS
 11172             MOVE  ER-1927        TO WS-ERROR
 11173             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11174             GO TO 3000-CONTINUE-EDIT
 11175         ELSE
 11176             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11177                 MOVE  ER-1920    TO WS-ERROR
 11178                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11179
 11180     IF PB-I-SIG-SW  = 'Y'
 11181       IF NOT PB-I-POLICY-ACCEPTED  AND
 11182          NOT PB-I-POLICY-DECLINED
 11183           MOVE 'U'               TO PB-BATCH-ENTRY
 11184           MOVE  ER-1926          TO WS-ERROR
 11185           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11186
 11187******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 204
* EL050.cbl
 11189
 11190 3000-CONTINUE-EDIT.
 11191
 11192     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11193     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11194     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11195     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11196     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11197
 11198     IF BROWSE-STARTED
 11199        PERFORM 9990-RETURN THRU 9990-EXIT
 11200        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11201
 11202     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11203        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11204        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11205        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11206*       MOVE 1                   TO DC-OPTION-CODE
 11207        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11208        IF DATE-CONVERSION-ERROR
 11209           MOVE ER-2622          TO WS-ERROR
 11210           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11211        ELSE
 11212           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11213              MOVE ER-2623       TO WS-ERROR
 11214              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11215           ELSE
 11216              MOVE ER-2622       TO WS-ERROR
 11217              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11218
 11219     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11220     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11221     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11222*    MOVE 1                      TO DC-OPTION-CODE.
 11223     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11224     IF DATE-CONVERSION-ERROR
 11225        GO TO 3005-EDIT-CONTINUE
 11226     ELSE
 11227        IF DC-ELAPSED-DAYS GREATER +180
 11228           MOVE ER-2613          TO WS-ERROR
 11229           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11230        ELSE
 11231           IF DC-ELAPSED-DAYS GREATER +90
 11232              MOVE ER-2612       TO WS-ERROR
 11233              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11234           ELSE
 11235             IF DC-ELAPSED-DAYS GREATER +60
 11236                MOVE ER-2614     TO WS-ERROR
 11237                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11238
 11239 3005-EDIT-CONTINUE.
 11240
 11241     IF PB-CANCELLATION
 11242         GO TO 3700-EDIT-CANCEL.
 11243
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 205
* EL050.cbl
 11245******************************************************************
 11246*                  E D I T   I S S U E                           *
 11247******************************************************************
 11248
 11249 3020-EDIT-ISSUE.
 11250
 11251      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11252      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11253      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11254      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11255      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11256
 11257     IF PB-ISSUE-FORCE
 11258        OR PB-ISSUE-DATE-FORCED
 11259        OR PB-FORCE-OFF
 11260        OR PB-OVERCHARGE-FORCE
 11261        CONTINUE
 11262     ELSE
 11263        MOVE ER-2670             TO WS-ERROR
 11264        PERFORM 9900-ERROR-FORMAT
 11265                                 THRU 9900-EXIT
 11266     END-IF
 11267     .
 11268 3022-SET-POLICY-STATUS.
 11269
 11270     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11271
 11272     IF (PB-REISSUED-CERT)
 11273             OR
 11274        ((PB-COMPANY-ID NOT = 'DCC')
 11275         AND (PB-MONTHLY-CERT))
 11276         MOVE '5'                TO PB-I-ENTRY-STATUS
 11277         MOVE 'E'                TO PB-BATCH-ENTRY
 11278     END-IF
 11279
 11280     IF PB-COMPANY-ID = 'DCC'
 11281        IF PB-MONTHLY-CERT
 11282           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11283        END-IF
 11284     END-IF
 11285     IF PB-POLICY-IS-DECLINED
 11286         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11287     IF PB-POLICY-IS-VOIDED
 11288         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11289     IF PB-NEEDS-UNDERWRITING
 11290         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11291     IF PB-REIN-ONLY-CERT
 11292         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11293     IF PB-PREM-ACCTNG-ONLY
 11294         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11295
 11296     MOVE SPACE                  TO PB-I-OB-FLAG.
 11297
 11298     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11299         MOVE ER-2665            TO WS-ERROR
 11300         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11301         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11302
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 206
* EL050.cbl
 11303     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11304        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11305           MOVE 'Z'             TO PB-I-OB-FLAG.
 11306
 11307     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11308        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11309           MOVE 'Z'             TO PB-I-OB-FLAG.
 11310
 11311     IF ACCOUNT-MAST-FOUND
 11312         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11313         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11314         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11315         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11316         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11317         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11318         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11319     END-IF
 11320
 11321     IF ACCOUNT-MAST-FOUND
 11322        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11323         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11324
 11325     IF (ACCOUNT-MAST-FOUND)
 11326        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11327        IF PB-REISSUED-CERT
 11328           CONTINUE
 11329        ELSE
 11330           MOVE ER-2608          TO WS-ERROR
 11331           PERFORM 9900-ERROR-FORMAT
 11332                                 THRU 9900-EXIT
 11333         END-IF
 11334     END-IF
 11335
 11336     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11337        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11338        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11339
 11340**********   DMD CUSTOM CODE FOLLOWS  **********
 11341 3024-EDIT-DMD-FIELDS.
 11342     IF PB-COMPANY-ID NOT = 'DMD'
 11343        GO TO 3025-EDIT-REINSURANCE.
 11344
 11345*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11346*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11347*** ERROR IF THEY ARE NOT EQUAL.
 11348
 11349     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11350     SET BIN-TO-GREG               TO TRUE.
 11351     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11352     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11353**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11354
 11355     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11356     SET BIN-TO-GREG               TO TRUE.
 11357     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11358     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11359**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11360
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 207
* EL050.cbl
 11361     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11362        MOVE ER-8116               TO WS-ERROR
 11363        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11364
 11365     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11366
 11367     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11368                                      WK-FULL-CERT-NO.
 11369     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11370
 11371     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11372
 11373     IF PB-VALID-LIFE
 11374        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11375     ELSE
 11376        IF PB-VALID-AH
 11377          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11378
 11379
 11380     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11381     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11382     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11383                                      DCUA-UNDRWRTR-CODE
 11384                                      DCUA-UNDRWRTR-GROUP-CODE
 11385                                      DCUA-RETURN-CODE.
 11386
 11387****************************************************************
 11388*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11389***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11390***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11391***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11392***   TO THIS RECORD.                                        ***
 11393****************************************************************
 11394     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11395     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11396     IF DCUA-SUCCESSFUL-PROCESS
 11397        GO TO 3024-EDIT-DL7-CONT.
 11398
 11399     IF DCUA-RETURN-CODE EQUAL '01'
 11400        MOVE ER-8110               TO WS-ERROR
 11401        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11402        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11403        GO TO 3024-EDIT-DL7-CONT.
 11404
 11405     IF DCUA-RETURN-CODE EQUAL '02'
 11406        MOVE ER-8111               TO WS-ERROR
 11407        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11408        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11409        GO TO 3024-EDIT-DL7-CONT.
 11410
 11411     IF DCUA-RETURN-CODE EQUAL '03'
 11412        MOVE ER-8074               TO WS-ERROR
 11413        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11414        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11415        GO TO 3024-EDIT-DL7-CONT.
 11416
 11417     IF DCUA-RETURN-CODE EQUAL '04'
 11418        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 208
* EL050.cbl
 11419        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11420        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11421        GO TO 3024-EDIT-DL7-CONT.
 11422
 11423     IF DCUA-RETURN-CODE EQUAL '05'
 11424        MOVE ER-8076               TO WS-ERROR
 11425        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11426        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11427        GO TO 3024-EDIT-DL7-CONT.
 11428
 11429     IF DCUA-RETURN-CODE EQUAL '06'
 11430        MOVE ER-8077               TO WS-ERROR
 11431        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11432        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11433        GO TO 3024-EDIT-DL7-CONT.
 11434
 11435     IF DCUA-RETURN-CODE EQUAL '07'
 11436        MOVE ER-8078               TO WS-ERROR
 11437        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11438        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11439        GO TO 3024-EDIT-DL7-CONT.
 11440
 11441     IF DCUA-RETURN-CODE EQUAL 'E1'
 11442        MOVE ER-8079               TO WS-ERROR
 11443        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11444        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11445        GO TO 3024-EDIT-DL7-CONT.
 11446
 11447     IF DCUA-RETURN-CODE EQUAL 'E2'
 11448        MOVE ER-8080               TO WS-ERROR
 11449        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11450        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11451        GO TO 3024-EDIT-DL7-CONT.
 11452
 11453     IF DCUA-RETURN-CODE EQUAL 'E3'
 11454        MOVE ER-8098               TO WS-ERROR
 11455        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11457        GO TO 3024-EDIT-DL7-CONT.
 11458
 11459     IF DCUA-RETURN-CODE EQUAL 'C1'
 11460        MOVE ER-8099               TO WS-ERROR
 11461        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11462        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11463        GO TO 3024-EDIT-DL7-CONT.
 11464
 11465     IF DCUA-RETURN-CODE EQUAL 'U1'
 11466        MOVE ER-8109               TO WS-ERROR
 11467        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11468        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11469        GO TO 3024-EDIT-DL7-CONT.
 11470
 11471     IF DCUA-RETURN-CODE EQUAL 'N1'
 11472        MOVE ER-8112               TO WS-ERROR
 11473        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11474        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11475        GO TO 3024-EDIT-DL7-CONT.
 11476
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 209
* EL050.cbl
 11477     IF DCUA-RETURN-CODE EQUAL 'N2'
 11478        MOVE ER-8113               TO WS-ERROR
 11479        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11480        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11481        GO TO 3024-EDIT-DL7-CONT.
 11482
 11483     IF DCUA-RETURN-CODE EQUAL 'N3'
 11484        MOVE ER-8114               TO WS-ERROR
 11485        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11486        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11487        GO TO 3024-EDIT-DL7-CONT.
 11488
 11489     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11490     MOVE ER-8097                  TO WS-ERROR.
 11491     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11492     GO TO 3024-EDIT-DL7-CONT.
 11493
 11494 3024-EDIT-DL7-CONT.
 11495
 11496     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11497     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11498     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11499        NEXT SENTENCE
 11500     ELSE
 11501        MOVE ER-9263               TO WS-ERROR
 11502        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11503
 11504******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11505******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11506     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11507        NEXT SENTENCE
 11508     ELSE
 11509        MOVE ER-8039               TO WS-ERROR
 11510        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11511
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 210
* EL050.cbl
 11513****************************************************************
 11514*** VALIDATE STATE  : DLO022                                 ***
 11515****************************************************************
 11516     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11517     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11518
 11519     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11520     IF DVSC-SUCCESSFUL-EDIT
 11521        GO TO 3024-EDIT-DL22-CONT.
 11522
 11523     IF DVSC-RETURN-CODE EQUAL '01'
 11524        MOVE ER-8300               TO WS-ERROR
 11525        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11526        GO TO 3024-EDIT-DL22-CONT.
 11527
 11528     IF DVSC-RETURN-CODE EQUAL '02'
 11529        MOVE ER-8301               TO WS-ERROR
 11530        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11531        GO TO 3024-EDIT-DL22-CONT.
 11532
 11533     IF DVSC-RETURN-CODE EQUAL '03'
 11534        MOVE ER-8302               TO WS-ERROR
 11535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11536        GO TO 3024-EDIT-DL22-CONT.
 11537
 11538     IF DVSC-RETURN-CODE EQUAL 'N1'
 11539        MOVE ER-8304               TO WS-ERROR
 11540        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11541        GO TO 3024-EDIT-DL22-CONT.
 11542
 11543     MOVE ER-8303                  TO WS-ERROR
 11544     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11545
 11546 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 211
* EL050.cbl
 11548****************************************************************
 11549*** VALIDATE LOAN OFFICER : DLO021                           ***
 11550****************************************************************
 11551
 11552     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11553     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11554     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11555     IF DVLO-SUCCESSFUL-EDIT
 11556        GO TO 3024-EDIT-DL21-CONT.
 11557
 11558     IF DVLO-RETURN-CODE EQUAL '01'
 11559        MOVE ER-8081               TO WS-ERROR
 11560        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11561        GO TO 3024-EDIT-DL21-CONT.
 11562
 11563     IF DVLO-RETURN-CODE EQUAL '02'
 11564        MOVE ER-8082               TO WS-ERROR
 11565        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11566        GO TO 3024-EDIT-DL21-CONT.
 11567
 11568     IF DVLO-RETURN-CODE EQUAL '03'
 11569        MOVE ER-8083               TO WS-ERROR
 11570        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11571        GO TO 3024-EDIT-DL21-CONT.
 11572
 11573     IF DVLO-RETURN-CODE EQUAL '04'
 11574        MOVE ER-8084               TO WS-ERROR
 11575        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11576        GO TO 3024-EDIT-DL21-CONT.
 11577
 11578     IF DVLO-RETURN-CODE EQUAL '05'
 11579        MOVE ER-8085               TO WS-ERROR
 11580        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11581        GO TO 3024-EDIT-DL21-CONT.
 11582
 11583     MOVE ER-7825                  TO WS-ERROR
 11584     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11585     GO TO 3024-EDIT-DL21-CONT.
 11586
 11587 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 212
* EL050.cbl
 11589
 11590****************************************************************
 11591*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11592****************************************************************
 11593
 11594     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11595     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11596     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11597     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11598     IF DIPF-SUCCESSFUL-EDIT
 11599        GO TO 3024-EDIT-DL02-CONT.
 11600
 11601     IF DIPF-RETURN-CODE EQUAL '01'
 11602        MOVE ER-8086               TO WS-ERROR
 11603        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11604        GO TO 3024-EDIT-DL02-CONT.
 11605
 11606     IF DIPF-RETURN-CODE EQUAL '02'
 11607        MOVE ER-8087               TO WS-ERROR
 11608        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11609        GO TO 3024-EDIT-DL02-CONT.
 11610
 11611     IF DIPF-RETURN-CODE EQUAL '03'
 11612        MOVE ER-8088               TO WS-ERROR
 11613        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11614        GO TO 3024-EDIT-DL02-CONT.
 11615
 11616     MOVE ER-8095                  TO WS-ERROR
 11617     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11618     GO TO 3024-EDIT-DL02-CONT.
 11619
 11620 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 213
* EL050.cbl
 11622
 11623****************************************************************
 11624*** VALIDATE BANK ID : DLO003                                ***
 11625****************************************************************
 11626
 11627     MOVE WK-GREG-CENT           TO WCG-CENT.
 11628     MOVE WK-GREG-YYMM           TO WCG-REST.
 11629     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11630        MOVE ER-8040               TO WS-ERROR
 11631        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11632
 11633     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11634     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11635     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11636     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11637     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11638     IF DVBI-SUCCESSFUL-EDIT
 11639        GO TO 3024-EDIT-DL03-CONT.
 11640
 11641     IF DVBI-RETURN-CODE EQUAL '01'
 11642        MOVE ER-8089               TO WS-ERROR
 11643        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11644        GO TO 3024-EDIT-DL03-CONT.
 11645
 11646     IF DVBI-RETURN-CODE EQUAL '02'
 11647        MOVE ER-8090               TO WS-ERROR
 11648        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11649        GO TO 3024-EDIT-DL03-CONT.
 11650
 11651     IF DVBI-RETURN-CODE EQUAL '03'
 11652        MOVE ER-8091               TO WS-ERROR
 11653        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11654        GO TO 3024-EDIT-DL03-CONT.
 11655
 11656     IF DVBI-RETURN-CODE EQUAL '04'
 11657        MOVE ER-8092               TO WS-ERROR
 11658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11659        GO TO 3024-EDIT-DL03-CONT.
 11660
 11661     IF DVBI-RETURN-CODE EQUAL '05'
 11662        MOVE ER-8093               TO WS-ERROR
 11663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11664        GO TO 3024-EDIT-DL03-CONT.
 11665
 11666     IF DVBI-RETURN-CODE EQUAL '06'
 11667        MOVE ER-8094               TO WS-ERROR
 11668        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11669        GO TO 3024-EDIT-DL03-CONT.
 11670
 11671     MOVE ER-8096                  TO WS-ERROR
 11672     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11673     GO TO 3024-EDIT-DL03-CONT.
 11674
 11675 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 214
* EL050.cbl
 11677
 11678     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11679        NEXT SENTENCE
 11680     ELSE
 11681        MOVE ER-8042               TO WS-ERROR
 11682        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11683
 11684     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11685     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11686     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11687
 11688     IF DMPF-RETURN-CODE = '01'
 11689        MOVE ER-8067               TO WS-ERROR
 11690        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11691        GO TO 3024-EDIT-DL01-CONT.
 11692
 11693     IF DMPF-RETURN-CODE = '02'
 11694        MOVE ER-8068               TO WS-ERROR
 11695        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11696        GO TO 3024-EDIT-DL01-CONT.
 11697
 11698     IF DMPF-RETURN-CODE = '03'
 11699        MOVE ER-8069               TO WS-ERROR
 11700        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11701        GO TO 3024-EDIT-DL01-CONT.
 11702
 11703     IF DMPF-RETURN-CODE = 'E1'
 11704        MOVE ER-8070               TO WS-ERROR
 11705        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11706        GO TO 3024-EDIT-DL01-CONT.
 11707
 11708     IF DMPF-RETURN-CODE = 'N1'
 11709        MOVE ER-8071               TO WS-ERROR
 11710        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11711        GO TO 3024-EDIT-DL01-CONT.
 11712
 11713     IF DMPF-RETURN-CODE NOT = 'OK'
 11714        MOVE ER-8072               TO WS-ERROR
 11715        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11716
 11717 3024-EDIT-DL01-CONT.
 11718******************************************************************
 11719***  VALIDATES RATE CODES : DLO017                             ***
 11720******************************************************************
 11721
 11722      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11723      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11724      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11725      IF DVRC-SUCCESSFUL-EDIT
 11726        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11727        GO TO 3024-CHECK-VALID-RATE.
 11728
 11729      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11730
 11731      IF DVRC-RETURN-CODE EQUAL '01'
 11732         MOVE ER-7817                   TO WS-ERROR
 11733         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11734         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 215
* EL050.cbl
 11735
 11736      IF DVRC-RETURN-CODE EQUAL '02'
 11737         MOVE ER-7818                   TO WS-ERROR
 11738         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11739         GO TO 3025-EDIT-REINSURANCE.
 11740
 11741      IF DVRC-RETURN-CODE EQUAL '03'
 11742         MOVE ER-7819                   TO WS-ERROR
 11743         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11744         GO TO 3025-EDIT-REINSURANCE.
 11745
 11746       MOVE ER-7820                     TO WS-ERROR.
 11747       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11748       GO TO 3025-EDIT-REINSURANCE.
 11749
 11750******************************************************************
 11751***  GET PREMIUM RATES : DLO011                                ***
 11752******************************************************************
 11753
 11754 3024-CHECK-VALID-RATE.
 11755
 11756     IF VALID-RATE-CODE
 11757        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11758        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11759        MOVE SPACES                TO DPRB-RETURN-CODE
 11760        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11761     ELSE
 11762         GO TO 3025-EDIT-REINSURANCE.
 11763
 11764      IF DPRB-SUCCESSFUL-PROCESS
 11765         IF PB-VALID-LIFE
 11766             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11767             GO TO 3025-EDIT-REINSURANCE
 11768         ELSE
 11769             IF PB-VALID-AH
 11770                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11771                 GO TO 3025-EDIT-REINSURANCE.
 11772
 11773      IF DPRB-RETURN-CODE EQUAL '01'
 11774         MOVE ER-7812                   TO WS-ERROR
 11775         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11776         GO TO 3025-EDIT-REINSURANCE.
 11777
 11778      IF DPRB-RETURN-CODE EQUAL '02'
 11779         MOVE ER-7813                   TO WS-ERROR
 11780         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11781         GO TO 3025-EDIT-REINSURANCE.
 11782
 11783      IF DPRB-RETURN-CODE EQUAL '03'
 11784         MOVE ER-7814                   TO WS-ERROR
 11785         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11786         GO TO 3025-EDIT-REINSURANCE.
 11787
 11788      IF DPRB-RETURN-CODE EQUAL '04'
 11789         IF NOT DPRB-1ST-TIME
 11790            MOVE ER-7815                   TO WS-ERROR
 11791            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11792            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 216
* EL050.cbl
 11793          ELSE
 11794         IF PB-VALID-LIFE
 11795            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11796          ELSE
 11797            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11798         END-IF
 11799         MOVE SPACES                TO DOCC-RETURN-CODE
 11800         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11801         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11802         IF DOCC-RETURN-CODE = 'OK'
 11803             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11804             GO TO 3024-CHECK-VALID-RATE
 11805           ELSE
 11806             MOVE ER-7823               TO WS-ERROR
 11807             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11808             GO TO 3025-EDIT-REINSURANCE.
 11809
 11810       MOVE ER-7816                     TO WS-ERROR.
 11811       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11812       GO TO 3025-EDIT-REINSURANCE.
 11813
 11814**********   DMD CUSTOM CODE ABOVE    **********
 11815
 11816 3025-EDIT-REINSURANCE.
 11817     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11818         GO TO 3027-EDIT-CONTINUE.
 11819
 11820     MOVE LOW-VALUES               TO ERREIN-KEY.
 11821     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11822     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11823                                      REIN-CODE-2
 11824                                      REIN-CODE-3.
 11825     MOVE 'A'                      TO REIN-TYPE.
 11826
 11827     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11828
 11829     MOVE '3026' TO REIN-SW.
 11830     MOVE ' '                   TO WS-REIN-READ-SW.
 11831
 11832     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11833     IF REIN-TABLE-NOT-FOUND
 11834         GO TO 3026-NO-SPEC-TABLE.
 11835
 11836     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11837     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11838                                   WS-NSP-ST-CD-LF.
 11839     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11840                                   WS-NSP-ST-CD-AH.
 11841
 11842     GO TO 3040-EDIT-CONTINUE.
 11843
 11844 3026-NO-SPEC-TABLE.
 11845
 11846     MOVE ER-2664                TO WS-ERROR.
 11847     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11848     GO TO 3040-EDIT-CONTINUE.
 11849
 11850 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 217
* EL050.cbl
 11851
 11852     IF PB-I-REIN-TABLE = SPACES
 11853       GO TO 3040-EDIT-CONTINUE.
 11854
 11855     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11856          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11857          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11858           GO TO 3040-EDIT-CONTINUE.
 11859
 11860     MOVE LOW-VALUES            TO ERREIN-KEY.
 11861     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11862     MOVE 'A'                   TO REIN-TYPE.
 11863     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11864
 11865     MOVE '3028'                TO REIN-SW.
 11866     MOVE ' '                   TO WS-REIN-READ-SW.
 11867
 11868     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11869     IF REIN-TABLE-NOT-FOUND
 11870         GO TO 3028-NO-REIN-TABLE.
 11871
 11872     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11873     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11874                                   WS-NSP-ST-CD-LF.
 11875     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11876                                   WS-NSP-ST-CD-AH.
 11877
 11878     GO TO 3040-EDIT-CONTINUE.
 11879
 11880 3028-NO-REIN-TABLE.
 11881
 11882     MOVE ER-2615                TO WS-ERROR.
 11883     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11884     GO TO 3040-EDIT-CONTINUE.
 11885
 11886 3040-EDIT-CONTINUE.
 11887
 11888     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11889         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11890
 11891     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11892         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11893
 11894     IF (NOT PB-REISSUED-CERT)
 11895        AND (NOT PB-MONTHLY-CERT)
 11896        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11897            MOVE '001'           TO PB-I-LF-TERM
 11898            MOVE 'M'             TO PB-I-INSURED-SEX.
 11899
 11900     IF (NOT PB-REISSUED-CERT)
 11901        AND (NOT PB-MONTHLY-CERT)
 11902        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11903            MOVE '001'           TO PB-I-AH-TERM
 11904            MOVE 'M'             TO PB-I-INSURED-SEX.
 11905
 11906 3040-EDIT-1ST-PMT-DT.
 11907     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11908     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 218
* EL050.cbl
 11909         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11910
 11911******************************************************************
 11912*                                                                *
 11913*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11914*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11915*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11916*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11917*                                                                *
 11918******************************************************************
 11919
 11920     IF PB-EFF-DT-PROCESSING
 11921        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11922                                    PB-I-LF-EXPIRE-DT
 11923                                    PB-I-AH-EXPIRE-DT
 11924        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11925        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11926        MOVE ZERO                TO DC-ELAPSED-DAYS
 11927        MOVE +1                  TO DC-ELAPSED-MONTHS
 11928        SET BIN-PLUS-ELAPSED     TO TRUE
 11929*       MOVE 6                   TO DC-OPTION-CODE
 11930        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11931        IF NO-CONVERSION-ERROR
 11932           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11933
 11934******************************************************************
 11935*                                                                *
 11936*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11937*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11938*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11939*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11940*                                                                *
 11941******************************************************************
 11942
 11943     IF PB-EXT-DAYS-PROCESSING
 11944          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11945                                         PB-I-LF-EXPIRE-DT
 11946                                         PB-I-AH-EXPIRE-DT
 11947          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11948          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11949          MOVE +1                     TO DC-ELAPSED-MONTHS
 11950          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11951          SET BIN-PLUS-ELAPSED        TO TRUE
 11952*         MOVE 6                      TO DC-OPTION-CODE
 11953          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11954          IF NO-CONVERSION-ERROR
 11955             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11956
 11957******************************************************************
 11958*                                                                *
 11959*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11960*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11961*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11962*        (EXPIRE DATE - (TERM -1))  *  -1.
 11963*                                                                *
 11964******************************************************************
 11965
 11966     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 219
* EL050.cbl
 11967        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11968           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11969              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11970              MOVE PB-I-AH-TERM      TO WS-TERM
 11971           ELSE
 11972              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11973              MOVE PB-I-LF-TERM      TO WS-TERM
 11974        ELSE
 11975           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11976              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11977              MOVE PB-I-LF-TERM      TO WS-TERM
 11978           ELSE
 11979              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11980              MOVE PB-I-AH-TERM      TO WS-TERM.
 11981
 11982     IF PB-EXPIRE-DT-PROCESSING
 11983        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11984        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11985        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11986        MOVE ZERO                TO DC-ELAPSED-DAYS
 11987                                    DC-ODD-DAYS-OVER
 11988          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11989          SET BIN-PLUS-ELAPSED    TO TRUE
 11990*         MOVE 6                  TO DC-OPTION-CODE
 11991          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11992          IF NO-CONVERSION-ERROR
 11993             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11994
 11995******************************************************************
 11996*                                                                *
 11997*            1ST PAYMENT DATE PROCESSING                         *
 11998*                                                                *
 11999******************************************************************
 12000
 12001     IF PB-1ST-PMT-DT-PROCESSING
 12002        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12003                                    PB-I-AH-EXPIRE-DT
 12004        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12005
 12006     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12007         NEXT SENTENCE
 12008     ELSE
 12009         MOVE ER-2680                 TO WS-ERROR
 12010         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12011         GO TO 3060-ORIG-TERM-CHECK.
 12012
 12013     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12014     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12015     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12016*    MOVE 1                      TO DC-OPTION-CODE.
 12017     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12018                                    DC-ELAPSED-DAYS
 12019                                    DC-ODD-DAYS-OVER.
 12020
 12021     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12022
 12023     IF DATE-CONVERSION-ERROR
 12024        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 220
* EL050.cbl
 12025
 12026     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12027     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12028        AND (WS-LF-COVERAGE-TYPE = 'L')
 12029        IF (DC-ELAPSED-MONTHS > 1)
 12030                      OR
 12031           ((DC-ELAPSED-MONTHS = 1)
 12032           AND (DC-ODD-DAYS-OVER > 0))
 12033           MOVE ER-2882          TO WS-ERROR
 12034           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12035        END-IF
 12036     END-IF
 12037     if dc-elapsed-months > 0
 12038        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12039        + dc-odd-days-over
 12040     end-if
 12041     IF PB-EXT-DAYS-PROCESSING
 12042        CONTINUE
 12043     ELSE
 12044        IF DC-ELAPSED-MONTHS = +0
 12045           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12046        ELSE
 12047           IF (WS-LF-EARNINGS-CALC = '4')
 12048              AND (DC-ELAPSED-MONTHS > ZERO)
 12049              AND (DC-ELAPSED-DAYS > ZERO)
 12050              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12051           ELSE
 12052              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12053                                 THRU 6499-EXIT
 12054              MOVE WS-ODD-DAYS-OVER
 12055                                 TO PB-I-EXTENTION-DAYS
 12056           END-IF
 12057        END-IF
 12058     END-IF
 12059******************************************************************
 12060*                                                                *
 12061*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12062*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12063*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12064*            AND ANY ODD DAYS.                                   *
 12065*                                                                *
 12066******************************************************************
 12067
 12068     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12069                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12070     IF WS-LF-EARNINGS-CALC NOT = '4'
 12071        IF DC-ELAPSED-DAYS > ZEROS
 12072           MOVE ER-2681          TO WS-ERROR
 12073           PERFORM 9900-ERROR-FORMAT
 12074                                 THRU 9900-EXIT
 12075        END-IF
 12076     END-IF
 12077
 12078     IF WS-LF-EARNINGS-CALC NOT = '4'
 12079        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12080           MOVE ER-2681          TO WS-ERROR
 12081           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12082
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 221
* EL050.cbl
 12083     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12084        (PB-I-LF-TERM NOT = ZERO) AND
 12085         NOT NO-LIFE-COVERAGE
 12086          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12087          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12088          IF WS-LF-EARNINGS-CALC = '4'
 12089             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12090             PB-I-PAY-FREQUENCY
 12091          END-IF
 12092          MOVE ZERO              TO DC-ELAPSED-DAYS
 12093                                    DC-ODD-DAYS-OVER
 12094          MOVE 1                 TO DC-END-OF-MONTH
 12095          SET BIN-PLUS-ELAPSED        TO TRUE
 12096*         MOVE 6                 TO DC-OPTION-CODE
 12097          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12098          IF NO-CONVERSION-ERROR
 12099             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12100             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12101                (WS-LF-SPECIAL-CALC-CD = 'L')
 12102                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12103                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12104                  MOVE +1             TO DC-ELAPSED-MONTHS
 12105                  SET BIN-PLUS-ELAPSED  TO TRUE
 12106*                 MOVE 6              TO DC-OPTION-CODE
 12107                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12108                  IF NO-CONVERSION-ERROR
 12109                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12110
 12111* okay, i had to move the new att age edit down here because the
 12112* expiration date could get recalculated and i need the exp date
 12113     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12114        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12115        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12116        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12117           AND ZEROS
 12118           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12119           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12120           SET ELAPSED-BETWEEN-BIN TO TRUE
 12121           PERFORM 8500-DATE-CONVERT
 12122                                 THRU 8500-EXIT
 12123           IF NO-CONVERSION-ERROR
 12124              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12125                 MOVE ER-2669       TO WS-ERROR
 12126*                PERFORM 9900-ERROR-FORMAT
 12127*                                THRU 9900-EXIT
 12128              END-IF
 12129           END-IF
 12130        ELSE
 12131           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12132           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12133              MOVE ER-2669       TO WS-ERROR
 12134*             PERFORM 9900-ERROR-FORMAT
 12135*                                THRU 9900-EXIT
 12136           ELSE
 12137              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12138                 MOVE ER-1570    TO WS-ERROR
 12139                 PERFORM 9900-ERROR-FORMAT
 12140                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 222
* EL050.cbl
 12141              END-IF
 12142           END-IF
 12143        END-IF
 12144        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12145           AND ZEROS
 12146           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12147           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12148           SET ELAPSED-BETWEEN-BIN TO TRUE
 12149           PERFORM 8500-DATE-CONVERT
 12150                                 THRU 8500-EXIT
 12151           IF NO-CONVERSION-ERROR
 12152              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12153                 MOVE ER-2669       TO WS-ERROR
 12154*                PERFORM 9900-ERROR-FORMAT
 12155*                                THRU 9900-EXIT
 12156              END-IF
 12157           END-IF
 12158        ELSE
 12159           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12160             (PB-I-LF-TERM / 12)
 12161           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12162              MOVE ER-2669       TO WS-ERROR
 12163*             PERFORM 9900-ERROR-FORMAT
 12164*                                THRU 9900-EXIT
 12165           ELSE
 12166              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12167                 MOVE ER-1571    TO WS-ERROR
 12168                 PERFORM 9900-ERROR-FORMAT
 12169                                 THRU 9900-EXIT
 12170              END-IF
 12171           END-IF
 12172        END-IF
 12173        IF WS-ERROR = ER-2669
 12174           PERFORM 9900-ERROR-FORMAT
 12175                                 THRU 9900-EXIT
 12176        END-IF
 12177     END-IF
 12178     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12179        (PB-I-AH-TERM NOT = ZERO) AND
 12180         NOT NO-AH-COVERAGE
 12181          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12182             AND (PB-COMPANY-ID = 'DCC')
 12183             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12184             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12185          ELSE
 12186             IF WS-LF-EARNINGS-CALC = '4'
 12187                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12188                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12189                PB-I-PAY-FREQUENCY
 12190             ELSE
 12191                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12192                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12193             END-IF
 12194          END-IF
 12195          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12196                                         DC-ODD-DAYS-OVER
 12197          MOVE 1                      TO DC-END-OF-MONTH
 12198          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 223
* EL050.cbl
 12199*         MOVE 6                      TO DC-OPTION-CODE
 12200          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12201          IF NO-CONVERSION-ERROR
 12202             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12203     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12204        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12205        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12206        IF PB-I-BIRTHDAY > LOW-VALUES
 12207           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12208           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12209           SET ELAPSED-BETWEEN-BIN TO TRUE
 12210           PERFORM 8500-DATE-CONVERT
 12211                                 THRU 8500-EXIT
 12212           IF NO-CONVERSION-ERROR
 12213              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12214                 MOVE ER-3054       TO WS-ERROR
 12215*                PERFORM 9900-ERROR-FORMAT
 12216*                                THRU 9900-EXIT
 12217              END-IF
 12218           END-IF
 12219        ELSE
 12220           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12221           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12222              MOVE ER-3054       TO WS-ERROR
 12223*             PERFORM 9900-ERROR-FORMAT
 12224*                                THRU 9900-EXIT
 12225           END-IF
 12226        END-IF
 12227        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12228           AND ZEROS
 12229           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12230           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12231           SET ELAPSED-BETWEEN-BIN TO TRUE
 12232           PERFORM 8500-DATE-CONVERT
 12233                                 THRU 8500-EXIT
 12234           IF NO-CONVERSION-ERROR
 12235              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12236                 MOVE ER-3054       TO WS-ERROR
 12237*                PERFORM 9900-ERROR-FORMAT
 12238*                                THRU 9900-EXIT
 12239              END-IF
 12240           END-IF
 12241        ELSE
 12242           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12243             (PB-I-AH-TERM / 12)
 12244           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12245              MOVE ER-3054       TO WS-ERROR
 12246*             PERFORM 9900-ERROR-FORMAT
 12247*                                THRU 9900-EXIT
 12248           END-IF
 12249        END-IF
 12250        IF WS-ERROR = ER-3054
 12251           PERFORM 9900-ERROR-FORMAT
 12252                                 THRU 9900-EXIT
 12253        END-IF
 12254     END-IF
 12255     MOVE SPACE                       TO DC-END-OF-MONTH.
 12256
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 224
* EL050.cbl
 12257     IF PB-COMPANY-ID = 'NCB'
 12258        GO TO 3040-EDIT-EXTENSION-DAYS.
 12259
 12260     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12261       AND
 12262        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12263        NEXT SENTENCE
 12264     ELSE
 12265        GO TO 3040-EDIT-EXTENSION-DAYS.
 12266
 12267     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12268        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12269        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12270     ELSE
 12271        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12272        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12273
 12274     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12275*    MOVE '1'      TO DC-OPTION-CODE
 12276     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12277     IF (NO-CONVERSION-ERROR)
 12278        AND (DC-ELAPSED-MONTHS > +1)
 12279        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12280        MOVE ER-2668   TO WS-ERROR
 12281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12282
 12283 3040-EDIT-EXTENSION-DAYS.
 12284
 12285     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12286        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12287         GO TO 3050-EDIT-TERM-IN-DAYS
 12288     ELSE
 12289         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12290
 12291     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12292         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12293     ELSE
 12294        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12295           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12296           MOVE ER-2681         TO WS-ERROR
 12297           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12298
 12299     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12300        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12301        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12302         GO TO 3060-ORIG-TERM-CHECK.
 12303
 12304     GO TO 3060-ORIG-TERM-CHECK.
 12305
 12306 3050-EDIT-TERM-IN-DAYS.
 12307
 12308     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12309
 12310     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12311         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12312     ELSE
 12313         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12314            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 225
* EL050.cbl
 12315            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12316
 12317     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12318                                       REMAINDER WS-WORK-TERM.
 12319     IF WS-WORK-TERM GREATER THAN ZERO
 12320         ADD +1 TO PB-I-LF-TERM.
 12321
 12322     IF NOT NO-AH-COVERAGE
 12323         MOVE ER-2684            TO WS-ERROR
 12324         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12325
 12326
 12327 3060-ORIG-TERM-CHECK.
 12328
 12329******************************************************************
 12330*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12331******************************************************************
 12332
 12333     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12334        NEXT SENTENCE
 12335     ELSE
 12336        IF NOT NO-LIFE-COVERAGE
 12337           IF PB-I-LF-TERM NUMERIC
 12338              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12339              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12340              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12341                  NEXT SENTENCE
 12342           ELSE
 12343              MOVE ER-2647       TO WS-ERROR
 12344              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12345
 12346     IF NOT NO-AH-COVERAGE
 12347         IF PB-I-AH-TERM NUMERIC
 12348            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12349            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12350            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12351             NEXT SENTENCE
 12352          ELSE
 12353              MOVE ER-2658       TO WS-ERROR
 12354              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12355
 12356     IF PB-COMPANY-ID = 'NCB'
 12357        GO TO 3070-LOAN-TERM-CHECK.
 12358
 12359     IF POLICY-HAS-AH
 12360       AND
 12361        POLICY-HAS-LIFE
 12362       AND
 12363        PB-I-LF-TERM NUMERIC
 12364       AND
 12365        PB-I-AH-TERM NUMERIC
 12366        NEXT SENTENCE
 12367     ELSE
 12368        GO TO 3070-LOAN-TERM-CHECK.
 12369
 12370     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12371     IF WS-TEX-FACT-2 LESS THAN +0
 12372        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 226
* EL050.cbl
 12373
 12374     IF WS-TEX-FACT-2 GREATER THAN +1
 12375        MOVE ER-2668             TO WS-ERROR
 12376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12377
 12378 3070-LOAN-TERM-CHECK.
 12379
 12380     IF (WS-LF-BENEFIT-CD = ZERO)
 12381         OR (NO-LF-BENEFIT-MATCH)
 12382            GO TO 3125-EDIT-PMT-FREQ.
 12383*    IF PB-COMPANY-ID NOT = 'DCC'
 12384*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12385*          AND 'V' AND 'W' AND 'X'
 12386*          GO TO 3125-EDIT-PMT-FREQ
 12387*       END-IF
 12388*    ELSE
 12389*       IF WS-AH-DCC-TRUNC = 'T'
 12390*          CONTINUE
 12391*       ELSE
 12392*          GO TO 3125-EDIT-PMT-FREQ
 12393*       END-IF
 12394*    END-IF
 12395     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12396                    OR
 12397        ((PB-COMPANY-ID = 'DCC')
 12398        AND (WS-AH-DCC-TRUNC = 'T'))
 12399        CONTINUE
 12400     ELSE
 12401        GO TO 3125-EDIT-PMT-FREQ
 12402     END-IF
 12403     IF PB-I-LOAN-TERM NOT NUMERIC
 12404         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12405
 12406     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12407        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12408*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12409        PB-I-LOAN-TERM NOT GREATER THAN +360
 12410         NEXT SENTENCE
 12411     ELSE
 12412         MOVE ER-2648            TO WS-ERROR
 12413         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12414
 12415     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12416        MOVE ER-3058             TO WS-ERROR
 12417        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12418     end-if
 12419
 12420     IF WS-STATE-ABBREVIATION = 'NC'
 12421        IF PB-I-LOAN-TERM > +59
 12422           CONTINUE
 12423        ELSE
 12424           MOVE ER-2792          TO WS-ERROR
 12425           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12426        END-IF
 12427     END-IF
 12428
 12429     .
 12430 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 227
* EL050.cbl
 12431     IF (WS-LF-BENEFIT-CD = ZERO)
 12432         OR (NO-LF-BENEFIT-MATCH)
 12433            GO TO 3127-EDIT-LOAN-OFFICER.
 12434     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12435                    OR
 12436        ((PB-COMPANY-ID = 'DCC')
 12437        AND (WS-AH-DCC-TRUNC = 'T'))
 12438                    OR
 12439         (PB-COMPANY-ID = 'AHL')
 12440        CONTINUE
 12441     ELSE
 12442        IF (PB-I-LOAN-TERM > ZEROS)
 12443           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12444           MOVE ER-1575          TO WS-ERROR
 12445           PERFORM 9900-ERROR-FORMAT
 12446                                 THRU 9900-EXIT
 12447        END-IF
 12448     END-IF
 12449     IF WS-LF-EARNINGS-CALC NOT = '4'
 12450         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12451            MOVE ER-2653         TO WS-ERROR
 12452            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12453            GO TO 3127-EDIT-LOAN-OFFICER
 12454         ELSE
 12455            GO TO 3127-EDIT-LOAN-OFFICER.
 12456
 12457     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12458         MOVE ER-2655            TO WS-ERROR
 12459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12460         GO TO 3127-EDIT-LOAN-OFFICER.
 12461
 12462     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12463         MOVE ER-2654            TO WS-ERROR
 12464         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12465         GO TO 3127-EDIT-LOAN-OFFICER.
 12466
 12467     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12468         GIVING WS-TEX-FACT-2
 12469             REMAINDER WS-TEX-FACT-3.
 12470
 12471*    IF WS-TEX-FACT-3 NOT = ZERO
 12472*       MOVE ER-2654             TO WS-ERROR
 12473*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12474
 12475
 12476 3127-EDIT-LOAN-OFFICER.
 12477
 12478     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12479        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12480           MOVE ER-2690          TO WS-ERROR
 12481           PERFORM 9900-ERROR-FORMAT
 12482                                 THRU 9900-EXIT
 12483        ELSE
 12484           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12485           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12486           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12487           MOVE PB-SV-STATE      TO LOFC-STATE
 12488           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 228
* EL050.cbl
 12489           MOVE PB-I-LOAN-OFFICER
 12490                                 TO LOFC-CODE
 12491           PERFORM 8586-READ-LOAN-OFFICER
 12492                                 THRU 8586-EXIT
 12493           IF (NOT LOFC-MASTER-FOUND)
 12494              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12495              MOVE ER-3006       TO WS-ERROR
 12496              PERFORM 9900-ERROR-FORMAT
 12497                                 THRU 9900-EXIT
 12498           END-IF
 12499        END-IF
 12500     END-IF
 12501     .
 12502 3129-EDIT-APR.
 12503
 12504     IF (WS-LF-BENEFIT-CD = ZERO)
 12505        OR (NO-LF-BENEFIT-MATCH)
 12506        IF PB-COMPANY-ID NOT = 'DCC'
 12507           GO TO 3130-EDIT-AGE
 12508*       ELSE
 12509*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12510*             GO TO 3130-EDIT-AGE
 12511*          END-IF
 12512        END-IF
 12513     END-IF
 12514
 12515     IF (WS-STATE-ABBREVIATION = 'OH')
 12516         AND (PB-I-RATE-CLASS NOT = 'L ')
 12517         AND (PB-I-LF-TERM GREATER THAN 60)
 12518         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12519         GO TO 3129-APR-CONT.
 12520
 12521     IF (WS-STATE-ABBREVIATION = 'RI')
 12522         AND (PB-I-LF-TERM GREATER THAN 60)
 12523         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12524         GO TO 3129-APR-CONT.
 12525
 12526     IF (WS-STATE-ABBREVIATION = 'UT')
 12527         AND (PB-I-LF-TERM GREATER THAN 62)
 12528         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12529         AND (PB-CERT-EFF-DT LESS WS-830901)
 12530         GO TO 3129-APR-CONT.
 12531
 12532     IF PB-COMPANY-ID = 'LAP'
 12533        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12534           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12535              MOVE ER-2656         TO WS-ERROR
 12536              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12537              GO TO 3130-EDIT-AGE.
 12538
 12539     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12540        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12541        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12542        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12543        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12544        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12545         GO TO 3130-EDIT-AGE.
 12546
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 229
* EL050.cbl
 12547 3129-APR-CONT.
 12548     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12549         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12550         GO TO 3130-EDIT-AGE.
 12551
 12552     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12553         WS-AH-BENEFIT-CD (1:1) = 'S')
 12554        AND (PB-COMPANY-ID = 'DCC')
 12555        AND (PB-I-LOAN-APR = ZERO)
 12556        MOVE ER-2657             TO WS-ERROR
 12557        PERFORM 9900-ERROR-FORMAT
 12558                                 THRU 9900-EXIT
 12559        GO TO 3130-EDIT-AGE
 12560     END-IF
 12561*    IF PB-I-LOAN-APR = ZERO
 12562*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12563*    END-IF
 12564
 12565     if pb-i-loan-apr = +99.9999
 12566        move er-2656             to ws-error
 12567        PERFORM 9900-ERROR-FORMAT
 12568                                 THRU 9900-EXIT
 12569        GO TO 3130-EDIT-AGE
 12570     end-if
 12571*    IF PB-I-LOAN-APR = ZERO
 12572*       MOVE ER-2656             TO WS-ERROR
 12573*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12574*       GO TO 3130-EDIT-AGE.
 12575
 12576*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12577     if pb-i-loan-apr not = +99.9999
 12578        IF PB-I-LOAN-APR > +30.000
 12579           MOVE ER-2657          TO WS-ERROR
 12580           PERFORM 9900-ERROR-FORMAT
 12581                                 THRU 9900-EXIT
 12582        end-if
 12583     end-if
 12584     .
 12585 3130-EDIT-AGE.
 12586
 12587******************************************************************
 12588*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12589******************************************************************
 12590
 12591     IF NOT NO-LIFE-COVERAGE
 12592        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12593           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12594               MOVE ER-2628             TO WS-ERROR
 12595               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12596
 12597     IF NOT NO-AH-COVERAGE
 12598        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12599           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12600               MOVE ER-2628         TO WS-ERROR
 12601               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12602
 12603 3133-SEX-CODE.
 12604     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 230
* EL050.cbl
 12605         IF WS-DEFAULT-SEX = 'M'
 12606             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12607          ELSE
 12608             IF WS-DEFAULT-SEX = 'F'
 12609             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12610
 12611     IF PB-I-INSURED-SEX = '1'
 12612         MOVE 'M' TO PB-I-INSURED-SEX.
 12613
 12614     IF PB-I-INSURED-SEX = '2'
 12615         MOVE 'F' TO PB-I-INSURED-SEX.
 12616
 12617 3134-SIG-SW-EDIT.
 12618     IF PB-I-SIG-SW = SPACE
 12619         MOVE 'N'                TO  PB-I-SIG-SW.
 12620
 12621     IF PB-COMPANY-ID = 'NCL'
 12622         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12623             NEXT SENTENCE
 12624         ELSE
 12625             MOVE ER-1923        TO  WS-ERROR
 12626             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12627     ELSE
 12628     IF PB-COMPANY-ID = 'CRI'
 12629         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12630             NEXT SENTENCE
 12631         ELSE
 12632             MOVE ER-2606        TO  WS-ERROR
 12633             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12634     ELSE
 12635     IF PB-COMPANY-ID = 'TMS'
 12636         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12637             NEXT SENTENCE
 12638         ELSE
 12639             MOVE ER-2689        TO  WS-ERROR
 12640             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12641     ELSE
 12642         IF PB-I-SIG-SW = 'Y' OR 'N'
 12643             NEXT SENTENCE
 12644         ELSE
 12645             MOVE ER-2651        TO  WS-ERROR
 12646             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12647
 12648     IF PB-COMPANY-ID = 'FLA'
 12649         IF (WS-EDIT-AGE GREATER 54  OR
 12650             WS-AH-EDIT-AGE GREATER 54)  AND
 12651            PB-I-SIG-SW = 'N'
 12652            MOVE ER-2651         TO  WS-ERROR
 12653            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12654
 12655 3135-NAME-EDIT.
 12656
 12657     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12658        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12659        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12660           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12661                                 TO PB-I-JOINT-FIRST-NAME
 12662        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 231
* EL050.cbl
 12663     END-IF
 12664     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12665        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12666        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12667           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12668                                 TO PB-I-JOINT-LAST-NAME
 12669        END-PERFORM
 12670     END-IF
 12671     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12672        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12673        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12674           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12675                                 TO PB-I-INSURED-FIRST-NAME
 12676        END-PERFORM
 12677     END-IF
 12678     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12679        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12680        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12681           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12682                                 TO PB-I-INSURED-LAST-NAME
 12683        END-PERFORM
 12684     END-IF
 12685     IF PB-I-INSURED-LAST-NAME = SPACES
 12686       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12687       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12688           MOVE ER-2660    TO WS-ERROR
 12689           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12690
 12691 3136-EDIT-SEX.
 12692
 12693******************************************************************
 12694*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12695******************************************************************
 12696
 12697     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12698        (WS-AH-SPECIAL-CALC-CD = 'O')
 12699        NEXT SENTENCE
 12700     ELSE
 12701        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12702           NEXT SENTENCE
 12703        ELSE
 12704           MOVE ER-2629            TO WS-ERROR
 12705           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12706
 12707 3137-EDIT-EFF-DATE.
 12708
 12709     IF PB-REISSUED-CERT       OR
 12710        PB-POLICY-IS-DECLINED  OR
 12711        PB-POLICY-IS-VOIDED
 12712         GO TO 3139-EDIT-COVERAGE-CODES.
 12713
 12714     MOVE SPACE                  TO WS-2671-SW
 12715                                    WS-2672-SW.
 12716
 12717     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12718         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12719             MOVE ER-2703        TO WS-ERROR
 12720             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 232
* EL050.cbl
 12721             GO TO 3139-EDIT-COVERAGE-CODES.
 12722
 12723     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12724         GO TO 3139-EDIT-COVERAGE-CODES.
 12725
 12726     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12727     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12728*    MOVE '1'                    TO DC-OPTION-CODE.
 12729     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12730     MOVE +0                     TO DC-ELAPSED-MONTHS
 12731                                    DC-ELAPSED-DAYS.
 12732     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12733
 12734     IF DATE-CONVERSION-ERROR
 12735         GO TO 3139-EDIT-COVERAGE-CODES.
 12736
 12737     IF DC-ELAPSED-DAYS GREATER +180
 12738         MOVE ER-2672            TO WS-ERROR
 12739         MOVE 'Y'                TO WS-2672-SW
 12740         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12741     END-IF
 12742
 12743     IF WS-ERROR = ER-2671  AND
 12744        PB-COMPANY-ID  = 'LBL'
 12745        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12746        MOVE SPACE               TO WS-2671-SW
 12747        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12748
 12749     IF PB-ISSUE-DATE-FORCED  AND
 12750      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12751         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12752         MOVE ER-2673            TO WS-ERROR
 12753         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12754         MOVE SPACE              TO WS-2671-SW
 12755                                    WS-2672-SW.
 12756
 12757     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12758         IF PB-ISSUE-DATE-FORCED
 12759             MOVE ER-2600          TO  WS-ERROR
 12760             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12761         ELSE
 12762             MOVE ER-2692          TO  WS-ERROR
 12763             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12764
 12765
 12766 3139-EDIT-COVERAGE-CODES.
 12767
 12768     if pb-company-id not = 'AHL'
 12769        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12770           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12771           MOVE ER-2787          TO WS-ERROR
 12772           PERFORM 9900-ERROR-FORMAT
 12773                                 THRU 9900-EXIT
 12774        END-IF
 12775     end-if
 12776     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12777        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12778                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 233
* EL050.cbl
 12779           MOVE ER-2719          TO WS-ERROR
 12780           PERFORM 9900-ERROR-FORMAT
 12781                                 THRU 9900-EXIT
 12782        END-IF
 12783     END-IF
 12784
 12785     IF PB-POLICY-IS-DECLINED  OR
 12786        PB-POLICY-IS-VOIDED
 12787         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12788
 12789     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12790        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12791         MOVE ER-2630                TO WS-ERROR
 12792         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12793
 12794     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12795        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12796        PB-I-LF-PREMIUM-AMT = ZERO
 12797         GO TO 3140-CHECK-AH-FOR-ZERO.
 12798
 12799     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12800        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12801        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12802         GO TO 3140-CHECK-AH-FOR-ZERO.
 12803
 12804     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12805        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12806        MOVE ER-2631             TO WS-ERROR
 12807        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12808     END-IF
 12809
 12810
 12811******************************************************************
 12812*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12813******************************************************************
 12814
 12815     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12816        NEXT SENTENCE
 12817     ELSE
 12818        IF PB-I-LF-BENEFIT-AMT = ZERO
 12819           MOVE ER-2632             TO WS-ERROR
 12820           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12821
 12822
 12823******************************************************************
 12824*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12825******************************************************************
 12826
 12827     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12828        CONTINUE
 12829     ELSE
 12830        IF PB-I-LF-PREMIUM-AMT = ZERO
 12831           IF (NOT PB-COMP-LF-PREM)
 12832              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12833              MOVE ER-2633       TO WS-ERROR
 12834              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12835           END-IF
 12836        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 234
* EL050.cbl
 12837     END-IF
 12838     .
 12839 3140-CHECK-AH-FOR-ZERO.
 12840
 12841     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12842        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12843        PB-I-AH-PREMIUM-AMT = ZERO
 12844         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12845
 12846     IF PB-COMPANY-ID = 'CSL'  AND
 12847        PB-I-AH-BENEFIT-CD = ZERO  AND
 12848        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12849        PB-I-AH-PREMIUM-AMT = ZERO
 12850         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12851
 12852     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12853        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12854        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12855         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12856
 12857     IF PB-I-AH-BENEFIT-CD = ZERO
 12858         MOVE ER-2634            TO WS-ERROR
 12859         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12860
 12861******************************************************************
 12862*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12863******************************************************************
 12864
 12865     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12866        NEXT SENTENCE
 12867     ELSE
 12868        IF PB-I-AH-BENEFIT-AMT = ZERO
 12869           MOVE ER-2635             TO WS-ERROR
 12870           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12871
 12872******************************************************************
 12873*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12874******************************************************************
 12875
 12876     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12877        NEXT SENTENCE
 12878     ELSE
 12879        IF PB-I-AH-PREMIUM-AMT = ZERO
 12880            IF NOT PB-COMP-AH-PREM
 12881                MOVE ER-2636    TO WS-ERROR
 12882                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12883
 12884
 12885 3140-EDIT-MAX-AMT-SIZES.
 12886* CUSTOM CODE FOR CLIENT    'DMD'
 12887     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12888                                     WS-RES-MUNI-TAX
 12889                                     PB-I-STATE-TAX
 12890                                     PB-I-MUNI-TAX.
 12891
 12892     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12893
 12894     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 235
* EL050.cbl
 12895        GO TO 3150-RATE-OUTSTAND-BAL.
 12896
 12897     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12898        GO TO 3150-RATE-OUTSTAND-BAL.
 12899
 12900     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12901        GO TO 3150-RATE-OUTSTAND-BAL.
 12902
 12903     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12904                             OR 'RIC')
 12905        GO TO 3150-RATE-OUTSTAND-BAL.
 12906
 12907     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12908        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12909            GO TO 3150-RATE-OUTSTAND-BAL
 12910        ELSE
 12911           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12912               GO TO 3150-RATE-OUTSTAND-BAL.
 12913
 12914     IF NOT PB-NO-MONTHS-SKIPPED
 12915        GO TO 3150-RATE-OUTSTAND-BAL.
 12916
 12917     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12918        GO TO 3150-RATE-OUTSTAND-BAL.
 12919
 12920     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12921        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12922           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12923             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12924           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12925           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12926              MOVE ER-2693     TO WS-ERROR
 12927              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12928              GO TO 3150-RATE-OUTSTAND-BAL
 12929           ELSE
 12930              GO TO 3150-RATE-OUTSTAND-BAL.
 12931
 12932 3150-RATE-OUTSTAND-BAL.
 12933
 12934* DMD RATING TEST
 12935     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12936         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12937         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12938         MOVE ER-2687                 TO WS-ERROR
 12939         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12940         MOVE 'B'                     TO PB-I-OB-FLAG
 12941         GO TO 3260-EDIT-CONTINUE.
 12942
 12943     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12944         IF  WS-ERROR    EQUAL    ER-2693
 12945             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12946                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12947                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12948                 MOVE  +0            TO  WS-ERROR.
 12949
 12950     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12951         IF  WS-ERROR    EQUAL    ER-2693
 12952             IF WS-STATE-ABBREVIATION EQUAL 'NC'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 236
* EL050.cbl
 12953                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12954                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12955                 MOVE  +0            TO  WS-ERROR.
 12956
 12957     IF PLAN-MASTER-AH-SW = 'Y'
 12958        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12959            IF  WS-ERROR    EQUAL    ER-2693
 12960              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12961                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12962                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12963                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12964                 MOVE  ER-1910           TO  WS-ERROR
 12965                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12966
 12967     IF PLAN-MASTER-AH-SW = 'Y'
 12968        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12969            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12970               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12971               MOVE  ER-1910           TO  WS-ERROR
 12972               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12973
 12974     IF PLAN-MASTER-AH-SW = 'Y'
 12975        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12976            IF  WS-ERROR    EQUAL    ER-2693
 12977                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12978                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12979                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12980                 MOVE  +0       TO  WS-ERROR.
 12981
 12982     IF WS-ERROR = ER-2693
 12983        IF PB-COMPANY-ID = 'JAL' AND
 12984           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12985           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12986           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12987
 12988     IF WS-ERROR = ER-2693
 12989        IF PB-COMPANY-ID = 'NCL'  AND
 12990           PB-I-AH-BENEFIT-CD = 'OA'
 12991           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12992           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12993
 12994     IF WS-ERROR = ER-2693
 12995        IF PB-COMPANY-ID = 'CNL' AND
 12996           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12997           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12998           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12999
 13000     IF WS-ERROR = ER-2693
 13001        IF PB-COMPANY-ID = 'HER'
 13002           IF WS-LEVEL
 13003              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13004              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13005
 13006     IF ((LF-BENEFIT-FOUND) AND
 13007         (NOT NO-LIFE-COVERAGE)  AND
 13008         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13009       OR   ((AH-BENEFIT-FOUND) AND
 13010             (NOT NO-AH-COVERAGE)    AND
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 237
* EL050.cbl
 13011             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13012         NEXT SENTENCE
 13013     ELSE
 13014         GO TO 3215-EDIT-RATES.
 13015
 13016     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13017        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13018           MOVE ER-2674          TO WS-ERROR
 13019           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13020           GO TO 3215-EDIT-RATES.
 13021
 13022     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13023        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13024           MOVE ER-2674          TO WS-ERROR
 13025           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13026           GO TO 3215-EDIT-RATES.
 13027
 13028     MOVE 'B'                    TO PB-I-OB-FLAG.
 13029
 13030     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13031         NEXT SENTENCE
 13032     ELSE
 13033         IF NOT NO-LIFE-COVERAGE
 13034             IF WS-ACCT-LF-OB-RT = ZERO
 13035                MOVE ER-2641    TO WS-ERROR
 13036                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13037
 13038     IF PB-COMPANY-ID = 'CRI'
 13039       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13040         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13041         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13042         IF WS-ERROR = ER-2675
 13043            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13044            MOVE ER-2687              TO WS-ERROR
 13045            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13046         ELSE
 13047            MOVE ER-2687              TO WS-ERROR
 13048            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13049
 13050
 13051     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13052         NEXT SENTENCE
 13053     ELSE
 13054       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13055            NEXT SENTENCE
 13056       ELSE
 13057         IF NOT NO-AH-COVERAGE
 13058             IF WS-ACCT-AH-OB-RT = ZERO
 13059                MOVE ER-2642    TO WS-ERROR
 13060                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13061
 13062     IF PB-COMPANY-ID = 'CRI'
 13063       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13064         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13065         IF WS-ERROR = ER-2676
 13066            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13067            MOVE ER-2687              TO WS-ERROR
 13068            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 238
* EL050.cbl
 13069         ELSE
 13070            MOVE ER-2687              TO WS-ERROR
 13071            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13072
 13073     IF PB-COMPANY-ID NOT = 'GIC'
 13074         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13075            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13076     ELSE
 13077         IF PB-I-LF-PREM-CALC = ZEROS
 13078             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13079                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13080
 13081     IF PB-COMPANY-ID NOT = 'GIC'
 13082         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13083            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13084     ELSE
 13085         IF PB-I-AH-PREM-CALC = ZEROS
 13086             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13087                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13088
 13089     MOVE ZEROS TO PB-I-MORT-CODE.
 13090
 13091     GO TO 3260-EDIT-CONTINUE.
 13092
 13093
 13094 3215-EDIT-RATES.
 13095     IF ACCOUNT-MAST-FOUND
 13096         NEXT SENTENCE
 13097     ELSE
 13098         GO TO 3999-END-EDIT.
 13099
 13100 3220-CHECK-LF-RATES.
 13101
 13102     IF PB-COMPANY-ID = 'DCC'
 13103        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13104        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13105        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13106           AND (NOT WS-LF-CASH))
 13107                           OR
 13108           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13109           AND (NOT WS-AH-CASH)))
 13110                       AND
 13111           (PB-I-ENTRY-STATUS NOT = '5')
 13112           MOVE 'M'              TO PB-BATCH-ENTRY
 13113                                    PB-I-ENTRY-STATUS
 13114        END-IF
 13115     END-IF
 13116     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13117                                    PB-I-AH-PREM-CALC
 13118                                    PB-I-LF-ALT-PREM-CALC
 13119                                    PB-I-LF-ALT-RATE
 13120                                    PB-I-LF-REI-RATE
 13121                                    PB-I-LF-ALT-REI-RATE
 13122                                    PB-I-AH-REI-RATE
 13123                                    PB-I-TOT-FEES-CALC.
 13124
 13125     IF PB-COMPANY-ID EQUAL 'DMD'
 13126        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 239
* EL050.cbl
 13127     ELSE
 13128        MOVE ZEROS               TO PB-I-LF-RATE
 13129                                    PB-I-AH-RATE.
 13130
 13131     IF PB-I-TOT-FEES NOT NUMERIC
 13132        MOVE ZEROS               TO PB-I-TOT-FEES
 13133     END-IF
 13134     IF PB-I-LIVES NOT NUMERIC
 13135         MOVE ZERO               TO PB-I-LIVES.
 13136
 13137     IF PB-I-NUM-BILLED NOT NUMERIC
 13138         MOVE ZERO               TO PB-I-NUM-BILLED.
 13139
 13140     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13141        MOVE +0                  TO PB-I-LF-PREM-TAX
 13142     END-IF
 13143
 13144     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13145        MOVE +0                  TO PB-I-AH-PREM-TAX
 13146     END-IF
 13147
 13148     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13149        PB-I-PAY-FREQUENCY = ZEROS
 13150            MOVE 12 TO CP-PAY-FREQUENCY
 13151     ELSE
 13152            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13153
 13154     IF PB-I-STATE-TAX NOT NUMERIC
 13155         MOVE ZEROS               TO PB-I-STATE-TAX.
 13156
 13157     IF PB-I-MUNI-TAX NOT NUMERIC
 13158         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13159
 13160     MOVE SPACES                 TO CP-BEN-CATEGORY
 13161     IF PB-COMPANY-ID  = 'CSL'  AND
 13162        PB-I-LF-TERM NOT = ZERO
 13163        COMPUTE WS-PAYMENT-AMT =
 13164             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13165        COMPUTE WS-CSL-AMT1 =
 13166             PB-I-LF-TERM * AM-MAX-MON-BEN
 13167        COMPUTE WS-CSL-AMT2 =
 13168             WS-PAYMENT-AMT * PB-I-LF-TERM
 13169        IF CP-PAY-FREQUENCY NOT = 12
 13170           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13171           MOVE '8' TO WS-CSL-CALC-CD
 13172        ELSE
 13173           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13174              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13175               AM-MAX-TOT-BEN
 13176               MOVE '6' TO WS-CSL-CALC-CD
 13177           ELSE
 13178              IF (WS-CSL-AMT1  GREATER THAN
 13179                 AM-MAX-TOT-BEN) AND
 13180                 (WS-CSL-AMT2  GREATER THAN
 13181                 AM-MAX-TOT-BEN)
 13182                 MOVE '7' TO WS-CSL-CALC-CD
 13183              ELSE
 13184                 MOVE '5' TO WS-CSL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 240
* EL050.cbl
 13185
 13186     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13187         NEXT SENTENCE
 13188     ELSE
 13189         GO TO 3300-CHECK-AH-RATES.
 13190
 13191*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13192
 13193     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13194        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13195              OR
 13196           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13197           MOVE ER-2618          TO WS-ERROR
 13198           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13199           GO TO 3300-CHECK-AH-RATES.
 13200
 13201     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13202           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13203                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13204
 13205     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13206         MOVE ER-2687             TO WS-ERROR
 13207         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13208         MOVE 'Z000'              TO PB-I-MORT-CODE
 13209         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13210         GO TO 3300-CHECK-AH-RATES.
 13211
 13212     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13213        IF PB-I-LIVES = ZERO
 13214           MOVE ER-2688          TO WS-ERROR
 13215           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13216
 13217     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13218
 13219     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13220     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13221     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13222     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13223     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13224     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13225     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13226     MOVE '3'                    TO CP-PROCESS-TYPE.
 13227     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13228     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13229
 13230******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13231     IF PB-COMPANY-ID EQUAL 'CDL'
 13232         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13233            CP-EARN-AS-NET-PAY)
 13234             IF PB-CERT-EFF-DT GREATER  WS-931231
 13235                 MOVE '1'        TO CP-EARNING-METHOD.
 13236*******
 13237
 13238     MOVE PB-SV-STATE            TO CP-STATE.
 13239     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13240     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13241     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13242     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 241
* EL050.cbl
 13243     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13244                                    CP-RATING-BENEFIT-AMT.
 13245     IF CP-STATE-STD-ABBRV = 'OR'
 13246         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13247                                         PB-I-LF-ALT-BENEFIT-AMT.
 13248     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13249     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13250     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13251     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13252     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13253     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13254     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13255     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13256     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13257                                    CP-REMAINING-TERM
 13258                                    CP-LOAN-TERM.
 13259
 13260     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13261         NEXT SENTENCE
 13262     ELSE
 13263         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13264             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13265                                           PB-I-LF-PREMIUM-AMT.
 13266
 13267     IF PB-COMPANY-ID EQUAL 'CSL'
 13268        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13269           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13270                                         PB-I-LF-PREMIUM-AMT.
 13271
 13272     IF PB-COMPANY-ID EQUAL 'NCB'
 13273         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13274            CP-EARN-AS-NET-PAY
 13275             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13276                 PB-I-LF-PREMIUM-AMT.
 13277
 13278     IF (CP-TRUNCATED-LIFE)
 13279        or ((pb-company-id = 'AHL')
 13280           and (pb-i-loan-term > pb-i-lf-term))
 13281        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13282
 13283     IF PB-COMPANY-ID EQUAL 'CRI'
 13284        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13285
 13286     IF CP-TERM-IS-DAYS
 13287         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13288     ELSE
 13289         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13290     IF PB-COMPANY-ID = 'DCC'
 13291        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13292        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13293        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13294        IF WS-LF-BEN-CATEGORY = 'D'
 13295           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13296           MOVE PB-I-LIFE-COMMISSION
 13297                                 TO CP-DCC-ACT-COMM
 13298           MOVE WS-LF-BEN-CATEGORY
 13299                                 TO CP-BEN-CATEGORY
 13300        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 242
* EL050.cbl
 13301        IF (CP-BENEFIT-CD (1:1) = 'P')
 13302           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13303           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13304           add pb-i-ah-premium-amt to cp-original-premium
 13305        END-IF
 13306     END-IF
 13307     IF PB-COMPANY-ID = 'CSL'
 13308         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13309         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13310         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13311
 13312     IF PB-COMPANY-ID = 'CSL'
 13313        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13314
 13315     IF (CP-SPECIAL-CALC-CD = 'H')
 13316        OR (PB-COMPANY-ID = 'DCC')
 13317         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13318                                    TO CP-ALTERNATE-BENEFIT
 13319         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13320
 13321     IF (PB-COMPANY-ID = 'CID')
 13322        AND (WS-LF-EARNINGS-CALC = 'B')
 13323        AND (CP-STATE-STD-ABBRV = 'MN')
 13324        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13325                                 TO CP-ALTERNATE-BENEFIT
 13326        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13327     END-IF
 13328     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13329     MOVE 'R'                   TO CP-RATE-FILE.
 13330     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13331
 13332     IF CP-ERROR-RATE-NOT-FOUND
 13333        MOVE ER-2641            TO WS-ERROR
 13334        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13335        GO TO 3300-CHECK-AH-RATES.
 13336
 13337     IF PB-COMPANY-ID EQUAL 'CRI'
 13338        IF CP-ERROR-NO-LIMITS-CRI
 13339           IF NOT ACCOUNT-LIFE-CHECKED
 13340              MOVE ER-2607      TO WS-ERROR
 13341              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13342
 13343******************************************************************
 13344*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13345*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13346******************************************************************
 13347
 13348* CALC LIFE AGE AT EXPIRATION.
 13349
 13350     COMPUTE WS-AGE-AT-EXPIRE =
 13351          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13352
 13353*    IF PB-STATE = 'CO' OR 'UT'
 13354*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13355*        MOVE 'F'            TO PB-FATAL-FLAG
 13356*        MOVE ER-2709        TO WS-ERROR
 13357*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13358*        GO TO PREMIUM-EDITING-IS-BYPASSED.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 243
* EL050.cbl
 13359
 13360*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13361*        MOVE 'X'            TO PB-FATAL-FLAG
 13362*        MOVE ER-2718        TO WS-ERROR
 13363*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13364*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13365
 13366* CALC A & H AGE AT EXPIRATION.
 13367
 13368     COMPUTE WS-AGE-AT-EXPIRE =
 13369          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13370
 13371*    IF PB-STATE = 'CO' OR 'UT'
 13372*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13373*        MOVE 'F'            TO PB-FATAL-FLAG
 13374*        MOVE ER-2709        TO WS-ERROR
 13375*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13376*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13377
 13378*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13379*        MOVE 'X'            TO PB-FATAL-FLAG
 13380*        MOVE ER-2718        TO WS-ERROR
 13381*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13382*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13383
 13384     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13385        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13386
 13387     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13388        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13389     end-if
 13390
 13391     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13392        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13393
 13394     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13395         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13396         MOVE ER-2639        TO WS-ERROR
 13397         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13398
 13399
 13400******************************************************************
 13401*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13402******************************************************************
 13403
 13404 PREMIUM-EDITING-IS-BYPASSED.
 13405     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13406        AND (CP-R-MAX-ATT-AGE > +0)
 13407        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13408        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13409           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13410           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13411           MOVE '1'              TO DC-OPTION-CODE
 13412           PERFORM 8500-DATE-CONVERT
 13413                                 THRU 8500-EXIT
 13414           IF NO-CONVERSION-ERROR
 13415              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13416                 MOVE ER-2661       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 244
* EL050.cbl
 13417*                PERFORM 9900-ERROR-FORMAT
 13418*                                THRU 9900-EXIT
 13419              END-IF
 13420           END-IF
 13421        ELSE
 13422           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13423           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13424              MOVE ER-2661       TO WS-ERROR
 13425*             PERFORM 9900-ERROR-FORMAT
 13426*                                THRU 9900-EXIT
 13427           ELSE
 13428              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13429                 MOVE ER-1570    TO WS-ERROR
 13430                 PERFORM 9900-ERROR-FORMAT
 13431                                 THRU 9900-EXIT
 13432              END-IF
 13433           END-IF
 13434        END-IF
 13435        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13436           MOVE PB-I-JOINT-BIRTHDAY
 13437                                 TO DC-BIN-DATE-1
 13438           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13439           MOVE '1'              TO DC-OPTION-CODE
 13440           PERFORM 8500-DATE-CONVERT
 13441                                 THRU 8500-EXIT
 13442           IF NO-CONVERSION-ERROR
 13443              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13444                 MOVE ER-2661       TO WS-ERROR
 13445*                PERFORM 9900-ERROR-FORMAT
 13446*                                THRU 9900-EXIT
 13447              END-IF
 13448           ELSE
 13449              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13450           END-IF
 13451        ELSE
 13452           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13453             (PB-I-LF-TERM / 12)
 13454           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13455              MOVE ER-2661       TO WS-ERROR
 13456*             PERFORM 9900-ERROR-FORMAT
 13457*                                THRU 9900-EXIT
 13458           ELSE
 13459              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13460                 MOVE ER-1571    TO WS-ERROR
 13461                 PERFORM 9900-ERROR-FORMAT
 13462                                 THRU 9900-EXIT
 13463              END-IF
 13464           END-IF
 13465        END-IF
 13466        IF WS-ERROR = ER-2661
 13467           PERFORM 9900-ERROR-FORMAT
 13468                                 THRU 9900-EXIT
 13469        END-IF
 13470     END-IF
 13471*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13472*       MOVE ER-2661             TO WS-ERROR
 13473*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13474
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 245
* EL050.cbl
 13475     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13476        MOVE ER-2662             TO WS-ERROR
 13477        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13478
 13479     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13480        MOVE ER-2677             TO WS-ERROR
 13481        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13482
 13483     IF CP-ERROR-LOAN-TERM
 13484        MOVE ER-2648             TO WS-ERROR
 13485        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13486
 13487 3221-CHECK-ERROR-RATE-OPEN.
 13488
 13489     IF CP-ERROR-RATE-FILE-NOTOPEN
 13490         GO TO 3990-FILES-NOT-OPEN.
 13491
 13492     IF PB-COMPANY-ID NOT = 'DMD'
 13493        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13494     END-IF
 13495     .
 13496 3221-CONTINUE.
 13497     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13498                                    WS-DCC-AH-RATE
 13499     IF PB-COMPANY-ID = 'DCC'
 13500        IF WS-LF-BEN-CATEGORY = 'D'
 13501           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13502              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13503        END-IF
 13504     END-IF
 13505     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13506*   X'A4FF' = 12/31/2009
 13507     IF (PB-COMPANY-ID = 'CID')
 13508        AND (WS-LF-EARNINGS-CALC = 'B')
 13509        AND (CP-STATE-STD-ABBRV = 'MN')
 13510        AND (PB-CERT-EFF-DT > X'A4FF')
 13511        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13512     END-IF
 13513     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13514
 13515     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13516     IF (PB-COMPANY-ID = 'DCC')
 13517        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13518        AND (PB-I-POLICY-IS-MONTHLY)
 13519        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13520        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13521     END-IF
 13522     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13523     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13524     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13525     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13526     IF (PB-COMPANY-ID = 'DCC')
 13527        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13528        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13529        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13530        MOVE ER-2786             TO WS-ERROR
 13531        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13532     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 246
* EL050.cbl
 13533
 13534     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13535
 13536******************************************************************
 13537*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13538******************************************************************
 13539     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13540        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13541
 13542     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13543        GO TO 3225-CHECK-ALT-LIFE-RATE
 13544     ELSE
 13545       IF PB-I-LF-RATE = ZERO
 13546          MOVE ER-2641          TO WS-ERROR
 13547          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13548
 13549 3225-CHECK-ALT-LIFE-RATE.
 13550
 13551     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13552        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13553        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13554         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13555
 13556     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13557         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13558             AND PB-COMPANY-ID NOT = 'DCC')
 13559                   OR
 13560              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13561              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13562              AND PB-COMPANY-ID NOT = 'DCC')
 13563             MOVE ER-2720        TO  WS-ERROR
 13564             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13565             GO TO 3225-RATING-CONT
 13566         ELSE
 13567             GO TO 3225-RATING-CONT.
 13568     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13569        AND (AM-GPCD = 01 OR 06 OR 15)
 13570        MOVE ER-2798             TO WS-ERROR
 13571        PERFORM 9900-ERROR-FORMAT
 13572                                 THRU 9900-EXIT
 13573*       GO TO 3225-RATING-CONT
 13574     END-IF
 13575     IF (PB-COMPANY-ID = 'CID')
 13576        AND (WS-LF-EARNINGS-CALC = 'B')
 13577        AND (CP-STATE-STD-ABBRV = 'MN')
 13578        AND (PB-CERT-EFF-DT > X'A4FF')
 13579        GO TO 3225-RATING-CONT
 13580     END-IF
 13581     IF PB-COMPANY-ID = 'DCC'
 13582        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13583           AND (PB-I-POLICY-IS-MONTHLY)
 13584           GO TO 3225-RATING-CONT
 13585        END-IF
 13586     END-IF
 13587
 13588     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13589        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13590        CP-EARN-AS-REG-BALLOON
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 247
* EL050.cbl
 13591        NEXT SENTENCE
 13592     ELSE
 13593        MOVE '2'                 TO CP-EARNING-METHOD.
 13594
 13595 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13596
 13597     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13598
 13599     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13600        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13601        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13602         NEXT SENTENCE
 13603     ELSE
 13604         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13605
 13606     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13607     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13608     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13609                                     CP-RATING-BENEFIT-AMT.
 13610     IF CP-STATE-STD-ABBRV = 'OR'
 13611         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13612                                         PB-I-LF-ALT-BENEFIT-AMT.
 13613     IF PB-COMPANY-ID = 'DCC'
 13614        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13615     END-IF
 13616     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13617     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13618     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13619                                    CP-REMAINING-TERM
 13620                                    CP-LOAN-TERM.
 13621     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13622        ADD +1                   TO CP-ORIGINAL-TERM
 13623                                    CP-REMAINING-TERM
 13624                                    CP-LOAN-TERM.
 13625
 13626     MOVE 'R'                   TO CP-RATE-FILE.
 13627     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13628
 13629     IF CP-ERROR-RATE-NOT-FOUND
 13630         MOVE ER-2641            TO WS-ERROR
 13631         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13632         GO TO 3300-CHECK-AH-RATES.
 13633
 13634     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13635     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13636
 13637     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13638         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13639
 13640     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13641                               + PB-I-LF-ALT-BENEFIT-AMT.
 13642
 13643     IF ACCOUNT-LIFE-CHECKED  OR
 13644        PB-POLICY-IS-VOIDED   OR
 13645        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13646        GO TO 3225-CONTINUE.
 13647
 13648     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 248
* EL050.cbl
 13649        GO TO 3225-CONTINUE.
 13650
 13651     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13652                             EC-RT-LF-MAX-TOT-BEN
 13653        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13654        MOVE ER-2639       TO WS-ERROR
 13655        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13656
 13657 3225-CONTINUE.
 13658     IF PB-I-LF-ALT-RATE = ZERO
 13659         MOVE ER-2659            TO WS-ERROR
 13660         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13661
 13662     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13663        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13664        MOVE ER-2698             TO WS-ERROR
 13665        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13666
 13667 3225-RATING-CONT.
 13668
 13669     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13670         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13671         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13672         IF (PB-COMPANY-ID = 'DCC')
 13673            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13674            CONTINUE
 13675         ELSE
 13676            MOVE ER-2687         TO WS-ERROR
 13677            PERFORM 9900-ERROR-FORMAT
 13678                                 THRU 9900-EXIT
 13679         END-IF
 13680         GO TO 3290-EDIT-LF-REIN-RATE
 13681     END-IF
 13682
 13683* DMD RATING TEST
 13684     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13685         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13686         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13687         MOVE ER-2687                 TO WS-ERROR
 13688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13689         GO TO 3290-EDIT-LF-REIN-RATE.
 13690
 13691 3230-CLIENT-MORT-CD-SPECIALS.
 13692
 13693     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13694     SET BIN-TO-GREG          TO TRUE.
 13695*    MOVE ' '                 TO DC-OPTION-CODE.
 13696     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13697     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13698
 13699 C-POS-3230-MORT-CD.
 13700     IF PB-COMPANY-ID = 'POS' AND
 13701        PB-SV-CARRIER = '2'
 13702         NEXT SENTENCE
 13703     ELSE
 13704         GO TO C-POS-3240-MORT-CD.
 13705
 13706     IF PB-SV-GROUPING = '030'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 249
* EL050.cbl
 13707        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13708         MOVE '2350' TO PB-I-MORT-CODE
 13709      ELSE
 13710         MOVE '3300' TO PB-I-MORT-CODE.
 13711
 13712
 13713 C-POS-3240-MORT-CD.
 13714     IF PB-COMPANY-ID = 'POS' AND
 13715        PB-SV-CARRIER = '1'
 13716         NEXT SENTENCE
 13717     ELSE
 13718         GO TO 3230-CONTINUE.
 13719
 13720     IF PB-SV-STATE = '45' OR '47'
 13721        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13722         MOVE '5200' TO PB-I-MORT-CODE
 13723     ELSE
 13724         MOVE '8300' TO PB-I-MORT-CODE.
 13725
 13726 3230-CONTINUE.
 13727
 13728     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13729        GO TO 3240-CONTINUE
 13730     END-IF
 13731
 13732     IF PB-CERT-EFF-DT > WS-971231
 13733        GO TO 3240-CONTINUE
 13734     END-IF
 13735
 13736     IF LF-BENEFIT-FOUND AND
 13737        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13738         MOVE 'F250'       TO PB-I-MORT-CODE
 13739     ELSE
 13740         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13741             MOVE '7250'   TO PB-I-MORT-CODE
 13742         ELSE
 13743             MOVE '4251'   TO PB-I-MORT-CODE
 13744         END-IF
 13745     END-IF
 13746
 13747     .
 13748 3240-CONTINUE.
 13749
 13750     IF PB-COMPANY-ID NOT = 'GNL'
 13751         GO TO 3256-CONTINUE.
 13752
 13753     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13754         MOVE 'A300' TO PB-I-MORT-CODE
 13755     ELSE
 13756         MOVE '8350' TO PB-I-MORT-CODE.
 13757
 13758 3256-CONTINUE.
 13759     IF PB-COMPANY-ID NOT = 'ABL'
 13760         GO TO 3260-EDIT-CONTINUE.
 13761
 13762     IF PB-I-LF-TERM GREATER THAN 59
 13763         MOVE 'F550' TO PB-I-MORT-CODE
 13764     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 250
* EL050.cbl
 13765         MOVE 'E550' TO PB-I-MORT-CODE.
 13766
 13767 3260-EDIT-CONTINUE.
 13768     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13769
 13770 3290-EDIT-LF-REIN-RATE.
 13771     IF LF-REIN-NSP-NOT-USED
 13772         GO TO 3290-RATING-CONT.
 13773
 13774     IF PB-COMPANY-ID = 'DCC'
 13775        GO TO 3290-RATING-CONT.
 13776     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13777     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13778     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13779     MOVE '3'                   TO CP-PROCESS-TYPE.
 13780     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13781
 13782******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13783     IF PB-COMPANY-ID EQUAL 'CDL'
 13784         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13785            CP-EARN-AS-NET-PAY)
 13786             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13787*            MOVE SPACE          TO DC-OPTION-CODE
 13788             SET BIN-TO-GREG     TO TRUE
 13789             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13790***  Y2K PROJ 7744
 13791             IF DC-GREG-DATE-CYMD GREATER 19931231
 13792                 MOVE '1'        TO CP-EARNING-METHOD.
 13793***  Y2K PROJ 7744
 13794*******
 13795
 13796     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13797     MOVE PB-SV-STATE           TO CP-STATE.
 13798     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13799     MOVE ZERO                  TO CP-DEVIATION-CODE
 13800                                   CP-RATE-DEV-PCT.
 13801     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13802     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13803                                   CP-RATING-BENEFIT-AMT.
 13804
 13805************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13806     IF PB-COMPANY-ID EQUAL 'NCB'
 13807         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13808            CP-EARN-AS-NET-PAY
 13809             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13810                 PB-I-LF-PREMIUM-AMT.
 13811************
 13812
 13813     IF CP-STATE-STD-ABBRV = 'OR'
 13814         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13815                                         PB-I-LF-ALT-BENEFIT-AMT.
 13816     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13817     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13818     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13819     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13820     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13821     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13822     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 251
* EL050.cbl
 13823     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13824                                   CP-REMAINING-TERM
 13825                                   CP-LOAN-TERM.
 13826     IF CP-TRUNCATED-LIFE
 13827        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13828
 13829     IF CP-TERM-IS-DAYS
 13830         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13831     ELSE
 13832         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13833
 13834     IF PB-COMPANY-ID = 'DCC'
 13835        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13836     END-IF
 13837     IF PB-COMPANY-ID NOT = 'TIC'
 13838          MOVE ZERO          TO CP-CLASS-CODE.
 13839
 13840     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13841
 13842     MOVE 'R'                   TO CP-RATE-FILE.
 13843     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13844
 13845     IF CP-ERROR-RATE-NOT-FOUND
 13846        IF PB-I-OB
 13847           MOVE ER-2625      TO WS-ERROR
 13848           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13849           GO TO 3299-EDIT-CONTINUE
 13850        ELSE
 13851           MOVE ER-2643      TO WS-ERROR
 13852           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13853           GO TO 3299-EDIT-CONTINUE.
 13854
 13855     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13856
 13857     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13858     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13859
 13860     IF PB-I-LF-REI-RATE = ZERO
 13861         MOVE ER-2643        TO WS-ERROR
 13862         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13863
 13864 3290-CHECK-ALT-REIN-RATE.
 13865
 13866     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13867        GO TO 3290-RATING-CONT.
 13868
 13869     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13870     MOVE '2'                    TO CP-EARNING-METHOD.
 13871     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13872     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13873     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13874     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13875                                     CP-RATING-BENEFIT-AMT.
 13876     IF CP-STATE-STD-ABBRV = 'OR'
 13877         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13878                                         PB-I-LF-ALT-BENEFIT-AMT.
 13879     IF PB-COMPANY-ID = 'DCC'
 13880        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 252
* EL050.cbl
 13881     END-IF
 13882     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13883     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13884     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13885                                    CP-REMAINING-TERM
 13886                                    CP-LOAN-TERM.
 13887     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13888        ADD +1                   TO CP-ORIGINAL-TERM
 13889                                    CP-REMAINING-TERM
 13890                                    CP-LOAN-TERM.
 13891
 13892     MOVE 'R'                   TO CP-RATE-FILE.
 13893     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13894
 13895     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13896
 13897     IF PB-I-LF-ALT-REI-RATE = ZERO
 13898         MOVE ER-2643            TO WS-ERROR
 13899         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13900
 13901 3290-RATING-CONT.
 13902
 13903     IF PB-I-OB
 13904*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13905        GO TO 3300-CHECK-AH-RATES.
 13906
 13907 3299-EDIT-CONTINUE.
 13908
 13909     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13910         NEXT SENTENCE
 13911     ELSE
 13912         MOVE ER-2620           TO WS-ERROR
 13913         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13914
 13915 3300-CHECK-AH-RATES.
 13916     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13917         NEXT SENTENCE
 13918     ELSE
 13919         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13920
 13921     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13922        ((CF-COMPANY-ID = 'DMD') AND
 13923                (NO-DMD-RATING))
 13924         IF (PB-COMPANY-ID = 'DCC')
 13925            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13926            CONTINUE
 13927         ELSE
 13928            MOVE ER-2687         TO WS-ERROR
 13929            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13930         END-IF
 13931         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13932         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13933     END-IF
 13934
 13935     IF PB-I-OB
 13936        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13937
 13938     IF WS-AH-SPECIAL-CALC-CD = 'M'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 253
* EL050.cbl
 13939         MOVE ER-2687             TO WS-ERROR
 13940         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13941         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13942         GO TO 3999-END-EDIT.
 13943
 13944*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13945     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13946        IF PB-I-AH-CRIT-PER = ZERO
 13947           IF PB-COMPANY-ID = 'DCC'
 13948              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13949              CONTINUE
 13950           ELSE
 13951              MOVE ER-2618       TO WS-ERROR
 13952              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13953              GO TO 3999-END-EDIT
 13954           END-IF
 13955        END-IF
 13956     END-IF
 13957     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13958     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13959     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13960     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13961     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13962     MOVE PB-SV-STATE            TO CP-STATE.
 13963     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13964     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13965     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13966*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13967     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13968     MOVE '3'                    TO CP-PROCESS-TYPE.
 13969     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13970     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13971                                    CP-RATING-BENEFIT-AMT.
 13972     IF PB-COMPANY-ID = 'CID'
 13973               OR
 13974        CP-STATE-STD-ABBRV = 'OR'
 13975         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13976                                         PB-I-AH-TERM.
 13977     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13978        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13979           AND (PB-I-POLICY-IS-MONTHLY)
 13980           MOVE PB-I-LF-BENEFIT-AMT
 13981                                 TO CP-NET-BENEFIT-AMT
 13982           move pb-i-ah-premium-amt to cp-original-premium
 13983           add pb-i-lf-premium-amt to cp-original-premium
 13984        END-IF
 13985     END-IF
 13986     MOVE SPACES                 TO CP-BEN-CATEGORY
 13987     IF PB-COMPANY-ID = 'DCC'
 13988        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13989        EVALUATE TRUE
 13990           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13991              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13992              MOVE PB-I-LF-BENEFIT-AMT
 13993                                 TO CP-RATING-BENEFIT-AMT
 13994              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13995           WHEN WS-AH-BEN-CATEGORY = 'G'
 13996              MOVE PB-I-UNPAID-CASH-PRICE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 254
* EL050.cbl
 13997                                 TO CP-RATING-BENEFIT-AMT
 13998           WHEN WS-AH-BEN-CATEGORY = 'D'
 13999              MOVE WS-AH-PMF-COMM
 14000                                 TO CP-DCC-PMF-COMM
 14001              MOVE PB-I-AH-COMMISSION
 14002                                 TO CP-DCC-ACT-COMM
 14003        END-EVALUATE
 14004     END-IF
 14005     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14006     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14007     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14008     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14009     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14010     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14011     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14012                                    CP-REMAINING-TERM
 14013                                    WS-WORK-TERM.
 14014     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14015
 14016     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14017     SET BIN-TO-GREG             TO TRUE.
 14018*    MOVE ' '                    TO DC-OPTION-CODE.
 14019     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14020     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14021
 14022     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14023     IF NOT VALID-SKIP-CODE
 14024         MOVE ER-2683            TO WS-ERROR
 14025         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14026         GO TO 3320-RATE-CONTINUE.
 14027
 14028     IF PB-NO-MONTHS-SKIPPED
 14029         GO TO 3320-RATE-CONTINUE.
 14030
 14031     MOVE SPACE TO NUMBER-OF-MONTHS.
 14032
 14033     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14034         MOVE 'S'                TO SK-MO (6).
 14035     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14036         MOVE 'S'                TO SK-MO (7).
 14037     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14038         MOVE 'S'                TO SK-MO (8).
 14039     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14040         MOVE 'S'                TO SK-MO (9).
 14041     IF PB-I-SKIP-CODE = 'A'
 14042         MOVE 'S'                TO SK-MO (10).
 14043
 14044     MOVE 1                      TO SUB2.
 14045     MOVE PB-I-AH-TERM           TO SUB3.
 14046     MOVE WS-MONTH               TO SUB1.
 14047     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14048     GO TO 3320-RATE-CONTINUE.
 14049
 14050 3310-GET-SKIP-MO.
 14051     IF SUB1 = 13
 14052         MOVE 1                  TO SUB1.
 14053
 14054     IF SK-MO (SUB1) = 'S'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 255
* EL050.cbl
 14055         SUBTRACT 1 FROM WS-WORK-TERM.
 14056
 14057     ADD 1 TO SUB2
 14058              SUB1.
 14059
 14060 3320-RATE-CONTINUE.
 14061
 14062     IF WS-WORK-TERM = ZERO
 14063         MOVE 1                  TO WS-WORK-TERM.
 14064
 14065     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14066                                    CP-LOAN-TERM.
 14067
 14068     IF PB-COMPANY-ID EQUAL 'DMD'
 14069         NEXT SENTENCE
 14070     ELSE
 14071         MOVE ZERO               TO PB-I-AH-RATE
 14072                                    PB-I-AH-REI-RATE.
 14073
 14074
 14075     IF PB-COMPANY-ID EQUAL 'CRI'
 14076        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14077
 14078     IF PB-COMPANY-ID = 'CSL'
 14079         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14080         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14081         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14082         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14083
 14084     IF PB-COMPANY-ID = 'DCC'
 14085        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14086           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14087              PB-I-RATE-DEV-PCT-LF
 14088        END-IF
 14089        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14090                                 TO CP-ALTERNATE-BENEFIT
 14091        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14092        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14093        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14094     END-IF
 14095     IF (PB-COMPANY-ID = 'CID')
 14096        AND (WS-LF-EARNINGS-CALC = 'B')
 14097        AND (CP-STATE-STD-ABBRV = 'MN')
 14098        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14099     ELSE
 14100        MOVE ' '                 TO CP-AH-BALLOON-SW
 14101     END-IF
 14102     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14103     MOVE 'R'                   TO CP-RATE-FILE.
 14104     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14105
 14106     IF CP-ERROR-RATE-NOT-FOUND
 14107        IF PB-I-OB
 14108           MOVE ER-2624          TO WS-ERROR
 14109           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14110           GO TO 3340-CALCULATE-PREMIUM-AMT
 14111        ELSE
 14112          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 256
* EL050.cbl
 14113              NEXT SENTENCE
 14114          ELSE
 14115           MOVE ER-2642          TO WS-ERROR
 14116           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14117           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14118
 14119     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14120        CP-ERROR-DIV-BY-ZERO
 14121           MOVE ER-3782          TO WS-ERROR
 14122           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14123
 14124     IF PB-COMPANY-ID EQUAL 'CRI'
 14125        IF CP-ERROR-NO-LIMITS-CRI
 14126           IF NOT ACCOUNT-AH-CHECKED
 14127              MOVE ER-2607          TO WS-ERROR
 14128              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14129
 14130     IF ACCOUNT-AH-CHECKED
 14131        NEXT SENTENCE
 14132     ELSE
 14133       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14134          MOVE ER-2640           TO WS-ERROR
 14135          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14136
 14137     IF PB-COMPANY-ID = 'CRI'
 14138         IF WS-ERROR = ER-2640
 14139             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14140     IF ACCOUNT-AH-CHECKED
 14141        CONTINUE
 14142     ELSE
 14143        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14144           AND (CP-R-MAX-ATT-AGE > +0)
 14145           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14146           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14147              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14148              MOVE PB-I-AH-EXPIRE-DT
 14149                                 TO DC-BIN-DATE-2
 14150              MOVE '1'           TO DC-OPTION-CODE
 14151              PERFORM 8500-DATE-CONVERT
 14152                                 THRU 8500-EXIT
 14153              IF NO-CONVERSION-ERROR
 14154                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14155                    MOVE ER-2661       TO WS-ERROR
 14156*                   PERFORM 9900-ERROR-FORMAT
 14157*                                THRU 9900-EXIT
 14158                 END-IF
 14159              END-IF
 14160           ELSE
 14161              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14162              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14163                 MOVE ER-2661    TO WS-ERROR
 14164*                PERFORM 9900-ERROR-FORMAT
 14165*                                THRU 9900-EXIT
 14166              ELSE
 14167                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14168                    MOVE ER-1570 TO WS-ERROR
 14169                    PERFORM 9900-ERROR-FORMAT
 14170                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 257
* EL050.cbl
 14171                 END-IF
 14172              END-IF
 14173           END-IF
 14174           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14175              MOVE PB-I-JOINT-BIRTHDAY
 14176                                    TO DC-BIN-DATE-1
 14177              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14178              MOVE '1'              TO DC-OPTION-CODE
 14179              PERFORM 8500-DATE-CONVERT
 14180                                    THRU 8500-EXIT
 14181              IF NO-CONVERSION-ERROR
 14182                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14183                    MOVE ER-2661       TO WS-ERROR
 14184*                   PERFORM 9900-ERROR-FORMAT
 14185*                                   THRU 9900-EXIT
 14186                 END-IF
 14187              END-IF
 14188           ELSE
 14189              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14190                (PB-I-AH-TERM / 12)
 14191              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14192                 MOVE ER-2661       TO WS-ERROR
 14193*                PERFORM 9900-ERROR-FORMAT
 14194*                                   THRU 9900-EXIT
 14195              ELSE
 14196                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14197                    MOVE ER-1571 TO WS-ERROR
 14198                    PERFORM 9900-ERROR-FORMAT
 14199                                 THRU 9900-EXIT
 14200                 END-IF
 14201              END-IF
 14202           END-IF
 14203           IF WS-ERROR = ER-2661
 14204              PERFORM 9900-ERROR-FORMAT
 14205                                    THRU 9900-EXIT
 14206           END-IF
 14207        END-IF
 14208     END-IF
 14209*    IF ACCOUNT-AH-CHECKED
 14210*       NEXT SENTENCE
 14211*    ELSE
 14212*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14213*          MOVE ER-2661          TO WS-ERROR
 14214*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14215
 14216     IF ACCOUNT-AH-CHECKED
 14217        NEXT SENTENCE
 14218     ELSE
 14219        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14220           MOVE ER-2663          TO WS-ERROR
 14221           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14222
 14223     IF ACCOUNT-AH-CHECKED OR
 14224        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14225         PB-POLICY-IS-VOIDED
 14226        NEXT SENTENCE
 14227     ELSE
 14228        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 258
* EL050.cbl
 14229           MOVE ER-2667            TO WS-ERROR
 14230           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14231
 14232     IF PB-COMPANY-ID = 'CRI'
 14233         IF WS-ERROR = ER-2667
 14234             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14235
 14236     IF ACCOUNT-AH-CHECKED
 14237        NEXT SENTENCE
 14238     ELSE
 14239        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14240           MOVE ER-2678            TO WS-ERROR
 14241           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14242
 14243     IF CP-ERROR-RATE-FILE-NOTOPEN
 14244         GO TO 3990-FILES-NOT-OPEN.
 14245
 14246 3321-CONTINUE.
 14247     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14248     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14249     IF (PB-COMPANY-ID = 'DCC')
 14250        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14251        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14252                                    PB-I-LF-ALT-PREM-CALC
 14253        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14254        IF WS-AH-BEN-CATEGORY = 'G'
 14255           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14256           + PB-I-ADDL-CLP)
 14257           * (1 + WS-TOL-CLP-PCT)
 14258*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14259        ELSE
 14260           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14261           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14262*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14263        END-IF
 14264        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14265                                 TO PB-I-AH-PREM-CALC
 14266        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14267           MOVE ER-8152          TO WS-ERROR
 14268           PERFORM 9900-ERROR-FORMAT
 14269                                 THRU 9900-EXIT
 14270        ELSE
 14271           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14272                 PB-I-ADDL-CLP)
 14273              MOVE ER-8148       TO WS-ERROR
 14274              PERFORM 9900-ERROR-FORMAT
 14275                                 THRU 9900-EXIT
 14276           END-IF
 14277        END-IF
 14278     END-IF
 14279     IF (PB-COMPANY-ID = 'DCC')
 14280        AND (PB-I-POLICY-IS-MONTHLY)
 14281        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14282        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14283        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14284           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14285        END-IF
 14286     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 259
* EL050.cbl
 14287     IF (PB-COMPANY-ID = 'DCC')
 14288        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14289        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14290        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14291        MOVE ER-2786             TO WS-ERROR
 14292        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14293     END-IF
 14294     MOVE +0                     TO PB-I-AH-CLP
 14295     IF PB-COMPANY-ID = 'DCC'
 14296        IF WS-AH-BEN-CATEGORY = 'D'
 14297           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14298              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14299        ELSE
 14300           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14301              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14302           END-IF
 14303        END-IF
 14304     END-IF
 14305     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14306
 14307     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14308         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14309
 14310     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14311         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14312
 14313     IF PB-COMPANY-ID = 'CRI'
 14314         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14315            PB-I-PAYMENT-AMOUNT = ZERO
 14316             NEXT SENTENCE
 14317         ELSE
 14318             COMPUTE PB-I-AH-PREM-CALC =
 14319                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14320                 (CP-PREMIUM-RATE / 100)
 14321             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14322                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14323                                             PB-I-RATE-DEV-PCT-AH.
 14324
 14325     IF PB-I-AH-RATE  = ZERO
 14326       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14327           NEXT SENTENCE
 14328       ELSE
 14329         MOVE ER-2642            TO WS-ERROR
 14330         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14331
 14332     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14333     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14334     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14335     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14336     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14337     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14338
 14339     IF (PB-COMPANY-ID = 'DCC')
 14340        AND (WS-AH-BEN-CATEGORY = 'G')
 14341        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14342        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14343        IF CP-DEVIATION-CODE NOT = '000'
 14344           MOVE '000'            TO CP-DEVIATION-CODE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 260
* EL050.cbl
 14345           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14346           IF NO-CP-ERROR
 14347              COMPUTE PB-I-DDF-IU-RATE-UP =
 14348              PB-I-AH-CLP - CP-CALC-PREMIUM
 14349           ELSE
 14350              MOVE ER-3057        TO WS-ERROR
 14351              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14352           END-IF
 14353        END-IF
 14354     END-IF
 14355     .
 14356 3335-EDIT-AH-REIN-NSP-RATE.
 14357     IF AH-REIN-NSP-NOT-USED
 14358         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14359
 14360     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14361     IF PB-COMPANY-ID = 'DCC'
 14362         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14363     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14364     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14365     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14366     MOVE PB-SV-STATE            TO CP-STATE.
 14367     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14368     MOVE ZERO                   TO CP-DEVIATION-CODE
 14369                                    CP-RATE-DEV-PCT.
 14370*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14371     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14372     MOVE '3'                    TO CP-PROCESS-TYPE.
 14373     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14374     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14375                                    CP-RATING-BENEFIT-AMT.
 14376     IF CP-STATE-STD-ABBRV = 'OR'
 14377         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14378                                         PB-I-AH-TERM.
 14379     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14380     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14381     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14382     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14383     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14384     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14385                                    CP-REMAINING-TERM
 14386                                    WS-WORK-TERM.
 14387     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14388     IF PB-COMPANY-ID = 'DCC'
 14389        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14390     END-IF
 14391     IF  PB-COMPANY-ID = 'TIC'
 14392         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14393            MOVE ZERO TO CP-CLASS-CODE.
 14394
 14395     IF PB-COMPANY-ID NOT = 'TIC'
 14396          MOVE ZERO          TO CP-CLASS-CODE.
 14397
 14398     MOVE ZERO               TO CP-DEVIATION-CODE.
 14399
 14400     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14401
 14402     MOVE ZERO               TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 261
* EL050.cbl
 14403
 14404     MOVE 'R'                   TO CP-RATE-FILE.
 14405     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14406
 14407     IF CP-ERROR-RATE-NOT-FOUND
 14408         MOVE ER-2645        TO WS-ERROR
 14409         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14410         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14411
 14412     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14413
 14414     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14415     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14416
 14417     IF PB-I-AH-REI-RATE = ZERO
 14418         MOVE ER-2645        TO WS-ERROR
 14419         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14420
 14421
 14422 3340-CALCULATE-PREMIUM-AMT.
 14423
 14424     IF PB-COMPANY-ID = 'NCL'
 14425         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14426             WS-AH-SPECIAL-CALC-CD = 'O')
 14427             GO TO 3999-END-EDIT.
 14428
 14429     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14430                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14431                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14432                         OR 'AHL'
 14433         NEXT SENTENCE
 14434     ELSE
 14435         IF WS-STATE-ABBREVIATION = 'CT'
 14436             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14437                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14438                 COMPUTE PB-I-LF-PREM-CALC =
 14439                                     PB-I-LF-PREM-CALC * .90
 14440                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14441                                     PB-I-LF-ALT-PREM-CALC * .90
 14442                 COMPUTE PB-I-AH-PREM-CALC =
 14443                                     PB-I-AH-PREM-CALC * .90.
 14444
 14445     IF PB-COMP-LF-PREM
 14446        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14447        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14448
 14449     IF PB-COMP-AH-PREM
 14450        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14451
 14452 3340-CHECK-DCC-TOT-FEES.
 14453     IF (PB-COMPANY-ID = 'DCC')
 14454        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14455        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14456        AND (PB-I-POLICY-IS-MONTHLY)
 14457        CONTINUE
 14458     ELSE
 14459        GO TO 3340-EDIT-LF-AH-TOL
 14460     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 262
* EL050.cbl
 14461     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14462     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14463     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14464        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14465           PB-I-RATE-DEV-PCT-LF
 14466     END-IF
 14467     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14468        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14469           PB-I-RATE-DEV-PCT-AH
 14470     END-IF
 14471     MOVE 'N'                    TO CP-BEN-CATEGORY
 14472     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14473
 14474     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14475     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14476     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14477     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14478     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14479     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14480     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14481     MOVE '3'                    TO CP-PROCESS-TYPE.
 14482     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14483     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14484
 14485     MOVE PB-SV-STATE            TO CP-STATE.
 14486     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14487     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14488     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14489     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14490     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14491                                    CP-RATING-BENEFIT-AMT.
 14492     IF CP-STATE-STD-ABBRV = 'OR'
 14493         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14494                                         PB-I-LF-ALT-BENEFIT-AMT.
 14495     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14496     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14497     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14498     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14499     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14500     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14501     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14502     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14503     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14504                                    CP-REMAINING-TERM
 14505                                    CP-LOAN-TERM.
 14506     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14507        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14508           PB-I-LF-PREMIUM-AMT
 14509     end-if
 14510
 14511     IF CP-TRUNCATED-LIFE
 14512        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14513
 14514     IF CP-TERM-IS-DAYS
 14515         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14516     ELSE
 14517         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14518
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 263
* EL050.cbl
 14519     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14520     IF CP-SPECIAL-CALC-CD = 'H'
 14521         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14522                                    TO CP-ALTERNATE-BENEFIT
 14523         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14524     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14525     MOVE 'R'                    TO CP-RATE-FILE
 14526     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14527     IF NOT CP-ERROR-RATE-NOT-FOUND
 14528        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14529        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14530           AND (CP-BENEFIT-CD (1:1) = 'S')
 14531           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14532                                    PB-I-LF-PREMIUM-AMT
 14533        END-IF
 14534     ELSE
 14535        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14536     END-IF
 14537     .
 14538 3340-EDIT-LF-AH-TOL.
 14539
 14540***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14541***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14542***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14543***
 14544     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14545         PB-I-AH-PREMIUM-AMT
 14546          GIVING WS-CALC-WORK.
 14547
 14548     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14549        AND WS-CALC-WORK NOT = ZERO
 14550         MOVE ER-2649            TO WS-ERROR
 14551         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14552
 14553     SUBTRACT PB-I-LF-PREM-CALC
 14554             FROM PB-I-LF-PREMIUM-AMT
 14555                 GIVING WS-UNSIGN-WRK1.
 14556
 14557     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14558             FROM PB-I-LF-ALT-PREMIUM-AMT
 14559                 GIVING WS-UNSIGN-WRK4.
 14560
 14561     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14562                                + WS-UNSIGN-WRK4.
 14563
 14564     SUBTRACT PB-I-AH-PREM-CALC
 14565             FROM PB-I-AH-PREMIUM-AMT
 14566                 GIVING WS-UNSIGN-WRK2.
 14567
 14568******************************************************************
 14569*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14570******************************************************************
 14571
 14572     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14573         MOVE ZERO TO WS-UNSIGN-WRK1.
 14574
 14575     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14576         MOVE ZERO TO WS-UNSIGN-WRK2.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 264
* EL050.cbl
 14577
 14578     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14579             GIVING WS-UNSIGN-WRK3.
 14580
 14581 3342-CONTINUE.
 14582
 14583     IF (PB-I-LF-RATE = ZERO  AND
 14584         PB-I-AH-RATE = ZERO)
 14585         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14586            WS-AH-SPECIAL-CALC-CD = 'O'
 14587              NEXT SENTENCE
 14588         ELSE
 14589             GO TO 3345-EDIT-CONTINUE.
 14590
 14591     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14592         NEXT SENTENCE
 14593     ELSE
 14594     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14595        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14596           IF (PB-REISSUED-CERT         OR
 14597               PB-POLICY-IS-DECLINED    OR
 14598               PB-POLICY-IS-VOIDED)
 14599              NEXT SENTENCE
 14600           ELSE
 14601              IF WS-PREM-REJECT-SW = SPACE
 14602                 MOVE ER-2652    TO WS-ERROR
 14603                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14604                 GO TO 3344-CHECK-AH
 14605              ELSE
 14606                 MOVE ER-2650    TO WS-ERROR
 14607                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14608                 GO TO 3344-CHECK-AH.
 14609
 14610***
 14611***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14612***
 14613
 14614     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14615         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14616            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14617             (1 + WS-TOL-LF-PREM-PCT)
 14618         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14619            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14620             (1 - WS-TOL-LF-PREM-PCT)
 14621     ELSE
 14622         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14623         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14624
 14625***
 14626***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14627***
 14628
 14629     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14630         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14631          WS-TOL-LF-PREM.
 14632
 14633     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14634         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 265
* EL050.cbl
 14635          WS-TOL-LF-PREM.
 14636
 14637     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14638        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14639
 14640     IF PB-REISSUED-CERT
 14641        or PB-POLICY-IS-DECLINED
 14642        or PB-POLICY-IS-VOIDED
 14643        continue
 14644     ELSE
 14645        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14646              > WS-TOL-LF-HIGH-PREM-AMT)
 14647           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14648              < WS-TOL-LF-LOW-PREM-AMT))
 14649                      or
 14650           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14651              > WS-TOL-LF-HIGH-PREM-PCT)
 14652           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14653              < WS-TOL-LF-LOW-PREM-PCT))
 14654           IF WS-PREM-REJECT-SW = SPACE
 14655              MOVE ER-2652       TO WS-ERROR
 14656              PERFORM 9900-ERROR-FORMAT
 14657                                 THRU 9900-EXIT
 14658           ELSE
 14659              MOVE ER-2650       TO WS-ERROR
 14660              PERFORM 9900-ERROR-FORMAT
 14661                                 THRU 9900-EXIT
 14662           end-if
 14663        end-if
 14664     end-if
 14665
 14666*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14667*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14668*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14669*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14670
 14671     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14672        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14673                      OR
 14674           ((PB-COMPANY-ID = 'DCC')
 14675           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14676           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14677           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14678        END-IF
 14679     END-IF
 14680
 14681     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14682        IF WS-COMP-MAX-CAP GREATER THAN +0
 14683           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14684              IF (PB-REISSUED-CERT         OR
 14685                  PB-POLICY-IS-DECLINED    OR
 14686                  PB-POLICY-IS-VOIDED)
 14687                 NEXT SENTENCE
 14688              ELSE
 14689                  MOVE ER-2646   TO  WS-ERROR
 14690                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14691
 14692 3344-CVL-TOLERANCE-CHECK.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 266
* EL050.cbl
 14693
 14694      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14695          GO TO 3344-CHECK-AH.
 14696
 14697      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14698          GO TO 3344-CHECK-AH.
 14699
 14700      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14701                                     WS-UNSIGN-WRK6.
 14702
 14703      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14704          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14705                                 + PB-I-LF-PREMIUM-AMT
 14706                                 - PB-I-LF-PREM-CALC.
 14707
 14708      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14709          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14710                                 + PB-I-LF-ALT-PREMIUM-AMT
 14711                                 - PB-I-LF-ALT-PREM-CALC.
 14712
 14713      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14714          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14715              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14716                 MOVE ER-2652    TO  WS-ERROR
 14717                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14718              ELSE
 14719                 MOVE ER-2650    TO  WS-ERROR
 14720                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14721
 14722      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14723          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14724              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14725                 MOVE ER-2652    TO  WS-ERROR
 14726                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14727              ELSE
 14728                 MOVE ER-2650    TO  WS-ERROR
 14729                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14730
 14731 3344-CHECK-AH.
 14732
 14733****************************************************************
 14734***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14735***
 14736
 14737     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14738         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14739             (1 + WS-TOL-AH-PREM-PCT)
 14740         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14741             (1 - WS-TOL-AH-PREM-PCT)
 14742     ELSE
 14743         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14744         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14745
 14746***
 14747***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14748***
 14749
 14750     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 267
* EL050.cbl
 14751         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14752
 14753     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14754         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14755
 14756     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14757        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14758
 14759     IF (PB-REISSUED-CERT)
 14760        OR (PB-POLICY-IS-DECLINED)
 14761        OR (PB-POLICY-IS-VOIDED)
 14762        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14763        CONTINUE
 14764     ELSE
 14765        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14766              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14767                          or
 14768           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14769              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14770           IF WS-PREM-REJECT-SW = SPACE
 14771              MOVE ER-3052       TO WS-ERROR
 14772              PERFORM 9900-ERROR-FORMAT
 14773                                 THRU 9900-EXIT
 14774           ELSE
 14775              MOVE ER-3050       TO WS-ERROR
 14776              PERFORM 9900-ERROR-FORMAT
 14777                                 THRU 9900-EXIT
 14778           END-IF
 14779        END-IF
 14780     END-IF
 14781     if (pb-company-id = 'DCC')
 14782        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14783        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14784        and (pb-i-policy-is-monthly)
 14785        compute ws-tol-ah-high-prem-amt =
 14786           pb-i-tot-fees-calc + ws-tol-ah-prem
 14787        compute ws-tol-ah-low-prem-amt =
 14788           pb-i-tot-fees-calc - ws-tol-ah-prem
 14789        if ws-tol-ah-prem-pct > zeros
 14790           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14791              (1 + ws-tol-ah-prem-pct)
 14792           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14793              (1 - ws-tol-ah-prem-pct)
 14794        else
 14795           move +9999999.99      to ws-tol-ah-high-prem-pct
 14796           move +0               to ws-tol-ah-low-prem-pct
 14797        end-if
 14798        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14799            or
 14800           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14801                          or
 14802           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14803           or
 14804           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14805            move er-3049         to ws-error
 14806           perform 9900-error-format
 14807                                 thru 9900-exit
 14808
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 268
* EL050.cbl
 14809        end-if
 14810     end-if
 14811     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14812         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14813             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14814             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14815
 14816     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14817        IF WS-COMP-MAX-CAP GREATER THAN +0
 14818           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14819              IF (PB-REISSUED-CERT         OR
 14820                  PB-POLICY-IS-DECLINED    OR
 14821                  PB-POLICY-IS-VOIDED)
 14822                 NEXT SENTENCE
 14823              ELSE
 14824                  MOVE ER-2646   TO  WS-ERROR
 14825                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14826
 14827     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14828        (WS-COMP-MAX-CAP EQUAL +0)
 14829           GO TO 3345-EDIT-CONTINUE.
 14830
 14831     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14832        GREATER THAN WS-COMP-MAX-CAP
 14833           MOVE ER-2646          TO  WS-ERROR
 14834           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14835
 14836 3345-EDIT-CONTINUE.
 14837
 14838*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14839*       IF PB-ENTRY-BATCH   NUMERIC
 14840*          IF PB-ISSUE
 14841*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14842*          ELSE
 14843*              IF PB-CANCELLATION
 14844*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14845
 14846*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14847*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14848*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14849*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14850*        ELSE
 14851*            MOVE  ER-1909            TO  WS-ERROR
 14852*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14853
 14854     IF PB-I-POLICY-ACCEPTED
 14855        IF PB-POLICY-IS-DECLINED  OR
 14856           PB-REISSUED-CERT  OR
 14857           PB-REIN-ONLY-CERT  OR
 14858           PB-POLICY-IS-VOIDED
 14859            MOVE  ER-1891         TO  WS-ERROR
 14860            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14861        ELSE
 14862            MOVE SPACE            TO  PB-BATCH-ENTRY
 14863            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14864
 14865     IF PB-I-POLICY-DECLINED
 14866        IF PB-REISSUED-CERT  OR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 269
* EL050.cbl
 14867           PB-REIN-ONLY-CERT  OR
 14868           PB-POLICY-IS-VOIDED
 14869            MOVE  ER-1906         TO  WS-ERROR
 14870            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14871        ELSE
 14872            MOVE  'D'             TO  PB-BATCH-ENTRY
 14873                                      PB-I-ENTRY-STATUS.
 14874
 14875     IF PB-I-NEEDS-UNDERWRITING
 14876        IF PB-POLICY-IS-DECLINED OR
 14877           PB-REISSUED-CERT  OR
 14878           PB-REIN-ONLY-CERT  OR
 14879           PB-POLICY-IS-VOIDED
 14880            MOVE  ER-1907         TO  WS-ERROR
 14881            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14882        ELSE
 14883            MOVE 'U'              TO  PB-BATCH-ENTRY
 14884                                      PB-I-ENTRY-STATUS.
 14885
 14886     IF PB-NEEDS-UNDERWRITING
 14887        MOVE  ER-1901             TO  WS-ERROR
 14888        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14889     IF PB-COMPANY-ID = 'DCC'
 14890        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14891        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14892        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14893           AND (NOT WS-LF-CASH))
 14894                           OR
 14895           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14896           AND (NOT WS-AH-CASH)))
 14897                       AND
 14898           (PB-I-ENTRY-STATUS NOT = '5')
 14899           MOVE 'M'              TO PB-BATCH-ENTRY
 14900                                    PB-I-ENTRY-STATUS
 14901        END-IF
 14902     END-IF
 14903     IF  PB-COMPANY-ID NOT = 'NCL'
 14904         GO TO 3999-END-EDIT.
 14905
 14906     IF PB-REISSUED-CERT  OR
 14907        PB-POLICY-IS-DECLINED  OR
 14908        PB-POLICY-IS-VOIDED  OR
 14909        PB-I-OB
 14910         GO TO 3999-END-EDIT.
 14911
 14912     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14913         MOVE  ER-2644            TO  WS-ERROR
 14914         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14915         GO TO 3999-END-EDIT.
 14916
 14917     MOVE 'N'                     TO  FORM-MASTER-SW.
 14918     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14919
 14920     IF NOT FORM-MASTER-FOUND
 14921         GO TO 3999-END-EDIT.
 14922
 14923     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14924                                      FORM-MASTER-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 270
* EL050.cbl
 14925
 14926     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14927         MOVE  +1                 TO SUB6
 14928         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14929
 14930     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14931         MOVE  +1                 TO SUB6
 14932         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14933
 14934     IF LF-FORM-MASTER-FOUND  OR
 14935        AH-FORM-MASTER-FOUND
 14936         GO TO 3360-CHECK-FORM-LIMITS
 14937     ELSE
 14938         GO TO 3999-END-EDIT.
 14939
 14940******************************************************************
 14941*                  3350-GET-ERFORM                               *
 14942*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14943*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14944******************************************************************
 14945
 14946 3350-GET-ERFORM.
 14947
 14948     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14949         GO TO  3350-ERFORM-GETMAIN.
 14950
 14951     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14952     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14953     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14954     MOVE 'Y'                     TO FORM-MASTER-SW.
 14955
 14956     IF PB-CANCELLATION
 14957         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14958            PB-SV-STATE          EQUAL   FO-STATE       AND
 14959            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14960              GO TO 3350-EXIT
 14961         ELSE
 14962             NEXT SENTENCE
 14963     ELSE
 14964         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14965            PB-SV-STATE          EQUAL   FO-STATE       AND
 14966            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14967              GO TO 3350-EXIT.
 14968
 14969 3350-ERFORM-GETMAIN.
 14970
 14971     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14972     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14973
 14974 3350-ERFORM-READ.
 14975
 14976     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14977     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14978     IF PB-CANCELLATION
 14979         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14980     ELSE
 14981         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14982     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 271
* EL050.cbl
 14983
 14984     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14985
 14986     IF FORM-MASTER-FOUND
 14987       IF PB-CANCELLATION
 14988          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14989             PB-SV-STATE          EQUAL   FO-STATE       AND
 14990             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14991              GO  TO 3350-EXIT
 14992          ELSE
 14993              NEXT SENTENCE
 14994       ELSE
 14995          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14996             PB-SV-STATE          EQUAL   FO-STATE       AND
 14997             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14998              GO  TO 3350-EXIT.
 14999
 15000     MOVE  'N'                    TO  FORM-MASTER-SW.
 15001     MOVE  ER-1895                TO  WS-ERROR.
 15002     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15003
 15004 3350-EXIT.
 15005      EXIT.
 15006
 15007******************************************************************
 15008*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15009*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15010*   VALID FOR THE POLICY FORM USED.                              *
 15011******************************************************************
 15012
 15013 3355-EDIT-FORM-LF-BENEFITS.
 15014
 15015     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15016        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15017         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15018         GO TO   3355-EXIT.
 15019
 15020     IF  SUB6    LESS THAN   +40
 15021         ADD  +1      TO  SUB6
 15022         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15023
 15024     MOVE  ER-1896         TO  WS-ERROR.
 15025     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15026
 15027 3355-EXIT.
 15028      EXIT.
 15029
 15030******************************************************************
 15031*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15032*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15033*   VALID FOR THE POLICY FORM USED.                              *
 15034******************************************************************
 15035
 15036 3356-EDIT-FORM-AH-BENEFITS.
 15037
 15038     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15039        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15040         MOVE  'Y'                TO  FORM-MASTER-AH-SW
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 272
* EL050.cbl
 15041         GO TO  3356-EXIT.
 15042
 15043      IF  SUB6    LESS THAN     +40
 15044          ADD  +1      TO  SUB6
 15045          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15046
 15047     MOVE  ER-1897         TO  WS-ERROR.
 15048     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15049
 15050 3356-EXIT.
 15051      EXIT.
 15052
 15053******************************************************************
 15054*                  3357-BENEFIT-SEARCH                           *
 15055*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15056*   CANCELLATIONS ONLY.                                          *
 15057******************************************************************
 15058 3357-BENEFIT-SEARCH.
 15059     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15060         MOVE +1                          TO SUB6
 15061         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15062
 15063     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15064         MOVE +1                          TO SUB6
 15065         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15066
 15067 3357-EXIT.
 15068     EXIT.
 15069
 15070******************************************************************
 15071*                  3358-BENEFIT-LIFE-SEARCH                      *
 15072*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15073*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15074*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15075******************************************************************
 15076 3358-BENEFIT-LIFE-SEARCH.
 15077     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15078       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15079         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15080           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15081              IF FO-PLAN-REFUND-METHOD (SUB6)
 15082                     IS GREATER THAN SPACES
 15083                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15084                                          WS-LF-REFUND-CALC
 15085                 GO TO 3358-EXIT.
 15086
 15087     IF SUB6 LESS THAN +40
 15088         ADD +1                 TO SUB6
 15089         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15090
 15091 3358-EXIT.
 15092     EXIT.
 15093******************************************************************
 15094*                  3359-BENEFIT-AH-SEARCH                        *
 15095*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15096*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15097*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15098******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 273
* EL050.cbl
 15099 3359-BENEFIT-AH-SEARCH.
 15100     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15101       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15102         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15103           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15104              IF FO-PLAN-REFUND-METHOD (SUB6)
 15105                      IS GREATER THAN SPACES
 15106                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15107                                          WS-AH-REFUND-CALC
 15108                 GO TO 3359-EXIT.
 15109
 15110     IF SUB6 LESS THAN +40
 15111         ADD +1                 TO SUB6
 15112         GO TO 3359-BENEFIT-AH-SEARCH.
 15113
 15114 3359-EXIT.
 15115     EXIT.
 15116
 15117******************************************************************
 15118*                  3360-CHECK-FORM-LIMITS                        *
 15119*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15120*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15121******************************************************************
 15122
 15123 3360-CHECK-FORM-LIMITS.
 15124
 15125     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15126         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15127
 15128     IF NOT LF-FORM-MASTER-FOUND
 15129         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15130
 15131 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15132
 15133     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15134       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15135        WS-LF-JOINT-INDICATOR = 'J'  AND
 15136        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15137         IF PB-COMPANY-ID = 'NCL'
 15138            MOVE  ER-1911          TO  WS-ERROR
 15139            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15140         ELSE
 15141            MOVE  ER-1892          TO  WS-ERROR
 15142            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15143
 15144 3360-CHECK-FORM-LF-ATT-AGE.
 15145
 15146     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15147
 15148     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15149         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15150         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15151            IF PB-COMPANY-ID = 'NCL'
 15152                MOVE  ER-1913      TO  WS-ERROR
 15153                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15154            ELSE
 15155                MOVE  ER-1894      TO  WS-ERROR
 15156                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 274
* EL050.cbl
 15157
 15158 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15159
 15160     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15161         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15162         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15163            IF PB-COMPANY-ID = 'NCL'
 15164                MOVE  ER-1914      TO  WS-ERROR
 15165                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15166            ELSE
 15167                MOVE  ER-1899      TO  WS-ERROR
 15168                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15169
 15170 3360-CHECK-FORM-LF-TERM-BAMT.
 15171
 15172     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15173         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15174         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15175           IF  PB-COMPANY-ID = 'NCL'
 15176               MOVE  ER-1916       TO  WS-ERROR
 15177               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15178           ELSE
 15179               MOVE  ER-1902       TO  WS-ERROR
 15180               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15181
 15182     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15183                                    PB-I-LF-ALT-BENEFIT-AMT.
 15184
 15185     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15186         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15187         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15188             IF  PB-COMPANY-ID = 'NCL'
 15189                 MOVE  ER-1918     TO  WS-ERROR
 15190                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15191             ELSE
 15192                 MOVE  ER-1904     TO  WS-ERROR
 15193                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15194
 15195******************************************************************
 15196*                  3360-CHECK-FORM-AH-LIMITS                     *
 15197*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15198*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15199******************************************************************
 15200
 15201 3360-CHECK-FORM-AH-LIMITS.
 15202
 15203     IF NOT AH-FORM-MASTER-FOUND
 15204         GO TO 3999-END-EDIT.
 15205
 15206 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15207
 15208     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15209       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15210        WS-AH-JOINT-INDICATOR = 'J'  AND
 15211        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15212         IF PB-COMPANY-ID = 'NCL'
 15213            MOVE  ER-1912          TO  WS-ERROR
 15214            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 275
* EL050.cbl
 15215         ELSE
 15216            MOVE  ER-1893          TO  WS-ERROR
 15217            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15218
 15219 3360-CHECK-FORM-AH-ATT-AGE.
 15220
 15221     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15222
 15223     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15224         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15225         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15226            IF PB-COMPANY-ID = 'NCL'
 15227                MOVE  ER-1913      TO  WS-ERROR
 15228                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15229            ELSE
 15230                MOVE  ER-1894      TO  WS-ERROR
 15231                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15232
 15233 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15234
 15235     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15236         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15237         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15238            IF PB-COMPANY-ID = 'NCL'
 15239                MOVE  ER-1915      TO  WS-ERROR
 15240                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15241            ELSE
 15242                MOVE  ER-1900      TO  WS-ERROR
 15243                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15244
 15245 3360-CHECK-FORM-AH-TERM-BAMT.
 15246
 15247     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15248         FO-AH-MAX-TERM    GREATER THAN  +0
 15249         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15250             IF  PB-COMPANY-ID = 'NCL'
 15251                 MOVE  ER-1917     TO  WS-ERROR
 15252                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15253             ELSE
 15254                  MOVE  ER-1903    TO  WS-ERROR
 15255                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15256
 15257     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15258         FO-MAX-AH-AMT    GREATER THAN  +0
 15259         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15260             IF  PB-COMPANY-ID = 'NCL'
 15261                 MOVE  ER-1919     TO  WS-ERROR
 15262                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15263             ELSE
 15264                 MOVE  ER-1905     TO  WS-ERROR
 15265                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15266
 15267     GO TO 3999-END-EDIT.
 15268
 15269******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 276
* EL050.cbl
 15271******************************************************************
 15272*                  E D I T   C A N C E L                         *
 15273******************************************************************
 15274
 15275 3700-EDIT-CANCEL.
 15276     IF PB-COMPANY-ID = 'DMD'
 15277         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15278                                         WS-RES-MUNI-TAX
 15279                                         PB-CI-STATE-TAX
 15280                                         PB-CI-MUNI-TAX
 15281         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15282
 15283*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15284*       IF PB-ENTRY-BATCH  NUMERIC
 15285*          IF PB-CANCELLATION
 15286*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15287*          ELSE
 15288*             IF PB-ISSUE
 15289*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15290
 15291     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15292        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15293     END-IF
 15294*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15295*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15296
 15297     IF CM-ENTRY-STATUS = 'V'
 15298        MOVE ER-2780             TO WS-ERROR
 15299        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15300        GO TO 3999-END-EDIT.
 15301
 15302     IF CM-ENTRY-STATUS = 'D'
 15303        MOVE ER-2781             TO WS-ERROR
 15304        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15305        GO TO 3999-END-EDIT.
 15306
 15307     IF CM-ENTRY-STATUS = 'U'
 15308        MOVE ER-2782             TO WS-ERROR
 15309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15310
 15311***************************************************************
 15312*                                                             *
 15313*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15314*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15315*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15316*   OF ANOTHER COVERAGE.                                      *
 15317*                                                             *
 15318***************************************************************
 15319
 15320     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15321                                    PB-C-AH-CANCEL-VOID-SW.
 15322
 15323     IF PB-C-LF-CANCEL-AMT = ZERO
 15324        NEXT SENTENCE
 15325     ELSE
 15326        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15327           AND
 15328           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 277
* EL050.cbl
 15329               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15330               MOVE ER-2745           TO WS-ERROR
 15331               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15332
 15333     IF PB-C-AH-CANCEL-AMT = ZERO
 15334        NEXT SENTENCE
 15335     ELSE
 15336        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15337           AND
 15338           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15339               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15340               MOVE ER-2745           TO WS-ERROR
 15341               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15342
 15343     IF WS-LF-EARNINGS-CALC = '4'
 15344        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15345
 15346     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15347     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15348     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15349     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15350     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15351     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15352
 15353     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15354                                      PB-C-AH-REF-CALC.
 15355     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15356
 15357******************************************************************
 15358*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15359*             TO VALIDATE COVERAGE.                              *
 15360******************************************************************
 15361
 15362     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15363        PB-C-LF-CANCEL-AMT = ZEROS
 15364          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15365      ELSE
 15366          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15367
 15368     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15369        PB-C-AH-CANCEL-AMT = ZEROS
 15370          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15371      ELSE
 15372          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15373
 15374     EVALUATE TRUE
 15375         WHEN PB-CANCEL-FORCE             OR
 15376              PB-CANCEL-DATE-FORCED       OR
 15377              PB-FORCE-OFF
 15378                  IF PB-COMPANY-ID = 'ACE'
 15379                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15380                  END-IF
 15381         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15382               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15383              (PB-COMPANY-ID = 'ACE' )
 15384                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15385         WHEN OTHER
 15386              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 278
* EL050.cbl
 15387                 MOVE ER-2794              TO WS-ERROR
 15388              ELSE
 15389                 MOVE ER-2749              TO WS-ERROR
 15390              END-IF
 15391              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15392     END-EVALUATE.
 15393
 15394
 15395*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15396*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15397*            MOVE  ER-1909            TO  WS-ERROR
 15398*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15399*        ELSE
 15400*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15401
 15402     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15403     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15404        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15405     ELSE
 15406        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15407     END-IF
 15408     .
 15409 3705-EDIT-CANCEL-DT.
 15410
 15411     IF LF-COVERAGE-CANCELLED
 15412        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15413         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15414         MOVE WS-CURRENT-MONTH-END
 15415                                 TO DC-BIN-DATE-2
 15416         SET ELAPSED-BETWEEN-BIN TO TRUE
 15417*        MOVE 1                  TO DC-OPTION-CODE
 15418         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15419         IF DATE-CONVERSION-ERROR
 15420            NEXT SENTENCE
 15421          ELSE
 15422             IF DC-ELAPSED-DAYS GREATER +180
 15423                IF PB-CANCEL-DATE-FORCED  OR
 15424                   PB-CANCEL-DATE-FORCED-NO-FEE
 15425                      MOVE ER-2751  TO WS-ERROR
 15426                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15427                 ELSE
 15428                   MOVE ER-2752  TO WS-ERROR
 15429                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15430
 15431     IF AH-COVERAGE-CANCELLED
 15432        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15433         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15434         MOVE WS-CURRENT-MONTH-END
 15435                                 TO DC-BIN-DATE-2
 15436         SET ELAPSED-BETWEEN-BIN TO TRUE
 15437*        MOVE 1                  TO DC-OPTION-CODE
 15438         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15439         IF DATE-CONVERSION-ERROR
 15440            NEXT SENTENCE
 15441          ELSE
 15442             IF DC-ELAPSED-DAYS GREATER +180
 15443                IF PB-CANCEL-DATE-FORCED OR
 15444                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 279
* EL050.cbl
 15445                      MOVE ER-2751  TO WS-ERROR
 15446                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15447                 ELSE
 15448                   MOVE ER-2752  TO WS-ERROR
 15449                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15450
 15451     IF WS-ERROR = ER-2752
 15452        AND (PB-COMPANY-ID = 'ABL'
 15453         OR  PB-COMPANY-ID = 'FGL'
 15454         OR  PB-COMPANY-ID = 'IST'
 15455         OR  PB-COMPANY-ID = 'JHL'
 15456         OR  PB-COMPANY-ID = 'LAP'
 15457         OR  PB-COMPANY-ID = 'LBL'
 15458         OR  PB-COMPANY-ID = 'NCB'
 15459         OR  PB-COMPANY-ID = 'NLI'
 15460         OR  PB-COMPANY-ID = 'OFI'
 15461         OR  PB-COMPANY-ID = 'PLI'
 15462         OR  PB-COMPANY-ID = 'TAO'
 15463         OR  PB-COMPANY-ID = 'TIC'
 15464         OR  PB-COMPANY-ID = 'HER'
 15465         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15466         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15467            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15468            MOVE ER-2762     TO WS-ERROR
 15469            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15470
 15471     IF LF-COVERAGE-CANCELLED
 15472        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15473        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15474             MOVE ER-2733         TO WS-ERROR
 15475             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15476
 15477     IF AH-COVERAGE-CANCELLED
 15478        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15479        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15480              MOVE ER-2733        TO WS-ERROR
 15481              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15482
 15483     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15484        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15485        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15486           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15487            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15488              IF PB-COMPANY-ID NOT = 'LAP'
 15489               MOVE ER-2704            TO WS-ERROR
 15490               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15491
 15492     IF CERT-WAS-NOT-FOUND
 15493         GO TO 3999-END-EDIT.
 15494
 15495     IF PB-COMPANY-ID EQUAL 'CDC'
 15496        IF LF-COVERAGE-CANCELLED
 15497           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15498            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15499            MOVE PB-C-LF-CANCEL-DT
 15500                                 TO DC-BIN-DATE-2
 15501            SET ELAPSED-BETWEEN-BIN TO TRUE
 15502*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 280
* EL050.cbl
 15503            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15504            IF DATE-CONVERSION-ERROR
 15505               NEXT SENTENCE
 15506             ELSE
 15507                IF DC-ELAPSED-DAYS GREATER +60
 15508                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15509
 15510     IF PB-COMPANY-ID EQUAL 'CDC'
 15511        IF AH-COVERAGE-CANCELLED
 15512           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15513            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15514            MOVE PB-C-AH-CANCEL-DT
 15515                                 TO DC-BIN-DATE-2
 15516            MOVE +0              TO DC-ELAPSED-DAYS
 15517                                    DC-ELAPSED-MONTHS
 15518            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15519*           MOVE 1               TO DC-OPTION-CODE
 15520            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15521            IF DATE-CONVERSION-ERROR
 15522               NEXT SENTENCE
 15523             ELSE
 15524                IF DC-ELAPSED-DAYS GREATER +60
 15525                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15526
 15527     MOVE +0                     TO DC-ELAPSED-DAYS
 15528                                    DC-ELAPSED-MONTHS.
 15529
 15530     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15531        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15532          MOVE 'Z'                TO PB-CI-OB-FLAG
 15533          MOVE ER-2767            TO WS-ERROR
 15534          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15535          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15536          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15537          GO TO 3775-OVER-REF-CHK
 15538        ELSE
 15539          MOVE ZEROS              TO PB-CI-LIVES
 15540                                     PB-C-LIVES
 15541          IF PB-CI-OB-FLAG NOT = 'B'
 15542             MOVE SPACE           TO PB-CI-OB-FLAG.
 15543
 15544     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15545         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15546     ELSE
 15547         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15548
 15549     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15550        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15551            MOVE ER-2760         TO WS-ERROR
 15552            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15553
 15554     IF LF-COVERAGE-CANCELLED
 15555        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15556         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15557            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15558               MOVE ER-2774       TO WS-ERROR
 15559               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15560
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 281
* EL050.cbl
 15561     IF AH-COVERAGE-CANCELLED
 15562        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15563         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15564            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15565               MOVE ER-2775       TO WS-ERROR
 15566               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15567
 15568     IF LF-COVERAGE-CANCELLED
 15569        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15570         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15571            MOVE ER-2776         TO WS-ERROR
 15572            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15573
 15574     IF AH-COVERAGE-CANCELLED
 15575        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15576         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15577            MOVE ER-2777         TO WS-ERROR
 15578            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15579
 15580     IF LF-COVERAGE-CANCELLED
 15581        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15582        if pb-ci-lf-expire-dt = low-values or spaces
 15583           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15584           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15585           MOVE PB-CI-EXTENTION-DAYS
 15586                                 TO DC-ELAPSED-DAYS
 15587           SET BIN-PLUS-ELAPSED  TO TRUE
 15588           PERFORM 8500-DATE-CONVERT
 15589                                 THRU 8500-EXIT
 15590           IF DATE-CONVERSION-ERROR
 15591              move low-values    to dc-bin-date-2
 15592           end-if
 15593        else
 15594           move pb-ci-lf-expire-dt
 15595                                 to dc-bin-date-2
 15596        end-if
 15597        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15598           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15599                             OR  'FIA'
 15600              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15601           ELSE
 15602              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15603              MOVE ER-2731       TO WS-ERROR
 15604              PERFORM 9900-ERROR-FORMAT
 15605                                 THRU 9900-EXIT
 15606           end-if
 15607        end-if
 15608     end-if
 15609*    IF LF-COVERAGE-CANCELLED
 15610*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15611*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15612*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15613*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15614*        SET BIN-PLUS-ELAPSED      TO TRUE
 15615*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15616*        IF DATE-CONVERSION-ERROR
 15617*           NEXT SENTENCE
 15618*         ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 282
* EL050.cbl
 15619*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15620*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15621*                            OR  'FIA'
 15622*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15623*              ELSE
 15624*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15625*               MOVE ER-2731       TO WS-ERROR
 15626*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15627     .
 15628 3705-EDIT-AH-CANCEL-DT.
 15629     IF AH-COVERAGE-CANCELLED
 15630        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15631        if pb-ci-AH-expire-dt = low-values or spaces
 15632           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15633           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15634           MOVE PB-CI-EXTENTION-DAYS
 15635                                 TO DC-ELAPSED-DAYS
 15636           SET BIN-PLUS-ELAPSED  TO TRUE
 15637           PERFORM 8500-DATE-CONVERT
 15638                                 THRU 8500-EXIT
 15639           IF DATE-CONVERSION-ERROR
 15640              move low-values    to dc-bin-date-2
 15641           end-if
 15642        else
 15643           move pb-ci-ah-expire-dt
 15644                                 to dc-bin-date-2
 15645        end-if
 15646        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15647           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15648                             OR  'FIA'
 15649              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15650           ELSE
 15651              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15652              MOVE ER-2771       TO WS-ERROR
 15653              PERFORM 9900-ERROR-FORMAT
 15654                                 THRU 9900-EXIT
 15655           end-if
 15656        end-if
 15657     end-if
 15658*    IF AH-COVERAGE-CANCELLED
 15659*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15660*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15661*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15662*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15663**       MOVE 6                    TO DC-OPTION-CODE
 15664*        SET BIN-PLUS-ELAPSED      TO TRUE
 15665*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15666*        IF DATE-CONVERSION-ERROR
 15667*           NEXT SENTENCE
 15668*         ELSE
 15669*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15670*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15671*                             OR 'FIA'
 15672*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15673*             ELSE
 15674*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15675*              MOVE ER-2771       TO WS-ERROR
 15676*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 283
* EL050.cbl
 15677     .
 15678 3705-EDIT-CONTINUED.
 15679
 15680*    IF LF-COVERAGE-CANCELLED
 15681*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15682*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15683*            MOVE ER-2727         TO WS-ERROR
 15684*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15685*
 15686*    IF AH-COVERAGE-CANCELLED
 15687*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15688*        IF PB-COMPANY-ID = 'ACE'
 15689*           MOVE ER-2727        TO WS-ERROR
 15690*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15691*        ELSE
 15692*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15693*              MOVE ER-2727     TO WS-ERROR
 15694*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15695
 15696     IF PB-COMPANY-ID = 'ACE'
 15697       IF AH-COVERAGE-CANCELLED
 15698         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15699           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15700              MOVE ER-2732      TO WS-ERROR
 15701              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15702
 15703     IF PB-COMPANY-ID      EQUAL   'HER'
 15704        IF WS-ERROR        EQUAL   ER-2727
 15705            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15706            MOVE  ER-2725          TO  WS-ERROR
 15707            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15708
 15709     IF PB-C-CLAIM-CREATED-CANCEL
 15710            MOVE ER-2748         TO WS-ERROR
 15711            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15712
 15713     IF PB-C-LAST-NAME NOT = SPACES
 15714         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15715            MOVE ER-2747         TO WS-ERROR
 15716            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15717
 15718 3710-EDIT-LUMP-SUM-PRIOR.
 15719
 15720     IF AH-COVERAGE-CANCELLED
 15721         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15722             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15723                MOVE ER-2735    TO WS-ERROR
 15724                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15725
 15726     IF LF-COVERAGE-CANCELLED
 15727         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15728             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15729                MOVE ER-2735    TO WS-ERROR
 15730                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15731
 15732 3710-EDIT-PRIOR-DEATH.
 15733
 15734*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 284
* EL050.cbl
 15735*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15736*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15737*           (NOT PB-CI-OB)
 15738*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15739*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15740*                   MOVE ER-2732  TO WS-ERROR
 15741*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15742*
 15743*    IF AH-COVERAGE-CANCELLED
 15744*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15745*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15746*           (NOT PB-CI-OB)
 15747*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15748*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15749*                   MOVE ER-2732  TO WS-ERROR
 15750*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15751
 15752     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15753         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15754            (NOT PB-COMP-LF-CANCEL)
 15755             NEXT SENTENCE
 15756         ELSE
 15757           IF PB-C-LF-CANCEL-VOIDED
 15758              NEXT SENTENCE
 15759           ELSE
 15760              MOVE ER-2753      TO WS-ERROR
 15761              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15762
 15763     IF CANCEL-FUTURE-DT
 15764         GO TO 3999-END-EDIT.
 15765
 15766 3715-GET-REMAIN-TERM-LF.
 15767
 15768     IF NO-LF-BENEFIT-MATCH  OR
 15769        WS-LF-BENEFIT-CD = ZEROS
 15770        GO TO 3730-GET-AH-REMAIN-TERM.
 15771
 15772     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15773     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15774     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15775     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15776     MOVE PB-SV-STATE            TO CP-STATE.
 15777     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15778     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15779     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15780     MOVE '2'                    TO CP-PROCESS-TYPE.
 15781     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15782     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15783     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15784     IF (PB-COMPANY-ID = 'CID')
 15785        AND (CP-STATE-STD-ABBRV = 'WI')
 15786        MOVE '7'                 TO CP-REM-TERM-METHOD
 15787        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15788     ELSE
 15789        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15790        MOVE WS-REM-TRM-CALC-OPTION
 15791                                 TO CP-REM-TRM-CALC-OPTION
 15792     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 285
* EL050.cbl
 15793**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15794     IF (PB-COMPANY-ID = 'CID')
 15795        AND (CP-STATE-STD-ABBRV = 'MO')
 15796        AND (PB-CERT-EFF-DT >= X'9B41')
 15797        AND (PB-CERT-EFF-DT <= X'A2FB')
 15798        MOVE '7'                 TO CP-REM-TERM-METHOD
 15799        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15800     END-IF
 15801     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15802                                    CP-LOAN-TERM.
 15803     IF CP-TRUNCATED-LIFE
 15804        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15805
 15806     IF CP-TERM-IS-DAYS
 15807         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15808     ELSE
 15809         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15810
 15811     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15812
 15813     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15814
 15815     IF LF-COVERAGE-CANCELLED
 15816        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15817        NEXT SENTENCE
 15818      ELSE
 15819          GO TO 3730-GET-AH-REMAIN-TERM.
 15820
 15821 3720-GET-LF-REFUND.
 15822
 15823     IF PB-C-LF-CANCEL-VOIDED
 15824        GO TO 3730-GET-AH-REMAIN-TERM
 15825     end-if
 15826
 15827     IF PB-COMPANY-ID EQUAL 'BOA'
 15828         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15829         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15830         GO TO 3730-GET-AH-REMAIN-TERM.
 15831
 15832     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15833        (WS-AH-SPECIAL-CALC-CD = 'M')
 15834         MOVE ER-2767            TO WS-ERROR
 15835         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15836         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15837         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15838         GO TO 3780-UPDATE-CANCEL-CERT.
 15839
 15840*    if (ws-lf-earnings-calc = '6')
 15841*       or (pb-c-lf-refund-override = '6')
 15842*       move cp-remaining-term-1 to cp-remaining-term-2
 15843*    end-if
 15844     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15845
 15846     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15847     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15848     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15849     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15850     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 286
* EL050.cbl
 15851     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15852     IF (PB-COMPANY-ID = 'DCC')
 15853        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15854        IF PDEF-MASTER-FOUND
 15855           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15856              (V1 > +8)
 15857              OR (PD-PROD-CODE (V1) = 'L')
 15858           END-PERFORM
 15859           IF V1 < +9
 15860              MOVE PD-MAX-AMT (V1)
 15861                           TO CP-R-MAX-TOT-BEN
 15862                              EC-AM-LF-MAX-TOT-BEN
 15863           END-IF
 15864        ELSE
 15865        MOVE ' '                 TO PDEF-MASTER-SW
 15866        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15867        MOVE PB-STATE            TO ERPDEF-STATE
 15868        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15869        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15870        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15871        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15872        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15873        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15874        IF PDEF-MASTER-FOUND
 15875           MOVE 'N'              TO PDEF-MASTER-SW
 15876           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15877           IF PDEF-MASTER-FOUND
 15878              IF (ERPDEF-KEY-SAVE (1:16) =
 15879                           PD-CONTROL-PRIMARY (1:16))
 15880                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15881                 CONTINUE
 15882              ELSE
 15883                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15884                 IF (ERPDEF-KEY-SAVE (1:16) =
 15885                           PD-CONTROL-PRIMARY (1:16))
 15886                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15887                    CONTINUE
 15888                 ELSE
 15889                    MOVE 'N'     TO PDEF-MASTER-SW
 15890                 END-IF
 15891              END-IF
 15892
 15893              IF PDEF-MASTER-FOUND
 15894                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15895                    (V1 > +8)
 15896                    OR (PD-PROD-CODE (V1) = 'L')
 15897                 END-PERFORM
 15898                 IF V1 < +9
 15899                    MOVE PD-MAX-AMT (V1)
 15900                                 TO CP-R-MAX-TOT-BEN
 15901                                    EC-AM-LF-MAX-TOT-BEN
 15902                 END-IF
 15903              END-IF
 15904           END-IF
 15905           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15906        END-IF
 15907        END-IF
 15908     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 287
* EL050.cbl
 15909     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15910
 15911     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15912
 15913     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15914                                    PB-C-LF-REM-TERM.
 15915
 15916     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15917     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15918
 15919     IF PB-COMPANY-ID EQUAL 'FLC'
 15920        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15921           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15922           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15923                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15924                    - CM-LF-ITD-DEATH-AMT
 15925           IF PB-C-LF-REF-CALC LESS THAN +0
 15926              MOVE +0            TO PB-C-LF-REF-CALC
 15927              GO TO 3730-GET-AH-REMAIN-TERM
 15928           ELSE
 15929              GO TO 3730-GET-AH-REMAIN-TERM.
 15930
 15931     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15932                            OR '4' OR '5' OR '6' OR '8'
 15933                            OR '9' OR 'G'
 15934        MOVE PB-C-LF-REFUND-OVERRIDE
 15935                                 TO CP-EARNING-METHOD.
 15936
 15937     if pb-company-id = 'AHL'
 15938        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15939        if cp-class-code = spaces
 15940           move zeros            to cp-class-code
 15941        end-if
 15942     ELSE
 15943        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15944     END-IF
 15945*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15946     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15947     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15948                                    CP-RATING-BENEFIT-AMT.
 15949     IF CP-STATE-STD-ABBRV = 'OR'
 15950         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15951                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15952     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15953     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15954     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15955     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15956     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15957     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15958     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15959     IF WS-DEFAULT-APR NOT NUMERIC
 15960         MOVE ZEROS TO WS-DEFAULT-APR.
 15961****   N O T E   ****
 15962*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15963*      THE OH HARD CODING IN ELCRFNDP
 15964
 15965     IF PB-COMPANY-ID = 'CID'
 15966        IF CP-STATE-STD-ABBRV = 'OH'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 288
* EL050.cbl
 15967           MOVE WS-LF-EARNINGS-CALC
 15968                                 TO CP-EARNING-METHOD
 15969        END-IF
 15970     END-IF
 15971
 15972****   N O T E   ****
 15973
 15974     IF CP-EARN-AS-NET-PAY
 15975         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15976            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15977                MOVE WS-DEFAULT-APR
 15978                                 TO  CP-LOAN-APR
 15979                MOVE ER-3780     TO  WS-ERROR
 15980                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15981            ELSE
 15982                MOVE ER-3781     TO  WS-ERROR
 15983                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15984*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15985     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15986
 15987     IF CP-REFUND-TYPE-USED NOT = SPACE
 15988         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15989
 15990     IF CP-ERROR-RATE-IS-ZERO OR
 15991        CP-ERROR-RATE-NOT-FOUND
 15992        MOVE ER-2740             TO WS-ERROR
 15993        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15994
 15995     IF CP-ERROR-RATE-FILE-NOTOPEN
 15996        MOVE ER-2617             TO WS-ERROR
 15997        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15998
 15999     IF PB-COMPANY-ID = 'DCC'
 16000        AND PB-CI-ENTRY-STATUS = 'M'
 16001        MOVE +0                  TO PB-C-LF-REF-CALC
 16002     ELSE
 16003        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16004     END-IF
 16005
 16006     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16007         GO TO 3730-GET-AH-REMAIN-TERM.
 16008
 16009*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16010*       ADD +1                   TO PB-C-LF-REM-TERM
 16011*                                   CP-REMAINING-TERM
 16012*                                   CP-ORIGINAL-TERM.
 16013
 16014     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16015     MOVE '2'                    TO CP-EARNING-METHOD
 16016                                    CP-RATING-METHOD.
 16017     IF PB-COMPANY-ID = 'CID'
 16018        IF (CP-STATE-STD-ABBRV = 'MN')
 16019           AND (PB-CERT-EFF-DT > X'A4FF')
 16020           AND (WS-LF-EARNINGS-CALC = 'B')
 16021           MOVE '5'              TO CP-EARNING-METHOD
 16022           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16023        END-IF
 16024     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 289
* EL050.cbl
 16025     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16026                                        CP-REMAINING-BENEFIT
 16027                                        CP-RATING-BENEFIT-AMT.
 16028     IF CP-STATE-STD-ABBRV = 'OR'
 16029         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16030                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16031     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16032     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16033
 16034     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16035
 16036     IF CP-ERROR-RATE-IS-ZERO OR
 16037        CP-ERROR-RATE-NOT-FOUND
 16038        MOVE ER-2740             TO WS-ERROR
 16039        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16040
 16041     IF CP-ERROR-RATE-FILE-NOTOPEN
 16042        MOVE ER-2617             TO WS-ERROR
 16043        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16044
 16045     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16046
 16047******************************************************************
 16048
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 290
* EL050.cbl
 16050 3730-GET-AH-REMAIN-TERM.
 16051     IF NO-AH-BENEFIT-MATCH  OR
 16052        WS-AH-BENEFIT-CD = ZEROS
 16053         GO TO 3770-CHECK-REFUNDS.
 16054
 16055     IF PB-CI-AH-LUMP-SUM-DISAB
 16056         IF  PB-C-AH-CANCEL-AMT = ZERO
 16057            IF NOT PB-COMP-AH-CANCEL
 16058             GO TO 3770-CHECK-REFUNDS.
 16059
 16060     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16061     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16062     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16063     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16064     MOVE PB-SV-STATE            TO CP-STATE.
 16065     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16066     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16067     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16068     MOVE '2'                    TO CP-PROCESS-TYPE.
 16069     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16070     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16071     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16072     IF (PB-COMPANY-ID = 'CID')
 16073        AND (CP-STATE-STD-ABBRV = 'WI')
 16074        MOVE '7'                 TO CP-REM-TERM-METHOD
 16075        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16076     ELSE
 16077        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16078        MOVE WS-REM-TRM-CALC-OPTION
 16079                                 TO CP-REM-TRM-CALC-OPTION
 16080     END-IF
 16081     IF (PB-COMPANY-ID = 'CID')
 16082        AND (CP-STATE-STD-ABBRV = 'MO')
 16083        AND (PB-CERT-EFF-DT >= X'9B41')
 16084        AND (PB-CERT-EFF-DT <= X'A2FB')
 16085        MOVE '7'                 TO CP-REM-TERM-METHOD
 16086        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16087     END-IF
 16088     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16089                                    CP-LOAN-TERM.
 16090     IF NOT CP-TERM-IS-DAYS
 16091         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16092
 16093     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16094
 16095     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16096
 16097     IF AH-COVERAGE-CANCELLED
 16098        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16099        NEXT SENTENCE
 16100      ELSE
 16101         GO TO 3770-CHECK-REFUNDS.
 16102
 16103 3740-GET-AH-REFUND.
 16104
 16105     IF PB-C-AH-CANCEL-VOIDED
 16106        GO TO 3780-UPDATE-CANCEL-CERT
 16107     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 291
* EL050.cbl
 16108
 16109     IF PB-COMPANY-ID = 'BOA'
 16110         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16111         GO TO 3770-CHECK-REFUNDS.
 16112
 16113     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16114*    MOVE ' '                    TO DC-OPTION-CODE
 16115     SET BIN-TO-GREG             TO TRUE
 16116     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16117     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16118                                    PB-C-AH-REM-TERM.
 16119     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16120     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16121
 16122     IF PB-COMPANY-ID EQUAL 'FLC'
 16123        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16124           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16125           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16126                    - CM-AH-ITD-AH-PMT)
 16127           IF PB-C-AH-REF-CALC LESS THAN +0
 16128              MOVE +0            TO PB-C-AH-REF-CALC
 16129              GO TO 3770-CHECK-REFUNDS
 16130           ELSE
 16131              GO TO 3770-CHECK-REFUNDS.
 16132
 16133     IF PB-COMPANY-ID = 'DCC'
 16134        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16135            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16136           MOVE 'S'              TO CP-EARNING-METHOD
 16137        END-IF
 16138     END-IF
 16139     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16140                            OR '4' OR '5' OR '6' OR '8'
 16141                            OR '9' OR 'G' OR 'S'
 16142        MOVE PB-C-AH-REFUND-OVERRIDE
 16143                                 TO CP-EARNING-METHOD.
 16144
 16145     if pb-company-id = 'AHL'
 16146        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16147        if cp-class-code = spaces
 16148           move zeros            to cp-class-code
 16149        end-if
 16150     ELSE
 16151        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16152     END-IF
 16153*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16154     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16155     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16156                                    CP-RATING-BENEFIT-AMT.
 16157     IF CP-STATE-STD-ABBRV = 'OR'
 16158         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16159                                         PB-CI-AH-TERM.
 16160     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16161     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16162     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16163     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16164     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16165     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 292
* EL050.cbl
 16166
 16167     IF CP-STATE-STD-ABBRV = 'OH'
 16168        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16169                                AND 'CID' AND 'DCC' AND 'AHL')
 16170           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16171              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16172              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16173              MOVE '6' TO CP-EARNING-METHOD
 16174           END-IF
 16175        END-IF
 16176        IF PB-COMPANY-ID = 'CID'
 16177           IF NO-LIFE-COVERAGE
 16178              IF CP-CRITICAL-PERIOD
 16179                 MOVE '2'       TO CP-EARNING-METHOD
 16180              ELSE
 16181                 MOVE '6'       TO CP-EARNING-METHOD
 16182              END-IF
 16183           ELSE
 16184              IF WS-LF-COVERAGE-TYPE = 'L'
 16185                 MOVE '2'       TO CP-EARNING-METHOD
 16186              ELSE
 16187                 IF (PB-CI-LF-TERM > +60) OR
 16188                    (WS-LF-EARNINGS-CALC = '5')
 16189                    IF CP-CRITICAL-PERIOD
 16190                       MOVE '2'  TO CP-EARNING-METHOD
 16191                    ELSE
 16192                       MOVE '6'  TO CP-EARNING-METHOD
 16193                    END-IF
 16194                 ELSE
 16195                    MOVE '1'     TO CP-EARNING-METHOD
 16196                 END-IF
 16197              END-IF
 16198           END-IF
 16199        END-IF
 16200     END-IF
 16201
 16202*    IF CP-STATE-STD-ABBRV = 'VA'
 16203*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16204*          IF CP-ORIGINAL-TERM GREATER 61
 16205*             MOVE '6' TO CP-EARNING-METHOD
 16206*          ELSE
 16207*             MOVE '1' TO CP-EARNING-METHOD.
 16208
 16209     IF WS-DEFAULT-APR NOT NUMERIC
 16210         MOVE ZEROS TO WS-DEFAULT-APR.
 16211     IF CP-EARN-AS-NET-PAY
 16212         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16213            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16214                MOVE WS-DEFAULT-APR
 16215                                 TO  CP-LOAN-APR
 16216                MOVE ER-3780     TO  WS-ERROR
 16217                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16218            ELSE
 16219                MOVE ER-3781     TO  WS-ERROR
 16220                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16221     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16222     IF PB-COMPANY-ID = 'DCC'
 16223        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 293
* EL050.cbl
 16224        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16225        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16226     END-IF
 16227     IF PB-COMPANY-ID = 'DCC'
 16228        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16229        AND (CP-EARNING-METHOD = 'D')
 16230        AND (CP-CANCEL-REASON NOT = 'R')
 16231        CONTINUE
 16232     ELSE
 16233        GO TO 3750-CONTINUE
 16234     END-IF
 16235     MOVE ' '                    TO DD-IU-SW
 16236     IF NOT PDEF-MASTER-FOUND
 16237        MOVE ' '                 TO PDEF-MASTER-SW
 16238        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16239        MOVE PB-STATE            TO ERPDEF-STATE
 16240        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16241        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16242        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16243        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16244        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16245        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16246        IF PDEF-MASTER-FOUND
 16247           MOVE 'N'              TO PDEF-MASTER-SW
 16248           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16249           IF PDEF-MASTER-FOUND
 16250              IF (ERPDEF-KEY-SAVE (1:16) =
 16251                           PD-CONTROL-PRIMARY (1:16))
 16252                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16253                 CONTINUE
 16254              ELSE
 16255                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16256                 IF (ERPDEF-KEY-SAVE (1:16) =
 16257                           PD-CONTROL-PRIMARY (1:16))
 16258                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16259                    CONTINUE
 16260                 ELSE
 16261                    MOVE ER-2740 TO WS-ERROR
 16262                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16263                    GO TO 3770-CHECK-REFUNDS
 16264                 END-IF
 16265              END-IF
 16266           END-IF
 16267           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16268        END-IF
 16269     END-IF
 16270     IF PDEF-MASTER-FOUND
 16271        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16272           (V1 > +8)
 16273           OR (PD-PROD-CODE (V1) = 'I')
 16274        END-PERFORM
 16275        IF V1 < +9
 16276           SET DD-IU-PRESENT        TO TRUE
 16277        END-IF
 16278        IF WS-AH-DCC-TRUNC = 'T'
 16279           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16280        ELSE
 16281           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 294
* EL050.cbl
 16282        END-IF
 16283        EVALUATE TRUE
 16284           WHEN WS-TERM > +168
 16285              MOVE 15               TO V1
 16286           WHEN WS-TERM > +156
 16287              MOVE 14               TO V1
 16288           WHEN WS-TERM > +144
 16289              MOVE 13               TO V1
 16290           WHEN WS-TERM > +132
 16291              MOVE 12               TO V1
 16292           WHEN WS-TERM > +120
 16293              MOVE 11               TO V1
 16294           WHEN WS-TERM > +108
 16295              MOVE 10               TO V1
 16296           WHEN WS-TERM > +96
 16297              MOVE 9                TO V1
 16298           WHEN WS-TERM > +84
 16299              MOVE 8                TO V1
 16300           WHEN WS-TERM > +72
 16301              MOVE 7                TO V1
 16302           WHEN WS-TERM > +60
 16303              MOVE 6                TO V1
 16304           WHEN WS-TERM > +48
 16305              MOVE 5                TO V1
 16306           WHEN WS-TERM > +36
 16307              MOVE 4                TO V1
 16308           WHEN WS-TERM > +24
 16309              MOVE 3                TO V1
 16310           WHEN WS-TERM > +12
 16311              MOVE 2                TO V1
 16312           WHEN OTHER
 16313              MOVE 1                TO V1
 16314        END-EVALUATE
 16315
 16316        EVALUATE TRUE
 16317*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16318*             < +13)
 16319*             AND (DD-IU-PRESENT)
 16320*             MOVE 2                TO V2
 16321*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16322*             MOVE 1                TO V2
 16323           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16324              MOVE 2                TO V2
 16325           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16326              MOVE 3                TO V2
 16327           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16328              MOVE 4                TO V2
 16329           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16330              MOVE 5                TO V2
 16331           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16332              MOVE 6                TO V2
 16333           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16334              MOVE 7                TO V2
 16335           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16336              MOVE 8                TO V2
 16337           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16338              MOVE 9                TO V2
 16339           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 295
* EL050.cbl
 16340              MOVE 10               TO V2
 16341           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16342              MOVE 11               TO V2
 16343           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16344              MOVE 12               TO V2
 16345           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16346              MOVE 13               TO V2
 16347           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16348              MOVE 14               TO V2
 16349           WHEN OTHER
 16350              MOVE 15               TO V2
 16351        END-EVALUATE
 16352
 16353        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16354                                 TO CP-DDF-LO-FACT
 16355        MOVE PD-UEP-FACTOR (V1 V2)
 16356                                 TO CP-DDF-HI-FACT
 16357
 16358        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16359        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16360        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16361           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16362        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16363        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16364        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16365           + PD-1ST-YR-ADMIN-ALLOW
 16366
 16367        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16368*       IF PI-CLP-YN = 'Y'
 16369*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16370*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16371*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16372*       END-IF
 16373
 16374        IF DD-IU-PRESENT
 16375           MOVE 'I'              TO CP-EARNING-METHOD
 16376        END-IF
 16377        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16378                                     CP-CLP-RATE-UP
 16379        IF CP-IU-RATE-UP NOT = ZEROS
 16380           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16381              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16382           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16383              / (1 - WS-WORK-FACT)
 16384        END-IF
 16385     END-IF
 16386     .
 16387 3750-CONTINUE.
 16388     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16389
 16390     IF CP-REFUND-TYPE-USED NOT = SPACE
 16391         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16392
 16393     IF CP-ERROR-RATE-IS-ZERO OR
 16394        CP-ERROR-RATE-NOT-FOUND
 16395        MOVE ER-2740             TO WS-ERROR
 16396        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16397
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 296
* EL050.cbl
 16398     IF CP-ERROR-RATE-FILE-NOTOPEN
 16399        MOVE ER-2617             TO WS-ERROR
 16400        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16401     IF PB-COMPANY-ID = 'DCC'
 16402        AND PB-CI-ENTRY-STATUS = 'M'
 16403        MOVE +0                  TO PB-C-AH-REF-CALC
 16404     ELSE
 16405        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16406     END-IF
 16407     IF PB-COMPANY-ID = 'DCC'
 16408        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16409        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16410        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16411        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16412        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16413        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16414        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16415        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16416*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16417     END-IF
 16418     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 297
* EL050.cbl
 16420
 16421 3770-CHECK-REFUNDS.
 16422
 16423     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16424        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16425           MOVE ER-2766          TO WS-ERROR
 16426           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16427           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16428           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16429              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16430
 16431     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16432        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16433           MOVE ER-2766          TO WS-ERROR
 16434           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16435           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16436           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16437              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16438
 16439     IF PB-COMP-LF-CANCEL
 16440        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16441        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16442           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16443              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16444
 16445     IF PB-COMP-AH-CANCEL
 16446        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16447        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16448           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16449              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16450
 16451     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16452             GIVING WS-UNSIGN-WRK1
 16453     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16454             GIVING WS-UNSIGN-WRK2.
 16455
 16456     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16457         MOVE ZERO TO WS-UNSIGN-WRK1.
 16458
 16459     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16460         MOVE ZERO TO WS-UNSIGN-WRK2.
 16461
 16462     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16463
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 298
* EL050.cbl
 16465
 16466 3772-CONTINUE.
 16467
 16468**********************************
 16469*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16470*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16471*** DOUBLES THE TOLERANCE AMOUNT.
 16472***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16473**********************************
 16474     IF PB-COMPANY-ID = 'MON'
 16475     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16476         IF WS-REF-REJECT-SW = SPACE
 16477             MOVE ER-2754        TO WS-ERROR
 16478             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16479           ELSE
 16480             MOVE ER-2736        TO WS-ERROR
 16481             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16482**********************************
 16483
 16484 3773-CONTINUE.
 16485
 16486     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16487        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16488           MOVE ER-2723          TO WS-ERROR
 16489           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16490
 16491     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16492        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16493           MOVE ER-2724          TO WS-ERROR
 16494           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16495
 16496     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16497         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16498             (1 + WS-LF-REFUND-OVS-PCT)
 16499     ELSE
 16500         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16501
 16502     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16503         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16504             (1 - WS-TOL-LF-REFUND-PCT)
 16505     ELSE
 16506         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16507
 16508     IF (PB-COMPANY-ID = 'DCC')
 16509        AND (PB-CI-ENTRY-STATUS = 'M')
 16510        AND (PB-C-LF-CANCEL-AMT > +0)
 16511        MOVE ER-3843             TO WS-ERROR
 16512        PERFORM 9900-ERROR-FORMAT
 16513                                 THRU 9900-EXIT
 16514     END-IF
 16515     EVALUATE TRUE
 16516        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16517           CONTINUE
 16518        WHEN PB-C-LF-CANCEL-AMT = +0
 16519                 AND PB-C-LF-REF-CALC > +0
 16520           CONTINUE
 16521        WHEN WS-LF-REFUND-OVS-AMT = 0
 16522                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 299
* EL050.cbl
 16523           CONTINUE
 16524        WHEN OTHER
 16525           IF WS-TOL-LF-REFUND  = +0
 16526              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16527           END-IF
 16528           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16529                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16530                          (PB-C-LF-CANCEL-AMT))
 16531              CONTINUE
 16532           ELSE
 16533              IF WS-LF-REFUND-OVS-AMT = +0
 16534                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16535              END-IF
 16536              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16537                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16538                                       PB-C-LF-CANCEL-AMT)
 16539                 CONTINUE
 16540              ELSE
 16541                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16542                   MOVE ER-2754   TO  WS-ERROR
 16543                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16544                 ELSE
 16545                    MOVE ER-2736   TO  WS-ERROR
 16546                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16547                 END-IF
 16548              END-IF
 16549           END-IF
 16550     END-EVALUATE.
 16551
 16552     EVALUATE TRUE
 16553        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16554           CONTINUE
 16555        WHEN PB-C-LF-CANCEL-AMT = +0
 16556                 AND PB-C-LF-REF-CALC > +0
 16557           CONTINUE
 16558        WHEN OTHER
 16559           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16560               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16561              CONTINUE
 16562           ELSE
 16563              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16564               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16565                CONTINUE
 16566              ELSE
 16567                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16568                     MOVE ER-2754   TO  WS-ERROR
 16569                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16570                 ELSE
 16571                     MOVE ER-2736   TO  WS-ERROR
 16572                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16573                 END-IF
 16574              END-IF
 16575           END-IF
 16576     END-EVALUATE.
 16577
 16578     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16579         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16580             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 300
* EL050.cbl
 16581     ELSE
 16582         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16583
 16584     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16585         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16586             (1 - WS-TOL-AH-REFUND-PCT)
 16587     ELSE
 16588         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16589
 16590     IF (PB-COMPANY-ID = 'DCC')
 16591        AND (PB-CI-ENTRY-STATUS = 'M')
 16592        AND (PB-C-AH-CANCEL-AMT > +0)
 16593        MOVE ER-3843             TO WS-ERROR
 16594        PERFORM 9900-ERROR-FORMAT
 16595                                 THRU 9900-EXIT
 16596     END-IF
 16597     EVALUATE TRUE
 16598        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16599           CONTINUE
 16600*       WHEN PB-C-AH-REF-CALC = +0 AND
 16601*                  PB-C-AH-CANCEL-AMT > +0
 16602        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16603                   PB-C-AH-REF-CALC > +0
 16604           CONTINUE
 16605        WHEN WS-AH-REFUND-OVS-AMT = +0
 16606                AND WS-TOL-AH-REFUND = +0
 16607           CONTINUE
 16608        WHEN OTHER
 16609           IF WS-TOL-AH-REFUND = +0
 16610              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16611           END-IF
 16612           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16613               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16614                                         PB-C-AH-CANCEL-AMT)
 16615              CONTINUE
 16616           ELSE
 16617              IF WS-AH-REFUND-OVS-AMT = +0
 16618                 MOVE +9999999.99 TO
 16619                         WS-AH-REFUND-OVS-AMT
 16620              END-IF
 16621              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16622                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16623                                         PB-C-AH-CANCEL-AMT)
 16624                 CONTINUE
 16625              ELSE
 16626                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16627                    MOVE ER-2754   TO  WS-ERROR
 16628                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16629                 ELSE
 16630                    MOVE ER-2736   TO  WS-ERROR
 16631                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16632                 END-IF
 16633              END-IF
 16634           END-IF
 16635     END-EVALUATE.
 16636
 16637     EVALUATE TRUE
 16638        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 301
* EL050.cbl
 16639           CONTINUE
 16640*       WHEN PB-C-AH-REF-CALC > +0 AND
 16641*                  PB-C-AH-CANCEL-AMT = +0
 16642        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16643                   PB-C-AH-REF-CALC = +0
 16644           CONTINUE
 16645        WHEN OTHER
 16646           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16647               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16648              CONTINUE
 16649           ELSE
 16650              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16651                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16652                 CONTINUE
 16653              ELSE
 16654                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16655                     MOVE ER-2754   TO  WS-ERROR
 16656                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16657                 ELSE
 16658                     MOVE ER-2736   TO  WS-ERROR
 16659                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16660                 END-IF
 16661              END-IF
 16662           END-IF
 16663     END-EVALUATE.
 16664
 16665     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16666        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16667        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16668           AND  PB-C-LF-REF-CALC < +1.00
 16669           AND  PB-C-AH-REF-CALC < +1.00
 16670           CONTINUE
 16671        ELSE
 16672           IF (PB-COMPANY-ID = 'DCC')
 16673              AND (PB-CI-ENTRY-STATUS = 'M')
 16674              CONTINUE
 16675           ELSE
 16676              MOVE ER-2741       TO WS-ERROR
 16677              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16678           END-IF
 16679        END-IF
 16680     END-IF
 16681
 16682     IF (PB-C-LF-CANCEL-AMT = ZERO
 16683        AND WS-LF-BENEFIT-CD NOT = ZERO
 16684        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16685        AND PB-C-LF-REF-CALC NOT = ZERO)
 16686        OR
 16687        (PB-C-LF-CANCEL-AMT = ZERO
 16688        AND WS-LF-BENEFIT-CD NOT = ZERO
 16689        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16690             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16691                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16692                NEXT SENTENCE
 16693             ELSE
 16694                MOVE ER-2739        TO WS-ERROR
 16695                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16696
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 302
* EL050.cbl
 16697     IF (PB-C-AH-CANCEL-AMT = ZERO
 16698        AND WS-AH-BENEFIT-CD NOT = ZERO
 16699        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16700        AND PB-C-AH-REF-CALC NOT = ZERO)
 16701        OR
 16702        (PB-C-AH-CANCEL-AMT = ZERO
 16703        AND WS-AH-BENEFIT-CD NOT = ZERO
 16704        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16705             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16706                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16707                NEXT SENTENCE
 16708             ELSE
 16709                MOVE ER-2738        TO WS-ERROR
 16710                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16711
 16712 3775-OVER-REF-CHK.
 16713
 16714     IF PB-CI-ENTRY-STATUS = '5'
 16715        GO TO 3780-UPDATE-CANCEL-CERT.
 16716
 16717     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16718                              PB-CI-LF-ALT-PREMIUM-AMT.
 16719
 16720     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16721        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16722                                 PB-C-LF-REF-CALC
 16723      ELSE
 16724        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16725                                 PB-C-LF-CANCEL-AMT.
 16726
 16727     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16728        MOVE ER-2755             TO WS-ERROR
 16729        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16730
 16731     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16732
 16733     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16734        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16735                                 PB-C-AH-REF-CALC
 16736      ELSE
 16737        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16738                                 PB-C-AH-CANCEL-AMT.
 16739
 16740     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16741        MOVE ER-2778             TO WS-ERROR
 16742        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16743
 16744     IF PB-CI-OB-FLAG NOT = 'Z'
 16745        NEXT SENTENCE
 16746       ELSE
 16747         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16748            MOVE ER-2757           TO WS-ERROR
 16749            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16750
 16751 3780-UPDATE-CANCEL-CERT.
 16752
 16753     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16754        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 303
* EL050.cbl
 16755        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16756
 16757     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16758         MOVE ER-2729              TO WS-ERROR
 16759         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16760
 16761     IF PB-CI-LF-BENEFIT-CD = ZERO
 16762         GO TO 3780-UPDATE-CONT-1.
 16763
 16764     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16765         GO TO 3780-UPDATE-CONT-1.
 16766
 16767     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16768       AND
 16769        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16770       AND
 16771        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16772       AND
 16773        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16774            NEXT SENTENCE
 16775       ELSE
 16776        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16777          AND
 16778***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16779***       AND
 16780           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16781            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16782               MOVE ER-2730      TO WS-ERROR
 16783               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16784               GO TO 3999-END-EDIT
 16785            ELSE
 16786               GO TO 3999-END-EDIT
 16787        ELSE
 16788            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16789               MOVE ER-2765           TO WS-ERROR
 16790               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16791               GO TO 3785-CHECK-NH.
 16792*              GO TO 3999-END-EDIT.
 16793
 16794 3780-UPDATE-CONT-1.
 16795     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16796
 16797     IF PB-CI-AH-BENEFIT-CD = ZERO
 16798         GO TO 3780-UPDATE-CONT-2.
 16799
 16800     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16801         GO TO 3780-UPDATE-CONT-2.
 16802
 16803     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16804
 16805     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16806       AND
 16807        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16808       AND
 16809        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16810       AND
 16811        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16812            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 304
* EL050.cbl
 16813       ELSE
 16814        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16815          AND
 16816***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16817***       AND
 16818           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16819           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16820            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16821               MOVE ER-2773      TO WS-ERROR
 16822               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16823               GO TO 3999-END-EDIT
 16824            ELSE
 16825               GO TO 3999-END-EDIT
 16826            END-IF
 16827           ELSE
 16828             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16829                MOVE ER-2890 TO WS-ERROR
 16830                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16831                GO TO 3999-END-EDIT
 16832             ELSE
 16833                GO TO 3785-CHECK-NH
 16834             END-IF
 16835           END-IF
 16836          ELSE
 16837            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16838              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16839                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16840                   MOVE ER-2890 TO WS-ERROR
 16841                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16842                   GO TO 3999-END-EDIT
 16843                ELSE
 16844                   MOVE ER-2765 TO WS-ERROR
 16845                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16846                   GO TO 3785-CHECK-NH
 16847                END-IF
 16848              ELSE
 16849               MOVE ER-2765      TO WS-ERROR
 16850               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16851               GO TO 3785-CHECK-NH.
 16852*              GO TO 3999-END-EDIT.
 16853
 16854 3780-UPDATE-CONT-2.
 16855
 16856     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16857        AND WS-LF-BENEFIT-CD = ZERO
 16858           MOVE ER-2743           TO WS-ERROR
 16859           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16860
 16861     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16862        AND WS-AH-BENEFIT-CD = ZERO
 16863           MOVE ER-2744           TO WS-ERROR
 16864           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16865
 16866     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16867        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16868        AND
 16869        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16870         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 305
* EL050.cbl
 16871           MOVE ER-2746           TO WS-ERROR
 16872           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16873
 16874     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16875       AND
 16876        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16877             MOVE ER-2737        TO WS-ERROR
 16878             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16879
 16880     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16881       AND
 16882        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16883             MOVE ER-2737        TO WS-ERROR
 16884             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16885
 16886     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16887         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16888             OR 'CID' OR 'DCC' OR 'AHL'
 16889             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16890         ELSE
 16891             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16892                 MOVE ER-2768    TO WS-ERROR
 16893                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16894             ELSE
 16895                 MOVE ER-2756    TO WS-ERROR
 16896                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16897
 16898     IF CERT-PEND-ISSUE-RETURNED
 16899        MOVE ER-2772             TO WS-ERROR
 16900        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16901 3785-CHECK-NH.
 16902     IF PB-STATE NOT = 'NH'
 16903        GO TO 3999-END-EDIT
 16904     END-IF
 16905
 16906     MOVE ER-2796                TO WS-ERROR
 16907     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16908     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16909        OR (CM-NH-INTERFACE-SW = 'Y')
 16910        MOVE ER-2793             TO WS-ERROR
 16911        PERFORM 9900-ERROR-FORMAT
 16912                                 THRU 9900-EXIT
 16913     END-IF
 16914     MOVE +0                     TO WS-PAYMENT-AMT
 16915     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16916        GO TO 3999-END-EDIT
 16917     END-IF
 16918     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16919        GO TO 3999-END-EDIT
 16920     END-IF
 16921     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16922     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16923     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16924        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16925     END-IF
 16926     MOVE '1'                    TO DC-OPTION-CODE
 16927     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16928     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 306
* EL050.cbl
 16929        IF DC-ELAPSED-DAYS < +16
 16930           GO TO 3999-END-EDIT
 16931        END-IF
 16932     END-IF
 16933     MOVE +0                     TO DC-ELAPSED-DAYS
 16934     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16935     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16936     MOVE '1'                    TO DC-OPTION-CODE
 16937     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16938     IF NO-CONVERSION-ERROR
 16939        IF DC-ELAPSED-DAYS > +30
 16940           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16941        ELSE
 16942           GO TO 3999-END-EDIT
 16943        END-IF
 16944     ELSE
 16945        GO TO 3999-END-EDIT
 16946     END-IF
 16947     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16948        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16949           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16950     IF WS-PAYMENT-AMT < 600.00
 16951        GO TO 3999-END-EDIT
 16952     END-IF
 16953     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16954
 16955     IF (ERMAIL-FOUND = ' ')
 16956         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16957         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16958        GO TO 3999-END-EDIT
 16959     END-IF
 16960     MOVE ER-2795                TO WS-ERROR
 16961     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16962
 16963     GO TO 3999-END-EDIT.
 16964******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 307
* EL050.cbl
 16966 3990-FILES-NOT-OPEN.
 16967
 16968     MOVE ER-2617                TO WS-ERROR.
 16969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16970     GO TO 9990-RETURN.
 16971
 16972 3999-END-EDIT.
 16973
 16974     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16975
 16976     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16977         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16978         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16979             PERFORM 9250-UNLOCK-RETURN
 16980             GO TO 9990-RETURN
 16981          ELSE
 16982             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16983             GO TO 9990-RETURN.
 16984
 16985     IF PB-CANCELLATION
 16986          GO TO 9990-RETURN.
 16987
 16988     IF CERT-WAS-NOT-FOUND
 16989        MOVE SPACES              TO CERTIFICATE-MASTER.
 16990
 16991     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16992
 16993     IF CERT-WAS-FOUND
 16994         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16995             PERFORM 9250-UNLOCK-RETURN
 16996          ELSE
 16997            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16998      ELSE
 16999         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17000
 17001     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17002        IF PB-COMPANY-ID = 'DCC' AND
 17003           (PB-CARRIER = '2' OR '4' OR '6')
 17004              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17005        END-IF
 17006     END-IF.
 17007
 17008     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17009         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17010     END-IF.
 17011     move ' '                    to ws-ins-age-defaulted
 17012     perform 8150-read-elcrtt    thru 8150-exit
 17013     if ws-ins-age-defaulted = 'Y'
 17014        move er-1573             to ws-error
 17015        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17016     end-if
 17017
 17018     if ws-jnt-age-defaulted = 'Y'
 17019        move er-1574             to ws-error
 17020        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17021     end-if
 17022
 17023     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 308
* EL050.cbl
 17024     IF ((PB-COMPANY-ID = 'DCC')
 17025        AND (WS-NO-SECURE-PAY))
 17026                  OR
 17027        (WS-LF-SPECIAL-CALC-CD = 'O'
 17028        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17029        SET SKIP-ADDR-EDIT       TO TRUE
 17030     END-IF
 17031     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17032        AND (NOT SKIP-ADDR-EDIT)
 17033        MOVE ER-2963             TO WS-ERROR
 17034        PERFORM 9900-ERROR-FORMAT
 17035                                 THRU 9900-EXIT
 17036        GO TO 9990-RETURN
 17037     END-IF
 17038     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17039     IF ERPNDM-FOUND NOT = 'X'
 17040        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17041           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17042           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17043           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17044           AND (NOT SKIP-ADDR-EDIT)
 17045           MOVE ER-2694          TO WS-ERROR
 17046           PERFORM 9900-ERROR-FORMAT
 17047                                 THRU 9900-EXIT
 17048        END-IF
 17049        MOVE ' '                 TO STATE-RECORD-ERROR
 17050        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17051        MOVE PM-STATE            TO CNTL-ACCESS
 17052        MOVE '3'                 TO CNTL-REC-TYPE
 17053        MOVE +0                  TO CNTL-SEQ-NO
 17054        MOVE '0'                 TO RC-SW-2
 17055        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17056        IF (NO-STATE-RECORD)
 17057           OR (CF-RECORD-TYPE NOT = '3')
 17058           OR (PM-STATE NOT = CF-STATE-CODE)
 17059           IF (PM-STATE = SPACES)
 17060              AND (SKIP-ADDR-EDIT)
 17061              CONTINUE
 17062           ELSE
 17063              MOVE ER-2963       TO WS-ERROR
 17064              PERFORM 9900-ERROR-FORMAT
 17065                                 THRU 9900-EXIT
 17066           END-IF
 17067        END-IF
 17068        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17069           MOVE ER-2883          TO WS-ERROR
 17070           PERFORM 9900-ERROR-FORMAT
 17071                                 THRU 9900-EXIT
 17072        END-IF
 17073        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17074           MOVE ' '                 TO STATE-RECORD-ERROR
 17075           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17076           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17077           MOVE '3'                 TO CNTL-REC-TYPE
 17078           MOVE +0                  TO CNTL-SEQ-NO
 17079           MOVE '0'                 TO RC-SW-2
 17080           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17081           IF NO-STATE-RECORD
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 309
* EL050.cbl
 17082              OR (CF-RECORD-TYPE NOT = '3')
 17083              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17084              MOVE ER-2964          TO WS-ERROR
 17085              PERFORM 9900-ERROR-FORMAT
 17086                                    THRU 9900-EXIT
 17087           END-IF
 17088        END-IF
 17089     ELSE
 17090        IF NOT SKIP-ADDR-EDIT
 17091           MOVE ER-2393          TO WS-ERROR
 17092           PERFORM 9900-ERROR-FORMAT
 17093                                 THRU 9900-EXIT
 17094        END-IF
 17095     END-IF
 17096
 17097     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17098
 17099     IF (ERMAIL-FOUND = ' ' AND
 17100        ERPNDM-FOUND = ' ')
 17101        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17102           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17103           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17104          OR
 17105           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17106          OR
 17107           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17108           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17109           GO TO 3999-UNLOCK-ERMAIL.
 17110
 17111     IF ERPNDM-FOUND = 'X'
 17112        GO TO 3999-UNLOCK-ERMAIL.
 17113
 17114     IF PM-INSURED-LAST-NAME      = SPACES
 17115        AND PM-INSURED-FIRST-NAME = SPACES
 17116        AND PM-ADDRESS-LINE-1     = SPACES
 17117        AND PM-ADDRESS-LINE-2     = SPACES
 17118        AND PM-CITY-STATE         = SPACES
 17119        AND PM-CRED-BENE-NAME     = SPACES
 17120        AND PM-CRED-BENE-ADDR     = SPACES
 17121        AND PM-CRED-BENE-CTYST    = SPACES
 17122        GO TO 3999-UNLOCK-ERMAIL
 17123     END-IF
 17124
 17125     MOVE SPACES                 TO MAILING-DATA.
 17126
 17127     MOVE 'MA'                   TO MA-RECORD-ID.
 17128     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17129     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17130     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17131     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17132     MOVE PB-SV-STATE            TO MA-STATE.
 17133     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17134     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17135
 17136     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17137     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17138
 17139     IF ERMAIL-FOUND = ' '
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 310
* EL050.cbl
 17140        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17141     ELSE
 17142        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17143        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17144        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17145
 17146     GO TO 9990-RETURN.
 17147
 17148 3999-UNLOCK-ERMAIL.
 17149     IF ERMAIL-FOUND = ' '
 17150        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17151
 17152     GO TO 9990-RETURN.
 17153******************************************************************
 17154
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 311
* EL050.cbl
 17156 4000-UPDATE-CANCELLED-CERT.
 17157     IF CERT-WAS-NOT-FOUND
 17158        GO TO 4299-EXIT.
 17159
 17160*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17161     IF PB-C-NH-INT-ON-REFS > ZEROS
 17162        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17163     END-IF
 17164     IF PB-C-REF-INTERFACE-SW = 'Y'
 17165        MOVE PB-C-REF-INTERFACE-SW
 17166                                 TO CM-NH-INTERFACE-SW
 17167     END-IF
 17168     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17169     IF ERMAIL-FOUND = 'X'
 17170        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17171        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17172        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17173        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17174           MOVE ER-2694          TO WS-ERROR
 17175           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17176     END-IF
 17177
 17178     IF PB-C-POST-CARD-IND = 'Y'
 17179        MOVE +8                  TO SUB
 17180*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17181        IF ERMAIL-FOUND = ' '
 17182           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17183              (SUB > +7)
 17184              OR (MA-MAIL-STATUS (SUB) = '1')
 17185           END-PERFORM
 17186        END-IF
 17187        IF (SUB > +7)
 17188           OR (ERMAIL-FOUND = 'X')
 17189           MOVE ER-3789          TO WS-ERROR
 17190           PERFORM 9900-ERROR-FORMAT
 17191                                 THRU 9900-EXIT
 17192        END-IF
 17193     ELSE
 17194        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17195     END-IF
 17196
 17197     IF ERMAIL-FOUND = ' '
 17198        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17199     END-IF.
 17200
 17201     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17202
 17203     IF PB-CI-OB-FLAG = 'Z'
 17204        GO TO 4150-SUMMARY-CERT-CANCEL.
 17205
 17206     IF PB-C-LF-CANCEL-VOIDED
 17207         PERFORM 4200-REVERSE-LF-CANCEL.
 17208     IF PB-C-AH-CANCEL-VOIDED
 17209         PERFORM 4200-REVERSE-AH-CANCEL.
 17210
 17211 4100-APPLY-LF-CANCEL.
 17212
 17213     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 312
* EL050.cbl
 17214
 17215 4100-CHECK-LF-ERRORS.
 17216
 17217     ADD +1                       TO WS-SUB.
 17218
 17219     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17220        IF LF-COVERAGE-CANCELLED
 17221           GO TO 4100-LF-CANCEL-CONT
 17222        ELSE
 17223           GO TO 4100-UPDATE-LF-COVERAGE.
 17224
 17225     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17226                                   ER-2729 OR
 17227                                   ER-2730 OR
 17228                                   ER-2731 OR
 17229                                   ER-2732 OR
 17230                                   ER-2737 OR
 17231                                   ER-2740 OR
 17232                                   ER-2743 OR
 17233                                   ER-2749 OR
 17234                                   ER-2750 OR
 17235                                   ER-2755 OR
 17236                                   ER-2757 OR
 17237                                   ER-2760 OR
 17238                                   ER-2772 OR
 17239                                   ER-2774 OR
 17240                                   ER-2776 OR
 17241                                   ER-2794
 17242        GO TO 4100-UPDATE-LF-COVERAGE.
 17243
 17244     GO TO 4100-CHECK-LF-ERRORS.
 17245
 17246 4100-UPDATE-LF-COVERAGE.
 17247
 17248     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17249     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17250     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17251        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17252     END-IF
 17253     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17254                                      TO CM-CREDIT-INTERFACE-SW-2.
 17255     IF CM-LF-CANCEL-DT = LOW-VALUE
 17256         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17257
 17258     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17259         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17260                                         CM-LF-STATUS-AT-CANCEL.
 17261
 17262     GO TO 4100-APPLY-AH-CANCEL.
 17263
 17264 4100-LF-CANCEL-CONT.
 17265     IF PB-C-LF-CANCEL-VOIDED
 17266         GO TO 4100-APPLY-AH-CANCEL.
 17267
 17268     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17269         GO TO 4100-APPLY-AH-CANCEL.
 17270
 17271     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 313
* EL050.cbl
 17272        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17273           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17274        ELSE
 17275           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17276
 17277     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17278     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17279
 17280     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17281         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17282
 17283     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17284        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17285         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17286         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17287
 17288     IF PB-RECORD-RETURNED
 17289        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17290      ELSE
 17291        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17292
 17293 4100-APPLY-AH-CANCEL.
 17294
 17295     MOVE +0                      TO WS-SUB.
 17296
 17297 4100-CHECK-AH-ERRORS.
 17298
 17299     ADD +1                       TO WS-SUB.
 17300
 17301     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17302        IF AH-COVERAGE-CANCELLED
 17303           GO TO 4100-AH-CANCEL-CONT
 17304        ELSE
 17305           GO TO 4100-UPDATE-AH-COVERAGE.
 17306
 17307     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17308                                   ER-2729 OR
 17309                                   ER-2732 OR
 17310                                   ER-2737 OR
 17311                                   ER-2740 OR
 17312                                   ER-2744 OR
 17313                                   ER-2749 OR
 17314                                   ER-2750 OR
 17315                                   ER-2778 OR
 17316                                   ER-2757 OR
 17317                                   ER-2760 OR
 17318                                   ER-2771 OR
 17319                                   ER-2772 OR
 17320                                   ER-2773 OR
 17321                                   ER-2775 OR
 17322                                   ER-2777 OR
 17323                                   ER-2794
 17324        GO TO 4100-UPDATE-AH-COVERAGE.
 17325
 17326     GO TO 4100-CHECK-AH-ERRORS.
 17327
 17328 4100-UPDATE-AH-COVERAGE.
 17329
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 314
* EL050.cbl
 17330     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17331     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17332     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17333     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17334                                      TO CM-CREDIT-INTERFACE-SW-2.
 17335     IF CM-AH-CANCEL-DT = LOW-VALUE
 17336         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17337
 17338     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17339         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17340                                         CM-AH-STATUS-AT-CANCEL.
 17341
 17342     IF LF-COVERAGE-CANCELLED
 17343         IF PB-RECORD-RETURNED
 17344              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17345          ELSE
 17346              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17347
 17348     GO TO 4299-EXIT.
 17349
 17350 4100-AH-CANCEL-CONT.
 17351     IF PB-C-AH-CANCEL-VOIDED
 17352         GO TO 4299-EXIT.
 17353
 17354     if cm-credit-interface-sw-2 = ' '
 17355        if pb-fatal-errors or pb-unforced-errors
 17356           move '4'              to cm-credit-interface-sw-2
 17357        else
 17358           move '1'              to cm-credit-interface-sw-2
 17359        end-if
 17360     end-if
 17361     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17362         GO TO 4299-EXIT.
 17363
 17364     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17365        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17366           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17367        ELSE
 17368           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17369
 17370     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17371     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17372
 17373     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17374         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17375
 17376     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17377         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17378         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17379
 17380     IF PB-RECORD-RETURNED
 17381        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17382      ELSE
 17383        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17384
 17385     GO TO 4299-EXIT.
 17386
 17387 4150-SUMMARY-CERT-CANCEL.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 315
* EL050.cbl
 17388     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17389
 17390     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17391        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17392                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17393     ELSE
 17394        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17395                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17396
 17397     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17398        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17399                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17400     ELSE
 17401        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17402                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17403
 17404     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17405        NEXT SENTENCE
 17406     ELSE
 17407        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17408
 17409     GO TO 4299-EXIT.
 17410
 17411 4200-REVERSE-LF-CANCEL.
 17412     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17413
 17414     IF CM-LF-CANCEL-APPLIED
 17415        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17416        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17417        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17418
 17419     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17420
 17421     IF PB-RECORD-RETURNED
 17422        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17423       ELSE
 17424        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17425
 17426 4200-REVERSE-LF-EXIT.
 17427       EXIT.
 17428
 17429 4200-REVERSE-AH-CANCEL.
 17430     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17431
 17432     IF CM-AH-CANCEL-APPLIED
 17433        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17434        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17435        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17436
 17437     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17438
 17439     IF PB-RECORD-RETURNED
 17440        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17441       ELSE
 17442        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17443
 17444 4200-REVERSE-AH-EXIT.
 17445       EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 316
* EL050.cbl
 17446
 17447 4299-EXIT.
 17448       EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 317
* EL050.cbl
 17450
 17451 4500-UPDATE-NEW-CERT.
 17452     IF CERT-WAS-FOUND
 17453         NEXT SENTENCE
 17454       ELSE
 17455         GO TO 4520-BUILD-NEW-KEY.
 17456
 17457     IF  CLASIC-CREATED-CERT
 17458         GO TO 4999-EXIT.
 17459
 17460     IF  CERT-WAS-CREATED-FOR-CLAIM
 17461         GO TO 4520-BUILD-NEW-KEY.
 17462
 17463     IF CERT-ADDED-BATCH
 17464        IF CM-RECORD-ID = 'CM'
 17465            GO TO 4999-EXIT.
 17466
 17467 4520-BUILD-NEW-KEY.
 17468* BUILD CONTROL PRIMARY
 17469
 17470     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17471                                       CM-COMPANY-CD-A1
 17472                                       CM-COMPANY-CD-A2
 17473                                       CM-COMPANY-CD-A4
 17474                                       CM-COMPANY-CD-A5.
 17475
 17476     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17477     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17478     MOVE PB-SV-STATE               TO CM-STATE.
 17479     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17480     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17481     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17482     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17483
 17484     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17485
 17486     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17487     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17488     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17489     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17490
 17491     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17492        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17493
 17494     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17495         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17496         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17497         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17498         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17499     ELSE
 17500         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17501
 17502     IF PB-COMPANY-ID   EQUAL  'CRI'
 17503         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17504         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17505         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17506         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17507         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 318
* EL050.cbl
 17508
 17509     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17510        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17511         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17512
 17513     IF PB-COMPANY-ID  = 'LBL'
 17514        IF PB-I-JOINT-COVERAGE
 17515            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17516                                           PB-I-MEMBER-NO
 17517            GO TO 4550-CONT-CERT-PROCESS.
 17518
 17519     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17520        NEXT SENTENCE
 17521     ELSE
 17522        GO TO 4540-BUILD-MEMBER-NO.
 17523
 17524******************************************************************
 17525*                                                                *
 17526*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17527*    FOR 'MON'.                                                  *
 17528*                                                                *
 17529******************************************************************
 17530
 17531     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17532     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17533     MOVE +1                     TO WS-SUB1
 17534                                    WS-SUB2.
 17535
 17536 4530-EDIT-MEMB-NAME.
 17537
 17538     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17539        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17540        ADD +1                       TO WS-SUB2.
 17541
 17542     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17543        ADD +1                       TO WS-SUB1
 17544        GO TO 4530-EDIT-MEMB-NAME.
 17545
 17546     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17547     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17548     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17549*    MOVE SPACE                      TO DC-OPTION-CODE.
 17550     SET  BIN-TO-GREG                TO TRUE.
 17551     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17552     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17553
 17554     GO TO 4550-CONT-CERT-PROCESS.
 17555
 17556******************************************************************
 17557*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17558******************************************************************
 17559
 17560 4540-BUILD-MEMBER-NO.
 17561
 17562     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17563         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17564         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17565         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 319
* EL050.cbl
 17566         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17567     ELSE
 17568         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17569
 17570     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17571        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17572         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17573
 17574 4550-CONT-CERT-PROCESS.
 17575
 17576*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17577*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17578*    ELSE
 17579*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17580
 17581     IF CERT-WAS-CREATED-FOR-CLAIM
 17582        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17583        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17584
 17585     IF CERT-AND-CLAIM-ONLINE
 17586        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17587        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17588
 17589     MOVE 'CM'                     TO CM-RECORD-ID.
 17590     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17591
 17592     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17593        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17594        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17595     ELSE
 17596        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17597        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17598
 17599     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17600     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17601     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17602     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17603     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17604     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17605     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17606                                      CM-LF-ITD-CANCEL-AMT
 17607                                      CM-LF-ITD-DEATH-AMT
 17608                                      CM-AH-ITD-AH-PMT
 17609                                      CM-AH-ITD-LUMP-PMT
 17610                                      CM-AH-ITD-CANCEL-AMT
 17611                                      CM-LF-NSP-PREMIUM-AMT
 17612                                      CM-AH-NSP-PREMIUM-AMT.
 17613*                                     CM-CLAIM-DEDUCT-WITHHELD
 17614*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17615     if pb-i-loan-apr = +99.9999
 17616        move zeros                 to cm-loan-apr
 17617     else
 17618        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17619     end-if
 17620     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17621     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17622     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17623     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 320
* EL050.cbl
 17624     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17625     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17626     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17627     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17628     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17629     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17630     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17631
 17632     IF PB-I-LIVES NOT NUMERIC
 17633         MOVE ZERO                 TO PB-I-LIVES.
 17634
 17635     IF PB-I-NUM-BILLED NOT NUMERIC
 17636         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17637
 17638     MOVE PB-I-LIVES               TO CM-LIVES.
 17639     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17640
 17641     IF PB-COMPANY-ID EQUAL  'DMD'
 17642         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17643         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17644
 17645     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17646     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17647     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17648     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17649     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17650     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17651
 17652     IF PB-I-LF-POLICY-FEE NUMERIC
 17653        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17654     ELSE
 17655        MOVE +0                    TO CM-LF-POLICY-FEE.
 17656
 17657     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17658        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17659        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17660     ELSE
 17661        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17662
 17663     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17664     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17665     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17666     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17667     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17668     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17669     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17670     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17671     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17672
 17673     IF PB-I-AH-POLICY-FEE NUMERIC
 17674        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17675     ELSE
 17676        MOVE +0                    TO CM-AH-POLICY-FEE.
 17677
 17678     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17679        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17680     ELSE
 17681        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 321
* EL050.cbl
 17682
 17683     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17684     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17685
 17686     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17687                                      CM-LF-DEATH-EXIT-DT
 17688                                      CM-AH-SETTLEMENT-EXIT-DT.
 17689
 17690*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17691*                       'TIH' OR 'OFL' OR 'FLA' OR
 17692*                       'TII' OR 'TMS' OR 'CRI' OR
 17693*                       'NCL'
 17694     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17695
 17696     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17697         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17698            MOVE '2'                TO CM-PREMIUM-TYPE.
 17699
 17700     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17701         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17702            MOVE '2'                TO CM-PREMIUM-TYPE.
 17703
 17704     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17705         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17706     ELSE
 17707         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17708         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17709
 17710     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17711     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17712     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17713     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17714     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17715     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17716     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17717     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17718
 17719     IF PB-NO-MONTHS-SKIPPED
 17720         MOVE SPACE                 TO CM-SKIP-CODE
 17721     ELSE
 17722         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17723
 17724     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17725     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17726                                       CM-LF-STATUS-AT-CANCEL.
 17727
 17728     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17729     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17730                                       CM-AH-STATUS-AT-CANCEL.
 17731
 17732     MOVE '1'                       TO CM-ENTRY-STATUS.
 17733
 17734     IF PB-REISSUED-CERT
 17735        MOVE '5'                    TO CM-ENTRY-STATUS.
 17736
 17737     IF PB-MONTHLY-CERT
 17738        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17739
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 322
* EL050.cbl
 17740     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17741     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17742     IF PB-POLICY-IS-DECLINED
 17743        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17744
 17745     IF PB-POLICY-IS-VOIDED
 17746        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17747
 17748     IF PB-NEEDS-UNDERWRITING
 17749        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17750
 17751     IF PB-REIN-ONLY-CERT
 17752        MOVE '9'                    TO CM-ENTRY-STATUS.
 17753
 17754     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17755         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17756     ELSE
 17757         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17758
 17759     IF PB-RECORD-RETURNED
 17760        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17761      ELSE
 17762        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17763
 17764     IF PB-I-MAIL-ADDRS-PRESENT
 17765        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17766
 17767     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17768                                       CM-ENTRY-DT.
 17769
 17770 4999-EXIT.
 17771     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 323
* EL050.cbl
 17773
 17774 5000-PROCESS-REPS.
 17775     MOVE ' '                    TO AGTC-MASTER-SW
 17776     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17777     MOVE CO-TYPE                TO AGTC-TYPE
 17778     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17779     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17780     IF (AGTC-MASTER-SW NOT = 'N')
 17781        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17782        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17783        PERFORM 8583-READ-ERAGTC-NEXT
 17784                                 THRU 8583-EXIT
 17785     END-IF
 17786     IF AGTC-MASTER-SW = 'N'
 17787        CONTINUE
 17788     ELSE
 17789        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17790           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17791              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17792              MOVE 'Y'           TO AGTC-MASTER-SW
 17793           END-IF
 17794        END-IF
 17795     END-IF
 17796     .
 17797 5000-EXIT.
 17798     EXIT.
 17799 6370-EDIT-INPUT-LF-CODE.
 17800     move ' ' to ws-benefit-cd-chg-sw
 17801     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17802        MOVE +1                  TO SUB
 17803        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17804        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17805        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17806        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17807        GO TO 6370-SEARCH-LOOP.
 17808
 17809     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17810
 17811     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17812     MOVE SPACES                 TO CNTL-ACCESS.
 17813*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17814     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17815     MOVE +0                     TO CNTL-SEQ-NO.
 17816     MOVE '4' TO RC-SW-2.
 17817     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17818
 17819     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17820        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17821        GO TO 6370-NO-LF-FOUND.
 17822
 17823     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17824     MOVE +1                     TO SUB.
 17825
 17826 6370-SEARCH-LOOP.
 17827     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17828         GO TO 6370-NO-LF-FOUND.
 17829
 17830     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 324
* EL050.cbl
 17831        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17832           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17833           set benefit-code-chg to true
 17834        end-if
 17835        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17836        GO TO 6370-HER-NET-PAY-CHECK.
 17837
 17838     ADD 1   TO SUB.
 17839*    IF SUB GREATER 120
 17840     IF SUB GREATER 200
 17841         GO TO 6370-NO-LF-FOUND.
 17842
 17843     GO TO 6370-SEARCH-LOOP.
 17844
 17845 6370-NO-LF-FOUND.
 17846
 17847     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17848        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17849        set benefit-code-chg to true
 17850     end-if
 17851     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17852
 17853 6370-HER-NET-PAY-CHECK.
 17854
 17855     IF PB-COMPANY-ID = 'CID'
 17856        IF PB-SV-STATE = 'CA' OR 'MN'
 17857           IF PB-I-LF-BENEFIT-CD = '02'
 17858              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17859           ELSE
 17860              IF PB-I-LF-BENEFIT-CD = '04'
 17861                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17862              END-IF
 17863           END-IF
 17864        END-IF
 17865     END-IF
 17866
 17867     IF PB-COMPANY-ID NOT = 'HER'
 17868         GO TO 6370-EXIT.
 17869
 17870     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17871         GO TO 6370-EXIT.
 17872
 17873     IF PB-I-LF-TERM NOT NUMERIC
 17874         MOVE ZEROS              TO PB-I-LF-TERM.
 17875
 17876     IF PB-I-LOAN-TERM NOT NUMERIC
 17877         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17878
 17879     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17880         GO TO 6370-EXIT.
 17881
 17882     IF PB-I-LF-BENEFIT-CD = '33'
 17883         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17884
 17885     IF PB-I-LF-BENEFIT-CD = '34'
 17886         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17887
 17888 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 325
* EL050.cbl
 17889     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 326
* EL050.cbl
 17891
 17892 6380-EDIT-INPUT-AH-CODE.
 17893     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17894        MOVE +1                  TO SUB
 17895        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17896        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17897        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17898        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17899        GO TO 6380-SEARCH-LOOP.
 17900
 17901     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17902
 17903     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17904     MOVE SPACES                 TO CNTL-ACCESS.
 17905     MOVE 'A'                    TO CNTL-REC-TYPE.
 17906*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17907     MOVE +0                     TO CNTL-SEQ-NO.
 17908     MOVE '5' TO RC-SW-2.
 17909     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17910
 17911     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17912        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17913        GO TO 6380-NO-AH-FOUND.
 17914
 17915     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17916     MOVE +1 TO SUB.
 17917
 17918 6380-SEARCH-LOOP.
 17919     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17920         GO TO 6380-NO-AH-FOUND.
 17921
 17922     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17923         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17924         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17925
 17926     ADD 1   TO SUB.
 17927     IF SUB GREATER THAN 96
 17928*    IF SUB GREATER THAN 300
 17929         GO TO 6380-NO-AH-FOUND.
 17930
 17931     GO TO 6380-SEARCH-LOOP.
 17932
 17933 6380-NO-AH-FOUND.
 17934
 17935     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17936
 17937     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17938         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17939     ELSE
 17940         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17941
 17942 6380-CSO-AH-ONLY-CHECKS.
 17943
 17944     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17945        NEXT SENTENCE
 17946      ELSE
 17947        GO TO 6380-EXIT.
 17948
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 327
* EL050.cbl
 17949     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17950         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17951
 17952
 17953     GO TO 6380-EXIT
 17954     .
 17955 6380-CSO-LIFE-WITH-AH-CHECKS.
 17956
 17957
 17958     .
 17959 6380-EXIT.
 17960     EXIT.
 17961
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 328
* EL050.cbl
 17963
 17964 6400-COMPUTE-EXTENSION-DAYS.
 17965
 17966******************************************************************
 17967*                                                                *
 17968*                   COMPUTE EXTENSION DAYS                       *
 17969*                                                                *
 17970*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17971*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17972*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17973*    THE EXTENSION DAYS.                                         *
 17974*                                                                *
 17975******************************************************************
 17976
 17977     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17978     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17979
 17980******************************************************************
 17981*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17982*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17983******************************************************************
 17984
 17985     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17986        COMPUTE WS-ODD-DAYS-OVER =
 17987               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17988     ELSE
 17989        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17990
 17991     IF WS-ODD-DAYS-OVER = ZEROS
 17992           GO TO 6499-EXIT
 17993     ELSE
 17994        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17995           IF WS-WDF-MONTH = 02
 17996              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17997              ADD 2       TO  WS-ODD-DAYS-OVER
 17998              GO TO 6499-EXIT
 17999           ELSE
 18000              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18001                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18002                 GO TO 6499-EXIT
 18003               ELSE
 18004                 GO TO 6499-EXIT
 18005        ELSE
 18006           GO TO 6499-EXIT.
 18007
 18008 6412-CHECK-TO-DAY.
 18009
 18010        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18011           IF WS-WDT-DAY = 28
 18012              ADD 2              TO WS-ODD-DAYS-OVER
 18013           ELSE
 18014              IF WS-WDT-DAY = 29
 18015                 ADD 1           TO WS-ODD-DAYS-OVER
 18016              ELSE
 18017                 NEXT SENTENCE
 18018        ELSE
 18019           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18020              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 329
* EL050.cbl
 18021
 18022     GO TO 6499-EXIT.
 18023
 18024
 18025 6415-CHECK-LEAP-YEAR.
 18026
 18027     IF DC-DAYS-IN-MONTH = 29
 18028        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18029
 18030 6415-EXIT.
 18031     EXIT.
 18032
 18033 6499-EXIT.
 18034      EXIT.
 18035
 18036 6500-END.
 18037     EXIT.
 18038
 18039
 18040******************************************************************
 18041************* PROCEDURE DIVISION FOR EL050 ***********************
 18042********************** ELC50PD END *******************************
 18043
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 330
* EL050.cbl
 18045
 18046**START***********************************************************
 18047*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18048*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18049******************************************************************
 18050*
 18051 6600-GET-STATE-MUNICIPAL-TAX.
 18052
 18053     IF PB-COMPANY-ID NOT = 'DMD'
 18054         GO TO 6640-EXIT.
 18055
 18056     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18057     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18058     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18059*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18060*
 18061***  Y2K PROJ 7744
 18062     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18063     SET BIN-TO-GREG          TO TRUE.
 18064     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18065
 18066     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18067
 18068     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18069     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18070
 18071
 18072* EXEC CICS HANDLE CONDITION
 18073*        INVREQ    (6610-START-BROWSE)
 18074*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18075*        NOTFND    (6630-END-OF-FILE)
 18076*    END-EXEC.
 18077*    MOVE '"$8JI                 ! # #00018059' TO DFHEIV0
 18078     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18079     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18080     MOVE X'2320233030303138303539' TO DFHEIV0(25:11)
 18081     CALL 'kxdfhei1' USING DFHEIV0
 18082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18083
 18084
 18085 6610-START-BROWSE.
 18086
 18087
 18088* EXEC CICS HANDLE CONDITION
 18089*        NOTFND    (6630-END-OF-FILE)
 18090*        DISABLED  (6630-ERRESS-PROBLEM)
 18091*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18092*        ENDFILE   (6630-END-OF-FILE)
 18093*    END-EXEC.
 18094*    MOVE '"$IcJ''                ! $ #00018067' TO DFHEIV0
 18095     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18097     MOVE X'2420233030303138303637' TO DFHEIV0(25:11)
 18098     CALL 'kxdfhei1' USING DFHEIV0
 18099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18100
 18101
 18102
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 331
* EL050.cbl
 18103* EXEC CICS STARTBR
 18104*        DATASET (FILE-ID-ERRESS)
 18105*        RIDFLD  (WS-ERRESS-KEY)
 18106*        GTEQ
 18107*    END-EXEC.
 18108     MOVE 0
 18109       TO DFHEIV11
 18110*    MOVE '&,         G          &   #00018074' TO DFHEIV0
 18111     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18112     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18113     MOVE X'2020233030303138303734' TO DFHEIV0(25:11)
 18114     CALL 'kxdfhei1' USING DFHEIV0,
 18115           FILE-ID-ERRESS,
 18116           WS-ERRESS-KEY,
 18117           DFHEIV99,
 18118           DFHEIV11,
 18119           DFHEIV99
 18120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18121
 18122
 18123 6620-READ-NEXT-ERRESS-MASTER.
 18124
 18125
 18126* EXEC CICS HANDLE CONDITION
 18127*        NOTFND    (6630-END-OF-FILE)
 18128*        ENDFILE   (6630-END-OF-FILE)
 18129*        DISABLED  (6630-ERRESS-PROBLEM)
 18130*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18131*    END-EXEC.
 18132*    MOVE '"$I''cJ                ! % #00018082' TO DFHEIV0
 18133     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18134     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18135     MOVE X'2520233030303138303832' TO DFHEIV0(25:11)
 18136     CALL 'kxdfhei1' USING DFHEIV0
 18137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18138
 18139
 18140
 18141* EXEC CICS READNEXT
 18142*        DATASET (FILE-ID-ERRESS)
 18143*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18144*        RIDFLD  (WS-ERRESS-KEY)
 18145*    END-EXEC.
 18146     MOVE LENGTH OF
 18147      RESIDENT-STATE-TAX-MASTER
 18148       TO DFHEIV12
 18149     MOVE 0
 18150       TO DFHEIV11
 18151*    MOVE '&.IL                  )   #00018089' TO DFHEIV0
 18152     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18153     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18154     MOVE X'2020233030303138303839' TO DFHEIV0(25:11)
 18155     CALL 'kxdfhei1' USING DFHEIV0,
 18156           FILE-ID-ERRESS,
 18157           RESIDENT-STATE-TAX-MASTER,
 18158           DFHEIV12,
 18159           WS-ERRESS-KEY,
 18160           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 332
* EL050.cbl
 18161           DFHEIV11,
 18162           DFHEIV99,
 18163           DFHEIV99
 18164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18165
 18166
 18167     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18168
 18169* EXEC CICS ENDBR
 18170*            DATASET (FILE-ID-ERRESS)
 18171*       END-EXEC
 18172     MOVE 0
 18173       TO DFHEIV11
 18174*    MOVE '&2                    $   #00018096' TO DFHEIV0
 18175     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18176     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18177     MOVE X'2020233030303138303936' TO DFHEIV0(25:11)
 18178     CALL 'kxdfhei1' USING DFHEIV0,
 18179           FILE-ID-ERRESS,
 18180           DFHEIV11,
 18181           DFHEIV99
 18182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18183        GO TO 6630-END-OF-FILE.
 18184
 18185     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18186        NEXT SENTENCE
 18187      ELSE
 18188        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18189
 18190*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18191*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18192*
 18193     MOVE +2                     TO WS-SUB1.
 18194
 18195     IF PB-ISSUE
 18196     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18197        MOVE +1                  TO WS-SUB1.
 18198
 18199     IF PB-CANCELLATION
 18200     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18201        MOVE +1                  TO WS-SUB1.
 18202*
 18203*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18204*
 18205***  Y2K PROJ 7744
 18206     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18207***  Y2K PROJ 7744
 18208
 18209*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18210* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18211* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18212
 18213     ADD 1                    TO WS-YEAR-YY.
 18214
 18215     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18216         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18217                              TO WS-RES-STATE-TAX
 18218         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 333
* EL050.cbl
 18219                              TO WS-RES-MUNI-TAX
 18220     ELSE
 18221         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18222                              TO WS-RES-STATE-TAX
 18223         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18224                              TO WS-RES-MUNI-TAX.
 18225
 18226*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18227
 18228     IF PB-CANCELLATION
 18229         GO TO 6640-CANCEL-TAX.
 18230
 18231     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18232         COMPUTE PB-I-STATE-TAX ROUNDED =
 18233                                   PB-I-LF-PREMIUM-AMT
 18234                                 * WS-RES-STATE-TAX
 18235         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18236                                   PB-I-LF-PREMIUM-AMT
 18237                                 * WS-RES-MUNI-TAX
 18238     ELSE
 18239     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18240         COMPUTE PB-I-STATE-TAX ROUNDED =
 18241                                   PB-I-AH-PREMIUM-AMT
 18242                                 * WS-RES-STATE-TAX
 18243         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18244                                   PB-I-AH-PREMIUM-AMT
 18245                                 * WS-RES-MUNI-TAX.
 18246
 18247
 18248* EXEC CICS ENDBR
 18249*         DATASET (FILE-ID-ERRESS)
 18250*    END-EXEC.
 18251     MOVE 0
 18252       TO DFHEIV11
 18253*    MOVE '&2                    $   #00018163' TO DFHEIV0
 18254     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18255     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18256     MOVE X'2020233030303138313633' TO DFHEIV0(25:11)
 18257     CALL 'kxdfhei1' USING DFHEIV0,
 18258           FILE-ID-ERRESS,
 18259           DFHEIV11,
 18260           DFHEIV99
 18261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18262
 18263
 18264     GO TO 6640-EXIT.
 18265
 18266 6640-CANCEL-TAX.
 18267     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18268
 18269     IF PB-C-LF-CANCEL-AMT > ZEROS
 18270         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18271                                   PB-C-LF-CANCEL-AMT
 18272                                 * WS-RES-STATE-TAX
 18273         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18274                                   PB-C-LF-CANCEL-AMT
 18275                                *  WS-RES-MUNI-TAX
 18276     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 334
* EL050.cbl
 18277     IF PB-C-AH-CANCEL-AMT > ZEROS
 18278         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18279                                   PB-C-AH-CANCEL-AMT
 18280                                 * WS-RES-STATE-TAX
 18281         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18282                                   PB-C-AH-CANCEL-AMT
 18283                                *  WS-RES-MUNI-TAX.
 18284
 18285
 18286* EXEC CICS ENDBR
 18287*         DATASET (FILE-ID-ERRESS)
 18288*    END-EXEC.
 18289     MOVE 0
 18290       TO DFHEIV11
 18291*    MOVE '&2                    $   #00018188' TO DFHEIV0
 18292     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18293     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18294     MOVE X'2020233030303138313838' TO DFHEIV0(25:11)
 18295     CALL 'kxdfhei1' USING DFHEIV0,
 18296           FILE-ID-ERRESS,
 18297           DFHEIV11,
 18298           DFHEIV99
 18299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18300
 18301
 18302     GO TO 6640-EXIT.
 18303
 18304 6630-END-OF-FILE.
 18305     MOVE ER-8002              TO WS-ERROR.
 18306     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18307
 18308     GO TO 6640-EXIT.
 18309
 18310 6630-ERRESS-PROBLEM.
 18311     MOVE ER-8044              TO WS-ERROR.
 18312     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18313
 18314 6640-EXIT.
 18315     EXIT.
 18316
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 335
* EL050.cbl
 18318 6650-GET-RES-STATE-COMM.
 18319
 18320     IF PB-COMPANY-ID NOT = 'DMD'
 18321         GO TO 6700-COMM-EXIT.
 18322
 18323     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18324     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18325     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18326     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18327     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18328     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18329     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18330
 18331*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18332*
 18333***  Y2K PROJ 7744
 18334     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18335     SET BIN-TO-GREG          TO TRUE.
 18336     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18337
 18338     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18339***  Y2K PROJ 7744
 18340
 18341     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18342
 18343
 18344* EXEC CICS HANDLE CONDITION
 18345*        INVREQ    (6660-START-BROWSE)
 18346*        DISABLED  (6690-ERRESC-PROBLEM)
 18347*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18348*        NOTFND    (6690-END-OF-FILE)
 18349*    END-EXEC.
 18350*    MOVE '"$8cJI                ! & #00018233' TO DFHEIV0
 18351     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18352     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18353     MOVE X'2620233030303138323333' TO DFHEIV0(25:11)
 18354     CALL 'kxdfhei1' USING DFHEIV0
 18355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18356
 18357
 18358
 18359* EXEC CICS RESETBR
 18360*        DATASET (FILE-ID-ERRESC)
 18361*        RIDFLD  (WS-ERRESC-KEY)
 18362*    END-EXEC.
 18363     MOVE 0
 18364       TO DFHEIV11
 18365*    MOVE '&4         G          &   #00018240' TO DFHEIV0
 18366     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18367     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18368     MOVE X'2020233030303138323430' TO DFHEIV0(25:11)
 18369     CALL 'kxdfhei1' USING DFHEIV0,
 18370           FILE-ID-ERRESC,
 18371           WS-ERRESC-KEY,
 18372           DFHEIV99,
 18373           DFHEIV11,
 18374           DFHEIV99
 18375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 336
* EL050.cbl
 18376
 18377
 18378 6660-START-BROWSE.
 18379
 18380
 18381* EXEC CICS HANDLE CONDITION
 18382*        NOTFND    (6690-END-OF-FILE)
 18383*        DISABLED  (6690-ERRESC-PROBLEM)
 18384*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18385*        ENDFILE   (6690-END-OF-FILE)
 18386*    END-EXEC.
 18387*    MOVE '"$IcJ''                ! '' #00018247' TO DFHEIV0
 18388     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18389     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18390     MOVE X'2720233030303138323437' TO DFHEIV0(25:11)
 18391     CALL 'kxdfhei1' USING DFHEIV0
 18392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18393
 18394
 18395
 18396* EXEC CICS STARTBR
 18397*        DATASET (FILE-ID-ERRESC)
 18398*        RIDFLD  (WS-ERRESC-KEY)
 18399*        GTEQ
 18400*    END-EXEC.
 18401     MOVE 0
 18402       TO DFHEIV11
 18403*    MOVE '&,         G          &   #00018254' TO DFHEIV0
 18404     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18405     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18406     MOVE X'2020233030303138323534' TO DFHEIV0(25:11)
 18407     CALL 'kxdfhei1' USING DFHEIV0,
 18408           FILE-ID-ERRESC,
 18409           WS-ERRESC-KEY,
 18410           DFHEIV99,
 18411           DFHEIV11,
 18412           DFHEIV99
 18413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18414
 18415
 18416     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18417
 18418 6670-READ-NEXT-ERRESC-MASTER.
 18419
 18420
 18421* EXEC CICS HANDLE CONDITION
 18422*        NOTFND    (6690-END-OF-FILE)
 18423*        DISABLED  (6690-ERRESC-PROBLEM)
 18424*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18425*        ENDFILE   (6690-END-OF-FILE)
 18426*    END-EXEC.
 18427*    MOVE '"$IcJ''                ! ( #00018264' TO DFHEIV0
 18428     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18430     MOVE X'2820233030303138323634' TO DFHEIV0(25:11)
 18431     CALL 'kxdfhei1' USING DFHEIV0
 18432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18433
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 337
* EL050.cbl
 18434
 18435
 18436* EXEC CICS READNEXT
 18437*        DATASET (FILE-ID-ERRESC)
 18438*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18439*        RIDFLD  (ERRESC-RECORD-KEY)
 18440*    END-EXEC.
 18441     MOVE LENGTH OF
 18442      ACCOUNT-RESIDENT-ST-COMMISSION
 18443       TO DFHEIV12
 18444     MOVE 0
 18445       TO DFHEIV11
 18446*    MOVE '&.IL                  )   #00018271' TO DFHEIV0
 18447     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18448     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18449     MOVE X'2020233030303138323731' TO DFHEIV0(25:11)
 18450     CALL 'kxdfhei1' USING DFHEIV0,
 18451           FILE-ID-ERRESC,
 18452           ACCOUNT-RESIDENT-ST-COMMISSION,
 18453           DFHEIV12,
 18454           ERRESC-RECORD-KEY,
 18455           DFHEIV99,
 18456           DFHEIV11,
 18457           DFHEIV99,
 18458           DFHEIV99
 18459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18460
 18461
 18462     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18463        NEXT SENTENCE
 18464     ELSE
 18465
 18466* EXEC CICS ENDBR
 18467*            DATASET (FILE-ID-ERRESC)
 18468*       END-EXEC
 18469     MOVE 0
 18470       TO DFHEIV11
 18471*    MOVE '&2                    $   #00018280' TO DFHEIV0
 18472     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18473     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18474     MOVE X'2020233030303138323830' TO DFHEIV0(25:11)
 18475     CALL 'kxdfhei1' USING DFHEIV0,
 18476           FILE-ID-ERRESC,
 18477           DFHEIV11,
 18478           DFHEIV99
 18479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18480        GO TO 6690-END-OF-FILE.
 18481
 18482     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18483
 18484* EXEC CICS ENDBR
 18485*            DATASET (FILE-ID-ERRESC)
 18486*       END-EXEC
 18487     MOVE 0
 18488       TO DFHEIV11
 18489*    MOVE '&2                    $   #00018286' TO DFHEIV0
 18490     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18491     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 338
* EL050.cbl
 18492     MOVE X'2020233030303138323836' TO DFHEIV0(25:11)
 18493     CALL 'kxdfhei1' USING DFHEIV0,
 18494           FILE-ID-ERRESC,
 18495           DFHEIV11,
 18496           DFHEIV99
 18497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18498        GO TO 6690-END-OF-FILE.
 18499
 18500     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18501        NEXT SENTENCE
 18502      ELSE
 18503        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18504
 18505* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18506*
 18507     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18508
 18509     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18510
 18511     IF WS-SUB1 > ZERO
 18512         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18513             PERFORM 6680-SET-COMMISSION
 18514         ELSE
 18515             PERFORM 6680-SET-TABLE-CODE.
 18516
 18517
 18518* EXEC CICS ENDBR
 18519*         DATASET (FILE-ID-ERRESC)
 18520*    END-EXEC.
 18521     MOVE 0
 18522       TO DFHEIV11
 18523*    MOVE '&2                    $   #00018308' TO DFHEIV0
 18524     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18525     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18526     MOVE X'2020233030303138333038' TO DFHEIV0(25:11)
 18527     CALL 'kxdfhei1' USING DFHEIV0,
 18528           FILE-ID-ERRESC,
 18529           DFHEIV11,
 18530           DFHEIV99
 18531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18532
 18533
 18534     GO TO 6700-COMM-EXIT.
 18535
 18536 6680-SET-TABLE-CODE.
 18537     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18538        MOVE ZEROS             TO WS-SUB1
 18539     ELSE
 18540* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18541* TO COMPUTE AH COMMISSION.
 18542        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18543        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18544        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18545        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18546        PERFORM 6680-READ-CTBL-TABLE
 18547        IF WS-CTBL-READ-SW NOT = 'Y'
 18548           MOVE ZEROS          TO WS-SUB1.
 18549
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 339
* EL050.cbl
 18550 6680-READ-CTBL-TABLE.
 18551*
 18552* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18553* TO COMPUTE LIFE COMMISSION
 18554
 18555     IF CTBL-SW = '0540'
 18556        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18557        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18558        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18559
 18560     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18561
 18562     IF CTBL-TABLE-FOUND
 18563        IF CTBL-SW = '0530'
 18564             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18565                                    * PB-I-AH-TERM
 18566             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18567             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18568        ELSE
 18569             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18570             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18571             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18572     ELSE
 18573        IF FIRST-TIME-THROUGH
 18574            GO TO 6680-READ-CTBL-TABLE
 18575        ELSE
 18576            MOVE ZEROS         TO WS-SUB1.
 18577
 18578 6680-SET-COMMISSION.
 18579     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18580           MOVE ZEROS          TO WS-SUB1
 18581       ELSE
 18582           MOVE RESC-COMMISSION-PER (WS-SUB)
 18583                               TO WS-COMMISSION
 18584           IF CTBL-SW = '0530'
 18585               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18586           ELSE
 18587               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18588
 18589 6680-SEARCH-CATEGORY.
 18590     ADD +1                   TO WS-SUB.
 18591     IF WS-SUB > +12
 18592         GO TO 6680-EXIT.
 18593
 18594     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18595          MOVE WS-SUB         TO WS-SUB1
 18596          GO TO 6680-EXIT.
 18597
 18598     GO TO 6680-SEARCH-CATEGORY.
 18599
 18600 6680-EXIT.
 18601     EXIT.
 18602
 18603 6690-END-OF-FILE.
 18604     GO TO 6700-COMM-EXIT.
 18605
 18606 6690-ERRESC-PROBLEM.
 18607      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 340
* EL050.cbl
 18608      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18609
 18610      GO TO 6700-COMM-EXIT.
 18611
 18612 6700-COMM-EXIT.
 18613     EXIT.
 18614
 18615 7000-GET-RATE.
 18616
 18617* EXEC CICS LINK
 18618*        PROGRAM    ('ELRATE')
 18619*        COMMAREA   (CALCULATION-PASS-AREA)
 18620*        LENGTH     (CP-COMM-LENGTH)
 18621*    END-EXEC.
 18622     MOVE 'ELRATE' TO DFHEIV1
 18623*    MOVE '."C                   (   #00018394' TO DFHEIV0
 18624     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18625     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18626     MOVE X'2020233030303138333934' TO DFHEIV0(25:11)
 18627     CALL 'kxdfhei1' USING DFHEIV0,
 18628           DFHEIV1,
 18629           CALCULATION-PASS-AREA,
 18630           CP-COMM-LENGTH,
 18631           DFHEIV99,
 18632           DFHEIV99,
 18633           DFHEIV99,
 18634           DFHEIV99
 18635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18636
 18637
 18638 7000-EXIT.
 18639     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 341
* EL050.cbl
 18641 7100-FIND-BENEFIT-IN-STATE.
 18642     MOVE 'N'                    TO BEN-SEARCH-SW.
 18643
 18644     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18645         VARYING SUB3 FROM 1 BY 1 UNTIL
 18646            ((SUB3 GREATER 50) OR
 18647              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18648               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18649
 18650     IF SUB3 NOT = 51
 18651         MOVE 'Y'                TO BEN-SEARCH-SW.
 18652
 18653     GO TO 7199-EXIT.
 18654
 18655 7100-BENEFIT-DUMMY.
 18656
 18657 7100-DUMMY-EXIT.
 18658     EXIT.
 18659
 18660 7199-EXIT.
 18661     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 342
* EL050.cbl
 18663 7200-FIND-BENEFIT.
 18664     MOVE 'N'                    TO BEN-SEARCH-SW.
 18665
 18666     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18667         VARYING SUB3 FROM 1 BY 1 UNTIL
 18668            ((SUB3 GREATER 8) OR
 18669            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18670
 18671     IF SUB3 NOT = 9
 18672         MOVE 'Y'                TO BEN-SEARCH-SW.
 18673
 18674     GO TO 7200-EXIT.
 18675
 18676 7200-BENEFIT-DUMMY.
 18677
 18678 7200-DUMMY-EXIT.
 18679     EXIT.
 18680
 18681 7200-EXIT.
 18682     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 343
* EL050.cbl
 18684 7250-LOOK-FOR-RESCINDED-CLAIM.
 18685     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18686                                    W-CL-COMP-CD.
 18687     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18688                                    W-CL-CERT-NO.
 18689
 18690
 18691* EXEC CICS HANDLE CONDITION
 18692*        NOTFND  (7250-CONTINUE)
 18693*        ENDFILE (7250-CONTINUE)
 18694*    END-EXEC.
 18695*    MOVE '"$I''                  ! ) #00018452' TO DFHEIV0
 18696     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18698     MOVE X'2920233030303138343532' TO DFHEIV0(25:11)
 18699     CALL 'kxdfhei1' USING DFHEIV0
 18700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18701
 18702
 18703
 18704* EXEC CICS IGNORE CONDITION
 18705*        DUPKEY
 18706*    END-EXEC.
 18707*    MOVE '"*$                   !   #00018457' TO DFHEIV0
 18708     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18709     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18710     MOVE X'2020233030303138343537' TO DFHEIV0(25:11)
 18711     CALL 'kxdfhei1' USING DFHEIV0
 18712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18713
 18714
 18715
 18716* EXEC CICS STARTBR
 18717*        DATASET   (CLMS-ID)
 18718*        RIDFLD    (ELMSTR-KEY)
 18719*        GENERIC   EQUAL
 18720*        KEYLENGTH (ELMSTR-LENGTH)
 18721*    END-EXEC.
 18722     MOVE 0
 18723       TO DFHEIV11
 18724*    MOVE '&,   KG    E          &   #00018461' TO DFHEIV0
 18725     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18726     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18727     MOVE X'2020233030303138343631' TO DFHEIV0(25:11)
 18728     CALL 'kxdfhei1' USING DFHEIV0,
 18729           CLMS-ID,
 18730           ELMSTR-KEY,
 18731           ELMSTR-LENGTH,
 18732           DFHEIV11,
 18733           DFHEIV99
 18734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18735
 18736
 18737     MOVE 'Y'                    TO W-BROWSE-SW.
 18738
 18739 7250-NEXT-CLAIM.
 18740
 18741
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 344
* EL050.cbl
 18742* EXEC CICS READNEXT
 18743*        DATASET   (CLMS-ID)
 18744*        RIDFLD    (ELMSTR-KEY)
 18745*        SET       (ADDRESS OF CLAIM-MASTER)
 18746*    END-EXEC.
 18747     MOVE 0
 18748       TO DFHEIV11
 18749*    MOVE '&.S                   )   #00018472' TO DFHEIV0
 18750     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18751     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18752     MOVE X'2020233030303138343732' TO DFHEIV0(25:11)
 18753     CALL 'kxdfhei1' USING DFHEIV0,
 18754           CLMS-ID,
 18755           DFHEIV20,
 18756           DFHEIV99,
 18757           ELMSTR-KEY,
 18758           DFHEIV99,
 18759           DFHEIV11,
 18760           DFHEIV99,
 18761           DFHEIV99
 18762     SET ADDRESS OF CLAIM-MASTER TO
 18763         DFHEIV20
 18764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18765
 18766
 18767     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18768        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18769         GO TO 7250-CONTINUE
 18770     END-IF.
 18771
 18772     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18773        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18774        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18775        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18776        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18777         GO TO 7250-NEXT-CLAIM
 18778     END-IF.
 18779
 18780     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18781        OR (CL-CLAIM-TYPE = 'I')
 18782        OR (CL-CLAIM-TYPE = 'G')
 18783          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18784              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18785              GO TO 7250-CONTINUE
 18786          END-IF
 18787     END-IF.
 18788
 18789     GO TO 7250-NEXT-CLAIM.
 18790
 18791 7250-CONTINUE.
 18792
 18793     IF W-BROWSE-SW = 'Y'
 18794
 18795* EXEC CICS ENDBR
 18796*            DATASET   (CLMS-ID)
 18797*        END-EXEC
 18798     MOVE 0
 18799       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 345
* EL050.cbl
 18800*    MOVE '&2                    $   #00018505' TO DFHEIV0
 18801     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18802     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18803     MOVE X'2020233030303138353035' TO DFHEIV0(25:11)
 18804     CALL 'kxdfhei1' USING DFHEIV0,
 18805           CLMS-ID,
 18806           DFHEIV11,
 18807           DFHEIV99
 18808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18809         MOVE 'N' TO W-BROWSE-SW
 18810     END-IF.
 18811
 18812 7250-EXIT.
 18813     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 346
* EL050.cbl
 18815 7300-CHECK-FOR-OPEN-CLMS.
 18816
 18817*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18818*    MOVE SPACES                 TO CNTL-ACCESS.
 18819*    MOVE '1'                    TO CNTL-REC-TYPE.
 18820*    MOVE +0                     TO CNTL-SEQ-NO.
 18821
 18822*    MOVE '3'                    TO RC-SW-1.
 18823*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18824
 18825*    IF NOT CF-COMPANY-MASTER
 18826*         PERFORM 0099-COMPANY-NOT-FOUND
 18827*         GO TO 7300-EXIT.
 18828
 18829     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18830                                    W-CL-COMP-CD.
 18831     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18832                                    W-CL-CERT-NO.
 18833
 18834
 18835* EXEC CICS HANDLE CONDITION
 18836*        NOTFND  (7300-CONTINUE)
 18837*        ENDFILE (7300-CONTINUE)
 18838*    END-EXEC.
 18839*    MOVE '"$I''                  ! * #00018533' TO DFHEIV0
 18840     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18841     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18842     MOVE X'2A20233030303138353333' TO DFHEIV0(25:11)
 18843     CALL 'kxdfhei1' USING DFHEIV0
 18844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18845
 18846
 18847
 18848* EXEC CICS IGNORE CONDITION
 18849*        DUPKEY
 18850*    END-EXEC.
 18851*    MOVE '"*$                   !   #00018538' TO DFHEIV0
 18852     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18853     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18854     MOVE X'2020233030303138353338' TO DFHEIV0(25:11)
 18855     CALL 'kxdfhei1' USING DFHEIV0
 18856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18857
 18858
 18859
 18860* EXEC CICS STARTBR
 18861*        DATASET   (CLMS-ID)
 18862*        RIDFLD    (ELMSTR-KEY)
 18863*        GENERIC   EQUAL
 18864*        KEYLENGTH (ELMSTR-LENGTH)
 18865*    END-EXEC.
 18866     MOVE 0
 18867       TO DFHEIV11
 18868*    MOVE '&,   KG    E          &   #00018542' TO DFHEIV0
 18869     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18870     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18871     MOVE X'2020233030303138353432' TO DFHEIV0(25:11)
 18872     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 347
* EL050.cbl
 18873           CLMS-ID,
 18874           ELMSTR-KEY,
 18875           ELMSTR-LENGTH,
 18876           DFHEIV11,
 18877           DFHEIV99
 18878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18879
 18880
 18881     MOVE 'Y'                    TO W-BROWSE-SW.
 18882
 18883 7300-NEXT-CLAIM.
 18884
 18885
 18886* EXEC CICS READNEXT
 18887*        DATASET   (CLMS-ID)
 18888*        RIDFLD    (ELMSTR-KEY)
 18889*        SET       (ADDRESS OF CLAIM-MASTER)
 18890*    END-EXEC.
 18891     MOVE 0
 18892       TO DFHEIV11
 18893*    MOVE '&.S                   )   #00018553' TO DFHEIV0
 18894     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18895     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18896     MOVE X'2020233030303138353533' TO DFHEIV0(25:11)
 18897     CALL 'kxdfhei1' USING DFHEIV0,
 18898           CLMS-ID,
 18899           DFHEIV20,
 18900           DFHEIV99,
 18901           ELMSTR-KEY,
 18902           DFHEIV99,
 18903           DFHEIV11,
 18904           DFHEIV99,
 18905           DFHEIV99
 18906     SET ADDRESS OF CLAIM-MASTER TO
 18907         DFHEIV20
 18908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18909
 18910
 18911     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18912        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18913         GO TO 7300-CONTINUE.
 18914
 18915     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18916        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18917        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18918        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18919        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18920         GO TO 7300-NEXT-CLAIM.
 18921
 18922*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18923     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18924        OR (CL-CLAIM-TYPE = 'I')
 18925        OR (CL-CLAIM-TYPE = 'G')
 18926        IF CLAIM-IS-OPEN
 18927           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18928             AND PB-C-AH-CANCEL-DT > SPACES
 18929              MOVE ER-2896        TO WS-ERROR
 18930              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 348
* EL050.cbl
 18931           END-IF
 18932           EVALUATE TRUE
 18933             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18934                 MOVE ER-2884      TO WS-ERROR
 18935             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 18936                 MOVE ER-2887      TO WS-ERROR
 18937             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18938                 MOVE ER-2886      TO WS-ERROR
 18939             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18940                 MOVE ER-2888      TO WS-ERROR
 18941             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18942                 MOVE ER-2885      TO WS-ERROR
 18943             WHEN OTHER
 18944                 MOVE ER-2768      TO WS-ERROR
 18945           END-EVALUATE
 18946           IF PB-C-AH-CANCEL-VOIDED OR
 18947              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18948                NOT AH-COVERAGE-CANCELLED)
 18949               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18950               MOVE ER-2768      TO WS-ERROR
 18951           END-IF
 18952           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18953           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18954              PB-FORCE-CODE NOT EQUAL '8'
 18955               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18956           END-IF
 18957           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18958           GO TO 7300-NEXT-CLAIM
 18959        ELSE
 18960           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18961*****THIS IS A RESCISSION OR REFORMATION
 18962              IF (AH-COVERAGE-CANCELLED AND
 18963                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18964                    MOVE ER-2890 TO WS-ERROR
 18965                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18966                    GO TO 7300-NEXT-CLAIM
 18967              END-IF
 18968           ELSE
 18969              IF CL-DENIAL-TYPE = '1'  AND
 18970                 CL-TOTAL-PAID-AMT = 0
 18971                    GO TO 7300-NEXT-CLAIM
 18972              END-IF
 18973              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18974               AND PB-C-AH-CANCEL-DT > SPACES
 18975                 MOVE ER-2756        TO WS-ERROR
 18976                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18977                 GO TO 7300-NEXT-CLAIM
 18978              END-IF
 18979           END-IF
 18980        END-IF
 18981     ELSE
 18982*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18983        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18984           IF CLAIM-IS-OPEN
 18985              MOVE ER-2889      TO WS-ERROR
 18986              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18987              GO TO 7300-NEXT-CLAIM
 18988           ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 349
* EL050.cbl
 18989              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18990*****THIS IS A RESCISSION OR REFORMATION
 18991                 IF (LF-COVERAGE-CANCELLED AND
 18992                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18993                       MOVE ER-2890 TO WS-ERROR
 18994                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18995                       GO TO 7300-NEXT-CLAIM
 18996                 END-IF
 18997              ELSE
 18998                 IF CL-DENIAL-TYPE = '1'  AND
 18999                    CL-TOTAL-PAID-AMT = 0
 19000                       GO TO 7300-NEXT-CLAIM
 19001                 END-IF
 19002                 IF (AH-COVERAGE-CANCELLED AND
 19003                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 19004                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 19005                    (LF-COVERAGE-CANCELLED AND
 19006                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 19007                     WS-ST-REFUND-CLAIM-FLAG = '4')
 19008                       MOVE ER-2965 TO WS-ERROR
 19009                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19010                       GO TO 7300-NEXT-CLAIM
 19011                 END-IF
 19012                 IF LF-COVERAGE-CANCELLED
 19013                  IF CL-TOTAL-PAID-AMT > 0
 19014                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19015                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19016                        MOVE ER-2891 TO WS-ERROR
 19017                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19018                        GO TO 7300-NEXT-CLAIM
 19019                      END-IF
 19020                    ELSE
 19021****only show this error if cert num matches exactly
 19022                      IF PB-CERT-NO = CL-CERT-NO
 19023                         MOVE ER-2892 TO WS-ERROR
 19024                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19025                         GO TO 7300-NEXT-CLAIM
 19026                      END-IF
 19027                    END-IF
 19028                  END-IF
 19029                 END-IF
 19030              END-IF
 19031           END-IF
 19032        END-IF
 19033     END-IF
 19034
 19035     GO TO 7300-NEXT-CLAIM.
 19036
 19037 7300-CONTINUE.
 19038
 19039     IF W-BROWSE-SW = 'Y'
 19040
 19041* EXEC CICS ENDBR
 19042*            DATASET   (CLMS-ID)
 19043*        END-EXEC.
 19044     MOVE 0
 19045       TO DFHEIV11
 19046*    MOVE '&2                    $   #00018688' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 350
* EL050.cbl
 19047     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19048     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19049     MOVE X'2020233030303138363838' TO DFHEIV0(25:11)
 19050     CALL 'kxdfhei1' USING DFHEIV0,
 19051           CLMS-ID,
 19052           DFHEIV11,
 19053           DFHEIV99
 19054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19055
 19056
 19057 7300-EXIT.
 19058     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 351
* EL050.cbl
 19060
 19061 7400-GET-REMAIN-TERM.
 19062
 19063* EXEC CICS LINK
 19064*        PROGRAM    ('ELRTRM')
 19065*        COMMAREA   (CALCULATION-PASS-AREA)
 19066*        LENGTH     (CP-COMM-LENGTH)
 19067*    END-EXEC.
 19068     MOVE 'ELRTRM' TO DFHEIV1
 19069*    MOVE '."C                   (   #00018697' TO DFHEIV0
 19070     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19071     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19072     MOVE X'2020233030303138363937' TO DFHEIV0(25:11)
 19073     CALL 'kxdfhei1' USING DFHEIV0,
 19074           DFHEIV1,
 19075           CALCULATION-PASS-AREA,
 19076           CP-COMM-LENGTH,
 19077           DFHEIV99,
 19078           DFHEIV99,
 19079           DFHEIV99,
 19080           DFHEIV99
 19081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19082
 19083
 19084 7400-EXIT.
 19085     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 352
* EL050.cbl
 19087
 19088 7500-GET-REMAIN-AMOUNT.
 19089
 19090* EXEC CICS LINK
 19091*        PROGRAM    ('ELRAMT')
 19092*        COMMAREA   (CALCULATION-PASS-AREA)
 19093*        LENGTH     (CP-COMM-LENGTH)
 19094*    END-EXEC.
 19095     MOVE 'ELRAMT' TO DFHEIV1
 19096*    MOVE '."C                   (   #00018708' TO DFHEIV0
 19097     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19098     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19099     MOVE X'2020233030303138373038' TO DFHEIV0(25:11)
 19100     CALL 'kxdfhei1' USING DFHEIV0,
 19101           DFHEIV1,
 19102           CALCULATION-PASS-AREA,
 19103           CP-COMM-LENGTH,
 19104           DFHEIV99,
 19105           DFHEIV99,
 19106           DFHEIV99,
 19107           DFHEIV99
 19108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19109
 19110
 19111 7500-EXIT.
 19112     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 353
* EL050.cbl
 19114
 19115 7600-GET-REFUND.
 19116
 19117* EXEC CICS LINK
 19118*        PROGRAM    ('ELRFND')
 19119*        COMMAREA   (CALCULATION-PASS-AREA)
 19120*        LENGTH     (CP-COMM-LENGTH)
 19121*    END-EXEC.
 19122     MOVE 'ELRFND' TO DFHEIV1
 19123*    MOVE '."C                   (   #00018719' TO DFHEIV0
 19124     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19125     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19126     MOVE X'2020233030303138373139' TO DFHEIV0(25:11)
 19127     CALL 'kxdfhei1' USING DFHEIV0,
 19128           DFHEIV1,
 19129           CALCULATION-PASS-AREA,
 19130           CP-COMM-LENGTH,
 19131           DFHEIV99,
 19132           DFHEIV99,
 19133           DFHEIV99,
 19134           DFHEIV99
 19135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19136
 19137
 19138 7600-EXIT.
 19139     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 354
* EL050.cbl
 19141 7700-CALL-DL1.
 19142
 19143* EXEC CICS LINK
 19144*        PROGRAM    ('DLO001')
 19145*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19146*        LENGTH     (DLO001-COMM-LENGTH)
 19147*    END-EXEC.
 19148     MOVE 'DLO001' TO DFHEIV1
 19149*    MOVE '."C                   (   #00018729' TO DFHEIV0
 19150     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19151     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19152     MOVE X'2020233030303138373239' TO DFHEIV0(25:11)
 19153     CALL 'kxdfhei1' USING DFHEIV0,
 19154           DFHEIV1,
 19155           WS-DLO-MASTER-POLICY-FORM,
 19156           DLO001-COMM-LENGTH,
 19157           DFHEIV99,
 19158           DFHEIV99,
 19159           DFHEIV99,
 19160           DFHEIV99
 19161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19162
 19163
 19164 7700-EXIT.
 19165     EXIT.
 19166
 19167 7710-CALL-DL2.
 19168
 19169* EXEC CICS LINK
 19170*        PROGRAM    ('DLO002')
 19171*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19172*        LENGTH     (DLO002-COMM-LENGTH)
 19173*    END-EXEC.
 19174     MOVE 'DLO002' TO DFHEIV1
 19175*    MOVE '."C                   (   #00018739' TO DFHEIV0
 19176     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19177     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19178     MOVE X'2020233030303138373339' TO DFHEIV0(25:11)
 19179     CALL 'kxdfhei1' USING DFHEIV0,
 19180           DFHEIV1,
 19181           WS-DLO-INTERNAL-POLICY-FORM,
 19182           DLO002-COMM-LENGTH,
 19183           DFHEIV99,
 19184           DFHEIV99,
 19185           DFHEIV99,
 19186           DFHEIV99
 19187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19188
 19189
 19190 7710-EXIT.
 19191     EXIT.
 19192
 19193 7720-CALL-DL3.
 19194
 19195* EXEC CICS LINK
 19196*        PROGRAM    ('DLO003')
 19197*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19198*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 355
* EL050.cbl
 19199*    END-EXEC.
 19200     MOVE 'DLO003' TO DFHEIV1
 19201*    MOVE '."C                   (   #00018749' TO DFHEIV0
 19202     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19203     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19204     MOVE X'2020233030303138373439' TO DFHEIV0(25:11)
 19205     CALL 'kxdfhei1' USING DFHEIV0,
 19206           DFHEIV1,
 19207           WS-DLO-VALID-BANK-ID,
 19208           DLO003-COMM-LENGTH,
 19209           DFHEIV99,
 19210           DFHEIV99,
 19211           DFHEIV99,
 19212           DFHEIV99
 19213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19214
 19215
 19216 7720-EXIT.
 19217     EXIT.
 19218
 19219 7730-CALL-DL7.
 19220
 19221* EXEC CICS LINK
 19222*        PROGRAM    ('DLO007')
 19223*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19224*        LENGTH     (DLO007-COMM-LENGTH)
 19225*    END-EXEC.
 19226     MOVE 'DLO007' TO DFHEIV1
 19227*    MOVE '."C                   (   #00018759' TO DFHEIV0
 19228     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19229     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19230     MOVE X'2020233030303138373539' TO DFHEIV0(25:11)
 19231     CALL 'kxdfhei1' USING DFHEIV0,
 19232           DFHEIV1,
 19233           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19234           DLO007-COMM-LENGTH,
 19235           DFHEIV99,
 19236           DFHEIV99,
 19237           DFHEIV99,
 19238           DFHEIV99
 19239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19240
 19241
 19242 7730-EXIT.
 19243     EXIT.
 19244
 19245 7740-CALL-DL11.
 19246
 19247* EXEC CICS LINK
 19248*        PROGRAM    ('DLO011')
 19249*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19250*        LENGTH     (DLO011-COMM-LENGTH)
 19251*    END-EXEC.
 19252     MOVE 'DLO011' TO DFHEIV1
 19253*    MOVE '."C                   (   #00018769' TO DFHEIV0
 19254     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19255     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19256     MOVE X'2020233030303138373639' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 356
* EL050.cbl
 19257     CALL 'kxdfhei1' USING DFHEIV0,
 19258           DFHEIV1,
 19259           WS-DLO-PREM-RATES-BEN-TYPE,
 19260           DLO011-COMM-LENGTH,
 19261           DFHEIV99,
 19262           DFHEIV99,
 19263           DFHEIV99,
 19264           DFHEIV99
 19265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19266
 19267
 19268 7740-EXIT.
 19269     EXIT.
 19270
 19271 7750-CALL-DL17.
 19272
 19273* EXEC CICS LINK
 19274*        PROGRAM    ('DLO017')
 19275*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19276*        LENGTH     (DLO017-COMM-LENGTH)
 19277*    END-EXEC.
 19278     MOVE 'DLO017' TO DFHEIV1
 19279*    MOVE '."C                   (   #00018779' TO DFHEIV0
 19280     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19281     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19282     MOVE X'2020233030303138373739' TO DFHEIV0(25:11)
 19283     CALL 'kxdfhei1' USING DFHEIV0,
 19284           DFHEIV1,
 19285           WS-DLO-VALID-RATE-CODE,
 19286           DLO017-COMM-LENGTH,
 19287           DFHEIV99,
 19288           DFHEIV99,
 19289           DFHEIV99,
 19290           DFHEIV99
 19291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19292
 19293
 19294 7750-EXIT.
 19295     EXIT.
 19296
 19297 7755-CALL-DL19.
 19298
 19299* EXEC CICS LINK
 19300*        PROGRAM    ('DLO019')
 19301*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19302*        LENGTH     (DLO019-COMM-LENGTH)
 19303*    END-EXEC.
 19304     MOVE 'DLO019' TO DFHEIV1
 19305*    MOVE '."C                   (   #00018789' TO DFHEIV0
 19306     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19307     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19308     MOVE X'2020233030303138373839' TO DFHEIV0(25:11)
 19309     CALL 'kxdfhei1' USING DFHEIV0,
 19310           DFHEIV1,
 19311           WS-DLO-ORIG-COV-CAT,
 19312           DLO019-COMM-LENGTH,
 19313           DFHEIV99,
 19314           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 357
* EL050.cbl
 19315           DFHEIV99,
 19316           DFHEIV99
 19317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19318
 19319
 19320 7755-EXIT.
 19321     EXIT.
 19322
 19323 7760-CALL-DL21.
 19324
 19325* EXEC CICS LINK
 19326*        PROGRAM    ('DLO021')
 19327*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19328*        LENGTH     (DLO021-COMM-LENGTH)
 19329*    END-EXEC.
 19330     MOVE 'DLO021' TO DFHEIV1
 19331*    MOVE '."C                   (   #00018799' TO DFHEIV0
 19332     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19333     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19334     MOVE X'2020233030303138373939' TO DFHEIV0(25:11)
 19335     CALL 'kxdfhei1' USING DFHEIV0,
 19336           DFHEIV1,
 19337           WS-DLO-VALID-LOAN-OFFICER,
 19338           DLO021-COMM-LENGTH,
 19339           DFHEIV99,
 19340           DFHEIV99,
 19341           DFHEIV99,
 19342           DFHEIV99
 19343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19344
 19345
 19346 7760-EXIT.
 19347     EXIT.
 19348
 19349 7770-CALL-DL22.
 19350
 19351* EXEC CICS LINK
 19352*        PROGRAM    ('DLO022')
 19353*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19354*        LENGTH     (DLO022-COMM-LENGTH)
 19355*    END-EXEC.
 19356     MOVE 'DLO022' TO DFHEIV1
 19357*    MOVE '."C                   (   #00018809' TO DFHEIV0
 19358     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19359     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19360     MOVE X'2020233030303138383039' TO DFHEIV0(25:11)
 19361     CALL 'kxdfhei1' USING DFHEIV0,
 19362           DFHEIV1,
 19363           WS-DLO-VALID-STATE-CODE,
 19364           DLO022-COMM-LENGTH,
 19365           DFHEIV99,
 19366           DFHEIV99,
 19367           DFHEIV99,
 19368           DFHEIV99
 19369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19370
 19371
 19372 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 358
* EL050.cbl
 19373     EXIT.
 19374
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 359
* EL050.cbl
 19376
 19377 7800-REWRITE-CERT.
 19378******************************************************************
 19379*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19380*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19381******************************************************************
 19382
 19383     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19384        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19385        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19386        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19387
 19388* EXEC CICS REWRITE
 19389*                  DATASET (CERT-ID)
 19390*                  FROM    (CERTIFICATE-MASTER)
 19391*              END-EXEC
 19392     MOVE LENGTH OF
 19393      CERTIFICATE-MASTER
 19394       TO DFHEIV11
 19395*    MOVE '&& L                  %   #00018830' TO DFHEIV0
 19396     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19397     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19398     MOVE X'2020233030303138383330' TO DFHEIV0(25:11)
 19399     CALL 'kxdfhei1' USING DFHEIV0,
 19400           CERT-ID,
 19401           CERTIFICATE-MASTER,
 19402           DFHEIV11,
 19403           DFHEIV99
 19404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19405        GO TO 7800-EXIT.
 19406
 19407       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19408       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19409
 19410 7800-EXIT.
 19411      EXIT.
 19412
 19413 7900-DELETE-CERT.
 19414
 19415* EXEC CICS DELETE
 19416*        DATASET (CERT-ID)
 19417*    END-EXEC.
 19418*    MOVE '&(                    &   #00018843' TO DFHEIV0
 19419     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19420     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19421     MOVE X'2020233030303138383433' TO DFHEIV0(25:11)
 19422     CALL 'kxdfhei1' USING DFHEIV0,
 19423           CERT-ID,
 19424           DFHEIV99,
 19425           DFHEIV99,
 19426           DFHEIV99,
 19427           DFHEIV99
 19428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19429
 19430
 19431 7900-EXIT.
 19432     EXIT.
 19433
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 360
* EL050.cbl
 19434 8000-WRITE-CERT.
 19435
 19436* EXEC CICS HANDLE CONDITION
 19437*        DUPKEY    (8000-FREE-MAIN)
 19438*    END-EXEC.
 19439*    MOVE '"$$                   ! + #00018851' TO DFHEIV0
 19440     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19441     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19442     MOVE X'2B20233030303138383531' TO DFHEIV0(25:11)
 19443     CALL 'kxdfhei1' USING DFHEIV0
 19444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19445
 19446
 19447
 19448* EXEC CICS WRITE
 19449*        DATASET     (CERT-ID)
 19450*        FROM        (CERTIFICATE-MASTER)
 19451*        RIDFLD      (ELCERT-KEY)
 19452*    END-EXEC.
 19453     MOVE LENGTH OF
 19454      CERTIFICATE-MASTER
 19455       TO DFHEIV11
 19456*    MOVE '&$ L                  ''   #00018855' TO DFHEIV0
 19457     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19458     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19459     MOVE X'2020233030303138383535' TO DFHEIV0(25:11)
 19460     CALL 'kxdfhei1' USING DFHEIV0,
 19461           CERT-ID,
 19462           CERTIFICATE-MASTER,
 19463           DFHEIV11,
 19464           ELCERT-KEY,
 19465           DFHEIV99,
 19466           DFHEIV99
 19467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19468
 19469
 19470 8000-FREE-MAIN.
 19471
 19472 8000-EXIT.
 19473      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 361
* EL050.cbl
 19475
 19476 8100-READ-ERPNDM.
 19477
 19478* EXEC CICS HANDLE CONDITION
 19479*         NOTFND     (8100-NOTFND)
 19480*         ENDFILE    (8100-NOTFND)
 19481*    END-EXEC.
 19482*    MOVE '"$I''                  ! , #00018868' TO DFHEIV0
 19483     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19484     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19485     MOVE X'2C20233030303138383638' TO DFHEIV0(25:11)
 19486     CALL 'kxdfhei1' USING DFHEIV0
 19487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19488
 19489
 19490     MOVE SPACES                 TO ERPNDM-FOUND.
 19491     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19492
 19493
 19494* EXEC CICS READ
 19495*         DATASET   (FILE-ERPNDM)
 19496*         RIDFLD    (PM-CONTROL-PRIMARY)
 19497*         INTO      (PENDING-MAILING-DATA)
 19498*    END-EXEC.
 19499     MOVE LENGTH OF
 19500      PENDING-MAILING-DATA
 19501       TO DFHEIV11
 19502*    MOVE '&"IL       E          (   #00018876' TO DFHEIV0
 19503     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19504     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19505     MOVE X'2020233030303138383736' TO DFHEIV0(25:11)
 19506     CALL 'kxdfhei1' USING DFHEIV0,
 19507           FILE-ERPNDM,
 19508           PENDING-MAILING-DATA,
 19509           DFHEIV11,
 19510           PM-CONTROL-PRIMARY,
 19511           DFHEIV99,
 19512           DFHEIV99,
 19513           DFHEIV99
 19514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19515
 19516
 19517     GO TO 8100-EXIT.
 19518
 19519 8100-NOTFND.
 19520
 19521     MOVE 'X'                    TO ERPNDM-FOUND.
 19522     MOVE ER-2694                TO WS-ERROR.
 19523     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19524     MOVE ER-2883                TO WS-ERROR
 19525     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19526     .
 19527 8100-EXIT.
 19528     EXIT.
 19529
 19530 8110-READ-ERMAIL.
 19531
 19532* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 362
* EL050.cbl
 19533*         NOTFND     (8110-NOTFND)
 19534*         ENDFILE    (8110-NOTFND)
 19535*    END-EXEC.
 19536*    MOVE '"$I''                  ! - #00018896' TO DFHEIV0
 19537     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19539     MOVE X'2D20233030303138383936' TO DFHEIV0(25:11)
 19540     CALL 'kxdfhei1' USING DFHEIV0
 19541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19542
 19543
 19544     MOVE SPACES                 TO ERMAIL-FOUND.
 19545     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19546     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19547     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19548     MOVE PB-SV-STATE            TO MA-STATE.
 19549
 19550
 19551* EXEC CICS READ
 19552*         UPDATE
 19553*         DATASET   (FILE-ERMAIL)
 19554*         RIDFLD    (MA-CONTROL-PRIMARY)
 19555*         INTO      (MAILING-DATA)
 19556*    END-EXEC.
 19557     MOVE LENGTH OF
 19558      MAILING-DATA
 19559       TO DFHEIV11
 19560*    MOVE '&"IL       EU         (   #00018907' TO DFHEIV0
 19561     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19562     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19563     MOVE X'2020233030303138393037' TO DFHEIV0(25:11)
 19564     CALL 'kxdfhei1' USING DFHEIV0,
 19565           FILE-ERMAIL,
 19566           MAILING-DATA,
 19567           DFHEIV11,
 19568           MA-CONTROL-PRIMARY,
 19569           DFHEIV99,
 19570           DFHEIV99,
 19571           DFHEIV99
 19572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19573
 19574
 19575     GO TO 8110-EXIT.
 19576
 19577 8110-NOTFND.
 19578     MOVE 'X'                    TO ERMAIL-FOUND.
 19579
 19580 8110-EXIT.
 19581     EXIT.
 19582
 19583 8120-REWRITE-ERMAIL.
 19584
 19585* EXEC CICS REWRITE
 19586*         DATASET    (FILE-ERMAIL)
 19587*         FROM       (MAILING-DATA)
 19588*    END-EXEC.
 19589     MOVE LENGTH OF
 19590      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 363
* EL050.cbl
 19591       TO DFHEIV11
 19592*    MOVE '&& L                  %   #00018923' TO DFHEIV0
 19593     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19594     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19595     MOVE X'2020233030303138393233' TO DFHEIV0(25:11)
 19596     CALL 'kxdfhei1' USING DFHEIV0,
 19597           FILE-ERMAIL,
 19598           MAILING-DATA,
 19599           DFHEIV11,
 19600           DFHEIV99
 19601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19602
 19603
 19604 8120-EXIT.
 19605     EXIT.
 19606
 19607 8130-WRITE-ERMAIL.
 19608
 19609* EXEC CICS HANDLE CONDITION
 19610*         DUPKEY   (8130-EXIT)
 19611*    END-EXEC.
 19612*    MOVE '"$$                   ! . #00018932' TO DFHEIV0
 19613     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19614     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19615     MOVE X'2E20233030303138393332' TO DFHEIV0(25:11)
 19616     CALL 'kxdfhei1' USING DFHEIV0
 19617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19618
 19619
 19620
 19621* EXEC CICS WRITE
 19622*         DATASET     (FILE-ERMAIL)
 19623*         RIDFLD      (MA-CONTROL-PRIMARY)
 19624*         FROM        (MAILING-DATA)
 19625*    END-EXEC.
 19626     MOVE LENGTH OF
 19627      MAILING-DATA
 19628       TO DFHEIV11
 19629*    MOVE '&$ L                  ''   #00018936' TO DFHEIV0
 19630     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19631     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19632     MOVE X'2020233030303138393336' TO DFHEIV0(25:11)
 19633     CALL 'kxdfhei1' USING DFHEIV0,
 19634           FILE-ERMAIL,
 19635           MAILING-DATA,
 19636           DFHEIV11,
 19637           MA-CONTROL-PRIMARY,
 19638           DFHEIV99,
 19639           DFHEIV99
 19640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19641
 19642
 19643 8130-EXIT.
 19644     EXIT.
 19645
 19646 8140-UNLOCK-ERMAIL.
 19647
 19648* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 364
* EL050.cbl
 19649*         DATASET   (FILE-ERMAIL)
 19650*    END-EXEC.
 19651*    MOVE '&*                    #   #00018946' TO DFHEIV0
 19652     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19653     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19654     MOVE X'2020233030303138393436' TO DFHEIV0(25:11)
 19655     CALL 'kxdfhei1' USING DFHEIV0,
 19656           FILE-ERMAIL,
 19657           DFHEIV99
 19658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19659
 19660
 19661 8140-EXIT.
 19662     EXIT.
 19663
 19664 8150-read-elcrtt.
 19665
 19666
 19667* EXEC CICS HANDLE CONDITION
 19668*        NOTFND   (8150-exit)
 19669*    END-EXEC
 19670*    MOVE '"$I                   ! / #00018955' TO DFHEIV0
 19671     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19673     MOVE X'2F20233030303138393535' TO DFHEIV0(25:11)
 19674     CALL 'kxdfhei1' USING DFHEIV0
 19675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19676
 19677     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19678     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19679
 19680
 19681* EXEC CICS READ
 19682*        DATASET  (CRTT-ID)
 19683*        RIDFLD   (WS-ELCRTT-KEY)
 19684*        INTO     (CERTIFICATE-TRAILERS)
 19685*    END-EXEC
 19686     MOVE LENGTH OF
 19687      CERTIFICATE-TRAILERS
 19688       TO DFHEIV11
 19689*    MOVE '&"IL       E          (   #00018962' TO DFHEIV0
 19690     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19691     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19692     MOVE X'2020233030303138393632' TO DFHEIV0(25:11)
 19693     CALL 'kxdfhei1' USING DFHEIV0,
 19694           CRTT-ID,
 19695           CERTIFICATE-TRAILERS,
 19696           DFHEIV11,
 19697           WS-ELCRTT-KEY,
 19698           DFHEIV99,
 19699           DFHEIV99,
 19700           DFHEIV99
 19701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19702
 19703     move cs-ins-age-default-flag to ws-ins-age-defaulted
 19704     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 19705
 19706     .
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 365
* EL050.cbl
 19707 8150-exit.
 19708     exit.
 19709 8180-UPDATE-VIN-NUMBER.
 19710
 19711* EXEC CICS HANDLE CONDITION
 19712*        NOTFND   (8180-NOTFND)
 19713*    END-EXEC.
 19714*    MOVE '"$I                   ! 0 #00018975' TO DFHEIV0
 19715     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19716     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19717     MOVE X'3020233030303138393735' TO DFHEIV0(25:11)
 19718     CALL 'kxdfhei1' USING DFHEIV0
 19719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19720
 19721
 19722     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19723     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19724
 19725
 19726* EXEC CICS READ
 19727*        UPDATE
 19728*        DATASET  (CRTT-ID)
 19729*        RIDFLD   (WS-ELCRTT-KEY)
 19730*        INTO     (CERTIFICATE-TRAILERS)
 19731*    END-EXEC.
 19732     MOVE LENGTH OF
 19733      CERTIFICATE-TRAILERS
 19734       TO DFHEIV11
 19735*    MOVE '&"IL       EU         (   #00018982' TO DFHEIV0
 19736     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19737     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19738     MOVE X'2020233030303138393832' TO DFHEIV0(25:11)
 19739     CALL 'kxdfhei1' USING DFHEIV0,
 19740           CRTT-ID,
 19741           CERTIFICATE-TRAILERS,
 19742           DFHEIV11,
 19743           WS-ELCRTT-KEY,
 19744           DFHEIV99,
 19745           DFHEIV99,
 19746           DFHEIV99
 19747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19748
 19749
 19750     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19751         MOVE PB-I-VIN TO CS-VIN-NUMBER
 19752
 19753* EXEC CICS REWRITE
 19754*           DATASET  (CRTT-ID)
 19755*           FROM     (CERTIFICATE-TRAILERS)
 19756*        END-EXEC
 19757     MOVE LENGTH OF
 19758      CERTIFICATE-TRAILERS
 19759       TO DFHEIV11
 19760*    MOVE '&& L                  %   #00018991' TO DFHEIV0
 19761     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19762     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19763     MOVE X'2020233030303138393931' TO DFHEIV0(25:11)
 19764     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 366
* EL050.cbl
 19765           CRTT-ID,
 19766           CERTIFICATE-TRAILERS,
 19767           DFHEIV11,
 19768           DFHEIV99
 19769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19770     ELSE
 19771
 19772* EXEC CICS UNLOCK
 19773*          DATASET  (CRTT-ID)
 19774*       END-EXEC
 19775*    MOVE '&*                    #   #00018996' TO DFHEIV0
 19776     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19777     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19778     MOVE X'2020233030303138393936' TO DFHEIV0(25:11)
 19779     CALL 'kxdfhei1' USING DFHEIV0,
 19780           CRTT-ID,
 19781           DFHEIV99
 19782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19783     END-IF.
 19784
 19785     GO TO 8180-EXIT.
 19786
 19787 8180-NOTFND.
 19788
 19789     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19790     MOVE 'CS'         TO CS-RECORD-ID.
 19791     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19792     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19793     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19794     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19795
 19796* EXEC CICS WRITE
 19797*       DATASET  (CRTT-ID)
 19798*       RIDFLD   (WS-ELCRTT-KEY)
 19799*       FROM     (CERTIFICATE-TRAILERS)
 19800*    END-EXEC.
 19801     MOVE LENGTH OF
 19802      CERTIFICATE-TRAILERS
 19803       TO DFHEIV11
 19804*    MOVE '&$ L                  ''   #00019011' TO DFHEIV0
 19805     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19806     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19807     MOVE X'2020233030303139303131' TO DFHEIV0(25:11)
 19808     CALL 'kxdfhei1' USING DFHEIV0,
 19809           CRTT-ID,
 19810           CERTIFICATE-TRAILERS,
 19811           DFHEIV11,
 19812           WS-ELCRTT-KEY,
 19813           DFHEIV99,
 19814           DFHEIV99
 19815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19816
 19817
 19818 8180-EXIT.
 19819     EXIT.
 19820
 19821 8190-UPDATE-REFUND-CLAIM-FLAG.
 19822
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 367
* EL050.cbl
 19823* EXEC CICS HANDLE CONDITION
 19824*        NOTFND   (8190-NOTFND)
 19825*    END-EXEC.
 19826*    MOVE '"$I                   ! 1 #00019021' TO DFHEIV0
 19827     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19828     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19829     MOVE X'3120233030303139303231' TO DFHEIV0(25:11)
 19830     CALL 'kxdfhei1' USING DFHEIV0
 19831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19832
 19833
 19834     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19835     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19836
 19837
 19838* EXEC CICS READ
 19839*        UPDATE
 19840*        DATASET  (CRTT-ID)
 19841*        RIDFLD   (WS-ELCRTT-KEY)
 19842*        INTO     (CERTIFICATE-TRAILERS)
 19843*    END-EXEC.
 19844     MOVE LENGTH OF
 19845      CERTIFICATE-TRAILERS
 19846       TO DFHEIV11
 19847*    MOVE '&"IL       EU         (   #00019028' TO DFHEIV0
 19848     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19849     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19850     MOVE X'2020233030303139303238' TO DFHEIV0(25:11)
 19851     CALL 'kxdfhei1' USING DFHEIV0,
 19852           CRTT-ID,
 19853           CERTIFICATE-TRAILERS,
 19854           DFHEIV11,
 19855           WS-ELCRTT-KEY,
 19856           DFHEIV99,
 19857           DFHEIV99,
 19858           DFHEIV99
 19859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19860
 19861
 19862     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19863
 19864* EXEC CICS REWRITE
 19865*       DATASET  (CRTT-ID)
 19866*       FROM     (CERTIFICATE-TRAILERS)
 19867*    END-EXEC.
 19868     MOVE LENGTH OF
 19869      CERTIFICATE-TRAILERS
 19870       TO DFHEIV11
 19871*    MOVE '&& L                  %   #00019036' TO DFHEIV0
 19872     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19873     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19874     MOVE X'2020233030303139303336' TO DFHEIV0(25:11)
 19875     CALL 'kxdfhei1' USING DFHEIV0,
 19876           CRTT-ID,
 19877           CERTIFICATE-TRAILERS,
 19878           DFHEIV11,
 19879           DFHEIV99
 19880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 368
* EL050.cbl
 19881
 19882
 19883     GO TO 8190-EXIT.
 19884
 19885 8190-NOTFND.
 19886
 19887     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19888     MOVE 'CS'         TO CS-RECORD-ID.
 19889     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19890     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19891     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19892     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19893
 19894* EXEC CICS WRITE
 19895*       DATASET  (CRTT-ID)
 19896*       RIDFLD   (WS-ELCRTT-KEY)
 19897*       FROM     (CERTIFICATE-TRAILERS)
 19898*    END-EXEC.
 19899     MOVE LENGTH OF
 19900      CERTIFICATE-TRAILERS
 19901       TO DFHEIV11
 19902*    MOVE '&$ L                  ''   #00019051' TO DFHEIV0
 19903     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19904     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19905     MOVE X'2020233030303139303531' TO DFHEIV0(25:11)
 19906     CALL 'kxdfhei1' USING DFHEIV0,
 19907           CRTT-ID,
 19908           CERTIFICATE-TRAILERS,
 19909           DFHEIV11,
 19910           WS-ELCRTT-KEY,
 19911           DFHEIV99,
 19912           DFHEIV99
 19913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19914
 19915
 19916 8190-EXIT.
 19917     EXIT.
 19918
 19919 8195-UPDATE-AGE-FLAGS.
 19920
 19921* EXEC CICS HANDLE CONDITION
 19922*        NOTFND   (8195-NOTFND)
 19923*    END-EXEC.
 19924*    MOVE '"$I                   ! 2 #00019061' TO DFHEIV0
 19925     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19926     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19927     MOVE X'3220233030303139303631' TO DFHEIV0(25:11)
 19928     CALL 'kxdfhei1' USING DFHEIV0
 19929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19930
 19931
 19932     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19933     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19934
 19935
 19936* EXEC CICS READ
 19937*        UPDATE
 19938*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 369
* EL050.cbl
 19939*        RIDFLD   (WS-ELCRTT-KEY)
 19940*        INTO     (CERTIFICATE-TRAILERS)
 19941*    END-EXEC.
 19942     MOVE LENGTH OF
 19943      CERTIFICATE-TRAILERS
 19944       TO DFHEIV11
 19945*    MOVE '&"IL       EU         (   #00019068' TO DFHEIV0
 19946     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19947     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19948     MOVE X'2020233030303139303638' TO DFHEIV0(25:11)
 19949     CALL 'kxdfhei1' USING DFHEIV0,
 19950           CRTT-ID,
 19951           CERTIFICATE-TRAILERS,
 19952           DFHEIV11,
 19953           WS-ELCRTT-KEY,
 19954           DFHEIV99,
 19955           DFHEIV99,
 19956           DFHEIV99
 19957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19958
 19959
 19960     IF WS-INS-AGE-SET = 'Y'
 19961        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19962     END-IF
 19963     IF WS-JNT-AGE-SET = 'Y'
 19964        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19965     END-IF
 19966
 19967
 19968* EXEC CICS REWRITE
 19969*       DATASET  (CRTT-ID)
 19970*       FROM     (CERTIFICATE-TRAILERS)
 19971*    END-EXEC.
 19972     MOVE LENGTH OF
 19973      CERTIFICATE-TRAILERS
 19974       TO DFHEIV11
 19975*    MOVE '&& L                  %   #00019082' TO DFHEIV0
 19976     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19977     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19978     MOVE X'2020233030303139303832' TO DFHEIV0(25:11)
 19979     CALL 'kxdfhei1' USING DFHEIV0,
 19980           CRTT-ID,
 19981           CERTIFICATE-TRAILERS,
 19982           DFHEIV11,
 19983           DFHEIV99
 19984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19985
 19986
 19987     GO TO 8195-EXIT.
 19988
 19989 8195-NOTFND.
 19990
 19991     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19992     MOVE 'CS'         TO CS-RECORD-ID.
 19993     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19994     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19995     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19996     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 370
* EL050.cbl
 19997     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19998
 19999* EXEC CICS WRITE
 20000*       DATASET  (CRTT-ID)
 20001*       RIDFLD   (WS-ELCRTT-KEY)
 20002*       FROM     (CERTIFICATE-TRAILERS)
 20003*    END-EXEC.
 20004     MOVE LENGTH OF
 20005      CERTIFICATE-TRAILERS
 20006       TO DFHEIV11
 20007*    MOVE '&$ L                  ''   #00019098' TO DFHEIV0
 20008     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20009     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20010     MOVE X'2020233030303139303938' TO DFHEIV0(25:11)
 20011     CALL 'kxdfhei1' USING DFHEIV0,
 20012           CRTT-ID,
 20013           CERTIFICATE-TRAILERS,
 20014           DFHEIV11,
 20015           WS-ELCRTT-KEY,
 20016           DFHEIV99,
 20017           DFHEIV99
 20018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20019
 20020
 20021 8195-EXIT.
 20022     EXIT.
 20023
 20024 8200-READ-REIN-TABLE.
 20025
 20026* EXEC CICS HANDLE CONDITION
 20027*         NOTFND   (8200-NOTFND)
 20028*    END-EXEC.
 20029*    MOVE '"$I                   ! 3 #00019108' TO DFHEIV0
 20030     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20031     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20032     MOVE X'3320233030303139313038' TO DFHEIV0(25:11)
 20033     CALL 'kxdfhei1' USING DFHEIV0
 20034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20035
 20036
 20037
 20038* EXEC CICS READ
 20039*        DATASET     (REIN-ID)
 20040*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20041*        RIDFLD      (ERREIN-KEY)
 20042*    END-EXEC.
 20043*    MOVE '&"S        E          (   #00019112' TO DFHEIV0
 20044     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20046     MOVE X'2020233030303139313132' TO DFHEIV0(25:11)
 20047     CALL 'kxdfhei1' USING DFHEIV0,
 20048           REIN-ID,
 20049           DFHEIV20,
 20050           DFHEIV99,
 20051           ERREIN-KEY,
 20052           DFHEIV99,
 20053           DFHEIV99,
 20054           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 371
* EL050.cbl
 20055     SET ADDRESS OF REINSURANCE-RECORD TO
 20056         DFHEIV20
 20057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20058
 20059
 20060     GO TO 8200-EXIT.
 20061
 20062 8200-NOTFND.
 20063     MOVE 'N'             TO WS-REIN-READ-SW.
 20064
 20065 8200-EXIT.
 20066      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 372
* EL050.cbl
 20068
 20069 8300-READ-CTBL-TABLE.
 20070
 20071* EXEC CICS HANDLE CONDITION
 20072*        NOTFND    (8300-NOTFND)
 20073*        DISABLED  (8300-ERRESS-PROBLEM)
 20074*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20075*        ENDFILE   (8300-NOTFND)
 20076*    END-EXEC.
 20077*    MOVE '"$IcJ''                ! 4 #00019128' TO DFHEIV0
 20078     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20079     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20080     MOVE X'3420233030303139313238' TO DFHEIV0(25:11)
 20081     CALL 'kxdfhei1' USING DFHEIV0
 20082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20083
 20084
 20085
 20086* EXEC CICS READ
 20087*        DATASET     (CTBL-ID)
 20088*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20089*        RIDFLD      (ERCTBL-KEY)
 20090*    END-EXEC.
 20091*    MOVE '&"S        E          (   #00019135' TO DFHEIV0
 20092     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20093     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20094     MOVE X'2020233030303139313335' TO DFHEIV0(25:11)
 20095     CALL 'kxdfhei1' USING DFHEIV0,
 20096           CTBL-ID,
 20097           DFHEIV20,
 20098           DFHEIV99,
 20099           ERCTBL-KEY,
 20100           DFHEIV99,
 20101           DFHEIV99,
 20102           DFHEIV99
 20103     SET ADDRESS OF COMM-TABLE-RECORD TO
 20104         DFHEIV20
 20105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20106
 20107
 20108     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20109
 20110     GO TO 8300-EXIT.
 20111
 20112 8300-NOTFND.
 20113
 20114     IF CTBL-SW = '0530'
 20115         MOVE 'AA'                     TO WS-AH-COMP-CD
 20116         MOVE '0550'                   TO CTBL-SW
 20117         MOVE '1'                      TO WS-CTBL-READ-SW
 20118         GO TO 8300-EXIT.
 20119
 20120     IF CTBL-SW = '0540'
 20121         MOVE 'AA'                     TO WS-LF-COMP-CD
 20122         MOVE '0550'                   TO CTBL-SW
 20123         MOVE '1'                      TO WS-CTBL-READ-SW
 20124         GO TO 8300-EXIT.
 20125
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 373
* EL050.cbl
 20126     IF CTBL-SW = '0550'
 20127         MOVE '2'                      TO WS-CTBL-READ-SW
 20128         GO TO 8300-EXIT.
 20129
 20130     GO TO 8300-EXIT.
 20131
 20132 8300-ERRESS-PROBLEM.
 20133
 20134      MOVE ER-8050              TO WS-ERROR.
 20135      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20136
 20137     GO TO 8300-EXIT.
 20138
 20139 8300-EXIT.
 20140      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 374
* EL050.cbl
 20142
 20143
 20144 8400-GETMAIN-ERFORM.
 20145
 20146
 20147* EXEC CICS   GETMAIN
 20148*        LENGTH  (500)
 20149*        SET     (ADDRESS OF FORM-MASTER)
 20150*    END-EXEC.
 20151     MOVE 500
 20152       TO DFHEIV11
 20153*    MOVE '," L                  $   #00019179' TO DFHEIV0
 20154     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20155     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20156     MOVE X'2020233030303139313739' TO DFHEIV0(25:11)
 20157     CALL 'kxdfhei1' USING DFHEIV0,
 20158           DFHEIV20,
 20159           DFHEIV11,
 20160           DFHEIV99
 20161     SET ADDRESS OF FORM-MASTER TO
 20162         DFHEIV20
 20163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20164
 20165
 20166     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20167
 20168 8400-EXIT.
 20169      EXIT.
 20170
 20171 8450-READ-FORM-MASTER.
 20172
 20173
 20174* EXEC CICS  HANDLE CONDITION
 20175*        NOTFND   (8450-FORM-NOT-FOUND)
 20176*        ENDFILE  (8450-FORM-NOT-FOUND)
 20177*    END-EXEC.
 20178*    MOVE '"$I''                  ! 5 #00019191' TO DFHEIV0
 20179     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20180     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20181     MOVE X'3520233030303139313931' TO DFHEIV0(25:11)
 20182     CALL 'kxdfhei1' USING DFHEIV0
 20183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20184
 20185
 20186
 20187* EXEC CICS   READ
 20188*        DATASET   (FORM-ID)
 20189*        RIDFLD    (ERFORM-KEY)
 20190*        INTO      (FORM-MASTER)
 20191*        GTEQ
 20192*    END-EXEC.
 20193     MOVE LENGTH OF
 20194      FORM-MASTER
 20195       TO DFHEIV11
 20196*    MOVE '&"IL       G          (   #00019196' TO DFHEIV0
 20197     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20198     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20199     MOVE X'2020233030303139313936' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 375
* EL050.cbl
 20200     CALL 'kxdfhei1' USING DFHEIV0,
 20201           FORM-ID,
 20202           FORM-MASTER,
 20203           DFHEIV11,
 20204           ERFORM-KEY,
 20205           DFHEIV99,
 20206           DFHEIV99,
 20207           DFHEIV99
 20208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20209
 20210
 20211     MOVE  'Y'           TO  FORM-MASTER-SW.
 20212
 20213     GO TO  8450-EXIT.
 20214
 20215 8450-FORM-NOT-FOUND.
 20216
 20217     MOVE  'N'           TO  FORM-MASTER-SW.
 20218
 20219 8450-EXIT.
 20220      EXIT.
 20221
 20222 8500-DATE-CONVERT.
 20223
 20224* EXEC CICS LINK
 20225*        PROGRAM    ('ELDATCV')
 20226*        COMMAREA   (DATE-CONVERSION-DATA)
 20227*        LENGTH     (DC-COMM-LENGTH)
 20228*    END-EXEC.
 20229     MOVE 'ELDATCV' TO DFHEIV1
 20230*    MOVE '."C                   (   #00019215' TO DFHEIV0
 20231     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20232     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20233     MOVE X'2020233030303139323135' TO DFHEIV0(25:11)
 20234     CALL 'kxdfhei1' USING DFHEIV0,
 20235           DFHEIV1,
 20236           DATE-CONVERSION-DATA,
 20237           DC-COMM-LENGTH,
 20238           DFHEIV99,
 20239           DFHEIV99,
 20240           DFHEIV99,
 20241           DFHEIV99
 20242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20243
 20244
 20245 8500-EXIT.
 20246     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 376
* EL050.cbl
 20248
 20249 8555-RELOAD-CONTROL-FILE.
 20250     CONTINUE.
 20251
 20252 8555-EXIT.
 20253     EXIT.
 20254
 20255 8557-GETMAIN-ERPLAN.
 20256
 20257
 20258* EXEC CICS GETMAIN
 20259*        LENGTH    (840)
 20260*        SET       (ADDRESS OF PLAN-RECORDS)
 20261*    END-EXEC.
 20262     MOVE 840
 20263       TO DFHEIV11
 20264*    MOVE '," L                  $   #00019233' TO DFHEIV0
 20265     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20266     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20267     MOVE X'2020233030303139323333' TO DFHEIV0(25:11)
 20268     CALL 'kxdfhei1' USING DFHEIV0,
 20269           DFHEIV20,
 20270           DFHEIV11,
 20271           DFHEIV99
 20272     SET ADDRESS OF PLAN-RECORDS TO
 20273         DFHEIV20
 20274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20275
 20276
 20277     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20278
 20279 8557-EXIT.
 20280     EXIT.
 20281
 20282 8560-GETMAIN.
 20283
 20284* EXEC CICS GETMAIN
 20285*        LENGTH    (2000)
 20286*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20287*    END-EXEC.
 20288     MOVE 2000
 20289       TO DFHEIV11
 20290*    MOVE '," L                  $   #00019244' TO DFHEIV0
 20291     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20292     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20293     MOVE X'2020233030303139323434' TO DFHEIV0(25:11)
 20294     CALL 'kxdfhei1' USING DFHEIV0,
 20295           DFHEIV20,
 20296           DFHEIV11,
 20297           DFHEIV99
 20298     SET ADDRESS OF ACCOUNT-MASTER TO
 20299         DFHEIV20
 20300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20301
 20302
 20303     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20304
 20305 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 377
* EL050.cbl
 20306     EXIT.
 20307
 20308 8570-START-ACCOUNT-MASTER.
 20309
 20310* EXEC CICS HANDLE CONDITION
 20311*        NOTFND    (0199-ACCT-NOT-FOUND)
 20312*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20313*    END-EXEC.
 20314*    MOVE '"$I''                  ! 6 #00019255' TO DFHEIV0
 20315     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20316     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20317     MOVE X'3620233030303139323535' TO DFHEIV0(25:11)
 20318     CALL 'kxdfhei1' USING DFHEIV0
 20319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20320
 20321
 20322
 20323* EXEC CICS STARTBR
 20324*        DATASET    (ACCT-ID)
 20325*        RIDFLD     (ERACCT-KEY)
 20326*        GTEQ
 20327*    END-EXEC.
 20328     MOVE 0
 20329       TO DFHEIV11
 20330*    MOVE '&,         G          &   #00019260' TO DFHEIV0
 20331     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20332     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20333     MOVE X'2020233030303139323630' TO DFHEIV0(25:11)
 20334     CALL 'kxdfhei1' USING DFHEIV0,
 20335           ACCT-ID,
 20336           ERACCT-KEY,
 20337           DFHEIV99,
 20338           DFHEIV11,
 20339           DFHEIV99
 20340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20341
 20342
 20343 8570-EXIT.
 20344     EXIT.
 20345
 20346 8580-READ-ACCOUNT-MASTER.
 20347
 20348* EXEC CICS HANDLE CONDITION
 20349*        NOTFND    (0199-ACCT-NOT-FOUND)
 20350*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20351*    END-EXEC.
 20352*    MOVE '"$I''                  ! 7 #00019270' TO DFHEIV0
 20353     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20355     MOVE X'3720233030303139323730' TO DFHEIV0(25:11)
 20356     CALL 'kxdfhei1' USING DFHEIV0
 20357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20358
 20359
 20360
 20361* EXEC CICS READNEXT
 20362*        DATASET     (ACCT-ID)
 20363*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 378
* EL050.cbl
 20364*        RIDFLD      (ERACCT-KEY)
 20365*    END-EXEC.
 20366     MOVE LENGTH OF
 20367      ACCOUNT-MASTER
 20368       TO DFHEIV12
 20369     MOVE 0
 20370       TO DFHEIV11
 20371*    MOVE '&.IL                  )   #00019275' TO DFHEIV0
 20372     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20373     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20374     MOVE X'2020233030303139323735' TO DFHEIV0(25:11)
 20375     CALL 'kxdfhei1' USING DFHEIV0,
 20376           ACCT-ID,
 20377           ACCOUNT-MASTER,
 20378           DFHEIV12,
 20379           ERACCT-KEY,
 20380           DFHEIV99,
 20381           DFHEIV11,
 20382           DFHEIV99,
 20383           DFHEIV99
 20384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20385
 20386
 20387 8580-EXIT.
 20388     EXIT.
 20389
 20390 8582-READ-COMPENSATION-MASTER.
 20391
 20392* EXEC CICS HANDLE CONDITION
 20393*        NOTFND    (8582-COMP-NOT-FOUND)
 20394*        ENDFILE   (8582-COMP-NOT-FOUND)
 20395*    END-EXEC.
 20396*    MOVE '"$I''                  ! 8 #00019285' TO DFHEIV0
 20397     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20398     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20399     MOVE X'3820233030303139323835' TO DFHEIV0(25:11)
 20400     CALL 'kxdfhei1' USING DFHEIV0
 20401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20402
 20403
 20404
 20405* EXEC CICS READ
 20406*        DATASET     (COMP-ID)
 20407*        INTO        (COMPENSATION-MASTER)
 20408*        RIDFLD      (ERCOMP-KEY)
 20409*    END-EXEC.
 20410     MOVE LENGTH OF
 20411      COMPENSATION-MASTER
 20412       TO DFHEIV11
 20413*    MOVE '&"IL       E          (   #00019290' TO DFHEIV0
 20414     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20415     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20416     MOVE X'2020233030303139323930' TO DFHEIV0(25:11)
 20417     CALL 'kxdfhei1' USING DFHEIV0,
 20418           COMP-ID,
 20419           COMPENSATION-MASTER,
 20420           DFHEIV11,
 20421           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 379
* EL050.cbl
 20422           DFHEIV99,
 20423           DFHEIV99,
 20424           DFHEIV99
 20425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20426
 20427
 20428     MOVE 'Y'                    TO COMP-MASTER-SW
 20429
 20430     GO TO 8582-EXIT
 20431     .
 20432 8582-COMP-NOT-FOUND.
 20433
 20434     MOVE 'N'                    TO COMP-MASTER-SW.
 20435
 20436 8582-EXIT.
 20437     EXIT.
 20438
 20439 8583-READ-ERAGTC.
 20440
 20441* EXEC CICS HANDLE CONDITION
 20442*        NOTFND    (8583-AGTC-NOT-FOUND)
 20443*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20444*    END-EXEC.
 20445*    MOVE '"$I''                  ! 9 #00019308' TO DFHEIV0
 20446     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20447     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20448     MOVE X'3920233030303139333038' TO DFHEIV0(25:11)
 20449     CALL 'kxdfhei1' USING DFHEIV0
 20450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20451
 20452
 20453
 20454* EXEC CICS STARTBR
 20455*        DATASET    (AGTC-ID)
 20456*        RIDFLD     (ERAGTC-KEY)
 20457*        GTEQ
 20458*    END-EXEC.
 20459     MOVE 0
 20460       TO DFHEIV11
 20461*    MOVE '&,         G          &   #00019313' TO DFHEIV0
 20462     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20463     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20464     MOVE X'2020233030303139333133' TO DFHEIV0(25:11)
 20465     CALL 'kxdfhei1' USING DFHEIV0,
 20466           AGTC-ID,
 20467           ERAGTC-KEY,
 20468           DFHEIV99,
 20469           DFHEIV11,
 20470           DFHEIV99
 20471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20472
 20473
 20474 8583-READ-ERAGTC-NEXT.
 20475
 20476* EXEC CICS READNEXT
 20477*        DATASET     (AGTC-ID)
 20478*        INTO        (AGENT-COMMISSIONS)
 20479*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 380
* EL050.cbl
 20480*    END-EXEC.
 20481     MOVE LENGTH OF
 20482      AGENT-COMMISSIONS
 20483       TO DFHEIV12
 20484     MOVE 0
 20485       TO DFHEIV11
 20486*    MOVE '&.IL                  )   #00019320' TO DFHEIV0
 20487     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20488     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20489     MOVE X'2020233030303139333230' TO DFHEIV0(25:11)
 20490     CALL 'kxdfhei1' USING DFHEIV0,
 20491           AGTC-ID,
 20492           AGENT-COMMISSIONS,
 20493           DFHEIV12,
 20494           ERAGTC-KEY,
 20495           DFHEIV99,
 20496           DFHEIV11,
 20497           DFHEIV99,
 20498           DFHEIV99
 20499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20500
 20501
 20502*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20503
 20504     GO TO 8583-EXIT
 20505     .
 20506 8583-AGTC-NOT-FOUND.
 20507
 20508     MOVE 'N'                    TO AGTC-MASTER-SW.
 20509
 20510 8583-EXIT.
 20511     EXIT.
 20512
 20513 8584-READ-BANK-CROSS-REF.
 20514
 20515* EXEC CICS HANDLE CONDITION
 20516*        NOTFND    (8584-BXRF-NOT-FOUND)
 20517*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20518*    END-EXEC.
 20519*    MOVE '"$I''                  ! : #00019338' TO DFHEIV0
 20520     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20522     MOVE X'3A20233030303139333338' TO DFHEIV0(25:11)
 20523     CALL 'kxdfhei1' USING DFHEIV0
 20524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20525
 20526
 20527
 20528* EXEC CICS READ
 20529*        DATASET     (BXRF-ID)
 20530*        INTO        (BANK-CROSS-REFERENCE)
 20531*        RIDFLD      (ERBXRF-KEY)
 20532*        LENGTH      (BXRF-REC-LENGTH)
 20533*    END-EXEC.
 20534*    MOVE '&"IL       E          (   #00019343' TO DFHEIV0
 20535     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20537     MOVE X'2020233030303139333433' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 381
* EL050.cbl
 20538     CALL 'kxdfhei1' USING DFHEIV0,
 20539           BXRF-ID,
 20540           BANK-CROSS-REFERENCE,
 20541           BXRF-REC-LENGTH,
 20542           ERBXRF-KEY,
 20543           DFHEIV99,
 20544           DFHEIV99,
 20545           DFHEIV99
 20546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20547
 20548
 20549     MOVE 'Y'                    TO BXRF-MASTER-SW
 20550
 20551     GO TO 8584-EXIT
 20552     .
 20553 8584-BXRF-NOT-FOUND.
 20554
 20555     MOVE 'N'                    TO BXRF-MASTER-SW.
 20556
 20557 8584-EXIT.
 20558     EXIT.
 20559
 20560 8585-READ-PLAN-MASTER.
 20561
 20562
 20563* EXEC CICS HANDLE CONDITION
 20564*        NOTFND    (8585-PLAN-NOT-FOUND)
 20565*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20566*    END-EXEC.
 20567*    MOVE '"$I''                  ! ; #00019363' TO DFHEIV0
 20568     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20569     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20570     MOVE X'3B20233030303139333633' TO DFHEIV0(25:11)
 20571     CALL 'kxdfhei1' USING DFHEIV0
 20572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20573
 20574
 20575
 20576* EXEC CICS READ
 20577*        DATASET     (PLAN-ID)
 20578*        INTO        (PLAN-MASTER)
 20579*        RIDFLD      (ERPLAN-KEY)
 20580*    END-EXEC.
 20581     MOVE LENGTH OF
 20582      PLAN-MASTER
 20583       TO DFHEIV11
 20584*    MOVE '&"IL       E          (   #00019368' TO DFHEIV0
 20585     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20586     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20587     MOVE X'2020233030303139333638' TO DFHEIV0(25:11)
 20588     CALL 'kxdfhei1' USING DFHEIV0,
 20589           PLAN-ID,
 20590           PLAN-MASTER,
 20591           DFHEIV11,
 20592           ERPLAN-KEY,
 20593           DFHEIV99,
 20594           DFHEIV99,
 20595           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 382
* EL050.cbl
 20596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20597
 20598
 20599     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20600
 20601     GO TO 8585-EXIT.
 20602
 20603 8585-PLAN-NOT-FOUND.
 20604
 20605     MOVE 'N'                    TO PLAN-MASTER-SW.
 20606
 20607 8585-EXIT.
 20608     EXIT.
 20609
 20610 8586-READ-LOAN-OFFICER.
 20611
 20612* EXEC CICS READ
 20613*        DATASET     (LOFC-ID)
 20614*        INTO        (LOAN-OFFICER-MASTER)
 20615*        RIDFLD      (ERLOFC-KEY)
 20616*        RESP        (WS-RESPONSE)
 20617*    END-EXEC
 20618     MOVE LENGTH OF
 20619      LOAN-OFFICER-MASTER
 20620       TO DFHEIV11
 20621*    MOVE '&"IL       E          (  N#00019386' TO DFHEIV0
 20622     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20623     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20624     MOVE X'204E233030303139333836' TO DFHEIV0(25:11)
 20625     CALL 'kxdfhei1' USING DFHEIV0,
 20626           LOFC-ID,
 20627           LOAN-OFFICER-MASTER,
 20628           DFHEIV11,
 20629           ERLOFC-KEY,
 20630           DFHEIV99,
 20631           DFHEIV99,
 20632           DFHEIV99
 20633     MOVE EIBRESP  TO WS-RESPONSE
 20634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20635
 20636     IF WS-RESP-NORMAL
 20637        MOVE 'Y'                 TO LOFC-MASTER-SW
 20638     ELSE
 20639        MOVE 'N'                 TO LOFC-MASTER-SW
 20640     END-IF
 20641     .
 20642 8586-EXIT.
 20643     EXIT.
 20644 8587-START-ERPDEF.
 20645
 20646* EXEC CICS STARTBR
 20647*       DATASET   (PDEF-ID)
 20648*       RIDFLD    (ERPDEF-KEY)
 20649*       GTEQ
 20650*       RESP      (WS-RESPONSE)
 20651*    END-EXEC
 20652     MOVE 0
 20653       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 383
* EL050.cbl
 20654*    MOVE '&,         G          &  N#00019402' TO DFHEIV0
 20655     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20656     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20657     MOVE X'204E233030303139343032' TO DFHEIV0(25:11)
 20658     CALL 'kxdfhei1' USING DFHEIV0,
 20659           PDEF-ID,
 20660           ERPDEF-KEY,
 20661           DFHEIV99,
 20662           DFHEIV11,
 20663           DFHEIV99
 20664     MOVE EIBRESP  TO WS-RESPONSE
 20665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20666     IF WS-RESP-NORMAL
 20667        MOVE 'Y'                 TO PDEF-MASTER-SW
 20668     ELSE
 20669        MOVE 'N'                 TO PDEF-MASTER-SW
 20670     END-IF
 20671     .
 20672 8587-EXIT.
 20673     EXIT.
 20674 8588-READ-ERPDEF.
 20675
 20676* EXEC CICS READNEXT
 20677*       DATASET   (PDEF-ID)
 20678*       RIDFLD    (ERPDEF-KEY)
 20679*       INTO      (PRODUCT-MASTER)
 20680*       RESP      (WS-RESPONSE)
 20681*    END-EXEC
 20682     MOVE LENGTH OF
 20683      PRODUCT-MASTER
 20684       TO DFHEIV12
 20685     MOVE 0
 20686       TO DFHEIV11
 20687*    MOVE '&.IL                  )  N#00019417' TO DFHEIV0
 20688     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20689     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20690     MOVE X'204E233030303139343137' TO DFHEIV0(25:11)
 20691     CALL 'kxdfhei1' USING DFHEIV0,
 20692           PDEF-ID,
 20693           PRODUCT-MASTER,
 20694           DFHEIV12,
 20695           ERPDEF-KEY,
 20696           DFHEIV99,
 20697           DFHEIV11,
 20698           DFHEIV99,
 20699           DFHEIV99
 20700     MOVE EIBRESP  TO WS-RESPONSE
 20701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20702     IF WS-RESP-NORMAL
 20703        MOVE 'Y'                 TO PDEF-MASTER-SW
 20704     ELSE
 20705        MOVE 'N'                 TO PDEF-MASTER-SW
 20706     END-IF
 20707     .
 20708 8588-EXIT.
 20709     EXIT.
 20710 8589-ENDBR-ERPDEF.
 20711
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 384
* EL050.cbl
 20712* EXEC CICS ENDBR
 20713*       DATASET   (PDEF-ID)
 20714*    END-EXEC
 20715     MOVE 0
 20716       TO DFHEIV11
 20717*    MOVE '&2                    $   #00019432' TO DFHEIV0
 20718     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20719     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20720     MOVE X'2020233030303139343332' TO DFHEIV0(25:11)
 20721     CALL 'kxdfhei1' USING DFHEIV0,
 20722           PDEF-ID,
 20723           DFHEIV11,
 20724           DFHEIV99
 20725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20726     .
 20727 8589-EXIT.
 20728     EXIT.
 20729 8590-READ-CERT-MASTER.
 20730     IF PB-COMPANY-ID = 'UCL'
 20731         GO TO 8690-READ-CERT-MASTER-UCL.
 20732
 20733
 20734* EXEC CICS HANDLE CONDITION
 20735*         NOTFND    (0299-CERT-NOT-FOUND)
 20736*    END-EXEC.
 20737*    MOVE '"$I                   ! < #00019442' TO DFHEIV0
 20738     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20739     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20740     MOVE X'3C20233030303139343432' TO DFHEIV0(25:11)
 20741     CALL 'kxdfhei1' USING DFHEIV0
 20742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20743
 20744
 20745
 20746* EXEC CICS READ
 20747*        DATASET     (CERT-ID)
 20748*        INTO        (CERTIFICATE-MASTER)
 20749*        RIDFLD      (ELCERT-KEY)
 20750*        UPDATE
 20751*    END-EXEC.
 20752     MOVE LENGTH OF
 20753      CERTIFICATE-MASTER
 20754       TO DFHEIV11
 20755*    MOVE '&"IL       EU         (   #00019446' TO DFHEIV0
 20756     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20757     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20758     MOVE X'2020233030303139343436' TO DFHEIV0(25:11)
 20759     CALL 'kxdfhei1' USING DFHEIV0,
 20760           CERT-ID,
 20761           CERTIFICATE-MASTER,
 20762           DFHEIV11,
 20763           ELCERT-KEY,
 20764           DFHEIV99,
 20765           DFHEIV99,
 20766           DFHEIV99
 20767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20768
 20769
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 385
* EL050.cbl
 20770 8590-EXIT.
 20771     EXIT.
 20772
 20773 8690-READ-CERT-MASTER-UCL.
 20774
 20775* EXEC CICS HANDLE CONDITION
 20776*         NOTFND    (8700-READ-CERT-MASTER)
 20777*    END-EXEC.
 20778*    MOVE '"$I                   ! = #00019457' TO DFHEIV0
 20779     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20780     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20781     MOVE X'3D20233030303139343537' TO DFHEIV0(25:11)
 20782     CALL 'kxdfhei1' USING DFHEIV0
 20783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20784
 20785
 20786 8690-READ-CERT-CONT.
 20787
 20788* EXEC CICS READ
 20789*        DATASET     (CERT-ID)
 20790*        INTO        (CERTIFICATE-MASTER)
 20791*        RIDFLD      (ELCERT-KEY)
 20792*        UPDATE
 20793*    END-EXEC.
 20794     MOVE LENGTH OF
 20795      CERTIFICATE-MASTER
 20796       TO DFHEIV11
 20797*    MOVE '&"IL       EU         (   #00019462' TO DFHEIV0
 20798     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20799     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20800     MOVE X'2020233030303139343632' TO DFHEIV0(25:11)
 20801     CALL 'kxdfhei1' USING DFHEIV0,
 20802           CERT-ID,
 20803           CERTIFICATE-MASTER,
 20804           DFHEIV11,
 20805           ELCERT-KEY,
 20806           DFHEIV99,
 20807           DFHEIV99,
 20808           DFHEIV99
 20809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20810
 20811
 20812     GO TO 8590-EXIT.
 20813
 20814 8700-READ-CERT-MASTER.
 20815     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20816     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20817
 20818* EXEC CICS HANDLE CONDITION
 20819*         DUPKEY    (8720-COMP-ACCOUNTS)
 20820*         ENDFILE   (8730-END-BROWSE)
 20821*         NOTFND    (8740-NOT-FOUND)
 20822*    END-EXEC.
 20823*    MOVE '"$$''I                 ! > #00019474' TO DFHEIV0
 20824     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20825     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20826     MOVE X'3E20233030303139343734' TO DFHEIV0(25:11)
 20827     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 386
* EL050.cbl
 20828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20829
 20830
 20831
 20832* EXEC CICS STARTBR
 20833*        DATASET     ('ELCERT5')
 20834*        RIDFLD      (ELCERT2-KEY)
 20835*        EQUAL
 20836*    END-EXEC.
 20837     MOVE 'ELCERT5' TO DFHEIV1
 20838     MOVE 0
 20839       TO DFHEIV11
 20840*    MOVE '&,         E          &   #00019480' TO DFHEIV0
 20841     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20842     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20843     MOVE X'2020233030303139343830' TO DFHEIV0(25:11)
 20844     CALL 'kxdfhei1' USING DFHEIV0,
 20845           DFHEIV1,
 20846           ELCERT2-KEY,
 20847           DFHEIV99,
 20848           DFHEIV11,
 20849           DFHEIV99
 20850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20851
 20852
 20853 8710-READ-NEXT.
 20854
 20855* EXEC CICS READNEXT
 20856*        DATASET     ('ELCERT5')
 20857*        INTO        (CERTIFICATE-MASTER)
 20858*        RIDFLD      (ELCERT2-KEY)
 20859*    END-EXEC.
 20860     MOVE LENGTH OF
 20861      CERTIFICATE-MASTER
 20862       TO DFHEIV12
 20863     MOVE 'ELCERT5' TO DFHEIV1
 20864     MOVE 0
 20865       TO DFHEIV11
 20866*    MOVE '&.IL                  )   #00019487' TO DFHEIV0
 20867     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20868     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20869     MOVE X'2020233030303139343837' TO DFHEIV0(25:11)
 20870     CALL 'kxdfhei1' USING DFHEIV0,
 20871           DFHEIV1,
 20872           CERTIFICATE-MASTER,
 20873           DFHEIV12,
 20874           ELCERT2-KEY,
 20875           DFHEIV99,
 20876           DFHEIV11,
 20877           DFHEIV99,
 20878           DFHEIV99
 20879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20880
 20881
 20882 8720-COMP-ACCOUNTS.
 20883
 20884* EXEC CICS ENTER
 20885*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 387
* EL050.cbl
 20886*         FROM (PB-C-LAST-NAME)
 20887*    END-EXEC.
 20888     MOVE 001
 20889       TO DFHEIV11
 20890*    MOVE ':$F                   %   #00019494' TO DFHEIV0
 20891     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20892     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20893     MOVE X'2020233030303139343934' TO DFHEIV0(25:11)
 20894     CALL 'kxdfhei1' USING DFHEIV0,
 20895           DFHEIV11,
 20896           PB-C-LAST-NAME,
 20897           DFHEIV99,
 20898           DFHEIV99
 20899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20900
 20901
 20902
 20903* EXEC CICS ENTER
 20904*         TRACEID (002)
 20905*         FROM (CM-INSURED-LAST-NAME)
 20906*    END-EXEC.
 20907     MOVE 002
 20908       TO DFHEIV11
 20909*    MOVE ':$F                   %   #00019499' TO DFHEIV0
 20910     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20911     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20912     MOVE X'2020233030303139343939' TO DFHEIV0(25:11)
 20913     CALL 'kxdfhei1' USING DFHEIV0,
 20914           DFHEIV11,
 20915           CM-INSURED-LAST-NAME,
 20916           DFHEIV99,
 20917           DFHEIV99
 20918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20919
 20920
 20921     IF PB-CERT-NO NOT = CM-CERT-NO
 20922         GO TO 8730-END-BROWSE.
 20923
 20924     IF PB-ACCOUNT = CM-ACCOUNT
 20925         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20926             MOVE ER-2799        TO WS-ERROR
 20927             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20928             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20929             GO TO 8730-END-BROWSE.
 20930
 20931     GO TO 8710-READ-NEXT.
 20932
 20933 8730-END-BROWSE.
 20934
 20935* EXEC CICS ENDBR
 20936*         DATASET    ('ELCERT5')
 20937*    END-EXEC.
 20938     MOVE 'ELCERT5' TO DFHEIV1
 20939     MOVE 0
 20940       TO DFHEIV11
 20941*    MOVE '&2                    $   #00019517' TO DFHEIV0
 20942     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20943     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 388
* EL050.cbl
 20944     MOVE X'2020233030303139353137' TO DFHEIV0(25:11)
 20945     CALL 'kxdfhei1' USING DFHEIV0,
 20946           DFHEIV1,
 20947           DFHEIV11,
 20948           DFHEIV99
 20949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20950
 20951
 20952 8740-NOT-FOUND.
 20953     GO TO 0299-CERT-NOT-FOUND.
 20954
 20955 8750-START-ELSTAT.
 20956
 20957* EXEC CICS STARTBR
 20958*       DATASET   (STAT-ID)
 20959*       RIDFLD    (ELSTAT-KEY)
 20960*       GTEQ
 20961*       RESP      (WS-RESPONSE)
 20962*    END-EXEC
 20963     MOVE 0
 20964       TO DFHEIV11
 20965*    MOVE '&,         G          &  N#00019525' TO DFHEIV0
 20966     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20967     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20968     MOVE X'204E233030303139353235' TO DFHEIV0(25:11)
 20969     CALL 'kxdfhei1' USING DFHEIV0,
 20970           STAT-ID,
 20971           ELSTAT-KEY,
 20972           DFHEIV99,
 20973           DFHEIV11,
 20974           DFHEIV99
 20975     MOVE EIBRESP  TO WS-RESPONSE
 20976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20977     IF WS-RESP-NORMAL
 20978        MOVE 'Y'                 TO STAT-MASTER-SW
 20979     ELSE
 20980        MOVE 'N'                 TO STAT-MASTER-SW
 20981     END-IF
 20982     .
 20983 8750-EXIT.
 20984     EXIT.
 20985 8752-READ-ELSTAT.
 20986
 20987* EXEC CICS READNEXT
 20988*       DATASET   (STAT-ID)
 20989*       RIDFLD    (ELSTAT-KEY)
 20990*       INTO      (STATE-FILE)
 20991*       RESP      (WS-RESPONSE)
 20992*    END-EXEC
 20993     MOVE LENGTH OF
 20994      STATE-FILE
 20995       TO DFHEIV12
 20996     MOVE 0
 20997       TO DFHEIV11
 20998*    MOVE '&.IL                  )  N#00019540' TO DFHEIV0
 20999     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21000     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21001     MOVE X'204E233030303139353430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 389
* EL050.cbl
 21002     CALL 'kxdfhei1' USING DFHEIV0,
 21003           STAT-ID,
 21004           STATE-FILE,
 21005           DFHEIV12,
 21006           ELSTAT-KEY,
 21007           DFHEIV99,
 21008           DFHEIV11,
 21009           DFHEIV99,
 21010           DFHEIV99
 21011     MOVE EIBRESP  TO WS-RESPONSE
 21012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21013     IF WS-RESP-NORMAL
 21014        MOVE 'Y'                 TO STAT-MASTER-SW
 21015     ELSE
 21016        MOVE 'N'                 TO STAT-MASTER-SW
 21017     END-IF
 21018     .
 21019 8752-EXIT.
 21020     EXIT.
 21021 8800-GET-COMP-RATE.
 21022     MOVE +1 TO IB.
 21023     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21024         ADD +9 TO IB
 21025         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21026             ADD +9 TO IB
 21027             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21028                MOVE ZEROS       TO WS-WK-RATE
 21029                GO TO 8800-EXIT.
 21030
 21031     IF PB-I-AGE GREATER CT-AGE (1)
 21032         ADD +3 TO IB
 21033         IF PB-I-AGE GREATER CT-AGE (2)
 21034             ADD +3 TO IB
 21035             IF PB-I-AGE GREATER CT-AGE (3)
 21036                MOVE ZEROS       TO WS-WK-RATE
 21037                GO TO 8800-EXIT.
 21038
 21039     IF WS-WORK-TERM GREATER CT-TRM (1)
 21040         ADD +1 TO IB
 21041         IF WS-WORK-TERM GREATER CT-TRM (2)
 21042             ADD +1 TO IB
 21043             IF WS-WORK-TERM GREATER CT-TRM (3)
 21044                MOVE ZEROS       TO WS-WK-RATE
 21045                GO TO 8800-EXIT.
 21046
 21047     IF CT-RT (IB) NOT NUMERIC
 21048         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21049         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21050         GO TO 8800-GET-COMP-RATE.
 21051
 21052     MOVE CT-RT (IB) TO WS-WK-RATE.
 21053
 21054 8800-EXIT.
 21055     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 390
* EL050.cbl
 21057 8900-ADDRESS-FILE.
 21058     IF ERACCT-FILE-ADDRESSED
 21059         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21060         GO TO 8900-ADDRESS-EXIT.
 21061
 21062     IF ELCNTL-FILE-ADDRESSED
 21063         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21064         GO TO 8900-ADDRESS-EXIT.
 21065
 21066     IF ERPLAN-FILE-ADDRESSED
 21067         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21068         GO TO 8900-ADDRESS-EXIT.
 21069
 21070     IF ERFORM-FILE-ADDRESSED
 21071         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21072         GO TO 8900-ADDRESS-EXIT.
 21073
 21074 8900-ADDRESS-EXIT.
 21075     EXIT.
 21076
 21077 9000-READ-CONTROL.
 21078
 21079* EXEC CICS HANDLE CONDITION
 21080*        NOTFND    (9000-NOTFND)
 21081*    END-EXEC.
 21082*    MOVE '"$I                   ! ? #00019611' TO DFHEIV0
 21083     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21084     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21085     MOVE X'3F20233030303139363131' TO DFHEIV0(25:11)
 21086     CALL 'kxdfhei1' USING DFHEIV0
 21087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21088
 21089
 21090
 21091* EXEC CICS READ
 21092*        DATASET     (CNTL-ID)
 21093*        SET         (ADDRESS OF CONTROL-FILE)
 21094*        RIDFLD      (ELCNTL-KEY)
 21095*        GTEQ
 21096*    END-EXEC.
 21097*    MOVE '&"S        G          (   #00019615' TO DFHEIV0
 21098     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21099     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21100     MOVE X'2020233030303139363135' TO DFHEIV0(25:11)
 21101     CALL 'kxdfhei1' USING DFHEIV0,
 21102           CNTL-ID,
 21103           DFHEIV20,
 21104           DFHEIV99,
 21105           ELCNTL-KEY,
 21106           DFHEIV99,
 21107           DFHEIV99,
 21108           DFHEIV99
 21109     SET ADDRESS OF CONTROL-FILE TO
 21110         DFHEIV20
 21111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21112
 21113
 21114     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 391
* EL050.cbl
 21115
 21116 9000-NOTFND.
 21117     IF RC-SW-1 = '1'
 21118        MOVE ER-2616              TO WS-ERROR
 21119        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21120        GO TO 9000-EXIT.
 21121
 21122     IF RC-SW-1 = '2'
 21123        MOVE ER-2602              TO WS-ERROR
 21124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21125
 21126 9000-EXIT.
 21127      EXIT.
 21128
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 392
* EL050.cbl
 21130 9100-READ-CONTROL.
 21131
 21132* EXEC CICS HANDLE CONDITION
 21133*        NOTFND  (9100-NOTFND)
 21134*        ENDFILE (9100-NOTFND)
 21135*    END-EXEC.
 21136*    MOVE '"$I''                  ! @ #00019639' TO DFHEIV0
 21137     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21138     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21139     MOVE X'4020233030303139363339' TO DFHEIV0(25:11)
 21140     CALL 'kxdfhei1' USING DFHEIV0
 21141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21142
 21143
 21144
 21145* EXEC CICS READ
 21146*        DATASET     (CNTL-ID)
 21147*        INTO        (CONTROL-FILE)
 21148*        RIDFLD      (ELCNTL-KEY)
 21149*        GTEQ
 21150*    END-EXEC.
 21151     MOVE LENGTH OF
 21152      CONTROL-FILE
 21153       TO DFHEIV11
 21154*    MOVE '&"IL       G          (   #00019644' TO DFHEIV0
 21155     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21156     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21157     MOVE X'2020233030303139363434' TO DFHEIV0(25:11)
 21158     CALL 'kxdfhei1' USING DFHEIV0,
 21159           CNTL-ID,
 21160           CONTROL-FILE,
 21161           DFHEIV11,
 21162           ELCNTL-KEY,
 21163           DFHEIV99,
 21164           DFHEIV99,
 21165           DFHEIV99
 21166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21167
 21168
 21169     GO TO 9100-EXIT.
 21170
 21171 9100-NOTFND.
 21172     IF RC-SW-2 = '0'
 21173        MOVE '1'                  TO STATE-RECORD-ERROR
 21174        GO TO 9100-EXIT
 21175     END-IF
 21176     IF RC-SW-2 = '1'
 21177        MOVE '1'                  TO LF-BENEFIT-ERROR
 21178        MOVE ER-2604              TO WS-ERROR
 21179        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21180        GO TO 9100-EXIT.
 21181
 21182     IF RC-SW-2 = '2'
 21183        MOVE '1'                  TO AH-BENEFIT-ERROR
 21184        MOVE ER-2605              TO WS-ERROR
 21185        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21186        GO TO 9100-EXIT.
 21187
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 393
* EL050.cbl
 21188     IF RC-SW-2 = '3'
 21189         MOVE ER-2603           TO WS-ERROR
 21190         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21191         GO TO 9100-EXIT.
 21192
 21193     IF RC-SW-2 = '4'
 21194         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21195         GO TO 9100-EXIT.
 21196
 21197     IF RC-SW-2 = '5'
 21198         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21199         IF WS-AH-INPUT-CD-1 = SPACE
 21200             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21201         ELSE
 21202             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21203
 21204 9100-EXIT.
 21205      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 394
* EL050.cbl
 21207 9200-CONTROL-GETMAIN.
 21208
 21209* EXEC CICS GETMAIN
 21210*         LENGTH   (750)
 21211*         SET      (ADDRESS OF CONTROL-FILE)
 21212*    END-EXEC.
 21213     MOVE 750
 21214       TO DFHEIV11
 21215*    MOVE '," L                  $   #00019690' TO DFHEIV0
 21216     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21217     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21218     MOVE X'2020233030303139363930' TO DFHEIV0(25:11)
 21219     CALL 'kxdfhei1' USING DFHEIV0,
 21220           DFHEIV20,
 21221           DFHEIV11,
 21222           DFHEIV99
 21223     SET ADDRESS OF CONTROL-FILE TO
 21224         DFHEIV20
 21225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21226
 21227
 21228     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21229
 21230 9200-EXIT.
 21231     EXIT.
 21232
 21233 9250-UNLOCK-RETURN.
 21234
 21235* EXEC CICS UNLOCK
 21236*        DATASET   (CERT-ID)
 21237*    END-EXEC.
 21238*    MOVE '&*                    #   #00019701' TO DFHEIV0
 21239     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21240     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21241     MOVE X'2020233030303139373031' TO DFHEIV0(25:11)
 21242     CALL 'kxdfhei1' USING DFHEIV0,
 21243           CERT-ID,
 21244           DFHEIV99
 21245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21246
 21247
 21248 9300-ABEND.
 21249     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21250
 21251
 21252* EXEC CICS LINK
 21253*        PROGRAM   ('EL004')
 21254*        COMMAREA  (WS-ERROR-LINE)
 21255*        LENGTH    (72)
 21256*    END-EXEC.
 21257     MOVE 'EL004' TO DFHEIV1
 21258     MOVE 72
 21259       TO DFHEIV11
 21260*    MOVE '."C                   (   #00019708' TO DFHEIV0
 21261     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21262     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21263     MOVE X'2020233030303139373038' TO DFHEIV0(25:11)
 21264     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 395
* EL050.cbl
 21265           DFHEIV1,
 21266           WS-ERROR-LINE,
 21267           DFHEIV11,
 21268           DFHEIV99,
 21269           DFHEIV99,
 21270           DFHEIV99,
 21271           DFHEIV99
 21272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21273
 21274
 21275     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21276
 21277
 21278* EXEC CICS ABEND
 21279*        ABCODE ('EL50')
 21280*    END-EXEC.
 21281     MOVE 'EL50' TO DFHEIV5
 21282*    MOVE '.,A                   "   #00019716' TO DFHEIV0
 21283     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21284     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21285     MOVE X'2020233030303139373136' TO DFHEIV0(25:11)
 21286     CALL 'kxdfhei1' USING DFHEIV0,
 21287           DFHEIV5
 21288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21289
 21290
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 396
* EL050.cbl
 21292
 21293******************************************************************
 21294*                                                                *
 21295*            E R R O R   F O R M A T   R O U T I N E             *
 21296*                                                                *
 21297******************************************************************
 21298
 21299 9900-ERROR-FORMAT.
 21300
 21301     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21302                    PB-COMMON-ERROR (2) OR
 21303                    PB-COMMON-ERROR (3) OR
 21304                    PB-COMMON-ERROR (4) OR
 21305                    PB-COMMON-ERROR (5) OR
 21306                    PB-COMMON-ERROR (6) OR
 21307                    PB-COMMON-ERROR (7) OR
 21308                    PB-COMMON-ERROR (8) OR
 21309                    PB-COMMON-ERROR (9) OR
 21310                    PB-COMMON-ERROR (10)
 21311        GO TO 9900-EXIT.
 21312
 21313     IF PB-NO-OF-ERRORS = +10
 21314        GO TO 9900-EXIT.
 21315
 21316     ADD +1  TO PB-NO-OF-ERRORS.
 21317     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21318                                       (PB-NO-OF-ERRORS).
 21319 9900-EXIT.
 21320     EXIT.
 21321
 21322 9990-RETURN.
 21323     IF BROWSE-STARTED
 21324
 21325* EXEC CICS ENDBR
 21326*            DATASET  (ACCT-ID)
 21327*       END-EXEC.
 21328     MOVE 0
 21329       TO DFHEIV11
 21330*    MOVE '&2                    $   #00019753' TO DFHEIV0
 21331     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21332     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21333     MOVE X'2020233030303139373533' TO DFHEIV0(25:11)
 21334     CALL 'kxdfhei1' USING DFHEIV0,
 21335           ACCT-ID,
 21336           DFHEIV11,
 21337           DFHEIV99
 21338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21339
 21340
 21341 9990-EXIT.
 21342     EXIT.
 21343
 21344
 21345****Check for CRTO record, add one if not found.
 21346 9991-CHECK-FOR-ELCRTO.
 21347
 21348* EXEC CICS HANDLE CONDITION
 21349*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 397
* EL050.cbl
 21350*         ENDFILE (9991-CRTO-NOT-FOUND)
 21351*     END-EXEC.
 21352*    MOVE '"$I''                  ! A #00019763' TO DFHEIV0
 21353     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21355     MOVE X'4120233030303139373633' TO DFHEIV0(25:11)
 21356     CALL 'kxdfhei1' USING DFHEIV0
 21357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21358
 21359     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21360     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21361     MOVE +0                     TO ELCRTO-SEQ-NO
 21362
 21363
 21364* EXEC CICS READ
 21365*       DATASET   ('ELCRTO')
 21366*       INTO      (ORIGINAL-CERTIFICATE)
 21367*       RIDFLD    (ELCRTO-KEY)
 21368*       GTEQ
 21369*       RESP      (WS-RESPONSE)
 21370*    END-EXEC
 21371     MOVE LENGTH OF
 21372      ORIGINAL-CERTIFICATE
 21373       TO DFHEIV11
 21374     MOVE 'ELCRTO' TO DFHEIV1
 21375*    MOVE '&"IL       G          (  N#00019771' TO DFHEIV0
 21376     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21377     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21378     MOVE X'204E233030303139373731' TO DFHEIV0(25:11)
 21379     CALL 'kxdfhei1' USING DFHEIV0,
 21380           DFHEIV1,
 21381           ORIGINAL-CERTIFICATE,
 21382           DFHEIV11,
 21383           ELCRTO-KEY,
 21384           DFHEIV99,
 21385           DFHEIV99,
 21386           DFHEIV99
 21387     MOVE EIBRESP  TO WS-RESPONSE
 21388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21389
 21390     IF WS-RESP-NORMAL
 21391        AND (OC-CONTROL-PRIMARY (1:33) =
 21392                 PB-CONTROL-BY-ACCOUNT (1:33))
 21393        AND (OC-RECORD-TYPE =  'I')
 21394           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21395               GO TO 9991-CHECK-INDICATORS
 21396           ELSE
 21397               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21398               GO TO 9991-CRTO-ADD-REC
 21399           END-IF
 21400     END-IF.
 21401
 21402 9991-CRTO-NOT-FOUND.
 21403
 21404     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21405     MOVE 'OC'                TO OC-RECORD-ID
 21406     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21407                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 398
* EL050.cbl
 21408     MOVE +4096               TO OC-KEY-SEQ-NO.
 21409
 21410 9991-CRTO-ADD-REC.
 21411
 21412     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21413     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21414     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21415     MOVE 'I'                 TO OC-RECORD-TYPE
 21416     IF PB-ISSUE
 21417         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21418         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21419         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21420         MOVE PB-I-AGE               TO OC-INS-AGE
 21421         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21422         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21423         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21424         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21425         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21426         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21427         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21428         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21429         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21430         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21431         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21432         IF PB-I-JOINT-COMMISSION > +0
 21433             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21434         ELSE
 21435             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21436         END-IF
 21437         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21438         MOVE +0                     TO OC-LF-CANCEL-AMT
 21439                                        OC-LF-ITD-CANCEL-AMT
 21440         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21441         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21442         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21443         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21444         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21445         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21446         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21447         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21448         MOVE +0                     TO OC-AH-CANCEL-AMT
 21449                                        OC-AH-ITD-CANCEL-AMT
 21450         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21451         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21452         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21453     ELSE
 21454         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21455         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21456         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21457         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21458         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21459         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21460         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21461         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21462         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21463          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21464             MOVE SPACES             TO OC-LF-BENCD
 21465             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 399
* EL050.cbl
 21466                                        OC-LF-BEN-AMT
 21467                                        OC-LF-PRM-AMT
 21468                                        OC-LF-ALT-BEN-AMT
 21469                                        OC-LF-ALT-PRM-AMT
 21470                                        OC-LF-COMM-PCT
 21471                                        OC-LF-CANCEL-AMT
 21472             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21473             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21474         ELSE
 21475             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21476             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21477             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21478             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21479             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21480             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21481             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21482             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21483             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21484             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21485         END-IF
 21486         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21487         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21488          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21489             MOVE SPACES             TO OC-AH-BENCD
 21490             MOVE ZEROS              TO OC-AH-TERM
 21491                                        OC-AH-BEN-AMT
 21492                                        OC-AH-PRM-AMT
 21493                                        OC-AH-COMM-PCT
 21494                                        OC-AH-CANCEL-AMT
 21495                                        OC-AH-CP
 21496             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21497             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21498         ELSE
 21499             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21500             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21501             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21502             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21503             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21504             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21505             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21506             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21507             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21508         END-IF
 21509         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21510         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21511         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21512         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21513     END-IF
 21514     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21515
 21516     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21517
 21518
 21519* EXEC CICS READ
 21520*         DATASET   (FILE-ERMAIL)
 21521*         RIDFLD    (MA-CONTROL-PRIMARY)
 21522*         INTO      (MAILING-DATA)
 21523*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 400
* EL050.cbl
 21524*    END-EXEC
 21525     MOVE LENGTH OF
 21526      MAILING-DATA
 21527       TO DFHEIV11
 21528*    MOVE '&"IL       E          (  N#00019907' TO DFHEIV0
 21529     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21530     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21531     MOVE X'204E233030303139393037' TO DFHEIV0(25:11)
 21532     CALL 'kxdfhei1' USING DFHEIV0,
 21533           FILE-ERMAIL,
 21534           MAILING-DATA,
 21535           DFHEIV11,
 21536           MA-CONTROL-PRIMARY,
 21537           DFHEIV99,
 21538           DFHEIV99,
 21539           DFHEIV99
 21540     MOVE EIBRESP  TO WS-RESPONSE
 21541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21542
 21543     IF WS-RESP-NORMAL
 21544         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21545     END-IF.
 21546
 21547     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21548     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21549
 21550
 21551* EXEC CICS READ
 21552*         DATASET  (CRTT-ID)
 21553*         RIDFLD   (WS-ELCRTT-KEY)
 21554*         INTO     (CERTIFICATE-TRAILERS)
 21555*         RESP     (WS-RESPONSE)
 21556*    END-EXEC
 21557     MOVE LENGTH OF
 21558      CERTIFICATE-TRAILERS
 21559       TO DFHEIV11
 21560*    MOVE '&"IL       E          (  N#00019921' TO DFHEIV0
 21561     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21562     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21563     MOVE X'204E233030303139393231' TO DFHEIV0(25:11)
 21564     CALL 'kxdfhei1' USING DFHEIV0,
 21565           CRTT-ID,
 21566           CERTIFICATE-TRAILERS,
 21567           DFHEIV11,
 21568           WS-ELCRTT-KEY,
 21569           DFHEIV99,
 21570           DFHEIV99,
 21571           DFHEIV99
 21572     MOVE EIBRESP  TO WS-RESPONSE
 21573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21574
 21575     IF WS-RESP-NORMAL
 21576         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21577         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21578     END-IF.
 21579
 21580
 21581* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 401
* EL050.cbl
 21582*       DATASET   ('ELCRTO')
 21583*       FROM      (ORIGINAL-CERTIFICATE)
 21584*       RIDFLD    (OC-CONTROL-PRIMARY)
 21585*       RESP      (WS-RESPONSE)
 21586*    END-EXEC.
 21587     MOVE LENGTH OF
 21588      ORIGINAL-CERTIFICATE
 21589       TO DFHEIV11
 21590     MOVE 'ELCRTO' TO DFHEIV1
 21591*    MOVE '&$ L                  ''  N#00019933' TO DFHEIV0
 21592     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21593     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21594     MOVE X'204E233030303139393333' TO DFHEIV0(25:11)
 21595     CALL 'kxdfhei1' USING DFHEIV0,
 21596           DFHEIV1,
 21597           ORIGINAL-CERTIFICATE,
 21598           DFHEIV11,
 21599           OC-CONTROL-PRIMARY,
 21600           DFHEIV99,
 21601           DFHEIV99
 21602     MOVE EIBRESP  TO WS-RESPONSE
 21603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21604
 21605
 21606     GO TO 9991-EXIT.
 21607
 21608 9991-CHECK-INDICATORS.
 21609
 21610     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21611         GO TO 9991-EXIT
 21612     END-IF.
 21613
 21614     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21615         GO TO 9991-EXIT
 21616     END-IF.
 21617
 21618
 21619* EXEC CICS READ
 21620*       DATASET   ('ELCRTO')
 21621*       INTO      (ORIGINAL-CERTIFICATE)
 21622*       RIDFLD    (OC-CONTROL-PRIMARY)
 21623*       UPDATE
 21624*       RESP      (WS-RESPONSE)
 21625*    END-EXEC
 21626     MOVE LENGTH OF
 21627      ORIGINAL-CERTIFICATE
 21628       TO DFHEIV11
 21629     MOVE 'ELCRTO' TO DFHEIV1
 21630*    MOVE '&"IL       EU         (  N#00019952' TO DFHEIV0
 21631     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21632     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21633     MOVE X'204E233030303139393532' TO DFHEIV0(25:11)
 21634     CALL 'kxdfhei1' USING DFHEIV0,
 21635           DFHEIV1,
 21636           ORIGINAL-CERTIFICATE,
 21637           DFHEIV11,
 21638           OC-CONTROL-PRIMARY,
 21639           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 402
* EL050.cbl
 21640           DFHEIV99,
 21641           DFHEIV99
 21642     MOVE EIBRESP  TO WS-RESPONSE
 21643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21644     IF WS-RESP-NORMAL
 21645        IF PB-ISSUE
 21646          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21647          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21648          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21649          MOVE PB-I-AGE               TO OC-INS-AGE
 21650          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21651          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21652          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21653          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21654          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21655          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21656          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21657          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21658          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21659          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21660          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21661          IF PB-I-JOINT-COMMISSION > +0
 21662              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21663          ELSE
 21664              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21665          END-IF
 21666          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21667          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21668          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21669          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21670          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21671          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21672          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21673          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21674          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21675
 21676          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21677
 21678* EXEC CICS READ
 21679*             DATASET   (FILE-ERMAIL)
 21680*             RIDFLD    (MA-CONTROL-PRIMARY)
 21681*             INTO      (MAILING-DATA)
 21682*             RESP      (WS-RESPONSE)
 21683*         END-EXEC
 21684     MOVE LENGTH OF
 21685      MAILING-DATA
 21686       TO DFHEIV11
 21687*    MOVE '&"IL       E          (  N#00019992' TO DFHEIV0
 21688     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21689     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21690     MOVE X'204E233030303139393932' TO DFHEIV0(25:11)
 21691     CALL 'kxdfhei1' USING DFHEIV0,
 21692           FILE-ERMAIL,
 21693           MAILING-DATA,
 21694           DFHEIV11,
 21695           MA-CONTROL-PRIMARY,
 21696           DFHEIV99,
 21697           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 403
* EL050.cbl
 21698           DFHEIV99
 21699     MOVE EIBRESP  TO WS-RESPONSE
 21700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21701          IF WS-RESP-NORMAL
 21702             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21703          END-IF
 21704
 21705          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21706          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21707
 21708* EXEC CICS READ
 21709*             DATASET  (CRTT-ID)
 21710*             RIDFLD   (WS-ELCRTT-KEY)
 21711*             INTO     (CERTIFICATE-TRAILERS)
 21712*             RESP     (WS-RESPONSE)
 21713*         END-EXEC
 21714     MOVE LENGTH OF
 21715      CERTIFICATE-TRAILERS
 21716       TO DFHEIV11
 21717*    MOVE '&"IL       E          (  N#00020004' TO DFHEIV0
 21718     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21719     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21720     MOVE X'204E233030303230303034' TO DFHEIV0(25:11)
 21721     CALL 'kxdfhei1' USING DFHEIV0,
 21722           CRTT-ID,
 21723           CERTIFICATE-TRAILERS,
 21724           DFHEIV11,
 21725           WS-ELCRTT-KEY,
 21726           DFHEIV99,
 21727           DFHEIV99,
 21728           DFHEIV99
 21729     MOVE EIBRESP  TO WS-RESPONSE
 21730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21731          IF WS-RESP-NORMAL
 21732             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21733                               OC-INS-AGE-DEFAULT-FLAG
 21734             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21735                               OC-JNT-AGE-DEFAULT-FLAG
 21736          END-IF
 21737
 21738        ELSE
 21739          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21740             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21741             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21742             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21743          END-IF
 21744          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21745             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21746             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21747             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21748          END-IF
 21749          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21750        END-IF
 21751
 21752* EXEC CICS REWRITE
 21753*          DATASET   ('ELCRTO')
 21754*          FROM      (ORIGINAL-CERTIFICATE)
 21755*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 404
* EL050.cbl
 21756*       END-EXEC
 21757     MOVE LENGTH OF
 21758      ORIGINAL-CERTIFICATE
 21759       TO DFHEIV11
 21760     MOVE 'ELCRTO' TO DFHEIV1
 21761*    MOVE '&& L                  %  N#00020030' TO DFHEIV0
 21762     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21763     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21764     MOVE X'204E233030303230303330' TO DFHEIV0(25:11)
 21765     CALL 'kxdfhei1' USING DFHEIV0,
 21766           DFHEIV1,
 21767           ORIGINAL-CERTIFICATE,
 21768           DFHEIV11,
 21769           DFHEIV99
 21770     MOVE EIBRESP  TO WS-RESPONSE
 21771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21772     END-IF.
 21773
 21774 9991-EXIT.
 21775     EXIT.
 21776
 21777
 21778 9999-RETURN.
 21779     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21780
 21781
 21782* EXEC CICS RETURN
 21783*    END-EXEC.
 21784*    MOVE '.(                    ''   #00020044' TO DFHEIV0
 21785     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21786     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21787     MOVE X'2020233030303230303434' TO DFHEIV0(25:11)
 21788     CALL 'kxdfhei1' USING DFHEIV0,
 21789           DFHEIV99,
 21790           DFHEIV99,
 21791           DFHEIV99,
 21792           DFHEIV99,
 21793           DFHEIV99,
 21794           DFHEIV99
 21795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21796
 21797
 21798
 21799* GOBACK.
 21800     MOVE '9%                    "   ' TO DFHEIV0
 21801     MOVE 'EL050' TO DFHEIV1
 21802     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21803     GOBACK.
 21804
 21805 9999-DFHBACK SECTION.
 21806     MOVE '9%                    "   ' TO DFHEIV0
 21807     MOVE 'EL050' TO DFHEIV1
 21808     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21809     GOBACK.
 21810 9999-DFHEXIT.
 21811     IF DFHEIGDJ EQUAL 0001
 21812         NEXT SENTENCE
 21813     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 405
* EL050.cbl
 21814         GO TO 9300-ABEND,
 21815               3990-FILES-NOT-OPEN
 21816         DEPENDING ON DFHEIGDI
 21817     ELSE IF DFHEIGDJ EQUAL 3
 21818         GO TO 6610-START-BROWSE,
 21819               6630-ERRESS-PROBLEM,
 21820               6630-END-OF-FILE
 21821         DEPENDING ON DFHEIGDI
 21822     ELSE IF DFHEIGDJ EQUAL 4
 21823         GO TO 6630-END-OF-FILE,
 21824               6630-ERRESS-PROBLEM,
 21825               6630-ERRESS-PROBLEM,
 21826               6630-END-OF-FILE
 21827         DEPENDING ON DFHEIGDI
 21828     ELSE IF DFHEIGDJ EQUAL 5
 21829         GO TO 6630-END-OF-FILE,
 21830               6630-END-OF-FILE,
 21831               6630-ERRESS-PROBLEM,
 21832               6630-ERRESS-PROBLEM
 21833         DEPENDING ON DFHEIGDI
 21834     ELSE IF DFHEIGDJ EQUAL 6
 21835         GO TO 6660-START-BROWSE,
 21836               6690-ERRESC-PROBLEM,
 21837               6690-ERRESC-PROBLEM,
 21838               6690-END-OF-FILE
 21839         DEPENDING ON DFHEIGDI
 21840     ELSE IF DFHEIGDJ EQUAL 7
 21841         GO TO 6690-END-OF-FILE,
 21842               6690-ERRESC-PROBLEM,
 21843               6690-ERRESC-PROBLEM,
 21844               6690-END-OF-FILE
 21845         DEPENDING ON DFHEIGDI
 21846     ELSE IF DFHEIGDJ EQUAL 8
 21847         GO TO 6690-END-OF-FILE,
 21848               6690-ERRESC-PROBLEM,
 21849               6690-ERRESC-PROBLEM,
 21850               6690-END-OF-FILE
 21851         DEPENDING ON DFHEIGDI
 21852     ELSE IF DFHEIGDJ EQUAL 9
 21853         GO TO 7250-CONTINUE,
 21854               7250-CONTINUE
 21855         DEPENDING ON DFHEIGDI
 21856     ELSE IF DFHEIGDJ EQUAL 10
 21857         GO TO 7300-CONTINUE,
 21858               7300-CONTINUE
 21859         DEPENDING ON DFHEIGDI
 21860     ELSE IF DFHEIGDJ EQUAL 11
 21861         GO TO 8000-FREE-MAIN
 21862         DEPENDING ON DFHEIGDI
 21863     ELSE IF DFHEIGDJ EQUAL 12
 21864         GO TO 8100-NOTFND,
 21865               8100-NOTFND
 21866         DEPENDING ON DFHEIGDI
 21867     ELSE IF DFHEIGDJ EQUAL 13
 21868         GO TO 8110-NOTFND,
 21869               8110-NOTFND
 21870         DEPENDING ON DFHEIGDI
 21871     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 406
* EL050.cbl
 21872         GO TO 8130-EXIT
 21873         DEPENDING ON DFHEIGDI
 21874     ELSE IF DFHEIGDJ EQUAL 15
 21875         GO TO 8150-exit
 21876         DEPENDING ON DFHEIGDI
 21877     ELSE IF DFHEIGDJ EQUAL 16
 21878         GO TO 8180-NOTFND
 21879         DEPENDING ON DFHEIGDI
 21880     ELSE IF DFHEIGDJ EQUAL 17
 21881         GO TO 8190-NOTFND
 21882         DEPENDING ON DFHEIGDI
 21883     ELSE IF DFHEIGDJ EQUAL 18
 21884         GO TO 8195-NOTFND
 21885         DEPENDING ON DFHEIGDI
 21886     ELSE IF DFHEIGDJ EQUAL 19
 21887         GO TO 8200-NOTFND
 21888         DEPENDING ON DFHEIGDI
 21889     ELSE IF DFHEIGDJ EQUAL 20
 21890         GO TO 8300-NOTFND,
 21891               8300-ERRESS-PROBLEM,
 21892               8300-ERRESS-PROBLEM,
 21893               8300-NOTFND
 21894         DEPENDING ON DFHEIGDI
 21895     ELSE IF DFHEIGDJ EQUAL 21
 21896         GO TO 8450-FORM-NOT-FOUND,
 21897               8450-FORM-NOT-FOUND
 21898         DEPENDING ON DFHEIGDI
 21899     ELSE IF DFHEIGDJ EQUAL 22
 21900         GO TO 0199-ACCT-NOT-FOUND,
 21901               0199-ACCT-NOT-FOUND
 21902         DEPENDING ON DFHEIGDI
 21903     ELSE IF DFHEIGDJ EQUAL 23
 21904         GO TO 0199-ACCT-NOT-FOUND,
 21905               0199-ACCT-NOT-FOUND
 21906         DEPENDING ON DFHEIGDI
 21907     ELSE IF DFHEIGDJ EQUAL 24
 21908         GO TO 8582-COMP-NOT-FOUND,
 21909               8582-COMP-NOT-FOUND
 21910         DEPENDING ON DFHEIGDI
 21911     ELSE IF DFHEIGDJ EQUAL 25
 21912         GO TO 8583-AGTC-NOT-FOUND,
 21913               8583-AGTC-NOT-FOUND
 21914         DEPENDING ON DFHEIGDI
 21915     ELSE IF DFHEIGDJ EQUAL 26
 21916         GO TO 8584-BXRF-NOT-FOUND,
 21917               8584-BXRF-NOT-FOUND
 21918         DEPENDING ON DFHEIGDI
 21919     ELSE IF DFHEIGDJ EQUAL 27
 21920         GO TO 8585-PLAN-NOT-FOUND,
 21921               8585-PLAN-NOT-FOUND
 21922         DEPENDING ON DFHEIGDI
 21923     ELSE IF DFHEIGDJ EQUAL 28
 21924         GO TO 0299-CERT-NOT-FOUND
 21925         DEPENDING ON DFHEIGDI
 21926     ELSE IF DFHEIGDJ EQUAL 29
 21927         GO TO 8700-READ-CERT-MASTER
 21928         DEPENDING ON DFHEIGDI
 21929     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 22-May-14 08:10 Page 407
* EL050.cbl
 21930         GO TO 8720-COMP-ACCOUNTS,
 21931               8730-END-BROWSE,
 21932               8740-NOT-FOUND
 21933         DEPENDING ON DFHEIGDI
 21934     ELSE IF DFHEIGDJ EQUAL 31
 21935         GO TO 9000-NOTFND
 21936         DEPENDING ON DFHEIGDI
 21937     ELSE IF DFHEIGDJ EQUAL 32
 21938         GO TO 9100-NOTFND,
 21939               9100-NOTFND
 21940         DEPENDING ON DFHEIGDI
 21941     ELSE IF DFHEIGDJ EQUAL 33
 21942         GO TO 9991-CRTO-NOT-FOUND,
 21943               9991-CRTO-NOT-FOUND
 21944         DEPENDING ON DFHEIGDI.
 21945     MOVE '9%                    "   ' TO DFHEIV0
 21946     MOVE 'EL050' TO DFHEIV1
 21947     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21948     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40016     Code:       88304
