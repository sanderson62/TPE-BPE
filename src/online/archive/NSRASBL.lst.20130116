* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page   1
* NSRASBL.cbl
* Options: int("NSRASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSRASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRASBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSRASLTR
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* ChangeS ARE MARKED BY THE Change EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  Change   Change REQUEST PGMR  DESCRIPTION OF Change
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page   2
* NSRASBL.cbl
    14* 060611    2011022800001  PEMA  NEW PROGRAM
    15* 122911    2011022800001  AJRA  ADD VA DISCLOSURE TO CERT PRINT
    16* 071212    2011022800001  AJRA  ADD UNDW ID
    17* 072312    2011022800001  AJRA    ADD NEW FIELDS
    18* 090612  IR2012090600001  AJRA  NAPERSOFT
    19* 091112  IR2012091100002  AJRA  FIX AKA
    20* 091312  IR2012091100004  AJRA  FIX JOINT NAME
    21* 092412  IR2012092350004  AJRA  FIX CANCEL AMT
    22* 100112  IR2012100100002  AJRA  FIX ADDRESS WITH 2 SPACES
    23* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    24* 101412    2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    25* 101812    2012101700002  AJRA  READ ENDT BY ARCHIVE NO
    26* 110612    2012101700002  AJRA  ADD NEW FIELDS
    27* 121112    2012101700002  AJRA  HANDLE .01 PREM AND 9999999 BEN
    28******************************************************************
    29 ENVIRONMENT DIVISION.
    30 DATA DIVISION.
    31 working-storage section.
    32 01  DFH-START PIC X(04).
    33 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    34 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    35 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    36 77  S1                          PIC S999 COMP-3 VALUE +0.
    37 77  E1                          PIC S999 COMP-3 VALUE +0.
    38 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    39 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    40 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    41 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    42 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    43 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    44 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    45 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    46 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    47 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    48 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    49 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    50     88  FOUND-BENE                  VALUE 'Y'.
    51 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    52 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    53 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    54 77  WS-ERPNDB-SW                PIC X  VALUE ' '.
    55     88  END-OF-ERPNDB              VALUE 'Y'.
    56 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    57     88  ACCT-FOUND                 VALUE 'Y'.
    58 77  WS-ELCERT-SW                PIC X  VALUE ' '.
    59     88  CERT-FOUND                 VALUE 'Y'.
    60     88  CERT-NOT-FOUND             VALUE 'N'.
    61 77  WS-ERENDT-SW                PIC X  VALUE ' '.
    62     88  ENDT-FOUND                 VALUE 'Y'.
    63     88  ENDT-NOT-FOUND             VALUE 'N'.
    64 77  WS-LF-ABBRV                 PIC X(10) VALUE SPACES.
    65 77  WS-LF-DESC                  PIC X(02) VALUE SPACES.
    66 77  WS-LF-EARN                  PIC X     VALUE ' '.
    67 77  WS-WAIT-PER                 PIC X(03) VALUE ZEROS.
    68 77  WS-RET-ELIM                 PIC X(01) VALUE SPACES.
    69 77  WS-AH-DESC                  PIC X(35) VALUE SPACES.
    70 77  WS-BEN-DAYS                 PIC X(02) VALUE ZEROS.
    71 77  WS-CSR-ID                   PIC XXXX  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page   3
* NSRASBL.cbl
    72 77  WS-LF-BENCD                 PIC XX    VALUE '00'.
    73 77  WS-AH-BENCD                 PIC XX    VALUE '00'.
    74 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    75 77  WS-COMPANY-CD               PIC X  VALUE LOW-VALUES.
    76 77  WS-WORK-PREM                PIC S9(9)V99 COMP-3 VALUE +0.
    77 77  WS-WORK-LF-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    78 77  WS-WORK-ALT-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    79 77  WS-WORK-CMB-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    80 77  WS-WORK-AH-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    81 77  WS-WORK-REF                 PIC S9(9)V99 COMP-3 VALUE +0.
    82 77  WS-WORK-LF-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    83 77  WS-WORK-AH-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    84 77  WS-ISSUE-CANCEL-SW          PIC X  VALUE SPACES.
    85     88  PROCESS-ISSUE               VALUE 'I'.
    86     88  PROCESS-CANCEL              VALUE 'C'.
    87 77  WS-SAVE-OUT-LETTER          PIC X(6)  VALUE SPACES.
    88 77  WS-WORK-COMM                PIC 9(7)V99 VALUE ZEROS.
    89 77  WS-DIFF                     PIC 999 VALUE ZEROS.
    90 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
    91 77  WS-CHGBK-LIFE-PCT           PIC S9V9(5) COMP-3 VALUE +0.
    92 77  WS-CHGBK-AH-PCT             PIC S9V9(5) COMP-3 VALUE +0.
    93 77  WS-CERT-EFF-DT              PIC XX  VALUE SPACES.
    94 77  LINK-ELVADS                 PIC X(8) VALUE 'ELVADS'.
    95 01  WS-CALC-FIELDS.
    96     12  WS-WRK-AMOUNT           PIC S9(7)V99 COMP-3 VALUE +0.
    97     12  WS-WRK-AMOUNT2          PIC S9(7)V99 COMP-3 VALUE +0.
    98     12  WS-CSO-LF-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
    99     12  WS-CSO-ALT-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   100     12  WS-CSO-CMB-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   101     12  WS-CSO-AH-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   102     12  WS-CSO-PORTION          PIC S9(7)V99 COMP-3 VALUE +0.
   103     12  WS-ACCT-LF-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   104     12  WS-ACCT-ALT-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   105     12  WS-ACCT-CMB-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   106     12  WS-ACCT-AH-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   107     12  WS-ACCT-PORTION         PIC S9(7)V99 COMP-3 VALUE +0.
   108     12  WS-CSO-ORIG-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   109     12  WS-CSO-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   110     12  WS-CSO-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   111     12  WS-CSO-ORIG-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   112     12  WS-CSO-ORIG-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   113     12  WS-ACCT-ORIG-LF-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   114     12  WS-ACCT-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   115     12  WS-ACCT-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   116     12  WS-ACCT-ORIG-AH-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   117     12  WS-ACCT-ORIG-PORTION    PIC S9(7)V99 COMP-3 VALUE +0.
   118     12  WS-CSO-NEW-LF-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   119     12  WS-CSO-NEW-ALT-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   120     12  WS-CSO-NEW-CMB-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   121     12  WS-CSO-NEW-AH-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   122     12  WS-CSO-NEW-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   123     12  WS-ACCT-NEW-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   124     12  WS-ACCT-NEW-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   125     12  WS-ACCT-NEW-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   126     12  WS-ACCT-NEW-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   127     12  WS-ACCT-NEW-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   128     12  WS-CSO-LF-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   129     12  WS-CSO-ALT-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page   4
* NSRASBL.cbl
   130     12  WS-CSO-CMB-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   131     12  WS-CSO-AH-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   132     12  WS-CSO-PORTION-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   133     12  WS-ACCT-LF-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   134     12  WS-ACCT-ALT-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   135     12  WS-ACCT-CMB-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   136     12  WS-ACCT-AH-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   137     12  WS-ACCT-PORTION-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   138 01  WS-SAVE-ERACCT-REC          PIC X(2000).
   139 01  WS-XML-WORK                 PIC X(4200)  VALUE SPACES.
   140 01 response-code         pic s9(8) comp.
   141 01 display-response      pic 9(8).
   142 01 bl-index              pic 9(8) comp.
   143 01 max-last-name         pic x(18).
   144 01 first-initial         pic x.
   145 01 name-in-range-flag    pic 9.
   146 01 max-entries           pic s9(8) comp value 100.
   147 01 WS-PASSED-DT          PIC XX   VALUE LOW-VALUES.
   148 01 lower-case    pic x(26) value
   149            "abcdefghijklmnopqrstuvwxyz".
   150 01 upper-case    pic x(26) value
   151            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
   152
   153*                                COPY ELCVADS.
   154******************************************************************
   155*                                                                *
   156*                                                                *
   157*                            ELCVADS.                            *
   158*                                                                *
   159*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   160*   ELVADS                  LENGTH = 350                         *
   161******************************************************************
   162******************************************************************
   163*                   C H A N G E   L O G
   164*
   165* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   166*-----------------------------------------------------------------
   167*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   168* EFFECTIVE    NUMBER
   169*-----------------------------------------------------------------
   170* 100111    2011022800001  AJRA  NAPERSOFT
   171******************************************************************
   172
   173 01  VIRGINIA-DISCLOSURE.
   174     12  VD-COMPANY-CD              PIC X.
   175     12  VD-CARRIER                 PIC X.
   176     12  VD-GROUPING.
   177         20  VD-GROUPING-PREFIX     PIC XXX.
   178         20  VD-GROUPING-PRIME      PIC XXX.
   179     12  VD-STATE                   PIC XX.
   180     12  VD-ACCOUNT.
   181         20  VD-ACCOUNT-PREFIX      PIC X(4).
   182         20  VD-ACCOUNT-PRIME       PIC X(6).
   183     12  VD-CERT-EFF-DT             PIC XX.
   184     12  VD-CERT-NO.
   185         20  VD-CERT-PRIME          PIC X(10).
   186         20  VD-CERT-SFX            PIC X.
   187     12  VD-ENTRY-BATCH             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page   5
* NSRASBL.cbl
   188     12  VD-CSR-ID                  PIC X(4).
   189     12  VD-NAME.
   190         20  VD-INSURED-LAST-NAME   PIC X(15).
   191         20  VD-INSURED-FIRST-NAME.
   192             24  VD-INSURED-1ST-INIT PIC X.
   193             24  FILLER             PIC X(9).
   194         20  VD-INSURED-MIDDLE-INIT PIC X.
   195     12  VD-JOINT-INSURED.
   196         20 VD-JOINT-LAST-NAME      PIC X(15).
   197         20 VD-JOINT-FIRST-NAME.
   198            24  VD-JOINT-FIRST-INIT PIC X.
   199            24  FILLER              PIC X(9).
   200         20 VD-JOINT-MIDDLE-INIT    PIC X.
   201     12  VD-INSURED-ADDRESS-1       PIC X(30).
   202     12  VD-INSURED-ADDRESS-2       PIC X(30).
   203     12  VD-INSURED-CITY-STATE.
   204         20  VD-INSURED-CITY        PIC X(28).
   205         20  VD-INSURED-STATE       PIC XX.
   206     12  VD-INSURED-ZIP-CODE.
   207         20  VD-INSURED-ZIP-PRIME.
   208             24  VD-INSURED-ZIP-1   PIC X.
   209                 88  VD-CANADIAN-POST-CODE
   210                                       VALUE 'A' THRU 'Z'.
   211             24  FILLER             PIC X(4).
   212         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
   213     12  VD-BENEFICIARY-NAME        PIC X(30).
   214     12  VD-ACCOUNT-NAME            PIC X(30).
   215     12  VD-LOAN-TERM               PIC S999   COMP-3.
   216     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   217     12  VD-1ST-PMT-DT              PIC XX.
   218     12  VD-LIFE-BENEFIT-CD         PIC XX.
   219         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   220         88  VD-INVALID-LIFE           VALUE '  ' '00'
   221                                             '90' THRU '99'.
   222     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   223                                    PIC XX.
   224     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   225     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   226     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   227     12  VD-LF-TERM                 PIC S999   COMP-3.
   228     12  VD-AH-BENEFIT-CD           PIC XX.
   229         88  VD-VALID-AH               VALUE '01' THRU '89'.
   230         88  VD-INVALID-AH             VALUE '  ' '00'
   231                                             '90' THRU '99'.
   232     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   233     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   234     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   235     12  VD-AH-TERM                 PIC S999   COMP-3.
   236     12  VD-LETTER-ID               PIC X(4).
   237     12  VD-PROC-ID                 PIC X(4).
   238     12  VD-COMP-ID                 PIC X(3).
   239     12  VD-CURRENT-DATE            PIC XX.
   240     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   241     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
   242     12  FILLER                     PIC X(32).
   243 01  WS-PASS-AREA.
   244     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   245     05  WS-PASS-VADS-REC    PIC X(350).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page   6
* NSRASBL.cbl
   246
   247*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   248*                         COPY ELCZREC.
   249******************************************************************
   250*                                                                *
   251*                                                                *
   252*                            ELCZREC.                            *
   253*                                                                *
   254*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   255*                                                                *
   256******************************************************************
   257*-----------------------------------------------------------------
   258*                   C H A N G E   L O G
   259*
   260* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   261*-----------------------------------------------------------------
   262*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   263* EFFECTIVE    NUMBER
   264*-----------------------------------------------------------------
   265* 122011    2011022800001  AJRA  NEW FILE
   266* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   267*-----------------------------------------------------------------
   268 01  W-Z-CONTROL-DATA.
   269     05  W-NUMBER-OF-COPIES      PIC  9.
   270     05  FILLER                  PIC  X.
   271     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   272     05  FILLER                  PIC  X.
   273     05  W-DAYS-TO-RESEND        PIC  999.
   274     05  FILLER                  PIC  X.
   275     05  W-FORM-TO-RESEND        PIC  X(4).
   276     05  FILLER                  PIC  X.
   277     05  W-PROMPT-LETTER         PIC  X.
   278     05  FILLER                  PIC  X.
   279     05  W-ENCLOSURE-CD          PIC  XXX.
   280     05  FILLER                  PIC  X.
   281     05  W-AUTO-CLOSE-IND        PIC  X.
   282     05  FILLER                  PIC  X.
   283     05  W-LETTER-TO-BENE        PIC  X.
   284     05  FILLER                  PIC  X.
   285     05  W-LETTER-TO-ACCT        PIC  X.
   286     05  FILLER                  PIC  X.
   287     05  W-LETTER-TYPE           PIC  X.
   288     05  FILLER                  PIC  X.
   289     05  W-PRINT-CERTIFICATE     PIC  X.
   290     05  FILLER                  PIC  X.
   291     05  W-REFUND-REQUIRED       PIC  X.
   292     05  FILLER                  PIC  X.
   293     05  W-ONBASE-CODE           PIC  XX.
   294     05  FILLER                  PIC  X.
   295     05  W-ACCT-SUMM             PIC  X.
   296     05  FILLER                  PIC  X.
   297     05  W-CSO-SUMM              PIC  X.
   298     05  FILLER                  PIC  X(31).
   299 01  MISC.
   300     12  WS-RESPONSE             PIC S9(8)   COMP.
   301         88  RESP-NORMAL                  VALUE +00.
   302         88  RESP-NOTFND                  VALUE +13.
   303         88  RESP-DUPREC                  VALUE +14.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page   7
* NSRASBL.cbl
   304         88  RESP-DUPKEY                  VALUE +15.
   305         88  RESP-NOTOPEN                 VALUE +19.
   306         88  RESP-ENDFILE                 VALUE +20.
   307 01  srch-commarea.
   308*                                copy ELCADLTRSPI.
   309******************************************************************
   310*                   C H A N G E   L O G
   311*
   312* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   313*-----------------------------------------------------------------
   314*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   315* EFFECTIVE    NUMBER
   316*-----------------------------------------------------------------
   317* 060611    2011022800001  PEMA  NEW COPYBOOK
   318* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   319* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   320******************************************************************
   321****************************************
   322*  commarea for NaperSoft On Demand Admin services letters
   323*  (business logic input & output)
   324****************************************
   325     03  BL-INPUT.
   326         05  BL-DATA-SRCE        PIC X.
   327         05  BL-LETTER-ID        PIC XXXX.
   328         05  BL-CARRIER          PIC X.
   329         05  BL-GROUP            PIC X(6).
   330         05  BL-STATE            PIC XX.
   331         05  BL-ACCOUNT          PIC X(10).
   332         05  BL-EFF-DT           PIC X(10).
   333         05  BL-CERT-NO          PIC X(11).
   334         05  BL-BATCH-NO         PIC X(6).
   335         05  BL-BATCH-SEQ        PIC 9(8).
   336         05  BL-RESP-NO          PIC X(10).
   337         05  BL-NO-OF-COPIES     PIC 99.
   338         05  BL-PROC-ID          PIC XXXX.
   339         05  BL-COMP-ID          PIC XXX.
   340         05  BL-PRINT-NOW-SW     PIC X.
   341         05  BL-ENC-CD           PIC XXX.
   342         05  BL-RESEND-DT        PIC X(10).
   343         05  BL-FOLLOW-UP-DT     PIC X(10).
   344         05  BL-ARCHIVE-NO       PIC 9(8).
   345         05  BL-FUNC             PIC X(8).
   346         05  BL-COMMENTS         PIC X(100).
   347         05  FILLER REDEFINES BL-COMMENTS.
   348             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   349             10  BL-LETTER-TO-ACCT PIC X.
   350             10  BL-LETTER-TO-BENE PIC X.
   351             10  BL-WRITE-ERARCH   PIC X.
   352                 88  ERARCH-QWS      VALUE 'Q'.
   353                 88  ERARCH-BATCH    VALUE 'B'.
   354                 88  ERARCH-TEMP     VALUE 'T'.
   355             10  BL-PROCESS-TYPE PIC X(07).
   356             10  BL-CERT-FORM-ID PIC X(05).
   357             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   358             10  BL-SOURCE-SCREEN PIC X(8).
   359             10  FILLER          PIC X(25).
   360     03  BL-OUTPUT.
   361         05  BL-STATUS                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page   8
* NSRASBL.cbl
   362             88  BL-OK                      VALUE "P".
   363             88  BL-FAIL                  VALUE "F".
   364         05  BL-MESSAGE          PIC X(50).
   365     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   366     03  FILLER                  PIC X(31).
   367 01  filler                      pic x(500).
   368 01  WS-SAVE-CARRIER-INFO.
   369     05  WS-PREV-CARRIER         PIC X      VALUE SPACES.
   370     05  WS-CARR-NAME            PIC X(30)  VALUE SPACES.
   371     05  WS-CARR-ICO             PIC X(30)  VALUE SPACES.
   372     05  WS-CARR-ADDR1           PIC X(30)  VALUE SPACES.
   373     05  WS-CARR-ADDR2           PIC X(30)  VALUE SPACES.
   374     05  WS-CARR-CITYST          PIC X(30)  VALUE SPACES.
   375     05  WS-CARR-ZIP             PIC X(9)   VALUE SPACES.
   376     05  WS-CARR-PHONE           PIC X(11)  VALUE SPACES.
   377 01  WS-SAVE-STATE-INFO.
   378     05  WS-PREV-STATE           PIC XX     VALUE SPACES.
   379     05  WS-STATE-NAME           PIC X(25)  VALUE SPACES.
   380 01  WS-SAVE-LFBEN-INFO.
   381     05  WS-PREV-LFBEN           PIC XX     VALUE SPACES.
   382     05  WS-LFBEN-ALPH           PIC XXX    VALUE SPACES.
   383     05  WS-LFBEN-DESC           PIC X(10)  VALUE SPACES.
   384 01  WS-SAVE-AHBEN-INFO.
   385     05  WS-PREV-AHBEN           PIC XX     VALUE SPACES.
   386     05  WS-AHBEN-DESC           PIC X(10)  VALUE SPACES.
   387     05  WS-AHBEN-RET-ELIM       PIC X      VALUE SPACES.
   388     05  WS-AHBEN-DAYS           PIC XX     VALUE SPACES.
   389 01  WS-ERPNDB-KEY.
   390     05  WS-ERPNDB-COMPANY-CD    PIC X.
   391     05  WS-ERPNDB-BATCH-NO      PIC X(6).
   392     05  WS-ERPNDB-BATCH-SEQ     PIC S9(4) COMP  VALUE +0.
   393     05  WS-ERPNDB-CHG-SEQ       PIC S9(4) COMP  VALUE +0.
   394 01  WS-ELENCC-KEY.
   395     05  WS-ELENCC-COMPANY-CD    PIC X.
   396     05  WS-ELENCC-REC-TYPE      PIC X.
   397     05  WS-ELENCC-ENC-CODE      PIC X(5).
   398     05  F                       PIC X(9).
   399 01  WS-ELCERT-KEY.
   400     05  WS-ELCERT-COMPANY-CD    PIC X.
   401     05  WS-ELCERT-CARRIER       PIC X.
   402     05  WS-ELCERT-GROUP         PIC X(6).
   403     05  WS-ELCERT-STATE         PIC XX.
   404     05  WS-ELCERT-ACCOUNT       PIC X(10).
   405     05  WS-ELCERT-EFF-DT        PIC XX.
   406     05  WS-ELCERT-CERT-NO       PIC X(11).
   407 01  WS-ERENDT-KEY.
   408     05  WS-ERENDT-COMPANY-CD    PIC X.
   409     05  WS-ERENDT-CARRIER       PIC X.
   410     05  WS-ERENDT-GROUP         PIC X(6).
   411     05  WS-ERENDT-STATE         PIC XX.
   412     05  WS-ERENDT-ACCOUNT       PIC X(10).
   413     05  WS-ERENDT-EFF-DT        PIC XX.
   414     05  WS-ERENDT-CERT-NO       PIC X(11).
   415     05  WS-ERENDT-REC-TYPE      PIC X.
   416     05  WS-ERENDT-SEQ-NO        PIC 9(4) BINARY.
   417
   418 01  WS-ERENDT-KEY-BY-ARCH.
   419     05  WS-ERENDT-COMPANY-CD-A1 PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page   9
* NSRASBL.cbl
   420     05  WS-ERENDT-ARCHIVE       PIC 9(8) BINARY.
   421 01  WS-ERCOMP-KEY.
   422     05  WS-ERCOMP-COMPANY-CD    PIC X.
   423     05  WS-ERCOMP-CARRIER       PIC X.
   424     05  WS-ERCOMP-GROUP         PIC X(6).
   425     05  WS-ERCOMP-RESP-NO       PIC X(10).
   426     05  WS-ERCOMP-ACCOUNT       PIC X(10).
   427     05  WS-ERCOMP-REC-TYPE      PIC X.
   428 01  WS-ERMAIL-KEY.
   429     05  WS-ERMAIL-COMPANY-CD    PIC X.
   430     05  WS-ERMAIL-CARRIER       PIC X.
   431     05  WS-ERMAIL-GROUP         PIC X(6).
   432     05  WS-ERMAIL-STATE         PIC XX.
   433     05  WS-ERMAIL-ACCOUNT       PIC X(10).
   434     05  WS-ERMAIL-EFF-DT        PIC XX.
   435     05  WS-ERMAIL-CERT-NO       PIC X(11).
   436 01  WS-ERACCT-KEY.
   437     05  WS-ERACCT-COMPANY-CD    PIC X.
   438     05  WS-ERACCT-CARRIER       PIC X.
   439     05  WS-ERACCT-GROUP         PIC X(6).
   440     05  WS-ERACCT-STATE         PIC XX.
   441     05  WS-ERACCT-ACCOUNT       PIC X(10).
   442     05  WS-ERACCT-EXP-DT        PIC XX.
   443     05  FILLER                  PIC XXXX.
   444 01  WS-ELLETR-KEY.
   445     05  WS-ELLETR-COMPANY-CD    PIC X.
   446     05  WS-ELLETR-LETTER-ID     PIC X(12).
   447     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   448 01  WS-ELCNTL-KEY.
   449     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   450     05  WS-ELCNTL-REC-TYPE      PIC X.
   451     05  WS-ELCNTL-GENL.
   452         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   453         10  WS-ELCNTL-BEN-CD.
   454             15  F               PIC X.
   455             15  WS-ELCNTL-CARR  PIC X.
   456     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   457*                                COPY ELCDATE.
   458******************************************************************
   459*                                                                *
   460*                                                                *
   461*                            ELCDATE.                            *
   462*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   463*                            VMOD=2.003
   464*                                                                *
   465*                                                                *
   466*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   467*                 LENGTH = 200                                   *
   468******************************************************************
   469
   470 01  DATE-CONVERSION-DATA.
   471     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   472     12  DC-OPTION-CODE                PIC X.
   473         88  BIN-TO-GREG                VALUE ' '.
   474         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   475         88  EDIT-GREG-TO-BIN           VALUE '2'.
   476         88  YMD-GREG-TO-BIN            VALUE '3'.
   477         88  MDY-GREG-TO-BIN            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  10
* NSRASBL.cbl
   478         88  JULIAN-TO-BIN              VALUE '5'.
   479         88  BIN-PLUS-ELAPSED           VALUE '6'.
   480         88  FIND-CENTURY               VALUE '7'.
   481         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   482         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   483         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   484         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   485         88  JULIAN-TO-BIN-3            VALUE 'C'.
   486         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   487         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   488         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   489         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   490         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   491         88  CHECK-LEAP-YEAR            VALUE 'H'.
   492         88  BIN-3-TO-GREG              VALUE 'I'.
   493         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   494         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   495         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   496         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   497         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   498         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   499         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   500         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   501         88  THREE-CHARACTER-BIN
   502                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   503         88  GREGORIAN-TO-BIN
   504                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   505         88  BIN-TO-GREGORIAN
   506                  VALUES ' ' '1' 'I' '8' 'G'.
   507         88  JULIAN-TO-BINARY
   508                  VALUES '5' 'C' 'E' 'F'.
   509     12  DC-ERROR-CODE                 PIC X.
   510         88  NO-CONVERSION-ERROR        VALUE ' '.
   511         88  DATE-CONVERSION-ERROR
   512                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   513         88  DATE-IS-ZERO               VALUE '1'.
   514         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   515         88  DATE-IS-INVALID            VALUE '3'.
   516         88  DATE1-GREATER-DATE2        VALUE '4'.
   517         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   518         88  DATE-INVALID-OPTION        VALUE '9'.
   519         88  INVALID-CENTURY            VALUE 'A'.
   520         88  ONLY-CENTURY               VALUE 'B'.
   521         88  ONLY-LEAP-YEAR             VALUE 'C'.
   522         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   523     12  DC-END-OF-MONTH               PIC X.
   524         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   525     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   526         88  USE-NORMAL-PROCESS         VALUE ' '.
   527         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   528         88  ADJUST-UP-100-YRS          VALUE '2'.
   529     12  FILLER                        PIC X.
   530     12  DC-CONVERSION-DATES.
   531         16  DC-BIN-DATE-1             PIC XX.
   532         16  DC-BIN-DATE-2             PIC XX.
   533         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   534         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   535                       DC-GREG-DATE-1-EDIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  11
* NSRASBL.cbl
   536             20  DC-EDIT1-MONTH        PIC 99.
   537             20  SLASH1-1              PIC X.
   538             20  DC-EDIT1-DAY          PIC 99.
   539             20  SLASH1-2              PIC X.
   540             20  DC-EDIT1-YEAR         PIC 99.
   541         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   542         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   543                     DC-GREG-DATE-2-EDIT.
   544             20  DC-EDIT2-MONTH        PIC 99.
   545             20  SLASH2-1              PIC X.
   546             20  DC-EDIT2-DAY          PIC 99.
   547             20  SLASH2-2              PIC X.
   548             20  DC-EDIT2-YEAR         PIC 99.
   549         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   550         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   551                     DC-GREG-DATE-1-YMD.
   552             20  DC-YMD-YEAR           PIC 99.
   553             20  DC-YMD-MONTH          PIC 99.
   554             20  DC-YMD-DAY            PIC 99.
   555         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   556         16  DC-GREG-DATE-1-MDY-R REDEFINES
   557                      DC-GREG-DATE-1-MDY.
   558             20  DC-MDY-MONTH          PIC 99.
   559             20  DC-MDY-DAY            PIC 99.
   560             20  DC-MDY-YEAR           PIC 99.
   561         16  DC-GREG-DATE-1-ALPHA.
   562             20  DC-ALPHA-MONTH        PIC X(10).
   563             20  DC-ALPHA-DAY          PIC 99.
   564             20  FILLER                PIC XX.
   565             20  DC-ALPHA-CENTURY.
   566                 24 DC-ALPHA-CEN-N     PIC 99.
   567             20  DC-ALPHA-YEAR         PIC 99.
   568         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   569         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   570         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   571         16  DC-JULIAN-DATE            PIC 9(05).
   572         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   573                                       PIC 9(05).
   574         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   575             20  DC-JULIAN-YEAR        PIC 99.
   576             20  DC-JULIAN-DAYS        PIC 999.
   577         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   578         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   579         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   580     12  DATE-CONVERSION-VARIBLES.
   581         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   582         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   583             20  FILLER                PIC 9(3).
   584             20  HOLD-CEN-1-CCYY.
   585                 24  HOLD-CEN-1-CC     PIC 99.
   586                 24  HOLD-CEN-1-YY     PIC 99.
   587             20  HOLD-CEN-1-MO         PIC 99.
   588             20  HOLD-CEN-1-DA         PIC 99.
   589         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   590             20  HOLD-CEN-1-R-MO       PIC 99.
   591             20  HOLD-CEN-1-R-DA       PIC 99.
   592             20  HOLD-CEN-1-R-CCYY.
   593                 24  HOLD-CEN-1-R-CC   PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  12
* NSRASBL.cbl
   594                 24  HOLD-CEN-1-R-YY   PIC 99.
   595             20  FILLER                PIC 9(3).
   596         16  HOLD-CENTURY-1-X.
   597             20  FILLER                PIC X(3)  VALUE SPACES.
   598             20  HOLD-CEN-1-X-CCYY.
   599                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   600                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   601             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   602             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   603         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   604             20  HOLD-CEN-1-R-X-MO     PIC XX.
   605             20  HOLD-CEN-1-R-X-DA     PIC XX.
   606             20  HOLD-CEN-1-R-X-CCYY.
   607                 24  HOLD-CEN-1-R-X-CC PIC XX.
   608                 24  HOLD-CEN-1-R-X-YY PIC XX.
   609             20  FILLER                PIC XXX.
   610         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   611         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   612         16  DC-JULIAN-DATE-1          PIC 9(07).
   613         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   614             20  DC-JULIAN-1-CCYY.
   615                 24  DC-JULIAN-1-CC    PIC 99.
   616                 24  DC-JULIAN-1-YR    PIC 99.
   617             20  DC-JULIAN-DA-1        PIC 999.
   618         16  DC-JULIAN-DATE-2          PIC 9(07).
   619         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   620             20  DC-JULIAN-2-CCYY.
   621                 24  DC-JULIAN-2-CC    PIC 99.
   622                 24  DC-JULIAN-2-YR    PIC 99.
   623             20  DC-JULIAN-DA-2        PIC 999.
   624         16  DC-GREG-DATE-A-EDIT.
   625             20  DC-EDITA-MONTH        PIC 99.
   626             20  SLASHA-1              PIC X VALUE '/'.
   627             20  DC-EDITA-DAY          PIC 99.
   628             20  SLASHA-2              PIC X VALUE '/'.
   629             20  DC-EDITA-CCYY.
   630                 24  DC-EDITA-CENT     PIC 99.
   631                 24  DC-EDITA-YEAR     PIC 99.
   632         16  DC-GREG-DATE-B-EDIT.
   633             20  DC-EDITB-MONTH        PIC 99.
   634             20  SLASHB-1              PIC X VALUE '/'.
   635             20  DC-EDITB-DAY          PIC 99.
   636             20  SLASHB-2              PIC X VALUE '/'.
   637             20  DC-EDITB-CCYY.
   638                 24  DC-EDITB-CENT     PIC 99.
   639                 24  DC-EDITB-YEAR     PIC 99.
   640         16  DC-GREG-DATE-CYMD         PIC 9(08).
   641         16  DC-GREG-DATE-CYMD-R REDEFINES
   642                              DC-GREG-DATE-CYMD.
   643             20  DC-CYMD-CEN           PIC 99.
   644             20  DC-CYMD-YEAR          PIC 99.
   645             20  DC-CYMD-MONTH         PIC 99.
   646             20  DC-CYMD-DAY           PIC 99.
   647         16  DC-GREG-DATE-MDCY         PIC 9(08).
   648         16  DC-GREG-DATE-MDCY-R REDEFINES
   649                              DC-GREG-DATE-MDCY.
   650             20  DC-MDCY-MONTH         PIC 99.
   651             20  DC-MDCY-DAY           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  13
* NSRASBL.cbl
   652             20  DC-MDCY-CEN           PIC 99.
   653             20  DC-MDCY-YEAR          PIC 99.
   654    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   655        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   656    12  DC-EL310-DATE                  PIC X(21).
   657    12  FILLER                         PIC X(28).
   658*                                COPY NSCASEXTR.
   659******************************************************************
   660*                                                                *
   661*                                                                *
   662*                            NSCASEXTR.                          *
   663*                            VMOD=2.001                          *
   664*                                                                *
   665*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   666*                                                                *
   667*   FILE TYPE = VSAM,KSDS                                        *
   668*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   669*                                                                *
   670*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   671*                                                                *
   672*   LOG = NO                                                     *
   673*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   674******************************************************************
   675*-----------------------------------------------------------------
   676*                   C H A N G E   L O G
   677*
   678* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   679*-----------------------------------------------------------------
   680*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   681* EFFECTIVE    NUMBER
   682*-----------------------------------------------------------------
   683* 072211    2011022800001  PEMA  NEW FILE
   684*-----------------------------------------------------------------
   685 01 NSAS-EXTRACT-RECORD.
   686    05  NSAS-CONTROL-PRIMARY.
   687        10  NSAS-COMPANY-CD      PIC X.
   688        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   689        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   690    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   691    05  FILLER                   PIC X(143).
   692*                                COPY ERCPNDB.
   693******************************************************************
   694*                                                                *
   695*                                                                *
   696*                            ERCPNDB.                            *
   697*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   698*                            VMOD=2.025                          *
   699*                                                                *
   700*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   701*                                                                *
   702******************************************************************
   703*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   704*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   705******************************************************************
   706*                                                                *
   707*                                                                *
   708*   FILE TYPE = VSAM,KSDS                                        *
   709*   RECORD SIZE = 585  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  14
* NSRASBL.cbl
   710*                                                                *
   711*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   712*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   713*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   714*                                                 RKP=13,LEN=36  *
   715*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   716*                                      AND CHG-SEQ.)             *
   717*                                                RKP=49,LEN=11   *
   718*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   719*                                      AND CHG-SEQ.)             *
   720*                                                RKP=60,LEN=15   *
   721*                                                                *
   722*   LOG = NO                                                     *
   723*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   724******************************************************************
   725******************************************************************
   726*                   C H A N G E   L O G
   727*
   728* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   729*-----------------------------------------------------------------
   730*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   731* EFFECTIVE    NUMBER
   732*-----------------------------------------------------------------
   733* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   734* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   735* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   736* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   737* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   738* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   739* 032306                   PEMA  ADD BOW LOAN NUMBER
   740* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   741* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   742* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   743* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   744* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   745* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   746* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   747* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   748******************************************************************
   749
   750 01  PENDING-BUSINESS.
   751     12  PB-RECORD-ID                     PIC XX.
   752         88  VALID-PB-ID                        VALUE 'PB'.
   753
   754     12  PB-CONTROL-PRIMARY.
   755         16  PB-COMPANY-CD                PIC X.
   756         16  PB-ENTRY-BATCH               PIC X(6).
   757         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   758         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   759
   760     12  PB-CONTROL-BY-ACCOUNT.
   761         16  PB-COMPANY-CD-A1             PIC X.
   762         16  PB-CARRIER                   PIC X.
   763         16  PB-GROUPING.
   764             20  PB-GROUPING-PREFIX       PIC XXX.
   765             20  PB-GROUPING-PRIME        PIC XXX.
   766         16  PB-STATE                     PIC XX.
   767         16  PB-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  15
* NSRASBL.cbl
   768             20  PB-ACCOUNT-PREFIX        PIC X(4).
   769             20  PB-ACCOUNT-PRIME         PIC X(6).
   770         16  PB-CERT-EFF-DT               PIC XX.
   771         16  PB-CERT-NO.
   772             20  PB-CERT-PRIME            PIC X(10).
   773             20  PB-CERT-SFX              PIC X.
   774         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   775
   776         16  PB-RECORD-TYPE               PIC X.
   777             88  PB-MAILING-DATA                VALUE '0'.
   778             88  PB-ISSUE                       VALUE '1'.
   779             88  PB-CANCELLATION                VALUE '2'.
   780             88  PB-BATCH-TRAILER               VALUE '9'.
   781
   782     12  PB-CONTROL-BY-ORIG-BATCH.
   783         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   784         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   785         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   786         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   787
   788     12  PB-CONTROL-BY-CSR.
   789         16  PB-CSR-COMPANY-CD            PIC X.
   790         16  PB-CSR-ID                    PIC X(4).
   791         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   792         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   793         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   794******************************************************************
   795*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   796******************************************************************
   797
   798     12  PB-LAST-MAINT-DT                 PIC XX.
   799     12  PB-LAST-MAINT-BY                 PIC X(4).
   800     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   801
   802     12  PB-RECORD-BODY                   PIC X(375).
   803
   804     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   805         16  PB-CERT-ORIGIN               PIC X.
   806             88  CLASIC-CREATED-CERT         VALUE '1'.
   807         16  PB-I-NAME.
   808             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   809             20  PB-I-INSURED-FIRST-NAME.
   810                 24  PB-I-INSURED-1ST-INIT PIC X.
   811                 24  FILLER                PIC X(9).
   812             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   813         16  PB-I-AGE                     PIC S99   COMP-3.
   814         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   815         16  PB-I-BIRTHDAY                PIC XX.
   816         16  PB-I-INSURED-SEX             PIC X.
   817             88  PB-SEX-MALE     VALUE 'M'.
   818             88  PB-SEX-FEMALE   VALUE 'F'.
   819
   820         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   821         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   822         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   823         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   824         16  PB-I-SKIP-CODE               PIC X.
   825             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  16
* NSRASBL.cbl
   826             88  PB-SKIP-JULY              VALUE '1'.
   827             88  PB-SKIP-AUGUST            VALUE '2'.
   828             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   829             88  PB-SKIP-JULY-AUG          VALUE '4'.
   830             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   831             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   832             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   833             88  PB-SKIP-JUNE              VALUE '8'.
   834             88  PB-SKIP-JUNE-JULY         VALUE '9'.
   835             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   836             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   837         16  PB-I-TERM-TYPE               PIC X.
   838             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   839             88  PB-PAID-WEEKLY            VALUE 'W'.
   840             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   841             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
   842             88  PB-PAID-13-YEARLY         VALUE 'T'.
   843         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   844         16  PB-I-POLICY-FORM-NO          PIC X(12).
   845         16  PB-I-DATA-ENTRY-SW           PIC X.
   846             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   847             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   848             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   849             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   850         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   851         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   852*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   853         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   854         16  FILLER                       PIC X.
   855
   856         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   857             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   858             88  PB-INVALID-LIFE             VALUE '  ' '00'
   859                                                   '90' THRU '99'.
   860         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   861                                          PIC XX.
   862         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   863         16  PB-I-AMOUNT-FINANCED REDEFINES
   864                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   865         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   866         16  PB-I-UNPAID-CASH-PRICE REDEFINES
   867                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
   868         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   869         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   870         16  PB-I-CLP-AMOUNT REDEFINES
   871                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
   872         16  PB-I-LF-CALC-FLAG            PIC X.
   873             88 PB-COMP-LF-PREM               VALUE '?'.
   874         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   875         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   876         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   877         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   878         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
   879         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   880         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
   881         16  PB-I-LF-ABBR                 PIC XXX.
   882         16  PB-I-LF-INPUT-CD             PIC XX.
   883
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  17
* NSRASBL.cbl
   884         16  PB-I-AH-BENEFIT-CD           PIC XX.
   885             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   886             88  PB-INVALID-AH               VALUE '  ' '00'
   887                                                   '90' THRU '99'.
   888         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   889         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   890         16  PB-I-AH-CALC-FLAG            PIC X.
   891             88 PB-COMP-AH-PREM                  VALUE '?'.
   892         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
   893         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   894         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
   895         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   896         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   897         16  PB-I-AH-ABBR                 PIC XXX.
   898         16  PB-I-AH-INPUT-CD             PIC XXX.
   899
   900         16  PB-I-SPECIAL-REIN-CODE       PIC X.
   901         16  PB-I-REIN-TABLE              PIC XXX.
   902         16  PB-I-BUSINESS-TYPE           PIC 99.
   903         16  PB-I-INDV-GRP-CD             PIC X.
   904         16  PB-I-MORT-CODE.
   905             20  PB-I-TABLE               PIC X.
   906             20  PB-I-INTEREST            PIC XX.
   907             20  PB-I-MORT-TYP            PIC X.
   908         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   909         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   910         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   911         16  PB-I-INDV-GRP-OVRD           PIC X.
   912         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   913         16  PB-I-SIG-SW                  PIC X.
   914             88  PB-POLICY-SIGNED             VALUE 'Y'.
   915         16  PB-I-RATE-CLASS              PIC XX.
   916         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   917         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
   918         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   919         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   920         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   921         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   922         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   923         16  PB-I-BENEFIT-TYPE            PIC XXX.
   924         16  PB-I-OB-FLAG                 PIC X.
   925             88  PB-I-OB                      VALUE 'B'.
   926             88  PB-I-SUMMARY                 VALUE 'Z'.
   927         16  PB-I-ENTRY-STATUS            PIC X.
   928             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   929                                              'M' '5' '9' '2'.
   930             88  PB-I-NORMAL-ENTRY            VALUE '1'.
   931             88  PB-I-POLICY-PENDING          VALUE '2'.
   932             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   933             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   934             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   935             88  PB-I-REIN-ONLY               VALUE '9'.
   936             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
   937             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   938             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
   939             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   940         16  PB-I-INT-CODE                PIC X.
   941             88  PB-ADD-ON-INTEREST           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  18
* NSRASBL.cbl
   942             88  PB-SIMPLE-INTEREST           VALUE 'S'.
   943         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   944         16  PB-I-SOC-SEC-NO              PIC X(11).
   945         16  PB-I-MEMBER-NO               PIC X(12).
   946         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
   947*        16  PB-I-LOAN-OFFICER            PIC XXX.
   948         16  PB-I-OLD-LOF                 PIC XXX.
   949         16  PB-I-LF-EXPIRE-DT            PIC XX.
   950         16  PB-I-AH-EXPIRE-DT            PIC XX.
   951         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   952         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   953         16  PB-I-LIFE-INDICATOR          PIC X.
   954             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   955         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   956         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
   957                                          PIC S9(5)V99    COMP-3.
   958         16  PB-I-MAIL-ADDRS-SW           PIC X.
   959             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   960             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   961         16  PB-I-1ST-PMT-DT              PIC XX.
   962         16  PB-I-JOINT-INSURED.
   963             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   964             20 PB-I-JOINT-FIRST-NAME.
   965                24  PB-I-JOINT-FIRST-INIT PIC X.
   966                24  FILLER                PIC X(9).
   967             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   968*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   969         16  PB-I-BENEFICIARY-NAME.
   970             20  PB-I-BANK-NUMBER         PIC X(10).
   971             20  FILLER                   PIC X(15).
   972         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   973         16  PB-I-REFERENCE               PIC X(12).
   974         16  FILLER REDEFINES PB-I-REFERENCE.
   975             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   976             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   977             20  PB-I-CLP-STATE           PIC XX.
   978         16  PB-I-UNDERWRITING-STATUS     PIC X.
   979             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   980             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   981             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   982         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
   983         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
   984         16  PB-I-RESIDENT-STATE          PIC XX.
   985         16  PB-I-RATE-CODE               PIC X(4).
   986         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
   987         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   988         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   989         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
   990         16  PB-I-BANK-NOCHRGB            PIC 99.
   991         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
   992         16  PB-I-JOINT-BIRTHDAY          PIC XX.
   993
   994     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
   995         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
   996             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
   997         16  PB-C-CANCEL-ORIGIN           PIC X.
   998             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
   999         16  PB-C-LF-CANCEL-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  19
* NSRASBL.cbl
  1000         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1001         16  PB-C-LF-CALC-REQ             PIC X.
  1002             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1003         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1004         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  1005         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1006             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1007         16  PB-C-AH-CANCEL-DT            PIC XX.
  1008         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1009         16  PB-C-AH-CALC-REQ             PIC X.
  1010             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1011         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1012         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1013         16  PB-C-LAST-NAME               PIC X(15).
  1014         16  PB-C-REFUND-SW               PIC X.
  1015             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1016             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1017         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1018         16  PB-C-PAYEE-CODE              PIC X(6).
  1019         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1020         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1021         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1022         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1023         16  PB-C-REFERENCE               PIC X(12).
  1024         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1025         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1026         16  PB-C-POST-CARD-IND           PIC X.
  1027         16  PB-C-CANCEL-REASON           PIC X.
  1028         16  PB-C-REF-INTERFACE-SW        PIC X.
  1029         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1030         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1031         16  FILLER                       PIC X(01).
  1032*        16  FILLER                       PIC X(18).
  1033         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1034*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1035         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  1036         16  PB-CANCELED-CERT-DATA.
  1037             20  PB-CI-INSURED-NAME.
  1038                 24  PB-CI-LAST-NAME      PIC X(15).
  1039                 24  PB-CI-INITIALS       PIC XX.
  1040             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  1041             20  PB-CI-INSURED-SEX        PIC X.
  1042             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1043             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1044             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1045             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1046             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1047             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  1048             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1049             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1050             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1051             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1052             20  PB-CI-RATE-CLASS         PIC XX.
  1053             20  PB-CI-RATE-DEV-LF        PIC XXX.
  1054             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1055             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1056             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1057             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  20
* NSRASBL.cbl
  1058             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  1059             20  PB-CI-LF-ABBR            PIC X(3).
  1060             20  PB-CI-AH-ABBR            PIC X(3).
  1061             20  PB-CI-OB-FLAG            PIC X.
  1062                 88  PB-CI-OB                VALUE 'B'.
  1063             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1064                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1065                                           'M' '4' '5' '9' '2'.
  1066                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1067                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1068                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1069                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1070                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1071                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1072                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1073                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1074                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1075                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1076                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1077                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1078             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1079                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1080                                           'M' '4' '5' '9' '2'.
  1081                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1082                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1083                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1084                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1085                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1086                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1087                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1088                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1089                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1090                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1091                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1092                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1093             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1094             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1095             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1096             20  PB-CI-MEMBER-NO          PIC X(12).
  1097             20  PB-CI-INT-CODE           PIC X.
  1098                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1099                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1100             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1101             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1102             20  PB-CI-COMP-EXCP-SW       PIC X.
  1103                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1104                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1105             20  PB-CI-ENTRY-STATUS       PIC X.
  1106             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1107             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1108             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1109             20  PB-CI-DEATH-DT           PIC XX.
  1110             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1111             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1112             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1113             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1114             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1115             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  21
* NSRASBL.cbl
  1116             20  PB-CI-ENTRY-DT              PIC XX.
  1117             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1118             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1119             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1120             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1121             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1122             20  PB-CI-OLD-LOF               PIC XXX.
  1123*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1124             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1125             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1126             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1127             20  PB-CI-INDV-GRP-CD           PIC X.
  1128             20  PB-CI-BENEFICIARY-NAME.
  1129                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1130                 24  FILLER                  PIC X(15).
  1131             20  PB-CI-NOTE-SW               PIC X.
  1132             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1133             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1134             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1135             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1136             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1137             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1138             20  PB-CI-FIRST-NAME            PIC X(10).
  1139             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1140
  1141         16  FILLER                       PIC X(13).
  1142*032306  16  FILLER                       PIC X(27).
  1143*        16  FILLER                       PIC X(46).
  1144
  1145     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1146         16  FILLER                       PIC X(10).
  1147         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1148         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1149         16  PB-M-INSURED-MID-INIT        PIC X.
  1150         16  PB-M-INSURED-AGE             PIC 99.
  1151         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1152         16  PB-M-INSURED-SEX             PIC X.
  1153         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1154         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1155         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1156         16  PB-M-INSURED-CITY-STATE.
  1157             20  PB-M-INSURED-CITY        PIC X(28).
  1158             20  PB-M-INSURED-STATE       PIC XX.
  1159         16  PB-M-INSURED-ZIP-CODE.
  1160             20  PB-M-INSURED-ZIP-PRIME.
  1161                 24  PB-M-INSURED-ZIP-1   PIC X.
  1162                     88  PB-M-CANADIAN-POST-CODE
  1163                                             VALUE 'A' THRU 'Z'.
  1164                 24  FILLER               PIC X(4).
  1165             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1166         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1167                                        PB-M-INSURED-ZIP-CODE.
  1168             20  PM-M-INS-CAN-POST1       PIC XXX.
  1169             20  PM-M-INS-CAN-POST2       PIC XXX.
  1170             20  FILLER                   PIC XXX.
  1171         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1172         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1173         16  PB-M-CRED-BENE-NAME          PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  22
* NSRASBL.cbl
  1174         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1175         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1176         16  PB-M-CRED-BENE-CITYST.
  1177             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1178             20  PB-M-CRED-BENE-STATE     PIC XX.
  1179         16  FILLER                       PIC X(92).
  1180
  1181     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1182         16  FILLER                       PIC X(10).
  1183         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1184         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1185         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1186         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1187         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1188         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1189         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1190         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1191         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1192         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1193         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1194         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1195         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1196         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1197         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1198         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1199         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1200         16  PB-ACCOUNT-NAME              PIC X(30).
  1201         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1202         16  PB-REFERENCE                 PIC X(12).
  1203         16  PB-B-RECEIVED-DT             PIC XX.
  1204         16  FILLER                       PIC X(234).
  1205
  1206     12  PB-RECORD-STATUS.
  1207         16  PB-CREDIT-SELECT-DT          PIC XX.
  1208         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  1209         16  PB-BILLED-DT                 PIC XX.
  1210         16  PB-BILLING-STATUS            PIC X.
  1211             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1212             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1213             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1214         16  PB-RECORD-BILL               PIC X.
  1215             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1216             88  PB-RECORD-RETURNED           VALUE 'R'.
  1217             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1218             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1219             88  PB-OVERRIDE-AH               VALUE 'A'.
  1220             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1221         16  PB-BATCH-ENTRY               PIC X.
  1222             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1223             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1224             88  PB-REISSUED-CERT             VALUE 'E'.
  1225             88  PB-MONTHLY-CERT              VALUE 'M'.
  1226             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1227             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1228             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1229         16  PB-FORCE-CODE                PIC X.
  1230             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1231             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  23
* NSRASBL.cbl
  1232             88  PB-CANCEL-FORCE              VALUE '8'.
  1233             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1234             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1235             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1236             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1237             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1238             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1239             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1240         16  PB-FATAL-FLAG                PIC X.
  1241             88  PB-FATAL-ERRORS              VALUE 'X'.
  1242         16  PB-FORCE-ER-CD               PIC X.
  1243             88  PB-FORCE-ERRORS              VALUE 'F'.
  1244             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1245         16  PB-WARN-ER-CD                PIC X.
  1246             88  PB-WARNING-ERRORS            VALUE 'W'.
  1247         16  FILLER                       PIC X.
  1248         16  PB-OUT-BAL-CD                PIC X.
  1249             88  PB-OUT-OF-BAL                VALUE 'O'.
  1250         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1251         16  PB-AH-OVERRIDE-L1            PIC X.
  1252         16  PB-INPUT-DT                  PIC XX.
  1253         16  PB-INPUT-BY                  PIC X(4).
  1254         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1255         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1256         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1257         16  PB-LF-EARNING-METHOD         PIC X.
  1258         16  PB-AH-EARNING-METHOD         PIC X.
  1259         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1260         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1261         16  PB-REIN-CD                   PIC XXX.
  1262         16  PB-LF-REFUND-TYPE            PIC X.
  1263         16  PB-AH-REFUND-TYPE            PIC X.
  1264         16  PB-ACCT-EFF-DT               PIC XX.
  1265         16  PB-ACCT-EXP-DT               PIC XX.
  1266         16  PB-COMPANY-ID                PIC X(3).
  1267         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1268         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1269         16  PB-SV-CARRIER                PIC X.
  1270         16  PB-SV-GROUPING               PIC X(6).
  1271         16  PB-SV-STATE                  PIC XX.
  1272         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1273         16  PB-GA-BILLING-INFO.
  1274             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1275                                          PIC XX.
  1276         16  PB-SV-REMIT-TO  REDEFINES
  1277             PB-GA-BILLING-INFO           PIC X(10).
  1278         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1279         16  PB-I-LOAN-OFFICER            PIC X(5).
  1280         16  PB-I-VIN                     PIC X(17).
  1281
  1282         16  FILLER                       PIC X(04).
  1283         16  IMNET-BYPASS-SW              PIC X.
  1284
  1285******************************************************************
  1286*                COMMON EDIT ERRORS                              *
  1287******************************************************************
  1288
  1289     12  PB-COMMON-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  24
* NSRASBL.cbl
  1290         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1291                                           PIC S9(4)     COMP.
  1292
  1293******************************************************************
  1294*                                COPY ERCENDT.
  1295******************************************************************
  1296*                                                                *
  1297*                                                                *
  1298*                            ERCENDT.                            *
  1299*                            VMOD=2.001                          *
  1300*                                                                *
  1301*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1302*                                                                *
  1303*   FILE TYPE = VSAM,KSDS                                        *
  1304*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1305*                                                                *
  1306*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1307*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1308*                                                                *
  1309*   LOG = NO                                                     *
  1310*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1311******************************************************************
  1312*-----------------------------------------------------------------
  1313*                   C H A N G E   L O G
  1314*
  1315* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1316*-----------------------------------------------------------------
  1317*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1318* EFFECTIVE    NUMBER
  1319*-----------------------------------------------------------------
  1320* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1321*                                WITH OPEN CLAIMS
  1322* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1323* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1324*-----------------------------------------------------------------
  1325 01  ENDORSEMENT-RECORD.
  1326     12  EN-RECORD-ID                PIC XX.
  1327         88  VALID-EN-ID                VALUE 'EN'.
  1328     12  EN-CONTROL-PRIMARY.
  1329         16  EN-COMPANY-CD           PIC X.
  1330         16  EN-CARRIER              PIC X.
  1331         16  EN-GROUPING             PIC X(6).
  1332         16  EN-STATE                PIC XX.
  1333         16  EN-ACCOUNT              PIC X(10).
  1334         16  EN-CERT-EFF-DT          PIC XX.
  1335         16  EN-CERT-NO.
  1336             20  EN-CERT-PRIME       PIC X(10).
  1337             20  EN-CERT-SFX         PIC X.
  1338         16  EN-REC-TYPE             PIC X.
  1339             88  EN-ISSUE               VALUE 'I'.
  1340             88  EN-CANCELLATION        VALUE 'C'.
  1341         16  EN-SEQ-NO               PIC 9(04) BINARY.
  1342     12  EN-CONTROL-BY-ARCH-NO.
  1343         16  EN-COMPANY-CD-A1              PIC X.
  1344         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  1345     12  EN-LAST-MAINT-DT            PIC XX.
  1346     12  EN-LAST-MAINT-BY            PIC X(4).
  1347     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  25
* NSRASBL.cbl
  1348     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  1349     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1350         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  1351         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  1352         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  1353         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  1354         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  1355         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  1356         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  1357         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  1358         16  EN-LF-ORIG-BENCD        PIC XX.
  1359         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  1360         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1361         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1362         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1363         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1364         16  EN-LF-ORIG-EXP-DT       PIC XX.
  1365*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1366         16  EN-ORIG-CRED-BENE       PIC X(25).
  1367         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1368         16  FILLER                  PIC X.
  1369         16  EN-AH-ORIG-BENCD        PIC XX.
  1370         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  1371         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1372         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1373         16  EN-AH-ORIG-EXP-DT       PIC XX.
  1374*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1375*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1376         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1377         16  F                       PIC X(09).
  1378         16  EN-AH-ORIG-CP           PIC 99.
  1379         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  1380         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  1381         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  1382         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  1383         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  1384         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  1385         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  1386         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  1387         16  EN-LF-NEW-BENCD         PIC XX.
  1388         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  1389         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1390         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1391         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1392         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1393         16  EN-LF-NEW-EXP-DT        PIC XX.
  1394         16  EN-NEW-CRED-BENE        PIC X(25).
  1395         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1396         16  FILLER                  PIC X.
  1397         16  EN-AH-NEW-BENCD         PIC XX.
  1398         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  1399         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1400         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1401         16  EN-AH-NEW-EXP-DT        PIC XX.
  1402*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1403*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1404*        16  F                       PIC X(12).
  1405         16  EN-AH-NEW-CP            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  26
* NSRASBL.cbl
  1406         16  EN-SIG-SW               PIC X.
  1407         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1408         16  FILLER                  PIC X(37).
  1409     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1410         16  EN-LF-ORIG-REF-DT       PIC XX.
  1411         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1412         16  EN-AH-ORIG-REF-DT       PIC XX.
  1413         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1414         16  EN-LF-NEW-REF-DT        PIC XX.
  1415         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1416         16  EN-AH-NEW-REF-DT        PIC XX.
  1417         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1418         16  EN-FLAG-CERT            PIC X.
  1419         16  EN-INS-LAST-NAME        PIC X(15).
  1420         16  EN-INS-FIRST-NAME       PIC X(10).
  1421         16  EN-INS-MIDDLE-INIT      PIC X.
  1422         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1423         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1424         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1425         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1426         16  FILLER                  PIC X(262).
  1427     12  EN-MONEY-SW             PIC X.
  1428     12  EN-HEALTH-APP           PIC X.
  1429     12  EN-VOUCHER-SW           PIC X.
  1430     12  EN-PAYEE                PIC X(14).
  1431     12  EN-INPUT-DT             PIC XX.
  1432     12  EN-PROCESS-DT           PIC XX.
  1433     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1434     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1435     12  EN-REASON-CODES.
  1436         16  F OCCURS 12.
  1437             20  EN-REASON-CODE  PIC X(4).
  1438     12  EN-TEMPLATE-USED        PIC X(8).
  1439     12  EN-DOCU-TYPE            PIC X.
  1440         88  EN-VERI-DOCU          VALUE 'V'.
  1441         88  EN-GCE-DOCU           VALUE 'G'.
  1442         88  EN-CANC-DOCU          VALUE 'C'.
  1443     12  EN-COMMENTS1            PIC X(13).
  1444     12  EN-COMMENTS2            PIC X(70).
  1445     12  EN-COMM-CHGBK           PIC X.
  1446         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  1447         88  EN-CHG-ACCT           VALUE 'Y'.
  1448     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  1449     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  1450     12  EN-BATCH-NUMBER         PIC X(6).
  1451     12  EN-ACCT-SUMM            PIC X.
  1452     12  EN-CSO-SUMM             PIC X.
  1453     12  FILLER                  PIC X(13).
  1454******************************************************************
  1455*                                COPY ERCMAIL.
  1456******************************************************************
  1457*                                                                *
  1458*                                                                *
  1459*                            ERCMAIL                             *
  1460*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1461*                            VMOD=2.003                          *
  1462*                                                                *
  1463*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  27
* NSRASBL.cbl
  1464*                                                                *
  1465*   FILE TYPE = VSAM,KSDS                                        *
  1466*   RECORD SIZE = 374   RECFORM = FIX                            *
  1467*                                                                *
  1468*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1469*   ALTERNATE PATH    = NOT USED                                 *
  1470*                                                                *
  1471*   LOG = YES                                                    *
  1472*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1473******************************************************************
  1474*                   C H A N G E   L O G
  1475*
  1476* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1477*-----------------------------------------------------------------
  1478*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1479* EFFECTIVE    NUMBER
  1480*-----------------------------------------------------------------
  1481* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1482* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1483* 111108                   PEMA  ADD CRED BENE ADDR2
  1484******************************************************************
  1485
  1486 01  MAILING-DATA.
  1487     12  MA-RECORD-ID                      PIC XX.
  1488         88  VALID-MA-ID                       VALUE 'MA'.
  1489
  1490     12  MA-CONTROL-PRIMARY.
  1491         16  MA-COMPANY-CD                 PIC X.
  1492         16  MA-CARRIER                    PIC X.
  1493         16  MA-GROUPING.
  1494             20  MA-GROUPING-PREFIX        PIC XXX.
  1495             20  MA-GROUPING-PRIME         PIC XXX.
  1496         16  MA-STATE                      PIC XX.
  1497         16  MA-ACCOUNT.
  1498             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1499             20  MA-ACCOUNT-PRIME          PIC X(6).
  1500         16  MA-CERT-EFF-DT                PIC XX.
  1501         16  MA-CERT-NO.
  1502             20  MA-CERT-PRIME             PIC X(10).
  1503             20  MA-CERT-SFX               PIC X.
  1504
  1505     12  FILLER                            PIC XX.
  1506
  1507     12  MA-ACCESS-CONTROL.
  1508         16  MA-SOURCE-SYSTEM              PIC XX.
  1509             88  MA-FROM-CREDIT                VALUE 'CR'.
  1510             88  MA-FROM-VSI                   VALUE 'VS'.
  1511             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1512             88  MA-FROM-OTHER                 VALUE 'OT'.
  1513         16  MA-RECORD-ADD-DT              PIC XX.
  1514         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1515         16  MA-LAST-MAINT-DT              PIC XX.
  1516         16  MA-LAST-MAINT-BY              PIC XXXX.
  1517         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1518
  1519     12  MA-PROFILE-INFO.
  1520         16  MA-QUALIFY-CODE-1             PIC XX.
  1521         16  MA-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  28
* NSRASBL.cbl
  1522         16  MA-QUALIFY-CODE-3             PIC XX.
  1523         16  MA-QUALIFY-CODE-4             PIC XX.
  1524         16  MA-QUALIFY-CODE-5             PIC XX.
  1525
  1526         16  MA-INSURED-LAST-NAME          PIC X(15).
  1527         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1528         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1529         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1530         16  MA-INSURED-BIRTH-DT           PIC XX.
  1531         16  MA-INSURED-SEX                PIC X.
  1532             88  MA-SEX-MALE                   VALUE 'M'.
  1533             88  MA-SEX-FEMALE                 VALUE 'F'.
  1534         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1535
  1536         16  MA-ADDRESS-CORRECTED          PIC X.
  1537         16  MA-JOINT-BIRTH-DT             PIC XX.
  1538*        16  FILLER                        PIC X(12).
  1539
  1540         16  MA-ADDRESS-LINE-1             PIC X(30).
  1541         16  MA-ADDRESS-LINE-2             PIC X(30).
  1542         16  MA-CITY-STATE.
  1543             20  MA-CITY                   PIC X(28).
  1544             20  MA-ADDR-STATE             PIC XX.
  1545         16  MA-ZIP.
  1546             20  MA-ZIP-CODE.
  1547                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1548                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1549                 24  FILLER                PIC X(4).
  1550             20  MA-ZIP-PLUS4              PIC X(4).
  1551         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1552             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1553             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1554             20  FILLER                    PIC X(3).
  1555
  1556         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1557
  1558         16  FILLER                        PIC XXX.
  1559*        16  FILLER                        PIC X(10).
  1560
  1561     12  MA-CRED-BENE-INFO.
  1562         16  MA-CRED-BENE-NAME                 PIC X(25).
  1563         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1564         16  MA-CRED-BENE-ADDR2                PIC X(30).
  1565         16  MA-CRED-BENE-CTYST.
  1566             20  MA-CRED-BENE-CITY             PIC X(28).
  1567             20  MA-CRED-BENE-STATE            PIC XX.
  1568         16  MA-CRED-BENE-ZIP.
  1569             20  MA-CB-ZIP-CODE.
  1570                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1571                     88  MA-CB-CANADIAN-POST-CODE
  1572                                           VALUE 'A' THRU 'Z'.
  1573                 24  FILLER                    PIC X(4).
  1574             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1575         16  MA-CB-CANADIAN-POSTAL-CODE
  1576                            REDEFINES MA-CRED-BENE-ZIP.
  1577             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1578             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1579             20  FILLER                        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  29
* NSRASBL.cbl
  1580     12  MA-POST-CARD-MAIL-DATA.
  1581         16  MA-MAIL-DATA OCCURS 7.
  1582             20  MA-MAIL-TYPE              PIC X.
  1583                 88  MA-12MO-MAILING           VALUE '1'.
  1584                 88  MA-EXP-MAILING            VALUE '2'.
  1585             20  MA-MAIL-STATUS            PIC X.
  1586                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1587                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1588                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1589             20  MA-MAIL-DATE              PIC XX.
  1590     12  FILLER                            PIC XX.
  1591     12  FILLER                            PIC XX.
  1592*    12  FILLER                            PIC X(30).
  1593******************************************************************
  1594*                                COPY ERCCOMP.
  1595******************************************************************
  1596*                                                                *
  1597*                                                                *
  1598*                            ERCCOMP                             *
  1599*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1600*                            VMOD=2.019                          *
  1601*                                                                *
  1602*   ONLINE CREDIT SYSTEM                                         *
  1603*                                                                *
  1604*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1605*                                                                *
  1606*   FILE TYPE = VSAM,KSDS                                        *
  1607*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1608*                                                                *
  1609*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1610*       ALTERNATE PATH = NONE                                    *
  1611*                                                                *
  1612*   LOG = NO                                                     *
  1613*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1614*                                                                *
  1615******************************************************************
  1616*                   C H A N G E   L O G
  1617*
  1618* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1619*-----------------------------------------------------------------
  1620*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1621* EFFECTIVE    NUMBER
  1622*-----------------------------------------------------------------
  1623* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1624* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1625* 092205    2005050300006  PEMA  ADD LEASE FEE
  1626* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1627* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1628* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1629* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1630* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1631* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1632******************************************************************
  1633
  1634 01  COMPENSATION-MASTER.
  1635     12  CO-RECORD-ID                          PIC XX.
  1636         88  VALID-CO-ID                          VALUE 'CO'.
  1637
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  30
* NSRASBL.cbl
  1638     12  CO-CONTROL-PRIMARY.
  1639         16  CO-COMPANY-CD                     PIC X.
  1640         16  CO-CONTROL.
  1641             20  CO-CTL-1.
  1642                 24  CO-CARR-GROUP.
  1643                     28  CO-CARRIER            PIC X.
  1644                     28  CO-GROUPING.
  1645                         32  CO-GROUP-PREFIX   PIC XXX.
  1646                         32  CO-GROUP-PRIME    PIC XXX.
  1647                 24  CO-RESP-NO.
  1648                     28  CO-RESP-PREFIX        PIC X(4).
  1649                     28  CO-RESP-PRIME         PIC X(6).
  1650             20  CO-CTL-2.
  1651                 24  CO-ACCOUNT.
  1652                     28  CO-ACCT-PREFIX        PIC X(4).
  1653                     28  CO-ACCT-PRIME         PIC X(6).
  1654         16  CO-TYPE                           PIC X.
  1655             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1656             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1657             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1658
  1659     12  CO-MAINT-INFORMATION.
  1660         16  CO-LAST-MAINT-DT                  PIC XX.
  1661         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1662         16  CO-LAST-MAINT-USER                PIC X(4).
  1663     12  FILLER                                PIC XX.
  1664     12  CO-STMT-TYPE                          PIC XXX.
  1665     12  CO-COMP-TYPE                          PIC X.
  1666         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1667     12  CO-STMT-OWNER                         PIC X(4).
  1668     12  CO-BALANCE-CONTROL                    PIC X.
  1669         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1670         88  CO-NO-BALANCE                        VALUE 'N'.
  1671
  1672     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1673         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1674         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1675         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1676
  1677     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1678         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1679         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1680
  1681     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1682     12  CO-GA-DIRECT-DEP                      PIC X.
  1683     12  CO-FUTURE-SPACE                       PIC X.
  1684         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1685
  1686     12  CO-ACCT-NAME                          PIC X(30).
  1687     12  CO-MAIL-NAME                          PIC X(30).
  1688     12  CO-ADDR-1                             PIC X(30).
  1689     12  CO-ADDR-2                             PIC X(30).
  1690     12  CO-ADDR-3.
  1691         16  CO-ADDR-CITY                      PIC X(27).
  1692         16  CO-ADDR-STATE                     PIC XX.
  1693     12  CO-CSO-1099                           PIC X.
  1694     12  CO-ZIP.
  1695         16  CO-ZIP-PRIME.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  31
* NSRASBL.cbl
  1696             20  CO-ZIP-PRI-1ST                PIC X.
  1697                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1698             20  FILLER                        PIC X(4).
  1699         16  CO-ZIP-PLUS4                      PIC X(4).
  1700     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1701         16  CO-CAN-POSTAL-1                   PIC XXX.
  1702         16  CO-CAN-POSTAL-2                   PIC XXX.
  1703         16  FILLER                            PIC XXX.
  1704     12  CO-SOC-SEC                            PIC X(13).
  1705     12  CO-TELEPHONE.
  1706         16  CO-AREA-CODE                      PIC XXX.
  1707         16  CO-PREFIX                         PIC XXX.
  1708         16  CO-PHONE                          PIC X(4).
  1709
  1710     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1711
  1712     12  CO-AR-BAL-LEVEL                       PIC X.
  1713         88  CO-AR-REF-LVL                        VALUE '1'.
  1714         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1715         88  CO-AR-BILL-LVL                       VALUE '2'.
  1716         88  CO-AR-AGT-LVL                        VALUE '3'.
  1717         88  CO-AR-FR-LVL                         VALUE '4'.
  1718
  1719     12  CO-AR-NORMAL-PRINT                    PIC X.
  1720         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1721         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1722
  1723     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1724
  1725     12  CO-AR-REPORTING                       PIC X.
  1726         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1727         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1728
  1729     12  CO-AR-PULL-CHECK                      PIC X.
  1730         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1731         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1732
  1733     12  CO-AR-BALANCE-PRINT                   PIC X.
  1734         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1735
  1736     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1737         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1738         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1739         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1740
  1741     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1742
  1743     12  CO-USER-CODE                          PIC X.
  1744     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1745
  1746******************************************************************
  1747*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1748*    THE LAST MONTH END RUN.
  1749******************************************************************
  1750
  1751     12  CO-LAST-ACTIVITY-DATE.
  1752         16  CO-ACT-YEAR                       PIC 99.
  1753         16  CO-ACT-MONTH                      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  32
* NSRASBL.cbl
  1754         16  CO-ACT-DAY                        PIC 99.
  1755
  1756     12  CO-LAST-STMT-DT.
  1757         16  CO-LAST-STMT-YEAR                 PIC 99.
  1758         16  CO-LAST-STMT-MONTH                PIC 99.
  1759         16  CO-LAST-STMT-DAY                  PIC 99.
  1760
  1761     12  CO-MO-END-TOTALS.
  1762         16  CO-MONTHLY-TOTALS.
  1763             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1764             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1765             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1766             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1767             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1768
  1769         16  CO-AGING-TOTALS.
  1770             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1771             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1772             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1773             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1774
  1775         16  CO-YTD-TOTALS.
  1776             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1777             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1778
  1779         16  CO-OVER-UNDER-TOTALS.
  1780             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1781             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1782
  1783     12  CO-MISCELLANEOUS-TOTALS.
  1784         16  CO-FICA-TOTALS.
  1785             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1786             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1787
  1788         16  CO-CLAIM-TOTALS.
  1789             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1790             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1791
  1792******************************************************************
  1793*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1794*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1795******************************************************************
  1796
  1797     12  CO-CURRENT-TOTALS.
  1798         16  CO-CURRENT-LAST-STMT-DT.
  1799             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1800             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1801             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1802
  1803         16  CO-CURRENT-MONTHLY-TOTALS.
  1804             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1805             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1806             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1807             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1808             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1809
  1810         16  CO-CURRENT-AGING-TOTALS.
  1811             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  33
* NSRASBL.cbl
  1812             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1813             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1814             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1815
  1816         16  CO-CURRENT-YTD-TOTALS.
  1817             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1818             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1819
  1820     12  CO-PAID-COMM-TOTALS.
  1821         16  CO-YTD-PAID-COMMS.
  1822             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1823             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1824
  1825     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1826         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1827         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1828
  1829     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1830         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1831         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1832         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1833         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1834         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1835         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1836         88  CO-FINAL-LETTER                  VALUE 'F'.
  1837         88  CO-RECONCILING                   VALUE 'R'.
  1838         88  CO-PHONE-CALL                    VALUE 'P'.
  1839         88  CO-LEGAL                         VALUE 'L'.
  1840         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1841         88  CO-WRITE-OFF                     VALUE 'W'.
  1842         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1843
  1844     12  CO-CSR-CODE                       PIC X(4).
  1845
  1846     12  CO-GA-STATUS-INFO.
  1847         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1848         16  CO-GA-TERMINATION-DT          PIC XX.
  1849         16  CO-GA-STATUS-CODE             PIC X.
  1850             88  CO-GA-ACTIVE                 VALUE 'A'.
  1851             88  CO-GA-INACTIVE               VALUE 'I'.
  1852             88  CO-GA-PENDING                VALUE 'P'.
  1853         16  CO-GA-COMMENTS.
  1854             20  CO-GA-COMMENT-1           PIC X(40).
  1855             20  CO-GA-COMMENT-2           PIC X(40).
  1856             20  CO-GA-COMMENT-3           PIC X(40).
  1857             20  CO-GA-COMMENT-4           PIC X(40).
  1858
  1859     12  CO-RPTCD2                         PIC X(10).
  1860     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1861         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1862         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1863
  1864     12  CO-TYPE-AGENT                     PIC X(01).
  1865         88  CO-CORPORATION                   VALUE 'C'.
  1866         88  CO-PARTNERSHIP                   VALUE 'P'.
  1867         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1868         88  CO-TRUST                         VALUE 'T'.
  1869         88  CO-UNKNOWN                       VALUE ' ' 'X'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  34
* NSRASBL.cbl
  1870
  1871     12  CO-FAXNO.
  1872         16  CO-FAX-AREA-CODE                  PIC XXX.
  1873         16  CO-FAX-PREFIX                     PIC XXX.
  1874         16  CO-FAX-PHONE                      PIC X(4).
  1875
  1876     12  CO-BANK-INFORMATION.
  1877         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1878         16  CO-BANK-TRANSIT-NON REDEFINES
  1879             CO-BANK-TRANSIT-NO                PIC 9(8).
  1880
  1881         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1882     12  CO-MISC-DEDUCT-INFO REDEFINES
  1883                  CO-BANK-INFORMATION.
  1884         16  CO-MD-GL-ACCT                     PIC X(10).
  1885         16  CO-MD-DIV                         PIC XX.
  1886         16  CO-MD-CENTER                      PIC X(4).
  1887         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1888         16  CO-CREATE-AP-CHECK                PIC X.
  1889         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1890         16  FILLER                            PIC XXX.
  1891     12  CO-ACH-STATUS                         PIC X.
  1892         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1893         88  CO-ACH-PENDING                        VALUE 'P'.
  1894
  1895     12  CO-BILL-SW                            PIC X.
  1896     12  CO-CONTROL-NAME                       PIC X(30).
  1897     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1898     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1899     12  CO-CLP-STATE                          PIC XX.
  1900     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1901     12  CO-SPP-REFUND-EDIT                    PIC X.
  1902
  1903******************************************************************
  1904*                                COPY ELCCERT.
  1905******************************************************************
  1906*                                                                *
  1907*                            ELCCERT.                            *
  1908*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1909*                            VMOD=2.013                          *
  1910*                                                                *
  1911*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1912*                                                                *
  1913*   FILE TYPE = VSAM,KSDS                                        *
  1914*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1915*                                                                *
  1916*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1917*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1918*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1919*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1920*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1921*                                                                *
  1922*   LOG = YES                                                    *
  1923*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1924******************************************************************
  1925*                   C H A N G E   L O G
  1926*
  1927* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  35
* NSRASBL.cbl
  1928*-----------------------------------------------------------------
  1929*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1930* EFFECTIVE    NUMBER
  1931*-----------------------------------------------------------------
  1932* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1933* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1934* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1935* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1936* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1937* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1938* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1939* 032612  CR2011110200001  PEMA  AHL CHANGES
  1940******************************************************************
  1941
  1942 01  CERTIFICATE-MASTER.
  1943     12  CM-RECORD-ID                      PIC XX.
  1944         88  VALID-CM-ID                      VALUE 'CM'.
  1945
  1946     12  CM-CONTROL-PRIMARY.
  1947         16  CM-COMPANY-CD                 PIC X.
  1948         16  CM-CARRIER                    PIC X.
  1949         16  CM-GROUPING.
  1950             20  CM-GROUPING-PREFIX        PIC X(3).
  1951             20  CM-GROUPING-PRIME         PIC X(3).
  1952         16  CM-STATE                      PIC XX.
  1953         16  CM-ACCOUNT.
  1954             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1955             20  CM-ACCOUNT-PRIME          PIC X(6).
  1956         16  CM-CERT-EFF-DT                PIC XX.
  1957         16  CM-CERT-NO.
  1958             20  CM-CERT-PRIME             PIC X(10).
  1959             20  CM-CERT-SFX               PIC X.
  1960
  1961     12  CM-CONTROL-BY-NAME.
  1962         16  CM-COMPANY-CD-A1              PIC X.
  1963         16  CM-INSURED-LAST-NAME          PIC X(15).
  1964         16  CM-INSURED-INITIALS.
  1965             20  CM-INSURED-INITIAL1       PIC X.
  1966             20  CM-INSURED-INITIAL2       PIC X.
  1967
  1968     12  CM-CONTROL-BY-SSN.
  1969         16  CM-COMPANY-CD-A2              PIC X.
  1970         16  CM-SOC-SEC-NO.
  1971             20  CM-SSN-STATE              PIC XX.
  1972             20  CM-SSN-ACCOUNT            PIC X(6).
  1973             20  CM-SSN-LN3.
  1974                 25  CM-INSURED-INITIALS-A2.
  1975                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1976                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1977                 25 CM-PART-LAST-NAME-A2         PIC X.
  1978
  1979     12  CM-CONTROL-BY-CERT-NO.
  1980         16  CM-COMPANY-CD-A4              PIC X.
  1981         16  CM-CERT-NO-A4                 PIC X(11).
  1982
  1983     12  CM-CONTROL-BY-MEMB.
  1984         16  CM-COMPANY-CD-A5              PIC X.
  1985         16  CM-MEMBER-NO.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  36
* NSRASBL.cbl
  1986             20  CM-MEMB-STATE             PIC XX.
  1987             20  CM-MEMB-ACCOUNT           PIC X(6).
  1988             20  CM-MEMB-LN4.
  1989                 25  CM-INSURED-INITIALS-A5.
  1990                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1991                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1992                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1993
  1994     12  CM-INSURED-PROFILE-DATA.
  1995         16  CM-INSURED-FIRST-NAME.
  1996             20  CM-INSURED-1ST-INIT       PIC X.
  1997             20  FILLER                    PIC X(9).
  1998         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1999         16  CM-INSURED-SEX                PIC X.
  2000             88  CM-SEX-MALE                  VALUE 'M'.
  2001             88  CM-SEX-FEMAL                 VALUE 'F'.
  2002         16  CM-INSURED-JOINT-AGE          PIC 99.
  2003         16  CM-JOINT-INSURED-NAME.
  2004             20  CM-JT-LAST-NAME           PIC X(15).
  2005             20  CM-JT-FIRST-NAME.
  2006                 24  CM-JT-1ST-INIT        PIC X.
  2007                 24  FILLER                PIC X(9).
  2008             20  CM-JT-INITIAL             PIC X.
  2009
  2010     12  CM-LIFE-DATA.
  2011         16  CM-LF-BENEFIT-CD              PIC XX.
  2012         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2013         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2014         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2015         16  CM-LF-DEV-CODE                PIC XXX.
  2016         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2017         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2018         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2019         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2020         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2021         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2022         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2023         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2024         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2025         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2026         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2027         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2028         16  FILLER                        PIC XX.
  2029
  2030     12  CM-AH-DATA.
  2031         16  CM-AH-BENEFIT-CD              PIC XX.
  2032         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2033         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2034         16  CM-AH-DEV-CODE                PIC XXX.
  2035         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2036         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2037         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2038         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2039         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2040         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2041         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2042         16  CM-AH-PAID-THRU-DT            PIC XX.
  2043             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  37
* NSRASBL.cbl
  2044         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2045         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2046         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2047         16  FILLER                        PIC X.
  2048
  2049     12  CM-LOAN-INFORMATION.
  2050         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2051         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2052                                           PIC S9(5)V99  COMP-3.
  2053         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2054         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2055         16  CM-PAY-FREQUENCY              PIC S99.
  2056         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2057         16  CM-RATE-CLASS                 PIC XX.
  2058         16  CM-BENEFICIARY                PIC X(25).
  2059         16  CM-POLICY-FORM-NO             PIC X(12).
  2060         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2061         16  CM-LAST-ADD-ON-DT             PIC XX.
  2062         16  CM-DEDUCTIBLE-AMOUNTS.
  2063             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2064             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2065         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2066             20  CM-RESIDENT-STATE         PIC XX.
  2067             20  CM-RATE-CODE              PIC X(4).
  2068             20  FILLER                    PIC XX.
  2069         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2070             20  CM-LOAN-OFFICER           PIC X(5).
  2071             20  FILLER                    PIC XXX.
  2072         16  CM-CSR-CODE                   PIC XXX.
  2073         16  CM-UNDERWRITING-CODE          PIC X.
  2074             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2075         16  CM-POST-CARD-IND              PIC X.
  2076         16  CM-NH-INTERFACE-SW            PIC X.
  2077         16  CM-PREMIUM-TYPE               PIC X.
  2078             88  CM-SING-PRM                  VALUE '1'.
  2079             88  CM-O-B-COVERAGE              VALUE '2'.
  2080             88  CM-OPEN-END                  VALUE '3'.
  2081         16  CM-IND-GRP-TYPE               PIC X.
  2082             88  CM-INDIVIDUAL                VALUE 'I'.
  2083             88  CM-GROUP                     VALUE 'G'.
  2084         16  CM-SKIP-CODE                  PIC X.
  2085             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2086             88  SKIP-JULY                    VALUE '1'.
  2087             88  SKIP-AUGUST                  VALUE '2'.
  2088             88  SKIP-SEPTEMBER               VALUE '3'.
  2089             88  SKIP-JULY-AUG                VALUE '4'.
  2090             88  SKIP-AUG-SEPT                VALUE '5'.
  2091             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2092             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2093             88  SKIP-JUNE                    VALUE '8'.
  2094             88  SKIP-JUNE-JULY               VALUE '9'.
  2095             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2096             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2097         16  CM-PAYMENT-MODE               PIC X.
  2098             88  PAY-MONTHLY                  VALUE SPACE.
  2099             88  PAY-WEEKLY                   VALUE '1'.
  2100             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2101             88  PAY-BI-WEEKLY                VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  38
* NSRASBL.cbl
  2102             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2103         16  CM-LOAN-NUMBER                PIC X(8).
  2104         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2105         16  CM-OLD-LOF                    PIC XXX.
  2106*        16  CM-LOAN-OFFICER               PIC XXX.
  2107         16  CM-REIN-TABLE                 PIC XXX.
  2108         16  CM-SPECIAL-REIN-CODE          PIC X.
  2109         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2110         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2111         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2112
  2113     12  CM-STATUS-DATA.
  2114         16  CM-ENTRY-STATUS               PIC X.
  2115         16  CM-ENTRY-DT                   PIC XX.
  2116
  2117         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2118         16  CM-LF-CANCEL-DT               PIC XX.
  2119         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2120
  2121         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2122         16  CM-LF-DEATH-DT                PIC XX.
  2123         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2124
  2125         16  CM-LF-CURRENT-STATUS          PIC X.
  2126             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2127                                                'M' '4' '5' '9'.
  2128             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2129             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2130             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2131             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2132             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2133             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2134             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2135             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2136             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2137             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2138             88  CM-LF-DECLINED               VALUE 'D'.
  2139             88  CM-LF-VOIDED                 VALUE 'V'.
  2140
  2141         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2142         16  CM-AH-CANCEL-DT               PIC XX.
  2143         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2144
  2145         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2146         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2147         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2148
  2149         16  CM-AH-CURRENT-STATUS          PIC X.
  2150             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2151                                                'M' '4' '5' '9'.
  2152             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2153             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2154             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2155             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2156             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2157             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2158             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2159             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  39
* NSRASBL.cbl
  2160             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2161             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2162             88  CM-AH-DECLINED               VALUE 'D'.
  2163             88  CM-AH-VOIDED                 VALUE 'V'.
  2164
  2165         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2166             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2167             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2168             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2169         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2170
  2171         16  CM-ENTRY-BATCH                PIC X(6).
  2172         16  CM-LF-EXIT-BATCH              PIC X(6).
  2173         16  CM-AH-EXIT-BATCH              PIC X(6).
  2174         16  CM-LAST-MONTH-END             PIC XX.
  2175
  2176     12  CM-NOTE-SW                        PIC X.
  2177         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2178         88  CERT-NOTES-PRESENT               VALUE '1'.
  2179         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2180         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2181         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2182         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2183         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2184         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2185     12  CM-COMP-EXCP-SW                   PIC X.
  2186         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2187         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2188     12  CM-INSURED-ADDRESS-SW             PIC X.
  2189         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2190         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2191
  2192*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2193     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2194     12  FILLER                            PIC X.
  2195
  2196*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2197     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2198     12  FILLER                            PIC X.
  2199*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2200     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2201
  2202     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2203         88  CERT-ADDED-BATCH                 VALUE ' '.
  2204         88  CERT-ADDED-ONLINE                VALUE '1'.
  2205         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2206         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2207         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2208     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2209         88  CERT-AS-LOADED                   VALUE ' '.
  2210         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2211         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2212         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2213         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2214         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2215         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2216         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2217
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  40
* NSRASBL.cbl
  2218     12  CM-ACCOUNT-COMM-PCTS.
  2219         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2220         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2221
  2222     12  CM-USER-FIELD                     PIC X.
  2223     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2224     12  CM-CLP-STATE                      PIC XX.
  2225     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2226     12  CM-USER-RESERVED                  PIC XXX.
  2227     12  FILLER REDEFINES CM-USER-RESERVED.
  2228         16  CM-AH-CLASS-CD                PIC XX.
  2229         16  F                             PIC X.
  2230******************************************************************
  2231*                                COPY ELCCRTO.
  2232******************************************************************
  2233*                                                                *
  2234*                            ELCCRTO.                            *
  2235*                                                                *
  2236*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2237*                                                                *
  2238*   FILE TYPE = VSAM,KSDS                                        *
  2239*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2240*                                                                *
  2241*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2242*                                                                *
  2243*   LOG = YES                                                    *
  2244*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2245******************************************************************
  2246*                   C H A N G E   L O G
  2247*
  2248* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2249*-----------------------------------------------------------------
  2250*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2251* EFFECTIVE    NUMBER
  2252*-----------------------------------------------------------------
  2253* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2254* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2255* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2256******************************************************************
  2257 01  ORIGINAL-CERTIFICATE.
  2258     12  OC-RECORD-ID                      PIC XX.
  2259         88  VALID-OC-ID                      VALUE 'OC'.
  2260     12  OC-CONTROL-PRIMARY.
  2261         16  OC-COMPANY-CD                 PIC X.
  2262         16  OC-CARRIER                    PIC X.
  2263         16  OC-GROUPING                   PIC X(6).
  2264         16  OC-STATE                      PIC XX.
  2265         16  OC-ACCOUNT                    PIC X(10).
  2266         16  OC-CERT-EFF-DT                PIC XX.
  2267         16  OC-CERT-NO.
  2268             20  OC-CERT-PRIME             PIC X(10).
  2269             20  OC-CERT-SFX               PIC X.
  2270         16  OC-RECORD-TYPE                PIC X.
  2271         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2272     12  OC-LAST-MAINT-DT                  PIC XX.
  2273     12  OC-LAST-MAINT-BY                  PIC X(4).
  2274     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2275     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  41
* NSRASBL.cbl
  2276     12  FILLER                            PIC X(49).
  2277     12  OC-ORIG-REC.
  2278         16  OC-INS-LAST-NAME              PIC X(15).
  2279         16  OC-INS-FIRST-NAME             PIC X(10).
  2280         16  OC-INS-MIDDLE-INIT            PIC X.
  2281         16  OC-INS-AGE                    PIC S999     COMP-3.
  2282         16  OC-JNT-LAST-NAME              PIC X(15).
  2283         16  OC-JNT-FIRST-NAME             PIC X(10).
  2284         16  OC-JNT-MIDDLE-INIT            PIC X.
  2285         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2286         16  OC-LF-BENCD                   PIC XX.
  2287         16  OC-LF-TERM                    PIC S999      COMP-3.
  2288         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2289         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2290         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2291         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2292         16  OC-LF-EXP-DT                  PIC XX.
  2293         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2294         16  OC-LF-CANCEL-DT               PIC XX.
  2295         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2296         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2297         16  OC-AH-BENCD                   PIC XX.
  2298         16  OC-AH-TERM                    PIC S999      COMP-3.
  2299         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2300         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2301         16  OC-AH-EXP-DT                  PIC XX.
  2302         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2303         16  OC-AH-CP                      PIC 99.
  2304         16  OC-AH-CANCEL-DT               PIC XX.
  2305         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2306         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2307         16  OC-CRED-BENE-NAME             PIC X(25).
  2308         16  OC-1ST-PMT-DT                 PIC XX.
  2309         16  FILLER                        PIC X(215).
  2310
  2311     12  FILLER                            PIC X(50).
  2312******************************************************************
  2313*                                COPY ERCACCT.
  2314******************************************************************
  2315*                                                                *
  2316*                                                                *
  2317*                            ERCACCT                             *
  2318*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2319*                            VMOD=2.031                          *
  2320*                                                                *
  2321*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2322*                                                                *
  2323*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2324*   VSAM ACCOUNT MASTER FILES.                                   *
  2325*                                                                *
  2326*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2327*                                                                *
  2328*   FILE TYPE = VSAM,KSDS                                        *
  2329*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2330*                                                                *
  2331*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2332*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2333*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  42
* NSRASBL.cbl
  2334*   LOG = NO                                                     *
  2335*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2336*                                                                *
  2337*                                                                *
  2338******************************************************************
  2339*                   C H A N G E   L O G
  2340*
  2341* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2342*-----------------------------------------------------------------
  2343*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2344* EFFECTIVE    NUMBER
  2345*-----------------------------------------------------------------
  2346* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2347* 092705    2005050300006  PEMA  ADD SPP LEASES
  2348* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2349* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2350* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2351* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2352* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2353******************************************************************
  2354
  2355 01  ACCOUNT-MASTER.
  2356     12  AM-RECORD-ID                      PIC XX.
  2357         88  VALID-AM-ID                      VALUE 'AM'.
  2358
  2359     12  AM-CONTROL-PRIMARY.
  2360         16  AM-COMPANY-CD                 PIC X.
  2361         16  AM-MSTR-CNTRL.
  2362             20  AM-CONTROL-A.
  2363                 24  AM-CARRIER            PIC X.
  2364                 24  AM-GROUPING.
  2365                     28 AM-GROUPING-PREFIX PIC XXX.
  2366                     28 AM-GROUPING-PRIME  PIC XXX.
  2367                 24  AM-STATE              PIC XX.
  2368                 24  AM-ACCOUNT.
  2369                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2370                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2371             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2372                                           PIC X(19).
  2373             20  AM-CNTRL-B.
  2374                 24  AM-EXPIRATION-DT      PIC XX.
  2375                 24  FILLER                PIC X(4).
  2376             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2377                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2378
  2379     12  AM-CONTROL-BY-VAR-GRP.
  2380         16  AM-COMPANY-CD-A1              PIC X.
  2381         16  AM-VG-CARRIER                 PIC X.
  2382         16  AM-VG-GROUPING                PIC X(6).
  2383         16  AM-VG-STATE                   PIC XX.
  2384         16  AM-VG-ACCOUNT                 PIC X(10).
  2385         16  AM-VG-DATE.
  2386             20  AM-VG-EXPIRATION-DT       PIC XX.
  2387             20  FILLER                    PIC X(4).
  2388         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2389                                           PIC 9(11)      COMP-3.
  2390     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2391         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  43
* NSRASBL.cbl
  2392         16  AM-VG-KEY3.
  2393             20  AM-VG3-ACCOUNT            PIC X(10).
  2394             20  AM-VG3-EXP-DT             PIC XX.
  2395         16  FILLER                        PIC X(4).
  2396     12  AM-MAINT-INFORMATION.
  2397         16  AM-LAST-MAINT-DT              PIC XX.
  2398         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2399         16  AM-LAST-MAINT-USER            PIC X(4).
  2400         16  FILLER                        PIC XX.
  2401
  2402     12  AM-EFFECTIVE-DT                   PIC XX.
  2403     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2404
  2405     12  AM-PREV-DATES  COMP-3.
  2406         16  AM-PREV-EXP-DT                PIC 9(11).
  2407         16  AM-PREV-EFF-DT                PIC 9(11).
  2408
  2409     12  AM-REPORT-CODE-1                  PIC X(10).
  2410     12  AM-REPORT-CODE-2                  PIC X(10).
  2411
  2412     12  AM-CITY-CODE                      PIC X(4).
  2413     12  AM-COUNTY-PARISH                  PIC X(6).
  2414
  2415     12  AM-NAME                           PIC X(30).
  2416     12  AM-PERSON                         PIC X(30).
  2417     12  AM-ADDRS                          PIC X(30).
  2418     12  AM-CITY.
  2419         16  AM-ADDR-CITY                  PIC X(28).
  2420         16  AM-ADDR-STATE                 PIC XX.
  2421     12  AM-ZIP.
  2422         16  AM-ZIP-PRIME.
  2423             20  AM-ZIP-PRI-1ST            PIC X.
  2424                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2425             20  FILLER                    PIC X(4).
  2426         16  AM-ZIP-PLUS4                  PIC X(4).
  2427     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2428         16  AM-CAN-POSTAL-1               PIC XXX.
  2429         16  AM-CAN-POSTAL-2               PIC XXX.
  2430         16  FILLER                        PIC XXX.
  2431     12  AM-TEL-NO.
  2432         16  AM-AREA-CODE                  PIC 999.
  2433         16  AM-TEL-PRE                    PIC 999.
  2434         16  AM-TEL-NBR                    PIC 9(4).
  2435     12  AM-TEL-LOC                        PIC X.
  2436         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2437         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2438
  2439     12  AM-COMM-STRUCTURE.
  2440         16  AM-DEFN-1.
  2441             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2442                 24  AM-AGT.
  2443                     28  AM-AGT-PREFIX     PIC X(4).
  2444                     28  AM-AGT-PRIME      PIC X(6).
  2445                 24  AM-COM-TYP            PIC X.
  2446                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2447                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2448                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2449                 24  AM-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  44
* NSRASBL.cbl
  2450                 24  AM-RETRO-LV-INDIC     PIC X.
  2451                 24  AM-GL-CODES           PIC X.
  2452                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2453                 24  FILLER                PIC X(01).
  2454         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2455             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2456                 24  FILLER                PIC X(11).
  2457                 24  AM-L-COMA             PIC XXX.
  2458                 24  AM-J-COMA             PIC XXX.
  2459                 24  AM-A-COMA             PIC XXX.
  2460                 24  FILLER                PIC X(6).
  2461
  2462     12  AM-COMM-CHANGE-STATUS             PIC X.
  2463         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2464
  2465     12  AM-CSR-CODE                       PIC X(4).
  2466
  2467     12  AM-BILLING-STATUS                 PIC X.
  2468         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2469         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2470     12  AM-AUTO-REFUND-SW                 PIC X.
  2471         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2472         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2473     12  AM-GPCD                           PIC 99.
  2474     12  AM-IG                             PIC X.
  2475         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2476         88  AM-HAS-GROUP                     VALUE '2'.
  2477     12  AM-STATUS                         PIC X.
  2478         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2479         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2480         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2481         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2482         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2483         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2484     12  AM-REMIT-TO                       PIC 99.
  2485     12  AM-ID-NO                          PIC X(11).
  2486
  2487     12  AM-CAL-TABLE                      PIC XX.
  2488     12  AM-LF-DEVIATION                   PIC XXX.
  2489     12  AM-AH-DEVIATION                   PIC XXX.
  2490     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2491     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2492     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2493     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2494     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2495     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2496
  2497     12  AM-USER-FIELDS.
  2498         16  AM-FLD-1                      PIC XX.
  2499         16  AM-FLD-2                      PIC XX.
  2500         16  AM-FLD-3                      PIC XX.
  2501         16  AM-FLD-4                      PIC XX.
  2502         16  AM-FLD-5                      PIC XX.
  2503
  2504     12  AM-1ST-PROD-DATE.
  2505         16  AM-1ST-PROD-YR                PIC XX.
  2506         16  AM-1ST-PROD-MO                PIC XX.
  2507         16  AM-1ST-PROD-DA                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  45
* NSRASBL.cbl
  2508     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2509     12  AM-CERTS-PURGED-DATE.
  2510         16  AM-PUR-YR                     PIC XX.
  2511         16  AM-PUR-MO                     PIC XX.
  2512         16  AM-PUR-DA                     PIC XX.
  2513     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2514     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2515     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2516     12  AM-INACTIVE-DATE.
  2517         16  AM-INA-MO                     PIC 99.
  2518         16  AM-INA-DA                     PIC 99.
  2519         16  AM-INA-YR                     PIC 99.
  2520     12  AM-AR-HI-CERT-DATE                PIC XX.
  2521
  2522     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2523     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2524
  2525     12  AM-OB-PAYMENT-MODE                PIC X.
  2526         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2527         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2528         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2529         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2530
  2531     12  AM-AH-ONLY-INDICATOR              PIC X.
  2532         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2533         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2534
  2535     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2536
  2537     12  AM-OVER-SHORT.
  2538         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2539         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2540
  2541     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2542     12  AM-DCC-CLP-STATE                  PIC XX.
  2543
  2544     12  AM-RECALC-COMM                    PIC X.
  2545     12  AM-RECALC-REIN                    PIC X.
  2546
  2547     12  AM-REI-TABLE                      PIC XXX.
  2548     12  AM-REI-ET-LF                      PIC X.
  2549     12  AM-REI-ET-AH                      PIC X.
  2550     12  AM-REI-PE-LF                      PIC X.
  2551     12  AM-REI-PE-AH                      PIC X.
  2552     12  AM-REI-PRT-ST                     PIC X.
  2553     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2554     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2555     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2556     12  AM-REI-GROUP-A                    PIC X(6).
  2557     12  AM-REI-MORT                       PIC X(4).
  2558     12  AM-REI-PRT-OW                     PIC X.
  2559     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2560     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2561     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2562     12  AM-REI-GROUP-B                    PIC X(6).
  2563
  2564     12  AM-TRUST-TYPE                     PIC X(2).
  2565
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  46
* NSRASBL.cbl
  2566     12  AM-EMPLOYER-STMT-USED             PIC X.
  2567     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2568
  2569     12  AM-STD-AH-TYPE                    PIC XX.
  2570     12  AM-EARN-METHODS.
  2571         16  AM-EARN-METHOD-R              PIC X.
  2572             88 AM-REF-RL-R78                 VALUE 'R'.
  2573             88 AM-REF-RL-PR                  VALUE 'P'.
  2574             88 AM-REF-RL-MEAN                VALUE 'M'.
  2575             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2576         16  AM-EARN-METHOD-L              PIC X.
  2577             88 AM-REF-LL-R78                 VALUE 'R'.
  2578             88 AM-REF-LL-PR                  VALUE 'P'.
  2579             88 AM-REF-LL-MEAN                VALUE 'M'.
  2580             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2581         16  AM-EARN-METHOD-A              PIC X.
  2582             88 AM-REF-AH-R78                 VALUE 'R'.
  2583             88 AM-REF-AH-PR                  VALUE 'P'.
  2584             88 AM-REF-AH-MEAN                VALUE 'M'.
  2585             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2586             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2587             88 AM-REF-AH-NET                 VALUE 'N'.
  2588
  2589     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2590     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2591     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2592
  2593     12  AM-RET-Y-N                        PIC X.
  2594     12  AM-RET-P-E                        PIC X.
  2595     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2596     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2597     12  AM-RET-GRP                        PIC X(6).
  2598     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2599         16  AM-POOL-PRIME                 PIC XXX.
  2600         16  AM-POOL-SUB                   PIC XXX.
  2601     12  AM-RETRO-EARNINGS.
  2602         16  AM-RET-EARN-R                 PIC X.
  2603         16  AM-RET-EARN-L                 PIC X.
  2604         16  AM-RET-EARN-A                 PIC X.
  2605     12  AM-RET-ST-TAX-USE                 PIC X.
  2606         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2607         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2608     12  AM-RETRO-BEG-EARNINGS.
  2609         16  AM-RET-BEG-EARN-R             PIC X.
  2610         16  AM-RET-BEG-EARN-L             PIC X.
  2611         16  AM-RET-BEG-EARN-A             PIC X.
  2612     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2613     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2614
  2615     12  AM-USER-SELECT-OPTIONS.
  2616         16  AM-USER-SELECT-1              PIC X(10).
  2617         16  AM-USER-SELECT-2              PIC X(10).
  2618         16  AM-USER-SELECT-3              PIC X(10).
  2619         16  AM-USER-SELECT-4              PIC X(10).
  2620         16  AM-USER-SELECT-5              PIC X(10).
  2621
  2622     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2623
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  47
* NSRASBL.cbl
  2624     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2625
  2626     12  AM-RPT045A-SWITCH                 PIC X.
  2627         88  RPT045A-OFF                   VALUE 'N'.
  2628
  2629     12  AM-INSURANCE-LIMITS.
  2630         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2631         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2632
  2633     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2634         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2635
  2636     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2637         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2638         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2639
  2640     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2641
  2642     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2643     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2644     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2645     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2646     12  AM-DCC-UEF-STATE                  PIC XX.
  2647     12  FILLER                            PIC XXX.
  2648     12  AM-REPORT-CODE-3                  PIC X(10).
  2649*    12  FILLER                            PIC X(22).
  2650
  2651     12  AM-RESERVE-DATE.
  2652         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2653         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2654         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2655
  2656     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2657     12  AM-NOTIFICATION-TYPES.
  2658         16  AM-NOTIF-OF-LETTERS           PIC X.
  2659         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2660         16  AM-NOTIF-OF-REPORTS           PIC X.
  2661         16  AM-NOTIF-OF-STATUS            PIC X.
  2662
  2663     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2664         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2665         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2666         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2667         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2668
  2669     12  AM-BENEFIT-CONTROLS.
  2670         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2671             20  AM-BENEFIT-CODE           PIC XX.
  2672             20  AM-BENEFIT-TYPE           PIC X.
  2673             20  AM-BENEFIT-REVISION       PIC XXX.
  2674             20  AM-BENEFIT-REM-TERM       PIC X.
  2675             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2676             20  FILLER                    PIC XX.
  2677         16  FILLER                        PIC X(80).
  2678
  2679     12  AM-TRANSFER-DATA.
  2680         16  AM-TRANSFERRED-FROM.
  2681             20  AM-TRNFROM-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  48
* NSRASBL.cbl
  2682             20  AM-TRNFROM-GROUPING.
  2683                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2684                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2685             20  AM-TRNFROM-STATE          PIC XX.
  2686             20  AM-TRNFROM-ACCOUNT.
  2687                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2688                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2689             20  AM-TRNFROM-DTE            PIC XX.
  2690         16  AM-TRANSFERRED-TO.
  2691             20  AM-TRNTO-CARRIER          PIC X.
  2692             20  AM-TRNTO-GROUPING.
  2693                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2694                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2695             20  AM-TRNTO-STATE            PIC XX.
  2696             20  AM-TRNTO-ACCOUNT.
  2697                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2698                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2699             20  AM-TRNTO-DTE              PIC XX.
  2700         16  FILLER                        PIC X(10).
  2701
  2702     12  AM-SAVED-REMIT-TO                 PIC 99.
  2703
  2704     12  AM-COMM-STRUCTURE-SAVED.
  2705         16  AM-DEFN-1-SAVED.
  2706             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2707                 24  AM-AGT-SV             PIC X(10).
  2708                 24  AM-COM-TYP-SV         PIC X.
  2709                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2710                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2711                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2712                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2713                 24  FILLER                PIC X.
  2714                 24  AM-GL-CODES-SV        PIC X.
  2715                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2716                 24  FILLER                PIC X.
  2717         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2718             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2719                 24  FILLER                PIC X(11).
  2720                 24  AM-L-COMA-SV          PIC XXX.
  2721                 24  AM-J-COMA-SV          PIC XXX.
  2722                 24  AM-A-COMA-SV          PIC XXX.
  2723                 24  FILLER                PIC X(6).
  2724
  2725     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2726         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2727            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2728            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2729            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2730
  2731     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2732     12  FILLER                            PIC X(120).
  2733
  2734     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2735         16  AM-CONTROL-NAME               PIC X(30).
  2736         16  AM-EXECUTIVE-ONE.
  2737             20  AM-EXEC1-NAME             PIC X(15).
  2738             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2739                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  49
* NSRASBL.cbl
  2740             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2741                                                          COMP-3.
  2742         16  AM-EXECUTIVE-TWO.
  2743             20  AM-EXEC2-NAME             PIC X(15).
  2744             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2745                                                          COMP-3.
  2746             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2747                                                          COMP-3.
  2748
  2749     12  AM-RETRO-ADDITIONAL-DATA.
  2750         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2751         16  AM-RETRO-PREM-P-E             PIC X.
  2752         16  AM-RETRO-CLMS-P-I             PIC X.
  2753         16  AM-RETRO-RET-BRACKET-LF.
  2754             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2755                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2756                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2757             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2758                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2759                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2760             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2761                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2762                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2763         16  AM-RETRO-RET-BRACKET-AH.
  2764             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2765                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2766                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2767                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2768             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2769                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2770                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2771             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2772                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2773                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2774
  2775     12  AM-COMMENTS.
  2776         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2777
  2778     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2779         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2780         16  AM-FLI-BILLING-CODE           PIC X.
  2781         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2782         16  AM-FLI-UNITED-IDENT           PIC X.
  2783         16  AM-FLI-INTEREST-LOST-DATA.
  2784             20  AM-FLI-BANK-NO            PIC X(5).
  2785             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2786             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2787             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2788         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2789             20  AM-FLI-AGT                PIC X(9).
  2790             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2791             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2792         16  FILLER                        PIC X(102).
  2793
  2794     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2795         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2796             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2797             20  AM-BENEFIT-DMD-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  50
* NSRASBL.cbl
  2798             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2799             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2800             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2801         16  FILLER                          PIC X(10).
  2802******************************************************************
  2803*                                COPY ELCTEXT.
  2804******************************************************************
  2805*                                                                *
  2806*                                                                *
  2807*                            ELCTEXT.                            *
  2808*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2809*                            VMOD=2.008                          *
  2810*                                                                *
  2811*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2812*                                     FORM LETTERS,              *
  2813*                                     CERT FORM DISPLAY.
  2814*                                                                *
  2815*   FILE TYPE = VSAM,KSDS                                        *
  2816*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2817*                                                                *
  2818*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2819*       ALTERNATE INDEX = NONE                                   *
  2820*                                                                *
  2821*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2822*       ALTERNATE INDEX = NONE                                   *
  2823*                                                                *
  2824*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  2825*       ALTERNATE INDEX = NONE                                   *
  2826*                                                                *
  2827*   LOG = NO                                                     *
  2828*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2829******************************************************************
  2830 01  TEXT-FILES.
  2831     12  TEXT-FILE-ID                PIC XX.
  2832         88  FORMS-FILE-TEXT            VALUE 'TF'.
  2833         88  LETTER-FILE-TEXT           VALUE 'TL'.
  2834         88  HELP-FILE-TEXT             VALUE 'TH'.
  2835
  2836     12  TX-CONTROL-PRIMARY.
  2837         16  TX-COMPANY-CD           PIC X.
  2838             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  2839         16  TX-ACCESS-CD-GENL       PIC X(12).
  2840
  2841         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2842             20  TX-LETTER-NO        PIC X(4).
  2843             20  FILLER              PIC X(8).
  2844
  2845         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2846             20  TX-FORM-NO          PIC X(12).
  2847
  2848         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2849             20  TX-HELP-TYPE        PIC X.
  2850                 88  HELP-FOR-GENERAL   VALUE ' '.
  2851                 88  HELP-BY-SCREEN     VALUE 'S'.
  2852                 88  HELP-BY-ERROR      VALUE 'E'.
  2853             20  TX-SCREEN-OR-ERROR  PIC X(4).
  2854                 88  GENERAL-INFO-HELP  VALUE '0000'.
  2855             20  TX-HELP-FOR-COMPANY  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  51
* NSRASBL.cbl
  2856                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  2857             20  FILLER              PIC X(4).
  2858
  2859         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  2860
  2861     12  TX-PROCESS-CONTROL          PIC XX.
  2862         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  2863
  2864     12  TX-TEXT-LINE                PIC X(70).
  2865
  2866     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  2867         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  2868         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  2869         88  TX-VALID-FORM-SQUEEZE-VALUE
  2870                                        VALUE 'Y' ' '.
  2871
  2872     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  2873         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  2874         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  2875         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  2876         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  2877         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  2878         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  2879         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  2880                                              'K' 'N' ' '
  2881                                              'Z'.
  2882
  2883     12  TX-ARCHIVE-SW               PIC X.
  2884         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  2885         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  2886         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  2887
  2888     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  2889     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  2890
  2891     12  TX-BSR-CODE                 PIC X.
  2892         88  TX-BSR-LETTER              VALUE 'B'.
  2893         88  TX-NON-BSR-LETTER          VALUE ' '.
  2894
  2895     12  FILLER                      PIC X.
  2896*****************************************************************
  2897*                                COPY ELCCNTL.
  2898******************************************************************
  2899*                                                                *
  2900*                                                                *
  2901*                            ELCCNTL.                            *
  2902*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2903*                            VMOD=2.059                          *
  2904*                                                                *
  2905*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2906*                                                                *
  2907*   FILE TYPE = VSAM,KSDS                                        *
  2908*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2909*                                                                *
  2910*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2911*       ALTERNATE INDEX = NONE                                   *
  2912*                                                                *
  2913*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  52
* NSRASBL.cbl
  2914*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2915******************************************************************
  2916*                   C H A N G E   L O G
  2917*
  2918* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2919*-----------------------------------------------------------------
  2920*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2921* EFFECTIVE    NUMBER
  2922*-----------------------------------------------------------------
  2923* 082503                   PEMA  ADD BENEFIT GROUP
  2924* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2925* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2926* 092705    2005050300006  PEMA  ADD SPP LEASES
  2927* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2928* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2929* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2930* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2931* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2932* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2933******************************************************************
  2934*
  2935 01  CONTROL-FILE.
  2936     12  CF-RECORD-ID                       PIC XX.
  2937         88  VALID-CF-ID                        VALUE 'CF'.
  2938
  2939     12  CF-CONTROL-PRIMARY.
  2940         16  CF-COMPANY-ID                  PIC XXX.
  2941         16  CF-RECORD-TYPE                 PIC X.
  2942             88  CF-COMPANY-MASTER              VALUE '1'.
  2943             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2944             88  CF-STATE-MASTER                VALUE '3'.
  2945             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2946             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2947             88  CF-CARRIER-MASTER              VALUE '6'.
  2948             88  CF-MORTALITY-MASTER            VALUE '7'.
  2949             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2950             88  CF-TERMINAL-MASTER             VALUE '9'.
  2951             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2952             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2953             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2954             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2955             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2956             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2957             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2958             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2959             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2960         16  CF-ACCESS-CD-GENL              PIC X(4).
  2961         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2962             20  CF-PROCESSOR               PIC X(4).
  2963         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2964             20  CF-STATE-CODE              PIC XX.
  2965             20  FILLER                     PIC XX.
  2966         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2967             20  FILLER                     PIC XX.
  2968             20  CF-HI-BEN-IN-REC           PIC XX.
  2969         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2970             20  FILLER                     PIC XXX.
  2971             20  CF-CARRIER-CNTL            PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  53
* NSRASBL.cbl
  2972         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2973             20  FILLER                     PIC XX.
  2974             20  CF-HI-TYPE-IN-REC          PIC 99.
  2975         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2976             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2977                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2978             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2979             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2980         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2981             20  FILLER                     PIC X.
  2982             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2983         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2984             20  FILLER                     PIC XX.
  2985             20  CF-MORTGAGE-PLAN           PIC XX.
  2986         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2987
  2988     12  CF-LAST-MAINT-DT                   PIC XX.
  2989     12  CF-LAST-MAINT-BY                   PIC X(4).
  2990     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2991
  2992     12  CF-RECORD-BODY                     PIC X(728).
  2993
  2994
  2995****************************************************************
  2996*             COMPANY MASTER RECORD                            *
  2997****************************************************************
  2998
  2999     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3000         16  CF-COMPANY-ADDRESS.
  3001             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3002             20  CF-CL-IN-CARE-OF           PIC X(30).
  3003             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3004             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3005             20  CF-CL-CITY-STATE           PIC X(30).
  3006             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3007             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3008         16  CF-COMPANY-CD                  PIC X.
  3009         16  CF-COMPANY-PASSWORD            PIC X(8).
  3010         16  CF-SECURITY-OPTION             PIC X.
  3011             88  ALL-SECURITY                   VALUE '1'.
  3012             88  COMPANY-VERIFY                 VALUE '2'.
  3013             88  PROCESSOR-VERIFY               VALUE '3'.
  3014             88  NO-SECURITY                    VALUE '4'.
  3015             88  ALL-BUT-TERM                   VALUE '5'.
  3016         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3017             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3018         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3019             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3020         16  CF-INFORCE-LOCATION            PIC X.
  3021             88  CERTS-ARE-ONLINE               VALUE '1'.
  3022             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3023             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3024         16  CF-LOWER-CASE-LETTERS          PIC X.
  3025         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3026             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3027             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3028             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3029             88  CF-ACCNT-CNTL                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  54
* NSRASBL.cbl
  3030             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3031
  3032         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3033         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3034
  3035         16  CF-LGX-CREDIT-USER             PIC X.
  3036             88  CO-IS-NOT-USER                 VALUE 'N'.
  3037             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3038
  3039         16 CF-CREDIT-CALC-CODES.
  3040             20  CF-CR-REM-TERM-CALC PIC X.
  3041               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3042               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3043               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3044               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3045               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3046               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3047               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3048             20  CF-CR-R78-METHOD           PIC X.
  3049               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3050               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3051
  3052         16  CF-CLAIM-CONTROL-COUNTS.
  3053             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3054                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3055
  3056             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3057                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3058
  3059             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3060                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3061
  3062             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3063                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3064
  3065         16  CF-CURRENT-MONTH-END           PIC XX.
  3066
  3067         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3068             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3069             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3070             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3071             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3072                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3073                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3074             20  CF-CO-PREM-REJECT-SW       PIC X.
  3075                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3076                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3077             20  CF-CO-REF-REJECT-SW        PIC X.
  3078                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3079                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3080
  3081         16  CF-CO-REPORTING-DT             PIC XX.
  3082         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3083         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3084           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3085           88  CF-CO-MONTH-END                  VALUE '1'.
  3086
  3087         16  CF-LGX-CLAIM-USER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  55
* NSRASBL.cbl
  3088             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3089             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3090
  3091         16  CF-CREDIT-EDIT-CONTROLS.
  3092             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3093             20  CF-MIN-AGE                 PIC 99.
  3094             20  CF-DEFAULT-AGE             PIC 99.
  3095             20  CF-MIN-TERM                PIC S999      COMP-3.
  3096             20  CF-MAX-TERM                PIC S999      COMP-3.
  3097             20  CF-DEFAULT-SEX             PIC X.
  3098             20  CF-JOINT-AGE-INPUT         PIC X.
  3099                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3100             20  CF-BIRTH-DATE-INPUT        PIC X.
  3101                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3102             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3103                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3104                 88  CF-ZERO-CARRIER            VALUE '1'.
  3105                 88  CF-ZERO-GROUPING           VALUE '2'.
  3106                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3107             20  CF-EDIT-SW                 PIC X.
  3108                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3109             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3110             20  CF-CR-PR-METHOD            PIC X.
  3111               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3112               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3113             20  FILLER                     PIC X.
  3114
  3115         16  CF-CREDIT-MISC-CONTROLS.
  3116             20  CF-REIN-TABLE-SW           PIC X.
  3117                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3118             20  CF-COMP-TABLE-SW           PIC X.
  3119                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3120             20  CF-EXPERIENCE-RETENTION-AGE
  3121                                            PIC S9        COMP-3.
  3122             20  CF-CONVERSION-DT           PIC XX.
  3123             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3124             20  CF-RUN-FREQUENCY-SW        PIC X.
  3125                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3126                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3127
  3128             20  CF-CR-CHECK-NO-CONTROL.
  3129                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3130                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3131                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3132                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3133                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3134                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3135
  3136                 24  CF-CR-CHECK-COUNT       REDEFINES
  3137                     CF-CR-CHECK-COUNTER      PIC X(4).
  3138
  3139                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3140                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3141
  3142                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3143                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3144                 24  CF-MAIL-PROCESSING       PIC X.
  3145                     88  MAIL-PROCESSING          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  56
* NSRASBL.cbl
  3146
  3147         16  CF-MISC-SYSTEM-CONTROL.
  3148             20  CF-SYSTEM-C                 PIC X.
  3149                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3150             20  CF-SYSTEM-D                 PIC X.
  3151                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3152             20  CF-SOC-SEC-NO-SW            PIC X.
  3153                 88  SOC-SEC-NO-USED             VALUE '1'.
  3154             20  CF-MEMBER-NO-SW             PIC X.
  3155                 88  MEMBER-NO-USED              VALUE '1'.
  3156             20  CF-TAX-ID-NUMBER            PIC X(11).
  3157             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3158             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3159                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3160                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3161                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3162                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3163             20  CF-SYSTEM-E                 PIC X.
  3164                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3165
  3166         16  CF-LGX-LIFE-USER               PIC X.
  3167             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3168             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3169
  3170         16  CF-CR-MONTH-END-DT             PIC XX.
  3171
  3172         16  CF-FILE-MAINT-DATES.
  3173             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3174                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3175             20  CF-LAST-BATCH       REDEFINES
  3176                 CF-LAST-BATCH-NO               PIC X(4).
  3177             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3178             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3179             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3180             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3181             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3182             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3183             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3184             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3185             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3186             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3187
  3188         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3189         16  FILLER                         PIC X.
  3190
  3191         16  CF-ALT-MORT-CODE               PIC X(4).
  3192         16  CF-MEMBER-CAPTION              PIC X(10).
  3193
  3194         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3195             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3196             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3197             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3198             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3199             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3200
  3201         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3202
  3203         16  CF-LIFE-OVERRIDE-L1            PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  57
* NSRASBL.cbl
  3204         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3205         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3206         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3207
  3208         16  CF-AH-OVERRIDE-L1              PIC X.
  3209         16  CF-AH-OVERRIDE-L2              PIC XX.
  3210         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3211         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3212
  3213         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3214         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3215
  3216         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3217         16  CF-AR-LAST-EL860-DT            PIC XX.
  3218         16  CF-MP-MONTH-END-DT             PIC XX.
  3219
  3220         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3221         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3222             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3223
  3224         16  CF-AR-MONTH-END-DT             PIC XX.
  3225
  3226         16  CF-CRDTCRD-USER                PIC X.
  3227             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3228             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3229
  3230         16  CF-CC-MONTH-END-DT             PIC XX.
  3231
  3232         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3233
  3234         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3235             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3236             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3237             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3238         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3239         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3240         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3241         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3242             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3243             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3244         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3245         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3246         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3247             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3248         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3249
  3250         16  CF-CL-ZIP-CODE.
  3251             20  CF-CL-ZIP-PRIME.
  3252                 24  CF-CL-ZIP-1ST          PIC X.
  3253                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3254                 24  FILLER                 PIC X(4).
  3255             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3256         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3257             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3258             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3259             20  FILLER                     PIC XXX.
  3260
  3261         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  58
* NSRASBL.cbl
  3262         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3263         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3264         16  CF-CO-OPTION-START-DATE        PIC XX.
  3265         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3266           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3267                                                      '3' '4'.
  3268           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3269           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3270           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3271           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3272           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3273           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3274
  3275         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3276
  3277         16  CF-PAYMENT-APPROVAL-LEVELS.
  3278             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3279             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3280             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3281             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3282             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3283             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3284
  3285         16  CF-END-USER-REPORTING-USER     PIC X.
  3286             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3287             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3288
  3289         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3290             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3291             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3292
  3293         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3294
  3295         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3296         16  FILLER                         PIC X.
  3297
  3298         16  CF-CREDIT-ARCHIVE-CNTL.
  3299             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3300             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3301             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3302
  3303         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3304
  3305         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3306             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3307             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3308
  3309         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3310             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3311             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3312
  3313         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3314
  3315         16  CF-CO-ACH-ID-CODE              PIC  X.
  3316             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3317             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3318             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3319         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  59
* NSRASBL.cbl
  3320         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3321         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3322         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3323         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3324         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3325         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3326         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3327         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3328                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3329         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3330                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3331
  3332         16  CF-CO-OVER-SHORT.
  3333             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3334             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3335
  3336*         16  FILLER                         PIC X(102).
  3337         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3338             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3339             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3340
  3341         16  CF-AH-APPROVAL-DAYS.
  3342             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3343             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3344             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3345             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3346
  3347         16  FILLER                         PIC X(82).
  3348****************************************************************
  3349*             PROCESSOR/USER RECORD                            *
  3350****************************************************************
  3351
  3352     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3353         16  CF-PROCESSOR-NAME              PIC X(30).
  3354         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3355         16  CF-PROCESSOR-TITLE             PIC X(26).
  3356         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3357                 88  MESSAGE-YES                VALUE 'Y'.
  3358                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3359
  3360*****************************************************
  3361****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3362****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3363****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3364****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3365*****************************************************
  3366
  3367         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3368             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3369             20  CF-APPLICATION-FORCE       PIC X.
  3370             20  CF-INDIVIDUAL-APP.
  3371                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3372                     28  CF-BROWSE-APP      PIC X.
  3373                     28  CF-UPDATE-APP      PIC X.
  3374
  3375         16  CF-CURRENT-TERM-ON             PIC X(4).
  3376         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3377             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  60
* NSRASBL.cbl
  3378             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3379             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3380             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3381             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3382             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3383             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3384         16  CF-PROCESSOR-CARRIER           PIC X.
  3385             88  NO-CARRIER-SECURITY            VALUE ' '.
  3386         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3387             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3388         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3389             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3390         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3391             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3392
  3393         16  CF-PROC-SYS-ACCESS-SW.
  3394             20  CF-PROC-CREDIT-CLAIMS-SW.
  3395                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3396                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3397                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3398                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3399             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3400                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3401                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3402             20  CF-PROC-LIFE-GNRLDGR-SW.
  3403                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3404                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3405                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3406                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3407             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3408                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3409                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3410         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3411             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3412             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3413         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3414
  3415         16  CF-APPROVAL-LEVEL                  PIC X.
  3416             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3417             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3418             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3419             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3420
  3421         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3422
  3423         16  CF-LANGUAGE-TYPE                   PIC X.
  3424             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3425             88  CF-LANG-IS-FR                      VALUE 'F'.
  3426
  3427         16  CF-CSR-IND                         PIC X.
  3428         16  FILLER                             PIC X(239).
  3429
  3430****************************************************************
  3431*             PROCESSOR/REMINDERS RECORD                       *
  3432****************************************************************
  3433
  3434     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3435         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  61
* NSRASBL.cbl
  3436             20  CF-START-REMIND-DT         PIC XX.
  3437             20  CF-END-REMIND-DT           PIC XX.
  3438             20  CF-REMINDER-TEXT           PIC X(50).
  3439         16  FILLER                         PIC X(296).
  3440
  3441
  3442****************************************************************
  3443*             STATE MASTER RECORD                              *
  3444****************************************************************
  3445
  3446     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3447         16  CF-STATE-ABBREVIATION          PIC XX.
  3448         16  CF-STATE-NAME                  PIC X(25).
  3449         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3450         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3451             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3452             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3453             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3454             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3455                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3456                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3457             20  CF-ST-PREM-REJECT-SW       PIC X.
  3458                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3459                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3460             20  CF-ST-REF-REJECT-SW        PIC X.
  3461                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3462                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3463         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3464         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3465         16  CF-ST-REFUND-RULES.
  3466             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3467             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3468             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3469         16  CF-ST-FST-PMT-EXTENSION.
  3470             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3471             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3472                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3473                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3474                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3475                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3476         16  CF-ST-STATE-CALL.
  3477             20  CF-ST-CALL-UNEARNED        PIC X.
  3478             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3479             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3480         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3481             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3482             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3483         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3484         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3485         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3486         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3487         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3488         16  FILLER                         PIC X.
  3489         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3490             20  CF-ST-BENEFIT-CD           PIC XX.
  3491             20  CF-ST-BENEFIT-KIND         PIC X.
  3492                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3493                 88  CF-ST-AH-KIND              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  62
* NSRASBL.cbl
  3494             20  CF-ST-REM-TERM-CALC        PIC X.
  3495                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3496                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3497                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3498                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3499                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3500                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3501                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3502                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3503
  3504             20  CF-ST-REFUND-CALC          PIC X.
  3505                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3506                 88  ST-REFD-BY-R78             VALUE '1'.
  3507                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3508                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3509                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3510                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3511                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3512                 88  ST-REFD-UTAH               VALUE '7'.
  3513                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3514                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3515                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3516
  3517             20  CF-ST-EARNING-CALC         PIC X.
  3518                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3519                 88  ST-EARN-BY-R78             VALUE '1'.
  3520                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3521                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3522                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3523                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3524                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3525                 88  ST-EARN-MEAN               VALUE '8'.
  3526                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3527
  3528             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3529                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3530                 88  ST-OVRD-BY-R78             VALUE '1'.
  3531                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3532                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3533                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3534                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3535                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3536                 88  ST-OVRD-MEAN               VALUE '8'.
  3537                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3538             20  FILLER                     PIC X.
  3539
  3540         16  CF-ST-COMMISSION-CAPS.
  3541             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3542             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3543             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3544             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3545         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3546                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3547
  3548         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3549
  3550         16  CF-ST-STATUTORY-INTEREST.
  3551             20  CF-ST-STAT-DATE-FROM       PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  63
* NSRASBL.cbl
  3552                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3553                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3554             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3555             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3556             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3557             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3558             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3559
  3560         16  CF-ST-OVER-SHORT.
  3561             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3562             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3563
  3564         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3565
  3566         16  CF-ST-RT-CALC                  PIC X.
  3567
  3568         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3569         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3570         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3571         16  CF-ST-RF-LR-CALC               PIC X.
  3572         16  CF-ST-RF-LL-CALC               PIC X.
  3573         16  CF-ST-RF-LN-CALC               PIC X.
  3574         16  CF-ST-RF-AH-CALC               PIC X.
  3575         16  CF-ST-RF-CP-CALC               PIC X.
  3576*        16  FILLER                         PIC X(206).
  3577*CIDMOD         16  FILLER                         PIC X(192).
  3578         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3579             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3580         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3581         16  CF-ST-VFY-2ND-BENE             PIC X.
  3582         16  FILLER                         PIC X(186).
  3583
  3584****************************************************************
  3585*             BENEFIT MASTER RECORD                            *
  3586****************************************************************
  3587
  3588     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3589         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3590             20  CF-BENEFIT-CODE            PIC XX.
  3591             20  CF-BENEFIT-NUMERIC  REDEFINES
  3592                 CF-BENEFIT-CODE            PIC XX.
  3593             20  CF-BENEFIT-ALPHA           PIC XXX.
  3594             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3595             20  CF-BENEFIT-COMMENT         PIC X(10).
  3596
  3597             20  CF-LF-COVERAGE-TYPE        PIC X.
  3598                 88  CF-REDUCING                VALUE 'R'.
  3599                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3600
  3601             20  CF-SPECIAL-CALC-CD         PIC X.
  3602                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3603                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3604                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3605                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3606                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3607                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3608                 88  CF-FARM-PLAN               VALUE 'F'.
  3609                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  64
* NSRASBL.cbl
  3610                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3611                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3612                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3613                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3614                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3615                 88  CF-PRUDENTIAL              VALUE 'P'.
  3616                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3617                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3618                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3619                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3620                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3621                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3622
  3623             20  CF-JOINT-INDICATOR         PIC X.
  3624                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3625
  3626*            20  FILLER                     PIC X(12).
  3627             20  FILLER                     PIC X(11).
  3628             20  CF-BENEFIT-CATEGORY        PIC X.
  3629             20  CF-LOAN-TYPE               PIC X(8).
  3630
  3631             20  CF-CO-REM-TERM-CALC        PIC X.
  3632                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3633                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3634                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3635                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3636                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3637
  3638             20  CF-CO-EARNINGS-CALC        PIC X.
  3639                 88  CO-EARN-BY-R78             VALUE '1'.
  3640                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3641                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3642                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3643                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3644                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3645                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3646                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3647
  3648             20  CF-CO-REFUND-CALC          PIC X.
  3649                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3650                 88  CO-REFD-BY-R78             VALUE '1'.
  3651                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3652                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3653                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3654                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3655                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3656                 88  CO-REFD-MEAN               VALUE '8'.
  3657                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3658                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3659                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3660
  3661             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3662                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3663                 88  CO-OVRD-BY-R78             VALUE '1'.
  3664                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3665                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3666                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3667                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  65
* NSRASBL.cbl
  3668                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3669                 88  CO-OVRD-MEAN               VALUE '8'.
  3670                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3671
  3672             20  CF-CO-BEN-I-G-CD           PIC X.
  3673                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3674                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3675                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3676
  3677         16  FILLER                         PIC X(304).
  3678
  3679
  3680****************************************************************
  3681*             CARRIER MASTER RECORD                            *
  3682****************************************************************
  3683
  3684     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3685         16  CF-ADDRESS-DATA.
  3686             20  CF-MAIL-TO-NAME            PIC X(30).
  3687             20  CF-IN-CARE-OF              PIC X(30).
  3688             20  CF-ADDRESS-LINE-1          PIC X(30).
  3689             20  CF-ADDRESS-LINE-2          PIC X(30).
  3690             20  CF-CITY-STATE              PIC X(30).
  3691             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3692             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3693
  3694         16  CF-CLAIM-NO-CONTROL.
  3695             20  CF-CLAIM-NO-METHOD         PIC X.
  3696                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3697                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3698                 88  CLAIM-NO-SEQ               VALUE '3'.
  3699                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3700             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3701                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3702                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3703                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3704
  3705         16  CF-CHECK-NO-CONTROL.
  3706             20  CF-CHECK-NO-METHOD         PIC X.
  3707                 88  CHECK-NO-MANUAL            VALUE '1'.
  3708                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3709                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3710                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3711             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3712                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3713
  3714         16  CF-DOMICILE-STATE              PIC XX.
  3715
  3716         16  CF-EXPENSE-CONTROLS.
  3717             20  CF-EXPENSE-METHOD          PIC X.
  3718                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3719                 88  DOLLARS-PER-PMT            VALUE '2'.
  3720                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3721                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3722             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3723             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3724
  3725         16  CF-CORRESPONDENCE-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  66
* NSRASBL.cbl
  3726             20  CF-LETTER-RESEND-OPT       PIC X.
  3727                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3728                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3729             20  FILLER                     PIC X(4).
  3730
  3731         16  CF-RESERVE-CONTROLS.
  3732             20  CF-MANUAL-SW               PIC X.
  3733                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3734             20  CF-FUTURE-SW               PIC X.
  3735                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3736             20  CF-PTC-SW                  PIC X.
  3737                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3738             20  CF-IBNR-SW                 PIC X.
  3739                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3740             20  CF-PTC-LF-SW               PIC X.
  3741                 88  CF-LF-PTC-USED             VALUE '1'.
  3742             20  CF-CDT-ACCESS-METHOD       PIC X.
  3743                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3744                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3745                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3746             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3747
  3748         16  CF-CLAIM-CALC-METHOD           PIC X.
  3749             88  360-PLUS-MONTHS                VALUE '1'.
  3750             88  365-PLUS-MONTHS                VALUE '2'.
  3751             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3752             88  360-DAILY                      VALUE '4'.
  3753             88  365-DAILY                      VALUE '5'.
  3754
  3755         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3756         16  FILLER                         PIC X(11).
  3757
  3758         16  CF-LIMIT-AMOUNTS.
  3759             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3760             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3761             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3762             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3763             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3764             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3765             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3766             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3767             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3768             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3769
  3770         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3771         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3772         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3773
  3774         16  CF-ZIP-CODE.
  3775             20  CF-ZIP-PRIME.
  3776                 24  CF-ZIP-1ST             PIC X.
  3777                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3778                 24  FILLER                 PIC X(4).
  3779             20  CF-ZIP-PLUS4               PIC X(4).
  3780         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3781             20  CF-CAN-POSTAL-1            PIC XXX.
  3782             20  CF-CAN-POSTAL-2            PIC XXX.
  3783             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  67
* NSRASBL.cbl
  3784
  3785         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3786         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3787         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3788
  3789         16  CF-RATING-SWITCH               PIC X.
  3790             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3791             88  CF-NO-RATING                   VALUE 'N'.
  3792
  3793         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3794
  3795         16  CF-CARRIER-OVER-SHORT.
  3796             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3797             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3798
  3799         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3800         16  CF-SECPAY-SWITCH               PIC X.
  3801             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3802             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3803         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3804         16  FILLER                         PIC X(448).
  3805*        16  FILLER                         PIC X(452).
  3806
  3807
  3808****************************************************************
  3809*             MORTALITY MASTER RECORD                          *
  3810****************************************************************
  3811
  3812     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3813         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3814                                INDEXED BY CF-MORT-NDX.
  3815             20  CF-MORT-TABLE              PIC X(5).
  3816             20  CF-MORT-TABLE-TYPE         PIC X.
  3817                 88  CF-MORT-JOINT              VALUE 'J'.
  3818                 88  CF-MORT-SINGLE             VALUE 'S'.
  3819                 88  CF-MORT-COMBINED           VALUE 'C'.
  3820                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3821                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3822             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3823             20  CF-MORT-AGE-METHOD         PIC XX.
  3824                 88  CF-AGE-LAST                VALUE 'AL'.
  3825                 88  CF-AGE-NEAR                VALUE 'AN'.
  3826             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3827             20  CF-MORT-ADJUSTMENT-DIRECTION
  3828                                            PIC X.
  3829                 88  CF-MINUS                   VALUE '-'.
  3830                 88  CF-PLUS                    VALUE '+'.
  3831             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3832             20  CF-MORT-JOINT-CODE         PIC X.
  3833                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3834             20  CF-MORT-PC-Q               PIC X.
  3835                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3836             20  CF-MORT-TABLE-CODE         PIC X(4).
  3837             20  CF-MORT-COMMENTS           PIC X(15).
  3838             20  FILLER                     PIC X(14).
  3839
  3840         16  FILLER                         PIC X(251).
  3841
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  68
* NSRASBL.cbl
  3842
  3843****************************************************************
  3844*             BUSSINESS TYPE MASTER RECORD                     *
  3845****************************************************************
  3846
  3847     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3848* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3849* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3850* AND RECORD 05 IS TYPES 81-99
  3851         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3852             20  CF-BUSINESS-TITLE          PIC  X(19).
  3853             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3854                                            PIC S9V9(4) COMP-3.
  3855             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3856             20  FILLER                     PIC  X.
  3857         16  FILLER                         PIC  X(248).
  3858
  3859
  3860****************************************************************
  3861*             TERMINAL MASTER RECORD                           *
  3862****************************************************************
  3863
  3864     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3865
  3866         16  CF-COMPANY-TERMINALS.
  3867             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3868                                  PIC X(4).
  3869         16  FILLER               PIC X(248).
  3870
  3871
  3872****************************************************************
  3873*             LIFE EDIT MASTER RECORD                          *
  3874****************************************************************
  3875
  3876     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3877         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3878             20  CF-LIFE-CODE-IN            PIC XX.
  3879             20  CF-LIFE-CODE-OUT           PIC XX.
  3880         16  FILLER                         PIC X(248).
  3881
  3882
  3883****************************************************************
  3884*             AH EDIT MASTER RECORD                            *
  3885****************************************************************
  3886
  3887     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3888         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3889             20  CF-AH-CODE-IN              PIC XXX.
  3890             20  CF-AH-CODE-OUT             PIC XX.
  3891         16  FILLER                         PIC X(248).
  3892
  3893
  3894****************************************************************
  3895*             CREDIBILITY TABLES                               *
  3896****************************************************************
  3897
  3898     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3899         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  69
* NSRASBL.cbl
  3900                             INDEXED BY CF-CRDB-NDX.
  3901             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3902             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3903             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3904         16  FILLER                         PIC  X(332).
  3905
  3906
  3907****************************************************************
  3908*             REPORT CUSTOMIZATION RECORD                      *
  3909****************************************************************
  3910
  3911     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3912         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3913             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3914             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3915             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3916**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3917****       A T-TRANSFER.                                   ****
  3918             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3919
  3920         16  FILLER                         PIC XX.
  3921
  3922         16  CF-CARRIER-CNTL-OPT.
  3923             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3924                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3925                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3926             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3927                                            PIC X.
  3928         16  CF-GROUP-CNTL-OPT.
  3929             20  CF-GROUP-OPT-SEQ           PIC 9.
  3930                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3931                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3932             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3933                                            PIC X(6).
  3934         16  CF-STATE-CNTL-OPT.
  3935             20  CF-STATE-OPT-SEQ           PIC 9.
  3936                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3937                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3938             20  CF-STATE-SELECT OCCURS 3 TIMES
  3939                                            PIC XX.
  3940         16  CF-ACCOUNT-CNTL-OPT.
  3941             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3942                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3943                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3944             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3945                                            PIC X(10).
  3946         16  CF-BUS-TYP-CNTL-OPT.
  3947             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3948                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3949                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3950             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3951                                            PIC XX.
  3952         16  CF-LF-TYP-CNTL-OPT.
  3953             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3954                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3955                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3956             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3957                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  70
* NSRASBL.cbl
  3958         16  CF-AH-TYP-CNTL-OPT.
  3959             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3960                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3961                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3962             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3963                                            PIC XX.
  3964         16  CF-REPTCD1-CNTL-OPT.
  3965             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3966                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3967                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3968             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3969                                            PIC X(10).
  3970         16  CF-REPTCD2-CNTL-OPT.
  3971             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3972                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3973                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3974             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3975                                            PIC X(10).
  3976         16  CF-USER1-CNTL-OPT.
  3977             20  CF-USER1-OPT-SEQ           PIC 9.
  3978                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3979                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3980             20  CF-USER1-SELECT OCCURS 3 TIMES
  3981                                            PIC X(10).
  3982         16  CF-USER2-CNTL-OPT.
  3983             20  CF-USER2-OPT-SEQ           PIC 9.
  3984                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3985                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3986             20  CF-USER2-SELECT OCCURS 3 TIMES
  3987                                            PIC X(10).
  3988         16  CF-USER3-CNTL-OPT.
  3989             20  CF-USER3-OPT-SEQ           PIC 9.
  3990                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3991                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3992             20  CF-USER3-SELECT OCCURS 3 TIMES
  3993                                            PIC X(10).
  3994         16  CF-USER4-CNTL-OPT.
  3995             20  CF-USER4-OPT-SEQ           PIC 9.
  3996                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3997                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3998             20  CF-USER4-SELECT OCCURS 3 TIMES
  3999                                            PIC X(10).
  4000         16  CF-USER5-CNTL-OPT.
  4001             20  CF-USER5-OPT-SEQ           PIC 9.
  4002                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4003                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4004             20  CF-USER5-SELECT OCCURS 3 TIMES
  4005                                            PIC X(10).
  4006         16  CF-REINS-CNTL-OPT.
  4007             20  CF-REINS-OPT-SEQ           PIC 9.
  4008                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4009                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4010             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4011                 24  CF-REINS-PRIME         PIC XXX.
  4012                 24  CF-REINS-SUB           PIC XXX.
  4013
  4014         16  CF-AGENT-CNTL-OPT.
  4015             20  CF-AGENT-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  71
* NSRASBL.cbl
  4016                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4017                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4018             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4019                                            PIC X(10).
  4020
  4021         16  FILLER                         PIC X(43).
  4022
  4023         16  CF-LOSS-RATIO-SELECT.
  4024             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4025             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4026         16  CF-ENTRY-DATE-SELECT.
  4027             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4028             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4029         16  CF-EFFECTIVE-DATE-SELECT.
  4030             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4031             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4032
  4033         16  CF-EXCEPTION-LIST-IND          PIC X.
  4034             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4035
  4036         16  FILLER                         PIC X(318).
  4037
  4038****************************************************************
  4039*                  EXCEPTION REPORTING RECORD                  *
  4040****************************************************************
  4041
  4042     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4043         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4044             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4045
  4046         16  CF-COMBINED-LIFE-AH-OPT.
  4047             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4048             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4049             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4050             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4051
  4052         16  CF-LIFE-OPT.
  4053             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4054             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4055             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4056             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4057             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4058             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4059             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4060             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4061             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4062             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4063
  4064         16  CF-AH-OPT.
  4065             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4066             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4067             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4068             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4069             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4070             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4071             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4072             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4073             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  72
* NSRASBL.cbl
  4074             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4075
  4076         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4077             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4078             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4079             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4080
  4081         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4082
  4083         16  FILLER                         PIC X(673).
  4084
  4085
  4086****************************************************************
  4087*             MORTGAGE SYSTEM PLAN RECORD                      *
  4088****************************************************************
  4089
  4090     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4091         16  CF-PLAN-TYPE                   PIC X.
  4092             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4093             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4094             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4095         16  CF-PLAN-ABBREV                 PIC XXX.
  4096         16  CF-PLAN-DESCRIPT               PIC X(10).
  4097         16  CF-PLAN-NOTES                  PIC X(20).
  4098         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4099         16  CF-PLAN-UNDERWRITING.
  4100             20  CF-PLAN-TERM-DATA.
  4101                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4102                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4103             20  CF-PLAN-AGE-DATA.
  4104                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4105                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4106                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4107             20  CF-PLAN-BENEFIT-DATA.
  4108                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4109                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4110                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4111                                            PIC S9(7)V99  COMP-3.
  4112         16  CF-PLAN-POLICY-FORMS.
  4113             20  CF-POLICY-FORM             PIC X(12).
  4114             20  CF-MASTER-APPLICATION      PIC X(12).
  4115             20  CF-MASTER-POLICY           PIC X(12).
  4116         16  CF-PLAN-RATING.
  4117             20  CF-RATE-CODE               PIC X(5).
  4118             20  CF-SEX-RATING              PIC X.
  4119                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4120                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4121             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4122             20  CF-SUB-STD-TYPE            PIC X.
  4123                 88  CF-PCT-OF-PREM            VALUE '1'.
  4124                 88  CF-PCT-OF-BENE            VALUE '2'.
  4125         16  CF-PLAN-PREM-TOLERANCES.
  4126             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4127             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4128         16  CF-PLAN-PYMT-TOLERANCES.
  4129             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4130             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4131         16  CF-PLAN-MISC-DATA.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  73
* NSRASBL.cbl
  4132             20  FILLER                     PIC X.
  4133             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4134             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4135         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4136         16  CF-PLAN-IND-GRP                PIC X.
  4137             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4138                                                     '1'.
  4139             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4140                                                     '2'.
  4141         16  CF-MIB-SEARCH-SW               PIC X.
  4142             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4143             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4144             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4145             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4146         16  CF-ALPHA-SEARCH-SW             PIC X.
  4147             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4148             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4149             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4150             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4151             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4152             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4153             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4154             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4155             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4156             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4157                                                     'A' 'B' 'C'
  4158                                                     'X' 'Y' 'Z'.
  4159         16  CF-EFF-DT-RULE-SW              PIC X.
  4160             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4161             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4162             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4163             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4164             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4165         16  FILLER                         PIC X(4).
  4166         16  CF-HEALTH-QUESTIONS            PIC X.
  4167             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4168         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4169         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4170         16  CF-PLAN-SNGL-JNT               PIC X.
  4171             88  CF-COMBINED-PLAN              VALUE 'C'.
  4172             88  CF-JNT-PLAN                   VALUE 'J'.
  4173             88  CF-SNGL-PLAN                  VALUE 'S'.
  4174         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4175         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4176         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4177         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4178         16  CF-RERATE-CNTL                 PIC  X.
  4179             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4180             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4181             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4182             88  CF-AUTO-RECALC                 VALUE '4'.
  4183         16  CF-BENEFIT-TYPE                PIC  X.
  4184             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4185             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4186         16  CF-POLICY-FEE                  PIC S999V99
  4187                                                    COMP-3.
  4188         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4189         16  CF-2ND-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  74
* NSRASBL.cbl
  4190         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4191         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4192         16  FILLER                         PIC  X(32).
  4193         16  CF-TERMINATION-FORM            PIC  X(04).
  4194         16  FILLER                         PIC  X(08).
  4195         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4196                                                       COMP-3.
  4197         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4198         16  CF-ISSUE-LETTER                PIC  X(4).
  4199         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4200         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4201             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4202             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4203         16  CF-MP-REFUND-CALC              PIC X.
  4204             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4205             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4206             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4207             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4208             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4209             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4210             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4211             88  CF-MP-REFD-MEAN                VALUE '8'.
  4212         16  CF-ALT-RATE-CODE               PIC  X(5).
  4213
  4214
  4215         16  FILLER                         PIC X(498).
  4216****************************************************************
  4217*             MORTGAGE COMPANY MASTER RECORD                   *
  4218****************************************************************
  4219
  4220     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4221         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4222         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4223             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4224             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4225             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4226             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4227             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4228
  4229         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4230         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4231         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4232         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4233         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4234
  4235         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4236             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4237         16  CF-MP-RECON-USE-IND            PIC X(1).
  4238             88  CF-MP-USE-RECON             VALUE 'Y'.
  4239         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4240             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4241         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4242             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4243             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4244         16  FILLER                         PIC X(1).
  4245         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4246             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4247         16  CF-MORTG-MIB-VERSION           PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  75
* NSRASBL.cbl
  4248             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4249             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4250             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4251         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4252             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4253                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4254             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4255                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4256             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4257                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4258             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4259                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4260             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4261                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4262             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4263                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4264         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4265         16  FILLER                         PIC X(7).
  4266         16  CF-MORTG-DESTINATION-SYMBOL.
  4267             20  CF-MORTG-MIB-COMM          PIC X(5).
  4268             20  CF-MORTG-MIB-TERM          PIC X(5).
  4269         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4270             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4271         16  FILLER                         PIC X(03).
  4272         16  CF-MP-CHECK-NO-CONTROL.
  4273             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4274                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4275                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4276                                                ' ' LOW-VALUES.
  4277                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4278                                               VALUE '3'.
  4279         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4280         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4281         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4282             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4283                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4284             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4285                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4286             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4287                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4288             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4289                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4290             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4291                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4292             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4293                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4294         16  CF-MORTG-BILLING-AREA.
  4295             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4296                                            PIC X.
  4297         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4298         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4299         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4300         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4301             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4302             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4303         16  FILLER                         PIC X.
  4304         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4305             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  76
* NSRASBL.cbl
  4306             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4307         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4308         16  FILLER                         PIC X(8).
  4309         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4310         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4311         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4312         16  CF-ACH-COMPANY-ID.
  4313             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4314                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4315                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4316                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4317             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4318         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4319             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4320         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4321             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4322             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4323         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4324         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4325         16  FILLER                         PIC X(536).
  4326
  4327****************************************************************
  4328*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4329****************************************************************
  4330
  4331     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4332         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4333             20  CF-FEMALE-HEIGHT.
  4334                 24  CF-FEMALE-FT           PIC 99.
  4335                 24  CF-FEMALE-IN           PIC 99.
  4336             20  CF-FEMALE-MIN-WT           PIC 999.
  4337             20  CF-FEMALE-MAX-WT           PIC 999.
  4338         16  FILLER                         PIC X(428).
  4339
  4340     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4341         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4342             20  CF-MALE-HEIGHT.
  4343                 24  CF-MALE-FT             PIC 99.
  4344                 24  CF-MALE-IN             PIC 99.
  4345             20  CF-MALE-MIN-WT             PIC 999.
  4346             20  CF-MALE-MAX-WT             PIC 999.
  4347         16  FILLER                         PIC X(428).
  4348******************************************************************
  4349*             AUTOMATIC ACTIVITY RECORD                          *
  4350******************************************************************
  4351     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4352         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4353             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4354             20  CF-SYS-LETTER-ID           PIC X(04).
  4355             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4356             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4357             20  CF-SYS-RESET-SW            PIC X(01).
  4358             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4359             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4360
  4361         16  FILLER                         PIC X(50).
  4362
  4363         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  77
* NSRASBL.cbl
  4364             20  CF-USER-ACTIVE-SW          PIC X(01).
  4365             20  CF-USER-LETTER-ID          PIC X(04).
  4366             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4367             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4368             20  CF-USER-RESET-SW           PIC X(01).
  4369             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4370             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4371             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4372
  4373         16  FILLER                         PIC X(246).
  4374*                                COPY NSCASVARS.
  4375******************************************************************
  4376*                   C H A N G E   L O G
  4377*
  4378* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4379*-----------------------------------------------------------------
  4380*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4381* EFFECTIVE    NUMBER
  4382*-----------------------------------------------------------------
  4383* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
  4384* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
  4385******************************************************************
  4386 01 NAPER-OUTPUT-DATA.
  4387    05  F                       PIC X(07) VALUE "LETTER=".
  4388    05  OUT-LETTER              PIC X(06) VALUE SPACES.
  4389    05  F                       PIC X(08) VALUE "~PROCID=".
  4390    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
  4391    05  F                       PIC X(10) VALUE "~PROCNAME=".
  4392    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
  4393    05  F                       PIC X(11) VALUE "~PROCTITLE=".
  4394    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
  4395    05  F                       PIC X(09) VALUE "~CSRNAME=".
  4396    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
  4397    05  F                       PIC X(10) VALUE "~CSRTITLE=".
  4398    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
  4399    05  F                       PIC X(06) VALUE "~CARR=".
  4400    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
  4401    05  F                       PIC X(10) VALUE "~GROUPING=".
  4402    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
  4403    05  F                       PIC X(08) VALUE "~CERTST=".
  4404    05  OUT-STATE               PIC X(02) VALUE SPACES.
  4405    05  F                       PIC X(09) VALUE "~ACCOUNT=".
  4406    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
  4407    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
  4408    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
  4409    05  F                       PIC X(07) VALUE "~CRTNO=".
  4410    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
  4411    05  F                       PIC X(08) VALUE "~CRTSUF=".
  4412    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
  4413    05  F                       PIC X(08) VALUE "~ILNAME=".
  4414    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
  4415    05  F                       PIC X(08) VALUE "~IFNAME=".
  4416    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
  4417    05  F                       PIC X(08) VALUE "~IFINIT=".
  4418    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
  4419    05  F                       PIC X(08) VALUE "~IMINIT=".
  4420    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
  4421    05  F                       PIC X(09) VALUE "~IISSAGE=".
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  78
* NSRASBL.cbl
  4422    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
  4423    05  F                       PIC X(06) VALUE "~ISEX=".
  4424    05  OUT-ISEX                PIC X(01) VALUE SPACES.
  4425    05  F                       PIC X(10) VALUE "~INSADDR1=".
  4426    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
  4427    05  F                       PIC X(10) VALUE "~INSADDR2=".
  4428    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
  4429    05  F                       PIC X(09) VALUE "~INSCITY=".
  4430    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
  4431    05  F                       PIC X(10) VALUE "~INSSTATE=".
  4432    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
  4433    05  F                       PIC X(08) VALUE "~INSZIP=".
  4434    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
  4435    05  F                       PIC X(05) VALUE "~SSN=".
  4436    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
  4437    05  F                       PIC X(07) VALUE "~MEMNO=".
  4438    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
  4439    05  F                       PIC X(08) VALUE "~JLNAME=".
  4440    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
  4441    05  F                       PIC X(08) VALUE "~JFNAME=".
  4442    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
  4443    05  F                       PIC X(08) VALUE "~JMINIT=".
  4444    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
  4445    05  F                       PIC X(08) VALUE "~JNTAGE=".
  4446    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
  4447    05  F                       PIC X(10) VALUE "~ACCTNAME=".
  4448    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
  4449    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
  4450    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
  4451    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
  4452    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
  4453    05  F                       PIC X(10) VALUE "~ACCTCITY=".
  4454    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
  4455    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
  4456    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
  4457    05  F                       PIC X(09) VALUE "~ACCTZIP=".
  4458    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
  4459    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
  4460    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
  4461    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
  4462    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
  4463    05  F                       PIC X(09) VALUE "~BUSTYPE=".
  4464    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
  4465    05  F                       PIC X(10) VALUE "~BENENAME=".
  4466    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
  4467    05  F                       PIC X(11) VALUE "~BENEADDR1=".
  4468    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
  4469    05  F                       PIC X(11) VALUE "~BENEADDR2=".
  4470    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
  4471    05  F                       PIC X(10) VALUE "~BENECITY=".
  4472    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
  4473    05  F                       PIC X(11) VALUE "~BENESTATE=".
  4474    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
  4475    05  F                       PIC X(09) VALUE "~BENEZIP=".
  4476    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
  4477    05  F                       PIC X(10) VALUE "~CARRNAME=".
  4478    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
  4479    05  F                       PIC X(08) VALUE "~RESPNO=".
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  79
* NSRASBL.cbl
  4480    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
  4481    05  F                       PIC X(12) VALUE "~COACCTNAME=".
  4482    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
  4483    05  F                       PIC X(12) VALUE "~COMAILNAME=".
  4484    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
  4485    05  F                       PIC X(11) VALUE "~COMPADDR1=".
  4486    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
  4487    05  F                       PIC X(11) VALUE "~COMPADDR2=".
  4488    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
  4489    05  F                       PIC X(10) VALUE "~COMPCITY=".
  4490    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
  4491    05  F                       PIC X(11) VALUE "~COMPSTATE=".
  4492    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
  4493    05  F                       PIC X(09) VALUE "~COMPZIP=".
  4494    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
  4495    05  F                       PIC X(11) VALUE "~COMPPHONE=".
  4496    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
  4497    05  F                       PIC X(09) VALUE "~COMPFAX=".
  4498    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
  4499    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
  4500    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
  4501    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
  4502    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
  4503    05  F                       PIC X(08) VALUE "~RPTCD1=".
  4504    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
  4505    05  F                       PIC X(08) VALUE "~RPTCD2=".
  4506    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
  4507    05  F                       PIC X(09) VALUE "~ENTRYDT=".
  4508    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
  4509    05  F                       PIC X(07) VALUE "~BATCH=".
  4510    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
  4511    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
  4512    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
  4513    05  F                       PIC X(10) VALUE "~1STPMTDT=".
  4514    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
  4515    05  F                       PIC X(05) VALUE "~APR=".
  4516    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
  4517    05  F                       PIC X(08) VALUE "~LNTERM=".
  4518    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
  4519    05  F                       PIC X(11) VALUE "~RATECLASS=".
  4520    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
  4521    05  F                       PIC X(09) VALUE "~EXTDAYS=".
  4522    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
  4523    05  F                       PIC X(09) VALUE "~CSRCODE=".
  4524    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
  4525    05  F                       PIC X(07) VALUE "~UCODE=".
  4526    05  OUT-UCODE               PIC X(01) VALUE SPACES.
  4527    05  F                       PIC X(10) VALUE "~PREMTYPE=".
  4528    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
  4529    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
  4530    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
  4531    05  F                       PIC X(06) VALUE "~SKIP=".
  4532    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
  4533    05  F                       PIC X(06) VALUE "~MODE=".
  4534    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
  4535    05  F                       PIC X(09) VALUE "~LOANOFF=".
  4536    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
  4537    05  F                       PIC X(06) VALUE "~RTBL=".
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  80
* NSRASBL.cbl
  4538    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
  4539    05  F                       PIC X(10) VALUE "~SPECREIN=".
  4540    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
  4541    05  F                       PIC X(09) VALUE "~LFBENCD=".
  4542    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
  4543    05  F                       PIC X(08) VALUE "~LFTERM=".
  4544    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
  4545    05  F                       PIC X(07) VALUE "~LFDEV=".
  4546    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
  4547    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
  4548    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
  4549    05  F                       PIC X(07) VALUE "~LFBEN=".
  4550    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
  4551    05  F                       PIC X(08) VALUE "~LFPREM=".
  4552    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4553    05  F                       PIC X(08) VALUE "~LFABEN=".
  4554    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4555    05  F                       PIC X(09) VALUE "~LFAPREM=".
  4556    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
  4557    05  F                       PIC X(07) VALUE "~LFNSP=".
  4558    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4559    05  F                       PIC X(08) VALUE "~LFRBEN=".
  4560    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4561    05  F                       PIC X(07) VALUE "~LFCAN=".
  4562    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4563    05  F                       PIC X(07) VALUE "~LFDTH=".
  4564    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
  4565    05  F                       PIC X(08) VALUE "~LFRATE=".
  4566    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4567    05  F                       PIC X(09) VALUE "~LFARATE=".
  4568    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
  4569    05  F                       PIC X(09) VALUE "~LFEXPDT=".
  4570    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
  4571    05  F                       PIC X(08) VALUE "~LFSTAT=".
  4572    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
  4573    05  F                       PIC X(09) VALUE "~LFCANDT=".
  4574    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
  4575    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
  4576    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4577    05  F                       PIC X(07) VALUE "~DTHDT=".
  4578    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
  4579    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
  4580    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
  4581    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
  4582    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4583    05  F                       PIC X(08) VALUE "~LFCOMM=".
  4584    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4585    05  F                       PIC X(11) VALUE "~LFBENDESC=".
  4586    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
  4587    05  F                       PIC X(11) VALUE "~LFBENABRV=".
  4588    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
  4589    05  F                       PIC X(09) VALUE "~AHBENCD=".
  4590    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
  4591    05  F                       PIC X(08) VALUE "~AHTERM=".
  4592    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
  4593    05  F                       PIC X(11) VALUE "~AHCRITPER=".
  4594    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
  4595    05  F                       PIC X(09) VALUE "~AHDEVCD=".
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  81
* NSRASBL.cbl
  4596    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
  4597    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
  4598    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
  4599    05  F                       PIC X(07) VALUE "~AHBEN=".
  4600    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
  4601    05  F                       PIC X(08) VALUE "~AHPREM=".
  4602    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4603    05  F                       PIC X(07) VALUE "~AHNSP=".
  4604    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4605    05  F                       PIC X(07) VALUE "~AHCAN=".
  4606    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4607    05  F                       PIC X(10) VALUE "~AHITDPMT=".
  4608    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
  4609    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
  4610    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4611    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
  4612    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
  4613    05  F                       PIC X(08) VALUE "~AHRATE=".
  4614    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4615    05  F                       PIC X(09) VALUE "~AHEXPDT=".
  4616    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
  4617    05  F                       PIC X(08) VALUE "~AHSTAT=".
  4618    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
  4619    05  F                       PIC X(09) VALUE "~AHCANDT=".
  4620    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
  4621    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
  4622    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4623    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
  4624    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4625    05  F                       PIC X(08) VALUE "~AHCOMM=".
  4626    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4627    05  F                       PIC X(11) VALUE "~AHBENDESC=".
  4628    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
  4629    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
  4630    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
  4631    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
  4632    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
  4633    05  F                       PIC X(08) VALUE "~AHWAIT=".
  4634    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
  4635    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
  4636    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
  4637    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
  4638                                PIC X(2).
  4639    05  F                       PIC X(09) VALUE "~TOTPREM=".
  4640    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
  4641    05  F                       PIC X(08) VALUE "~TOTREF=".
  4642    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
  4643    05  F                       PIC X(08) VALUE "~SEXPDT=".
  4644    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
  4645    05  F                       PIC X(07) VALUE "~STERM=".
  4646    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
  4647    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
  4648    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
  4649    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
  4650    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
  4651    05  F                       PIC X(11) VALUE "~IORIGINIT=".
  4652    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
  4653    05  F                       PIC X(10) VALUE "~IORIGAGE=".
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  82
* NSRASBL.cbl
  4654    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
  4655    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
  4656    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
  4657    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
  4658    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
  4659    05  F                       PIC X(11) VALUE "~JORIGINIT=".
  4660    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
  4661    05  F                       PIC X(10) VALUE "~JORIGAGE=".
  4662    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
  4663    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
  4664    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
  4665    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
  4666    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
  4667    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
  4668    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
  4669    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
  4670                                PIC X(12).
  4671    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
  4672    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
  4673    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
  4674                                PIC X(12).
  4675    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
  4676    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
  4677    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
  4678    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
  4679    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
  4680    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4681    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
  4682    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
  4683    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
  4684                                PIC X(12).
  4685    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
  4686    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
  4687    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
  4688                                PIC X(10).
  4689    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
  4690    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
  4691    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
  4692    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
  4693    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
  4694    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
  4695    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
  4696    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
  4697    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
  4698    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
  4699    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
  4700    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
  4701    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
  4702                                PIC X(10).
  4703    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
  4704    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
  4705    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
  4706                                PIC X(10).
  4707    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
  4708    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
  4709    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
  4710    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
  4711    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  83
* NSRASBL.cbl
  4712    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4713    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
  4714    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
  4715    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
  4716    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
  4717    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
  4718    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
  4719    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
  4720    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
  4721    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
  4722    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
  4723    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
  4724    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
  4725    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
  4726                                PIC X(2).
  4727    05  F                       PIC X(09) VALUE "~OSEXPDT=".
  4728    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
  4729    05  F                       PIC X(08) VALUE "~OSTERM=".
  4730    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
  4731    05  F                       PIC X(11) VALUE "~INEWLNAME=".
  4732    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
  4733    05  F                       PIC X(11) VALUE "~INEWFNAME=".
  4734    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
  4735    05  F                       PIC X(10) VALUE "~INEWINIT=".
  4736    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
  4737    05  F                       PIC X(09) VALUE "~INEWAGE=".
  4738    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
  4739    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
  4740                                PIC X(09).
  4741    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
  4742    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
  4743    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
  4744    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
  4745    05  F                       PIC X(10) VALUE "~JNEWINIT=".
  4746    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
  4747    05  F                       PIC X(09) VALUE "~JNEWAGE=".
  4748    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
  4749    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
  4750                                PIC X(09).
  4751    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
  4752    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
  4753    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
  4754    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
  4755    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
  4756                                PIC X(09).
  4757    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
  4758    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
  4759    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
  4760                                PIC X(12).
  4761    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
  4762    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
  4763    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
  4764                                PIC X(10).
  4765    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
  4766    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
  4767    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
  4768    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
  4769    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  84
* NSRASBL.cbl
  4770                                PIC X(12).
  4771    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
  4772    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
  4773    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
  4774                                PIC X(10).
  4775    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
  4776    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
  4777    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
  4778    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
  4779    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
  4780    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
  4781    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
  4782    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
  4783    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
  4784                                PIC X(09).
  4785    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
  4786    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
  4787    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
  4788                                PIC X(09).
  4789    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
  4790    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
  4791    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
  4792                                PIC X(10).
  4793    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
  4794    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
  4795    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
  4796                                PIC X(10).
  4797    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
  4798    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
  4799    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
  4800    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
  4801    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
  4802    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
  4803    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
  4804    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
  4805    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
  4806    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
  4807    05  F                       PIC X(09) VALUE "~NEWWAIT=".
  4808    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
  4809    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
  4810    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
  4811    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
  4812                                PIC X(09).
  4813    05  F                       PIC X(09) VALUE "~NSEXPDT=".
  4814    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
  4815    05  F                       PIC X(08) VALUE "~NSTERM=".
  4816    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
  4817    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
  4818                                PIC X(09).
  4819    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
  4820    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
  4821    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
  4822    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
  4823    05  F                       PIC X(11) VALUE "~PAYABLETO=".
  4824    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
  4825    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
  4826    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
  4827    05  F                       PIC X(09) VALUE "~BALLOON=".
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  85
* NSRASBL.cbl
  4828    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
  4829    05  F                       PIC X(10) VALUE "~LEASEIND=".
  4830    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
  4831    05  F                       PIC X(09) VALUE "~RESCIND=".
  4832    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
  4833    05  F                       PIC X(07) VALUE "~RCD01=".
  4834    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
  4835    05  F                       PIC X(07) VALUE "~RCD02=".
  4836    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
  4837    05  F                       PIC X(07) VALUE "~RCD03=".
  4838    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
  4839    05  F                       PIC X(07) VALUE "~RCD04=".
  4840    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
  4841    05  F                       PIC X(07) VALUE "~RCD05=".
  4842    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
  4843    05  F                       PIC X(07) VALUE "~RCD06=".
  4844    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
  4845    05  F                       PIC X(07) VALUE "~RCD07=".
  4846    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
  4847    05  F                       PIC X(07) VALUE "~RCD08=".
  4848    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
  4849    05  F                       PIC X(07) VALUE "~RCD09=".
  4850    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
  4851    05  F                       PIC X(07) VALUE "~RCD10=".
  4852    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
  4853    05  F                       PIC X(07) VALUE "~RCD11=".
  4854    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
  4855    05  F                       PIC X(07) VALUE "~RCD12=".
  4856    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
  4857    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
  4858    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
  4859    05  F                       PIC X(08) VALUE "~ARCHNO=".
  4860    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
  4861    05  F                       PIC X(06) VALUE "~FORM=".
  4862    05  OUT-FORM                PIC X(03) VALUE SPACES.
  4863    05  F                       PIC X(09) VALUE "~ENCLINE=".
  4864    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
  4865    05  F                       PIC X(08) VALUE "~ATTACH=".
  4866    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
  4867    05  F                       PIC X(10) VALUE "~OUTSTACK=".
  4868    05  OUT-STACK               PIC X(10) VALUE SPACES.
  4869    05  F                       PIC X(11) VALUE "~STATENAME=".
  4870    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
  4871    05  F                       PIC X(08) VALUE "~PRTNOW=".
  4872    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
  4873    05  F                       PIC X(05) VALUE "~NCB=".
  4874    05  OUT-CHGBACK             PIC X     VALUE ' '.
  4875    05  F                       PIC X(8) VALUE "~CSOAMT=".
  4876    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
  4877    05  F                       PIC X(9) VALUE "~ACCTAMT=".
  4878    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
  4879    05  F                       PIC X(09) VALUE "~LETRTYP=".
  4880    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
  4881    05  F                       PIC X(10) VALUE "~PRNTCERT=".
  4882    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
  4883    05  F                       PIC X(08) VALUE "~INSBDT=".
  4884    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
  4885    05  F                       PIC X(08) VALUE "~JNTBDT=".
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  86
* NSRASBL.cbl
  4886    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
  4887    05  F                       PIC X(08) VALUE "~TOTINT=".
  4888    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
  4889    05  F                       PIC X(8) VALUE "~TOPREM=".
  4890    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  4891    05  F                       PIC X(7) VALUE "~TOREF=".
  4892    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  4893    05  F                       PIC X(7) VALUE "~CANDT=".
  4894    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  4895    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  4896    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  4897    05  F                       PIC X(08) VALUE "~CERTID=".
  4898    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
  4899    05  F                       PIC X(08) VALUE "~UNDWID=".
  4900    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
  4901    05  F                       PIC X(8) VALUE "~TNPREM=".
  4902    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  4903    05  F                       PIC X(7) VALUE "~TNREF=".
  4904    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  4905    05  F                       PIC X(8)  VALUE "~COVIND=".
  4906    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
  4907    05  F                       PIC X(9)  VALUE "~OCOVIND=".
  4908    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
  4909    05  F                       PIC X(9)  VALUE "~NCOVIND=".
  4910    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  4911    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  4912    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  4913    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  4914    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  4915    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
  4916    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  4917    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  4918                                PIC X(10).
  4919    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  4920    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  4921    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  4922    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  4923    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  4924    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  4925    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
  4926    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  4927    05  F                       PIC X(10) VALUE "~LFREFCHG=".
  4928    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  4929    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  4930    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  4931    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  4932    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  4933    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  4934    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4935    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  4936    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4937    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  4938    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  4939    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  4940    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  4941    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  4942    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  4943    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  87
* NSRASBL.cbl
  4944    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  4945    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  4946    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
  4947    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  4948    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  4949    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  4950    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4951    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  4952    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4953    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  4954    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  4955    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
  4956    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  4957    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
  4958    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4959    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  4960    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4961    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
  4962    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4963    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  4964    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  4965    05  F                       PIC X(09) VALUE "~CSOOAMT=".
  4966    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  4967    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
  4968    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4969    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  4970    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4971    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  4972    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4973    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
  4974    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  4975    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  4976    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  4977    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  4978    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  4979    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  4980    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4981    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  4982    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4983    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
  4984    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  4985    05  F                       PIC X(09) VALUE "~CSONAMT=".
  4986    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
  4987    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  4988    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  4989    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  4990    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  4991    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  4992    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  4993    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  4994    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  4995    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  4996    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  4997    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  4998    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  4999    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  5000    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5001    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  88
* NSRASBL.cbl
  5002    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5003    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  5004    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5005    05  F                       PIC X(08) VALUE "~CSOCHG=".
  5006    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  5007    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  5008    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  5009    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  5010    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  5011    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  5012    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  5013    05  F                       PIC X(10) VALUE "~AHNCANDT=".
  5014    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  5015    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
  5016    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
  5017    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  5018    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  5019    05  F                       PIC X(8)  VALUE "~SCREEN=".
  5020    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  5021    05  F                       PIC X(11) VALUE 'EndOfString'.
  5022    05  f                       pic x(12) value spaces.
  5023*                                COPY ERCARCH.
  5024******************************************************************
  5025*                                                                *
  5026*                            ERCARCH.                            *
  5027*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5028*                            VMOD=2.002                          *
  5029*                                                                *
  5030*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5031*                                                                *
  5032*   FILE TYPE = VSAM,KSDS                                        *
  5033*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5034*                                                                *
  5035*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5036*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5037*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5038*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5039*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5040*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5041*                                                                *
  5042*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5043******************************************************************
  5044*                   C H A N G E   L O G
  5045*
  5046* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5047*-----------------------------------------------------------------
  5048*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5049* EFFECTIVE    NUMBER
  5050*-----------------------------------------------------------------
  5051* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5052* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5053* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5054******************************************************************
  5055 01  LETTER-ARCHIVE.
  5056     12  LA-RECORD-ID                PIC  X(02).
  5057         88  LA-VALID-ID                VALUE 'LA'.
  5058
  5059     12  LA-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  89
* NSRASBL.cbl
  5060         16  LA-COMPANY-CD           PIC  X(01).
  5061         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5062
  5063     12  LA-CONTROL-BY-CERT-RESP.
  5064         16  LA-COMPANY-CD-A2        PIC  X(01).
  5065         16  LA-CERT-NO-A2.
  5066             20  LA-CERT-PRIME-A2    PIC  X(10).
  5067             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5068         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5069             20  LA-RESP-PERSON-A2   PIC  X(10).
  5070             20  LA-TYPE-A2          PIC  X(01).
  5071         16  LA-CARRIER-A2           PIC  X(01).
  5072         16  LA-GROUPING-A2          PIC  X(06).
  5073         16  LA-STATE-A2             PIC  X(02).
  5074         16  LA-ACCOUNT-A2           PIC  X(10).
  5075         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5076         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5077
  5078     12  LA-CONTROL-BY-FORM.
  5079         16  LA-COMPANY-CD-A3        PIC  X(01).
  5080         16  LA-FORM-A3              PIC  X(04).
  5081         16  LA-CARRIER-A3           PIC  X(01).
  5082         16  LA-GROUPING-A3          PIC  X(06).
  5083         16  LA-STATE-A3             PIC  X(02).
  5084         16  LA-ACCOUNT-A3           PIC  X(10).
  5085         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5086
  5087     12  LA-CONTROL-BY-PROCESSOR.
  5088         16  LA-COMPANY-CD-A4        PIC  X(01).
  5089         16  LA-PROCESSOR-CD         PIC  X(04).
  5090         16  LA-CARRIER-A4           PIC  X(01).
  5091         16  LA-GROUPING-A4          PIC  X(06).
  5092         16  LA-STATE-A4             PIC  X(02).
  5093         16  LA-ACCOUNT-A4           PIC  X(10).
  5094         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5095
  5096     12  LA-CONTROL-BY-KEY-FIELDS.
  5097         16  LA-COMPANY-CD-A5        PIC  X(01).
  5098         16  LA-CARRIER-A5           PIC  X(01).
  5099         16  LA-GROUPING-A5          PIC  X(06).
  5100         16  LA-STATE-A5             PIC  X(02).
  5101         16  LA-ACCOUNT-A5           PIC  X(10).
  5102         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5103
  5104     12  LA-CONTROL-BY-GROUP-CODE.
  5105         16  LA-COMPANY-CD-A6        PIC  X(01).
  5106         16  LA-ENTRY-A6.
  5107             20  LA-FILLER           PIC  X(02).
  5108             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5109         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5110
  5111     12  FILLER                      PIC  X(09).
  5112
  5113     12  LA-HEADER-RECORD.
  5114         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5115         16  LA-CREATION-DATE        PIC  X(02).
  5116         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5117         16  LA-FINAL-ACT-DATE       REDEFINES
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  90
* NSRASBL.cbl
  5118               LA-FOLLOW-UP-DATE     PIC  X(02).
  5119         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5120         16  LA-NO-OF-COPIES         PIC S9(01).
  5121         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5122         16  LA-REPLY-DATE           PIC  X(02).
  5123         16  LA-RESEND-DATES.
  5124             20  LA-RESEND-DATE      PIC  X(02).
  5125             20  LA-SENT-DATE        PIC  X(02).
  5126             20  FILLER              PIC  X(08).
  5127         16  LA-SOURCE-INFORMATION.
  5128             20  LA-DATA-SOURCE      PIC  X(01).
  5129             20  LA-ADDR-SOURCE      PIC  X(01).
  5130         16  LA-STATUS               PIC  X(01).
  5131             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5132             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5133             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5134             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5135             88  LA-STATUS-PURGED         VALUE 'P'.
  5136             88  LA-STATUS-VOIDED         VALUE 'V'.
  5137         16  LA-LAST-RESENT-PRINT-DATE
  5138                                     PIC  X(02).
  5139         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5140             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5141                                          VALUE 'C'.
  5142             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5143                                          VALUE 'F'.
  5144             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5145                                          VALUE 'P'.
  5146         16  LA-PURGED-DATE          PIC  X(02).
  5147         16  LA-VOIDED-DATE          PIC  X(02).
  5148         16  LA-RESEND-LETR          PIC  X(4).
  5149         16  FILLER                  PIC  X(08).
  5150*        16  LA-RESEND-LETR-2        PIC  X(4).
  5151*        16  LA-RESEND-LETR-3        PIC  X(4).
  5152*        16  FILLER                  PIC  X(59).
  5153         16  LA-ARCHIVE-STATUS       PIC  X.
  5154             88  LA-TEMP                VALUE 'T'.
  5155             88  LA-QWS                 VALUE 'Q'.
  5156             88  LA-BATCH               VALUE 'B'.
  5157         16  LA-FINAL-ACT-IND        PIC  X(1).
  5158         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5159         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5160         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5161                                     PIC X(4).
  5162         16  FILLER                  PIC  X(42).
  5163*        16  FILLER                  PIC  X(71).
  5164         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5165         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5166         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5167                                     PIC  X(4).
  5168         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5169
  5170******************************************************************
  5171 01  FILLER                      PIC X(500)  VALUE SPACES.
  5172*                                COPY ELCENCC.
  5173******************************************************************
  5174*                                                                *
  5175*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  91
* NSRASBL.cbl
  5176*                            ELCENCC                             *
  5177*                            VMOD=2.001                          *
  5178*                                                                *
  5179*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5180*                                                                *
  5181*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5182*   A NAPERSOFT DOCUMENT                                         *
  5183*                                                                *
  5184*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5185*                                                                *
  5186*   FILE TYPE = VSAM,KSDS                                        *
  5187*   RECORD SIZE = 400   RECFORM = FIX                            *
  5188*                                                                *
  5189*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5190*                                                                *
  5191*   LOG = NO                                                     *
  5192*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5193*                                                                *
  5194*                                                                *
  5195******************************************************************
  5196*                   C H A N G E   L O G
  5197*
  5198* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5199*-----------------------------------------------------------------
  5200*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5201* EFFECTIVE    NUMBER
  5202*-----------------------------------------------------------------
  5203* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5204******************************************************************
  5205 01  ENCLOSURE-CODES.
  5206     12  NC-RECORD-ID                      PIC XX.
  5207         88  VALID-NC-ID                      VALUE 'NC'.
  5208     12  NC-CONTROL-PRIMARY.
  5209         16  NC-COMPANY-CD                 PIC X.
  5210         16  NC-REC-TYPE                   PIC X.
  5211             88  NC-CLAIMS                   VALUE '1'.
  5212             88  NC-ADMIN                    VALUE '2'.
  5213         16  NC-ENC-CODE                   PIC X(5).
  5214         16  FILLER                        PIC X(09).
  5215     12  NC-MAINT-INFORMATION.
  5216         16  NC-LAST-MAINT-DT              PIC XX.
  5217         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5218         16  NC-LAST-MAINT-USER            PIC X(4).
  5219         16  FILLER                        PIC XX.
  5220     12  NC-OUTPUT-STACK                   PIC XXX.
  5221     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5222     12  NC-ATTACHMENTS                    PIC X(100).
  5223     12  NC-FUTURE                         PIC X(50).
  5224     12  FILLER                            PIC X(117).
  5225******************************************************************
  5226****************************************************************
  5227*
  5228* Copyright (c) 2007 by Clerity Solutions, Inc.
  5229* All rights reserved.
  5230*
  5231****************************************************************
  5232 01  DFHEIV.
  5233   02  DFHEIV0               PIC X(35).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  92
* NSRASBL.cbl
  5234   02  DFHEIV1               PIC X(08).
  5235   02  DFHEIV2               PIC X(08).
  5236   02  DFHEIV3               PIC X(08).
  5237   02  DFHEIV4               PIC X(06).
  5238   02  DFHEIV5               PIC X(04).
  5239   02  DFHEIV6               PIC X(04).
  5240   02  DFHEIV7               PIC X(02).
  5241   02  DFHEIV8               PIC X(02).
  5242   02  DFHEIV9               PIC X(01).
  5243   02  DFHEIV10              PIC S9(7) COMP-3.
  5244   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5245   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5246   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5247   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5248   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5249   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5250   02  DFHEIV17              PIC X(04).
  5251   02  DFHEIV18              PIC X(04).
  5252   02  DFHEIV19              PIC X(04).
  5253   02  DFHEIV20              USAGE IS POINTER.
  5254   02  DFHEIV21              USAGE IS POINTER.
  5255   02  DFHEIV22              USAGE IS POINTER.
  5256   02  DFHEIV23              USAGE IS POINTER.
  5257   02  DFHEIV24              USAGE IS POINTER.
  5258   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5259   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5260   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5261   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5262   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5263   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5264   02  FILLER                PIC X(02).
  5265   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5266   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5267   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5268   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5269   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5270 LINKAGE  SECTION.
  5271*****************************************************************
  5272*                                                               *
  5273* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5274* All rights reserved.                                          *
  5275*                                                               *
  5276*****************************************************************
  5277 01  dfheiblk.
  5278     02  eibtime          pic s9(7) comp-3.
  5279     02  eibdate          pic s9(7) comp-3.
  5280     02  eibtrnid         pic x(4).
  5281     02  eibtaskn         pic s9(7) comp-3.
  5282     02  eibtrmid         pic x(4).
  5283     02  dfheigdi         pic s9(4) comp.
  5284     02  eibcposn         pic s9(4) comp.
  5285     02  eibcalen         pic s9(4) comp.
  5286     02  eibaid           pic x(1).
  5287     02  eibfiller1       pic x(1).
  5288     02  eibfn            pic x(2).
  5289     02  eibfiller2       pic x(2).
  5290     02  eibrcode         pic x(6).
  5291     02  eibfiller3       pic x(2).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  93
* NSRASBL.cbl
  5292     02  eibds            pic x(8).
  5293     02  eibreqid         pic x(8).
  5294     02  eibrsrce         pic x(8).
  5295     02  eibsync          pic x(1).
  5296     02  eibfree          pic x(1).
  5297     02  eibrecv          pic x(1).
  5298     02  eibsend          pic x(1).
  5299     02  eibatt           pic x(1).
  5300     02  eibeoc           pic x(1).
  5301     02  eibfmh           pic x(1).
  5302     02  eibcompl         pic x(1).
  5303     02  eibsig           pic x(1).
  5304     02  eibconf          pic x(1).
  5305     02  eiberr           pic x(1).
  5306     02  eibrldbk         pic x(1).
  5307     02  eiberrcd         pic x(4).
  5308     02  eibsynrb         pic x(1).
  5309     02  eibnodat         pic x(1).
  5310     02  eibfiller5       pic x(2).
  5311     02  eibresp          pic 9(09) comp.
  5312     02  eibresp2         pic 9(09) comp.
  5313     02  dfheigdj         pic s9(4) comp.
  5314     02  dfheigdk         pic s9(4) comp.
  5315 01 dfhcommarea                  PIC X(6500).
  5316 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  5317 0000-DFHEXIT SECTION.
  5318     MOVE '9#                    $   ' TO DFHEIV0.
  5319     MOVE 'NSRASBL' TO DFHEIV1.
  5320     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5321     display ' entering pgm nsrasbl '
  5322     display ' commarea ' dfhcommarea
  5323     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5324     MOVE '5'                    TO DC-OPTION-CODE
  5325     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5326     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  5327     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  5328     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  5329     move dfhcommarea            to srch-commarea
  5330*****************************************************
  5331* The full       key has been established and passed
  5332* to this program via NSRASLTR
  5333*****************************************************
  5334     PERFORM 1115-MATCH-COMPANY  THRU 1115-EXIT
  5335     display ' input data ' bl-carrier ' ' bl-group ' '
  5336        bl-account ' ' bl-eff-dt ' ' bl-cert-no
  5337     MOVE BL-LETTER-ID           TO OUT-LETTER
  5338     MOVE BL-PROC-ID             TO OUT-PROC-ID
  5339     MOVE BL-CARRIER             TO OUT-CARRIER
  5340     MOVE BL-GROUP               TO OUT-GROUPING
  5341     MOVE BL-ACCOUNT             TO OUT-ACCOUNT
  5342     MOVE BL-PRINT-NOW-SW        TO OUT-PRINT-NOW
  5343     MOVE BL-CERT-FORM-ID        TO OUT-CERTIFICATE-ID
  5344     MOVE BL-SOURCE-SCREEN       TO OUT-SCREEN-ID
  5345     STRING DC-EDITA-CCYY DC-EDITA-MONTH
  5346        DC-EDITA-DAY  DELIMITED BY SIZE
  5347        INTO OUT-CYCLE-DT
  5348     END-STRING
  5349     IF BL-EFF-DT = '99/99/99' OR '99/99/9999'
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  94
* NSRASBL.cbl
  5350        MOVE HIGH-VALUES         TO WS-PASSED-DT
  5351     ELSE
  5352        IF BL-EFF-DT = SPACES
  5353           display ' bad eff data ' bl-eff-dt ' ' bl-cert-no
  5354        ELSE
  5355           IF BL-EFF-DT (9:2) = SPACES
  5356              STRING BL-EFF-DT (7:2) BL-EFF-DT (1:2)
  5357                     BL-EFF-DT (4:2)
  5358                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5359              END-STRING
  5360           ELSE
  5361              STRING BL-EFF-DT (9:2) BL-EFF-DT (1:2)
  5362                     BL-EFF-DT (4:2)
  5363                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5364              END-STRING
  5365           END-IF
  5366           MOVE '3'              TO DC-OPTION-CODE
  5367           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5368           IF NO-CONVERSION-ERROR
  5369              MOVE DC-BIN-DATE-1 TO WS-PASSED-DT
  5370           ELSE
  5371              MOVE 'BAD EFF DATE CONVERT ' TO BL-MESSAGE
  5372              SET BL-FAIL TO TRUE
  5373              GO TO 0000-RETURN
  5374           END-IF
  5375        END-IF
  5376     END-IF
  5377     perform 0800-init-out-data  thru 0800-exit
  5378     SET BL-FAIL TO TRUE
  5379******************************************************************
  5380* DATA SOURCE MEANINGS  BL-DATA-SRCE
  5381*    1) FROM ACCT MAINT
  5382*    2) FROM CERT UPDATE
  5383*    3) FROM COMP MAINT
  5384*    4) FROM REVIEW AND CORRECTIONS
  5385******************************************************************
  5386     EVALUATE BL-DATA-SRCE
  5387        WHEN '1'
  5388           PERFORM 0100-DATA-SRCE-1 THRU 0100-EXIT
  5389        WHEN '2'
  5390           PERFORM 0200-DATA-SRCE-2 THRU 0200-EXIT
  5391        WHEN '3'
  5392           PERFORM 0300-DATA-SRCE-3 THRU 0300-EXIT
  5393        WHEN '4'
  5394           PERFORM 0400-DATA-SRCE-4 THRU 0400-EXIT
  5395        WHEN OTHER
  5396           MOVE ' BAD DATA SOURCE CODE ' TO BL-MESSAGE
  5397     END-EVALUATE
  5398     IF BL-OK
  5399        display ' bl write erarch ' bl-write-erarch
  5400        PERFORM 1250-GET-ELLETR  THRU 1250-EXIT
  5401        PERFORM 1700-GET-ELENCC  THRU 1700-EXIT
  5402        IF BL-ARCHIVE-NO = ZEROS
  5403           PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  5404           MOVE WS-ARCHIVE-NO    TO BL-ARCHIVE-NO
  5405           display ' arch zeros, new arch ' bl-archive-no
  5406        END-IF
  5407        MOVE BL-ARCHIVE-NO       TO OUT-ARCH-NO
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  95
* NSRASBL.cbl
  5408        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  5409        display ' bl write erarch ' bl-write-erarch
  5410        IF BL-WRITE-ERARCH = 'T' OR 'B'
  5411           PERFORM 0700-WRITE-EXTR THRU 0700-EXIT
  5412           IF BL-FAIL
  5413              GO TO 0000-RETURN
  5414           END-IF
  5415        END-IF
  5416        MOVE W-LETTER-TO-ACCT    TO BL-LETTER-TO-ACCT
  5417        MOVE W-LETTER-TO-BENE    TO BL-LETTER-TO-BENE
  5418     END-IF
  5419     .
  5420 0000-RETURN.
  5421     move srch-commarea          to dfhcommarea
  5422
  5423* exec cics
  5424*       return
  5425*    end-exec
  5426*    MOVE '.(                    ''   #00005418' TO DFHEIV0
  5427     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5428     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5429     MOVE X'2020233030303035343138' TO DFHEIV0(25:11)
  5430     CALL 'kxdfhei1' USING DFHEIV0,
  5431           DFHEIV99,
  5432           DFHEIV99,
  5433           DFHEIV99,
  5434           DFHEIV99,
  5435           DFHEIV99,
  5436           DFHEIV99
  5437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5438     .
  5439 0100-DATA-SRCE-1.
  5440     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5441     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5442     MOVE ' '                    TO WS-ERACCT-SW
  5443     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  5444     MOVE WS-COMPANY-CD          TO WS-ERACCT-COMPANY-CD
  5445     MOVE BL-CARRIER             TO WS-ERACCT-CARRIER
  5446     MOVE BL-GROUP               TO WS-ERACCT-GROUP
  5447     MOVE BL-STATE               TO WS-ERACCT-STATE
  5448     MOVE BL-ACCOUNT             TO WS-ERACCT-ACCOUNT
  5449     MOVE WS-PASSED-DT           TO WS-ERACCT-EXP-DT
  5450                                    WS-CERT-EFF-DT
  5451     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  5452     IF ACCT-FOUND
  5453        MOVE AM-CSR-CODE         TO WS-CSR-ID
  5454        PERFORM 1025-GET-CSR-INFO
  5455                                 THRU 1025-EXIT
  5456        PERFORM 1300-DETERMINE-COMM
  5457                                 THRU 1300-EXIT
  5458        SET BL-OK TO TRUE
  5459     ELSE
  5460        MOVE ' ACCOUNT MASTER NOT FOUND ' TO BL-MESSAGE
  5461        SET BL-FAIL TO TRUE
  5462     END-IF
  5463     .
  5464 0100-EXIT.
  5465     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  96
* NSRASBL.cbl
  5466 0200-DATA-SRCE-2.
  5467     display ' made it to data srce 2 '
  5468     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5469     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5470     MOVE ' '                    TO WS-ELCERT-SW
  5471     MOVE WS-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  5472     MOVE BL-CARRIER             TO WS-ELCERT-CARRIER
  5473     MOVE BL-GROUP               TO WS-ELCERT-GROUP
  5474     MOVE BL-STATE               TO WS-ELCERT-STATE
  5475     MOVE BL-ACCOUNT             TO WS-ELCERT-ACCOUNT
  5476     MOVE WS-PASSED-DT           TO WS-ELCERT-EFF-DT
  5477                                    WS-CERT-EFF-DT
  5478     MOVE BL-CERT-NO             TO WS-ELCERT-CERT-NO
  5479
  5480     MOVE ' '                 TO WS-ERACCT-SW
  5481     MOVE LOW-VALUES          TO WS-ERACCT-KEY
  5482     MOVE WS-ELCERT-KEY (1:22) TO WS-ERACCT-KEY (1:22)
  5483     PERFORM 1200-GET-ERACCT  THRU 1200-EXIT
  5484     IF ACCT-FOUND
  5485        MOVE AM-CSR-CODE      TO WS-CSR-ID
  5486        PERFORM 1025-GET-CSR-INFO THRU 1025-EXIT
  5487     END-IF
  5488     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  5489     IF CERT-FOUND
  5490        PERFORM 1130-MATCH-BENCDS THRU 1130-EXIT
  5491        MOVE WS-LF-ABBRV         TO OUT-LF-ABBRV
  5492        MOVE WS-LF-DESC          TO OUT-LF-DESC
  5493        IF WS-LF-EARN = 'B'
  5494           MOVE 'B'              TO OUT-BALLOON-IND
  5495        END-IF
  5496        MOVE WS-WAIT-PER         TO OUT-WAIT-PER
  5497        MOVE WS-RET-ELIM         TO OUT-RET-ELIM
  5498        MOVE WS-AH-DESC          TO OUT-AH-DESC
  5499        MOVE WS-BEN-DAYS         TO OUT-BEN-DAYS
  5500
  5501        IF BL-ENDT-ARCH-NO > ZERO
  5502           MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5503           MOVE BL-ENDT-ARCH-NO    TO WS-ERENDT-ARCHIVE
  5504           PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5505        ELSE
  5506           IF BL-ARCHIVE-NO > ZERO
  5507              MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5508              MOVE BL-ARCHIVE-NO      TO WS-ERENDT-ARCHIVE
  5509              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5510           END-IF
  5511        END-IF
  5512
  5513        IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  5514           AND (OUT-BALLOON-IND = 'B')
  5515           MOVE 'B'              TO OUT-FORM (3:1)
  5516        END-IF
  5517        SET BL-OK TO TRUE
  5518     ELSE
  5519        display ' cert not found ' ws-elcert-cert-no
  5520        MOVE ' CERTIFICATE NOT FOUND ' TO BL-MESSAGE
  5521        SET BL-FAIL TO TRUE
  5522     END-IF
  5523     .
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  97
* NSRASBL.cbl
  5524 0200-EXIT.
  5525     EXIT.
  5526 0300-DATA-SRCE-3.
  5527     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5528     MOVE WS-COMPANY-CD          TO WS-ERCOMP-COMPANY-CD
  5529     MOVE BL-CARRIER             TO WS-ERCOMP-CARRIER
  5530     MOVE BL-GROUP               TO WS-ERCOMP-GROUP
  5531     MOVE BL-RESP-NO             TO WS-ERCOMP-RESP-NO
  5532     MOVE BL-ACCOUNT             TO WS-ERCOMP-ACCOUNT
  5533     IF WS-ERCOMP-ACCOUNT = SPACES
  5534        MOVE LOW-VALUES          TO WS-ERCOMP-ACCOUNT
  5535        MOVE 'G'                 TO WS-ERCOMP-REC-TYPE
  5536     ELSE
  5537        MOVE 'A'                 TO WS-ERCOMP-REC-TYPE
  5538     END-IF
  5539     PERFORM 1225-GET-ERCOMP     THRU 1225-EXIT
  5540     IF RESP-NORMAL
  5541        MOVE CO-CSR-CODE         TO WS-CSR-ID
  5542        PERFORM 1025-GET-CSR-INFO
  5543                                 THRU 1025-EXIT
  5544        SET BL-OK TO TRUE
  5545     ELSE
  5546        MOVE ' COMPENSATION MASTER NOT FOUND ' TO BL-MESSAGE
  5547        SET BL-FAIL TO TRUE
  5548     END-IF
  5549     .
  5550 0300-EXIT.
  5551     EXIT.
  5552 0400-DATA-SRCE-4.
  5553     MOVE WS-COMPANY-CD          TO WS-ERPNDB-COMPANY-CD
  5554     MOVE BL-BATCH-NO            TO WS-ERPNDB-BATCH-NO
  5555     MOVE BL-BATCH-SEQ           TO WS-ERPNDB-BATCH-SEQ
  5556     MOVE +0                     TO WS-ERPNDB-CHG-SEQ
  5557     MOVE ' '                    TO WS-ERPNDB-SW WS-ERACCT-SW
  5558                                    WS-ELCERT-SW WS-ERENDT-SW
  5559
  5560* EXEC CICS READ
  5561*         DATASET    ('ERPNDB')
  5562*         INTO       (PENDING-BUSINESS)
  5563*         RIDFLD     (WS-ERPNDB-KEY)
  5564*         RESP       (WS-RESPONSE)
  5565*    END-EXEC
  5566     MOVE LENGTH OF
  5567      PENDING-BUSINESS
  5568       TO DFHEIV11
  5569     MOVE 'ERPNDB' TO DFHEIV1
  5570*    MOVE '&"IL       E          (  N#00005542' TO DFHEIV0
  5571     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5572     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5573     MOVE X'204E233030303035353432' TO DFHEIV0(25:11)
  5574     CALL 'kxdfhei1' USING DFHEIV0,
  5575           DFHEIV1,
  5576           PENDING-BUSINESS,
  5577           DFHEIV11,
  5578           WS-ERPNDB-KEY,
  5579           DFHEIV99,
  5580           DFHEIV99,
  5581           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  98
* NSRASBL.cbl
  5582     MOVE EIBRESP  TO WS-RESPONSE
  5583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5584     IF RESP-NORMAL
  5585        IF PB-RECORD-TYPE = '1' OR '2'
  5586           MOVE PB-CARRIER       TO BL-CARRIER
  5587           MOVE PB-GROUPING      TO BL-GROUP
  5588           MOVE PB-STATE         TO BL-STATE
  5589           MOVE PB-ACCOUNT       TO BL-ACCOUNT
  5590           MOVE PB-CERT-NO       TO BL-CERT-NO
  5591           MOVE PB-CSR-ID        TO WS-CSR-ID
  5592           IF PB-ISSUE
  5593              SET PROCESS-ISSUE TO TRUE
  5594              MOVE PB-I-LF-BENEFIT-CD TO WS-LF-BENCD
  5595              MOVE PB-I-AH-BENEFIT-CD TO WS-AH-BENCD
  5596              MOVE PB-I-LF-PREM-CALC TO OUT-LF-CALC-PRM
  5597              MOVE PB-I-AH-PREM-CALC TO OUT-AH-CALC-PRM
  5598           ELSE
  5599              SET PROCESS-CANCEL TO TRUE
  5600              MOVE PB-CI-LF-BENEFIT-CD TO WS-LF-BENCD
  5601              MOVE PB-CI-AH-BENEFIT-CD TO WS-AH-BENCD
  5602              MOVE PB-C-LF-REF-CALC TO OUT-LF-CALC-REF
  5603              MOVE PB-C-AH-REF-CALC TO OUT-AH-CALC-REF
  5604           END-IF
  5605           PERFORM 1120-MATCH-CARRIER
  5606                                 THRU 1120-EXIT
  5607           PERFORM 1125-MATCH-STATE
  5608                                 THRU 1125-EXIT
  5609           PERFORM 1130-MATCH-BENCDS
  5610                                 THRU 1130-EXIT
  5611           MOVE WS-LF-ABBRV      TO OUT-LF-ABBRV
  5612           MOVE WS-LF-DESC       TO OUT-LF-DESC
  5613                                    OUT-ORIG-LF-DESC
  5614           IF WS-LF-EARN = 'B'
  5615              MOVE 'B'           TO OUT-BALLOON-IND
  5616           END-IF
  5617           MOVE WS-WAIT-PER      TO OUT-WAIT-PER
  5618                                    OUT-ORIG-WAIT-PER
  5619           MOVE WS-RET-ELIM      TO OUT-RET-ELIM
  5620                                    OUT-ORIG-RET-ELIM
  5621           MOVE WS-AH-DESC       TO OUT-AH-DESC
  5622                                    OUT-ORIG-AH-DESC
  5623           MOVE WS-BEN-DAYS      TO OUT-BEN-DAYS
  5624                                    OUT-ORIG-BEN-DAYS
  5625           PERFORM 1025-GET-CSR-INFO
  5626                                 THRU 1025-EXIT
  5627
  5628           MOVE LOW-VALUES       TO WS-ERACCT-KEY
  5629           MOVE PB-CONTROL-BY-ACCOUNT (1:22)
  5630                                 TO WS-ERACCT-KEY (1:22)
  5631           MOVE PB-CERT-EFF-DT   TO WS-CERT-EFF-DT
  5632           PERFORM 1200-GET-ERACCT THRU 1200-EXIT
  5633           IF ACCT-FOUND
  5634              MOVE AM-CSR-CODE      TO WS-CSR-ID
  5635              PERFORM 1025-GET-CSR-INFO
  5636                                    THRU 1025-EXIT
  5637              PERFORM 1300-DETERMINE-COMM
  5638                                    THRU 1300-EXIT
  5639           END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page  99
* NSRASBL.cbl
  5640
  5641           MOVE PB-CONTROL-BY-ACCOUNT (1:33)
  5642                                 TO WS-ELCERT-KEY
  5643           PERFORM 1100-GET-ELCERT
  5644                                 THRU 1100-EXIT
  5645
  5646           IF BL-ENDT-ARCH-NO > ZERO
  5647              MOVE PB-COMPANY-CD   TO WS-ERENDT-COMPANY-CD-A1
  5648              MOVE BL-ENDT-ARCH-NO TO WS-ERENDT-ARCHIVE
  5649              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5650           ELSE
  5651              IF BL-ARCHIVE-NO > ZERO
  5652                 MOVE PB-COMPANY-CD TO WS-ERENDT-COMPANY-CD-A1
  5653                 MOVE BL-ARCHIVE-NO TO WS-ERENDT-ARCHIVE
  5654                 PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5655              END-IF
  5656           END-IF
  5657
  5658           SET BL-OK TO TRUE
  5659           IF (PB-STATE = 'KY' OR 'MD' OR 'WI')
  5660              AND (OUT-BALLOON-IND = 'B')
  5661              MOVE 'B'           TO OUT-FORM (3:1)
  5662           END-IF
  5663        END-IF
  5664     END-IF
  5665     .
  5666 0400-EXIT.
  5667     EXIT.
  5668 0500-SCRUB-DATA.
  5669*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  5670*   A DIFFERENT DELIMITER IN PROGRAM NSRASLTR BUT
  5671*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  5672*   TO A HEX 26 TO GET BY THE DECODER
  5673     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  5674                                 TO M1
  5675     MOVE OUT-ACCT-NAME          TO WS-WORK-FIELD
  5676     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5677        (A1 > M1)
  5678        OR (WS-WORK-FIELD (A1:1) = '*')
  5679        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  5680        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  5681     END-PERFORM
  5682     IF A1 > M1
  5683        CONTINUE
  5684     ELSE
  5685        MOVE WS-WORK-FIELD (1:A1 - 1)
  5686                                 TO OUT-ACCT-NAME
  5687     END-IF
  5688     MOVE FUNCTION LENGTH(OUT-BENE-NAME)
  5689                                 TO M1
  5690     MOVE OUT-BENE-NAME          TO WS-WORK-FIELD
  5691     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5692        (A1 > M1)
  5693        OR (WS-WORK-FIELD (A1:1) = '*')
  5694        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  5695        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  5696     END-PERFORM
  5697     IF A1 > M1
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 100
* NSRASBL.cbl
  5698        CONTINUE
  5699     ELSE
  5700        MOVE WS-WORK-FIELD (1:A1 - 1)
  5701                                 TO OUT-BENE-NAME
  5702     END-IF
  5703     IF OUT-CERT-NO = LOW-VALUES OR SPACES
  5704         MOVE '0000000000 '  TO OUT-CERT-NO
  5705     END-IF
  5706     MOVE +1 TO M1
  5707     MOVE SPACES TO BL-RECORD-PASSED-DATA
  5708     MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  5709                                 TO NS-LEN
  5710     display ' naper output data length ' ns-len
  5711     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5712        (NAPER-OUTPUT-DATA (A1:11) = 'EndOfString')
  5713        OR (A1 > NS-LEN)
  5714        IF NAPER-OUTPUT-DATA (A1:3) = SPACES
  5715           CONTINUE
  5716        ELSE
  5717           IF NAPER-OUTPUT-DATA (A1:1) = '~'
  5718              MOVE '&'           TO BL-RECORD-PASSED-DATA (M1:1)
  5719              MOVE ' '           TO NAPER-OUTPUT-DATA (A1:1)
  5720              ADD +1 TO M1
  5721           ELSE
  5722              IF NAPER-OUTPUT-DATA (A1:1) = '&'
  5723                 MOVE '%26'      TO BL-RECORD-PASSED-DATA (M1:3)
  5724                 ADD +3 TO M1
  5725              ELSE
  5726                 MOVE NAPER-OUTPUT-DATA (A1:1)
  5727                                 TO BL-RECORD-PASSED-DATA (M1:1)
  5728                 ADD +1 TO M1
  5729              END-IF
  5730           END-IF
  5731        END-IF
  5732     END-PERFORM
  5733     .
  5734 0500-EXIT.
  5735     EXIT.
  5736 0600-GET-ERENDT.
  5737
  5738* EXEC CICS READ
  5739*         DATASET    ('ERENDT2')
  5740*         INTO       (ENDORSEMENT-RECORD)
  5741*         RIDFLD     (WS-ERENDT-KEY-BY-ARCH)
  5742*         RESP       (WS-RESPONSE)
  5743*    END-EXEC
  5744     MOVE LENGTH OF
  5745      ENDORSEMENT-RECORD
  5746       TO DFHEIV11
  5747     MOVE 'ERENDT2' TO DFHEIV1
  5748*    MOVE '&"IL       E          (  N#00005701' TO DFHEIV0
  5749     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5750     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5751     MOVE X'204E233030303035373031' TO DFHEIV0(25:11)
  5752     CALL 'kxdfhei1' USING DFHEIV0,
  5753           DFHEIV1,
  5754           ENDORSEMENT-RECORD,
  5755           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 101
* NSRASBL.cbl
  5756           WS-ERENDT-KEY-BY-ARCH,
  5757           DFHEIV99,
  5758           DFHEIV99,
  5759           DFHEIV99
  5760     MOVE EIBRESP  TO WS-RESPONSE
  5761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5762     DISPLAY ' JUST READ ENDT ' WS-RESPONSE ' '
  5763         WS-ERENDT-ARCHIVE
  5764     IF (RESP-NORMAL)
  5765        SET ENDT-FOUND TO TRUE
  5766        PERFORM 0620-BUILD-ENDT  THRU 0620-EXIT
  5767        PERFORM 0650-PROCESS-NO-Change
  5768                                 THRU 0650-EXIT
  5769     END-IF
  5770     .
  5771 0600-EXIT.
  5772     EXIT.
  5773 0620-BUILD-ENDT.
  5774     MOVE SPACES                 TO OUT-ORIG-LF-CAN-DT
  5775                                    OUT-NEW-LF-CAN-DT
  5776                                    OUT-ORIG-AH-CAN-DT
  5777                                    OUT-NEW-AH-CAN-DT
  5778                                    OUT-ORIG-CAN-DT
  5779                                    OUT-NEW-CAN-DT
  5780     IF EN-REC-TYPE = 'C'
  5781        GO TO 0620-PROCESS-CANCEL
  5782     END-IF
  5783     MOVE EN-LF-ORIG-BENCD       TO WS-LF-BENCD
  5784     MOVE EN-AH-ORIG-BENCD       TO WS-AH-BENCD
  5785     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  5786     MOVE WS-LF-DESC             TO OUT-ORIG-LF-DESC
  5787     IF WS-LF-EARN = 'B'
  5788        MOVE 'B'                 TO OUT-BALLOON-IND
  5789     END-IF
  5790     MOVE WS-AH-DESC             TO OUT-ORIG-AH-DESC
  5791     MOVE WS-RET-ELIM            TO OUT-ORIG-RET-ELIM
  5792     MOVE WS-BEN-DAYS            TO OUT-ORIG-BEN-DAYS
  5793     MOVE WS-WAIT-PER            TO OUT-ORIG-WAIT-PER
  5794     MOVE EN-INS-ORIG-LAST-NAME    TO OUT-ORIG-ILNAME
  5795     MOVE EN-INS-ORIG-FIRST-NAME   TO OUT-ORIG-IFNAME
  5796     MOVE EN-INS-ORIG-MIDDLE-INIT  TO OUT-ORIG-MINIT
  5797     MOVE EN-INS-ORIG-AGE          TO OUT-ORIG-IAGE
  5798     MOVE EN-JNT-ORIG-LAST-NAME    TO OUT-ORIG-JLNAME
  5799     MOVE EN-JNT-ORIG-FIRST-NAME   TO OUT-ORIG-JFNAME
  5800     MOVE EN-JNT-ORIG-MIDDLE-INIT  TO OUT-ORIG-JMINIT
  5801     MOVE EN-JNT-ORIG-AGE          TO OUT-ORIG-JAGE
  5802     MOVE EN-LF-ORIG-BENCD         TO OUT-ORIG-LF-BENCD
  5803     MOVE EN-LF-ORIG-TERM          TO OUT-ORIG-LF-TERM
  5804     MOVE EN-LF-ORIG-BEN-AMT       TO OUT-ORIG-LF-BEN
  5805     MOVE EN-LF-ORIG-PRM-AMT       TO OUT-ORIG-LF-PRM
  5806     MOVE EN-LF-ORIG-ALT-BEN-AMT   TO OUT-ORIG-LF-ALT-BEN
  5807     MOVE EN-LF-ORIG-ALT-PRM-AMT   TO OUT-ORIG-LF-ALT-PRM
  5808     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  5809                             EN-LF-ORIG-ALT-PRM-AMT
  5810     MOVE WS-WRK-AMOUNT          TO OUT-ORIG-LF-CMB-PREM
  5811     IF EN-LF-ORIG-BENCD EQUAL '00' OR SPACES
  5812         MOVE SPACES             TO OUT-ORIG-LF-BEN-A
  5813                                    OUT-ORIG-LF-PRM-A
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 102
* NSRASBL.cbl
  5814                                    OUT-ORIG-LF-ALT-BEN-A
  5815                                    OUT-ORIG-LF-ALT-PRM-A
  5816                                    OUT-ORIG-COVERAGE-IND
  5817     ELSE
  5818         MOVE 'LIFE'             TO OUT-ORIG-COVERAGE-IND
  5819         IF EN-LF-ORIG-PRM-AMT = .01
  5820             MOVE SPACES         TO OUT-ORIG-LF-PRM-A
  5821         END-IF
  5822         IF EN-LF-ORIG-BEN-AMT = 999999999.99
  5823             MOVE SPACES         TO OUT-ORIG-LF-BEN-A
  5824         END-IF
  5825     END-IF
  5826     MOVE EN-LF-ORIG-EXP-DT      TO DC-BIN-DATE-1
  5827     MOVE ' '                    TO DC-OPTION-CODE
  5828     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5829     IF NO-CONVERSION-ERROR
  5830        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5831           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5832              INTO OUT-ORIG-LF-EXP-DT
  5833        END-STRING
  5834     END-IF
  5835     MOVE EN-AH-ORIG-BENCD       TO OUT-ORIG-AH-BENCD
  5836     MOVE EN-AH-ORIG-TERM        TO OUT-ORIG-AH-TERM
  5837     MOVE EN-AH-ORIG-BEN-AMT     TO OUT-ORIG-AH-BEN
  5838     MOVE EN-AH-ORIG-PRM-AMT     TO OUT-ORIG-AH-PRM
  5839     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  5840         MOVE SPACES             TO OUT-ORIG-AH-BEN-A
  5841                                    OUT-ORIG-AH-PRM-A
  5842     ELSE
  5843        IF OUT-ORIG-COVERAGE-IND = 'LIFE'
  5844            MOVE 'BOTH'          TO OUT-ORIG-COVERAGE-IND
  5845        ELSE
  5846            MOVE 'AH  '          TO OUT-ORIG-COVERAGE-IND
  5847        END-IF
  5848        IF EN-AH-ORIG-PRM-AMT = .01
  5849            MOVE SPACES          TO OUT-ORIG-AH-PRM-A
  5850        END-IF
  5851        IF EN-AH-ORIG-BEN-AMT = 999999999.99
  5852            MOVE SPACES          TO OUT-ORIG-AH-BEN-A
  5853        END-IF
  5854     END-IF
  5855     COMPUTE WS-WORK-PREM =
  5856        EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT
  5857           + EN-AH-ORIG-PRM-AMT
  5858     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-PREM
  5859     MOVE EN-AH-ORIG-EXP-DT      TO DC-BIN-DATE-1
  5860     MOVE ' '                    TO DC-OPTION-CODE
  5861     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5862     IF NO-CONVERSION-ERROR
  5863        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5864           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5865              INTO OUT-ORIG-AH-EXP-DT
  5866        END-STRING
  5867     END-IF
  5868     MOVE EN-AH-ORIG-CP          TO OUT-ORIG-CRIT-PER
  5869                                    OUT-ORIG-MAX-PMTS
  5870     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  5871         MOVE SPACES             TO OUT-ORIG-MAX-PMTS-A
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 103
* NSRASBL.cbl
  5872     END-IF
  5873     MOVE EN-INS-NEW-LAST-NAME    TO OUT-NEW-ILNAME
  5874     MOVE EN-INS-NEW-FIRST-NAME   TO OUT-NEW-IFNAME
  5875     MOVE EN-INS-NEW-MIDDLE-INIT  TO OUT-NEW-IMINIT
  5876     MOVE EN-INS-NEW-AGE          TO OUT-NEW-IAGE
  5877     MOVE EN-JNT-NEW-LAST-NAME    TO OUT-NEW-JLNAME
  5878     MOVE EN-JNT-NEW-FIRST-NAME   TO OUT-NEW-JFNAME
  5879     MOVE EN-JNT-NEW-MIDDLE-INIT  TO OUT-NEW-JMINIT
  5880     MOVE EN-JNT-NEW-AGE          TO OUT-NEW-JAGE
  5881     MOVE EN-LF-NEW-BENCD        TO WS-LF-BENCD
  5882     MOVE EN-AH-NEW-BENCD        TO WS-AH-BENCD
  5883     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  5884     MOVE WS-LF-DESC             TO OUT-NEW-LF-DESC
  5885     IF WS-LF-EARN = 'B'
  5886        MOVE 'B'                 TO OUT-BALLOON-IND
  5887     END-IF
  5888     MOVE WS-AH-DESC             TO OUT-NEW-AH-DESC
  5889     MOVE WS-RET-ELIM            TO OUT-NEW-RET-ELIM
  5890     MOVE WS-BEN-DAYS            TO OUT-NEW-BEN-DAYS
  5891     MOVE WS-WAIT-PER            TO OUT-NEW-WAIT-PER
  5892     MOVE EN-LF-NEW-BENCD         TO OUT-NEW-LF-BENCD
  5893     MOVE EN-LF-NEW-TERM          TO OUT-NEW-LF-TERM
  5894     MOVE EN-LF-NEW-BEN-AMT       TO OUT-NEW-LF-BEN
  5895     MOVE EN-LF-NEW-PRM-AMT       TO OUT-NEW-LF-PRM
  5896     MOVE EN-LF-NEW-ALT-BEN-AMT   TO OUT-NEW-LF-ALT-BEN
  5897     MOVE EN-LF-NEW-ALT-PRM-AMT   TO OUT-NEW-LF-ALT-PRM
  5898     COMPUTE WS-WRK-AMOUNT = EN-LF-NEW-PRM-AMT +
  5899                             EN-LF-NEW-ALT-PRM-AMT
  5900     MOVE WS-WRK-AMOUNT           TO OUT-NEW-LF-CMB-PREM
  5901     IF EN-LF-NEW-BENCD EQUAL '00' OR SPACES
  5902         MOVE SPACES             TO OUT-NEW-LF-BEN-A
  5903                                    OUT-NEW-LF-PRM-A
  5904                                    OUT-NEW-LF-ALT-BEN-A
  5905                                    OUT-NEW-LF-ALT-PRM-A
  5906                                    OUT-NEW-LF-CMB-PREM-A
  5907                                    OUT-NEW-COVERAGE-IND
  5908     ELSE
  5909         MOVE 'LIFE'             TO OUT-NEW-COVERAGE-IND
  5910     END-IF
  5911    MOVE EN-LF-NEW-EXP-DT        TO DC-BIN-DATE-1
  5912     MOVE ' '                     TO DC-OPTION-CODE
  5913     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  5914     IF NO-CONVERSION-ERROR
  5915        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5916           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5917              INTO OUT-NEW-LF-EXP-DT
  5918        END-STRING
  5919     END-IF
  5920     MOVE EN-AH-NEW-BENCD         TO OUT-NEW-AH-BENCD
  5921     MOVE EN-AH-NEW-TERM          TO OUT-NEW-AH-TERM
  5922     MOVE EN-AH-NEW-BEN-AMT       TO OUT-NEW-AH-BEN
  5923     MOVE EN-AH-NEW-PRM-AMT       TO OUT-NEW-AH-PRM
  5924     COMPUTE WS-WORK-PREM =
  5925        EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT
  5926           + EN-AH-NEW-PRM-AMT
  5927     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-PREM
  5928     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  5929         MOVE SPACES             TO OUT-NEW-AH-BEN-A
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 104
* NSRASBL.cbl
  5930                                    OUT-NEW-AH-PRM-A
  5931     ELSE
  5932        IF OUT-NEW-COVERAGE-IND = 'LIFE'
  5933            MOVE 'BOTH'          TO OUT-NEW-COVERAGE-IND
  5934        ELSE
  5935            MOVE 'AH  '          TO OUT-NEW-COVERAGE-IND
  5936        END-IF
  5937     END-IF
  5938     MOVE EN-AH-NEW-EXP-DT        TO DC-BIN-DATE-1
  5939     MOVE ' '                     TO DC-OPTION-CODE
  5940     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  5941     IF NO-CONVERSION-ERROR
  5942        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5943           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5944              INTO OUT-NEW-AH-EXP-DT
  5945        END-STRING
  5946     END-IF
  5947     MOVE EN-AH-NEW-CP            TO OUT-NEW-CRIT-PER
  5948                                     OUT-NEW-MAX-PMTS
  5949     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  5950         MOVE SPACES             TO OUT-NEW-MAX-PMTS-A
  5951     END-IF
  5952     IF EN-LF-ORIG-EXP-DT > EN-AH-ORIG-EXP-DT
  5953        MOVE OUT-ORIG-LF-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  5954     ELSE
  5955        MOVE OUT-ORIG-AH-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  5956     END-IF
  5957     IF EN-LF-NEW-EXP-DT > EN-AH-NEW-EXP-DT
  5958        MOVE OUT-NEW-LF-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  5959     ELSE
  5960        MOVE OUT-NEW-AH-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  5961     END-IF
  5962     IF EN-LF-ORIG-TERM > EN-AH-ORIG-TERM
  5963        MOVE EN-LF-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  5964     ELSE
  5965        MOVE EN-AH-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  5966     END-IF
  5967     IF EN-LF-NEW-TERM > EN-AH-NEW-TERM
  5968        MOVE EN-LF-NEW-TERM      TO OUT-NEW-SCHED-TERM
  5969     ELSE
  5970        MOVE EN-AH-NEW-TERM      TO OUT-NEW-SCHED-TERM
  5971     END-IF
  5972     COMPUTE WS-WORK-PREM =
  5973        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  5974        EN-AH-NEW-PRM-AMT) -
  5975        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT +
  5976        EN-AH-ORIG-PRM-AMT)
  5977     MOVE WS-WORK-PREM           TO OUT-TOT-PRM-CHG
  5978     IF EN-CSO-PORTION NOT NUMERIC
  5979        MOVE ZEROS               TO EN-CSO-PORTION
  5980     END-IF
  5981     IF EN-ACCT-PORTION NOT NUMERIC
  5982        MOVE ZERO                TO EN-ACCT-PORTION
  5983     END-IF
  5984*    MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  5985*    MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  5986     IF WS-WORK-PREM > +0
  5987        MOVE 'CSO'               TO OUT-PAYEE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 105
* NSRASBL.cbl
  5988     ELSE
  5989      IF WS-WORK-PREM = +0
  5990         MOVE 'ZERO'             TO OUT-PAYEE
  5991      ELSE
  5992         MOVE 'ACCT'             TO OUT-PAYEE
  5993      END-IF
  5994     END-IF
  5995     COMPUTE WS-ACCT-ORIG-LF-PORT =
  5996        EN-LF-ORIG-PRM-AMT * EN-LF-ORIG-COMM-PCT
  5997     MOVE WS-ACCT-ORIG-LF-PORT TO OUT-ACCT-ORIG-LF-PORT
  5998     COMPUTE WS-ACCT-ORIG-ALT-LF-PORT =
  5999        EN-LF-ORIG-ALT-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6000     MOVE WS-ACCT-ORIG-ALT-LF-PORT TO OUT-ACCT-ORIG-ALT-LF-PORT
  6001     COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6002        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6003        * EN-LF-ORIG-COMM-PCT
  6004     MOVE WS-ACCT-ORIG-CMB-LF-PORT TO OUT-ACCT-ORIG-CMB-LF-PORT
  6005     COMPUTE WS-ACCT-ORIG-AH-PORT =
  6006        EN-AH-ORIG-PRM-AMT * EN-AH-ORIG-COMM-PCT
  6007     MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6008     COMPUTE WS-ACCT-ORIG-PORTION =
  6009        WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6010     MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6011
  6012     COMPUTE WS-CSO-ORIG-LF-PORT =
  6013       EN-LF-ORIG-PRM-AMT - WS-ACCT-ORIG-LF-PORT
  6014     MOVE WS-CSO-ORIG-LF-PORT TO OUT-CSO-ORIG-LF-PORT
  6015     COMPUTE WS-CSO-ORIG-ALT-LF-PORT =
  6016       EN-LF-ORIG-ALT-PRM-AMT - WS-ACCT-ORIG-ALT-LF-PORT
  6017     MOVE WS-CSO-ORIG-ALT-LF-PORT TO OUT-CSO-ORIG-ALT-LF-PORT
  6018     COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6019       (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6020        WS-ACCT-ORIG-CMB-LF-PORT
  6021     MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6022     COMPUTE WS-CSO-ORIG-AH-PORT =
  6023        EN-AH-ORIG-PRM-AMT - WS-ACCT-ORIG-AH-PORT
  6024     MOVE WS-CSO-ORIG-AH-PORT TO OUT-CSO-ORIG-AH-PORT
  6025     COMPUTE WS-CSO-ORIG-PORTION =
  6026        WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6027     MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6028     COMPUTE WS-ACCT-NEW-LF-PORT =
  6029        EN-LF-NEW-PRM-AMT * EN-LF-NEW-COMM-PCT
  6030     MOVE WS-ACCT-NEW-LF-PORT TO OUT-ACCT-NEW-LF-PORT
  6031     COMPUTE WS-ACCT-NEW-ALT-LF-PORT =
  6032        EN-LF-NEW-ALT-PRM-AMT * EN-LF-NEW-COMM-PCT
  6033     MOVE WS-ACCT-NEW-ALT-LF-PORT TO OUT-ACCT-NEW-ALT-LF-PORT
  6034     COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6035        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT)
  6036        * EN-LF-NEW-COMM-PCT
  6037     MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6038     COMPUTE WS-ACCT-NEW-AH-PORT =
  6039        EN-AH-NEW-PRM-AMT * EN-AH-NEW-COMM-PCT
  6040     MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6041     COMPUTE WS-ACCT-NEW-PORTION =
  6042        WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6043     MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6044
  6045     COMPUTE WS-CSO-NEW-LF-PORT =
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 106
* NSRASBL.cbl
  6046       EN-LF-NEW-PRM-AMT - WS-ACCT-NEW-LF-PORT
  6047     MOVE WS-CSO-NEW-LF-PORT TO OUT-CSO-NEW-LF-PORT
  6048     COMPUTE WS-CSO-NEW-ALT-LF-PORT =
  6049       EN-LF-NEW-ALT-PRM-AMT - WS-ACCT-NEW-ALT-LF-PORT
  6050     MOVE WS-CSO-NEW-ALT-LF-PORT TO OUT-CSO-NEW-ALT-LF-PORT
  6051     COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6052       (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6053        WS-ACCT-NEW-CMB-LF-PORT
  6054     MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6055     COMPUTE WS-CSO-NEW-AH-PORT =
  6056        EN-AH-NEW-PRM-AMT - WS-ACCT-NEW-AH-PORT
  6057     MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6058     COMPUTE WS-CSO-NEW-PORTION =
  6059        WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6060     MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6061
  6062     COMPUTE WS-ACCT-LF-PORT-CHG =
  6063        WS-ACCT-NEW-LF-PORT - WS-ACCT-ORIG-LF-PORT
  6064     MOVE WS-ACCT-LF-PORT-CHG TO OUT-ACCT-LF-PORT-CHG
  6065     COMPUTE WS-ACCT-ALT-LF-PORT-CHG =
  6066        WS-ACCT-NEW-ALT-LF-PORT - WS-ACCT-ORIG-ALT-LF-PORT
  6067     MOVE WS-ACCT-ALT-LF-PORT-CHG TO OUT-ACCT-ALT-LF-PORT-CHG
  6068     COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6069        WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6070     MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6071     COMPUTE WS-ACCT-AH-PORT-CHG =
  6072        WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6073     MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6074     COMPUTE WS-ACCT-PORTION-CHG =
  6075        WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6076     MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6077
  6078     COMPUTE WS-CSO-LF-PORT-CHG =
  6079        WS-CSO-NEW-LF-PORT - WS-CSO-ORIG-LF-PORT
  6080     MOVE WS-CSO-LF-PORT-CHG TO OUT-CSO-LF-PORT-CHG
  6081     COMPUTE WS-CSO-ALT-LF-PORT-CHG =
  6082        WS-CSO-NEW-ALT-LF-PORT - WS-CSO-ORIG-ALT-LF-PORT
  6083     MOVE WS-CSO-ALT-LF-PORT-CHG TO OUT-CSO-ALT-LF-PORT-CHG
  6084     COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6085        WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6086     MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6087     COMPUTE WS-CSO-AH-PORT-CHG =
  6088        WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6089     MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6090     COMPUTE WS-CSO-PORTION-CHG =
  6091        WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6092     MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6093
  6094     COMPUTE WS-WORK-PREM =
  6095         EN-LF-NEW-PRM-AMT - EN-LF-ORIG-PRM-AMT
  6096     MOVE WS-WORK-PREM           TO OUT-LF-PREM-CHG
  6097     COMPUTE WS-WORK-PREM =
  6098         EN-LF-NEW-ALT-PRM-AMT - EN-LF-ORIG-ALT-PRM-AMT
  6099     MOVE WS-WORK-PREM           TO OUT-LF-ALT-PREM-CHG
  6100     COMPUTE WS-WORK-PREM =
  6101        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6102        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6103     MOVE WS-WORK-PREM           TO OUT-LF-CMB-PREM-CHG
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 107
* NSRASBL.cbl
  6104     COMPUTE WS-WORK-PREM =
  6105        (EN-AH-NEW-PRM-AMT - EN-AH-ORIG-PRM-AMT)
  6106     MOVE WS-WORK-PREM           TO OUT-AH-PREM-CHG
  6107
  6108     move en-sig-sw              to out-sig-sw
  6109     MOVE EN-HEALTH-APP          TO OUT-HEALTH-APP
  6110     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6111     GO TO 0620-CONTINUE
  6112     .
  6113 0620-PROCESS-CANCEL.
  6114     IF EN-LF-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6115        MOVE EN-LF-ORIG-REF-DT   TO DC-BIN-DATE-1
  6116        MOVE ' '                 TO DC-OPTION-CODE
  6117        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6118        IF NO-CONVERSION-ERROR
  6119           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6120              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6121                 INTO OUT-ORIG-LF-CAN-DT
  6122           END-STRING
  6123        END-IF
  6124        MOVE OUT-ORIG-LF-CAN-DT  TO OUT-ORIG-CAN-DT
  6125     END-IF
  6126
  6127     IF EN-LF-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6128        MOVE EN-LF-NEW-REF-DT    TO DC-BIN-DATE-1
  6129        MOVE ' '                 TO DC-OPTION-CODE
  6130        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6131        IF NO-CONVERSION-ERROR
  6132           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6133              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6134                 INTO OUT-NEW-LF-CAN-DT
  6135           END-STRING
  6136        END-IF
  6137        MOVE OUT-NEW-LF-CAN-DT   TO OUT-NEW-CAN-DT
  6138     END-IF
  6139
  6140     IF EN-AH-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6141        MOVE EN-AH-ORIG-REF-DT      TO DC-BIN-DATE-1
  6142        MOVE ' '                    TO DC-OPTION-CODE
  6143        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6144        IF NO-CONVERSION-ERROR
  6145           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6146              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6147                 INTO OUT-ORIG-AH-CAN-DT
  6148           END-STRING
  6149        END-IF
  6150        IF EN-AH-ORIG-REF-DT > EN-LF-ORIG-REF-DT
  6151           MOVE OUT-ORIG-AH-CAN-DT  TO OUT-ORIG-CAN-DT
  6152        END-IF
  6153     END-IF
  6154
  6155     IF EN-AH-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6156        MOVE EN-AH-NEW-REF-DT       TO DC-BIN-DATE-1
  6157        MOVE ' '                    TO DC-OPTION-CODE
  6158        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6159        IF NO-CONVERSION-ERROR
  6160           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6161              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 108
* NSRASBL.cbl
  6162                 INTO OUT-NEW-AH-CAN-DT
  6163           END-STRING
  6164        END-IF
  6165        IF EN-AH-NEW-REF-DT > EN-LF-NEW-REF-DT
  6166           MOVE OUT-NEW-AH-CAN-DT  TO OUT-NEW-CAN-DT
  6167        END-IF
  6168     END-IF
  6169     MOVE EN-LF-ORIG-REF-AMT     TO OUT-ORIG-LF-REF
  6170     MOVE EN-AH-ORIG-REF-AMT     TO OUT-ORIG-AH-REF
  6171     MOVE EN-LF-NEW-REF-AMT      TO OUT-NEW-LF-REF
  6172     MOVE EN-AH-NEW-REF-AMT      TO OUT-NEW-AH-REF
  6173     COMPUTE WS-WORK-PREM =
  6174        EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6175     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-REF
  6176     COMPUTE WS-WORK-PREM =
  6177        EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6178     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-REF
  6179     COMPUTE WS-WORK-PREM =
  6180        (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6181        (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6182     MOVE WS-WORK-PREM           TO OUT-TOT-REF-CHG
  6183
  6184     COMPUTE WS-WORK-PREM =
  6185        (EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT)
  6186     MOVE WS-WORK-PREM           TO OUT-LF-REF-CHG
  6187     COMPUTE WS-WORK-PREM =
  6188        (EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT)
  6189     MOVE WS-WORK-PREM           TO OUT-AH-REF-CHG
  6190
  6191*     MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6192*     MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6193     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6194
  6195     IF EN-COMM-CHGBK = 'N'
  6196         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6197                                   OUT-CSO-ORIG-ALT-LF-PORT
  6198         MOVE EN-LF-ORIG-REF-AMT TO OUT-CSO-ORIG-CMB-LF-PORT
  6199         MOVE EN-AH-ORIG-REF-AMT TO OUT-CSO-ORIG-AH-PORT
  6200         COMPUTE WS-CSO-ORIG-PORTION =
  6201             EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6202         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6203         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6204                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6205                                   OUT-ACCT-ORIG-CMB-LF-PORT
  6206                                   OUT-ACCT-ORIG-AH-PORT
  6207                                   OUT-ACCT-ORIG-PORTION
  6208
  6209         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6210                                   OUT-CSO-NEW-ALT-LF-PORT
  6211         MOVE EN-LF-NEW-REF-AMT TO OUT-CSO-NEW-CMB-LF-PORT
  6212         MOVE EN-AH-NEW-REF-AMT TO OUT-CSO-NEW-AH-PORT
  6213         COMPUTE WS-CSO-NEW-PORTION =
  6214             EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6215         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6216         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6217                                   OUT-ACCT-NEW-ALT-LF-PORT
  6218                                   OUT-ACCT-NEW-CMB-LF-PORT
  6219                                   OUT-ACCT-NEW-AH-PORT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 109
* NSRASBL.cbl
  6220                                   OUT-ACCT-NEW-PORTION
  6221
  6222         MOVE ZERO              TO OUT-CSO-LF-PORT-CHG
  6223                                   OUT-CSO-ALT-LF-PORT-CHG
  6224         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6225           EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT
  6226         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6227         COMPUTE WS-CSO-AH-PORT-CHG =
  6228           EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT
  6229         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6230         COMPUTE WS-CSO-PORTION-CHG =
  6231           (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6232           (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6233         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6234         MOVE ZERO              TO OUT-ACCT-LF-PORT-CHG
  6235                                   OUT-ACCT-ALT-LF-PORT-CHG
  6236                                   OUT-ACCT-CMB-LF-PORT-CHG
  6237                                   OUT-ACCT-AH-PORT-CHG
  6238                                   OUT-ACCT-PORTION-CHG
  6239     ELSE
  6240         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6241                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6242         COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6243           (EN-LF-ORIG-REF-AMT * EN-LF-ORIG-REF-COMM-PCT)
  6244         MOVE WS-ACCT-ORIG-CMB-LF-PORT TO
  6245                                  OUT-ACCT-ORIG-CMB-LF-PORT
  6246         COMPUTE WS-ACCT-ORIG-AH-PORT =
  6247           (EN-AH-ORIG-REF-AMT * EN-AH-ORIG-REF-COMM-PCT)
  6248         MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6249         COMPUTE WS-ACCT-ORIG-PORTION =
  6250            WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6251         MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6252
  6253         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6254                                   OUT-CSO-ORIG-ALT-LF-PORT
  6255         COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6256           (EN-LF-ORIG-REF-AMT - WS-ACCT-ORIG-CMB-LF-PORT)
  6257         MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6258         COMPUTE WS-CSO-ORIG-AH-PORT =
  6259           (EN-AH-ORIG-REF-AMT - WS-ACCT-ORIG-AH-PORT)
  6260         MOVE WS-CSO-AH-PORTION  TO OUT-CSO-ORIG-AH-PORT
  6261         COMPUTE WS-CSO-ORIG-PORTION =
  6262            WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6263         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6264
  6265         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6266                                   OUT-ACCT-NEW-ALT-LF-PORT
  6267         COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6268           (EN-LF-NEW-REF-AMT * EN-LF-NEW-REF-COMM-PCT)
  6269         MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6270         COMPUTE WS-ACCT-NEW-AH-PORT =
  6271           (EN-AH-NEW-REF-AMT * EN-AH-NEW-REF-COMM-PCT)
  6272         MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6273         COMPUTE WS-ACCT-NEW-PORTION =
  6274            WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6275         MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6276
  6277         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 110
* NSRASBL.cbl
  6278                                   OUT-CSO-NEW-ALT-LF-PORT
  6279         COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6280           (EN-LF-NEW-REF-AMT - WS-ACCT-NEW-CMB-LF-PORT)
  6281         MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6282         COMPUTE WS-CSO-NEW-AH-PORT =
  6283           (EN-AH-NEW-REF-AMT - WS-ACCT-NEW-AH-PORT)
  6284         MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6285         COMPUTE WS-CSO-NEW-PORTION =
  6286            WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6287         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6288
  6289         MOVE ZERO               TO OUT-ACCT-LF-PORT-CHG
  6290                                    OUT-ACCT-ALT-LF-PORT-CHG
  6291         COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6292            WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6293         MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6294         COMPUTE WS-ACCT-AH-PORT-CHG =
  6295            WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6296         MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6297         COMPUTE WS-ACCT-PORTION-CHG =
  6298            WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6299         MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6300
  6301         MOVE ZERO               TO OUT-CSO-LF-PORT-CHG
  6302                                    OUT-CSO-ALT-LF-PORT-CHG
  6303         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6304            WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6305         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6306         COMPUTE WS-CSO-AH-PORT-CHG =
  6307            WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6308         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6309         COMPUTE WS-CSO-PORTION-CHG =
  6310            WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6311         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6312
  6313     END-IF
  6314     .
  6315 0620-CONTINUE.
  6316     display ' about to bld reason codes ' en-reason-code (1)
  6317     move en-reason-code (1)     to out-rea-cd1
  6318     move en-reason-code (2)     to out-rea-cd2
  6319     move en-reason-code (3)     to out-rea-cd3
  6320     move en-reason-code (4)     to out-rea-cd4
  6321     move en-reason-code (5)     to out-rea-cd5
  6322     move en-reason-code (6)     to out-rea-cd6
  6323     move en-reason-code (7)     to out-rea-cd7
  6324     move en-reason-code (8)     to out-rea-cd8
  6325     move en-reason-code (9)     to out-rea-cd9
  6326     move en-reason-code (10)    to out-rea-cd10
  6327     move en-reason-code (11)    to out-rea-cd11
  6328     move en-reason-code (12)    to out-rea-cd12
  6329*    PERFORM 1300-DETERMINE-COMM
  6330*                                THRU 1300-EXIT
  6331     .
  6332 0620-EXIT.
  6333     EXIT.
  6334 0650-PROCESS-NO-Change.
  6335     IF EN-REC-TYPE = 'C'
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 111
* NSRASBL.cbl
  6336        GO TO 0650-PROCESS-CANCEL
  6337     END-IF
  6338     if ((OUT-NEW-ILNAME = OUT-ORIG-ILNAME)
  6339        AND (OUT-NEW-ILNAME NOT = SPACES))
  6340                      AND
  6341        ((OUT-NEW-IFNAME = OUT-ORIG-IFNAME)
  6342        AND (OUT-NEW-IFNAME NOT = SPACES))
  6343                      AND
  6344        ((OUT-NEW-IMINIT = OUT-ORIG-MINIT)
  6345        AND (OUT-NEW-IFNAME NOT = SPACES))
  6346        move 'No Change'         to out-new-Ifname
  6347        MOVE SPACES              TO OUT-NEW-IMINIT
  6348        move spaces              to out-new-Ilname
  6349     ELSE
  6350         IF OUT-NEW-ILNAME = SPACES
  6351           AND OUT-NEW-IFNAME = SPACES
  6352           AND OUT-NEW-IMINIT = SPACES
  6353           AND OUT-ORIG-ILNAME NOT = SPACES
  6354            MOVE 'None'          TO OUT-NEW-IFNAME
  6355            MOVE SPACES          TO OUT-NEW-IMINIT
  6356            MOVE SPACES          TO OUT-NEW-ILNAME
  6357         END-IF
  6358     END-IF
  6359     IF ((OUT-NEW-JLNAME = OUT-ORIG-JLNAME)
  6360        AND (OUT-NEW-JLNAME NOT = SPACES))
  6361                    AND
  6362        ((OUT-NEW-JFNAME = OUT-ORIG-JFNAME)
  6363        AND (OUT-NEW-JFNAME NOT = SPACES))
  6364                    AND
  6365        ((OUT-NEW-JMINIT = OUT-ORIG-JMINIT)
  6366        AND (OUT-NEW-JFNAME NOT = SPACES))
  6367        MOVE 'No Change'         TO OUT-NEW-JFNAME
  6368        MOVE SPACES              TO OUT-NEW-JMINIT
  6369        MOVE SPACES              TO OUT-NEW-JLNAME
  6370     ELSE
  6371         IF OUT-NEW-JLNAME = SPACES
  6372           AND OUT-NEW-JFNAME = SPACES
  6373           AND OUT-NEW-JMINIT = SPACES
  6374           AND OUT-ORIG-JLNAME NOT = SPACES
  6375            MOVE 'None'          TO OUT-NEW-JFNAME
  6376            MOVE SPACES          TO OUT-NEW-JMINIT
  6377            MOVE SPACES          TO OUT-NEW-JLNAME
  6378         END-IF
  6379     END-IF
  6380     IF (EN-LF-NEW-BEN-AMT = EN-LF-ORIG-BEN-AMT)
  6381        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6382        MOVE 'No Change'         TO OUT-NEW-LF-BEN-A
  6383     ELSE
  6384         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6385           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6386             MOVE ZEROS          TO OUT-NEW-LF-BEN
  6387         END-IF
  6388     END-IF
  6389     IF (EN-LF-NEW-PRM-AMT = EN-LF-ORIG-PRM-AMT)
  6390        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6391        MOVE 'No Change'         TO OUT-NEW-LF-PRM-A
  6392     ELSE
  6393         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 112
* NSRASBL.cbl
  6394           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6395             MOVE ZEROS          TO OUT-NEW-LF-PRM
  6396         END-IF
  6397     END-IF
  6398     IF (EN-LF-NEW-ALT-BEN-AMT = EN-LF-ORIG-ALT-BEN-AMT)
  6399        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6400        MOVE 'No Change'         TO OUT-NEW-LF-ALT-BEN-A
  6401     ELSE
  6402         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6403           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6404             MOVE ZEROS          TO OUT-NEW-LF-ALT-BEN
  6405         END-IF
  6406     END-IF
  6407     IF (EN-LF-NEW-ALT-PRM-AMT = EN-LF-ORIG-ALT-PRM-AMT)
  6408        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6409        MOVE 'No Change'         TO OUT-NEW-LF-ALT-PRM-A
  6410     ELSE
  6411         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6412           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6413             MOVE ZEROS          TO OUT-NEW-LF-ALT-PRM
  6414         END-IF
  6415     END-IF
  6416
  6417     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6418                              EN-LF-ORIG-ALT-PRM-AMT
  6419     COMPUTE WS-WRK-AMOUNT2 = EN-LF-NEW-PRM-AMT +
  6420                               EN-LF-NEW-ALT-PRM-AMT
  6421     IF (WS-WRK-AMOUNT2 = WS-WRK-AMOUNT)
  6422        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6423        MOVE 'No Change'         TO OUT-NEW-LF-CMB-PREM-A
  6424     ELSE
  6425         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6426           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6427            MOVE ZEROS          TO OUT-NEW-LF-CMB-PREM
  6428         END-IF
  6429     END-IF
  6430     IF OUT-NEW-SCHED-EXP-DT = OUT-ORIG-SCHED-EXP-DT
  6431        MOVE 'No Change'         TO OUT-NEW-SCHED-EXP-DT
  6432     END-IF
  6433     IF (OUT-NEW-LF-EXP-DT = OUT-ORIG-LF-EXP-DT)
  6434        AND (OUT-NEW-LF-EXP-DT NOT = SPACES)
  6435        MOVE 'No Change'         TO OUT-NEW-LF-EXP-DT
  6436     END-IF
  6437     IF (OUT-NEW-LF-DESC = OUT-ORIG-LF-DESC)
  6438        AND (OUT-NEW-LF-DESC NOT = SPACES)
  6439        MOVE 'No Change'         to OUT-NEW-LF-DESC
  6440     ELSE
  6441        IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6442          AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6443            MOVE 'None'          TO OUT-NEW-LF-DESC
  6444        END-IF
  6445     end-if
  6446     IF (OUT-NEW-AH-EXP-DT = OUT-ORIG-AH-EXP-DT)
  6447       AND (OUT-NEW-AH-EXP-DT NOT = SPACES)
  6448        MOVE 'No Change'          TO OUT-NEW-AH-EXP-DT
  6449     END-IF
  6450     IF (EN-AH-NEW-BEN-AMT = EN-AH-ORIG-BEN-AMT)
  6451        AND (EN-AH-ORIG-BEN-AMT NOT = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 113
* NSRASBL.cbl
  6452        MOVE 'No Change'         TO OUT-NEW-AH-BEN-A
  6453     ELSE
  6454         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6455           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6456             MOVE ZEROS          TO OUT-NEW-AH-BEN
  6457         END-IF
  6458     END-IF
  6459     IF (EN-AH-NEW-PRM-AMT = EN-AH-ORIG-PRM-AMT)
  6460        AND (EN-AH-ORIG-PRM-AMT NOT = ZEROS)
  6461        MOVE 'No Change'         TO OUT-NEW-AH-PRM-A
  6462     ELSE
  6463         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6464           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6465             MOVE ZEROS          TO OUT-NEW-AH-PRM
  6466         END-IF
  6467     END-IF
  6468     IF (OUT-NEW-AH-DESC = OUT-ORIG-AH-DESC)
  6469        AND (OUT-ORIG-AH-DESC NOT = SPACES)
  6470        MOVE 'No Change'         TO OUT-NEW-AH-DESC
  6471     ELSE
  6472         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6473           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6474             MOVE 'None'         TO OUT-NEW-AH-DESC
  6475         END-IF
  6476     END-IF
  6477     IF EN-INS-NEW-AGE = EN-INS-ORIG-AGE
  6478        MOVE 'No Change'         TO OUT-NEW-IAGE-A
  6479     END-IF
  6480     IF (EN-JNT-NEW-AGE = EN-JNT-ORIG-AGE)
  6481        AND (EN-JNT-ORIG-AGE NOT = ZEROS)
  6482        MOVE 'No Change'         TO OUT-NEW-JAGE-A
  6483     ELSE
  6484         IF (EN-JNT-ORIG-AGE NOT = ZEROS AND SPACES)
  6485           AND (EN-JNT-NEW-AGE = ZEROS OR SPACES)
  6486             MOVE 'None'         TO OUT-NEW-JAGE-A
  6487         END-IF
  6488     END-IF
  6489     IF (EN-LF-NEW-TERM = EN-LF-ORIG-TERM)
  6490        AND (EN-LF-ORIG-TERM NOT = ZEROS)
  6491        MOVE 'No Change'         TO OUT-NEW-LF-TERM-A
  6492     ELSE
  6493         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6494           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6495             MOVE ZEROS          TO OUT-NEW-LF-TERM
  6496         END-IF
  6497     END-IF
  6498     IF (EN-AH-NEW-TERM = EN-AH-ORIG-TERM)
  6499        AND (EN-AH-ORIG-TERM NOT = ZEROS)
  6500        MOVE 'No Change'         TO OUT-NEW-AH-TERM-A
  6501     ELSE
  6502         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6503           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6504             MOVE ZEROS          TO OUT-NEW-AH-TERM
  6505         END-IF
  6506     END-IF
  6507     IF (EN-AH-NEW-CP = EN-AH-ORIG-CP)
  6508        AND (EN-AH-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6509        MOVE 'No Change'         TO OUT-NEW-CRIT-PER-A
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 114
* NSRASBL.cbl
  6510                                    OUT-NEW-MAX-PMTS-A
  6511     ELSE
  6512         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6513           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6514             MOVE 'None'         TO OUT-NEW-CRIT-PER-A
  6515                                    OUT-NEW-MAX-PMTS-A
  6516         END-IF
  6517     END-IF
  6518     IF OUT-NEW-SCHED-TERM = OUT-ORIG-SCHED-TERM
  6519        MOVE 'No Change'         TO OUT-NEW-SCHED-TERM-A
  6520     END-IF
  6521     IF (OUT-NEW-WAIT-PER = OUT-ORIG-WAIT-PER)
  6522       AND (OUT-ORIG-WAIT-PER NOT = SPACES)
  6523         MOVE 'No Change'        TO OUT-NEW-WAIT-PER
  6524     ELSE
  6525         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6526           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6527             MOVE 'None'         TO OUT-NEW-WAIT-PER
  6528         END-IF
  6529     END-IF
  6530     .
  6531 0650-PROCESS-CANCEL.
  6532     .
  6533 0650-EXIT.
  6534     EXIT.
  6535 0700-WRITE-EXTR.
  6536     display ' made it to 0700 '
  6537     PERFORM 1000-BUILD-ERARCH   THRU 1000-EXIT
  6538     IF BL-FAIL
  6539        MOVE ' COULDNT BUILD ERARCH ' TO BL-MESSAGE
  6540        GO TO 0700-EXIT
  6541     END-IF
  6542     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  6543     MOVE BL-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  6544     MOVE +0                     TO NSAS-SEQ-NO
  6545     PERFORM 0710-BUILD-NSASEXTR THRU 0710-EXIT
  6546     PERFORM 0720-WRITE-NSASEXTR THRU 0720-EXIT
  6547     IF BL-FAIL
  6548        MOVE ' COULDNT BUILD STD NSASEXTR ' TO BL-MESSAGE
  6549        GO TO 0700-EXIT
  6550     END-IF
  6551     IF W-LETTER-TO-ACCT NOT = SPACES
  6552        display ' acct ne spaces ' bl-archive-no
  6553        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  6554        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  6555        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  6556        MOVE +1                  TO NSAS-SEQ-NO
  6557        PERFORM 0720-WRITE-NSASEXTR
  6558                                 THRU 0720-EXIT
  6559        IF BL-FAIL
  6560           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO BL-MESSAGE
  6561           GO TO 0700-EXIT
  6562        END-IF
  6563     END-IF
  6564     IF W-LETTER-TO-BENE NOT = SPACES
  6565        display ' bene ne spaces ' bl-archive-no
  6566        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  6567        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 115
* NSRASBL.cbl
  6568        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  6569        MOVE +2                  TO NSAS-SEQ-NO
  6570        PERFORM 0720-WRITE-NSASEXTR
  6571                                 THRU 0720-EXIT
  6572        IF BL-FAIL
  6573           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO BL-MESSAGE
  6574        END-IF
  6575     END-IF
  6576     IF W-PRINT-CERTIFICATE = 'Y' AND
  6577        BL-STATE = 'VA'
  6578           MOVE OUT-ACCT-NAME       TO VD-ACCOUNT-NAME
  6579           MOVE WS-COMPANY-CD       TO VD-COMPANY-CD
  6580           MOVE BL-CARRIER          TO VD-CARRIER
  6581           MOVE BL-GROUP            TO VD-GROUPING
  6582           MOVE BL-STATE            TO VD-STATE
  6583           MOVE BL-ACCOUNT          TO VD-ACCOUNT
  6584           MOVE WS-ELCERT-EFF-DT    TO VD-CERT-EFF-DT
  6585           MOVE BL-CERT-NO          TO VD-CERT-NO
  6586           MOVE OUT-ILNAME          TO VD-INSURED-LAST-NAME
  6587           MOVE OUT-IFNAME          TO VD-INSURED-FIRST-NAME
  6588           MOVE OUT-IMINIT          TO VD-INSURED-MIDDLE-INIT
  6589           MOVE OUT-JLNAME          TO VD-JOINT-LAST-NAME
  6590           MOVE OUT-JFNAME          TO VD-JOINT-FIRST-NAME
  6591           MOVE OUT-JMINIT          TO VD-JOINT-MIDDLE-INIT
  6592           MOVE OUT-BENE-NAME       TO VD-BENEFICIARY-NAME
  6593           MOVE OUT-ENTRY-BATCH     TO VD-ENTRY-BATCH
  6594           MOVE OUT-CSR-CODE        TO VD-CSR-ID
  6595           MOVE CM-LF-BENEFIT-CD    TO VD-LF-BENEFIT-CD
  6596           MOVE CM-LF-PREMIUM-AMT   TO VD-LF-PREMIUM-AMT
  6597           MOVE CM-LF-BENEFIT-AMT   TO VD-LF-BENEFIT-AMT
  6598           MOVE CM-LF-ORIG-TERM     TO VD-LF-TERM
  6599           MOVE CM-LF-PREMIUM-RATE  TO VD-LF-RATE
  6600           MOVE CM-AH-BENEFIT-CD    TO VD-AH-BENEFIT-CD
  6601           MOVE CM-AH-PREMIUM-AMT   TO VD-AH-PREMIUM-AMT
  6602           MOVE CM-AH-BENEFIT-AMT   TO VD-AH-BENEFIT-AMT
  6603           MOVE CM-AH-ORIG-TERM     TO VD-AH-TERM
  6604           MOVE CM-AH-PREMIUM-RATE  TO VD-AH-RATE
  6605           MOVE CM-LOAN-TERM        TO VD-LOAN-TERM
  6606           MOVE CM-LOAN-APR         TO VD-LOAN-APR
  6607           MOVE CM-LOAN-1ST-PMT-DT  TO VD-1ST-PMT-DT
  6608           MOVE OUT-INS-ADDR1       TO VD-INSURED-ADDRESS-1
  6609           MOVE OUT-INS-ADDR2       TO VD-INSURED-ADDRESS-2
  6610           MOVE OUT-INS-CITY        TO VD-INSURED-CITY
  6611           MOVE OUT-INS-STATE       TO VD-INSURED-STATE
  6612           MOVE OUT-INS-ZIP         TO VD-INSURED-ZIP-CODE
  6613           MOVE 'VADS'              TO VD-LETTER-ID
  6614           MOVE OUT-PROC-ID         TO VD-PROC-ID
  6615           MOVE BL-COMP-ID          TO VD-COMP-ID
  6616           MOVE EIBTIME             TO VD-CURRENT-TIME
  6617           MOVE SAVE-BIN-DATE       TO VD-CURRENT-DATE
  6618           MOVE BL-ARCHIVE-NO       TO VD-ARCHIVE-NO
  6619           MOVE VIRGINIA-DISCLOSURE TO WS-PASS-VADS-REC
  6620
  6621* EXEC CICS LINK
  6622*              PROGRAM    (LINK-ELVADS)
  6623*              COMMAREA   (WS-PASS-AREA)
  6624*              LENGTH     (WS-PASS-AREA-LENGTH)
  6625*          END-EXEC
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 116
* NSRASBL.cbl
  6626*    MOVE '."C                   (   #00006565' TO DFHEIV0
  6627     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6628     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6629     MOVE X'2020233030303036353635' TO DFHEIV0(25:11)
  6630     CALL 'kxdfhei1' USING DFHEIV0,
  6631           LINK-ELVADS,
  6632           WS-PASS-AREA,
  6633           WS-PASS-AREA-LENGTH,
  6634           DFHEIV99,
  6635           DFHEIV99,
  6636           DFHEIV99,
  6637           DFHEIV99
  6638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6639     END-IF
  6640     .
  6641 0700-EXIT.
  6642     EXIT.
  6643  0710-BUILD-NSASEXTR.
  6644***  i added the extra space in front of the 1st ~
  6645***  only because there may be a letter to acct or bene
  6646     STRING
  6647         OUT-LETTER             ' ~'
  6648         OUT-PROC-ID            '~'
  6649         OUT-PROC-NAME          '~'
  6650         OUT-PROC-TITLE         '~'
  6651         OUT-CSR-NAME           '~'
  6652         OUT-CSR-TITLE          '~'
  6653         OUT-CARRIER            '~'
  6654         OUT-GROUPING           '~'
  6655         OUT-STATE              '~'
  6656         OUT-ACCOUNT            '~'
  6657         OUT-CERT-EFF-DT        '~'
  6658         OUT-CERT-NO            '~'
  6659         OUT-CERT-SFX           '~'
  6660         OUT-ILNAME             '~'
  6661         OUT-IFNAME             '~'
  6662         OUT-IFINIT             '~'
  6663         OUT-IMINIT             '~'
  6664         OUT-IAGE               '~'
  6665         OUT-ISEX               '~'
  6666         OUT-INS-ADDR1          '~'
  6667         OUT-INS-ADDR2          '~'
  6668         OUT-INS-CITY           '~'
  6669         OUT-INS-STATE          '~'
  6670         OUT-INS-ZIP            '~'
  6671         OUT-SOC-SEC-NO         '~'
  6672         OUT-MEMBER-NO          '~'
  6673         OUT-JLNAME             '~'
  6674         OUT-JFNAME             '~'
  6675         OUT-JMINIT             '~'
  6676         OUT-JAGE               '~'
  6677         OUT-ACCT-NAME          '~'
  6678         OUT-ACCT-ADDR1         '~'
  6679         OUT-ACCT-ADDR2         '~'
  6680         OUT-ACCT-CITY          '~'
  6681         OUT-ACCT-STATE         '~'
  6682         OUT-ACCT-ZIP           '~'
  6683         OUT-ACCT-PHONE         '~'
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 117
* NSRASBL.cbl
  6684         OUT-ACCT-CNTRL-NAME    '~'
  6685         OUT-ACCT-BUS-TYPE      '~'
  6686         OUT-BENE-NAME          '~'
  6687         OUT-BENE-ADDR1         '~'
  6688         OUT-BENE-ADDR2         '~'
  6689         OUT-BENE-CITY          '~'
  6690         OUT-BENE-STATE         '~'
  6691         OUT-BENE-ZIP           '~'
  6692         OUT-CARR-NAME          '~'
  6693         OUT-RESP-NO            '~'
  6694         OUT-COMP-NAME          '~'
  6695         OUT-COMP-MAIL-TO       '~'
  6696         OUT-COMP-ADDR1         '~'
  6697         OUT-COMP-ADDR2         '~'
  6698         OUT-COMP-CITY          '~'
  6699         OUT-COMP-STATE         '~'
  6700         OUT-COMP-ZIP           '~'
  6701         OUT-COMP-PHONE         '~'
  6702         OUT-COMP-FAX           '~'
  6703         OUT-COMP-STATUS        '~'
  6704         OUT-BILL-SW            '~'
  6705         OUT-RPT-CD1            '~'
  6706         OUT-RPT-CD2            '~'
  6707         OUT-ENTRY-DT           '~'
  6708         OUT-ENTRY-BATCH        '~'
  6709         OUT-ENTRY-STATUS       '~'
  6710         OUT-1ST-PMT-DT         '~'
  6711         OUT-LOAN-APR           '~'
  6712         OUT-LOAN-TERM          '~'
  6713         OUT-RATE-CLASS         '~'
  6714         OUT-EXT-DAYS           '~'
  6715         OUT-CSR-CODE           '~'
  6716         OUT-UCODE              '~'
  6717         OUT-PREM-TYPE          '~'
  6718         OUT-IND-GRP            '~'
  6719         OUT-SKIP-CD            '~'
  6720         OUT-PMT-MODE           '~'
  6721         OUT-LOAN-OFF           '~'
  6722         OUT-REIN-TABLE         '~'
  6723         OUT-SPEC-REIN          '~'
  6724         OUT-LF-BENCD           '~'
  6725         OUT-LF-TERM            '~'
  6726         OUT-LF-DEV-CD          '~'
  6727         OUT-LF-DEV-PCT         '~'
  6728         OUT-LF-BEN             '~'
  6729         OUT-LF-PRM             '~'
  6730         OUT-LF-ALT-BEN         '~'
  6731         OUT-LF-ALT-PRM         '~'
  6732         OUT-LF-NSP             '~'
  6733         OUT-LF-REM-BEN         '~'
  6734         OUT-LF-REF             '~'
  6735         OUT-LF-DTH             '~'
  6736         OUT-LF-RATE            '~'
  6737         OUT-LF-ALT-RATE        '~'
  6738         OUT-LF-EXP-DT          '~'
  6739         OUT-LF-CUR-STATUS      '~'
  6740         OUT-LF-CAN-DT          '~'
  6741         OUT-LF-CAN-EXIT-DT     '~'
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 118
* NSRASBL.cbl
  6742         OUT-LF-DTH-DT          '~'
  6743         OUT-LF-DTH-EXIT-DT     '~'
  6744         OUT-LF-EXIT-BATCH      '~'
  6745         OUT-LF-COMM-PCT        '~'
  6746         OUT-LF-DESC            '~'
  6747         OUT-LF-ABBRV           '~'
  6748         OUT-AH-BENCD           '~'
  6749         OUT-AH-TERM            '~'
  6750         OUT-CRIT-PER           '~'
  6751         OUT-AH-DEV-CD          '~'
  6752         OUT-AH-DEV-PCT         '~'
  6753         OUT-AH-BEN             '~'
  6754         OUT-AH-PRM             '~'
  6755         OUT-AH-NSP             '~'
  6756         OUT-AH-REF             '~'
  6757         OUT-AH-CLM             '~'
  6758         OUT-AH-TOT-BEN         '~'
  6759         OUT-AH-PDTHRU-DT       '~'
  6760         OUT-AH-RATE            '~'
  6761         OUT-AH-EXP-DT          '~'
  6762         OUT-AH-CUR-STATUS      '~'
  6763         OUT-AH-CAN-DT          '~'
  6764         OUT-AH-CAN-EXIT-DT     '~'
  6765         OUT-AH-EXIT-BATCH      '~'
  6766         OUT-AH-COMM-PCT        '~'
  6767         OUT-AH-DESC            '~'
  6768         OUT-RET-ELIM           '~'
  6769         OUT-BEN-DAYS           '~'
  6770         OUT-WAIT-PER           '~'
  6771         OUT-MAX-PMTS           '~'
  6772         OUT-TOT-PRM            '~'
  6773         OUT-TOT-REF            '~'
  6774         OUT-SCHED-EXP-DT       '~'
  6775         OUT-SCHED-TERM         '~'
  6776         OUT-ORIG-ILNAME        '~'
  6777         OUT-ORIG-IFNAME        '~'
  6778         OUT-ORIG-MINIT         '~'
  6779         OUT-ORIG-IAGE          '~'
  6780         OUT-ORIG-JLNAME        '~'
  6781         OUT-ORIG-JFNAME        '~'
  6782         OUT-ORIG-JMINIT        '~'
  6783         OUT-ORIG-JAGE          '~'
  6784         OUT-ORIG-LF-BENCD      '~'
  6785         OUT-ORIG-LF-TERM       '~'
  6786         OUT-ORIG-LF-BEN        '~'
  6787         OUT-ORIG-LF-PRM        '~'
  6788         OUT-LF-CALC-PRM        '~'
  6789         OUT-ORIG-LF-REF        '~'
  6790         OUT-LF-CALC-REF        '~'
  6791         OUT-ORIG-LF-ALT-BEN    '~'
  6792         OUT-ORIG-LF-ALT-PRM    '~'
  6793         OUT-ORIG-LF-EXP-DT     '~'
  6794         OUT-ORIG-LF-DESC       '~'
  6795         OUT-ORIG-AH-BENCD      '~'
  6796         OUT-ORIG-AH-TERM       '~'
  6797         OUT-ORIG-CRIT-PER      '~'
  6798         OUT-ORIG-AH-BEN        '~'
  6799         OUT-ORIG-AH-PRM        '~'
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 119
* NSRASBL.cbl
  6800         OUT-AH-CALC-PRM        '~'
  6801         OUT-ORIG-AH-REF        '~'
  6802         OUT-AH-CALC-REF        '~'
  6803         OUT-ORIG-AH-EXP-DT     '~'
  6804         OUT-ORIG-AH-DESC       '~'
  6805         OUT-ORIG-RET-ELIM      '~'
  6806         OUT-ORIG-BEN-DAYS      '~'
  6807         OUT-ORIG-WAIT-PER      '~'
  6808         OUT-ORIG-MAX-PMTS      '~'
  6809         OUT-ORIG-SCHED-EXP-DT  '~'
  6810         OUT-ORIG-SCHED-TERM    '~'
  6811         OUT-NEW-ILNAME         '~'
  6812         OUT-NEW-IFNAME         '~'
  6813         OUT-NEW-IMINIT         '~'
  6814         OUT-NEW-IAGE           '~'
  6815         OUT-NEW-JLNAME         '~'
  6816         OUT-NEW-JFNAME         '~'
  6817         OUT-NEW-JMINIT         '~'
  6818         OUT-NEW-JAGE           '~'
  6819         OUT-NEW-LF-BENCD       '~'
  6820         OUT-NEW-LF-TERM        '~'
  6821         OUT-NEW-LF-BEN         '~'
  6822         OUT-NEW-LF-PRM         '~'
  6823         OUT-NEW-LF-REF         '~'
  6824         OUT-NEW-LF-ALT-BEN     '~'
  6825         OUT-NEW-LF-ALT-PRM     '~'
  6826         OUT-NEW-LF-EXP-DT      '~'
  6827         OUT-NEW-LF-DESC        '~'
  6828         OUT-NEW-AH-BENCD       '~'
  6829         OUT-NEW-AH-TERM        '~'
  6830         OUT-NEW-CRIT-PER       '~'
  6831         OUT-NEW-AH-BEN         '~'
  6832         OUT-NEW-AH-PRM         '~'
  6833         OUT-NEW-AH-REF         '~'
  6834         OUT-NEW-AH-EXP-DT      '~'
  6835         OUT-NEW-AH-DESC        '~'
  6836         OUT-NEW-RET-ELIM       '~'
  6837         OUT-NEW-BEN-DAYS       '~'
  6838         OUT-NEW-WAIT-PER       '~'
  6839         OUT-NEW-MAX-PMTS       '~'
  6840         OUT-NEW-SCHED-EXP-DT   '~'
  6841         OUT-NEW-SCHED-TERM     '~'
  6842         OUT-TOT-PRM-CHG        '~'
  6843         OUT-TOT-REF-CHG        '~'
  6844         OUT-PAYEE              '~'
  6845         OUT-SIG-SW             '~'
  6846         OUT-BALLOON-IND        '~'
  6847         OUT-LEASE-IND          '~'
  6848         OUT-RESCIND            '~'
  6849         OUT-REA-CD1            '~'
  6850         OUT-REA-CD2            '~'
  6851         OUT-REA-CD3            '~'
  6852         OUT-REA-CD4            '~'
  6853         OUT-REA-CD5            '~'
  6854         OUT-REA-CD6            '~'
  6855         OUT-REA-CD7            '~'
  6856         OUT-REA-CD8            '~'
  6857         OUT-REA-CD9            '~'
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 120
* NSRASBL.cbl
  6858         OUT-REA-CD10           '~'
  6859         OUT-REA-CD11           '~'
  6860         OUT-REA-CD12           '~'
  6861         OUT-CYCLE-DT           '~'
  6862         OUT-ARCH-NO            '~'
  6863         OUT-FORM               '~'
  6864         OUT-ENC-LINE           '~'
  6865         OUT-ATTACH             '~'
  6866         OUT-STACK              '~'
  6867         OUT-STATE-NAME         '~'
  6868         OUT-PRINT-NOW          '~'
  6869         OUT-CHGBACK            '~'
  6870         OUT-CSO-PORTION        '~'
  6871         OUT-ACCT-PORTION       '~'
  6872         OUT-LETTER-TYPE        '~'
  6873         OUT-PRINT-CERTIFICATE  '~'
  6874         OUT-INS-BIRTHDATE      '~'
  6875         OUT-JNT-BIRTHDATE      '~'
  6876         OUT-TOT-INTEREST       '~'
  6877         OUT-ORIG-TOT-PREM      '~'
  6878         OUT-ORIG-TOT-REF       '~'
  6879         OUT-CANCEL-DT          '~'
  6880         OUT-HEALTH-APP         '~'
  6881         OUT-CERTIFICATE-ID     '~'
  6882         OUT-UNDW-ID            '~'
  6883         OUT-NEW-TOT-PREM       '~'
  6884         OUT-NEW-TOT-REF        '~'
  6885         OUT-COVERAGE-IND       '~'
  6886         OUT-ORIG-COVERAGE-IND  '~'
  6887         OUT-NEW-COVERAGE-IND   '~'
  6888         OUT-LF-CMB-PREM        '~'
  6889         OUT-ORIG-LF-CMB-PREM   '~'
  6890         OUT-NEW-LF-CMB-PREM    '~'
  6891         OUT-LF-PREM-CHG        '~'
  6892         OUT-LF-ALT-PREM-CHG    '~'
  6893         OUT-LF-CMB-PREM-CHG    '~'
  6894         OUT-AH-PREM-CHG        '~'
  6895         OUT-LF-REF-CHG         '~'
  6896         OUT-AH-REF-CHG         '~'
  6897         OUT-ACCT-LF-PORTION    '~'
  6898         OUT-ACCT-ALT-LF-PORT   '~'
  6899         OUT-ACCT-CMB-LF-PORT   '~'
  6900         OUT-ACCT-AH-PORTION    '~'
  6901         OUT-CSO-LF-PORTION     '~'
  6902         OUT-CSO-ALT-LF-PORT    '~'
  6903         OUT-CSO-CMB-LF-PORT    '~'
  6904         OUT-CSO-AH-PORTION     '~'
  6905         OUT-ACCT-ORIG-LF-PORT  '~'
  6906         OUT-ACCT-ORIG-ALT-LF-PORT '~'
  6907         OUT-ACCT-ORIG-CMB-LF-PORT '~'
  6908         OUT-ACCT-ORIG-AH-PORT  '~'
  6909         OUT-ACCT-ORIG-PORTION  '~'
  6910         OUT-CSO-ORIG-LF-PORT   '~'
  6911         OUT-CSO-ORIG-ALT-LF-PORT '~'
  6912         OUT-CSO-ORIG-CMB-LF-PORT '~'
  6913         OUT-CSO-ORIG-AH-PORT   '~'
  6914         OUT-CSO-ORIG-PORTION   '~'
  6915         OUT-ACCT-NEW-LF-PORT   '~'
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 121
* NSRASBL.cbl
  6916         OUT-ACCT-NEW-ALT-LF-PORT '~'
  6917         OUT-ACCT-NEW-CMB-LF-PORT '~'
  6918         OUT-ACCT-NEW-AH-PORT   '~'
  6919         OUT-ACCT-NEW-PORTION   '~'
  6920         OUT-CSO-NEW-LF-PORT    '~'
  6921         OUT-CSO-NEW-ALT-LF-PORT '~'
  6922         OUT-CSO-NEW-CMB-LF-PORT '~'
  6923         OUT-CSO-NEW-AH-PORT    '~'
  6924         OUT-CSO-NEW-PORTION    '~'
  6925         OUT-ACCT-LF-PORT-CHG   '~'
  6926         OUT-ACCT-ALT-LF-PORT-CHG '~'
  6927         OUT-ACCT-CMB-LF-PORT-CHG '~'
  6928         OUT-ACCT-AH-PORT-CHG   '~'
  6929         OUT-ACCT-PORTION-CHG   '~'
  6930         OUT-CSO-LF-PORT-CHG    '~'
  6931         OUT-CSO-ALT-LF-PORT-CHG '~'
  6932         OUT-CSO-CMB-LF-PORT-CHG '~'
  6933         OUT-CSO-AH-PORT-CHG    '~'
  6934         OUT-CSO-PORTION-CHG    '~'
  6935         OUT-ORIG-LF-CAN-DT     '~'
  6936         OUT-NEW-LF-CAN-DT      '~'
  6937         OUT-ORIG-AH-CAN-DT     '~'
  6938         OUT-NEW-AH-CAN-DT      '~'
  6939         OUT-ORIG-CAN-DT        '~'
  6940         OUT-NEW-CAN-DT         '~'
  6941         OUT-SCREEN-ID          '~'
  6942            DELIMITED BY '   ' INTO NSAS-LETTER-VARIABLES
  6943     END-STRING
  6944     .
  6945 0710-exit.
  6946     EXIT.
  6947 0720-WRITE-NSASEXTR.
  6948
  6949* EXEC CICS WRITE
  6950*       DATASET    ('NSASEXTR')
  6951*       FROM       (NSAS-EXTRACT-RECORD)
  6952*       RIDFLD     (NSAS-CONTROL-PRIMARY)
  6953*       RESP       (WS-RESPONSE)
  6954*    END-EXEC
  6955     MOVE LENGTH OF
  6956      NSAS-EXTRACT-RECORD
  6957       TO DFHEIV11
  6958     MOVE 'NSASEXTR' TO DFHEIV1
  6959*    MOVE '&$ L                  ''  N#00006879' TO DFHEIV0
  6960     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6961     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6962     MOVE X'204E233030303036383739' TO DFHEIV0(25:11)
  6963     CALL 'kxdfhei1' USING DFHEIV0,
  6964           DFHEIV1,
  6965           NSAS-EXTRACT-RECORD,
  6966           DFHEIV11,
  6967           NSAS-CONTROL-PRIMARY,
  6968           DFHEIV99,
  6969           DFHEIV99
  6970     MOVE EIBRESP  TO WS-RESPONSE
  6971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6972     IF NOT RESP-NORMAL
  6973        display ' bad write nsasextr ' ws-response
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 122
* NSRASBL.cbl
  6974        SET BL-FAIL TO TRUE
  6975     END-IF
  6976     .
  6977 0720-EXIT.
  6978     EXIT.
  6979 0800-init-out-data.
  6980     MOVE ZEROS                  TO OUT-IAGE
  6981                                    OUT-JAGE
  6982                                    OUT-LOAN-APR
  6983                                    OUT-LOAN-TERM
  6984                                    OUT-EXT-DAYS
  6985                                    OUT-LF-TERM
  6986                                    OUT-AH-TERM
  6987                                    OUT-LF-DEV-PCT
  6988                                    OUT-AH-DEV-PCT
  6989                                    OUT-LF-BEN
  6990                                    OUT-AH-BEN
  6991                                    OUT-CRIT-PER
  6992                                    OUT-MAX-PMTS
  6993                                    OUT-SCHED-TERM
  6994                                    OUT-ORIG-IAGE
  6995                                    OUT-ORIG-JAGE
  6996                                    OUT-NEW-IAGE
  6997                                    OUT-NEW-JAGE
  6998                                    OUT-ORIG-LF-TERM
  6999                                    OUT-ORIG-AH-TERM
  7000                                    OUT-NEW-LF-TERM
  7001                                    OUT-NEW-AH-TERM
  7002                                    OUT-ORIG-CRIT-PER
  7003                                    OUT-ORIG-MAX-PMTS
  7004                                    OUT-ORIG-SCHED-TERM
  7005                                    OUT-NEW-SCHED-TERM
  7006                                    OUT-NEW-CRIT-PER
  7007                                    OUT-NEW-MAX-PMTS
  7008                                    OUT-CSO-PORTION
  7009                                    OUT-CSO-LF-PORTION
  7010                                    OUT-CSO-ALT-LF-PORT
  7011                                    OUT-CSO-CMB-LF-PORT
  7012                                    OUT-CSO-AH-PORTION
  7013                                    OUT-ACCT-PORTION
  7014                                    OUT-ACCT-LF-PORTION
  7015                                    OUT-ACCT-ALT-LF-PORT
  7016                                    OUT-ACCT-CMB-LF-PORT
  7017                                    OUT-ACCT-AH-PORTION
  7018                                    OUT-LF-PREM-CHG
  7019                                    OUT-LF-ALT-PREM-CHG
  7020                                    OUT-LF-CMB-PREM-CHG
  7021                                    OUT-AH-PREM-CHG
  7022                                    OUT-LF-REF-CHG
  7023                                    OUT-AH-REF-CHG
  7024     .
  7025 0800-exit.
  7026     exit.
  7027 1000-BUILD-ERARCH.
  7028* DATA SOURCE MEANINGS  BL-DATA-SRCE
  7029*    1) FROM ACCT MAINT
  7030*    2) FROM CERT UPDATE
  7031*    3) FROM COMP MAINT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 123
* NSRASBL.cbl
  7032*    4) FROM REVIEW AND CORRECTIONS
  7033******************************************************************
  7034     MOVE 'LA'                   TO LETTER-ARCHIVE
  7035     MOVE BL-ARCHIVE-NO          TO LA-ARCHIVE-NO
  7036                                    LA-ARCHIVE-NO-A2
  7037                                    LA-ARCHIVE-NO-A3
  7038                                    LA-ARCHIVE-NO-A4
  7039                                    LA-ARCHIVE-NO-A5
  7040                                    LA-ARCHIVE-NO-A6
  7041     MOVE WS-COMPANY-CD          TO LA-COMPANY-CD
  7042                                    LA-COMPANY-CD-A2
  7043                                    LA-COMPANY-CD-A3
  7044                                    LA-COMPANY-CD-A4
  7045                                    LA-COMPANY-CD-A5
  7046                                    LA-COMPANY-CD-A6
  7047     MOVE BL-CARRIER             TO LA-CARRIER-A2
  7048                                    LA-CARRIER-A3
  7049                                    LA-CARRIER-A4
  7050                                    LA-CARRIER-A5
  7051     MOVE BL-GROUP               TO LA-GROUPING-A2
  7052                                    LA-GROUPING-A3
  7053                                    LA-GROUPING-A4
  7054                                    LA-GROUPING-A5
  7055     MOVE BL-ACCOUNT             TO LA-ACCOUNT-A2
  7056                                    LA-ACCOUNT-A3
  7057                                    LA-ACCOUNT-A4
  7058                                    LA-ACCOUNT-A5
  7059     MOVE BL-STATE               TO LA-STATE-A2
  7060                                    LA-STATE-A3
  7061                                    LA-STATE-A4
  7062                                    LA-STATE-A5
  7063     IF BL-DATA-SRCE = '2' OR '4'
  7064        MOVE WS-ELCERT-EFF-DT    TO LA-EFFECT-DATE-A2
  7065        MOVE BL-CERT-NO          TO LA-CERT-NO-A2
  7066     ELSE
  7067        MOVE LOW-VALUES          TO LA-EFFECT-DATE-A2
  7068     END-IF
  7069     IF BL-DATA-SRCE = '4'
  7070        MOVE BL-BATCH-NO         TO LA-ENTRY-A6
  7071     END-IF
  7072     MOVE BL-PROC-ID             TO LA-PROCESSOR-CD
  7073                                    LA-LAST-UPDATED-BY
  7074     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7075                                    LA-INITIAL-PRINT-DATE
  7076                                    LA-SENT-DATE
  7077                                    LA-REPLY-DATE
  7078                                    LA-RESEND-DATE
  7079                                    LA-FOLLOW-UP-DATE
  7080     MOVE 'A'                    TO LA-STATUS
  7081     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7082     MOVE W-FORM-TO-RESEND       TO LA-RESEND-LETR
  7083     IF W-DAYS-TO-RESEND NOT NUMERIC
  7084        MOVE ZEROS               TO W-DAYS-TO-RESEND
  7085     END-IF
  7086     IF W-DAYS-TO-RESEND > ZEROS
  7087        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7088        MOVE W-DAYS-TO-RESEND  TO DC-ELAPSED-DAYS
  7089        MOVE ZEROS               TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 124
* NSRASBL.cbl
  7090        MOVE '6'                 TO DC-OPTION-CODE
  7091        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7092        IF NO-CONVERSION-ERROR
  7093           MOVE DC-BIN-DATE-2    TO LA-RESEND-DATE
  7094        END-IF
  7095     END-IF
  7096     IF W-DAYS-TO-FOLLOW-UP >= ZEROS
  7097        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7098        MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  7099        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7100        MOVE '6'                 TO DC-OPTION-CODE
  7101        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7102        IF NO-CONVERSION-ERROR
  7103           MOVE DC-BIN-DATE-2    TO LA-FOLLOW-UP-DATE
  7104        END-IF
  7105     END-IF
  7106
  7107     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7108     MOVE BL-LETTER-ID           TO LA-FORM-A3
  7109     MOVE BL-DATA-SRCE           TO LA-DATA-SOURCE
  7110     MOVE BL-WRITE-ERARCH        TO LA-ARCHIVE-STATUS
  7111     IF BL-ENDT-ARCH-NO > ZEROS
  7112        MOVE BL-ENDT-ARCH-NO     TO LA-ENDT-ARCH-NO
  7113     ELSE
  7114        MOVE BL-ARCHIVE-NO       TO LA-ENDT-ARCH-NO
  7115     END-IF
  7116     MOVE SAVE-BIN-DATE          TO LA-CREATION-DATE
  7117                                    LA-LAST-MAINT-DATE
  7118     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7119                                    LA-NO-OF-TEXT-RECORDS
  7120     MOVE EIBTIME                TO LA-LAST-MAINT-TIME
  7121
  7122* EXEC CICS WRITE
  7123*         DATASET   ('ERARCH')
  7124*         FROM      (LETTER-ARCHIVE)
  7125*         RIDFLD    (LA-CONTROL-PRIMARY)
  7126*         RESP      (WS-RESPONSE)
  7127*    END-EXEC
  7128     MOVE LENGTH OF
  7129      LETTER-ARCHIVE
  7130       TO DFHEIV11
  7131     MOVE 'ERARCH' TO DFHEIV1
  7132*    MOVE '&$ L                  ''  N#00007034' TO DFHEIV0
  7133     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7134     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7135     MOVE X'204E233030303037303334' TO DFHEIV0(25:11)
  7136     CALL 'kxdfhei1' USING DFHEIV0,
  7137           DFHEIV1,
  7138           LETTER-ARCHIVE,
  7139           DFHEIV11,
  7140           LA-CONTROL-PRIMARY,
  7141           DFHEIV99,
  7142           DFHEIV99
  7143     MOVE EIBRESP  TO WS-RESPONSE
  7144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7145     IF NOT RESP-NORMAL
  7146        DISPLAY ' BAD WRITE ON ERARCH ' WS-RESPONSE ' '
  7147        la-archive-no
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 125
* NSRASBL.cbl
  7148        SET BL-FAIL TO TRUE
  7149     END-IF
  7150     .
  7151 1000-EXIT.
  7152     EXIT.
  7153 1025-GET-CSR-INFO.
  7154     MOVE WS-CSR-ID              TO OUT-CSR-CODE
  7155                                    OUT-CSR-TITLE
  7156                                    OUT-PROC-TITLE
  7157                                    OUT-UNDW-ID
  7158     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7159     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
  7160     MOVE WS-CSR-ID              TO WS-ELCNTL-GENL
  7161     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7162
  7163* EXEC CICS READ
  7164*       INTO    (CONTROL-FILE)
  7165*       DATASET ('ELCNTL')
  7166*       RIDFLD  (WS-ELCNTL-KEY)
  7167*       RESP    (WS-RESPONSE)
  7168*    END-EXEC
  7169     MOVE LENGTH OF
  7170      CONTROL-FILE
  7171       TO DFHEIV11
  7172     MOVE 'ELCNTL' TO DFHEIV1
  7173*    MOVE '&"IL       E          (  N#00007057' TO DFHEIV0
  7174     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7175     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7176     MOVE X'204E233030303037303537' TO DFHEIV0(25:11)
  7177     CALL 'kxdfhei1' USING DFHEIV0,
  7178           DFHEIV1,
  7179           CONTROL-FILE,
  7180           DFHEIV11,
  7181           WS-ELCNTL-KEY,
  7182           DFHEIV99,
  7183           DFHEIV99,
  7184           DFHEIV99
  7185     MOVE EIBRESP  TO WS-RESPONSE
  7186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7187     IF RESP-NORMAL
  7188        MOVE CF-PROCESSOR-NAME   TO OUT-CSR-NAME
  7189                                    OUT-PROC-NAME
  7190*       MOVE CF-PROCESSOR-TITLE  TO OUT-CSR-TITLE
  7191*                                   OUT-PROC-TITLE
  7192     END-IF
  7193     IF BL-PROC-ID NOT = PB-CSR-ID
  7194        MOVE BL-COMP-ID          TO WS-ELCNTL-KEY
  7195        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
  7196        MOVE BL-PROC-ID          TO WS-ELCNTL-GENL
  7197                                    OUT-PROC-TITLE
  7198        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  7199
  7200* EXEC CICS READ
  7201*          INTO    (CONTROL-FILE)
  7202*          DATASET ('ELCNTL')
  7203*          RIDFLD  (WS-ELCNTL-KEY)
  7204*          RESP    (WS-RESPONSE)
  7205*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 126
* NSRASBL.cbl
  7206     MOVE LENGTH OF
  7207      CONTROL-FILE
  7208       TO DFHEIV11
  7209     MOVE 'ELCNTL' TO DFHEIV1
  7210*    MOVE '&"IL       E          (  N#00007075' TO DFHEIV0
  7211     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7212     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7213     MOVE X'204E233030303037303735' TO DFHEIV0(25:11)
  7214     CALL 'kxdfhei1' USING DFHEIV0,
  7215           DFHEIV1,
  7216           CONTROL-FILE,
  7217           DFHEIV11,
  7218           WS-ELCNTL-KEY,
  7219           DFHEIV99,
  7220           DFHEIV99,
  7221           DFHEIV99
  7222     MOVE EIBRESP  TO WS-RESPONSE
  7223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7224        IF RESP-NORMAL
  7225           MOVE CF-PROCESSOR-NAME   TO OUT-PROC-NAME
  7226*          MOVE CF-PROCESSOR-TITLE  TO OUT-PROC-TITLE
  7227        END-IF
  7228     END-IF
  7229     .
  7230 1025-EXIT.
  7231     EXIT.
  7232 1050-GET-ERMAIL.
  7233     MOVE CM-CONTROL-PRIMARY     TO WS-ERMAIL-KEY
  7234
  7235* EXEC CICS READ
  7236*         DATASET    ('ERMAIL')
  7237*         INTO       (MAILING-DATA)
  7238*         RIDFLD     (WS-ERMAIL-KEY)
  7239*         RESP       (WS-RESPONSE)
  7240*    END-EXEC
  7241     MOVE LENGTH OF
  7242      MAILING-DATA
  7243       TO DFHEIV11
  7244     MOVE 'ERMAIL' TO DFHEIV1
  7245*    MOVE '&"IL       E          (  N#00007091' TO DFHEIV0
  7246     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7247     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7248     MOVE X'204E233030303037303931' TO DFHEIV0(25:11)
  7249     CALL 'kxdfhei1' USING DFHEIV0,
  7250           DFHEIV1,
  7251           MAILING-DATA,
  7252           DFHEIV11,
  7253           WS-ERMAIL-KEY,
  7254           DFHEIV99,
  7255           DFHEIV99,
  7256           DFHEIV99
  7257     MOVE EIBRESP  TO WS-RESPONSE
  7258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7259     IF RESP-NORMAL
  7260        MOVE MA-ADDRESS-LINE-1   TO OUT-INS-ADDR1
  7261        MOVE MA-ADDRESS-LINE-2   TO OUT-INS-ADDR2
  7262        MOVE MA-CITY             TO OUT-INS-CITY
  7263        MOVE MA-ADDR-STATE       TO OUT-INS-STATE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 127
* NSRASBL.cbl
  7264        MOVE MA-ZIP              TO OUT-INS-ZIP
  7265        MOVE MA-CRED-BENE-NAME   TO OUT-BENE-NAME
  7266        MOVE MA-CRED-BENE-ADDR   TO OUT-BENE-ADDR1
  7267        MOVE MA-CRED-BENE-ADDR2  TO OUT-BENE-ADDR2
  7268        MOVE MA-CRED-BENE-CITY   TO OUT-BENE-CITY
  7269        MOVE MA-CRED-BENE-STATE  TO OUT-BENE-STATE
  7270        MOVE MA-CRED-BENE-ZIP    TO OUT-BENE-ZIP
  7271        IF MA-INSURED-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7272           MOVE MA-INSURED-BIRTH-DT
  7273                                 TO DC-BIN-DATE-1
  7274           MOVE ' '              TO DC-OPTION-CODE
  7275           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7276           IF NO-CONVERSION-ERROR
  7277              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7278                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7279                INTO OUT-INS-BIRTHDATE
  7280              END-STRING
  7281           END-IF
  7282        END-IF
  7283        IF MA-JOINT-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7284           MOVE MA-JOINT-BIRTH-DT
  7285                                 TO DC-BIN-DATE-1
  7286           MOVE ' '              TO DC-OPTION-CODE
  7287           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7288           IF NO-CONVERSION-ERROR
  7289              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7290                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7291                INTO OUT-JNT-BIRTHDATE
  7292              END-STRING
  7293           END-IF
  7294        END-IF
  7295     END-IF
  7296     .
  7297 1050-EXIT.
  7298     EXIT.
  7299 1100-GET-ELCERT.
  7300
  7301* EXEC CICS READ
  7302*         DATASET    ('ELCERT')
  7303*         INTO       (CERTIFICATE-MASTER)
  7304*         RIDFLD     (WS-ELCERT-KEY)
  7305*         RESP       (WS-RESPONSE)
  7306*    END-EXEC.
  7307     MOVE LENGTH OF
  7308      CERTIFICATE-MASTER
  7309       TO DFHEIV11
  7310     MOVE 'ELCERT' TO DFHEIV1
  7311*    MOVE '&"IL       E          (  N#00007138' TO DFHEIV0
  7312     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7313     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7314     MOVE X'204E233030303037313338' TO DFHEIV0(25:11)
  7315     CALL 'kxdfhei1' USING DFHEIV0,
  7316           DFHEIV1,
  7317           CERTIFICATE-MASTER,
  7318           DFHEIV11,
  7319           WS-ELCERT-KEY,
  7320           DFHEIV99,
  7321           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 128
* NSRASBL.cbl
  7322           DFHEIV99
  7323     MOVE EIBRESP  TO WS-RESPONSE
  7324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7325
  7326     IF RESP-NORMAL
  7327        SET CERT-FOUND TO TRUE
  7328        PERFORM 1110-BUILD-CERT  THRU 1110-EXIT
  7329        PERFORM 1050-GET-ERMAIL  THRU 1050-EXIT
  7330     END-IF
  7331     .
  7332 1100-EXIT.
  7333     EXIT.
  7334 1110-BUILD-CERT.
  7335     PERFORM 1300-DETERMINE-COMM THRU 1300-EXIT
  7336     MOVE SPACES                 TO OUT-COVERAGE-IND
  7337     MOVE SPACES                 TO OUT-ORIG-COVERAGE-IND
  7338     MOVE SPACES                 TO OUT-NEW-COVERAGE-IND
  7339     MOVE CM-CARRIER             TO OUT-CARRIER
  7340     MOVE CM-GROUPING            TO OUT-GROUPING
  7341     MOVE CM-STATE               TO OUT-STATE
  7342     MOVE CM-ACCOUNT             TO OUT-ACCOUNT
  7343     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  7344     MOVE ' '                    TO DC-OPTION-CODE
  7345     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7346     IF NO-CONVERSION-ERROR
  7347        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7348           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7349              INTO OUT-CERT-EFF-DT
  7350        END-STRING
  7351     END-IF
  7352     MOVE CM-CERT-NO             TO OUT-CERT-NO
  7353     MOVE CM-INSURED-LAST-NAME   TO OUT-ILNAME
  7354                                    OUT-ORIG-ILNAME
  7355     MOVE CM-INSURED-INITIAL1    TO OUT-IFINIT
  7356     MOVE CM-INSURED-INITIAL2    TO OUT-IMINIT
  7357                                    OUT-ORIG-MINIT
  7358     IF (CM-SSN-STATE = CM-STATE)
  7359        AND (CM-SSN-ACCOUNT = CM-ACCOUNT (5:6))
  7360        MOVE SPACES              TO OUT-SOC-SEC-NO
  7361     ELSE
  7362        MOVE CM-SOC-SEC-NO       TO OUT-SOC-SEC-NO
  7363     END-IF
  7364     IF (CM-MEMB-STATE = CM-STATE)
  7365        AND (CM-MEMB-ACCOUNT = CM-ACCOUNT (5:6))
  7366        MOVE SPACES              TO OUT-MEMBER-NO
  7367     ELSE
  7368        MOVE CM-MEMBER-NO        TO OUT-MEMBER-NO
  7369     END-IF
  7370     MOVE CM-INSURED-FIRST-NAME  TO OUT-IFNAME
  7371                                    OUT-ORIG-IFNAME
  7372     MOVE CM-INSURED-ISSUE-AGE   TO OUT-IAGE
  7373                                    OUT-ORIG-IAGE
  7374     MOVE CM-INSURED-SEX         TO OUT-ISEX
  7375     MOVE CM-INSURED-JOINT-AGE   TO OUT-JAGE
  7376                                    OUT-ORIG-JAGE
  7377     MOVE CM-JT-LAST-NAME        TO OUT-JLNAME
  7378                                    OUT-ORIG-JLNAME
  7379     MOVE CM-JT-FIRST-NAME       TO OUT-JFNAME
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 129
* NSRASBL.cbl
  7380                                    OUT-ORIG-JFNAME
  7381     MOVE CM-JT-INITIAL          TO OUT-JMINIT
  7382                                    OUT-ORIG-JMINIT
  7383     MOVE CM-LF-BENEFIT-CD       TO OUT-LF-BENCD
  7384                                    OUT-ORIG-LF-BENCD
  7385     MOVE CM-LF-ORIG-TERM        TO OUT-LF-TERM
  7386                                    OUT-ORIG-LF-TERM
  7387     MOVE CM-LF-DEV-CODE         TO OUT-LF-DEV-CD
  7388     IF CM-LF-DEV-PCT NOT NUMERIC
  7389        MOVE ZEROS               TO CM-LF-DEV-PCT
  7390     END-IF
  7391     MOVE CM-LF-DEV-PCT          TO OUT-LF-DEV-PCT
  7392     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7393        IF (PB-C-LF-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7394          (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7395             MOVE SPACES          TO OUT-LF-BENCD
  7396                                     WS-LF-BENCD
  7397                                     OUT-LF-CAN-DT
  7398             MOVE ZEROS           TO OUT-LF-TERM
  7399                                     OUT-LF-BEN
  7400                                     OUT-LF-PRM
  7401                                     OUT-LF-ALT-BEN
  7402                                     OUT-LF-ALT-PRM
  7403                                     OUT-LF-COMM-PCT
  7404                                     OUT-LF-NSP
  7405                                     OUT-LF-REM-BEN
  7406                                     WS-WORK-LF-PREM
  7407                                     WS-WORK-ALT-LF-PREM
  7408                                     WS-WORK-CMB-LF-PREM
  7409                                     OUT-LF-REF
  7410                                     OUT-ORIG-LF-REF
  7411                                     WS-WORK-LF-REF
  7412             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7413             GO TO 1100-LF-CONT
  7414        END-IF
  7415     END-IF
  7416
  7417     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7418        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7419             MOVE SPACES          TO OUT-LF-BENCD
  7420                                     WS-LF-BENCD
  7421                                     OUT-LF-CAN-DT
  7422             MOVE ZEROS           TO OUT-LF-TERM
  7423                                     OUT-LF-BEN
  7424                                     OUT-LF-PRM
  7425                                     OUT-LF-ALT-BEN
  7426                                     OUT-LF-ALT-PRM
  7427                                     OUT-LF-COMM-PCT
  7428                                     OUT-LF-NSP
  7429                                     OUT-LF-REM-BEN
  7430                                     WS-WORK-LF-PREM
  7431                                     WS-WORK-ALT-LF-PREM
  7432                                     WS-WORK-CMB-LF-PREM
  7433                                     OUT-LF-REF
  7434                                     OUT-ORIG-LF-REF
  7435                                     WS-WORK-LF-REF
  7436             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7437             GO TO 1100-LF-CONT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 130
* NSRASBL.cbl
  7438        END-IF
  7439     END-IF
  7440     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  7441         MOVE 'LIFE'             TO OUT-COVERAGE-IND
  7442                                    OUT-ORIG-COVERAGE-IND
  7443     END-IF
  7444
  7445     MOVE CM-LF-BENEFIT-CD       TO WS-LF-BENCD
  7446     MOVE CM-LF-BENEFIT-AMT      TO OUT-LF-BEN
  7447                                    OUT-ORIG-LF-BEN
  7448     IF CM-LF-BENEFIT-AMT = 999999999.99
  7449        MOVE SPACES              TO OUT-ORIG-LF-BEN-A
  7450     END-IF
  7451     MOVE CM-LF-PREMIUM-AMT      TO OUT-LF-PRM
  7452                                    OUT-ORIG-LF-PRM
  7453                                    WS-WORK-LF-PREM
  7454     IF CM-LF-PREMIUM-AMT = .01
  7455         MOVE SPACES             TO OUT-ORIG-LF-PRM-A
  7456     END-IF
  7457     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
  7458        MOVE ZEROS               TO CM-LF-ALT-BENEFIT-AMT
  7459     END-IF
  7460     MOVE CM-LF-ALT-BENEFIT-AMT  TO OUT-LF-ALT-BEN
  7461                                    OUT-ORIG-LF-ALT-BEN
  7462     IF CM-LF-ALT-PREMIUM-AMT NOT NUMERIC
  7463        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-AMT
  7464     END-IF
  7465     MOVE CM-LF-ALT-PREMIUM-AMT  TO OUT-LF-ALT-PRM
  7466                                    OUT-ORIG-LF-ALT-PRM
  7467                                    WS-WORK-ALT-LF-PREM
  7468     COMPUTE WS-WRK-AMOUNT = CM-LF-PREMIUM-AMT +
  7469                             CM-LF-ALT-PREMIUM-AMT
  7470     MOVE WS-WRK-AMOUNT          TO OUT-LF-CMB-PREM
  7471                                 OUT-ORIG-LF-CMB-PREM
  7472                                 WS-WORK-CMB-LF-PREM
  7473     IF CM-LF-NSP-PREMIUM-AMT NOT NUMERIC
  7474        MOVE ZEROS               TO CM-LF-NSP-PREMIUM-AMT
  7475     END-IF
  7476     MOVE CM-LF-NSP-PREMIUM-AMT  TO OUT-LF-NSP
  7477     MOVE CM-LF-REMAINING-AMT    TO OUT-LF-REM-BEN
  7478     MOVE CM-LF-ITD-CANCEL-AMT   TO OUT-LF-REF
  7479                                    OUT-ORIG-LF-REF
  7480                                    WS-WORK-LF-REF
  7481     IF CM-LF-DEATH-CLAIM-APPLIED
  7482        AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  7483            MOVE PB-C-LF-CANCEL-AMT TO OUT-LF-REF
  7484                                    OUT-ORIG-LF-REF
  7485                                    WS-WORK-LF-REF
  7486     END-IF
  7487     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  7488     MOVE ' '                    TO DC-OPTION-CODE
  7489     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7490     IF NO-CONVERSION-ERROR
  7491        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7492           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7493              INTO OUT-LF-CAN-DT
  7494        END-STRING
  7495     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 131
* NSRASBL.cbl
  7496
  7497     IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7498         MOVE ZEROS          TO WS-WORK-LF-PREM
  7499                                WS-WORK-ALT-LF-PREM
  7500                                WS-WORK-CMB-LF-PREM
  7501     END-IF
  7502
  7503      .
  7504 1100-LF-CONT.
  7505
  7506     MOVE CM-LF-ITD-DEATH-AMT    TO OUT-LF-DTH
  7507     IF CM-LF-PREMIUM-RATE NOT NUMERIC
  7508        MOVE ZEROS               TO CM-LF-PREMIUM-RATE
  7509     END-IF
  7510     MOVE CM-LF-PREMIUM-RATE     TO OUT-LF-RATE
  7511     IF CM-LF-ALT-PREMIUM-RATE NOT NUMERIC
  7512        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-RATE
  7513     END-IF
  7514     MOVE CM-LF-ALT-PREMIUM-RATE TO OUT-LF-ALT-RATE
  7515     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7516        IF (PB-C-AH-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7517          (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7518              MOVE SPACES              TO OUT-AH-BENCD
  7519                                          WS-AH-BENCD
  7520                                          OUT-AH-CAN-DT
  7521              MOVE ZEROS               TO OUT-AH-TERM
  7522                                          OUT-AH-BEN
  7523                                          OUT-AH-PRM
  7524                                          OUT-AH-NSP
  7525                                          OUT-AH-COMM-PCT
  7526                                          OUT-CRIT-PER
  7527                                          WS-WORK-AH-PREM
  7528                                          OUT-AH-REF
  7529                                          OUT-ORIG-AH-REF
  7530                                          WS-WORK-AH-REF
  7531              MOVE SPACES              TO OUT-MAX-PMTS-A
  7532                                          OUT-WAIT-PER
  7533                                          OUT-RET-ELIM
  7534                                          OUT-AH-DESC
  7535                                          OUT-BEN-DAYS
  7536              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  7537             GO TO 1100-AH-CONT
  7538        END-IF
  7539     END-IF
  7540
  7541     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7542        IF (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7543              MOVE SPACES              TO OUT-AH-BENCD
  7544                                          WS-AH-BENCD
  7545                                          OUT-AH-CAN-DT
  7546              MOVE ZEROS               TO OUT-AH-TERM
  7547                                          OUT-AH-BEN
  7548                                          OUT-AH-PRM
  7549                                          OUT-AH-NSP
  7550                                          OUT-AH-COMM-PCT
  7551                                          OUT-CRIT-PER
  7552                                          WS-WORK-AH-PREM
  7553                                          OUT-AH-REF
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 132
* NSRASBL.cbl
  7554                                          OUT-ORIG-AH-REF
  7555                                          WS-WORK-AH-REF
  7556              MOVE SPACES              TO OUT-MAX-PMTS-A
  7557                                          OUT-WAIT-PER
  7558                                          OUT-RET-ELIM
  7559                                          OUT-AH-DESC
  7560                                          OUT-BEN-DAYS
  7561              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  7562             GO TO 1100-AH-CONT
  7563        END-IF
  7564     END-IF
  7565     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BENCD
  7566     MOVE CM-AH-BENEFIT-CD       TO OUT-AH-BENCD
  7567                                    OUT-ORIG-AH-BENCD
  7568     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  7569        COMPUTE OUT-AH-TOT-BEN = CM-AH-ORIG-TERM *
  7570           CM-AH-BENEFIT-AMT
  7571        IF OUT-COVERAGE-IND = 'LIFE'
  7572            MOVE 'BOTH'          TO OUT-COVERAGE-IND
  7573                                    OUT-ORIG-COVERAGE-IND
  7574        ELSE
  7575            MOVE 'AH  '          TO OUT-COVERAGE-IND
  7576                                    OUT-ORIG-COVERAGE-IND
  7577        END-IF
  7578     ELSE
  7579        MOVE ZEROS               TO OUT-AH-TOT-BEN
  7580     END-IF
  7581     MOVE CM-AH-ORIG-TERM        TO OUT-AH-TERM
  7582                                    OUT-ORIG-AH-TERM
  7583     MOVE CM-AH-CRITICAL-PERIOD  TO OUT-CRIT-PER
  7584                                    OUT-ORIG-CRIT-PER
  7585                                    OUT-MAX-PMTS
  7586                                    OUT-ORIG-MAX-PMTS
  7587     IF CM-AH-BENEFIT-CD EQUAL '00' OR SPACES
  7588         MOVE SPACES             TO OUT-MAX-PMTS-A
  7589     END-IF
  7590     MOVE CM-AH-DEV-CODE         TO OUT-AH-DEV-CD
  7591     IF CM-AH-DEV-PCT NOT NUMERIC
  7592        MOVE ZEROS               TO CM-AH-DEV-PCT
  7593     END-IF
  7594     MOVE CM-AH-DEV-PCT          TO OUT-AH-DEV-PCT
  7595     MOVE CM-AH-BENEFIT-AMT      TO OUT-AH-BEN
  7596                                    OUT-ORIG-AH-BEN
  7597     IF CM-AH-BENEFIT-AMT = 999999999.99
  7598        MOVE SPACES              TO OUT-ORIG-AH-BEN-A
  7599     END-IF
  7600     MOVE CM-AH-PREMIUM-AMT      TO OUT-AH-PRM
  7601                                    OUT-ORIG-AH-PRM
  7602                                    WS-WORK-AH-PREM
  7603     IF CM-AH-PREMIUM-AMT = .01
  7604         MOVE SPACES             TO OUT-ORIG-AH-PRM-A
  7605     END-IF
  7606     MOVE CM-AH-NSP-PREMIUM-AMT  TO OUT-AH-NSP
  7607     MOVE CM-AH-ITD-CANCEL-AMT   TO OUT-AH-REF
  7608                                    OUT-ORIG-AH-REF
  7609                                    WS-WORK-AH-REF
  7610     IF CM-AH-DEATH-CLAIM-APPLIED
  7611        AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES OR SPACES)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 133
* NSRASBL.cbl
  7612            MOVE PB-C-AH-CANCEL-AMT TO OUT-AH-REF
  7613                                    OUT-ORIG-AH-REF
  7614                                    WS-WORK-AH-REF
  7615     END-IF
  7616     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  7617     MOVE ' '                    TO DC-OPTION-CODE
  7618     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7619     IF NO-CONVERSION-ERROR
  7620        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7621           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7622              INTO OUT-AH-CAN-DT
  7623        END-STRING
  7624     END-IF
  7625
  7626     IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7627         MOVE ZEROS          TO WS-WORK-AH-PREM
  7628     END-IF
  7629
  7630      .
  7631 1100-AH-CONT.
  7632
  7633     MOVE CM-AH-ITD-AH-PMT       TO OUT-AH-CLM
  7634     MOVE CM-AH-PAID-THRU-DT     TO DC-BIN-DATE-1
  7635     MOVE ' '                    TO DC-OPTION-CODE
  7636     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7637     IF NO-CONVERSION-ERROR
  7638        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7639           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7640              INTO OUT-AH-PDTHRU-DT
  7641        END-STRING
  7642     END-IF
  7643     IF CM-AH-PREMIUM-RATE NOT NUMERIC
  7644        MOVE ZEROS               TO CM-AH-PREMIUM-RATE
  7645     END-IF
  7646     MOVE CM-AH-PREMIUM-RATE     TO OUT-AH-RATE
  7647     IF CM-LOAN-APR NOT NUMERIC
  7648        MOVE ZEROS               TO CM-LOAN-APR
  7649     END-IF
  7650     MOVE CM-LOAN-APR            TO OUT-LOAN-APR
  7651     MOVE CM-LOAN-TERM           TO OUT-LOAN-TERM
  7652     MOVE CM-RATE-CLASS          TO OUT-RATE-CLASS
  7653     MOVE CM-PMT-EXTENSION-DAYS  TO OUT-EXT-DAYS
  7654     MOVE CM-UNDERWRITING-CODE   TO OUT-UCODE
  7655     MOVE CM-PREMIUM-TYPE        TO OUT-PREM-TYPE
  7656     MOVE CM-IND-GRP-TYPE        TO OUT-IND-GRP
  7657     MOVE CM-LOAN-OFFICER        TO OUT-LOAN-OFF
  7658     MOVE CM-REIN-TABLE          TO OUT-REIN-TABLE
  7659     MOVE CM-SPECIAL-REIN-CODE   TO OUT-SPEC-REIN
  7660     MOVE CM-LF-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  7661     MOVE ' '                    TO DC-OPTION-CODE
  7662     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7663     IF NO-CONVERSION-ERROR
  7664        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7665           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7666              INTO OUT-LF-EXP-DT
  7667        END-STRING
  7668     END-IF
  7669     MOVE OUT-LF-EXP-DT          TO OUT-ORIG-LF-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 134
* NSRASBL.cbl
  7670     MOVE CM-AH-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  7671     MOVE ' '                    TO DC-OPTION-CODE
  7672     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7673     IF NO-CONVERSION-ERROR
  7674        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7675           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7676              INTO OUT-AH-EXP-DT
  7677        END-STRING
  7678     END-IF
  7679     MOVE OUT-AH-EXP-DT          TO OUT-ORIG-AH-EXP-DT
  7680     MOVE CM-LOAN-1ST-PMT-DT     TO DC-BIN-DATE-1
  7681     MOVE ' '                    TO DC-OPTION-CODE
  7682     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7683     IF NO-CONVERSION-ERROR
  7684        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7685           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7686              INTO OUT-1ST-PMT-DT
  7687        END-STRING
  7688     END-IF
  7689     MOVE CM-ENTRY-STATUS        TO OUT-ENTRY-STATUS
  7690     MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  7691     MOVE ' '                    TO DC-OPTION-CODE
  7692     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7693     IF NO-CONVERSION-ERROR
  7694        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7695           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7696              INTO OUT-ENTRY-DT
  7697        END-STRING
  7698     END-IF
  7699     MOVE CM-LF-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  7700     MOVE ' '                    TO DC-OPTION-CODE
  7701     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7702     IF NO-CONVERSION-ERROR
  7703        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7704           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7705              INTO OUT-LF-CAN-EXIT-DT
  7706        END-STRING
  7707     END-IF
  7708     MOVE CM-LF-DEATH-DT         TO DC-BIN-DATE-1
  7709     MOVE ' '                    TO DC-OPTION-CODE
  7710     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7711     IF NO-CONVERSION-ERROR
  7712        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7713           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7714              INTO OUT-LF-DTH-DT
  7715        END-STRING
  7716     END-IF
  7717     MOVE CM-LF-DEATH-EXIT-DT    TO DC-BIN-DATE-1
  7718     MOVE ' '                    TO DC-OPTION-CODE
  7719     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7720     IF NO-CONVERSION-ERROR
  7721        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7722           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7723              INTO OUT-LF-DTH-EXIT-DT
  7724        END-STRING
  7725     END-IF
  7726     MOVE CM-LF-CURRENT-STATUS   TO OUT-LF-CUR-STATUS
  7727     IF OUT-AH-CAN-DT NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 135
* NSRASBL.cbl
  7728        MOVE OUT-AH-CAN-DT       TO OUT-CANCEL-DT
  7729     ELSE
  7730        MOVE OUT-LF-CAN-DT       TO OUT-CANCEL-DT
  7731     END-IF
  7732     MOVE CM-AH-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  7733     MOVE ' '                    TO DC-OPTION-CODE
  7734     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7735     IF NO-CONVERSION-ERROR
  7736        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7737           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7738              INTO OUT-AH-CAN-EXIT-DT
  7739        END-STRING
  7740     END-IF
  7741     MOVE CM-AH-CURRENT-STATUS   TO OUT-AH-CUR-STATUS
  7742     IF CM-ENTRY-BATCH = LOW-VALUES
  7743        MOVE SPACES              TO CM-ENTRY-BATCH
  7744     END-IF
  7745     MOVE CM-ENTRY-BATCH         TO OUT-ENTRY-BATCH
  7746     IF CM-LF-EXIT-BATCH = LOW-VALUES
  7747        MOVE SPACES              TO CM-LF-EXIT-BATCH
  7748     END-IF
  7749     MOVE CM-LF-EXIT-BATCH       TO OUT-LF-EXIT-BATCH
  7750     IF CM-AH-EXIT-BATCH = LOW-VALUES
  7751        MOVE SPACES              TO CM-AH-EXIT-BATCH
  7752     END-IF
  7753     MOVE CM-AH-EXIT-BATCH       TO OUT-AH-EXIT-BATCH
  7754     MOVE WS-CHGBK-LIFE-PCT      TO OUT-LF-COMM-PCT
  7755     MOVE WS-CHGBK-AH-PCT        TO OUT-AH-COMM-PCT
  7756     MOVE CM-CERT-SFX            TO OUT-CERT-SFX
  7757     MOVE CM-CONTROL-PRIMARY     TO MA-CONTROL-PRIMARY
  7758     COMPUTE WS-WORK-PREM =
  7759        (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT
  7760           + CM-AH-PREMIUM-AMT)
  7761     MOVE WS-WORK-PREM           TO OUT-TOT-PRM
  7762                                    OUT-ORIG-TOT-PREM
  7763     COMPUTE WS-WORK-REF =
  7764        (WS-WORK-LF-REF + WS-WORK-AH-REF)
  7765     MOVE WS-WORK-REF            TO OUT-TOT-REF
  7766                                    OUT-ORIG-TOT-REF
  7767     IF CM-LF-LOAN-EXPIRE-DT > CM-AH-LOAN-EXPIRE-DT
  7768        MOVE OUT-LF-EXP-DT       TO OUT-SCHED-EXP-DT
  7769     ELSE
  7770        MOVE OUT-AH-EXP-DT       TO OUT-SCHED-EXP-DT
  7771     END-IF
  7772     MOVE OUT-SCHED-EXP-DT       TO OUT-ORIG-SCHED-EXP-DT
  7773     IF CM-LF-ORIG-TERM > CM-AH-ORIG-TERM
  7774        MOVE CM-LF-ORIG-TERM     TO OUT-SCHED-TERM
  7775     ELSE
  7776        MOVE CM-AH-ORIG-TERM     TO OUT-SCHED-TERM
  7777     END-IF
  7778     MOVE OUT-SCHED-TERM         TO OUT-ORIG-SCHED-TERM
  7779     IF CM-NH-INT-ON-REFS NUMERIC
  7780        IF CM-NH-INT-ON-REFS NOT = ZEROS
  7781           MOVE CM-NH-INT-ON-REFS TO OUT-TOT-INTEREST
  7782        END-IF
  7783     END-IF
  7784
  7785     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 136
* NSRASBL.cbl
  7786        IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7787            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  7788        END-IF
  7789        IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7790            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  7791        END-IF
  7792     END-IF
  7793*
  7794*     IF BL-DATA-SRCE = '2'
  7795*        IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7796*            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  7797*        END-IF
  7798*        IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7799*            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  7800*        END-IF
  7801*     END-IF
  7802
  7803     COMPUTE WS-ACCT-LF-PORTION =
  7804        WS-WORK-LF-PREM * WS-CHGBK-LIFE-PCT
  7805     MOVE WS-ACCT-LF-PORTION TO OUT-ACCT-LF-PORTION
  7806                                OUT-ACCT-ORIG-LF-PORT
  7807     COMPUTE WS-ACCT-ALT-LF-PORTION =
  7808        WS-WORK-ALT-LF-PREM * WS-CHGBK-LIFE-PCT
  7809     MOVE WS-ACCT-ALT-LF-PORTION TO OUT-ACCT-ALT-LF-PORT
  7810                                OUT-ACCT-ORIG-ALT-LF-PORT
  7811     COMPUTE WS-ACCT-CMB-LF-PORTION =
  7812        WS-WORK-CMB-LF-PREM * WS-CHGBK-LIFE-PCT
  7813     MOVE WS-ACCT-CMB-LF-PORTION TO OUT-ACCT-CMB-LF-PORT
  7814                                OUT-ACCT-ORIG-CMB-LF-PORT
  7815     COMPUTE WS-ACCT-AH-PORTION =
  7816        WS-WORK-AH-PREM * WS-CHGBK-AH-PCT
  7817     MOVE WS-ACCT-AH-PORTION TO OUT-ACCT-AH-PORTION
  7818                                OUT-ACCT-ORIG-AH-PORT
  7819     COMPUTE WS-ACCT-PORTION =
  7820        WS-ACCT-CMB-LF-PORTION + WS-ACCT-AH-PORTION
  7821     MOVE WS-ACCT-PORTION TO OUT-ACCT-PORTION
  7822                                OUT-ACCT-ORIG-PORTION
  7823
  7824     COMPUTE WS-CSO-LF-PORTION =
  7825       WS-WORK-LF-PREM - WS-ACCT-LF-PORTION
  7826     MOVE WS-CSO-LF-PORTION TO OUT-CSO-LF-PORTION
  7827                               OUT-CSO-ORIG-LF-PORT
  7828     COMPUTE WS-CSO-ALT-LF-PORTION =
  7829       WS-WORK-ALT-LF-PREM - WS-ACCT-ALT-LF-PORTION
  7830     MOVE WS-CSO-ALT-LF-PORTION TO OUT-CSO-ALT-LF-PORT
  7831                                   OUT-CSO-ORIG-ALT-LF-PORT
  7832     COMPUTE WS-CSO-CMB-LF-PORTION =
  7833       WS-WORK-CMB-LF-PREM - WS-ACCT-CMB-LF-PORTION
  7834     MOVE WS-CSO-CMB-LF-PORTION TO OUT-CSO-CMB-LF-PORT
  7835                                   OUT-CSO-ORIG-CMB-LF-PORT
  7836     COMPUTE WS-CSO-AH-PORTION =
  7837        WS-WORK-AH-PREM - WS-ACCT-AH-PORTION
  7838     MOVE WS-CSO-AH-PORTION TO OUT-CSO-AH-PORTION
  7839                               OUT-CSO-ORIG-AH-PORT
  7840     COMPUTE WS-CSO-PORTION =
  7841        WS-CSO-CMB-LF-PORTION + WS-CSO-AH-PORTION
  7842     MOVE WS-CSO-PORTION TO OUT-CSO-PORTION
  7843                            OUT-CSO-ORIG-PORTION
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 137
* NSRASBL.cbl
  7844     .
  7845 1110-EXIT.
  7846     EXIT.
  7847 1115-MATCH-COMPANY.
  7848     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7849     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  7850     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7851
  7852* EXEC CICS READ
  7853*       INTO    (CONTROL-FILE)
  7854*       DATASET ('ELCNTL')
  7855*       RIDFLD  (WS-ELCNTL-KEY)
  7856*       RESP    (WS-RESPONSE)
  7857*    END-EXEC
  7858     MOVE LENGTH OF
  7859      CONTROL-FILE
  7860       TO DFHEIV11
  7861     MOVE 'ELCNTL' TO DFHEIV1
  7862*    MOVE '&"IL       E          (  N#00007669' TO DFHEIV0
  7863     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7864     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7865     MOVE X'204E233030303037363639' TO DFHEIV0(25:11)
  7866     CALL 'kxdfhei1' USING DFHEIV0,
  7867           DFHEIV1,
  7868           CONTROL-FILE,
  7869           DFHEIV11,
  7870           WS-ELCNTL-KEY,
  7871           DFHEIV99,
  7872           DFHEIV99,
  7873           DFHEIV99
  7874     MOVE EIBRESP  TO WS-RESPONSE
  7875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7876     IF RESP-NORMAL
  7877        MOVE CF-COMPANY-CD       TO WS-COMPANY-CD
  7878     END-IF
  7879     .
  7880 1115-EXIT.
  7881     EXIT.
  7882 1120-MATCH-CARRIER.
  7883     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7884     MOVE '6'                    TO WS-ELCNTL-REC-TYPE
  7885     MOVE BL-CARRIER             TO WS-ELCNTL-CARR
  7886     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7887
  7888* EXEC CICS READ
  7889*       INTO    (CONTROL-FILE)
  7890*       DATASET ('ELCNTL')
  7891*       RIDFLD  (WS-ELCNTL-KEY)
  7892*       RESP    (WS-RESPONSE)
  7893*    END-EXEC
  7894     MOVE LENGTH OF
  7895      CONTROL-FILE
  7896       TO DFHEIV11
  7897     MOVE 'ELCNTL' TO DFHEIV1
  7898*    MOVE '&"IL       E          (  N#00007686' TO DFHEIV0
  7899     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7900     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7901     MOVE X'204E233030303037363836' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 138
* NSRASBL.cbl
  7902     CALL 'kxdfhei1' USING DFHEIV0,
  7903           DFHEIV1,
  7904           CONTROL-FILE,
  7905           DFHEIV11,
  7906           WS-ELCNTL-KEY,
  7907           DFHEIV99,
  7908           DFHEIV99,
  7909           DFHEIV99
  7910     MOVE EIBRESP  TO WS-RESPONSE
  7911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7912     IF RESP-NORMAL
  7913        MOVE CF-MAIL-TO-NAME     TO OUT-CARR-NAME
  7914     ELSE
  7915        MOVE 'UNKNOWN'           TO OUT-CARR-NAME
  7916     END-IF
  7917     .
  7918 1120-EXIT.
  7919     EXIT.
  7920 1125-MATCH-STATE.
  7921     MOVE BL-STATE               TO OUT-STATE
  7922     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7923     MOVE '3'                    TO WS-ELCNTL-REC-TYPE
  7924     MOVE BL-STATE               TO WS-ELCNTL-STATE
  7925     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7926
  7927* EXEC CICS READ
  7928*       INTO    (CONTROL-FILE)
  7929*       DATASET ('ELCNTL')
  7930*       RIDFLD  (WS-ELCNTL-KEY)
  7931*       RESP    (WS-RESPONSE)
  7932*    END-EXEC
  7933     MOVE LENGTH OF
  7934      CONTROL-FILE
  7935       TO DFHEIV11
  7936     MOVE 'ELCNTL' TO DFHEIV1
  7937*    MOVE '&"IL       E          (  N#00007706' TO DFHEIV0
  7938     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7939     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7940     MOVE X'204E233030303037373036' TO DFHEIV0(25:11)
  7941     CALL 'kxdfhei1' USING DFHEIV0,
  7942           DFHEIV1,
  7943           CONTROL-FILE,
  7944           DFHEIV11,
  7945           WS-ELCNTL-KEY,
  7946           DFHEIV99,
  7947           DFHEIV99,
  7948           DFHEIV99
  7949     MOVE EIBRESP  TO WS-RESPONSE
  7950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7951     IF RESP-NORMAL
  7952        MOVE CF-STATE-NAME       TO OUT-STATE-NAME
  7953     ELSE
  7954        MOVE 'UNKNOWN'           TO OUT-STATE-NAME
  7955     END-IF
  7956     .
  7957 1125-EXIT.
  7958     EXIT.
  7959 1130-MATCH-BENCDS.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 139
* NSRASBL.cbl
  7960     MOVE SPACES                 TO WS-LF-ABBRV
  7961                                    WS-LF-DESC
  7962                                    WS-LF-EARN
  7963                                    WS-WAIT-PER
  7964                                    WS-RET-ELIM
  7965                                    WS-AH-DESC
  7966                                    WS-BEN-DAYS
  7967     IF WS-LF-BENCD NOT = ZEROS AND SPACES
  7968        PERFORM 1140-MATCH-LFBEN THRU 1140-EXIT
  7969     END-IF
  7970     IF WS-AH-BENCD NOT = ZEROS AND SPACES
  7971        PERFORM 1150-MATCH-AHBEN THRU 1150-EXIT
  7972     END-IF
  7973     .
  7974 1130-EXIT.
  7975     EXIT.
  7976 1140-MATCH-LFBEN.
  7977     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7978     MOVE '4'                    TO WS-ELCNTL-REC-TYPE
  7979     MOVE WS-LF-BENCD            TO WS-ELCNTL-BEN-CD
  7980     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7981
  7982* EXEC CICS READ
  7983*       INTO    (CONTROL-FILE)
  7984*       DATASET ('ELCNTL')
  7985*       RIDFLD  (WS-ELCNTL-KEY)
  7986*       GTEQ
  7987*       RESP    (WS-RESPONSE)
  7988*    END-EXEC
  7989     MOVE LENGTH OF
  7990      CONTROL-FILE
  7991       TO DFHEIV11
  7992     MOVE 'ELCNTL' TO DFHEIV1
  7993*    MOVE '&"IL       G          (  N#00007742' TO DFHEIV0
  7994     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  7995     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7996     MOVE X'204E233030303037373432' TO DFHEIV0(25:11)
  7997     CALL 'kxdfhei1' USING DFHEIV0,
  7998           DFHEIV1,
  7999           CONTROL-FILE,
  8000           DFHEIV11,
  8001           WS-ELCNTL-KEY,
  8002           DFHEIV99,
  8003           DFHEIV99,
  8004           DFHEIV99
  8005     MOVE EIBRESP  TO WS-RESPONSE
  8006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8007     IF RESP-NORMAL
  8008        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8009           (WS-LF-BENCD = CF-BENEFIT-CODE (S1))
  8010           OR (S1 > +8)
  8011        END-PERFORM
  8012        IF S1 < + 9
  8013           MOVE CF-BENEFIT-ALPHA (S1)
  8014                                 TO WS-LF-ABBRV
  8015           MOVE WS-LF-BENCD      TO WS-LF-DESC
  8016           MOVE CF-CO-EARNINGS-CALC (S1)
  8017                                 TO WS-LF-EARN
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 140
* NSRASBL.cbl
  8018        ELSE
  8019           MOVE 'XX'             TO WS-LF-DESC
  8020           MOVE 'XXX'            TO WS-LF-ABBRV
  8021        END-IF
  8022     ELSE
  8023        DISPLAY ' NO LF BEN CD ' WS-LF-BENCD
  8024     END-IF
  8025     .
  8026 1140-EXIT.
  8027     EXIT.
  8028 1150-MATCH-AHBEN.
  8029     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8030     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  8031     MOVE WS-AH-BENCD            TO WS-ELCNTL-BEN-CD
  8032     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8033
  8034* EXEC CICS READ
  8035*       INTO    (CONTROL-FILE)
  8036*       DATASET ('ELCNTL')
  8037*       RIDFLD  (WS-ELCNTL-KEY)
  8038*       GTEQ
  8039*       RESP    (WS-RESPONSE)
  8040*    END-EXEC
  8041     MOVE LENGTH OF
  8042      CONTROL-FILE
  8043       TO DFHEIV11
  8044     MOVE 'ELCNTL' TO DFHEIV1
  8045*    MOVE '&"IL       G          (  N#00007775' TO DFHEIV0
  8046     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8047     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8048     MOVE X'204E233030303037373735' TO DFHEIV0(25:11)
  8049     CALL 'kxdfhei1' USING DFHEIV0,
  8050           DFHEIV1,
  8051           CONTROL-FILE,
  8052           DFHEIV11,
  8053           WS-ELCNTL-KEY,
  8054           DFHEIV99,
  8055           DFHEIV99,
  8056           DFHEIV99
  8057     MOVE EIBRESP  TO WS-RESPONSE
  8058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8059     IF RESP-NORMAL
  8060        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8061           (WS-AH-BENCD = CF-BENEFIT-CODE (S1))
  8062           OR (S1 > +8)
  8063        END-PERFORM
  8064        IF S1 < + 9
  8065           MOVE CF-BENEFIT-ALPHA (S1)
  8066                                 TO WS-WAIT-PER
  8067           MOVE CF-BENEFIT-ALPHA (S1) (3:1)
  8068                                 TO WS-RET-ELIM
  8069           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  8070                                 TO WS-BEN-DAYS
  8071           IF CF-SPECIAL-CALC-CD (S1) = 'C'
  8072              IF CF-JOINT-INDICATOR (S1) = 'J'
  8073                 MOVE 'Joint Critical Period Disability'
  8074                                 TO WS-AH-DESC
  8075              ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 141
* NSRASBL.cbl
  8076                 MOVE 'Single Critical Period-Primary Only'
  8077                                 TO WS-AH-DESC
  8078              END-IF
  8079           ELSE
  8080              IF CF-JOINT-INDICATOR (S1) = 'J'
  8081                 MOVE 'Joint Disability'
  8082                                 TO WS-AH-DESC
  8083              ELSE
  8084                 MOVE 'Single Disability (Primary Only)'
  8085                                 TO WS-AH-DESC
  8086              END-IF
  8087           END-IF
  8088        ELSE
  8089           MOVE 'NOT FOUND'      TO WS-AH-DESC
  8090        END-IF
  8091     ELSE
  8092        DISPLAY ' NO AH BEN CD ' WS-AH-BENCD
  8093     END-IF
  8094     .
  8095 1150-EXIT.
  8096     EXIT.
  8097 1200-GET-ERACCT.
  8098     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  8099     MOVE ' UNKNOWN '            TO OUT-ACCT-NAME
  8100                                    OUT-ACCT-ADDR1
  8101                                    OUT-ACCT-ADDR2
  8102                                    OUT-ACCT-CITY
  8103     MOVE ZEROS                  TO WS-CHGBACK
  8104
  8105* EXEC CICS STARTBR
  8106*        DATASET   ('ERACCT')
  8107*        RIDFLD    (WS-ERACCT-KEY)
  8108*        GTEQ
  8109*        RESP      (WS-RESPONSE)
  8110*    END-EXEC
  8111     MOVE 'ERACCT' TO DFHEIV1
  8112     MOVE 0
  8113       TO DFHEIV11
  8114*    MOVE '&,         G          &  N#00007827' TO DFHEIV0
  8115     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8116     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8117     MOVE X'204E233030303037383237' TO DFHEIV0(25:11)
  8118     CALL 'kxdfhei1' USING DFHEIV0,
  8119           DFHEIV1,
  8120           WS-ERACCT-KEY,
  8121           DFHEIV99,
  8122           DFHEIV11,
  8123           DFHEIV99
  8124     MOVE EIBRESP  TO WS-RESPONSE
  8125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8126     IF RESP-NORMAL
  8127
  8128* EXEC CICS READNEXT
  8129*          INTO    (ACCOUNT-MASTER)
  8130*          DATASET ('ERACCT')
  8131*          RIDFLD  (WS-ERACCT-KEY)
  8132*          RESP    (WS-RESPONSE)
  8133*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 142
* NSRASBL.cbl
  8134     MOVE LENGTH OF
  8135      ACCOUNT-MASTER
  8136       TO DFHEIV12
  8137     MOVE 'ERACCT' TO DFHEIV1
  8138     MOVE 0
  8139       TO DFHEIV11
  8140*    MOVE '&.IL                  )  N#00007834' TO DFHEIV0
  8141     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8142     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8143     MOVE X'204E233030303037383334' TO DFHEIV0(25:11)
  8144     CALL 'kxdfhei1' USING DFHEIV0,
  8145           DFHEIV1,
  8146           ACCOUNT-MASTER,
  8147           DFHEIV12,
  8148           WS-ERACCT-KEY,
  8149           DFHEIV99,
  8150           DFHEIV11,
  8151           DFHEIV99,
  8152           DFHEIV99
  8153     MOVE EIBRESP  TO WS-RESPONSE
  8154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8155     END-IF
  8156     IF RESP-NORMAL
  8157        PERFORM UNTIL
  8158           NOT (RESP-NORMAL)
  8159           OR (WS-SAVE-ERACCT-KEY NOT =
  8160                        AM-CONTROL-PRIMARY (1:20))
  8161           IF BL-DATA-SRCE = '4' OR '2'
  8162              IF (WS-CERT-EFF-DT < AM-EXPIRATION-DT
  8163                 AND >= AM-EFFECTIVE-DT)
  8164                 PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8165                    (AM-COM-TYP (S1) = 'C' OR 'D')
  8166                    OR (S1 > +10)
  8167                 END-PERFORM
  8168                 IF S1 < +11
  8169                    MOVE AM-COMM-CHARGEBACK (S1)
  8170                                 TO WS-CHGBACK
  8171                 END-IF
  8172              END-IF
  8173           END-IF
  8174           MOVE ACCOUNT-MASTER   TO WS-SAVE-ERACCT-REC
  8175
  8176* EXEC CICS READNEXT
  8177*             INTO    (ACCOUNT-MASTER)
  8178*             DATASET ('ERACCT')
  8179*             RIDFLD  (WS-ERACCT-KEY)
  8180*             RESP    (WS-RESPONSE)
  8181*          END-EXEC
  8182     MOVE LENGTH OF
  8183      ACCOUNT-MASTER
  8184       TO DFHEIV12
  8185     MOVE 'ERACCT' TO DFHEIV1
  8186     MOVE 0
  8187       TO DFHEIV11
  8188*    MOVE '&.IL                  )  N#00007860' TO DFHEIV0
  8189     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8190     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8191     MOVE X'204E233030303037383630' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 143
* NSRASBL.cbl
  8192     CALL 'kxdfhei1' USING DFHEIV0,
  8193           DFHEIV1,
  8194           ACCOUNT-MASTER,
  8195           DFHEIV12,
  8196           WS-ERACCT-KEY,
  8197           DFHEIV99,
  8198           DFHEIV11,
  8199           DFHEIV99,
  8200           DFHEIV99
  8201     MOVE EIBRESP  TO WS-RESPONSE
  8202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8203        END-PERFORM
  8204        MOVE WS-SAVE-ERACCT-REC  TO ACCOUNT-MASTER
  8205        IF WS-SAVE-ERACCT-KEY = AM-CONTROL-PRIMARY (1:20)
  8206           SET ACCT-FOUND TO TRUE
  8207           MOVE AM-NAME          TO OUT-ACCT-NAME
  8208           MOVE AM-ADDRS         TO OUT-ACCT-ADDR1
  8209           MOVE SPACES           TO OUT-ACCT-ADDR2
  8210           MOVE AM-ADDR-CITY     TO OUT-ACCT-CITY
  8211           MOVE AM-ADDR-STATE    TO OUT-ACCT-STATE
  8212           MOVE AM-ZIP-PRIME     TO OUT-ACCT-ZIP
  8213           MOVE AM-REPORT-CODE-1 TO OUT-RPT-CD1
  8214           MOVE AM-REPORT-CODE-2 TO OUT-RPT-CD2
  8215           IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  8216              STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  8217                 INTO OUT-ACCT-ZIP (6:5)
  8218              END-STRING
  8219           END-IF
  8220           MOVE AM-TEL-NO        TO OUT-ACCT-PHONE
  8221           MOVE AM-GPCD          TO OUT-ACCT-BUS-TYPE
  8222           MOVE AM-STATE         TO OUT-FORM
  8223           IF AM-ACCOUNT (10:1) = 'L'
  8224              MOVE 'L'           TO OUT-FORM (3:1)
  8225                                    OUT-LEASE-IND
  8226           END-IF
  8227           MOVE AM-CONTROL-PRIMARY (1:8)
  8228                                 TO WS-ERCOMP-KEY
  8229           IF AM-REMIT-TO NOT NUMERIC
  8230              MOVE 01            TO AM-REMIT-TO
  8231           END-IF
  8232           MOVE AM-AGT (AM-REMIT-TO) TO WS-ERCOMP-RESP-NO
  8233           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8234              (AM-COM-TYP (S1) = 'C' OR 'D')
  8235              OR (S1 > +10)
  8236           END-PERFORM
  8237           IF S1 < +11
  8238              MOVE AM-AGT (S1)   TO WS-ERCOMP-ACCOUNT
  8239           END-IF
  8240           MOVE 'A'              TO WS-ERCOMP-REC-TYPE
  8241           PERFORM 1225-GET-ERCOMP THRU 1225-EXIT
  8242        END-IF
  8243     END-IF
  8244
  8245* EXEC CICS ENDBR
  8246*        DATASET   ('ERACCT')
  8247*    END-EXEC
  8248     MOVE 'ERACCT' TO DFHEIV1
  8249     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 144
* NSRASBL.cbl
  8250       TO DFHEIV11
  8251*    MOVE '&2                    $   #00007907' TO DFHEIV0
  8252     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8253     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8254     MOVE X'2020233030303037393037' TO DFHEIV0(25:11)
  8255     CALL 'kxdfhei1' USING DFHEIV0,
  8256           DFHEIV1,
  8257           DFHEIV11,
  8258           DFHEIV99
  8259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8260    .
  8261 1200-EXIT.
  8262     EXIT.
  8263 1225-GET-ERCOMP.
  8264
  8265* EXEC CICS READ
  8266*       INTO    (COMPENSATION-MASTER)
  8267*       DATASET ('ERCOMP')
  8268*       RIDFLD  (WS-ERCOMP-KEY)
  8269*       RESP    (WS-RESPONSE)
  8270*    END-EXEC
  8271     MOVE LENGTH OF
  8272      COMPENSATION-MASTER
  8273       TO DFHEIV11
  8274     MOVE 'ERCOMP' TO DFHEIV1
  8275*    MOVE '&"IL       E          (  N#00007914' TO DFHEIV0
  8276     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8277     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8278     MOVE X'204E233030303037393134' TO DFHEIV0(25:11)
  8279     CALL 'kxdfhei1' USING DFHEIV0,
  8280           DFHEIV1,
  8281           COMPENSATION-MASTER,
  8282           DFHEIV11,
  8283           WS-ERCOMP-KEY,
  8284           DFHEIV99,
  8285           DFHEIV99,
  8286           DFHEIV99
  8287     MOVE EIBRESP  TO WS-RESPONSE
  8288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8289     IF RESP-NORMAL
  8290        MOVE CO-RESP-NO          TO OUT-RESP-NO
  8291        MOVE CO-ACCT-NAME        TO OUT-COMP-NAME
  8292        MOVE CO-MAIL-NAME        TO OUT-COMP-MAIL-TO
  8293        MOVE CO-ADDR-1           TO OUT-COMP-ADDR1
  8294        MOVE CO-ADDR-2           TO OUT-COMP-ADDR2
  8295        MOVE CO-ADDR-CITY        TO OUT-COMP-CITY
  8296        MOVE CO-ADDR-STATE       TO OUT-COMP-STATE
  8297        MOVE CO-ZIP              TO OUT-COMP-ZIP
  8298        MOVE CO-TELEPHONE        TO OUT-COMP-PHONE
  8299        MOVE CO-FAXNO            TO OUT-COMP-FAX
  8300        MOVE CO-GA-STATUS-CODE   TO OUT-COMP-STATUS
  8301        MOVE CO-BILL-SW          TO OUT-BILL-SW
  8302     END-IF
  8303     .
  8304 1225-EXIT.
  8305     EXIT.
  8306 1250-GET-ELLETR.
  8307     display ' made it to 1250 '
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 145
* NSRASBL.cbl
  8308     move spaces                 to W-Z-CONTROL-DATA
  8309     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  8310     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  8311     MOVE +0                     TO WS-ELLETR-SEQ-NO
  8312
  8313* EXEC CICS READ
  8314*         DATASET    ('ELLETR')
  8315*         INTO       (TEXT-FILES)
  8316*         RIDFLD     (WS-ELLETR-KEY)
  8317*         RESP       (WS-RESPONSE)
  8318*         GTEQ
  8319*    END-EXEC
  8320     MOVE LENGTH OF
  8321      TEXT-FILES
  8322       TO DFHEIV11
  8323     MOVE 'ELLETR' TO DFHEIV1
  8324*    MOVE '&"IL       G          (  N#00007943' TO DFHEIV0
  8325     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8326     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8327     MOVE X'204E233030303037393433' TO DFHEIV0(25:11)
  8328     CALL 'kxdfhei1' USING DFHEIV0,
  8329           DFHEIV1,
  8330           TEXT-FILES,
  8331           DFHEIV11,
  8332           WS-ELLETR-KEY,
  8333           DFHEIV99,
  8334           DFHEIV99,
  8335           DFHEIV99
  8336     MOVE EIBRESP  TO WS-RESPONSE
  8337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8338     IF RESP-NORMAL
  8339        IF (LETTER-FILE-TEXT)
  8340           AND (BL-LETTER-ID = TX-LETTER-NO)
  8341           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  8342           display ' found good z record '
  8343           PERFORM 1280-PROCESS-Z-CONTROLS
  8344                                 THRU 1280-EXIT
  8345        END-IF
  8346     END-IF
  8347     .
  8348 1250-EXIT.
  8349     EXIT.
  8350 1280-PROCESS-Z-CONTROLS.
  8351     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  8352*    IF W-FORM-TO-RESEND > SPACES
  8353*       MOVE W-FORM-TO-RESEND    TO OUT-FORM
  8354*    ELSE
  8355*       MOVE SPACES              TO OUT-FORM
  8356*    END-IF
  8357     MOVE W-ENCLOSURE-CD         TO BL-ENC-CD
  8358     MOVE W-LETTER-TYPE          TO OUT-LETTER-TYPE
  8359     MOVE W-PRINT-CERTIFICATE    TO OUT-PRINT-CERTIFICATE
  8360     .
  8361 1280-EXIT.
  8362     EXIT.
  8363 1300-DETERMINE-COMM.
  8364******************************************************************
  8365* DATA SOURCE MEANINGS  BL-DATA-SRCE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 146
* NSRASBL.cbl
  8366*    1) FROM ACCT MAINT
  8367*    2) FROM CERT UPDATE
  8368*    3) FROM COMP MAINT
  8369*    4) FROM REVIEW AND CORRECTIONS
  8370******************************************************************
  8371     MOVE 'Y'                    TO OUT-CHGBACK
  8372     MOVE ZEROS                  TO WS-DIFF
  8373                                    WS-CHGBK-LIFE-PCT
  8374                                    WS-CHGBK-AH-PCT
  8375     IF BL-DATA-SRCE = '4'
  8376        IF PB-CANCELLATION
  8377           MOVE PB-CI-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8378           MOVE PB-CI-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8379           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
  8380           MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-2
  8381           IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  8382              MOVE PB-C-LF-CANCEL-DT
  8383                                 TO DC-BIN-DATE-2
  8384           END-IF
  8385           MOVE '1'              TO DC-OPTION-CODE
  8386           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8387           IF NO-CONVERSION-ERROR
  8388              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8389              IF DC-ODD-DAYS-OVER > +1
  8390                 ADD +1          TO WS-DIFF
  8391              END-IF
  8392              IF (WS-CHGBACK = 99)
  8393                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8394                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8395                                WS-CHGBK-AH-PCT
  8396                   MOVE 'N'  TO OUT-CHGBACK
  8397              END-IF
  8398           END-IF
  8399        ELSE
  8400           MOVE PB-I-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8401           MOVE PB-I-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8402        END-IF
  8403     ELSE
  8404        MOVE CM-LIFE-COMM-PCT TO WS-CHGBK-LIFE-PCT
  8405        MOVE CM-AH-COMM-PCT   TO WS-CHGBK-AH-PCT
  8406        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8407           OR (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8408           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  8409           MOVE CM-AH-CANCEL-DT  TO DC-BIN-DATE-2
  8410           IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  8411              MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  8412           END-IF
  8413           MOVE '1'              TO DC-OPTION-CODE
  8414           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8415           IF NO-CONVERSION-ERROR
  8416              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8417              IF DC-ODD-DAYS-OVER > +1
  8418                 ADD +1          TO WS-DIFF
  8419              END-IF
  8420              IF (WS-CHGBACK = 99)
  8421                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8422                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8423                                WS-CHGBK-AH-PCT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 147
* NSRASBL.cbl
  8424                   MOVE 'N'  TO OUT-CHGBACK
  8425              END-IF
  8426           END-IF
  8427        END-IF
  8428     END-IF
  8429     .
  8430 1300-EXIT.
  8431     EXIT.
  8432 1500-GET-ARCH-NO.
  8433     DISPLAY ' MADE IT TO 1500 '
  8434     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  8435     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8436     MOVE SPACES                 TO WS-ELCNTL-GENL
  8437     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8438
  8439* EXEC CICS READ
  8440*       INTO    (CONTROL-FILE)
  8441*       DATASET ('ELCNTL')
  8442*       RIDFLD  (WS-ELCNTL-KEY)
  8443*       UPDATE
  8444*       RESP    (WS-RESPONSE)
  8445*    END-EXEC
  8446     MOVE LENGTH OF
  8447      CONTROL-FILE
  8448       TO DFHEIV11
  8449     MOVE 'ELCNTL' TO DFHEIV1
  8450*    MOVE '&"IL       EU         (  N#00008050' TO DFHEIV0
  8451     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8452     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8453     MOVE X'204E233030303038303530' TO DFHEIV0(25:11)
  8454     CALL 'kxdfhei1' USING DFHEIV0,
  8455           DFHEIV1,
  8456           CONTROL-FILE,
  8457           DFHEIV11,
  8458           WS-ELCNTL-KEY,
  8459           DFHEIV99,
  8460           DFHEIV99,
  8461           DFHEIV99
  8462     MOVE EIBRESP  TO WS-RESPONSE
  8463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8464     IF RESP-NORMAL
  8465        AND (CF-COMPANY-ID  = BL-COMP-ID)
  8466        AND (CF-RECORD-TYPE = '1')
  8467        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  8468        MOVE CF-CREDIT-LAST-ARCH-NUM
  8469                                 TO WS-ARCHIVE-NO
  8470
  8471* EXEC CICS REWRITE
  8472*          FROM    (CONTROL-FILE)
  8473*          DATASET ('ELCNTL')
  8474*       END-EXEC
  8475     MOVE LENGTH OF
  8476      CONTROL-FILE
  8477       TO DFHEIV11
  8478     MOVE 'ELCNTL' TO DFHEIV1
  8479*    MOVE '&& L                  %   #00008063' TO DFHEIV0
  8480     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8481     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 148
* NSRASBL.cbl
  8482     MOVE X'2020233030303038303633' TO DFHEIV0(25:11)
  8483     CALL 'kxdfhei1' USING DFHEIV0,
  8484           DFHEIV1,
  8485           CONTROL-FILE,
  8486           DFHEIV11,
  8487           DFHEIV99
  8488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8489     ELSE
  8490        MOVE +0                  TO WS-ARCHIVE-NO
  8491     END-IF
  8492    .
  8493 1500-EXIT.
  8494     EXIT.
  8495 1700-GET-ELENCC.
  8496     MOVE WS-COMPANY-CD          TO WS-ELENCC-KEY
  8497     MOVE '2'                    TO WS-ELENCC-REC-TYPE
  8498     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  8499     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  8500        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  8501        OR (E1 > +5)
  8502     END-PERFORM
  8503     IF E1 < +5
  8504        MOVE BL-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  8505     END-IF
  8506
  8507* EXEC CICS READ
  8508*        DATASET   ('ELENCC')
  8509*        INTO      (ENCLOSURE-CODES)
  8510*        RIDFLD    (WS-ELENCC-KEY)
  8511*        RESP      (WS-RESPONSE)
  8512*    END-EXEC
  8513     MOVE LENGTH OF
  8514      ENCLOSURE-CODES
  8515       TO DFHEIV11
  8516     MOVE 'ELENCC' TO DFHEIV1
  8517*    MOVE '&"IL       E          (  N#00008084' TO DFHEIV0
  8518     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8519     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8520     MOVE X'204E233030303038303834' TO DFHEIV0(25:11)
  8521     CALL 'kxdfhei1' USING DFHEIV0,
  8522           DFHEIV1,
  8523           ENCLOSURE-CODES,
  8524           DFHEIV11,
  8525           WS-ELENCC-KEY,
  8526           DFHEIV99,
  8527           DFHEIV99,
  8528           DFHEIV99
  8529     MOVE EIBRESP  TO WS-RESPONSE
  8530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8531     IF NOT RESP-NORMAL
  8532        display ' elencc resp not normal ' ws-response
  8533        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  8534
  8535* EXEC CICS READ
  8536*           DATASET   ('ELENCC')
  8537*           INTO      (ENCLOSURE-CODES)
  8538*           RIDFLD    (WS-ELENCC-KEY)
  8539*           RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 149
* NSRASBL.cbl
  8540*       END-EXEC
  8541     MOVE LENGTH OF
  8542      ENCLOSURE-CODES
  8543       TO DFHEIV11
  8544     MOVE 'ELENCC' TO DFHEIV1
  8545*    MOVE '&"IL       E          (  N#00008093' TO DFHEIV0
  8546     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8547     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8548     MOVE X'204E233030303038303933' TO DFHEIV0(25:11)
  8549     CALL 'kxdfhei1' USING DFHEIV0,
  8550           DFHEIV1,
  8551           ENCLOSURE-CODES,
  8552           DFHEIV11,
  8553           WS-ELENCC-KEY,
  8554           DFHEIV99,
  8555           DFHEIV99,
  8556           DFHEIV99
  8557     MOVE EIBRESP  TO WS-RESPONSE
  8558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8559     END-IF
  8560     IF RESP-NORMAL
  8561        display ' elencc resp normal ' ws-response
  8562        MOVE NC-OUTPUT-STACK     TO OUT-STACK
  8563        MOVE NC-ENCLOSURE-LINE   TO OUT-ENC-LINE
  8564        MOVE NC-ATTACHMENTS      TO OUT-ATTACH
  8565     END-IF
  8566     .
  8567 1700-EXIT.
  8568     EXIT.
  8569 9700-DATE-LINK.
  8570
  8571* EXEC CICS LINK
  8572*        PROGRAM   ('ELDATCV')
  8573*        COMMAREA  (DATE-CONVERSION-DATA)
  8574*        LENGTH    (DC-COMM-LENGTH)
  8575*    END-EXEC.
  8576     MOVE 'ELDATCV' TO DFHEIV1
  8577*    MOVE '."C                   (   #00008110' TO DFHEIV0
  8578     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8579     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8580     MOVE X'2020233030303038313130' TO DFHEIV0(25:11)
  8581     CALL 'kxdfhei1' USING DFHEIV0,
  8582           DFHEIV1,
  8583           DATE-CONVERSION-DATA,
  8584           DC-COMM-LENGTH,
  8585           DFHEIV99,
  8586           DFHEIV99,
  8587           DFHEIV99,
  8588           DFHEIV99
  8589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8590
  8591 9700-EXIT.
  8592      EXIT.
  8593
  8594 9999-DFHBACK SECTION.
  8595     MOVE '9%                    "   ' TO DFHEIV0
  8596     MOVE 'NSRASBL' TO DFHEIV1
  8597     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 10:58 Page 150
* NSRASBL.cbl
  8598     GOBACK.
  8599 9999-DFHEXIT.
  8600     IF DFHEIGDJ EQUAL 0001
  8601         NEXT SENTENCE.
  8602     MOVE '9%                    "   ' TO DFHEIV0
  8603     MOVE 'NSRASBL' TO DFHEIV1
  8604     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8605     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34476     Code:       53444
