* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   1
* EL6503.cbl
* Options: int("EL6503.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6503.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6503.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6503.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6503.
     3*                            VMOD=2.001.
     4*AUTHOR.    PABLO.
     5*           OMAHA, NEBRASKA.
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    10*            *                                                   *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   2
* EL6503.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE BRANCH LOCATION AND SHIPPING ADDRESSES FOR PRODUCERS
    19*
    20*    SCREENS     - EL650I - BRANCH LOCAL AND SHIPPING ADDR MAINT
    21*
    22*    ENTERED BY  - EL650 - ACCOUNT MAINTENANCE MENU
    23*
    24*    EXIT TO     - EL650 - ACCOUNT MAINTENANCE MENU
    25*
    26*    COMMAREA    - PASSED
    27*
    28*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL650.  ON
    29*                  FIRST ENTRY, READ ERACNT TO DISPLAY INFO,  THE
    30*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    31*                  ENTRIES (XCTL FROM CICS VIA EXC7) THE SCREEN
    32*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    33*                  MAINTENANCE TYPE INDICATED.
    34******************************************************************
    35*                   C H A N G E   L O G
    36*
    37* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    38*-----------------------------------------------------------------
    39*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    40* EFFECTIVE    NUMBER
    41*-----------------------------------------------------------------
    42* 110706  CR2006071700004  PEMA  NEW PROGRAM
    43* 111407  CR2007010300001  PEMA  USE ACCT SEC FOR THIS PROGRAM
    44******************************************************************
    45 ENVIRONMENT DIVISION.
    46 DATA DIVISION.
    47 WORKING-STORAGE SECTION.
    48 01  DFH-START PIC X(04).
    49 77  FILLER  PIC X(32)  VALUE '********************************'.
    50 77  FILLER  PIC X(32)  VALUE '*   EL6503 WORKING STORAGE     *'.
    51 77  FILLER  PIC X(32)  VALUE '***********VMOD=2.001 **********'.
    52 77  CI1                PIC S999  COMP-3 VALUE +0.
    53 77  B1                 PIC S999  COMP-3 VALUE +0.
    54 77  WS-BROWSE-SW                PIC X   VALUE SPACES.
    55     88  ERACNT-BROWSE-STARTED         VALUE 'Y'.
    56*    COPY ELCSCTM.
    57******************************************************************
    58*                                                                *
    59*                                                                *
    60*                            ELCSCTM                             *
    61*                            VMOD=2.001                          *
    62*                                                                *
    63*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    64*                                                                *
    65******************************************************************
    66 01  SECURITY-MESSAGE.
    67     12  FILLER                          PIC X(30)
    68            VALUE '** LOGIC SECURITY VIOLATION -'.
    69     12  SM-READ                         PIC X(6).
    70     12  FILLER                          PIC X(5)
    71            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   3
* EL6503.cbl
    72     12  SM-PGM                          PIC X(6).
    73     12  FILLER                          PIC X(5)
    74            VALUE ' OPR='.
    75     12  SM-PROCESSOR-ID                 PIC X(4).
    76     12  FILLER                          PIC X(6)
    77            VALUE ' TERM='.
    78     12  SM-TERMID                       PIC X(4).
    79     12  FILLER                          PIC XX   VALUE SPACE.
    80     12  SM-JUL-DATE                     PIC 9(5).
    81     12  FILLER                          PIC X    VALUE SPACE.
    82     12  SM-TIME                         PIC 99.99.
    83
    84*    COPY ELCSCRTY.
    85******************************************************************
    86*                                                                *
    87*                                                                *
    88*                            ELCSCRTY                            *
    89*                            VMOD=2.001                          *
    90*                                                                *
    91*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    92*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    93*        SAVED IN PI-SECURITY-ADDRESS.                           *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-CONTROL.
    97     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    98     12  FILLER                       PIC XX    VALUE 'SC'.
    99     12  SC-CREDIT-CODES.
   100         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   101             20  SC-CREDIT-DISPLAY    PIC X.
   102             20  SC-CREDIT-UPDATE     PIC X.
   103     12  SC-CLAIMS-CODES.
   104         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   105             20  SC-CLAIMS-DISPLAY    PIC X.
   106             20  SC-CLAIMS-UPDATE     PIC X.
   107 01  WS-DATE-AREA.
   108     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   109     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   110 01  WS-INC-DATE                 PIC XX  VALUE LOW-VALUES.
   111 01  WS-RPT-DATE                 PIC XX  VALUE LOW-VALUES.
   112 01  WS-EST-DATE                 PIC XX  VALUE LOW-VALUES.
   113 01  WS-PRF-DATE                 PIC XX  VALUE LOW-VALUES.
   114 01  WS-LSTPD-DATE               PIC XX  VALUE LOW-VALUES.
   115 01  FILLER                          COMP-3.
   116     05  WS-RECORD-COUNT             PIC S9(3)   VALUE ZERO.
   117     05  WS-READNEXT-SW              PIC S9      VALUE ZERO.
   118     05  WS-LAST-ERROR-COUNT         PIC S9(3)   VALUE ZERO.
   119     05  WS-UPDATE-SW                PIC S9      VALUE ZERO.
   120     05  WS-COMPLETED-SUCCESSFUL     PIC S9      VALUE ZERO.
   121       88  TRANSACTION-SUCCESSFUL                    VALUE +1.
   122       88  INITIAL-TRANSACTION                       VALUE +2.
   123       88  CHANGE-SUCCESSFUL                         VALUE +3.
   124     05  TIME-IN                     PIC S9(7)   VALUE ZERO.
   125     05  TIME-OUT                    REDEFINES
   126         TIME-IN                     PIC S9(3)V9(4).
   127 01  FILLER                          COMP SYNC.
   128     05  WS-INDEX                    PIC S9(4)   VALUE ZERO.
   129     05  WS-JOURNAL-FILE-ID          PIC S9(4)   VALUE +1.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   4
* EL6503.cbl
   130     05  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +773.
   131     05  ERACNT-LENGTH               PIC S9(4)   VALUE +120.
   132     05  GETMAIN-SPACE               PIC  X      VALUE SPACE.
   133 01  FILLER.
   134     12  DEEDIT-FIELD        PIC  X(10).
   135     12  DEEDIT-FIELD-V0  REDEFINES
   136         DEEDIT-FIELD        PIC S9(10).
   137     12  DEEDIT-FIELD-V2  REDEFINES
   138         DEEDIT-FIELD        PIC 9(8)V99.
   139     05  WS-BIN-DATES OCCURS 10.
   140         10  WS-BIN-DATE         PIC XX.
   141     05  WS-RESPONSE             PIC S9(8)   COMP.
   142         88  RESP-NORMAL              VALUE +00.
   143         88  RESP-ERROR               VALUE +01.
   144         88  RESP-NOTFND              VALUE +13.
   145         88  RESP-NOTOPEN             VALUE +19.
   146         88  RESP-ENDFILE             VALUE +20.
   147     05  WS-SAVE-ERACNT-KEY      PIC X(23)   VALUE LOW-VALUES.
   148     05  WS-CONTROL-PRIMARY.
   149         10  WS-COMPANY-CD           PIC X      VALUE SPACES.
   150         10  WS-CARRIER              PIC X      VALUE SPACES.
   151         10  WS-GROUPING             PIC X(6)   VALUE SPACES.
   152         10  WS-STATE                PIC XX     VALUE SPACES.
   153         10  WS-ACCOUNT              PIC X(10)  VALUE SPACES.
   154         10  WS-REC-TYPE             PIC X      VALUE SPACES.
   155         10  WS-SEQ-NO               PIC S9(4)  VALUE +0 COMP.
   156     05  WS-CONTROL-FILE-KEY.
   157         10  WS-CFK-COMPANY-ID       PIC X(3)    VALUE SPACES.
   158         10  WS-CFK-RECORD-TYPE      PIC X       VALUE SPACES.
   159         10  WS-CFK-STATE            PIC XX      VALUE SPACES.
   160         10  WS-CFK-BENEFIT-CD       PIC XX      VALUE SPACES.
   161         10  WS-CFK-SEQUENCE-NO      PIC S9(4)   VALUE ZERO COMP.
   162     05  WS-MAPSET-NAME              PIC X(8)  VALUE 'EL6503S'.
   163     05  WS-MAP-NAME                 PIC X(8)  VALUE 'EL6503A'.
   164     05  FILLER                      REDEFINES
   165         WS-MAP-NAME.
   166         10  FILLER                  PIC XX.
   167         10  WS-MAP-NUMBER           PIC X(4).
   168         10  FILLER                  PIC XX.
   169     05  THIS-PGM                    PIC X(8)  VALUE 'EL6503'.
   170     05  WS-JOURNAL-TYPE-ID          PIC XX      VALUE 'EL'.
   171     05  WS-LOW-VALUES               PIC X VALUE LOW-VALUES.
   172     05  WS-SPACE                    PIC X       VALUE SPACE.
   173     05  WS-TRANS-ID                 PIC X(4)    VALUE 'EXC7'.
   174     05  WS-TEMP-STORAGE-KEY.
   175         10  WS-TS-TERM-ID           PIC X(4)    VALUE 'XXXX'.
   176         10  FILLER                  PIC X(4)    VALUE '6503'.
   177     05  WS-ERROR-MESSAGE-AREA.
   178         10  ER-0000                 PIC 9(4)   VALUE 0000.
   179         10  ER-0004                 PIC 9(4)   VALUE 0004.
   180         10  ER-0006                 PIC 9(4)   VALUE 0006.
   181         10  ER-0008                 PIC 9(4)   VALUE 0008.
   182         10  ER-0023                 PIC 9(4)   VALUE 0023.
   183         10  ER-0029                 PIC 9(4)   VALUE 0029.
   184         10  ER-0070                 PIC 9(4)   VALUE 0070.
   185         10  ER-0150                 PIC 9(4)   VALUE 0150.
   186         10  ER-0196                 PIC 9(4)   VALUE 0196.
   187         10  ER-0419                 PIC 9(4)   VALUE 0419.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   5
* EL6503.cbl
   188         10  ER-0491                 PIC 9(4)   VALUE 0491.
   189         10  ER-1079                 PIC 9(4)   VALUE 1079.
   190         10  ER-1257                 PIC 9(4)   VALUE 1257.
   191         10  ER-1258                 PIC 9(4)   VALUE 1258.
   192         10  ER-2261                 PIC 9(4)   VALUE 2261.
   193         10  ER-3800                 PIC 9(4)   VALUE 3800.
   194         10  ER-3801                 PIC 9(4)   VALUE 3801.
   195         10  ER-3802                 PIC 9(4)   VALUE 3802.
   196         10  ER-3803                 PIC 9(4)   VALUE 3803.
   197         10  ER-3804                 PIC 9(4)   VALUE 3804.
   198         10  ER-3805                 PIC 9(4)   VALUE 3805.
   199         10  ER-3806                 PIC 9(4)   VALUE 3806.
   200         10  ER-3807                 PIC 9(4)   VALUE 3807.
   201         10  ER-3810                 PIC 9(4)   VALUE 3810.
   202         10  ER-3811                 PIC 9(4)   VALUE 3811.
   203         10  ER-3812                 PIC 9(4)   VALUE 3812.
   204         10  ER-3813                 PIC 9(4)   VALUE 3813.
   205         10  ER-3814                 PIC 9(4)   VALUE 3814.
   206         10  ER-3815                 PIC 9(4)   VALUE 3815.
   207         10  ER-3816                 PIC 9(4)   VALUE 3816.
   208         10  ER-3817                 PIC 9(4)   VALUE 3817.
   209         10  ER-3818                 PIC 9(4)   VALUE 3818.
   210         10  ER-3819                 PIC 9(4)   VALUE 3819.
   211         10  ER-7220                 PIC 9(4)   VALUE 7220.
   212         10  ER-7698                 PIC 9(4)   VALUE 7698.
   213         10  ER-9999                 PIC 9(4)   VALUE 9999.
   214*                                COPY ELCINTF.
   215******************************************************************
   216*                                                                *
   217*                                                                *
   218*                            ELCINTF.                            *
   219*                            VMOD=2.017                          *
   220*                                                                *
   221*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   222*                                                                *
   223*       LENGTH = 1024                                            *
   224*                                                                *
   225******************************************************************
   226*                   C H A N G E   L O G
   227*
   228* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   229*-----------------------------------------------------------------
   230*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   231* EFFECTIVE    NUMBER
   232*-----------------------------------------------------------------
   233* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   234******************************************************************
   235 01  PROGRAM-INTERFACE-BLOCK.
   236     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   237     12  PI-CALLING-PROGRAM              PIC X(8).
   238     12  PI-SAVED-PROGRAM-1              PIC X(8).
   239     12  PI-SAVED-PROGRAM-2              PIC X(8).
   240     12  PI-SAVED-PROGRAM-3              PIC X(8).
   241     12  PI-SAVED-PROGRAM-4              PIC X(8).
   242     12  PI-SAVED-PROGRAM-5              PIC X(8).
   243     12  PI-SAVED-PROGRAM-6              PIC X(8).
   244     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   245     12  PI-COMPANY-ID                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   6
* EL6503.cbl
   246     12  PI-COMPANY-CD                   PIC X.
   247
   248     12  PI-COMPANY-PASSWORD             PIC X(8).
   249
   250     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   251
   252     12  PI-CONTROL-IN-PROGRESS.
   253         16  PI-CARRIER                  PIC X.
   254         16  PI-GROUPING                 PIC X(6).
   255         16  PI-STATE                    PIC XX.
   256         16  PI-ACCOUNT                  PIC X(10).
   257         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   258                                         PIC X(10).
   259         16  PI-CLAIM-CERT-GRP.
   260             20  PI-CLAIM-NO             PIC X(7).
   261             20  PI-CERT-NO.
   262                 25  PI-CERT-PRIME       PIC X(10).
   263                 25  PI-CERT-SFX         PIC X.
   264             20  PI-CERT-EFF-DT          PIC XX.
   265         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   266             20  PI-PLAN-CODE            PIC X(2).
   267             20  PI-REVISION-NUMBER      PIC X(3).
   268             20  PI-PLAN-EFF-DT          PIC X(2).
   269             20  PI-PLAN-EXP-DT          PIC X(2).
   270             20  FILLER                  PIC X(11).
   271         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   272             20  PI-OE-REFERENCE-1.
   273                 25  PI-OE-REF-1-PRIME   PIC X(18).
   274                 25  PI-OE-REF-1-SUFF    PIC XX.
   275
   276     12  PI-SESSION-IN-PROGRESS          PIC X.
   277         88  CLAIM-SESSION                   VALUE '1'.
   278         88  CREDIT-SESSION                  VALUE '2'.
   279         88  WARRANTY-SESSION                VALUE '3'.
   280         88  MORTGAGE-SESSION                VALUE '4'.
   281         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   282
   283
   284*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   285
   286     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   287     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   288
   289     12  PI-CREDIT-USER                  PIC X.
   290         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   291         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   292
   293     12  PI-CLAIM-USER                   PIC X.
   294         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   295         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   296
   297     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   298         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   299         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   300         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   301         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   302         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   303
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   7
* EL6503.cbl
   304     12  PI-PROCESSOR-ID                 PIC X(4).
   305
   306     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   307
   308     12  PI-MEMBER-CAPTION               PIC X(10).
   309
   310     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   311         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   312
   313     12  PI-LIFE-OVERRIDE-L1             PIC X.
   314     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   315     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   316     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   317
   318     12  PI-AH-OVERRIDE-L1               PIC X.
   319     12  PI-AH-OVERRIDE-L2               PIC XX.
   320     12  PI-AH-OVERRIDE-L6               PIC X(6).
   321     12  PI-AH-OVERRIDE-L12              PIC X(12).
   322
   323     12  PI-NEW-SYSTEM                   PIC X(2).
   324
   325     12  PI-PRIMARY-CERT-NO              PIC X(11).
   326     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   327         88  PI-USES-PAID-TO                 VALUE '1'.
   328     12  PI-CRDTCRD-SYSTEM.
   329         16  PI-CRDTCRD-USER             PIC X.
   330             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   331             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   332         16  PI-CC-MONTH-END-DT          PIC XX.
   333     12  PI-PROCESSOR-PRINTER            PIC X(4).
   334
   335     12  PI-OE-REFERENCE-2.
   336         16  PI-OE-REF-2-PRIME           PIC X(10).
   337         16  PI-OE-REF-2-SUFF            PIC X.
   338
   339     12  PI-REM-TRM-CALC-OPTION          PIC X.
   340
   341     12  PI-LANGUAGE-TYPE                PIC X.
   342             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   343             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   344             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   345
   346     12  PI-POLICY-LINKAGE-IND           PIC X.
   347         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   348         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   349                                                   LOW-VALUES.
   350
   351     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   352     12  PI-CLAIM-PW-SESSION             PIC X(1).
   353         88  PI-CLAIM-CREDIT                 VALUE '1'.
   354         88  PI-CLAIM-CONVEN                 VALUE '2'.
   355
   356     12  PI-PROCESSOR-CSR-IND            PIC X.
   357         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   358         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   359
   360     12  FILLER                          PIC X(3).
   361
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   8
* EL6503.cbl
   362     12  PI-SYSTEM-LEVEL                 PIC X(145).
   363
   364     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   365         PI-SYSTEM-LEVEL.
   366
   367         16  PI-ENTRY-CODES.
   368             20  PI-ENTRY-CD-1           PIC X.
   369             20  PI-ENTRY-CD-2           PIC X.
   370
   371         16  PI-RETURN-CODES.
   372             20  PI-RETURN-CD-1          PIC X.
   373             20  PI-RETURN-CD-2          PIC X.
   374
   375         16  PI-UPDATE-STATUS-SAVE.
   376             20  PI-UPDATE-BY            PIC X(4).
   377             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   378
   379         16  PI-LOWER-CASE-LETTERS       PIC X.
   380             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   381
   382*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   383*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   384*            88  CARRIER-CLM-CNTL            VALUE '2'.
   385
   386         16  PI-CERT-ACCESS-CONTROL      PIC X.
   387             88  ST-ACCNT-CNTL               VALUE ' '.
   388             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   389             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   390             88  ACCNT-CNTL                  VALUE '3'.
   391             88  CARR-ACCNT-CNTL             VALUE '4'.
   392
   393         16  PI-PROCESSOR-CAP-LIST.
   394             20  PI-SYSTEM-CONTROLS.
   395                24 PI-SYSTEM-DISPLAY     PIC X.
   396                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   397                24 PI-SYSTEM-MODIFY      PIC X.
   398                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   399             20  FILLER                  PIC XX.
   400             20  PI-DISPLAY-CAP          PIC X.
   401                 88  DISPLAY-CAP             VALUE 'Y'.
   402             20  PI-MODIFY-CAP           PIC X.
   403                 88  MODIFY-CAP              VALUE 'Y'.
   404             20  PI-MSG-AT-LOGON-CAP     PIC X.
   405                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   406             20  PI-FORCE-CAP            PIC X.
   407                 88  FORCE-CAP               VALUE 'Y'.
   408
   409         16  PI-PROGRAM-CONTROLS.
   410             20  PI-PGM-PRINT-OPT        PIC X.
   411             20  PI-PGM-FORMAT-OPT       PIC X.
   412             20  PI-PGM-PROCESS-OPT      PIC X.
   413             20  PI-PGM-TOTALS-OPT       PIC X.
   414
   415         16  PI-HELP-INTERFACE.
   416             20  PI-LAST-ERROR-NO        PIC X(4).
   417             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   418
   419         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   9
* EL6503.cbl
   420             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   421
   422         16  PI-CR-CONTROL-IN-PROGRESS.
   423             20  PI-CR-CARRIER           PIC X.
   424             20  PI-CR-GROUPING          PIC X(6).
   425             20  PI-CR-STATE             PIC XX.
   426             20  PI-CR-ACCOUNT           PIC X(10).
   427             20  PI-CR-FIN-RESP          PIC X(10).
   428             20  PI-CR-TYPE              PIC X.
   429
   430         16  PI-CR-BATCH-NUMBER          PIC X(6).
   431
   432         16  PI-CR-MONTH-END-DT          PIC XX.
   433
   434         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   435             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   436             88  PI-ZERO-CARRIER             VALUE '1'.
   437             88  PI-ZERO-GROUPING            VALUE '2'.
   438             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   439
   440         16  PI-CARRIER-SECURITY         PIC X.
   441             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   442
   443         16  PI-ACCOUNT-SECURITY         PIC X(10).
   444             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   445             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   446
   447         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   448             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   449                                         INDEXED BY PI-ACCESS-NDX
   450                                         PIC X.
   451
   452         16  PI-GA-BILLING-CONTROL       PIC X.
   453             88  PI-GA-BILLING               VALUE '1'.
   454
   455         16  PI-MAIL-PROCESSING          PIC X.
   456             88  PI-MAIL-YES                 VALUE 'Y'.
   457
   458         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   459
   460         16  PI-AR-SYSTEM.
   461             20  PI-AR-PROCESSING-CNTL   PIC X.
   462                 88  PI-AR-PROCESSING        VALUE 'Y'.
   463             20  PI-AR-SUMMARY-CODE      PIC X(6).
   464             20  PI-AR-MONTH-END-DT      PIC XX.
   465
   466         16  PI-MP-SYSTEM.
   467             20  PI-MORTGAGE-USER            PIC X.
   468                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   469                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   470             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   471                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   472                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   473                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   474                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   475                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   476             20  PI-MP-MONTH-END-DT          PIC XX.
   477             20  PI-MP-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  10
* EL6503.cbl
   478                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   479                 24  PI-MP-REFERENCE-SFX     PIC XX.
   480
   481         16  PI-LABEL-CONTROL            PIC X(01).
   482             88  PI-CREATE-LABELS                    VALUE 'Y'.
   483             88  PI-BYPASS-LABELS                    VALUE 'N'.
   484
   485         16  PI-BILL-GROUPING-CODE       PIC X(01).
   486             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   487
   488         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   489             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   490             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   491
   492         16  FILLER                      PIC X(14).
   493
   494     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   495******************************************************************
   496*                                COPY ELC650PI.
   497******************************************************************
   498*
   499*                            ELC650PI.
   500*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   501*                            VMOD=2.007
   502*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
   503*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
   504* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
   505*
   506******************************************************************
   507******************************************************************
   508*                   C H A N G E   L O G
   509*
   510* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   511*-----------------------------------------------------------------
   512*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   513* EFFECTIVE    NUMBER
   514*-----------------------------------------------------------------
   515* 101916  IR2016101900001  PEMA  Inc tot line to 3 bytes
   516
   517     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   518         16  PI-MAINT                   PIC X.
   519         16  PI-PREV-ACCOUNT            PIC X(20).
   520         16  PI-PREV-VG-ACCOUNT         PIC X(20).
   521         16  PI-ACCT-KEY.
   522             20  PI-ACCT-CCGSA-KEY.
   523                 24  PI-ACCT-CO             PIC X.
   524                 24  PI-ACCT-CARRIER        PIC X.
   525                 24  PI-ACCT-GROUPING       PIC X(6).
   526                 24  PI-ACCT-STATE          PIC XX.
   527                 24  PI-ACCT-ACCOUNT        PIC X(10).
   528             20  PI-ACCT-EXP-DT           PIC XX.
   529             20  PI-ACCT-REST-OF-EXP      PIC X(4).
   530         16  PI-ACCT-ID                 PIC X(8).
   531         16  PI-PLAN-KEY.
   532             20  PI-PLAN-ACCT-KEY.
   533                 24  PI-PLAN-COMPANY-CD PIC X.
   534                 24  PI-PLAN-CARRIER    PIC X.
   535                 24  PI-PLAN-GROUP      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  11
* EL6503.cbl
   536                 24  PI-PLAN-STATE      PIC X(2).
   537                 24  PI-PLAN-ACCOUNT    PIC X(10).
   538             20  PI-PLAN-BEN-TYPE       PIC X.
   539             20  PI-PLAN-BEN            PIC XX.
   540             20  PI-PLAN-REVISION       PIC X(3).
   541         16  PI-WS-STATE                PIC XX.
   542         16  PI-WS-CLASS                PIC XX.
   543         16  PI-WS-DEV                  PIC X(3).
   544         16  PI-WS-TYPE                 PIC X.
   545         16  PI-WS-PLAN                 PIC XX.
   546
   547         16  PI-ERPNDB-ALT-KEY.
   548             20  PI-PB-COMPANY-CD-A1    PIC X.
   549             20  PI-PB-CARRIER          PIC X.
   550             20  PI-PB-GROUPING         PIC X(6).
   551             20  PI-PB-STATE            PIC XX.
   552             20  PI-PB-ACCOUNT          PIC X(10).
   553             20  PI-PB-CERT-EFF-DT      PIC XX.
   554             20  PI-PB-CERT-NO          PIC X(10).
   555             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
   556             20  PI-PB-RECORD-TYPE      PIC X.
   557
   558         16  PI-DATE-RANGE-TABLE.
   559             20  PI-TABLE-ENT OCCURS 32 TIMES
   560                            INDEXED BY T-INDEX.
   561                 24  PI-BIN-EFF-DT          PIC XX.
   562                 24  PI-BIN-EXP-DT          PIC XX.
   563                 24  PI-BIN-MAINT-DT        PIC XX.
   564                 24  PI-BIN-LO-CERT         PIC XX.
   565                 24  PI-BIN-AR-HI-CERT      PIC XX.
   566                 24  PI-BIN-HI-CERT         PIC XX.
   567         16  PI-PAGE-NUMBER             PIC S9.
   568             88  PI-FST-PAGE               VALUE +1.
   569             88  PI-2ND-PAGE               VALUE +2.
   570             88  PI-3RD-PAGE               VALUE +3.
   571             88  PI-LST-PAGE               VALUE +4.
   572         16  PI-TOTAL-LINES             PIC S999.
   573         16  PI-LINE-SELECTED    PIC S9.
   574***  Y2K PROJ 7744
   575         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
   576         16  BIN-EFFCHG-SAVE     PIC XX.
   577         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
   578***  Y2K PROJ 7744
   579         16  BIN-EXPCHG-SAVE     PIC XX.
   580         16  PI-RECORD-ADDED-SW  PIC X.
   581             88  PI-RECORD-ADDED            VALUE '1'.
   582             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
   583         16  PI-ACCNAME          PIC X(30).
   584         16  PI-COMM-POINTER     PIC S9(8)   COMP.
   585         16  PI-SV-MAINT         PIC X.
   586         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
   587         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
   588         16  PI-UPDATE-SW        PIC X.
   589             88  PI-CHANGES-MADE             VALUE '1'.
   590         16  PI-NOTE-TYPE        PIC X.
   591             88  PI-ACCT-NOTE                VALUE '1'.
   592         16  PI-DMD-FILE-SW      PIC X.
   593             88  END-OF-FILE                 VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  12
* EL6503.cbl
   594             88  INTO-NEXT-BENEFITS          VALUE 'I'.
   595             88  FIRST-OCCURS                VALUE 'F'.
   596         16  PI-DMD-OCCURS       PIC S999.
   597         16  PI-DMD-SCREEN       PIC X.
   598             88  SCREEN-1-DISPLAYED  VALUE '1'.
   599             88  SCREEN-2-DISPLAYED  VALUE '2'.
   600             88  SCREEN-3-DISPLAYED  VALUE '3'.
   601         16  PI-NAMEFLG          PIC X.
   602         16  PI-EL650-DEL-SW     PIC X.
   603         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
   604         16  PI-DCC-PROD-CODE    PIC XXX.
   605         16  FILLER              PIC X(34).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  13
* EL6503.cbl
   607*                                COPY EL6503S.
   608 01  EL6503AI.
   609     05  FILLER            PIC  X(0012).
   610*    -------------------------------
   611     05  RUNDATEL PIC S9(0004) COMP.
   612     05  RUNDATEF PIC  X(0001).
   613     05  FILLER REDEFINES RUNDATEF.
   614         10  RUNDATEA PIC  X(0001).
   615     05  RUNDATEI PIC  X(0008).
   616*    -------------------------------
   617     05  RUNTIMEL PIC S9(0004) COMP.
   618     05  RUNTIMEF PIC  X(0001).
   619     05  FILLER REDEFINES RUNTIMEF.
   620         10  RUNTIMEA PIC  X(0001).
   621     05  RUNTIMEI PIC  X(0005).
   622*    -------------------------------
   623     05  CMPNYIDL PIC S9(0004) COMP.
   624     05  CMPNYIDF PIC  X(0001).
   625     05  FILLER REDEFINES CMPNYIDF.
   626         10  CMPNYIDA PIC  X(0001).
   627     05  CMPNYIDI PIC  X(0003).
   628*    -------------------------------
   629     05  USERIDL PIC S9(0004) COMP.
   630     05  USERIDF PIC  X(0001).
   631     05  FILLER REDEFINES USERIDF.
   632         10  USERIDA PIC  X(0001).
   633     05  USERIDI PIC  X(0004).
   634*    -------------------------------
   635     05  MAINTYPL PIC S9(0004) COMP.
   636     05  MAINTYPF PIC  X(0001).
   637     05  FILLER REDEFINES MAINTYPF.
   638         10  MAINTYPA PIC  X(0001).
   639     05  MAINTYPI PIC  X(0001).
   640*    -------------------------------
   641     05  LSTDTEL PIC S9(0004) COMP.
   642     05  LSTDTEF PIC  X(0001).
   643     05  FILLER REDEFINES LSTDTEF.
   644         10  LSTDTEA PIC  X(0001).
   645     05  LSTDTEI PIC  X(0008).
   646*    -------------------------------
   647     05  LSTTIMEL PIC S9(0004) COMP.
   648     05  LSTTIMEF PIC  X(0001).
   649     05  FILLER REDEFINES LSTTIMEF.
   650         10  LSTTIMEA PIC  X(0001).
   651     05  LSTTIMEI PIC  X(0005).
   652*    -------------------------------
   653     05  LSTUSRL PIC S9(0004) COMP.
   654     05  LSTUSRF PIC  X(0001).
   655     05  FILLER REDEFINES LSTUSRF.
   656         10  LSTUSRA PIC  X(0001).
   657     05  LSTUSRI PIC  X(0004).
   658*    -------------------------------
   659     05  CARRIERL PIC S9(0004) COMP.
   660     05  CARRIERF PIC  X(0001).
   661     05  FILLER REDEFINES CARRIERF.
   662         10  CARRIERA PIC  X(0001).
   663     05  CARRIERI PIC  X(0001).
   664*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  14
* EL6503.cbl
   665     05  GROUPL PIC S9(0004) COMP.
   666     05  GROUPF PIC  X(0001).
   667     05  FILLER REDEFINES GROUPF.
   668         10  GROUPA PIC  X(0001).
   669     05  GROUPI PIC  X(0006).
   670*    -------------------------------
   671     05  STATEL PIC S9(0004) COMP.
   672     05  STATEF PIC  X(0001).
   673     05  FILLER REDEFINES STATEF.
   674         10  STATEA PIC  X(0001).
   675     05  STATEI PIC  X(0002).
   676*    -------------------------------
   677     05  ACCTNOL PIC S9(0004) COMP.
   678     05  ACCTNOF PIC  X(0001).
   679     05  FILLER REDEFINES ACCTNOF.
   680         10  ACCTNOA PIC  X(0001).
   681     05  ACCTNOI PIC  X(0010).
   682*    -------------------------------
   683     05  BLINE1L PIC S9(0004) COMP.
   684     05  BLINE1F PIC  X(0001).
   685     05  FILLER REDEFINES BLINE1F.
   686         10  BLINE1A PIC  X(0001).
   687     05  BLINE1I PIC  X(0060).
   688*    -------------------------------
   689     05  BLINE2L PIC S9(0004) COMP.
   690     05  BLINE2F PIC  X(0001).
   691     05  FILLER REDEFINES BLINE2F.
   692         10  BLINE2A PIC  X(0001).
   693     05  BLINE2I PIC  X(0060).
   694*    -------------------------------
   695     05  SNAME1L PIC S9(0004) COMP.
   696     05  SNAME1F PIC  X(0001).
   697     05  FILLER REDEFINES SNAME1F.
   698         10  SNAME1A PIC  X(0001).
   699     05  SNAME1I PIC  X(0060).
   700*    -------------------------------
   701     05  SNAME2L PIC S9(0004) COMP.
   702     05  SNAME2F PIC  X(0001).
   703     05  FILLER REDEFINES SNAME2F.
   704         10  SNAME2A PIC  X(0001).
   705     05  SNAME2I PIC  X(0060).
   706*    -------------------------------
   707     05  SADDR1L PIC S9(0004) COMP.
   708     05  SADDR1F PIC  X(0001).
   709     05  FILLER REDEFINES SADDR1F.
   710         10  SADDR1A PIC  X(0001).
   711     05  SADDR1I PIC  X(0060).
   712*    -------------------------------
   713     05  SADDR2L PIC S9(0004) COMP.
   714     05  SADDR2F PIC  X(0001).
   715     05  FILLER REDEFINES SADDR2F.
   716         10  SADDR2A PIC  X(0001).
   717     05  SADDR2I PIC  X(0060).
   718*    -------------------------------
   719     05  SADDR3L PIC S9(0004) COMP.
   720     05  SADDR3F PIC  X(0001).
   721     05  FILLER REDEFINES SADDR3F.
   722         10  SADDR3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  15
* EL6503.cbl
   723     05  SADDR3I PIC  X(0060).
   724*    -------------------------------
   725     05  SCITYL PIC S9(0004) COMP.
   726     05  SCITYF PIC  X(0001).
   727     05  FILLER REDEFINES SCITYF.
   728         10  SCITYA PIC  X(0001).
   729     05  SCITYI PIC  X(0060).
   730*    -------------------------------
   731     05  SSTATEL PIC S9(0004) COMP.
   732     05  SSTATEF PIC  X(0001).
   733     05  FILLER REDEFINES SSTATEF.
   734         10  SSTATEA PIC  X(0001).
   735     05  SSTATEI PIC  X(0002).
   736*    -------------------------------
   737     05  SZIPL PIC S9(0004) COMP.
   738     05  SZIPF PIC  X(0001).
   739     05  FILLER REDEFINES SZIPF.
   740         10  SZIPA PIC  X(0001).
   741     05  SZIPI PIC  X(0010).
   742*    -------------------------------
   743     05  ERRMSG1L PIC S9(0004) COMP.
   744     05  ERRMSG1F PIC  X(0001).
   745     05  FILLER REDEFINES ERRMSG1F.
   746         10  ERRMSG1A PIC  X(0001).
   747     05  ERRMSG1I PIC  X(0072).
   748*    -------------------------------
   749     05  PFKEYL PIC S9(0004) COMP.
   750     05  PFKEYF PIC  X(0001).
   751     05  FILLER REDEFINES PFKEYF.
   752         10  PFKEYA PIC  X(0001).
   753     05  PFKEYI PIC  99.
   754 01  EL6503AO REDEFINES EL6503AI.
   755     05  FILLER            PIC  X(0012).
   756*    -------------------------------
   757     05  FILLER            PIC  X(0003).
   758     05  RUNDATEO PIC  X(0008).
   759*    -------------------------------
   760     05  FILLER            PIC  X(0003).
   761     05  RUNTIMEO PIC  99.99.
   762*    -------------------------------
   763     05  FILLER            PIC  X(0003).
   764     05  CMPNYIDO PIC  X(0003).
   765*    -------------------------------
   766     05  FILLER            PIC  X(0003).
   767     05  USERIDO PIC  X(0004).
   768*    -------------------------------
   769     05  FILLER            PIC  X(0003).
   770     05  MAINTYPO PIC  X(0001).
   771*    -------------------------------
   772     05  FILLER            PIC  X(0003).
   773     05  LSTDTEO PIC  X(0008).
   774*    -------------------------------
   775     05  FILLER            PIC  X(0003).
   776     05  LSTTIMEO PIC  99.99.
   777*    -------------------------------
   778     05  FILLER            PIC  X(0003).
   779     05  LSTUSRO PIC  X(0004).
   780*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  16
* EL6503.cbl
   781     05  FILLER            PIC  X(0003).
   782     05  CARRIERO PIC  X(0001).
   783*    -------------------------------
   784     05  FILLER            PIC  X(0003).
   785     05  GROUPO PIC  X(0006).
   786*    -------------------------------
   787     05  FILLER            PIC  X(0003).
   788     05  STATEO PIC  X(0002).
   789*    -------------------------------
   790     05  FILLER            PIC  X(0003).
   791     05  ACCTNOO PIC  X(0010).
   792*    -------------------------------
   793     05  FILLER            PIC  X(0003).
   794     05  BLINE1O PIC  X(0060).
   795*    -------------------------------
   796     05  FILLER            PIC  X(0003).
   797     05  BLINE2O PIC  X(0060).
   798*    -------------------------------
   799     05  FILLER            PIC  X(0003).
   800     05  SNAME1O PIC  X(0060).
   801*    -------------------------------
   802     05  FILLER            PIC  X(0003).
   803     05  SNAME2O PIC  X(0060).
   804*    -------------------------------
   805     05  FILLER            PIC  X(0003).
   806     05  SADDR1O PIC  X(0060).
   807*    -------------------------------
   808     05  FILLER            PIC  X(0003).
   809     05  SADDR2O PIC  X(0060).
   810*    -------------------------------
   811     05  FILLER            PIC  X(0003).
   812     05  SADDR3O PIC  X(0060).
   813*    -------------------------------
   814     05  FILLER            PIC  X(0003).
   815     05  SCITYO PIC  X(0060).
   816*    -------------------------------
   817     05  FILLER            PIC  X(0003).
   818     05  SSTATEO PIC  X(0002).
   819*    -------------------------------
   820     05  FILLER            PIC  X(0003).
   821     05  SZIPO PIC  X(0010).
   822*    -------------------------------
   823     05  FILLER            PIC  X(0003).
   824     05  ERRMSG1O PIC  X(0072).
   825*    -------------------------------
   826     05  FILLER            PIC  X(0003).
   827     05  PFKEYO PIC  X(0002).
   828*    -------------------------------
   829*                                COPY ELCJPFX.
   830******************************************************************
   831*                                                                *
   832*                                                                *
   833*                            ELCJPFX.                            *
   834*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   835*                            VMOD=2.002                          *
   836*                                                                *
   837*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   838*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  17
* EL6503.cbl
   839*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   840*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   841*        ELCNTL - CONTROL FILE                                   *
   842*        ELMSTR - CLAIM MASTERS                                  *
   843*        ELTRLR - ACTIVITY TRAILERS                              *
   844*        ELCHKQ - CHECK QUE                                      *
   845******************************************************************
   846 01  JOURNAL-RECORD.
   847     12  jp-date                     pic s9(5) comp-3.
   848     12  jp-time                     pic s9(7) comp-3.
   849     12  JP-USER-ID                  PIC X(4).
   850     12  JP-FILE-ID                  PIC X(8).
   851     12  JP-PROGRAM-ID               PIC X(8).
   852     12  JP-RECORD-TYPE              PIC X.
   853         88 JP-ADD              VALUE 'A'.
   854         88 JP-BEFORE-CHANGE    VALUE 'B'.
   855         88 JP-AFTER-CHANGE     VALUE 'C'.
   856         88 JP-DELETE           VALUE 'D'.
   857         88 JP-GENERIC-DELETE   VALUE 'G'.
   858         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   859         88 JP-KEY-CHG-ADD      VALUE 'N'.
   860     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   861     12  JP-RECORD-AREA
   862
   863
   864                                 PIC X(750).
   865*                                COPY ELCEMIB.
   866******************************************************************
   867*                                                                *
   868*                                                                *
   869*                            ELCEMIB.                            *
   870*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   871*                            VMOD=2.005                          *
   872*                                                                *
   873*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   874*                                                                *
   875******************************************************************
   876 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   877     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   878     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   879     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   880     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   881     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   882     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   883     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   884     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   885     12  EMI-SWITCH1             PIC X        VALUE '1'.
   886         88  EMI-NO-ERRORS                    VALUE '1'.
   887         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   888         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   889     12  EMI-SWITCH2             PIC X        VALUE '1'.
   890         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   891     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   892         88  EMI-AREA1-EMPTY                  VALUE '1'.
   893         88  EMI-AREA1-FULL                   VALUE '2'.
   894     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   895         88  EMI-AREA2-EMPTY                  VALUE '1'.
   896         88  EMI-AREA2-FULL                   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  18
* EL6503.cbl
   897     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   898         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   899         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   900         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   901         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   902         88  EMI-BYPASS-FATALS                VALUE 'X'.
   903     12  EMI-ERROR-LINES.
   904         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   905         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   906         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   907         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   908             20  EMI-ERR-CODES OCCURS 10 TIMES.
   909                 24  EMI-ERR-NUM         PIC X(4).
   910                 24  EMI-FILLER          PIC X.
   911                 24  EMI-SEV             PIC X.
   912                 24  FILLER              PIC X.
   913             20  FILLER                  PIC X(02).
   914     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   915         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   916             20  EMI-ERROR-NUMBER    PIC X(4).
   917             20  EMI-FILL            PIC X.
   918             20  EMI-SEVERITY        PIC X.
   919             20  FILLER              PIC X.
   920             20  EMI-ERROR-TEXT.
   921                 24  EMI-TEXT-VARIABLE   PIC X(10).
   922                 24  FILLER          PIC X(55).
   923     12  EMI-SEVERITY-SAVE           PIC X.
   924         88  EMI-NOTE                    VALUE 'N'.
   925         88  EMI-WARNING                 VALUE 'W'.
   926         88  EMI-FORCABLE                VALUE 'F'.
   927         88  EMI-FATAL                   VALUE 'X'.
   928     12  EMI-MESSAGE-FLAG            PIC X.
   929         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   930         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   931     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   932     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   933         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   934         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   935         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   936     12  emi-claim-no                pic x(7).
   937     12  emi-claim-type              pic x(6).
   938     12  FILLER                      PIC X(124)  VALUE SPACES.
   939     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   940     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   941     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   942     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   943*                                COPY ELCDATE.
   944******************************************************************
   945*                                                                *
   946*                                                                *
   947*                            ELCDATE.                            *
   948*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   949*                            VMOD=2.003
   950*                                                                *
   951*                                                                *
   952*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   953*                 LENGTH = 200                                   *
   954******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  19
* EL6503.cbl
   955
   956 01  DATE-CONVERSION-DATA.
   957     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   958     12  DC-OPTION-CODE                PIC X.
   959         88  BIN-TO-GREG                VALUE ' '.
   960         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   961         88  EDIT-GREG-TO-BIN           VALUE '2'.
   962         88  YMD-GREG-TO-BIN            VALUE '3'.
   963         88  MDY-GREG-TO-BIN            VALUE '4'.
   964         88  JULIAN-TO-BIN              VALUE '5'.
   965         88  BIN-PLUS-ELAPSED           VALUE '6'.
   966         88  FIND-CENTURY               VALUE '7'.
   967         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   968         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   969         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   970         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   971         88  JULIAN-TO-BIN-3            VALUE 'C'.
   972         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   973         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   974         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   975         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   976         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   977         88  CHECK-LEAP-YEAR            VALUE 'H'.
   978         88  BIN-3-TO-GREG              VALUE 'I'.
   979         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   980         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   981         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   982         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   983         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   984         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   985         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   986         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   987         88  THREE-CHARACTER-BIN
   988                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   989         88  GREGORIAN-TO-BIN
   990                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   991         88  BIN-TO-GREGORIAN
   992                  VALUES ' ' '1' 'I' '8' 'G'.
   993         88  JULIAN-TO-BINARY
   994                  VALUES '5' 'C' 'E' 'F'.
   995     12  DC-ERROR-CODE                 PIC X.
   996         88  NO-CONVERSION-ERROR        VALUE ' '.
   997         88  DATE-CONVERSION-ERROR
   998                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   999         88  DATE-IS-ZERO               VALUE '1'.
  1000         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1001         88  DATE-IS-INVALID            VALUE '3'.
  1002         88  DATE1-GREATER-DATE2        VALUE '4'.
  1003         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1004         88  DATE-INVALID-OPTION        VALUE '9'.
  1005         88  INVALID-CENTURY            VALUE 'A'.
  1006         88  ONLY-CENTURY               VALUE 'B'.
  1007         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1008         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1009     12  DC-END-OF-MONTH               PIC X.
  1010         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1011     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1012         88  USE-NORMAL-PROCESS         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  20
* EL6503.cbl
  1013         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1014         88  ADJUST-UP-100-YRS          VALUE '2'.
  1015     12  FILLER                        PIC X.
  1016     12  DC-CONVERSION-DATES.
  1017         16  DC-BIN-DATE-1             PIC XX.
  1018         16  DC-BIN-DATE-2             PIC XX.
  1019         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1020         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1021                       DC-GREG-DATE-1-EDIT.
  1022             20  DC-EDIT1-MONTH        PIC 99.
  1023             20  SLASH1-1              PIC X.
  1024             20  DC-EDIT1-DAY          PIC 99.
  1025             20  SLASH1-2              PIC X.
  1026             20  DC-EDIT1-YEAR         PIC 99.
  1027         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1028         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1029                     DC-GREG-DATE-2-EDIT.
  1030             20  DC-EDIT2-MONTH        PIC 99.
  1031             20  SLASH2-1              PIC X.
  1032             20  DC-EDIT2-DAY          PIC 99.
  1033             20  SLASH2-2              PIC X.
  1034             20  DC-EDIT2-YEAR         PIC 99.
  1035         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1036         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1037                     DC-GREG-DATE-1-YMD.
  1038             20  DC-YMD-YEAR           PIC 99.
  1039             20  DC-YMD-MONTH          PIC 99.
  1040             20  DC-YMD-DAY            PIC 99.
  1041         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1042         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1043                      DC-GREG-DATE-1-MDY.
  1044             20  DC-MDY-MONTH          PIC 99.
  1045             20  DC-MDY-DAY            PIC 99.
  1046             20  DC-MDY-YEAR           PIC 99.
  1047         16  DC-GREG-DATE-1-ALPHA.
  1048             20  DC-ALPHA-MONTH        PIC X(10).
  1049             20  DC-ALPHA-DAY          PIC 99.
  1050             20  FILLER                PIC XX.
  1051             20  DC-ALPHA-CENTURY.
  1052                 24 DC-ALPHA-CEN-N     PIC 99.
  1053             20  DC-ALPHA-YEAR         PIC 99.
  1054         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1055         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1056         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1057         16  DC-JULIAN-DATE            PIC 9(05).
  1058         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1059                                       PIC 9(05).
  1060         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1061             20  DC-JULIAN-YEAR        PIC 99.
  1062             20  DC-JULIAN-DAYS        PIC 999.
  1063         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1064         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1065         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1066     12  DATE-CONVERSION-VARIBLES.
  1067         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1068         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1069             20  FILLER                PIC 9(3).
  1070             20  HOLD-CEN-1-CCYY.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  21
* EL6503.cbl
  1071                 24  HOLD-CEN-1-CC     PIC 99.
  1072                 24  HOLD-CEN-1-YY     PIC 99.
  1073             20  HOLD-CEN-1-MO         PIC 99.
  1074             20  HOLD-CEN-1-DA         PIC 99.
  1075         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1076             20  HOLD-CEN-1-R-MO       PIC 99.
  1077             20  HOLD-CEN-1-R-DA       PIC 99.
  1078             20  HOLD-CEN-1-R-CCYY.
  1079                 24  HOLD-CEN-1-R-CC   PIC 99.
  1080                 24  HOLD-CEN-1-R-YY   PIC 99.
  1081             20  FILLER                PIC 9(3).
  1082         16  HOLD-CENTURY-1-X.
  1083             20  FILLER                PIC X(3)  VALUE SPACES.
  1084             20  HOLD-CEN-1-X-CCYY.
  1085                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1086                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1087             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1088             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1089         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1090             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1091             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1092             20  HOLD-CEN-1-R-X-CCYY.
  1093                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1094                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1095             20  FILLER                PIC XXX.
  1096         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1097         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1098         16  DC-JULIAN-DATE-1          PIC 9(07).
  1099         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1100             20  DC-JULIAN-1-CCYY.
  1101                 24  DC-JULIAN-1-CC    PIC 99.
  1102                 24  DC-JULIAN-1-YR    PIC 99.
  1103             20  DC-JULIAN-DA-1        PIC 999.
  1104         16  DC-JULIAN-DATE-2          PIC 9(07).
  1105         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1106             20  DC-JULIAN-2-CCYY.
  1107                 24  DC-JULIAN-2-CC    PIC 99.
  1108                 24  DC-JULIAN-2-YR    PIC 99.
  1109             20  DC-JULIAN-DA-2        PIC 999.
  1110         16  DC-GREG-DATE-A-EDIT.
  1111             20  DC-EDITA-MONTH        PIC 99.
  1112             20  SLASHA-1              PIC X VALUE '/'.
  1113             20  DC-EDITA-DAY          PIC 99.
  1114             20  SLASHA-2              PIC X VALUE '/'.
  1115             20  DC-EDITA-CCYY.
  1116                 24  DC-EDITA-CENT     PIC 99.
  1117                 24  DC-EDITA-YEAR     PIC 99.
  1118         16  DC-GREG-DATE-B-EDIT.
  1119             20  DC-EDITB-MONTH        PIC 99.
  1120             20  SLASHB-1              PIC X VALUE '/'.
  1121             20  DC-EDITB-DAY          PIC 99.
  1122             20  SLASHB-2              PIC X VALUE '/'.
  1123             20  DC-EDITB-CCYY.
  1124                 24  DC-EDITB-CENT     PIC 99.
  1125                 24  DC-EDITB-YEAR     PIC 99.
  1126         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1127         16  DC-GREG-DATE-CYMD-R REDEFINES
  1128                              DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  22
* EL6503.cbl
  1129             20  DC-CYMD-CEN           PIC 99.
  1130             20  DC-CYMD-YEAR          PIC 99.
  1131             20  DC-CYMD-MONTH         PIC 99.
  1132             20  DC-CYMD-DAY           PIC 99.
  1133         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1134         16  DC-GREG-DATE-MDCY-R REDEFINES
  1135                              DC-GREG-DATE-MDCY.
  1136             20  DC-MDCY-MONTH         PIC 99.
  1137             20  DC-MDCY-DAY           PIC 99.
  1138             20  DC-MDCY-CEN           PIC 99.
  1139             20  DC-MDCY-YEAR          PIC 99.
  1140    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1141        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1142    12  DC-EL310-DATE                  PIC X(21).
  1143    12  FILLER                         PIC X(28).
  1144*                                COPY ELCLOGOF.
  1145******************************************************************
  1146*                                                                *
  1147*                                                                *
  1148*                            ELCLOGOF.                           *
  1149*                            VMOD=2.001                          *
  1150*                                                                *
  1151*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1152*                                                                *
  1153******************************************************************
  1154 01  CLASIC-LOGOFF.
  1155     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1156     12  LOGOFF-TEXT.
  1157         16  FILLER          PIC X(5)    VALUE SPACES.
  1158         16  LOGOFF-MSG.
  1159             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1160             20  FILLER      PIC X       VALUE SPACES.
  1161             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1162         16  FILLER          PIC X(80)
  1163           VALUE '* YOU ARE NOW LOGGED OFF'.
  1164         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1165         16  FILLER          PIC X       VALUE QUOTE.
  1166         16  LOGOFF-SYS-MSG  PIC X(17)
  1167           VALUE 'S CLAS-IC SYSTEM '.
  1168     12  TEXT-MESSAGES.
  1169         16  UNACCESS-MSG    PIC X(29)
  1170             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1171         16  PGMIDERR-MSG    PIC X(17)
  1172             VALUE 'PROGRAM NOT FOUND'.
  1173*                                COPY ELCATTR.
  1174******************************************************************
  1175*                                                                *
  1176*                            ELCATTR.                            *
  1177*                            VMOD=2.001                          *
  1178*                                                                *
  1179*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1180*                                                                *
  1181*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1182*                                                                *
  1183*                   POS 1   P=PROTECTED                          *
  1184*                           U=UNPROTECTED                        *
  1185*                           S=ASKIP                              *
  1186*                   POS 2   A=ALPHA/NUMERIC                      *
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  23
* EL6503.cbl
  1187*                           N=NUMERIC                            *
  1188*                   POS 3   N=NORMAL                             *
  1189*                           B=BRIGHT                             *
  1190*                           D=DARK                               *
  1191*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1192*                           OF=MODIFIED DATA TAG OFF             *
  1193*                                                                *
  1194*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1195******************************************************************
  1196 01  ATTRIBUTE-LIST.
  1197     12  AL-PABOF            PIC X       VALUE 'Y'.
  1198     12  AL-PABON            PIC X       VALUE 'Z'.
  1199     12  AL-PADOF            PIC X       VALUE '%'.
  1200     12  AL-PADON            PIC X       VALUE '_'.
  1201     12  AL-PANOF            PIC X       VALUE '-'.
  1202     12  AL-PANON            PIC X       VALUE '/'.
  1203     12  AL-SABOF            PIC X       VALUE '8'.
  1204     12  AL-SABON            PIC X       VALUE '9'.
  1205     12  AL-SADOF            PIC X       VALUE '@'.
  1206     12  AL-SADON            PIC X       VALUE QUOTE.
  1207     12  AL-SANOF            PIC X       VALUE '0'.
  1208     12  AL-SANON            PIC X       VALUE '1'.
  1209     12  AL-UABOF            PIC X       VALUE 'H'.
  1210     12  AL-UABON            PIC X       VALUE 'I'.
  1211     12  AL-UADOF            PIC X       VALUE '<'.
  1212     12  AL-UADON            PIC X       VALUE '('.
  1213     12  AL-UANOF            PIC X       VALUE ' '.
  1214     12  AL-UANON            PIC X       VALUE 'A'.
  1215     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1216     12  AL-UNBON            PIC X       VALUE 'R'.
  1217     12  AL-UNDOF            PIC X       VALUE '*'.
  1218     12  AL-UNDON            PIC X       VALUE ')'.
  1219     12  AL-UNNOF            PIC X       VALUE '&'.
  1220     12  AL-UNNON            PIC X       VALUE 'J'.
  1221*                                COPY ELCAID.
  1222******************************************************************
  1223*                                                                *
  1224*                            ELCAID.                             *
  1225*                            VMOD=2.001                          *
  1226*                                                                *
  1227*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1228*                                                                *
  1229*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1230*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1231******************************************************************
  1232
  1233 01  DFHAID.
  1234   02  DFHNULL   PIC  X  VALUE  ' '.
  1235   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1236   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1237   02  DFHPEN    PIC  X  VALUE  '='.
  1238   02  DFHOPID   PIC  X  VALUE  'W'.
  1239   02  DFHPA1    PIC  X  VALUE  '%'.
  1240   02  DFHPA2    PIC  X  VALUE  '>'.
  1241   02  DFHPA3    PIC  X  VALUE  ','.
  1242   02  DFHPF1    PIC  X  VALUE  '1'.
  1243   02  DFHPF2    PIC  X  VALUE  '2'.
  1244   02  DFHPF3    PIC  X  VALUE  '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  24
* EL6503.cbl
  1245   02  DFHPF4    PIC  X  VALUE  '4'.
  1246   02  DFHPF5    PIC  X  VALUE  '5'.
  1247   02  DFHPF6    PIC  X  VALUE  '6'.
  1248   02  DFHPF7    PIC  X  VALUE  '7'.
  1249   02  DFHPF8    PIC  X  VALUE  '8'.
  1250   02  DFHPF9    PIC  X  VALUE  '9'.
  1251   02  DFHPF10   PIC  X  VALUE  ':'.
  1252   02  DFHPF11   PIC  X  VALUE  '#'.
  1253   02  DFHPF12   PIC  X  VALUE  '@'.
  1254   02  DFHPF13   PIC  X  VALUE  'A'.
  1255   02  DFHPF14   PIC  X  VALUE  'B'.
  1256   02  DFHPF15   PIC  X  VALUE  'C'.
  1257   02  DFHPF16   PIC  X  VALUE  'D'.
  1258   02  DFHPF17   PIC  X  VALUE  'E'.
  1259   02  DFHPF18   PIC  X  VALUE  'F'.
  1260   02  DFHPF19   PIC  X  VALUE  'G'.
  1261   02  DFHPF20   PIC  X  VALUE  'H'.
  1262   02  DFHPF21   PIC  X  VALUE  'I'.
  1263*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1264   02  DFHPF22   PIC  X  VALUE  '['.
  1265   02  DFHPF23   PIC  X  VALUE  '.'.
  1266   02  DFHPF24   PIC  X  VALUE  '<'.
  1267   02  DFHMSRE   PIC  X  VALUE  'X'.
  1268   02  DFHSTRF   PIC  X  VALUE  'h'.
  1269   02  DFHTRIG   PIC  X  VALUE  '"'.
  1270 01  FILLER    REDEFINES DFHAID.
  1271     05  FILLER                      PIC X(8).
  1272     05  PF-VALUES                   PIC X
  1273         OCCURS 24 TIMES.
  1274*                                COPY ERCACNT.
  1275******************************************************************
  1276*                                                                *
  1277*                                                                *
  1278*                            ERCACNT.                            *
  1279*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1280*                            VMOD=2.002                          *
  1281*                                                                *
  1282*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  1283*                                                                *
  1284*   FILE TYPE = VSAM,KSDS                                        *
  1285*   RECORD SIZE = 120   RECFORM = FIXED                          *
  1286*                                                                *
  1287*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  1288*       ALTERNATE INDEX = NONE                                   *
  1289*                                                                *
  1290*                                                                *
  1291*   LOG = YES                                                    *
  1292*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1293******************************************************************
  1294*                   C H A N G E   L O G
  1295*
  1296* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1297*-----------------------------------------------------------------
  1298*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1299* EFFECTIVE    NUMBER
  1300*-----------------------------------------------------------------
  1301* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  1302*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  25
* EL6503.cbl
  1303******************************************************************
  1304 01  NOTE-FILE.
  1305     12  NT-FILE-ID                  PIC XX.
  1306         88  VALID-NOTE-ID              VALUE 'NT'.
  1307
  1308     12  NT-CONTROL-PRIMARY.
  1309         16  NT-COMPANY-CD           PIC X.
  1310         16  NT-ACCT-NOTE-KEY.
  1311             18  NT-CARRIER              PIC X.
  1312             18  NT-GROUPING             PIC X(06).
  1313             18  NT-STATE                PIC XX.
  1314             18  NT-ACCOUNT              PIC X(10).
  1315         16  NT-RECORD-TYPE          PIC X.
  1316              88  ACCT-NOTE          VALUE '1'.
  1317              88  ACCT-BRANCH-LOC    VALUE '2'.
  1318              88  ACCT-SHIPPING-ADDR VALUE '3'.
  1319         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  1320
  1321     12  NT-LAST-MAINT-DT            PIC XX.
  1322     12  NT-LAST-MAINT-BY            PIC X(4).
  1323     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  1324
  1325*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  1326*     SEQUENCE NUMBERS
  1327     12  NT-NOTE-INFORMATION.
  1328         16  NT-NOTE-LINE            PIC X(60).
  1329         16  FILLER                  PIC X(25).
  1330*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  1331     12  NT-LOCATION-INFORMATION REDEFINES
  1332                         NT-NOTE-INFORMATION.
  1333         16  NT-BRANCH-LOC-LINE      PIC X(60).
  1334         16  FILLER                  PIC X(25).
  1335*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  1336*     SEQUENCE NUMBER 1 IS NAME LINE 1
  1337*     SEQUENCE NUMBER 2 IS NAME LINE 2
  1338*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  1339*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  1340*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  1341*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  1342     12  NT-SHIPPING-INFORMATION REDEFINES
  1343                         NT-NOTE-INFORMATION.
  1344         16  NT-SHIPPING-LINE        PIC X(60).
  1345         16  NT-SHIP-STATE           PIC XX.
  1346         16  NT-SHIP-ZIP             PIC X(10).
  1347         16  FILLER                  PIC X(13).
  1348*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  26
* EL6503.cbl
  1350****************************************************************
  1351*
  1352* Copyright (c) 2007 by Clerity Solutions, Inc.
  1353* All rights reserved.
  1354*
  1355****************************************************************
  1356 01  DFHEIV.
  1357   02  DFHEIV0               PIC X(35).
  1358   02  DFHEIV1               PIC X(08).
  1359   02  DFHEIV2               PIC X(08).
  1360   02  DFHEIV3               PIC X(08).
  1361   02  DFHEIV4               PIC X(06).
  1362   02  DFHEIV5               PIC X(04).
  1363   02  DFHEIV6               PIC X(04).
  1364   02  DFHEIV7               PIC X(02).
  1365   02  DFHEIV8               PIC X(02).
  1366   02  DFHEIV9               PIC X(01).
  1367   02  DFHEIV10              PIC S9(7) COMP-3.
  1368   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1369   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1370   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1371   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1372   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1373   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1374   02  DFHEIV17              PIC X(04).
  1375   02  DFHEIV18              PIC X(04).
  1376   02  DFHEIV19              PIC X(04).
  1377   02  DFHEIV20              USAGE IS POINTER.
  1378   02  DFHEIV21              USAGE IS POINTER.
  1379   02  DFHEIV22              USAGE IS POINTER.
  1380   02  DFHEIV23              USAGE IS POINTER.
  1381   02  DFHEIV24              USAGE IS POINTER.
  1382   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1383   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1384   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1385   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1386   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1387   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1388   02  FILLER                PIC X(02).
  1389   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1390   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1391   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1392   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1393   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1394 LINKAGE  SECTION.
  1395*****************************************************************
  1396*                                                               *
  1397* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1398* All rights reserved.                                          *
  1399*                                                               *
  1400*****************************************************************
  1401 01  dfheiblk.
  1402     02  eibtime          pic s9(7) comp-3.
  1403     02  eibdate          pic s9(7) comp-3.
  1404     02  eibtrnid         pic x(4).
  1405     02  eibtaskn         pic s9(7) comp-3.
  1406     02  eibtrmid         pic x(4).
  1407     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  27
* EL6503.cbl
  1408     02  eibcposn         pic s9(4) comp.
  1409     02  eibcalen         pic s9(4) comp.
  1410     02  eibaid           pic x(1).
  1411     02  eibfiller1       pic x(1).
  1412     02  eibfn            pic x(2).
  1413     02  eibfiller2       pic x(2).
  1414     02  eibrcode         pic x(6).
  1415     02  eibfiller3       pic x(2).
  1416     02  eibds            pic x(8).
  1417     02  eibreqid         pic x(8).
  1418     02  eibrsrce         pic x(8).
  1419     02  eibsync          pic x(1).
  1420     02  eibfree          pic x(1).
  1421     02  eibrecv          pic x(1).
  1422     02  eibsend          pic x(1).
  1423     02  eibatt           pic x(1).
  1424     02  eibeoc           pic x(1).
  1425     02  eibfmh           pic x(1).
  1426     02  eibcompl         pic x(1).
  1427     02  eibsig           pic x(1).
  1428     02  eibconf          pic x(1).
  1429     02  eiberr           pic x(1).
  1430     02  eibrldbk         pic x(1).
  1431     02  eiberrcd         pic x(4).
  1432     02  eibsynrb         pic x(1).
  1433     02  eibnodat         pic x(1).
  1434     02  eibfiller5       pic x(2).
  1435     02  eibresp          pic 9(09) comp.
  1436     02  eibresp2         pic 9(09) comp.
  1437     02  dfheigdj         pic s9(4) comp.
  1438     02  dfheigdk         pic s9(4) comp.
  1439 01  DFHCOMMAREA                 PIC X(1024).
  1440 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1441 0000-DFHEXIT SECTION.
  1442     MOVE '9#                    $   ' TO DFHEIV0.
  1443     MOVE 'EL6503' TO DFHEIV1.
  1444     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1445     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1446     MOVE '5'                    TO DC-OPTION-CODE
  1447     PERFORM 8500-DATE-CONVERSION
  1448                                 THRU 8500-EXIT
  1449     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1450     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1451     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  1452     MOVE +1                     TO EMI-NUMBER-OF-LINES
  1453                                    EMI-SWITCH2
  1454     IF EIBCALEN NOT > ZERO
  1455        MOVE UNACCESS-MSG        TO LOGOFF-MSG
  1456        GO TO 8300-SEND-TEXT
  1457     END-IF
  1458
  1459* EXEC CICS HANDLE CONDITION
  1460*        PGMIDERR (9600-PGMIDERR)
  1461*        ERROR    (9990-ERROR)
  1462*    END-EXEC
  1463*    MOVE '"$L.                  ! " #00001454' TO DFHEIV0
  1464     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  28
* EL6503.cbl
  1466     MOVE X'2220233030303031343534' TO DFHEIV0(25:11)
  1467     CALL 'kxdfhei1' USING DFHEIV0
  1468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1469     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1470        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1471           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  1472           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  1473           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  1474           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  1475           MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  1476           MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  1477           MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  1478           MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  1479        ELSE
  1480           MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  1481           MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  1482           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  1483           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  1484           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  1485           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  1486           MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  1487           MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  1488        END-IF
  1489     END-IF
  1490     IF EIBTRNID NOT = WS-TRANS-ID
  1491        GO TO 1000-INITIAL-SCREEN
  1492     END-IF
  1493     IF EIBAID = DFHCLEAR
  1494        GO TO 9400-CLEAR
  1495     END-IF
  1496     IF NOT DISPLAY-CAP
  1497        MOVE 'READ'              TO SM-READ
  1498        PERFORM 9995-SECURITY-VIOLATION
  1499        MOVE ER-0070             TO EMI-ERROR
  1500        PERFORM 9900-ERROR-FORMAT
  1501                                 THRU 9900-EXIT
  1502        GO TO 8100-SEND-INITIAL-MAP
  1503     END-IF
  1504     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1505        MOVE LOW-VALUES          TO EL6503AO
  1506        MOVE -1                  TO PFKEYL
  1507        MOVE ER-0008             TO EMI-ERROR
  1508        GO TO 8200-SEND-DATAONLY
  1509     END-IF
  1510
  1511* EXEC CICS RECEIVE
  1512*        INTO   (EL6503AI)
  1513*        MAPSET (WS-MAPSET-NAME)
  1514*        MAP    (WS-MAP-NAME)
  1515*    END-EXEC
  1516     MOVE LENGTH OF
  1517      EL6503AI
  1518       TO DFHEIV11
  1519*    MOVE '8"T I  L              ''   #00001499' TO DFHEIV0
  1520     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1521     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1522     MOVE X'2020233030303031343939' TO DFHEIV0(25:11)
  1523     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  29
* EL6503.cbl
  1524           WS-MAP-NAME,
  1525           EL6503AI,
  1526           DFHEIV11,
  1527           WS-MAPSET-NAME,
  1528           DFHEIV99,
  1529           DFHEIV99
  1530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1531     IF PFKEYL > ZERO
  1532        IF EIBAID NOT = DFHENTER
  1533           MOVE ER-0004          TO EMI-ERROR
  1534           MOVE AL-UNBOF         TO PFKEYA
  1535           MOVE -1               TO PFKEYL
  1536           GO TO 8200-SEND-DATAONLY
  1537        ELSE
  1538           IF PFKEYO NUMERIC AND
  1539              (PFKEYO > ZERO AND LESS '25')
  1540              MOVE PF-VALUES (PFKEYI)
  1541                                 TO  EIBAID
  1542           ELSE
  1543              MOVE ER-0029       TO  EMI-ERROR
  1544              MOVE AL-UNBOF      TO  PFKEYA
  1545              MOVE -1            TO  PFKEYL
  1546              GO TO 8200-SEND-DATAONLY
  1547           END-IF
  1548        END-IF
  1549     END-IF
  1550     IF EIBAID = DFHPF12
  1551        MOVE 'EL010'             TO THIS-PGM
  1552        GO TO 9300-XCTL
  1553     END-IF
  1554     IF EIBAID = DFHPF23
  1555        GO TO 9000-RETURN-CICS
  1556     END-IF
  1557     IF EIBAID = DFHPF24
  1558        IF CREDIT-SESSION
  1559           MOVE 'EL626'          TO THIS-PGM
  1560           GO TO 9300-XCTL
  1561        ELSE
  1562           MOVE 'EL126'          TO THIS-PGM
  1563           GO TO 9300-XCTL
  1564        END-IF
  1565     END-IF
  1566     IF EIBAID = DFHENTER
  1567        CONTINUE
  1568     ELSE
  1569        MOVE ER-0008             TO EMI-ERROR
  1570        MOVE -1                  TO PFKEYL
  1571        GO TO 8200-SEND-DATAONLY
  1572     END-IF
  1573     IF NOT MODIFY-CAP
  1574        MOVE 'UPDATE'            TO SM-READ
  1575        PERFORM 9995-SECURITY-VIOLATION
  1576                                 THRU 9995-EXIT
  1577        MOVE ER-0070             TO EMI-ERROR
  1578        PERFORM 9900-ERROR-FORMAT
  1579                                 THRU 9900-EXIT
  1580        MOVE AL-UANON            TO CARRIERA GROUPA
  1581                                    STATEA  ACCTNOA
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  30
* EL6503.cbl
  1582        GO TO 8100-SEND-INITIAL-MAP
  1583     END-IF
  1584     EVALUATE MAINTYPI
  1585        WHEN 'D'
  1586           PERFORM 2000-DELETE-ERACNT
  1587                                 THRU 2000-EXIT
  1588           MOVE ER-0000          TO EMI-ERROR
  1589           PERFORM 9900-ERROR-FORMAT
  1590                                 THRU 9900-EXIT
  1591           GO TO 8100-SEND-INITIAL-MAP
  1592        WHEN 'C'
  1593           PERFORM 3000-CHANGE-ERACNT
  1594                                 THRU 3000-EXIT
  1595           MOVE ER-0000          TO EMI-ERROR
  1596           PERFORM 9900-ERROR-FORMAT
  1597                                 THRU 9900-EXIT
  1598        WHEN 'A'
  1599           PERFORM 4000-ADD-ERACNT
  1600                                 THRU 4000-EXIT
  1601           MOVE ER-0000          TO EMI-ERROR
  1602           PERFORM 9900-ERROR-FORMAT
  1603                                 THRU 9900-EXIT
  1604        WHEN OTHER
  1605           MOVE ER-0023          TO EMI-ERROR
  1606           PERFORM 9900-ERROR-FORMAT
  1607                                 THRU 9900-EXIT
  1608           MOVE -1               TO MAINTYPL
  1609           MOVE AL-UABON         TO MAINTYPA
  1610     END-EVALUATE
  1611     .
  1612 1000-INITIAL-SCREEN.
  1613*    MOVE SPACES                 TO PI-PROGRAM-WORK-AREA
  1614     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  1615     MOVE PI-ACCT-CARRIER        TO WS-CARRIER
  1616                                    CARRIERO
  1617     MOVE PI-ACCT-GROUPING       TO WS-GROUPING
  1618                                    GROUPO
  1619     MOVE PI-ACCT-STATE          TO WS-STATE
  1620                                    STATEO
  1621     MOVE PI-ACCT-ACCOUNT        TO WS-ACCOUNT
  1622                                    ACCTNOO
  1623     MOVE AL-UANON               TO CARRIERA
  1624                                    GROUPA
  1625                                    STATEA
  1626                                    ACCTNOA
  1627     MOVE ' '                    TO MAINTYPO
  1628     MOVE -1                     TO MAINTYPL
  1629     MOVE '2'                    TO WS-REC-TYPE
  1630     MOVE +0                     TO WS-SEQ-NO
  1631     MOVE WS-CONTROL-PRIMARY     TO WS-SAVE-ERACNT-KEY
  1632
  1633* EXEC CICS STARTBR
  1634*        DATASET   ('ERACNT')
  1635*        RIDFLD    (WS-CONTROL-PRIMARY)
  1636*        GTEQ
  1637*        RESP      (WS-RESPONSE)
  1638*    END-EXEC
  1639     MOVE 'ERACNT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  31
* EL6503.cbl
  1640     MOVE 0
  1641       TO DFHEIV11
  1642*    MOVE '&,         G          &  N#00001605' TO DFHEIV0
  1643     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1644     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1645     MOVE X'204E233030303031363035' TO DFHEIV0(25:11)
  1646     CALL 'kxdfhei1' USING DFHEIV0,
  1647           DFHEIV1,
  1648           WS-CONTROL-PRIMARY,
  1649           DFHEIV99,
  1650           DFHEIV11,
  1651           DFHEIV99
  1652     MOVE EIBRESP  TO WS-RESPONSE
  1653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1654     IF NOT RESP-NORMAL
  1655        GO TO 8100-SEND-INITIAL-MAP
  1656     END-IF
  1657     SET ERACNT-BROWSE-STARTED   TO TRUE
  1658
  1659* EXEC CICS READNEXT
  1660*        DATASET  ('ERACNT')
  1661*        INTO     (NOTE-FILE)
  1662*        RIDFLD   (WS-CONTROL-PRIMARY)
  1663*        RESP     (WS-RESPONSE)
  1664*    END-EXEC
  1665     MOVE LENGTH OF
  1666      NOTE-FILE
  1667       TO DFHEIV12
  1668     MOVE 'ERACNT' TO DFHEIV1
  1669     MOVE 0
  1670       TO DFHEIV11
  1671*    MOVE '&.IL                  )  N#00001615' TO DFHEIV0
  1672     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1673     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1674     MOVE X'204E233030303031363135' TO DFHEIV0(25:11)
  1675     CALL 'kxdfhei1' USING DFHEIV0,
  1676           DFHEIV1,
  1677           NOTE-FILE,
  1678           DFHEIV12,
  1679           WS-CONTROL-PRIMARY,
  1680           DFHEIV99,
  1681           DFHEIV11,
  1682           DFHEIV99,
  1683           DFHEIV99
  1684     MOVE EIBRESP  TO WS-RESPONSE
  1685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1686     IF (RESP-NORMAL)
  1687        AND (WS-CONTROL-PRIMARY (1:20) =
  1688           WS-SAVE-ERACNT-KEY (1:20))
  1689        IF (WS-REC-TYPE = '2')
  1690           AND (WS-SEQ-NO = 1)
  1691           MOVE NT-BRANCH-LOC-LINE
  1692                                 TO BLINE1O
  1693           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1694                                 THRU 1010-EXIT
  1695
  1696* EXEC CICS READNEXT
  1697*             DATASET  ('ERACNT')
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  32
* EL6503.cbl
  1698*             INTO     (NOTE-FILE)
  1699*             RIDFLD   (WS-CONTROL-PRIMARY)
  1700*             RESP     (WS-RESPONSE)
  1701*          END-EXEC
  1702     MOVE LENGTH OF
  1703      NOTE-FILE
  1704       TO DFHEIV12
  1705     MOVE 'ERACNT' TO DFHEIV1
  1706     MOVE 0
  1707       TO DFHEIV11
  1708*    MOVE '&.IL                  )  N#00001630' TO DFHEIV0
  1709     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1710     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1711     MOVE X'204E233030303031363330' TO DFHEIV0(25:11)
  1712     CALL 'kxdfhei1' USING DFHEIV0,
  1713           DFHEIV1,
  1714           NOTE-FILE,
  1715           DFHEIV12,
  1716           WS-CONTROL-PRIMARY,
  1717           DFHEIV99,
  1718           DFHEIV11,
  1719           DFHEIV99,
  1720           DFHEIV99
  1721     MOVE EIBRESP  TO WS-RESPONSE
  1722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1723        END-IF
  1724     ELSE
  1725        MOVE ER-0006             TO EMI-ERROR
  1726        PERFORM 9900-ERROR-FORMAT
  1727                                 THRU 9900-EXIT
  1728     END-IF
  1729     IF (RESP-NORMAL)
  1730        AND (WS-CONTROL-PRIMARY (1:20) =
  1731           WS-SAVE-ERACNT-KEY (1:20))
  1732        IF (WS-REC-TYPE = '2')
  1733           AND (WS-SEQ-NO = 2)
  1734           MOVE NT-BRANCH-LOC-LINE
  1735                                 TO BLINE2O
  1736           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1737                                 THRU 1010-EXIT
  1738
  1739* EXEC CICS READNEXT
  1740*             DATASET  ('ERACNT')
  1741*             INTO     (NOTE-FILE)
  1742*             RIDFLD   (WS-CONTROL-PRIMARY)
  1743*             RESP     (WS-RESPONSE)
  1744*          END-EXEC
  1745     MOVE LENGTH OF
  1746      NOTE-FILE
  1747       TO DFHEIV12
  1748     MOVE 'ERACNT' TO DFHEIV1
  1749     MOVE 0
  1750       TO DFHEIV11
  1751*    MOVE '&.IL                  )  N#00001651' TO DFHEIV0
  1752     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1753     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1754     MOVE X'204E233030303031363531' TO DFHEIV0(25:11)
  1755     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  33
* EL6503.cbl
  1756           DFHEIV1,
  1757           NOTE-FILE,
  1758           DFHEIV12,
  1759           WS-CONTROL-PRIMARY,
  1760           DFHEIV99,
  1761           DFHEIV11,
  1762           DFHEIV99,
  1763           DFHEIV99
  1764     MOVE EIBRESP  TO WS-RESPONSE
  1765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1766        END-IF
  1767     END-IF
  1768     IF (RESP-NORMAL)
  1769        AND (WS-CONTROL-PRIMARY (1:20) =
  1770           WS-SAVE-ERACNT-KEY (1:20))
  1771        IF (WS-REC-TYPE = '3')
  1772           AND (WS-SEQ-NO = 1)
  1773           MOVE NT-SHIPPING-LINE TO SNAME1O
  1774           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1775                                 THRU 1010-EXIT
  1776
  1777* EXEC CICS READNEXT
  1778*             DATASET  ('ERACNT')
  1779*             INTO     (NOTE-FILE)
  1780*             RIDFLD   (WS-CONTROL-PRIMARY)
  1781*             RESP     (WS-RESPONSE)
  1782*          END-EXEC
  1783     MOVE LENGTH OF
  1784      NOTE-FILE
  1785       TO DFHEIV12
  1786     MOVE 'ERACNT' TO DFHEIV1
  1787     MOVE 0
  1788       TO DFHEIV11
  1789*    MOVE '&.IL                  )  N#00001667' TO DFHEIV0
  1790     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1791     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1792     MOVE X'204E233030303031363637' TO DFHEIV0(25:11)
  1793     CALL 'kxdfhei1' USING DFHEIV0,
  1794           DFHEIV1,
  1795           NOTE-FILE,
  1796           DFHEIV12,
  1797           WS-CONTROL-PRIMARY,
  1798           DFHEIV99,
  1799           DFHEIV11,
  1800           DFHEIV99,
  1801           DFHEIV99
  1802     MOVE EIBRESP  TO WS-RESPONSE
  1803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1804        END-IF
  1805     END-IF
  1806     IF (RESP-NORMAL)
  1807        AND (WS-CONTROL-PRIMARY (1:20) =
  1808           WS-SAVE-ERACNT-KEY (1:20))
  1809        IF (WS-REC-TYPE = '3')
  1810           AND (WS-SEQ-NO = 2)
  1811           MOVE NT-SHIPPING-LINE TO SNAME2O
  1812           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1813                                 THRU 1010-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  34
* EL6503.cbl
  1814
  1815* EXEC CICS READNEXT
  1816*             DATASET  ('ERACNT')
  1817*             INTO     (NOTE-FILE)
  1818*             RIDFLD   (WS-CONTROL-PRIMARY)
  1819*             RESP     (WS-RESPONSE)
  1820*          END-EXEC
  1821     MOVE LENGTH OF
  1822      NOTE-FILE
  1823       TO DFHEIV12
  1824     MOVE 'ERACNT' TO DFHEIV1
  1825     MOVE 0
  1826       TO DFHEIV11
  1827*    MOVE '&.IL                  )  N#00001683' TO DFHEIV0
  1828     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1829     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1830     MOVE X'204E233030303031363833' TO DFHEIV0(25:11)
  1831     CALL 'kxdfhei1' USING DFHEIV0,
  1832           DFHEIV1,
  1833           NOTE-FILE,
  1834           DFHEIV12,
  1835           WS-CONTROL-PRIMARY,
  1836           DFHEIV99,
  1837           DFHEIV11,
  1838           DFHEIV99,
  1839           DFHEIV99
  1840     MOVE EIBRESP  TO WS-RESPONSE
  1841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1842        END-IF
  1843     END-IF
  1844     IF (RESP-NORMAL)
  1845        AND (WS-CONTROL-PRIMARY (1:20) =
  1846           WS-SAVE-ERACNT-KEY (1:20))
  1847        IF (WS-REC-TYPE = '3')
  1848           AND (WS-SEQ-NO = 3)
  1849           MOVE NT-SHIPPING-LINE TO SADDR1O
  1850           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1851                                 THRU 1010-EXIT
  1852
  1853* EXEC CICS READNEXT
  1854*             DATASET  ('ERACNT')
  1855*             INTO     (NOTE-FILE)
  1856*             RIDFLD   (WS-CONTROL-PRIMARY)
  1857*             RESP     (WS-RESPONSE)
  1858*          END-EXEC
  1859     MOVE LENGTH OF
  1860      NOTE-FILE
  1861       TO DFHEIV12
  1862     MOVE 'ERACNT' TO DFHEIV1
  1863     MOVE 0
  1864       TO DFHEIV11
  1865*    MOVE '&.IL                  )  N#00001699' TO DFHEIV0
  1866     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1867     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1868     MOVE X'204E233030303031363939' TO DFHEIV0(25:11)
  1869     CALL 'kxdfhei1' USING DFHEIV0,
  1870           DFHEIV1,
  1871           NOTE-FILE,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  35
* EL6503.cbl
  1872           DFHEIV12,
  1873           WS-CONTROL-PRIMARY,
  1874           DFHEIV99,
  1875           DFHEIV11,
  1876           DFHEIV99,
  1877           DFHEIV99
  1878     MOVE EIBRESP  TO WS-RESPONSE
  1879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1880        END-IF
  1881     END-IF
  1882     IF (RESP-NORMAL)
  1883        AND (WS-CONTROL-PRIMARY (1:20) =
  1884           WS-SAVE-ERACNT-KEY (1:20))
  1885        IF (WS-REC-TYPE = '3')
  1886           AND (WS-SEQ-NO = 4)
  1887           MOVE NT-SHIPPING-LINE TO SADDR2O
  1888           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1889                                 THRU 1010-EXIT
  1890
  1891* EXEC CICS READNEXT
  1892*             DATASET  ('ERACNT')
  1893*             INTO     (NOTE-FILE)
  1894*             RIDFLD   (WS-CONTROL-PRIMARY)
  1895*             RESP     (WS-RESPONSE)
  1896*          END-EXEC
  1897     MOVE LENGTH OF
  1898      NOTE-FILE
  1899       TO DFHEIV12
  1900     MOVE 'ERACNT' TO DFHEIV1
  1901     MOVE 0
  1902       TO DFHEIV11
  1903*    MOVE '&.IL                  )  N#00001715' TO DFHEIV0
  1904     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1905     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1906     MOVE X'204E233030303031373135' TO DFHEIV0(25:11)
  1907     CALL 'kxdfhei1' USING DFHEIV0,
  1908           DFHEIV1,
  1909           NOTE-FILE,
  1910           DFHEIV12,
  1911           WS-CONTROL-PRIMARY,
  1912           DFHEIV99,
  1913           DFHEIV11,
  1914           DFHEIV99,
  1915           DFHEIV99
  1916     MOVE EIBRESP  TO WS-RESPONSE
  1917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1918        END-IF
  1919     END-IF
  1920     IF (RESP-NORMAL)
  1921        AND (WS-CONTROL-PRIMARY (1:20) =
  1922           WS-SAVE-ERACNT-KEY (1:20))
  1923        IF (WS-REC-TYPE = '3')
  1924           AND (WS-SEQ-NO = 5)
  1925           MOVE NT-SHIPPING-LINE TO SADDR3O
  1926           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1927                                 THRU 1010-EXIT
  1928
  1929* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  36
* EL6503.cbl
  1930*             DATASET  ('ERACNT')
  1931*             INTO     (NOTE-FILE)
  1932*             RIDFLD   (WS-CONTROL-PRIMARY)
  1933*             RESP     (WS-RESPONSE)
  1934*          END-EXEC
  1935     MOVE LENGTH OF
  1936      NOTE-FILE
  1937       TO DFHEIV12
  1938     MOVE 'ERACNT' TO DFHEIV1
  1939     MOVE 0
  1940       TO DFHEIV11
  1941*    MOVE '&.IL                  )  N#00001731' TO DFHEIV0
  1942     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1943     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1944     MOVE X'204E233030303031373331' TO DFHEIV0(25:11)
  1945     CALL 'kxdfhei1' USING DFHEIV0,
  1946           DFHEIV1,
  1947           NOTE-FILE,
  1948           DFHEIV12,
  1949           WS-CONTROL-PRIMARY,
  1950           DFHEIV99,
  1951           DFHEIV11,
  1952           DFHEIV99,
  1953           DFHEIV99
  1954     MOVE EIBRESP  TO WS-RESPONSE
  1955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1956        END-IF
  1957     END-IF
  1958     IF (RESP-NORMAL)
  1959        AND (WS-CONTROL-PRIMARY (1:20) =
  1960           WS-SAVE-ERACNT-KEY (1:20))
  1961        IF (WS-REC-TYPE = '3')
  1962           AND (WS-SEQ-NO = 6)
  1963           MOVE NT-SHIPPING-LINE TO SCITYO
  1964           MOVE NT-SHIP-STATE    TO SSTATEO
  1965           MOVE NT-SHIP-ZIP      TO SZIPO
  1966           PERFORM 1010-BUILD-LAST-MAINT-INFO
  1967                                 THRU 1010-EXIT
  1968        END-IF
  1969     END-IF
  1970     IF ERACNT-BROWSE-STARTED
  1971
  1972* EXEC CICS ENDBR
  1973*          DATASET    ('ERACNT')
  1974*       END-EXEC
  1975     MOVE 'ERACNT' TO DFHEIV1
  1976     MOVE 0
  1977       TO DFHEIV11
  1978*    MOVE '&2                    $   #00001752' TO DFHEIV0
  1979     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1980     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1981     MOVE X'2020233030303031373532' TO DFHEIV0(25:11)
  1982     CALL 'kxdfhei1' USING DFHEIV0,
  1983           DFHEIV1,
  1984           DFHEIV11,
  1985           DFHEIV99
  1986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1987     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  37
* EL6503.cbl
  1988     MOVE -1                     TO MAINTYPL
  1989     GO TO 8100-SEND-INITIAL-MAP
  1990     .
  1991 1000-EXIT.
  1992     EXIT.
  1993 1010-BUILD-LAST-MAINT-INFO.
  1994     MOVE NT-LAST-MAINT-BY       TO LSTUSRO
  1995     MOVE NT-LAST-MAINT-HHMMSS   TO TIME-IN
  1996     MOVE TIME-OUT               TO LSTTIMEO
  1997     MOVE NT-LAST-MAINT-DT       TO DC-BIN-DATE-1
  1998     MOVE ' '                    TO DC-OPTION-CODE
  1999     PERFORM 8500-DATE-CONVERSION
  2000                                 THRU 8500-EXIT
  2001     IF NO-CONVERSION-ERROR
  2002        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  2003     END-IF
  2004     .
  2005 1010-EXIT.
  2006     EXIT.
  2007 2000-DELETE-ERACNT.
  2008     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  2009     MOVE PI-ACCT-CARRIER        TO WS-CARRIER
  2010     MOVE PI-ACCT-GROUPING       TO WS-GROUPING
  2011     MOVE PI-ACCT-STATE          TO WS-STATE
  2012     MOVE PI-ACCT-ACCOUNT        TO WS-ACCOUNT
  2013     MOVE '2'                    TO WS-REC-TYPE
  2014     MOVE +1                     TO WS-SEQ-NO
  2015
  2016* EXEC CICS READ
  2017*       UPDATE
  2018*       DATASET  ('ERACNT')
  2019*       INTO     (NOTE-FILE)
  2020*       RIDFLD   (WS-CONTROL-PRIMARY)
  2021*       RESP     (WS-RESPONSE)
  2022*    END-EXEC
  2023     MOVE LENGTH OF
  2024      NOTE-FILE
  2025       TO DFHEIV11
  2026     MOVE 'ERACNT' TO DFHEIV1
  2027*    MOVE '&"IL       EU         (  N#00001783' TO DFHEIV0
  2028     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2029     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2030     MOVE X'204E233030303031373833' TO DFHEIV0(25:11)
  2031     CALL 'kxdfhei1' USING DFHEIV0,
  2032           DFHEIV1,
  2033           NOTE-FILE,
  2034           DFHEIV11,
  2035           WS-CONTROL-PRIMARY,
  2036           DFHEIV99,
  2037           DFHEIV99,
  2038           DFHEIV99
  2039     MOVE EIBRESP  TO WS-RESPONSE
  2040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2041     IF RESP-NORMAL
  2042
  2043* EXEC CICS DELETE
  2044*          DATASET    ('ERACNT')
  2045*          RESP       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  38
* EL6503.cbl
  2046*       END-EXEC
  2047     MOVE 'ERACNT' TO DFHEIV1
  2048*    MOVE '&(                    &  N#00001791' TO DFHEIV0
  2049     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2050     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2051     MOVE X'204E233030303031373931' TO DFHEIV0(25:11)
  2052     CALL 'kxdfhei1' USING DFHEIV0,
  2053           DFHEIV1,
  2054           DFHEIV99,
  2055           DFHEIV99,
  2056           DFHEIV99,
  2057           DFHEIV99
  2058     MOVE EIBRESP  TO WS-RESPONSE
  2059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2060     END-IF
  2061     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  2062     MOVE PI-ACCT-CARRIER        TO WS-CARRIER
  2063     MOVE PI-ACCT-GROUPING       TO WS-GROUPING
  2064     MOVE PI-ACCT-STATE          TO WS-STATE
  2065     MOVE PI-ACCT-ACCOUNT        TO WS-ACCOUNT
  2066     MOVE '2'                    TO WS-REC-TYPE
  2067     MOVE +2                     TO WS-SEQ-NO
  2068
  2069* EXEC CICS READ
  2070*       UPDATE
  2071*       DATASET  ('ERACNT')
  2072*       INTO     (NOTE-FILE)
  2073*       RIDFLD   (WS-CONTROL-PRIMARY)
  2074*       RESP     (WS-RESPONSE)
  2075*    END-EXEC
  2076     MOVE LENGTH OF
  2077      NOTE-FILE
  2078       TO DFHEIV11
  2079     MOVE 'ERACNT' TO DFHEIV1
  2080*    MOVE '&"IL       EU         (  N#00001803' TO DFHEIV0
  2081     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2082     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2083     MOVE X'204E233030303031383033' TO DFHEIV0(25:11)
  2084     CALL 'kxdfhei1' USING DFHEIV0,
  2085           DFHEIV1,
  2086           NOTE-FILE,
  2087           DFHEIV11,
  2088           WS-CONTROL-PRIMARY,
  2089           DFHEIV99,
  2090           DFHEIV99,
  2091           DFHEIV99
  2092     MOVE EIBRESP  TO WS-RESPONSE
  2093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2094     IF RESP-NORMAL
  2095
  2096* EXEC CICS DELETE
  2097*          DATASET    ('ERACNT')
  2098*          RESP       (WS-RESPONSE)
  2099*       END-EXEC
  2100     MOVE 'ERACNT' TO DFHEIV1
  2101*    MOVE '&(                    &  N#00001811' TO DFHEIV0
  2102     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2103     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  39
* EL6503.cbl
  2104     MOVE X'204E233030303031383131' TO DFHEIV0(25:11)
  2105     CALL 'kxdfhei1' USING DFHEIV0,
  2106           DFHEIV1,
  2107           DFHEIV99,
  2108           DFHEIV99,
  2109           DFHEIV99,
  2110           DFHEIV99
  2111     MOVE EIBRESP  TO WS-RESPONSE
  2112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2113     END-IF
  2114     PERFORM VARYING B1 FROM +1 BY +1 UNTIL
  2115        (B1 > +6)
  2116        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2117        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2118        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2119        MOVE PI-ACCT-STATE       TO WS-STATE
  2120        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2121        MOVE '3'                 TO WS-REC-TYPE
  2122        MOVE B1                  TO WS-SEQ-NO
  2123
  2124* EXEC CICS READ
  2125*          UPDATE
  2126*          DATASET  ('ERACNT')
  2127*          INTO     (NOTE-FILE)
  2128*          RIDFLD   (WS-CONTROL-PRIMARY)
  2129*          RESP     (WS-RESPONSE)
  2130*       END-EXEC
  2131     MOVE LENGTH OF
  2132      NOTE-FILE
  2133       TO DFHEIV11
  2134     MOVE 'ERACNT' TO DFHEIV1
  2135*    MOVE '&"IL       EU         (  N#00001825' TO DFHEIV0
  2136     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2137     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2138     MOVE X'204E233030303031383235' TO DFHEIV0(25:11)
  2139     CALL 'kxdfhei1' USING DFHEIV0,
  2140           DFHEIV1,
  2141           NOTE-FILE,
  2142           DFHEIV11,
  2143           WS-CONTROL-PRIMARY,
  2144           DFHEIV99,
  2145           DFHEIV99,
  2146           DFHEIV99
  2147     MOVE EIBRESP  TO WS-RESPONSE
  2148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2149        IF RESP-NORMAL
  2150
  2151* EXEC CICS DELETE
  2152*             DATASET    ('ERACNT')
  2153*             RESP       (WS-RESPONSE)
  2154*          END-EXEC
  2155     MOVE 'ERACNT' TO DFHEIV1
  2156*    MOVE '&(                    &  N#00001833' TO DFHEIV0
  2157     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2158     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2159     MOVE X'204E233030303031383333' TO DFHEIV0(25:11)
  2160     CALL 'kxdfhei1' USING DFHEIV0,
  2161           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  40
* EL6503.cbl
  2162           DFHEIV99,
  2163           DFHEIV99,
  2164           DFHEIV99,
  2165           DFHEIV99
  2166     MOVE EIBRESP  TO WS-RESPONSE
  2167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2168        END-IF
  2169     END-PERFORM
  2170     .
  2171 2000-EXIT.
  2172     EXIT.
  2173 3000-CHANGE-ERACNT.
  2174     IF BLINE1L > ZEROS
  2175        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2176        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2177        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2178        MOVE PI-ACCT-STATE       TO WS-STATE
  2179        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2180        MOVE '2'                 TO WS-REC-TYPE
  2181        MOVE +1                  TO WS-SEQ-NO
  2182
  2183* EXEC CICS READ
  2184*          UPDATE
  2185*          DATASET  ('ERACNT')
  2186*          INTO     (NOTE-FILE)
  2187*          RIDFLD   (WS-CONTROL-PRIMARY)
  2188*          RESP     (WS-RESPONSE)
  2189*       END-EXEC
  2190     MOVE LENGTH OF
  2191      NOTE-FILE
  2192       TO DFHEIV11
  2193     MOVE 'ERACNT' TO DFHEIV1
  2194*    MOVE '&"IL       EU         (  N#00001851' TO DFHEIV0
  2195     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2196     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2197     MOVE X'204E233030303031383531' TO DFHEIV0(25:11)
  2198     CALL 'kxdfhei1' USING DFHEIV0,
  2199           DFHEIV1,
  2200           NOTE-FILE,
  2201           DFHEIV11,
  2202           WS-CONTROL-PRIMARY,
  2203           DFHEIV99,
  2204           DFHEIV99,
  2205           DFHEIV99
  2206     MOVE EIBRESP  TO WS-RESPONSE
  2207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2208        IF RESP-NORMAL
  2209           MOVE BLINE1I          TO NT-BRANCH-LOC-LINE
  2210           PERFORM 5020-REWRITE-ERACNT
  2211                                 THRU 5020-EXIT
  2212        ELSE
  2213           PERFORM 4010-ADD-BLINE1
  2214                                 THRU 4010-EXIT
  2215        END-IF
  2216     END-IF
  2217     IF BLINE2L > ZEROS
  2218        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2219        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  41
* EL6503.cbl
  2220        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2221        MOVE PI-ACCT-STATE       TO WS-STATE
  2222        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2223        MOVE '2'                 TO WS-REC-TYPE
  2224        MOVE +2                  TO WS-SEQ-NO
  2225
  2226* EXEC CICS READ
  2227*          UPDATE
  2228*          DATASET  ('ERACNT')
  2229*          INTO     (NOTE-FILE)
  2230*          RIDFLD   (WS-CONTROL-PRIMARY)
  2231*          RESP     (WS-RESPONSE)
  2232*       END-EXEC
  2233     MOVE LENGTH OF
  2234      NOTE-FILE
  2235       TO DFHEIV11
  2236     MOVE 'ERACNT' TO DFHEIV1
  2237*    MOVE '&"IL       EU         (  N#00001875' TO DFHEIV0
  2238     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2239     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2240     MOVE X'204E233030303031383735' TO DFHEIV0(25:11)
  2241     CALL 'kxdfhei1' USING DFHEIV0,
  2242           DFHEIV1,
  2243           NOTE-FILE,
  2244           DFHEIV11,
  2245           WS-CONTROL-PRIMARY,
  2246           DFHEIV99,
  2247           DFHEIV99,
  2248           DFHEIV99
  2249     MOVE EIBRESP  TO WS-RESPONSE
  2250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2251        IF RESP-NORMAL
  2252           MOVE BLINE2I          TO NT-BRANCH-LOC-LINE
  2253           PERFORM 5020-REWRITE-ERACNT
  2254                                 THRU 5020-EXIT
  2255        ELSE
  2256           PERFORM 4012-ADD-BLINE2
  2257                                 THRU 4012-EXIT
  2258        END-IF
  2259     END-IF
  2260     IF SNAME1L > ZEROS
  2261        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2262        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2263        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2264        MOVE PI-ACCT-STATE       TO WS-STATE
  2265        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2266        MOVE '3'                 TO WS-REC-TYPE
  2267        MOVE +1                  TO WS-SEQ-NO
  2268
  2269* EXEC CICS READ
  2270*          UPDATE
  2271*          DATASET  ('ERACNT')
  2272*          INTO     (NOTE-FILE)
  2273*          RIDFLD   (WS-CONTROL-PRIMARY)
  2274*          RESP     (WS-RESPONSE)
  2275*       END-EXEC
  2276     MOVE LENGTH OF
  2277      NOTE-FILE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  42
* EL6503.cbl
  2278       TO DFHEIV11
  2279     MOVE 'ERACNT' TO DFHEIV1
  2280*    MOVE '&"IL       EU         (  N#00001899' TO DFHEIV0
  2281     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2282     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2283     MOVE X'204E233030303031383939' TO DFHEIV0(25:11)
  2284     CALL 'kxdfhei1' USING DFHEIV0,
  2285           DFHEIV1,
  2286           NOTE-FILE,
  2287           DFHEIV11,
  2288           WS-CONTROL-PRIMARY,
  2289           DFHEIV99,
  2290           DFHEIV99,
  2291           DFHEIV99
  2292     MOVE EIBRESP  TO WS-RESPONSE
  2293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2294        IF RESP-NORMAL
  2295           MOVE SNAME1I          TO NT-SHIPPING-LINE
  2296           PERFORM 5020-REWRITE-ERACNT
  2297                                 THRU 5020-EXIT
  2298        ELSE
  2299           PERFORM 4014-ADD-SNAME1
  2300                                 THRU 4014-EXIT
  2301        END-IF
  2302     END-IF
  2303     IF SNAME2L > ZEROS
  2304        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2305        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2306        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2307        MOVE PI-ACCT-STATE       TO WS-STATE
  2308        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2309        MOVE '3'                 TO WS-REC-TYPE
  2310        MOVE +2                  TO WS-SEQ-NO
  2311
  2312* EXEC CICS READ
  2313*          UPDATE
  2314*          DATASET  ('ERACNT')
  2315*          INTO     (NOTE-FILE)
  2316*          RIDFLD   (WS-CONTROL-PRIMARY)
  2317*          RESP     (WS-RESPONSE)
  2318*       END-EXEC
  2319     MOVE LENGTH OF
  2320      NOTE-FILE
  2321       TO DFHEIV11
  2322     MOVE 'ERACNT' TO DFHEIV1
  2323*    MOVE '&"IL       EU         (  N#00001923' TO DFHEIV0
  2324     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2325     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2326     MOVE X'204E233030303031393233' TO DFHEIV0(25:11)
  2327     CALL 'kxdfhei1' USING DFHEIV0,
  2328           DFHEIV1,
  2329           NOTE-FILE,
  2330           DFHEIV11,
  2331           WS-CONTROL-PRIMARY,
  2332           DFHEIV99,
  2333           DFHEIV99,
  2334           DFHEIV99
  2335     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  43
* EL6503.cbl
  2336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2337        IF RESP-NORMAL
  2338           MOVE SNAME2I          TO NT-SHIPPING-LINE
  2339           PERFORM 5020-REWRITE-ERACNT
  2340                                 THRU 5020-EXIT
  2341        ELSE
  2342           PERFORM 4016-ADD-SNAME2
  2343                                 THRU 4016-EXIT
  2344        END-IF
  2345     END-IF
  2346     IF SADDR1L > ZEROS
  2347        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2348        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2349        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2350        MOVE PI-ACCT-STATE       TO WS-STATE
  2351        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2352        MOVE '3'                 TO WS-REC-TYPE
  2353        MOVE +3                  TO WS-SEQ-NO
  2354
  2355* EXEC CICS READ
  2356*          UPDATE
  2357*          DATASET  ('ERACNT')
  2358*          INTO     (NOTE-FILE)
  2359*          RIDFLD   (WS-CONTROL-PRIMARY)
  2360*          RESP     (WS-RESPONSE)
  2361*       END-EXEC
  2362     MOVE LENGTH OF
  2363      NOTE-FILE
  2364       TO DFHEIV11
  2365     MOVE 'ERACNT' TO DFHEIV1
  2366*    MOVE '&"IL       EU         (  N#00001947' TO DFHEIV0
  2367     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2368     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2369     MOVE X'204E233030303031393437' TO DFHEIV0(25:11)
  2370     CALL 'kxdfhei1' USING DFHEIV0,
  2371           DFHEIV1,
  2372           NOTE-FILE,
  2373           DFHEIV11,
  2374           WS-CONTROL-PRIMARY,
  2375           DFHEIV99,
  2376           DFHEIV99,
  2377           DFHEIV99
  2378     MOVE EIBRESP  TO WS-RESPONSE
  2379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2380        IF RESP-NORMAL
  2381           MOVE SADDR1I          TO NT-SHIPPING-LINE
  2382           PERFORM 5020-REWRITE-ERACNT
  2383                                 THRU 5020-EXIT
  2384        ELSE
  2385           PERFORM 4018-ADD-SADDR1
  2386                                 THRU 4018-EXIT
  2387        END-IF
  2388     END-IF
  2389     IF SADDR2L > ZEROS
  2390        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2391        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2392        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2393        MOVE PI-ACCT-STATE       TO WS-STATE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  44
* EL6503.cbl
  2394        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2395        MOVE '3'                 TO WS-REC-TYPE
  2396        MOVE +4                  TO WS-SEQ-NO
  2397
  2398* EXEC CICS READ
  2399*          UPDATE
  2400*          DATASET  ('ERACNT')
  2401*          INTO     (NOTE-FILE)
  2402*          RIDFLD   (WS-CONTROL-PRIMARY)
  2403*          RESP     (WS-RESPONSE)
  2404*       END-EXEC
  2405     MOVE LENGTH OF
  2406      NOTE-FILE
  2407       TO DFHEIV11
  2408     MOVE 'ERACNT' TO DFHEIV1
  2409*    MOVE '&"IL       EU         (  N#00001971' TO DFHEIV0
  2410     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2411     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2412     MOVE X'204E233030303031393731' TO DFHEIV0(25:11)
  2413     CALL 'kxdfhei1' USING DFHEIV0,
  2414           DFHEIV1,
  2415           NOTE-FILE,
  2416           DFHEIV11,
  2417           WS-CONTROL-PRIMARY,
  2418           DFHEIV99,
  2419           DFHEIV99,
  2420           DFHEIV99
  2421     MOVE EIBRESP  TO WS-RESPONSE
  2422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2423        IF RESP-NORMAL
  2424           MOVE SADDR2I          TO NT-SHIPPING-LINE
  2425           PERFORM 5020-REWRITE-ERACNT
  2426                                 THRU 5020-EXIT
  2427        ELSE
  2428           PERFORM 4020-ADD-SADDR2
  2429                                 THRU 4020-EXIT
  2430        END-IF
  2431     END-IF
  2432     IF SADDR3L    > ZEROS
  2433        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2434        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2435        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2436        MOVE PI-ACCT-STATE       TO WS-STATE
  2437        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2438        MOVE '3'                 TO WS-REC-TYPE
  2439        MOVE +5                  TO WS-SEQ-NO
  2440
  2441* EXEC CICS READ
  2442*          UPDATE
  2443*          DATASET  ('ERACNT')
  2444*          INTO     (NOTE-FILE)
  2445*          RIDFLD   (WS-CONTROL-PRIMARY)
  2446*          RESP     (WS-RESPONSE)
  2447*       END-EXEC
  2448     MOVE LENGTH OF
  2449      NOTE-FILE
  2450       TO DFHEIV11
  2451     MOVE 'ERACNT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  45
* EL6503.cbl
  2452*    MOVE '&"IL       EU         (  N#00001995' TO DFHEIV0
  2453     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2454     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2455     MOVE X'204E233030303031393935' TO DFHEIV0(25:11)
  2456     CALL 'kxdfhei1' USING DFHEIV0,
  2457           DFHEIV1,
  2458           NOTE-FILE,
  2459           DFHEIV11,
  2460           WS-CONTROL-PRIMARY,
  2461           DFHEIV99,
  2462           DFHEIV99,
  2463           DFHEIV99
  2464     MOVE EIBRESP  TO WS-RESPONSE
  2465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2466        IF RESP-NORMAL
  2467           MOVE SADDR3I          TO NT-SHIPPING-LINE
  2468           PERFORM 5020-REWRITE-ERACNT
  2469                                 THRU 5020-EXIT
  2470        ELSE
  2471           PERFORM 4022-ADD-SADDR3
  2472                                 THRU 4022-EXIT
  2473        END-IF
  2474     END-IF
  2475     IF (SCITYL     > ZEROS)
  2476        OR (SSTATEL > ZEROS)
  2477        OR (SZIPL   > ZEROS)
  2478        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2479        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2480        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2481        MOVE PI-ACCT-STATE       TO WS-STATE
  2482        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2483        MOVE '3'                 TO WS-REC-TYPE
  2484        MOVE +6                  TO WS-SEQ-NO
  2485
  2486* EXEC CICS READ
  2487*          UPDATE
  2488*          DATASET  ('ERACNT')
  2489*          INTO     (NOTE-FILE)
  2490*          RIDFLD   (WS-CONTROL-PRIMARY)
  2491*          RESP     (WS-RESPONSE)
  2492*       END-EXEC
  2493     MOVE LENGTH OF
  2494      NOTE-FILE
  2495       TO DFHEIV11
  2496     MOVE 'ERACNT' TO DFHEIV1
  2497*    MOVE '&"IL       EU         (  N#00002021' TO DFHEIV0
  2498     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2499     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2500     MOVE X'204E233030303032303231' TO DFHEIV0(25:11)
  2501     CALL 'kxdfhei1' USING DFHEIV0,
  2502           DFHEIV1,
  2503           NOTE-FILE,
  2504           DFHEIV11,
  2505           WS-CONTROL-PRIMARY,
  2506           DFHEIV99,
  2507           DFHEIV99,
  2508           DFHEIV99
  2509     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  46
* EL6503.cbl
  2510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2511        IF RESP-NORMAL
  2512           IF SCITYL > ZEROS
  2513              MOVE SCITYI        TO NT-SHIPPING-LINE
  2514           END-IF
  2515           IF SSTATEL > ZEROS
  2516              MOVE SSTATEI       TO NT-SHIP-STATE
  2517           END-IF
  2518           IF SZIPL > ZEROS
  2519              MOVE SZIPI         TO NT-SHIP-ZIP
  2520           END-IF
  2521           PERFORM 5020-REWRITE-ERACNT
  2522                                 THRU 5020-EXIT
  2523        ELSE
  2524           PERFORM 4024-ADD-SCITYSTZP
  2525                                 THRU 4024-EXIT
  2526        END-IF
  2527     END-IF
  2528     .
  2529 3000-EXIT.
  2530     EXIT.
  2531 4000-ADD-ERACNT.
  2532     PERFORM 4010-ADD-BLINE1     THRU 4010-EXIT
  2533     PERFORM 4012-ADD-BLINE2     THRU 4012-EXIT
  2534     PERFORM 4014-ADD-SNAME1     THRU 4014-EXIT
  2535     PERFORM 4016-ADD-SNAME2     THRU 4016-EXIT
  2536     PERFORM 4018-ADD-SADDR1     THRU 4018-EXIT
  2537     PERFORM 4020-ADD-SADDR2     THRU 4020-EXIT
  2538     PERFORM 4022-ADD-SADDR3     THRU 4022-EXIT
  2539     PERFORM 4024-ADD-SCITYSTZP  THRU 4024-EXIT
  2540     .
  2541 4000-EXIT.
  2542     EXIT.
  2543 4010-ADD-BLINE1.
  2544     IF BLINE1L > ZEROS
  2545        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2546        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2547        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2548        MOVE PI-ACCT-STATE       TO WS-STATE
  2549        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2550        MOVE '2'                 TO WS-REC-TYPE
  2551        MOVE +1                  TO WS-SEQ-NO
  2552
  2553* EXEC CICS READ
  2554*          DATASET  ('ERACNT')
  2555*          INTO     (NOTE-FILE)
  2556*          RIDFLD   (WS-CONTROL-PRIMARY)
  2557*          RESP     (WS-RESPONSE)
  2558*       END-EXEC
  2559     MOVE LENGTH OF
  2560      NOTE-FILE
  2561       TO DFHEIV11
  2562     MOVE 'ERACNT' TO DFHEIV1
  2563*    MOVE '&"IL       E          (  N#00002069' TO DFHEIV0
  2564     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2565     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2566     MOVE X'204E233030303032303639' TO DFHEIV0(25:11)
  2567     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  47
* EL6503.cbl
  2568           DFHEIV1,
  2569           NOTE-FILE,
  2570           DFHEIV11,
  2571           WS-CONTROL-PRIMARY,
  2572           DFHEIV99,
  2573           DFHEIV99,
  2574           DFHEIV99
  2575     MOVE EIBRESP  TO WS-RESPONSE
  2576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2577        IF RESP-NOTFND
  2578           PERFORM 5010-BUILD-ERACNT
  2579                                 THRU 5010-EXIT
  2580           MOVE BLINE1I          TO NT-BRANCH-LOC-LINE
  2581           PERFORM 5000-WRITE-ERACNT
  2582                                 THRU 5000-EXIT
  2583        END-IF
  2584     END-IF
  2585     .
  2586 4010-EXIT.
  2587     EXIT.
  2588 4012-ADD-BLINE2.
  2589     IF BLINE2L > ZEROS
  2590        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2591        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2592        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2593        MOVE PI-ACCT-STATE       TO WS-STATE
  2594        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2595        MOVE '2'                 TO WS-REC-TYPE
  2596        MOVE +2                  TO WS-SEQ-NO
  2597
  2598* EXEC CICS READ
  2599*          DATASET  ('ERACNT')
  2600*          INTO     (NOTE-FILE)
  2601*          RIDFLD   (WS-CONTROL-PRIMARY)
  2602*          RESP     (WS-RESPONSE)
  2603*       END-EXEC
  2604     MOVE LENGTH OF
  2605      NOTE-FILE
  2606       TO DFHEIV11
  2607     MOVE 'ERACNT' TO DFHEIV1
  2608*    MOVE '&"IL       E          (  N#00002095' TO DFHEIV0
  2609     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2610     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2611     MOVE X'204E233030303032303935' TO DFHEIV0(25:11)
  2612     CALL 'kxdfhei1' USING DFHEIV0,
  2613           DFHEIV1,
  2614           NOTE-FILE,
  2615           DFHEIV11,
  2616           WS-CONTROL-PRIMARY,
  2617           DFHEIV99,
  2618           DFHEIV99,
  2619           DFHEIV99
  2620     MOVE EIBRESP  TO WS-RESPONSE
  2621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2622        IF RESP-NOTFND
  2623           PERFORM 5010-BUILD-ERACNT
  2624                                 THRU 5010-EXIT
  2625           MOVE BLINE2I          TO NT-BRANCH-LOC-LINE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  48
* EL6503.cbl
  2626           PERFORM 5000-WRITE-ERACNT
  2627                                 THRU 5000-EXIT
  2628        END-IF
  2629     END-IF
  2630     .
  2631 4012-EXIT.
  2632     EXIT.
  2633 4014-ADD-SNAME1.
  2634     IF SNAME1L > ZEROS
  2635        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2636        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2637        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2638        MOVE PI-ACCT-STATE       TO WS-STATE
  2639        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2640        MOVE '3'                 TO WS-REC-TYPE
  2641        MOVE +1                  TO WS-SEQ-NO
  2642
  2643* EXEC CICS READ
  2644*          DATASET  ('ERACNT')
  2645*          INTO     (NOTE-FILE)
  2646*          RIDFLD   (WS-CONTROL-PRIMARY)
  2647*          RESP     (WS-RESPONSE)
  2648*       END-EXEC
  2649     MOVE LENGTH OF
  2650      NOTE-FILE
  2651       TO DFHEIV11
  2652     MOVE 'ERACNT' TO DFHEIV1
  2653*    MOVE '&"IL       E          (  N#00002121' TO DFHEIV0
  2654     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2655     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2656     MOVE X'204E233030303032313231' TO DFHEIV0(25:11)
  2657     CALL 'kxdfhei1' USING DFHEIV0,
  2658           DFHEIV1,
  2659           NOTE-FILE,
  2660           DFHEIV11,
  2661           WS-CONTROL-PRIMARY,
  2662           DFHEIV99,
  2663           DFHEIV99,
  2664           DFHEIV99
  2665     MOVE EIBRESP  TO WS-RESPONSE
  2666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2667        IF RESP-NOTFND
  2668           PERFORM 5010-BUILD-ERACNT
  2669                                 THRU 5010-EXIT
  2670           MOVE SNAME1I          TO NT-SHIPPING-LINE
  2671           PERFORM 5000-WRITE-ERACNT
  2672                                 THRU 5000-EXIT
  2673        END-IF
  2674     END-IF
  2675     .
  2676 4014-EXIT.
  2677     EXIT.
  2678 4016-ADD-SNAME2.
  2679     IF SNAME2L > ZEROS
  2680        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2681        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2682        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2683        MOVE PI-ACCT-STATE       TO WS-STATE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  49
* EL6503.cbl
  2684        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2685        MOVE '3'                 TO WS-REC-TYPE
  2686        MOVE +2                  TO WS-SEQ-NO
  2687
  2688* EXEC CICS READ
  2689*          DATASET  ('ERACNT')
  2690*          INTO     (NOTE-FILE)
  2691*          RIDFLD   (WS-CONTROL-PRIMARY)
  2692*          RESP     (WS-RESPONSE)
  2693*       END-EXEC
  2694     MOVE LENGTH OF
  2695      NOTE-FILE
  2696       TO DFHEIV11
  2697     MOVE 'ERACNT' TO DFHEIV1
  2698*    MOVE '&"IL       E          (  N#00002147' TO DFHEIV0
  2699     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2700     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2701     MOVE X'204E233030303032313437' TO DFHEIV0(25:11)
  2702     CALL 'kxdfhei1' USING DFHEIV0,
  2703           DFHEIV1,
  2704           NOTE-FILE,
  2705           DFHEIV11,
  2706           WS-CONTROL-PRIMARY,
  2707           DFHEIV99,
  2708           DFHEIV99,
  2709           DFHEIV99
  2710     MOVE EIBRESP  TO WS-RESPONSE
  2711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2712        IF RESP-NOTFND
  2713           PERFORM 5010-BUILD-ERACNT
  2714                                 THRU 5010-EXIT
  2715           MOVE SNAME2I          TO NT-SHIPPING-LINE
  2716           PERFORM 5000-WRITE-ERACNT
  2717                                 THRU 5000-EXIT
  2718        END-IF
  2719     END-IF
  2720     .
  2721 4016-EXIT.
  2722     EXIT.
  2723 4018-ADD-SADDR1.
  2724     IF SADDR1L > ZEROS
  2725        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2726        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2727        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2728        MOVE PI-ACCT-STATE       TO WS-STATE
  2729        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2730        MOVE '3'                 TO WS-REC-TYPE
  2731        MOVE +3                  TO WS-SEQ-NO
  2732
  2733* EXEC CICS READ
  2734*          DATASET  ('ERACNT')
  2735*          INTO     (NOTE-FILE)
  2736*          RIDFLD   (WS-CONTROL-PRIMARY)
  2737*          RESP     (WS-RESPONSE)
  2738*       END-EXEC
  2739     MOVE LENGTH OF
  2740      NOTE-FILE
  2741       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  50
* EL6503.cbl
  2742     MOVE 'ERACNT' TO DFHEIV1
  2743*    MOVE '&"IL       E          (  N#00002173' TO DFHEIV0
  2744     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2745     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2746     MOVE X'204E233030303032313733' TO DFHEIV0(25:11)
  2747     CALL 'kxdfhei1' USING DFHEIV0,
  2748           DFHEIV1,
  2749           NOTE-FILE,
  2750           DFHEIV11,
  2751           WS-CONTROL-PRIMARY,
  2752           DFHEIV99,
  2753           DFHEIV99,
  2754           DFHEIV99
  2755     MOVE EIBRESP  TO WS-RESPONSE
  2756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2757        IF RESP-NOTFND
  2758           PERFORM 5010-BUILD-ERACNT
  2759                                 THRU 5010-EXIT
  2760           MOVE SADDR1I          TO NT-SHIPPING-LINE
  2761           PERFORM 5000-WRITE-ERACNT
  2762                                 THRU 5000-EXIT
  2763        END-IF
  2764     END-IF
  2765     .
  2766 4018-EXIT.
  2767     EXIT.
  2768 4020-ADD-SADDR2.
  2769     IF SADDR2L > ZEROS
  2770        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2771        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2772        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2773        MOVE PI-ACCT-STATE       TO WS-STATE
  2774        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2775        MOVE '3'                 TO WS-REC-TYPE
  2776        MOVE +4                  TO WS-SEQ-NO
  2777
  2778* EXEC CICS READ
  2779*          DATASET  ('ERACNT')
  2780*          INTO     (NOTE-FILE)
  2781*          RIDFLD   (WS-CONTROL-PRIMARY)
  2782*          RESP     (WS-RESPONSE)
  2783*       END-EXEC
  2784     MOVE LENGTH OF
  2785      NOTE-FILE
  2786       TO DFHEIV11
  2787     MOVE 'ERACNT' TO DFHEIV1
  2788*    MOVE '&"IL       E          (  N#00002199' TO DFHEIV0
  2789     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2790     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2791     MOVE X'204E233030303032313939' TO DFHEIV0(25:11)
  2792     CALL 'kxdfhei1' USING DFHEIV0,
  2793           DFHEIV1,
  2794           NOTE-FILE,
  2795           DFHEIV11,
  2796           WS-CONTROL-PRIMARY,
  2797           DFHEIV99,
  2798           DFHEIV99,
  2799           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  51
* EL6503.cbl
  2800     MOVE EIBRESP  TO WS-RESPONSE
  2801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2802        IF RESP-NOTFND
  2803           PERFORM 5010-BUILD-ERACNT
  2804                                 THRU 5010-EXIT
  2805           MOVE SADDR2I          TO NT-SHIPPING-LINE
  2806           PERFORM 5000-WRITE-ERACNT
  2807                                 THRU 5000-EXIT
  2808        END-IF
  2809     END-IF
  2810    .
  2811 4020-EXIT.
  2812     EXIT.
  2813 4022-ADD-SADDR3.
  2814     IF SADDR3L    > ZEROS
  2815        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2816        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2817        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2818        MOVE PI-ACCT-STATE       TO WS-STATE
  2819        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2820        MOVE '3'                 TO WS-REC-TYPE
  2821        MOVE +5                  TO WS-SEQ-NO
  2822
  2823* EXEC CICS READ
  2824*          DATASET  ('ERACNT')
  2825*          INTO     (NOTE-FILE)
  2826*          RIDFLD   (WS-CONTROL-PRIMARY)
  2827*          RESP     (WS-RESPONSE)
  2828*       END-EXEC
  2829     MOVE LENGTH OF
  2830      NOTE-FILE
  2831       TO DFHEIV11
  2832     MOVE 'ERACNT' TO DFHEIV1
  2833*    MOVE '&"IL       E          (  N#00002225' TO DFHEIV0
  2834     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2835     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2836     MOVE X'204E233030303032323235' TO DFHEIV0(25:11)
  2837     CALL 'kxdfhei1' USING DFHEIV0,
  2838           DFHEIV1,
  2839           NOTE-FILE,
  2840           DFHEIV11,
  2841           WS-CONTROL-PRIMARY,
  2842           DFHEIV99,
  2843           DFHEIV99,
  2844           DFHEIV99
  2845     MOVE EIBRESP  TO WS-RESPONSE
  2846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2847        IF RESP-NOTFND
  2848           PERFORM 5010-BUILD-ERACNT
  2849                                 THRU 5010-EXIT
  2850           MOVE SADDR3I          TO NT-SHIPPING-LINE
  2851           PERFORM 5000-WRITE-ERACNT
  2852                                 THRU 5000-EXIT
  2853        END-IF
  2854     END-IF
  2855     .
  2856 4022-EXIT.
  2857     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  52
* EL6503.cbl
  2858 4024-ADD-SCITYSTZP.
  2859     IF (SCITYL     > ZEROS)
  2860        OR (SSTATEL > ZEROS)
  2861        OR (SZIPL   > ZEROS)
  2862        MOVE PI-COMPANY-CD       TO WS-COMPANY-CD
  2863        MOVE PI-ACCT-CARRIER     TO WS-CARRIER
  2864        MOVE PI-ACCT-GROUPING    TO WS-GROUPING
  2865        MOVE PI-ACCT-STATE       TO WS-STATE
  2866        MOVE PI-ACCT-ACCOUNT     TO WS-ACCOUNT
  2867        MOVE '3'                 TO WS-REC-TYPE
  2868        MOVE +6                  TO WS-SEQ-NO
  2869
  2870* EXEC CICS READ
  2871*          DATASET  ('ERACNT')
  2872*          INTO     (NOTE-FILE)
  2873*          RIDFLD   (WS-CONTROL-PRIMARY)
  2874*          RESP     (WS-RESPONSE)
  2875*       END-EXEC
  2876     MOVE LENGTH OF
  2877      NOTE-FILE
  2878       TO DFHEIV11
  2879     MOVE 'ERACNT' TO DFHEIV1
  2880*    MOVE '&"IL       E          (  N#00002253' TO DFHEIV0
  2881     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2882     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2883     MOVE X'204E233030303032323533' TO DFHEIV0(25:11)
  2884     CALL 'kxdfhei1' USING DFHEIV0,
  2885           DFHEIV1,
  2886           NOTE-FILE,
  2887           DFHEIV11,
  2888           WS-CONTROL-PRIMARY,
  2889           DFHEIV99,
  2890           DFHEIV99,
  2891           DFHEIV99
  2892     MOVE EIBRESP  TO WS-RESPONSE
  2893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2894        IF RESP-NOTFND
  2895           PERFORM 5010-BUILD-ERACNT
  2896                                 THRU 5010-EXIT
  2897           IF SCITYL > ZEROS
  2898              MOVE SCITYI        TO NT-SHIPPING-LINE
  2899           END-IF
  2900           IF SSTATEL > ZEROS
  2901              MOVE SSTATEI       TO NT-SHIP-STATE
  2902           END-IF
  2903           IF SZIPL > ZEROS
  2904              MOVE SZIPI         TO NT-SHIP-ZIP
  2905           END-IF
  2906           PERFORM 5000-WRITE-ERACNT
  2907                                 THRU 5000-EXIT
  2908        END-IF
  2909     END-IF
  2910     .
  2911 4024-EXIT.
  2912     EXIT.
  2913 5000-WRITE-ERACNT.
  2914     MOVE SAVE-BIN-DATE          TO NT-LAST-MAINT-DT
  2915     MOVE EIBTIME                TO NT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  53
* EL6503.cbl
  2916     MOVE PI-PROCESSOR-ID        TO NT-LAST-MAINT-BY
  2917
  2918* EXEC CICS WRITE
  2919*         FROM    (NOTE-FILE)
  2920*         DATASET ('ERACNT')
  2921*         RIDFLD  (WS-CONTROL-PRIMARY)
  2922*         RESP    (WS-RESPONSE)
  2923*    END-EXEC
  2924     MOVE LENGTH OF
  2925      NOTE-FILE
  2926       TO DFHEIV11
  2927     MOVE 'ERACNT' TO DFHEIV1
  2928*    MOVE '&$ L                  ''  N#00002282' TO DFHEIV0
  2929     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2930     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2931     MOVE X'204E233030303032323832' TO DFHEIV0(25:11)
  2932     CALL 'kxdfhei1' USING DFHEIV0,
  2933           DFHEIV1,
  2934           NOTE-FILE,
  2935           DFHEIV11,
  2936           WS-CONTROL-PRIMARY,
  2937           DFHEIV99,
  2938           DFHEIV99
  2939     MOVE EIBRESP  TO WS-RESPONSE
  2940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2941     .
  2942 5000-EXIT.
  2943     EXIT.
  2944 5010-BUILD-ERACNT.
  2945     MOVE SPACES                 TO NOTE-FILE
  2946     MOVE 'NT'                   TO NT-FILE-ID
  2947     MOVE WS-CONTROL-PRIMARY     TO NT-CONTROL-PRIMARY
  2948     MOVE SAVE-BIN-DATE          TO NT-LAST-MAINT-DT
  2949     MOVE EIBTIME                TO NT-LAST-MAINT-HHMMSS
  2950     MOVE PI-PROCESSOR-ID        TO NT-LAST-MAINT-BY
  2951     .
  2952 5010-EXIT.
  2953     EXIT.
  2954 5020-REWRITE-ERACNT.
  2955     MOVE SAVE-BIN-DATE          TO NT-LAST-MAINT-DT
  2956     MOVE EIBTIME                TO NT-LAST-MAINT-HHMMSS
  2957     MOVE PI-PROCESSOR-ID        TO NT-LAST-MAINT-BY
  2958
  2959* EXEC CICS REWRITE
  2960*         FROM    (NOTE-FILE)
  2961*         DATASET ('ERACNT')
  2962*         RESP    (WS-RESPONSE)
  2963*    END-EXEC
  2964     MOVE LENGTH OF
  2965      NOTE-FILE
  2966       TO DFHEIV11
  2967     MOVE 'ERACNT' TO DFHEIV1
  2968*    MOVE '&& L                  %  N#00002305' TO DFHEIV0
  2969     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2970     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2971     MOVE X'204E233030303032333035' TO DFHEIV0(25:11)
  2972     CALL 'kxdfhei1' USING DFHEIV0,
  2973           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  54
* EL6503.cbl
  2974           NOTE-FILE,
  2975           DFHEIV11,
  2976           DFHEIV99
  2977     MOVE EIBRESP  TO WS-RESPONSE
  2978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2979     .
  2980 5020-EXIT.
  2981     EXIT.
  2982 8100-SEND-INITIAL-MAP.
  2983     MOVE -1                     TO  MAINTYPL
  2984     MOVE SAVE-DATE              TO  RUNDATEO
  2985     MOVE EIBTIME                TO  TIME-IN
  2986     MOVE TIME-OUT               TO  RUNTIMEO
  2987     IF EMI-ERROR NOT = ZERO
  2988         PERFORM 9900-ERROR-FORMAT
  2989     END-IF
  2990     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  2991
  2992* EXEC CICS SEND
  2993*        FROM   (EL6503AO)
  2994*        MAPSET (WS-MAPSET-NAME)
  2995*        MAP    (WS-MAP-NAME)
  2996*        CURSOR ERASE
  2997*    END-EXEC.
  2998     MOVE LENGTH OF
  2999      EL6503AO
  3000       TO DFHEIV12
  3001     MOVE -1
  3002       TO DFHEIV11
  3003*    MOVE '8$     CT  E    H L F ,   #00002322' TO DFHEIV0
  3004     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3005     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3006     MOVE X'2020233030303032333232' TO DFHEIV0(25:11)
  3007     CALL 'kxdfhei1' USING DFHEIV0,
  3008           WS-MAP-NAME,
  3009           EL6503AO,
  3010           DFHEIV12,
  3011           WS-MAPSET-NAME,
  3012           DFHEIV99,
  3013           DFHEIV99,
  3014           DFHEIV99,
  3015           DFHEIV11,
  3016           DFHEIV99,
  3017           DFHEIV99,
  3018           DFHEIV99
  3019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3020
  3021     GO TO 9100-RETURN-TRAN
  3022     .
  3023 8100-EXIT.
  3024      EXIT.
  3025 8200-SEND-DATAONLY.
  3026     MOVE SAVE-DATE              TO  RUNDATEO
  3027     MOVE EIBTIME                TO  TIME-IN
  3028     MOVE TIME-OUT               TO  RUNTIMEO
  3029     IF EMI-ERROR NOT = ZERO
  3030        PERFORM 9900-ERROR-FORMAT
  3031     END-IF
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  55
* EL6503.cbl
  3032     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  3033
  3034* EXEC CICS SEND DATAONLY
  3035*        FROM   (EL6503AO)
  3036*        MAPSET (WS-MAPSET-NAME)
  3037*        MAP    (WS-MAP-NAME)
  3038*        CURSOR
  3039*    END-EXEC.
  3040     MOVE LENGTH OF
  3041      EL6503AO
  3042       TO DFHEIV12
  3043     MOVE -1
  3044       TO DFHEIV11
  3045*    MOVE '8$D    CT       H L F ,   #00002340' TO DFHEIV0
  3046     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3047     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3048     MOVE X'2020233030303032333430' TO DFHEIV0(25:11)
  3049     CALL 'kxdfhei1' USING DFHEIV0,
  3050           WS-MAP-NAME,
  3051           EL6503AO,
  3052           DFHEIV12,
  3053           WS-MAPSET-NAME,
  3054           DFHEIV99,
  3055           DFHEIV99,
  3056           DFHEIV99,
  3057           DFHEIV11,
  3058           DFHEIV99,
  3059           DFHEIV99,
  3060           DFHEIV99
  3061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3062
  3063     GO TO 9100-RETURN-TRAN
  3064     .
  3065 8200-EXIT.
  3066      EXIT.
  3067 8300-SEND-TEXT.
  3068
  3069* EXEC CICS SEND TEXT
  3070*        FROM   (LOGOFF-TEXT)
  3071*        LENGTH (LOGOFF-LENGTH)
  3072*        ERASE  FREEKB
  3073*    END-EXEC.
  3074*    MOVE '8&      T  E F  H   F -   #00002351' TO DFHEIV0
  3075     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3076     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3077     MOVE X'2020233030303032333531' TO DFHEIV0(25:11)
  3078     CALL 'kxdfhei1' USING DFHEIV0,
  3079           LOGOFF-TEXT,
  3080           LOGOFF-LENGTH,
  3081           DFHEIV99,
  3082           DFHEIV99,
  3083           DFHEIV99,
  3084           DFHEIV99,
  3085           DFHEIV99,
  3086           DFHEIV99,
  3087           DFHEIV99,
  3088           DFHEIV99,
  3089           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  56
* EL6503.cbl
  3090           DFHEIV99
  3091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3092
  3093
  3094* EXEC CICS RETURN
  3095*    END-EXEC.
  3096*    MOVE '.(                    ''   #00002356' TO DFHEIV0
  3097     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3098     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3099     MOVE X'2020233030303032333536' TO DFHEIV0(25:11)
  3100     CALL 'kxdfhei1' USING DFHEIV0,
  3101           DFHEIV99,
  3102           DFHEIV99,
  3103           DFHEIV99,
  3104           DFHEIV99,
  3105           DFHEIV99,
  3106           DFHEIV99
  3107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3108
  3109 8300-EXIT.
  3110      EXIT.
  3111 8400-LOG-JOURNAL-RECORD.
  3112     IF PI-JOURNAL-FILE-ID = 0
  3113        GO TO 8400-EXIT
  3114     END-IF
  3115     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  3116     MOVE 'ELCNTL'               TO  JP-FILE-ID.
  3117     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  3118*    EXEC CICS JOURNAL
  3119*        JFILEID (PI-JOURNAL-FILE-ID)
  3120*        JTYPEID (WS-JOURNAL-TYPE-ID)
  3121*        FROM    (JOURNAL-RECORD)
  3122*        LENGTH  (WS-JOURNAL-RECORD-LENGTH)
  3123*    END-EXEC.
  3124 8400-EXIT.
  3125      EXIT.
  3126 8500-DATE-CONVERSION.
  3127
  3128* EXEC CICS LINK
  3129*        PROGRAM  ('ELDATCV')
  3130*        COMMAREA (DATE-CONVERSION-DATA)
  3131*        LENGTH   (DC-COMM-LENGTH)
  3132*    END-EXEC.
  3133     MOVE 'ELDATCV' TO DFHEIV1
  3134*    MOVE '."C                   (   #00002376' TO DFHEIV0
  3135     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3136     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3137     MOVE X'2020233030303032333736' TO DFHEIV0(25:11)
  3138     CALL 'kxdfhei1' USING DFHEIV0,
  3139           DFHEIV1,
  3140           DATE-CONVERSION-DATA,
  3141           DC-COMM-LENGTH,
  3142           DFHEIV99,
  3143           DFHEIV99,
  3144           DFHEIV99,
  3145           DFHEIV99
  3146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3147
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  57
* EL6503.cbl
  3148 8500-EXIT.
  3149      EXIT.
  3150 9000-RETURN-CICS.
  3151     MOVE 'EL005'                TO  THIS-PGM.
  3152     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  3153     PERFORM 9300-XCTL.
  3154 9000-EXIT.
  3155      EXIT.
  3156 9100-RETURN-TRAN.
  3157     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  3158     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  3159
  3160* EXEC CICS RETURN
  3161*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3162*        LENGTH   (PI-COMM-LENGTH)
  3163*        TRANSID  (WS-TRANS-ID)
  3164*    END-EXEC.
  3165*    MOVE '.(CT                  ''   #00002392' TO DFHEIV0
  3166     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3167     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3168     MOVE X'2020233030303032333932' TO DFHEIV0(25:11)
  3169     CALL 'kxdfhei1' USING DFHEIV0,
  3170           WS-TRANS-ID,
  3171           PROGRAM-INTERFACE-BLOCK,
  3172           PI-COMM-LENGTH,
  3173           DFHEIV99,
  3174           DFHEIV99,
  3175           DFHEIV99
  3176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3177
  3178 9100-EXIT.
  3179      EXIT.
  3180*****************************************************************
  3181 9300-XCTL.
  3182*****************************************************************
  3183     MOVE DFHENTER               TO  EIBAID.
  3184
  3185* EXEC CICS XCTL
  3186*        PROGRAM  (THIS-PGM)
  3187*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3188*        LENGTH   (PI-COMM-LENGTH)
  3189*    END-EXEC.
  3190*    MOVE '.$C                   %   #00002403' TO DFHEIV0
  3191     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3192     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3193     MOVE X'2020233030303032343033' TO DFHEIV0(25:11)
  3194     CALL 'kxdfhei1' USING DFHEIV0,
  3195           THIS-PGM,
  3196           PROGRAM-INTERFACE-BLOCK,
  3197           PI-COMM-LENGTH,
  3198           DFHEIV99
  3199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3200
  3201 9300-EXIT.
  3202      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  58
* EL6503.cbl
  3204*****************************************************************
  3205 9400-CLEAR.
  3206*****************************************************************
  3207     MOVE PI-RETURN-TO-PROGRAM   TO THIS-PGM
  3208     PERFORM 9300-XCTL
  3209     .
  3210 9400-EXIT.
  3211      EXIT.
  3212*****************************************************************
  3213 9600-PGMIDERR.
  3214*****************************************************************
  3215
  3216* EXEC CICS HANDLE CONDITION
  3217*        PGMIDERR (8300-SEND-TEXT)
  3218*    END-EXEC.
  3219*    MOVE '"$L                   ! # #00002422' TO DFHEIV0
  3220     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3221     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3222     MOVE X'2320233030303032343232' TO DFHEIV0(25:11)
  3223     CALL 'kxdfhei1' USING DFHEIV0
  3224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3225
  3226     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM
  3227                                     LOGOFF-PGM.
  3228     MOVE 'EL005'                TO  THIS-PGM.
  3229     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  3230     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  3231     PERFORM 9300-XCTL.
  3232 9600-EXIT.
  3233      EXIT.
  3234*****************************************************************
  3235 9900-ERROR-FORMAT.
  3236*****************************************************************
  3237     IF EMI-ERRORS-COMPLETE
  3238         ADD +1             TO  EMI-FATAL-CTR
  3239         MOVE ZERO          TO  EMI-ERROR
  3240         GO TO 9900-EXIT.
  3241
  3242* EXEC CICS LINK
  3243*        PROGRAM  ('EL001')
  3244*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  3245*        LENGTH   (EMI-COMM-LENGTH)
  3246*    END-EXEC.
  3247     MOVE 'EL001' TO DFHEIV1
  3248*    MOVE '."C                   (   #00002440' TO DFHEIV0
  3249     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3250     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3251     MOVE X'2020233030303032343430' TO DFHEIV0(25:11)
  3252     CALL 'kxdfhei1' USING DFHEIV0,
  3253           DFHEIV1,
  3254           ERROR-MESSAGE-INTERFACE-BLOCK,
  3255           EMI-COMM-LENGTH,
  3256           DFHEIV99,
  3257           DFHEIV99,
  3258           DFHEIV99,
  3259           DFHEIV99
  3260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3261
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  59
* EL6503.cbl
  3262     MOVE ZERO              TO  EMI-ERROR.
  3263 9900-EXIT.
  3264      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  60
* EL6503.cbl
  3266*****************************************************************
  3267 9990-ERROR.
  3268*****************************************************************
  3269     MOVE DFHEIBLK               TO EMI-LINE1.
  3270
  3271* EXEC CICS LINK
  3272*        PROGRAM   ('EL004')
  3273*        COMMAREA  (EMI-LINE1)
  3274*        LENGTH    (72)
  3275*    END-EXEC.
  3276     MOVE 'EL004' TO DFHEIV1
  3277     MOVE 72
  3278       TO DFHEIV11
  3279*    MOVE '."C                   (   #00002453' TO DFHEIV0
  3280     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3281     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3282     MOVE X'2020233030303032343533' TO DFHEIV0(25:11)
  3283     CALL 'kxdfhei1' USING DFHEIV0,
  3284           DFHEIV1,
  3285           EMI-LINE1,
  3286           DFHEIV11,
  3287           DFHEIV99,
  3288           DFHEIV99,
  3289           DFHEIV99,
  3290           DFHEIV99
  3291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3292
  3293     PERFORM 8200-SEND-DATAONLY.
  3294     GO TO 9100-RETURN-TRAN.
  3295 9990-EXIT.
  3296      EXIT.
  3297*****************************************************************
  3298 9995-SECURITY-VIOLATION.
  3299*****************************************************************
  3300*           COPY ELCSCTP.
  3301******************************************************************
  3302*                                                                *
  3303*                            ELCSCTP                             *
  3304*                            VMOD=2.001                          *
  3305*                                                                *
  3306*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3307******************************************************************
  3308
  3309
  3310     MOVE EIBDATE          TO SM-JUL-DATE.
  3311     MOVE EIBTRMID         TO SM-TERMID.
  3312     MOVE THIS-PGM         TO SM-PGM.
  3313     MOVE EIBTIME          TO TIME-IN.
  3314     MOVE TIME-OUT         TO SM-TIME.
  3315     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3316
  3317
  3318* EXEC CICS LINK
  3319*         PROGRAM  ('EL003')
  3320*         COMMAREA (SECURITY-MESSAGE)
  3321*         LENGTH   (80)
  3322*    END-EXEC.
  3323     MOVE 'EL003' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  61
* EL6503.cbl
  3324     MOVE 80
  3325       TO DFHEIV11
  3326*    MOVE '."C                   (   #00002482' TO DFHEIV0
  3327     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3329     MOVE X'2020233030303032343832' TO DFHEIV0(25:11)
  3330     CALL 'kxdfhei1' USING DFHEIV0,
  3331           DFHEIV1,
  3332           SECURITY-MESSAGE,
  3333           DFHEIV11,
  3334           DFHEIV99,
  3335           DFHEIV99,
  3336           DFHEIV99,
  3337           DFHEIV99
  3338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3339
  3340
  3341******************************************************************
  3342
  3343 9995-EXIT.
  3344      EXIT.
  3345 9999-LAST-PARAGRAPH.
  3346
  3347* GOBACK.
  3348     MOVE '9%                    "   ' TO DFHEIV0
  3349     MOVE 'EL6503' TO DFHEIV1
  3350     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3351     GOBACK.
  3352
  3353 9999-DFHBACK SECTION.
  3354     MOVE '9%                    "   ' TO DFHEIV0
  3355     MOVE 'EL6503' TO DFHEIV1
  3356     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3357     GOBACK.
  3358 9999-DFHEXIT.
  3359     IF DFHEIGDJ EQUAL 0001
  3360         NEXT SENTENCE
  3361     ELSE IF DFHEIGDJ EQUAL 2
  3362         GO TO 9600-PGMIDERR,
  3363               9990-ERROR
  3364         DEPENDING ON DFHEIGDI
  3365     ELSE IF DFHEIGDJ EQUAL 3
  3366         GO TO 8300-SEND-TEXT
  3367         DEPENDING ON DFHEIGDI.
  3368     MOVE '9%                    "   ' TO DFHEIV0
  3369     MOVE 'EL6503' TO DFHEIV1
  3370     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3371     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5220     Code:       10693
