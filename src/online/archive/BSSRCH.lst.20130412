* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page   1
* BSSRCH.cbl
* Options: int("BSSRCH.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("BSSRCH.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"BSSRCH.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"BSSRCH.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2013 by Central States Health and Life          *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. BSSRCH.
     9*
    10*AUTHOR.    Pablo.
    11*           Colleyville, TEXAS.
    12********************************************
    13*   Balance sheet for month end balancing
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page   2
* BSSRCH.cbl
    14********************************************
    15 environment division.
    16 INPUT-OUTPUT SECTION.
    17 FILE-CONTROL.
    18 SELECT CID-ECS010-IN ASSIGN TO
    19    '/data/seqfiles/cilgm15.ECS010.ME50.BAL.AMTS'
    20    FILE STATUS IS ECS010-STATUS.
    21 SELECT AHL-ECS010-IN ASSIGN TO
    22    '/data/seqfiles/ahlgm15.ECS010.ME50.BAL.AMTS'
    23    FILE STATUS IS ECS010-STATUS.
    24 SELECT DCC-ECS010-IN ASSIGN TO
    25    '/data/seqfiles/cidclgm15.ECS010.ME50.BAL.AMTS'
    26    FILE STATUS IS ECS010-STATUS.
    27 SELECT CID-CHKPOINT-OUT ASSIGN TO
    28    '/data/test/mdoff/seqfiles/cidmechkpts.txt'
    29    FILE STATUS IS CHKPNT-STATUS
    30                            ORGANIZATION IS LINE SEQUENTIAL.
    31 SELECT ahl-CHKPOINT-OUT ASSIGN TO
    32   '/data/test/mdoff/seqfiles/ahlmechkpts.txt'
    33*   '/data/test/mdoff/seqfiles/a1.txt'
    34    FILE STATUS IS CHKPNT-STATUS
    35                            ORGANIZATION IS LINE SEQUENTIAL.
    36 SELECT dcc-CHKPOINT-OUT ASSIGN TO
    37    '/data/test/mdoff/seqfiles/dccmechkpts.txt'
    38    FILE STATUS IS CHKPNT-STATUS
    39                            ORGANIZATION IS LINE SEQUENTIAL.
    40 data division.
    41 FILE SECTION.
    42 FD  CID-ECS010-IN
    43     BLOCK CONTAINS 0
    44     RECORDING MODE F.
    45 01  CID-ECS010-IN-REC           pic x(94).
    46 FD  AHL-ECS010-IN
    47     BLOCK CONTAINS 0
    48     RECORDING MODE F.
    49 01  AHL-ECS010-IN-REC           pic x(94).
    50 FD  DCC-ECS010-IN
    51     BLOCK CONTAINS 0
    52     RECORDING MODE F.
    53 01  DCC-ECS010-IN-REC           pic x(94).
    54 FD  cid-CHKPOINT-OUT
    55     BLOCK CONTAINS 0
    56     RECORDING MODE F.
    57 01  cid-CHKPOINT-OUT-REC        pic x(94).
    58 FD  ahl-CHKPOINT-OUT
    59     BLOCK CONTAINS 0
    60     RECORDING MODE F.
    61 01  ahl-CHKPOINT-OUT-REC        pic x(94).
    62 FD  dcc-CHKPOINT-OUT
    63     BLOCK CONTAINS 0
    64     RECORDING MODE F.
    65 01  dcc-CHKPOINT-OUT-REC        pic x(94).
    66 working-storage section.
    67 01  DFH-START PIC X(04).
    68 77  s1 pic s999 comp-3 value +0.
    69 77  s2 pic s999 comp-3 value +0.
    70 77  ws-pass-amount              pic s9(11) comp-3 value +0.
    71 77  ws-low-amount               pic s9(11) value zeros.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page   3
* BSSRCH.cbl
    72 77  ws-hi-amount                pic s9(11) value zeros.
    73************************************************
    74* commarea passed to the business logic
    75************************************************
    76 01  srch-commarea.
    77*                                copy BSSRCH-COMMAREA.
    78*****************************************************************
    79*                                                               *
    80* Copyright (c) 2013 by CSO.                                    *
    81* All rights reserved.                                          *
    82*                                                               *
    83*****************************************************************
    84****************************************
    85*  commarea for QUERY by eom date and company id
    86*  (business logic input & output)
    87****************************************
    88     03  bl-input.
    89         05  bl-input-eom-date   pic x(10).
    90         05  bl-input-comp-id    pic xxx.
    91         05  bl-input-lo-resv    pic 9(9).
    92         05  bl-input-hi-resv    pic 9(9).
    93         05  bl-input-bld-file   pic xxx.
    94     03  bl-output.
    95         05  bl-status           pic x.
    96             88  bl-ok                 value "p".
    97             88  bl-fail               value "f".
    98         05  bl-output-message   pic x(50).
    99         05  bl-output-record.
   100            07  bl-out-company-name
   101                                 pic x(30).
   102            07  bl-out-formated-date
   103                                 pic x(20).
   104            07  filler occurs 3.
   105                09  bl-out-lf-prem  pic s9(9)v99 comp-3 value +0.
   106                09  bl-out-ah-prem  pic s9(9)v99 comp-3 value +0.
   107                09  bl-out-lf-ref   pic s9(9)v99 comp-3 value +0.
   108                09  bl-out-ah-ref   pic s9(9)v99 comp-3 value +0.
   109                09  bl-out-lf-net   pic s9(9)v99 comp-3 value +0.
   110                09  bl-out-ah-net   pic s9(9)v99 comp-3 value +0.
   111                09  bl-out-lf-iss-com
   112                                    pic s9(9)v99 comp-3 value +0.
   113                09  bl-out-ah-iss-com
   114                                    pic s9(9)v99 comp-3 value +0.
   115                09  bl-out-lf-ref-com
   116                                    pic s9(9)v99 comp-3 value +0.
   117                09  bl-out-ah-ref-com
   118                                    pic s9(9)v99 comp-3 value +0.
   119                09  bl-out-lf-net-com
   120                                    pic s9(9)v99 comp-3 value +0.
   121                09  bl-out-ah-net-com
   122                                    pic s9(9)v99 comp-3 value +0.
   123                09  bl-out-iss-com  pic s9(9)v99 comp-3 value +0.
   124                09  bl-out-ref-com  pic s9(9)v99 comp-3 value +0.
   125                09  bl-out-net-com  pic s9(9)v99 comp-3 value +0.
   126                09  bl-out-iss-cnt  pic s9(9)    comp-3 value +0.
   127                09  bl-out-can-cnt  pic s9(9)    comp-3 value +0.
   128                09  bl-out-net-cnt  pic s9(9)    comp-3 value +0.
   129                09  bl-out-tot-prm  pic s9(9)v99 comp-3 value +0.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page   4
* BSSRCH.cbl
   130                09  bl-out-tot-ref  pic s9(9)v99 comp-3 value +0.
   131                09  bl-out-net-tot  pic s9(9)v99 comp-3 value +0.
   132            07  bl-out-cm-cnt    pic s9(9)     comp-3 value +0.
   133            07  bl-out-lf-clms-pd
   134                                 pic s9(9)v99  comp-3 value +0.
   135            07  bl-out-lf-clms-void
   136                                 pic s9(9)v99  comp-3 value +0.
   137            07  bl-out-lf-tot-clms
   138                                 pic s9(9)v99  comp-3 value +0.
   139            07  bl-out-ah-clms-pd
   140                                 pic s9(9)v99  comp-3 value +0.
   141            07  bl-out-ah-clms-void
   142                                 pic s9(9)v99  comp-3 value +0.
   143            07  bl-out-ah-tot-clms
   144                                 pic s9(9)v99  comp-3 value +0.
   145            07  bl-out-clms-pd   pic s9(9)v99  comp-3 value +0.
   146            07  bl-out-clms-void pic s9(9)v99  comp-3 value +0.
   147            07  bl-out-tot-clms  pic s9(9)v99  comp-3 value +0.
   148            07  bl-out-lf-clms-cur
   149                                 pic s9(9)v99  comp-3 value +0.
   150            07  bl-out-ah-clms-cur
   151                                 pic s9(9)v99  comp-3 value +0.
   152            07  bl-out-tot-clms-cur
   153                                 pic s9(9)v99  comp-3 value +0.
   154*                                copy ELCFUNDT.
   155*****************************************************************
   156*                                                               *
   157*                            ELCFUNDT.                          *
   158*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   159*                            VMOD=2.001                         *
   160*                                                               *
   161*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   162*                                                               *
   163*****************************************************************
   164
   165
   166 01  FUNCTION-DATE.
   167     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   168     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   169         10  WS-FN-CCYR            PIC 9(4).
   170         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   171             15  WS-FN-CC          PIC 99.
   172             15  WS-FN-YR          PIC 99.
   173         10  WS-FN-MO              PIC 99.
   174         10  WS-FN-DA              PIC 99.
   175     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   176     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   177     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   178     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   179     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   180         88  WS-BEHIND-GMT                     VALUE '-'.
   181         88  WS-AFTER-GMT                      VALUE '+'.
   182         88  WS-NO-GMT                         VALUE ZERO.
   183     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   184     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   185*                                COPY ELCDATE.
   186******************************************************************
   187*                                                                *
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page   5
* BSSRCH.cbl
   188*                                                                *
   189*                            ELCDATE.                            *
   190*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   191*                            VMOD=2.003
   192*                                                                *
   193*                                                                *
   194*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   195*                 LENGTH = 200                                   *
   196******************************************************************
   197
   198 01  DATE-CONVERSION-DATA.
   199     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   200     12  DC-OPTION-CODE                PIC X.
   201         88  BIN-TO-GREG                VALUE ' '.
   202         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   203         88  EDIT-GREG-TO-BIN           VALUE '2'.
   204         88  YMD-GREG-TO-BIN            VALUE '3'.
   205         88  MDY-GREG-TO-BIN            VALUE '4'.
   206         88  JULIAN-TO-BIN              VALUE '5'.
   207         88  BIN-PLUS-ELAPSED           VALUE '6'.
   208         88  FIND-CENTURY               VALUE '7'.
   209         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   210         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   211         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   212         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   213         88  JULIAN-TO-BIN-3            VALUE 'C'.
   214         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   215         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   216         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   217         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   218         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   219         88  CHECK-LEAP-YEAR            VALUE 'H'.
   220         88  BIN-3-TO-GREG              VALUE 'I'.
   221         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   222         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   223         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   224         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   225         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   226         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   227         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   228         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   229         88  THREE-CHARACTER-BIN
   230                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   231         88  GREGORIAN-TO-BIN
   232                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   233         88  BIN-TO-GREGORIAN
   234                  VALUES ' ' '1' 'I' '8' 'G'.
   235         88  JULIAN-TO-BINARY
   236                  VALUES '5' 'C' 'E' 'F'.
   237     12  DC-ERROR-CODE                 PIC X.
   238         88  NO-CONVERSION-ERROR        VALUE ' '.
   239         88  DATE-CONVERSION-ERROR
   240                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   241         88  DATE-IS-ZERO               VALUE '1'.
   242         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   243         88  DATE-IS-INVALID            VALUE '3'.
   244         88  DATE1-GREATER-DATE2        VALUE '4'.
   245         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page   6
* BSSRCH.cbl
   246         88  DATE-INVALID-OPTION        VALUE '9'.
   247         88  INVALID-CENTURY            VALUE 'A'.
   248         88  ONLY-CENTURY               VALUE 'B'.
   249         88  ONLY-LEAP-YEAR             VALUE 'C'.
   250         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   251     12  DC-END-OF-MONTH               PIC X.
   252         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   253     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   254         88  USE-NORMAL-PROCESS         VALUE ' '.
   255         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   256         88  ADJUST-UP-100-YRS          VALUE '2'.
   257     12  FILLER                        PIC X.
   258     12  DC-CONVERSION-DATES.
   259         16  DC-BIN-DATE-1             PIC XX.
   260         16  DC-BIN-DATE-2             PIC XX.
   261         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   262         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   263                       DC-GREG-DATE-1-EDIT.
   264             20  DC-EDIT1-MONTH        PIC 99.
   265             20  SLASH1-1              PIC X.
   266             20  DC-EDIT1-DAY          PIC 99.
   267             20  SLASH1-2              PIC X.
   268             20  DC-EDIT1-YEAR         PIC 99.
   269         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   270         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   271                     DC-GREG-DATE-2-EDIT.
   272             20  DC-EDIT2-MONTH        PIC 99.
   273             20  SLASH2-1              PIC X.
   274             20  DC-EDIT2-DAY          PIC 99.
   275             20  SLASH2-2              PIC X.
   276             20  DC-EDIT2-YEAR         PIC 99.
   277         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   278         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   279                     DC-GREG-DATE-1-YMD.
   280             20  DC-YMD-YEAR           PIC 99.
   281             20  DC-YMD-MONTH          PIC 99.
   282             20  DC-YMD-DAY            PIC 99.
   283         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   284         16  DC-GREG-DATE-1-MDY-R REDEFINES
   285                      DC-GREG-DATE-1-MDY.
   286             20  DC-MDY-MONTH          PIC 99.
   287             20  DC-MDY-DAY            PIC 99.
   288             20  DC-MDY-YEAR           PIC 99.
   289         16  DC-GREG-DATE-1-ALPHA.
   290             20  DC-ALPHA-MONTH        PIC X(10).
   291             20  DC-ALPHA-DAY          PIC 99.
   292             20  FILLER                PIC XX.
   293             20  DC-ALPHA-CENTURY.
   294                 24 DC-ALPHA-CEN-N     PIC 99.
   295             20  DC-ALPHA-YEAR         PIC 99.
   296         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   297         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   298         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   299         16  DC-JULIAN-DATE            PIC 9(05).
   300         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   301                                       PIC 9(05).
   302         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   303             20  DC-JULIAN-YEAR        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page   7
* BSSRCH.cbl
   304             20  DC-JULIAN-DAYS        PIC 999.
   305         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   306         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   307         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   308     12  DATE-CONVERSION-VARIBLES.
   309         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   310         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   311             20  FILLER                PIC 9(3).
   312             20  HOLD-CEN-1-CCYY.
   313                 24  HOLD-CEN-1-CC     PIC 99.
   314                 24  HOLD-CEN-1-YY     PIC 99.
   315             20  HOLD-CEN-1-MO         PIC 99.
   316             20  HOLD-CEN-1-DA         PIC 99.
   317         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   318             20  HOLD-CEN-1-R-MO       PIC 99.
   319             20  HOLD-CEN-1-R-DA       PIC 99.
   320             20  HOLD-CEN-1-R-CCYY.
   321                 24  HOLD-CEN-1-R-CC   PIC 99.
   322                 24  HOLD-CEN-1-R-YY   PIC 99.
   323             20  FILLER                PIC 9(3).
   324         16  HOLD-CENTURY-1-X.
   325             20  FILLER                PIC X(3)  VALUE SPACES.
   326             20  HOLD-CEN-1-X-CCYY.
   327                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   328                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   329             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   330             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   331         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   332             20  HOLD-CEN-1-R-X-MO     PIC XX.
   333             20  HOLD-CEN-1-R-X-DA     PIC XX.
   334             20  HOLD-CEN-1-R-X-CCYY.
   335                 24  HOLD-CEN-1-R-X-CC PIC XX.
   336                 24  HOLD-CEN-1-R-X-YY PIC XX.
   337             20  FILLER                PIC XXX.
   338         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   339         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   340         16  DC-JULIAN-DATE-1          PIC 9(07).
   341         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   342             20  DC-JULIAN-1-CCYY.
   343                 24  DC-JULIAN-1-CC    PIC 99.
   344                 24  DC-JULIAN-1-YR    PIC 99.
   345             20  DC-JULIAN-DA-1        PIC 999.
   346         16  DC-JULIAN-DATE-2          PIC 9(07).
   347         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   348             20  DC-JULIAN-2-CCYY.
   349                 24  DC-JULIAN-2-CC    PIC 99.
   350                 24  DC-JULIAN-2-YR    PIC 99.
   351             20  DC-JULIAN-DA-2        PIC 999.
   352         16  DC-GREG-DATE-A-EDIT.
   353             20  DC-EDITA-MONTH        PIC 99.
   354             20  SLASHA-1              PIC X VALUE '/'.
   355             20  DC-EDITA-DAY          PIC 99.
   356             20  SLASHA-2              PIC X VALUE '/'.
   357             20  DC-EDITA-CCYY.
   358                 24  DC-EDITA-CENT     PIC 99.
   359                 24  DC-EDITA-YEAR     PIC 99.
   360         16  DC-GREG-DATE-B-EDIT.
   361             20  DC-EDITB-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page   8
* BSSRCH.cbl
   362             20  SLASHB-1              PIC X VALUE '/'.
   363             20  DC-EDITB-DAY          PIC 99.
   364             20  SLASHB-2              PIC X VALUE '/'.
   365             20  DC-EDITB-CCYY.
   366                 24  DC-EDITB-CENT     PIC 99.
   367                 24  DC-EDITB-YEAR     PIC 99.
   368         16  DC-GREG-DATE-CYMD         PIC 9(08).
   369         16  DC-GREG-DATE-CYMD-R REDEFINES
   370                              DC-GREG-DATE-CYMD.
   371             20  DC-CYMD-CEN           PIC 99.
   372             20  DC-CYMD-YEAR          PIC 99.
   373             20  DC-CYMD-MONTH         PIC 99.
   374             20  DC-CYMD-DAY           PIC 99.
   375         16  DC-GREG-DATE-MDCY         PIC 9(08).
   376         16  DC-GREG-DATE-MDCY-R REDEFINES
   377                              DC-GREG-DATE-MDCY.
   378             20  DC-MDCY-MONTH         PIC 99.
   379             20  DC-MDCY-DAY           PIC 99.
   380             20  DC-MDCY-CEN           PIC 99.
   381             20  DC-MDCY-YEAR          PIC 99.
   382    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   383        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   384    12  DC-EL310-DATE                  PIC X(21).
   385    12  FILLER                         PIC X(28).
   386* 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   387*     'BEGINJOB mode=''MVS'''.
   388* 01  TRAN-DATA-LINE2             PIC X(80)    VALUE
   389*     'LABEL name=PERL1'.
   390* 01  TRAN-DATA-LINE3             PIC X(80)    VALUE
   391*     'ASSGNDD ddname=''SYSIN'' type=''INSTREAM''  << !'.
   392* 01  TRAN-DATA-LINE4             PIC X(80)    VALUE
   393*     'perl /export/home/pema/bin/bal_sheet_ss.pl $SEQFILES/a1.txt
   394*-    '$SEQFILES/a2.xlsx'
   395* 01  TRAN-DATA-LINE5             PIC X(80)    VALUE '!'.
   396* 01  TRAN-DATA-LINE6             PIC X(80)    VALUE
   397*    'EXECPGM pgmname=''BPXBATCH'' stepname=''PERL1'' parm=''SH'''
   398* 01  TRAN-DATA-LINE7             PIC X(80)    VALUE
   399*     'LABEL name=EMAIL'.
   400* 01  TRAN-DATA-LINE8             PIC X(80)    VALUE
   401*     'ASSGNDD ddname=''SYSIN'' type=''INSTREAM''  << !'.
   402* 01  TRAN-DATA-LINE9             PIC X(80)    VALUE
   403*     'mutt -s ''AHL chkpts'' -a $SEQFILES/ahlmechkpts.xlsx pema@c
   404*-    'o.com < /dev/null'.
   405* 01  TRAN-DATA-LINE10            PIC X(80)    VALUE '!'.
   406* 01  TRAN-DATA-LINE11            PIC X(80)    VALUE
   407*    'EXECPGM pgmname=''BPXBATCH'' stepname=''EMAIL'' parm=''SH'''
   408* 01  TRAN-DATA-LINE12            PIC X(80)    VALUE
   409*     'ENDJOB'.
   410 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   411     'cd /apps/test/mdoff/jcl'.
   412 01  TRAN-DATA-LINE2.
   413     05  filler                  pic x(10) value 'unikixjob '.
   414     05  tran-comp-id            pic xxx   value '   '.
   415     05  filler                 pic x(15) value 'chkpts -k mdoff'.
   416     05  filler                  pic x(52) value spaces.
   417 01  ECS010-IN-REC.
   418     05  filler                  pic x(21).
   419     05  ecs010-cert-cnt         pic x(11).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page   9
* BSSRCH.cbl
   420     05  filler                  pic x(62).
   421 01  cpo-out-record.
   422     05  cpo-jobname             pic x(10)  value spaces.
   423     05  f                       pic x value ';'.
   424     05  cpo-stepname            pic x(6)   value spaces.
   425     05  f                       pic x value ';'.
   426     05  cpo-low-amount          pic -9(9)  value zeros.
   427     05  f                       pic x value ';'.
   428     05  cpo-hi-amount           pic -9(9)  value zeros.
   429     05  f                       pic x value ';'.
   430     05  cpo-desc                pic x(50)  value spaces.
   431 01  ahl-table.
   432     05 f                        pic x(68) value
   433         'AHLGM10   ;EL524 ;Total Claims Paid
   434-        '            '.
   435     05 f                        pic x(68) value
   436         'AHLGM10   ;EL523 ;Processable Written & Outstanding Bala
   437-        'nce         '.
   438     05 f                        pic x(68) value
   439         'AHLGM10   ;EL523 ;Non-Processable Written & Outstanding
   440-        'Balance     '.
   441     05 f                        pic x(68) value
   442         'AHLGM10   ;EL523 ;Total Written & Outstanding Balance
   443-        '            '.
   444     05 f                        pic x(68) value
   445         'AHLGM10   ;EL523 ;Processable Cancelled
   446-        '            '.
   447     05 f                        pic x(68) value
   448         'AHLGM10   ;EL523 ;Non-Processable Cancelled
   449-        '            '.
   450     05 f                        pic x(68) value
   451         'AHLGM10   ;EL523 ;Total Cancelled
   452-        '            '.
   453     05 f                        pic x(68) value
   454         'AHLGM10   ;EL523 ;Processable Net Premium
   455-        '            '.
   456     05 f                        pic x(68) value
   457         'AHLGM10   ;EL523 ;Non-Processable Net Premium
   458-        '            '.
   459     05 f                        pic x(68) value
   460         'AHLGM10   ;EL523 ;Total Net Premium
   461-        '            '.
   462     05 f                        pic x(68) value
   463         'AHLGM10   ;EL523 ;Processable Net Commission
   464-        '            '.
   465     05 f                        pic x(68) value
   466         'AHLGM10   ;EL523 ;Non-Processable Net Commission
   467-        '            '.
   468     05 f                        pic x(68) value
   469         'AHLGM10   ;EL523 ;Total Net Commission
   470-        '            '.
   471     05 f                        pic x(68) value
   472         'AHLGM15   ;ECS010;Life Claims Paid
   473-        '            '.
   474     05 f                        pic x(68) value
   475         'AHLGM15   ;ECS010;A&H Claims Paid
   476-        '            '.
   477     05 f                        pic x(68) value
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  10
* BSSRCH.cbl
   478         'AHLGM15   ;ECS010;Output Certificate Master Records Prio
   479-        'r Month     '.
   480     05 f                        pic x(68) value
   481         'AHLGM17   ;ECS080;Gross Reserve
   482-        '            '.
   483 01  dcc-table.
   484     05 f                        pic x(68) value
   485         'CIDCLGM10 ;EL524 ;Total Claims Paid
   486-        '            '.
   487     05 f                        pic x(68) value
   488         'CIDCLGM10 ;EL523 ;Processable Written & Outstanding Bala
   489-        'nce         '.
   490     05 f                        pic x(68) value
   491         'CIDCLGM10 ;EL523 ;Non-Processable Written & Outstanding
   492-        'Balance     '.
   493     05 f                        pic x(68) value
   494         'CIDCLGM10 ;EL523 ;Total Written & Outstanding Balance
   495-        '            '.
   496     05 f                        pic x(68) value
   497         'CIDCLGM10 ;EL523 ;Processable Cancelled
   498-        '            '.
   499     05 f                        pic x(68) value
   500         'CIDCLGM10 ;EL523 ;Non-Processable Cancelled
   501-        '            '.
   502     05 f                        pic x(68) value
   503         'CIDCLGM10 ;EL523 ;Total Cancelled
   504-        '            '.
   505     05 f                        pic x(68) value
   506         'CIDCLGM10 ;EL523 ;Processable Net Premium
   507-        '            '.
   508     05 f                        pic x(68) value
   509         'CIDCLGM10 ;EL523 ;Non-Processable Net Premium
   510-        '            '.
   511     05 f                        pic x(68) value
   512         'CIDCLGM10 ;EL523 ;Total Net Premium
   513-        '            '.
   514     05 f                        pic x(68) value
   515         'CIDCLGM10 ;EL523 ;Processable Net Commission
   516-        '            '.
   517     05 f                        pic x(68) value
   518         'CIDCLGM10 ;EL523 ;Non-Processable Net Commission
   519-        '            '.
   520     05 f                        pic x(68) value
   521         'CIDCLGM10 ;EL523 ;Total Net Commission
   522-        '            '.
   523     05 f                        pic x(68) value
   524         'CIDCLGM15 ;ECS010;Life Claims Paid
   525-        '            '.
   526     05 f                        pic x(68) value
   527         'CIDCLGM15 ;ECS010;A&H Claims Paid
   528-        '            '.
   529     05 f                        pic x(68) value
   530         'CIDCLGM15 ;ECS010;Output Certificate Master Records Prio
   531-        'r Month     '.
   532     05 f                        pic x(68) value
   533         'CIDCLGM17 ;ECS080;Gross Reserve
   534-        '            '.
   535 01  cid-table.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  11
* BSSRCH.cbl
   536     05 f                        pic x(68) value
   537         'CILGM10   ;EL524 ;Total Claims Paid
   538-        '            '.
   539     05 f                        pic x(68) value
   540         'CILGM10   ;EL523 ;Processable Written & Outstanding Bala
   541-        'nce         '.
   542     05 f                        pic x(68) value
   543         'CILGM10   ;EL523 ;Non-Processable Written & Outstanding
   544-        'Balance     '.
   545     05 f                        pic x(68) value
   546         'CILGM10   ;EL523 ;Total Written & Outstanding Balance
   547-        '            '.
   548     05 f                        pic x(68) value
   549         'CILGM10   ;EL523 ;Processable Cancelled
   550-        '            '.
   551     05 f                        pic x(68) value
   552         'CILGM10   ;EL523 ;Non-Processable Cancelled
   553-        '            '.
   554     05 f                        pic x(68) value
   555         'CILGM10   ;EL523 ;Total Cancelled
   556-        '            '.
   557     05 f                        pic x(68) value
   558         'CILGM10   ;EL523 ;Processable Net Premium
   559-        '            '.
   560     05 f                        pic x(68) value
   561         'CILGM10   ;EL523 ;Non-Processable Net Premium
   562-        '            '.
   563     05 f                        pic x(68) value
   564         'CILGM10   ;EL523 ;Total Net Premium
   565-        '            '.
   566     05 f                        pic x(68) value
   567         'CILGM10   ;EL523 ;Processable Net Commission
   568-        '            '.
   569     05 f                        pic x(68) value
   570         'CILGM10   ;EL523 ;Non-Processable Net Commission
   571-        '            '.
   572     05 f                        pic x(68) value
   573         'CILGM10   ;EL523 ;Total Net Commission
   574-        '            '.
   575     05 f                        pic x(68) value
   576         'CILGM15   ;ECS010;Life Claims Paid
   577-        '            '.
   578     05 f                        pic x(68) value
   579         'CILGM15   ;ECS010;A&H Claims Paid
   580-        '            '.
   581     05 f                        pic x(68) value
   582         'CILGM15   ;ECS010;Output Certificate Master Records Prio
   583-        'r Month     '.
   584     05 f                        pic x(68) value
   585         'CILGM17   ;ECS080;Gross Reserve
   586-        '            '.
   587 01  filler redefines cid-table.
   588     05  filler occurs 17.
   589         10  tbl-jobname             pic x(10).
   590         10  f                       pic x.
   591         10  tbl-stepname            pic x(6).
   592         10  f                       pic x.
   593         10  tbl-desc                pic x(50).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  12
* BSSRCH.cbl
   594 01  filler.
   595     05  filler occurs 17.
   596         10  tbl-low-amount      pic s9(9).
   597         10  tbl-hi-amount       pic s9(9).
   598************************************
   599* fields used to read web data
   600************************************
   601 01  w-form-name       pic x(80).
   602 01  w-form-value      pic x(80).
   603 01  w-form-name-len   pic s9(8) comp.
   604 01  w-form-value-len  pic s9(8) comp.
   605 01  w-resp            pic s9(8) comp.
   606 01  w-doctoken        pic x(16).
   607 01  filler.
   608     05  ECS010-STATUS           PIC XX VALUE ZEROS.
   609     05  CHKPNT-STATUS           pic xx value zeros.
   610     05  work-cert-cnt           pic x(11).
   611     05  numeric-cert-cnt        pic 9(9).
   612     05  work-mort-resv-lo       pic x(11).
   613     05  work-mort-resv-hi       pic x(11).
   614     05  numeric-mort-resv       pic 9(9).
   615*****************************************
   616* symbol list for the BSDETAIL template
   617*****************************************
   618 01 output-data.
   619    05  filler                   pic x(7) value"COMPID=".
   620    05  out-comp-id              pic xxx.
   621    05  filler                   pic x(8) value"&EOMDTE=".
   622    05  out-eom-date             pic x(10).
   623    05  filler                   pic x(9) value"&COMPNME=".
   624    05  out-comp-name            pic x(30).
   625    05  filler                   pic x(7) value"&FDATE=".
   626    05  out-format-date          pic x(20).
   627    05  filler                   pic x(10) value"&LFISSPRM=".
   628    05  out-lf-iss-prem          pic zzz99,999.99.
   629    05  filler                   pic x(10) value"&LFREFPRM=".
   630    05  out-lf-ref-prem          pic zz,z99,999.99.
   631    05  filler                   pic x(10) value"&LFNETPRM=".
   632    05  out-lf-net-prem          pic -zz,zz9,999.99.
   633    05  filler                   pic x(10) value"&AHISSPRM=".
   634    05  out-ah-iss-prem          pic zz,zz9,999.99.
   635    05  filler                   pic x(10) value"&AHREFPRM=".
   636    05  out-ah-ref-prem          pic zz,z99,999.99.
   637    05  filler                   pic x(10) value"&AHNETPRM=".
   638    05  out-ah-net-prem          pic -zz,z99,999.99.
   639    05  filler                   pic x(10) value"&LFISSCOM=".
   640    05  out-lf-iss-comm          pic zz,zz9,999.99.
   641    05  filler                   pic x(10) value"&LFREFCOM=".
   642    05  out-lf-ref-comm          pic zz,zz9,999.99.
   643    05  filler                   pic x(10) value"&LFNETCOM=".
   644    05  out-lf-net-comm          pic -zz,zz9,999.99.
   645    05  filler                   pic x(10) value"&AHISSCOM=".
   646    05  out-ah-iss-comm          pic zz,zzz,999.99.
   647    05  filler                   pic x(10) value"&AHREFCOM=".
   648    05  out-ah-ref-comm          pic zz,z99,999.99.
   649    05  filler                   pic x(10) value"&AHNETCOM=".
   650    05  out-ah-net-comm          pic -zz,z99,999.99.
   651    05  filler                   pic x(9) value "&TOTPREM=".
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  13
* BSSRCH.cbl
   652    05  out-tot-prem             pic zz,z99,999.99.
   653    05  filler                   pic x(9) value "&TOTREFS=".
   654    05  out-tot-refs             pic zz,z99,999.99.
   655    05  filler                   pic x(9) value"&TOTNETP=".
   656    05  out-tot-netp             pic -zz,z99,999.99.
   657    05  filler                   pic x(8) value"&ISSCOM=".
   658    05  out-iss-comm             pic zz,zz9,999.99.
   659    05  filler                   pic x(8) value"&REFCOM=".
   660    05  out-ref-comm             pic zz,z99,999.99.
   661    05  filler                   pic x(9) value"&TOTNCOM=".
   662    05  out-net-comm             pic -zz,z99,999.99.
   663    05  filler                   pic x(8) value "&ISSCNT=".
   664    05  out-iss-cnt              pic zzzz,z99.
   665    05  filler                   pic x(8) value "&REFCNT=".
   666    05  out-ref-cnt              pic zzzz,999.
   667    05  filler                   pic x(8) value "&NETCNT=".
   668    05  out-net-cnt              pic -zzzz,999.
   669    05  filler                   pic x(8) value"&LFCLMS=".
   670    05  out-lf-clms-pd           pic zz,z99,999.99.
   671    05  filler                   pic x(9) value"&LFVOIDS=".
   672    05  out-lf-clms-void         pic zz,zz9,999.99.
   673    05  filler                   pic x(11) value"&TOTLFCLMS=".
   674    05  out-lf-tot-clms          pic -zz,z99,999.99.
   675    05  filler                   pic x(8) value"&AHCLMS=".
   676    05  out-ah-clms-pd           pic zz,z99,999.99.
   677    05  filler                   pic x(9) value"&AHVOIDS=".
   678    05  out-ah-clms-void         pic zz,zz9,999.99.
   679    05  filler                   pic x(11) value"&TOTAHCLMS=".
   680    05  out-ah-tot-clms          pic -zz,z99,999.99.
   681    05  filler                   pic x(8) value"&PDCLMS=".
   682    05  out-clms-pd              pic zz,z99,999.99.
   683    05  filler                   pic x(8) value"&VDCLMS=".
   684    05  out-clms-void            pic zz,z99,999.99.
   685    05  filler                   pic x(9) value"&TOTCLMS=".
   686    05  out-tot-clms             pic -zz,z99,999.99.
   687    05  filler                   pic x(8) value"&LORESV=".
   688    05  out-lo-resv              pic zzz,z99,999.
   689    05  filler                   pic x(8) value"&HIRESV=".
   690    05  out-hi-resv              pic zzz,z99,999.
   691    05  filler                   pic x(8) value"&CRTCNT=".
   692    05  out-crt-cnt              pic z,zz9,999.
   693    05  filler                   pic x(5) value "&MSG=".
   694    05  output-msg               pic x(50).
   695 01 bl-index               pic s9(8) comp.
   696****************************************************************
   697*
   698* Copyright (c) 2007 by Clerity Solutions, Inc.
   699* All rights reserved.
   700*
   701****************************************************************
   702 01  DFHEIV.
   703   02  DFHEIV0               PIC X(35).
   704   02  DFHEIV1               PIC X(08).
   705   02  DFHEIV2               PIC X(08).
   706   02  DFHEIV3               PIC X(08).
   707   02  DFHEIV4               PIC X(06).
   708   02  DFHEIV5               PIC X(04).
   709   02  DFHEIV6               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  14
* BSSRCH.cbl
   710   02  DFHEIV7               PIC X(02).
   711   02  DFHEIV8               PIC X(02).
   712   02  DFHEIV9               PIC X(01).
   713   02  DFHEIV10              PIC S9(7) COMP-3.
   714   02  DFHEIV11              PIC S9(4) COMP SYNC.
   715   02  DFHEIV12              PIC S9(4) COMP SYNC.
   716   02  DFHEIV13              PIC S9(4) COMP SYNC.
   717   02  DFHEIV14              PIC S9(4) COMP SYNC.
   718   02  DFHEIV15              PIC S9(4) COMP SYNC.
   719   02  DFHEIV16              PIC S9(9) COMP SYNC.
   720   02  DFHEIV17              PIC X(04).
   721   02  DFHEIV18              PIC X(04).
   722   02  DFHEIV19              PIC X(04).
   723   02  DFHEIV20              USAGE IS POINTER.
   724   02  DFHEIV21              USAGE IS POINTER.
   725   02  DFHEIV22              USAGE IS POINTER.
   726   02  DFHEIV23              USAGE IS POINTER.
   727   02  DFHEIV24              USAGE IS POINTER.
   728   02  DFHEIV25              PIC S9(9) COMP SYNC.
   729   02  DFHEIV26              PIC S9(9) COMP SYNC.
   730   02  DFHEIV27              PIC S9(9) COMP SYNC.
   731   02  DFHEIV28              PIC S9(9) COMP SYNC.
   732   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   733   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   734   02  FILLER                PIC X(02).
   735   02  DFHEIV99              PIC X(08) VALUE SPACE.
   736   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   737   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   738   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   739   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   740 LINKAGE  SECTION.
   741*****************************************************************
   742*                                                               *
   743* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   744* All rights reserved.                                          *
   745*                                                               *
   746*****************************************************************
   747 01  dfheiblk.
   748     02  eibtime          pic s9(7) comp-3.
   749     02  eibdate          pic s9(7) comp-3.
   750     02  eibtrnid         pic x(4).
   751     02  eibtaskn         pic s9(7) comp-3.
   752     02  eibtrmid         pic x(4).
   753     02  dfheigdi         pic s9(4) comp.
   754     02  eibcposn         pic s9(4) comp.
   755     02  eibcalen         pic s9(4) comp.
   756     02  eibaid           pic x(1).
   757     02  eibfiller1       pic x(1).
   758     02  eibfn            pic x(2).
   759     02  eibfiller2       pic x(2).
   760     02  eibrcode         pic x(6).
   761     02  eibfiller3       pic x(2).
   762     02  eibds            pic x(8).
   763     02  eibreqid         pic x(8).
   764     02  eibrsrce         pic x(8).
   765     02  eibsync          pic x(1).
   766     02  eibfree          pic x(1).
   767     02  eibrecv          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  15
* BSSRCH.cbl
   768     02  eibsend          pic x(1).
   769     02  eibatt           pic x(1).
   770     02  eibeoc           pic x(1).
   771     02  eibfmh           pic x(1).
   772     02  eibcompl         pic x(1).
   773     02  eibsig           pic x(1).
   774     02  eibconf          pic x(1).
   775     02  eiberr           pic x(1).
   776     02  eibrldbk         pic x(1).
   777     02  eiberrcd         pic x(4).
   778     02  eibsynrb         pic x(1).
   779     02  eibnodat         pic x(1).
   780     02  eibfiller5       pic x(2).
   781     02  eibresp          pic 9(09) comp.
   782     02  eibresp2         pic 9(09) comp.
   783     02  dfheigdj         pic s9(4) comp.
   784     02  dfheigdk         pic s9(4) comp.
   785 01  DFHCOMMAREA       PIC X(01).
   786 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
   787 0000-DFHEXIT SECTION.
   788     MOVE '9#                    $   ' TO DFHEIV0.
   789     MOVE 'BSSRCH' TO DFHEIV1.
   790     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   791 0000-begin.
   792     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
   793
   794* exec cics web
   795*       startbr formfield resp(w-resp)
   796*    end-exec
   797*    MOVE 'X(f                   &  N#00000789' TO DFHEIV0
   798     MOVE X'582866202020202020202020' TO DFHEIV0(1:12)
   799     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   800     MOVE X'204E233030303030373839' TO DFHEIV0(25:11)
   801     CALL 'kxdfhei1' USING DFHEIV0,
   802           DFHEIV99,
   803           DFHEIV99,
   804           DFHEIV99,
   805           DFHEIV99,
   806           DFHEIV99
   807     MOVE EIBRESP  TO w-resp
   808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   809     perform 0200-read-form      thru 0200-exit until
   810        w-resp not = 0
   811*   dfhresp(normal)
   812
   813* exec cics web
   814*       endbr formfield
   815*    end-exec
   816*    MOVE 'X,f                   #   #00000794' TO DFHEIV0
   817     MOVE X'582C66202020202020202020' TO DFHEIV0(1:12)
   818     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
   819     MOVE X'2020233030303030373934' TO DFHEIV0(25:11)
   820     CALL 'kxdfhei1' USING DFHEIV0,
   821           DFHEIV99,
   822           DFHEIV99
   823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   824     display ' input date   ' bl-input-eom-date
   825     display ' comp id      ' bl-input-comp-id
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  16
* BSSRCH.cbl
   826     display ' mort resv lo ' work-mort-resv-lo
   827     display ' mort resv hi ' work-mort-resv-hi
   828     display ' build file   ' bl-input-bld-file
   829     evaluate bl-input-comp-id
   830        when 'AHL'
   831           open input AHL-ECS010-IN
   832           if ecs010-status not = '00'
   833              move ' Cant open AHL ecs010 file '
   834                                 to bl-output-message
   835              go to 0100-send-document
   836           end-if
   837           READ AHL-ECS010-IN into ecs010-in-rec
   838              display ' ecs010 cert cnt ' ecs010-cert-cnt
   839              move ecs010-cert-cnt
   840                                 to work-cert-cnt
   841           close ahl-ecs010-in
   842        when 'CID'
   843           open input CID-ECS010-IN
   844           if ecs010-status not = '00'
   845              move ' Cant open AHL ecs010 file '
   846                                 to bl-output-message
   847              go to 0100-send-document
   848           end-if
   849           READ CID-ECS010-IN into ecs010-in-rec
   850              display ' ecs010 cert cnt ' ecs010-cert-cnt
   851              move ecs010-cert-cnt
   852                                 to work-cert-cnt
   853           close cid-ecs010-in
   854        when 'DCC'
   855           open input DCC-ECS010-IN
   856           if ecs010-status not = '00'
   857              move ' Cant open AHL ecs010 file '
   858                                 to bl-output-message
   859              go to 0100-send-document
   860           end-if
   861           READ DCC-ECS010-IN into ecs010-in-rec
   862              display ' ecs010 cert cnt ' ecs010-cert-cnt
   863              move ecs010-cert-cnt
   864                                 to work-cert-cnt
   865           close dcc-ecs010-in
   866     end-evaluate
   867     move zeros                  to numeric-cert-cnt
   868     inspect work-cert-cnt replacing all spaces by zeros
   869     move +9 to s2
   870     perform varying s1 from +11 by -1 until s1 < +1
   871        if work-cert-cnt (s1:1) numeric
   872           move work-cert-cnt (s1:1)
   873                                 to numeric-cert-cnt (s2:1)
   874           subtract +1 from s2
   875        end-if
   876     end-perform
   877     move numeric-cert-cnt       to bl-out-cm-cnt
   878     move zeros                  to numeric-mort-resv
   879*    inspect work-mort-resv replacing all spaces by zeros
   880     move +9 to s2
   881     perform varying s1 from +11 by -1 until s1 < +1
   882        if work-mort-resv-lo (s1:1) numeric
   883           move work-mort-resv-lo (s1:1)
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  17
* BSSRCH.cbl
   884                                 to numeric-mort-resv (s2:1)
   885           subtract +1 from s2
   886        end-if
   887     end-perform
   888     move numeric-mort-resv      to bl-input-lo-resv
   889     display ' bl lo reserve ' bl-input-lo-resv
   890     move zeros                  to numeric-mort-resv
   891*    inspect work-mort-resv replacing all spaces by zeros
   892     move +9 to s2
   893     perform varying s1 from +11 by -1 until s1 < +1
   894        if work-mort-resv-hi (s1:1) numeric
   895           move work-mort-resv-hi (s1:1)
   896                                 to numeric-mort-resv (s2:1)
   897           subtract +1 from s2
   898        end-if
   899     end-perform
   900     move numeric-mort-resv      to bl-input-hi-resv
   901     display ' bl hi reserve ' bl-input-hi-resv
   902
   903* exec cics link
   904*       program  ('BSSRCHBL')
   905*       commarea (srch-commarea)
   906*    end-exec
   907     MOVE LENGTH OF
   908      srch-commarea
   909       TO DFHEIV11
   910     MOVE 'BSSRCHBL' TO DFHEIV1
   911*    MOVE '."C                   (   #00000875' TO DFHEIV0
   912     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
   913     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
   914     MOVE X'2020233030303030383735' TO DFHEIV0(25:11)
   915     CALL 'kxdfhei1' USING DFHEIV0,
   916           DFHEIV1,
   917           srch-commarea,
   918           DFHEIV11,
   919           DFHEIV99,
   920           DFHEIV99,
   921           DFHEIV99,
   922           DFHEIV99
   923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   924     .
   925 0100-send-document.
   926***********************************************************
   927* Build output document.
   928***********************************************************
   929     move bl-input-comp-id       to out-comp-id
   930     move bl-input-eom-date      to out-eom-date
   931     move bl-input-lo-resv       to out-lo-resv
   932     move bl-input-hi-resv       to out-hi-resv
   933     move bl-out-company-name    to out-comp-name
   934     move bl-out-formated-date   to out-format-date
   935     move bl-out-lf-prem (1)     to out-lf-iss-prem
   936     move bl-out-ah-prem (1)     to out-ah-iss-prem
   937     move bl-out-tot-prm (1)     to out-tot-prem
   938     move bl-out-lf-ref  (1)     to out-lf-ref-prem
   939     move bl-out-ah-ref  (1)     to out-ah-ref-prem
   940     move bl-out-tot-ref (1)     to out-tot-refs
   941     move bl-out-lf-net  (1)     to out-lf-net-prem
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  18
* BSSRCH.cbl
   942     move bl-out-ah-net  (1)     to out-ah-net-prem
   943     move bl-out-lf-iss-com (1)  to out-lf-iss-comm
   944     move bl-out-ah-iss-com (1)  to out-ah-iss-comm
   945     move bl-out-lf-ref-com (1)  to out-lf-ref-comm
   946     move bl-out-ah-ref-com (1)  to out-ah-ref-comm
   947     move bl-out-lf-net-com (1)  to out-lf-net-comm
   948     move bl-out-ah-net-com (1)  to out-ah-net-comm
   949     move bl-out-iss-com    (1)  to out-iss-comm
   950     move bl-out-ref-com    (1)  to out-ref-comm
   951     move bl-out-net-com    (1)  to out-net-comm
   952     move bl-out-iss-cnt    (1)  to out-iss-cnt
   953     move bl-out-can-cnt    (1)  to out-ref-cnt
   954     move bl-out-net-cnt    (1)  to out-net-cnt
   955     move bl-out-net-tot    (1)  to out-tot-netp
   956     move bl-out-cm-cnt          to out-crt-cnt
   957     move bl-out-lf-clms-pd      to out-lf-clms-pd
   958     move bl-out-lf-clms-void    to out-lf-clms-void
   959     move bl-out-lf-tot-clms     to out-lf-tot-clms
   960     move bl-out-ah-clms-pd      to out-ah-clms-pd
   961     move bl-out-ah-clms-void    to out-ah-clms-void
   962     move bl-out-ah-tot-clms     to out-ah-tot-clms
   963     move bl-out-clms-pd         to out-clms-pd
   964     move bl-out-clms-void       to out-clms-void
   965     move bl-out-tot-clms        to out-tot-clms
   966     move bl-output-message      to output-msg
   967     if bl-input-bld-file = 'YES'
   968        move 'Balance File Created'
   969                                 to output-msg
   970     end-if
   971
   972* exec cics document create
   973*       doctoken   (w-doctoken)
   974*       template   ('BSDETAIL')
   975*       symbollist (output-data)
   976*       listlength (length of output-data)
   977*    end-exec
   978     MOVE 'BSDETAIL'
   979      TO DFHEIVL0
   980     MOVE LENGTH OF
   981      output-data TO DFHEIV16
   982*    MOVE '\"D tSL               )   #00000926' TO DFHEIV0
   983     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
   984     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
   985     MOVE X'2020233030303030393236' TO DFHEIV0(25:11)
   986     CALL 'kxdfhei1' USING DFHEIV0,
   987           w-doctoken,
   988           DFHEIV99,
   989           DFHEIVL0,
   990           output-data,
   991           DFHEIV16,
   992           DFHEIV99,
   993           DFHEIV99,
   994           DFHEIV99
   995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   996     move 1                      to bl-index
   997*    exec cics document insert
   998*       doctoken (w-doctoken)
   999*       template ('BSFTR')
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  19
* BSSRCH.cbl
  1000*    end-exec
  1001    if bl-fail
  1002
  1003* exec cics syncpoint rollback
  1004*      end-exec
  1005*    MOVE '6"R                   !   #00000938' TO DFHEIV0
  1006     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  1007     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1008     MOVE X'2020233030303030393338' TO DFHEIV0(25:11)
  1009     CALL 'kxdfhei1' USING DFHEIV0
  1010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1011    end-if
  1012****************************************
  1013* Send the document and return.
  1014****************************************
  1015
  1016* exec cics web send
  1017*       doctoken(w-doctoken)
  1018*    end-exec
  1019*    MOVE 'X$D                   *   #00000944' TO DFHEIV0
  1020     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  1021     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  1022     MOVE X'2020233030303030393434' TO DFHEIV0(25:11)
  1023     CALL 'kxdfhei1' USING DFHEIV0,
  1024           w-doctoken,
  1025           DFHEIV99,
  1026           DFHEIV99,
  1027           DFHEIV99,
  1028           DFHEIV99,
  1029           DFHEIV99,
  1030           DFHEIV99,
  1031           DFHEIV99,
  1032           DFHEIV99
  1033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1034     if bl-input-bld-file = 'YES'
  1035        evaluate bl-input-comp-id
  1036           when 'AHL'
  1037              move ahl-table     to cid-table
  1038              perform 0300-build-cid
  1039                                 thru 0300-exit
  1040              perform 0400-write-ahl
  1041                                 thru 0400-exit
  1042           when 'CID'
  1043              perform 0300-build-cid
  1044                                 thru 0300-exit
  1045              perform 0500-write-cid
  1046                                 thru 0500-exit
  1047           when 'DCC'
  1048              move dcc-table     to cid-table
  1049              perform 0300-build-cid
  1050                                 thru 0300-exit
  1051              perform 0600-write-dcc
  1052                                 thru 0600-exit
  1053        end-evaluate
  1054     end-if
  1055
  1056* exec cics return
  1057*    end-exec
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  20
* BSSRCH.cbl
  1058*    MOVE '.(                    ''   #00000968' TO DFHEIV0
  1059     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1060     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1061     MOVE X'2020233030303030393638' TO DFHEIV0(25:11)
  1062     CALL 'kxdfhei1' USING DFHEIV0,
  1063           DFHEIV99,
  1064           DFHEIV99,
  1065           DFHEIV99,
  1066           DFHEIV99,
  1067           DFHEIV99,
  1068           DFHEIV99
  1069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1070     .
  1071 0200-read-form.
  1072     move spaces                 to w-form-name
  1073     move length of w-form-name  to w-form-name-len
  1074     move spaces                 to w-form-value
  1075     move length of w-form-value to w-form-value-len
  1076
  1077* exec cics web readnext
  1078*       formfield   (w-form-name)
  1079*       namelength  (w-form-name-len)
  1080*       value       (w-form-value)
  1081*       valuelength (w-form-value-len)
  1082*       resp        (w-resp)
  1083*    end-exec
  1084*    MOVE 'X*FLVL                &  N#00000976' TO DFHEIV0
  1085     MOVE X'582A464C564C202020202020' TO DFHEIV0(1:12)
  1086     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1087     MOVE X'204E233030303030393736' TO DFHEIV0(25:11)
  1088     CALL 'kxdfhei1' USING DFHEIV0,
  1089           w-form-name,
  1090           w-form-name-len,
  1091           w-form-value,
  1092           w-form-value-len,
  1093           DFHEIV99
  1094     MOVE EIBRESP  TO w-resp
  1095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1096     evaluate w-resp
  1097        when 0
  1098*   dfhresp(normal)
  1099           evaluate w-form-name(1:w-form-name-len)
  1100              when 'eom_dte'
  1101                 if w-form-value-len not = 0
  1102                    move w-form-value(1:w-form-value-len)
  1103                                 to bl-input-eom-date
  1104                 else
  1105                    move spaces  to bl-input-eom-date
  1106                end-if
  1107              when 'comp_id'
  1108                 if w-form-value-len not = 0
  1109                    move w-form-value(1:w-form-value-len)
  1110                                 to bl-input-comp-id
  1111                 else
  1112                    move spaces  to bl-input-comp-id
  1113                end-if
  1114              when 'lo_resv'
  1115                 if w-form-value-len not = 0
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  21
* BSSRCH.cbl
  1116                    move w-form-value(1:w-form-value-len)
  1117                                 to work-mort-resv-lo
  1118                 else
  1119                    move zeros   to work-mort-resv-lo
  1120                end-if
  1121              when 'hi_resv'
  1122                 if w-form-value-len not = 0
  1123                    move w-form-value(1:w-form-value-len)
  1124                                 to work-mort-resv-hi
  1125                 else
  1126                    move zeros   to work-mort-resv-hi
  1127                end-if
  1128              when 'bld_file'
  1129                 if w-form-value-len not = 0
  1130                    move w-form-value(1:w-form-value-len)
  1131                                 to bl-input-bld-file
  1132                 else
  1133                    move spaces  to bl-input-bld-file
  1134                end-if
  1135           end-evaluate
  1136        when other
  1137           continue
  1138     end-evaluate
  1139     .
  1140 0200-exit.
  1141     exit.
  1142 0300-build-cid.
  1143     perform varying s1 from +1 by +1 until s1 > +17
  1144        move -999999999          to tbl-low-amount (s1)
  1145        move +999999999          to tbl-hi-amount  (s1)
  1146     end-perform
  1147     move bl-out-tot-clms        to ws-pass-amount
  1148     perform 0310-calc-tol       thru 0310-exit
  1149     move ws-low-amount          to tbl-low-amount (1)
  1150     move ws-hi-amount           to tbl-hi-amount (1)
  1151     move bl-out-tot-prm (1)     to ws-pass-amount
  1152     perform 0310-calc-tol       thru 0310-exit
  1153     move ws-low-amount          to tbl-low-amount (2)
  1154     move ws-hi-amount           to tbl-hi-amount (2)
  1155     move bl-out-tot-prm (2)     to ws-pass-amount
  1156     perform 0310-calc-tol       thru 0310-exit
  1157     move ws-low-amount          to tbl-low-amount (3)
  1158     move ws-hi-amount           to tbl-hi-amount (3)
  1159     move bl-out-tot-prm (3)     to ws-pass-amount
  1160     perform 0310-calc-tol       thru 0310-exit
  1161     move ws-low-amount          to tbl-low-amount (4)
  1162     move ws-hi-amount           to tbl-hi-amount (4)
  1163     move bl-out-tot-ref (1)     to ws-pass-amount
  1164     perform 0310-calc-tol       thru 0310-exit
  1165     move ws-low-amount          to tbl-low-amount (5)
  1166     move ws-hi-amount           to tbl-hi-amount (5)
  1167     move bl-out-tot-ref (2)     to ws-pass-amount
  1168     perform 0310-calc-tol       thru 0310-exit
  1169     move ws-low-amount          to tbl-low-amount (6)
  1170     move ws-hi-amount           to tbl-hi-amount (6)
  1171     move bl-out-tot-ref (3)     to ws-pass-amount
  1172     perform 0310-calc-tol       thru 0310-exit
  1173     move ws-low-amount          to tbl-low-amount (7)
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  22
* BSSRCH.cbl
  1174     move ws-hi-amount           to tbl-hi-amount (7)
  1175     move bl-out-net-tot (1)     to ws-pass-amount
  1176     perform 0310-calc-tol       thru 0310-exit
  1177     move ws-low-amount          to tbl-low-amount (8)
  1178     move ws-hi-amount           to tbl-hi-amount (8)
  1179     move bl-out-net-tot (2)     to ws-pass-amount
  1180     perform 0310-calc-tol       thru 0310-exit
  1181     move ws-low-amount          to tbl-low-amount (9)
  1182     move ws-hi-amount           to tbl-hi-amount (9)
  1183     move bl-out-net-tot (3)     to ws-pass-amount
  1184     perform 0310-calc-tol       thru 0310-exit
  1185     move ws-low-amount          to tbl-low-amount (10)
  1186     move ws-hi-amount           to tbl-hi-amount (10)
  1187     move bl-out-net-com (1)     to ws-pass-amount
  1188     perform 0310-calc-tol       thru 0310-exit
  1189     move ws-low-amount          to tbl-low-amount (11)
  1190     move ws-hi-amount           to tbl-hi-amount (11)
  1191     move bl-out-net-com (2)     to ws-pass-amount
  1192     perform 0310-calc-tol       thru 0310-exit
  1193     move ws-low-amount          to tbl-low-amount (12)
  1194     move ws-hi-amount           to tbl-hi-amount (12)
  1195     move bl-out-net-com (3)     to ws-pass-amount
  1196     perform 0310-calc-tol       thru 0310-exit
  1197     move ws-low-amount          to tbl-low-amount (13)
  1198     move ws-hi-amount           to tbl-hi-amount (13)
  1199     move bl-out-lf-tot-clms     to ws-pass-amount
  1200     perform 0310-calc-tol       thru 0310-exit
  1201     move ws-low-amount          to tbl-low-amount (14)
  1202     move ws-hi-amount           to tbl-hi-amount (14)
  1203     move bl-out-ah-tot-clms     to ws-pass-amount
  1204     perform 0310-calc-tol       thru 0310-exit
  1205     move ws-low-amount          to tbl-low-amount (15)
  1206     move ws-hi-amount           to tbl-hi-amount (15)
  1207     move bl-out-cm-cnt          to tbl-low-amount (16)
  1208                                    tbl-hi-amount  (16)
  1209     move bl-input-lo-resv       to tbl-low-amount (17)
  1210     move bl-input-hi-resv       to tbl-hi-amount (17)
  1211     .
  1212 0300-exit.
  1213     exit.
  1214 0310-calc-tol.
  1215     if ws-pass-amount > zeros
  1216        compute ws-low-amount = ws-pass-amount * .98
  1217        compute ws-hi-amount  = ws-pass-amount * 1.02
  1218     else
  1219        compute ws-low-amount = ws-pass-amount * 1.02
  1220        compute ws-hi-amount  = ws-pass-amount * .98
  1221     end-if
  1222     .
  1223 0310-exit.
  1224     exit.
  1225 0400-write-ahl.
  1226     open output ahl-chkpoint-out
  1227     if chkpnt-status not = '00'
  1228        move ' Cant open AHL CHKPNT file '
  1229           to bl-output-message
  1230        go to 0100-send-document
  1231     end-if
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  23
* BSSRCH.cbl
  1232     move bl-input-eom-date      to cpo-jobname
  1233     move 'AHL'                  to cpo-stepname
  1234     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1235        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1236        delimited by size into cpo-desc
  1237     end-string
  1238     write ahl-chkpoint-out-rec  from cpo-out-record
  1239     move spaces                 to cpo-jobname
  1240                                    cpo-stepname
  1241     move 'Proc Cnt'             to cpo-desc
  1242     move bl-out-iss-cnt (1)     to cpo-low-amount
  1243     move bl-out-can-cnt (1)     to cpo-hi-amount
  1244     write ahl-chkpoint-out-rec  from cpo-out-record
  1245     move 'NonProcCnt'           to cpo-desc
  1246     move bl-out-iss-cnt (2)     to cpo-low-amount
  1247     move bl-out-can-cnt (2)     to cpo-hi-amount
  1248     write ahl-chkpoint-out-rec  from cpo-out-record
  1249     move 'Total Cnt'            to cpo-desc
  1250     move bl-out-iss-cnt (3)     to cpo-low-amount
  1251     move bl-out-can-cnt (3)     to cpo-hi-amount
  1252     write ahl-chkpoint-out-rec  from cpo-out-record
  1253     move bl-out-lf-clms-cur     to ws-pass-amount
  1254     perform 0310-calc-tol       thru 0310-exit
  1255     move 'LF Claims Paid Curr'  to cpo-desc
  1256     move ws-low-amount          to cpo-low-amount
  1257     move ws-hi-amount           to cpo-hi-amount
  1258     write ahl-chkpoint-out-rec  from cpo-out-record
  1259     move bl-out-ah-clms-cur     to ws-pass-amount
  1260     perform 0310-calc-tol       thru 0310-exit
  1261     move 'AH Claims Paid Curr'  to cpo-desc
  1262     move ws-low-amount          to cpo-low-amount
  1263     move ws-hi-amount           to cpo-hi-amount
  1264     write ahl-chkpoint-out-rec  from cpo-out-record
  1265     move bl-out-tot-clms-cur    to ws-pass-amount
  1266     perform 0310-calc-tol       thru 0310-exit
  1267     move 'TOT Claims Paid Curr' to cpo-desc
  1268     move ws-low-amount          to cpo-low-amount
  1269     move ws-hi-amount           to cpo-hi-amount
  1270     write ahl-chkpoint-out-rec  from cpo-out-record
  1271     perform varying s1 from 1 by 1 until s1 > 17
  1272        move tbl-jobname    (s1) to cpo-jobname
  1273        move tbl-stepname   (s1) to cpo-stepname
  1274        move tbl-desc       (s1) to cpo-desc
  1275        move tbl-low-amount (s1) to cpo-low-amount
  1276        move tbl-hi-amount  (s1) to cpo-hi-amount
  1277        write ahl-chkpoint-out-rec from cpo-out-record
  1278     end-perform
  1279     close ahl-chkpoint-out
  1280     perform 0700-submit-job     thru 0700-exit
  1281     .
  1282 0400-exit.
  1283     exit.
  1284 0500-write-cid.
  1285     open output cid-chkpoint-out
  1286     if chkpnt-status not = '00'
  1287        move ' Cant open CID CHKPNT file '
  1288           to bl-output-message
  1289        go to 0100-send-document
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  24
* BSSRCH.cbl
  1290     end-if
  1291     move bl-input-eom-date      to cpo-jobname
  1292     move 'CID'                  to cpo-stepname
  1293     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1294        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1295        delimited by size into cpo-desc
  1296     end-string
  1297     write cid-chkpoint-out-rec  from cpo-out-record
  1298     move spaces                 to cpo-jobname
  1299                                    cpo-stepname
  1300     move 'Proc Cnt'             to cpo-desc
  1301     move bl-out-iss-cnt (1)     to cpo-low-amount
  1302     move bl-out-can-cnt (1)     to cpo-hi-amount
  1303     write cid-chkpoint-out-rec  from cpo-out-record
  1304     move 'NonProcCnt'           to cpo-desc
  1305     move bl-out-iss-cnt (2)     to cpo-low-amount
  1306     move bl-out-can-cnt (2)     to cpo-hi-amount
  1307     write cid-chkpoint-out-rec  from cpo-out-record
  1308     move 'Total Cnt'            to cpo-desc
  1309     move bl-out-iss-cnt (3)     to cpo-low-amount
  1310     move bl-out-can-cnt (3)     to cpo-hi-amount
  1311     write cid-chkpoint-out-rec  from cpo-out-record
  1312     move bl-out-lf-clms-cur     to ws-pass-amount
  1313     perform 0310-calc-tol       thru 0310-exit
  1314     move 'LF Claims Paid Curr'  to cpo-desc
  1315     move ws-low-amount          to cpo-low-amount
  1316     move ws-hi-amount           to cpo-hi-amount
  1317     write cid-chkpoint-out-rec  from cpo-out-record
  1318     move bl-out-ah-clms-cur     to ws-pass-amount
  1319     perform 0310-calc-tol       thru 0310-exit
  1320     move 'AH Claims Paid Curr'  to cpo-desc
  1321     move ws-low-amount          to cpo-low-amount
  1322     move ws-hi-amount           to cpo-hi-amount
  1323     write cid-chkpoint-out-rec  from cpo-out-record
  1324     move bl-out-tot-clms-cur    to ws-pass-amount
  1325     perform 0310-calc-tol       thru 0310-exit
  1326     move 'TOT Claims Paid Curr' to cpo-desc
  1327     move ws-low-amount          to cpo-low-amount
  1328     move ws-hi-amount           to cpo-hi-amount
  1329     write cid-chkpoint-out-rec  from cpo-out-record
  1330     perform varying s1 from 1 by 1 until s1 > 17
  1331        move tbl-jobname    (s1) to cpo-jobname
  1332        move tbl-stepname   (s1) to cpo-stepname
  1333        move tbl-desc       (s1) to cpo-desc
  1334        move tbl-low-amount (s1) to cpo-low-amount
  1335        move tbl-hi-amount  (s1) to cpo-hi-amount
  1336        write cid-chkpoint-out-rec
  1337                                 from cpo-out-record
  1338     end-perform
  1339     close cid-chkpoint-out
  1340     perform 0700-submit-job     thru 0700-exit
  1341     .
  1342 0500-exit.
  1343     exit.
  1344 0600-write-dcc.
  1345     open output dcc-chkpoint-out
  1346     if chkpnt-status not = '00'
  1347        move ' Cant open DCC CHKPNT file '
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  25
* BSSRCH.cbl
  1348           to bl-output-message
  1349        go to 0100-send-document
  1350     end-if
  1351     move bl-input-eom-date      to cpo-jobname
  1352     move 'DCC'                  to cpo-stepname
  1353     string ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  1354        ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  1355        delimited by size into cpo-desc
  1356     end-string
  1357     write dcc-chkpoint-out-rec  from cpo-out-record
  1358     move spaces                 to cpo-jobname
  1359                                    cpo-stepname
  1360     move 'Proc Cnt'             to cpo-desc
  1361     move bl-out-iss-cnt (1)     to cpo-low-amount
  1362     move bl-out-can-cnt (1)     to cpo-hi-amount
  1363     write dcc-chkpoint-out-rec  from cpo-out-record
  1364     move 'NonProcCnt'           to cpo-desc
  1365     move bl-out-iss-cnt (2)     to cpo-low-amount
  1366     move bl-out-can-cnt (2)     to cpo-hi-amount
  1367     write dcc-chkpoint-out-rec  from cpo-out-record
  1368     move 'Total Cnt'            to cpo-desc
  1369     move bl-out-iss-cnt (3)     to cpo-low-amount
  1370     move bl-out-can-cnt (3)     to cpo-hi-amount
  1371     write dcc-chkpoint-out-rec  from cpo-out-record
  1372     move bl-out-lf-clms-cur     to ws-pass-amount
  1373     perform 0310-calc-tol       thru 0310-exit
  1374     move 'LF Claims Paid Curr'  to cpo-desc
  1375     move ws-low-amount          to cpo-low-amount
  1376     move ws-hi-amount           to cpo-hi-amount
  1377     write dcc-chkpoint-out-rec  from cpo-out-record
  1378     move bl-out-ah-clms-cur     to ws-pass-amount
  1379     perform 0310-calc-tol       thru 0310-exit
  1380     move 'AH Claims Paid Curr'  to cpo-desc
  1381     move ws-low-amount          to cpo-low-amount
  1382     move ws-hi-amount           to cpo-hi-amount
  1383     write dcc-chkpoint-out-rec  from cpo-out-record
  1384     move bl-out-tot-clms-cur    to ws-pass-amount
  1385     perform 0310-calc-tol       thru 0310-exit
  1386     move 'TOT Claims Paid Curr' to cpo-desc
  1387     move ws-low-amount          to cpo-low-amount
  1388     move ws-hi-amount           to cpo-hi-amount
  1389     write dcc-chkpoint-out-rec  from cpo-out-record
  1390     perform varying s1 from 1 by 1 until s1 > 16
  1391        move tbl-jobname    (s1) to cpo-jobname
  1392        move tbl-stepname   (s1) to cpo-stepname
  1393        move tbl-desc       (s1) to cpo-desc
  1394        move tbl-low-amount (s1) to cpo-low-amount
  1395        move tbl-hi-amount  (s1) to cpo-hi-amount
  1396        write dcc-chkpoint-out-rec from cpo-out-record
  1397     end-perform
  1398     close dcc-chkpoint-out
  1399     perform 0700-submit-job     thru 0700-exit
  1400     .
  1401 0600-exit.
  1402     exit.
  1403 0700-submit-job.
  1404     move function lower-case(bl-input-comp-id)
  1405                                 to tran-comp-id
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  26
* BSSRCH.cbl
  1406
  1407* EXEC CICS WRITEQ TD
  1408*       QUEUE ('BTCH')
  1409*       FROM (TRAN-DATA-LINE1)
  1410*       LENGTH (80)
  1411*    END-EXEC
  1412     MOVE 80
  1413       TO DFHEIV11
  1414     MOVE 'BTCH' TO DFHEIV5
  1415*    MOVE '(" L                  &   #00001292' TO DFHEIV0
  1416     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  1417     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1418     MOVE X'2020233030303031323932' TO DFHEIV0(25:11)
  1419     CALL 'kxdfhei1' USING DFHEIV0,
  1420           DFHEIV5,
  1421           TRAN-DATA-LINE1,
  1422           DFHEIV11,
  1423           DFHEIV99,
  1424           DFHEIV99
  1425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1426
  1427* EXEC CICS WRITEQ TD
  1428*       QUEUE ('BTCH')
  1429*       FROM (TRAN-DATA-LINE2)
  1430*       LENGTH (80)
  1431*    END-EXEC
  1432     MOVE 80
  1433       TO DFHEIV11
  1434     MOVE 'BTCH' TO DFHEIV5
  1435*    MOVE '(" L                  &   #00001297' TO DFHEIV0
  1436     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  1437     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1438     MOVE X'2020233030303031323937' TO DFHEIV0(25:11)
  1439     CALL 'kxdfhei1' USING DFHEIV0,
  1440           DFHEIV5,
  1441           TRAN-DATA-LINE2,
  1442           DFHEIV11,
  1443           DFHEIV99,
  1444           DFHEIV99
  1445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1446     .
  1447 0700-exit.
  1448     exit.
  1449
  1450 9999-DFHBACK SECTION.
  1451     MOVE '9%                    "   ' TO DFHEIV0
  1452     MOVE 'BSSRCH' TO DFHEIV1
  1453     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1454     GOBACK.
  1455 9999-DFHEXIT.
  1456     IF DFHEIGDJ EQUAL 0001
  1457         NEXT SENTENCE.
  1458     MOVE '9%                    "   ' TO DFHEIV0
  1459     MOVE 'BSSRCH' TO DFHEIV1
  1460     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1461     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 28-Mar-13 14:38 Page  27
* BSSRCH.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       10168     Code:        7449
