* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   1
* WSMESS03.cbl
* Options: int("WSMESS03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("WSMESS03.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"WSMESS03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "WSMESS03.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID. WSMESS03.
     4 AUTHOR.     Cowtown.
     5 DATE-COMPILED. 05-Feb-19 08:05.
     6*SECURITY.   *****************************************************
     7*            *                                                   *
     8*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
     9*            *                                                   *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF     CSO     IS EXPRESSLY PROHIBITED WITHOUT  *
    12*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   2
* WSMESS03.cbl
    14*            *****************************************************
    15******************************************************************
    16*REMARKS.                                                        *
    17*     Premium verification                                       *
    18*  Returns premium calc based on info passed to me.              *
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 020617   2017020300002   PEMA  New Program
    28* 080117   2017020300002   PEMA  Tol for tot pmts, use totpmts GP
    29* 080817   2017020300002   PEMA  Limit and ben code assign changes
    30* 100317   2017020300002   PEMA  copy of message001
    31******************************************************************
    32 ENVIRONMENT DIVISION.
    33 data division.
    34 WORKING-STORAGE SECTION.
    35 01  DFH-START PIC X(04).
    36 77  FILLER  PIC X(32) VALUE '********************************'.
    37 77  FILLER  PIC X(32) VALUE '   WSMESS03 WORKING STORAGE     '.
    38 77  FILLER  PIC X(32) VALUE '********************************'.
    39*
    40* program buffers
    41*
    42 77  ws-seq-num                  pic s9(8) comp value 0.
    43 77  ws-flags                    pic s9(8) comp value 0.
    44 77  WS-COMP-CD                  PIC X  VALUE LOW-VALUES.
    45 77  ws-comp-id                  pic xxx value spaces.
    46 77  WS-SAVE-ACCOUNT             PIC X(10)  VALUE SPACES.
    47 77  WS-BIN-ORIG-EFF-DT          PIC XX  VALUE LOW-VALUES.
    48 77  WS-ORIG-EFF-DT              PIC X(10)  VALUE SPACES.
    49 77  WS-EFF-DATE                 PIC X(10)  VALUE SPACES.
    50 77  WS-LF-EXP-DATE              PIC X(10)  VALUE SPACES.
    51 77  WS-AH-EXP-DATE              PIC X(10)  VALUE SPACES.
    52 77  WS-LOAN-EXP-DATE            PIC X(10)  VALUE SPACES.
    53 77  X1                          PIC S999 COMP-3 VALUE +0.
    54 77  S1                          PIC S999 COMP-3 VALUE +0.
    55 77  S2                          PIC S999 COMP-3 VALUE +0.
    56 77  S3                          PIC S999 COMP-3 VALUE +0.
    57 77  b1                          pic s999 comp-3 value +0.
    58 77  WS-BUILD-SW                 PIC X.
    59     88  TIME-TO-BUILD              VALUE 'Y'.
    60 77  WS-SAVE-ERACCT              PIC X(2000).
    61 77  WS-DIS-RESP                 PIC 9(05) VALUE ZEROS.
    62 77  WS-PERFORM-SW               PIC X VALUE SPACES.
    63     88  GET-RATES                   VALUE 'R'.
    64     88  GET-ACT-ACCTS               VALUE 'A'.
    65 77  ws-bin-current-dt           pic xx  value low-values.
    66 77  ws-bin-eff-dt               pic xx  value low-values.
    67 77  ws-bin-lf-exp-dt            pic xx  value low-values.
    68 77  ws-bin-ah-exp-dt            pic xx  value low-values.
    69 77  ws-bin-loan-exp-dt          pic xx  value low-values.
    70 77  ws-bin-1st-pmt-dt           pic xx  value low-values.
    71 77  ws-bin-pri-birth-dt         pic xx  value low-values.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   3
* WSMESS03.cbl
    72 77  ws-bin-cob-birth-dt         pic xx  value low-values.
    73 77  WS-DISP-AMT                 PIC Z,ZZZ,Z99.99.
    74 77  ws-disp-rate                pic z9.99999.
    75 77  WS-ERACCT-SW                PIC X VALUE ' '.
    76     88  END-OF-ERACCT                 VALUE 'Y'.
    77 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    78     88  END-OF-ERCTBL                 VALUE 'Y'.
    79 77  WS-STATUS                   PIC X.
    80 77  ws-socket-sw                pic x value ' '.
    81     88  end-of-socket              value 'Y'.
    82 77  rec-cnt                     pic 9(5) value zeros.
    83 77  ws-stop-sw                  pic x value ' '.
    84     88  i-say-stop                 value 'Y'.
    85 77  ws-browse-sw                pic x value ' '.
    86     88  browse-started            value 'Y'.
    87 77  ws-contract-sw              pic x  value ' '.
    88     88  contract-no-assigned      value 'Y'.
    89 77  ws-error-sw                 pic x value ' '.
    90     88  error-in-one-coverage     value 'Y'.
    91 77  ws-connect-sw               pic x value ' '.
    92     88  connected-to-db           value 'Y'.
    93 77  client-id                   pic xxx.
    94 77  ws-error-sub                pic 999  value zeros.
    95 77  ws-error-sup                pic x(25) value spaces.
    96 77  ws-form-limit-name          pic x(50) value spaces.
    97 77  l1                          pic s999 comp-3 value +0.
    98 77  ws-extension-days           pic 999 value zeros.
    99 77  d                           pic s9(5) comp-3 value +0.
   100 77  ws-life-coverage-sw         pic x value ' '.
   101     88  no-life-coverage          value 'Y'.
   102 01  P pointer.
   103 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   104 01  var-ptr pointer.
   105 01  env-var-len                 pic 9(4)  binary.
   106 01  rc                          pic 9(9)  binary.
   107 01  WS-KIXSYS.
   108     05  WS-KIX-FIL1             PIC X(10).
   109     05  WS-KIX-APPS             PIC X(10).
   110     05  WS-KIX-ENV              PIC X(10).
   111     05  WS-KIX-MYENV            PIC X(10).
   112     05  WS-KIX-SYS              PIC X(10).
   113 01  a-angle-n                   pic s9(7)v9(11) comp-3 value +0.
   114 01  a-prm-angle-n               pic s9(7)v9(11) comp-3 value +0.
   115 01  gamma                       pic s9(7)v9(11) comp-5 value +0.
   116 01  n                           pic s9(4)v9(4)  comp-3 value +0.
   117 01  i                           pic s9(7)v9(11) comp-3 value +0.
   118 01  ws-ins-per-month            pic s9(5)v99 comp-3 value +0.
   119 01  ws-prem-plus-int            pic s9(5)v99 comp-3 value +0.
   120 01  ws-tot-pmts-wo-ins          pic s9(7)v99 comp-3 value +0.
   121 01  ws-principal                pic s9(7)v99 comp-3 value +0.
   122 01  ws-amt-financed             pic s9(7)v99 comp-3 value +0.
   123 01  ws-loan-payment             pic s9(5)v99 comp-3 value +0.
   124 01  ppy                         pic s9(5)    comp-3 value +0.
   125 01  dpp                         pic s9(5)    comp-3 value +0.
   126 01  ELCNTL-KEY.
   127     05  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   128     05  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   129     05  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   4
* WSMESS03.cbl
   130     05  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   131 01  ws-lf-coverage-type         pic x value spaces.
   132 01  ws-lf-special-calc-cd       pic x value spaces.
   133 01  ws-lf-joint-indicator       pic x value spaces.
   134 01  ws-lf-earning-calc          pic x value spaces.
   135 01  ws-ah-coverage-type         pic x value spaces.
   136 01  ws-ah-special-calc-cd       pic x value spaces.
   137 01  ws-ah-joint-indicator       pic x value spaces.
   138 01  ws-ah-earnings-calc         pic x value spaces.
   139 01  ws-state-chg-ext-days       pic x value spaces.
*  140 EXEC SQL
*  141    INCLUDE SQLDA
*  142 END-EXEC
   143 01 SQLDA sync.
   144    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   145    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   146    05 SQLN                  PIC S9(4) COMP-5 value 0.
   147    05 SQLD                  PIC S9(4) COMP-5 value 0.
   148    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   149       10 SQLTYPE            PIC S9(4) COMP-5.
   150       10 SQLLEN             PIC S9(4) COMP-5.
   151$IF P64 SET
   152X      *> For 64-bit environments, ensure that SQLDATA is
   153X      *> aligned on an 8-byte boundary.
   154X      10 FILLER             PIC S9(9) COMP-5.
   155$END
   156       10 SQLDATA            USAGE POINTER.
   157       10 SQLIND             USAGE POINTER.
   158       10 SQLNAME.
   159          15 SQLNAMEL        PIC S9(4) COMP-5.
   160          15 SQLNAMEC        PIC X(30).
   161
   162* Values for SQLTYPE
   163
   164 78  ESQL-DATE-CHAR              VALUE 384.
   165 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   166 78  ESQL-DATE-REC               VALUE 386.
   167 78  ESQL-DATE-REC-NULL          VALUE 387.
   168 78  ESQL-TIME-CHAR              VALUE 388.
   169 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   170 78  ESQL-TIME-REC               VALUE 390.
   171 78  ESQL-TIME-REC-NULL          VALUE 391.
   172 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   173 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   174 78  ESQL-TIMESTAMP-REC          VALUE 394.
   175 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   176 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   177 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   178 78  ESQL-TS-OFFSET-REC          VALUE 398.
   179 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   180 78  ESQL-LONGVARBINARY          VALUE 404.
   181 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   182 78  ESQL-LONGVARCHAR            VALUE 408.
   183 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   184 78  ESQL-BINARY                 VALUE 444.
   185 78  ESQL-BINARY-NULL            VALUE 445.
   186 78  ESQL-VARBINARY              VALUE 446.
   187 78  ESQL-VARBINARY-NULL         VALUE 447.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   5
* WSMESS03.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   188 78  ESQL-VARCHAR                VALUE 448.
   189 78  ESQL-VARCHAR-NULL           VALUE 449.
   190
   191 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   192 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   193
   194 78  ESQL-CHAR                   VALUE 452.
   195 78  ESQL-CHAR-NULL              VALUE 453.
   196
   197 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   198 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   199
   200 78  ESQL-DOUBLE                 VALUE 480.
   201 78  ESQL-DOUBLE-NULL            VALUE 481.
   202 78  ESQL-REAL                   VALUE 482.
   203 78  ESQL-REAL-NULL              VALUE 483.
   204 78  ESQL-DECIMAL                VALUE 484.
   205 78  ESQL-DECIMAL-NULL           VALUE 485.
   206 78  ESQL-INTEGER                VALUE 496.
   207 78  ESQL-INTEGER-NULL           VALUE 497.
   208 78  ESQL-SMALLINT               VALUE 500.
   209 78  ESQL-SMALLINT-NULL          VALUE 501.
   210 78  ESQL-TINYINT                VALUE 502.
   211 78  ESQL-TINYINT-NULL           VALUE 503.
*  212 EXEC SQL
*  213    INCLUDE SQLCA
*  214 END-EXEC
   215 01 SQLCA.
   216     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   217     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   218     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   219     05  SQLERRM.
   220         49  SQLERRML    PIC S9(4) COMP-5.
   221         49  SQLERRMC    PIC X(70).
   222     05  SQLERRP         PIC X(8).
   223     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   224     05  SQLWARN.
   225         10  SQLWARN0    PIC X.
   226         10  SQLWARN1    PIC X.
   227         10  SQLWARN2    PIC X.
   228         10  SQLWARN3    PIC X.
   229         10  SQLWARN4    PIC X.
   230         10  SQLWARN5    PIC X.
   231         10  SQLWARN6    PIC X.
   232         10  SQLWARN7    PIC X.
   233     05  SQLEXT.
   234         10  SQLWARN8    PIC X.
   235         10  SQLWARN9    PIC X.
   236         10  SQLWARN10   PIC X.
   237         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   238     05  SQLSTATE    PIC X(5).
   239 EXEC SQL
   240    BEGIN DECLARE SECTION
   241 END-EXEC
   242 01  ws-dealer-state             pic xx.
   243 01  ws-dealer-id                pic x(10).
   244 01  ws-contract-eff-dt          pic x(10).
   245 01  ws-contract-no              pic x(10) value spaces.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   6
* WSMESS03.cbl
   246 01  ws-contract-suffix          pic x     value spaces.
   247 01  ws-key-stuff.
   248     05  ws-ks-contract-no       pic x(10) value spaces.
   249     05  ws-batch-no             pic x(6) value zeros.
   250     05  ws-batch-no-n redefines
   251         ws-batch-no             pic 9(6).
   252     05  ws-check-key            pic 9(7).
   253     05  ws-check-no             pic x(7).
   254     05  ws-compid               pic xxx.
   255     05  ws-carrier              pic x.
   256     05  ws-grouping             pic x(6).
   257     05  ws-state                pic xx.
   258     05  ws-account              pic x(10).
   259     05  ws-eff-date             pic x(10).
   260     05  ws-certificate          pic x(10).
   261     05  ws-cert-sfx             pic x.
   262     05  ws-seq-no               pic 999.
   263     05  ws-type                 pic 999.
   264 01  ws-status-code-a            pic x(7) value zeros.
   265 01  ws-status-code redefines
   266     ws-status-code-a            pic 9(7).
   267 01  ws-error-message            pic x(50) value spaces.
   268 01  ws-status-date              pic x(10).
   269 01  sqlcmd                      pic x(1024).
   270 01  svr                         pic x(32).
   271 01  usr                         pic x(32).
   272 01  pass                        pic x(32).
   273 01  usr-pass                    pic x(64).
   274 01  ws-disp-code                pic s9(11).
   275***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   276***                                                            ***
   277***  These indicators are used to determine if a variable      ***
   278***  is        null.           The indicator will be -1        ***
   279***  if the value        is null  and +0 if the value is       ***
   280***  something other than null.  Here is an example on how     ***
   281***  to use the indicator variables.                           ***
   282***                                                            ***
   283***     EXEC SQL                                               ***
   284***        fetch checkapp into                                 ***
   285***           :db-app-status :nu-app-status,                   ***
   286***           :db-app-by     :nu-app-by,                       ***
   287***           :db-app-date   :nu-app-date,                     ***
   288***           :db-app-batch  :nu-app-batch                     ***
   289***     END-EXEC                                               ***
   290***                                                            ***
   291***           OR This way on an update                         ***
   292***                                                            ***
   293***     EXEC SQL                                               ***
   294***        UPDATE                                              ***
   295***           CUC_Logic_Remittance                             ***
   296***        SET                                                 ***
   297***           LogicStatus     = :ws-status-code,               ***
   298***           LogicStatusDate = :ws-status-date,               ***
   299***           BatchNumber     = :ws-batch-no :nu-batchno       ***
   300***        WHERE                                               ***
   301***           RemitId = :ws-remit-id                           ***
   302***     END-EXEC                                               ***
   303***                                                            ***
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   7
* WSMESS03.cbl
   304***    Also, when the table has a column with a data type of   ***
   305***  "BIT" and used as true/false move the 1 byte receiving    ***
   306***  field to ws-bit and check out ws-bit-comp. if = zeros,    ***
   307***  then its false. I think true would be 256.                ***
   308***                                                            ***
   309***                                                            ***
   310***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   311 01  ws-bit                      pic x.
   312 01  ws-bit-comp redefines ws-bit pic s9(4) comp.
   313 01  indicator-vaiables-for-nulls.
   314     05  nu-partial-cov          pic s9(4) comp value +0.
   315     05  nu-check-elig           pic s9(4) comp value +0.
   316     05  nu-app-status           pic s9(4) comp value +0.
   317     05  nu-app-by               pic s9(4) comp value +0.
   318     05  nu-app-date             pic s9(4) comp value +0.
   319     05  nu-app-batch            pic s9(4) comp value +0.
   320     05  nu-fincar               pic s9(4) comp value +0.
   321     05  nu-batchno              pic s9(4) comp value +0.
   322     05  nu-error-message        pic s9(4) comp value +0.
   323 01  sql-cert-records.
   324     05  sql-dlr-state           pic xx.
   325     05  sql-dlr-id              pic x(10).
   326     05  sql-eff-dt              pic x(10).
   327     05  sql-contr-no            pic x(10).
   328     05  sql-contr-suffix        pic x.
   329 01  ws-limit-issue-age          pic 999.
   330 01  ws-att-age                  pic 999.
   331 01  form-limit-table.
   332     05  ws-limit-name           pic x(50).
   333     05  ws-limit-cov-type       pic xx.
   334     05  ws-limit-lo-age         pic 999.
   335     05  ws-limit-hi-age         pic 999.
   336     05  ws-limit-att-age        pic 999.
   337     05  ws-limit-max-term       pic 999.
   338     05  ws-limit-max-jnt-term   pic 999.
   339     05  ws-limit-max-mo-ben     pic 9(5).
   340     05  ws-limit-max-tot-ben    pic 9(7).
   341     05  ws-limit-partial-cov    pic s9(4) comp-5.
   342     05  ws-limit-check-elig     pic s9(4) comp-5.
   343     05  ws-limit-elig-max-term  pic 999.
   344 01  state-benefit-code-table.
   345     05  ws-sbc-min-amt          pic 999999.
   346     05  ws-sbc-state            pic xx.
   347     05  ws-sbc-cov-type         pic xx.
   348     05  ws-sbc-ben-amt          pic 999999.
   349     05  ws-sbc-sin-jnt          pic x.
   350     05  ws-sbc-dismember        pic x.
   351     05  ws-sbc-retroelim        pic x.
   352     05  ws-sbc-wait-days        pic 999.
   353     05  ws-sbc-max-bens         pic 999.
   354     05  ws-sbc-logic-ben-code   pic xx.
   355 EXEC SQL
   356    END DECLARE SECTION
   357 END-EXEC
   358 01  filler.
   359     05  ws-work-in              pic x(10).
   360     05  ws-work-out             pic x(10).
   361     05  ws-work-out-v2 redefines
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   8
* WSMESS03.cbl
   362         ws-work-out             pic 9(8)v99.
   363     05  ws-work-out-v0 redefines
   364         ws-work-out             pic 9(10).
   365     05  ws-work-out-v5 redefines
   366         ws-work-out             pic 9(5)v9(5).
   367 01  filler.
   368     05  ws-last-suffix          pic x value low-values.
   369     05  ws-tbl-last-suffix      pic x value low-values.
   370     05  filler.  *> Use X1 for this table.
   371         10  ws-codes            pic x(26) value
   372         ' ABCDEFGHIJKLMNOPQRSTUVWXY'.
   373         10  ws-suffix-value redefines ws-codes
   374           occurs 26             pic x.
   375 01  ws-work-date.
   376     05  ws-work-ccyy            pic x(4).
   377     05  ws-work-mm              pic xx.
   378     05  ws-work-dd              pic xx.
   379 01  ws-work-date-num redefines ws-work-date
   380                                 pic 9(8).
   381 01  raw-message003-area.
   382     05  raw-message-num         pic x(10).
   383     05  raw-state               pic xx.
   384     05  raw-acct-no             pic x(10).
   385     05  raw-vin                 pic x(17).
   386     05  raw-lf-ben-code         pic xx.
   387     05  raw-ah-ben-code         pic xx.
   388     05  raw-earn-meth           pic x.
   389     05  raw-pri-birth-date      pic x(10).
   390     05  raw-cob-birth-date      pic x(10).
   391     05  raw-loan-amt            pic x(9).
   392     05  raw-eff-date            pic x(10).
   393     05  raw-1st-pmt-dt          pic x(10).
   394     05  raw-pmts-per-year       pic xx.
   395     05  raw-lf-premium          pic x(8).
   396     05  raw-ah-premium          pic x(8).
   397     05  raw-loan-term           pic xxx.
   398     05  raw-lf-term             pic XXX.
   399     05  raw-ah-term             pic xxx.
   400     05  raw-apr                 pic x(8).
   401     05  raw-lf-sin-jnt-ind      pic x.
   402     05  raw-ah-sin-jnt-ind      pic x.
   403     05  raw-lf-dismemberment    pic x.
   404     05  raw-retro-elim          pic x.
   405     05  raw-waiting-days        pic xx.
   406     05  raw-crit-per            pic xx.
   407     05  raw-total-payments      pic x(9).
   408     05  raw-period-payment      pic x(8).
   409 01  ws-rate-work-area.
   410     05  ws-rate-state           pic xx.
   411     05  ws-rate-acct-no         pic x(10).
   412     05  ws-rate-vin             pic x(17).
   413     05  ws-rate-in-lf-ben-code  pic xx.
   414     05  ws-rate-in-ah-ben-code  pic xx.
   415     05  ws-rate-earn-meth       pic x.
   416     05  ws-rate-pri-birth-date  pic x(10).
   417     05  ws-rate-cob-birth-date  pic x(10).
   418     05  ws-rate-eff-date        pic x(10).
   419     05  ws-rate-1st-pmt-dt      pic x(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page   9
* WSMESS03.cbl
   420     05  ws-rate-benefit-type    pic x.
   421     05  ws-rate-lf-benefit-cd   pic xx.
   422     05  ws-rate-ah-benefit-cd   pic xx.
   423     05  ws-rate-benefit         pic 9(6)v99.
   424     05  ws-rate-loan-pmt        pic 9(7)v99.
   425     05  ws-rate-tot-pmts        pic 9(6)v99.
   426     05  ws-rate-lf-prem         pic 9(5)v99.
   427     05  ws-rate-ah-prem         pic 9(5)v99.
   428     05  ws-rate-new-lf-prem     pic 9(5)v99.
   429     05  ws-rate-new-ah-prem     pic 9(5)v99.
   430     05  ws-rate-lf-rate         pic 99v9(5).
   431     05  ws-rate-ah-rate         pic 99v9(5).
   432     05  ws-rate-apr             pic 99v9(5).
   433     05  ws-rate-pmts-per-year   pic 99.
   434     05  ws-rate-loan-term       pic 999  value zeros.
   435     05  ws-rate-lf-term         pic 999  value zeros.
   436     05  ws-rate-ah-term         pic 999  value zeros.
   437     05  ws-issue-age            pic 999  value zeros.
   438     05  ws-cob-age              pic 999  value zeros.
   439     05  ws-rate-age             pic 999  value zeros.
   440     05  ws-max-lf-benefit       pic 9(7)v99 value zeros.
   441     05  ws-max-ah-benefit       pic 9(7)v99 value zeros.
   442     05  ws-rate-crit-per        pic 99.
   443     05  ws-rate-sin-jnt-lf      pic x.
   444     05  ws-rate-sin-jnt-ah      pic x.
   445     05  ws-rate-dismemberment   pic x.
   446     05  ws-rate-retro-elim      pic x.
   447     05  ws-rate-waiting-days    pic 99.
   448     05  ws-rate-payment         pic 9(5)v99.
   449     05  ws-calc-tot-pmts        pic 9(7)v99 value zeros.
   450     05  ws-rate-amt-financed    pic 9(7)v99 value zeros.
   451     05  ws-rate-loan-type       pic x.
   452 01  ws-lf-limits.
   453     05  ws-lf-limit-lo-age         pic 999.
   454     05  ws-lf-limit-hi-age         pic 999.
   455     05  ws-lf-limit-att-age        pic 999.
   456     05  ws-lf-limit-max-term       pic 999.
   457     05  ws-lf-limit-max-benefit    pic 9(7).
   458     05  ws-lf-limit-partial-cov    pic s9(4) comp-5.
   459     05  ws-lf-limit-check-elig     pic s9(4) comp-5.
   460     05  ws-lf-limit-elig-max-term  pic 999.
   461 01  ws-di-limits.
   462     05  ws-di-limit-lo-age         pic 999.
   463     05  ws-di-limit-hi-age         pic 999.
   464     05  ws-di-limit-att-age        pic 999.
   465     05  ws-di-limit-max-term       pic 999.
   466     05  ws-di-limit-max-jnt-term   pic 999.
   467     05  ws-di-limit-max-mo-ben     pic 9(5).
   468     05  ws-di-limit-max-tot-ben    pic 9(7).
   469     05  ws-di-limit-partial-cov    pic s9(4) comp-5.
   470     05  ws-di-limit-check-elig     pic s9(4) comp-5.
   471     05  ws-di-limit-elig-max-term  pic 999.
   472 01  WS-AM-KEY.
   473     05  WS-AM-COMPANY-CD        PIC X.
   474     05  WS-AM-CARRIER           PIC X.
   475     05  WS-AM-GROUP             PIC X(6).
   476     05  WS-AM-STATE             PIC XX.
   477     05  WS-AM-ACCOUNT           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  10
* WSMESS03.cbl
   478     05  WS-AM-EXP-DT            PIC XX.
   479     05  FILLER                  PIC X(4).
   480 01  ws-cm5-compare-key          pic x(12).
   481 01  WS-CM5-KEY.
   482     05  WS-CM5-COMPANY-CD       PIC X.
   483     05  WS-CM5-CERT-NO          PIC X(11).
   484 01  ws-cm-compare-key           pic x(33).
   485 01  WS-CM-KEY.
   486     05  WS-CM-COMPANY-CD        PIC X.
   487     05  WS-CM-CARRIER           PIC X.
   488     05  WS-CM-GROUP             PIC X(6).
   489     05  WS-CM-STATE             PIC XX.
   490     05  WS-CM-ACCOUNT           PIC X(10).
   491     05  WS-CM-EFF-DT            PIC XX.
   492     05  WS-CM-CERT-NO.
   493         10  ws-cm-cert-ten      pic x(10).
   494         10  ws-cm-cert-suffix   pic x.
   495 01  WS-CS-KEY.
   496     05  WS-CS-COMPANY-CD        PIC X.
   497     05  WS-CS-CARRIER           PIC X.
   498     05  WS-CS-GROUP             PIC X(6).
   499     05  WS-CS-STATE             PIC XX.
   500     05  WS-CS-ACCOUNT           PIC X(10).
   501     05  WS-CS-EFF-DT            PIC XX.
   502     05  WS-CS-CERT-NO           PIC X(11).
   503     05  WS-CS-TRLR-TYPE         PIC X.
   504 01  WS-AM-ALT-KEY.
   505     05  WS-AM-ALT-ACCOUNT       PIC X(10).
   506     05  WS-AM-ALT-EXP-DT        PIC XX.
   507 01  WS-CF-KEY-SAVE              PIC X(10).
   508 01  WS-CF-KEY.
   509     05  WS-CF-COMPANY-ID        PIC XXX.
   510     05  WS-CF-RECORD-TYPE       PIC X.
   511     05  WS-CF-ACCESS            PIC X(4).
   512     05  WS-CF-SEQ-NO            PIC S9(4) COMP.
   513 01  filler.
   514     05  ws-errors-table.
   515         10  filler              pic x(130) value
   516         '0000Transaction successfully completed'.
   517         10  filler              pic x(130) value
   518         '0101Amount entered contains invalid characters. Please c
   519-        'orrect and re-submit'.
   520         10  filler              pic x(130) value
   521         '0102Date entered is invalid. Please correct and re-submi
   522-        't'.
   523         10  filler              pic x(130) value
   524         '0103Customer age exceeds age limit. Not eligible for cov
   525-        'erage'.
   526         10  filler              pic x(130) value
   527         '0104Customer will exceed age limit during term of covera
   528-        'ge. Not eligible for coverage'.
   529         10  filler              pic x(130) value
   530         '0105Invalid loan term. Term must be more than 0 and less
   531-        ' than 360'.
   532         10  filler              pic x(130) value
   533         '0106Insurance term exceeds maximum term allowed. Loan is
   534-        ' not eligible for credit insurance'.
   535         10  filler              pic x(130) value
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  11
* WSMESS03.cbl
   536         '0107Insurance term exceeds maximum term allowed. Loan is
   537-        ' not eligible for Joint credit disability insurance'.
   538         10  filler              pic x(130) value
   539         '0108Insurance term exceeds maximum term allowed. Loan is
   540-        ' not eligible for credit disability insurance'.
   541         10  filler              pic x(130) value
   542         '0109Total of payments exceeds maximum allowed. Loan is n
   543-        'ot eligible for credit insurance'.
   544         10  filler              pic x(130) value
   545         '0110Monthly payment exceeds maximum allowed. Loan is not
   546-        ' eligible for disability insurance'.
   547         10  filler              pic x(130) value
   548         '0111Loan term cannot be less than insurance term. Loan i
   549-        's not eligible for credit insurance'.
   550         10  filler              pic x(130) value
   551         '0112Term times monthly payment exceeds Maximum total dis
   552-        'ability benefit. Loan is not eligible for credit disabil
   553-        'ity insurance'.
   554         10  filler              pic x(130) value
   555         '0113Cannot rate based on existing loan terms'.
   556         10  filler              pic x(130) value
   557         '0114Cannot rate life coverage based on existing loan ter
   558-        'ms'.
   559         10  filler              pic x(130) value
   560         '0115Cannot rate disability coverage based on existing lo
   561-        'an terms'.
   562         10  filler              pic x(130) value
   563         '0116Problem with rate file. Unable to rate'.
   564         10  filler              pic x(130) value
   565         '0117Calculated premium is outside of tolerance'.
   566         10  filler              pic x(130) value
   567         '0118This appears to be a duplicate record. Unable to rat
   568-        'e'.
   569         10  filler              pic x(130) value
   570         '0119Loan term and insurance term cannot be zero. Unable
   571-        'to rate'.
   572         10  filler              pic x(130) value
   573         '0120Loan term and insurance term cannot be zero. Unable
   574-        'to rate'.
   575         10  filler              pic x(130) value
   576         '0121Cannot locate limit table. Unable to rate'.
   577         10  filler              pic x(130) value
   578         '0122Invalid company id '.
   579         10  filler              pic x(130) value
   580         '0123Cannot locate life benefit code. Unable to rate'.
   581         10  filler              pic x(130) value
   582         '0124Cannot locate disability benefit code. Unable to rat
   583-        'e'.
   584         10  filler              pic x(130) value
   585         '0125Calculated total of payments do not match submitted
   586-        'total of payments. Unable to rate'.
   587         10  filler              pic x(130) value
   588         '0126Life and Disability Terms must be the same'.
   589         10  filler              pic x(130) value
   590         '0127Loan term must match insurance term on gross coverag
   591-        'e. Unable to rate'.
   592         10  filler              pic x(130) value
   593         '0128Total of payments does not match benefit amount prov
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  12
* WSMESS03.cbl
   594-        'ided on Gross coverage. Unable to rate'.
   595         10  filler              pic x(130) value
   596         '0129Calculated amount financed does not match provided a
   597-        'mount financed. Unable to rate'.
   598         10  filler              pic x(130) value
   599         '0130Insurance term exceeds maximum eligibility term. Loa
   600-        'n is not eligible for credit insurance'.
   601         10  filler              pic x(130) value
   602         '0131Amount exceeds maximum eligibility amount. Loan is n
   603-        'ot eligible for credit insurance'.
   604         10  filler              pic x(130) value
   605         '0132Disability only certificate is not allowed. Loan is
   606-        'not eligible for credit insurance'.
   607     05  filler redefines ws-errors-table occurs 33.
   608         10  ws-table-error-no   pic x(4).
   609         10  ws-table-error-mess pic x(126).
   610 01  ws-return-string.
   611     05  ws-return-error-no      pic x(4).
   612     05  ws-sc1                  pic x.
   613     05  ws-return-error-mess    pic x(150).
   614     05  ws-sc2                  pic x.
   615     05  ws-return-contract-no   pic x(11).
   616     05  ws-sc3                  pic x.
   617     05  ws-return-lf-max-ben    pic z,zzz,z99.99.
   618     05  ws-sc4                  pic x.
   619     05  ws-return-ah-max-amt    pic z,zzz,z99.99.
   620     05  ws-sc5                  pic x.
   621     05  ws-return-lf-prem       pic z,zzz,z99.99.
   622     05  ws-sc6                  pic x.
   623     05  ws-return-ah-prem       pic z,zzz,z99.99.
   624     05  ws-sc7                  pic x.
   625     05  ws-return-lf-rate       pic z9.99999.
   626     05  ws-sc8                  pic x.
   627     05  ws-return-ah-rate       pic z9.99999.
   628     05  ws-sc9                  pic x.
   629     05  ws-return-lf-exp-dt     pic x(10).
   630     05  ws-sc10                 pic x.
   631     05  ws-return-ah-exp-dt     pic x(10).
   632     05  ws-sc11                 pic x.
   633     05  ws-return-lf-benefit-cd pic xx.
   634     05  ws-sc12                 pic x.
   635     05  ws-return-ah-benefit-cd pic xx.
   636     05  ws-sc13                 pic x.
   637     05  ws-return-period-pmt    pic zzz,z99.99.
   638     05  ws-sc14                 pic x.
   639     05  ws-return-tot-financed  pic z,zzz,z99.99.
   640     05  ws-sc15                 pic x.
   641     05  ws-return-tot-pmts      pic z,zzz,z99.99.
   642     05  ws-sc16                 pic x.
   643     05  ws-return-loan-exp-dt   pic x(10).
   644     05  ws-sc17                 pic x.
   645     05  ws-return-limit-name    pic x(50).
   646     05  ws-sc18                 pic x.
   647     05  ws-return-rate-class    pic xx.
   648     05  ws-sc19                 pic x.
   649     05  ws-return-loan-pmt      pic zzz,z99.99.
   650     05  ws-sc20                 pic x.
   651     05  ws-return-principal     pic zzz,z99.99.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  13
* WSMESS03.cbl
   652     05  ws-sc21                 pic x.
   653     05  ws-return-lf-term       pic zz9.
   654     05  ws-sc22                 pic x.
   655     05  ws-return-ah-term       pic zz9.
   656     05  ws-sc23                 pic x.
   657     05  ws-return-lf-bencd      pic xx.
   658     05  ws-sc24                 pic x.
   659     05  ws-return-max-bens      pic 99.
   660 01  ws-mess003-length           pic s9(4) comp value +1024.
   661 01  WS-MESS003-PASS-AREA        PIC X(1024).
   662 01  WS-CID-NO                   PIC X(8).
   663 01  WS-DISP-RESP                PIC 9(5).
   664 01  WS-RESPONSE                 PIC S9(8)   COMP.
   665     88  RESP-NORMAL                  VALUE +00.
   666     88  RESP-NOTFND                  VALUE +13.
   667     88  resp-duprec                  value +14.
   668     88  resp-dupkey                  value +15.
   669     88  RESP-NOTOPEN                 VALUE +19.
   670     88  RESP-ENDFILE                 VALUE +20.
   671*                                 COPY ERCACCT.
   672******************************************************************
   673*                                                                *
   674*                                                                *
   675*                            ERCACCT                             *
   676*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   677*                            VMOD=2.031                          *
   678*                                                                *
   679*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   680*                                                                *
   681*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   682*   VSAM ACCOUNT MASTER FILES.                                   *
   683*                                                                *
   684*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   685*                                                                *
   686*   FILE TYPE = VSAM,KSDS                                        *
   687*   RECORD SIZE = 2000  RECFORM = FIX                            *
   688*                                                                *
   689*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   690*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   691*                                                                *
   692*   LOG = NO                                                     *
   693*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   694*                                                                *
   695*                                                                *
   696******************************************************************
   697*                   C H A N G E   L O G
   698*
   699* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   700*-----------------------------------------------------------------
   701*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   702* EFFECTIVE    NUMBER
   703*-----------------------------------------------------------------
   704* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   705* 092705    2005050300006  PEMA  ADD SPP LEASES
   706* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   707* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   708* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   709* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  14
* WSMESS03.cbl
   710* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   711* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
   712******************************************************************
   713
   714 01  ACCOUNT-MASTER.
   715     12  AM-RECORD-ID                      PIC XX.
   716         88  VALID-AM-ID                      VALUE 'AM'.
   717
   718     12  AM-CONTROL-PRIMARY.
   719         16  AM-COMPANY-CD                 PIC X.
   720         16  AM-MSTR-CNTRL.
   721             20  AM-CONTROL-A.
   722                 24  AM-CARRIER            PIC X.
   723                 24  AM-GROUPING.
   724                     28 AM-GROUPING-PREFIX PIC XXX.
   725                     28 AM-GROUPING-PRIME  PIC XXX.
   726                 24  AM-STATE              PIC XX.
   727                 24  AM-ACCOUNT.
   728                     28  AM-ACCOUNT-PREFIX PIC X(4).
   729                     28  AM-ACCOUNT-PRIME  PIC X(6).
   730             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   731                                           PIC X(19).
   732             20  AM-CNTRL-B.
   733                 24  AM-EXPIRATION-DT      PIC XX.
   734                 24  FILLER                PIC X(4).
   735             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   736                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   737
   738     12  AM-CONTROL-BY-VAR-GRP.
   739         16  AM-COMPANY-CD-A1              PIC X.
   740         16  AM-VG-CARRIER                 PIC X.
   741         16  AM-VG-GROUPING                PIC X(6).
   742         16  AM-VG-STATE                   PIC XX.
   743         16  AM-VG-ACCOUNT                 PIC X(10).
   744         16  AM-VG-DATE.
   745             20  AM-VG-EXPIRATION-DT       PIC XX.
   746             20  FILLER                    PIC X(4).
   747         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   748                                           PIC 9(11)      COMP-3.
   749     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   750         16  FILLER                        PIC X(10).
   751         16  AM-VG-KEY3.
   752             20  AM-VG3-ACCOUNT            PIC X(10).
   753             20  AM-VG3-EXP-DT             PIC XX.
   754         16  FILLER                        PIC X(4).
   755     12  AM-MAINT-INFORMATION.
   756         16  AM-LAST-MAINT-DT              PIC XX.
   757         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   758         16  AM-LAST-MAINT-USER            PIC X(4).
   759         16  FILLER                        PIC XX.
   760
   761     12  AM-EFFECTIVE-DT                   PIC XX.
   762     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   763
   764     12  AM-PREV-DATES  COMP-3.
   765         16  AM-PREV-EXP-DT                PIC 9(11).
   766         16  AM-PREV-EFF-DT                PIC 9(11).
   767
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  15
* WSMESS03.cbl
   768     12  AM-REPORT-CODE-1                  PIC X(10).
   769     12  AM-REPORT-CODE-2                  PIC X(10).
   770
   771     12  AM-CITY-CODE                      PIC X(4).
   772     12  AM-COUNTY-PARISH                  PIC X(6).
   773
   774     12  AM-NAME                           PIC X(30).
   775     12  AM-PERSON                         PIC X(30).
   776     12  AM-ADDRS                          PIC X(30).
   777     12  AM-CITY.
   778         16  AM-ADDR-CITY                  PIC X(28).
   779         16  AM-ADDR-STATE                 PIC XX.
   780     12  AM-ZIP.
   781         16  AM-ZIP-PRIME.
   782             20  AM-ZIP-PRI-1ST            PIC X.
   783                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   784             20  FILLER                    PIC X(4).
   785         16  AM-ZIP-PLUS4                  PIC X(4).
   786     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   787         16  AM-CAN-POSTAL-1               PIC XXX.
   788         16  AM-CAN-POSTAL-2               PIC XXX.
   789         16  FILLER                        PIC XXX.
   790     12  AM-TEL-NO.
   791         16  AM-AREA-CODE                  PIC 999.
   792         16  AM-TEL-PRE                    PIC 999.
   793         16  AM-TEL-NBR                    PIC 9(4).
   794     12  AM-TEL-LOC                        PIC X.
   795         88  AM-TEL-AT-HOME                   VALUE 'H'.
   796         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   797
   798     12  AM-COMM-STRUCTURE.
   799         16  AM-DEFN-1.
   800             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   801                 24  AM-AGT.
   802                     28  AM-AGT-PREFIX     PIC X(4).
   803                     28  AM-AGT-PRIME      PIC X(6).
   804                 24  AM-COM-TYP            PIC X.
   805                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   806                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   807                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   808                 24  AM-RECALC-LV-INDIC    PIC X.
   809                 24  AM-RETRO-LV-INDIC     PIC X.
   810                 24  AM-GL-CODES           PIC X.
   811                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   812                 24  FILLER                PIC X(01).
   813         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   814             20  AM-COM-TBLS        OCCURS 10 TIMES.
   815                 24  FILLER                PIC X(11).
   816                 24  AM-L-COMA             PIC XXX.
   817                 24  AM-J-COMA             PIC XXX.
   818                 24  AM-A-COMA             PIC XXX.
   819                 24  FILLER                PIC X(6).
   820
   821     12  AM-COMM-CHANGE-STATUS             PIC X.
   822         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   823
   824     12  AM-CSR-CODE                       PIC X(4).
   825
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  16
* WSMESS03.cbl
   826     12  AM-BILLING-STATUS                 PIC X.
   827         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   828         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   829     12  AM-AUTO-REFUND-SW                 PIC X.
   830         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   831         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   832     12  AM-GPCD                           PIC 99.
   833     12  AM-IG                             PIC X.
   834         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   835         88  AM-HAS-GROUP                     VALUE '2'.
   836     12  AM-STATUS                         PIC X.
   837         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   838         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   839         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   840         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   841         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   842         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   843         88  AM-ACCOUNT-DROPPED               VALUE '6'.
   844         88  AM-ACCOUNT-LAPSED                VALUE '7'.
   845         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
   846         88  AM-ACCOUNT-PENDING               VALUE '9'.
   847     12  AM-REMIT-TO                       PIC 99.
   848     12  AM-ID-NO                          PIC X(11).
   849
   850     12  AM-CAL-TABLE                      PIC XX.
   851     12  AM-LF-DEVIATION                   PIC XXX.
   852     12  AM-AH-DEVIATION                   PIC XXX.
   853     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   854     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   855     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   856     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   857     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   858     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   859
   860     12  AM-USER-FIELDS.
   861         16  AM-FLD-1                      PIC XX.
   862         16  AM-FLD-2                      PIC XX.
   863         16  AM-FLD-3                      PIC XX.
   864         16  AM-FLD-4                      PIC XX.
   865         16  AM-FLD-5                      PIC XX.
   866
   867     12  AM-1ST-PROD-DATE.
   868         16  AM-1ST-PROD-YR                PIC XX.
   869         16  AM-1ST-PROD-MO                PIC XX.
   870         16  AM-1ST-PROD-DA                PIC XX.
   871     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   872     12  AM-CERTS-PURGED-DATE.
   873         16  AM-PUR-YR                     PIC XX.
   874         16  AM-PUR-MO                     PIC XX.
   875         16  AM-PUR-DA                     PIC XX.
   876     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   877     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   878     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   879     12  AM-INACTIVE-DATE.
   880         16  AM-INA-MO                     PIC 99.
   881         16  AM-INA-DA                     PIC 99.
   882         16  AM-INA-YR                     PIC 99.
   883     12  AM-AR-HI-CERT-DATE                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  17
* WSMESS03.cbl
   884
   885     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   886     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   887
   888     12  AM-OB-PAYMENT-MODE                PIC X.
   889         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   890         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   891         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   892         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   893
   894     12  AM-AH-ONLY-INDICATOR              PIC X.
   895         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   896         88  AM-NO-AH-ONLY                    VALUE 'N'.
   897
   898     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   899
   900     12  AM-OVER-SHORT.
   901         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   902         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   903
   904     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   905     12  AM-DCC-CLP-STATE                  PIC XX.
   906
   907     12  AM-RECALC-COMM                    PIC X.
   908     12  AM-RECALC-REIN                    PIC X.
   909
   910     12  AM-REI-TABLE                      PIC XXX.
   911     12  AM-REI-ET-LF                      PIC X.
   912     12  AM-REI-ET-AH                      PIC X.
   913     12  AM-REI-PE-LF                      PIC X.
   914     12  AM-REI-PE-AH                      PIC X.
   915     12  AM-REI-PRT-ST                     PIC X.
   916     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   917     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   918     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   919     12  AM-REI-GROUP-A                    PIC X(6).
   920     12  AM-REI-MORT                       PIC X(4).
   921     12  AM-REI-PRT-OW                     PIC X.
   922     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   923     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   924     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   925     12  AM-REI-GROUP-B                    PIC X(6).
   926
   927     12  AM-TRUST-TYPE                     PIC X(2).
   928
   929     12  AM-EMPLOYER-STMT-USED             PIC X.
   930     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   931
   932     12  AM-STD-AH-TYPE                    PIC XX.
   933     12  AM-EARN-METHODS.
   934         16  AM-EARN-METHOD-R              PIC X.
   935             88 AM-REF-RL-R78                 VALUE 'R'.
   936             88 AM-REF-RL-PR                  VALUE 'P'.
   937             88 AM-REF-RL-MEAN                VALUE 'M'.
   938             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   939         16  AM-EARN-METHOD-L              PIC X.
   940             88 AM-REF-LL-R78                 VALUE 'R'.
   941             88 AM-REF-LL-PR                  VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  18
* WSMESS03.cbl
   942             88 AM-REF-LL-MEAN                VALUE 'M'.
   943             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   944         16  AM-EARN-METHOD-A              PIC X.
   945             88 AM-REF-AH-R78                 VALUE 'R'.
   946             88 AM-REF-AH-PR                  VALUE 'P'.
   947             88 AM-REF-AH-MEAN                VALUE 'M'.
   948             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   949             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   950             88 AM-REF-AH-NET                 VALUE 'N'.
   951
   952     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   953     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   954     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   955
   956     12  AM-RET-Y-N                        PIC X.
   957     12  AM-RET-P-E                        PIC X.
   958     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   959     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   960     12  AM-RET-GRP                        PIC X(6).
   961     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   962         16  AM-POOL-PRIME                 PIC XXX.
   963         16  AM-POOL-SUB                   PIC XXX.
   964     12  AM-RETRO-EARNINGS.
   965         16  AM-RET-EARN-R                 PIC X.
   966         16  AM-RET-EARN-L                 PIC X.
   967         16  AM-RET-EARN-A                 PIC X.
   968     12  AM-RET-ST-TAX-USE                 PIC X.
   969         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   970         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   971     12  AM-RETRO-BEG-EARNINGS.
   972         16  AM-RET-BEG-EARN-R             PIC X.
   973         16  AM-RET-BEG-EARN-L             PIC X.
   974         16  AM-RET-BEG-EARN-A             PIC X.
   975     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   976     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   977
   978     12  AM-USER-SELECT-OPTIONS.
   979         16  AM-USER-SELECT-1              PIC X(10).
   980         16  AM-USER-SELECT-2              PIC X(10).
   981         16  AM-USER-SELECT-3              PIC X(10).
   982         16  AM-USER-SELECT-4              PIC X(10).
   983         16  AM-USER-SELECT-5              PIC X(10).
   984
   985     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   986
   987     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   988
   989     12  AM-RPT045A-SWITCH                 PIC X.
   990         88  RPT045A-OFF                   VALUE 'N'.
   991
   992     12  AM-INSURANCE-LIMITS.
   993         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   994         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   995
   996     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   997         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   998
   999     12  AM-DISMBR-COVERAGE-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  19
* WSMESS03.cbl
  1000         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1001         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1002
  1003     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1004
  1005     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1006     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1007     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1008     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1009     12  AM-DCC-UEF-STATE                  PIC XX.
  1010     12  FILLER                            PIC XXX.
  1011     12  AM-REPORT-CODE-3                  PIC X(10).
  1012*    12  FILLER                            PIC X(22).
  1013
  1014     12  AM-RESERVE-DATE.
  1015         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1016         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1017         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1018
  1019     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1020     12  AM-NOTIFICATION-TYPES.
  1021         16  AM-NOTIF-OF-LETTERS           PIC X.
  1022         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1023         16  AM-NOTIF-OF-REPORTS           PIC X.
  1024         16  AM-NOTIF-OF-STATUS            PIC X.
  1025
  1026     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1027         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1028         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1029         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1030         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1031
  1032     12  AM-BENEFIT-CONTROLS.
  1033         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1034             20  AM-BENEFIT-CODE           PIC XX.
  1035             20  AM-BENEFIT-TYPE           PIC X.
  1036             20  AM-BENEFIT-REVISION       PIC XXX.
  1037             20  AM-BENEFIT-REM-TERM       PIC X.
  1038             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1039             20  FILLER                    PIC XX.
  1040         16  FILLER                        PIC X(80).
  1041
  1042     12  AM-TRANSFER-DATA.
  1043         16  AM-TRANSFERRED-FROM.
  1044             20  AM-TRNFROM-CARRIER        PIC X.
  1045             20  AM-TRNFROM-GROUPING.
  1046                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1047                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1048             20  AM-TRNFROM-STATE          PIC XX.
  1049             20  AM-TRNFROM-ACCOUNT.
  1050                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1051                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1052             20  AM-TRNFROM-DTE            PIC XX.
  1053         16  AM-TRANSFERRED-TO.
  1054             20  AM-TRNTO-CARRIER          PIC X.
  1055             20  AM-TRNTO-GROUPING.
  1056                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1057                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  20
* WSMESS03.cbl
  1058             20  AM-TRNTO-STATE            PIC XX.
  1059             20  AM-TRNTO-ACCOUNT.
  1060                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1061                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1062             20  AM-TRNTO-DTE              PIC XX.
  1063         16  FILLER                        PIC X(10).
  1064
  1065     12  AM-SAVED-REMIT-TO                 PIC 99.
  1066
  1067     12  AM-COMM-STRUCTURE-SAVED.
  1068         16  AM-DEFN-1-SAVED.
  1069             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1070                 24  AM-AGT-SV             PIC X(10).
  1071                 24  AM-COM-TYP-SV         PIC X.
  1072                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1073                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1074                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1075                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1076                 24  FILLER                PIC X.
  1077                 24  AM-GL-CODES-SV        PIC X.
  1078                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1079                 24  FILLER                PIC X.
  1080         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1081             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1082                 24  FILLER                PIC X(11).
  1083                 24  AM-L-COMA-SV          PIC XXX.
  1084                 24  AM-J-COMA-SV          PIC XXX.
  1085                 24  AM-A-COMA-SV          PIC XXX.
  1086                 24  FILLER                PIC X(6).
  1087
  1088     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1089         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1090            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1091            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1092            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1093
  1094     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1095     12  FILLER                            PIC X(120).
  1096
  1097     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1098         16  AM-CONTROL-NAME               PIC X(30).
  1099         16  AM-EXECUTIVE-ONE.
  1100             20  AM-EXEC1-NAME             PIC X(15).
  1101             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1102                                                          COMP-3.
  1103             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1104                                                          COMP-3.
  1105         16  AM-EXECUTIVE-TWO.
  1106             20  AM-EXEC2-NAME             PIC X(15).
  1107             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1108                                                          COMP-3.
  1109             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1110                                                          COMP-3.
  1111
  1112     12  AM-RETRO-ADDITIONAL-DATA.
  1113         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1114         16  AM-RETRO-PREM-P-E             PIC X.
  1115         16  AM-RETRO-CLMS-P-I             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  21
* WSMESS03.cbl
  1116         16  AM-RETRO-RET-BRACKET-LF.
  1117             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1118                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1119                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1120             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1121                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1122                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1123             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1124                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1125                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1126         16  AM-RETRO-RET-BRACKET-AH.
  1127             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1128                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1129                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1130                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1131             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1132                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1133                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1134             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1135                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1136                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1137
  1138     12  AM-COMMENTS.
  1139         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1140
  1141     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1142         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1143         16  AM-FLI-BILLING-CODE           PIC X.
  1144         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1145         16  AM-FLI-UNITED-IDENT           PIC X.
  1146         16  AM-FLI-INTEREST-LOST-DATA.
  1147             20  AM-FLI-BANK-NO            PIC X(5).
  1148             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1149             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1150             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1151         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1152             20  AM-FLI-AGT                PIC X(9).
  1153             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1154             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1155         16  FILLER                        PIC X(102).
  1156
  1157     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1158         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1159             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1160             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1161             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1162             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1163             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1164         16  FILLER                          PIC X(10).
  1165******************************************************************
  1166*                                 COPY ELCCERT.
  1167******************************************************************
  1168*                                                                *
  1169*                            ELCCERT.                            *
  1170*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1171*                            VMOD=2.013                          *
  1172*                                                                *
  1173*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  22
* WSMESS03.cbl
  1174*                                                                *
  1175*   FILE TYPE = VSAM,KSDS                                        *
  1176*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1177*                                                                *
  1178*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1179*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1180*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1181*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1182*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1183*                                                                *
  1184*   LOG = YES                                                    *
  1185*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1186******************************************************************
  1187*                   C H A N G E   L O G
  1188*
  1189* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1190*-----------------------------------------------------------------
  1191*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1192* EFFECTIVE    NUMBER
  1193*-----------------------------------------------------------------
  1194* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1195* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1196* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1197* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1198* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1199* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1200* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1201* 032612  CR2011110200001  PEMA  AHL CHANGES
  1202* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1203* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1204* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  1205******************************************************************
  1206
  1207 01  CERTIFICATE-MASTER.
  1208     12  CM-RECORD-ID                      PIC XX.
  1209         88  VALID-CM-ID                      VALUE 'CM'.
  1210
  1211     12  CM-CONTROL-PRIMARY.
  1212         16  CM-COMPANY-CD                 PIC X.
  1213         16  CM-CARRIER                    PIC X.
  1214         16  CM-GROUPING.
  1215             20  CM-GROUPING-PREFIX        PIC X(3).
  1216             20  CM-GROUPING-PRIME         PIC X(3).
  1217         16  CM-STATE                      PIC XX.
  1218         16  CM-ACCOUNT.
  1219             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1220             20  CM-ACCOUNT-PRIME          PIC X(6).
  1221         16  CM-CERT-EFF-DT                PIC XX.
  1222         16  CM-CERT-NO.
  1223             20  CM-CERT-PRIME             PIC X(10).
  1224             20  CM-CERT-SFX               PIC X.
  1225
  1226     12  CM-CONTROL-BY-NAME.
  1227         16  CM-COMPANY-CD-A1              PIC X.
  1228         16  CM-INSURED-LAST-NAME          PIC X(15).
  1229         16  CM-INSURED-INITIALS.
  1230             20  CM-INSURED-INITIAL1       PIC X.
  1231             20  CM-INSURED-INITIAL2       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  23
* WSMESS03.cbl
  1232
  1233     12  CM-CONTROL-BY-SSN.
  1234         16  CM-COMPANY-CD-A2              PIC X.
  1235         16  CM-SOC-SEC-NO.
  1236             20  CM-SSN-STATE              PIC XX.
  1237             20  CM-SSN-ACCOUNT            PIC X(6).
  1238             20  CM-SSN-LN3.
  1239                 25  CM-INSURED-INITIALS-A2.
  1240                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1241                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1242                 25 CM-PART-LAST-NAME-A2         PIC X.
  1243
  1244     12  CM-CONTROL-BY-CERT-NO.
  1245         16  CM-COMPANY-CD-A4              PIC X.
  1246         16  CM-CERT-NO-A4                 PIC X(11).
  1247
  1248     12  CM-CONTROL-BY-MEMB.
  1249         16  CM-COMPANY-CD-A5              PIC X.
  1250         16  CM-MEMBER-NO.
  1251             20  CM-MEMB-STATE             PIC XX.
  1252             20  CM-MEMB-ACCOUNT           PIC X(6).
  1253             20  CM-MEMB-LN4.
  1254                 25  CM-INSURED-INITIALS-A5.
  1255                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1256                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1257                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1258
  1259     12  CM-INSURED-PROFILE-DATA.
  1260         16  CM-INSURED-FIRST-NAME.
  1261             20  CM-INSURED-1ST-INIT       PIC X.
  1262             20  FILLER                    PIC X(9).
  1263         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1264         16  CM-INSURED-SEX                PIC X.
  1265             88  CM-SEX-MALE                  VALUE 'M'.
  1266             88  CM-SEX-FEMAL                 VALUE 'F'.
  1267         16  CM-INSURED-JOINT-AGE          PIC 99.
  1268         16  CM-JOINT-INSURED-NAME.
  1269             20  CM-JT-LAST-NAME           PIC X(15).
  1270             20  CM-JT-FIRST-NAME.
  1271                 24  CM-JT-1ST-INIT        PIC X.
  1272                 24  FILLER                PIC X(9).
  1273             20  CM-JT-INITIAL             PIC X.
  1274
  1275     12  CM-LIFE-DATA.
  1276         16  CM-LF-BENEFIT-CD              PIC XX.
  1277         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1278         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1279         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1280         16  CM-LF-DEV-CODE                PIC XXX.
  1281         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1282         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1283         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1284         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1285         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1286         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1287         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1288         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1289         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  24
* WSMESS03.cbl
  1290         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1291         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1292         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1293         16  cm-temp-epiq                  pic xx.
  1294             88  EPIQ-CLASS                  value 'EQ'.
  1295*        16  FILLER                        PIC XX.
  1296
  1297     12  CM-AH-DATA.
  1298         16  CM-AH-BENEFIT-CD              PIC XX.
  1299         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1300         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1301         16  CM-AH-DEV-CODE                PIC XXX.
  1302         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1303         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1304         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1305         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1306         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1307         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1308         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1309         16  CM-AH-PAID-THRU-DT            PIC XX.
  1310             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1311         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1312         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1313         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1314         16  FILLER                        PIC X.
  1315
  1316     12  CM-LOAN-INFORMATION.
  1317         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1318         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1319                                           PIC S9(5)V99  COMP-3.
  1320         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1321         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1322         16  CM-PAY-FREQUENCY              PIC S99.
  1323         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1324         16  CM-RATE-CLASS                 PIC XX.
  1325         16  CM-BENEFICIARY                PIC X(25).
  1326         16  CM-POLICY-FORM-NO             PIC X(12).
  1327         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1328         16  CM-LAST-ADD-ON-DT             PIC XX.
  1329         16  CM-DEDUCTIBLE-AMOUNTS.
  1330             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1331             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1332         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1333             20  CM-RESIDENT-STATE         PIC XX.
  1334             20  CM-RATE-CODE              PIC X(4).
  1335             20  FILLER                    PIC XX.
  1336         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1337             20  CM-LOAN-OFFICER           PIC X(5).
  1338             20  FILLER                    PIC XXX.
  1339         16  CM-CSR-CODE                   PIC XXX.
  1340         16  CM-UNDERWRITING-CODE          PIC X.
  1341             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1342         16  CM-POST-CARD-IND              PIC X.
  1343         16  CM-REF-INTERFACE-SW           PIC X.
  1344         16  CM-PREMIUM-TYPE               PIC X.
  1345             88  CM-SING-PRM                  VALUE '1'.
  1346             88  CM-O-B-COVERAGE              VALUE '2'.
  1347             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  25
* WSMESS03.cbl
  1348         16  CM-IND-GRP-TYPE               PIC X.
  1349             88  CM-INDIVIDUAL                VALUE 'I'.
  1350             88  CM-GROUP                     VALUE 'G'.
  1351         16  CM-SKIP-CODE                  PIC X.
  1352             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1353             88  SKIP-JULY                    VALUE '1'.
  1354             88  SKIP-AUGUST                  VALUE '2'.
  1355             88  SKIP-SEPTEMBER               VALUE '3'.
  1356             88  SKIP-JULY-AUG                VALUE '4'.
  1357             88  SKIP-AUG-SEPT                VALUE '5'.
  1358             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1359             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1360             88  SKIP-JUNE                    VALUE '8'.
  1361             88  SKIP-JUNE-JULY               VALUE '9'.
  1362             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1363             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1364         16  CM-PAYMENT-MODE               PIC X.
  1365             88  PAY-MONTHLY                  VALUE SPACE.
  1366             88  PAY-WEEKLY                   VALUE '1'.
  1367             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1368             88  PAY-BI-WEEKLY                VALUE '3'.
  1369             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1370         16  CM-LOAN-NUMBER                PIC X(8).
  1371         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1372         16  CM-OLD-LOF                    PIC XXX.
  1373*        16  CM-LOAN-OFFICER               PIC XXX.
  1374         16  CM-REIN-TABLE                 PIC XXX.
  1375         16  CM-SPECIAL-REIN-CODE          PIC X.
  1376         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1377         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1378         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1379
  1380     12  CM-STATUS-DATA.
  1381         16  CM-ENTRY-STATUS               PIC X.
  1382         16  CM-ENTRY-DT                   PIC XX.
  1383
  1384         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1385         16  CM-LF-CANCEL-DT               PIC XX.
  1386         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1387
  1388         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1389         16  CM-LF-DEATH-DT                PIC XX.
  1390         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1391
  1392         16  CM-LF-CURRENT-STATUS          PIC X.
  1393             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1394                                                'M' '4' '5' '9'.
  1395             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1396             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1397             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1398             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1399             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1400             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1401             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1402             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1403             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1404             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1405             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  26
* WSMESS03.cbl
  1406             88  CM-LF-DECLINED               VALUE 'D'.
  1407             88  CM-LF-VOIDED                 VALUE 'V'.
  1408
  1409         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1410         16  CM-AH-CANCEL-DT               PIC XX.
  1411         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1412
  1413         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1414         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1415         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1416
  1417         16  CM-AH-CURRENT-STATUS          PIC X.
  1418             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1419                                                'M' '4' '5' '9'.
  1420             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1421             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1422             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1423             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1424             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1425             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1426             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1427             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1428             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1429             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1430             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1431             88  CM-AH-DECLINED               VALUE 'D'.
  1432             88  CM-AH-VOIDED                 VALUE 'V'.
  1433
  1434         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1435             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1436             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1437             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1438         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1439
  1440         16  CM-ENTRY-BATCH                PIC X(6).
  1441         16  CM-LF-EXIT-BATCH              PIC X(6).
  1442         16  CM-AH-EXIT-BATCH              PIC X(6).
  1443         16  CM-LAST-MONTH-END             PIC XX.
  1444
  1445     12  CM-NOTE-SW                        PIC X.
  1446         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1447         88  CERT-NOTES-PRESENT               VALUE '1'.
  1448         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1449         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1450         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1451         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1452         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1453         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1454     12  CM-COMP-EXCP-SW                   PIC X.
  1455         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1456         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1457     12  CM-INSURED-ADDRESS-SW             PIC X.
  1458         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1459         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1460
  1461*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1462     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1463     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  27
* WSMESS03.cbl
  1464
  1465*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1466     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1467     12  FILLER                            PIC X.
  1468*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1469     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  1470
  1471     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1472         88  CERT-ADDED-BATCH                 VALUE ' '.
  1473         88  CERT-ADDED-ONLINE                VALUE '1'.
  1474         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1475         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1476         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1477     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1478         88  CERT-AS-LOADED                   VALUE ' '.
  1479         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1480         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1481         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1482         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1483         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1484         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1485         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1486
  1487     12  CM-ACCOUNT-COMM-PCTS.
  1488         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1489         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1490
  1491     12  CM-USER-FIELD                     PIC X.
  1492     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1493     12  CM-CLP-STATE                      PIC XX.
  1494     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1495     12  CM-USER-RESERVED                  PIC XXX.
  1496     12  FILLER REDEFINES CM-USER-RESERVED.
  1497         16  CM-AH-CLASS-CD                PIC XX.
  1498         16  F                             PIC X.
  1499******************************************************************
  1500*                                 COPY ELCCRTT.
  1501******************************************************************
  1502*                                                                *
  1503*                            ELCCRTT.                            *
  1504*                                                                *
  1505*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  1506*                                                                *
  1507*   FILE TYPE = VSAM,KSDS                                        *
  1508*   RECORD SIZE = 552  RECFORM = FIXED                           *
  1509*                                                                *
  1510*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  1511*                                                                *
  1512*   LOG = YES                                                    *
  1513*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1514******************************************************************
  1515*                   C H A N G E   L O G
  1516*
  1517* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1518*-----------------------------------------------------------------
  1519*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1520* EFFECTIVE    NUMBER
  1521*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  28
* WSMESS03.cbl
  1522* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  1523* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  1524* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  1525* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1526* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1527* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1528* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1529* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  1530* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1531* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  1532* 091318  CR2018073000001  PEMA  ADD Refund methods
  1533* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1534******************************************************************
  1535
  1536 01  CERTIFICATE-TRAILERS.
  1537     12  CS-RECORD-ID                      PIC XX.
  1538         88  VALID-CS-ID                      VALUE 'CS'.
  1539
  1540     12  CS-CONTROL-PRIMARY.
  1541         16  CS-COMPANY-CD                 PIC X.
  1542         16  CS-CARRIER                    PIC X.
  1543         16  CS-GROUPING                   PIC X(6).
  1544         16  CS-STATE                      PIC XX.
  1545         16  CS-ACCOUNT                    PIC X(10).
  1546         16  CS-CERT-EFF-DT                PIC XX.
  1547         16  CS-CERT-NO.
  1548             20  CS-CERT-PRIME             PIC X(10).
  1549             20  CS-CERT-SFX               PIC X.
  1550         16  CS-TRAILER-TYPE               PIC X.
  1551             88  COMM-TRLR           VALUE 'A'.
  1552             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  1553             88  CERT-DATA-TRLR      VALUE 'C'.
  1554
  1555     12  CS-DATA-AREA                      PIC X(516).
  1556
  1557     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  1558         16  CS-BANK-COMMISSION-AREA.
  1559             20  CS-BANK-COMMS       OCCURS 10.
  1560                 24  CS-AGT                PIC X(10).
  1561                 24  CS-COM-TYP            PIC X.
  1562                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  1563                 24  CS-RECALC-LV-INDIC    PIC X.
  1564                 24  FILLER                PIC X(10).
  1565         16  FILLER                        PIC X(256).
  1566
  1567     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  1568****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  1569         16  CS-MB-CLAIM-DATA OCCURS 24.
  1570             20  CS-CLAIM-NO               PIC X(7).
  1571             20  CS-CLAIM-TYPE             PIC X.
  1572                 88  CS-AH-CLM               VALUE 'A'.
  1573                 88  CS-IU-CLM               VALUE 'I'.
  1574                 88  CS-GP-CLM               VALUE 'G'.
  1575                 88  CS-LF-CLM               VALUE 'L'.
  1576                 88  CS-PR-CLM               VALUE 'P'.
  1577                 88  CS-FL-CLM               VALUE 'F'.
  1578                 88  CS-OT-CLM               VALUE 'O'.
  1579             20  CS-INSURED-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  29
* WSMESS03.cbl
  1580                 88  CS-PRIM-INSURED          VALUE 'P'.
  1581                 88  CS-CO-BORROWER           VALUE 'C'.
  1582             20  CS-BENEFIT-PERIOD         PIC 99.
  1583             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  1584             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  1585             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  1586         16  FILLER                        PIC X(12).
  1587     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  1588         16  CS-VIN-NUMBER                 PIC X(17).
  1589         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  1590         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  1591         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  1592         16  cs-agent-name.
  1593             20  cs-agent-fname            pic x(20).
  1594             20  cs-agent-mi               pic x.
  1595             20  cs-agent-lname            pic x(25).
  1596         16  cs-license-no                 pic x(15).
  1597         16  cs-npn-number                 pic x(10).
  1598         16  cs-agent-edit-status          pic x.
  1599             88  cs-ae-refer-to-manager      value 'M'.
  1600             88  cs-ae-cover-sheet           value 'C'.
  1601             88  cs-ae-sig-form              value 'S'.
  1602             88  cs-ae-verified              value 'V'.
  1603             88  cs-unidentified-signature   value 'U'.
  1604             88  cs-cert-returned            value 'R'.
  1605             88  cs-accept-no-commission     value 'N'.
  1606         16  cs-year                       pic 9999.
  1607         16  cs-make                       pic x(20).
  1608         16  cs-model                      pic x(20).
  1609         16  cs-future                     pic x(20).
  1610         16  cs-vehicle-odometer           pic s9(7) comp-3.
  1611         16  cs-claim-verification-status  pic x.
  1612             88  cs-clm-ver-eligible         value 'A'.
  1613             88  cs-clm-ver-partial-elig     value 'B'.
  1614             88  cs-clm-ver-not-eligible     value 'C'.
  1615             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  1616             88  cs-clm-ver-not-part-elig-rw value 'E'.
  1617             88  cs-clm-ver-ND-CERT          value 'F'.
  1618             88  cs-clm-ver-spec-other       value 'G'.
  1619             88  cs-clam-ver-pratial-corrected
  1620                                             value 'H'.
  1621             88  cs-clm-ver-no-matches       value 'I'.
  1622             88  cs-clm-ver-not-elig-corrected
  1623                                             value 'J'.
  1624             88  cs-clm-ver-needs-review     value 'R'.
  1625             88  cs-clm-ver-sent-to-claims   value 'W'.
  1626         16  CS-LF-REFUND-METHOD           PIC X.
  1627         16  CS-AH-REFUND-METHOD           PIC X.
  1628         16  FILLER                        PIC X(353). *> was 420
  1629*        16  FILLER                        PIC X(496).
  1630*                                 COPY ELCCNTL.
  1631******************************************************************
  1632*                                                                *
  1633*                                                                *
  1634*                            ELCCNTL.                            *
  1635*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1636*                            VMOD=2.059                          *
  1637*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  30
* WSMESS03.cbl
  1638*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1639*                                                                *
  1640*   FILE TYPE = VSAM,KSDS                                        *
  1641*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1642*                                                                *
  1643*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1644*       ALTERNATE INDEX = NONE                                   *
  1645*                                                                *
  1646*   LOG = YES                                                    *
  1647*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1648******************************************************************
  1649*                   C H A N G E   L O G
  1650*
  1651* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1652*-----------------------------------------------------------------
  1653*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1654* EFFECTIVE    NUMBER
  1655*-----------------------------------------------------------------
  1656* 082503                   PEMA  ADD BENEFIT GROUP
  1657* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1658* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1659* 092705    2005050300006  PEMA  ADD SPP LEASES
  1660* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1661* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1662* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1663* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1664* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1665* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1666* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1667* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1668* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1669* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1670* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  1671******************************************************************
  1672*
  1673 01  CONTROL-FILE.
  1674     12  CF-RECORD-ID                       PIC XX.
  1675         88  VALID-CF-ID                        VALUE 'CF'.
  1676
  1677     12  CF-CONTROL-PRIMARY.
  1678         16  CF-COMPANY-ID                  PIC XXX.
  1679         16  CF-RECORD-TYPE                 PIC X.
  1680             88  CF-COMPANY-MASTER              VALUE '1'.
  1681             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1682             88  CF-STATE-MASTER                VALUE '3'.
  1683             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1684             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1685             88  CF-CARRIER-MASTER              VALUE '6'.
  1686             88  CF-MORTALITY-MASTER            VALUE '7'.
  1687             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1688             88  CF-TERMINAL-MASTER             VALUE '9'.
  1689             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1690             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1691             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1692             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1693             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1694             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1695             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  31
* WSMESS03.cbl
  1696             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1697             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1698         16  CF-ACCESS-CD-GENL              PIC X(4).
  1699         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1700             20  CF-PROCESSOR               PIC X(4).
  1701         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1702             20  CF-STATE-CODE              PIC XX.
  1703             20  FILLER                     PIC XX.
  1704         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1705             20  FILLER                     PIC XX.
  1706             20  CF-HI-BEN-IN-REC           PIC XX.
  1707         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1708             20  FILLER                     PIC XXX.
  1709             20  CF-CARRIER-CNTL            PIC X.
  1710         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1711             20  FILLER                     PIC XX.
  1712             20  CF-HI-TYPE-IN-REC          PIC 99.
  1713         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1714             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1715                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1716             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1717             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1718         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1719             20  FILLER                     PIC X.
  1720             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1721         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1722             20  FILLER                     PIC XX.
  1723             20  CF-MORTGAGE-PLAN           PIC XX.
  1724         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1725
  1726     12  CF-LAST-MAINT-DT                   PIC XX.
  1727     12  CF-LAST-MAINT-BY                   PIC X(4).
  1728     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1729
  1730     12  CF-RECORD-BODY                     PIC X(728).
  1731
  1732
  1733****************************************************************
  1734*             COMPANY MASTER RECORD                            *
  1735****************************************************************
  1736
  1737     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1738         16  CF-COMPANY-ADDRESS.
  1739             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1740             20  CF-CL-IN-CARE-OF           PIC X(30).
  1741             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1742             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1743             20  CF-CL-CITY-STATE           PIC X(30).
  1744             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1745             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1746         16  CF-COMPANY-CD                  PIC X.
  1747         16  CF-COMPANY-PASSWORD            PIC X(8).
  1748         16  CF-SECURITY-OPTION             PIC X.
  1749             88  ALL-SECURITY                   VALUE '1'.
  1750             88  COMPANY-VERIFY                 VALUE '2'.
  1751             88  PROCESSOR-VERIFY               VALUE '3'.
  1752             88  NO-SECURITY                    VALUE '4'.
  1753             88  ALL-BUT-TERM                   VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  32
* WSMESS03.cbl
  1754         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1755             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1756         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1757             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1758         16  CF-INFORCE-LOCATION            PIC X.
  1759             88  CERTS-ARE-ONLINE               VALUE '1'.
  1760             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1761             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1762         16  CF-LOWER-CASE-LETTERS          PIC X.
  1763         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1764             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1765             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1766             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1767             88  CF-ACCNT-CNTL                  VALUE '3'.
  1768             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1769
  1770         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1771         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1772
  1773         16  CF-LGX-CREDIT-USER             PIC X.
  1774             88  CO-IS-NOT-USER                 VALUE 'N'.
  1775             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1776
  1777         16 CF-CREDIT-CALC-CODES.
  1778             20  CF-CR-REM-TERM-CALC PIC X.
  1779               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1780               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1781               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1782               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1783               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1784               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1785               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1786             20  CF-CR-R78-METHOD           PIC X.
  1787               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1788               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1789
  1790         16  CF-CLAIM-CONTROL-COUNTS.
  1791             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1792                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1793
  1794             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1795                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1796
  1797             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1798                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1799
  1800             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1801                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1802
  1803         16  CF-CURRENT-MONTH-END           PIC XX.
  1804
  1805         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1806             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1807             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1808             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1809             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1810                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1811                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  33
* WSMESS03.cbl
  1812             20  CF-CO-PREM-REJECT-SW       PIC X.
  1813                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1814                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1815             20  CF-CO-REF-REJECT-SW        PIC X.
  1816                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1817                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1818
  1819         16  CF-CO-REPORTING-DT             PIC XX.
  1820         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1821         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1822           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1823           88  CF-CO-MONTH-END                  VALUE '1'.
  1824
  1825         16  CF-LGX-CLAIM-USER              PIC X.
  1826             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1827             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1828
  1829         16  CF-CREDIT-EDIT-CONTROLS.
  1830             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1831             20  CF-MIN-AGE                 PIC 99.
  1832             20  CF-DEFAULT-AGE             PIC 99.
  1833             20  CF-MIN-TERM                PIC S999      COMP-3.
  1834             20  CF-MAX-TERM                PIC S999      COMP-3.
  1835             20  CF-DEFAULT-SEX             PIC X.
  1836             20  CF-JOINT-AGE-INPUT         PIC X.
  1837                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1838             20  CF-BIRTH-DATE-INPUT        PIC X.
  1839                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1840             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1841                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1842                 88  CF-ZERO-CARRIER            VALUE '1'.
  1843                 88  CF-ZERO-GROUPING           VALUE '2'.
  1844                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1845             20  CF-EDIT-SW                 PIC X.
  1846                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1847             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1848             20  CF-CR-PR-METHOD            PIC X.
  1849               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1850               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1851             20  FILLER                     PIC X.
  1852
  1853         16  CF-CREDIT-MISC-CONTROLS.
  1854             20  CF-REIN-TABLE-SW           PIC X.
  1855                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1856             20  CF-COMP-TABLE-SW           PIC X.
  1857                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1858             20  CF-EXPERIENCE-RETENTION-AGE
  1859                                            PIC S9        COMP-3.
  1860             20  CF-CONVERSION-DT           PIC XX.
  1861             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1862             20  CF-RUN-FREQUENCY-SW        PIC X.
  1863                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1864                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1865
  1866             20  CF-CR-CHECK-NO-CONTROL.
  1867                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1868                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1869                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  34
* WSMESS03.cbl
  1870                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1871                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1872                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1873
  1874                 24  CF-CR-CHECK-COUNT       REDEFINES
  1875                     CF-CR-CHECK-COUNTER      PIC X(4).
  1876
  1877                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1878                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1879
  1880                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1881                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1882                 24  CF-MAIL-PROCESSING       PIC X.
  1883                     88  MAIL-PROCESSING          VALUE 'Y'.
  1884
  1885         16  CF-MISC-SYSTEM-CONTROL.
  1886             20  CF-SYSTEM-C                 PIC X.
  1887                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1888             20  CF-SYSTEM-D                 PIC X.
  1889                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1890             20  CF-SOC-SEC-NO-SW            PIC X.
  1891                 88  SOC-SEC-NO-USED             VALUE '1'.
  1892             20  CF-MEMBER-NO-SW             PIC X.
  1893                 88  MEMBER-NO-USED              VALUE '1'.
  1894             20  CF-TAX-ID-NUMBER            PIC X(11).
  1895             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1896             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1897                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1898                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1899                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1900                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1901             20  CF-SYSTEM-E                 PIC X.
  1902                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1903
  1904         16  CF-LGX-LIFE-USER               PIC X.
  1905             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1906             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1907
  1908         16  CF-CR-MONTH-END-DT             PIC XX.
  1909
  1910         16  CF-FILE-MAINT-DATES.
  1911             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1912                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1913             20  CF-LAST-BATCH       REDEFINES
  1914                 CF-LAST-BATCH-NO               PIC X(4).
  1915             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1916             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1917             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1918             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1919             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1920             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1921             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1922             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1923             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1924             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1925
  1926         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1927         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  35
* WSMESS03.cbl
  1928
  1929         16  CF-ALT-MORT-CODE               PIC X(4).
  1930         16  CF-MEMBER-CAPTION              PIC X(10).
  1931
  1932         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1933             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1934             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1935             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1936             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1937             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1938
  1939         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1940
  1941         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1942         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1943         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1944         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1945
  1946         16  CF-AH-OVERRIDE-L1              PIC X.
  1947         16  CF-AH-OVERRIDE-L2              PIC XX.
  1948         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1949         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1950
  1951         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1952         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1953
  1954         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1955         16  CF-AR-LAST-EL860-DT            PIC XX.
  1956         16  CF-MP-MONTH-END-DT             PIC XX.
  1957
  1958         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1959         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1960             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1961
  1962         16  CF-AR-MONTH-END-DT             PIC XX.
  1963
  1964         16  CF-CRDTCRD-USER                PIC X.
  1965             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1966             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1967
  1968         16  CF-CC-MONTH-END-DT             PIC XX.
  1969
  1970         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1971
  1972         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1973             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1974             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1975             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1976         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1977         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1978         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1979         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1980             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1981             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1982         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1983         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1984         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1985             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  36
* WSMESS03.cbl
  1986         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1987
  1988         16  CF-CL-ZIP-CODE.
  1989             20  CF-CL-ZIP-PRIME.
  1990                 24  CF-CL-ZIP-1ST          PIC X.
  1991                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1992                 24  FILLER                 PIC X(4).
  1993             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1994         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1995             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1996             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1997             20  FILLER                     PIC XXX.
  1998
  1999         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2000         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2001         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2002         16  CF-CO-OPTION-START-DATE        PIC XX.
  2003         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2004           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2005                                                      '3' '4'.
  2006           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2007           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2008           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2009           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2010           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2011           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2012
  2013         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2014
  2015         16  CF-PAYMENT-APPROVAL-LEVELS.
  2016             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2017             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2018             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2019             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2020             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2021             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2022
  2023         16  CF-END-USER-REPORTING-USER     PIC X.
  2024             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2025             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2026
  2027         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2028             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2029             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2030
  2031         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2032
  2033         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2034         16  FILLER                         PIC X.
  2035
  2036         16  CF-CREDIT-ARCHIVE-CNTL.
  2037             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2038             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2039             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2040
  2041         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2042
  2043         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  37
* WSMESS03.cbl
  2044             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2045             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2046
  2047         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2048             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2049             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2050
  2051         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2052
  2053         16  CF-CO-ACH-ID-CODE              PIC  X.
  2054             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2055             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2056             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2057         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2058         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2059         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2060         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2061         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2062         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2063         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2064         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2065         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2066                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2067         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2068                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2069
  2070         16  CF-CO-OVER-SHORT.
  2071             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2072             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2073
  2074*         16  FILLER                         PIC X(102).
  2075         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2076             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2077             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2078
  2079         16  CF-AH-APPROVAL-DAYS.
  2080             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2081             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2082             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2083             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2084
  2085         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2086
  2087         16  CF-APPROV-LEV-5.
  2088             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2089             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2090             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2091
  2092         16  FILLER                         PIC X(68).
  2093****************************************************************
  2094*             PROCESSOR/USER RECORD                            *
  2095****************************************************************
  2096
  2097     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2098         16  CF-PROCESSOR-NAME              PIC X(30).
  2099         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2100         16  CF-PROCESSOR-TITLE             PIC X(26).
  2101         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  38
* WSMESS03.cbl
  2102                 88  MESSAGE-YES                VALUE 'Y'.
  2103                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2104
  2105*****************************************************
  2106****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2107****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2108****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2109****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2110*****************************************************
  2111
  2112         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2113             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2114             20  CF-APPLICATION-FORCE       PIC X.
  2115             20  CF-INDIVIDUAL-APP.
  2116                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2117                     28  CF-BROWSE-APP      PIC X.
  2118                     28  CF-UPDATE-APP      PIC X.
  2119
  2120         16  CF-CURRENT-TERM-ON             PIC X(4).
  2121         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2122             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2123             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2124             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2125             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2126             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2127             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2128             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2129         16  CF-PROCESSOR-CARRIER           PIC X.
  2130             88  NO-CARRIER-SECURITY            VALUE ' '.
  2131         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2132             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2133         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2134             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2135         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2136             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2137
  2138         16  CF-PROC-SYS-ACCESS-SW.
  2139             20  CF-PROC-CREDIT-CLAIMS-SW.
  2140                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2141                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2142                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2143                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2144             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2145                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2146                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2147             20  CF-PROC-LIFE-GNRLDGR-SW.
  2148                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2149                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2150                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2151                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2152             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2153                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2154                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2155         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2156             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2157             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2158         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2159
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  39
* WSMESS03.cbl
  2160         16  CF-APPROVAL-LEVEL                  PIC X.
  2161             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2162             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2163             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2164             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2165             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2166
  2167         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2168
  2169         16  CF-LANGUAGE-TYPE                   PIC X.
  2170             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2171             88  CF-LANG-IS-FR                      VALUE 'F'.
  2172
  2173         16  CF-CSR-IND                         PIC X.
  2174         16  FILLER                             PIC X(239).
  2175
  2176****************************************************************
  2177*             PROCESSOR/REMINDERS RECORD                       *
  2178****************************************************************
  2179
  2180     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2181         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2182             20  CF-START-REMIND-DT         PIC XX.
  2183             20  CF-END-REMIND-DT           PIC XX.
  2184             20  CF-REMINDER-TEXT           PIC X(50).
  2185         16  FILLER                         PIC X(296).
  2186
  2187
  2188****************************************************************
  2189*             STATE MASTER RECORD                              *
  2190****************************************************************
  2191
  2192     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2193         16  CF-STATE-ABBREVIATION          PIC XX.
  2194         16  CF-STATE-NAME                  PIC X(25).
  2195         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2196         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2197             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2198             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2199             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2200             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2201                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2202                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2203             20  CF-ST-PREM-REJECT-SW       PIC X.
  2204                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2205                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2206             20  CF-ST-REF-REJECT-SW        PIC X.
  2207                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2208                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2209         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2210         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2211         16  CF-ST-REFUND-RULES.
  2212             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2213             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2214             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2215         16  CF-ST-FST-PMT-EXTENSION.
  2216             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2217             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  40
* WSMESS03.cbl
  2218                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2219                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2220                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2221                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2222         16  CF-ST-STATE-CALL.
  2223             20  CF-ST-CALL-UNEARNED        PIC X.
  2224             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2225             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2226         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2227             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2228             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2229         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2230         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2231         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2232         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2233         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2234         16  FILLER                         PIC X.
  2235         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2236             20  CF-ST-BENEFIT-CD           PIC XX.
  2237             20  CF-ST-BENEFIT-KIND         PIC X.
  2238                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2239                 88  CF-ST-AH-KIND              VALUE 'A'.
  2240             20  CF-ST-REM-TERM-CALC        PIC X.
  2241                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2242                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2243                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2244                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2245                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2246                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2247                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2248                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2249
  2250             20  CF-ST-REFUND-CALC          PIC X.
  2251                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2252                 88  ST-REFD-BY-R78             VALUE '1'.
  2253                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2254                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2255                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2256                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2257                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2258                 88  ST-REFD-UTAH               VALUE '7'.
  2259                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2260                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2261                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2262
  2263             20  CF-ST-EARNING-CALC         PIC X.
  2264                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2265                 88  ST-EARN-BY-R78             VALUE '1'.
  2266                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2267                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2268                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2269                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2270                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2271                 88  ST-EARN-MEAN               VALUE '8'.
  2272                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2273
  2274             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2275                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  41
* WSMESS03.cbl
  2276                 88  ST-OVRD-BY-R78             VALUE '1'.
  2277                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2278                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2279                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2280                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2281                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2282                 88  ST-OVRD-MEAN               VALUE '8'.
  2283                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2284             20  cf-st-extra-periods        pic 9.
  2285*            20  FILLER                     PIC X.
  2286
  2287         16  CF-ST-COMMISSION-CAPS.
  2288             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2289             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2290             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2291             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2292         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2293                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2294                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  2295                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  2296
  2297         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2298
  2299         16  CF-ST-STATUTORY-INTEREST.
  2300             20  CF-ST-STAT-DATE-FROM       PIC X.
  2301                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2302                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2303             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2304             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2305             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2306             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2307             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2308
  2309         16  CF-ST-OVER-SHORT.
  2310             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2311             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2312
  2313         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2314
  2315         16  CF-ST-RT-CALC                  PIC X.
  2316
  2317         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2318         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2319         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2320         16  CF-ST-RF-LR-CALC               PIC X.
  2321         16  CF-ST-RF-LL-CALC               PIC X.
  2322         16  CF-ST-RF-LN-CALC               PIC X.
  2323         16  CF-ST-RF-AH-CALC               PIC X.
  2324         16  CF-ST-RF-CP-CALC               PIC X.
  2325*        16  FILLER                         PIC X(206).
  2326*CIDMOD         16  FILLER                         PIC X(192).
  2327         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2328             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2329         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2330         16  CF-ST-VFY-2ND-BENE             PIC X.
  2331         16  CF-ST-CAUSAL-STATE             PIC X.
  2332         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2333         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  42
* WSMESS03.cbl
  2334         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2335             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2336         16  CF-ST-NET-ONLY-STATE           PIC X.
  2337             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2338         16  cf-commission-cap-required     pic x.
  2339         16  CF-ST-GA-COMMISSION-CAPS.
  2340             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2341             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2342             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2343             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2344         16  CF-ST-TOT-COMMISSION-CAPS.
  2345             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2346             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2347             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2348             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2349         16  FILLER                         PIC X(156).
  2350
  2351****************************************************************
  2352*             BENEFIT MASTER RECORD                            *
  2353****************************************************************
  2354
  2355     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2356         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2357             20  CF-BENEFIT-CODE            PIC XX.
  2358             20  CF-BENEFIT-NUMERIC  REDEFINES
  2359                 CF-BENEFIT-CODE            PIC XX.
  2360             20  CF-BENEFIT-ALPHA           PIC XXX.
  2361             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2362             20  CF-BENEFIT-COMMENT         PIC X(10).
  2363
  2364             20  CF-LF-COVERAGE-TYPE        PIC X.
  2365                 88  CF-REDUCING                VALUE 'R'.
  2366                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2367
  2368             20  CF-SPECIAL-CALC-CD         PIC X.
  2369                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2370                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2371                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2372                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2373                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2374                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2375                 88  CF-FARM-PLAN               VALUE 'F'.
  2376                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2377                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2378                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2379                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2380                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2381                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2382                 88  CF-PRUDENTIAL              VALUE 'P'.
  2383                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2384                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2385                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2386                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2387                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2388                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2389
  2390             20  CF-JOINT-INDICATOR         PIC X.
  2391                 88  CF-JOINT-COVERAGE          VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  43
* WSMESS03.cbl
  2392
  2393*            20  FILLER                     PIC X(12).
  2394             20  cf-maximum-benefits        pic s999 comp-3.
  2395             20  FILLER                     PIC X(09).
  2396             20  CF-BENEFIT-CATEGORY        PIC X.
  2397             20  CF-LOAN-TYPE               PIC X(8).
  2398
  2399             20  CF-CO-REM-TERM-CALC        PIC X.
  2400                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2401                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2402                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2403                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2404                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2405
  2406             20  CF-CO-EARNINGS-CALC        PIC X.
  2407                 88  CO-EARN-BY-R78             VALUE '1'.
  2408                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2409                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2410                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2411                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2412                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2413                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2414                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2415
  2416             20  CF-CO-REFUND-CALC          PIC X.
  2417                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2418                 88  CO-REFD-BY-R78             VALUE '1'.
  2419                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2420                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2421                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2422                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2423                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2424                 88  CO-REFD-MEAN               VALUE '8'.
  2425                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2426                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2427                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2428
  2429             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2430                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2431                 88  CO-OVRD-BY-R78             VALUE '1'.
  2432                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2433                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2434                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2435                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2436                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2437                 88  CO-OVRD-MEAN               VALUE '8'.
  2438                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2439
  2440             20  CF-CO-BEN-I-G-CD           PIC X.
  2441                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2442                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2443                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2444
  2445         16  FILLER                         PIC X(304).
  2446
  2447
  2448****************************************************************
  2449*             CARRIER MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  44
* WSMESS03.cbl
  2450****************************************************************
  2451
  2452     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2453         16  CF-ADDRESS-DATA.
  2454             20  CF-MAIL-TO-NAME            PIC X(30).
  2455             20  CF-IN-CARE-OF              PIC X(30).
  2456             20  CF-ADDRESS-LINE-1          PIC X(30).
  2457             20  CF-ADDRESS-LINE-2          PIC X(30).
  2458             20  CF-CITY-STATE              PIC X(30).
  2459             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2460             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2461
  2462         16  CF-CLAIM-NO-CONTROL.
  2463             20  CF-CLAIM-NO-METHOD         PIC X.
  2464                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2465                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2466                 88  CLAIM-NO-SEQ               VALUE '3'.
  2467                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2468             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2469                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2470                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2471                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2472
  2473         16  CF-CHECK-NO-CONTROL.
  2474             20  CF-CHECK-NO-METHOD         PIC X.
  2475                 88  CHECK-NO-MANUAL            VALUE '1'.
  2476                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2477                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2478                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2479             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2480                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2481
  2482         16  CF-DOMICILE-STATE              PIC XX.
  2483
  2484         16  CF-EXPENSE-CONTROLS.
  2485             20  CF-EXPENSE-METHOD          PIC X.
  2486                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2487                 88  DOLLARS-PER-PMT            VALUE '2'.
  2488                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2489                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2490             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2491             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2492
  2493         16  CF-CORRESPONDENCE-CONTROL.
  2494             20  CF-LETTER-RESEND-OPT       PIC X.
  2495                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2496                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2497             20  FILLER                     PIC X(4).
  2498
  2499         16  CF-RESERVE-CONTROLS.
  2500             20  CF-MANUAL-SW               PIC X.
  2501                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2502             20  CF-FUTURE-SW               PIC X.
  2503                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2504             20  CF-PTC-SW                  PIC X.
  2505                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2506             20  CF-IBNR-SW                 PIC X.
  2507                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  45
* WSMESS03.cbl
  2508             20  CF-PTC-LF-SW               PIC X.
  2509                 88  CF-LF-PTC-USED             VALUE '1'.
  2510             20  CF-CDT-ACCESS-METHOD       PIC X.
  2511                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2512                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2513                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2514             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2515
  2516         16  CF-CLAIM-CALC-METHOD           PIC X.
  2517             88  360-PLUS-MONTHS                VALUE '1'.
  2518             88  365-PLUS-MONTHS                VALUE '2'.
  2519             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2520             88  360-DAILY                      VALUE '4'.
  2521             88  365-DAILY                      VALUE '5'.
  2522
  2523         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2524         16  FILLER                         PIC X(11).
  2525
  2526         16  CF-LIMIT-AMOUNTS.
  2527             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2528             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2529             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2530             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2531             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2532             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2533             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2534             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2535             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2536             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2537
  2538         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2539         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2540         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2541
  2542         16  CF-ZIP-CODE.
  2543             20  CF-ZIP-PRIME.
  2544                 24  CF-ZIP-1ST             PIC X.
  2545                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2546                 24  FILLER                 PIC X(4).
  2547             20  CF-ZIP-PLUS4               PIC X(4).
  2548         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2549             20  CF-CAN-POSTAL-1            PIC XXX.
  2550             20  CF-CAN-POSTAL-2            PIC XXX.
  2551             20  FILLER                     PIC XXX.
  2552
  2553         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2554         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2555         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2556
  2557         16  CF-RATING-SWITCH               PIC X.
  2558             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2559             88  CF-NO-RATING                   VALUE 'N'.
  2560
  2561         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2562
  2563         16  CF-CARRIER-OVER-SHORT.
  2564             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2565             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  46
* WSMESS03.cbl
  2566
  2567         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2568         16  CF-SECPAY-SWITCH               PIC X.
  2569             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2570             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2571         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2572         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2573         16  FILLER                         PIC X(444).
  2574*        16  FILLER                         PIC X(452).
  2575
  2576
  2577****************************************************************
  2578*             MORTALITY MASTER RECORD                          *
  2579****************************************************************
  2580
  2581     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2582         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2583                                INDEXED BY CF-MORT-NDX.
  2584             20  CF-MORT-TABLE              PIC X(5).
  2585             20  CF-MORT-TABLE-TYPE         PIC X.
  2586                 88  CF-MORT-JOINT              VALUE 'J'.
  2587                 88  CF-MORT-SINGLE             VALUE 'S'.
  2588                 88  CF-MORT-COMBINED           VALUE 'C'.
  2589                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2590                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2591             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2592             20  CF-MORT-AGE-METHOD         PIC XX.
  2593                 88  CF-AGE-LAST                VALUE 'AL'.
  2594                 88  CF-AGE-NEAR                VALUE 'AN'.
  2595             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2596             20  CF-MORT-ADJUSTMENT-DIRECTION
  2597                                            PIC X.
  2598                 88  CF-MINUS                   VALUE '-'.
  2599                 88  CF-PLUS                    VALUE '+'.
  2600             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2601             20  CF-MORT-JOINT-CODE         PIC X.
  2602                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2603             20  CF-MORT-PC-Q               PIC X.
  2604                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2605             20  CF-MORT-TABLE-CODE         PIC X(4).
  2606             20  CF-MORT-COMMENTS           PIC X(15).
  2607             20  FILLER                     PIC X(14).
  2608
  2609         16  FILLER                         PIC X(251).
  2610
  2611
  2612****************************************************************
  2613*             BUSSINESS TYPE MASTER RECORD                     *
  2614****************************************************************
  2615
  2616     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2617* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2618* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2619* AND RECORD 05 IS TYPES 81-99
  2620         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2621             20  CF-BUSINESS-TITLE          PIC  X(19).
  2622             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2623                                            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  47
* WSMESS03.cbl
  2624             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2625             20  FILLER                     PIC  X.
  2626         16  FILLER                         PIC  X(248).
  2627
  2628
  2629****************************************************************
  2630*             TERMINAL MASTER RECORD                           *
  2631****************************************************************
  2632
  2633     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2634
  2635         16  CF-COMPANY-TERMINALS.
  2636             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2637                                  PIC X(4).
  2638         16  FILLER               PIC X(248).
  2639
  2640
  2641****************************************************************
  2642*             LIFE EDIT MASTER RECORD                          *
  2643****************************************************************
  2644
  2645     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2646         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2647             20  CF-LIFE-CODE-IN            PIC XX.
  2648             20  CF-LIFE-CODE-OUT           PIC XX.
  2649         16  FILLER                         PIC X(248).
  2650
  2651
  2652****************************************************************
  2653*             AH EDIT MASTER RECORD                            *
  2654****************************************************************
  2655
  2656     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2657         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2658             20  CF-AH-CODE-IN              PIC XXX.
  2659             20  CF-AH-CODE-OUT             PIC XX.
  2660         16  FILLER                         PIC X(248).
  2661
  2662
  2663****************************************************************
  2664*             CREDIBILITY TABLES                               *
  2665****************************************************************
  2666
  2667     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2668         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2669                             INDEXED BY CF-CRDB-NDX.
  2670             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2671             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2672             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2673         16  FILLER                         PIC  X(332).
  2674
  2675
  2676****************************************************************
  2677*             REPORT CUSTOMIZATION RECORD                      *
  2678****************************************************************
  2679
  2680     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2681         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  48
* WSMESS03.cbl
  2682             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2683             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2684             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2685**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2686****       A T-TRANSFER.                                   ****
  2687             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2688
  2689         16  FILLER                         PIC XX.
  2690
  2691         16  CF-CARRIER-CNTL-OPT.
  2692             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2693                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2694                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2695             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2696                                            PIC X.
  2697         16  CF-GROUP-CNTL-OPT.
  2698             20  CF-GROUP-OPT-SEQ           PIC 9.
  2699                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2700                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2701             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2702                                            PIC X(6).
  2703         16  CF-STATE-CNTL-OPT.
  2704             20  CF-STATE-OPT-SEQ           PIC 9.
  2705                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2706                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2707             20  CF-STATE-SELECT OCCURS 3 TIMES
  2708                                            PIC XX.
  2709         16  CF-ACCOUNT-CNTL-OPT.
  2710             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2711                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2712                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2713             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2714                                            PIC X(10).
  2715         16  CF-BUS-TYP-CNTL-OPT.
  2716             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2717                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2718                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2719             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2720                                            PIC XX.
  2721         16  CF-LF-TYP-CNTL-OPT.
  2722             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2723                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2724                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2725             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2726                                            PIC XX.
  2727         16  CF-AH-TYP-CNTL-OPT.
  2728             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2729                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2730                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2731             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2732                                            PIC XX.
  2733         16  CF-REPTCD1-CNTL-OPT.
  2734             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2735                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2736                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2737             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2738                                            PIC X(10).
  2739         16  CF-REPTCD2-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  49
* WSMESS03.cbl
  2740             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2741                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2742                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2743             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2744                                            PIC X(10).
  2745         16  CF-USER1-CNTL-OPT.
  2746             20  CF-USER1-OPT-SEQ           PIC 9.
  2747                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2748                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2749             20  CF-USER1-SELECT OCCURS 3 TIMES
  2750                                            PIC X(10).
  2751         16  CF-USER2-CNTL-OPT.
  2752             20  CF-USER2-OPT-SEQ           PIC 9.
  2753                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2754                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2755             20  CF-USER2-SELECT OCCURS 3 TIMES
  2756                                            PIC X(10).
  2757         16  CF-USER3-CNTL-OPT.
  2758             20  CF-USER3-OPT-SEQ           PIC 9.
  2759                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2760                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2761             20  CF-USER3-SELECT OCCURS 3 TIMES
  2762                                            PIC X(10).
  2763         16  CF-USER4-CNTL-OPT.
  2764             20  CF-USER4-OPT-SEQ           PIC 9.
  2765                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2766                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2767             20  CF-USER4-SELECT OCCURS 3 TIMES
  2768                                            PIC X(10).
  2769         16  CF-USER5-CNTL-OPT.
  2770             20  CF-USER5-OPT-SEQ           PIC 9.
  2771                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2772                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2773             20  CF-USER5-SELECT OCCURS 3 TIMES
  2774                                            PIC X(10).
  2775         16  CF-REINS-CNTL-OPT.
  2776             20  CF-REINS-OPT-SEQ           PIC 9.
  2777                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2778                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2779             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2780                 24  CF-REINS-PRIME         PIC XXX.
  2781                 24  CF-REINS-SUB           PIC XXX.
  2782
  2783         16  CF-AGENT-CNTL-OPT.
  2784             20  CF-AGENT-OPT-SEQ           PIC 9.
  2785                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2786                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2787             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2788                                            PIC X(10).
  2789
  2790         16  FILLER                         PIC X(43).
  2791
  2792         16  CF-LOSS-RATIO-SELECT.
  2793             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2794             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2795         16  CF-ENTRY-DATE-SELECT.
  2796             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2797             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  50
* WSMESS03.cbl
  2798         16  CF-EFFECTIVE-DATE-SELECT.
  2799             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2800             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2801
  2802         16  CF-EXCEPTION-LIST-IND          PIC X.
  2803             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2804
  2805         16  FILLER                         PIC X(318).
  2806
  2807****************************************************************
  2808*                  EXCEPTION REPORTING RECORD                  *
  2809****************************************************************
  2810
  2811     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2812         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2813             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2814
  2815         16  CF-COMBINED-LIFE-AH-OPT.
  2816             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2817             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2818             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2819             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2820
  2821         16  CF-LIFE-OPT.
  2822             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2823             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2824             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2825             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2826             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2827             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2828             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2829             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2830             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2831             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2832
  2833         16  CF-AH-OPT.
  2834             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2835             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2836             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2837             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2838             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2839             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2840             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2841             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2842             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2843             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2844
  2845         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2846             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2847             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2848             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2849
  2850         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2851
  2852         16  FILLER                         PIC X(673).
  2853
  2854
  2855****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  51
* WSMESS03.cbl
  2856*             MORTGAGE SYSTEM PLAN RECORD                      *
  2857****************************************************************
  2858
  2859     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2860         16  CF-PLAN-TYPE                   PIC X.
  2861             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2862             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2863             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2864         16  CF-PLAN-ABBREV                 PIC XXX.
  2865         16  CF-PLAN-DESCRIPT               PIC X(10).
  2866         16  CF-PLAN-NOTES                  PIC X(20).
  2867         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2868         16  CF-PLAN-UNDERWRITING.
  2869             20  CF-PLAN-TERM-DATA.
  2870                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2871                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2872             20  CF-PLAN-AGE-DATA.
  2873                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2874                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2875                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2876             20  CF-PLAN-BENEFIT-DATA.
  2877                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2878                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2879                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2880                                            PIC S9(7)V99  COMP-3.
  2881         16  CF-PLAN-POLICY-FORMS.
  2882             20  CF-POLICY-FORM             PIC X(12).
  2883             20  CF-MASTER-APPLICATION      PIC X(12).
  2884             20  CF-MASTER-POLICY           PIC X(12).
  2885         16  CF-PLAN-RATING.
  2886             20  CF-RATE-CODE               PIC X(5).
  2887             20  CF-SEX-RATING              PIC X.
  2888                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2889                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2890             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2891             20  CF-SUB-STD-TYPE            PIC X.
  2892                 88  CF-PCT-OF-PREM            VALUE '1'.
  2893                 88  CF-PCT-OF-BENE            VALUE '2'.
  2894         16  CF-PLAN-PREM-TOLERANCES.
  2895             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2896             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2897         16  CF-PLAN-PYMT-TOLERANCES.
  2898             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2899             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2900         16  CF-PLAN-MISC-DATA.
  2901             20  FILLER                     PIC X.
  2902             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2903             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2904         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2905         16  CF-PLAN-IND-GRP                PIC X.
  2906             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2907                                                     '1'.
  2908             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2909                                                     '2'.
  2910         16  CF-MIB-SEARCH-SW               PIC X.
  2911             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2912             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2913             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  52
* WSMESS03.cbl
  2914             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2915         16  CF-ALPHA-SEARCH-SW             PIC X.
  2916             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2917             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2918             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2919             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2920             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2921             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2922             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2923             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2924             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2925             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2926                                                     'A' 'B' 'C'
  2927                                                     'X' 'Y' 'Z'.
  2928         16  CF-EFF-DT-RULE-SW              PIC X.
  2929             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2930             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2931             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2932             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2933             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2934         16  FILLER                         PIC X(4).
  2935         16  CF-HEALTH-QUESTIONS            PIC X.
  2936             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2937         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2938         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2939         16  CF-PLAN-SNGL-JNT               PIC X.
  2940             88  CF-COMBINED-PLAN              VALUE 'C'.
  2941             88  CF-JNT-PLAN                   VALUE 'J'.
  2942             88  CF-SNGL-PLAN                  VALUE 'S'.
  2943         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2944         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2945         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2946         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2947         16  CF-RERATE-CNTL                 PIC  X.
  2948             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2949             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2950             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2951             88  CF-AUTO-RECALC                 VALUE '4'.
  2952         16  CF-BENEFIT-TYPE                PIC  X.
  2953             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2954             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2955         16  CF-POLICY-FEE                  PIC S999V99
  2956                                                    COMP-3.
  2957         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2958         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2959         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2960         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2961         16  FILLER                         PIC  X(32).
  2962         16  CF-TERMINATION-FORM            PIC  X(04).
  2963         16  FILLER                         PIC  X(08).
  2964         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2965                                                       COMP-3.
  2966         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2967         16  CF-ISSUE-LETTER                PIC  X(4).
  2968         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2969         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2970             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2971             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  53
* WSMESS03.cbl
  2972         16  CF-MP-REFUND-CALC              PIC X.
  2973             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2974             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2975             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2976             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2977             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2978             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2979             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2980             88  CF-MP-REFD-MEAN                VALUE '8'.
  2981         16  CF-ALT-RATE-CODE               PIC  X(5).
  2982
  2983
  2984         16  FILLER                         PIC X(498).
  2985****************************************************************
  2986*             MORTGAGE COMPANY MASTER RECORD                   *
  2987****************************************************************
  2988
  2989     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2990         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2991         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2992             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2993             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2994             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2995             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2996             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2997
  2998         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2999         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3000         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3001         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3002         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3003
  3004         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3005             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3006         16  CF-MP-RECON-USE-IND            PIC X(1).
  3007             88  CF-MP-USE-RECON             VALUE 'Y'.
  3008         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3009             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3010         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3011             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3012             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3013         16  FILLER                         PIC X(1).
  3014         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3015             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3016         16  CF-MORTG-MIB-VERSION           PIC X.
  3017             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3018             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3019             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3020         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3021             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3022                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3023             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3024                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3025             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3026                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3027             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3028                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3029             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  54
* WSMESS03.cbl
  3030                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3031             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3032                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3033         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3034         16  FILLER                         PIC X(7).
  3035         16  CF-MORTG-DESTINATION-SYMBOL.
  3036             20  CF-MORTG-MIB-COMM          PIC X(5).
  3037             20  CF-MORTG-MIB-TERM          PIC X(5).
  3038         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3039             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3040         16  FILLER                         PIC X(03).
  3041         16  CF-MP-CHECK-NO-CONTROL.
  3042             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3043                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3044                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3045                                                ' ' LOW-VALUES.
  3046                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3047                                               VALUE '3'.
  3048         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3049         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3050         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3051             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3052                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3053             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3054                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3055             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3056                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3057             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3058                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3059             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3060                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3061             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3062                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3063         16  CF-MORTG-BILLING-AREA.
  3064             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3065                                            PIC X.
  3066         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3067         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3068         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3069         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3070             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3071             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3072         16  FILLER                         PIC X.
  3073         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3074             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3075             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3076         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3077         16  FILLER                         PIC X(8).
  3078         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3079         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3080         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3081         16  CF-ACH-COMPANY-ID.
  3082             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3083                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3084                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3085                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3086             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3087         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  55
* WSMESS03.cbl
  3088             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3089         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3090             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3091             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3092         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3093         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3094         16  FILLER                         PIC X(536).
  3095
  3096****************************************************************
  3097*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3098****************************************************************
  3099
  3100     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3101         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3102             20  CF-FEMALE-HEIGHT.
  3103                 24  CF-FEMALE-FT           PIC 99.
  3104                 24  CF-FEMALE-IN           PIC 99.
  3105             20  CF-FEMALE-MIN-WT           PIC 999.
  3106             20  CF-FEMALE-MAX-WT           PIC 999.
  3107         16  FILLER                         PIC X(428).
  3108
  3109     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3110         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3111             20  CF-MALE-HEIGHT.
  3112                 24  CF-MALE-FT             PIC 99.
  3113                 24  CF-MALE-IN             PIC 99.
  3114             20  CF-MALE-MIN-WT             PIC 999.
  3115             20  CF-MALE-MAX-WT             PIC 999.
  3116         16  FILLER                         PIC X(428).
  3117******************************************************************
  3118*             AUTOMATIC ACTIVITY RECORD                          *
  3119******************************************************************
  3120     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3121         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3122             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3123             20  CF-SYS-LETTER-ID           PIC X(04).
  3124             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3125             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3126             20  CF-SYS-RESET-SW            PIC X(01).
  3127             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3128             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3129
  3130         16  FILLER                         PIC X(50).
  3131
  3132         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3133             20  CF-USER-ACTIVE-SW          PIC X(01).
  3134             20  CF-USER-LETTER-ID          PIC X(04).
  3135             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3136             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3137             20  CF-USER-RESET-SW           PIC X(01).
  3138             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3139             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3140             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3141
  3142         16  FILLER                         PIC X(246).
  3143*                                 COPY ELCFUNDT.
  3144*****************************************************************
  3145*                                                               *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  56
* WSMESS03.cbl
  3146*                            ELCFUNDT.                          *
  3147*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
  3148*                            VMOD=2.001                         *
  3149*                                                               *
  3150*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
  3151*                                                               *
  3152*****************************************************************
  3153
  3154
  3155 01  FUNCTION-DATE.
  3156     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
  3157     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
  3158         10  WS-FN-CCYR            PIC 9(4).
  3159         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
  3160             15  WS-FN-CC          PIC 99.
  3161             15  WS-FN-YR          PIC 99.
  3162         10  WS-FN-MO              PIC 99.
  3163         10  WS-FN-DA              PIC 99.
  3164     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
  3165     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
  3166     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
  3167     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
  3168     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
  3169         88  WS-BEHIND-GMT                     VALUE '-'.
  3170         88  WS-AFTER-GMT                      VALUE '+'.
  3171         88  WS-NO-GMT                         VALUE ZERO.
  3172     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
  3173     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
  3174*                                 COPY ELCDATE.
  3175******************************************************************
  3176*                                                                *
  3177*                                                                *
  3178*                            ELCDATE.                            *
  3179*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3180*                            VMOD=2.003
  3181*                                                                *
  3182*                                                                *
  3183*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3184*                 LENGTH = 200                                   *
  3185******************************************************************
  3186
  3187 01  DATE-CONVERSION-DATA.
  3188     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3189     12  DC-OPTION-CODE                PIC X.
  3190         88  BIN-TO-GREG                VALUE ' '.
  3191         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3192         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3193         88  YMD-GREG-TO-BIN            VALUE '3'.
  3194         88  MDY-GREG-TO-BIN            VALUE '4'.
  3195         88  JULIAN-TO-BIN              VALUE '5'.
  3196         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3197         88  FIND-CENTURY               VALUE '7'.
  3198         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3199         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3200         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3201         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3202         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3203         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  57
* WSMESS03.cbl
  3204         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3205         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3206         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3207         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3208         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3209         88  BIN-3-TO-GREG              VALUE 'I'.
  3210         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3211         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3212         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3213         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3214         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3215         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3216         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3217         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3218         88  THREE-CHARACTER-BIN
  3219                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3220         88  GREGORIAN-TO-BIN
  3221                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3222         88  BIN-TO-GREGORIAN
  3223                  VALUES ' ' '1' 'I' '8' 'G'.
  3224         88  JULIAN-TO-BINARY
  3225                  VALUES '5' 'C' 'E' 'F'.
  3226     12  DC-ERROR-CODE                 PIC X.
  3227         88  NO-CONVERSION-ERROR        VALUE ' '.
  3228         88  DATE-CONVERSION-ERROR
  3229                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3230         88  DATE-IS-ZERO               VALUE '1'.
  3231         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3232         88  DATE-IS-INVALID            VALUE '3'.
  3233         88  DATE1-GREATER-DATE2        VALUE '4'.
  3234         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3235         88  DATE-INVALID-OPTION        VALUE '9'.
  3236         88  INVALID-CENTURY            VALUE 'A'.
  3237         88  ONLY-CENTURY               VALUE 'B'.
  3238         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3239         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3240     12  DC-END-OF-MONTH               PIC X.
  3241         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3242     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3243         88  USE-NORMAL-PROCESS         VALUE ' '.
  3244         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3245         88  ADJUST-UP-100-YRS          VALUE '2'.
  3246     12  FILLER                        PIC X.
  3247     12  DC-CONVERSION-DATES.
  3248         16  DC-BIN-DATE-1             PIC XX.
  3249         16  DC-BIN-DATE-2             PIC XX.
  3250         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3251         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3252                       DC-GREG-DATE-1-EDIT.
  3253             20  DC-EDIT1-MONTH        PIC 99.
  3254             20  SLASH1-1              PIC X.
  3255             20  DC-EDIT1-DAY          PIC 99.
  3256             20  SLASH1-2              PIC X.
  3257             20  DC-EDIT1-YEAR         PIC 99.
  3258         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3259         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3260                     DC-GREG-DATE-2-EDIT.
  3261             20  DC-EDIT2-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  58
* WSMESS03.cbl
  3262             20  SLASH2-1              PIC X.
  3263             20  DC-EDIT2-DAY          PIC 99.
  3264             20  SLASH2-2              PIC X.
  3265             20  DC-EDIT2-YEAR         PIC 99.
  3266         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3267         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3268                     DC-GREG-DATE-1-YMD.
  3269             20  DC-YMD-YEAR           PIC 99.
  3270             20  DC-YMD-MONTH          PIC 99.
  3271             20  DC-YMD-DAY            PIC 99.
  3272         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3273         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3274                      DC-GREG-DATE-1-MDY.
  3275             20  DC-MDY-MONTH          PIC 99.
  3276             20  DC-MDY-DAY            PIC 99.
  3277             20  DC-MDY-YEAR           PIC 99.
  3278         16  DC-GREG-DATE-1-ALPHA.
  3279             20  DC-ALPHA-MONTH        PIC X(10).
  3280             20  DC-ALPHA-DAY          PIC 99.
  3281             20  FILLER                PIC XX.
  3282             20  DC-ALPHA-CENTURY.
  3283                 24 DC-ALPHA-CEN-N     PIC 99.
  3284             20  DC-ALPHA-YEAR         PIC 99.
  3285         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3286         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3287         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3288         16  DC-JULIAN-DATE            PIC 9(05).
  3289         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3290                                       PIC 9(05).
  3291         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3292             20  DC-JULIAN-YEAR        PIC 99.
  3293             20  DC-JULIAN-DAYS        PIC 999.
  3294         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3295         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3296         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3297     12  DATE-CONVERSION-VARIBLES.
  3298         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3299         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3300             20  FILLER                PIC 9(3).
  3301             20  HOLD-CEN-1-CCYY.
  3302                 24  HOLD-CEN-1-CC     PIC 99.
  3303                 24  HOLD-CEN-1-YY     PIC 99.
  3304             20  HOLD-CEN-1-MO         PIC 99.
  3305             20  HOLD-CEN-1-DA         PIC 99.
  3306         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3307             20  HOLD-CEN-1-R-MO       PIC 99.
  3308             20  HOLD-CEN-1-R-DA       PIC 99.
  3309             20  HOLD-CEN-1-R-CCYY.
  3310                 24  HOLD-CEN-1-R-CC   PIC 99.
  3311                 24  HOLD-CEN-1-R-YY   PIC 99.
  3312             20  FILLER                PIC 9(3).
  3313         16  HOLD-CENTURY-1-X.
  3314             20  FILLER                PIC X(3)  VALUE SPACES.
  3315             20  HOLD-CEN-1-X-CCYY.
  3316                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3317                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3318             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3319             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  59
* WSMESS03.cbl
  3320         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3321             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3322             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3323             20  HOLD-CEN-1-R-X-CCYY.
  3324                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3325                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3326             20  FILLER                PIC XXX.
  3327         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3328         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3329         16  DC-JULIAN-DATE-1          PIC 9(07).
  3330         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3331             20  DC-JULIAN-1-CCYY.
  3332                 24  DC-JULIAN-1-CC    PIC 99.
  3333                 24  DC-JULIAN-1-YR    PIC 99.
  3334             20  DC-JULIAN-DA-1        PIC 999.
  3335         16  DC-JULIAN-DATE-2          PIC 9(07).
  3336         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3337             20  DC-JULIAN-2-CCYY.
  3338                 24  DC-JULIAN-2-CC    PIC 99.
  3339                 24  DC-JULIAN-2-YR    PIC 99.
  3340             20  DC-JULIAN-DA-2        PIC 999.
  3341         16  DC-GREG-DATE-A-EDIT.
  3342             20  DC-EDITA-MONTH        PIC 99.
  3343             20  SLASHA-1              PIC X VALUE '/'.
  3344             20  DC-EDITA-DAY          PIC 99.
  3345             20  SLASHA-2              PIC X VALUE '/'.
  3346             20  DC-EDITA-CCYY.
  3347                 24  DC-EDITA-CENT     PIC 99.
  3348                 24  DC-EDITA-YEAR     PIC 99.
  3349         16  DC-GREG-DATE-B-EDIT.
  3350             20  DC-EDITB-MONTH        PIC 99.
  3351             20  SLASHB-1              PIC X VALUE '/'.
  3352             20  DC-EDITB-DAY          PIC 99.
  3353             20  SLASHB-2              PIC X VALUE '/'.
  3354             20  DC-EDITB-CCYY.
  3355                 24  DC-EDITB-CENT     PIC 99.
  3356                 24  DC-EDITB-YEAR     PIC 99.
  3357         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3358         16  DC-GREG-DATE-CYMD-R REDEFINES
  3359                              DC-GREG-DATE-CYMD.
  3360             20  DC-CYMD-CEN           PIC 99.
  3361             20  DC-CYMD-YEAR          PIC 99.
  3362             20  DC-CYMD-MONTH         PIC 99.
  3363             20  DC-CYMD-DAY           PIC 99.
  3364         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3365         16  DC-GREG-DATE-MDCY-R REDEFINES
  3366                              DC-GREG-DATE-MDCY.
  3367             20  DC-MDCY-MONTH         PIC 99.
  3368             20  DC-MDCY-DAY           PIC 99.
  3369             20  DC-MDCY-CEN           PIC 99.
  3370             20  DC-MDCY-YEAR          PIC 99.
  3371    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3372        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3373    12  DC-EL310-DATE                  PIC X(21).
  3374    12  FILLER                         PIC X(28).
  3375*                                 COPY ELCCALC.
  3376******************************************************************
  3377*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  60
* WSMESS03.cbl
  3378*                           ELCCALC.                            *
  3379*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3380*                            VMOD=2.025                          *
  3381*                                                                *
  3382*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3383*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3384*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3385*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3386*                                                                *
  3387*  PASSED TO ELRTRM                                              *
  3388*  -----------------                                             *
  3389*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3390*  ORIGINAL TERM                                                 *
  3391*  BEGINNING DATE                                                *
  3392*  ENDING DATE                                                   *
  3393*  COMPANY I.D.                                                  *
  3394*  ACCOUNT MASTER USER FIELD                                     *
  3395*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3396*  FREE LOOK DAYS                                                *
  3397*                                                                *
  3398*  RETURNED FROM ELRTRM                                          *
  3399*  ---------------------                                         *
  3400*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3401*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3402*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3403*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3404*----------------------------------------------------------------*
  3405*  PASSED TO ELRAMT                                              *
  3406*  ----------------                                              *
  3407*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3408*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3409*  ORIGINAL AMOUNT                                               *
  3410*  ALTERNATE BENEFIT (BALLON)                                    *
  3411*  A.P.R. - NET PAY ONLY                                         *
  3412*  METHOD
  3413*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3414*  COMPANY I.D.                                                  *
  3415*  BENEFIT TYPE                                                  *
  3416*                                                                *
  3417*  RETURNED FROM ELRAMT                                          *
  3418*  --------------------                                          *
  3419*  REMAINING AMOUNT 1 - CURRENT                                  *
  3420*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3421*  REMAINING AMOUNT FACTOR
  3422*----------------------------------------------------------------*
  3423*  PASSED TO ELRESV                                              *
  3424*  -----------------                                             *
  3425*  CERTIFICATE EFFECTIVE DATE                                    *
  3426*  VALUATION DATE                                                *
  3427*  PAID THRU DATE                                                *
  3428*  BENEFIT                                                       *
  3429*  INCURRED DATE                                                 *
  3430*  REPORTED DATE                                                 *
  3431*  ISSUE AGE                                                     *
  3432*  TERM                                                          *
  3433*  CDT PERCENT                                                   *
  3434*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3435* *CLAIM TYPE (LIFE, A/H)                                        *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  61
* WSMESS03.cbl
  3436* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3437* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3438*                                                                *
  3439*  RETURNED FROM ELRESV                                          *
  3440*  --------------------                                          *
  3441*  CDT TABLE USED                                                *
  3442*  CDT FACTOR USED                                               *
  3443*  PAY TO CURRENT RESERVE                                        *
  3444*  I.B.N.R. - A/H ONLY                                           *
  3445*  FUTURE (ACCRUED) AH ONLY                                      *
  3446*----------------------------------------------------------------*
  3447*  PASSED TO ELRATE                                              *
  3448*  ----------------                                              *
  3449*  CERT ISSUE DATE                                               *
  3450*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3451*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3452*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3453*  STATE CODE (CLIENT DEFINED)                                   *
  3454*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3455*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3456*  DEVIATION CODE                                                *
  3457*  ISSUE AGE                                                     *
  3458*  ORIGINAL BENEFIT AMOUNT                                       *
  3459*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3460*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3461*  BENEFIT KIND (LIFE OR A/H)                                    *
  3462*  A.P.R.                                                        *
  3463*  METHOD
  3464*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3465*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3466*  COMPANY I.D. (3 CHARACTER)                                    *
  3467*  BENEFIT CODE                                                  *
  3468*  BENEFIT OVERRIDE CODE                                         *
  3469*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3470*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3471*  JOINT INDICATOR (CSL ONLY)                                    *
  3472*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3473*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3474*                                                                *
  3475*  RETURNED FROM ELRATE                                          *
  3476*  --------------------                                          *
  3477*  CALCULATED PREMIUM                                            *
  3478*  PREMIUM RATE                                                  *
  3479*  MORTALITY CODE                                                *
  3480*  MAX ATTAINED AGE                                              *
  3481*  MAX AGE                                                       *
  3482*  MAX TERM                                                      *
  3483*  MAX MONTHLY BENEFIT                                           *
  3484*  MAX TOTAL BENIFIT                                             *
  3485*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3486*----------------------------------------------------------------*
  3487*  PASSED TO ELRFND                                              *
  3488*  ----------------                                              *
  3489*  CERT ISSUE DATE                                               *
  3490*  REFUND DATE                                                   *
  3491*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3492*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3493*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  62
* WSMESS03.cbl
  3494*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3495*  STATE CODE (CLIENT DEFINED)                                   *
  3496*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3497*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3498*  DEVIATION CODE                                                *
  3499*  ISSUE AGE                                                     *
  3500*  ORIGINAL BENEFIT AMOUNT                                       *
  3501*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3502*  PROCESS TYPE (CANCEL)                                         *
  3503*  BENEFIT KIND (LIFE OR A/H)                                    *
  3504*  A.P.R.                                                        *
  3505*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3506*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3507*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3508*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3509*  COMPANY I.D. (3 CHARACTER)                                    *
  3510*  BENEFIT CODE                                                  *
  3511*  BENEFIT OVERRIDE CODE                                         *
  3512*                                                                *
  3513*  RETURNED FROM ELRFND                                          *
  3514*  --------------------                                          *
  3515*  CALCULATED REFUND                                             *
  3516*----------------------------------------------------------------*
  3517*  PASSED TO ELEARN                                              *
  3518*  ----------------                                              *
  3519*  CERT ISSUE DATE                                               *
  3520*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3521*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3522*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3523*  STATE CODE (CLIENT DEFINED)                                   *
  3524*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3525*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3526*  DEVIATION CODE                                                *
  3527*  ISSUE AGE                                                     *
  3528*  ORIGINAL BENEFIT AMOUNT                                       *
  3529*  BENEFIT KIND (LIFE OR A/H)                                    *
  3530*  A.P.R.                                                        *
  3531*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3532*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3533*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3534*  COMPANY I.D. (3 CHARACTER)                                    *
  3535*  BENEFIT CODE                                                  *
  3536*  BENEFIT OVERRIDE CODE                                         *
  3537*                                                                *
  3538*  RETURNED FROM ELEARN                                          *
  3539*  --------------------                                          *
  3540*  INDICATED  EARNINGS                                           *
  3541*----------------------------------------------------------------*
  3542*                 LENGTH = 450                                   *
  3543*                                                                *
  3544******************************************************************
  3545******************************************************************
  3546*                   C H A N G E   L O G
  3547*
  3548* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3549*-----------------------------------------------------------------
  3550*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3551* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  63
* WSMESS03.cbl
  3552*-----------------------------------------------------------------
  3553* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3554* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3555* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3556* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3557* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3558* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3559* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3560* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3561* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3562* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3563* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3564******************************************************************
  3565
  3566 01  CALCULATION-PASS-AREA.
  3567     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3568                                     COMP.
  3569
  3570     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3571       88  NO-CP-ERROR                             VALUE ZERO.
  3572       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3573                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3574       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3575       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3576       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3577       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3578       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3579       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3580       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3581       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3582       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3583       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3584       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3585       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3586       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3587       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3588       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3589       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3590       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3591
  3592     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3593       88  NO-CP-ERROR-2                           VALUE ZERO.
  3594***********************  INPUT AREAS ****************************
  3595
  3596     12  CP-CALCULATION-AREA.
  3597         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3598         16  CP-CERT-EFF-DT        PIC XX.
  3599         16  CP-VALUATION-DT       PIC XX.
  3600         16  CP-PAID-THRU-DT       PIC XX.
  3601         16  CP-BENEFIT-TYPE       PIC X.
  3602           88  CP-AH                               VALUE 'A' 'D'
  3603                                                   'I' 'U'.
  3604           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3605           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3606         16  CP-INCURRED-DT        PIC XX.
  3607         16  CP-REPORTED-DT        PIC XX.
  3608         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3609         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  64
* WSMESS03.cbl
  3610         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3611                                     COMP-3.
  3612         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3613                                     COMP-3.
  3614         16  CP-CDT-METHOD         PIC X.
  3615           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3616           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3617           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3618         16  CP-CLAIM-TYPE         PIC X.
  3619           88  CP-AH-CLAIM                         VALUE 'A'.
  3620           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3621         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3622                                     COMP-3.
  3623         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3624                                     COMP-3.
  3625         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3626                                     COMP-3.
  3627         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3628                                     COMP-3.
  3629         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3630                                     COMP-3.
  3631         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3632                                     COMP-3.
  3633         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3634                                     COMP-3.
  3635         16  CP-REM-TERM-METHOD    PIC X.
  3636           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3637           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3638           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3639           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3640           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3641           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3642           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3643         16  CP-EARNING-METHOD     PIC X.
  3644           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3645           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3646           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3647           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3648           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3649           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3650           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3651           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3652           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3653           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3654           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3655           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3656           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3657           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3658         16  CP-PROCESS-TYPE       PIC X.
  3659           88  CP-CLAIM                            VALUE '1'.
  3660           88  CP-CANCEL                           VALUE '2'.
  3661           88  CP-ISSUE                            VALUE '3'.
  3662         16  CP-SPECIAL-CALC-CD    PIC X.
  3663           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3664           88  CP-1-MTH-INTEREST               VALUE ' '.
  3665           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3666           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3667           88  CP-CRITICAL-PERIOD              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  65
* WSMESS03.cbl
  3668           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3669           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3670           88  CP-FARM-PLAN                    VALUE 'F'.
  3671           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3672           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3673           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3674           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3675           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3676           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3677           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3678           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3679           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3680           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3681                                                     'W' 'X'.
  3682           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3683           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3684           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3685           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3686           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3687           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3688           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3689           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3690           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3691           88  CP-CSL-METH-1                   VALUE '5'.
  3692           88  CP-CSL-METH-2                   VALUE '6'.
  3693           88  CP-CSL-METH-3                   VALUE '7'.
  3694           88  CP-CSL-METH-4                   VALUE '8'.
  3695
  3696         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3697                                     COMP-3.
  3698         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3699         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3700         16  CP-STATE              PIC XX          VALUE SPACE.
  3701         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3702         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3703           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3704               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3705         16  CP-R78-OPTION         PIC X.
  3706           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3707           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3708
  3709         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3710         16  CP-IBNR-RESERVE-SW    PIC X.
  3711         16  CP-CLAIM-STATUS       PIC X.
  3712         16  CP-RATE-FILE          PIC X.
  3713         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3714                                     COMP-3.
  3715
  3716         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3717         16  CP-AH-OVERRIDE-CODE   PIC X.
  3718
  3719         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3720                                     COMP-3.
  3721         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3722                                   PIC S9(5)V99 COMP-3.
  3723         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3724                                     COMP-3.
  3725         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  66
* WSMESS03.cbl
  3726                                     COMP-3.
  3727         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3728                                     COMP-3.
  3729         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3730                                  PIC S9(7)V99 COMP-3.
  3731
  3732         16  CP-PAID-FROM-DATE     PIC X(02).
  3733         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3734         16  CP-EXT-DAYS-CALC      PIC X.
  3735           88  CP-EXT-NO-CHG                   VALUE ' '.
  3736           88  CP-EXT-CHG-LF                   VALUE '1'.
  3737           88  CP-EXT-CHG-AH                   VALUE '2'.
  3738           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3739         16  CP-DOMICILE-STATE     PIC XX.
  3740         16  CP-CARRIER            PIC X.
  3741         16  CP-REIN-FLAG          PIC X.
  3742         16  CP-REM-TRM-CALC-OPTION PIC X.
  3743           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3744                      '2' '3' '4' '5'.
  3745           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3746           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3747           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3748           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3749           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3750           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3751           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3752           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3753         16  CP-SIG-SWITCH         PIC X.
  3754         16  CP-RATING-METHOD      PIC X.
  3755           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3756           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3757           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3758           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3759           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3760           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3761           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3762           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3763           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3764         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3765                                     COMP-3.
  3766         16  CP-BEN-CATEGORY       PIC X.
  3767         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3768         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3769                                   PIC S99V9(5) COMP-3.
  3770         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3771         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3772                                   PIC S99V9(5) COMP-3.
  3773         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3774         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3775         16  CP-EXPIRE-DT          PIC XX.
  3776         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3777         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3778         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3779         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3780         16  CP-DDF-SPEC-CALC      PIC X.
  3781             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3782             88  CP-CALC-CLP              VALUE 'C'.
  3783         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  67
* WSMESS03.cbl
  3784         16  CP-CANCEL-REASON      PIC X.
  3785         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3786         16  CP-PMT-MODE           PIC X.
  3787         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3788         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3789         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3790         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3791         16  FILLER                PIC X.
  3792
  3793***************    OUTPUT FROM ELRESV   ************************
  3794
  3795         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3796
  3797         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3798                                     COMP-3.
  3799         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3800                                     COMP-3.
  3801         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3802                                     COMP-3.
  3803         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3804                                     COMP-3.
  3805         16  FILLER                PIC X(09).
  3806***************    OUTPUT FROM ELRTRM   *************************
  3807
  3808         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3809                                     COMP-3.
  3810         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3811                                     COMP-3.
  3812         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3813                                     COMP-3.
  3814         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3815                                     COMP-3.
  3816         16  FILLER                PIC X(12).
  3817
  3818***************    OUTPUT FROM ELRAMT   *************************
  3819
  3820         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3821                                     COMP-3.
  3822         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3823                                     COMP-3.
  3824         16  FILLER                PIC X(12).
  3825
  3826***************    OUTPUT FROM ELRATE   *************************
  3827
  3828         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3829                                     COMP-3.
  3830         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3831                                     COMP-3.
  3832         16  CP-MORTALITY-CODE     PIC X(4).
  3833         16  CP-RATE-EDIT-FLAG     PIC X.
  3834             88  CP-RATES-NEED-APR                  VALUE '1'.
  3835         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3836                                     COMP-3.
  3837         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3838         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3839         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3840                                   PIC S9(7)V99 COMP-3.
  3841         16  FILLER                PIC X(07).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  68
* WSMESS03.cbl
  3842
  3843***************    OUTPUT FROM ELRFND   *************************
  3844
  3845         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3846                                     COMP-3.
  3847         16  CP-REFUND-TYPE-USED   PIC X.
  3848           88  CP-R-AS-R78                         VALUE '1'.
  3849           88  CP-R-AS-PRORATA                     VALUE '2'.
  3850           88  CP-R-AS-CALIF                       VALUE '3'.
  3851           88  CP-R-AS-TEXAS                       VALUE '4'.
  3852           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3853           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3854           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3855           88  CP-R-AS-MEAN                        VALUE '8'.
  3856           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3857           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3858           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3859           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3860           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3861           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3862         16  FILLER                PIC X(12).
  3863
  3864***************    OUTPUT FROM ELEARN   *************************
  3865
  3866         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3867                                     COMP-3.
  3868         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3869                                     COMP-3.
  3870         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3871                                     COMP-3.
  3872         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3873                                     COMP-3.
  3874         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3875                                     COMP-3.
  3876         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3877                                     COMP-3.
  3878         16  CP-EARNING-TYPE-USED  PIC X.
  3879           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3880           88  CP-E-AS-R78                         VALUE '1'.
  3881           88  CP-E-AS-PRORATA                     VALUE '2'.
  3882           88  CP-E-AS-TEXAS                       VALUE '4'.
  3883           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3884           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3885           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3886           88  CP-E-AS-MEAN                        VALUE '8'.
  3887           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3888         16  FILLER                PIC X(12).
  3889
  3890***************    OUTPUT FROM ELPMNT   *************************
  3891
  3892         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3893                                     COMP-3.
  3894         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3895                                     COMP-3.
  3896         16  FILLER                PIC X(12).
  3897
  3898***************   MISC WORK AREAS    *****************************
  3899         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  69
* WSMESS03.cbl
  3900                                     COMP-3.
  3901         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3902                                     COMP-3.
  3903         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3904                                     COMP-3.
  3905         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3906                                     COMP-3.
  3907         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3908                                     COMP-3.
  3909         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3910                                     COMP-3.
  3911         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3912             88  OPEN-RATE-FILE                   VALUE 'O'.
  3913             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3914             88  IO-ERROR                         VALUE 'E'.
  3915
  3916         16  CP-FIRST-PAY-DATE     PIC XX.
  3917
  3918         16  CP-JOINT-INDICATOR    PIC X.
  3919
  3920         16  CP-RESERVE-REMAINING-TERM
  3921                                   PIC S9(4)V9    VALUE ZERO
  3922                                     COMP-3.
  3923
  3924         16  CP-INSURED-BIRTH-DT   PIC XX.
  3925
  3926         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3927                                     COMP-3.
  3928
  3929         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3930                                     COMP-3.
  3931
  3932         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3933                                     COMP-3.
  3934
  3935         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3936                                     COMP-3.
  3937
  3938         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3939                                     COMP-3.
  3940
  3941         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3942                                     COMP-3.
  3943
  3944         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3945                                     COMP-3.
  3946
  3947         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3948             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3949
  3950         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3951                                     COMP-3.
  3952         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3953                                     COMP-3.
  3954         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3955         16  cp-extra-periods      pic 9 value zeros.
  3956         16  cp-net-only-state     pic x value spaces.
  3957         16  FILLER                PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  70
* WSMESS03.cbl
  3958******************************************************************
  3959****************************************************************
  3960*
  3961* Copyright (c) 2007-2013 Dell Inc.
  3962* All rights reserved.
  3963*
  3964****************************************************************
  3965 01  DFHEIV.
  3966   02  DFHEIV0               PIC X(35).
  3967   02  DFHEIV1               PIC X(08).
  3968   02  DFHEIV2               PIC X(08).
  3969   02  DFHEIV3               PIC X(08).
  3970   02  DFHEIV4               PIC X(06).
  3971   02  DFHEIV5               PIC X(04).
  3972   02  DFHEIV6               PIC X(04).
  3973   02  DFHEIV7               PIC X(02).
  3974   02  DFHEIV8               PIC X(02).
  3975   02  DFHEIV9               PIC X(01).
  3976   02  DFHEIV10              PIC S9(7) COMP-3.
  3977   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3978   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3979   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3980   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3981   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3982   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3983   02  DFHEIV17              PIC X(04).
  3984   02  DFHEIV18              PIC X(04).
  3985   02  DFHEIV19              PIC X(04).
  3986   02  DFHEIV20              USAGE IS POINTER.
  3987   02  DFHEIV21              USAGE IS POINTER.
  3988   02  DFHEIV22              USAGE IS POINTER.
  3989   02  DFHEIV23              USAGE IS POINTER.
  3990   02  DFHEIV24              USAGE IS POINTER.
  3991   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3992   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3993   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3994   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3995   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3996   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3997   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3998   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3999   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4000   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4001   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4002   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4003   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4004   02  FILLER                PIC X(02).
  4005   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4006   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4007   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4008   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4009   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4010   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4011   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4012 LINKAGE  SECTION.
  4013*****************************************************************
  4014*                                                               *
  4015* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  71
* WSMESS03.cbl
  4016* All rights reserved.                                          *
  4017*                                                               *
  4018*****************************************************************
  4019 01  dfheiblk.
  4020     02  eibtime          pic s9(7) comp-3.
  4021     02  eibdate          pic s9(7) comp-3.
  4022     02  eibtrnid         pic x(4).
  4023     02  eibtaskn         pic s9(7) comp-3.
  4024     02  eibtrmid         pic x(4).
  4025     02  dfheigdi         pic s9(4) comp.
  4026     02  eibcposn         pic s9(4) comp.
  4027     02  eibcalen         pic s9(4) comp.
  4028     02  eibaid           pic x(1).
  4029     02  eibfiller1       pic x(1).
  4030     02  eibfn            pic x(2).
  4031     02  eibfiller2       pic x(2).
  4032     02  eibrcode         pic x(6).
  4033     02  eibfiller3       pic x(2).
  4034     02  eibds            pic x(8).
  4035     02  eibreqid         pic x(8).
  4036     02  eibrsrce         pic x(8).
  4037     02  eibsync          pic x(1).
  4038     02  eibfree          pic x(1).
  4039     02  eibrecv          pic x(1).
  4040     02  eibsend          pic x(1).
  4041     02  eibatt           pic x(1).
  4042     02  eibeoc           pic x(1).
  4043     02  eibfmh           pic x(1).
  4044     02  eibcompl         pic x(1).
  4045     02  eibsig           pic x(1).
  4046     02  eibconf          pic x(1).
  4047     02  eiberr           pic x(1).
  4048     02  eibrldbk         pic x(1).
  4049     02  eiberrcd         pic x(4).
  4050     02  eibsynrb         pic x(1).
  4051     02  eibnodat         pic x(1).
  4052     02  eibfiller5       pic x(2).
  4053     02  eibresp          pic s9(8) comp.
  4054     02  eibresp2         pic s9(8) comp.
  4055     02  dfheigdj         pic s9(4) comp.
  4056     02  dfheigdk         pic s9(4) comp.
  4057 01  DFHCOMMAREA                 pic x(1024).
  4058 01  var  pic x(30).
  4059 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  4060 0000-DFHEXIT SECTION.
  4061     MOVE '9#                    $   ' TO DFHEIV0.
  4062     MOVE 'WSMESS03' TO DFHEIV1.
  4063     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4064     display ' Entering program WSMESS03 '
  4065     move dfhcommarea            to ws-mess003-pass-area
  4066     perform 0000-init           thru 0000-exit
  4067     display ' mess003 area ' ws-mess003-pass-area
  4068     perform 0010-process-message
  4069                                 thru 0010-exit
  4070*    move ' returning string goes here ' to ws-return-string
  4071     go to 0300-RETURN-CICS
  4072     .
  4073 0000-init.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  72
* WSMESS03.cbl
  4074     move 'CID'                  to client-id
  4075     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  4076     move ws-fn-cymd             to dc-greg-date-cymd
  4077     move 'L'                    to dc-option-code
  4078     perform 9700-date-link      thru 9700-exit
  4079     if no-conversion-error
  4080        move dc-bin-date-1       to ws-bin-current-dt
  4081     else
  4082        display ' error current dt invalid ' dc-error-code
  4083     end-if
  4084     set P to address of KIXSYS
  4085     CALL "getenv" using by value P returning var-ptr
  4086     if var-ptr = null then
  4087        display ' kixsys not set '
  4088     else
  4089        set address of var to var-ptr
  4090        move 0 to env-var-len
  4091        inspect var tallying env-var-len
  4092          for characters before X'00'
  4093        unstring var (1:env-var-len) delimited by '/'
  4094           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  4095              WS-KIX-SYS
  4096        end-unstring
  4097     end-if
  4098     evaluate client-id
  4099        when 'DCC'
  4100           MOVE X'05'            TO WS-COMP-CD
  4101           MOVE 'DCC'            TO WS-COMP-ID
  4102        when 'CID'
  4103           MOVE X'04'            TO WS-COMP-CD
  4104           MOVE 'CID'            TO WS-COMP-ID
  4105        when 'AHL'
  4106           MOVE X'06'            TO WS-COMP-CD
  4107           MOVE 'AHL'            TO WS-COMP-ID
  4108        when other
  4109           display ' Invalid company id ' client-id
  4110           move 23               to ws-error-sub
  4111           move client-id        to ws-error-sup
  4112           perform 0180-error-handle
  4113                                 thru 0180-exit
  4114           go to 0300-RETURN-CICS
  4115     END-evaluate
  4116     move spaces                 to ws-return-string
  4117     move ';'                    to ws-sc1
  4118                                    ws-sc2
  4119                                    ws-sc3
  4120                                    ws-sc4
  4121                                    ws-sc5
  4122                                    ws-sc6
  4123                                    ws-sc7
  4124                                    ws-sc8
  4125                                    ws-sc9
  4126                                    ws-sc10
  4127                                    ws-sc11
  4128                                    ws-sc12
  4129                                    ws-sc13
  4130                                    ws-sc14
  4131                                    ws-sc15
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  73
* WSMESS03.cbl
  4132                                    ws-sc16
  4133                                    ws-sc17
  4134                                    ws-sc18
  4135                                    ws-sc19
  4136                                    ws-sc20
  4137                                    ws-sc21
  4138                                    ws-sc22
  4139                                    ws-sc23
  4140                                    ws-sc24
  4141     .
  4142 0000-exit.
  4143     exit.
  4144 0010-process-message.
  4145     perform 0110-unstring       thru 0110-exit
  4146     perform 0120-format-message thru 0120-exit
  4147     perform 0020-edit-received  thru 0020-exit
  4148     perform 0025-assign-ben-cd  thru 0025-exit
  4149     perform 0050-get-account    thru 0050-exit
  4150     perform 0090-get-limits     thru 0090-exit
  4151     perform 0058-get-state-controls
  4152                                 thru 0058-exit
  4153     perform 0030-get-lf-rate    thru 0030-exit
  4154     perform 0035-get-ah-rate    thru 0035-exit
  4155     if (contract-no-assigned)
  4156            or
  4157        (error-in-one-coverage)
  4158        continue
  4159     else
  4160        perform 0060-check-for-dup
  4161                                 thru 0060-exit
  4162        perform 0070-open-cursor thru 0070-exit
  4163        perform 0080-process-input
  4164                                 thru 0080-exit
  4165     end-if
  4166     perform 0040-format-buffer  thru 0040-exit
  4167     set contract-no-assigned to true
  4168     .
  4169 0010-exit.
  4170     exit.
  4171 0020-edit-received.
  4172     if ws-rate-sin-jnt-lf = '*'
  4173        set no-life-coverage to true
  4174     end-if
  4175     if ws-rate-sin-jnt-lf = 'S' OR 'J'
  4176        continue
  4177     else
  4178        move 'S'                 to ws-rate-sin-jnt-lf
  4179     end-if
  4180     if ws-rate-sin-jnt-ah = 'S' OR 'J'
  4181        continue
  4182     else
  4183        move 'S'                 to ws-rate-sin-jnt-ah
  4184     end-if
  4185     if ws-rate-dismemberment = 'Y'
  4186        continue
  4187     else
  4188        move 'N'                 to ws-rate-dismemberment
  4189     end-if
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  74
* WSMESS03.cbl
  4190     if ws-rate-in-ah-ben-code = 'A'
  4191        if ws-rate-retro-elim = 'R' or 'E'
  4192           continue
  4193        else
  4194           move 'R'              to ws-rate-retro-elim
  4195        end-if
  4196     else
  4197        move spaces              to ws-rate-retro-elim
  4198     end-if
  4199**==============================================================**
  4200**                                                              **
  4201**  Validate passed effective date. Probably should add edits   **
  4202**                                                              **
  4203**==============================================================**
  4204     move ws-rate-eff-date (7:4) to ws-work-date (1:4)
  4205     move ws-rate-eff-date (1:2) to ws-work-date (5:2)
  4206     move ws-rate-eff-date (4:2) to ws-work-date (7:2)
  4207     move ws-work-date-num       to dc-greg-date-cymd
  4208     move 'L'                    to dc-option-code
  4209     perform 9700-date-link      thru 9700-exit
  4210     if no-conversion-error
  4211        move dc-bin-date-1       to ws-bin-eff-dt
  4212     else
  4213        move 3                   to ws-error-sub
  4214        move '- Eff Date'        to ws-error-sup
  4215        perform 0180-error-handle
  4216                                 thru 0180-exit
  4217        go to 0300-RETURN-CICS
  4218     end-if
  4219     if ws-bin-eff-dt > ws-bin-current-dt
  4220        move 3                   to ws-error-sub
  4221        move '- Future Eff'      to ws-error-sup
  4222        perform 0180-error-handle
  4223                                 thru 0180-exit
  4224        go to 0300-RETURN-CICS
  4225     end-if
  4226**==============================================================**
  4227**                                                              **
  4228**  Validate passed 1st pmt date.   Probably should add edits   **
  4229**                                                              **
  4230**==============================================================**
  4231     move ws-rate-1st-pmt-dt (7:4)
  4232                                 to ws-work-date (1:4)
  4233     move ws-rate-1st-pmt-dt (1:2)
  4234                                 to ws-work-date (5:2)
  4235     move ws-rate-1st-pmt-dt (4:2)
  4236                                 to ws-work-date (7:2)
  4237     move ws-work-date-num       to dc-greg-date-cymd
  4238     move 'L'                    to dc-option-code
  4239     perform 9700-date-link      thru 9700-exit
  4240     if no-conversion-error
  4241        move dc-bin-date-1       to ws-bin-1st-pmt-dt
  4242     else
  4243        move low-values          to ws-bin-1st-pmt-dt
  4244        move 3                   to ws-error-sub
  4245        move '- 1st Pmt Dt'      to ws-error-sup
  4246        perform 0180-error-handle
  4247                                 thru 0180-exit
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  75
* WSMESS03.cbl
  4248        go to 0300-RETURN-CICS
  4249     end-if
  4250     if ws-bin-1st-pmt-dt <= ws-bin-eff-dt
  4251        move low-values          to ws-bin-1st-pmt-dt
  4252        move 3                   to ws-error-sub
  4253        move '- 1st Pmt !> Eff dt' to ws-error-sup
  4254        perform 0180-error-handle
  4255                                 thru 0180-exit
  4256        go to 0300-RETURN-CICS
  4257     end-if
  4258**==============================================================**
  4259**                                                              **
  4260**  Only use the code below if there is a time they don't       **
  4261**  send the 1st pmt date.                                      **
  4262**                                                              **
  4263**==============================================================**
  4264     if ws-bin-1st-pmt-dt = low-values
  4265        move +1                  to dc-elapsed-months
  4266        move +0                  to dc-elapsed-days
  4267        move '6'                 to dc-option-code
  4268        perform 9700-date-link   thru 9700-exit
  4269        if no-conversion-error
  4270           move dc-bin-date-2    to ws-bin-1st-pmt-dt
  4271        else
  4272           move 3                to ws-error-sub
  4273           move '- 1st Pmt Dt'   to ws-error-sup
  4274           perform 0180-error-handle
  4275                                 thru 0180-exit
  4276           go to 0300-RETURN-CICS
  4277        end-if
  4278     end-if
  4279**==============================================================**
  4280**                                                              **
  4281**  Calculate the days to first payment date                    **
  4282**                                                              **
  4283**==============================================================**
  4284     move ws-bin-eff-dt          to dc-bin-date-1
  4285     move ws-bin-1st-pmt-dt      to dc-bin-date-2
  4286     move zeros                  to dc-elapsed-months
  4287                                    dc-elapsed-days
  4288     move '1'                    to dc-option-code
  4289     perform 9700-date-link   thru 9700-exit
  4290     if no-conversion-error
  4291        move dc-elapsed-days     to d
  4292     else
  4293        move 30                  to d
  4294     end-if
  4295**==============================================================**
  4296**                                                              **
  4297**  Calculate the lf expiration date to be passed back.         **
  4298**                                                              **
  4299**==============================================================**
  4300     move ws-bin-1st-pmt-dt      to dc-bin-date-1
  4301     compute dc-elapsed-months = ws-rate-lf-term - 1
  4302     move +0                     to dc-elapsed-days
  4303     move '6'                    to dc-option-code
  4304     perform 9700-date-link      thru 9700-exit
  4305     if no-conversion-error
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  76
* WSMESS03.cbl
  4306        move dc-bin-date-2       to ws-bin-lf-exp-dt
  4307        move dc-greg-date-a-edit to ws-lf-exp-date
  4308     else
  4309        move 3                   to ws-error-sub
  4310        move '- Lf Exp Dt'       to ws-error-sup
  4311        perform 0180-error-handle
  4312                                 thru 0180-exit
  4313        go to 0300-RETURN-CICS
  4314     end-if
  4315**==============================================================**
  4316**                                                              **
  4317**  Calculate the ah expiration date to be passed back.         **
  4318**                                                              **
  4319**==============================================================**
  4320     move ws-bin-1st-pmt-dt      to dc-bin-date-1
  4321     compute dc-elapsed-months = ws-rate-ah-term - 1
  4322     move +0                     to dc-elapsed-days
  4323     move '6'                    to dc-option-code
  4324     perform 9700-date-link      thru 9700-exit
  4325     if no-conversion-error
  4326        move dc-bin-date-2       to ws-bin-ah-exp-dt
  4327        move dc-greg-date-a-edit to ws-ah-exp-date
  4328     else
  4329        move 3                   to ws-error-sub
  4330        move '- Ah Exp Dt'       to ws-error-sup
  4331        perform 0180-error-handle
  4332                                 thru 0180-exit
  4333        go to 0300-RETURN-CICS
  4334     end-if
  4335**==============================================================**
  4336**                                                              **
  4337**  Calculate the loan expiration date to be passed back.       **
  4338**                                                              **
  4339**==============================================================**
  4340     move ws-bin-1st-pmt-dt      to dc-bin-date-1
  4341     compute dc-elapsed-months = ws-rate-loan-term - 1
  4342     move +0                     to dc-elapsed-days
  4343     move '6'                    to dc-option-code
  4344     perform 9700-date-link      thru 9700-exit
  4345     if no-conversion-error
  4346        move dc-bin-date-2       to ws-bin-loan-exp-dt
  4347        move dc-greg-date-a-edit to ws-loan-exp-date
  4348     else
  4349        move 3                   to ws-error-sub
  4350        move '- Loan Exp Dt'     to ws-error-sup
  4351        perform 0180-error-handle
  4352                                 thru 0180-exit
  4353        go to 0300-RETURN-CICS
  4354     end-if
  4355**==============================================================**
  4356**                                                              **
  4357**  Validate primary borrower birth date.                       **
  4358**                                                              **
  4359**==============================================================**
  4360     move ws-rate-pri-birth-date (7:4)
  4361                                 to ws-work-date (1:4)
  4362     move ws-rate-pri-birth-date (1:2)
  4363                                 to ws-work-date (5:2)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  77
* WSMESS03.cbl
  4364     move ws-rate-pri-birth-date (4:2)
  4365                                 to ws-work-date (7:2)
  4366     move ws-work-date-num       to dc-greg-date-cymd
  4367     move 'L'                    to dc-option-code
  4368     perform 9700-date-link      thru 9700-exit
  4369     if no-conversion-error
  4370        move dc-bin-date-1       to ws-bin-pri-birth-dt
  4371     else
  4372        move 3                   to ws-error-sub
  4373        move '- Pri DOB '        to ws-error-sup
  4374        perform 0180-error-handle
  4375                                 thru 0180-exit
  4376        go to 0300-RETURN-CICS
  4377     end-if
  4378**==============================================================**
  4379**                                                              **
  4380**  Validate co borrowers birth date.                           **
  4381**                                                              **
  4382**==============================================================**
  4383     if ws-rate-cob-birth-date (7:4) = spaces
  4384        move zeros               to ws-rate-cob-birth-date
  4385     end-if
  4386     move ws-rate-cob-birth-date (7:4)
  4387                                 to ws-work-date (1:4)
  4388     move ws-rate-cob-birth-date (1:2)
  4389                                 to ws-work-date (5:2)
  4390     move ws-rate-cob-birth-date (4:2)
  4391                                 to ws-work-date (7:2)
  4392     move low-values             to ws-bin-cob-birth-dt
  4393     if ws-work-date-num not = zeros
  4394        move ws-work-date-num    to dc-greg-date-cymd
  4395        move 'L'                 to dc-option-code
  4396        perform 9700-date-link   thru 9700-exit
  4397        if no-conversion-error
  4398           move dc-bin-date-1    to ws-bin-cob-birth-dt
  4399        else
  4400           move 3                to ws-error-sub
  4401           move '- Cob DOB '     to ws-error-sup
  4402           perform 0180-error-handle
  4403                                 thru 0180-exit
  4404           go to 0300-RETURN-CICS
  4405        end-if
  4406     end-if
  4407**==============================================================**
  4408**                                                              **
  4409**  Calculate primary borrowers age.                            **
  4410**                                                              **
  4411**==============================================================**
  4412     move ws-bin-pri-birth-dt    to dc-bin-date-1
  4413     move ws-bin-eff-dt          to dc-bin-date-2
  4414     move '1'                    to dc-option-code
  4415     perform 9700-date-link      thru 9700-exit
  4416     if no-conversion-error
  4417        compute ws-issue-age = dc-elapsed-months / +12
  4418     else
  4419        move 3                   to ws-error-sub
  4420        move '- Pri DOB '        to ws-error-sup
  4421        perform 0180-error-handle
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  78
* WSMESS03.cbl
  4422                                 thru 0180-exit
  4423        go to 0300-RETURN-CICS
  4424     end-if
  4425**==============================================================**
  4426**                                                              **
  4427**  Calculate primary borrowers age at expiration date          **
  4428**                                                              **
  4429**==============================================================**
  4430     move ws-bin-pri-birth-dt    to dc-bin-date-1
  4431     move ws-bin-lf-exp-dt       to dc-bin-date-2
  4432     if ws-bin-ah-exp-dt > dc-bin-date-2
  4433        move ws-bin-ah-exp-dt    to dc-bin-date-2
  4434     end-if
  4435     move '1'                    to dc-option-code
  4436     perform 9700-date-link      thru 9700-exit
  4437     if no-conversion-error
  4438        compute ws-att-age = dc-elapsed-months / +12
  4439     else
  4440        move 3                   to ws-error-sub
  4441        move '- Pri DOB '        to ws-error-sup
  4442        perform 0180-error-handle
  4443                                 thru 0180-exit
  4444        go to 0300-RETURN-CICS
  4445     end-if
  4446**==============================================================**
  4447**                                                              **
  4448**  Calculate co borrowers age.                                 **
  4449**                                                              **
  4450**==============================================================**
  4451     move zeros                  to ws-cob-age
  4452     if ws-bin-cob-birth-dt not = low-values
  4453        move ws-bin-cob-birth-dt to dc-bin-date-1
  4454        move ws-bin-eff-dt       to dc-bin-date-2
  4455        move '1'                 to dc-option-code
  4456        perform 9700-date-link   thru 9700-exit
  4457        if no-conversion-error
  4458           compute ws-cob-age = dc-elapsed-months / +12
  4459        else
  4460           move 3                to ws-error-sub
  4461           move '- Cob DOB '     to ws-error-sup
  4462           perform 0180-error-handle
  4463                                 thru 0180-exit
  4464           go to 0300-RETURN-CICS
  4465        end-if
  4466     end-if
  4467     move ws-issue-age           to ws-rate-age
  4468     if ws-cob-age > ws-rate-age
  4469        move ws-cob-age          to ws-rate-age
  4470     end-if
  4471**==============================================================**
  4472**                                                              **
  4473**  Calculate extension days.                                   **
  4474**                                                              **
  4475**==============================================================**
  4476     move zeros                  to ws-extension-days
  4477     move ws-bin-eff-dt          to dc-bin-date-1
  4478     move ws-bin-1st-pmt-dt      to dc-bin-date-2
  4479     move '1'                    to dc-option-code
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  79
* WSMESS03.cbl
  4480     perform 9700-date-link      thru 9700-exit
  4481     if no-conversion-error
  4482        if dc-elapsed-days > 31
  4483           compute ws-extension-days =
  4484              dc-elapsed-days - 30
  4485        end-if
  4486     end-if
  4487**==============================================================**
  4488**                                                              **
  4489**  Validate passed total of payments. loan term * payment      **
  4490**                                                              **
  4491**==============================================================**
  4492     if ws-rate-loan-type = '2'  *>   lease
  4493        if ws-rate-tot-pmts = 0
  4494           compute ws-rate-tot-pmts =
  4495              ws-rate-loan-term * ws-rate-payment
  4496        end-if
  4497     end-if
  4498     if ws-rate-loan-type = '2'  *> means it's a Lease
  4499        move ws-rate-tot-pmts    to ws-calc-tot-pmts
  4500     else
  4501        compute ws-calc-tot-pmts =
  4502           ws-rate-loan-term * ws-rate-payment
  4503     end-if
  4504     if ((ws-calc-tot-pmts - ws-rate-tot-pmts) > 1.00)
  4505                     or
  4506        ((ws-rate-tot-pmts - ws-calc-tot-pmts) > 1.00)
  4507*    if ws-calc-tot-pmts <> ws-rate-tot-pmts
  4508        move 26                  to ws-error-sub
  4509        move spaces              to ws-error-sup
  4510        perform 0180-error-handle
  4511                                 thru 0180-exit
  4512        go to 0300-RETURN-CICS
  4513     end-if
  4514**==============================================================**
  4515**                                                              **
  4516**  Validate life and dis terms                                 **
  4517**                                                              **
  4518**==============================================================**
  4519     if (ws-rate-lf-term > 0)
  4520        and (ws-rate-ah-term > 0)
  4521        if ws-rate-lf-term <> ws-rate-ah-term
  4522           move 27               to ws-error-sub
  4523           move ' '              to ws-error-sup
  4524           perform 0180-error-handle
  4525                                 thru 0180-exit
  4526           go to 0300-RETURN-CICS
  4527        end-if
  4528     end-if
  4529**==============================================================**
  4530**                                                              **
  4531**  Validate Loan term against insurance term.                  **
  4532**                                                              **
  4533**==============================================================**
  4534     if ((ws-rate-in-lf-ben-code (1:1) = 'G')
  4535        and (ws-rate-lf-term > 0)
  4536        and (ws-rate-lf-term <> ws-rate-loan-term))
  4537                  or
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  80
* WSMESS03.cbl
  4538        ((ws-rate-in-ah-ben-code (1:1) <> ' ')
  4539        and (raw-lf-ben-code = ' ')
  4540        and (ws-rate-ah-term > 0)
  4541        and (ws-rate-ah-term <> ws-rate-loan-term))
  4542        move 28               to ws-error-sub
  4543        move ' '              to ws-error-sup
  4544        perform 0180-error-handle
  4545                                 thru 0180-exit
  4546        go to 0300-RETURN-CICS
  4547     end-if
  4548**==============================================================**
  4549**                                                              **
  4550**  Validate total of payments against benefit amount for gross **
  4551**                                                              **
  4552**==============================================================**
  4553**  just learned that the rate benefit will be the amt financed
  4554**  and not the total of payments so I commented out this error
  4555     if (ws-rate-in-lf-ben-code (1:1) = 'G' or 'L')
  4556        and (ws-rate-tot-pmts <> ws-rate-benefit)
  4557        move ws-rate-tot-pmts    to ws-rate-benefit
  4558     end-if
  4559**  just learned that we are verifying leases.
  4560     if ws-rate-loan-type = '2'
  4561        if ws-rate-in-lf-ben-code (1:1) = 'G' or 'L'
  4562           compute ws-rate-benefit =
  4563              ws-rate-payment * (ws-rate-lf-term - 1)
  4564        else
  4565           if ws-rate-in-ah-ben-code (1:1) = 'A'
  4566              compute ws-rate-benefit =
  4567                 ws-rate-payment * (ws-rate-ah-term - 1)
  4568           end-if
  4569        end-if
  4570     end-if
  4571     move ws-rate-benefit        to ws-rate-amt-financed
  4572**   if (ws-rate-in-lf-ben-code (1:1) = 'G')
  4573**      and (ws-rate-tot-pmts <> ws-rate-benefit)
  4574**      move 29               to ws-error-sub
  4575**      move ' '              to ws-error-sup
  4576**      perform 0180-error-handle
  4577**                               thru 0180-exit
  4578**      go to 0300-RETURN-CICS
  4579**   end-if
  4580     .
  4581 0020-exit.
  4582     exit.
  4583 0025-assign-ben-cd.
  4584     if not connected-to-db
  4585        perform 6000-connect-to-db thru 6000-exit
  4586     end-if
  4587     move ws-rate-state          to ws-sbc-state
  4588     evaluate true
  4589        when ws-rate-in-lf-ben-code (1:1) = 'N'
  4590           move 'NP'             to ws-sbc-cov-type
  4591        when ws-rate-in-lf-ben-code (1:1) = 'T'
  4592           move 'NT'             to ws-sbc-cov-type
  4593        when ws-rate-in-lf-ben-code (1:1) = 'L'
  4594           move 'LL'             to ws-sbc-cov-type
  4595        when ws-rate-in-lf-ben-code (1:1) = ' '
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  81
* WSMESS03.cbl
  4596           go to 0025-get-ah-ben
  4597        when other
  4598           move 'GP'             to ws-sbc-cov-type
  4599     end-evaluate
  4600     move ws-rate-benefit        to ws-sbc-ben-amt
  4601     move ws-rate-sin-jnt-lf     to ws-sbc-sin-jnt
  4602     move ws-rate-dismemberment  to ws-sbc-dismember
  4603     EXEC SQL
  4604        SELECT TOP (1)
  4605           MIN(BenefitAmt) as LessAmt,
  4606           LogicBenCode
  4607        INTO
  4608           :ws-sbc-min-amt,
  4609           :ws-sbc-logic-ben-code
  4610        FROM
  4611           BenefitCodeMapping
  4612        WHERE
  4613           State           = :ws-sbc-state
  4614           and CovType     = :ws-sbc-cov-type
  4615           and SinJnt      = :ws-sbc-sin-jnt
  4616           and Dismem      = :ws-sbc-dismember
  4617           and BenefitAmt  > :ws-sbc-ben-amt
  4618        GROUP BY
  4619           LogicBenCode
  4620        ORDER BY
  4621           LessAmt
  4622     end-exec
  4623     if sqlcode not = 0 and 1
  4624        display "Error: cannot find lf benefit code "
  4625           ws-sbc-state ' ' ws-sbc-cov-type ' ' ws-sbc-sin-jnt
  4626           ' ' ws-sbc-dismember
  4627        display ' sql return code ' sqlcode
  4628        display ' sql err mess    ' sqlerrmc
  4629        move 24                  to ws-error-sub
  4630        move spaces to ws-error-sup
  4631        string
  4632           ws-sbc-state ' '
  4633           ws-sbc-cov-type ' '
  4634           ws-sbc-sin-jnt ' '
  4635           ws-sbc-dismember
  4636           delimited by size into ws-error-sup
  4637        perform 0180-error-handle
  4638                                 thru 0180-exit
  4639        go to 0300-return-cics
  4640     end-if
  4641     move ws-sbc-logic-ben-code  to ws-rate-lf-benefit-cd
  4642     .
  4643 0025-get-ah-ben.
  4644     if ws-rate-in-ah-ben-code (1:1) = ' '
  4645        go to 0025-exit
  4646     end-if
  4647     move ws-rate-state          to ws-sbc-state
  4648     move 'DI'                   to ws-sbc-cov-type
  4649     move ws-rate-benefit        to ws-sbc-ben-amt
  4650     move ws-rate-sin-jnt-ah     to ws-sbc-sin-jnt
  4651     move ws-rate-retro-elim     to ws-sbc-retroelim
  4652     move ws-rate-waiting-days   to ws-sbc-wait-days
  4653     move ws-rate-crit-per       to ws-sbc-max-bens
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  82
* WSMESS03.cbl
  4654     EXEC SQL
  4655        SELECT TOP (1)
  4656           MIN(BenefitAmt) as LessAmt,
  4657           LogicBenCode
  4658        INTO
  4659           :ws-sbc-min-amt,
  4660           :ws-sbc-logic-ben-code
  4661        FROM
  4662           BenefitCodeMapping
  4663        WHERE
  4664           State           = :ws-sbc-state
  4665           and CovType     = :ws-sbc-cov-type
  4666           and SinJnt      = :ws-sbc-sin-jnt
  4667           and RetroElim   = :ws-sbc-retroelim
  4668           and WaitDays    = :ws-sbc-wait-days
  4669           and MaxBens     = :ws-sbc-max-bens
  4670           and BenefitAmt  > :ws-sbc-ben-amt
  4671        GROUP BY
  4672           LogicBenCode
  4673        ORDER BY
  4674           LessAmt
  4675     end-exec
  4676     if sqlcode not = 0
  4677        display "Error: cannot find ah benefit code "
  4678           ws-sbc-state ' ' ws-sbc-cov-type ' ' ws-sbc-sin-jnt
  4679           ' ' ws-sbc-retroelim ' ' ws-sbc-wait-days ' '
  4680           ws-sbc-max-bens
  4681        display ' sql return code ' sqlcode
  4682        display ' sql err mess    ' sqlerrmc
  4683        move 25                  to ws-error-sub
  4684        move spaces              to ws-error-sup
  4685        string
  4686           ws-sbc-state ' '
  4687           ws-sbc-cov-type ' '
  4688           ws-sbc-sin-jnt ' '
  4689           ws-sbc-retroelim ' '
  4690           ws-sbc-wait-days ' '
  4691           ws-sbc-max-bens
  4692           delimited by size into ws-error-sup
  4693        perform 0180-error-handle
  4694                                 thru 0180-exit
  4695        go to 0300-return-cics
  4696     end-if
  4697     move ws-sbc-logic-ben-code  to ws-rate-ah-benefit-cd
  4698     .
  4699 0025-exit.
  4700     exit.
  4701 0030-get-lf-rate.
  4702     if raw-lf-ben-code (1:1) = ' '
  4703        go to 0030-exit
  4704     end-if
  4705     perform 0054-get-lf-ben-code thru 0054-exit
  4706*    move spaces                 to calculation-pass-area
  4707     move zeros                  to cp-r-max-mon-ben
  4708                                    cp-r-max-tot-ben
  4709                                    cp-rate-dev-pct
  4710                                    cp-original-premium
  4711                                    cp-critical-months
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  83
* WSMESS03.cbl
  4712                                    cp-term-or-ext-days
  4713     move am-cal-table           to cp-class-CODE
  4714     move am-lf-deviation        to cp-deviation-code
  4715     move ws-rate-state          to cp-state
  4716                                    cp-state-std-abbrv
  4717     move ws-state-chg-ext-days  to cp-ext-days-calc
  4718     move ws-lf-coverage-type    to cp-benefit-type
  4719     move ws-rate-lf-benefit-cd  to cp-benefit-cd
  4720     move ws-rate-benefit        to cp-original-benefit
  4721                                    cp-rating-benefit-amt
  4722     move ws-rate-age            to cp-issue-age
  4723     move ws-comp-id             to cp-company-id
  4724     move ws-comp-cd             to cp-company-cd
  4725     move ws-rate-apr            to cp-loan-apr
  4726     if ws-rate-loan-term = zeros
  4727        move ws-rate-lf-term     to ws-rate-loan-term
  4728     end-if
  4729     move ws-rate-lf-term        to cp-original-term
  4730     move ws-rate-loan-term      to cp-loan-term
  4731     if ws-rate-loan-type = '2'   *>  Lease
  4732        compute cp-original-term =
  4733           cp-original-term - 1
  4734        compute cp-loan-term =
  4735           cp-loan-term - 1
  4736     end-if
  4737     if (cp-original-term = zeros)
  4738        and (cp-loan-term = zeros)
  4739        move 20                  to ws-error-sub
  4740        move '-Lf term'          to ws-error-sup
  4741        perform 0180-error-handle
  4742                                 thru 0180-exit
  4743        go to 0300-return-cics
  4744     end-if
  4745*    if ws-rate-in-lf-ben-code (1:1) = 'N' or 'T'
  4746*       compute cp-original-benefit =
  4747*          cp-original-benefit - ws-rate-lf-prem - ws-rate-ah-prem
  4748*    end-if
  4749     move 'L'                    to cp-life-override-code
  4750     move 'A'                    to cp-ah-override-code
  4751     move '3'                    to cp-process-type
  4752     move ws-lf-special-calc-cd  to cp-special-calc-cd
  4753     move ws-lf-earning-calc     to cp-earning-method
  4754                                    cp-rating-method
  4755     move 'R'                    to cp-rate-file
  4756     move ws-bin-eff-dt          to cp-cert-eff-dt
  4757     move ws-bin-1st-pmt-dt      to cp-first-pay-date
  4758     move ws-rate-lf-prem        to cp-original-premium
  4759     if d > 30
  4760        compute cp-term-or-ext-days = d - 30
  4761     else
  4762        move zeros               to cp-term-or-ext-days
  4763     end-if
  4764     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  4765     evaluate true
  4766        when cp-return-code = '0' or '8' or '9' or 'A' or
  4767           'B' or 'C'
  4768           move '0'              to cp-return-code
  4769           if ((cp-calc-premium - ws-rate-lf-prem) > 9.99)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  84
* WSMESS03.cbl
  4770                        or
  4771              ((ws-rate-lf-prem - cp-calc-premium) > 9.99)
  4772              move 18            to ws-error-sub
  4773              move '-Lf Prem'    to ws-error-sup
  4774*    move cp-calc-premium     to ws-rate-lf-prem
  4775*    move cp-premium-rate     to ws-rate-lf-rate
  4776*    perform 0040-format-buffer  thru 0040-exit
  4777              perform 0180-error-handle
  4778                                 thru 0180-exit
  4779              go to 0300-return-cics
  4780           end-if
  4781        when cp-return-code = '7'
  4782           move '0'              to cp-return-code
  4783           move 14               to ws-error-sub
  4784           move '-Lf Rates'      to ws-error-sup
  4785           perform 0180-error-handle
  4786                                 thru 0180-exit
  4787           go to 0300-return-cics
  4788        when cp-return-code = '6'
  4789           move '0'              to cp-return-code
  4790           move 15               to ws-error-sub
  4791           move ' '              to ws-error-sup
  4792           perform 0180-error-handle
  4793                                 thru 0180-exit
  4794           go to 0300-return-cics
  4795        when cp-return-code = 'D'
  4796           move '0'              to cp-return-code
  4797           move 17               to ws-error-sub
  4798           move ' '              to ws-error-sup
  4799           perform 0180-error-handle
  4800                                 thru 0180-exit
  4801           go to 0300-return-cics
  4802     end-evaluate
  4803     move cp-calc-premium     to ws-rate-new-lf-prem
  4804     move cp-premium-rate     to ws-rate-lf-rate
  4805     .
  4806 0030-exit.
  4807     exit.
  4808 0035-get-ah-rate.
  4809     if ws-rate-in-ah-ben-code (1:1) = ' '
  4810        go to 0035-exit
  4811     end-if
  4812     perform 0056-get-di-ben-code thru 0056-exit
  4813*    move spaces                 to calculation-pass-area
  4814     move zeros                  to cp-r-max-mon-ben
  4815                                    cp-r-max-tot-ben
  4816                                    cp-rate-dev-pct
  4817                                    cp-original-premium
  4818                                    cp-critical-months
  4819                                    cp-term-or-ext-days
  4820                                    cp-original-benefit
  4821                                    cp-rating-benefit-amt
  4822     move am-cal-table           to cp-class-CODE
  4823     move am-ah-deviation        to cp-deviation-code
  4824     move ws-rate-state          to cp-state
  4825                                    cp-state-std-abbrv
  4826     move ws-state-chg-ext-days  to cp-ext-days-calc
  4827     move 'A'                    to cp-benefit-type
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  85
* WSMESS03.cbl
  4828     move ws-rate-ah-benefit-cd  to cp-benefit-cd
  4829     if ws-rate-ah-term > zeros
  4830        compute cp-original-benefit =
  4831           ws-rate-benefit / ws-rate-ah-term
  4832        move cp-original-benefit to cp-rating-benefit-amt
  4833     end-if
  4834*    move ws-rate-benefit        to cp-original-benefit
  4835*                                   cp-rating-benefit-amt
  4836     move ws-rate-payment        to cp-original-benefit
  4837                                    cp-rating-benefit-amt
  4838     move ws-rate-age            to cp-issue-age
  4839     move ws-comp-id             to cp-company-id
  4840     move ws-comp-cd             to cp-company-cd
  4841     if ws-rate-loan-term = zeros
  4842        move ws-rate-ah-term     to ws-rate-loan-term
  4843     end-if
  4844     move ws-rate-ah-term        to cp-original-term
  4845     move ws-rate-loan-term      to cp-loan-term
  4846     if ws-rate-loan-type = '2'   *>  Lease
  4847        compute cp-original-term =
  4848           cp-original-term - 1
  4849        compute cp-loan-term =
  4850           cp-loan-term - 1
  4851     end-if
  4852     if (cp-original-term = zeros)
  4853        and (cp-loan-term = zeros)
  4854        move 21                  to ws-error-sub
  4855        move '-DI term'          to ws-error-sup
  4856        perform 0180-error-handle
  4857                                 thru 0180-exit
  4858        go to 0300-return-cics
  4859     end-if
  4860     move 'L'                    to cp-life-override-code
  4861     move 'A'                    to cp-ah-override-code
  4862     move '3'                    to cp-process-type
  4863     move ws-ah-earnings-calc    to cp-earning-method
  4864                                    cp-rating-method
  4865     move ws-ah-special-calc-cd  to cp-special-calc-cd
  4866     move 'R'                    to cp-rate-file
  4867     move ws-bin-eff-dt          to cp-cert-eff-dt
  4868     move ws-bin-1st-pmt-dt      to cp-first-pay-date
  4869     if d > 30
  4870        compute cp-term-or-ext-days = d - 30
  4871     else
  4872        move zeros               to cp-term-or-ext-days
  4873     end-if
  4874     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  4875     evaluate true
  4876        when cp-return-code = '0' or '8' or '9' or 'A' or
  4877           'B' or 'C'
  4878           move '0'              to cp-return-code
  4879           if ((cp-calc-premium - ws-rate-ah-prem) > 9.99)
  4880                           or
  4881              ((ws-rate-ah-prem - cp-calc-premium) > 9.99)
  4882              move 18            to ws-error-sub
  4883              move '-Ah Prem'    to ws-error-sup
  4884              perform 0180-error-handle
  4885                                 thru 0180-exit
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  86
* WSMESS03.cbl
  4886              go to 0300-return-cics
  4887           end-if
  4888        when cp-return-code = '7'
  4889           move '0'              to cp-return-code
  4890           move 14               to ws-error-sub
  4891           move '-Ah Rates'      to ws-error-sup
  4892           perform 0180-error-handle
  4893                                 thru 0180-exit
  4894           go to 0300-return-cics
  4895        when cp-return-code = '6'
  4896           move '0'              to cp-return-code
  4897           move 16               to ws-error-sub
  4898           move ' '              to ws-error-sup
  4899           perform 0180-error-handle
  4900                                 thru 0180-exit
  4901           go to 0300-return-cics
  4902        when cp-return-code = 'D'
  4903           move '0'              to cp-return-code
  4904           move 17               to ws-error-sub
  4905           move ' '              to ws-error-sup
  4906           perform 0180-error-handle
  4907                                 thru 0180-exit
  4908           go to 0300-return-cics
  4909     end-evaluate
  4910*    if (no-cp-error)
  4911*       or (cp-return-code = '8' or '9' or 'A' or 'B' or 'C')
  4912*       move '0'                 to cp-return-code
  4913*       if ((cp-calc-premium - ws-rate-ah-prem) > 9.99)
  4914*                       or
  4915*          ((ws-rate-ah-prem - cp-calc-premium) > 9.99)
  4916*           move 18                  to ws-error-sub
  4917*           move '-Ah Prem'          to ws-error-sup
  4918*           perform 0180-error-handle
  4919*                                thru 0180-exit
  4920*           go to 0300-return-cics
  4921*          move 'Z'              to cp-return-code
  4922*       end-if
  4923*    end-if
  4924     move zeros                  to ws-max-ah-benefit
  4925     move cp-calc-premium        to ws-rate-new-ah-prem
  4926     move cp-premium-rate        to ws-rate-ah-rate
  4927     .
  4928 0035-exit.
  4929     exit.
  4930 0040-format-buffer.
  4931     move spaces                 to ws-return-string
  4932     perform 0045-format-error   thru 0045-exit
  4933     move ';'                    to ws-sc1
  4934                                    ws-sc2
  4935                                    ws-sc3
  4936                                    ws-sc4
  4937                                    ws-sc5
  4938                                    ws-sc6
  4939                                    ws-sc7
  4940                                    ws-sc8
  4941                                    ws-sc9
  4942                                    ws-sc10
  4943                                    ws-sc11
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  87
* WSMESS03.cbl
  4944                                    ws-sc12
  4945                                    ws-sc13
  4946                                    ws-sc14
  4947                                    ws-sc15
  4948                                    ws-sc16
  4949                                    ws-sc17
  4950                                    ws-sc18
  4951                                    ws-sc19
  4952                                    ws-sc20
  4953                                    ws-sc21
  4954                                    ws-sc22
  4955                                    ws-sc23
  4956                                    ws-sc24
  4957     if no-cp-error
  4958        if ws-contract-suffix = spaces or low-values
  4959           move ws-contract-no   to ws-return-contract-no (2:10)
  4960        else
  4961           move ws-contract-no   to ws-return-contract-no (1:10)
  4962           move ws-contract-suffix
  4963                                 to ws-return-contract-no (11:1)
  4964        end-if
  4965*       move ws-rate-new-lf-prem to ws-return-lf-prem
  4966*       move ws-rate-new-ah-prem to ws-return-ah-prem
  4967        move ws-rate-lf-prem     to ws-return-lf-prem
  4968        move ws-rate-ah-prem     to ws-return-ah-prem
  4969        move ws-rate-lf-term     to ws-return-lf-term
  4970        move ws-rate-ah-term     to ws-return-ah-term
  4971        move ws-rate-lf-rate     to ws-return-lf-rate
  4972        move ws-rate-ah-rate     to ws-return-ah-rate
  4973        move ws-rate-in-lf-ben-code
  4974                                 to ws-return-lf-bencd
  4975        move ws-rate-crit-per    to ws-return-max-bens
  4976*       move ws-max-ah-benefit   to ws-return-ah-max-amt
  4977*       move ws-max-lf-benefit   to ws-return-lf-max-ben
  4978        move ws-lf-exp-date      to ws-return-lf-exp-dt
  4979        move ws-ah-exp-date      to ws-return-ah-exp-dt
  4980        move ws-loan-exp-date    to ws-return-loan-exp-dt
  4981        move ws-rate-lf-benefit-cd
  4982                                 to ws-return-lf-benefit-cd
  4983        move ws-rate-ah-benefit-cd
  4984                                 to ws-return-ah-benefit-cd
  4985        move ws-rate-payment     to ws-return-period-pmt
  4986                                    ws-return-ah-max-amt
  4987*       move ws-rate-tot-financed to ws-return-tot-financed
  4988        move ws-rate-tot-pmts    to ws-return-tot-pmts
  4989        move ws-rate-benefit     to ws-return-lf-max-ben
  4990        move ws-limit-name       to ws-return-limit-name
  4991        move am-cal-table        to ws-return-rate-class
  4992        perform 0200-calc-stuff  thru 0200-exit
  4993     else
  4994        set error-in-one-coverage to true
  4995        move spaces              to ws-contract-no
  4996                                    ws-contract-suffix
  4997     end-if
  4998     .
  4999 0040-exit.
  5000     exit.
  5001 0045-format-error.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  88
* WSMESS03.cbl
  5002     evaluate true
  5003        when cp-return-code = '0'
  5004           move +1               to s1
  5005        when cp-return-code = '1'
  5006           move +2               to s1
  5007        when cp-return-code = '2'
  5008           move +3               to s1
  5009        when cp-return-code = 'A'
  5010           move +4               to s1
  5011        when cp-return-code = 'B'
  5012           move +5               to s1
  5013        when cp-return-code = '4'
  5014           move +6               to s1
  5015        when cp-return-code = '9'
  5016           move +7               to s1
  5017        when cp-return-code = '8'
  5018           move +8               to s1
  5019        when cp-return-code = 'H'
  5020           move +9               to s1
  5021        when cp-return-code = 'C'
  5022           move +10              to s1
  5023        when cp-return-code = '7'
  5024           move +11              to s1
  5025        when cp-return-code = '6'
  5026           move +12              to s1
  5027        when cp-return-code = 'D'
  5028           move +13              to s1
  5029        when cp-return-code = 'Z'
  5030           move +14              to s1
  5031           move cp-calc-premium  to ws-return-ah-prem
  5032           move cp-premium-rate  to ws-return-ah-rate
  5033           move ws-max-ah-benefit
  5034                                 to ws-return-ah-max-amt
  5035           move ws-ah-exp-date   to ws-return-ah-exp-dt
  5036           move ws-rate-ah-benefit-cd
  5037                                 to ws-return-ah-benefit-cd
  5038        when cp-return-code = 'Y'
  5039           move +15              to s1
  5040           move cp-calc-premium  to ws-return-ah-prem
  5041           move cp-premium-rate  to ws-return-ah-rate
  5042           move ws-max-ah-benefit
  5043                                 to ws-return-ah-max-amt
  5044           move ws-ah-exp-date   to ws-return-ah-exp-dt
  5045           move ws-rate-ah-benefit-cd
  5046                                 to ws-return-ah-benefit-cd
  5047     end-evaluate
  5048     move ws-table-error-no (s1) to ws-return-error-no
  5049     move ws-table-error-mess (s1)
  5050                                 to ws-return-error-mess
  5051     .
  5052 0045-exit.
  5053     exit.
  5054 0050-get-account.
  5055     move ws-comp-cd             to ws-am-company-cd
  5056     move '9'                    to ws-am-carrier
  5057     move '000000'               to ws-am-group
  5058     move ws-rate-state          to ws-am-state
  5059     move ws-rate-acct-no        to ws-am-account
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  89
* WSMESS03.cbl
  5060     move ws-bin-eff-dt          to ws-am-exp-dt
  5061
  5062* exec cics read
  5063*       dataset      ('ERACCT')
  5064*       ridfld       (ws-am-key)
  5065*       into         (account-master)
  5066*       GTEQ
  5067*       resp         (ws-response)
  5068*    end-exec
  5069     MOVE LENGTH OF
  5070      account-master
  5071       TO DFHEIV11
  5072     MOVE 'ERACCT' TO DFHEIV1
  5073*    MOVE '&"IL       G          (  N#00004964' TO DFHEIV0
  5074     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5075     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5076     MOVE X'204E233030303034393634' TO DFHEIV0(25:11)
  5077     CALL 'kxdfhei1' USING DFHEIV0,
  5078           DFHEIV1,
  5079           account-master,
  5080           DFHEIV11,
  5081           ws-am-key,
  5082           DFHEIV99,
  5083           DFHEIV99,
  5084           DFHEIV99
  5085     MOVE EIBRESP  TO ws-response
  5086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5087     if resp-normal
  5088        and (ws-comp-cd = am-company-cd)
  5089        and (ws-rate-state = am-state)
  5090        and (ws-rate-acct-no = am-account)
  5091        and (ws-bin-eff-dt >= am-effective-dt)
  5092        and (ws-bin-eff-dt < am-expiration-dt)
  5093        continue
  5094     else
  5095        move '0114;No account mstr found ' to ws-return-string
  5096        go to 0300-RETURN-CICS
  5097     end-if
  5098     move am-comment-line (1)    to ws-form-limit-name
  5099     move spaces                 to ws-limit-name
  5100     perform varying l1 from +50 by -1 until
  5101        (l1 < +1)
  5102        or (ws-form-limit-name (l1:1) <> ' ')
  5103     end-perform
  5104     if l1 > +3
  5105        perform varying l1 from l1 by -1 until
  5106           (l1 < +1)
  5107           or (ws-form-limit-name (l1:1) = ' ')
  5108        end-perform
  5109        if l1 > +3
  5110           subtract +1 from l1
  5111           move ws-form-limit-name (1:l1)
  5112                                 to ws-limit-name
  5113        end-if
  5114     end-if
  5115     .
  5116 0050-exit.
  5117     exit.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  90
* WSMESS03.cbl
  5118 0054-get-lf-ben-code.
  5119     move ws-comp-id             to cntl-comp-id
  5120     move '4'                    to cntl-rec-type
  5121     move spaces                 to cntl-access
  5122     move ws-rate-lf-benefit-cd  to cntl-access(3:2)
  5123     move +0                     to cntl-seq-no
  5124
  5125* exec cics read
  5126*       dataset      ('ELCNTL')
  5127*       ridfld       (ELCNTL-KEY)
  5128*       into         (control-file)
  5129*       GTEQ
  5130*       resp         (ws-response)
  5131*    end-exec
  5132     MOVE LENGTH OF
  5133      control-file
  5134       TO DFHEIV11
  5135     MOVE 'ELCNTL' TO DFHEIV1
  5136*    MOVE '&"IL       G          (  N#00005008' TO DFHEIV0
  5137     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5138     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5139     MOVE X'204E233030303035303038' TO DFHEIV0(25:11)
  5140     CALL 'kxdfhei1' USING DFHEIV0,
  5141           DFHEIV1,
  5142           control-file,
  5143           DFHEIV11,
  5144           ELCNTL-KEY,
  5145           DFHEIV99,
  5146           DFHEIV99,
  5147           DFHEIV99
  5148     MOVE EIBRESP  TO ws-response
  5149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5150     if (resp-normal)
  5151        and (cntl-rec-type = '4')
  5152        perform varying b1 from +1 by +1 until
  5153           (b1 > 8)
  5154           or (cf-benefit-code(b1) = ws-rate-lf-benefit-cd)
  5155        end-perform
  5156        if b1 < 9
  5157           move cf-lf-coverage-type(b1)
  5158                                 to ws-lf-coverage-type
  5159           move cf-special-calc-cd(b1)
  5160                                 to ws-lf-special-calc-cd
  5161           move cf-joint-indicator(b1)
  5162                                 to ws-lf-joint-indicator
  5163           move cf-co-earnings-calc(b1)
  5164                                 to ws-lf-earning-calc
  5165        end-if
  5166     end-if
  5167     .
  5168 0054-exit.
  5169     exit.
  5170 0056-get-di-ben-code.
  5171     move ws-comp-id             to cntl-comp-id
  5172     move '5'                    to cntl-rec-type
  5173     move spaces                 to cntl-access
  5174     move ws-rate-ah-benefit-cd  to cntl-access(3:2)
  5175     move +0                     to cntl-seq-no
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  91
* WSMESS03.cbl
  5176
  5177* exec cics read
  5178*       dataset      ('ELCNTL')
  5179*       ridfld       (ELCNTL-KEY)
  5180*       into         (control-file)
  5181*       GTEQ
  5182*       resp         (ws-response)
  5183*    end-exec
  5184     MOVE LENGTH OF
  5185      control-file
  5186       TO DFHEIV11
  5187     MOVE 'ELCNTL' TO DFHEIV1
  5188*    MOVE '&"IL       G          (  N#00005041' TO DFHEIV0
  5189     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5191     MOVE X'204E233030303035303431' TO DFHEIV0(25:11)
  5192     CALL 'kxdfhei1' USING DFHEIV0,
  5193           DFHEIV1,
  5194           control-file,
  5195           DFHEIV11,
  5196           ELCNTL-KEY,
  5197           DFHEIV99,
  5198           DFHEIV99,
  5199           DFHEIV99
  5200     MOVE EIBRESP  TO ws-response
  5201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5202     if (resp-normal)
  5203        and (cntl-rec-type = '5')
  5204        perform varying b1 from +1 by +1 until
  5205           (b1 > 8)
  5206           or (cf-benefit-code(b1) = ws-rate-ah-benefit-cd)
  5207        end-perform
  5208        if b1 < 9
  5209           move cf-special-calc-cd(b1)
  5210                                 to ws-ah-special-calc-cd
  5211           move cf-joint-indicator(b1)
  5212                                 to ws-ah-joint-indicator
  5213           move cf-co-earnings-calc(b1)
  5214                                 to ws-ah-earnings-calc
  5215        end-if
  5216     end-if
  5217     .
  5218 0056-exit.
  5219     exit.
  5220 0058-get-state-controls.
  5221     move ws-comp-id             to cntl-comp-id
  5222     move '3'                    to cntl-rec-type
  5223     move spaces                 to cntl-access
  5224     move ws-rate-state          to cntl-access
  5225     move +0                     to cntl-seq-no
  5226
  5227* exec cics read
  5228*       dataset      ('ELCNTL')
  5229*       ridfld       (ELCNTL-KEY)
  5230*       into         (control-file)
  5231*       GTEQ
  5232*       resp         (ws-response)
  5233*    end-exec
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  92
* WSMESS03.cbl
  5234     MOVE LENGTH OF
  5235      control-file
  5236       TO DFHEIV11
  5237     MOVE 'ELCNTL' TO DFHEIV1
  5238*    MOVE '&"IL       G          (  N#00005072' TO DFHEIV0
  5239     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5240     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5241     MOVE X'204E233030303035303732' TO DFHEIV0(25:11)
  5242     CALL 'kxdfhei1' USING DFHEIV0,
  5243           DFHEIV1,
  5244           control-file,
  5245           DFHEIV11,
  5246           ELCNTL-KEY,
  5247           DFHEIV99,
  5248           DFHEIV99,
  5249           DFHEIV99
  5250     MOVE EIBRESP  TO ws-response
  5251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5252     if (resp-normal)
  5253        and (cntl-rec-type = '3')
  5254        move cf-st-fst-pmt-days-chg
  5255                                 to ws-state-chg-ext-days
  5256     end-if
  5257     .
  5258 0058-exit.
  5259     exit.
  5260 0060-check-for-dup.
  5261**==============================================================**
  5262**                                                              **
  5263**    All i'm going to do here is check for a dup using         **
  5264**  the state, account, eff dt and last six of vin and a space  **
  5265**  in the cert suffix. If I do find one then I will have to    **
  5266**  find the last suffix and use the next available one in the  **
  5267**  suffix table.                                               **
  5268**                                                              **
  5269**==============================================================**
  5270     move +1                     to x1
  5271     move ' '                    to ws-browse-sw
  5272     move ws-comp-cd             to ws-cm-key
  5273     move '9'                    to ws-cm-carrier
  5274     move '000000'               to ws-cm-group
  5275     move ws-rate-state          to ws-cm-state
  5276     move ws-rate-acct-no        to ws-cm-account
  5277     move ws-bin-eff-dt          to ws-cm-eff-dt
  5278     string
  5279        '0000'
  5280        ws-rate-vin (12:6)
  5281        ' ' delimited by size into ws-cm-cert-no
  5282     end-string
  5283     move ws-cm-key              to ws-cm-compare-key
  5284     move ws-cm-cert-ten         to ws-contract-no
  5285     move low-values             to ws-last-suffix
  5286
  5287* exec cics startbr
  5288*       dataset      ('ELCERT')
  5289*       ridfld       (ws-cm-key)
  5290*       gteq
  5291*       resp         (ws-response)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  93
* WSMESS03.cbl
  5292*    end-exec
  5293     MOVE 'ELCERT' TO DFHEIV1
  5294     MOVE 0
  5295       TO DFHEIV11
  5296*    MOVE '&,         G          &  N#00005113' TO DFHEIV0
  5297     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5298     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5299     MOVE X'204E233030303035313133' TO DFHEIV0(25:11)
  5300     CALL 'kxdfhei1' USING DFHEIV0,
  5301           DFHEIV1,
  5302           ws-cm-key,
  5303           DFHEIV99,
  5304           DFHEIV11,
  5305           DFHEIV99
  5306     MOVE EIBRESP  TO ws-response
  5307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5308     evaluate true
  5309        when resp-normal
  5310           set browse-started to true
  5311        when resp-notfnd or resp-endfile
  5312           set i-say-stop to true
  5313        when other
  5314           move ws-response to ws-disp-resp
  5315           string
  5316              '9999' ';'
  5317              'Bad elcert startbr ' ';'
  5318              ws-disp-resp delimited by size
  5319                                 into ws-return-string
  5320           end-string
  5321           display ' something went wrong with start br '
  5322              ws-response
  5323           go to 0300-RETURN-CICS
  5324     end-evaluate
  5325     perform until i-say-stop
  5326
  5327* exec cics readnext
  5328*          dataset      ('ELCERT')
  5329*          ridfld       (ws-cm-key)
  5330*          into         (certificate-master)
  5331*          resp         (ws-response)
  5332*       end-exec
  5333     MOVE LENGTH OF
  5334      certificate-master
  5335       TO DFHEIV12
  5336     MOVE 'ELCERT' TO DFHEIV1
  5337     MOVE 0
  5338       TO DFHEIV11
  5339*    MOVE '&.IL                  )  N#00005137' TO DFHEIV0
  5340     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5341     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5342     MOVE X'204E233030303035313337' TO DFHEIV0(25:11)
  5343     CALL 'kxdfhei1' USING DFHEIV0,
  5344           DFHEIV1,
  5345           certificate-master,
  5346           DFHEIV12,
  5347           ws-cm-key,
  5348           DFHEIV99,
  5349           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  94
* WSMESS03.cbl
  5350           DFHEIV99,
  5351           DFHEIV99
  5352     MOVE EIBRESP  TO ws-response
  5353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5354        if resp-normal
  5355           if ws-cm-key (1:32) = ws-cm-compare-key (1:32)
  5356              move ws-cm-cert-suffix
  5357                                 to ws-last-suffix
  5358           else
  5359              set i-say-stop to true
  5360           end-if
  5361        else
  5362           set i-say-stop to true
  5363        end-if
  5364     end-perform
  5365     if browse-started
  5366
  5367* exec cics endbr
  5368*          dataset   ('ELCERT')
  5369*       END-EXEC
  5370     MOVE 'ELCERT' TO DFHEIV1
  5371     MOVE 0
  5372       TO DFHEIV11
  5373*    MOVE '&2                    $   #00005155' TO DFHEIV0
  5374     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5375     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5376     MOVE X'2020233030303035313535' TO DFHEIV0(25:11)
  5377     CALL 'kxdfhei1' USING DFHEIV0,
  5378           DFHEIV1,
  5379           DFHEIV11,
  5380           DFHEIV99
  5381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5382     end-if
  5383     if ws-last-suffix not = low-values
  5384        perform varying x1 from +1 by +1 until
  5385           (x1 > +26)
  5386           or (ws-last-suffix = ws-suffix-value (x1))
  5387        end-perform
  5388        if x1 < +27
  5389           move ws-suffix-value (x1 + 1)
  5390                                 to ws-contract-suffix
  5391        else
  5392           display ' more than 26 suffix codes ' ws-last-suffix
  5393           move 19               to ws-error-sub
  5394           move spaces           to ws-error-sup
  5395           perform 0180-error-handle
  5396                                 thru 0180-exit
  5397           go to 0300-return-cics
  5398        end-if
  5399     end-if
  5400     .
  5401 0060-exit.
  5402     exit.
  5403 0070-open-cursor.
  5404*    display ' declare cursor ' ws-begin-dt ' ' ws-end-dt
  5405***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  5406***                                                            ***
  5407***  The dates on the sql table have values in the time        ***
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  95
* WSMESS03.cbl
  5408***  so I convert it to a string and just use mm/dd/yyyy       ***
  5409***  to perform the comparison.                                ***
  5410***                                                            ***
  5411***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  5412     if not connected-to-db
  5413        perform 6000-connect-to-db thru 6000-exit
  5414     end-if
  5415     move ws-rate-state          to ws-dealer-state
  5416     move ws-rate-acct-no        to ws-dealer-id
  5417     move ws-rate-eff-date       to ws-contract-eff-dt
  5418     move zeros                  to ws-ks-contract-no
  5419     move ws-rate-vin (12:6)     to ws-ks-contract-no (5:6)
  5420     EXEC SQL
  5421        DECLARE
  5422           contracts cursor for
  5423        SELECT
  5424           DlrState,
  5425           DlrId,
  5426           EffDt,
  5427           ContractNo,
  5428           ContractSuffix
  5429        FROM
  5430           PendingContracts
  5431        WHERE
  5432           DlrState     = :ws-dealer-state
  5433           and DlrId    = :ws-dealer-id
  5434           and EffDt    = :ws-contract-eff-dt
  5435           and ContractNo  = :ws-ks-contract-no
  5436        ORDER BY
  5437           dlrstate,
  5438           dlrid,
  5439           effdt,
  5440           contractno,
  5441           contractsuffix
  5442     end-exec
  5443     if sqlcode not = 0
  5444        display "Error: cannot declare cursor "
  5445        display ' sql retrun code ' sqlcode
  5446        display ' sql err mess    ' sqlerrmc
  5447        go to 0070-exit
  5448     end-if
  5449     EXEC SQL
  5450        open contracts
  5451     END-EXEC
  5452     if sqlcode not = 0
  5453        display "Error: cannot open cursor "
  5454        display ' sql retrun code ' sqlcode
  5455        display ' sql err mess    ' sqlerrmc
  5456        go to 0070-exit
  5457     end-if
  5458     .
  5459 0070-exit.
  5460     exit.
  5461 0080-process-input.
  5462     perform until sqlcode not = 0
  5463        EXEC SQL
  5464           fetch contracts into
  5465              :sql-dlr-state,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  96
* WSMESS03.cbl
  5466              :sql-dlr-id,
  5467              :sql-eff-dt,
  5468              :sql-contr-no,
  5469              :sql-contr-suffix
  5470        END-EXEC
  5471        if sqlcode = 0
  5472           move sql-contr-suffix to ws-tbl-last-suffix
  5473        else
  5474           if sqlcode not = 0 and 100
  5475              display "Error: cannot fetch row "
  5476              display ' sql return code ' sqlcode
  5477              display ' sql err mess    ' sqlerrmc
  5478           end-if
  5479        end-if
  5480     end-perform
  5481     if ws-tbl-last-suffix not = low-values
  5482        and (ws-tbl-last-suffix > ws-last-suffix)
  5483        perform varying x1 from +1 by +1 until
  5484           (x1 > +26)
  5485           or (ws-tbl-last-suffix = ws-suffix-value (x1))
  5486        end-perform
  5487        if x1 < +27
  5488           move ws-suffix-value (x1 + 1)
  5489                                 to ws-contract-suffix
  5490        else
  5491           display ' more than 26 suffix codes ' ws-last-suffix
  5492           move 19               to ws-error-sub
  5493           move spaces           to ws-error-sup
  5494           perform 0180-error-handle
  5495                                 thru 0180-exit
  5496           go to 0300-return-cics
  5497        end-if
  5498     end-if
  5499     EXEC SQL
  5500         close contracts
  5501     END-EXEC
  5502     if sqlcode not = 0
  5503        display "Error: cannot close cursor "
  5504        display ' sql retrun code ' sqlcode
  5505        display ' sql err mess    ' sqlerrmc
  5506     end-if
  5507     .
  5508 0080-exit.
  5509     exit.
  5510 0090-get-limits.
  5511*** Per Kim, add no disab only edit and error to WS
  5512     if ((ws-rate-lf-benefit-cd = '00' or '  ')
  5513                       or
  5514         (no-life-coverage))
  5515        and (ws-rate-ah-benefit-cd <> '00' and '  ')
  5516        if am-ah-only-indicator = 'N'
  5517           move 33               to ws-error-sub
  5518           move ' '              to ws-error-sup
  5519           perform 0180-error-handle
  5520                                 thru 0180-exit
  5521           go to 0300-RETURN-CICS
  5522        end-if
  5523     end-if
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  97
* WSMESS03.cbl
  5524     move zeros                  to ws-lf-limit-lo-age
  5525                                    ws-lf-limit-hi-age
  5526                                    ws-lf-limit-att-age
  5527                                    ws-lf-limit-max-term
  5528                                    ws-lf-limit-max-benefit
  5529                                    ws-lf-limit-partial-cov
  5530                                    ws-lf-limit-check-elig
  5531                                    ws-lf-limit-elig-max-term
  5532                                    ws-di-limit-lo-age
  5533                                    ws-di-limit-hi-age
  5534                                    ws-di-limit-att-age
  5535                                    ws-di-limit-max-term
  5536                                    ws-di-limit-max-jnt-term
  5537                                    ws-di-limit-max-mo-ben
  5538                                    ws-di-limit-max-tot-ben
  5539                                    ws-di-limit-partial-cov
  5540                                    ws-di-limit-check-elig
  5541                                    ws-di-limit-elig-max-term
  5542     if ws-rate-in-lf-ben-code = spaces
  5543        move zeros to ws-rate-lf-term
  5544     end-if
  5545     if (ws-rate-lf-term = zeros)
  5546        and (ws-rate-ah-term <> zeros)
  5547        move 'N '                to ws-rate-in-lf-ben-code
  5548     end-if
  5549     perform 0092-get-lf-limits  thru 0092-exit
  5550     perform 0097-get-di-limits  thru 0097-exit
  5551     .
  5552 0090-exit.
  5553     exit.
  5554 0092-get-lf-limits.
  5555     if not connected-to-db
  5556        perform 6000-connect-to-db thru 6000-exit
  5557     end-if
  5558     evaluate true
  5559        when raw-lf-ben-code (1:1) = 'L'
  5560           move 'LL'             to ws-limit-cov-type
  5561        when raw-ah-ben-code (1:1) = ' '
  5562           move 'LO'             to ws-limit-cov-type
  5563        when raw-lf-ben-code (1:1) = 'N' or 'G' or 'T'
  5564           move 'RL'             to ws-limit-cov-type
  5565        when other   *> Assuming no life coverage
  5566           go to 0092-exit
  5567     end-evaluate
  5568     move zeros                  to ws-limit-lo-age
  5569                                    ws-limit-hi-age
  5570                                    ws-limit-att-age
  5571                                    ws-limit-max-term
  5572                                    ws-limit-max-jnt-term
  5573                                    ws-limit-max-mo-ben
  5574                                    ws-limit-max-tot-ben
  5575                                    ws-limit-partial-cov
  5576                                    ws-limit-check-elig
  5577                                    ws-limit-elig-max-term
  5578     move ws-rate-age            to ws-limit-issue-age
  5579     .
  5580 0092-get-life.
  5581     move 30 to ws-limit-issue-age
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  98
* WSMESS03.cbl
  5582     EXEC SQL
  5583        SELECT
  5584           AttainedAge
  5585        INTO
  5586           :ws-limit-att-age
  5587        FROM
  5588           FormLimits
  5589        WHERE
  5590           Limit           = :ws-limit-name
  5591           and CovType     = :ws-limit-cov-type
  5592           and LoIssueAge <= :ws-limit-issue-age
  5593           and HiIssueAge >= :ws-limit-issue-age
  5594     end-exec
  5595     if sqlcode not = 0
  5596        display "Error: cannot find limitsa " ws-limit-name
  5597           ' ' ws-limit-cov-type ' ' ws-limit-issue-age
  5598        display ' sql return code ' sqlcode
  5599        display ' sql err mess    ' sqlerrmc
  5600        if (ws-limit-cov-type = 'LO')
  5601           and (raw-ah-ben-code (1:1) = ' ')
  5602           move 'RL'             to ws-limit-cov-type
  5603           go to 0092-get-life
  5604        else
  5605           display "Error: cannot find limits " ws-limit-name
  5606              ' ' ws-limit-cov-type ' ' ws-limit-issue-age
  5607           display ' sql retrun code ' sqlcode
  5608           display ' sql err mess    ' sqlerrmc
  5609           move 22                  to ws-error-sub
  5610           move ws-limit-name       to ws-error-sup
  5611           perform 0180-error-handle
  5612                                    thru 0180-exit
  5613           go to 0300-return-cics
  5614        end-if
  5615     end-if
  5616     move ws-rate-age            to ws-limit-issue-age
  5617     EXEC SQL
  5618        SELECT
  5619           AttainedAge,
  5620           MaxTerm,
  5621           MaxTotBen,
  5622           PartialCoverage,
  5623           CheckEligibility,
  5624           EligibilityMaxTerm
  5625        INTO
  5626           :ws-limit-att-age,
  5627           :ws-limit-max-term,
  5628           :ws-limit-max-tot-ben,
  5629           :ws-limit-partial-cov  :nu-partial-cov,
  5630           :ws-limit-check-elig   :nu-check-elig,
  5631           :ws-limit-elig-max-term
  5632        FROM
  5633           FormLimits
  5634        WHERE
  5635           Limit           = :ws-limit-name
  5636           and CovType     = :ws-limit-cov-type
  5637           and LoIssueAge <= :ws-limit-issue-age
  5638           and HiIssueAge >= :ws-limit-issue-age
  5639     end-exec
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page  99
* WSMESS03.cbl
  5640     if sqlcode not = 0
  5641        display "Error: cannot find limits for age "
  5642           ws-limit-name ' ' ws-limit-cov-type ' '
  5643           ws-limit-issue-age
  5644        display ' sql retrun code ' sqlcode
  5645        display ' sql err mess    ' sqlerrmc
  5646        move 4                   to ws-error-sub
  5647        move ws-limit-name       to ws-error-sup
  5648        perform 0180-error-handle
  5649                                 thru 0180-exit
  5650        go to 0300-return-cics
  5651     end-if
  5652*    display ' good get on limit *'  ws-limit-name '*'
  5653*       ws-limit-att-age '*' ws-limit-cov-type '*'
  5654*         ws-limit-issue-age '*' ws-att-age '*'
  5655*         ws-limit-partial-cov '*' ws-limit-check-elig '*'
  5656*         ws-limit-elig-max-term '*'
  5657     move ws-limit-lo-age        to ws-lf-limit-lo-age
  5658     move ws-limit-hi-age        to ws-lf-limit-hi-age
  5659     move ws-limit-att-age       to ws-lf-limit-att-age
  5660     move ws-limit-max-term      to ws-lf-limit-max-term
  5661     move ws-limit-max-tot-ben   to ws-lf-limit-max-benefit
  5662     move ws-limit-partial-cov   to ws-lf-limit-partial-cov
  5663     move ws-limit-check-elig    to ws-lf-limit-check-elig
  5664     move ws-limit-elig-max-term to ws-lf-limit-elig-max-term
  5665     if ws-lf-limit-check-elig = 0
  5666        go to 0092-check-partial
  5667     end-if
  5668     if ws-rate-loan-term <= ws-lf-limit-elig-max-term
  5669        continue
  5670     else
  5671        move 31                  to ws-error-sub
  5672        move ' '                 to ws-error-sup
  5673        perform 0180-error-handle
  5674                                 thru 0180-exit
  5675        go to 0300-return-cics
  5676     end-if
  5677     if ws-rate-benefit <= ws-lf-limit-max-benefit
  5678        continue
  5679     else
  5680        move 32                  to ws-error-sub
  5681        move '- Lf Benefit '     to ws-error-sup
  5682        perform 0180-error-handle
  5683                                 thru 0180-exit
  5684        go to 0300-return-cics
  5685     end-if
  5686     .
  5687 0092-check-partial.
  5688     if ws-lf-limit-partial-cov = 0
  5689        go to 0092-continue
  5690     end-if
  5691     if ws-rate-benefit > ws-lf-limit-max-benefit
  5692        move ws-lf-limit-max-benefit
  5693                                 to ws-rate-benefit
  5694     end-if
  5695     .
  5696 0092-continue.
  5697     if ws-rate-benefit <= ws-lf-limit-max-benefit
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page 100
* WSMESS03.cbl
  5698        continue
  5699     else
  5700        move 10                  to ws-error-sub
  5701        move '- Lf Benefit '     to ws-error-sup
  5702        perform 0180-error-handle
  5703                                 thru 0180-exit
  5704        go to 0300-return-cics
  5705     end-if
  5706     if ws-rate-lf-term <= ws-lf-limit-max-term
  5707        continue
  5708     else
  5709        move 9                   to ws-error-sub
  5710        move '- Lf Term '        to ws-error-sup
  5711        perform 0180-error-handle
  5712                                 thru 0180-exit
  5713        go to 0300-return-cics
  5714     end-if
  5715     if ws-att-age <= ws-lf-limit-att-age
  5716        continue
  5717     else
  5718        move 5                   to ws-error-sub
  5719        move ws-att-age          to ws-error-sup
  5720        perform 0180-error-handle
  5721                                 thru 0180-exit
  5722        go to 0300-return-cics
  5723     end-if
  5724     .
  5725 0092-exit.
  5726     exit.
  5727 0097-get-di-limits.
  5728     if raw-ah-ben-code (1:1) = 'A'
  5729        move 'DI'                to ws-limit-cov-type
  5730     else   *>  Assuming no AH coverage
  5731        go to 0097-exit
  5732     end-if
  5733     if not connected-to-db
  5734        perform 6000-connect-to-db thru 6000-exit
  5735     end-if
  5736***  True = -1
  5737     move 30 to ws-limit-issue-age
  5738     EXEC SQL
  5739        SELECT distinct top 1
  5740           AttainedAge
  5741        INTO
  5742           :ws-limit-att-age
  5743        FROM
  5744           FormLimits
  5745        WHERE
  5746           Limit           = :ws-limit-name
  5747           and CovType     = :ws-limit-cov-type
  5748           and LoIssueAge <= :ws-limit-issue-age
  5749           and HiIssueAge >= :ws-limit-issue-age
  5750     end-exec
  5751     if sqlcode not = 0
  5752        display "Error: cannot find limits " ws-limit-name
  5753        display ' sql retrun code ' sqlcode
  5754        display ' sql err mess    ' sqlerrmc
  5755        move 22                  to ws-error-sub
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page 101
* WSMESS03.cbl
  5756        move ws-limit-name       to ws-error-sup
  5757        perform 0180-error-handle
  5758                                 thru 0180-exit
  5759        go to 0300-return-cics
  5760     end-if
  5761     move ws-rate-age            to ws-limit-issue-age
  5762     EXEC SQL
  5763        SELECT distinct top 1
  5764           AttainedAge,
  5765           MaxTerm,
  5766           MaxJntTerm,
  5767           MaxMoBen,
  5768           MaxTotBen,
  5769           PartialCoverage,
  5770           CheckEligibility,
  5771           EligibilityMaxTerm
  5772        INTO
  5773           :ws-limit-att-age,
  5774           :ws-limit-max-term,
  5775           :ws-limit-max-jnt-term,
  5776           :ws-limit-max-mo-ben,
  5777           :ws-limit-max-tot-ben,
  5778           :ws-limit-partial-cov   :nu-partial-cov,
  5779           :ws-limit-check-elig    :nu-check-elig,
  5780           :ws-limit-elig-max-term
  5781        FROM
  5782           FormLimits
  5783        WHERE
  5784           Limit           = :ws-limit-name
  5785           and CovType     = :ws-limit-cov-type
  5786           and LoIssueAge <= :ws-limit-issue-age
  5787           and HiIssueAge >= :ws-limit-issue-age
  5788     end-exec
  5789     if sqlcode not = 0
  5790        display "Error: cannot find limits " ws-limit-name
  5791        display ' sql retrun code ' sqlcode
  5792        display ' sql err mess    ' sqlerrmc
  5793        move 4                   to ws-error-sub
  5794        move ws-limit-name       to ws-error-sup
  5795        perform 0180-error-handle
  5796                                 thru 0180-exit
  5797        go to 0300-return-cics
  5798     end-if
  5799*    display ' good get on ah limit *'  ws-limit-name '*'
  5800*       ws-limit-att-age '*' ws-limit-cov-type '*'
  5801*         ws-limit-issue-age '*' ws-att-age '*'
  5802*         ws-limit-partial-cov '*' ws-limit-check-elig '*'
  5803*         ws-limit-elig-max-term '*'
  5804     move ws-limit-lo-age        to ws-di-limit-lo-age
  5805     move ws-limit-hi-age        to ws-di-limit-hi-age
  5806     move ws-limit-att-age       to ws-di-limit-att-age
  5807     move ws-limit-max-term      to ws-di-limit-max-term
  5808     move ws-limit-max-jnt-term  to ws-di-limit-max-jnt-term
  5809     move ws-limit-max-mo-ben    to ws-di-limit-max-mo-ben
  5810     move ws-limit-max-tot-ben   to ws-di-limit-max-tot-ben
  5811     move ws-limit-partial-cov   to ws-di-limit-partial-cov
  5812     move ws-limit-check-elig    to ws-di-limit-check-elig
  5813     move ws-limit-elig-max-term to ws-di-limit-elig-max-term
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page 102
* WSMESS03.cbl
  5814     if ws-di-limit-check-elig = 0
  5815        go to 0097-check-partial
  5816     end-if
  5817     if ws-rate-loan-term <= ws-di-limit-elig-max-term
  5818        continue
  5819     else
  5820        move 31                  to ws-error-sub
  5821        move ' '                 to ws-error-sup
  5822        perform 0180-error-handle
  5823                                 thru 0180-exit
  5824        go to 0300-return-cics
  5825     end-if
  5826     if (ws-rate-ah-term * ws-rate-payment) <=
  5827                   ws-di-limit-max-tot-ben
  5828        continue
  5829     else
  5830        move 32                  to ws-error-sub
  5831        move '- Di ToT Ben '     to ws-error-sup
  5832        perform 0180-error-handle
  5833                                 thru 0180-exit
  5834        go to 0300-return-cics
  5835     end-if
  5836     if ws-rate-state = 'FL'
  5837        if ((ws-rate-loan-term * ws-rate-payment) <=
  5838                   ws-di-limit-max-tot-ben)
  5839           continue
  5840        else
  5841           move 32               to ws-error-sub
  5842           move '- Di ToT Ben '  to ws-error-sup
  5843           perform 0180-error-handle
  5844                                 thru 0180-exit
  5845           go to 0300-return-cics
  5846        end-if
  5847     end-if
  5848     .
  5849 0097-check-partial.
  5850     if ws-di-limit-partial-cov = 0
  5851        go to 0097-continue
  5852     end-if
  5853     if ws-rate-payment > ws-di-limit-max-mo-ben
  5854        move ws-di-limit-max-mo-ben
  5855                                 to ws-rate-payment
  5856     end-if
  5857     if (ws-rate-ah-term * ws-rate-payment) >
  5858                   ws-di-limit-max-tot-ben
  5859        compute ws-rate-payment =
  5860           ws-di-limit-max-tot-ben / ws-rate-ah-term
  5861     end-if
  5862     .
  5863 0097-continue.
  5864     if ws-rate-payment <= ws-di-limit-max-mo-ben
  5865        continue
  5866     else
  5867        move 11                  to ws-error-sub
  5868        move '- Ah Benefit '     to ws-error-sup
  5869        perform 0180-error-handle
  5870                                 thru 0180-exit
  5871        go to 0300-return-cics
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page 103
* WSMESS03.cbl
  5872     end-if
  5873     if ws-rate-sin-jnt-ah = 'J'
  5874        if ws-rate-ah-term <= ws-di-limit-max-jnt-term
  5875           continue
  5876        else
  5877           move 8                   to ws-error-sub
  5878           move '- Ah TermJNT'      to ws-error-sup
  5879           perform 0180-error-handle
  5880                                    thru 0180-exit
  5881           go to 0300-return-cics
  5882        end-if
  5883     else
  5884        if ws-rate-ah-term <= ws-di-limit-max-term
  5885           continue
  5886        else
  5887           move 9                   to ws-error-sub
  5888           move '- Ah Term '        to ws-error-sup
  5889           perform 0180-error-handle
  5890                                    thru 0180-exit
  5891           go to 0300-return-cics
  5892        end-if
  5893     end-if
  5894     if (ws-rate-ah-term * ws-rate-payment) <=
  5895                   ws-di-limit-max-tot-ben
  5896        continue
  5897     else
  5898        move 13                  to ws-error-sub
  5899        move spaces              to ws-error-sup
  5900        perform 0180-error-handle
  5901                                 thru 0180-exit
  5902        go to 0300-return-cics
  5903     end-if
  5904     if ws-att-age <= ws-di-limit-att-age
  5905        continue
  5906     else
  5907        move 5                   to ws-error-sub
  5908        move ws-att-age          to ws-error-sup
  5909        perform 0180-error-handle
  5910                                 thru 0180-exit
  5911        go to 0300-return-cics
  5912     end-if
  5913     .
  5914 0097-exit.
  5915     exit.
  5916 0110-unstring.
  5917***____________________________________________________________***
  5918**|                                                            |**
  5919**|    Unstring the raw data into data elements                |**
  5920**|                                                            |**
  5921***____________________________________________________________***
  5922        unstring dfhcommarea
  5923           delimited by '|' into
  5924              raw-message-num
  5925              raw-state
  5926              raw-acct-no
  5927              raw-vin
  5928              raw-lf-ben-code
  5929              raw-ah-ben-code
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page 104
* WSMESS03.cbl
  5930              raw-earn-meth
  5931              raw-pri-birth-date
  5932              raw-cob-birth-date
  5933              raw-loan-amt
  5934              raw-eff-date
  5935              raw-1st-pmt-dt
  5936              raw-pmts-per-year
  5937              raw-lf-premium
  5938              raw-ah-premium
  5939              raw-loan-term
  5940              raw-lf-term
  5941              raw-ah-term
  5942              raw-apr
  5943              raw-lf-sin-jnt-ind
  5944              raw-ah-sin-jnt-ind
  5945              raw-lf-dismemberment
  5946              raw-retro-elim
  5947              raw-waiting-days
  5948              raw-crit-per
  5949              raw-total-payments
  5950              raw-period-payment
  5951        end-unstring
  5952     .
  5953 0110-exit.
  5954     exit.
  5955 0120-format-message.
  5956***____________________________________________________________***
  5957**|                                                            |**
  5958**|    Format each data element to be consistant with          |**
  5959**|  COBOL rate copybook model                                 |**
  5960**|                                                            |**
  5961***____________________________________________________________***
  5962     inspect
  5963        raw-acct-no replacing leading spaces by zeros
  5964     inspect
  5965        raw-pmts-per-year replacing leading spaces by zeros
  5966     inspect
  5967        raw-loan-term replacing leading spaces by zeros
  5968     inspect
  5969        raw-lf-term replacing leading spaces by zeros
  5970     inspect
  5971        raw-ah-term replacing leading spaces by zeros
  5972     inspect
  5973        raw-waiting-days replacing leading spaces by zeros
  5974     inspect
  5975        raw-crit-per replacing leading spaces by zeros
  5976     inspect
  5977        raw-loan-amt replacing all spaces by zeros
  5978     inspect
  5979        raw-lf-premium replacing all spaces by zeros
  5980     inspect
  5981        raw-ah-premium replacing all spaces by zeros
  5982     inspect
  5983        raw-lf-term replacing leading spaces by zeros
  5984     inspect
  5985        raw-ah-term replacing leading spaces by zeros
  5986     inspect
  5987        raw-apr replacing all spaces by zeros
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page 105
* WSMESS03.cbl
  5988     inspect
  5989        raw-total-payments replacing all spaces by zeros
  5990     inspect
  5991        raw-period-payment replacing all spaces by zeros
  5992     move raw-loan-amt           to ws-work-in
  5993     perform 0130-format-amt     thru 0130-exit
  5994     move ws-work-out-v2         to ws-rate-benefit
  5995*    display ' ben  in *' ws-work-in '*'
  5996*    display ' ben  out *' ws-work-out '*'
  5997     move raw-total-payments     to ws-work-in
  5998     perform 0130-format-amt     thru 0130-exit
  5999     move ws-work-out-v2         to ws-rate-tot-pmts
  6000*    display ' tot pmts  in *' ws-work-in '*'
  6001*    display ' tot pmts  out *' ws-work-out '*'
  6002     move raw-lf-premium         to ws-work-in
  6003     perform 0130-format-amt     thru 0130-exit
  6004     move ws-work-out-v2         to ws-rate-lf-prem
  6005*    display ' prem in *' ws-work-in '*'
  6006*    display ' prem out *' ws-work-out '*'
  6007     move raw-ah-premium         to ws-work-in
  6008     perform 0130-format-amt     thru 0130-exit
  6009     move ws-work-out-v2         to ws-rate-ah-prem
  6010*    display ' prem in *' ws-work-in '*'
  6011*    display ' prem out *' ws-work-out '*'
  6012     move raw-period-payment     to ws-work-in
  6013     perform 0130-format-amt     thru 0130-exit
  6014     move ws-work-out-v2         to ws-rate-payment
  6015*    display ' pmt  in *' ws-work-in '*'
  6016*    display ' pmt  out *' ws-work-out '*'
  6017     move raw-loan-term          to ws-work-in
  6018     perform 0140-format-term    thru 0140-exit
  6019     move ws-work-out-v0         to ws-rate-loan-term
  6020*    display ' rate loan term *' ws-rate-loan-term '*'
  6021*    display ' ln term in *' ws-work-in '*'
  6022*    display ' ln term out *' ws-work-out '*'
  6023     move raw-lf-term            to ws-work-in
  6024     perform 0140-format-term    thru 0140-exit
  6025     move ws-work-out-v0         to ws-rate-lf-term
  6026*    display ' rate ins  term *' ws-rate-lf-term '*'
  6027*    display ' ins term in *' ws-work-in '*'
  6028*    display ' ins term out *' ws-work-out '*'
  6029     move raw-ah-term            to ws-work-in
  6030     perform 0140-format-term    thru 0140-exit
  6031     move ws-work-out-v0         to ws-rate-ah-term
  6032*    display ' rate ins  term *' ws-rate-ah-term '*'
  6033*    display ' ins term in *' ws-work-in '*'
  6034*    display ' ins term out *' ws-work-out '*'
  6035     move raw-waiting-days       to ws-work-in
  6036     perform 0140-format-term    thru 0140-exit
  6037     move ws-work-out-v0         to ws-rate-waiting-days
  6038*    display ' wait day in *' ws-work-in '*'
  6039*    display ' wait day out *' ws-work-out '*'
  6040     move raw-crit-per           to ws-work-in
  6041     perform 0140-format-term    thru 0140-exit
  6042     move ws-work-out-v0         to ws-rate-crit-per
  6043*    display ' crit per in *' ws-work-in '*'
  6044*    display ' crit per out *' ws-work-out '*'
  6045     move raw-pmts-per-year      to ws-work-in
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page 106
* WSMESS03.cbl
  6046     perform 0140-format-term    thru 0140-exit
  6047     move ws-work-out-v0         to ws-rate-pmts-per-year
  6048*    display ' pmts per yr *' ws-work-in '*'
  6049*    display ' pmts per yr  *' ws-work-out '*'
  6050     move raw-apr                to ws-work-in
  6051     perform 0150-format-apr     thru 0150-exit
  6052     move ws-work-out-v5         to ws-rate-apr
  6053*    display ' ins apr  in *' ws-work-in '*'
  6054*    display ' ins apr  out *' ws-work-out '*'
  6055     move raw-state              to ws-rate-state
  6056     move raw-acct-no            to ws-rate-acct-no
  6057     move raw-vin                to ws-rate-vin
  6058     move raw-lf-ben-code        to ws-rate-in-lf-ben-code
  6059     move raw-ah-ben-code        to ws-rate-in-ah-ben-code
  6060     move raw-earn-meth          to ws-rate-loan-type
  6061     evaluate ws-rate-in-lf-ben-code(1:1)
  6062        when 'N'
  6063           move '5'              to ws-rate-earn-meth
  6064        when 'T'
  6065           move '5'              to ws-rate-earn-meth
  6066        when other
  6067           move '1'              to ws-rate-earn-meth
  6068     end-evaluate
  6069     move raw-pri-birth-date     to ws-rate-pri-birth-date
  6070     move raw-cob-birth-date     to ws-rate-cob-birth-date
  6071     move raw-eff-date           to ws-rate-eff-date
  6072     move raw-1st-pmt-dt         to ws-rate-1st-pmt-dt
  6073     move raw-lf-sin-jnt-ind     to ws-rate-sin-jnt-lf
  6074     move raw-ah-sin-jnt-ind     to ws-rate-sin-jnt-ah
  6075     move raw-lf-dismemberment   to ws-rate-dismemberment
  6076     move raw-retro-elim         to ws-rate-retro-elim
  6077     .
  6078 0120-exit.
  6079     exit.
  6080 0130-format-amt.
  6081     move zeros                  to ws-work-out
  6082     perform varying s2 from +10 by -1 until
  6083        (s2 < +1)
  6084        or (ws-work-in (s2:1) = '.')
  6085     end-perform
  6086     if s2 < +9
  6087        move ws-work-in (s2 + 1:2)
  6088                              to ws-work-out (9:2)
  6089        move +8               to s3
  6090        subtract +1 from s2
  6091        perform varying s2 from s2 by -1 until
  6092           (s2 < +1)
  6093           or (s3 = 0)
  6094           move ws-work-in (s2:1) to ws-work-out (s3:1)
  6095           subtract +1 from s3
  6096        end-perform
  6097     end-if
  6098     .
  6099 0130-exit.
  6100     exit.
  6101 0140-format-term.
  6102     move zeros                  to ws-work-out
  6103     perform varying s2 from +10 by -1 until
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page 107
* WSMESS03.cbl
  6104        (s2 < +1)
  6105        or (ws-work-in (s2:1) numeric)
  6106     end-perform
  6107     if s2 > +0
  6108        move ws-work-in (s2:1)
  6109                              to ws-work-out (10:1)
  6110        move +9               to s3
  6111        subtract +1 from s2
  6112        perform varying s2 from s2 by -1 until
  6113           (s2 < +1)
  6114           or (s3 = 7)
  6115           move ws-work-in (s2:1) to ws-work-out (s3:1)
  6116           subtract +1 from s3
  6117        end-perform
  6118     end-if
  6119     .
  6120 0140-exit.
  6121     exit.
  6122 0150-format-apr.
  6123     move zeros                  to ws-work-out
  6124     perform varying s2 from +10 by -1 until
  6125        (s2 < +1)
  6126        or (ws-work-in (s2:1) = '.')
  6127     end-perform
  6128     if s2 < +5
  6129        move ws-work-in (s2 + 1:5)
  6130                              to ws-work-out (6:5)
  6131        move +5               to s3
  6132        subtract +1 from s2
  6133        perform varying s2 from s2 by -1 until
  6134           (s2 < +1)
  6135           or (s3 = 0)
  6136           move ws-work-in (s2:1) to ws-work-out (s3:1)
  6137           subtract +1 from s3
  6138        end-perform
  6139     end-if
  6140     .
  6141 0150-exit.
  6142     exit.
  6143 0180-error-handle.
  6144     move ws-table-error-no (ws-error-sub)
  6145                                 to ws-return-error-no
  6146     move spaces                 to ws-return-error-mess
  6147     string
  6148        ws-table-error-mess (ws-error-sub)
  6149        ws-error-sup
  6150        delimited by '  ' into ws-return-error-mess
  6151     end-string
  6152     .
  6153 0180-exit.
  6154     exit.
  6155 0200-calc-stuff.
  6156*    if ws-lf-limit-partial-cov = 0
  6157     move ws-rate-loan-term      to n
  6158*    if ws-rate-loan-type = '2'
  6159*       if (ws-rate-in-lf-ben-code (1:1) = 'G' or 'L')
  6160*          or (ws-rate-in-ah-ben-code (1:1) = 'A')
  6161*          compute n = n - 1
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page 108
* WSMESS03.cbl
  6162*       end-if
  6163*    end-if
  6164     move ws-rate-pmts-per-year  to ppy
  6165     move 30                     to dpp
  6166     compute i = ws-rate-apr / (ppy *100)
  6167     if i = zeros
  6168        move n                   to a-angle-n
  6169        move 1                   to gamma
  6170*       move .0000001            to i
  6171     else
  6172        COMPUTE A-ANGLE-N ROUNDED =
  6173           (1 - ((1 / (1 + I)) ** N)) / I
  6174        COMPUTE GAMMA ROUNDED =
  6175           (1 + ((D * I) / DPP)) / (1 + I)
  6176     end-if
  6177     COMPUTE A-PRM-ANGLE-N ROUNDED = A-ANGLE-N / GAMMA
  6178     compute ws-ins-per-month rounded =
  6179        (ws-rate-lf-prem + ws-rate-ah-prem) / a-prm-angle-n
  6180     compute ws-prem-plus-int rounded =
  6181        (ws-ins-per-month * n)
  6182     compute ws-tot-pmts-wo-ins rounded =
  6183        ws-rate-tot-pmts - ws-prem-plus-int
  6184     if (ws-rate-in-lf-ben-code (1:1) = 'N' or 'T')
  6185        and (ws-rate-loan-type <> '2')
  6186        compute ws-principal rounded =
  6187           ws-rate-amt-financed - (ws-rate-lf-prem +
  6188              ws-rate-ah-prem)
  6189*          ws-rate-benefit - (ws-rate-lf-prem + ws-rate-ah-prem)
  6190     else
  6191        compute ws-principal rounded =
  6192           ws-tot-pmts-wo-ins / n * a-angle-n
  6193     end-if
  6194     compute ws-amt-financed rounded =
  6195        ws-principal + (ws-rate-lf-prem + ws-rate-ah-prem)
  6196*    compute ws-rate-loan-pmt rounded =
  6197*       ws-principal / a-angle-n
  6198     compute ws-rate-loan-pmt rounded =
  6199        ws-amt-financed / a-angle-n
  6200     move ws-amt-financed        to ws-return-tot-financed
  6201     move ws-rate-loan-pmt       to ws-return-loan-pmt
  6202     move ws-principal           to ws-return-principal
  6203**==============================================================**
  6204**                                                              **
  6205**  Validate benefit with amt financed for net pay              **
  6206**                                                              **
  6207**==============================================================**
  6208     if (ws-rate-in-lf-ben-code (1:1) = 'N' or 'T')
  6209        and (ws-rate-loan-type <> '2')
  6210        if ((ws-amt-financed - ws-rate-amt-financed) > 9.99)
  6211                       or
  6212           ((ws-rate-amt-financed - ws-amt-financed) > 9.99)
  6213           move spaces           to ws-return-string
  6214           move 30               to ws-error-sub
  6215           move ' '              to ws-error-sup
  6216           perform 0180-error-handle
  6217                                 thru 0180-exit
  6218           go to 0300-RETURN-CICS
  6219        end-if
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page 109
* WSMESS03.cbl
  6220     end-if
  6221     .
  6222 0200-exit.
  6223     exit.
  6224 0300-RETURN-CICS.
  6225     perform 0400-disconnect     thru 0400-exit
  6226     move ws-return-string       to dfhcommarea
  6227
  6228* exec cics return end-exec
  6229*    MOVE '.(                    ''   #00006004' TO DFHEIV0
  6230     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6231     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6232     MOVE X'2020233030303036303034' TO DFHEIV0(25:11)
  6233     CALL 'kxdfhei1' USING DFHEIV0,
  6234           DFHEIV99,
  6235           DFHEIV99,
  6236           DFHEIV99,
  6237           DFHEIV99,
  6238           DFHEIV99,
  6239           DFHEIV99
  6240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6241
  6242* goback
  6243
  6244     MOVE '9%                    "   ' TO DFHEIV0
  6245     MOVE 'WSMESS03' TO DFHEIV1
  6246     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6247     goback
  6248     .
  6249 0300-exit.
  6250     exit.
  6251 0400-disconnect.
  6252     if connected-to-db
  6253        EXEC SQL
  6254            disconnect all
  6255        END-EXEC
  6256        move ' ' to ws-connect-sw
  6257     end-if
  6258     .
  6259 0400-exit.
  6260     exit.
  6261 6000-CONNECT-TO-DB.
  6262***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  6263***                                                            ***
  6264***                                                            ***
  6265***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  6266     evaluate true
  6267        when ws-kix-myenv = 'cid1p'
  6268           MOVE 'NTCSO2_CrtManage'
  6269                                 TO SVR
  6270           move 'sa'             to usr
  6271           move 'ntcso2'         to pass
  6272        when ws-kix-myenv = 'mdoff'
  6273           MOVE 'NTSQLTST2UAT_CrtManage'
  6274                                 TO SVR
  6275           move 'sa'             to usr
  6276           move 'sql2008r2'      to pass
  6277        when other
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page 110
* WSMESS03.cbl
  6278           MOVE 'NTSQLTST2_CrtManage'
  6279                                 TO SVR
  6280           move 'sa'             to usr
  6281           move 'sql2008r2'      to pass
  6282           display ' connecting to ' svr ' ' usr ' ' pass
  6283     end-evaluate
  6284     string
  6285         usr delimited space
  6286         "." delimited size
  6287         pass delimited space into usr-pass
  6288     end-string
  6289     EXEC SQL
  6290        CONNECT TO :svr USER :usr-pass
  6291     END-EXEC
  6292     if sqlcode not = 0
  6293        display "Error: cannot connect to " svr
  6294        display sqlcode
  6295        display sqlerrmc
  6296     else
  6297        display ' Successful Connect ' sqlcode
  6298        set connected-to-db to true
  6299     end-if
  6300     .
  6301 6000-EXIT.
  6302     EXIT.
  6303 7000-GET-RATE.
  6304
  6305* EXEC CICS LINK
  6306*       PROGRAM ('ELRATE')
  6307*       COMMAREA (CALCULATION-PASS-AREA)
  6308*       LENGTH   (CP-COMM-LENGTH)
  6309*    END-EXEC
  6310     MOVE 'ELRATE' TO DFHEIV1
  6311*    MOVE '."C                   (   #00006062' TO DFHEIV0
  6312     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6313     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6314     MOVE X'2020233030303036303632' TO DFHEIV0(25:11)
  6315     CALL 'kxdfhei1' USING DFHEIV0,
  6316           DFHEIV1,
  6317           CALCULATION-PASS-AREA,
  6318           CP-COMM-LENGTH,
  6319           DFHEIV99,
  6320           DFHEIV99,
  6321           DFHEIV99,
  6322           DFHEIV99
  6323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6324     .
  6325 7000-EXIT.
  6326     EXIT.
  6327 9700-DATE-LINK.
  6328
  6329* EXEC CICS LINK
  6330*         PROGRAM  ('ELDATCV')
  6331*         COMMAREA (DATE-CONVERSION-DATA)
  6332*         LENGTH   (DC-COMM-LENGTH)
  6333*    END-EXEC.
  6334     MOVE 'ELDATCV' TO DFHEIV1
  6335*    MOVE '."C                   (   #00006071' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Feb-19 08:05 Page 111
* WSMESS03.cbl
  6336     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6337     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6338     MOVE X'2020233030303036303731' TO DFHEIV0(25:11)
  6339     CALL 'kxdfhei1' USING DFHEIV0,
  6340           DFHEIV1,
  6341           DATE-CONVERSION-DATA,
  6342           DC-COMM-LENGTH,
  6343           DFHEIV99,
  6344           DFHEIV99,
  6345           DFHEIV99,
  6346           DFHEIV99
  6347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6348
  6349 9700-EXIT.
  6350      EXIT.
  6351
  6352 9999-DFHBACK SECTION.
  6353     MOVE '9%                    "   ' TO DFHEIV0
  6354     MOVE 'WSMESS03' TO DFHEIV1
  6355     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6356     GOBACK.
  6357 9999-DFHEXIT.
  6358     IF DFHEIGDJ EQUAL 0001
  6359         NEXT SENTENCE.
  6360     MOVE '9%                    "   ' TO DFHEIV0
  6361     MOVE 'WSMESS03' TO DFHEIV1
  6362     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6363     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      148996     Code:       24929
