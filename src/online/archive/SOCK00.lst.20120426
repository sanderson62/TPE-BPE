* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page   1
* SOCK00.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"SOCK00.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK00.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7******************************************************************
     8*                   C H A N G E   L O G
     9*
    10* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    11*-----------------------------------------------------------------
    12*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    13* EFFECTIVE    NUMBER
    14*-----------------------------------------------------------------
    15* 091609  CR2009082400002  PEMA  ADD USER SELECT 3
    16*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page   2
* SOCK00.cbl
    17 identification division.
    18 program-id. SOCK00.
    19*         This program is the first invoked by the SOCK
    20*         transaction. This transaction must be submited
    21*         by a message transmited over a stream socket.
    22*         The first message format is:
    23*         aaaa,bbbbb              ccc
    24*         where "aaaa" is the tran id SOCK (1 to 4 characters)
    25*         and "bbbbb is either "RATE " or "STATE" and ccc is eithe
    26*         DCC or CID or any future company id
    27*         Information on the originating message and
    28*         remote socket is provided in the DFHCOMMAREA.
    29*         As its first action this program must send a
    30*         message to the requesting socket. This lets the
    31*         remote program know its request has been
    32*         accepted and the transaction started.
    33*         The program will make four transmissions to
    34*         the initating program in response to received
    35*         messages and then close the socket.
    36*         This program is provided to show method and
    37*         has minimal checking and error messages.
    38*         The Cobol compiler, unless instructed otherwise,
    39*         will hold its working storage integer data items in
    40*         machine idependent form. This matches the network
    41*         ordering of information. Care should be exercised
    42*         to ensure that this data ordering is correct when
    43*         calling system library functions or passing data
    44*         structure containing such data to functions.
    45 environment division.
    46 data division.
    47 working-storage section.
    48 01  DFH-START PIC X(04).
    49*
    50* program buffers
    51*
    52 77 ws-send-msg-size           pic s9(8) comp value 4096.
    53 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    54 77 ws-recv-buf                pic x(4096).
    55 77 ws-send-buf                pic x(4096) VALUE SPACES.
    56 77 ws-recv-total              pic s9(8) comp value 0.
    57 77 ws-recv-left               pic s9(8) comp value 0.
    58 77 ws-seq-num                 pic s9(8) comp value 0.
    59 77 ws-flags                   pic s9(8) comp value 0.
    60 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    61 77 WS-COMP-ID                   PIC XXX VALUE 'CID'.
    62 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    63 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    64 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    65 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    66 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    67 77 S1                           PIC S999 COMP-3 VALUE +0.
    68 77 S2                           PIC S999 COMP-3 VALUE +0.
    69 77 WS-BUILD-SW                  PIC X.
    70    88  TIME-TO-BUILD               VALUE 'Y'.
    71 77 WS-SAVE-ERACCT               PIC X(2000).
    72 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    73 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    74    88  GET-RATES                    VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page   3
* SOCK00.cbl
    75    88  GET-ACT-ACCTS                VALUE 'A'.
    76 77 ws-bin-eff-dt                pic xx  value low-values.
    77 77 ws-bin-1st-pay-dt            pic xx  value low-values.
    78 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    79 77 ws-disp-rate                 pic z9.99999.
    80 77  WS-ERACCT-SW                PIC X VALUE ' '.
    81     88  END-OF-ERACCT                 VALUE 'Y'.
    82 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    83     88  END-OF-ERCTBL                 VALUE 'Y'.
    84 77  WS-STATUS                   PIC X.
    85 01  ws-work-date.
    86     05  ws-work-ccyy            pic x(4).
    87     05  ws-work-mm              pic xx.
    88     05  ws-work-dd              pic xx.
    89 01  ws-work-date-num redefines ws-work-date
    90                                 pic 9(8).
    91 01  WS-AM-CITY-STATE            PIC X(30) VALUE SPACES.
    92 01  ws-work-apr.
    93     05  ws-apr-num              pic 99V999.
    94 01  ws-work-ben.
    95     05  ws-ben-num              pic 9(5).
    96 01  ws-work-term.
    97     05  ws-term-num             pic 999.
    98 01  ws-get-rate-data.
    99     05  rate-state              pic xx.
   100     05  rate-lf-ah              pic x.
   101     05  rate-ben-code           pic xx.
   102     05  rate-earn-meth          pic x.
   103     05  rate-ben-amt            pic x(5).
   104     05  rate-eff-date           pic x(10).
   105     05  rate-term               pic xxx.
   106     05  rate-apr                pic x(5).
   107 01  WS-FIN-RESP                 PIC X(10).
   108 01  WS-GA-DATA.
   109     05  WS-GA-NUM               PIC X(10).
   110     05  WS-GA-PRIMARY-CONTACT   PIC X(30).
   111     05  WS-GA-NAME              PIC X(30).
   112     05  WS-GA-MAIL-NAME         PIC X(30).
   113     05  WS-GA-ADDR1             PIC X(30).
   114     05  WS-GA-ADDR2             PIC X(30).
   115     05  WS-GA-ADDR3             PIC X(30).
   116     05  WS-GA-ZIP               PIC X(9).
   117     05  WS-GA-PHONE             PIC X(10).
   118 01  WS-AM-KEY.
   119     05  WS-AM-COMPANY-CD        PIC X.
   120     05  WS-AM-CARRIER           PIC X.
   121     05  WS-AM-GROUP             PIC X(6).
   122     05  WS-AM-STATE             PIC XX.
   123     05  WS-AM-ACCOUNT           PIC X(10).
   124     05  WS-AM-EXP-DT            PIC XX.
   125     05  FILLER                  PIC X(4).
   126 01  WS-NT-KEY.
   127     05  WS-NT-COMPANY-CD        PIC X.
   128     05  WS-NT-CARRIER           PIC X.
   129     05  WS-NT-GROUP             PIC X(6).
   130     05  WS-NT-STATE             PIC XX.
   131     05  WS-NT-ACCOUNT           PIC X(10).
   132     05  WS-NT-REC-TYPE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page   4
* SOCK00.cbl
   133     05  WS-NT-SEQ-NO            PIC S9(4) COMP.
   134 01  WS-AM-ALT-KEY.
   135     05  WS-AM-ALT-ACCOUNT       PIC X(10).
   136     05  WS-AM-ALT-EXP-DT        PIC XX.
   137 01  WS-CT-KEY-SAVE              PIC X(5).
   138 01  WS-CT-KEY.
   139     05  WS-CT-COMPANY-CD        PIC X.
   140     05  WS-CT-TABLE             PIC XXX.
   141     05  WS-CT-BEN-TYPE          PIC X.
   142     05  WS-CT-BEN-CODE          PIC XX.
   143 01  WS-CF-KEY-SAVE              PIC X(10).
   144 01  WS-CF-KEY.
   145     05  WS-CF-COMPANY-ID        PIC XXX.
   146     05  WS-CF-RECORD-TYPE       PIC X.
   147     05  WS-CF-ACCESS            PIC X(4).
   148     05  WS-CF-SEQ-NO            PIC S9(4) COMP.
   149 01  WS-CO-KEY.
   150     05  WS-CO-COMPANY-CD        PIC X.
   151     05  WS-CO-CARRIER           PIC X.
   152     05  WS-CO-GROUP             PIC X(6).
   153     05  WS-CO-FIN-RESP          PIC X(10).
   154     05  WS-CO-ACCOUNT           PIC X(10).
   155     05  WS-CO-TYPE              PIC X.
   156 01  WS-WORK-SAH-COMM            PIC SV9(5) VALUE +0.
   157 01  WS-WORK-JAH-COMM            PIC SV9(5) VALUE +0.
   158 01  WS-POLICY-NO                PIC X(6).
   159 01  WS-SHORT-ACCT-NAME          PIC X(30).
   160 01  WS-LONG-ACCT-NAME           PIC X(60).
   161 01  WS-CONTR-NAME               PIC X(60).
   162 01  WS-SL-COMM                  PIC 9.99999.
   163 01  WS-JL-COMM                  PIC 9.99999.
   164 01  WS-SAH-COMM                 PIC 9.99999.
   165 01  WS-JAH-COMM                 PIC 9.99999.
   166 01  WS-CID-NO                   PIC X(8).
   167 01  WS-DISP-RESP                PIC 9(5).
   168 01  WS-RESPONSE                 PIC S9(8)   COMP.
   169     88  RESP-NORMAL                  VALUE +00.
   170     88  RESP-NOTFND                  VALUE +13.
   171     88  RESP-NOTOPEN                 VALUE +19.
   172     88  RESP-ENDFILE                 VALUE +20.
   173*                                 COPY ERCACNT.
   174******************************************************************
   175*                                                                *
   176*                                                                *
   177*                            ERCACNT.                            *
   178*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   179*                            VMOD=2.002                          *
   180*                                                                *
   181*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
   182*                                                                *
   183*   FILE TYPE = VSAM,KSDS                                        *
   184*   RECORD SIZE = 120   RECFORM = FIXED                          *
   185*                                                                *
   186*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
   187*       ALTERNATE INDEX = NONE                                   *
   188*                                                                *
   189*                                                                *
   190*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page   5
* SOCK00.cbl
   191*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   192******************************************************************
   193*                   C H A N G E   L O G
   194*
   195* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   196*-----------------------------------------------------------------
   197*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   198* EFFECTIVE    NUMBER
   199*-----------------------------------------------------------------
   200* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
   201*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
   202******************************************************************
   203 01  NOTE-FILE.
   204     12  NT-FILE-ID                  PIC XX.
   205         88  VALID-NOTE-ID              VALUE 'NT'.
   206
   207     12  NT-CONTROL-PRIMARY.
   208         16  NT-COMPANY-CD           PIC X.
   209         16  NT-ACCT-NOTE-KEY.
   210             18  NT-CARRIER              PIC X.
   211             18  NT-GROUPING             PIC X(06).
   212             18  NT-STATE                PIC XX.
   213             18  NT-ACCOUNT              PIC X(10).
   214         16  NT-RECORD-TYPE          PIC X.
   215              88  ACCT-NOTE          VALUE '1'.
   216              88  ACCT-BRANCH-LOC    VALUE '2'.
   217              88  ACCT-SHIPPING-ADDR VALUE '3'.
   218         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
   219
   220     12  NT-LAST-MAINT-DT            PIC XX.
   221     12  NT-LAST-MAINT-BY            PIC X(4).
   222     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
   223
   224*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
   225*     SEQUENCE NUMBERS
   226     12  NT-NOTE-INFORMATION.
   227         16  NT-NOTE-LINE            PIC X(60).
   228         16  FILLER                  PIC X(25).
   229*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
   230     12  NT-LOCATION-INFORMATION REDEFINES
   231                         NT-NOTE-INFORMATION.
   232         16  NT-BRANCH-LOC-LINE      PIC X(60).
   233         16  FILLER                  PIC X(25).
   234*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
   235*     SEQUENCE NUMBER 1 IS NAME LINE 1
   236*     SEQUENCE NUMBER 2 IS NAME LINE 2
   237*     SEQUENCE NUMBER 3 IS ADDR LINE 1
   238*     SEQUENCE NUMBER 4 IS ADDR LINE 2
   239*     SEQUENCE NUMBER 5 IS ADDR LINE 3
   240*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
   241     12  NT-SHIPPING-INFORMATION REDEFINES
   242                         NT-NOTE-INFORMATION.
   243         16  NT-SHIPPING-LINE        PIC X(60).
   244         16  NT-SHIP-STATE           PIC XX.
   245         16  NT-SHIP-ZIP             PIC X(10).
   246         16  FILLER                  PIC X(13).
   247*****************************************************************
   248*                                 COPY ERCACCT.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page   6
* SOCK00.cbl
   249******************************************************************
   250*                                                                *
   251*                                                                *
   252*                            ERCACCT                             *
   253*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   254*                            VMOD=2.031                          *
   255*                                                                *
   256*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   257*                                                                *
   258*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   259*   VSAM ACCOUNT MASTER FILES.                                   *
   260*                                                                *
   261*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   262*                                                                *
   263*   FILE TYPE = VSAM,KSDS                                        *
   264*   RECORD SIZE = 2000  RECFORM = FIX                            *
   265*                                                                *
   266*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   267*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   268*                                                                *
   269*   LOG = NO                                                     *
   270*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   271*                                                                *
   272*                                                                *
   273******************************************************************
   274*                   C H A N G E   L O G
   275*
   276* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   277*-----------------------------------------------------------------
   278*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   279* EFFECTIVE    NUMBER
   280*-----------------------------------------------------------------
   281* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   282* 092705    2005050300006  PEMA  ADD SPP LEASES
   283* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   284* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   285* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   286******************************************************************
   287
   288 01  ACCOUNT-MASTER.
   289     12  AM-RECORD-ID                      PIC XX.
   290         88  VALID-AM-ID                      VALUE 'AM'.
   291
   292     12  AM-CONTROL-PRIMARY.
   293         16  AM-COMPANY-CD                 PIC X.
   294         16  AM-MSTR-CNTRL.
   295             20  AM-CONTROL-A.
   296                 24  AM-CARRIER            PIC X.
   297                 24  AM-GROUPING.
   298                     28 AM-GROUPING-PREFIX PIC XXX.
   299                     28 AM-GROUPING-PRIME  PIC XXX.
   300                 24  AM-STATE              PIC XX.
   301                 24  AM-ACCOUNT.
   302                     28  AM-ACCOUNT-PREFIX PIC X(4).
   303                     28  AM-ACCOUNT-PRIME  PIC X(6).
   304             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   305                                           PIC X(19).
   306             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page   7
* SOCK00.cbl
   307                 24  AM-EXPIRATION-DT      PIC XX.
   308                 24  FILLER                PIC X(4).
   309             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   310                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   311
   312     12  AM-CONTROL-BY-VAR-GRP.
   313         16  AM-COMPANY-CD-A1              PIC X.
   314         16  AM-VG-CARRIER                 PIC X.
   315         16  AM-VG-GROUPING                PIC X(6).
   316         16  AM-VG-STATE                   PIC XX.
   317         16  AM-VG-ACCOUNT                 PIC X(10).
   318         16  AM-VG-DATE.
   319             20  AM-VG-EXPIRATION-DT       PIC XX.
   320             20  FILLER                    PIC X(4).
   321         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   322                                           PIC 9(11)      COMP-3.
   323     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   324         16  FILLER                        PIC X(10).
   325         16  AM-VG-KEY3.
   326             20  AM-VG3-ACCOUNT            PIC X(10).
   327             20  AM-VG3-EXP-DT             PIC XX.
   328         16  FILLER                        PIC X(4).
   329     12  AM-MAINT-INFORMATION.
   330         16  AM-LAST-MAINT-DT              PIC XX.
   331         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   332         16  AM-LAST-MAINT-USER            PIC X(4).
   333         16  FILLER                        PIC XX.
   334
   335     12  AM-EFFECTIVE-DT                   PIC XX.
   336     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   337
   338     12  AM-PREV-DATES  COMP-3.
   339         16  AM-PREV-EXP-DT                PIC 9(11).
   340         16  AM-PREV-EFF-DT                PIC 9(11).
   341
   342     12  AM-REPORT-CODE-1                  PIC X(10).
   343     12  AM-REPORT-CODE-2                  PIC X(10).
   344
   345     12  AM-CITY-CODE                      PIC X(4).
   346     12  AM-COUNTY-PARISH                  PIC X(6).
   347
   348     12  AM-NAME                           PIC X(30).
   349     12  AM-PERSON                         PIC X(30).
   350     12  AM-ADDRS                          PIC X(30).
   351     12  AM-CITY.
   352         16  AM-ADDR-CITY                  PIC X(28).
   353         16  AM-ADDR-STATE                 PIC XX.
   354     12  AM-ZIP.
   355         16  AM-ZIP-PRIME.
   356             20  AM-ZIP-PRI-1ST            PIC X.
   357                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   358             20  FILLER                    PIC X(4).
   359         16  AM-ZIP-PLUS4                  PIC X(4).
   360     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   361         16  AM-CAN-POSTAL-1               PIC XXX.
   362         16  AM-CAN-POSTAL-2               PIC XXX.
   363         16  FILLER                        PIC XXX.
   364     12  AM-TEL-NO.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page   8
* SOCK00.cbl
   365         16  AM-AREA-CODE                  PIC 999.
   366         16  AM-TEL-PRE                    PIC 999.
   367         16  AM-TEL-NBR                    PIC 9(4).
   368     12  AM-TEL-LOC                        PIC X.
   369         88  AM-TEL-AT-HOME                   VALUE 'H'.
   370         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   371
   372     12  AM-COMM-STRUCTURE.
   373         16  AM-DEFN-1.
   374             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   375                 24  AM-AGT.
   376                     28  AM-AGT-PREFIX     PIC X(4).
   377                     28  AM-AGT-PRIME      PIC X(6).
   378                 24  AM-COM-TYP            PIC X.
   379                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   380                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   381                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   382                 24  AM-RECALC-LV-INDIC    PIC X.
   383                 24  AM-RETRO-LV-INDIC     PIC X.
   384                 24  AM-GL-CODES           PIC X.
   385                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   386                 24  FILLER                PIC X(01).
   387         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   388             20  AM-COM-TBLS        OCCURS 10 TIMES.
   389                 24  FILLER                PIC X(11).
   390                 24  AM-L-COMA             PIC XXX.
   391                 24  AM-J-COMA             PIC XXX.
   392                 24  AM-A-COMA             PIC XXX.
   393                 24  FILLER                PIC X(6).
   394
   395     12  AM-COMM-CHANGE-STATUS             PIC X.
   396         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   397
   398     12  AM-CSR-CODE                       PIC X(4).
   399
   400     12  AM-BILLING-STATUS                 PIC X.
   401         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   402         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   403     12  AM-AUTO-REFUND-SW                 PIC X.
   404         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   405         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   406     12  AM-GPCD                           PIC 99.
   407     12  AM-IG                             PIC X.
   408         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   409         88  AM-HAS-GROUP                     VALUE '2'.
   410     12  AM-STATUS                         PIC X.
   411         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   412         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   413         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   414         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   415         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   416     12  AM-REMIT-TO                       PIC 99.
   417     12  AM-ID-NO                          PIC X(11).
   418
   419     12  AM-CAL-TABLE                      PIC XX.
   420     12  AM-LF-DEVIATION                   PIC XXX.
   421     12  AM-AH-DEVIATION                   PIC XXX.
   422     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page   9
* SOCK00.cbl
   423     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   424     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   425     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   426     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   427     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   428
   429     12  AM-USER-FIELDS.
   430         16  AM-FLD-1                      PIC XX.
   431         16  AM-FLD-2                      PIC XX.
   432         16  AM-FLD-3                      PIC XX.
   433         16  AM-FLD-4                      PIC XX.
   434         16  AM-FLD-5                      PIC XX.
   435
   436     12  AM-1ST-PROD-DATE.
   437         16  AM-1ST-PROD-YR                PIC XX.
   438         16  AM-1ST-PROD-MO                PIC XX.
   439         16  AM-1ST-PROD-DA                PIC XX.
   440     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   441     12  AM-CERTS-PURGED-DATE.
   442         16  AM-PUR-YR                     PIC XX.
   443         16  AM-PUR-MO                     PIC XX.
   444         16  AM-PUR-DA                     PIC XX.
   445     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   446     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   447     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   448     12  AM-INACTIVE-DATE.
   449         16  AM-INA-MO                     PIC 99.
   450         16  AM-INA-DA                     PIC 99.
   451         16  AM-INA-YR                     PIC 99.
   452     12  AM-AR-HI-CERT-DATE                PIC XX.
   453
   454     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   455     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   456
   457     12  AM-OB-PAYMENT-MODE                PIC X.
   458         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   459         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   460         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   461         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   462
   463     12  AM-AH-ONLY-INDICATOR              PIC X.
   464         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   465         88  AM-NO-AH-ONLY                    VALUE 'N'.
   466
   467     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   468
   469     12  AM-OVER-SHORT.
   470         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   471         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   472
   473     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   474     12  AM-DCC-CLP-STATE                  PIC XX.
   475
   476     12  AM-RECALC-COMM                    PIC X.
   477     12  AM-RECALC-REIN                    PIC X.
   478
   479     12  AM-REI-TABLE                      PIC XXX.
   480     12  AM-REI-ET-LF                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  10
* SOCK00.cbl
   481     12  AM-REI-ET-AH                      PIC X.
   482     12  AM-REI-PE-LF                      PIC X.
   483     12  AM-REI-PE-AH                      PIC X.
   484     12  AM-REI-PRT-ST                     PIC X.
   485     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   486     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   487     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   488     12  AM-REI-GROUP-A                    PIC X(6).
   489     12  AM-REI-MORT                       PIC X(4).
   490     12  AM-REI-PRT-OW                     PIC X.
   491     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   492     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   493     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   494     12  AM-REI-GROUP-B                    PIC X(6).
   495
   496     12  AM-TRUST-TYPE                     PIC X(2).
   497
   498     12  AM-EMPLOYER-STMT-USED             PIC X.
   499     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   500
   501     12  AM-STD-AH-TYPE                    PIC XX.
   502     12  AM-EARN-METHODS.
   503         16  AM-EARN-METHOD-R              PIC X.
   504             88 AM-REF-RL-R78                 VALUE 'R'.
   505             88 AM-REF-RL-PR                  VALUE 'P'.
   506             88 AM-REF-RL-MEAN                VALUE 'M'.
   507             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   508         16  AM-EARN-METHOD-L              PIC X.
   509             88 AM-REF-LL-R78                 VALUE 'R'.
   510             88 AM-REF-LL-PR                  VALUE 'P'.
   511             88 AM-REF-LL-MEAN                VALUE 'M'.
   512             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   513         16  AM-EARN-METHOD-A              PIC X.
   514             88 AM-REF-AH-R78                 VALUE 'R'.
   515             88 AM-REF-AH-PR                  VALUE 'P'.
   516             88 AM-REF-AH-MEAN                VALUE 'M'.
   517             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   518             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   519             88 AM-REF-AH-NET                 VALUE 'N'.
   520
   521     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   522     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   523     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   524
   525     12  AM-RET-Y-N                        PIC X.
   526     12  AM-RET-P-E                        PIC X.
   527     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   528     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   529     12  AM-RET-GRP                        PIC X(6).
   530     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   531         16  AM-POOL-PRIME                 PIC XXX.
   532         16  AM-POOL-SUB                   PIC XXX.
   533     12  AM-RETRO-EARNINGS.
   534         16  AM-RET-EARN-R                 PIC X.
   535         16  AM-RET-EARN-L                 PIC X.
   536         16  AM-RET-EARN-A                 PIC X.
   537     12  AM-RET-ST-TAX-USE                 PIC X.
   538         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  11
* SOCK00.cbl
   539         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   540     12  AM-RETRO-BEG-EARNINGS.
   541         16  AM-RET-BEG-EARN-R             PIC X.
   542         16  AM-RET-BEG-EARN-L             PIC X.
   543         16  AM-RET-BEG-EARN-A             PIC X.
   544     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   545     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   546
   547     12  AM-USER-SELECT-OPTIONS.
   548         16  AM-USER-SELECT-1              PIC X(10).
   549         16  AM-USER-SELECT-2              PIC X(10).
   550         16  AM-USER-SELECT-3              PIC X(10).
   551         16  AM-USER-SELECT-4              PIC X(10).
   552         16  AM-USER-SELECT-5              PIC X(10).
   553
   554     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   555
   556     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   557
   558     12  AM-RPT045A-SWITCH                 PIC X.
   559         88  RPT045A-OFF                   VALUE 'N'.
   560
   561     12  AM-INSURANCE-LIMITS.
   562         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   563         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   564
   565     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   566         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   567
   568     12  AM-DISMBR-COVERAGE-SW             PIC X.
   569         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   570         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   571
   572     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   573
   574     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   575     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   576     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   577     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   578     12  FILLER                            PIC X(5).
   579     12  AM-REPORT-CODE-3                  PIC X(10).
   580*    12  FILLER                            PIC X(22).
   581
   582     12  AM-RESERVE-DATE.
   583         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   584         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   585         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   586
   587     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   588     12  AM-NOTIFICATION-TYPES.
   589         16  AM-NOTIF-OF-LETTERS           PIC X.
   590         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   591         16  AM-NOTIF-OF-REPORTS           PIC X.
   592         16  AM-NOTIF-OF-STATUS            PIC X.
   593
   594     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   595         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   596         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  12
* SOCK00.cbl
   597         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   598         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   599
   600     12  AM-BENEFIT-CONTROLS.
   601         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   602             20  AM-BENEFIT-CODE           PIC XX.
   603             20  AM-BENEFIT-TYPE           PIC X.
   604             20  AM-BENEFIT-REVISION       PIC XXX.
   605             20  AM-BENEFIT-REM-TERM       PIC X.
   606             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   607             20  FILLER                    PIC XX.
   608         16  FILLER                        PIC X(80).
   609
   610     12  AM-TRANSFER-DATA.
   611         16  AM-TRANSFERRED-FROM.
   612             20  AM-TRNFROM-CARRIER        PIC X.
   613             20  AM-TRNFROM-GROUPING.
   614                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   615                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   616             20  AM-TRNFROM-STATE          PIC XX.
   617             20  AM-TRNFROM-ACCOUNT.
   618                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   619                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   620             20  AM-TRNFROM-DTE            PIC XX.
   621         16  AM-TRANSFERRED-TO.
   622             20  AM-TRNTO-CARRIER          PIC X.
   623             20  AM-TRNTO-GROUPING.
   624                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   625                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   626             20  AM-TRNTO-STATE            PIC XX.
   627             20  AM-TRNTO-ACCOUNT.
   628                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   629                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   630             20  AM-TRNTO-DTE              PIC XX.
   631         16  FILLER                        PIC X(10).
   632
   633     12  AM-SAVED-REMIT-TO                 PIC 99.
   634
   635     12  AM-COMM-STRUCTURE-SAVED.
   636         16  AM-DEFN-1-SAVED.
   637             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   638                 24  AM-AGT-SV             PIC X(10).
   639                 24  AM-COM-TYP-SV         PIC X.
   640                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
   641                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
   642                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
   643                 24  AM-RECALC-LV-INDIC-SV PIC X.
   644                 24  FILLER                PIC X.
   645                 24  AM-GL-CODES-SV        PIC X.
   646                 24  AM-COM-CHARGEBACK-SV  PIC 99.
   647                 24  FILLER                PIC X.
   648         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
   649             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
   650                 24  FILLER                PIC X(11).
   651                 24  AM-L-COMA-SV          PIC XXX.
   652                 24  AM-J-COMA-SV          PIC XXX.
   653                 24  AM-A-COMA-SV          PIC XXX.
   654                 24  FILLER                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  13
* SOCK00.cbl
   655
   656     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
   657         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
   658            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
   659            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
   660            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
   661
   662     12  AM-ORIG-DEALER-NO                 PIC X(10).
   663     12  FILLER                            PIC X(120).
   664
   665     12  AM-ACCOUNT-EXECUTIVE-DATA.
   666         16  AM-CONTROL-NAME               PIC X(30).
   667         16  AM-EXECUTIVE-ONE.
   668             20  AM-EXEC1-NAME             PIC X(15).
   669             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
   670                                                          COMP-3.
   671             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
   672                                                          COMP-3.
   673         16  AM-EXECUTIVE-TWO.
   674             20  AM-EXEC2-NAME             PIC X(15).
   675             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
   676                                                          COMP-3.
   677             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
   678                                                          COMP-3.
   679
   680     12  AM-RETRO-ADDITIONAL-DATA.
   681         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
   682         16  AM-RETRO-PREM-P-E             PIC X.
   683         16  AM-RETRO-CLMS-P-I             PIC X.
   684         16  AM-RETRO-RET-BRACKET-LF.
   685             20  AM-RETRO-RET-METHOD-LF    PIC X.
   686                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
   687                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
   688             20  AM-RETRO-RET-BASIS-LF     PIC X.
   689                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
   690                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
   691             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
   692                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
   693                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
   694         16  AM-RETRO-RET-BRACKET-AH.
   695             20  AM-RETRO-RET-METHOD-AH    PIC X.
   696                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
   697                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
   698                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
   699             20  AM-RETRO-RET-BASIS-AH     PIC X.
   700                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
   701                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
   702             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
   703                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
   704                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
   705
   706     12  AM-COMMENTS.
   707         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
   708
   709     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
   710         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
   711         16  AM-FLI-BILLING-CODE           PIC X.
   712         16  AM-FLI-ALT-STATE-CODE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  14
* SOCK00.cbl
   713         16  AM-FLI-UNITED-IDENT           PIC X.
   714         16  AM-FLI-INTEREST-LOST-DATA.
   715             20  AM-FLI-BANK-NO            PIC X(5).
   716             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
   717             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
   718             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
   719         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
   720             20  AM-FLI-AGT                PIC X(9).
   721             20  AM-FLI-AGT-COMM-ACC       PIC X.
   722             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
   723         16  FILLER                        PIC X(102).
   724
   725     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
   726         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
   727             20  AM-BENEFIT-DMD-CODE         PIC XX.
   728             20  AM-BENEFIT-DMD-TYPE         PIC X.
   729             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
   730             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
   731             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
   732         16  FILLER                          PIC X(10).
   733******************************************************************
   734*                                 COPY ERCCOMP.
   735******************************************************************
   736*                                                                *
   737*                                                                *
   738*                            ERCCOMP                             *
   739*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   740*                            VMOD=2.019                          *
   741*                                                                *
   742*   ONLINE CREDIT SYSTEM                                         *
   743*                                                                *
   744*   FILE DESCRIPTION = COMPENSATION MASTER                       *
   745*                                                                *
   746*   FILE TYPE = VSAM,KSDS                                        *
   747*   RECORD SIZE = 700   RECFORM = FIXED                          *
   748*                                                                *
   749*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
   750*       ALTERNATE PATH = NONE                                    *
   751*                                                                *
   752*   LOG = NO                                                     *
   753*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   754*                                                                *
   755******************************************************************
   756*                   C H A N G E   L O G
   757*
   758* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   759*-----------------------------------------------------------------
   760*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   761* EFFECTIVE    NUMBER
   762*-----------------------------------------------------------------
   763* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   764* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
   765* 092205    2005050300006  PEMA  ADD LEASE FEE
   766* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
   767* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
   768* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
   769* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   770* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  15
* SOCK00.cbl
   771******************************************************************
   772
   773 01  COMPENSATION-MASTER.
   774     12  CO-RECORD-ID                          PIC XX.
   775         88  VALID-CO-ID                          VALUE 'CO'.
   776
   777     12  CO-CONTROL-PRIMARY.
   778         16  CO-COMPANY-CD                     PIC X.
   779         16  CO-CONTROL.
   780             20  CO-CTL-1.
   781                 24  CO-CARR-GROUP.
   782                     28  CO-CARRIER            PIC X.
   783                     28  CO-GROUPING.
   784                         32  CO-GROUP-PREFIX   PIC XXX.
   785                         32  CO-GROUP-PRIME    PIC XXX.
   786                 24  CO-RESP-NO.
   787                     28  CO-RESP-PREFIX        PIC X(4).
   788                     28  CO-RESP-PRIME         PIC X(6).
   789             20  CO-CTL-2.
   790                 24  CO-ACCOUNT.
   791                     28  CO-ACCT-PREFIX        PIC X(4).
   792                     28  CO-ACCT-PRIME         PIC X(6).
   793         16  CO-TYPE                           PIC X.
   794             88  CO-COMPANY-TYPE                  VALUE 'C'.
   795             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
   796             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
   797
   798     12  CO-MAINT-INFORMATION.
   799         16  CO-LAST-MAINT-DT                  PIC XX.
   800         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   801         16  CO-LAST-MAINT-USER                PIC X(4).
   802     12  FILLER                                PIC XX.
   803     12  CO-STMT-TYPE                          PIC XXX.
   804     12  CO-COMP-TYPE                          PIC X.
   805         88  CO-COMP-IS-SPPDD                    VALUE '1'.
   806     12  CO-STMT-OWNER                         PIC X(4).
   807     12  CO-BALANCE-CONTROL                    PIC X.
   808         88  CO-CARRY-BALANCE                     VALUE 'Y'.
   809         88  CO-NO-BALANCE                        VALUE 'N'.
   810
   811     12  CO-INTERNAL-CONTROL-1                 PIC X.
   812         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   813         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   814         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   815
   816     12  CO-INTERNAL-CONTROL-2                 PIC X.
   817         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
   818         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   819
   820     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   821     12  CO-GA-DIRECT-DEP                      PIC X.
   822     12  CO-FUTURE-SPACE                       PIC X.
   823         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   824
   825     12  CO-ACCT-NAME                          PIC X(30).
   826     12  CO-MAIL-NAME                          PIC X(30).
   827     12  CO-ADDR-1                             PIC X(30).
   828     12  CO-ADDR-2                             PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  16
* SOCK00.cbl
   829     12  CO-ADDR-3.
   830         16  CO-ADDR-CITY                      PIC X(27).
   831         16  CO-ADDR-STATE                     PIC XX.
   832     12  CO-CSO-1099                           PIC X.
   833     12  CO-ZIP.
   834         16  CO-ZIP-PRIME.
   835             20  CO-ZIP-PRI-1ST                PIC X.
   836                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   837             20  FILLER                        PIC X(4).
   838         16  CO-ZIP-PLUS4                      PIC X(4).
   839     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   840         16  CO-CAN-POSTAL-1                   PIC XXX.
   841         16  CO-CAN-POSTAL-2                   PIC XXX.
   842         16  FILLER                            PIC XXX.
   843     12  CO-SOC-SEC                            PIC X(13).
   844     12  CO-TELEPHONE.
   845         16  CO-AREA-CODE                      PIC XXX.
   846         16  CO-PREFIX                         PIC XXX.
   847         16  CO-PHONE                          PIC X(4).
   848
   849     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   850
   851     12  CO-AR-BAL-LEVEL                       PIC X.
   852         88  CO-AR-REF-LVL                        VALUE '1'.
   853         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   854         88  CO-AR-BILL-LVL                       VALUE '2'.
   855         88  CO-AR-AGT-LVL                        VALUE '3'.
   856         88  CO-AR-FR-LVL                         VALUE '4'.
   857
   858     12  CO-AR-NORMAL-PRINT                    PIC X.
   859         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   860         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   861
   862     12  CO-AR-SUMMARY-CODE                    PIC X(6).
   863
   864     12  CO-AR-REPORTING                       PIC X.
   865         88  CO-AR-NET-REPORT                     VALUE 'N'.
   866         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   867
   868     12  CO-AR-PULL-CHECK                      PIC X.
   869         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   870         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   871
   872     12  CO-AR-BALANCE-PRINT                   PIC X.
   873         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
   874
   875     12  CO-AR-LAST-RUN-CODE                   PIC X.
   876         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   877         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
   878         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   879
   880     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   881
   882     12  CO-USER-CODE                          PIC X.
   883     12  CO-REPORT-GROUP-ID                    PIC X(12).
   884
   885******************************************************************
   886*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  17
* SOCK00.cbl
   887*    THE LAST MONTH END RUN.
   888******************************************************************
   889
   890     12  CO-LAST-ACTIVITY-DATE.
   891         16  CO-ACT-YEAR                       PIC 99.
   892         16  CO-ACT-MONTH                      PIC 99.
   893         16  CO-ACT-DAY                        PIC 99.
   894
   895     12  CO-LAST-STMT-DT.
   896         16  CO-LAST-STMT-YEAR                 PIC 99.
   897         16  CO-LAST-STMT-MONTH                PIC 99.
   898         16  CO-LAST-STMT-DAY                  PIC 99.
   899
   900     12  CO-MO-END-TOTALS.
   901         16  CO-MONTHLY-TOTALS.
   902             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   903             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   904             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
   905             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
   906             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
   907
   908         16  CO-AGING-TOTALS.
   909             20  CO-CUR                    PIC S9(7)V99   COMP-3.
   910             20  CO-OV30                   PIC S9(7)V99   COMP-3.
   911             20  CO-OV60                   PIC S9(7)V99   COMP-3.
   912             20  CO-OV90                   PIC S9(7)V99   COMP-3.
   913
   914         16  CO-YTD-TOTALS.
   915             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
   916             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
   917
   918         16  CO-OVER-UNDER-TOTALS.
   919             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
   920             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
   921
   922     12  CO-MISCELLANEOUS-TOTALS.
   923         16  CO-FICA-TOTALS.
   924             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
   925             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
   926
   927         16  CO-CLAIM-TOTALS.
   928             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
   929             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
   930
   931******************************************************************
   932*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
   933*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
   934******************************************************************
   935
   936     12  CO-CURRENT-TOTALS.
   937         16  CO-CURRENT-LAST-STMT-DT.
   938             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
   939             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
   940             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
   941
   942         16  CO-CURRENT-MONTHLY-TOTALS.
   943             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
   944             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  18
* SOCK00.cbl
   945             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
   946             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
   947             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
   948
   949         16  CO-CURRENT-AGING-TOTALS.
   950             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
   951             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
   952             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
   953             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
   954
   955         16  CO-CURRENT-YTD-TOTALS.
   956             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
   957             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
   958
   959     12  CO-PAID-COMM-TOTALS.
   960         16  CO-YTD-PAID-COMMS.
   961             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
   962             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
   963
   964     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
   965         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
   966         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
   967
   968     12  CO-DELINQUENT-LETTER-CODE         PIC X.
   969         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
   970         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
   971         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
   972         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
   973         88  CO-OVERWRITE-LETTER              VALUE 'O'.
   974         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
   975         88  CO-FINAL-LETTER                  VALUE 'F'.
   976         88  CO-RECONCILING                   VALUE 'R'.
   977         88  CO-PHONE-CALL                    VALUE 'P'.
   978         88  CO-LEGAL                         VALUE 'L'.
   979         88  CO-COLLECTION-AGENCY             VALUE 'C'.
   980         88  CO-WRITE-OFF                     VALUE 'W'.
   981         88  CO-NO-ACTION                     VALUE 'N' ' '.
   982
   983     12  CO-CSR-CODE                       PIC X(4).
   984
   985     12  CO-GA-STATUS-INFO.
   986         16  CO-GA-EFFECTIVE-DT            PIC XX.
   987         16  CO-GA-TERMINATION-DT          PIC XX.
   988         16  CO-GA-STATUS-CODE             PIC X.
   989             88  CO-GA-ACTIVE                 VALUE 'A'.
   990             88  CO-GA-INACTIVE               VALUE 'I'.
   991             88  CO-GA-PENDING                VALUE 'P'.
   992         16  CO-GA-COMMENTS.
   993             20  CO-GA-COMMENT-1           PIC X(40).
   994             20  CO-GA-COMMENT-2           PIC X(40).
   995             20  CO-GA-COMMENT-3           PIC X(40).
   996             20  CO-GA-COMMENT-4           PIC X(40).
   997
   998     12  CO-RPTCD2                         PIC X(10).
   999
  1000     12  CO-TYPE-AGENT                     PIC X(01).
  1001         88  CO-CORPORATION                   VALUE 'C'.
  1002         88  CO-PARTNERSHIP                   VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  19
* SOCK00.cbl
  1003         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1004         88  CO-TRUST                         VALUE 'T'.
  1005         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1006
  1007     12  CO-FAXNO.
  1008         16  CO-FAX-AREA-CODE                  PIC XXX.
  1009         16  CO-FAX-PREFIX                     PIC XXX.
  1010         16  CO-FAX-PHONE                      PIC X(4).
  1011
  1012     12  CO-BANK-INFORMATION.
  1013         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1014         16  CO-BANK-TRANSIT-NON REDEFINES
  1015             CO-BANK-TRANSIT-NO                PIC 9(8).
  1016
  1017         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1018     12  CO-MISC-DEDUCT-INFO REDEFINES
  1019                  CO-BANK-INFORMATION.
  1020         16  CO-MD-GL-ACCT                     PIC X(10).
  1021         16  CO-MD-DIV                         PIC XX.
  1022         16  CO-MD-CENTER                      PIC X(4).
  1023         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1024         16  CO-CREATE-AP-CHECK                PIC X.
  1025         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1026         16  FILLER                            PIC XXX.
  1027     12  CO-ACH-STATUS                         PIC X.
  1028         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1029         88  CO-ACH-PENDING                        VALUE 'P'.
  1030
  1031     12  CO-BILL-SW                            PIC X.
  1032     12  CO-CONTROL-NAME                       PIC X(30).
  1033     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1034     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1035     12  CO-CLP-STATE                          PIC XX.
  1036     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1037     12  CO-SPP-REFUND-EDIT                    PIC X.
  1038
  1039******************************************************************
  1040*                                 COPY ELCCNTL.
  1041******************************************************************
  1042*                                                                *
  1043*                                                                *
  1044*                            ELCCNTL.                            *
  1045*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1046*                            VMOD=2.059                          *
  1047*                                                                *
  1048*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1049*                                                                *
  1050*   FILE TYPE = VSAM,KSDS                                        *
  1051*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1052*                                                                *
  1053*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1054*       ALTERNATE INDEX = NONE                                   *
  1055*                                                                *
  1056*   LOG = YES                                                    *
  1057*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1058******************************************************************
  1059*                   C H A N G E   L O G
  1060*
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  20
* SOCK00.cbl
  1061* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1062*-----------------------------------------------------------------
  1063*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1064* EFFECTIVE    NUMBER
  1065*-----------------------------------------------------------------
  1066* 082503                   PEMA  ADD BENEFIT GROUP
  1067* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1068* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1069* 092705    2005050300006  PEMA  ADD SPP LEASES
  1070* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1071* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1072* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1073* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1074******************************************************************
  1075*
  1076 01  CONTROL-FILE.
  1077     12  CF-RECORD-ID                       PIC XX.
  1078         88  VALID-CF-ID                        VALUE 'CF'.
  1079
  1080     12  CF-CONTROL-PRIMARY.
  1081         16  CF-COMPANY-ID                  PIC XXX.
  1082         16  CF-RECORD-TYPE                 PIC X.
  1083             88  CF-COMPANY-MASTER              VALUE '1'.
  1084             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1085             88  CF-STATE-MASTER                VALUE '3'.
  1086             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1087             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1088             88  CF-CARRIER-MASTER              VALUE '6'.
  1089             88  CF-MORTALITY-MASTER            VALUE '7'.
  1090             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1091             88  CF-TERMINAL-MASTER             VALUE '9'.
  1092             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1093             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1094             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1095             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1096             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1097             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1098             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1099             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1100             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1101         16  CF-ACCESS-CD-GENL              PIC X(4).
  1102         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1103             20  CF-PROCESSOR               PIC X(4).
  1104         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1105             20  CF-STATE-CODE              PIC XX.
  1106             20  FILLER                     PIC XX.
  1107         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1108             20  FILLER                     PIC XX.
  1109             20  CF-HI-BEN-IN-REC           PIC XX.
  1110         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1111             20  FILLER                     PIC XXX.
  1112             20  CF-CARRIER-CNTL            PIC X.
  1113         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1114             20  FILLER                     PIC XX.
  1115             20  CF-HI-TYPE-IN-REC          PIC 99.
  1116         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1117             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1118                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  21
* SOCK00.cbl
  1119             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1120             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1121         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1122             20  FILLER                     PIC X.
  1123             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1124         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1125             20  FILLER                     PIC XX.
  1126             20  CF-MORTGAGE-PLAN           PIC XX.
  1127         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1128
  1129     12  CF-LAST-MAINT-DT                   PIC XX.
  1130     12  CF-LAST-MAINT-BY                   PIC X(4).
  1131     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1132
  1133     12  CF-RECORD-BODY                     PIC X(728).
  1134
  1135
  1136****************************************************************
  1137*             COMPANY MASTER RECORD                            *
  1138****************************************************************
  1139
  1140     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1141         16  CF-COMPANY-ADDRESS.
  1142             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1143             20  CF-CL-IN-CARE-OF           PIC X(30).
  1144             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1145             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1146             20  CF-CL-CITY-STATE           PIC X(30).
  1147             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1148             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1149         16  CF-COMPANY-CD                  PIC X.
  1150         16  CF-COMPANY-PASSWORD            PIC X(8).
  1151         16  CF-SECURITY-OPTION             PIC X.
  1152             88  ALL-SECURITY                   VALUE '1'.
  1153             88  COMPANY-VERIFY                 VALUE '2'.
  1154             88  PROCESSOR-VERIFY               VALUE '3'.
  1155             88  NO-SECURITY                    VALUE '4'.
  1156             88  ALL-BUT-TERM                   VALUE '5'.
  1157         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1158             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1159         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1160             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1161         16  CF-INFORCE-LOCATION            PIC X.
  1162             88  CERTS-ARE-ONLINE               VALUE '1'.
  1163             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1164             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1165         16  CF-LOWER-CASE-LETTERS          PIC X.
  1166         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1167             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1168             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1169             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1170             88  CF-ACCNT-CNTL                  VALUE '3'.
  1171             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1172
  1173         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1174         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1175
  1176         16  CF-LGX-CREDIT-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  22
* SOCK00.cbl
  1177             88  CO-IS-NOT-USER                 VALUE 'N'.
  1178             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1179
  1180         16 CF-CREDIT-CALC-CODES.
  1181             20  CF-CR-REM-TERM-CALC PIC X.
  1182               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1183               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1184               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1185               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1186               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1187               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1188               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1189             20  CF-CR-R78-METHOD           PIC X.
  1190               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1191               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1192
  1193         16  CF-CLAIM-CONTROL-COUNTS.
  1194             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1195                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1196
  1197             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1198                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1199
  1200             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1201                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1202
  1203             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1204                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1205
  1206         16  CF-CURRENT-MONTH-END           PIC XX.
  1207
  1208         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1209             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1210             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1211             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1212             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1213                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1214                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1215             20  CF-CO-PREM-REJECT-SW       PIC X.
  1216                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1217                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1218             20  CF-CO-REF-REJECT-SW        PIC X.
  1219                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1220                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1221
  1222         16  CF-CO-REPORTING-DT             PIC XX.
  1223         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1224         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1225           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1226           88  CF-CO-MONTH-END                  VALUE '1'.
  1227
  1228         16  CF-LGX-CLAIM-USER              PIC X.
  1229             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1230             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1231
  1232         16  CF-CREDIT-EDIT-CONTROLS.
  1233             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1234             20  CF-MIN-AGE                 PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  23
* SOCK00.cbl
  1235             20  CF-DEFAULT-AGE             PIC 99.
  1236             20  CF-MIN-TERM                PIC S999      COMP-3.
  1237             20  CF-MAX-TERM                PIC S999      COMP-3.
  1238             20  CF-DEFAULT-SEX             PIC X.
  1239             20  CF-JOINT-AGE-INPUT         PIC X.
  1240                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1241             20  CF-BIRTH-DATE-INPUT        PIC X.
  1242                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1243             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1244                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1245                 88  CF-ZERO-CARRIER            VALUE '1'.
  1246                 88  CF-ZERO-GROUPING           VALUE '2'.
  1247                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1248             20  CF-EDIT-SW                 PIC X.
  1249                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1250             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1251             20  CF-CR-PR-METHOD            PIC X.
  1252               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1253               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1254             20  FILLER                     PIC X.
  1255
  1256         16  CF-CREDIT-MISC-CONTROLS.
  1257             20  CF-REIN-TABLE-SW           PIC X.
  1258                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1259             20  CF-COMP-TABLE-SW           PIC X.
  1260                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1261             20  CF-EXPERIENCE-RETENTION-AGE
  1262                                            PIC S9        COMP-3.
  1263             20  CF-CONVERSION-DT           PIC XX.
  1264             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1265             20  CF-RUN-FREQUENCY-SW        PIC X.
  1266                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1267                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1268
  1269             20  CF-CR-CHECK-NO-CONTROL.
  1270                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1271                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1272                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1273                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1274                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1275                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1276
  1277                 24  CF-CR-CHECK-COUNT       REDEFINES
  1278                     CF-CR-CHECK-COUNTER      PIC X(4).
  1279
  1280                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1281                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1282
  1283                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1284                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1285                 24  CF-MAIL-PROCESSING       PIC X.
  1286                     88  MAIL-PROCESSING          VALUE 'Y'.
  1287
  1288         16  CF-MISC-SYSTEM-CONTROL.
  1289             20  CF-SYSTEM-C                 PIC X.
  1290                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1291             20  CF-SYSTEM-D                 PIC X.
  1292                 88  DAILY-BILL-SYS-USED         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  24
* SOCK00.cbl
  1293             20  CF-SOC-SEC-NO-SW            PIC X.
  1294                 88  SOC-SEC-NO-USED             VALUE '1'.
  1295             20  CF-MEMBER-NO-SW             PIC X.
  1296                 88  MEMBER-NO-USED              VALUE '1'.
  1297             20  CF-TAX-ID-NUMBER            PIC X(11).
  1298             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1299             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1300                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1301                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1302                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1303                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1304             20  CF-SYSTEM-E                 PIC X.
  1305                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1306
  1307         16  CF-LGX-LIFE-USER               PIC X.
  1308             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1309             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1310
  1311         16  CF-CR-MONTH-END-DT             PIC XX.
  1312
  1313         16  CF-FILE-MAINT-DATES.
  1314             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1315                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1316             20  CF-LAST-BATCH       REDEFINES
  1317                 CF-LAST-BATCH-NO               PIC X(4).
  1318             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1319             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1320             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1321             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1322             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1323             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1324             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1325             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1326             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1327             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1328
  1329         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1330         16  FILLER                         PIC X.
  1331
  1332         16  CF-ALT-MORT-CODE               PIC X(4).
  1333         16  CF-MEMBER-CAPTION              PIC X(10).
  1334
  1335         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1336             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1337             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1338             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1339             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1340             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1341
  1342         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1343
  1344         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1345         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1346         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1347         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1348
  1349         16  CF-AH-OVERRIDE-L1              PIC X.
  1350         16  CF-AH-OVERRIDE-L2              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  25
* SOCK00.cbl
  1351         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1352         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1353
  1354         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1355         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1356
  1357         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1358         16  CF-AR-LAST-EL860-DT            PIC XX.
  1359         16  CF-MP-MONTH-END-DT             PIC XX.
  1360
  1361         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1362         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1363             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1364
  1365         16  CF-AR-MONTH-END-DT             PIC XX.
  1366
  1367         16  CF-CRDTCRD-USER                PIC X.
  1368             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1369             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1370
  1371         16  CF-CC-MONTH-END-DT             PIC XX.
  1372
  1373         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1374
  1375         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1376             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1377             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1378             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1379         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1380         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1381         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1382         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1383             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1384             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1385         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1386         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1387         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1388             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1389         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1390
  1391         16  CF-CL-ZIP-CODE.
  1392             20  CF-CL-ZIP-PRIME.
  1393                 24  CF-CL-ZIP-1ST          PIC X.
  1394                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1395                 24  FILLER                 PIC X(4).
  1396             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1397         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1398             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1399             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1400             20  FILLER                     PIC XXX.
  1401
  1402         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1403         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1404         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1405         16  CF-CO-OPTION-START-DATE        PIC XX.
  1406         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1407           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1408                                                      '3' '4'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  26
* SOCK00.cbl
  1409           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1410           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1411           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1412           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1413           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1414           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1415
  1416         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1417
  1418         16  CF-PAYMENT-APPROVAL-LEVELS.
  1419             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1420             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1421             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1422             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1423             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1424             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1425
  1426         16  CF-END-USER-REPORTING-USER     PIC X.
  1427             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1428             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1429
  1430         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1431             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1432             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1433
  1434         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1435
  1436         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1437         16  FILLER                         PIC X.
  1438
  1439         16  CF-CREDIT-ARCHIVE-CNTL.
  1440             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1441             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1442             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1443
  1444         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1445
  1446         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1447             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1448             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1449
  1450         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1451             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1452             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1453
  1454         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1455
  1456         16  CF-CO-ACH-ID-CODE              PIC  X.
  1457             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1458             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1459             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1460         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1461         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1462         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1463         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1464         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1465         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1466         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  27
* SOCK00.cbl
  1467         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1468         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1469                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1470         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1471                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1472
  1473         16  CF-CO-OVER-SHORT.
  1474             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1475             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1476
  1477*         16  FILLER                         PIC X(102).
  1478         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1479             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1480             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1481
  1482         16  CF-AH-APPROVAL-DAYS.
  1483             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1484             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1485             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1486             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1487
  1488         16  FILLER                         PIC X(82).
  1489****************************************************************
  1490*             PROCESSOR/USER RECORD                            *
  1491****************************************************************
  1492
  1493     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1494         16  CF-PROCESSOR-NAME              PIC X(30).
  1495         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1496         16  CF-PROCESSOR-TITLE             PIC X(26).
  1497         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1498                 88  MESSAGE-YES                VALUE 'Y'.
  1499                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1500
  1501*****************************************************
  1502****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1503****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1504****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1505****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1506*****************************************************
  1507
  1508         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1509             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1510             20  CF-APPLICATION-FORCE       PIC X.
  1511             20  CF-INDIVIDUAL-APP.
  1512                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1513                     28  CF-BROWSE-APP      PIC X.
  1514                     28  CF-UPDATE-APP      PIC X.
  1515
  1516         16  CF-CURRENT-TERM-ON             PIC X(4).
  1517         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1518             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1519             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1520             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1521             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1522             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1523             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1524             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  28
* SOCK00.cbl
  1525         16  CF-PROCESSOR-CARRIER           PIC X.
  1526             88  NO-CARRIER-SECURITY            VALUE ' '.
  1527         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1528             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1529         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1530             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1531         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1532             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1533
  1534         16  CF-PROC-SYS-ACCESS-SW.
  1535             20  CF-PROC-CREDIT-CLAIMS-SW.
  1536                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1537                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1538                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1539                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1540             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1541                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1542                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1543             20  CF-PROC-LIFE-GNRLDGR-SW.
  1544                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1545                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1546                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1547                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1548             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1549                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1550                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1551         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1552             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1553             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1554         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1555
  1556         16  CF-APPROVAL-LEVEL                  PIC X.
  1557             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1558             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1559             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1560             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1561
  1562         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1563
  1564         16  CF-LANGUAGE-TYPE                   PIC X.
  1565             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1566             88  CF-LANG-IS-FR                      VALUE 'F'.
  1567         16  FILLER                             PIC  X(240).
  1568
  1569****************************************************************
  1570*             PROCESSOR/REMINDERS RECORD                       *
  1571****************************************************************
  1572
  1573     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1574         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1575             20  CF-START-REMIND-DT         PIC XX.
  1576             20  CF-END-REMIND-DT           PIC XX.
  1577             20  CF-REMINDER-TEXT           PIC X(50).
  1578         16  FILLER                         PIC X(296).
  1579
  1580
  1581****************************************************************
  1582*             STATE MASTER RECORD                              *
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  29
* SOCK00.cbl
  1583****************************************************************
  1584
  1585     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1586         16  CF-STATE-ABBREVIATION          PIC XX.
  1587         16  CF-STATE-NAME                  PIC X(25).
  1588         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1589         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1590             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1591             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1592             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1593             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1594                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1595                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1596             20  CF-ST-PREM-REJECT-SW       PIC X.
  1597                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1598                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1599             20  CF-ST-REF-REJECT-SW        PIC X.
  1600                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1601                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1602         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1603         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1604         16  CF-ST-REFUND-RULES.
  1605             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1606             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1607             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1608         16  CF-ST-FST-PMT-EXTENSION.
  1609             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1610             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1611                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1612                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1613                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1614                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1615         16  CF-ST-STATE-CALL.
  1616             20  CF-ST-CALL-UNEARNED        PIC X.
  1617             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1618             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1619         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1620             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1621             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1622         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1623         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1624         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1625         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1626         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1627         16  FILLER                         PIC X.
  1628         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1629             20  CF-ST-BENEFIT-CD           PIC XX.
  1630             20  CF-ST-BENEFIT-KIND         PIC X.
  1631                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1632                 88  CF-ST-AH-KIND              VALUE 'A'.
  1633             20  CF-ST-REM-TERM-CALC        PIC X.
  1634                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1635                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1636                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1637                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1638                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1639                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1640                 88  ST-EARN-AFTER-14TH         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  30
* SOCK00.cbl
  1641                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1642
  1643             20  CF-ST-REFUND-CALC          PIC X.
  1644                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1645                 88  ST-REFD-BY-R78             VALUE '1'.
  1646                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1647                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1648                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1649                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1650                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1651                 88  ST-REFD-UTAH               VALUE '7'.
  1652                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1653                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1654                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1655
  1656             20  CF-ST-EARNING-CALC         PIC X.
  1657                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1658                 88  ST-EARN-BY-R78             VALUE '1'.
  1659                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1660                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1661                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1662                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1663                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1664                 88  ST-EARN-MEAN               VALUE '8'.
  1665                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1666
  1667             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1668                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1669                 88  ST-OVRD-BY-R78             VALUE '1'.
  1670                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1671                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1672                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1673                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1674                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1675                 88  ST-OVRD-MEAN               VALUE '8'.
  1676                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1677             20  FILLER                     PIC X.
  1678
  1679         16  CF-ST-COMMISSION-CAPS.
  1680             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1681             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1682             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1683             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1684         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1685                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1686
  1687         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1688
  1689         16  CF-ST-STATUTORY-INTEREST.
  1690             20  CF-ST-STAT-DATE-FROM       PIC X.
  1691                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1692                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1693             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1694             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1695             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1696             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1697             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1698
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  31
* SOCK00.cbl
  1699         16  CF-ST-OVER-SHORT.
  1700             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1701             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1702
  1703         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1704
  1705         16  CF-ST-RT-CALC                  PIC X.
  1706
  1707         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1708         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1709         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1710         16  CF-ST-RF-LR-CALC               PIC X.
  1711         16  CF-ST-RF-LL-CALC               PIC X.
  1712         16  CF-ST-RF-LN-CALC               PIC X.
  1713         16  CF-ST-RF-AH-CALC               PIC X.
  1714         16  CF-ST-RF-CP-CALC               PIC X.
  1715*        16  FILLER                         PIC X(206).
  1716*CIDMOD         16  FILLER                         PIC X(192).
  1717         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1718             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1719         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1720         16  FILLER                         PIC X(187).
  1721
  1722****************************************************************
  1723*             BENEFIT MASTER RECORD                            *
  1724****************************************************************
  1725
  1726     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1727         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1728             20  CF-BENEFIT-CODE            PIC XX.
  1729             20  CF-BENEFIT-NUMERIC  REDEFINES
  1730                 CF-BENEFIT-CODE            PIC XX.
  1731             20  CF-BENEFIT-ALPHA           PIC XXX.
  1732             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1733             20  CF-BENEFIT-COMMENT         PIC X(10).
  1734
  1735             20  CF-LF-COVERAGE-TYPE        PIC X.
  1736                 88  CF-REDUCING                VALUE 'R'.
  1737                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1738
  1739             20  CF-SPECIAL-CALC-CD         PIC X.
  1740                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1741                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1742                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1743                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1744                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1745                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1746                 88  CF-FARM-PLAN               VALUE 'F'.
  1747                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1748                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1749                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1750                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1751                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1752                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1753                 88  CF-PRUDENTIAL              VALUE 'P'.
  1754                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1755                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1756                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  32
* SOCK00.cbl
  1757                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1758                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1759                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1760
  1761             20  CF-JOINT-INDICATOR         PIC X.
  1762                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1763
  1764*            20  FILLER                     PIC X(12).
  1765             20  FILLER                     PIC X(11).
  1766             20  CF-BENEFIT-CATEGORY        PIC X.
  1767             20  CF-LOAN-TYPE               PIC X(8).
  1768
  1769             20  CF-CO-REM-TERM-CALC        PIC X.
  1770                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1771                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1772                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1773                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1774                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1775
  1776             20  CF-CO-EARNINGS-CALC        PIC X.
  1777                 88  CO-EARN-BY-R78             VALUE '1'.
  1778                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1779                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1780                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1781                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1782                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1783                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1784                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1785
  1786             20  CF-CO-REFUND-CALC          PIC X.
  1787                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1788                 88  CO-REFD-BY-R78             VALUE '1'.
  1789                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1790                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1791                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1792                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1793                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1794                 88  CO-REFD-MEAN               VALUE '8'.
  1795                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1796                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1797                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1798
  1799             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1800                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1801                 88  CO-OVRD-BY-R78             VALUE '1'.
  1802                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1803                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1804                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1805                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1806                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1807                 88  CO-OVRD-MEAN               VALUE '8'.
  1808                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1809
  1810             20  CF-CO-BEN-I-G-CD           PIC X.
  1811                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1812                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1813                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1814
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  33
* SOCK00.cbl
  1815         16  FILLER                         PIC X(304).
  1816
  1817
  1818****************************************************************
  1819*             CARRIER MASTER RECORD                            *
  1820****************************************************************
  1821
  1822     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1823         16  CF-ADDRESS-DATA.
  1824             20  CF-MAIL-TO-NAME            PIC X(30).
  1825             20  CF-IN-CARE-OF              PIC X(30).
  1826             20  CF-ADDRESS-LINE-1          PIC X(30).
  1827             20  CF-ADDRESS-LINE-2          PIC X(30).
  1828             20  CF-CITY-STATE              PIC X(30).
  1829             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1830             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1831
  1832         16  CF-CLAIM-NO-CONTROL.
  1833             20  CF-CLAIM-NO-METHOD         PIC X.
  1834                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1835                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1836                 88  CLAIM-NO-SEQ               VALUE '3'.
  1837                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1838             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1839                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1840                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1841                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1842
  1843         16  CF-CHECK-NO-CONTROL.
  1844             20  CF-CHECK-NO-METHOD         PIC X.
  1845                 88  CHECK-NO-MANUAL            VALUE '1'.
  1846                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1847                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1848                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1849             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1850                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1851
  1852         16  CF-DOMICILE-STATE              PIC XX.
  1853
  1854         16  CF-EXPENSE-CONTROLS.
  1855             20  CF-EXPENSE-METHOD          PIC X.
  1856                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1857                 88  DOLLARS-PER-PMT            VALUE '2'.
  1858                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1859                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1860             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1861             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1862
  1863         16  CF-CORRESPONDENCE-CONTROL.
  1864             20  CF-LETTER-RESEND-OPT       PIC X.
  1865                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1866                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1867             20  FILLER                     PIC X(4).
  1868
  1869         16  CF-RESERVE-CONTROLS.
  1870             20  CF-MANUAL-SW               PIC X.
  1871                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1872             20  CF-FUTURE-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  34
* SOCK00.cbl
  1873                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1874             20  CF-PTC-SW                  PIC X.
  1875                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1876             20  CF-IBNR-SW                 PIC X.
  1877                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1878             20  CF-PTC-LF-SW               PIC X.
  1879                 88  CF-LF-PTC-USED             VALUE '1'.
  1880             20  CF-CDT-ACCESS-METHOD       PIC X.
  1881                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1882                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1883                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1884             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1885
  1886         16  CF-CLAIM-CALC-METHOD           PIC X.
  1887             88  360-PLUS-MONTHS                VALUE '1'.
  1888             88  365-PLUS-MONTHS                VALUE '2'.
  1889             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1890             88  360-DAILY                      VALUE '4'.
  1891             88  365-DAILY                      VALUE '5'.
  1892
  1893         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1894         16  FILLER                         PIC X(11).
  1895
  1896         16  CF-LIMIT-AMOUNTS.
  1897             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1898             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1899             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1900             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1901             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1902             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1903             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1904             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1905             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1906             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1907
  1908         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1909         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1910         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1911
  1912         16  CF-ZIP-CODE.
  1913             20  CF-ZIP-PRIME.
  1914                 24  CF-ZIP-1ST             PIC X.
  1915                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1916                 24  FILLER                 PIC X(4).
  1917             20  CF-ZIP-PLUS4               PIC X(4).
  1918         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1919             20  CF-CAN-POSTAL-1            PIC XXX.
  1920             20  CF-CAN-POSTAL-2            PIC XXX.
  1921             20  FILLER                     PIC XXX.
  1922
  1923         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1924         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1925         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1926
  1927         16  CF-RATING-SWITCH               PIC X.
  1928             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1929             88  CF-NO-RATING                   VALUE 'N'.
  1930
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  35
* SOCK00.cbl
  1931         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1932
  1933         16  CF-CARRIER-OVER-SHORT.
  1934             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1935             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1936
  1937         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1938         16  CF-SECPAY-SWITCH               PIC X.
  1939             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1940             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1941         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1942         16  FILLER                         PIC X(448).
  1943*        16  FILLER                         PIC X(452).
  1944
  1945
  1946****************************************************************
  1947*             MORTALITY MASTER RECORD                          *
  1948****************************************************************
  1949
  1950     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1951         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1952                                INDEXED BY CF-MORT-NDX.
  1953             20  CF-MORT-TABLE              PIC X(5).
  1954             20  CF-MORT-TABLE-TYPE         PIC X.
  1955                 88  CF-MORT-JOINT              VALUE 'J'.
  1956                 88  CF-MORT-SINGLE             VALUE 'S'.
  1957                 88  CF-MORT-COMBINED           VALUE 'C'.
  1958                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1959                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1960             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1961             20  CF-MORT-AGE-METHOD         PIC XX.
  1962                 88  CF-AGE-LAST                VALUE 'AL'.
  1963                 88  CF-AGE-NEAR                VALUE 'AN'.
  1964             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1965             20  CF-MORT-ADJUSTMENT-DIRECTION
  1966                                            PIC X.
  1967                 88  CF-MINUS                   VALUE '-'.
  1968                 88  CF-PLUS                    VALUE '+'.
  1969             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1970             20  CF-MORT-JOINT-CODE         PIC X.
  1971                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1972             20  CF-MORT-PC-Q               PIC X.
  1973                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1974             20  CF-MORT-TABLE-CODE         PIC X(4).
  1975             20  CF-MORT-COMMENTS           PIC X(15).
  1976             20  FILLER                     PIC X(14).
  1977
  1978         16  FILLER                         PIC X(251).
  1979
  1980
  1981****************************************************************
  1982*             BUSSINESS TYPE MASTER RECORD                     *
  1983****************************************************************
  1984
  1985     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1986* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1987* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1988* AND RECORD 05 IS TYPES 81-99
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  36
* SOCK00.cbl
  1989         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1990             20  CF-BUSINESS-TITLE          PIC  X(19).
  1991             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1992                                            PIC S9V9(4) COMP-3.
  1993             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1994             20  FILLER                     PIC  X.
  1995         16  FILLER                         PIC  X(248).
  1996
  1997
  1998****************************************************************
  1999*             TERMINAL MASTER RECORD                           *
  2000****************************************************************
  2001
  2002     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2003
  2004         16  CF-COMPANY-TERMINALS.
  2005             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2006                                  PIC X(4).
  2007         16  FILLER               PIC X(248).
  2008
  2009
  2010****************************************************************
  2011*             LIFE EDIT MASTER RECORD                          *
  2012****************************************************************
  2013
  2014     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2015         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2016             20  CF-LIFE-CODE-IN            PIC XX.
  2017             20  CF-LIFE-CODE-OUT           PIC XX.
  2018         16  FILLER                         PIC X(248).
  2019
  2020
  2021****************************************************************
  2022*             AH EDIT MASTER RECORD                            *
  2023****************************************************************
  2024
  2025     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2026         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2027             20  CF-AH-CODE-IN              PIC XXX.
  2028             20  CF-AH-CODE-OUT             PIC XX.
  2029         16  FILLER                         PIC X(248).
  2030
  2031
  2032****************************************************************
  2033*             CREDIBILITY TABLES                               *
  2034****************************************************************
  2035
  2036     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2037         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2038                             INDEXED BY CF-CRDB-NDX.
  2039             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2040             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2041             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2042         16  FILLER                         PIC  X(332).
  2043
  2044
  2045****************************************************************
  2046*             REPORT CUSTOMIZATION RECORD                      *
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  37
* SOCK00.cbl
  2047****************************************************************
  2048
  2049     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2050         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2051             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2052             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2053             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2054**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2055****       A T-TRANSFER.                                   ****
  2056             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2057
  2058         16  FILLER                         PIC XX.
  2059
  2060         16  CF-CARRIER-CNTL-OPT.
  2061             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2062                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2063                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2064             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2065                                            PIC X.
  2066         16  CF-GROUP-CNTL-OPT.
  2067             20  CF-GROUP-OPT-SEQ           PIC 9.
  2068                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2069                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2070             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2071                                            PIC X(6).
  2072         16  CF-STATE-CNTL-OPT.
  2073             20  CF-STATE-OPT-SEQ           PIC 9.
  2074                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2075                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2076             20  CF-STATE-SELECT OCCURS 3 TIMES
  2077                                            PIC XX.
  2078         16  CF-ACCOUNT-CNTL-OPT.
  2079             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2080                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2081                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2082             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2083                                            PIC X(10).
  2084         16  CF-BUS-TYP-CNTL-OPT.
  2085             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2086                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2087                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2088             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2089                                            PIC XX.
  2090         16  CF-LF-TYP-CNTL-OPT.
  2091             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2092                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2093                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2094             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2095                                            PIC XX.
  2096         16  CF-AH-TYP-CNTL-OPT.
  2097             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2098                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2099                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2100             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2101                                            PIC XX.
  2102         16  CF-REPTCD1-CNTL-OPT.
  2103             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2104                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  38
* SOCK00.cbl
  2105                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2106             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2107                                            PIC X(10).
  2108         16  CF-REPTCD2-CNTL-OPT.
  2109             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2110                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2111                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2112             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2113                                            PIC X(10).
  2114         16  CF-USER1-CNTL-OPT.
  2115             20  CF-USER1-OPT-SEQ           PIC 9.
  2116                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2117                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2118             20  CF-USER1-SELECT OCCURS 3 TIMES
  2119                                            PIC X(10).
  2120         16  CF-USER2-CNTL-OPT.
  2121             20  CF-USER2-OPT-SEQ           PIC 9.
  2122                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2123                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2124             20  CF-USER2-SELECT OCCURS 3 TIMES
  2125                                            PIC X(10).
  2126         16  CF-USER3-CNTL-OPT.
  2127             20  CF-USER3-OPT-SEQ           PIC 9.
  2128                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2129                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2130             20  CF-USER3-SELECT OCCURS 3 TIMES
  2131                                            PIC X(10).
  2132         16  CF-USER4-CNTL-OPT.
  2133             20  CF-USER4-OPT-SEQ           PIC 9.
  2134                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2135                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2136             20  CF-USER4-SELECT OCCURS 3 TIMES
  2137                                            PIC X(10).
  2138         16  CF-USER5-CNTL-OPT.
  2139             20  CF-USER5-OPT-SEQ           PIC 9.
  2140                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2141                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2142             20  CF-USER5-SELECT OCCURS 3 TIMES
  2143                                            PIC X(10).
  2144         16  CF-REINS-CNTL-OPT.
  2145             20  CF-REINS-OPT-SEQ           PIC 9.
  2146                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2147                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2148             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2149                 24  CF-REINS-PRIME         PIC XXX.
  2150                 24  CF-REINS-SUB           PIC XXX.
  2151
  2152         16  CF-AGENT-CNTL-OPT.
  2153             20  CF-AGENT-OPT-SEQ           PIC 9.
  2154                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2155                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2156             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2157                                            PIC X(10).
  2158
  2159         16  FILLER                         PIC X(43).
  2160
  2161         16  CF-LOSS-RATIO-SELECT.
  2162             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  39
* SOCK00.cbl
  2163             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2164         16  CF-ENTRY-DATE-SELECT.
  2165             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2166             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2167         16  CF-EFFECTIVE-DATE-SELECT.
  2168             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2169             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2170
  2171         16  CF-EXCEPTION-LIST-IND          PIC X.
  2172             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2173
  2174         16  FILLER                         PIC X(318).
  2175
  2176****************************************************************
  2177*                  EXCEPTION REPORTING RECORD                  *
  2178****************************************************************
  2179
  2180     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2181         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2182             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2183
  2184         16  CF-COMBINED-LIFE-AH-OPT.
  2185             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2186             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2187             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2188             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2189
  2190         16  CF-LIFE-OPT.
  2191             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2192             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2193             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2194             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2195             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2196             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2197             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2198             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2199             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2200             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2201
  2202         16  CF-AH-OPT.
  2203             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2204             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2205             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2206             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2207             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2208             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2209             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2210             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2211             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2212             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2213
  2214         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2215             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2216             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2217             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2218
  2219         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2220
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  40
* SOCK00.cbl
  2221         16  FILLER                         PIC X(673).
  2222
  2223
  2224****************************************************************
  2225*             MORTGAGE SYSTEM PLAN RECORD                      *
  2226****************************************************************
  2227
  2228     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2229         16  CF-PLAN-TYPE                   PIC X.
  2230             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2231             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2232             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2233         16  CF-PLAN-ABBREV                 PIC XXX.
  2234         16  CF-PLAN-DESCRIPT               PIC X(10).
  2235         16  CF-PLAN-NOTES                  PIC X(20).
  2236         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2237         16  CF-PLAN-UNDERWRITING.
  2238             20  CF-PLAN-TERM-DATA.
  2239                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2240                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2241             20  CF-PLAN-AGE-DATA.
  2242                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2243                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2244                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2245             20  CF-PLAN-BENEFIT-DATA.
  2246                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2247                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2248                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2249                                            PIC S9(7)V99  COMP-3.
  2250         16  CF-PLAN-POLICY-FORMS.
  2251             20  CF-POLICY-FORM             PIC X(12).
  2252             20  CF-MASTER-APPLICATION      PIC X(12).
  2253             20  CF-MASTER-POLICY           PIC X(12).
  2254         16  CF-PLAN-RATING.
  2255             20  CF-RATE-CODE               PIC X(5).
  2256             20  CF-SEX-RATING              PIC X.
  2257                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2258                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2259             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2260             20  CF-SUB-STD-TYPE            PIC X.
  2261                 88  CF-PCT-OF-PREM            VALUE '1'.
  2262                 88  CF-PCT-OF-BENE            VALUE '2'.
  2263         16  CF-PLAN-PREM-TOLERANCES.
  2264             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2265             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2266         16  CF-PLAN-PYMT-TOLERANCES.
  2267             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2268             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2269         16  CF-PLAN-MISC-DATA.
  2270             20  FILLER                     PIC X.
  2271             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2272             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2273         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2274         16  CF-PLAN-IND-GRP                PIC X.
  2275             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2276                                                     '1'.
  2277             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2278                                                     '2'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  41
* SOCK00.cbl
  2279         16  CF-MIB-SEARCH-SW               PIC X.
  2280             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2281             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2282             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2283             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2284         16  CF-ALPHA-SEARCH-SW             PIC X.
  2285             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2286             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2287             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2288             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2289             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2290             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2291             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2292             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2293             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2294             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2295                                                     'A' 'B' 'C'
  2296                                                     'X' 'Y' 'Z'.
  2297         16  CF-EFF-DT-RULE-SW              PIC X.
  2298             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2299             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2300             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2301             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2302             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2303         16  FILLER                         PIC X(4).
  2304         16  CF-HEALTH-QUESTIONS            PIC X.
  2305             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2306         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2307         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2308         16  CF-PLAN-SNGL-JNT               PIC X.
  2309             88  CF-COMBINED-PLAN              VALUE 'C'.
  2310             88  CF-JNT-PLAN                   VALUE 'J'.
  2311             88  CF-SNGL-PLAN                  VALUE 'S'.
  2312         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2313         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2314         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2315         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2316         16  CF-RERATE-CNTL                 PIC  X.
  2317             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2318             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2319             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2320             88  CF-AUTO-RECALC                 VALUE '4'.
  2321         16  CF-BENEFIT-TYPE                PIC  X.
  2322             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2323             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2324         16  CF-POLICY-FEE                  PIC S999V99
  2325                                                    COMP-3.
  2326         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2327         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2328         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2329         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2330         16  FILLER                         PIC  X(32).
  2331         16  CF-TERMINATION-FORM            PIC  X(04).
  2332         16  FILLER                         PIC  X(08).
  2333         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2334                                                       COMP-3.
  2335         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2336         16  CF-ISSUE-LETTER                PIC  X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  42
* SOCK00.cbl
  2337         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2338         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2339             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2340             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2341         16  CF-MP-REFUND-CALC              PIC X.
  2342             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2343             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2344             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2345             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2346             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2347             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2348             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2349             88  CF-MP-REFD-MEAN                VALUE '8'.
  2350         16  CF-ALT-RATE-CODE               PIC  X(5).
  2351
  2352
  2353         16  FILLER                         PIC X(498).
  2354****************************************************************
  2355*             MORTGAGE COMPANY MASTER RECORD                   *
  2356****************************************************************
  2357
  2358     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2359         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2360         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2361             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2362             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2363             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2364             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2365             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2366
  2367         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2368         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2369         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2370         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2371         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2372
  2373         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2374             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2375         16  CF-MP-RECON-USE-IND            PIC X(1).
  2376             88  CF-MP-USE-RECON             VALUE 'Y'.
  2377         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2378             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2379         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2380             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2381             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2382         16  FILLER                         PIC X(1).
  2383         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2384             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2385         16  CF-MORTG-MIB-VERSION           PIC X.
  2386             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2387             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2388             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2389         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2390             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2391                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2392             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2393                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2394             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  43
* SOCK00.cbl
  2395                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2396             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2397                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2398             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2399                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2400             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2401                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2402         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2403         16  FILLER                         PIC X(7).
  2404         16  CF-MORTG-DESTINATION-SYMBOL.
  2405             20  CF-MORTG-MIB-COMM          PIC X(5).
  2406             20  CF-MORTG-MIB-TERM          PIC X(5).
  2407         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2408             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2409         16  FILLER                         PIC X(03).
  2410         16  CF-MP-CHECK-NO-CONTROL.
  2411             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2412                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2413                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2414                                                ' ' LOW-VALUES.
  2415                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2416                                               VALUE '3'.
  2417         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2418         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2419         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2420             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2421                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2422             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2423                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2424             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2425                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2426             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2427                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2428             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2429                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2430             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2431                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2432         16  CF-MORTG-BILLING-AREA.
  2433             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2434                                            PIC X.
  2435         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2436         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2437         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2438         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2439             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2440             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2441         16  FILLER                         PIC X.
  2442         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2443             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2444             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2445         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2446         16  FILLER                         PIC X(8).
  2447         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2448         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2449         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2450         16  CF-ACH-COMPANY-ID.
  2451             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2452                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  44
* SOCK00.cbl
  2453                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2454                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2455             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2456         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2457             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2458         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2459             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2460             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2461         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2462         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2463         16  FILLER                         PIC X(536).
  2464
  2465****************************************************************
  2466*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2467****************************************************************
  2468
  2469     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2470         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2471             20  CF-FEMALE-HEIGHT.
  2472                 24  CF-FEMALE-FT           PIC 99.
  2473                 24  CF-FEMALE-IN           PIC 99.
  2474             20  CF-FEMALE-MIN-WT           PIC 999.
  2475             20  CF-FEMALE-MAX-WT           PIC 999.
  2476         16  FILLER                         PIC X(428).
  2477
  2478     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2479         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2480             20  CF-MALE-HEIGHT.
  2481                 24  CF-MALE-FT             PIC 99.
  2482                 24  CF-MALE-IN             PIC 99.
  2483             20  CF-MALE-MIN-WT             PIC 999.
  2484             20  CF-MALE-MAX-WT             PIC 999.
  2485         16  FILLER                         PIC X(428).
  2486******************************************************************
  2487*             AUTOMATIC ACTIVITY RECORD                          *
  2488******************************************************************
  2489     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2490         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2491             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2492             20  CF-SYS-LETTER-ID           PIC X(04).
  2493             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2494             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2495             20  CF-SYS-RESET-SW            PIC X(01).
  2496             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2497             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2498
  2499         16  FILLER                         PIC X(50).
  2500
  2501         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2502             20  CF-USER-ACTIVE-SW          PIC X(01).
  2503             20  CF-USER-LETTER-ID          PIC X(04).
  2504             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2505             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2506             20  CF-USER-RESET-SW           PIC X(01).
  2507             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2508             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2509             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2510
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  45
* SOCK00.cbl
  2511         16  FILLER                         PIC X(246).
  2512*                                 COPY ERCCTBL.
  2513******************************************************************
  2514*                                                                *
  2515*                                                                *
  2516*                            ERCCTBL                             *
  2517*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2518*                            VMOD=2.003
  2519*                                                                *
  2520*   ONLINE CREDIT SYSTEM                                         *
  2521*                                                                *
  2522*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2523*                                                                *
  2524*   FILE TYPE = VSAM,KSDS                                        *
  2525*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2526*                                                                *
  2527*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2528*       ALTERNATE PATH = NONE                                    *
  2529*                                                                *
  2530*   LOG = NO                                                     *
  2531*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2532*                                                                *
  2533*                                                                *
  2534******************************************************************
  2535
  2536 01  COMM-TABLE-RECORD.
  2537     12  CT-RECORD-ID                      PIC XX.
  2538         88  VALID-CT-ID                      VALUE 'CT'.
  2539
  2540     12  CT-CONTROL-PRIMARY.
  2541         16  CT-COMPANY-CD                 PIC X.
  2542         16  CT-TABLE                      PIC XXX.
  2543         16  CT-CNTRL-2.
  2544             20  CT-BEN-TYPE               PIC X.
  2545             20  CT-BEN-CODE               PIC XX.
  2546
  2547     12  CT-MAINT-INFORMATION.
  2548         16  CT-LAST-MAINT-DT              PIC XX.
  2549         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2550         16  CT-LAST-MAINT-USER            PIC X(4).
  2551         16  FILLER                        PIC X(31).
  2552
  2553     12  CT-LIMITS.
  2554         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2555
  2556         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2557
  2558         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2559
  2560     12  CT-RATES.
  2561         16  CT-RTX          OCCURS 27 TIMES.
  2562             20  CT-RT                     PIC SV9(5)     COMP-3.
  2563             20  CT-RT-R   REDEFINES
  2564                 CT-RT                     PIC XXX.
  2565
  2566     12  FILLER                            PIC  X(42).
  2567
  2568******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  46
* SOCK00.cbl
  2569*                                 COPY ELCDATE.
  2570******************************************************************
  2571*                                                                *
  2572*                                                                *
  2573*                            ELCDATE.                            *
  2574*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2575*                            VMOD=2.003
  2576*                                                                *
  2577*                                                                *
  2578*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2579*                 LENGTH = 200                                   *
  2580******************************************************************
  2581
  2582 01  DATE-CONVERSION-DATA.
  2583     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2584     12  DC-OPTION-CODE                PIC X.
  2585         88  BIN-TO-GREG                VALUE ' '.
  2586         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2587         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2588         88  YMD-GREG-TO-BIN            VALUE '3'.
  2589         88  MDY-GREG-TO-BIN            VALUE '4'.
  2590         88  JULIAN-TO-BIN              VALUE '5'.
  2591         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2592         88  FIND-CENTURY               VALUE '7'.
  2593         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2594         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2595         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2596         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2597         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2598         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2599         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2600         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2601         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2602         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2603         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2604         88  BIN-3-TO-GREG              VALUE 'I'.
  2605         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2606         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2607         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2608         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2609         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2610         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2611         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2612         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2613         88  THREE-CHARACTER-BIN
  2614                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2615         88  GREGORIAN-TO-BIN
  2616                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2617         88  BIN-TO-GREGORIAN
  2618                  VALUES ' ' '1' 'I' '8' 'G'.
  2619         88  JULIAN-TO-BINARY
  2620                  VALUES '5' 'C' 'E' 'F'.
  2621     12  DC-ERROR-CODE                 PIC X.
  2622         88  NO-CONVERSION-ERROR        VALUE ' '.
  2623         88  DATE-CONVERSION-ERROR
  2624                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2625         88  DATE-IS-ZERO               VALUE '1'.
  2626         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  47
* SOCK00.cbl
  2627         88  DATE-IS-INVALID            VALUE '3'.
  2628         88  DATE1-GREATER-DATE2        VALUE '4'.
  2629         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2630         88  DATE-INVALID-OPTION        VALUE '9'.
  2631         88  INVALID-CENTURY            VALUE 'A'.
  2632         88  ONLY-CENTURY               VALUE 'B'.
  2633         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2634         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2635     12  DC-END-OF-MONTH               PIC X.
  2636         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2637     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2638         88  USE-NORMAL-PROCESS         VALUE ' '.
  2639         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2640         88  ADJUST-UP-100-YRS          VALUE '2'.
  2641     12  FILLER                        PIC X.
  2642     12  DC-CONVERSION-DATES.
  2643         16  DC-BIN-DATE-1             PIC XX.
  2644         16  DC-BIN-DATE-2             PIC XX.
  2645         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2646         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2647                       DC-GREG-DATE-1-EDIT.
  2648             20  DC-EDIT1-MONTH        PIC 99.
  2649             20  SLASH1-1              PIC X.
  2650             20  DC-EDIT1-DAY          PIC 99.
  2651             20  SLASH1-2              PIC X.
  2652             20  DC-EDIT1-YEAR         PIC 99.
  2653         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2654         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2655                     DC-GREG-DATE-2-EDIT.
  2656             20  DC-EDIT2-MONTH        PIC 99.
  2657             20  SLASH2-1              PIC X.
  2658             20  DC-EDIT2-DAY          PIC 99.
  2659             20  SLASH2-2              PIC X.
  2660             20  DC-EDIT2-YEAR         PIC 99.
  2661         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2662         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2663                     DC-GREG-DATE-1-YMD.
  2664             20  DC-YMD-YEAR           PIC 99.
  2665             20  DC-YMD-MONTH          PIC 99.
  2666             20  DC-YMD-DAY            PIC 99.
  2667         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2668         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2669                      DC-GREG-DATE-1-MDY.
  2670             20  DC-MDY-MONTH          PIC 99.
  2671             20  DC-MDY-DAY            PIC 99.
  2672             20  DC-MDY-YEAR           PIC 99.
  2673         16  DC-GREG-DATE-1-ALPHA.
  2674             20  DC-ALPHA-MONTH        PIC X(10).
  2675             20  DC-ALPHA-DAY          PIC 99.
  2676             20  FILLER                PIC XX.
  2677             20  DC-ALPHA-CENTURY.
  2678                 24 DC-ALPHA-CEN-N     PIC 99.
  2679             20  DC-ALPHA-YEAR         PIC 99.
  2680         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2681         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2682         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2683         16  DC-JULIAN-DATE            PIC 9(05).
  2684         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  48
* SOCK00.cbl
  2685                                       PIC 9(05).
  2686         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2687             20  DC-JULIAN-YEAR        PIC 99.
  2688             20  DC-JULIAN-DAYS        PIC 999.
  2689         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2690         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2691         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2692     12  DATE-CONVERSION-VARIBLES.
  2693         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2694         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2695             20  FILLER                PIC 9(3).
  2696             20  HOLD-CEN-1-CCYY.
  2697                 24  HOLD-CEN-1-CC     PIC 99.
  2698                 24  HOLD-CEN-1-YY     PIC 99.
  2699             20  HOLD-CEN-1-MO         PIC 99.
  2700             20  HOLD-CEN-1-DA         PIC 99.
  2701         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2702             20  HOLD-CEN-1-R-MO       PIC 99.
  2703             20  HOLD-CEN-1-R-DA       PIC 99.
  2704             20  HOLD-CEN-1-R-CCYY.
  2705                 24  HOLD-CEN-1-R-CC   PIC 99.
  2706                 24  HOLD-CEN-1-R-YY   PIC 99.
  2707             20  FILLER                PIC 9(3).
  2708         16  HOLD-CENTURY-1-X.
  2709             20  FILLER                PIC X(3)  VALUE SPACES.
  2710             20  HOLD-CEN-1-X-CCYY.
  2711                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2712                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2713             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2714             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2715         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2716             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2717             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2718             20  HOLD-CEN-1-R-X-CCYY.
  2719                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2720                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2721             20  FILLER                PIC XXX.
  2722         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2723         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2724         16  DC-JULIAN-DATE-1          PIC 9(07).
  2725         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2726             20  DC-JULIAN-1-CCYY.
  2727                 24  DC-JULIAN-1-CC    PIC 99.
  2728                 24  DC-JULIAN-1-YR    PIC 99.
  2729             20  DC-JULIAN-DA-1        PIC 999.
  2730         16  DC-JULIAN-DATE-2          PIC 9(07).
  2731         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2732             20  DC-JULIAN-2-CCYY.
  2733                 24  DC-JULIAN-2-CC    PIC 99.
  2734                 24  DC-JULIAN-2-YR    PIC 99.
  2735             20  DC-JULIAN-DA-2        PIC 999.
  2736         16  DC-GREG-DATE-A-EDIT.
  2737             20  DC-EDITA-MONTH        PIC 99.
  2738             20  SLASHA-1              PIC X VALUE '/'.
  2739             20  DC-EDITA-DAY          PIC 99.
  2740             20  SLASHA-2              PIC X VALUE '/'.
  2741             20  DC-EDITA-CCYY.
  2742                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  49
* SOCK00.cbl
  2743                 24  DC-EDITA-YEAR     PIC 99.
  2744         16  DC-GREG-DATE-B-EDIT.
  2745             20  DC-EDITB-MONTH        PIC 99.
  2746             20  SLASHB-1              PIC X VALUE '/'.
  2747             20  DC-EDITB-DAY          PIC 99.
  2748             20  SLASHB-2              PIC X VALUE '/'.
  2749             20  DC-EDITB-CCYY.
  2750                 24  DC-EDITB-CENT     PIC 99.
  2751                 24  DC-EDITB-YEAR     PIC 99.
  2752         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2753         16  DC-GREG-DATE-CYMD-R REDEFINES
  2754                              DC-GREG-DATE-CYMD.
  2755             20  DC-CYMD-CEN           PIC 99.
  2756             20  DC-CYMD-YEAR          PIC 99.
  2757             20  DC-CYMD-MONTH         PIC 99.
  2758             20  DC-CYMD-DAY           PIC 99.
  2759         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2760         16  DC-GREG-DATE-MDCY-R REDEFINES
  2761                              DC-GREG-DATE-MDCY.
  2762             20  DC-MDCY-MONTH         PIC 99.
  2763             20  DC-MDCY-DAY           PIC 99.
  2764             20  DC-MDCY-CEN           PIC 99.
  2765             20  DC-MDCY-YEAR          PIC 99.
  2766    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2767        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2768    12  DC-EL310-DATE                  PIC X(21).
  2769    12  FILLER                         PIC X(28).
  2770*                                 COPY ELCCALC.
  2771******************************************************************
  2772*                                                                *
  2773*                           ELCCALC.                            *
  2774*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2775*                            VMOD=2.025                          *
  2776*                                                                *
  2777*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2778*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2779*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2780*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2781*                                                                *
  2782*  PASSED TO ELRTRM                                              *
  2783*  -----------------                                             *
  2784*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2785*  ORIGINAL TERM                                                 *
  2786*  BEGINNING DATE                                                *
  2787*  ENDING DATE                                                   *
  2788*  COMPANY I.D.                                                  *
  2789*  ACCOUNT MASTER USER FIELD                                     *
  2790*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2791*  FREE LOOK DAYS                                                *
  2792*                                                                *
  2793*  RETURNED FROM ELRTRM                                          *
  2794*  ---------------------                                         *
  2795*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2796*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2797*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2798*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2799*----------------------------------------------------------------*
  2800*  PASSED TO ELRAMT                                              *
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  50
* SOCK00.cbl
  2801*  ----------------                                              *
  2802*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2803*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2804*  ORIGINAL AMOUNT                                               *
  2805*  ALTERNATE BENEFIT (BALLON)                                    *
  2806*  A.P.R. - NET PAY ONLY                                         *
  2807*  METHOD
  2808*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2809*  COMPANY I.D.                                                  *
  2810*  BENEFIT TYPE                                                  *
  2811*                                                                *
  2812*  RETURNED FROM ELRAMT                                          *
  2813*  --------------------                                          *
  2814*  REMAINING AMOUNT 1 - CURRENT                                  *
  2815*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2816*  REMAINING AMOUNT FACTOR
  2817*----------------------------------------------------------------*
  2818*  PASSED TO ELRESV                                              *
  2819*  -----------------                                             *
  2820*  CERTIFICATE EFFECTIVE DATE                                    *
  2821*  VALUATION DATE                                                *
  2822*  PAID THRU DATE                                                *
  2823*  BENEFIT                                                       *
  2824*  INCURRED DATE                                                 *
  2825*  REPORTED DATE                                                 *
  2826*  ISSUE AGE                                                     *
  2827*  TERM                                                          *
  2828*  CDT PERCENT                                                   *
  2829*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2830* *CLAIM TYPE (LIFE, A/H)                                        *
  2831* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2832* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2833*                                                                *
  2834*  RETURNED FROM ELRESV                                          *
  2835*  --------------------                                          *
  2836*  CDT TABLE USED                                                *
  2837*  CDT FACTOR USED                                               *
  2838*  PAY TO CURRENT RESERVE                                        *
  2839*  I.B.N.R. - A/H ONLY                                           *
  2840*  FUTURE (ACCRUED) AH ONLY                                      *
  2841*----------------------------------------------------------------*
  2842*  PASSED TO ELRATE                                              *
  2843*  ----------------                                              *
  2844*  CERT ISSUE DATE                                               *
  2845*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2846*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2847*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2848*  STATE CODE (CLIENT DEFINED)                                   *
  2849*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2850*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2851*  DEVIATION CODE                                                *
  2852*  ISSUE AGE                                                     *
  2853*  ORIGINAL BENEFIT AMOUNT                                       *
  2854*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2855*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2856*  BENEFIT KIND (LIFE OR A/H)                                    *
  2857*  A.P.R.                                                        *
  2858*  METHOD
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  51
* SOCK00.cbl
  2859*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2860*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2861*  COMPANY I.D. (3 CHARACTER)                                    *
  2862*  BENEFIT CODE                                                  *
  2863*  BENEFIT OVERRIDE CODE                                         *
  2864*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2865*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2866*  JOINT INDICATOR (CSL ONLY)                                    *
  2867*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2868*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2869*                                                                *
  2870*  RETURNED FROM ELRATE                                          *
  2871*  --------------------                                          *
  2872*  CALCULATED PREMIUM                                            *
  2873*  PREMIUM RATE                                                  *
  2874*  MORTALITY CODE                                                *
  2875*  MAX ATTAINED AGE                                              *
  2876*  MAX AGE                                                       *
  2877*  MAX TERM                                                      *
  2878*  MAX MONTHLY BENEFIT                                           *
  2879*  MAX TOTAL BENIFIT                                             *
  2880*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2881*----------------------------------------------------------------*
  2882*  PASSED TO ELRFND                                              *
  2883*  ----------------                                              *
  2884*  CERT ISSUE DATE                                               *
  2885*  REFUND DATE                                                   *
  2886*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2887*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2888*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2889*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2890*  STATE CODE (CLIENT DEFINED)                                   *
  2891*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2892*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2893*  DEVIATION CODE                                                *
  2894*  ISSUE AGE                                                     *
  2895*  ORIGINAL BENEFIT AMOUNT                                       *
  2896*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2897*  PROCESS TYPE (CANCEL)                                         *
  2898*  BENEFIT KIND (LIFE OR A/H)                                    *
  2899*  A.P.R.                                                        *
  2900*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2901*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2902*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2903*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2904*  COMPANY I.D. (3 CHARACTER)                                    *
  2905*  BENEFIT CODE                                                  *
  2906*  BENEFIT OVERRIDE CODE                                         *
  2907*                                                                *
  2908*  RETURNED FROM ELRFND                                          *
  2909*  --------------------                                          *
  2910*  CALCULATED REFUND                                             *
  2911*----------------------------------------------------------------*
  2912*  PASSED TO ELEARN                                              *
  2913*  ----------------                                              *
  2914*  CERT ISSUE DATE                                               *
  2915*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2916*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  52
* SOCK00.cbl
  2917*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2918*  STATE CODE (CLIENT DEFINED)                                   *
  2919*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2920*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2921*  DEVIATION CODE                                                *
  2922*  ISSUE AGE                                                     *
  2923*  ORIGINAL BENEFIT AMOUNT                                       *
  2924*  BENEFIT KIND (LIFE OR A/H)                                    *
  2925*  A.P.R.                                                        *
  2926*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2927*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2928*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2929*  COMPANY I.D. (3 CHARACTER)                                    *
  2930*  BENEFIT CODE                                                  *
  2931*  BENEFIT OVERRIDE CODE                                         *
  2932*                                                                *
  2933*  RETURNED FROM ELEARN                                          *
  2934*  --------------------                                          *
  2935*  INDICATED  EARNINGS                                           *
  2936*----------------------------------------------------------------*
  2937*                 LENGTH = 450                                   *
  2938*                                                                *
  2939******************************************************************
  2940******************************************************************
  2941*                   C H A N G E   L O G
  2942*
  2943* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2944*-----------------------------------------------------------------
  2945*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2946* EFFECTIVE    NUMBER
  2947*-----------------------------------------------------------------
  2948* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2949* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2950* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2951* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2952* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2953* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2954* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2955******************************************************************
  2956
  2957 01  CALCULATION-PASS-AREA.
  2958     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2959                                     COMP.
  2960
  2961     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2962       88  NO-CP-ERROR                             VALUE ZERO.
  2963       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2964                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2965       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2966       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2967       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2968       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2969       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2970       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2971       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2972       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2973       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2974       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  53
* SOCK00.cbl
  2975       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2976       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2977       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2978       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2979       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2980       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2981       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2982
  2983     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2984       88  NO-CP-ERROR-2                           VALUE ZERO.
  2985***********************  INPUT AREAS ****************************
  2986
  2987     12  CP-CALCULATION-AREA.
  2988         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2989         16  CP-CERT-EFF-DT        PIC XX.
  2990         16  CP-VALUATION-DT       PIC XX.
  2991         16  CP-PAID-THRU-DT       PIC XX.
  2992         16  CP-BENEFIT-TYPE       PIC X.
  2993           88  CP-AH                               VALUE 'A' 'D'
  2994                                                   'I' 'U'.
  2995           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2996           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2997         16  CP-INCURRED-DT        PIC XX.
  2998         16  CP-REPORTED-DT        PIC XX.
  2999         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3000         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3001         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3002                                     COMP-3.
  3003         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3004                                     COMP-3.
  3005         16  CP-CDT-METHOD         PIC X.
  3006           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3007           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3008           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3009         16  CP-CLAIM-TYPE         PIC X.
  3010           88  CP-AH-CLAIM                         VALUE 'A'.
  3011           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3012         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3013                                     COMP-3.
  3014         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3015                                     COMP-3.
  3016         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3017                                     COMP-3.
  3018         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3019                                     COMP-3.
  3020         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3021                                     COMP-3.
  3022         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3023                                     COMP-3.
  3024         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3025                                     COMP-3.
  3026         16  CP-REM-TERM-METHOD    PIC X.
  3027           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3028           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3029           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3030           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3031           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3032           88  CP-EARN-AFTER-14TH                  VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  54
* SOCK00.cbl
  3033           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3034         16  CP-EARNING-METHOD     PIC X.
  3035           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3036           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3037           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3038           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3039           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3040           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3041           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3042           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3043           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3044           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3045           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3046           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3047         16  CP-PROCESS-TYPE       PIC X.
  3048           88  CP-CLAIM                            VALUE '1'.
  3049           88  CP-CANCEL                           VALUE '2'.
  3050           88  CP-ISSUE                            VALUE '3'.
  3051         16  CP-SPECIAL-CALC-CD    PIC X.
  3052           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3053           88  CP-1-MTH-INTEREST               VALUE ' '.
  3054           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3055           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3056           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3057           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3058           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3059           88  CP-FARM-PLAN                    VALUE 'F'.
  3060           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3061           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3062           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3063           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3064           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3065           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3066           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3067           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3068           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3069           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3070                                                     'W' 'X'.
  3071           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3072           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3073           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3074           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3075           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3076           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3077           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3078           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3079           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3080           88  CP-CSL-METH-1                   VALUE '5'.
  3081           88  CP-CSL-METH-2                   VALUE '6'.
  3082           88  CP-CSL-METH-3                   VALUE '7'.
  3083           88  CP-CSL-METH-4                   VALUE '8'.
  3084
  3085         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3086                                     COMP-3.
  3087         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3088         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3089         16  CP-STATE              PIC XX          VALUE SPACE.
  3090         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  55
* SOCK00.cbl
  3091         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3092           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3093               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3094         16  CP-R78-OPTION         PIC X.
  3095           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3096           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3097
  3098         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3099         16  CP-IBNR-RESERVE-SW    PIC X.
  3100         16  CP-CLAIM-STATUS       PIC X.
  3101         16  CP-RATE-FILE          PIC X.
  3102         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3103                                     COMP-3.
  3104
  3105         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3106         16  CP-AH-OVERRIDE-CODE   PIC X.
  3107
  3108         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3109                                     COMP-3.
  3110         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3111                                     COMP-3.
  3112         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3113                                     COMP-3.
  3114         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3115                                     COMP-3.
  3116
  3117         16  CP-PAID-FROM-DATE     PIC X(02).
  3118         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3119         16  CP-EXT-DAYS-CALC      PIC X.
  3120           88  CP-EXT-NO-CHG                   VALUE ' '.
  3121           88  CP-EXT-CHG-LF                   VALUE '1'.
  3122           88  CP-EXT-CHG-AH                   VALUE '2'.
  3123           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3124         16  CP-DOMICILE-STATE     PIC XX.
  3125         16  CP-CARRIER            PIC X.
  3126         16  CP-REIN-FLAG          PIC X.
  3127         16  CP-REM-TRM-CALC-OPTION PIC X.
  3128           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3129                      '2' '3' '4' '5'.
  3130           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3131           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3132           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3133           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3134           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3135           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3136           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3137           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3138         16  CP-SIG-SWITCH         PIC X.
  3139         16  CP-RATING-METHOD      PIC X.
  3140           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3141           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3142           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3143           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3144           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3145           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3146           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3147           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3148           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  56
* SOCK00.cbl
  3149         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3150                                     COMP-3.
  3151         16  CP-BEN-CATEGORY       PIC X.
  3152         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3153         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3154                                   PIC S99V9(5) COMP-3.
  3155         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3156         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3157                                   PIC S99V9(5) COMP-3.
  3158         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3159         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3160         16  CP-EXPIRE-DT          PIC XX.
  3161         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3162         16  FILLER                PIC X(35).
  3163*        16  FILLER                PIC X(50).
  3164
  3165***************    OUTPUT FROM ELRESV   ************************
  3166
  3167         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3168
  3169         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3170                                     COMP-3.
  3171         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3172                                     COMP-3.
  3173         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3174                                     COMP-3.
  3175         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3176                                     COMP-3.
  3177         16  FILLER                PIC X(09).
  3178***************    OUTPUT FROM ELRTRM   *************************
  3179
  3180         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3181                                     COMP-3.
  3182         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3183                                     COMP-3.
  3184         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3185                                     COMP-3.
  3186         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3187                                     COMP-3.
  3188         16  FILLER                PIC X(12).
  3189
  3190***************    OUTPUT FROM ELRAMT   *************************
  3191
  3192         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3193                                     COMP-3.
  3194         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3195                                     COMP-3.
  3196         16  FILLER                PIC X(12).
  3197
  3198***************    OUTPUT FROM ELRATE   *************************
  3199
  3200         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3201                                     COMP-3.
  3202         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3203                                     COMP-3.
  3204         16  CP-MORTALITY-CODE     PIC X(4).
  3205         16  CP-RATE-EDIT-FLAG     PIC X.
  3206             88  CP-RATES-NEED-APR                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  57
* SOCK00.cbl
  3207         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3208                                     COMP-3.
  3209         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3210         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3211         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3212                                   PIC S9(7)V99 COMP-3.
  3213         16  FILLER                PIC X(07).
  3214
  3215***************    OUTPUT FROM ELRFND   *************************
  3216
  3217         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3218                                     COMP-3.
  3219         16  CP-REFUND-TYPE-USED   PIC X.
  3220           88  CP-R-AS-R78                         VALUE '1'.
  3221           88  CP-R-AS-PRORATA                     VALUE '2'.
  3222           88  CP-R-AS-CALIF                       VALUE '3'.
  3223           88  CP-R-AS-TEXAS                       VALUE '4'.
  3224           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3225           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3226           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3227           88  CP-R-AS-MEAN                        VALUE '8'.
  3228           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3229           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3230           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3231         16  FILLER                PIC X(12).
  3232
  3233***************    OUTPUT FROM ELEARN   *************************
  3234
  3235         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3236                                     COMP-3.
  3237         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3238                                     COMP-3.
  3239         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3240                                     COMP-3.
  3241         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3242                                     COMP-3.
  3243         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3244                                     COMP-3.
  3245         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3246                                     COMP-3.
  3247         16  CP-EARNING-TYPE-USED  PIC X.
  3248           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3249           88  CP-E-AS-R78                         VALUE '1'.
  3250           88  CP-E-AS-PRORATA                     VALUE '2'.
  3251           88  CP-E-AS-TEXAS                       VALUE '4'.
  3252           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3253           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3254           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3255           88  CP-E-AS-MEAN                        VALUE '8'.
  3256           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3257         16  FILLER                PIC X(12).
  3258
  3259***************    OUTPUT FROM ELPMNT   *************************
  3260
  3261         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3262                                     COMP-3.
  3263         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3264                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  58
* SOCK00.cbl
  3265         16  FILLER                PIC X(12).
  3266
  3267***************   MISC WORK AREAS    *****************************
  3268         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3269                                     COMP-3.
  3270         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3271                                     COMP-3.
  3272         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3273                                     COMP-3.
  3274         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3275                                     COMP-3.
  3276         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3277                                     COMP-3.
  3278         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3279                                     COMP-3.
  3280         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3281             88  OPEN-RATE-FILE                   VALUE 'O'.
  3282             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3283             88  IO-ERROR                         VALUE 'E'.
  3284
  3285         16  CP-FIRST-PAY-DATE     PIC XX.
  3286
  3287         16  CP-JOINT-INDICATOR    PIC X.
  3288
  3289         16  CP-RESERVE-REMAINING-TERM
  3290                                   PIC S9(4)V9    VALUE ZERO
  3291                                     COMP-3.
  3292
  3293         16  CP-INSURED-BIRTH-DT   PIC XX.
  3294
  3295         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3296                                     COMP-3.
  3297
  3298         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3299                                     COMP-3.
  3300
  3301         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3302                                     COMP-3.
  3303
  3304         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3305                                     COMP-3.
  3306
  3307         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3308                                     COMP-3.
  3309
  3310         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3311                                     COMP-3.
  3312
  3313         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3314                                     COMP-3.
  3315
  3316         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3317             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3318
  3319         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3320                                     COMP-3.
  3321         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3322                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  59
* SOCK00.cbl
  3323         16  FILLER                PIC X(17).
  3324******************************************************************
  3325****************************************************************
  3326*
  3327* Copyright (c) 2007 by Clerity Solutions, Inc.
  3328* All rights reserved.
  3329*
  3330****************************************************************
  3331 01  DFHEIV.
  3332   02  DFHEIV0               PIC X(35).
  3333   02  DFHEIV1               PIC X(08).
  3334   02  DFHEIV2               PIC X(08).
  3335   02  DFHEIV3               PIC X(08).
  3336   02  DFHEIV4               PIC X(06).
  3337   02  DFHEIV5               PIC X(04).
  3338   02  DFHEIV6               PIC X(04).
  3339   02  DFHEIV7               PIC X(02).
  3340   02  DFHEIV8               PIC X(02).
  3341   02  DFHEIV9               PIC X(01).
  3342   02  DFHEIV10              PIC S9(7) COMP-3.
  3343   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3344   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3345   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3346   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3347   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3348   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3349   02  DFHEIV17              PIC X(04).
  3350   02  DFHEIV18              PIC X(04).
  3351   02  DFHEIV19              PIC X(04).
  3352   02  DFHEIV20              USAGE IS POINTER.
  3353   02  DFHEIV21              USAGE IS POINTER.
  3354   02  DFHEIV22              USAGE IS POINTER.
  3355   02  DFHEIV23              USAGE IS POINTER.
  3356   02  DFHEIV24              USAGE IS POINTER.
  3357   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3358   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3359   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3360   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3361   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3362   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3363   02  FILLER                PIC X(02).
  3364   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3365   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3366   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3367   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3368   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3369 LINKAGE  SECTION.
  3370*****************************************************************
  3371*                                                               *
  3372* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3373* All rights reserved.                                          *
  3374*                                                               *
  3375*****************************************************************
  3376 01  dfheiblk.
  3377     02  eibtime          pic s9(7) comp-3.
  3378     02  eibdate          pic s9(7) comp-3.
  3379     02  eibtrnid         pic x(4).
  3380     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  60
* SOCK00.cbl
  3381     02  eibtrmid         pic x(4).
  3382     02  dfheigdi         pic s9(4) comp.
  3383     02  eibcposn         pic s9(4) comp.
  3384     02  eibcalen         pic s9(4) comp.
  3385     02  eibaid           pic x(1).
  3386     02  eibfiller1       pic x(1).
  3387     02  eibfn            pic x(2).
  3388     02  eibfiller2       pic x(2).
  3389     02  eibrcode         pic x(6).
  3390     02  eibfiller3       pic x(2).
  3391     02  eibds            pic x(8).
  3392     02  eibreqid         pic x(8).
  3393     02  eibrsrce         pic x(8).
  3394     02  eibsync          pic x(1).
  3395     02  eibfree          pic x(1).
  3396     02  eibrecv          pic x(1).
  3397     02  eibsend          pic x(1).
  3398     02  eibatt           pic x(1).
  3399     02  eibeoc           pic x(1).
  3400     02  eibfmh           pic x(1).
  3401     02  eibcompl         pic x(1).
  3402     02  eibsig           pic x(1).
  3403     02  eibconf          pic x(1).
  3404     02  eiberr           pic x(1).
  3405     02  eibrldbk         pic x(1).
  3406     02  eiberrcd         pic x(4).
  3407     02  eibsynrb         pic x(1).
  3408     02  eibnodat         pic x(1).
  3409     02  eibfiller5       pic x(2).
  3410     02  eibresp          pic 9(09) comp.
  3411     02  eibresp2         pic 9(09) comp.
  3412     02  dfheigdj         pic s9(4) comp.
  3413     02  dfheigdk         pic s9(4) comp.
  3414 01  DFHCOMMAREA.
  3415   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3416   05 LSTN-NAME                PIC X(8).
  3417   05 LSTN-SUBNAME             PIC X(8).
  3418   05 CLIENT-IN-DATA.
  3419      15  CLIENT-CAR           PIC X.
  3420      15  CLIENT-GRP           PIC X(6).
  3421      15  CLIENT-ST            PIC XX.
  3422      15  CLIENT-ACT           PIC X(10).
  3423      15  CLIENT-ID            PIC XXX.
  3424      15  FILLER               PIC X(14).
  3425   05 SOCKADDR-IN-PARM.
  3426     15 SIN-FAMILY             PIC 9(4) COMP.
  3427     15 SIN-PORT               PIC 9(4) COMP.
  3428     15 SIN-ADDRESS            PIC 9(8) COMP.
  3429     15 SIN-ZERO               PIC X(8).
  3430 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3431 0000-DFHEXIT SECTION.
  3432     MOVE '9#                    $   ' TO DFHEIV0.
  3433     MOVE 'SOCK00' TO DFHEIV1.
  3434     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3435*
  3436* when calling a C function the function returns its value
  3437* in the system variable return code.
  3438*
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  61
* SOCK00.cbl
  3439 start-here.
  3440*
  3441* data with transaction
  3442*
  3443     display 'SOCK00:transaction data =', CLIENT-IN-DATA.
  3444     display 'SOCK00:socket number    =', GIVE-TAKE-SOCKET.
  3445     IF CLIENT-IN-DATA (1:4) = "RATE"
  3446        SET GET-RATES            TO TRUE
  3447     ELSE
  3448        IF CLIENT-IN-DATA (1:5) = "STATE"
  3449           SET GET-ACT-ACCTS     TO TRUE
  3450        END-IF
  3451     END-IF
  3452     IF CLIENT-ID = 'DCC'
  3453        MOVE X'05'               TO WS-COMP-CD
  3454        MOVE 'DCC'               TO WS-SEND-BUF (5:3)
  3455                                    WS-COMP-ID
  3456     ELSE
  3457        MOVE X'04'               TO WS-COMP-CD
  3458        MOVE 'CID'               TO WS-SEND-BUF (5:3)
  3459                                    WS-COMP-ID
  3460     END-IF
  3461     move 'CSO'                  to ws-send-buf (1:3)
  3462     move +25                    to ws-send-msg-size
  3463* send data
  3464*
  3465     display 'SOCK00:sequence number  =', ws-seq-num.
  3466     display 'SOCK00:send buffer      =', ws-send-buf(1:25).
  3467     call "send" using by value GIVE-TAKE-SOCKET,
  3468         by reference ws-send-buf,
  3469         by value ws-send-msg-size,
  3470         by value ws-flags.
  3471     if return-code <= zero
  3472         display 'SOCK00:send error ',
  3473         go to socket-error.
  3474*
  3475* set up the receive buffer
  3476*
  3477     move low-values to ws-recv-buf.
  3478     set ws-recv-total to zero.
  3479     compute ws-recv-left = ws-recv-msg-size.
  3480*
  3481* receive data
  3482*
  3483     display 'SOCK00:About to recv '
  3484     call "recv" using by value GIVE-TAKE-SOCKET,
  3485         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3486         by value ws-recv-left,
  3487         by value ws-flags.
  3488*
  3489* test what was received and decide what we should do
  3490*
  3491     if return-code < zero
  3492        display 'SOCK00:recv error ',
  3493        go to socket-error.
  3494     if return-code = zero
  3495        display 'SOCK00:client disconnected',
  3496        go to socket-error.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  62
* SOCK00.cbl
  3497*
  3498     display 'SOCK00:Good recv  '
  3499     display 'SOCK00:return code      = ', return-code
  3500     display 'SOCK00:receive buffer   = ', ws-recv-buf(1:50)
  3501     move +4096                  to ws-send-msg-size
  3502*    move +750                   to ws-send-msg-size
  3503     if get-rates
  3504        perform 0300-get-rates   thru 0300-exit
  3505     end-if
  3506     IF GET-ACT-ACCTS
  3507        PERFORM 0400-GET-ACT-ACCTS
  3508                                 THRU 0400-EXIT
  3509     END-IF
  3510     move ws-recv-buf (1:19)     to client-in-data
  3511     IF (CLIENT-CAR NOT = ZEROS)
  3512        AND (CLIENT-ST NOT = ZEROS)
  3513        PERFORM 0500-GET-ONE-ACCT
  3514                                 THRU 0500-EXIT
  3515     END-IF
  3516     MOVE ' '                    TO WS-BUILD-SW
  3517     MOVE CLIENT-ACT             TO WS-AM-ALT-ACCOUNT
  3518     MOVE LOW-VALUES             TO WS-AM-ALT-EXP-DT
  3519     PERFORM 0010-STARTBR-ERACCT THRU 0010-EXIT
  3520     IF NOT RESP-NORMAL
  3521        MOVE 'BAD STARTBR ON ERACCT  '
  3522                                 TO WS-SEND-BUF
  3523        MOVE WS-RESPONSE         TO WS-DIS-RESP
  3524        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  3525        GO TO SEND-BUFFER
  3526     END-IF
  3527     PERFORM 0020-READNEXT-ERACCT
  3528                                 THRU 0020-EXIT
  3529     IF (NOT RESP-NORMAL)
  3530        OR (AM-ACCOUNT NOT = CLIENT-ACT)
  3531        MOVE 'BAD READNEXT ON ERACCT '
  3532                                 TO WS-SEND-BUF
  3533        MOVE WS-RESPONSE         TO WS-DIS-RESP
  3534        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  3535        GO TO SEND-BUFFER
  3536     ELSE
  3537        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  3538     END-IF
  3539     PERFORM UNTIL
  3540        (TIME-TO-BUILD)
  3541        IF AM-ACCOUNT = CLIENT-ACT
  3542         IF (AM-STATE = CLIENT-ST)
  3543                 OR
  3544            (CLIENT-ST = 00)
  3545           IF AM-EXPIRATION-DT = HIGH-VALUES
  3546              SET TIME-TO-BUILD  TO TRUE
  3547           ELSE
  3548              MOVE ACCOUNT-MASTER
  3549                                 TO WS-SAVE-ERACCT
  3550              PERFORM 0020-READNEXT-ERACCT
  3551                                 THRU 0020-EXIT
  3552              IF NOT RESP-NORMAL
  3553                 MOVE WS-SAVE-ERACCT
  3554                                 TO ACCOUNT-MASTER
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  63
* SOCK00.cbl
  3555                 SET TIME-TO-BUILD
  3556                                 TO TRUE
  3557              END-IF
  3558           END-IF
  3559         ELSE
  3560          PERFORM 0020-READNEXT-ERACCT
  3561                            THRU 0020-EXIT
  3562         END-IF
  3563        ELSE
  3564           MOVE WS-SAVE-ERACCT   TO ACCOUNT-MASTER
  3565           SET TIME-TO-BUILD     TO TRUE
  3566        END-IF
  3567     END-PERFORM
  3568     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  3569     .
  3570*
  3571* send data
  3572*
  3573 SEND-BUFFER.
  3574     display 'SOCK00:About to send      '
  3575     display 'SOCK00:sequence number  =', ws-seq-num.
  3576     display 'SOCK00:send buffer      =', ws-send-buf(1:300).
  3577     call "send" using by value GIVE-TAKE-SOCKET,
  3578         by reference ws-send-buf,
  3579         by value ws-send-msg-size,
  3580         by value ws-flags.
  3581     if return-code <= zero
  3582         display 'SOCK00:send error ',
  3583         go to socket-error.
  3584     GO TO SOCKET-FIN
  3585*
  3586* set up the receive buffer
  3587*
  3588     move low-values to ws-recv-buf.
  3589     set ws-recv-total to zero.
  3590     compute ws-recv-left = ws-recv-msg-size.
  3591*
  3592* receive data
  3593*
  3594 recv-1.
  3595     call "recv" using by value GIVE-TAKE-SOCKET,
  3596         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3597         by value ws-recv-left,
  3598         by value ws-flags.
  3599*
  3600* test what was received and decide what we should do
  3601*
  3602     if return-code < zero
  3603        display 'SOCK00:recv error ',
  3604        go to socket-error.
  3605     if return-code = zero
  3606        display 'SOCK00:client disconnected',
  3607        go to socket-error.
  3608*
  3609* have we received all the data yet?
  3610*
  3611     compute ws-recv-total = ws-recv-total + return-code.
  3612     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  64
* SOCK00.cbl
  3613*
  3614* not yet
  3615*
  3616     if ws-recv-left > 0 go to recv-1.
  3617*
  3618* received all the data
  3619*
  3620     display 'SOCK00:receive buffer   =', ws-recv-buf(1:50).
  3621*
  3622* make sure what we received was what we sent
  3623*
  3624*    if ws-recv-buf <> ws-send-buf
  3625*        display "SOCK00:data doesn't match",
  3626*        go to socket-error.
  3627*
  3628* end of pass
  3629*
  3630*loop-end.
  3631*    if ws-seq-num = 5 go to socket-error.
  3632*    go to loop-1.
  3633*
  3634* program end
  3635*
  3636 socket-error.
  3637     if ws-seq-num <> 0
  3638         display "SOCK00:did not complete".
  3639*
  3640* flush the send buffer and deallocate
  3641*
  3642*    display 'SOCK00:closing socket'.
  3643*    call "close" using by value GIVE-TAKE-SOCKET .
  3644*
  3645* finised return to cics
  3646*
  3647 socket-fin.
  3648     display 'SOCK00:closing socket'.
  3649     call "close" using by value GIVE-TAKE-SOCKET .
  3650     display 'SOCK00:done'.
  3651
  3652* exec cics return end-exec.
  3653*    MOVE '.(                    &   #00003647' TO DFHEIV0
  3654     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3655     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3656     MOVE X'2020233030303033363437' TO DFHEIV0(25:11)
  3657     CALL 'kxdfhei1' USING DFHEIV0,
  3658           DFHEIV99,
  3659           DFHEIV99,
  3660           DFHEIV99,
  3661           DFHEIV99,
  3662           DFHEIV99
  3663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3664
  3665
  3666* goback.
  3667     MOVE '9%                    "   ' TO DFHEIV0
  3668     MOVE 'SOCK00' TO DFHEIV1
  3669     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3670     goback.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  65
* SOCK00.cbl
  3671 0010-STARTBR-ERACCT.
  3672
  3673* EXEC CICS STARTBR
  3674*         DATASET    ('ERACCT3')
  3675*         RIDFLD     (WS-AM-ALT-KEY)
  3676*         GENERIC
  3677*         GTEQ
  3678*         KEYLENGTH  (10)
  3679*         RESP       (WS-RESPONSE)
  3680*    END-EXEC
  3681     MOVE 'ERACCT3' TO DFHEIV1
  3682     MOVE 10
  3683       TO DFHEIV11
  3684     MOVE 0
  3685       TO DFHEIV12
  3686*    MOVE '&,   KG    G          &  N#00003650' TO DFHEIV0
  3687     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3688     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3689     MOVE X'204E233030303033363530' TO DFHEIV0(25:11)
  3690     CALL 'kxdfhei1' USING DFHEIV0,
  3691           DFHEIV1,
  3692           WS-AM-ALT-KEY,
  3693           DFHEIV11,
  3694           DFHEIV12,
  3695           DFHEIV99
  3696     MOVE EIBRESP  TO WS-RESPONSE
  3697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3698     .
  3699 0010-EXIT.
  3700     EXIT.
  3701 0020-READNEXT-ERACCT.
  3702
  3703* EXEC CICS READNEXT
  3704*         INTO    (ACCOUNT-MASTER)
  3705*         DATASET ('ERACCT3')
  3706*         RIDFLD  (WS-AM-ALT-KEY)
  3707*         RESP    (WS-RESPONSE)
  3708*    END-EXEC
  3709     MOVE LENGTH OF
  3710      ACCOUNT-MASTER
  3711       TO DFHEIV12
  3712     MOVE 'ERACCT3' TO DFHEIV1
  3713     MOVE 0
  3714       TO DFHEIV11
  3715*    MOVE '&.IL                  )  N#00003662' TO DFHEIV0
  3716     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3717     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3718     MOVE X'204E233030303033363632' TO DFHEIV0(25:11)
  3719     CALL 'kxdfhei1' USING DFHEIV0,
  3720           DFHEIV1,
  3721           ACCOUNT-MASTER,
  3722           DFHEIV12,
  3723           WS-AM-ALT-KEY,
  3724           DFHEIV99,
  3725           DFHEIV11,
  3726           DFHEIV99,
  3727           DFHEIV99
  3728     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  66
* SOCK00.cbl
  3729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3730     .
  3731 0020-EXIT.
  3732     EXIT.
  3733 0030-BUILD-BUFFER.
  3734     PERFORM 0100-BUILD-ERACCT-STUFF
  3735                                 THRU 0100-EXIT
  3736     MOVE SPACES                 TO WS-SEND-BUF
  3737     EVALUATE AM-STATUS
  3738        WHEN '1'
  3739           MOVE 'I'              TO WS-STATUS
  3740        WHEN '2'
  3741           MOVE 'T'              TO WS-STATUS
  3742        WHEN '3'
  3743           MOVE 'C'              TO WS-STATUS
  3744        WHEN '4'
  3745           MOVE 'I'              TO WS-STATUS
  3746        WHEN OTHER
  3747           MOVE 'A'              TO WS-STATUS
  3748     END-EVALUATE
  3749     IF AM-REMIT-TO NOT NUMERIC
  3750        MOVE ZEROS         TO AM-REMIT-TO
  3751     END-IF
  3752     IF AM-REMIT-TO = ZEROS
  3753        MOVE 01        TO AM-REMIT-TO
  3754     END-IF
  3755     MOVE AM-AGT (AM-REMIT-TO) TO WS-FIN-RESP
  3756     MOVE SPACES                 TO WS-AM-CITY-STATE
  3757     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3758        DELIMITED BY '  ' INTO WS-AM-CITY-STATE
  3759     END-STRING
  3760     IF NOT GET-ACT-ACCTS
  3761* this is when a single account is selected
  3762       STRING
  3763        AM-ACCOUNT      ';'
  3764        WS-LONG-ACCT-NAME    ';'
  3765        WS-CONTR-NAME   ';'
  3766        AM-ADDRS        ';'
  3767        WS-AM-CITY-STATE ';'
  3768        AM-ZIP          ';'
  3769        AM-GPCD         ';'
  3770        WS-EFF-DATE     ';'
  3771        WS-EXP-DATE     ';'
  3772        WS-POLICY-NO    ';'
  3773        WS-SL-COMM      ';'
  3774        WS-JL-COMM      ';'
  3775        WS-SAH-COMM     ';'
  3776        WS-JAH-COMM     ';'
  3777        WS-CID-NO       ';'
  3778        AM-STATE        ';'
  3779        WS-GA-NUM       ';'
  3780        WS-GA-PRIMARY-CONTACT ';'
  3781        WS-GA-NAME      ';'
  3782        WS-GA-MAIL-NAME ';'
  3783        WS-GA-ADDR1     ';'
  3784        WS-GA-ADDR2     ';'
  3785        WS-GA-ADDR3     ';'
  3786        WS-GA-ZIP       ';'
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  67
* SOCK00.cbl
  3787        WS-GA-PHONE     ';'
  3788        AM-CONTROL-NAME ';'
  3789        WS-ORIG-EFF-DT  ';'
  3790        AM-COMMENT-LINE (1) ';'
  3791        AM-COMMENT-LINE (2) ';'
  3792        AM-COMMENT-LINE (3) ';'
  3793        AM-COMMENT-LINE (4) ';'
  3794        AM-COMMENT-LINE (5) ';'
  3795        AM-TEL-NO       ';'
  3796        AM-REPORT-CODE-1    ';'
  3797        AM-REPORT-CODE-2    ';'
  3798        WS-STATUS           ';'
  3799        AM-REPORT-CODE-3    ';'
  3800        AM-USER-SELECT-2    ';'
  3801        AM-CARRIER          ';'
  3802        WS-FIN-RESP         ';'
  3803        AM-USER-SELECT-3    ';'
  3804        WS-SHORT-ACCT-NAME  ';'
  3805           DELIMITED BY SIZE INTO WS-SEND-BUF
  3806       END-STRING
  3807     ELSE
  3808       STRING
  3809        AM-ACCOUNT      ';'
  3810        WS-LONG-ACCT-NAME    ';'
  3811        WS-CONTR-NAME   ';'
  3812        AM-ADDRS        ';'
  3813        WS-AM-CITY-STATE ';'
  3814        AM-ZIP          ';'
  3815        AM-GPCD         ';'
  3816        WS-EFF-DATE     ';'
  3817        WS-EXP-DATE     ';'
  3818        WS-POLICY-NO    ';'
  3819        WS-SL-COMM      ';'
  3820        WS-JL-COMM      ';'
  3821        WS-SAH-COMM     ';'
  3822        WS-JAH-COMM     ';'
  3823        WS-CID-NO       ';'
  3824        AM-STATE        ';'
  3825        WS-GA-NUM       ';'
  3826        WS-GA-PRIMARY-CONTACT ';'
  3827        WS-GA-NAME      ';'
  3828        WS-GA-MAIL-NAME ';'
  3829        WS-GA-ADDR1     ';'
  3830        WS-GA-ADDR2     ';'
  3831        WS-GA-ADDR3     ';'
  3832        WS-GA-ZIP       ';'
  3833        WS-GA-PHONE     ';'
  3834        AM-COMMENT-LINE (1) ';'
  3835        AM-COMMENT-LINE (2) ';'
  3836        AM-COMMENT-LINE (3) ';'
  3837        AM-COMMENT-LINE (4) ';'
  3838        AM-COMMENT-LINE (5) ';'
  3839        AM-CONTROL-NAME     ';'
  3840        WS-ORIG-EFF-DT      ';'
  3841        AM-TEL-NO           ';'
  3842        AM-REPORT-CODE-1    ';'
  3843        AM-REPORT-CODE-2    ';'
  3844        WS-STATUS           ';'
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  68
* SOCK00.cbl
  3845        AM-REPORT-CODE-3    ';'
  3846        AM-USER-SELECT-2    ';'
  3847        AM-CARRIER          ';'
  3848        WS-FIN-RESP         ';'
  3849        AM-USER-SELECT-3    ';'
  3850        WS-SHORT-ACCT-NAME  ';'
  3851           DELIMITED BY SIZE INTO WS-SEND-BUF
  3852       END-STRING
  3853     END-IF
  3854     .
  3855 0030-EXIT.
  3856     EXIT.
  3857 0100-BUILD-ERACCT-STUFF.
  3858     MOVE AM-EFFECTIVE-DT        TO DC-BIN-DATE-1
  3859     MOVE ' '                    TO DC-OPTION-CODE
  3860     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  3861     IF NO-CONVERSION-ERROR
  3862        MOVE DC-GREG-DATE-A-EDIT TO WS-EFF-DATE
  3863     ELSE
  3864        MOVE '00/00/0000'        TO WS-EFF-DATE
  3865     END-IF
  3866     IF AM-EXPIRATION-DT = HIGH-VALUES
  3867        MOVE '99/99/9999'        TO WS-EXP-DATE
  3868     ELSE
  3869        MOVE AM-EXPIRATION-DT    TO DC-BIN-DATE-1
  3870        MOVE ' '                 TO DC-OPTION-CODE
  3871        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  3872        IF NO-CONVERSION-ERROR
  3873           MOVE DC-GREG-DATE-A-EDIT
  3874                                 TO WS-EXP-DATE
  3875        ELSE
  3876           MOVE '00/00/0000'     TO WS-EXP-DATE
  3877        END-IF
  3878     END-IF
  3879     MOVE WS-BIN-ORIG-EFF-DT     TO DC-BIN-DATE-1
  3880     MOVE ' '                    TO DC-OPTION-CODE
  3881     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  3882     IF NO-CONVERSION-ERROR
  3883        MOVE DC-GREG-DATE-A-EDIT TO WS-ORIG-EFF-DT
  3884     ELSE
  3885        MOVE '00/00/0000'        TO WS-ORIG-EFF-DT
  3886     END-IF
  3887     MOVE AM-COMMENT-LINE (2)    TO WS-POLICY-NO
  3888     PERFORM VARYING S1 FROM +7 BY +1 UNTIL
  3889        (S1 > +48)
  3890        OR (AM-COMMENT-LINE (2) (S1:3) = 'CID')
  3891     END-PERFORM
  3892     IF S1 > +48
  3893        MOVE SPACES              TO WS-CID-NO
  3894     ELSE
  3895        MOVE AM-COMMENT-LINE (2) (S1:8)
  3896                                 TO WS-CID-NO
  3897     END-IF
  3898     MOVE AM-NAME                TO WS-SHORT-ACCT-NAME
  3899                                    WS-LONG-ACCT-NAME
  3900     MOVE AM-PERSON              TO WS-CONTR-NAME
  3901*    IF AM-REPORT-CODE-3 = 'RLIC'
  3902        MOVE AM-CONTROL-PRIMARY  TO WS-NT-KEY
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  69
* SOCK00.cbl
  3903        MOVE '3'                 TO WS-NT-REC-TYPE
  3904        MOVE +1                  TO WS-NT-SEQ-NO
  3905
  3906* EXEC CICS READ
  3907*          DATASET    ('ERACNT')
  3908*          RIDFLD     (WS-NT-KEY)
  3909*          INTO       (NOTE-FILE)
  3910*          RESP       (WS-RESPONSE)
  3911*       END-EXEC
  3912     MOVE LENGTH OF
  3913      NOTE-FILE
  3914       TO DFHEIV11
  3915     MOVE 'ERACNT' TO DFHEIV1
  3916*    MOVE '&"IL       E          (  N#00003843' TO DFHEIV0
  3917     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3918     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3919     MOVE X'204E233030303033383433' TO DFHEIV0(25:11)
  3920     CALL 'kxdfhei1' USING DFHEIV0,
  3921           DFHEIV1,
  3922           NOTE-FILE,
  3923           DFHEIV11,
  3924           WS-NT-KEY,
  3925           DFHEIV99,
  3926           DFHEIV99,
  3927           DFHEIV99
  3928     MOVE EIBRESP  TO WS-RESPONSE
  3929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3930        IF RESP-NORMAL
  3931           IF NT-SHIPPING-LINE NOT = SPACES AND LOW-VALUES
  3932              MOVE NT-SHIPPING-LINE TO WS-LONG-ACCT-NAME
  3933           END-IF
  3934        END-IF
  3935        MOVE AM-CONTROL-PRIMARY  TO WS-NT-KEY
  3936        MOVE '3'                 TO WS-NT-REC-TYPE
  3937        MOVE +2                  TO WS-NT-SEQ-NO
  3938
  3939* EXEC CICS READ
  3940*          DATASET    ('ERACNT')
  3941*          RIDFLD     (WS-NT-KEY)
  3942*          INTO       (NOTE-FILE)
  3943*          RESP       (WS-RESPONSE)
  3944*       END-EXEC
  3945     MOVE LENGTH OF
  3946      NOTE-FILE
  3947       TO DFHEIV11
  3948     MOVE 'ERACNT' TO DFHEIV1
  3949*    MOVE '&"IL       E          (  N#00003857' TO DFHEIV0
  3950     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3951     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3952     MOVE X'204E233030303033383537' TO DFHEIV0(25:11)
  3953     CALL 'kxdfhei1' USING DFHEIV0,
  3954           DFHEIV1,
  3955           NOTE-FILE,
  3956           DFHEIV11,
  3957           WS-NT-KEY,
  3958           DFHEIV99,
  3959           DFHEIV99,
  3960           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  70
* SOCK00.cbl
  3961     MOVE EIBRESP  TO WS-RESPONSE
  3962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3963        IF RESP-NORMAL
  3964           IF NT-SHIPPING-LINE NOT = SPACES AND LOW-VALUES
  3965              MOVE NT-SHIPPING-LINE TO WS-CONTR-NAME
  3966           END-IF
  3967        END-IF
  3968*    END-IF
  3969     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  3970        (S1 > +10)
  3971        OR (AM-COM-TYP (S1) = 'D' OR 'C')
  3972     END-PERFORM
  3973     IF S1 > +10
  3974        CONTINUE
  3975     ELSE
  3976        PERFORM 0150-BUILD-DW-COMM
  3977                                 THRU 0150-EXIT
  3978     END-IF
  3979     MOVE SPACES                 TO WS-GA-DATA
  3980     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  3981        (S1 > +10)
  3982        OR (AM-COM-TYP (S1) = 'O' OR 'P' OR 'K')
  3983     END-PERFORM
  3984     IF S1 > +10
  3985        MOVE ZEROS               TO WS-GA-NUM
  3986     ELSE
  3987        MOVE AM-AGT (S1)         TO WS-GA-NUM
  3988     END-IF
  3989     IF WS-GA-NUM NOT = ZEROS
  3990        PERFORM 0200-GET-ERCOMP  THRU 0200-EXIT
  3991     END-IF
  3992     .
  3993 0100-EXIT.
  3994     EXIT.
  3995 0150-BUILD-DW-COMM.
  3996     MOVE ZEROS                  TO WS-SL-COMM
  3997                                    WS-JL-COMM
  3998                                    WS-SAH-COMM
  3999                                    WS-JAH-COMM
  4000                                    WS-WORK-SAH-COMM
  4001                                    WS-WORK-JAH-COMM
  4002     IF (AM-L-COM (S1) NOT NUMERIC)
  4003        OR (AM-L-COMA (S1) (3:1) = 'L' OR 'M')
  4004        CONTINUE
  4005     ELSE
  4006        MOVE AM-L-COM (S1)       TO WS-SL-COMM
  4007     END-IF
  4008     IF (AM-J-COM (S1) NOT NUMERIC)
  4009        OR (AM-J-COMA (S1) (3:1) = 'L' OR 'M')
  4010        CONTINUE
  4011     ELSE
  4012        MOVE AM-J-COM (S1)       TO WS-JL-COMM
  4013     END-IF
  4014     IF (AM-A-COM (S1) NOT NUMERIC)
  4015        OR (AM-A-COMA (S1) (3:1) = 'L' OR 'M')
  4016        PERFORM 0160-ERCTBL-STARTBR
  4017                                 THRU 0160-EXIT
  4018        IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  71
* SOCK00.cbl
  4019           PERFORM 0165-ERCTBL-READNEXT
  4020                                 THRU 0165-EXIT
  4021           UNTIL
  4022           ((WS-WORK-SAH-COMM NOT = ZEROS)
  4023            AND (WS-WORK-JAH-COMM NOT = ZEROS))
  4024                       OR
  4025            END-OF-ERCTBL
  4026            MOVE WS-WORK-JAH-COMM TO WS-JAH-COMM
  4027            MOVE WS-WORK-SAH-COMM TO WS-SAH-COMM
  4028        END-IF
  4029     ELSE
  4030        MOVE AM-A-COM (S1)       TO WS-SAH-COMM
  4031                                    WS-JAH-COMM
  4032     END-IF
  4033     .
  4034 0150-EXIT.
  4035     EXIT.
  4036 0160-ERCTBL-STARTBR.
  4037     MOVE AM-COMPANY-CD          TO WS-CT-COMPANY-CD
  4038     MOVE AM-A-COMA (S1)         TO WS-CT-TABLE
  4039     MOVE 'A'                    TO WS-CT-BEN-TYPE
  4040     MOVE LOW-VALUES             TO WS-CT-BEN-CODE
  4041     MOVE WS-CT-KEY              TO WS-CT-KEY-SAVE
  4042
  4043* EXEC CICS STARTBR
  4044*         DATASET    ('ERCTBL')
  4045*         RIDFLD     (WS-CT-KEY)
  4046*         GTEQ
  4047*         RESP       (WS-RESPONSE)
  4048*    END-EXEC
  4049     MOVE 'ERCTBL' TO DFHEIV1
  4050     MOVE 0
  4051       TO DFHEIV11
  4052*    MOVE '&,         G          &  N#00003942' TO DFHEIV0
  4053     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4054     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4055     MOVE X'204E233030303033393432' TO DFHEIV0(25:11)
  4056     CALL 'kxdfhei1' USING DFHEIV0,
  4057           DFHEIV1,
  4058           WS-CT-KEY,
  4059           DFHEIV99,
  4060           DFHEIV11,
  4061           DFHEIV99
  4062     MOVE EIBRESP  TO WS-RESPONSE
  4063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4064     .
  4065 0160-EXIT.
  4066     EXIT.
  4067 0165-ERCTBL-READNEXT.
  4068
  4069* EXEC CICS READNEXT
  4070*         INTO    (COMM-TABLE-RECORD)
  4071*         DATASET ('ERCTBL')
  4072*         RIDFLD  (WS-CT-KEY)
  4073*         RESP    (WS-RESPONSE)
  4074*    END-EXEC
  4075     MOVE LENGTH OF
  4076      COMM-TABLE-RECORD
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  72
* SOCK00.cbl
  4077       TO DFHEIV12
  4078     MOVE 'ERCTBL' TO DFHEIV1
  4079     MOVE 0
  4080       TO DFHEIV11
  4081*    MOVE '&.IL                  )  N#00003952' TO DFHEIV0
  4082     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4083     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4084     MOVE X'204E233030303033393532' TO DFHEIV0(25:11)
  4085     CALL 'kxdfhei1' USING DFHEIV0,
  4086           DFHEIV1,
  4087           COMM-TABLE-RECORD,
  4088           DFHEIV12,
  4089           WS-CT-KEY,
  4090           DFHEIV99,
  4091           DFHEIV11,
  4092           DFHEIV99,
  4093           DFHEIV99
  4094     MOVE EIBRESP  TO WS-RESPONSE
  4095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4096     IF (RESP-NORMAL)
  4097        AND (WS-CT-KEY (1:5) = WS-CT-KEY-SAVE (1:5))
  4098        PERFORM 0170-PROCESS-BEN-CODE
  4099                                 THRU 0170-EXIT
  4100     ELSE
  4101        SET END-OF-ERCTBL        TO TRUE
  4102     END-IF
  4103     .
  4104 0165-EXIT.
  4105     EXIT.
  4106 0170-PROCESS-BEN-CODE.
  4107     MOVE SPACES                 TO WS-CF-KEY
  4108     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  4109     MOVE '5'                    TO WS-CF-RECORD-TYPE
  4110     MOVE CT-BEN-CODE            TO WS-CF-ACCESS (3:2)
  4111     MOVE +0                     TO WS-CF-SEQ-NO
  4112     MOVE WS-CF-KEY              TO WS-CF-KEY-SAVE
  4113
  4114* EXEC CICS READ
  4115*         DATASET    ('ELCNTL')
  4116*         RIDFLD     (WS-CF-KEY)
  4117*         INTO       (CONTROL-FILE)
  4118*         GTEQ
  4119*         RESP       (WS-RESPONSE)
  4120*    END-EXEC
  4121     MOVE LENGTH OF
  4122      CONTROL-FILE
  4123       TO DFHEIV11
  4124     MOVE 'ELCNTL' TO DFHEIV1
  4125*    MOVE '&"IL       G          (  N#00003975' TO DFHEIV0
  4126     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4127     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4128     MOVE X'204E233030303033393735' TO DFHEIV0(25:11)
  4129     CALL 'kxdfhei1' USING DFHEIV0,
  4130           DFHEIV1,
  4131           CONTROL-FILE,
  4132           DFHEIV11,
  4133           WS-CF-KEY,
  4134           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  73
* SOCK00.cbl
  4135           DFHEIV99,
  4136           DFHEIV99
  4137     MOVE EIBRESP  TO WS-RESPONSE
  4138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4139     IF NOT RESP-NORMAL
  4140        MOVE WS-RESPONSE         TO WS-DISP-RESP
  4141        DISPLAY ' ERROR - ELCNTL - READ ' WS-DISP-RESP
  4142        GO TO 0170-EXIT
  4143     END-IF
  4144     IF WS-CF-KEY (1:4) = WS-CF-KEY-SAVE (1:4)
  4145        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  4146           (S2 > +8)
  4147           OR (CT-BEN-CODE = CF-BENEFIT-CODE (S2))
  4148        END-PERFORM
  4149        IF CT-BEN-CODE = CF-BENEFIT-CODE (S2)
  4150           IF CF-JOINT-INDICATOR (S2) = 'J'
  4151              IF WS-WORK-JAH-COMM = ZEROS
  4152                 MOVE CT-RT (1)  TO WS-WORK-JAH-COMM
  4153              END-IF
  4154           ELSE
  4155              IF WS-WORK-SAH-COMM = ZEROS
  4156                 MOVE CT-RT (1)  TO WS-WORK-SAH-COMM
  4157              END-IF
  4158           END-IF
  4159        END-IF
  4160     END-IF
  4161     .
  4162 0170-EXIT.
  4163     EXIT.
  4164 0200-GET-ERCOMP.
  4165     MOVE LOW-VALUES             TO WS-CO-KEY
  4166     MOVE AM-COMPANY-CD          TO WS-CO-COMPANY-CD
  4167     MOVE AM-CARRIER             TO WS-CO-CARRIER
  4168     MOVE AM-GROUPING            TO WS-CO-GROUP
  4169     MOVE WS-GA-NUM              TO WS-CO-FIN-RESP
  4170     MOVE LOW-VALUES             TO WS-CO-ACCOUNT
  4171     MOVE 'G'                    TO WS-CO-TYPE
  4172
  4173* EXEC CICS READ
  4174*         INTO    (COMPENSATION-MASTER)
  4175*         DATASET ('ERCOMP')
  4176*         RIDFLD  (WS-CO-KEY)
  4177*         RESP    (WS-RESPONSE)
  4178*    END-EXEC
  4179     MOVE LENGTH OF
  4180      COMPENSATION-MASTER
  4181       TO DFHEIV11
  4182     MOVE 'ERCOMP' TO DFHEIV1
  4183*    MOVE '&"IL       E          (  N#00004015' TO DFHEIV0
  4184     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4185     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4186     MOVE X'204E233030303034303135' TO DFHEIV0(25:11)
  4187     CALL 'kxdfhei1' USING DFHEIV0,
  4188           DFHEIV1,
  4189           COMPENSATION-MASTER,
  4190           DFHEIV11,
  4191           WS-CO-KEY,
  4192           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  74
* SOCK00.cbl
  4193           DFHEIV99,
  4194           DFHEIV99
  4195     MOVE EIBRESP  TO WS-RESPONSE
  4196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4197     IF RESP-NORMAL
  4198        MOVE CO-CONTROL-NAME     TO WS-GA-PRIMARY-CONTACT
  4199        MOVE CO-ACCT-NAME        TO WS-GA-NAME
  4200        MOVE CO-MAIL-NAME        TO WS-GA-MAIL-NAME
  4201        MOVE CO-ADDR-1           TO WS-GA-ADDR1
  4202        MOVE CO-ADDR-2           TO WS-GA-ADDR2
  4203*       MOVE CO-ADDR-3           TO WS-GA-ADDR3
  4204        MOVE SPACES              TO WS-GA-ADDR3
  4205        STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  4206           DELIMITED BY '  ' INTO WS-GA-ADDR3
  4207        END-STRING
  4208        MOVE CO-ZIP              TO WS-GA-ZIP
  4209        MOVE CO-TELEPHONE        TO WS-GA-PHONE
  4210     ELSE
  4211        MOVE SPACES              TO WS-GA-DATA
  4212        MOVE 'GA NOT FOUND '     TO WS-GA-NAME
  4213     END-IF
  4214     .
  4215 0200-EXIT.
  4216     EXIT.
  4217 0300-get-rates.
  4218     move +30                    to ws-send-msg-size
  4219     move ws-recv-buf (1:31)     to ws-get-rate-data
  4220     if rate-apr not numeric
  4221        move zeros               to rate-apr
  4222     end-if
  4223     move rate-apr               to ws-work-apr
  4224     if rate-ben-amt not numeric
  4225        move zeros               to rate-ben-amt
  4226     end-if
  4227     move rate-ben-amt           to ws-work-ben
  4228     if rate-term not numeric
  4229        move zeros               to rate-term
  4230     end-if
  4231     move rate-term              to ws-work-term
  4232     move rate-eff-date (7:4)    to ws-work-date (1:4)
  4233     move rate-eff-date (1:2)    to ws-work-date (5:2)
  4234     move rate-eff-date (4:2)    to ws-work-date (7:2)
  4235     move ws-work-date-num       to dc-greg-date-cymd
  4236     move 'L'                    to dc-option-code
  4237     perform 9700-date-link      thru 9700-exit
  4238     if no-conversion-error
  4239        move dc-bin-date-1       to ws-bin-eff-dt
  4240     else
  4241        move 'bad eff dt convert ' to ws-send-buf
  4242        go to send-rate-buf
  4243     end-if
  4244     move +1                     to dc-elapsed-months
  4245     move +0                     to dc-elapsed-days
  4246     move '6'                    to dc-option-code
  4247     perform 9700-date-link      thru 9700-exit
  4248     if no-conversion-error
  4249        move dc-bin-date-2       to ws-bin-1st-pay-dt
  4250     else
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  75
* SOCK00.cbl
  4251        move 'bad 1st dt convert ' to ws-send-buf
  4252        go to send-rate-buf
  4253     end-if
  4254*    move spaces                 to calculation-pass-area
  4255     move zeros                  to cp-r-max-mon-ben
  4256                                    cp-r-max-tot-ben
  4257                                    cp-class-code
  4258                                    cp-deviation-code
  4259                                    cp-rate-dev-pct
  4260                                    cp-original-premium
  4261                                    cp-critical-months
  4262                                    cp-term-or-ext-days
  4263     move rate-state             to cp-state
  4264                                    cp-state-std-abbrv
  4265     move rate-lf-ah             to cp-benefit-type
  4266     move rate-ben-code          to cp-benefit-cd
  4267     move ws-ben-num             to cp-original-benefit
  4268                                    cp-rating-benefit-amt
  4269     move 40                     to cp-issue-age
  4270     move WS-COMP-ID             to cp-company-id
  4271     move WS-COMP-CD             to cp-company-cd
  4272     move ws-apr-num             to cp-loan-apr
  4273     move ws-term-num            to cp-original-term
  4274                                    cp-loan-term
  4275                                    cp-remaining-term
  4276     move 'L'                    to cp-life-override-code
  4277     move 'A'                    to cp-ah-override-code
  4278     move '3'                    to cp-process-type
  4279     move rate-earn-meth         to cp-earning-method
  4280                                    cp-rating-method
  4281     move 'R'                    to cp-rate-file
  4282     move ws-bin-eff-dt          to cp-cert-eff-dt
  4283     move ws-bin-1st-pay-dt      to cp-first-pay-date
  4284     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  4285     if not no-cp-error
  4286        move cp-return-code      to ws-send-buf
  4287     else
  4288        move cp-calc-premium     to ws-disp-amt
  4289        move cp-premium-rate     to ws-disp-rate
  4290        string ws-disp-amt ';' ws-disp-rate delimited
  4291           by size into ws-send-buf
  4292        end-string
  4293     end-if
  4294     .
  4295 SEND-RATE-BUF.
  4296     display 'SOCK00:About to send      '
  4297     display 'SOCK00:sequence number  =', ws-seq-num.
  4298     display 'SOCK00:send buffer      =', ws-send-buf(1:30).
  4299     call "send" using by value GIVE-TAKE-SOCKET,
  4300         by reference ws-send-buf,
  4301         by value ws-send-msg-size,
  4302         by value ws-flags.
  4303     if return-code <= zero
  4304         display 'SOCK00:send error ',
  4305         go to socket-error.
  4306     GO TO SOCKET-FIN
  4307     .
  4308 0300-exit.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  76
* SOCK00.cbl
  4309     exit.
  4310 0400-GET-ACT-ACCTS.
  4311     MOVE WS-RECV-BUF (1:2)      TO CLIENT-ST
  4312     MOVE ' '                    TO WS-BUILD-SW
  4313     MOVE LOW-VALUES             TO WS-AM-KEY
  4314     MOVE WS-COMP-CD             TO WS-AM-COMPANY-CD
  4315     PERFORM 0410-STARTBR-ERACCT THRU 0410-EXIT
  4316     IF NOT RESP-NORMAL
  4317        MOVE 'BAD STARTBR ON ERACCT  '
  4318                                 TO WS-SEND-BUF
  4319        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4320        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4321        GO TO SEND-BUFFER
  4322     END-IF
  4323     PERFORM 0420-READNEXT-ERACCT
  4324                                 THRU 0420-EXIT
  4325     IF NOT RESP-NORMAL
  4326        MOVE 'BAD READNEXT ON ERACCT '
  4327                                 TO WS-SEND-BUF
  4328        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4329        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4330        GO TO SEND-BUFFER
  4331     ELSE
  4332        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  4333        MOVE AM-ACCOUNT          TO WS-SAVE-ACCOUNT
  4334     END-IF
  4335     PERFORM UNTIL END-OF-ERACCT
  4336        IF NOT (RESP-NORMAL)
  4337           OR (AM-COMPANY-CD > WS-COMP-CD)
  4338           SET END-OF-ERACCT     TO TRUE
  4339        ELSE
  4340           IF AM-ACCOUNT NOT = WS-SAVE-ACCOUNT
  4341              MOVE AM-EFFECTIVE-DT TO WS-BIN-ORIG-EFF-DT
  4342           END-IF
  4343           IF (AM-STATE = CLIENT-ST)
  4344              AND (AM-EXPIRATION-DT = HIGH-VALUES)
  4345*             AND (AM-STATUS = '0')
  4346              PERFORM 0030-BUILD-BUFFER
  4347                                 THRU 0030-EXIT
  4348              PERFORM 0430-SEND-BUFFER
  4349                                 THRU 0430-EXIT
  4350           END-IF
  4351           PERFORM 0420-READNEXT-ERACCT
  4352                                 THRU 0420-EXIT
  4353        END-IF
  4354     END-PERFORM
  4355     GO TO SOCKET-FIN
  4356     .
  4357 0400-EXIT.
  4358     EXIT.
  4359 0410-STARTBR-ERACCT.
  4360
  4361* EXEC CICS STARTBR
  4362*         DATASET    ('ERACCT')
  4363*         RIDFLD     (WS-AM-KEY)
  4364*         GTEQ
  4365*         RESP       (WS-RESPONSE)
  4366*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  77
* SOCK00.cbl
  4367     MOVE 'ERACCT' TO DFHEIV1
  4368     MOVE 0
  4369       TO DFHEIV11
  4370*    MOVE '&,         G          &  N#00004184' TO DFHEIV0
  4371     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4372     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4373     MOVE X'204E233030303034313834' TO DFHEIV0(25:11)
  4374     CALL 'kxdfhei1' USING DFHEIV0,
  4375           DFHEIV1,
  4376           WS-AM-KEY,
  4377           DFHEIV99,
  4378           DFHEIV11,
  4379           DFHEIV99
  4380     MOVE EIBRESP  TO WS-RESPONSE
  4381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4382     .
  4383 0410-EXIT.
  4384     EXIT.
  4385 0420-READNEXT-ERACCT.
  4386
  4387* EXEC CICS READNEXT
  4388*         INTO    (ACCOUNT-MASTER)
  4389*         DATASET ('ERACCT')
  4390*         RIDFLD  (WS-AM-KEY)
  4391*         RESP    (WS-RESPONSE)
  4392*    END-EXEC
  4393     MOVE LENGTH OF
  4394      ACCOUNT-MASTER
  4395       TO DFHEIV12
  4396     MOVE 'ERACCT' TO DFHEIV1
  4397     MOVE 0
  4398       TO DFHEIV11
  4399*    MOVE '&.IL                  )  N#00004194' TO DFHEIV0
  4400     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4401     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4402     MOVE X'204E233030303034313934' TO DFHEIV0(25:11)
  4403     CALL 'kxdfhei1' USING DFHEIV0,
  4404           DFHEIV1,
  4405           ACCOUNT-MASTER,
  4406           DFHEIV12,
  4407           WS-AM-KEY,
  4408           DFHEIV99,
  4409           DFHEIV11,
  4410           DFHEIV99,
  4411           DFHEIV99
  4412     MOVE EIBRESP  TO WS-RESPONSE
  4413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4414     .
  4415 0420-EXIT.
  4416     EXIT.
  4417 0430-SEND-BUFFER.
  4418     display 'SOCK00:About to send      '
  4419     display 'SOCK00:sequence number  =', ws-seq-num.
  4420     display 'SOCK00:send buffer      =', ws-send-buf(1:300).
  4421     call "send" using by value GIVE-TAKE-SOCKET,
  4422         by reference ws-send-buf,
  4423         by value ws-send-msg-size,
  4424         by value ws-flags.
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  78
* SOCK00.cbl
  4425     if return-code <= zero
  4426         display 'SOCK00:send error ',
  4427         go to socket-error.
  4428     .
  4429 0430-EXIT.
  4430     EXIT.
  4431 0500-GET-ONE-ACCT.
  4432     MOVE WS-COMP-CD             TO WS-AM-COMPANY-CD
  4433     MOVE CLIENT-CAR             TO WS-AM-CARRIER
  4434     MOVE CLIENT-GRP             TO WS-AM-GROUP
  4435     MOVE CLIENT-ST              TO WS-AM-STATE
  4436     MOVE CLIENT-ACT             TO WS-AM-ACCOUNT
  4437     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  4438     MOVE '5'                    TO DC-OPTION-CODE
  4439     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4440     MOVE DC-BIN-DATE-1          TO WS-AM-EXP-DT
  4441     MOVE LOW-VALUES             TO WS-AM-EXP-DT
  4442     MOVE ' '                    TO WS-BUILD-SW
  4443    PERFORM 0410-STARTBR-ERACCT THRU 0410-EXIT
  4444     IF NOT RESP-NORMAL
  4445        MOVE 'BAD STARTBR ON ERACCT  '
  4446                                 TO WS-SEND-BUF
  4447        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4448        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4449        GO TO SEND-BUFFER
  4450     END-IF
  4451     PERFORM 0420-READNEXT-ERACCT
  4452                                 THRU 0420-EXIT
  4453     IF NOT RESP-NORMAL
  4454        MOVE 'BAD READNEXT ON ERACCT '
  4455                                 TO WS-SEND-BUF
  4456        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4457        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4458        GO TO SEND-BUFFER
  4459     ELSE
  4460        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  4461        MOVE AM-ACCOUNT          TO WS-SAVE-ACCOUNT
  4462     END-IF
  4463     PERFORM UNTIL
  4464        (TIME-TO-BUILD)
  4465        IF AM-ACCOUNT = CLIENT-ACT
  4466           IF AM-EXPIRATION-DT = HIGH-VALUES
  4467              SET TIME-TO-BUILD  TO TRUE
  4468           ELSE
  4469              MOVE ACCOUNT-MASTER
  4470                                 TO WS-SAVE-ERACCT
  4471              PERFORM 0420-READNEXT-ERACCT
  4472                                 THRU 0420-EXIT
  4473              IF NOT RESP-NORMAL
  4474                 MOVE WS-SAVE-ERACCT
  4475                                 TO ACCOUNT-MASTER
  4476                 SET TIME-TO-BUILD
  4477                                 TO TRUE
  4478              END-IF
  4479           END-IF
  4480        ELSE
  4481           MOVE WS-SAVE-ERACCT   TO ACCOUNT-MASTER
  4482           SET TIME-TO-BUILD     TO TRUE
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  79
* SOCK00.cbl
  4483        END-IF
  4484     END-PERFORM
  4485     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4486     PERFORM 0430-SEND-BUFFER    THRU 0430-EXIT
  4487     GO TO SOCKET-FIN
  4488     .
  4489 0500-EXIT.
  4490     EXIT.
  4491 7000-GET-RATE.
  4492
  4493* EXEC CICS LINK
  4494*       PROGRAM ('ELRATE')
  4495*       COMMAREA (CALCULATION-PASS-AREA)
  4496*       LENGTH   (CP-COMM-LENGTH)
  4497*    END-EXEC
  4498     MOVE 'ELRATE' TO DFHEIV1
  4499*    MOVE '."C                   ''   #00004278' TO DFHEIV0
  4500     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4501     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4502     MOVE X'2020233030303034323738' TO DFHEIV0(25:11)
  4503     CALL 'kxdfhei1' USING DFHEIV0,
  4504           DFHEIV1,
  4505           CALCULATION-PASS-AREA,
  4506           CP-COMM-LENGTH,
  4507           DFHEIV99,
  4508           DFHEIV99,
  4509           DFHEIV99
  4510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4511     .
  4512 7000-EXIT.
  4513     EXIT.
  4514 9700-DATE-LINK.
  4515
  4516* EXEC CICS LINK
  4517*         PROGRAM  ('ELDATCV')
  4518*         COMMAREA (DATE-CONVERSION-DATA)
  4519*         LENGTH   (DC-COMM-LENGTH)
  4520*    END-EXEC.
  4521     MOVE 'ELDATCV' TO DFHEIV1
  4522*    MOVE '."C                   ''   #00004287' TO DFHEIV0
  4523     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4524     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4525     MOVE X'2020233030303034323837' TO DFHEIV0(25:11)
  4526     CALL 'kxdfhei1' USING DFHEIV0,
  4527           DFHEIV1,
  4528           DATE-CONVERSION-DATA,
  4529           DC-COMM-LENGTH,
  4530           DFHEIV99,
  4531           DFHEIV99,
  4532           DFHEIV99
  4533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4534
  4535 9700-EXIT.
  4536      EXIT.
  4537
  4538 9999-DFHBACK SECTION.
  4539     MOVE '9%                    "   ' TO DFHEIV0
  4540     MOVE 'SOCK00' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 04-Mar-11 09:56 Page  80
* SOCK00.cbl
  4541     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4542     GOBACK.
  4543 9999-DFHEXIT.
  4544     IF DFHEIGDJ EQUAL 0001
  4545         NEXT SENTENCE.
  4546     MOVE '9%                    "   ' TO DFHEIV0
  4547     MOVE 'SOCK00' TO DFHEIV1
  4548     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4549     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       16548     Code:        9987
