* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page   1
* EL677.cbl
* Options: int("EL677.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL677.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL677.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL677.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 ID DIVISION.
     3
     4 PROGRAM-ID.                 EL677.
     5*
     6*AUTHOR.     CSO
     7*            OMAHA, NEBRASKA.
     8
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page   2
* EL677.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*                                                                *
    17*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    TRANSACTION - EXF3 - CHECK MAINTENANCE
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    32* 021714  CR2014021700001  PEMA  ADD TEST DB FOR OTHER THAN cid1p
    33* 030414  IR2014030400001  PEMA  CHG PYAJ VOID TRANS TO R AND +
    34* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    35* 091615  CR2015082000001  PEMA  ADD TOTAL ENDT PROCESSING
    36* 020317  IR2016110900001  PEMA  FIXED MISC PROBLEMS
    37* 060717  CR2017032900002  PEMA  CHANGE TEST DB
    38* 111418  CR2018103100001  PEMA  ADD REISSUE CAPABILITY
    39* 040919  CR2019040900001  PEMA  FIX RETURN TO ON REISSUES
    40******************************************************************
    41 ENVIRONMENT DIVISION.
    42
    43 DATA DIVISION.
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  FILLER  PIC X(32)  VALUE '********************************'.
    47 77  FILLER  PIC X(32)  VALUE '*    EL677 WORKING STORAGE     *'.
    48 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    49 77  s1                          pic s999 comp-3 value +0.
    50 77  ws-tot-lf-prem              pic s9(7)v99 comp-3 value +0.
    51 77  ws-tot-iss-prem             pic s9(7)v99 comp-3 value +0.
    52 77  ws-tot-iss-comm             pic s9(7)v99 comp-3 value +0.
    53 77  ws-tot-ref-comm             pic s9(7)v99 comp-3 value +0.
    54 77  ws-browse-sw                pic x value spaces.
    55     88  i-say-when                 value 'Y'.
    56 77  ws-delete-sw                pic x value ' '.
    57     88  row-deleted                 value 'Y'.
    58 77  ws-sql-code                 pic s9(7) value zeros.
    59 77  ws-dis-sql-code             pic -9999999 value zeros.
    60 77  ws-match-sw                 pic x  value ' '.
    61     88  found-a-match             value 'Y'.
    62 77  ws-commit-sw                pic x value ' '.
    63     88  tbl-commited                value 'Y'.
    64 01  P pointer.
    65 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    66 01  var-ptr pointer.
    67 01  env-var-len                 pic 9(4)  binary.
    68
    69 01  WS-KIXSYS.
    70     05  WS-KIX-FIL1             PIC X(10).
    71     05  WS-KIX-APPS             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page   3
* EL677.cbl
    72     05  WS-KIX-ENV              PIC X(10).
    73     05  WS-KIX-MYENV            PIC X(10).
    74     05  WS-KIX-SYS              PIC X(10).
*   75 EXEC SQL
*   76    INCLUDE SQLDA
*   77 END-EXEC
    78 01 SQLDA sync.
    79    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    80    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    81    05 SQLN                  PIC S9(4) COMP-5 value 0.
    82    05 SQLD                  PIC S9(4) COMP-5 value 0.
    83    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    84       10 SQLTYPE            PIC S9(4) COMP-5.
    85       10 SQLLEN             PIC S9(4) COMP-5.
    86$IF P64 SET
    87X      *> For 64-bit environments, ensure that SQLDATA is
    88X      *> aligned on an 8-byte boundary.
    89X      10 FILLER             PIC S9(9) COMP-5.
    90$END
    91       10 SQLDATA            USAGE POINTER.
    92       10 SQLIND             USAGE POINTER.
    93       10 SQLNAME.
    94          15 SQLNAMEL        PIC S9(4) COMP-5.
    95          15 SQLNAMEC        PIC X(30).
    96
    97* Values for SQLTYPE
    98
    99 78  ESQL-DATE-CHAR              VALUE 384.
   100 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   101 78  ESQL-DATE-REC               VALUE 386.
   102 78  ESQL-DATE-REC-NULL          VALUE 387.
   103 78  ESQL-TIME-CHAR              VALUE 388.
   104 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   105 78  ESQL-TIME-REC               VALUE 390.
   106 78  ESQL-TIME-REC-NULL          VALUE 391.
   107 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   108 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   109 78  ESQL-TIMESTAMP-REC          VALUE 394.
   110 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   111 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   112 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   113 78  ESQL-TS-OFFSET-REC          VALUE 398.
   114 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   115 78  ESQL-LONGVARBINARY          VALUE 404.
   116 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   117 78  ESQL-LONGVARCHAR            VALUE 408.
   118 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   119 78  ESQL-BINARY                 VALUE 444.
   120 78  ESQL-BINARY-NULL            VALUE 445.
   121 78  ESQL-VARBINARY              VALUE 446.
   122 78  ESQL-VARBINARY-NULL         VALUE 447.
   123 78  ESQL-VARCHAR                VALUE 448.
   124 78  ESQL-VARCHAR-NULL           VALUE 449.
   125
   126 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   127 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   128
   129 78  ESQL-CHAR                   VALUE 452.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page   4
* EL677.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-CHAR-NULL              VALUE 453.
   131
   132 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   133 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   134
   135 78  ESQL-DOUBLE                 VALUE 480.
   136 78  ESQL-DOUBLE-NULL            VALUE 481.
   137 78  ESQL-REAL                   VALUE 482.
   138 78  ESQL-REAL-NULL              VALUE 483.
   139 78  ESQL-DECIMAL                VALUE 484.
   140 78  ESQL-DECIMAL-NULL           VALUE 485.
   141 78  ESQL-INTEGER                VALUE 496.
   142 78  ESQL-INTEGER-NULL           VALUE 497.
   143 78  ESQL-SMALLINT               VALUE 500.
   144 78  ESQL-SMALLINT-NULL          VALUE 501.
   145 78  ESQL-TINYINT                VALUE 502.
   146 78  ESQL-TINYINT-NULL           VALUE 503.
*  147 EXEC SQL
*  148    INCLUDE SQLCA
*  149 END-EXEC
   150 01 SQLCA.
   151     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   152     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   153     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   154     05  SQLERRM.
   155         49  SQLERRML    PIC S9(4) COMP-5.
   156         49  SQLERRMC    PIC X(70).
   157     05  SQLERRP         PIC X(8).
   158     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   159     05  SQLWARN.
   160         10  SQLWARN0    PIC X.
   161         10  SQLWARN1    PIC X.
   162         10  SQLWARN2    PIC X.
   163         10  SQLWARN3    PIC X.
   164         10  SQLWARN4    PIC X.
   165         10  SQLWARN5    PIC X.
   166         10  SQLWARN6    PIC X.
   167         10  SQLWARN7    PIC X.
   168     05  SQLEXT.
   169         10  SQLWARN8    PIC X.
   170         10  SQLWARN9    PIC X.
   171         10  SQLWARN10   PIC X.
   172         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   173     05  SQLSTATE    PIC X(5).
   174 EXEC SQL
   175    BEGIN DECLARE SECTION
   176 END-EXEC
   177 01  ws-paid-bank-work-area.
   178     05  ws-pb-compid            pic x(9).
   179     05  ws-pb-check-no          pic x(10).
   180     05  ws-pb-bad-check-no      pic x(10).
   181     05  ws-check-amount         pic x(10).
   182 01  Paid-Bank-Info.
   183     05  pb-check-no             pic 9(10).
   184     05  pb-tran-type            pic x.
   185     05  pb-bank-acct-desc       pic x(50).
   186     05  pb-amount               pic x(12).
   187     05  pb-paid-date            pic x(25).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page   5
* EL677.cbl
   188 01  ws-key-stuff.
   189     05  ws-compid               pic xxx.
   190     05  ws-carrier              pic x.
   191     05  ws-grouping             pic x(6).
   192     05  ws-state                pic xx.
   193     05  ws-account              pic x(10).
   194     05  ws-eff-date             pic x(10).
   195     05  ws-certificate          pic x(10).
   196     05  ws-cert-sfx             pic x.
   197     05  ws-seq-no               pic 999.
   198     05  ws-type                 pic x.
   199     05  ws-check-sub-type       pic x.
   200 01  svr                         pic x(32).
   201 01  usr                         pic x(32).
   202 01  pass                        pic x(32).
   203 01  usr-pass                    pic x(64).
   204 01  ws-disp-code                pic s9(11).
   205***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   206***                                                            ***
   207***  These indicators are used to determine if a variable      ***
   208***  is passed nulls from sql. The indicator will be -1        ***
   209***  if the value on sql is nulls and +0 if the value is       ***
   210***  something other than nulls. Here is an example on how     ***
   211***  to use the indicator variables.                           ***
   212***                                                            ***
   213***     EXEC SQL                                               ***
   214***        fetch checkapp into                                 ***
   215***           :db-app-status :nu-app-status,                   ***
   216***           :db-app-by     :nu-app-by,                       ***
   217***           :db-app-date   :nu-app-date,                     ***
   218***           :db-app-batch  :nu-app-batch                     ***
   219***     END-EXEC                                               ***
   220***                                                            ***
   221***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   222 01  indicator-vaiables-for-nulls.
   223     05  nu-app-status           pic s9(4) comp value +0.
   224     05  nu-app-by               pic s9(4) comp value +0.
   225     05  nu-app-date             pic s9(4) comp value +0.
   226     05  nu-app-batch            pic s9(4) comp value +0.
   227 01  daily-check-request-rec.
   228     05  db-compid               pic xxx.
   229     05  db-carrier              pic x.
   230     05  db-grouping             pic x(6).
   231     05  db-state                pic xx.
   232     05  db-account              pic x(10).
   233     05  db-effdate              pic x(10).
   234     05  db-certificate          pic x(10).
   235     05  db-cert-sfx             pic x.
   236     05  db-seq-no               pic 999.
   237     05  db-type                 pic x.
   238     05  db-amount-n             pic 9(7).99.
   239     05  db-amount redefines db-amount-n
   240                                 pic x(10).
   241     05  db-checkno              pic x(15).
   242     05  db-checkdate            pic x(10).
   243     05  db-checkstatus          pic 9(5).
   244     05  db-releasebatch         pic 9(5).
   245     05  db-releasedt            pic x(10).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page   6
* EL677.cbl
   246     05  db-releaseby            pic x(4).
   247     05  db-payeename1           pic x(30).
   248     05  db-payeename2           pic x(30).
   249     05  db-payeeaddr1           pic x(30).
   250     05  db-payeeaddr2           pic x(30).
   251     05  db-payeecity            pic x(30).
   252     05  db-payeest              pic xx.
   253     05  db-payeezip             pic x(10).
   254     05  db-fincar               pic x.
   255     05  db-fingrp               pic x(6).
   256     05  db-finresp              pic x(10).
   257     05  db-finacct              pic x(10).
   258     05  db-preparer             pic x(4).
   259     05  db-app-status           pic x(9).
   260     05  dp-app-status-n redefines db-app-status
   261                                 pic 9(9).
   262     05  db-app-by               pic x(20).
   263     05  db-app-date             pic x(30).
   264     05  db-app-batch            pic x(10).
   265     05  db-return-to            pic x(30).
   266     05  db-insured-name         pic x(30).
   267     05  db-check-sub-type       pic x.
   268 EXEC SQL
   269    END DECLARE SECTION
   270 END-EXEC
   271*                            COPY ELCSCTM.
   272******************************************************************
   273*                                                                *
   274*                                                                *
   275*                            ELCSCTM                             *
   276*                            VMOD=2.001                          *
   277*                                                                *
   278*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   279*                                                                *
   280******************************************************************
   281 01  SECURITY-MESSAGE.
   282     12  FILLER                          PIC X(30)
   283            VALUE '** LOGIC SECURITY VIOLATION -'.
   284     12  SM-READ                         PIC X(6).
   285     12  FILLER                          PIC X(5)
   286            VALUE ' PGM='.
   287     12  SM-PGM                          PIC X(6).
   288     12  FILLER                          PIC X(5)
   289            VALUE ' OPR='.
   290     12  SM-PROCESSOR-ID                 PIC X(4).
   291     12  FILLER                          PIC X(6)
   292            VALUE ' TERM='.
   293     12  SM-TERMID                       PIC X(4).
   294     12  FILLER                          PIC XX   VALUE SPACE.
   295     12  SM-JUL-DATE                     PIC 9(5).
   296     12  FILLER                          PIC X    VALUE SPACE.
   297     12  SM-TIME                         PIC 99.99.
   298
   299*                            COPY ELCSCRTY.
   300******************************************************************
   301*                                                                *
   302*                                                                *
   303*                            ELCSCRTY                            *
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page   7
* EL677.cbl
   304*                            VMOD=2.001                          *
   305*                                                                *
   306*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   307*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   308*        SAVED IN PI-SECURITY-ADDRESS.                           *
   309*                                                                *
   310******************************************************************
   311 01  SECURITY-CONTROL.
   312     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   313     12  FILLER                       PIC XX    VALUE 'SC'.
   314     12  SC-CREDIT-CODES.
   315         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   316             20  SC-CREDIT-DISPLAY    PIC X.
   317             20  SC-CREDIT-UPDATE     PIC X.
   318     12  SC-CLAIMS-CODES.
   319         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   320             20  SC-CLAIMS-DISPLAY    PIC X.
   321             20  SC-CLAIMS-UPDATE     PIC X.
   322 01  ws-dummy-erchek             pic x(600).
   323 01  filler.
   324     05  WS-CHECK-AMT-TMP        PIC Z(7).99.
   325     05  WS-CHECK-AMT-TMPX REDEFINES
   326         WS-CHECK-AMT-TMP        PIC X(10).
   327 01  ws-compare-erchek-key          pic x(33) value low-values.
   328 01  ws-eracct-sw                   pic x value ' '.
   329     88  eracct-found                 value 'Y'.
   330 01  ws-eracct-start-sw             pic x value ' '.
   331     88  eracct-start                 value 'Y'.
   332 01  WS-MISC-AREA.
   333     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   334     05  SAVE-CURRENT-DATE-MDY       PIC X(6)    VALUE SPACES.
   335     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   336
   337 01  ws-user-defined.
   338     05  ws-user-reason         pic xxx.
   339     05  ws-user-cert-no        pic x(11).
   340     05  ws-user-name           pic x(28).
   341 01  ws-hold-eracct-record       pic x(2000)  value spaces.
   342 01  STANDARD-AREAS.
   343     12  ws-connect-sw               pic x  value ' '.
   344         88  connected-to-db             value 'Y'.
   345     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
   346     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   347     12  EL677A                      PIC X(8)    VALUE 'EL677A'.
   348     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL677S'.
   349     12  SCREEN-NUMBER               PIC X(4)    VALUE '677A'.
   350     12  TRANS-ID                    PIC X(4)    VALUE 'EXF3'.
   351     12  EL6311-TRANS-ID             PIC X(4)    VALUE 'EXB1'.
   352     12  EL6318-TRANS-ID             PIC X(4)    VALUE 'EXBE'.
   353     12  THIS-PGM                    PIC X(8)    VALUE 'EL677'.
   354     12  PGM-NAME                    PIC X(8)   VALUE SPACES.
   355     12  TIME-IN                     PIC S9(7)  VALUE ZEROS.
   356     12  TIME-OUT-R  REDEFINES TIME-IN.
   357         16  FILLER                  PIC X.
   358         16  TIME-OUT                PIC 99V99.
   359         16  FILLER                  PIC XX.
   360     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   361     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page   8
* EL677.cbl
   362     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   363     12  XCTL-1273                   PIC X(8)    VALUE 'EL1273'.
   364     12  XCTL-114                    PIC X(8)    VALUE 'EL114'.
   365     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   366     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   367     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   368     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   369     12  ERACCT-FILE-ID              PIC X(8)    VALUE 'ERACCT'.
   370     12  ERCOMP-FILE-ID              PIC X(8)    VALUE 'ERCOMP'.
   371     12  ERCHEK-FILE-ID              PIC X(8)    VALUE 'ERCHEK'.
   372     12  ERPNDB-FILE-ID              PIC X(8)    VALUE 'ERPNDB'.
   373     12  ERPNDB-ALT-FILE-ID          PIC X(8)    VALUE 'ERPNDB2'.
   374     12  ELCERT-FILE-ID              PIC X(8)    VALUE 'ELCERT'.
   375     12  ERMAIL-FILE-ID              PIC X(8)    VALUE 'ERMAIL'.
   376     12  ERPYAJ-FILE-ID              PIC X(8)    VALUE 'ERPYAJ'.
   377     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +0    COMP.
   378     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   379     12  QID.
   380         16  QID-TERM                PIC X(4)    VALUE SPACES.
   381         16  FILLER                  PIC X(4)    VALUE '677A'.
   382
   383 01  WORK-AREAS.
   384     12  WS-AM-WORK                  PIC S9(8)V99 VALUE +0.
   385     12  WS-AM-WK REDEFINES WS-AM-WORK.
   386         16  WS-AM-NUM               PIC S9(7)V99.
   387         16  WS-AM-SIGN              PIC X.
   388     12  WS-CHECK-WORK.
   389         16  FILLER                  PIC X        VALUE SPACE.
   390         16  WS-CHECK-NO             PIC X(6)     VALUE SPACES.
   391     12  WS-CHK-PRINT-DT             PIC XX       VALUE LOW-VALUE.
   392     12  WS-SV-AMOUNT-PAID           PIC S9(7)V99 VALUE +0.
   393     12  WS-AMT                      PIC S9(7)V99 VALUE +0.
   394     12  WS-REFUND-AMOUNT            PIC S9(7)V99 VALUE +0.
   395     12  WS-DEEDIT-FIELD             PIC S9(9)V99 VALUE +0.
   396     12  WS-DT-DEEDIT-FIELD          PIC X(10)   VALUE ZERO.
   397     12  WS-DEEDIT-FIELD-DATE        REDEFINES
   398         WS-DT-DEEDIT-FIELD.
   399         16  FILLER                  PIC X(4).
   400         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   401     12  WS-DEEDIT-FIELD-A           PIC X(15)   VALUE ZERO.
   402     12  WS-DEEDIT-FIELD-V0          REDEFINES
   403         WS-DEEDIT-FIELD-A           PIC S9(15).
   404
   405     12  WS-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   406     12  WS-CERT-FOUND-SW            PIC X       VALUE 'N'.
   407         88 WS-CERT-FOUND                        VALUE 'Y'.
   408         88 WS-CERT-NOT-FOUND                    VALUE 'N'.
   409     12  WS-PNDB-FOUND-SW            PIC X       VALUE 'N'.
   410         88 WS-PNDB-FOUND                        VALUE 'Y'.
   411         88 WS-PNDB-NOT-FOUND                    VALUE 'N'.
   412     12  WS-PROCESS-CERT-SW          PIC X       VALUE SPACE.
   413         88  WS-PROCESS-CERT                     VALUE 'Y'.
   414     12  WS-PROCESS-BENEFICIARY-SW   PIC X       VALUE SPACE.
   415         88  WS-PROCESS-BENEFICIARY              VALUE 'Y'.
   416     12  WS-TMS-ENTRY-COMMENT.
   417         16  WS-TMS-PY-CERT          PIC X(10)   VALUE SPACES.
   418         16  FILLER                  PIC XX      VALUE SPACES.
   419         16  WS-TMS-PY-PAYEE         PIC X(18)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page   9
* EL677.cbl
   420     12  WS-ZIP-CODE.
   421         16  WS-ZIP-PRIME.
   422             20  WS-ZIP-PRI-1ST      PIC X.
   423                 88  WS-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   424             20  FILLER              PIC X(4).
   425         16  WS-ZIP-PLUS4            PIC X(4).
   426     12  WS-CANADIAN-POST-CODE1  REDEFINES  WS-ZIP-CODE.
   427         16  WS-CAN-POST1-1          PIC XXX.
   428         16  WS-CAN-POST1-2.
   429             20  WS-CAN-POST-4TH     PIC X.
   430             20  FILLER              PIC XX.
   431         16  FILLER                  PIC XXX.
   432     12  WS-CANADIAN-POST-CODE2  REDEFINES  WS-ZIP-CODE.
   433         16  WS-CAN-POST2-1          PIC XXX.
   434         16  FILLER                  PIC X.
   435         16  WS-CAN-POST2-2          PIC XXX.
   436         16  FILLER                  PIC XX.
   437
   438*                                    COPY ELCNWA.
   439*****************************************************************
   440*                                                               *
   441*                                                               *
   442*                            ELCNWA.                            *
   443*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   444*                            VMOD=2.003                         *
   445*                                                               *
   446*            M O V E   N A M E   W O R K   A R E A.             *
   447*                                                               *
   448*****************************************************************.
   449
   450 01  WS-NAME-WORK-AREA.
   451     05  WS-INSURED-LAST-NAME        PIC X(15).
   452     05  WS-INSURED-1ST-NAME         PIC X(12).
   453     05  WS-INSURED-MID-INIT         PIC X.
   454
   455     05  WS-NAME-WORK.
   456         10  WS-NW                   PIC X
   457             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   458
   459     05  WS-NAME-WORK2.
   460         10  WS-NW2                  PIC X
   461             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   462                                        NWA-INDEX0.
   463
   464     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   465                                     COMP-3.
   466
   467 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   468     88  RESP-NORMAL                    VALUE +0.
   469     88  resp-file-notfnd               value +12.
   470     88  RESP-NOTFND                    VALUE +13.
   471     88  resp-duprec                    value +14.
   472     88  resp-dupkey                    value +15.
   473     88  resp-invreq                    value +16.
   474     88  RESP-NOTOPEN                   VALUE +19.
   475     88  RESP-ENDFILE                   VALUE +20.
   476     88  resp-lengtherr                 value +22.
   477 01  ACCESS-KEYS.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  10
* EL677.cbl
   478     12  ELCNTL-KEY.
   479         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   480         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   481         16 ELCNTL-ACCESS.
   482             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   483             20  FILLER              PIC X       VALUE SPACES.
   484             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   485         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   486
   487     12  ERACCT-KEY.
   488         16  ERACCT-CO               PIC X       VALUE SPACES.
   489         16  ERACCT-CARRIER          PIC X       VALUE SPACES.
   490         16  ERACCT-GROUPING         PIC X(6)    VALUE SPACES.
   491         16  ERACCT-STATE            PIC XX      VALUE SPACES.
   492         16  ERACCT-ACCOUNT          PIC X(10)   VALUE SPACES.
   493         16  ERACCT-EXP-DATE         PIC XX      VALUE SPACES.
   494         16  ERACCT-EXP-DATE-FILLER  PIC X(4)    VALUE SPACES.
   495
   496     12  SAVE-ERACCT-KEY.
   497         16  SV-ACCT-CO              PIC X       VALUE SPACES.
   498         16  SV-ACCT-CARRIER         PIC X       VALUE SPACES.
   499         16  SV-ACCT-GROUPING        PIC X(6)    VALUE SPACES.
   500         16  SV-ACCT-STATE           PIC XX      VALUE SPACES.
   501         16  SV-ACCT-ACCOUNT         PIC X(10)   VALUE SPACES.
   502         16  SV-ACCT-EXP-DATE        PIC XX      VALUE SPACES.
   503         16  SV-ACCT-EXP-DATE-FILLER PIC X(4)    VALUE SPACES.
   504
   505     12  ERCOMP-KEY.
   506         16  ERCOMP-COMP-CD          PIC X       VALUE SPACE.
   507         16  ERCOMP-CARRIER          PIC X       VALUE SPACES.
   508         16  ERCOMP-GROUPING         PIC X(6)    VALUE SPACES.
   509         16  ERCOMP-FIN-RESP         PIC X(10)   VALUE SPACES.
   510         16  ERCOMP-ACCOUNT          PIC X(10)   VALUE SPACES.
   511         16  ERCOMP-RECORD-TYPE      PIC X       VALUE SPACES.
   512
   513     12  ELCERT-KEY.
   514         16 ELCERT-COMPANY-CD        PIC X       VALUE SPACES.
   515         16 ELCERT-CARRIER           PIC X       VALUE SPACES.
   516         16 ELCERT-GROUPING          PIC X(6)    VALUE SPACES.
   517         16 ELCERT-STATE             PIC XX      VALUE SPACES.
   518         16 ELCERT-ACCOUNT           PIC X(10)   VALUE SPACES.
   519         16 ELCERT-CERT-EFF-DT       PIC XX      VALUE SPACES.
   520         16 ELCERT-CERT-PRIME        PIC X(10)   VALUE SPACES.
   521         16 ELCERT-CERT-SFX          PIC X       VALUE SPACES.
   522
   523     12  ERPNDB-PRIMARY-KEY.
   524         16 ERPNDB-COMPANY-CD        PIC X       VALUE SPACES.
   525         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   526         16 ERPNDB-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   527         16 ERPNDB-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   528
   529     12  ERPNDB-ALT-KEY.
   530         16 ERPNDB-ALT-COMPANY-CD    PIC X       VALUE SPACES.
   531         16 ERPNDB-ALT-CARRIER       PIC X       VALUE SPACES.
   532         16 ERPNDB-ALT-GROUPING      PIC X(6)    VALUE SPACES.
   533         16 ERPNDB-ALT-STATE         PIC XX      VALUE SPACES.
   534         16 ERPNDB-ALT-ACCOUNT       PIC X(10)   VALUE SPACES.
   535         16 ERPNDB-ALT-CERT-EFF-DT   PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  11
* EL677.cbl
   536         16 ERPNDB-ALT-CERT-PRIME    PIC X(10)   VALUE SPACES.
   537         16 ERPNDB-ALT-CERT-SFX      PIC X       VALUE SPACES.
   538         16 ERPNDB-ALT-CH-SEQ-NO     PIC S9(4)   VALUE +0    COMP.
   539         16 ERPNDB-ALT-RECORD-TYPE   PIC X       VALUE SPACE.
   540
   541     12  ERCHEK-KEY.
   542         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   543         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   544         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   545         16  CHEK-STATE              PIC XX      VALUE SPACES.
   546         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   547         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   548         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   549         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   550         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   551
   552     12  ERCHEK-RECORD-LENGTH        PIC S9(4)   VALUE +600  COMP.
   553     12  ERPYAJ-KEY.
   554         16 PYAJ-COMPANY-CD          PIC X       VALUE LOW-VALUES.
   555         16 PYAJ-CARRIER             PIC X       VALUE SPACE.
   556         16 PYAJ-GROUPING            PIC X(06)   VALUE SPACES.
   557         16 PYAJ-FIN-RESP            PIC X(10)   VALUE SPACES.
   558         16 PYAJ-ACCOUNT             PIC X(10)   VALUE SPACES.
   559         16 PYAJ-FILE-SEQ-NO         PIC S9(8)   VALUE +0  COMP.
   560         16 PYAJ-RECORD-TYPE         PIC X       VALUE SPACE.
   561
   562 01  ERROR-NUMBERS.
   563     12  ER-0000                 PIC X(4)    VALUE '0000'.
   564     12  ER-0004                 PIC X(4)    VALUE '0004'.
   565     12  ER-0013                 PIC X(4)    VALUE '0013'.
   566     12  ER-0022                 PIC X(4)    VALUE '0022'.
   567     12  ER-0023                 PIC X(4)    VALUE '0023'.
   568     12  ER-0029                 PIC X(4)    VALUE '0029'.
   569     12  ER-0070                 PIC X(4)    VALUE '0070'.
   570     12  ER-0194                 PIC X(4)    VALUE '0194'.
   571     12  ER-0195                 PIC X(4)    VALUE '0195'.
   572     12  ER-0196                 PIC X(4)    VALUE '0196'.
   573     12  ER-0197                 PIC X(4)    VALUE '0197'.
   574     12  ER-0203                 PIC X(4)    VALUE '0203'.
   575     12  ER-0215                 PIC X(4)    VALUE '0215'.
   576     12  ER-0216                 PIC X(4)    VALUE '0216'.
   577     12  ER-0433                 PIC X(4)    VALUE '0433'.
   578     12  ER-1159                 PIC X(4)    VALUE '1159'.
   579     12  ER-1162                 PIC X(4)    VALUE '1162'.
   580     12  ER-2056                 PIC X(4)    VALUE '2056'.
   581     12  ER-2208                 PIC X(4)    VALUE '2208'.
   582     12  ER-2209                 PIC X(4)    VALUE '2209'.
   583     12  ER-2210                 PIC X(4)    VALUE '2210'.
   584     12  ER-2230                 PIC X(4)    VALUE '2230'.
   585     12  ER-2237                 PIC X(4)    VALUE '2237'.
   586     12  ER-2238                 PIC X(4)    VALUE '2238'.
   587     12  ER-2394                 PIC X(4)    VALUE '2394'.
   588     12  ER-2583                 PIC X(4)    VALUE '2583'.
   589     12  ER-2600                 PIC X(4)    VALUE '2600'.
   590     12  ER-2726                 PIC X(4)    VALUE '2726'.
   591     12  ER-2907                 PIC X(4)    VALUE '2907'.
   592     12  ER-2908                 PIC X(4)    VALUE '2908'.
   593     12  ER-3044                 PIC X(4)    VALUE '3044'.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  12
* EL677.cbl
   594     12  ER-3046                 PIC X(4)    VALUE '3046'.
   595     12  er-3274                 pic x(4)    value '3274'.
   596     12  er-3450                 pic x(4)    value '3450'.
   597     12  er-3451                 pic x(4)    value '3451'.
   598     12  er-3452                 pic x(4)    value '3452'.
   599     12  er-3453                 pic x(4)    value '3453'.
   600     12  er-3454                 pic x(4)    value '3454'.
   601     12  er-3455                 pic x(4)    value '3455'.
   602     12  er-3459                 pic x(4)    value '3459'.
   603     12  er-3460                 pic x(4)    value '3460'.
   604     12  er-9999                 pic x(4)    value '9999'.
   605*                                COPY ELCLOGOF.
   606******************************************************************
   607*                                                                *
   608*                                                                *
   609*                            ELCLOGOF.                           *
   610*                            VMOD=2.001                          *
   611*                                                                *
   612*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   613*                                                                *
   614******************************************************************
   615 01  CLASIC-LOGOFF.
   616     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   617     12  LOGOFF-TEXT.
   618         16  FILLER          PIC X(5)    VALUE SPACES.
   619         16  LOGOFF-MSG.
   620             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   621             20  FILLER      PIC X       VALUE SPACES.
   622             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   623         16  FILLER          PIC X(80)
   624           VALUE '* YOU ARE NOW LOGGED OFF'.
   625         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   626         16  FILLER          PIC X       VALUE QUOTE.
   627         16  LOGOFF-SYS-MSG  PIC X(17)
   628           VALUE 'S CLAS-IC SYSTEM '.
   629     12  TEXT-MESSAGES.
   630         16  UNACCESS-MSG    PIC X(29)
   631             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   632         16  PGMIDERR-MSG    PIC X(17)
   633             VALUE 'PROGRAM NOT FOUND'.
   634*                                COPY ELCDATE.
   635******************************************************************
   636*                                                                *
   637*                                                                *
   638*                            ELCDATE.                            *
   639*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   640*                            VMOD=2.003
   641*                                                                *
   642*                                                                *
   643*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   644*                 LENGTH = 200                                   *
   645******************************************************************
   646
   647 01  DATE-CONVERSION-DATA.
   648     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   649     12  DC-OPTION-CODE                PIC X.
   650         88  BIN-TO-GREG                VALUE ' '.
   651         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  13
* EL677.cbl
   652         88  EDIT-GREG-TO-BIN           VALUE '2'.
   653         88  YMD-GREG-TO-BIN            VALUE '3'.
   654         88  MDY-GREG-TO-BIN            VALUE '4'.
   655         88  JULIAN-TO-BIN              VALUE '5'.
   656         88  BIN-PLUS-ELAPSED           VALUE '6'.
   657         88  FIND-CENTURY               VALUE '7'.
   658         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   659         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   660         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   661         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   662         88  JULIAN-TO-BIN-3            VALUE 'C'.
   663         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   664         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   665         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   666         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   667         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   668         88  CHECK-LEAP-YEAR            VALUE 'H'.
   669         88  BIN-3-TO-GREG              VALUE 'I'.
   670         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   671         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   672         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   673         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   674         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   675         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   676         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   677         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   678         88  THREE-CHARACTER-BIN
   679                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   680         88  GREGORIAN-TO-BIN
   681                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   682         88  BIN-TO-GREGORIAN
   683                  VALUES ' ' '1' 'I' '8' 'G'.
   684         88  JULIAN-TO-BINARY
   685                  VALUES '5' 'C' 'E' 'F'.
   686     12  DC-ERROR-CODE                 PIC X.
   687         88  NO-CONVERSION-ERROR        VALUE ' '.
   688         88  DATE-CONVERSION-ERROR
   689                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   690         88  DATE-IS-ZERO               VALUE '1'.
   691         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   692         88  DATE-IS-INVALID            VALUE '3'.
   693         88  DATE1-GREATER-DATE2        VALUE '4'.
   694         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   695         88  DATE-INVALID-OPTION        VALUE '9'.
   696         88  INVALID-CENTURY            VALUE 'A'.
   697         88  ONLY-CENTURY               VALUE 'B'.
   698         88  ONLY-LEAP-YEAR             VALUE 'C'.
   699         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   700     12  DC-END-OF-MONTH               PIC X.
   701         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   702     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   703         88  USE-NORMAL-PROCESS         VALUE ' '.
   704         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   705         88  ADJUST-UP-100-YRS          VALUE '2'.
   706     12  FILLER                        PIC X.
   707     12  DC-CONVERSION-DATES.
   708         16  DC-BIN-DATE-1             PIC XX.
   709         16  DC-BIN-DATE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  14
* EL677.cbl
   710         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   711         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   712                       DC-GREG-DATE-1-EDIT.
   713             20  DC-EDIT1-MONTH        PIC 99.
   714             20  SLASH1-1              PIC X.
   715             20  DC-EDIT1-DAY          PIC 99.
   716             20  SLASH1-2              PIC X.
   717             20  DC-EDIT1-YEAR         PIC 99.
   718         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   719         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   720                     DC-GREG-DATE-2-EDIT.
   721             20  DC-EDIT2-MONTH        PIC 99.
   722             20  SLASH2-1              PIC X.
   723             20  DC-EDIT2-DAY          PIC 99.
   724             20  SLASH2-2              PIC X.
   725             20  DC-EDIT2-YEAR         PIC 99.
   726         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   727         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   728                     DC-GREG-DATE-1-YMD.
   729             20  DC-YMD-YEAR           PIC 99.
   730             20  DC-YMD-MONTH          PIC 99.
   731             20  DC-YMD-DAY            PIC 99.
   732         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   733         16  DC-GREG-DATE-1-MDY-R REDEFINES
   734                      DC-GREG-DATE-1-MDY.
   735             20  DC-MDY-MONTH          PIC 99.
   736             20  DC-MDY-DAY            PIC 99.
   737             20  DC-MDY-YEAR           PIC 99.
   738         16  DC-GREG-DATE-1-ALPHA.
   739             20  DC-ALPHA-MONTH        PIC X(10).
   740             20  DC-ALPHA-DAY          PIC 99.
   741             20  FILLER                PIC XX.
   742             20  DC-ALPHA-CENTURY.
   743                 24 DC-ALPHA-CEN-N     PIC 99.
   744             20  DC-ALPHA-YEAR         PIC 99.
   745         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   746         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   747         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   748         16  DC-JULIAN-DATE            PIC 9(05).
   749         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   750                                       PIC 9(05).
   751         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   752             20  DC-JULIAN-YEAR        PIC 99.
   753             20  DC-JULIAN-DAYS        PIC 999.
   754         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   755         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   756         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   757     12  DATE-CONVERSION-VARIBLES.
   758         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   759         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   760             20  FILLER                PIC 9(3).
   761             20  HOLD-CEN-1-CCYY.
   762                 24  HOLD-CEN-1-CC     PIC 99.
   763                 24  HOLD-CEN-1-YY     PIC 99.
   764             20  HOLD-CEN-1-MO         PIC 99.
   765             20  HOLD-CEN-1-DA         PIC 99.
   766         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   767             20  HOLD-CEN-1-R-MO       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  15
* EL677.cbl
   768             20  HOLD-CEN-1-R-DA       PIC 99.
   769             20  HOLD-CEN-1-R-CCYY.
   770                 24  HOLD-CEN-1-R-CC   PIC 99.
   771                 24  HOLD-CEN-1-R-YY   PIC 99.
   772             20  FILLER                PIC 9(3).
   773         16  HOLD-CENTURY-1-X.
   774             20  FILLER                PIC X(3)  VALUE SPACES.
   775             20  HOLD-CEN-1-X-CCYY.
   776                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   777                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   778             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   779             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   780         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   781             20  HOLD-CEN-1-R-X-MO     PIC XX.
   782             20  HOLD-CEN-1-R-X-DA     PIC XX.
   783             20  HOLD-CEN-1-R-X-CCYY.
   784                 24  HOLD-CEN-1-R-X-CC PIC XX.
   785                 24  HOLD-CEN-1-R-X-YY PIC XX.
   786             20  FILLER                PIC XXX.
   787         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   788         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   789         16  DC-JULIAN-DATE-1          PIC 9(07).
   790         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   791             20  DC-JULIAN-1-CCYY.
   792                 24  DC-JULIAN-1-CC    PIC 99.
   793                 24  DC-JULIAN-1-YR    PIC 99.
   794             20  DC-JULIAN-DA-1        PIC 999.
   795         16  DC-JULIAN-DATE-2          PIC 9(07).
   796         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   797             20  DC-JULIAN-2-CCYY.
   798                 24  DC-JULIAN-2-CC    PIC 99.
   799                 24  DC-JULIAN-2-YR    PIC 99.
   800             20  DC-JULIAN-DA-2        PIC 999.
   801         16  DC-GREG-DATE-A-EDIT.
   802             20  DC-EDITA-MONTH        PIC 99.
   803             20  SLASHA-1              PIC X VALUE '/'.
   804             20  DC-EDITA-DAY          PIC 99.
   805             20  SLASHA-2              PIC X VALUE '/'.
   806             20  DC-EDITA-CCYY.
   807                 24  DC-EDITA-CENT     PIC 99.
   808                 24  DC-EDITA-YEAR     PIC 99.
   809         16  DC-GREG-DATE-B-EDIT.
   810             20  DC-EDITB-MONTH        PIC 99.
   811             20  SLASHB-1              PIC X VALUE '/'.
   812             20  DC-EDITB-DAY          PIC 99.
   813             20  SLASHB-2              PIC X VALUE '/'.
   814             20  DC-EDITB-CCYY.
   815                 24  DC-EDITB-CENT     PIC 99.
   816                 24  DC-EDITB-YEAR     PIC 99.
   817         16  DC-GREG-DATE-CYMD         PIC 9(08).
   818         16  DC-GREG-DATE-CYMD-R REDEFINES
   819                              DC-GREG-DATE-CYMD.
   820             20  DC-CYMD-CEN           PIC 99.
   821             20  DC-CYMD-YEAR          PIC 99.
   822             20  DC-CYMD-MONTH         PIC 99.
   823             20  DC-CYMD-DAY           PIC 99.
   824         16  DC-GREG-DATE-MDCY         PIC 9(08).
   825         16  DC-GREG-DATE-MDCY-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  16
* EL677.cbl
   826                              DC-GREG-DATE-MDCY.
   827             20  DC-MDCY-MONTH         PIC 99.
   828             20  DC-MDCY-DAY           PIC 99.
   829             20  DC-MDCY-CEN           PIC 99.
   830             20  DC-MDCY-YEAR          PIC 99.
   831    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   832        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   833    12  DC-EL310-DATE                  PIC X(21).
   834    12  FILLER                         PIC X(28).
   835*                                COPY ELCATTR.
   836******************************************************************
   837*                                                                *
   838*                            ELCATTR.                            *
   839*                            VMOD=2.001                          *
   840*                                                                *
   841*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   842*                                                                *
   843*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   844*                                                                *
   845*                   POS 1   P=PROTECTED                          *
   846*                           U=UNPROTECTED                        *
   847*                           S=ASKIP                              *
   848*                   POS 2   A=ALPHA/NUMERIC                      *
   849*                           N=NUMERIC                            *
   850*                   POS 3   N=NORMAL                             *
   851*                           B=BRIGHT                             *
   852*                           D=DARK                               *
   853*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   854*                           OF=MODIFIED DATA TAG OFF             *
   855*                                                                *
   856*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   857******************************************************************
   858 01  ATTRIBUTE-LIST.
   859     12  AL-PABOF            PIC X       VALUE 'Y'.
   860     12  AL-PABON            PIC X       VALUE 'Z'.
   861     12  AL-PADOF            PIC X       VALUE '%'.
   862     12  AL-PADON            PIC X       VALUE '_'.
   863     12  AL-PANOF            PIC X       VALUE '-'.
   864     12  AL-PANON            PIC X       VALUE '/'.
   865     12  AL-SABOF            PIC X       VALUE '8'.
   866     12  AL-SABON            PIC X       VALUE '9'.
   867     12  AL-SADOF            PIC X       VALUE '@'.
   868     12  AL-SADON            PIC X       VALUE QUOTE.
   869     12  AL-SANOF            PIC X       VALUE '0'.
   870     12  AL-SANON            PIC X       VALUE '1'.
   871     12  AL-UABOF            PIC X       VALUE 'H'.
   872     12  AL-UABON            PIC X       VALUE 'I'.
   873     12  AL-UADOF            PIC X       VALUE '<'.
   874     12  AL-UADON            PIC X       VALUE '('.
   875     12  AL-UANOF            PIC X       VALUE ' '.
   876     12  AL-UANON            PIC X       VALUE 'A'.
   877     12  AL-UNBOF            PIC X       VALUE 'Q'.
   878     12  AL-UNBON            PIC X       VALUE 'R'.
   879     12  AL-UNDOF            PIC X       VALUE '*'.
   880     12  AL-UNDON            PIC X       VALUE ')'.
   881     12  AL-UNNOF            PIC X       VALUE '&'.
   882     12  AL-UNNON            PIC X       VALUE 'J'.
   883*                                COPY ELCEMIB.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  17
* EL677.cbl
   884******************************************************************
   885*                                                                *
   886*                                                                *
   887*                            ELCEMIB.                            *
   888*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   889*                            VMOD=2.005                          *
   890*                                                                *
   891*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   892*                                                                *
   893******************************************************************
   894 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   895     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   896     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   897     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   898     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   899     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   900     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   901     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   902     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   903     12  EMI-SWITCH1             PIC X        VALUE '1'.
   904         88  EMI-NO-ERRORS                    VALUE '1'.
   905         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   906         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   907     12  EMI-SWITCH2             PIC X        VALUE '1'.
   908         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   909     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   910         88  EMI-AREA1-EMPTY                  VALUE '1'.
   911         88  EMI-AREA1-FULL                   VALUE '2'.
   912     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   913         88  EMI-AREA2-EMPTY                  VALUE '1'.
   914         88  EMI-AREA2-FULL                   VALUE '2'.
   915     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   916         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   917         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   918         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   919         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   920         88  EMI-BYPASS-FATALS                VALUE 'X'.
   921     12  EMI-ERROR-LINES.
   922         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   923         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   924         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   925         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   926             20  EMI-ERR-CODES OCCURS 10 TIMES.
   927                 24  EMI-ERR-NUM         PIC X(4).
   928                 24  EMI-FILLER          PIC X.
   929                 24  EMI-SEV             PIC X.
   930                 24  FILLER              PIC X.
   931             20  FILLER                  PIC X(02).
   932     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   933         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   934             20  EMI-ERROR-NUMBER    PIC X(4).
   935             20  EMI-FILL            PIC X.
   936             20  EMI-SEVERITY        PIC X.
   937             20  FILLER              PIC X.
   938             20  EMI-ERROR-TEXT.
   939                 24  EMI-TEXT-VARIABLE   PIC X(10).
   940                 24  FILLER          PIC X(55).
   941     12  EMI-SEVERITY-SAVE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  18
* EL677.cbl
   942         88  EMI-NOTE                    VALUE 'N'.
   943         88  EMI-WARNING                 VALUE 'W'.
   944         88  EMI-FORCABLE                VALUE 'F'.
   945         88  EMI-FATAL                   VALUE 'X'.
   946     12  EMI-MESSAGE-FLAG            PIC X.
   947         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   948         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   949     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   950     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   951         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   952         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   953         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   954     12  emi-claim-no                pic x(7).
   955     12  emi-claim-type              pic x(6).
   956     12  FILLER                      PIC X(124)  VALUE SPACES.
   957     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   958     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   959     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   960     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   961*                                COPY ELCINTF.
   962******************************************************************
   963*                                                                *
   964*                                                                *
   965*                            ELCINTF.                            *
   966*                            VMOD=2.017                          *
   967*                                                                *
   968*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   969*                                                                *
   970*       LENGTH = 1024                                            *
   971*                                                                *
   972******************************************************************
   973*                   C H A N G E   L O G
   974*
   975* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   976*-----------------------------------------------------------------
   977*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   978* EFFECTIVE    NUMBER
   979*-----------------------------------------------------------------
   980* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   981******************************************************************
   982 01  PROGRAM-INTERFACE-BLOCK.
   983     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   984     12  PI-CALLING-PROGRAM              PIC X(8).
   985     12  PI-SAVED-PROGRAM-1              PIC X(8).
   986     12  PI-SAVED-PROGRAM-2              PIC X(8).
   987     12  PI-SAVED-PROGRAM-3              PIC X(8).
   988     12  PI-SAVED-PROGRAM-4              PIC X(8).
   989     12  PI-SAVED-PROGRAM-5              PIC X(8).
   990     12  PI-SAVED-PROGRAM-6              PIC X(8).
   991     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   992     12  PI-COMPANY-ID                   PIC XXX.
   993     12  PI-COMPANY-CD                   PIC X.
   994
   995     12  PI-COMPANY-PASSWORD             PIC X(8).
   996
   997     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   998
   999     12  PI-CONTROL-IN-PROGRESS.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  19
* EL677.cbl
  1000         16  PI-CARRIER                  PIC X.
  1001         16  PI-GROUPING                 PIC X(6).
  1002         16  PI-STATE                    PIC XX.
  1003         16  PI-ACCOUNT                  PIC X(10).
  1004         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1005                                         PIC X(10).
  1006         16  PI-CLAIM-CERT-GRP.
  1007             20  PI-CLAIM-NO             PIC X(7).
  1008             20  PI-CERT-NO.
  1009                 25  PI-CERT-PRIME       PIC X(10).
  1010                 25  PI-CERT-SFX         PIC X.
  1011             20  PI-CERT-EFF-DT          PIC XX.
  1012         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1013             20  PI-PLAN-CODE            PIC X(2).
  1014             20  PI-REVISION-NUMBER      PIC X(3).
  1015             20  PI-PLAN-EFF-DT          PIC X(2).
  1016             20  PI-PLAN-EXP-DT          PIC X(2).
  1017             20  FILLER                  PIC X(11).
  1018         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1019             20  PI-OE-REFERENCE-1.
  1020                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1021                 25  PI-OE-REF-1-SUFF    PIC XX.
  1022
  1023     12  PI-SESSION-IN-PROGRESS          PIC X.
  1024         88  CLAIM-SESSION                   VALUE '1'.
  1025         88  CREDIT-SESSION                  VALUE '2'.
  1026         88  WARRANTY-SESSION                VALUE '3'.
  1027         88  MORTGAGE-SESSION                VALUE '4'.
  1028         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1029
  1030
  1031*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1032
  1033     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1034     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1035
  1036     12  PI-CREDIT-USER                  PIC X.
  1037         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1038         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1039
  1040     12  PI-CLAIM-USER                   PIC X.
  1041         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1042         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1043
  1044     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1045         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1046         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1047         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1048         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1049         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1050
  1051     12  PI-PROCESSOR-ID                 PIC X(4).
  1052
  1053     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1054
  1055     12  PI-MEMBER-CAPTION               PIC X(10).
  1056
  1057     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  20
* EL677.cbl
  1058         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1059
  1060     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1061     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1062     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1063     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1064
  1065     12  PI-AH-OVERRIDE-L1               PIC X.
  1066     12  PI-AH-OVERRIDE-L2               PIC XX.
  1067     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1068     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1069
  1070     12  PI-NEW-SYSTEM                   PIC X(2).
  1071
  1072     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1073     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1074         88  PI-USES-PAID-TO                 VALUE '1'.
  1075     12  PI-CRDTCRD-SYSTEM.
  1076         16  PI-CRDTCRD-USER             PIC X.
  1077             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1078             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1079         16  PI-CC-MONTH-END-DT          PIC XX.
  1080     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1081
  1082     12  PI-OE-REFERENCE-2.
  1083         16  PI-OE-REF-2-PRIME           PIC X(10).
  1084         16  PI-OE-REF-2-SUFF            PIC X.
  1085
  1086     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1087
  1088     12  PI-LANGUAGE-TYPE                PIC X.
  1089             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1090             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1091             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1092
  1093     12  PI-POLICY-LINKAGE-IND           PIC X.
  1094         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1095         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1096                                                   LOW-VALUES.
  1097
  1098     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1099     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1100         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1101         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1102
  1103     12  PI-PROCESSOR-CSR-IND            PIC X.
  1104         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1105         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1106
  1107     12  FILLER                          PIC X(3).
  1108
  1109     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1110
  1111     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1112         PI-SYSTEM-LEVEL.
  1113
  1114         16  PI-ENTRY-CODES.
  1115             20  PI-ENTRY-CD-1           PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  21
* EL677.cbl
  1116             20  PI-ENTRY-CD-2           PIC X.
  1117
  1118         16  PI-RETURN-CODES.
  1119             20  PI-RETURN-CD-1          PIC X.
  1120             20  PI-RETURN-CD-2          PIC X.
  1121
  1122         16  PI-UPDATE-STATUS-SAVE.
  1123             20  PI-UPDATE-BY            PIC X(4).
  1124             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1125
  1126         16  PI-LOWER-CASE-LETTERS       PIC X.
  1127             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1128
  1129*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1130*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1131*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1132
  1133         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1134             88  ST-ACCNT-CNTL               VALUE ' '.
  1135             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1136             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1137             88  ACCNT-CNTL                  VALUE '3'.
  1138             88  CARR-ACCNT-CNTL             VALUE '4'.
  1139
  1140         16  PI-PROCESSOR-CAP-LIST.
  1141             20  PI-SYSTEM-CONTROLS.
  1142                24 PI-SYSTEM-DISPLAY     PIC X.
  1143                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1144                24 PI-SYSTEM-MODIFY      PIC X.
  1145                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1146             20  FILLER                  PIC XX.
  1147             20  PI-DISPLAY-CAP          PIC X.
  1148                 88  DISPLAY-CAP             VALUE 'Y'.
  1149             20  PI-MODIFY-CAP           PIC X.
  1150                 88  MODIFY-CAP              VALUE 'Y'.
  1151             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1152                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1153             20  PI-FORCE-CAP            PIC X.
  1154                 88  FORCE-CAP               VALUE 'Y'.
  1155
  1156         16  PI-PROGRAM-CONTROLS.
  1157             20  PI-PGM-PRINT-OPT        PIC X.
  1158             20  PI-PGM-FORMAT-OPT       PIC X.
  1159             20  PI-PGM-PROCESS-OPT      PIC X.
  1160             20  PI-PGM-TOTALS-OPT       PIC X.
  1161
  1162         16  PI-HELP-INTERFACE.
  1163             20  PI-LAST-ERROR-NO        PIC X(4).
  1164             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1165
  1166         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1167             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1168
  1169         16  PI-CR-CONTROL-IN-PROGRESS.
  1170             20  PI-CR-CARRIER           PIC X.
  1171             20  PI-CR-GROUPING          PIC X(6).
  1172             20  PI-CR-STATE             PIC XX.
  1173             20  PI-CR-ACCOUNT           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  22
* EL677.cbl
  1174             20  PI-CR-FIN-RESP          PIC X(10).
  1175             20  PI-CR-TYPE              PIC X.
  1176
  1177         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1178
  1179         16  PI-CR-MONTH-END-DT          PIC XX.
  1180
  1181         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1182             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1183             88  PI-ZERO-CARRIER             VALUE '1'.
  1184             88  PI-ZERO-GROUPING            VALUE '2'.
  1185             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1186
  1187         16  PI-CARRIER-SECURITY         PIC X.
  1188             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1189
  1190         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1191             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1192             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1193
  1194         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1195             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1196                                         INDEXED BY PI-ACCESS-NDX
  1197                                         PIC X.
  1198
  1199         16  PI-GA-BILLING-CONTROL       PIC X.
  1200             88  PI-GA-BILLING               VALUE '1'.
  1201
  1202         16  PI-MAIL-PROCESSING          PIC X.
  1203             88  PI-MAIL-YES                 VALUE 'Y'.
  1204
  1205         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1206
  1207         16  PI-AR-SYSTEM.
  1208             20  PI-AR-PROCESSING-CNTL   PIC X.
  1209                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1210             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1211             20  PI-AR-MONTH-END-DT      PIC XX.
  1212
  1213         16  PI-MP-SYSTEM.
  1214             20  PI-MORTGAGE-USER            PIC X.
  1215                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1216                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1217             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1218                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1219                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1220                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1221                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1222                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1223             20  PI-MP-MONTH-END-DT          PIC XX.
  1224             20  PI-MP-REFERENCE-NO.
  1225                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1226                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1227
  1228         16  PI-LABEL-CONTROL            PIC X(01).
  1229             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1230             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1231
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  23
* EL677.cbl
  1232         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1233             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1234
  1235         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1236             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1237             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1238
  1239         16  FILLER                      PIC X(14).
  1240
  1241     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1242******************************************************************
  1243     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1244         16  PI-EOF-SW               PIC X.
  1245             88  PI-FILE-EOF                     VALUE 'Y'.
  1246         16  PI-PREV-MAINT           PIC X.
  1247         16  PI-WORK-SEQ-NO          PIC S9(9)   COMP-3.
  1248         16  PI-ERCHEK-KEY.
  1249             20  PI-CHEK-COMP-CD     PIC X.
  1250             20  PI-CHEK-CARRIER     PIC X.
  1251             20  PI-CHEK-GROUPING    PIC X(6).
  1252             20  PI-CHEK-STATE       PIC XX.
  1253             20  PI-CHEK-ACCOUNT     PIC X(10).
  1254             20  PI-CHEK-EFF-DT      PIC XX.
  1255             20  PI-CHEK-CERT-NO     PIC X(10).
  1256             20  PI-CHEK-SUF-NO      PIC X.
  1257             20  PI-CHEK-SEQUENCE    PIC S9(4)  COMP.
  1258         16  PI-ACCOUNT-ADDRESS.
  1259             20  PI-AM-NAME          PIC X(30).
  1260             20  PI-AM-ADDRS         PIC X(30).
  1261             20  PI-AM-CITY-st.
  1262                 24  pi-am-city      PIC X(28).
  1263                 24  pi-am-st        pic xx.
  1264             20  PI-AM-ZIP-CODE.
  1265                 24  PI-AM-ZIP-PRIME PIC X(5).
  1266                 24  PI-AM-ZIP-PLUS4 PIC X(4).
  1267         16  PI-PROCESS-CERT-SW          PIC X.
  1268             88  PI-PROCESS-CERT                     VALUE 'Y'.
  1269         16  PI-PROCESS-BENEFICIARY-SW   PIC X.
  1270             88  PI-PROCESS-BENEFICIARY              VALUE 'Y'.
  1271         16  PI-PAYTO1                   PIC X(30).
  1272         16  PI-REFERENCE                PIC X(12).
  1273         16  PI-CANC-DT                  PIC XX.
  1274         16  PI-LF-REFUND                PIC S9(7)V99  COMP-3.
  1275         16  PI-AH-REFUND                PIC S9(7)V99  COMP-3.
  1276         16  PI-INSURED-NAME             PIC X(28).
  1277         16  PI-PFKEY                    PIC XXX.
  1278             88  PI-TO-EL1273-FROM-EL677        VALUE 'PF3'.
  1279             88  PI-TO-EL677-FROM-EL1273        VALUE 'PF8'.
  1280         16  PI-AMOUNT                   PIC S9(9)V99  COMP-3.
  1281         16  PI-TYPE                     PIC X.
  1282         16  pi-prev-paid                pic s9(7)v99 comp-3.
  1283         16  pi-refund-on-pending-rec    pic s9(7)v99 comp-3.
  1284         16  pi-ue-comm                  pic s9(7)v99 comp-3.
  1285         16  pi-chek-rec-cnt             pic s999 comp-3.
  1286         16  pi-am-csr                   pic x(4).
  1287         16  pi-return-to                pic x(30).
  1288         16  pi-prev-ded-comm            pic x.
  1289         16  pi-table-name               pic x(30).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  24
* EL677.cbl
  1290         16  pi-check-cashed             pic x.
  1291         16  pi-endt-prm-diff            pic s9(7)v99 comp-3.
  1292         16  pi-endt-com-diff            pic s9(5)v99 comp-3.
  1293         16  pi-check-type               pic x.
  1294             88  pi-corr-check              value 'C'.
  1295             88  pi-ref-check               value 'R'.
  1296         16  pi-check-cut                pic x.
  1297         16  pi-prev-paid-this-month     pic s9(7)v99 comp-3.
  1298         16  pi-previous-deduct-comm     pic x.
  1299         16  pi-void-reissue-pass        pic x.
  1300             88  pi-void-complete           value '1'.
  1301             88  pi-address-selected        value '2'.
  1302         16  pi-void-reissue-amt         pic s9(7)v99 comp-3.
  1303         16  FILLER                      PIC X(304). *> wass 311
  1304*                                    COPY ELCAID.
  1305******************************************************************
  1306*                                                                *
  1307*                            ELCAID.                             *
  1308*                            VMOD=2.001                          *
  1309*                                                                *
  1310*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1311*                                                                *
  1312*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1313*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1314******************************************************************
  1315
  1316 01  DFHAID.
  1317   02  DFHNULL   PIC  X  VALUE  ' '.
  1318   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1319   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1320   02  DFHPEN    PIC  X  VALUE  '='.
  1321   02  DFHOPID   PIC  X  VALUE  'W'.
  1322   02  DFHPA1    PIC  X  VALUE  '%'.
  1323   02  DFHPA2    PIC  X  VALUE  '>'.
  1324   02  DFHPA3    PIC  X  VALUE  ','.
  1325   02  DFHPF1    PIC  X  VALUE  '1'.
  1326   02  DFHPF2    PIC  X  VALUE  '2'.
  1327   02  DFHPF3    PIC  X  VALUE  '3'.
  1328   02  DFHPF4    PIC  X  VALUE  '4'.
  1329   02  DFHPF5    PIC  X  VALUE  '5'.
  1330   02  DFHPF6    PIC  X  VALUE  '6'.
  1331   02  DFHPF7    PIC  X  VALUE  '7'.
  1332   02  DFHPF8    PIC  X  VALUE  '8'.
  1333   02  DFHPF9    PIC  X  VALUE  '9'.
  1334   02  DFHPF10   PIC  X  VALUE  ':'.
  1335   02  DFHPF11   PIC  X  VALUE  '#'.
  1336   02  DFHPF12   PIC  X  VALUE  '@'.
  1337   02  DFHPF13   PIC  X  VALUE  'A'.
  1338   02  DFHPF14   PIC  X  VALUE  'B'.
  1339   02  DFHPF15   PIC  X  VALUE  'C'.
  1340   02  DFHPF16   PIC  X  VALUE  'D'.
  1341   02  DFHPF17   PIC  X  VALUE  'E'.
  1342   02  DFHPF18   PIC  X  VALUE  'F'.
  1343   02  DFHPF19   PIC  X  VALUE  'G'.
  1344   02  DFHPF20   PIC  X  VALUE  'H'.
  1345   02  DFHPF21   PIC  X  VALUE  'I'.
  1346*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1347   02  DFHPF22   PIC  X  VALUE  '['.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  25
* EL677.cbl
  1348   02  DFHPF23   PIC  X  VALUE  '.'.
  1349   02  DFHPF24   PIC  X  VALUE  '<'.
  1350   02  DFHMSRE   PIC  X  VALUE  'X'.
  1351   02  DFHSTRF   PIC  X  VALUE  'h'.
  1352   02  DFHTRIG   PIC  X  VALUE  '"'.
  1353 01  FILLER    REDEFINES DFHAID.
  1354     12  FILLER                      PIC X(8).
  1355     12  PF-VALUES                   PIC X       OCCURS 24.
  1356     12  FILLER                      PIC X(3).
  1357*                                    COPY EL677S.
  1358 01  EL677AI.
  1359     05  FILLER            PIC  X(0012).
  1360*    -------------------------------
  1361     05  DATEL PIC S9(0004) COMP.
  1362     05  DATEF PIC  X(0001).
  1363     05  FILLER REDEFINES DATEF.
  1364         10  DATEA PIC  X(0001).
  1365     05  DATEI PIC  X(0008).
  1366*    -------------------------------
  1367     05  TIMEL PIC S9(0004) COMP.
  1368     05  TIMEF PIC  X(0001).
  1369     05  FILLER REDEFINES TIMEF.
  1370         10  TIMEA PIC  X(0001).
  1371     05  TIMEI PIC  X(0005).
  1372*    -------------------------------
  1373     05  MAINTL PIC S9(0004) COMP.
  1374     05  MAINTF PIC  X(0001).
  1375     05  FILLER REDEFINES MAINTF.
  1376         10  MAINTA PIC  X(0001).
  1377     05  MAINTI PIC  X(0001).
  1378*    -------------------------------
  1379     05  DMAINT1L PIC S9(0004) COMP.
  1380     05  DMAINT1F PIC  X(0001).
  1381     05  FILLER REDEFINES DMAINT1F.
  1382         10  DMAINT1A PIC  X(0001).
  1383     05  DMAINT1I PIC  X(0009).
  1384*    -------------------------------
  1385     05  DMAINT2L PIC S9(0004) COMP.
  1386     05  DMAINT2F PIC  X(0001).
  1387     05  FILLER REDEFINES DMAINT2F.
  1388         10  DMAINT2A PIC  X(0001).
  1389     05  DMAINT2I PIC  X(0029).
  1390*    -------------------------------
  1391     05  CARRIERL PIC S9(0004) COMP.
  1392     05  CARRIERF PIC  X(0001).
  1393     05  FILLER REDEFINES CARRIERF.
  1394         10  CARRIERA PIC  X(0001).
  1395     05  CARRIERI PIC  X(0001).
  1396*    -------------------------------
  1397     05  GROUPL PIC S9(0004) COMP.
  1398     05  GROUPF PIC  X(0001).
  1399     05  FILLER REDEFINES GROUPF.
  1400         10  GROUPA PIC  X(0001).
  1401     05  GROUPI PIC  X(0006).
  1402*    -------------------------------
  1403     05  STATEL PIC S9(0004) COMP.
  1404     05  STATEF PIC  X(0001).
  1405     05  FILLER REDEFINES STATEF.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  26
* EL677.cbl
  1406         10  STATEA PIC  X(0001).
  1407     05  STATEI PIC  X(0002).
  1408*    -------------------------------
  1409     05  ACCTL PIC S9(0004) COMP.
  1410     05  ACCTF PIC  X(0001).
  1411     05  FILLER REDEFINES ACCTF.
  1412         10  ACCTA PIC  X(0001).
  1413     05  ACCTI PIC  X(0010).
  1414*    -------------------------------
  1415     05  EFFDTL PIC S9(0004) COMP.
  1416     05  EFFDTF PIC  X(0001).
  1417     05  FILLER REDEFINES EFFDTF.
  1418         10  EFFDTA PIC  X(0001).
  1419     05  EFFDTI PIC  X(0008).
  1420*    -------------------------------
  1421     05  CERTNOL PIC S9(0004) COMP.
  1422     05  CERTNOF PIC  X(0001).
  1423     05  FILLER REDEFINES CERTNOF.
  1424         10  CERTNOA PIC  X(0001).
  1425     05  CERTNOI PIC  X(0010).
  1426*    -------------------------------
  1427     05  SFXL PIC S9(0004) COMP.
  1428     05  SFXF PIC  X(0001).
  1429     05  FILLER REDEFINES SFXF.
  1430         10  SFXA PIC  X(0001).
  1431     05  SFXI PIC  X(0001).
  1432*    -------------------------------
  1433     05  SEQL PIC S9(0004) COMP.
  1434     05  SEQF PIC  X(0001).
  1435     05  FILLER REDEFINES SEQF.
  1436         10  SEQA PIC  X(0001).
  1437     05  SEQI PIC  99.
  1438*    -------------------------------
  1439     05  PAYTO1L PIC S9(0004) COMP.
  1440     05  PAYTO1F PIC  X(0001).
  1441     05  FILLER REDEFINES PAYTO1F.
  1442         10  PAYTO1A PIC  X(0001).
  1443     05  PAYTO1I PIC  X(0030).
  1444*    -------------------------------
  1445     05  CREATEDL PIC S9(0004) COMP.
  1446     05  CREATEDF PIC  X(0001).
  1447     05  FILLER REDEFINES CREATEDF.
  1448         10  CREATEDA PIC  X(0001).
  1449     05  CREATEDI PIC  X(0008).
  1450*    -------------------------------
  1451     05  CBYL PIC S9(0004) COMP.
  1452     05  CBYF PIC  X(0001).
  1453     05  FILLER REDEFINES CBYF.
  1454         10  CBYA PIC  X(0001).
  1455     05  CBYI PIC  X(0004).
  1456*    -------------------------------
  1457     05  PAYTO2L PIC S9(0004) COMP.
  1458     05  PAYTO2F PIC  X(0001).
  1459     05  FILLER REDEFINES PAYTO2F.
  1460         10  PAYTO2A PIC  X(0001).
  1461     05  PAYTO2I PIC  X(0030).
  1462*    -------------------------------
  1463     05  PAYEEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  27
* EL677.cbl
  1464     05  PAYEEF PIC  X(0001).
  1465     05  FILLER REDEFINES PAYEEF.
  1466         10  PAYEEA PIC  X(0001).
  1467     05  PAYEEI PIC  X(0006).
  1468*    -------------------------------
  1469     05  APVSTATL PIC S9(0004) COMP.
  1470     05  APVSTATF PIC  X(0001).
  1471     05  FILLER REDEFINES APVSTATF.
  1472         10  APVSTATA PIC  X(0001).
  1473     05  APVSTATI PIC  X(0009).
  1474*    -------------------------------
  1475     05  PAYAD1L PIC S9(0004) COMP.
  1476     05  PAYAD1F PIC  X(0001).
  1477     05  FILLER REDEFINES PAYAD1F.
  1478         10  PAYAD1A PIC  X(0001).
  1479     05  PAYAD1I PIC  X(0030).
  1480*    -------------------------------
  1481     05  APVDTL PIC S9(0004) COMP.
  1482     05  APVDTF PIC  X(0001).
  1483     05  FILLER REDEFINES APVDTF.
  1484         10  APVDTA PIC  X(0001).
  1485     05  APVDTI PIC  X(0008).
  1486*    -------------------------------
  1487     05  APVBYL PIC S9(0004) COMP.
  1488     05  APVBYF PIC  X(0001).
  1489     05  FILLER REDEFINES APVBYF.
  1490         10  APVBYA PIC  X(0001).
  1491     05  APVBYI PIC  X(0004).
  1492*    -------------------------------
  1493     05  PAYAD2L PIC S9(0004) COMP.
  1494     05  PAYAD2F PIC  X(0001).
  1495     05  FILLER REDEFINES PAYAD2F.
  1496         10  PAYAD2A PIC  X(0001).
  1497     05  PAYAD2I PIC  X(0030).
  1498*    -------------------------------
  1499     05  VOIDEDL PIC S9(0004) COMP.
  1500     05  VOIDEDF PIC  X(0001).
  1501     05  FILLER REDEFINES VOIDEDF.
  1502         10  VOIDEDA PIC  X(0001).
  1503     05  VOIDEDI PIC  X(0008).
  1504*    -------------------------------
  1505     05  VBYL PIC S9(0004) COMP.
  1506     05  VBYF PIC  X(0001).
  1507     05  FILLER REDEFINES VBYF.
  1508         10  VBYA PIC  X(0001).
  1509     05  VBYI PIC  X(0004).
  1510*    -------------------------------
  1511     05  PAYCTYL PIC S9(0004) COMP.
  1512     05  PAYCTYF PIC  X(0001).
  1513     05  FILLER REDEFINES PAYCTYF.
  1514         10  PAYCTYA PIC  X(0001).
  1515     05  PAYCTYI PIC  X(0028).
  1516*    -------------------------------
  1517     05  PAYSTL PIC S9(0004) COMP.
  1518     05  PAYSTF PIC  X(0001).
  1519     05  FILLER REDEFINES PAYSTF.
  1520         10  PAYSTA PIC  X(0001).
  1521     05  PAYSTI PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  28
* EL677.cbl
  1522*    -------------------------------
  1523     05  PRINTEDL PIC S9(0004) COMP.
  1524     05  PRINTEDF PIC  X(0001).
  1525     05  FILLER REDEFINES PRINTEDF.
  1526         10  PRINTEDA PIC  X(0001).
  1527     05  PRINTEDI PIC  X(0008).
  1528*    -------------------------------
  1529     05  PTOZIPL PIC S9(0004) COMP.
  1530     05  PTOZIPF PIC  X(0001).
  1531     05  FILLER REDEFINES PTOZIPF.
  1532         10  PTOZIPA PIC  X(0001).
  1533     05  PTOZIPI PIC  X(0009).
  1534*    -------------------------------
  1535     05  DEDCYNL PIC S9(0004) COMP.
  1536     05  DEDCYNF PIC  X(0001).
  1537     05  FILLER REDEFINES DEDCYNF.
  1538         10  DEDCYNA PIC  X(0001).
  1539     05  DEDCYNI PIC  X(0001).
  1540*    -------------------------------
  1541     05  CASHEDL PIC S9(0004) COMP.
  1542     05  CASHEDF PIC  X(0001).
  1543     05  FILLER REDEFINES CASHEDF.
  1544         10  CASHEDA PIC  X(0001).
  1545     05  CASHEDI PIC  X(0008).
  1546*    -------------------------------
  1547     05  RETTOL PIC S9(0004) COMP.
  1548     05  RETTOF PIC  X(0001).
  1549     05  FILLER REDEFINES RETTOF.
  1550         10  RETTOA PIC  X(0001).
  1551     05  RETTOI PIC  X(0030).
  1552*    -------------------------------
  1553     05  DPREML PIC S9(0004) COMP.
  1554     05  DPREMF PIC  X(0001).
  1555     05  FILLER REDEFINES DPREMF.
  1556         10  DPREMA PIC  X(0001).
  1557     05  DPREMI PIC  X(0005).
  1558*    -------------------------------
  1559     05  PREML PIC S9(0004) COMP.
  1560     05  PREMF PIC  X(0001).
  1561     05  FILLER REDEFINES PREMF.
  1562         10  PREMA PIC  X(0001).
  1563     05  PREMI PIC  X(0008).
  1564*    -------------------------------
  1565     05  DCOMML PIC S9(0004) COMP.
  1566     05  DCOMMF PIC  X(0001).
  1567     05  FILLER REDEFINES DCOMMF.
  1568         10  DCOMMA PIC  X(0001).
  1569     05  DCOMMI PIC  X(0005).
  1570*    -------------------------------
  1571     05  ISSCOMML PIC S9(0004) COMP.
  1572     05  ISSCOMMF PIC  X(0001).
  1573     05  FILLER REDEFINES ISSCOMMF.
  1574         10  ISSCOMMA PIC  X(0001).
  1575     05  ISSCOMMI PIC  X(0008).
  1576*    -------------------------------
  1577     05  DREFL PIC S9(0004) COMP.
  1578     05  DREFF PIC  X(0001).
  1579     05  FILLER REDEFINES DREFF.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  29
* EL677.cbl
  1580         10  DREFA PIC  X(0001).
  1581     05  DREFI PIC  X(0004).
  1582*    -------------------------------
  1583     05  REFL PIC S9(0004) COMP.
  1584     05  REFF PIC  X(0001).
  1585     05  FILLER REDEFINES REFF.
  1586         10  REFA PIC  X(0001).
  1587     05  REFI PIC  X(0008).
  1588*    -------------------------------
  1589     05  DUECOMML PIC S9(0004) COMP.
  1590     05  DUECOMMF PIC  X(0001).
  1591     05  FILLER REDEFINES DUECOMMF.
  1592         10  DUECOMMA PIC  X(0001).
  1593     05  DUECOMMI PIC  X(0007).
  1594*    -------------------------------
  1595     05  UECOMML PIC S9(0004) COMP.
  1596     05  UECOMMF PIC  X(0001).
  1597     05  FILLER REDEFINES UECOMMF.
  1598         10  UECOMMA PIC  X(0001).
  1599     05  UECOMMI PIC  X(0008).
  1600*    -------------------------------
  1601     05  DPREPDL PIC S9(0004) COMP.
  1602     05  DPREPDF PIC  X(0001).
  1603     05  FILLER REDEFINES DPREPDF.
  1604         10  DPREPDA PIC  X(0001).
  1605     05  DPREPDI PIC  X(0006).
  1606*    -------------------------------
  1607     05  PREPDL PIC S9(0004) COMP.
  1608     05  PREPDF PIC  X(0001).
  1609     05  FILLER REDEFINES PREPDF.
  1610         10  PREPDA PIC  X(0001).
  1611     05  PREPDI PIC  X(0008).
  1612*    -------------------------------
  1613     05  AMOUNTL PIC S9(0004) COMP.
  1614     05  AMOUNTF PIC  X(0001).
  1615     05  FILLER REDEFINES AMOUNTF.
  1616         10  AMOUNTA PIC  X(0001).
  1617     05  AMOUNTI PIC  S9(9)V99.
  1618*    -------------------------------
  1619     05  CHECKL PIC S9(0004) COMP.
  1620     05  CHECKF PIC  X(0001).
  1621     05  FILLER REDEFINES CHECKF.
  1622         10  CHECKA PIC  X(0001).
  1623     05  CHECKI PIC  X(0007).
  1624*    -------------------------------
  1625     05  TYPEL PIC S9(0004) COMP.
  1626     05  TYPEF PIC  X(0001).
  1627     05  FILLER REDEFINES TYPEF.
  1628         10  TYPEA PIC  X(0001).
  1629     05  TYPEI PIC  X(0001).
  1630*    -------------------------------
  1631     05  REASONL PIC S9(0004) COMP.
  1632     05  REASONF PIC  X(0001).
  1633     05  FILLER REDEFINES REASONF.
  1634         10  REASONA PIC  X(0001).
  1635     05  REASONI PIC  X(0025).
  1636*    -------------------------------
  1637     05  VREASONL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  30
* EL677.cbl
  1638     05  VREASONF PIC  X(0001).
  1639     05  FILLER REDEFINES VREASONF.
  1640         10  VREASONA PIC  X(0001).
  1641     05  VREASONI PIC  X(0024).
  1642*    -------------------------------
  1643     05  STUBL PIC S9(0004) COMP.
  1644     05  STUBF PIC  X(0001).
  1645     05  FILLER REDEFINES STUBF.
  1646         10  STUBA PIC  X(0001).
  1647     05  STUBI PIC  X(0030).
  1648*    -------------------------------
  1649     05  TEXT1L PIC S9(0004) COMP.
  1650     05  TEXT1F PIC  X(0001).
  1651     05  FILLER REDEFINES TEXT1F.
  1652         10  TEXT1A PIC  X(0001).
  1653     05  TEXT1I PIC  X(0050).
  1654*    -------------------------------
  1655     05  TEXT2L PIC S9(0004) COMP.
  1656     05  TEXT2F PIC  X(0001).
  1657     05  FILLER REDEFINES TEXT2F.
  1658         10  TEXT2A PIC  X(0001).
  1659     05  TEXT2I PIC  X(0050).
  1660*    -------------------------------
  1661     05  TEXT3L PIC S9(0004) COMP.
  1662     05  TEXT3F PIC  X(0001).
  1663     05  FILLER REDEFINES TEXT3F.
  1664         10  TEXT3A PIC  X(0001).
  1665     05  TEXT3I PIC  X(0040).
  1666*    -------------------------------
  1667     05  ERRMSG1L PIC S9(0004) COMP.
  1668     05  ERRMSG1F PIC  X(0001).
  1669     05  FILLER REDEFINES ERRMSG1F.
  1670         10  ERRMSG1A PIC  X(0001).
  1671     05  ERRMSG1I PIC  X(0079).
  1672*    -------------------------------
  1673     05  ERRMSG2L PIC S9(0004) COMP.
  1674     05  ERRMSG2F PIC  X(0001).
  1675     05  FILLER REDEFINES ERRMSG2F.
  1676         10  ERRMSG2A PIC  X(0001).
  1677     05  ERRMSG2I PIC  X(0079).
  1678*    -------------------------------
  1679     05  PFENTERL PIC S9(0004) COMP.
  1680     05  PFENTERF PIC  X(0001).
  1681     05  FILLER REDEFINES PFENTERF.
  1682         10  PFENTERA PIC  X(0001).
  1683     05  PFENTERI PIC  9(2).
  1684*    -------------------------------
  1685     05  PF3L PIC S9(0004) COMP.
  1686     05  PF3F PIC  X(0001).
  1687     05  FILLER REDEFINES PF3F.
  1688         10  PF3A PIC  X(0001).
  1689     05  PF3I PIC  X(0016).
  1690*    -------------------------------
  1691     05  PF57L PIC S9(0004) COMP.
  1692     05  PF57F PIC  X(0001).
  1693     05  FILLER REDEFINES PF57F.
  1694         10  PF57A PIC  X(0001).
  1695     05  PF57I PIC  X(0030).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  31
* EL677.cbl
  1696*    -------------------------------
  1697     05  PF4L PIC S9(0004) COMP.
  1698     05  PF4F PIC  X(0001).
  1699     05  FILLER REDEFINES PF4F.
  1700         10  PF4A PIC  X(0001).
  1701     05  PF4I PIC  X(0018).
  1702*    -------------------------------
  1703     05  PF6L PIC S9(0004) COMP.
  1704     05  PF6F PIC  X(0001).
  1705     05  FILLER REDEFINES PF6F.
  1706         10  PF6A PIC  X(0001).
  1707     05  PF6I PIC  X(0013).
  1708 01  EL677AO REDEFINES EL677AI.
  1709     05  FILLER            PIC  X(0012).
  1710*    -------------------------------
  1711     05  FILLER            PIC  X(0003).
  1712     05  DATEO PIC  X(0008).
  1713*    -------------------------------
  1714     05  FILLER            PIC  X(0003).
  1715     05  TIMEO PIC  99.99.
  1716*    -------------------------------
  1717     05  FILLER            PIC  X(0003).
  1718     05  MAINTO PIC  X(0001).
  1719*    -------------------------------
  1720     05  FILLER            PIC  X(0003).
  1721     05  DMAINT1O PIC  X(0009).
  1722*    -------------------------------
  1723     05  FILLER            PIC  X(0003).
  1724     05  DMAINT2O PIC  X(0029).
  1725*    -------------------------------
  1726     05  FILLER            PIC  X(0003).
  1727     05  CARRIERO PIC  X(0001).
  1728*    -------------------------------
  1729     05  FILLER            PIC  X(0003).
  1730     05  GROUPO PIC  X(0006).
  1731*    -------------------------------
  1732     05  FILLER            PIC  X(0003).
  1733     05  STATEO PIC  X(0002).
  1734*    -------------------------------
  1735     05  FILLER            PIC  X(0003).
  1736     05  ACCTO PIC  X(0010).
  1737*    -------------------------------
  1738     05  FILLER            PIC  X(0003).
  1739     05  EFFDTO PIC  99B99B99.
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
  1742     05  CERTNOO PIC  X(0010).
  1743*    -------------------------------
  1744     05  FILLER            PIC  X(0003).
  1745     05  SFXO PIC  X(0001).
  1746*    -------------------------------
  1747     05  FILLER            PIC  X(0003).
  1748     05  SEQO PIC  99.
  1749*    -------------------------------
  1750     05  FILLER            PIC  X(0003).
  1751     05  PAYTO1O PIC  X(0030).
  1752*    -------------------------------
  1753     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  32
* EL677.cbl
  1754     05  CREATEDO PIC  X(0008).
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  CBYO PIC  X(0004).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
  1760     05  PAYTO2O PIC  X(0030).
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
  1763     05  PAYEEO PIC  X(0006).
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  APVSTATO PIC  X(0009).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  PAYAD1O PIC  X(0030).
  1770*    -------------------------------
  1771     05  FILLER            PIC  X(0003).
  1772     05  APVDTO PIC  X(0008).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  APVBYO PIC  X(0004).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  PAYAD2O PIC  X(0030).
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  VOIDEDO PIC  X(0008).
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  VBYO PIC  X(0004).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  PAYCTYO PIC  X(0028).
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  PAYSTO PIC  X(0002).
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  PRINTEDO PIC  99B99B99.
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  PTOZIPO PIC  X(0009).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  DEDCYNO PIC  X(0001).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  CASHEDO PIC  X(0008).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  RETTOO PIC  X(0030).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  DPREMO PIC  X(0005).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  PREMO PIC  Z(5).99.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  33
* EL677.cbl
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  DCOMMO PIC  X(0005).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  ISSCOMMO PIC  Z(5).99.
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  DREFO PIC  X(0004).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  REFO PIC  Z(5).99.
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  DUECOMMO PIC  X(0007).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  UECOMMO PIC  Z(5).99.
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  DPREPDO PIC  X(0006).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  PREPDO PIC  Z(5).99.
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  AMOUNTO PIC  Z(7).ZZ-.
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  CHECKO PIC  X(0007).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  TYPEO PIC  X(0001).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  REASONO PIC  X(0025).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  VREASONO PIC  X(0024).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  STUBO PIC  X(0030).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  TEXT1O PIC  X(0050).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  TEXT2O PIC  X(0050).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  TEXT3O PIC  X(0040).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  ERRMSG1O PIC  X(0079).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  ERRMSG2O PIC  X(0079).
  1869*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  34
* EL677.cbl
  1870     05  FILLER            PIC  X(0003).
  1871     05  PFENTERO PIC  99.
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  PF3O PIC  X(0016).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  PF57O PIC  X(0030).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  PF4O PIC  X(0018).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  PF6O PIC  X(0013).
  1884*    -------------------------------
  1885****************************************************************
  1886*
  1887* Copyright (c) 2007-2013 Dell Inc.
  1888* All rights reserved.
  1889*
  1890****************************************************************
  1891 01  DFHEIV.
  1892   02  DFHEIV0               PIC X(35).
  1893   02  DFHEIV1               PIC X(08).
  1894   02  DFHEIV2               PIC X(08).
  1895   02  DFHEIV3               PIC X(08).
  1896   02  DFHEIV4               PIC X(06).
  1897   02  DFHEIV5               PIC X(04).
  1898   02  DFHEIV6               PIC X(04).
  1899   02  DFHEIV7               PIC X(02).
  1900   02  DFHEIV8               PIC X(02).
  1901   02  DFHEIV9               PIC X(01).
  1902   02  DFHEIV10              PIC S9(7) COMP-3.
  1903   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1904   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1905   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1906   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1907   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1908   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1909   02  DFHEIV17              PIC X(04).
  1910   02  DFHEIV18              PIC X(04).
  1911   02  DFHEIV19              PIC X(04).
  1912   02  DFHEIV20              USAGE IS POINTER.
  1913   02  DFHEIV21              USAGE IS POINTER.
  1914   02  DFHEIV22              USAGE IS POINTER.
  1915   02  DFHEIV23              USAGE IS POINTER.
  1916   02  DFHEIV24              USAGE IS POINTER.
  1917   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1918   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1919   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1920   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1921   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1922   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1923   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1924   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1925   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1926   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1927   02  DFHEIV35              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  35
* EL677.cbl
  1928   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1929   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1930   02  FILLER                PIC X(02).
  1931   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1932   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1933   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1934   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1935   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1936   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1937   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1938 LINKAGE  SECTION.
  1939*****************************************************************
  1940*                                                               *
  1941* Copyright (c) 2007-2013 Dell Inc.                             *
  1942* All rights reserved.                                          *
  1943*                                                               *
  1944*****************************************************************
  1945 01  dfheiblk.
  1946     02  eibtime          pic s9(7) comp-3.
  1947     02  eibdate          pic s9(7) comp-3.
  1948     02  eibtrnid         pic x(4).
  1949     02  eibtaskn         pic s9(7) comp-3.
  1950     02  eibtrmid         pic x(4).
  1951     02  dfheigdi         pic s9(4) comp.
  1952     02  eibcposn         pic s9(4) comp.
  1953     02  eibcalen         pic s9(4) comp.
  1954     02  eibaid           pic x(1).
  1955     02  eibfiller1       pic x(1).
  1956     02  eibfn            pic x(2).
  1957     02  eibfiller2       pic x(2).
  1958     02  eibrcode         pic x(6).
  1959     02  eibfiller3       pic x(2).
  1960     02  eibds            pic x(8).
  1961     02  eibreqid         pic x(8).
  1962     02  eibrsrce         pic x(8).
  1963     02  eibsync          pic x(1).
  1964     02  eibfree          pic x(1).
  1965     02  eibrecv          pic x(1).
  1966     02  eibsend          pic x(1).
  1967     02  eibatt           pic x(1).
  1968     02  eibeoc           pic x(1).
  1969     02  eibfmh           pic x(1).
  1970     02  eibcompl         pic x(1).
  1971     02  eibsig           pic x(1).
  1972     02  eibconf          pic x(1).
  1973     02  eiberr           pic x(1).
  1974     02  eibrldbk         pic x(1).
  1975     02  eiberrcd         pic x(4).
  1976     02  eibsynrb         pic x(1).
  1977     02  eibnodat         pic x(1).
  1978     02  eibfiller5       pic x(2).
  1979     02  eibresp          pic s9(8) comp.
  1980     02  eibresp2         pic s9(8) comp.
  1981     02  dfheigdj         pic s9(4) comp.
  1982     02  dfheigdk         pic s9(4) comp.
  1983 01  DFHCOMMAREA.
  1984     05  filler                  PIC X(1024).
  1985 01  var  pic x(30).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  36
* EL677.cbl
  1986*                                COPY ELCCNTL.
  1987******************************************************************
  1988*                                                                *
  1989*                                                                *
  1990*                            ELCCNTL.                            *
  1991*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1992*                            VMOD=2.059                          *
  1993*                                                                *
  1994*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1995*                                                                *
  1996*   FILE TYPE = VSAM,KSDS                                        *
  1997*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1998*                                                                *
  1999*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2000*       ALTERNATE INDEX = NONE                                   *
  2001*                                                                *
  2002*   LOG = YES                                                    *
  2003*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2004******************************************************************
  2005*                   C H A N G E   L O G
  2006*
  2007* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2008*-----------------------------------------------------------------
  2009*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2010* EFFECTIVE    NUMBER
  2011*-----------------------------------------------------------------
  2012* 082503                   PEMA  ADD BENEFIT GROUP
  2013* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2014* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2015* 092705    2005050300006  PEMA  ADD SPP LEASES
  2016* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2017* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2018* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2019* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2020* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2021* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2022* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2023* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2024* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2025* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2026* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2027******************************************************************
  2028*
  2029 01  CONTROL-FILE.
  2030     12  CF-RECORD-ID                       PIC XX.
  2031         88  VALID-CF-ID                        VALUE 'CF'.
  2032
  2033     12  CF-CONTROL-PRIMARY.
  2034         16  CF-COMPANY-ID                  PIC XXX.
  2035         16  CF-RECORD-TYPE                 PIC X.
  2036             88  CF-COMPANY-MASTER              VALUE '1'.
  2037             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2038             88  CF-STATE-MASTER                VALUE '3'.
  2039             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2040             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2041             88  CF-CARRIER-MASTER              VALUE '6'.
  2042             88  CF-MORTALITY-MASTER            VALUE '7'.
  2043             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  37
* EL677.cbl
  2044             88  CF-TERMINAL-MASTER             VALUE '9'.
  2045             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2046             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2047             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2048             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2049             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2050             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2051             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2052             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2053             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2054         16  CF-ACCESS-CD-GENL              PIC X(4).
  2055         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2056             20  CF-PROCESSOR               PIC X(4).
  2057         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2058             20  CF-STATE-CODE              PIC XX.
  2059             20  FILLER                     PIC XX.
  2060         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2061             20  FILLER                     PIC XX.
  2062             20  CF-HI-BEN-IN-REC           PIC XX.
  2063         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2064             20  FILLER                     PIC XXX.
  2065             20  CF-CARRIER-CNTL            PIC X.
  2066         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2067             20  FILLER                     PIC XX.
  2068             20  CF-HI-TYPE-IN-REC          PIC 99.
  2069         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2070             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2071                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2072             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2073             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2074         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2075             20  FILLER                     PIC X.
  2076             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2077         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2078             20  FILLER                     PIC XX.
  2079             20  CF-MORTGAGE-PLAN           PIC XX.
  2080         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2081
  2082     12  CF-LAST-MAINT-DT                   PIC XX.
  2083     12  CF-LAST-MAINT-BY                   PIC X(4).
  2084     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2085
  2086     12  CF-RECORD-BODY                     PIC X(728).
  2087
  2088
  2089****************************************************************
  2090*             COMPANY MASTER RECORD                            *
  2091****************************************************************
  2092
  2093     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2094         16  CF-COMPANY-ADDRESS.
  2095             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2096             20  CF-CL-IN-CARE-OF           PIC X(30).
  2097             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2098             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2099             20  CF-CL-CITY-STATE           PIC X(30).
  2100             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2101             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  38
* EL677.cbl
  2102         16  CF-COMPANY-CD                  PIC X.
  2103         16  CF-COMPANY-PASSWORD            PIC X(8).
  2104         16  CF-SECURITY-OPTION             PIC X.
  2105             88  ALL-SECURITY                   VALUE '1'.
  2106             88  COMPANY-VERIFY                 VALUE '2'.
  2107             88  PROCESSOR-VERIFY               VALUE '3'.
  2108             88  NO-SECURITY                    VALUE '4'.
  2109             88  ALL-BUT-TERM                   VALUE '5'.
  2110         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2111             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2112         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2113             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2114         16  CF-INFORCE-LOCATION            PIC X.
  2115             88  CERTS-ARE-ONLINE               VALUE '1'.
  2116             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2117             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2118         16  CF-LOWER-CASE-LETTERS          PIC X.
  2119         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2120             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2121             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2122             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2123             88  CF-ACCNT-CNTL                  VALUE '3'.
  2124             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2125
  2126         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2127         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2128
  2129         16  CF-LGX-CREDIT-USER             PIC X.
  2130             88  CO-IS-NOT-USER                 VALUE 'N'.
  2131             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2132
  2133         16 CF-CREDIT-CALC-CODES.
  2134             20  CF-CR-REM-TERM-CALC PIC X.
  2135               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2136               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2137               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2138               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2139               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2140               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2141               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2142             20  CF-CR-R78-METHOD           PIC X.
  2143               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2144               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2145
  2146         16  CF-CLAIM-CONTROL-COUNTS.
  2147             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2148                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2149
  2150             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2151                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2152
  2153             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2154                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2155
  2156             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2157                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2158
  2159         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  39
* EL677.cbl
  2160
  2161         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2162             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2163             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2164             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2165             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2166                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2167                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2168             20  CF-CO-PREM-REJECT-SW       PIC X.
  2169                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2170                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2171             20  CF-CO-REF-REJECT-SW        PIC X.
  2172                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2173                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2174
  2175         16  CF-CO-REPORTING-DT             PIC XX.
  2176         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2177         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2178           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2179           88  CF-CO-MONTH-END                  VALUE '1'.
  2180
  2181         16  CF-LGX-CLAIM-USER              PIC X.
  2182             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2183             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2184
  2185         16  CF-CREDIT-EDIT-CONTROLS.
  2186             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2187             20  CF-MIN-AGE                 PIC 99.
  2188             20  CF-DEFAULT-AGE             PIC 99.
  2189             20  CF-MIN-TERM                PIC S999      COMP-3.
  2190             20  CF-MAX-TERM                PIC S999      COMP-3.
  2191             20  CF-DEFAULT-SEX             PIC X.
  2192             20  CF-JOINT-AGE-INPUT         PIC X.
  2193                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2194             20  CF-BIRTH-DATE-INPUT        PIC X.
  2195                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2196             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2197                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2198                 88  CF-ZERO-CARRIER            VALUE '1'.
  2199                 88  CF-ZERO-GROUPING           VALUE '2'.
  2200                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2201             20  CF-EDIT-SW                 PIC X.
  2202                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2203             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2204             20  CF-CR-PR-METHOD            PIC X.
  2205               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2206               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2207             20  FILLER                     PIC X.
  2208
  2209         16  CF-CREDIT-MISC-CONTROLS.
  2210             20  CF-REIN-TABLE-SW           PIC X.
  2211                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2212             20  CF-COMP-TABLE-SW           PIC X.
  2213                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2214             20  CF-EXPERIENCE-RETENTION-AGE
  2215                                            PIC S9        COMP-3.
  2216             20  CF-CONVERSION-DT           PIC XX.
  2217             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  40
* EL677.cbl
  2218             20  CF-RUN-FREQUENCY-SW        PIC X.
  2219                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2220                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2221
  2222             20  CF-CR-CHECK-NO-CONTROL.
  2223                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2224                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2225                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2226                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2227                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2228                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2229
  2230                 24  CF-CR-CHECK-COUNT       REDEFINES
  2231                     CF-CR-CHECK-COUNTER      PIC X(4).
  2232
  2233                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2234                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2235
  2236                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2237                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2238                 24  CF-MAIL-PROCESSING       PIC X.
  2239                     88  MAIL-PROCESSING          VALUE 'Y'.
  2240
  2241         16  CF-MISC-SYSTEM-CONTROL.
  2242             20  CF-SYSTEM-C                 PIC X.
  2243                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2244             20  CF-SYSTEM-D                 PIC X.
  2245                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2246             20  CF-SOC-SEC-NO-SW            PIC X.
  2247                 88  SOC-SEC-NO-USED             VALUE '1'.
  2248             20  CF-MEMBER-NO-SW             PIC X.
  2249                 88  MEMBER-NO-USED              VALUE '1'.
  2250             20  CF-TAX-ID-NUMBER            PIC X(11).
  2251             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2252             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2253                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2254                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2255                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2256                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2257             20  CF-SYSTEM-E                 PIC X.
  2258                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2259
  2260         16  CF-LGX-LIFE-USER               PIC X.
  2261             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2262             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2263
  2264         16  CF-CR-MONTH-END-DT             PIC XX.
  2265
  2266         16  CF-FILE-MAINT-DATES.
  2267             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2268                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2269             20  CF-LAST-BATCH       REDEFINES
  2270                 CF-LAST-BATCH-NO               PIC X(4).
  2271             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2272             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2273             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2274             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2275             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  41
* EL677.cbl
  2276             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2277             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2278             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2279             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2280             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2281
  2282         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2283         16  FILLER                         PIC X.
  2284
  2285         16  CF-ALT-MORT-CODE               PIC X(4).
  2286         16  CF-MEMBER-CAPTION              PIC X(10).
  2287
  2288         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2289             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2290             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2291             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2292             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2293             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2294
  2295         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2296
  2297         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2298         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2299         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2300         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2301
  2302         16  CF-AH-OVERRIDE-L1              PIC X.
  2303         16  CF-AH-OVERRIDE-L2              PIC XX.
  2304         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2305         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2306
  2307         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2308         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2309
  2310         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2311         16  CF-AR-LAST-EL860-DT            PIC XX.
  2312         16  CF-MP-MONTH-END-DT             PIC XX.
  2313
  2314         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2315         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2316             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2317
  2318         16  CF-AR-MONTH-END-DT             PIC XX.
  2319
  2320         16  CF-CRDTCRD-USER                PIC X.
  2321             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2322             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2323
  2324         16  CF-CC-MONTH-END-DT             PIC XX.
  2325
  2326         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2327
  2328         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2329             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2330             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2331             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2332         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2333         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  42
* EL677.cbl
  2334         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2335         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2336             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2337             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2338         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2339         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2340         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2341             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2342         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2343
  2344         16  CF-CL-ZIP-CODE.
  2345             20  CF-CL-ZIP-PRIME.
  2346                 24  CF-CL-ZIP-1ST          PIC X.
  2347                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2348                 24  FILLER                 PIC X(4).
  2349             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2350         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2351             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2352             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2353             20  FILLER                     PIC XXX.
  2354
  2355         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2356         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2357         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2358         16  CF-CO-OPTION-START-DATE        PIC XX.
  2359         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2360           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2361                                                      '3' '4'.
  2362           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2363           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2364           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2365           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2366           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2367           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2368
  2369         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2370
  2371         16  CF-PAYMENT-APPROVAL-LEVELS.
  2372             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2373             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2374             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2375             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2376             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2377             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2378
  2379         16  CF-END-USER-REPORTING-USER     PIC X.
  2380             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2381             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2382
  2383         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2384             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2385             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2386
  2387         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2388
  2389         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2390         16  FILLER                         PIC X.
  2391
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  43
* EL677.cbl
  2392         16  CF-CREDIT-ARCHIVE-CNTL.
  2393             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2394             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2395             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2396
  2397         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2398
  2399         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2400             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2401             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2402
  2403         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2404             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2405             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2406
  2407         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2408
  2409         16  CF-CO-ACH-ID-CODE              PIC  X.
  2410             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2411             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2412             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2413         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2414         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2415         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2416         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2417         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2418         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2419         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2420         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2421         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2422                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2423         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2424                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2425
  2426         16  CF-CO-OVER-SHORT.
  2427             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2428             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2429
  2430*         16  FILLER                         PIC X(102).
  2431         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2432             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2433             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2434
  2435         16  CF-AH-APPROVAL-DAYS.
  2436             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2437             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2438             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2439             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2440
  2441         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2442
  2443         16  CF-APPROV-LEV-5.
  2444             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2445             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2446             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2447
  2448         16  FILLER                         PIC X(68).
  2449****************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  44
* EL677.cbl
  2450*             PROCESSOR/USER RECORD                            *
  2451****************************************************************
  2452
  2453     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2454         16  CF-PROCESSOR-NAME              PIC X(30).
  2455         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2456         16  CF-PROCESSOR-TITLE             PIC X(26).
  2457         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2458                 88  MESSAGE-YES                VALUE 'Y'.
  2459                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2460
  2461*****************************************************
  2462****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2463****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2464****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2465****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2466*****************************************************
  2467
  2468         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2469             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2470             20  CF-APPLICATION-FORCE       PIC X.
  2471             20  CF-INDIVIDUAL-APP.
  2472                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2473                     28  CF-BROWSE-APP      PIC X.
  2474                     28  CF-UPDATE-APP      PIC X.
  2475
  2476         16  CF-CURRENT-TERM-ON             PIC X(4).
  2477         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2478             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2479             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2480             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2481             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2482             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2483             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2484             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2485         16  CF-PROCESSOR-CARRIER           PIC X.
  2486             88  NO-CARRIER-SECURITY            VALUE ' '.
  2487         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2488             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2489         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2490             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2491         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2492             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2493
  2494         16  CF-PROC-SYS-ACCESS-SW.
  2495             20  CF-PROC-CREDIT-CLAIMS-SW.
  2496                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2497                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2498                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2499                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2500             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2501                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2502                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2503             20  CF-PROC-LIFE-GNRLDGR-SW.
  2504                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2505                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2506                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2507                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  45
* EL677.cbl
  2508             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2509                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2510                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2511         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2512             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2513             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2514         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2515
  2516         16  CF-APPROVAL-LEVEL                  PIC X.
  2517             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2518             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2519             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2520             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2521             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2522
  2523         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2524
  2525         16  CF-LANGUAGE-TYPE                   PIC X.
  2526             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2527             88  CF-LANG-IS-FR                      VALUE 'F'.
  2528
  2529         16  CF-CSR-IND                         PIC X.
  2530         16  FILLER                             PIC X(239).
  2531
  2532****************************************************************
  2533*             PROCESSOR/REMINDERS RECORD                       *
  2534****************************************************************
  2535
  2536     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2537         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2538             20  CF-START-REMIND-DT         PIC XX.
  2539             20  CF-END-REMIND-DT           PIC XX.
  2540             20  CF-REMINDER-TEXT           PIC X(50).
  2541         16  FILLER                         PIC X(296).
  2542
  2543
  2544****************************************************************
  2545*             STATE MASTER RECORD                              *
  2546****************************************************************
  2547
  2548     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2549         16  CF-STATE-ABBREVIATION          PIC XX.
  2550         16  CF-STATE-NAME                  PIC X(25).
  2551         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2552         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2553             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2554             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2555             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2556             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2557                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2558                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2559             20  CF-ST-PREM-REJECT-SW       PIC X.
  2560                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2561                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2562             20  CF-ST-REF-REJECT-SW        PIC X.
  2563                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2564                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2565         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  46
* EL677.cbl
  2566         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2567         16  CF-ST-REFUND-RULES.
  2568             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2569             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2570             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2571         16  CF-ST-FST-PMT-EXTENSION.
  2572             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2573             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2574                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2575                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2576                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2577                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2578         16  CF-ST-STATE-CALL.
  2579             20  CF-ST-CALL-UNEARNED        PIC X.
  2580             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2581             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2582         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2583             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2584             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2585         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2586         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2587         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2588         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2589         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2590         16  FILLER                         PIC X.
  2591         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2592             20  CF-ST-BENEFIT-CD           PIC XX.
  2593             20  CF-ST-BENEFIT-KIND         PIC X.
  2594                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2595                 88  CF-ST-AH-KIND              VALUE 'A'.
  2596             20  CF-ST-REM-TERM-CALC        PIC X.
  2597                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2598                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2599                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2600                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2601                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2602                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2603                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2604                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2605
  2606             20  CF-ST-REFUND-CALC          PIC X.
  2607                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2608                 88  ST-REFD-BY-R78             VALUE '1'.
  2609                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2610                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2611                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2612                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2613                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2614                 88  ST-REFD-UTAH               VALUE '7'.
  2615                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2616                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2617                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2618
  2619             20  CF-ST-EARNING-CALC         PIC X.
  2620                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2621                 88  ST-EARN-BY-R78             VALUE '1'.
  2622                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2623                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  47
* EL677.cbl
  2624                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2625                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2626                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2627                 88  ST-EARN-MEAN               VALUE '8'.
  2628                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2629
  2630             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2631                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2632                 88  ST-OVRD-BY-R78             VALUE '1'.
  2633                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2634                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2635                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2636                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2637                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2638                 88  ST-OVRD-MEAN               VALUE '8'.
  2639                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2640             20  cf-st-extra-periods        pic 9.
  2641*            20  FILLER                     PIC X.
  2642
  2643         16  CF-ST-COMMISSION-CAPS.
  2644             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2645             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2646             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2647             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2648         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2649                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2650                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  2651                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  2652
  2653         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2654
  2655         16  CF-ST-STATUTORY-INTEREST.
  2656             20  CF-ST-STAT-DATE-FROM       PIC X.
  2657                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2658                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2659             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2660             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2661             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2662             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2663             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2664
  2665         16  CF-ST-OVER-SHORT.
  2666             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2667             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2668
  2669         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2670
  2671         16  CF-ST-RT-CALC                  PIC X.
  2672
  2673         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2674         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2675         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2676         16  CF-ST-RF-LR-CALC               PIC X.
  2677         16  CF-ST-RF-LL-CALC               PIC X.
  2678         16  CF-ST-RF-LN-CALC               PIC X.
  2679         16  CF-ST-RF-AH-CALC               PIC X.
  2680         16  CF-ST-RF-CP-CALC               PIC X.
  2681*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  48
* EL677.cbl
  2682*CIDMOD         16  FILLER                         PIC X(192).
  2683         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2684             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2685         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2686         16  CF-ST-VFY-2ND-BENE             PIC X.
  2687         16  CF-ST-CAUSAL-STATE             PIC X.
  2688         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2689         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2690         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2691             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2692         16  CF-ST-NET-ONLY-STATE           PIC X.
  2693             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2694         16  cf-commission-cap-required     pic x.
  2695         16  CF-ST-GA-COMMISSION-CAPS.
  2696             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2697             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2698             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2699             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2700         16  CF-ST-TOT-COMMISSION-CAPS.
  2701             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2702             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2703             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2704             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2705         16  FILLER                         PIC X(156).
  2706
  2707****************************************************************
  2708*             BENEFIT MASTER RECORD                            *
  2709****************************************************************
  2710
  2711     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2712         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2713             20  CF-BENEFIT-CODE            PIC XX.
  2714             20  CF-BENEFIT-NUMERIC  REDEFINES
  2715                 CF-BENEFIT-CODE            PIC XX.
  2716             20  CF-BENEFIT-ALPHA           PIC XXX.
  2717             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2718             20  CF-BENEFIT-COMMENT         PIC X(10).
  2719
  2720             20  CF-LF-COVERAGE-TYPE        PIC X.
  2721                 88  CF-REDUCING                VALUE 'R'.
  2722                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2723
  2724             20  CF-SPECIAL-CALC-CD         PIC X.
  2725                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2726                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2727                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2728                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2729                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2730                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2731                 88  CF-FARM-PLAN               VALUE 'F'.
  2732                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2733                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2734                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2735                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2736                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2737                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2738                 88  CF-PRUDENTIAL              VALUE 'P'.
  2739                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  49
* EL677.cbl
  2740                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2741                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2742                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2743                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2744                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2745
  2746             20  CF-JOINT-INDICATOR         PIC X.
  2747                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2748
  2749*            20  FILLER                     PIC X(12).
  2750             20  cf-maximum-benefits        pic s999 comp-3.
  2751             20  FILLER                     PIC X(09).
  2752             20  CF-BENEFIT-CATEGORY        PIC X.
  2753             20  CF-LOAN-TYPE               PIC X(8).
  2754
  2755             20  CF-CO-REM-TERM-CALC        PIC X.
  2756                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2757                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2758                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2759                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2760                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2761
  2762             20  CF-CO-EARNINGS-CALC        PIC X.
  2763                 88  CO-EARN-BY-R78             VALUE '1'.
  2764                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2765                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2766                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2767                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2768                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2769                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2770                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2771
  2772             20  CF-CO-REFUND-CALC          PIC X.
  2773                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2774                 88  CO-REFD-BY-R78             VALUE '1'.
  2775                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2776                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2777                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2778                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2779                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2780                 88  CO-REFD-MEAN               VALUE '8'.
  2781                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2782                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2783                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2784
  2785             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2786                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2787                 88  CO-OVRD-BY-R78             VALUE '1'.
  2788                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2789                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2790                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2791                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2792                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2793                 88  CO-OVRD-MEAN               VALUE '8'.
  2794                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2795
  2796             20  CF-CO-BEN-I-G-CD           PIC X.
  2797                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  50
* EL677.cbl
  2798                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2799                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2800
  2801         16  FILLER                         PIC X(304).
  2802
  2803
  2804****************************************************************
  2805*             CARRIER MASTER RECORD                            *
  2806****************************************************************
  2807
  2808     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2809         16  CF-ADDRESS-DATA.
  2810             20  CF-MAIL-TO-NAME            PIC X(30).
  2811             20  CF-IN-CARE-OF              PIC X(30).
  2812             20  CF-ADDRESS-LINE-1          PIC X(30).
  2813             20  CF-ADDRESS-LINE-2          PIC X(30).
  2814             20  CF-CITY-STATE              PIC X(30).
  2815             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2816             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2817
  2818         16  CF-CLAIM-NO-CONTROL.
  2819             20  CF-CLAIM-NO-METHOD         PIC X.
  2820                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2821                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2822                 88  CLAIM-NO-SEQ               VALUE '3'.
  2823                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2824             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2825                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2826                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2827                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2828
  2829         16  CF-CHECK-NO-CONTROL.
  2830             20  CF-CHECK-NO-METHOD         PIC X.
  2831                 88  CHECK-NO-MANUAL            VALUE '1'.
  2832                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2833                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2834                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2835             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2836                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2837
  2838         16  CF-DOMICILE-STATE              PIC XX.
  2839
  2840         16  CF-EXPENSE-CONTROLS.
  2841             20  CF-EXPENSE-METHOD          PIC X.
  2842                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2843                 88  DOLLARS-PER-PMT            VALUE '2'.
  2844                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2845                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2846             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2847             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2848
  2849         16  CF-CORRESPONDENCE-CONTROL.
  2850             20  CF-LETTER-RESEND-OPT       PIC X.
  2851                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2852                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2853             20  FILLER                     PIC X(4).
  2854
  2855         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  51
* EL677.cbl
  2856             20  CF-MANUAL-SW               PIC X.
  2857                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2858             20  CF-FUTURE-SW               PIC X.
  2859                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2860             20  CF-PTC-SW                  PIC X.
  2861                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2862             20  CF-IBNR-SW                 PIC X.
  2863                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2864             20  CF-PTC-LF-SW               PIC X.
  2865                 88  CF-LF-PTC-USED             VALUE '1'.
  2866             20  CF-CDT-ACCESS-METHOD       PIC X.
  2867                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2868                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2869                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2870             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2871
  2872         16  CF-CLAIM-CALC-METHOD           PIC X.
  2873             88  360-PLUS-MONTHS                VALUE '1'.
  2874             88  365-PLUS-MONTHS                VALUE '2'.
  2875             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2876             88  360-DAILY                      VALUE '4'.
  2877             88  365-DAILY                      VALUE '5'.
  2878
  2879         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2880         16  FILLER                         PIC X(11).
  2881
  2882         16  CF-LIMIT-AMOUNTS.
  2883             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2884             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2885             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2886             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2887             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2888             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2889             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2890             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2891             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2892             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2893
  2894         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2895         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2896         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2897
  2898         16  CF-ZIP-CODE.
  2899             20  CF-ZIP-PRIME.
  2900                 24  CF-ZIP-1ST             PIC X.
  2901                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2902                 24  FILLER                 PIC X(4).
  2903             20  CF-ZIP-PLUS4               PIC X(4).
  2904         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2905             20  CF-CAN-POSTAL-1            PIC XXX.
  2906             20  CF-CAN-POSTAL-2            PIC XXX.
  2907             20  FILLER                     PIC XXX.
  2908
  2909         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2910         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2911         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2912
  2913         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  52
* EL677.cbl
  2914             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2915             88  CF-NO-RATING                   VALUE 'N'.
  2916
  2917         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2918
  2919         16  CF-CARRIER-OVER-SHORT.
  2920             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2921             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2922
  2923         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2924         16  CF-SECPAY-SWITCH               PIC X.
  2925             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2926             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2927         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2928         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2929         16  FILLER                         PIC X(444).
  2930*        16  FILLER                         PIC X(452).
  2931
  2932
  2933****************************************************************
  2934*             MORTALITY MASTER RECORD                          *
  2935****************************************************************
  2936
  2937     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2938         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2939                                INDEXED BY CF-MORT-NDX.
  2940             20  CF-MORT-TABLE              PIC X(5).
  2941             20  CF-MORT-TABLE-TYPE         PIC X.
  2942                 88  CF-MORT-JOINT              VALUE 'J'.
  2943                 88  CF-MORT-SINGLE             VALUE 'S'.
  2944                 88  CF-MORT-COMBINED           VALUE 'C'.
  2945                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2946                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2947             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2948             20  CF-MORT-AGE-METHOD         PIC XX.
  2949                 88  CF-AGE-LAST                VALUE 'AL'.
  2950                 88  CF-AGE-NEAR                VALUE 'AN'.
  2951             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2952             20  CF-MORT-ADJUSTMENT-DIRECTION
  2953                                            PIC X.
  2954                 88  CF-MINUS                   VALUE '-'.
  2955                 88  CF-PLUS                    VALUE '+'.
  2956             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2957             20  CF-MORT-JOINT-CODE         PIC X.
  2958                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2959             20  CF-MORT-PC-Q               PIC X.
  2960                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2961             20  CF-MORT-TABLE-CODE         PIC X(4).
  2962             20  CF-MORT-COMMENTS           PIC X(15).
  2963             20  FILLER                     PIC X(14).
  2964
  2965         16  FILLER                         PIC X(251).
  2966
  2967
  2968****************************************************************
  2969*             BUSSINESS TYPE MASTER RECORD                     *
  2970****************************************************************
  2971
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  53
* EL677.cbl
  2972     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2973* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2974* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2975* AND RECORD 05 IS TYPES 81-99
  2976         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2977             20  CF-BUSINESS-TITLE          PIC  X(19).
  2978             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2979                                            PIC S9V9(4) COMP-3.
  2980             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2981             20  FILLER                     PIC  X.
  2982         16  FILLER                         PIC  X(248).
  2983
  2984
  2985****************************************************************
  2986*             TERMINAL MASTER RECORD                           *
  2987****************************************************************
  2988
  2989     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2990
  2991         16  CF-COMPANY-TERMINALS.
  2992             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2993                                  PIC X(4).
  2994         16  FILLER               PIC X(248).
  2995
  2996
  2997****************************************************************
  2998*             LIFE EDIT MASTER RECORD                          *
  2999****************************************************************
  3000
  3001     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3002         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3003             20  CF-LIFE-CODE-IN            PIC XX.
  3004             20  CF-LIFE-CODE-OUT           PIC XX.
  3005         16  FILLER                         PIC X(248).
  3006
  3007
  3008****************************************************************
  3009*             AH EDIT MASTER RECORD                            *
  3010****************************************************************
  3011
  3012     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3013         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3014             20  CF-AH-CODE-IN              PIC XXX.
  3015             20  CF-AH-CODE-OUT             PIC XX.
  3016         16  FILLER                         PIC X(248).
  3017
  3018
  3019****************************************************************
  3020*             CREDIBILITY TABLES                               *
  3021****************************************************************
  3022
  3023     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3024         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3025                             INDEXED BY CF-CRDB-NDX.
  3026             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3027             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3028             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3029         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  54
* EL677.cbl
  3030
  3031
  3032****************************************************************
  3033*             REPORT CUSTOMIZATION RECORD                      *
  3034****************************************************************
  3035
  3036     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3037         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3038             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3039             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3040             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3041**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3042****       A T-TRANSFER.                                   ****
  3043             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3044
  3045         16  FILLER                         PIC XX.
  3046
  3047         16  CF-CARRIER-CNTL-OPT.
  3048             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3049                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3050                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3051             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3052                                            PIC X.
  3053         16  CF-GROUP-CNTL-OPT.
  3054             20  CF-GROUP-OPT-SEQ           PIC 9.
  3055                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3056                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3057             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3058                                            PIC X(6).
  3059         16  CF-STATE-CNTL-OPT.
  3060             20  CF-STATE-OPT-SEQ           PIC 9.
  3061                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3062                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3063             20  CF-STATE-SELECT OCCURS 3 TIMES
  3064                                            PIC XX.
  3065         16  CF-ACCOUNT-CNTL-OPT.
  3066             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3067                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3068                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3069             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3070                                            PIC X(10).
  3071         16  CF-BUS-TYP-CNTL-OPT.
  3072             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3073                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3074                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3075             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3076                                            PIC XX.
  3077         16  CF-LF-TYP-CNTL-OPT.
  3078             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3079                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3080                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3081             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3082                                            PIC XX.
  3083         16  CF-AH-TYP-CNTL-OPT.
  3084             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3085                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3086                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3087             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  55
* EL677.cbl
  3088                                            PIC XX.
  3089         16  CF-REPTCD1-CNTL-OPT.
  3090             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3091                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3092                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3093             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3094                                            PIC X(10).
  3095         16  CF-REPTCD2-CNTL-OPT.
  3096             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3097                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3098                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3099             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3100                                            PIC X(10).
  3101         16  CF-USER1-CNTL-OPT.
  3102             20  CF-USER1-OPT-SEQ           PIC 9.
  3103                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3104                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3105             20  CF-USER1-SELECT OCCURS 3 TIMES
  3106                                            PIC X(10).
  3107         16  CF-USER2-CNTL-OPT.
  3108             20  CF-USER2-OPT-SEQ           PIC 9.
  3109                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3110                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3111             20  CF-USER2-SELECT OCCURS 3 TIMES
  3112                                            PIC X(10).
  3113         16  CF-USER3-CNTL-OPT.
  3114             20  CF-USER3-OPT-SEQ           PIC 9.
  3115                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3116                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3117             20  CF-USER3-SELECT OCCURS 3 TIMES
  3118                                            PIC X(10).
  3119         16  CF-USER4-CNTL-OPT.
  3120             20  CF-USER4-OPT-SEQ           PIC 9.
  3121                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3122                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3123             20  CF-USER4-SELECT OCCURS 3 TIMES
  3124                                            PIC X(10).
  3125         16  CF-USER5-CNTL-OPT.
  3126             20  CF-USER5-OPT-SEQ           PIC 9.
  3127                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3128                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3129             20  CF-USER5-SELECT OCCURS 3 TIMES
  3130                                            PIC X(10).
  3131         16  CF-REINS-CNTL-OPT.
  3132             20  CF-REINS-OPT-SEQ           PIC 9.
  3133                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3134                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3135             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3136                 24  CF-REINS-PRIME         PIC XXX.
  3137                 24  CF-REINS-SUB           PIC XXX.
  3138
  3139         16  CF-AGENT-CNTL-OPT.
  3140             20  CF-AGENT-OPT-SEQ           PIC 9.
  3141                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3142                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3143             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3144                                            PIC X(10).
  3145
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  56
* EL677.cbl
  3146         16  FILLER                         PIC X(43).
  3147
  3148         16  CF-LOSS-RATIO-SELECT.
  3149             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3150             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3151         16  CF-ENTRY-DATE-SELECT.
  3152             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3153             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3154         16  CF-EFFECTIVE-DATE-SELECT.
  3155             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3156             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3157
  3158         16  CF-EXCEPTION-LIST-IND          PIC X.
  3159             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3160
  3161         16  FILLER                         PIC X(318).
  3162
  3163****************************************************************
  3164*                  EXCEPTION REPORTING RECORD                  *
  3165****************************************************************
  3166
  3167     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3168         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3169             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3170
  3171         16  CF-COMBINED-LIFE-AH-OPT.
  3172             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3173             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3174             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3175             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3176
  3177         16  CF-LIFE-OPT.
  3178             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3179             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3180             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3181             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3182             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3183             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3184             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3185             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3186             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3187             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3188
  3189         16  CF-AH-OPT.
  3190             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3191             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3192             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3193             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3194             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3195             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3196             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3197             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3198             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3199             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3200
  3201         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3202             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3203             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  57
* EL677.cbl
  3204             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3205
  3206         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3207
  3208         16  FILLER                         PIC X(673).
  3209
  3210
  3211****************************************************************
  3212*             MORTGAGE SYSTEM PLAN RECORD                      *
  3213****************************************************************
  3214
  3215     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3216         16  CF-PLAN-TYPE                   PIC X.
  3217             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3218             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3219             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3220         16  CF-PLAN-ABBREV                 PIC XXX.
  3221         16  CF-PLAN-DESCRIPT               PIC X(10).
  3222         16  CF-PLAN-NOTES                  PIC X(20).
  3223         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3224         16  CF-PLAN-UNDERWRITING.
  3225             20  CF-PLAN-TERM-DATA.
  3226                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3227                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3228             20  CF-PLAN-AGE-DATA.
  3229                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3230                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3231                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3232             20  CF-PLAN-BENEFIT-DATA.
  3233                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3234                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3235                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3236                                            PIC S9(7)V99  COMP-3.
  3237         16  CF-PLAN-POLICY-FORMS.
  3238             20  CF-POLICY-FORM             PIC X(12).
  3239             20  CF-MASTER-APPLICATION      PIC X(12).
  3240             20  CF-MASTER-POLICY           PIC X(12).
  3241         16  CF-PLAN-RATING.
  3242             20  CF-RATE-CODE               PIC X(5).
  3243             20  CF-SEX-RATING              PIC X.
  3244                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3245                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3246             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3247             20  CF-SUB-STD-TYPE            PIC X.
  3248                 88  CF-PCT-OF-PREM            VALUE '1'.
  3249                 88  CF-PCT-OF-BENE            VALUE '2'.
  3250         16  CF-PLAN-PREM-TOLERANCES.
  3251             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3252             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3253         16  CF-PLAN-PYMT-TOLERANCES.
  3254             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3255             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3256         16  CF-PLAN-MISC-DATA.
  3257             20  FILLER                     PIC X.
  3258             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3259             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3260         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3261         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  58
* EL677.cbl
  3262             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3263                                                     '1'.
  3264             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3265                                                     '2'.
  3266         16  CF-MIB-SEARCH-SW               PIC X.
  3267             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3268             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3269             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3270             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3271         16  CF-ALPHA-SEARCH-SW             PIC X.
  3272             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3273             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3274             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3275             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3276             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3277             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3278             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3279             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3280             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3281             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3282                                                     'A' 'B' 'C'
  3283                                                     'X' 'Y' 'Z'.
  3284         16  CF-EFF-DT-RULE-SW              PIC X.
  3285             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3286             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3287             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3288             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3289             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3290         16  FILLER                         PIC X(4).
  3291         16  CF-HEALTH-QUESTIONS            PIC X.
  3292             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3293         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3294         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3295         16  CF-PLAN-SNGL-JNT               PIC X.
  3296             88  CF-COMBINED-PLAN              VALUE 'C'.
  3297             88  CF-JNT-PLAN                   VALUE 'J'.
  3298             88  CF-SNGL-PLAN                  VALUE 'S'.
  3299         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3300         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3301         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3302         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3303         16  CF-RERATE-CNTL                 PIC  X.
  3304             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3305             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3306             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3307             88  CF-AUTO-RECALC                 VALUE '4'.
  3308         16  CF-BENEFIT-TYPE                PIC  X.
  3309             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3310             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3311         16  CF-POLICY-FEE                  PIC S999V99
  3312                                                    COMP-3.
  3313         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3314         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3315         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3316         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3317         16  FILLER                         PIC  X(32).
  3318         16  CF-TERMINATION-FORM            PIC  X(04).
  3319         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  59
* EL677.cbl
  3320         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3321                                                       COMP-3.
  3322         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3323         16  CF-ISSUE-LETTER                PIC  X(4).
  3324         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3325         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3326             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3327             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3328         16  CF-MP-REFUND-CALC              PIC X.
  3329             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3330             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3331             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3332             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3333             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3334             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3335             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3336             88  CF-MP-REFD-MEAN                VALUE '8'.
  3337         16  CF-ALT-RATE-CODE               PIC  X(5).
  3338
  3339
  3340         16  FILLER                         PIC X(498).
  3341****************************************************************
  3342*             MORTGAGE COMPANY MASTER RECORD                   *
  3343****************************************************************
  3344
  3345     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3346         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3347         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3348             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3349             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3350             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3351             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3352             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3353
  3354         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3355         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3356         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3357         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3358         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3359
  3360         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3361             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3362         16  CF-MP-RECON-USE-IND            PIC X(1).
  3363             88  CF-MP-USE-RECON             VALUE 'Y'.
  3364         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3365             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3366         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3367             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3368             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3369         16  FILLER                         PIC X(1).
  3370         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3371             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3372         16  CF-MORTG-MIB-VERSION           PIC X.
  3373             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3374             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3375             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3376         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3377             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  60
* EL677.cbl
  3378                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3379             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3380                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3381             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3382                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3383             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3384                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3385             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3386                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3387             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3388                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3389         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3390         16  FILLER                         PIC X(7).
  3391         16  CF-MORTG-DESTINATION-SYMBOL.
  3392             20  CF-MORTG-MIB-COMM          PIC X(5).
  3393             20  CF-MORTG-MIB-TERM          PIC X(5).
  3394         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3395             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3396         16  FILLER                         PIC X(03).
  3397         16  CF-MP-CHECK-NO-CONTROL.
  3398             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3399                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3400                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3401                                                ' ' LOW-VALUES.
  3402                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3403                                               VALUE '3'.
  3404         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3405         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3406         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3407             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3408                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3409             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3410                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3411             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3412                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3413             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3414                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3415             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3416                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3417             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3418                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3419         16  CF-MORTG-BILLING-AREA.
  3420             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3421                                            PIC X.
  3422         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3423         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3424         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3425         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3426             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3427             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3428         16  FILLER                         PIC X.
  3429         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3430             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3431             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3432         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3433         16  FILLER                         PIC X(8).
  3434         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3435         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  61
* EL677.cbl
  3436         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3437         16  CF-ACH-COMPANY-ID.
  3438             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3439                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3440                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3441                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3442             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3443         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3444             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3445         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3446             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3447             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3448         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3449         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3450         16  FILLER                         PIC X(536).
  3451
  3452****************************************************************
  3453*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3454****************************************************************
  3455
  3456     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3457         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3458             20  CF-FEMALE-HEIGHT.
  3459                 24  CF-FEMALE-FT           PIC 99.
  3460                 24  CF-FEMALE-IN           PIC 99.
  3461             20  CF-FEMALE-MIN-WT           PIC 999.
  3462             20  CF-FEMALE-MAX-WT           PIC 999.
  3463         16  FILLER                         PIC X(428).
  3464
  3465     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3466         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3467             20  CF-MALE-HEIGHT.
  3468                 24  CF-MALE-FT             PIC 99.
  3469                 24  CF-MALE-IN             PIC 99.
  3470             20  CF-MALE-MIN-WT             PIC 999.
  3471             20  CF-MALE-MAX-WT             PIC 999.
  3472         16  FILLER                         PIC X(428).
  3473******************************************************************
  3474*             AUTOMATIC ACTIVITY RECORD                          *
  3475******************************************************************
  3476     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3477         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3478             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3479             20  CF-SYS-LETTER-ID           PIC X(04).
  3480             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3481             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3482             20  CF-SYS-RESET-SW            PIC X(01).
  3483             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3484             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3485
  3486         16  FILLER                         PIC X(50).
  3487
  3488         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3489             20  CF-USER-ACTIVE-SW          PIC X(01).
  3490             20  CF-USER-LETTER-ID          PIC X(04).
  3491             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3492             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3493             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  62
* EL677.cbl
  3494             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3495             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3496             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3497
  3498         16  FILLER                         PIC X(246).
  3499*                                COPY ERCCHEK.
  3500******************************************************************
  3501*                                                                *
  3502*                                                                *
  3503*                            ERCCHEK                             *
  3504*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3505*                            VMOD=2.008                          *
  3506*                                                                *
  3507*   FILE DESCRIPTION = CHECK RECORDS                             *
  3508*                                                                *
  3509*   FILE TYPE = VSAM,KSDS                                        *
  3510*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3511*                                                                *
  3512*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3513*       ALTERNATE INDEX = NONE                                   *
  3514*                                                                *
  3515*   LOG = YES                                                    *
  3516*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3517******************************************************************
  3518*                   C H A N G E   L O G
  3519*
  3520* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3521*-----------------------------------------------------------------
  3522*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3523* EFFECTIVE    NUMBER
  3524*-----------------------------------------------------------------
  3525* 021414    2003053000001  PEMA  changes for auto chk request
  3526******************************************************************
  3527 01  CHECK-RECORDS.
  3528     12  CH-RECORD-ID                      PIC XX.
  3529         88  VALID-CH-ID                      VALUE 'CH'.
  3530
  3531     12  CH-CONTROL-PRIMARY.
  3532         16  CH-COMPANY-CD                 PIC X.
  3533         16  CH-CARRIER                    PIC X.
  3534         16  CH-GROUPING                   PIC X(6).
  3535         16  CH-STATE                      PIC XX.
  3536         16  CH-ACCOUNT                    PIC X(10).
  3537         16  CH-CERT-EFF-DT                PIC XX.
  3538         16  CH-CERT-NO.
  3539             20  CH-CERT-PRIME             PIC X(10).
  3540             20  CH-CERT-SFX               PIC X.
  3541         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3542
  3543     12  CH-RECORDED-DT                    PIC XX.
  3544     12  CH-RECORDED-BY                    PIC X(4).
  3545     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3546
  3547     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3548     12  CH-CHECK-NO                       PIC X(7).
  3549     12  CH-REASON-FOR-CHECK               PIC X(25).
  3550     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3551     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  63
* EL677.cbl
  3552
  3553     12  CH-PAYEE-INFO.
  3554         16  CH-PAYEE-NAME-1               PIC X(30).
  3555         16  CH-PAYEE-NAME-2               PIC X(30).
  3556         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3557         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3558         16  CH-PAYEE-CITY-ST.
  3559             20  CH-PAYEE-CITY             PIC X(28).
  3560             20  CH-PAYEE-STATE            PIC XX.
  3561         16  CH-PAYEE-ZIP-CODE.
  3562             20  CH-PAYEE-ZIP.
  3563                 24  CH-ZIP-PRI-1ST        PIC X.
  3564                     88  CH-CANADIAN-POST-CODE
  3565                                           VALUES 'A' THRU 'Z'.
  3566                 24  FILLER                PIC X(4).
  3567             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3568         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3569             20  CH-CAN-POSTAL-1           PIC XXX.
  3570             20  CH-CAN-POSTAL-2           PIC XXX.
  3571             20  FILLER                    PIC XXX.
  3572
  3573     12  CH-CHECK-STUB-TEXT.
  3574         16  CH-STUB-LINE-1                PIC X(30).
  3575         16  CH-TEXT-LINE-1                PIC X(50).
  3576         16  CH-TEXT-LINE-2                PIC X(50).
  3577         16  CH-TEXT-LINE-3                PIC X(40).
  3578     12  CH-RETURN-TO                      PIC X(30).
  3579
  3580     12  CH-COMPENSATION-CONTROL.
  3581         16  CH-COMP-CARRIER               PIC X.
  3582         16  CH-COMP-GROUPING              PIC X(6).
  3583         16  CH-COMP-FIN-RESP              PIC X(10).
  3584         16  CH-COMP-ACCOUNT               PIC X(10).
  3585
  3586     12  CH-CREDIT-SELECT-DT               PIC XX.
  3587     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3588     12  CH-PAYEE-CODE                     PIC X(6).
  3589
  3590     12  CH-VOID-DATA.
  3591         20  CH-VOID-DT                    PIC XX.
  3592         20  CH-VOID-BY                    PIC X(4).
  3593         20  CH-VOID-REASON                PIC X(25).
  3594
  3595     12  CH-APPROVAL-DATA.
  3596         20  CH-APPROVAL-DT                PIC XX.
  3597         20  CH-APPROVAL-STATUS            PIC X.
  3598             88  CH-IN-LIMBO                  VALUE ' '.
  3599             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  3600             88  CH-APPROVED                  VALUE 'A'.
  3601             88  CH-DENIED                    VALUE 'D'.
  3602         20  CH-APPROVED-BY                PIC XXXX.
  3603     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3604             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3605     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3606
  3607     12  ch-released-dt                    pic xx.
  3608     12  ch-check-cashed-dt                pic xx.
  3609     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  64
* EL677.cbl
  3610*    12  CH-CHECK-REFERENCE                PIC X(12).
  3611     12  CH-CHECK-ORIGIN-SW                PIC X.
  3612             88  CH-REFUND-CHECK              VALUE 'R'.
  3613             88  CH-MAINT-CHECK               VALUE 'M'.
  3614
  3615     12  CH-CANC-DT                        PIC XX.
  3616     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3617     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3618
  3619     12  CH-INSURED-NAME                   PIC X(28).
  3620
  3621     12  ch-released-by                    pic x(4).
  3622     12  ch-csr                            pic x(4).
  3623     12  ch-deduct-commission              pic x.
  3624         88  ch-deduct-comm                  value 'Y'.
  3625         88  ch-do-not-deduct-comm           value 'N'.
  3626
  3627     12  FILLER                            PIC X(11).
  3628*    12  CH-LETTER-TABLE.
  3629*        16  CH-LETTERS OCCURS 3 TIMES
  3630*                       INDEXED BY CH-LT-NDX
  3631*                                          PIC X(04).
  3632
  3633     12  FILLER                            PIC X(07).
  3634
  3635*                                COPY ERCACCT.
  3636******************************************************************
  3637*                                                                *
  3638*                                                                *
  3639*                            ERCACCT                             *
  3640*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3641*                            VMOD=2.031                          *
  3642*                                                                *
  3643*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3644*                                                                *
  3645*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3646*   VSAM ACCOUNT MASTER FILES.                                   *
  3647*                                                                *
  3648*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3649*                                                                *
  3650*   FILE TYPE = VSAM,KSDS                                        *
  3651*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3652*                                                                *
  3653*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3654*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3655*                                                                *
  3656*   LOG = NO                                                     *
  3657*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3658*                                                                *
  3659*                                                                *
  3660******************************************************************
  3661*                   C H A N G E   L O G
  3662*
  3663* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3664*-----------------------------------------------------------------
  3665*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3666* EFFECTIVE    NUMBER
  3667*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  65
* EL677.cbl
  3668* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3669* 092705    2005050300006  PEMA  ADD SPP LEASES
  3670* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3671* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3672* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3673* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3674* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3675* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  3676******************************************************************
  3677
  3678 01  ACCOUNT-MASTER.
  3679     12  AM-RECORD-ID                      PIC XX.
  3680         88  VALID-AM-ID                      VALUE 'AM'.
  3681
  3682     12  AM-CONTROL-PRIMARY.
  3683         16  AM-COMPANY-CD                 PIC X.
  3684         16  AM-MSTR-CNTRL.
  3685             20  AM-CONTROL-A.
  3686                 24  AM-CARRIER            PIC X.
  3687                 24  AM-GROUPING.
  3688                     28 AM-GROUPING-PREFIX PIC XXX.
  3689                     28 AM-GROUPING-PRIME  PIC XXX.
  3690                 24  AM-STATE              PIC XX.
  3691                 24  AM-ACCOUNT.
  3692                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3693                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3694             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3695                                           PIC X(19).
  3696             20  AM-CNTRL-B.
  3697                 24  AM-EXPIRATION-DT      PIC XX.
  3698                 24  FILLER                PIC X(4).
  3699             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3700                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3701
  3702     12  AM-CONTROL-BY-VAR-GRP.
  3703         16  AM-COMPANY-CD-A1              PIC X.
  3704         16  AM-VG-CARRIER                 PIC X.
  3705         16  AM-VG-GROUPING                PIC X(6).
  3706         16  AM-VG-STATE                   PIC XX.
  3707         16  AM-VG-ACCOUNT                 PIC X(10).
  3708         16  AM-VG-DATE.
  3709             20  AM-VG-EXPIRATION-DT       PIC XX.
  3710             20  FILLER                    PIC X(4).
  3711         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3712                                           PIC 9(11)      COMP-3.
  3713     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3714         16  FILLER                        PIC X(10).
  3715         16  AM-VG-KEY3.
  3716             20  AM-VG3-ACCOUNT            PIC X(10).
  3717             20  AM-VG3-EXP-DT             PIC XX.
  3718         16  FILLER                        PIC X(4).
  3719     12  AM-MAINT-INFORMATION.
  3720         16  AM-LAST-MAINT-DT              PIC XX.
  3721         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3722         16  AM-LAST-MAINT-USER            PIC X(4).
  3723         16  FILLER                        PIC XX.
  3724
  3725     12  AM-EFFECTIVE-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  66
* EL677.cbl
  3726     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3727
  3728     12  AM-PREV-DATES  COMP-3.
  3729         16  AM-PREV-EXP-DT                PIC 9(11).
  3730         16  AM-PREV-EFF-DT                PIC 9(11).
  3731
  3732     12  AM-REPORT-CODE-1                  PIC X(10).
  3733     12  AM-REPORT-CODE-2                  PIC X(10).
  3734
  3735     12  AM-CITY-CODE                      PIC X(4).
  3736     12  AM-COUNTY-PARISH                  PIC X(6).
  3737
  3738     12  AM-NAME                           PIC X(30).
  3739     12  AM-PERSON                         PIC X(30).
  3740     12  AM-ADDRS                          PIC X(30).
  3741     12  AM-CITY.
  3742         16  AM-ADDR-CITY                  PIC X(28).
  3743         16  AM-ADDR-STATE                 PIC XX.
  3744     12  AM-ZIP.
  3745         16  AM-ZIP-PRIME.
  3746             20  AM-ZIP-PRI-1ST            PIC X.
  3747                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3748             20  FILLER                    PIC X(4).
  3749         16  AM-ZIP-PLUS4                  PIC X(4).
  3750     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3751         16  AM-CAN-POSTAL-1               PIC XXX.
  3752         16  AM-CAN-POSTAL-2               PIC XXX.
  3753         16  FILLER                        PIC XXX.
  3754     12  AM-TEL-NO.
  3755         16  AM-AREA-CODE                  PIC 999.
  3756         16  AM-TEL-PRE                    PIC 999.
  3757         16  AM-TEL-NBR                    PIC 9(4).
  3758     12  AM-TEL-LOC                        PIC X.
  3759         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3760         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3761
  3762     12  AM-COMM-STRUCTURE.
  3763         16  AM-DEFN-1.
  3764             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3765                 24  AM-AGT.
  3766                     28  AM-AGT-PREFIX     PIC X(4).
  3767                     28  AM-AGT-PRIME      PIC X(6).
  3768                 24  AM-COM-TYP            PIC X.
  3769                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3770                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3771                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3772                 24  AM-RECALC-LV-INDIC    PIC X.
  3773                 24  AM-RETRO-LV-INDIC     PIC X.
  3774                 24  AM-GL-CODES           PIC X.
  3775                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3776                 24  FILLER                PIC X(01).
  3777         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3778             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3779                 24  FILLER                PIC X(11).
  3780                 24  AM-L-COMA             PIC XXX.
  3781                 24  AM-J-COMA             PIC XXX.
  3782                 24  AM-A-COMA             PIC XXX.
  3783                 24  FILLER                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  67
* EL677.cbl
  3784
  3785     12  AM-COMM-CHANGE-STATUS             PIC X.
  3786         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3787
  3788     12  AM-CSR-CODE                       PIC X(4).
  3789
  3790     12  AM-BILLING-STATUS                 PIC X.
  3791         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3792         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3793     12  AM-AUTO-REFUND-SW                 PIC X.
  3794         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3795         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3796     12  AM-GPCD                           PIC 99.
  3797     12  AM-IG                             PIC X.
  3798         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3799         88  AM-HAS-GROUP                     VALUE '2'.
  3800     12  AM-STATUS                         PIC X.
  3801         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3802         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3803         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3804         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3805         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3806         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3807         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  3808         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  3809         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  3810         88  AM-ACCOUNT-PENDING               VALUE '9'.
  3811     12  AM-REMIT-TO                       PIC 99.
  3812     12  AM-ID-NO                          PIC X(11).
  3813
  3814     12  AM-CAL-TABLE                      PIC XX.
  3815     12  AM-LF-DEVIATION                   PIC XXX.
  3816     12  AM-AH-DEVIATION                   PIC XXX.
  3817     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3818     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3819     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3820     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3821     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3822     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3823
  3824     12  AM-USER-FIELDS.
  3825         16  AM-FLD-1                      PIC XX.
  3826         16  AM-FLD-2                      PIC XX.
  3827         16  AM-FLD-3                      PIC XX.
  3828         16  AM-FLD-4                      PIC XX.
  3829         16  AM-FLD-5                      PIC XX.
  3830
  3831     12  AM-1ST-PROD-DATE.
  3832         16  AM-1ST-PROD-YR                PIC XX.
  3833         16  AM-1ST-PROD-MO                PIC XX.
  3834         16  AM-1ST-PROD-DA                PIC XX.
  3835     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3836     12  AM-CERTS-PURGED-DATE.
  3837         16  AM-PUR-YR                     PIC XX.
  3838         16  AM-PUR-MO                     PIC XX.
  3839         16  AM-PUR-DA                     PIC XX.
  3840     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3841     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  68
* EL677.cbl
  3842     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3843     12  AM-INACTIVE-DATE.
  3844         16  AM-INA-MO                     PIC 99.
  3845         16  AM-INA-DA                     PIC 99.
  3846         16  AM-INA-YR                     PIC 99.
  3847     12  AM-AR-HI-CERT-DATE                PIC XX.
  3848
  3849     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3850     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3851
  3852     12  AM-OB-PAYMENT-MODE                PIC X.
  3853         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3854         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3855         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3856         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3857
  3858     12  AM-AH-ONLY-INDICATOR              PIC X.
  3859         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3860         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3861
  3862     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3863
  3864     12  AM-OVER-SHORT.
  3865         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3866         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3867
  3868     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3869     12  AM-DCC-CLP-STATE                  PIC XX.
  3870
  3871     12  AM-RECALC-COMM                    PIC X.
  3872     12  AM-RECALC-REIN                    PIC X.
  3873
  3874     12  AM-REI-TABLE                      PIC XXX.
  3875     12  AM-REI-ET-LF                      PIC X.
  3876     12  AM-REI-ET-AH                      PIC X.
  3877     12  AM-REI-PE-LF                      PIC X.
  3878     12  AM-REI-PE-AH                      PIC X.
  3879     12  AM-REI-PRT-ST                     PIC X.
  3880     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3881     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3882     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3883     12  AM-REI-GROUP-A                    PIC X(6).
  3884     12  AM-REI-MORT                       PIC X(4).
  3885     12  AM-REI-PRT-OW                     PIC X.
  3886     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3887     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3888     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3889     12  AM-REI-GROUP-B                    PIC X(6).
  3890
  3891     12  AM-TRUST-TYPE                     PIC X(2).
  3892
  3893     12  AM-EMPLOYER-STMT-USED             PIC X.
  3894     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3895
  3896     12  AM-STD-AH-TYPE                    PIC XX.
  3897     12  AM-EARN-METHODS.
  3898         16  AM-EARN-METHOD-R              PIC X.
  3899             88 AM-REF-RL-R78                 VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  69
* EL677.cbl
  3900             88 AM-REF-RL-PR                  VALUE 'P'.
  3901             88 AM-REF-RL-MEAN                VALUE 'M'.
  3902             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3903         16  AM-EARN-METHOD-L              PIC X.
  3904             88 AM-REF-LL-R78                 VALUE 'R'.
  3905             88 AM-REF-LL-PR                  VALUE 'P'.
  3906             88 AM-REF-LL-MEAN                VALUE 'M'.
  3907             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3908         16  AM-EARN-METHOD-A              PIC X.
  3909             88 AM-REF-AH-R78                 VALUE 'R'.
  3910             88 AM-REF-AH-PR                  VALUE 'P'.
  3911             88 AM-REF-AH-MEAN                VALUE 'M'.
  3912             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3913             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3914             88 AM-REF-AH-NET                 VALUE 'N'.
  3915
  3916     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3917     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3918     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3919
  3920     12  AM-RET-Y-N                        PIC X.
  3921     12  AM-RET-P-E                        PIC X.
  3922     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3923     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3924     12  AM-RET-GRP                        PIC X(6).
  3925     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3926         16  AM-POOL-PRIME                 PIC XXX.
  3927         16  AM-POOL-SUB                   PIC XXX.
  3928     12  AM-RETRO-EARNINGS.
  3929         16  AM-RET-EARN-R                 PIC X.
  3930         16  AM-RET-EARN-L                 PIC X.
  3931         16  AM-RET-EARN-A                 PIC X.
  3932     12  AM-RET-ST-TAX-USE                 PIC X.
  3933         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3934         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3935     12  AM-RETRO-BEG-EARNINGS.
  3936         16  AM-RET-BEG-EARN-R             PIC X.
  3937         16  AM-RET-BEG-EARN-L             PIC X.
  3938         16  AM-RET-BEG-EARN-A             PIC X.
  3939     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3940     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3941
  3942     12  AM-USER-SELECT-OPTIONS.
  3943         16  AM-USER-SELECT-1              PIC X(10).
  3944         16  AM-USER-SELECT-2              PIC X(10).
  3945         16  AM-USER-SELECT-3              PIC X(10).
  3946         16  AM-USER-SELECT-4              PIC X(10).
  3947         16  AM-USER-SELECT-5              PIC X(10).
  3948
  3949     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3950
  3951     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3952
  3953     12  AM-RPT045A-SWITCH                 PIC X.
  3954         88  RPT045A-OFF                   VALUE 'N'.
  3955
  3956     12  AM-INSURANCE-LIMITS.
  3957         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  70
* EL677.cbl
  3958         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3959
  3960     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3961         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3962
  3963     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3964         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3965         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3966
  3967     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3968
  3969     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3970     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3971     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3972     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3973     12  AM-DCC-UEF-STATE                  PIC XX.
  3974     12  FILLER                            PIC XXX.
  3975     12  AM-REPORT-CODE-3                  PIC X(10).
  3976*    12  FILLER                            PIC X(22).
  3977
  3978     12  AM-RESERVE-DATE.
  3979         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3980         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3981         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3982
  3983     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3984     12  AM-NOTIFICATION-TYPES.
  3985         16  AM-NOTIF-OF-LETTERS           PIC X.
  3986         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3987         16  AM-NOTIF-OF-REPORTS           PIC X.
  3988         16  AM-NOTIF-OF-STATUS            PIC X.
  3989
  3990     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3991         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3992         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3993         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3994         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3995
  3996     12  AM-BENEFIT-CONTROLS.
  3997         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  3998             20  AM-BENEFIT-CODE           PIC XX.
  3999             20  AM-BENEFIT-TYPE           PIC X.
  4000             20  AM-BENEFIT-REVISION       PIC XXX.
  4001             20  AM-BENEFIT-REM-TERM       PIC X.
  4002             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4003             20  FILLER                    PIC XX.
  4004         16  FILLER                        PIC X(80).
  4005
  4006     12  AM-TRANSFER-DATA.
  4007         16  AM-TRANSFERRED-FROM.
  4008             20  AM-TRNFROM-CARRIER        PIC X.
  4009             20  AM-TRNFROM-GROUPING.
  4010                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4011                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4012             20  AM-TRNFROM-STATE          PIC XX.
  4013             20  AM-TRNFROM-ACCOUNT.
  4014                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4015                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  71
* EL677.cbl
  4016             20  AM-TRNFROM-DTE            PIC XX.
  4017         16  AM-TRANSFERRED-TO.
  4018             20  AM-TRNTO-CARRIER          PIC X.
  4019             20  AM-TRNTO-GROUPING.
  4020                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4021                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4022             20  AM-TRNTO-STATE            PIC XX.
  4023             20  AM-TRNTO-ACCOUNT.
  4024                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4025                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4026             20  AM-TRNTO-DTE              PIC XX.
  4027         16  FILLER                        PIC X(10).
  4028
  4029     12  AM-SAVED-REMIT-TO                 PIC 99.
  4030
  4031     12  AM-COMM-STRUCTURE-SAVED.
  4032         16  AM-DEFN-1-SAVED.
  4033             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4034                 24  AM-AGT-SV             PIC X(10).
  4035                 24  AM-COM-TYP-SV         PIC X.
  4036                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4037                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4038                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4039                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4040                 24  FILLER                PIC X.
  4041                 24  AM-GL-CODES-SV        PIC X.
  4042                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4043                 24  FILLER                PIC X.
  4044         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4045             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4046                 24  FILLER                PIC X(11).
  4047                 24  AM-L-COMA-SV          PIC XXX.
  4048                 24  AM-J-COMA-SV          PIC XXX.
  4049                 24  AM-A-COMA-SV          PIC XXX.
  4050                 24  FILLER                PIC X(6).
  4051
  4052     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4053         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4054            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4055            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4056            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4057
  4058     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4059     12  FILLER                            PIC X(120).
  4060
  4061     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4062         16  AM-CONTROL-NAME               PIC X(30).
  4063         16  AM-EXECUTIVE-ONE.
  4064             20  AM-EXEC1-NAME             PIC X(15).
  4065             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4066                                                          COMP-3.
  4067             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4068                                                          COMP-3.
  4069         16  AM-EXECUTIVE-TWO.
  4070             20  AM-EXEC2-NAME             PIC X(15).
  4071             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4072                                                          COMP-3.
  4073             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  72
* EL677.cbl
  4074                                                          COMP-3.
  4075
  4076     12  AM-RETRO-ADDITIONAL-DATA.
  4077         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4078         16  AM-RETRO-PREM-P-E             PIC X.
  4079         16  AM-RETRO-CLMS-P-I             PIC X.
  4080         16  AM-RETRO-RET-BRACKET-LF.
  4081             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4082                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4083                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4084             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4085                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4086                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4087             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4088                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4089                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4090         16  AM-RETRO-RET-BRACKET-AH.
  4091             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4092                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4093                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4094                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4095             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4096                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4097                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4098             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4099                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4100                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4101
  4102     12  AM-COMMENTS.
  4103         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4104
  4105     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4106         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4107         16  AM-FLI-BILLING-CODE           PIC X.
  4108         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4109         16  AM-FLI-UNITED-IDENT           PIC X.
  4110         16  AM-FLI-INTEREST-LOST-DATA.
  4111             20  AM-FLI-BANK-NO            PIC X(5).
  4112             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4113             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4114             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4115         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4116             20  AM-FLI-AGT                PIC X(9).
  4117             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4118             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4119         16  FILLER                        PIC X(102).
  4120
  4121     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4122         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4123             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4124             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4125             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4126             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4127             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4128         16  FILLER                          PIC X(10).
  4129******************************************************************
  4130*                                COPY ERCCOMP.
  4131******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  73
* EL677.cbl
  4132*                                                                *
  4133*                                                                *
  4134*                            ERCCOMP                             *
  4135*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4136*                            VMOD=2.019                          *
  4137*                                                                *
  4138*   ONLINE CREDIT SYSTEM                                         *
  4139*                                                                *
  4140*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4141*                                                                *
  4142*   FILE TYPE = VSAM,KSDS                                        *
  4143*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4144*                                                                *
  4145*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4146*       ALTERNATE PATH = NONE                                    *
  4147*                                                                *
  4148*   LOG = NO                                                     *
  4149*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4150*                                                                *
  4151******************************************************************
  4152*                   C H A N G E   L O G
  4153*
  4154* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4155*-----------------------------------------------------------------
  4156*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4157* EFFECTIVE    NUMBER
  4158*-----------------------------------------------------------------
  4159* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4160* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4161* 092205    2005050300006  PEMA  ADD LEASE FEE
  4162* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4163* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4164* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4165* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4166* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4167* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4168******************************************************************
  4169
  4170 01  COMPENSATION-MASTER.
  4171     12  CO-RECORD-ID                          PIC XX.
  4172         88  VALID-CO-ID                          VALUE 'CO'.
  4173
  4174     12  CO-CONTROL-PRIMARY.
  4175         16  CO-COMPANY-CD                     PIC X.
  4176         16  CO-CONTROL.
  4177             20  CO-CTL-1.
  4178                 24  CO-CARR-GROUP.
  4179                     28  CO-CARRIER            PIC X.
  4180                     28  CO-GROUPING.
  4181                         32  CO-GROUP-PREFIX   PIC XXX.
  4182                         32  CO-GROUP-PRIME    PIC XXX.
  4183                 24  CO-RESP-NO.
  4184                     28  CO-RESP-PREFIX        PIC X(4).
  4185                     28  CO-RESP-PRIME         PIC X(6).
  4186             20  CO-CTL-2.
  4187                 24  CO-ACCOUNT.
  4188                     28  CO-ACCT-PREFIX        PIC X(4).
  4189                     28  CO-ACCT-PRIME         PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  74
* EL677.cbl
  4190         16  CO-TYPE                           PIC X.
  4191             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4192             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4193             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4194
  4195     12  CO-MAINT-INFORMATION.
  4196         16  CO-LAST-MAINT-DT                  PIC XX.
  4197         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4198         16  CO-LAST-MAINT-USER                PIC X(4).
  4199     12  FILLER                                PIC XX.
  4200     12  CO-STMT-TYPE                          PIC XXX.
  4201     12  CO-COMP-TYPE                          PIC X.
  4202         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4203     12  CO-STMT-OWNER                         PIC X(4).
  4204     12  CO-BALANCE-CONTROL                    PIC X.
  4205         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4206         88  CO-NO-BALANCE                        VALUE 'N'.
  4207
  4208     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4209         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4210         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4211         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4212
  4213     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4214         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4215         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4216
  4217     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4218     12  CO-GA-DIRECT-DEP                      PIC X.
  4219     12  CO-FUTURE-SPACE                       PIC X.
  4220         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4221
  4222     12  CO-ACCT-NAME                          PIC X(30).
  4223     12  CO-MAIL-NAME                          PIC X(30).
  4224     12  CO-ADDR-1                             PIC X(30).
  4225     12  CO-ADDR-2                             PIC X(30).
  4226     12  CO-ADDR-3.
  4227         16  CO-ADDR-CITY                      PIC X(27).
  4228         16  CO-ADDR-STATE                     PIC XX.
  4229     12  CO-CSO-1099                           PIC X.
  4230     12  CO-ZIP.
  4231         16  CO-ZIP-PRIME.
  4232             20  CO-ZIP-PRI-1ST                PIC X.
  4233                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4234             20  FILLER                        PIC X(4).
  4235         16  CO-ZIP-PLUS4                      PIC X(4).
  4236     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4237         16  CO-CAN-POSTAL-1                   PIC XXX.
  4238         16  CO-CAN-POSTAL-2                   PIC XXX.
  4239         16  FILLER                            PIC XXX.
  4240     12  CO-SOC-SEC                            PIC X(13).
  4241     12  CO-TELEPHONE.
  4242         16  CO-AREA-CODE                      PIC XXX.
  4243         16  CO-PREFIX                         PIC XXX.
  4244         16  CO-PHONE                          PIC X(4).
  4245
  4246     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4247
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  75
* EL677.cbl
  4248     12  CO-AR-BAL-LEVEL                       PIC X.
  4249         88  CO-AR-REF-LVL                        VALUE '1'.
  4250         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4251         88  CO-AR-BILL-LVL                       VALUE '2'.
  4252         88  CO-AR-AGT-LVL                        VALUE '3'.
  4253         88  CO-AR-FR-LVL                         VALUE '4'.
  4254
  4255     12  CO-AR-NORMAL-PRINT                    PIC X.
  4256         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4257         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4258
  4259     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4260
  4261     12  CO-AR-REPORTING                       PIC X.
  4262         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4263         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4264
  4265     12  CO-AR-PULL-CHECK                      PIC X.
  4266         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4267         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4268
  4269     12  CO-AR-BALANCE-PRINT                   PIC X.
  4270         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4271
  4272     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4273         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4274         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4275         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4276
  4277     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4278
  4279     12  CO-USER-CODE                          PIC X.
  4280     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4281
  4282******************************************************************
  4283*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4284*    THE LAST MONTH END RUN.
  4285******************************************************************
  4286
  4287     12  CO-LAST-ACTIVITY-DATE.
  4288         16  CO-ACT-YEAR                       PIC 99.
  4289         16  CO-ACT-MONTH                      PIC 99.
  4290         16  CO-ACT-DAY                        PIC 99.
  4291
  4292     12  CO-LAST-STMT-DT.
  4293         16  CO-LAST-STMT-YEAR                 PIC 99.
  4294         16  CO-LAST-STMT-MONTH                PIC 99.
  4295         16  CO-LAST-STMT-DAY                  PIC 99.
  4296
  4297     12  CO-MO-END-TOTALS.
  4298         16  CO-MONTHLY-TOTALS.
  4299             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4300             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4301             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4302             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4303             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4304
  4305         16  CO-AGING-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  76
* EL677.cbl
  4306             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4307             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4308             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4309             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4310
  4311         16  CO-YTD-TOTALS.
  4312             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4313             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4314
  4315         16  CO-OVER-UNDER-TOTALS.
  4316             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4317             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4318
  4319     12  CO-MISCELLANEOUS-TOTALS.
  4320         16  CO-FICA-TOTALS.
  4321             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4322             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4323
  4324         16  CO-CLAIM-TOTALS.
  4325             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4326             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4327
  4328******************************************************************
  4329*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4330*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4331******************************************************************
  4332
  4333     12  CO-CURRENT-TOTALS.
  4334         16  CO-CURRENT-LAST-STMT-DT.
  4335             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4336             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4337             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4338
  4339         16  CO-CURRENT-MONTHLY-TOTALS.
  4340             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4341             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4342             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4343             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4344             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4345
  4346         16  CO-CURRENT-AGING-TOTALS.
  4347             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4348             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4349             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4350             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4351
  4352         16  CO-CURRENT-YTD-TOTALS.
  4353             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4354             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4355
  4356     12  CO-PAID-COMM-TOTALS.
  4357         16  CO-YTD-PAID-COMMS.
  4358             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4359             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4360
  4361     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4362         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4363         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  77
* EL677.cbl
  4364
  4365     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4366         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4367         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4368         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4369         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4370         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4371         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4372         88  CO-FINAL-LETTER                  VALUE 'F'.
  4373         88  CO-RECONCILING                   VALUE 'R'.
  4374         88  CO-PHONE-CALL                    VALUE 'P'.
  4375         88  CO-LEGAL                         VALUE 'L'.
  4376         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4377         88  CO-WRITE-OFF                     VALUE 'W'.
  4378         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4379
  4380     12  CO-CSR-CODE                       PIC X(4).
  4381
  4382     12  CO-GA-STATUS-INFO.
  4383         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4384         16  CO-GA-TERMINATION-DT          PIC XX.
  4385         16  CO-GA-STATUS-CODE             PIC X.
  4386             88  CO-GA-ACTIVE                 VALUE 'A'.
  4387             88  CO-GA-INACTIVE               VALUE 'I'.
  4388             88  CO-GA-PENDING                VALUE 'P'.
  4389         16  CO-GA-COMMENTS.
  4390             20  CO-GA-COMMENT-1           PIC X(40).
  4391             20  CO-GA-COMMENT-2           PIC X(40).
  4392             20  CO-GA-COMMENT-3           PIC X(40).
  4393             20  CO-GA-COMMENT-4           PIC X(40).
  4394
  4395     12  CO-RPTCD2                         PIC X(10).
  4396     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4397         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4398         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4399
  4400     12  CO-TYPE-AGENT                     PIC X(01).
  4401         88  CO-CORPORATION                   VALUE 'C'.
  4402         88  CO-PARTNERSHIP                   VALUE 'P'.
  4403         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4404         88  CO-TRUST                         VALUE 'T'.
  4405         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4406
  4407     12  CO-FAXNO.
  4408         16  CO-FAX-AREA-CODE                  PIC XXX.
  4409         16  CO-FAX-PREFIX                     PIC XXX.
  4410         16  CO-FAX-PHONE                      PIC X(4).
  4411
  4412     12  CO-BANK-INFORMATION.
  4413         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4414         16  CO-BANK-TRANSIT-NON REDEFINES
  4415             CO-BANK-TRANSIT-NO                PIC 9(8).
  4416
  4417         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4418     12  CO-MISC-DEDUCT-INFO REDEFINES
  4419                  CO-BANK-INFORMATION.
  4420         16  CO-MD-GL-ACCT                     PIC X(10).
  4421         16  CO-MD-DIV                         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  78
* EL677.cbl
  4422         16  CO-MD-CENTER                      PIC X(4).
  4423         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4424         16  CO-CREATE-AP-CHECK                PIC X.
  4425         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4426         16  FILLER                            PIC XXX.
  4427     12  CO-ACH-STATUS                         PIC X.
  4428         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4429         88  CO-ACH-PENDING                        VALUE 'P'.
  4430
  4431     12  CO-BILL-SW                            PIC X.
  4432     12  CO-CONTROL-NAME                       PIC X(30).
  4433     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4434     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4435     12  CO-CLP-STATE                          PIC XX.
  4436     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4437     12  CO-SPP-REFUND-EDIT                    PIC X.
  4438
  4439******************************************************************
  4440*                                COPY ELCCERT.
  4441******************************************************************
  4442*                                                                *
  4443*                            ELCCERT.                            *
  4444*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4445*                            VMOD=2.013                          *
  4446*                                                                *
  4447*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4448*                                                                *
  4449*   FILE TYPE = VSAM,KSDS                                        *
  4450*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4451*                                                                *
  4452*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4453*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4454*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4455*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4456*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4457*                                                                *
  4458*   LOG = YES                                                    *
  4459*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4460******************************************************************
  4461*                   C H A N G E   L O G
  4462*
  4463* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4464*-----------------------------------------------------------------
  4465*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4466* EFFECTIVE    NUMBER
  4467*-----------------------------------------------------------------
  4468* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4469* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4470* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4471* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4472* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4473* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4474* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4475* 032612  CR2011110200001  PEMA  AHL CHANGES
  4476* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4477* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4478* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4479******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  79
* EL677.cbl
  4480
  4481 01  CERTIFICATE-MASTER.
  4482     12  CM-RECORD-ID                      PIC XX.
  4483         88  VALID-CM-ID                      VALUE 'CM'.
  4484
  4485     12  CM-CONTROL-PRIMARY.
  4486         16  CM-COMPANY-CD                 PIC X.
  4487         16  CM-CARRIER                    PIC X.
  4488         16  CM-GROUPING.
  4489             20  CM-GROUPING-PREFIX        PIC X(3).
  4490             20  CM-GROUPING-PRIME         PIC X(3).
  4491         16  CM-STATE                      PIC XX.
  4492         16  CM-ACCOUNT.
  4493             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4494             20  CM-ACCOUNT-PRIME          PIC X(6).
  4495         16  CM-CERT-EFF-DT                PIC XX.
  4496         16  CM-CERT-NO.
  4497             20  CM-CERT-PRIME             PIC X(10).
  4498             20  CM-CERT-SFX               PIC X.
  4499
  4500     12  CM-CONTROL-BY-NAME.
  4501         16  CM-COMPANY-CD-A1              PIC X.
  4502         16  CM-INSURED-LAST-NAME          PIC X(15).
  4503         16  CM-INSURED-INITIALS.
  4504             20  CM-INSURED-INITIAL1       PIC X.
  4505             20  CM-INSURED-INITIAL2       PIC X.
  4506
  4507     12  CM-CONTROL-BY-SSN.
  4508         16  CM-COMPANY-CD-A2              PIC X.
  4509         16  CM-SOC-SEC-NO.
  4510             20  CM-SSN-STATE              PIC XX.
  4511             20  CM-SSN-ACCOUNT            PIC X(6).
  4512             20  CM-SSN-LN3.
  4513                 25  CM-INSURED-INITIALS-A2.
  4514                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4515                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4516                 25 CM-PART-LAST-NAME-A2         PIC X.
  4517
  4518     12  CM-CONTROL-BY-CERT-NO.
  4519         16  CM-COMPANY-CD-A4              PIC X.
  4520         16  CM-CERT-NO-A4                 PIC X(11).
  4521
  4522     12  CM-CONTROL-BY-MEMB.
  4523         16  CM-COMPANY-CD-A5              PIC X.
  4524         16  CM-MEMBER-NO.
  4525             20  CM-MEMB-STATE             PIC XX.
  4526             20  CM-MEMB-ACCOUNT           PIC X(6).
  4527             20  CM-MEMB-LN4.
  4528                 25  CM-INSURED-INITIALS-A5.
  4529                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4530                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4531                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4532
  4533     12  CM-INSURED-PROFILE-DATA.
  4534         16  CM-INSURED-FIRST-NAME.
  4535             20  CM-INSURED-1ST-INIT       PIC X.
  4536             20  FILLER                    PIC X(9).
  4537         16  CM-INSURED-ISSUE-AGE          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  80
* EL677.cbl
  4538         16  CM-INSURED-SEX                PIC X.
  4539             88  CM-SEX-MALE                  VALUE 'M'.
  4540             88  CM-SEX-FEMAL                 VALUE 'F'.
  4541         16  CM-INSURED-JOINT-AGE          PIC 99.
  4542         16  CM-JOINT-INSURED-NAME.
  4543             20  CM-JT-LAST-NAME           PIC X(15).
  4544             20  CM-JT-FIRST-NAME.
  4545                 24  CM-JT-1ST-INIT        PIC X.
  4546                 24  FILLER                PIC X(9).
  4547             20  CM-JT-INITIAL             PIC X.
  4548
  4549     12  CM-LIFE-DATA.
  4550         16  CM-LF-BENEFIT-CD              PIC XX.
  4551         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4552         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4553         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4554         16  CM-LF-DEV-CODE                PIC XXX.
  4555         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4556         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4557         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4558         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4559         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4560         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4561         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4562         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4563         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4564         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4565         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4566         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4567         16  cm-temp-epiq                  pic xx.
  4568             88  EPIQ-CLASS                  value 'EQ'.
  4569*        16  FILLER                        PIC XX.
  4570
  4571     12  CM-AH-DATA.
  4572         16  CM-AH-BENEFIT-CD              PIC XX.
  4573         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4574         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4575         16  CM-AH-DEV-CODE                PIC XXX.
  4576         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4577         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4578         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4579         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4580         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4581         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4582         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4583         16  CM-AH-PAID-THRU-DT            PIC XX.
  4584             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4585         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4586         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4587         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4588         16  FILLER                        PIC X.
  4589
  4590     12  CM-LOAN-INFORMATION.
  4591         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4592         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4593                                           PIC S9(5)V99  COMP-3.
  4594         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4595         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  81
* EL677.cbl
  4596         16  CM-PAY-FREQUENCY              PIC S99.
  4597         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4598         16  CM-RATE-CLASS                 PIC XX.
  4599         16  CM-BENEFICIARY                PIC X(25).
  4600         16  CM-POLICY-FORM-NO             PIC X(12).
  4601         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4602         16  CM-LAST-ADD-ON-DT             PIC XX.
  4603         16  CM-DEDUCTIBLE-AMOUNTS.
  4604             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4605             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4606         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4607             20  CM-RESIDENT-STATE         PIC XX.
  4608             20  CM-RATE-CODE              PIC X(4).
  4609             20  FILLER                    PIC XX.
  4610         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4611             20  CM-LOAN-OFFICER           PIC X(5).
  4612             20  FILLER                    PIC XXX.
  4613         16  CM-CSR-CODE                   PIC XXX.
  4614         16  CM-UNDERWRITING-CODE          PIC X.
  4615             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4616         16  CM-POST-CARD-IND              PIC X.
  4617         16  CM-REF-INTERFACE-SW           PIC X.
  4618         16  CM-PREMIUM-TYPE               PIC X.
  4619             88  CM-SING-PRM                  VALUE '1'.
  4620             88  CM-O-B-COVERAGE              VALUE '2'.
  4621             88  CM-OPEN-END                  VALUE '3'.
  4622         16  CM-IND-GRP-TYPE               PIC X.
  4623             88  CM-INDIVIDUAL                VALUE 'I'.
  4624             88  CM-GROUP                     VALUE 'G'.
  4625         16  CM-SKIP-CODE                  PIC X.
  4626             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4627             88  SKIP-JULY                    VALUE '1'.
  4628             88  SKIP-AUGUST                  VALUE '2'.
  4629             88  SKIP-SEPTEMBER               VALUE '3'.
  4630             88  SKIP-JULY-AUG                VALUE '4'.
  4631             88  SKIP-AUG-SEPT                VALUE '5'.
  4632             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4633             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4634             88  SKIP-JUNE                    VALUE '8'.
  4635             88  SKIP-JUNE-JULY               VALUE '9'.
  4636             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4637             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4638         16  CM-PAYMENT-MODE               PIC X.
  4639             88  PAY-MONTHLY                  VALUE SPACE.
  4640             88  PAY-WEEKLY                   VALUE '1'.
  4641             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4642             88  PAY-BI-WEEKLY                VALUE '3'.
  4643             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4644         16  CM-LOAN-NUMBER                PIC X(8).
  4645         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4646         16  CM-OLD-LOF                    PIC XXX.
  4647*        16  CM-LOAN-OFFICER               PIC XXX.
  4648         16  CM-REIN-TABLE                 PIC XXX.
  4649         16  CM-SPECIAL-REIN-CODE          PIC X.
  4650         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4651         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4652         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4653
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  82
* EL677.cbl
  4654     12  CM-STATUS-DATA.
  4655         16  CM-ENTRY-STATUS               PIC X.
  4656         16  CM-ENTRY-DT                   PIC XX.
  4657
  4658         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4659         16  CM-LF-CANCEL-DT               PIC XX.
  4660         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4661
  4662         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4663         16  CM-LF-DEATH-DT                PIC XX.
  4664         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4665
  4666         16  CM-LF-CURRENT-STATUS          PIC X.
  4667             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4668                                                'M' '4' '5' '9'.
  4669             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4670             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4671             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4672             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4673             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4674             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4675             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4676             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4677             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4678             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4679             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4680             88  CM-LF-DECLINED               VALUE 'D'.
  4681             88  CM-LF-VOIDED                 VALUE 'V'.
  4682
  4683         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4684         16  CM-AH-CANCEL-DT               PIC XX.
  4685         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4686
  4687         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4688         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4689         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4690
  4691         16  CM-AH-CURRENT-STATUS          PIC X.
  4692             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4693                                                'M' '4' '5' '9'.
  4694             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4695             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4696             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4697             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4698             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4699             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4700             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4701             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4702             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4703             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4704             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4705             88  CM-AH-DECLINED               VALUE 'D'.
  4706             88  CM-AH-VOIDED                 VALUE 'V'.
  4707
  4708         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4709             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4710             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4711             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  83
* EL677.cbl
  4712         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4713
  4714         16  CM-ENTRY-BATCH                PIC X(6).
  4715         16  CM-LF-EXIT-BATCH              PIC X(6).
  4716         16  CM-AH-EXIT-BATCH              PIC X(6).
  4717         16  CM-LAST-MONTH-END             PIC XX.
  4718
  4719     12  CM-NOTE-SW                        PIC X.
  4720         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4721         88  CERT-NOTES-PRESENT               VALUE '1'.
  4722         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4723         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4724         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4725         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4726         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4727         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4728     12  CM-COMP-EXCP-SW                   PIC X.
  4729         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4730         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4731     12  CM-INSURED-ADDRESS-SW             PIC X.
  4732         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4733         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4734
  4735*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4736     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4737     12  FILLER                            PIC X.
  4738
  4739*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4740     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4741     12  FILLER                            PIC X.
  4742*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4743     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  4744
  4745     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4746         88  CERT-ADDED-BATCH                 VALUE ' '.
  4747         88  CERT-ADDED-ONLINE                VALUE '1'.
  4748         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4749         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4750         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4751     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4752         88  CERT-AS-LOADED                   VALUE ' '.
  4753         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4754         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4755         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4756         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4757         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4758         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4759         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4760
  4761     12  CM-ACCOUNT-COMM-PCTS.
  4762         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4763         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4764
  4765     12  CM-USER-FIELD                     PIC X.
  4766     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4767     12  CM-CLP-STATE                      PIC XX.
  4768     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4769     12  CM-USER-RESERVED                  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  84
* EL677.cbl
  4770     12  FILLER REDEFINES CM-USER-RESERVED.
  4771         16  CM-AH-CLASS-CD                PIC XX.
  4772         16  F                             PIC X.
  4773******************************************************************
  4774*                                COPY ERCPNDB.
  4775******************************************************************
  4776*                                                                *
  4777*                                                                *
  4778*                            ERCPNDB.                            *
  4779*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4780*                            VMOD=2.025                          *
  4781*                                                                *
  4782*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4783*                                                                *
  4784******************************************************************
  4785*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4786*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4787******************************************************************
  4788*                                                                *
  4789*                                                                *
  4790*   FILE TYPE = VSAM,KSDS                                        *
  4791*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4792*                                                                *
  4793*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4794*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4795*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4796*                                                 RKP=13,LEN=36  *
  4797*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4798*                                      AND CHG-SEQ.)             *
  4799*                                                RKP=49,LEN=11   *
  4800*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4801*                                      AND CHG-SEQ.)             *
  4802*                                                RKP=60,LEN=15   *
  4803*                                                                *
  4804*   LOG = NO                                                     *
  4805*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4806******************************************************************
  4807******************************************************************
  4808*                   C H A N G E   L O G
  4809*
  4810* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4811*-----------------------------------------------------------------
  4812*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4813* EFFECTIVE    NUMBER
  4814*-----------------------------------------------------------------
  4815* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4816* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4817* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4818* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4819* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4820* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4821* 032306                   PEMA  ADD BOW LOAN NUMBER
  4822* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4823* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4824* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4825* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4826* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4827* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  85
* EL677.cbl
  4828* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4829* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4830* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4831* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4832* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4833* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4834******************************************************************
  4835
  4836 01  PENDING-BUSINESS.
  4837     12  PB-RECORD-ID                     PIC XX.
  4838         88  VALID-PB-ID                        VALUE 'PB'.
  4839
  4840     12  PB-CONTROL-PRIMARY.
  4841         16  PB-COMPANY-CD                PIC X.
  4842         16  PB-ENTRY-BATCH               PIC X(6).
  4843         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4844         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4845
  4846     12  PB-CONTROL-BY-ACCOUNT.
  4847         16  PB-COMPANY-CD-A1             PIC X.
  4848         16  PB-CARRIER                   PIC X.
  4849         16  PB-GROUPING.
  4850             20  PB-GROUPING-PREFIX       PIC XXX.
  4851             20  PB-GROUPING-PRIME        PIC XXX.
  4852         16  PB-STATE                     PIC XX.
  4853         16  PB-ACCOUNT.
  4854             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4855             20  PB-ACCOUNT-PRIME         PIC X(6).
  4856         16  PB-CERT-EFF-DT               PIC XX.
  4857         16  PB-CERT-NO.
  4858             20  PB-CERT-PRIME            PIC X(10).
  4859             20  PB-CERT-SFX              PIC X.
  4860         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4861
  4862         16  PB-RECORD-TYPE               PIC X.
  4863             88  PB-MAILING-DATA                VALUE '0'.
  4864             88  PB-ISSUE                       VALUE '1'.
  4865             88  PB-CANCELLATION                VALUE '2'.
  4866             88  PB-BATCH-TRAILER               VALUE '9'.
  4867
  4868     12  PB-CONTROL-BY-ORIG-BATCH.
  4869         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4870         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4871         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4872         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4873
  4874     12  PB-CONTROL-BY-CSR.
  4875         16  PB-CSR-COMPANY-CD            PIC X.
  4876         16  PB-CSR-ID                    PIC X(4).
  4877         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4878         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4879         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4880******************************************************************
  4881*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4882******************************************************************
  4883
  4884     12  PB-LAST-MAINT-DT                 PIC XX.
  4885     12  PB-LAST-MAINT-BY                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  86
* EL677.cbl
  4886     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4887
  4888     12  PB-RECORD-BODY                   PIC X(375).
  4889
  4890     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4891         16  PB-CERT-ORIGIN               PIC X.
  4892             88  CLASIC-CREATED-CERT         VALUE '1'.
  4893         16  PB-I-NAME.
  4894             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4895             20  PB-I-INSURED-FIRST-NAME.
  4896                 24  PB-I-INSURED-1ST-INIT PIC X.
  4897                 24  FILLER                PIC X(9).
  4898             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4899         16  PB-I-AGE                     PIC S99   COMP-3.
  4900         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4901         16  PB-I-BIRTHDAY                PIC XX.
  4902         16  PB-I-INSURED-SEX             PIC X.
  4903             88  PB-SEX-MALE     VALUE 'M'.
  4904             88  PB-SEX-FEMALE   VALUE 'F'.
  4905
  4906         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4907         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4908         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4909         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4910         16  PB-I-SKIP-CODE               PIC X.
  4911             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4912             88  PB-SKIP-JULY              VALUE '1'.
  4913             88  PB-SKIP-AUGUST            VALUE '2'.
  4914             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4915             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4916             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4917             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4918             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4919             88  PB-SKIP-JUNE              VALUE '8'.
  4920             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4921             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4922             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4923         16  PB-I-TERM-TYPE               PIC X.
  4924             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4925             88  PB-PAID-WEEKLY            VALUE 'W'.
  4926             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4927             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4928             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4929         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4930         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4931         16  PB-I-DATA-ENTRY-SW           PIC X.
  4932             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4933             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4934             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4935             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4936         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4937         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4938*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4939         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4940         16  FILLER                       PIC X.
  4941
  4942         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4943             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  87
* EL677.cbl
  4944             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4945                                                   '90' THRU '99'.
  4946         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4947                                          PIC XX.
  4948         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4949         16  PB-I-AMOUNT-FINANCED REDEFINES
  4950                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4951         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4952         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4953                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4954         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4955         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4956         16  PB-I-CLP-AMOUNT REDEFINES
  4957                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4958         16  PB-I-LF-CALC-FLAG            PIC X.
  4959             88 PB-COMP-LF-PREM               VALUE '?'.
  4960         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4961         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4962         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4963         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4964         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4965         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4966         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4967         16  PB-I-LF-ABBR                 PIC XXX.
  4968         16  PB-I-LF-INPUT-CD             PIC XX.
  4969
  4970         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4971             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4972             88  PB-INVALID-AH               VALUE '  ' '00'
  4973                                                   '90' THRU '99'.
  4974         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4975         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4976         16  PB-I-AH-CALC-FLAG            PIC X.
  4977             88 PB-COMP-AH-PREM                  VALUE '?'.
  4978         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4979         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4980         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4981         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4982         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4983         16  PB-I-AH-ABBR                 PIC XXX.
  4984         16  PB-I-AH-INPUT-CD             PIC XXX.
  4985
  4986         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4987         16  PB-I-REIN-TABLE              PIC XXX.
  4988         16  PB-I-BUSINESS-TYPE           PIC 99.
  4989         16  PB-I-INDV-GRP-CD             PIC X.
  4990         16  PB-I-MORT-CODE.
  4991             20  PB-I-TABLE               PIC X.
  4992             20  PB-I-INTEREST            PIC XX.
  4993             20  PB-I-MORT-TYP            PIC X.
  4994         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4995         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4996         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4997         16  PB-I-INDV-GRP-OVRD           PIC X.
  4998         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4999         16  PB-I-SIG-SW                  PIC X.
  5000             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5001         16  PB-I-RATE-CLASS              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  88
* EL677.cbl
  5002         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5003         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5004         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5005         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5006         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5007         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5008         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5009         16  PB-I-BENEFIT-TYPE            PIC XXX.
  5010         16  PB-I-OB-FLAG                 PIC X.
  5011             88  PB-I-OB                      VALUE 'B'.
  5012             88  PB-I-SUMMARY                 VALUE 'Z'.
  5013         16  PB-I-ENTRY-STATUS            PIC X.
  5014             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5015                                              'M' '5' '9' '2'.
  5016             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5017             88  PB-I-POLICY-PENDING          VALUE '2'.
  5018             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5019             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5020             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  5021             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5022             88  PB-I-REIN-ONLY               VALUE '9'.
  5023             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5024             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5025             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5026             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5027         16  PB-I-INT-CODE                PIC X.
  5028             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5029             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5030         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5031         16  PB-I-SOC-SEC-NO              PIC X(11).
  5032         16  PB-I-MEMBER-NO               PIC X(12).
  5033         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5034*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5035         16  PB-I-OLD-LOF                 PIC XXX.
  5036         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5037         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5038         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5039         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5040         16  PB-I-LIFE-INDICATOR          PIC X.
  5041             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5042         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5043         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5044                                          PIC S9(5)V99    COMP-3.
  5045         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5046             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5047             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5048         16  PB-I-1ST-PMT-DT              PIC XX.
  5049         16  PB-I-JOINT-INSURED.
  5050             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5051             20 PB-I-JOINT-FIRST-NAME.
  5052                24  PB-I-JOINT-FIRST-INIT PIC X.
  5053                24  FILLER                PIC X(9).
  5054             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5055*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5056         16  PB-I-BENEFICIARY-NAME.
  5057             20  PB-I-BANK-NUMBER         PIC X(10).
  5058             20  FILLER                   PIC X(15).
  5059         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  89
* EL677.cbl
  5060         16  PB-I-REFERENCE               PIC X(12).
  5061         16  FILLER REDEFINES PB-I-REFERENCE.
  5062             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5063             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5064             20  PB-I-CLP-STATE           PIC XX.
  5065         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5066             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  5067             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5068             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  5069         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5070         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5071         16  PB-I-RESIDENT-STATE          PIC XX.
  5072         16  PB-I-RATE-CODE               PIC X(4).
  5073         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  5074         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5075         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5076         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5077         16  PB-I-BANK-NOCHRGB            PIC 99.
  5078         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5079         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5080
  5081     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5082         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5083             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5084         16  PB-C-CANCEL-ORIGIN           PIC X.
  5085             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5086         16  PB-C-LF-CANCEL-DT            PIC XX.
  5087         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5088         16  PB-C-LF-CALC-REQ             PIC X.
  5089             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5090         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5091         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5092         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5093             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5094         16  PB-C-AH-CANCEL-DT            PIC XX.
  5095         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5096         16  PB-C-AH-CALC-REQ             PIC X.
  5097             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5098         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5099         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5100         16  PB-C-LAST-NAME               PIC X(15).
  5101         16  PB-C-REFUND-SW               PIC X.
  5102             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5103             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5104         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5105         16  PB-C-PAYEE-CODE              PIC X(6).
  5106         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5107         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5108         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5109         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  5110         16  PB-C-REFERENCE               PIC X(12).
  5111         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5112         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5113         16  PB-C-POST-CARD-IND           PIC X.
  5114         16  PB-C-CANCEL-REASON           PIC X.
  5115         16  PB-C-REF-INTERFACE-SW        PIC X.
  5116         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  5117         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  90
* EL677.cbl
  5118         16  FILLER                       PIC X(01).
  5119*        16  FILLER                       PIC X(18).
  5120         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5121*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  5122         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  5123         16  PB-CANCELED-CERT-DATA.
  5124             20  PB-CI-INSURED-NAME.
  5125                 24  PB-CI-LAST-NAME      PIC X(15).
  5126                 24  PB-CI-INITIALS       PIC XX.
  5127             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5128             20  PB-CI-INSURED-SEX        PIC X.
  5129             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5130             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  5131             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  5132             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5133             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5134             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5135             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5136             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5137             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5138             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5139             20  PB-CI-RATE-CLASS         PIC XX.
  5140             20  PB-CI-RATE-DEV-LF        PIC XXX.
  5141             20  PB-CI-RATE-DEV-AH        PIC XXX.
  5142             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5143             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5144             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  5145             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5146             20  PB-CI-LF-ABBR            PIC X(3).
  5147             20  PB-CI-AH-ABBR            PIC X(3).
  5148             20  PB-CI-OB-FLAG            PIC X.
  5149                 88  PB-CI-OB                VALUE 'B'.
  5150             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5151                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5152                                           'M' '4' '5' '9' '2'.
  5153                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  5154                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5155                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5156                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5157                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5158                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  5159                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5160                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5161                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5162                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5163                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5164                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5165                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5166             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5167                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5168                                           'M' '4' '5' '9' '2'.
  5169                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5170                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5171                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5172                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5173                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5174                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  5175                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  91
* EL677.cbl
  5176                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5177                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5178                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5179                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5180                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5181                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5182             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5183             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5184             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5185             20  PB-CI-MEMBER-NO          PIC X(12).
  5186             20  PB-CI-INT-CODE           PIC X.
  5187                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5188                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5189             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5190             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5191             20  PB-CI-COMP-EXCP-SW       PIC X.
  5192                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5193                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5194             20  PB-CI-ENTRY-STATUS       PIC X.
  5195             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5196             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5197             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5198             20  PB-CI-DEATH-DT           PIC XX.
  5199             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5200             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5201             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5202             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5203             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5204             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5205             20  PB-CI-ENTRY-DT              PIC XX.
  5206             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5207             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5208             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5209             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5210             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5211             20  PB-CI-OLD-LOF               PIC XXX.
  5212*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5213             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5214             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5215             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5216             20  PB-CI-INDV-GRP-CD           PIC X.
  5217             20  PB-CI-BENEFICIARY-NAME.
  5218                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5219                 24  FILLER                  PIC X(15).
  5220             20  PB-CI-NOTE-SW               PIC X.
  5221             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5222             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5223             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5224             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5225             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5226             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5227             20  PB-CI-FIRST-NAME            PIC X(10).
  5228             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5229
  5230         16  FILLER                       PIC X(13).
  5231*032306  16  FILLER                       PIC X(27).
  5232*        16  FILLER                       PIC X(46).
  5233
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  92
* EL677.cbl
  5234     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5235         16  FILLER                       PIC X(10).
  5236         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5237         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5238         16  PB-M-INSURED-MID-INIT        PIC X.
  5239         16  PB-M-INSURED-AGE             PIC 99.
  5240         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5241         16  PB-M-INSURED-SEX             PIC X.
  5242         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5243         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5244         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5245         16  PB-M-INSURED-CITY-STATE.
  5246             20  PB-M-INSURED-CITY        PIC X(28).
  5247             20  PB-M-INSURED-STATE       PIC XX.
  5248         16  PB-M-INSURED-ZIP-CODE.
  5249             20  PB-M-INSURED-ZIP-PRIME.
  5250                 24  PB-M-INSURED-ZIP-1   PIC X.
  5251                     88  PB-M-CANADIAN-POST-CODE
  5252                                             VALUE 'A' THRU 'Z'.
  5253                 24  FILLER               PIC X(4).
  5254             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5255         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5256                                        PB-M-INSURED-ZIP-CODE.
  5257             20  PM-M-INS-CAN-POST1       PIC XXX.
  5258             20  PM-M-INS-CAN-POST2       PIC XXX.
  5259             20  FILLER                   PIC XXX.
  5260         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5261         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5262         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5263         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5264         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5265         16  PB-M-CRED-BENE-CITYST.
  5266             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5267             20  PB-M-CRED-BENE-STATE     PIC XX.
  5268         16  FILLER                       PIC X(92).
  5269
  5270     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5271         16  FILLER                       PIC X(10).
  5272         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5273         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5274         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5275         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5276         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5277         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5278         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5279         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5280         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5281         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5282         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5283         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5284         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5285         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5286         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5287         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5288         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5289         16  PB-ACCOUNT-NAME              PIC X(30).
  5290         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5291         16  PB-REFERENCE                 PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  93
* EL677.cbl
  5292         16  PB-B-RECEIVED-DT             PIC XX.
  5293         16  FILLER                       PIC X(234).
  5294
  5295     12  PB-RECORD-STATUS.
  5296         16  PB-CREDIT-SELECT-DT          PIC XX.
  5297         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5298         16  PB-BILLED-DT                 PIC XX.
  5299         16  PB-BILLING-STATUS            PIC X.
  5300             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5301             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5302             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5303         16  PB-RECORD-BILL               PIC X.
  5304             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5305             88  PB-RECORD-RETURNED           VALUE 'R'.
  5306             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5307             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5308             88  PB-OVERRIDE-AH               VALUE 'A'.
  5309             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5310         16  PB-BATCH-ENTRY               PIC X.
  5311             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5312             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5313             88  PB-REISSUED-CERT             VALUE 'E'.
  5314             88  PB-CASH-CERT                 VALUE 'C'.
  5315             88  PB-MONTHLY-CERT              VALUE 'M'.
  5316             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5317             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5318             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5319         16  PB-FORCE-CODE                PIC X.
  5320             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5321             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5322             88  PB-CANCEL-FORCE              VALUE '8'.
  5323             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5324             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5325             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5326             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5327             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5328             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5329             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  5330             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5331         16  PB-FATAL-FLAG                PIC X.
  5332             88  PB-FATAL-ERRORS              VALUE 'X'.
  5333         16  PB-FORCE-ER-CD               PIC X.
  5334             88  PB-FORCE-ERRORS              VALUE 'F'.
  5335             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5336         16  PB-WARN-ER-CD                PIC X.
  5337             88  PB-WARNING-ERRORS            VALUE 'W'.
  5338         16  FILLER                       PIC X.
  5339         16  PB-OUT-BAL-CD                PIC X.
  5340             88  PB-OUT-OF-BAL                VALUE 'O'.
  5341         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5342         16  PB-AH-OVERRIDE-L1            PIC X.
  5343         16  PB-INPUT-DT                  PIC XX.
  5344         16  PB-INPUT-BY                  PIC X(4).
  5345         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5346         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5347         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5348         16  PB-LF-EARNING-METHOD         PIC X.
  5349         16  PB-AH-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  94
* EL677.cbl
  5350         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5351         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5352         16  PB-REIN-CD                   PIC XXX.
  5353         16  PB-LF-REFUND-TYPE            PIC X.
  5354         16  PB-AH-REFUND-TYPE            PIC X.
  5355         16  PB-ACCT-EFF-DT               PIC XX.
  5356         16  PB-ACCT-EXP-DT               PIC XX.
  5357         16  PB-COMPANY-ID                PIC X(3).
  5358         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5359         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5360         16  PB-SV-CARRIER                PIC X.
  5361         16  PB-SV-GROUPING               PIC X(6).
  5362         16  PB-SV-STATE                  PIC XX.
  5363         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5364         16  PB-GA-BILLING-INFO.
  5365             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5366                                          PIC XX.
  5367         16  PB-SV-REMIT-TO  REDEFINES
  5368             PB-GA-BILLING-INFO           PIC X(10).
  5369         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5370         16  PB-I-LOAN-OFFICER            PIC X(5).
  5371         16  PB-I-VIN                     PIC X(17).
  5372
  5373         16  FILLER                       PIC X(04).
  5374         16  IMNET-BYPASS-SW              PIC X.
  5375
  5376******************************************************************
  5377*                COMMON EDIT ERRORS                              *
  5378******************************************************************
  5379
  5380     12  PB-COMMON-ERRORS.
  5381         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5382                                           PIC S9(4)     COMP.
  5383
  5384******************************************************************
  5385*                                COPY ERCPNDM.
  5386******************************************************************
  5387*                                                                *
  5388*                                                                *
  5389*                            ERCPNDM                             *
  5390*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5391*                            VMOD=2.003                          *
  5392*                                                                *
  5393*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5394*                                                                *
  5395*   FILE TYPE = VSAM,KSDS                                        *
  5396*   RECORD SIZE = 374   RECFORM = FIX                            *
  5397*                                                                *
  5398*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5399*   ALTERNATE PATH    = NOT USED                                 *
  5400*                                                                *
  5401*   LOG = YES                                                    *
  5402*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5403******************************************************************
  5404*                   C H A N G E   L O G
  5405*
  5406* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5407*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  95
* EL677.cbl
  5408*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5409* EFFECTIVE    NUMBER
  5410*-----------------------------------------------------------------
  5411* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5412* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5413* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5414* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  5415******************************************************************
  5416
  5417 01  PENDING-MAILING-DATA.
  5418     12  PM-RECORD-ID                      PIC XX.
  5419         88  VALID-MA-ID                       VALUE 'PM'.
  5420
  5421     12  PM-CONTROL-PRIMARY.
  5422         16  PM-COMPANY-CD                 PIC X.
  5423         16  PM-ENTRY-BATCH                PIC X(6).
  5424         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5425         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5426
  5427     12  FILLER                            PIC X(14).
  5428
  5429     12  PM-ACCESS-CONTROL.
  5430         16  PM-SOURCE-SYSTEM              PIC XX.
  5431             88  PM-FROM-CREDIT                VALUE 'CR'.
  5432             88  PM-FROM-VSI                   VALUE 'VS'.
  5433             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5434             88  PM-FROM-OTHER                 VALUE 'OT'.
  5435         16  PM-RECORD-ADD-DT              PIC XX.
  5436         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5437         16  PM-LAST-MAINT-DT              PIC XX.
  5438         16  PM-LAST-MAINT-BY              PIC XXXX.
  5439         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5440
  5441     12  PM-PROFILE-INFO.
  5442         16  PM-QUALIFY-CODE-1             PIC XX.
  5443         16  PM-QUALIFY-CODE-2             PIC XX.
  5444         16  PM-QUALIFY-CODE-3             PIC XX.
  5445         16  PM-QUALIFY-CODE-4             PIC XX.
  5446         16  PM-QUALIFY-CODE-5             PIC XX.
  5447
  5448         16  PM-INSURED-LAST-NAME          PIC X(15).
  5449         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5450         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5451         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5452         16  PM-INSURED-BIRTH-DT           PIC XX.
  5453         16  PM-INSURED-SEX                PIC X.
  5454             88  PM-SEX-MALE                   VALUE 'M'.
  5455             88  PM-SEX-FEMALE                 VALUE 'F'.
  5456         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5457
  5458         16  PM-ADDRESS-CORRECTED          PIC X.
  5459         16  PM-JOINT-BIRTH-DT             PIC XX.
  5460*        16  FILLER                        PIC X(12).
  5461
  5462         16  PM-ADDRESS-LINE-1             PIC X(30).
  5463         16  PM-ADDRESS-LINE-2             PIC X(30).
  5464         16  PM-CITY-STATE.
  5465             20  PM-CITY                   PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  96
* EL677.cbl
  5466             20  PM-STATE                  PIC XX.
  5467         16  PM-ZIP.
  5468             20  PM-ZIP-CODE.
  5469                 24  PM-ZIP-1              PIC X.
  5470                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5471                 24  FILLER                PIC X(4).
  5472             20  PM-ZIP-PLUS4              PIC X(4).
  5473         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5474             20  PM-CAN-POST1              PIC XXX.
  5475             20  PM-CAN-POST2              PIC XXX.
  5476             20  FILLER                    PIC XXX.
  5477
  5478         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5479         16  pm-city-st-zip-verified       pic x.
  5480         16  FILLER                        PIC XX.
  5481
  5482     12  PM-CRED-BENE-INFO.
  5483         16  PM-CRED-BENE-NAME             PIC X(25).
  5484         16  PM-CRED-BENE-ADDR             PIC X(30).
  5485         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5486         16  PM-CRED-BENE-CTYST.
  5487             20  PM-CRED-BENE-CITY         PIC X(28).
  5488             20  PM-CRED-BENE-STATE        PIC XX.
  5489         16  PM-CRED-BENE-ZIP.
  5490             20  PM-CB-ZIP-CODE.
  5491                 24  PM-CB-ZIP-1           PIC X.
  5492                     88  PM-CB-CANADIAN-POST-CODE
  5493                                  VALUE 'A' THRU 'Z'.
  5494                 24  FILLER                PIC X(4).
  5495             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5496         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5497             20  PM-CB-CAN-POST1           PIC XXX.
  5498             20  PM-CB-CAN-POST2           PIC XXX.
  5499             20  FILLER                    PIC XXX.
  5500     12  PM-POST-CARD-MAIL-DATA.
  5501         16  PM-MAIL-DATA OCCURS 7.
  5502             20  PM-MAIL-TYPE              PIC X.
  5503                 88  PM-12MO-MAILING           VALUE '1'.
  5504                 88  PM-EXP-MAILING            VALUE '2'.
  5505             20  PM-MAIL-STATUS            PIC X.
  5506                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5507                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5508                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5509             20  PM-MAIL-DATE              PIC XX.
  5510     12  FILLER                            PIC XX.
  5511     12  FILLER                            PIC X(12).
  5512*    12  FILLER                            PIC X(30).
  5513
  5514******************************************************************
  5515*                                COPY ERCMAIL.
  5516******************************************************************
  5517*                                                                *
  5518*                                                                *
  5519*                            ERCMAIL                             *
  5520*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5521*                            VMOD=2.003                          *
  5522*                                                                *
  5523*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  97
* EL677.cbl
  5524*                                                                *
  5525*   FILE TYPE = VSAM,KSDS                                        *
  5526*   RECORD SIZE = 374   RECFORM = FIX                            *
  5527*                                                                *
  5528*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5529*   ALTERNATE PATH    = NOT USED                                 *
  5530*                                                                *
  5531*   LOG = YES                                                    *
  5532*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5533******************************************************************
  5534*                   C H A N G E   L O G
  5535*
  5536* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5537*-----------------------------------------------------------------
  5538*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5539* EFFECTIVE    NUMBER
  5540*-----------------------------------------------------------------
  5541* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5542* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5543* 111108                   PEMA  ADD CRED BENE ADDR2
  5544******************************************************************
  5545
  5546 01  MAILING-DATA.
  5547     12  MA-RECORD-ID                      PIC XX.
  5548         88  VALID-MA-ID                       VALUE 'MA'.
  5549
  5550     12  MA-CONTROL-PRIMARY.
  5551         16  MA-COMPANY-CD                 PIC X.
  5552         16  MA-CARRIER                    PIC X.
  5553         16  MA-GROUPING.
  5554             20  MA-GROUPING-PREFIX        PIC XXX.
  5555             20  MA-GROUPING-PRIME         PIC XXX.
  5556         16  MA-STATE                      PIC XX.
  5557         16  MA-ACCOUNT.
  5558             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5559             20  MA-ACCOUNT-PRIME          PIC X(6).
  5560         16  MA-CERT-EFF-DT                PIC XX.
  5561         16  MA-CERT-NO.
  5562             20  MA-CERT-PRIME             PIC X(10).
  5563             20  MA-CERT-SFX               PIC X.
  5564
  5565     12  FILLER                            PIC XX.
  5566
  5567     12  MA-ACCESS-CONTROL.
  5568         16  MA-SOURCE-SYSTEM              PIC XX.
  5569             88  MA-FROM-CREDIT                VALUE 'CR'.
  5570             88  MA-FROM-VSI                   VALUE 'VS'.
  5571             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5572             88  MA-FROM-OTHER                 VALUE 'OT'.
  5573         16  MA-RECORD-ADD-DT              PIC XX.
  5574         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5575         16  MA-LAST-MAINT-DT              PIC XX.
  5576         16  MA-LAST-MAINT-BY              PIC XXXX.
  5577         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5578
  5579     12  MA-PROFILE-INFO.
  5580         16  MA-QUALIFY-CODE-1             PIC XX.
  5581         16  MA-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  98
* EL677.cbl
  5582         16  MA-QUALIFY-CODE-3             PIC XX.
  5583         16  MA-QUALIFY-CODE-4             PIC XX.
  5584         16  MA-QUALIFY-CODE-5             PIC XX.
  5585
  5586         16  MA-INSURED-LAST-NAME          PIC X(15).
  5587         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5588         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5589         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5590         16  MA-INSURED-BIRTH-DT           PIC XX.
  5591         16  MA-INSURED-SEX                PIC X.
  5592             88  MA-SEX-MALE                   VALUE 'M'.
  5593             88  MA-SEX-FEMALE                 VALUE 'F'.
  5594         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5595
  5596         16  MA-ADDRESS-CORRECTED          PIC X.
  5597         16  MA-JOINT-BIRTH-DT             PIC XX.
  5598*        16  FILLER                        PIC X(12).
  5599
  5600         16  MA-ADDRESS-LINE-1             PIC X(30).
  5601         16  MA-ADDRESS-LINE-2             PIC X(30).
  5602         16  MA-CITY-STATE.
  5603             20  MA-CITY                   PIC X(28).
  5604             20  MA-ADDR-STATE             PIC XX.
  5605         16  MA-ZIP.
  5606             20  MA-ZIP-CODE.
  5607                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5608                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5609                 24  FILLER                PIC X(4).
  5610             20  MA-ZIP-PLUS4              PIC X(4).
  5611         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5612             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5613             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5614             20  FILLER                    PIC X(3).
  5615
  5616         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5617
  5618         16  FILLER                        PIC XXX.
  5619*        16  FILLER                        PIC X(10).
  5620
  5621     12  MA-CRED-BENE-INFO.
  5622         16  MA-CRED-BENE-NAME                 PIC X(25).
  5623         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5624         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5625         16  MA-CRED-BENE-CTYST.
  5626             20  MA-CRED-BENE-CITY             PIC X(28).
  5627             20  MA-CRED-BENE-STATE            PIC XX.
  5628         16  MA-CRED-BENE-ZIP.
  5629             20  MA-CB-ZIP-CODE.
  5630                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5631                     88  MA-CB-CANADIAN-POST-CODE
  5632                                           VALUE 'A' THRU 'Z'.
  5633                 24  FILLER                    PIC X(4).
  5634             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5635         16  MA-CB-CANADIAN-POSTAL-CODE
  5636                            REDEFINES MA-CRED-BENE-ZIP.
  5637             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5638             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5639             20  FILLER                        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page  99
* EL677.cbl
  5640     12  MA-POST-CARD-MAIL-DATA.
  5641         16  MA-MAIL-DATA OCCURS 7.
  5642             20  MA-MAIL-TYPE              PIC X.
  5643                 88  MA-12MO-MAILING           VALUE '1'.
  5644                 88  MA-EXP-MAILING            VALUE '2'.
  5645             20  MA-MAIL-STATUS            PIC X.
  5646                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5647                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5648                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5649             20  MA-MAIL-DATE              PIC XX.
  5650     12  FILLER                            PIC XX.
  5651     12  FILLER                            PIC XX.
  5652*    12  FILLER                            PIC X(30).
  5653******************************************************************
  5654*                                COPY ERCPYAJ.
  5655******************************************************************
  5656*                                                                *
  5657*                            ERCPYAJ                             *
  5658*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5659*                            VMOD=2.015                          *
  5660*                                                                *
  5661*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  5662*                                                                *
  5663*                                                                *
  5664*   FILE TYPE = VSAM,KSDS                                        *
  5665*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5666*                                                                *
  5667*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  5668*       ALTERNATE PATHS = NONE                                   *
  5669*                                                                *
  5670*   LOG = YES                                                    *
  5671*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5672******************************************************************
  5673******************************************************************
  5674*                   C H A N G E   L O G
  5675*
  5676* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5677*-----------------------------------------------------------------
  5678*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5679* EFFECTIVE    NUMBER
  5680*-----------------------------------------------------------------
  5681* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  5682* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  5683******************************************************************
  5684
  5685 01  PENDING-PAY-ADJ.
  5686     12  PY-RECORD-ID                     PIC XX.
  5687         88  VALID-PY-ID                        VALUE 'PY'.
  5688
  5689     12  PY-CONTROL-PRIMARY.
  5690         16  PY-COMPANY-CD                PIC X.
  5691         16  PY-CARRIER                   PIC X.
  5692         16  PY-GROUPING                  PIC X(6).
  5693         16  PY-FIN-RESP                  PIC X(10).
  5694         16  PY-ACCOUNT                   PIC X(10).
  5695         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  5696                                          PIC X(10).
  5697         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 100
* EL677.cbl
  5698         16  PY-RECORD-TYPE               PIC X.
  5699             88  PY-REMIT-RECEIVED            VALUE 'R'.
  5700             88  PY-DEPOSIT                   VALUE 'D'.
  5701             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  5702             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  5703             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  5704             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  5705             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  5706             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  5707             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  5708             88  PY-FICA-ENTRY                VALUE 'F'.
  5709             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  5710             88  PY-POLICY-FEE                VALUE 'W'.
  5711             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  5712
  5713     12  PY-PYMT-TYPE                     PIC X.
  5714             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  5715             88  PY-REINS-PYMT                VALUE 'R'.
  5716             88  PY-EXP-PYMT                  VALUE 'E'.
  5717
  5718     12  PY-BIL-INV                       PIC X(6).
  5719     12  PY-REF-NO                        PIC X(12).
  5720
  5721     12  PY-LAST-MAINT-DT                 PIC XX.
  5722     12  PY-LAST-MAINT-BY                 PIC X(4).
  5723     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5724
  5725     12  PY-PYADJ-RECORD.
  5726         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  5727         16  PY-ENTRY-COMMENT             PIC X(30).
  5728         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  5729             20  PY-GL-ACCOUNT            PIC X(10).
  5730             20  PY-GL-STATE              PIC X(02).
  5731             20  PY-GL-CANC-SW            PIC X(01).
  5732                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  5733                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  5734             20  PY-GL-COMMENT            PIC X(10).
  5735             20  FILLER      REDEFINES PY-GL-COMMENT.
  5736                 24  PY-GL-CHECK-NO       PIC 9(06).
  5737                 24  FILLER               PIC X(04).
  5738             20  FILLER                   PIC X(07).
  5739         16  PY-SAVE-ACCOUNT              PIC X(10).
  5740         16  PY-SAVE-TYPE                 PIC X(01).
  5741
  5742         16  PY-LETTERS.
  5743             20  PY-LETTER OCCURS 3 TIMES
  5744                           INDEXED BY PY-LET-NDX
  5745                                          PIC X(04).
  5746
  5747         16  PY-ERCOMP-TYPE               PIC X.
  5748             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  5749             88  PY-GA-TYPE                   VALUE 'G'.
  5750             88  PY-BANK-TYPE                 VALUE 'B'.
  5751         16  FILLER                       PIC X(05).
  5752
  5753     12  PY-RECORD-STATUS.
  5754         16  PY-CREDIT-SELECT-DT          PIC XX.
  5755         16  PY-CREDIT-ACCEPT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 101
* EL677.cbl
  5756         16  PY-BILLED-DATE               PIC XX.
  5757         16  PY-REPORTED-DT               PIC XX.
  5758         16  PY-PMT-APPLIED               PIC X.
  5759             88  PY-ACCOUNT-PMT               VALUE 'A'.
  5760             88  PY-GA-PMT                    VALUE 'G'.
  5761             88  PY-OVWRITE-PMT               VALUE 'O'.
  5762             88  PY-NON-AR-PMT                VALUE 'N'.
  5763         16  FILLER                       PIC X(5).
  5764         16  PY-INPUT-DT                  PIC XX.
  5765         16  PY-CHECK-NUMBER              PIC X(6).
  5766         16  PY-VOID-SW                   PIC X.
  5767             88  PY-CHECK-VOIDED              VALUE 'V'.
  5768         16  PY-CHECK-ORIGIN-SW           PIC X.
  5769             88  PY-BILLING-CHECK             VALUE 'B'.
  5770             88  PY-REFUND-CHECK              VALUE 'R'.
  5771             88  PY-GA-CHECK                  VALUE 'G'.
  5772             88  PY-CHECK-WRITTEN             VALUE 'W'.
  5773             88  PY-CHECK-REVERSAL            VALUE 'V'.
  5774         16  PY-CHECK-WRITTEN-DT          PIC XX.
  5775         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  5776         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  5777         16  PY-BILL-FLAG                 PIC X.
  5778             88  PY-BILLED                    VALUE 'B'.
  5779         16  PY-AR-FLAG                   PIC X.
  5780             88  PY-AR-CYCLE                  VALUE 'C'.
  5781             88  PY-AR-MONTH-END              VALUE 'M'.
  5782         16  PY-AR-DATE                   PIC XX.
  5783
  5784     12  PY-GL-CODES.
  5785         16  PY-GL-DB                     PIC X(14).
  5786         16  PY-GL-CR                     PIC X(14).
  5787         16  PY-GL-FLAG                   PIC X.
  5788         16  PY-GL-DATE                   PIC XX.
  5789
  5790     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  5791     12  FILLER                           PIC X(3).
  5792******************************************************************
  5793 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CONTROL-FILE
  5794                          CHECK-RECORDS ACCOUNT-MASTER
  5795                          COMPENSATION-MASTER
  5796                          CERTIFICATE-MASTER PENDING-BUSINESS
  5797                          PENDING-MAILING-DATA MAILING-DATA
  5798                          PENDING-PAY-ADJ.
  5799 0000-DFHEXIT SECTION.
  5800     MOVE '9#                    $   ' TO DFHEIV0.
  5801     MOVE 'EL677' TO DFHEIV1.
  5802     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5803
  5804     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5805     MOVE '5'                    TO  DC-OPTION-CODE.
  5806     PERFORM 8500-DATE-CONVERT.
  5807     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5808     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5809     MOVE DC-GREG-DATE-1-MDY     TO  SAVE-CURRENT-DATE-MDY.
  5810
  5811     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5812
  5813     IF PI-AMOUNT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 102
* EL677.cbl
  5814         MOVE ZEROS              TO  PI-AMOUNT.
  5815
  5816     IF EIBCALEN = 0
  5817         GO TO 8800-UNAUTHORIZED-ACCESS.
  5818     set P to address of KIXSYS
  5819     CALL "getenv" using by value P returning var-ptr
  5820     if var-ptr = null then
  5821        display ' kixsys not set '
  5822     else
  5823        set address of var to var-ptr
  5824        move 0 to env-var-len
  5825        inspect var tallying env-var-len
  5826          for characters before X'00'
  5827        unstring var (1:env-var-len) delimited by '/'
  5828           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5829              WS-KIX-SYS
  5830        end-unstring
  5831     end-if
  5832     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5833     MOVE 2                      TO  EMI-SWITCH2.
  5834     MOVE EIBTRMID               TO  QID-TERM.
  5835
  5836     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5837         MOVE PI-CALLING-PROGRAM TO  RETURNED-FROM.
  5838
  5839     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5840         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5841             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  5842             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  5843             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  5844             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  5845             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  5846             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  5847             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  5848             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  5849         ELSE
  5850             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  5851             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  5852             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  5853             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  5854             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  5855             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  5856             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  5857             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  5858
  5859     MOVE LOW-VALUES             TO  EL677AI.
  5860
  5861     if eibtrnid not = trans-id
  5862        evaluate true
  5863           when pi-return-to-program = 'EL6315'
  5864              move pi-company-cd to pi-chek-comp-cd
  5865              move pi-carrier    to pi-chek-carrier
  5866              move pi-grouping   to pi-chek-grouping
  5867              move pi-state      to pi-chek-state
  5868              move pi-account    to pi-chek-account
  5869              move pi-cert-eff-dt to pi-chek-eff-dt
  5870              move pi-cert-prime to pi-chek-cert-no
  5871              move pi-cert-sfx   to pi-chek-suf-no
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 103
* EL677.cbl
  5872              move +1            to pi-chek-sequence
  5873              move 'C'           to pi-check-type *> Correction
  5874              move 'S'           to mainti
  5875              move +1            to maintl
  5876              move al-uanon      to mainta
  5877              move dfhenter      to eibaid
  5878              go to 5000-browse-file
  5879           when pi-return-to-program = 'EL6318'
  5880              move 'C'           to pi-check-type *> Correction
  5881           when other
  5882              move 'R'           to pi-check-type *> Refund
  5883        end-evaluate
  5884     end-if
  5885     IF EIBTRNID NOT = TRANS-ID
  5886         move pi-processor-id    to pi-return-to
  5887         move +1                 to dedcynl
  5888         move 'N'                to dedcyno
  5889         move al-uanon           to dedcyna
  5890         move dfhpf7             to eibaid
  5891         move ' '                to pi-void-reissue-pass
  5892         move zeros              to pi-void-reissue-amt
  5893         perform 6800-browse-previous-chek-recs *> totals up prev
  5894                                 thru 6800-exit
  5895         perform 5600-get-erpndb thru 5600-exit *> calc refund on
  5896                                                *> pending record
  5897         IF PI-TO-EL677-FROM-EL1273
  5898             MOVE 'S'            TO MAINTI
  5899             MOVE 1              TO MAINTL
  5900             MOVE AL-UABON       TO MAINTA
  5901             MOVE DFHENTER       TO EIBAID
  5902             GO TO 5000-BROWSE-FILE.
  5903
  5904     IF EIBTRNID NOT = TRANS-ID
  5905        IF RETURNED-FROM = XCTL-1273 OR XCTL-114
  5906           PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT
  5907           PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5908           IF PI-PROCESS-BENEFICIARY
  5909              GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5910           ELSE
  5911              GO TO 6300-BUILD-CERT-SCREEN
  5912           end-if
  5913        ELSE
  5914           IF EIBTRNID NOT = EL6311-TRANS-ID and el6318-trans-id
  5915              GO TO 8100-SEND-INITIAL-MAP
  5916           ELSE
  5917              PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5918              IF PI-PROCESS-BENEFICIARY
  5919                 GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5920              ELSE
  5921                 GO TO 6300-BUILD-CERT-SCREEN
  5922              end-if
  5923           end-if
  5924        end-if
  5925      end-if
  5926
  5927     MOVE PI-COMPANY-CD          TO  CHEK-COMPANY-CD
  5928                                     PI-CHEK-COMP-CD.
  5929
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 104
* EL677.cbl
  5930
  5931* EXEC CICS HANDLE CONDITION
  5932*        PGMIDERR  (9600-PGMID-ERROR)
  5933*        ERROR     (9990-ABEND)
  5934*    END-EXEC.
  5935*    MOVE '"$L.                  ! " #00005833' TO DFHEIV0
  5936     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5938     MOVE X'2220233030303035383333' TO DFHEIV0(25:11)
  5939     CALL 'kxdfhei1' USING DFHEIV0
  5940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5941
  5942
  5943     IF EIBAID = DFHCLEAR
  5944         GO TO 9400-CLEAR.
  5945
  5946     IF PI-PROCESSOR-ID = 'LGXX'
  5947         GO TO 0200-RECEIVE.
  5948
  5949
  5950* EXEC CICS READQ TS
  5951*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5952*        INTO   (SECURITY-CONTROL)
  5953*        LENGTH (SC-COMM-LENGTH)
  5954*        ITEM   (SC-ITEM)
  5955*    END-EXEC.
  5956*    MOVE '*$II   L              ''   #00005844' TO DFHEIV0
  5957     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5958     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5959     MOVE X'2020233030303035383434' TO DFHEIV0(25:11)
  5960     CALL 'kxdfhei1' USING DFHEIV0,
  5961           PI-SECURITY-TEMP-STORE-ID,
  5962           SECURITY-CONTROL,
  5963           SC-COMM-LENGTH,
  5964           SC-ITEM,
  5965           DFHEIV99,
  5966           DFHEIV99
  5967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5968
  5969
  5970     MOVE SC-CREDIT-DISPLAY (17)  TO PI-DISPLAY-CAP.
  5971     MOVE SC-CREDIT-UPDATE  (17)  TO PI-MODIFY-CAP.
  5972
  5973     IF NOT DISPLAY-CAP
  5974         MOVE 'READ'          TO SM-READ
  5975         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5976         MOVE ER-0070         TO  EMI-ERROR
  5977         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5978         GO TO 8100-SEND-INITIAL-MAP.
  5979
  5980 0200-RECEIVE.
  5981     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5982         MOVE ER-1159            TO  EMI-ERROR
  5983         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5984         MOVE -1                 TO  PFENTERL
  5985         GO TO 8200-SEND-DATAONLY.
  5986
  5987
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 105
* EL677.cbl
  5988* EXEC CICS HANDLE CONDITION
  5989*        MAPFAIL (8100-SEND-INITIAL-MAP)
  5990*    END-EXEC.
  5991*    MOVE '"$?                   ! # #00005868' TO DFHEIV0
  5992     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  5993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5994     MOVE X'2320233030303035383638' TO DFHEIV0(25:11)
  5995     CALL 'kxdfhei1' USING DFHEIV0
  5996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5997
  5998
  5999
  6000* EXEC CICS RECEIVE
  6001*        MAP      (EL677A)
  6002*        MAPSET   (MAPSET-NAME)
  6003*        INTO     (EL677AI)
  6004*    END-EXEC.
  6005     MOVE LENGTH OF
  6006      EL677AI
  6007       TO DFHEIV11
  6008*    MOVE '8"T I  L              ''   #00005872' TO DFHEIV0
  6009     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6010     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6011     MOVE X'2020233030303035383732' TO DFHEIV0(25:11)
  6012     CALL 'kxdfhei1' USING DFHEIV0,
  6013           EL677A,
  6014           EL677AI,
  6015           DFHEIV11,
  6016           MAPSET-NAME,
  6017           DFHEIV99,
  6018           DFHEIV99
  6019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6020
  6021
  6022     IF PFENTERL GREATER ZERO
  6023         IF EIBAID NOT = DFHENTER
  6024             MOVE ER-0004        TO  EMI-ERROR
  6025             MOVE AL-UNBOF       TO  PFENTERA
  6026             MOVE -1             TO  PFENTERL
  6027             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6028             GO TO 8200-SEND-DATAONLY
  6029         ELSE
  6030             IF (PFENTERI NUMERIC) AND
  6031                (PFENTERI GREATER 0 AND LESS 25)
  6032                 MOVE PF-VALUES (PFENTERI)   TO  EIBAID
  6033             ELSE
  6034                 MOVE ER-0029    TO  EMI-ERROR
  6035                 MOVE AL-UNBOF   TO  PFENTERA
  6036                 MOVE -1         TO  PFENTERL
  6037                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6038                 GO TO 8200-SEND-DATAONLY.
  6039 0300-CHECK-PFKEYS.
  6040     IF EIBAID = DFHPF23
  6041         GO TO 8810-PF23.
  6042
  6043     IF EIBAID = DFHPF24
  6044         GO TO 9200-RETURN-MAIN-MENU.
  6045
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 106
* EL677.cbl
  6046     IF EIBAID = DFHPF12
  6047         GO TO 9500-PF12.
  6048
  6049     IF EIBAID = DFHPF1 OR DFHPF2
  6050         GO TO 5000-BROWSE-FILE.
  6051
  6052     if PI-TO-EL677-FROM-EL1273
  6053        and (eibaid not = dfhenter)
  6054        and (pi-void-reissue-pass not = '1' and '2')
  6055        go to 0320-input-error
  6056     end-if
  6057     IF EIBAID = DFHPF3
  6058         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6059         MOVE 'PF3'              TO  PI-PFKEY
  6060         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6061         IF PI-RETURN-TO-PROGRAM IS EQUAL TO 'EL1273  '
  6062             GO TO 9400-CLEAR
  6063         ELSE
  6064             MOVE XCTL-1273      TO  PGM-NAME
  6065             GO TO 9300-XCTL.
  6066
  6067     IF EIBAID = DFHPF4
  6068         IF NOT FORCE-CAP
  6069             MOVE ER-0433        TO EMI-ERROR
  6070             MOVE -1             TO PFENTERL
  6071             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6072             GO TO 8200-SEND-DATAONLY.
  6073
  6074     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2 OR DFHPF4 OR
  6075                             DFHPF5 OR DFHPF6 or dfhpf7
  6076         GO TO 1000-EDIT-DATA.
  6077
  6078*    IF EIBAID = DFHPF7
  6079*        PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6080*        PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6081*        MOVE XCTL-114           TO  PGM-NAME
  6082*        GO TO 9300-XCTL.
  6083
  6084 0320-INPUT-ERROR.
  6085     MOVE ER-0029                TO  EMI-ERROR.
  6086     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6087     MOVE -1                     TO  PFENTERL.
  6088     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 107
* EL677.cbl
  6090
  6091 1000-EDIT-DATA.
  6092     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D' or 'R'
  6093         MOVE AL-UANON           TO MAINTA
  6094         IF MAINTI = 'C' OR 'V' OR 'R'
  6095             IF PI-PREV-MAINT = 'S'  OR  'C' or 'R'
  6096                 NEXT SENTENCE
  6097             ELSE
  6098                 MOVE ER-2056    TO  EMI-ERROR
  6099                 MOVE -1         TO  MAINTL
  6100                 MOVE AL-UABON   TO  MAINTA
  6101                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6102                 GO TO 1100-EDIT-COMPLETE
  6103         ELSE
  6104             NEXT SENTENCE
  6105     ELSE
  6106         IF EIBAID = DFHPF5 OR DFHPF6 or dfhpf7
  6107            NEXT SENTENCE
  6108         ELSE
  6109            MOVE ER-0023            TO  EMI-ERROR
  6110            MOVE -1                 TO  MAINTL
  6111            MOVE AL-UABON           TO  MAINTA
  6112            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6113
  6114     IF MODIFY-CAP
  6115         NEXT SENTENCE
  6116       ELSE
  6117         IF MAINTI NOT = 'S'
  6118            MOVE 'UPDATE'       TO SM-READ
  6119            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6120            MOVE ER-0070        TO EMI-ERROR
  6121            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6122            GO TO 8100-SEND-INITIAL-MAP.
  6123
  6124     if (pi-return-to-program = 'EL1273')
  6125        and (MAINTI not = 'S' and 'V' and 'R' and 'D')
  6126        move 'S'                 to mainti
  6127        move +1                  to maintl
  6128        move al-uanon            to mainta
  6129     end-if
  6130     IF CARRIERI NOT = LOW-VALUES
  6131         MOVE AL-UANON           TO  CARRIERA
  6132         PERFORM 1200-VERIFY-CARRIER-ID THRU 1200-EXIT
  6133         MOVE CARRIERI           TO  PI-CHEK-CARRIER
  6134                                     PI-CARRIER
  6135     ELSE
  6136         MOVE -1                 TO  CARRIERL
  6137         MOVE AL-UABON           TO  CARRIERA
  6138         MOVE ER-0194            TO  EMI-ERROR
  6139         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6140
  6141     IF GROUPI NOT = LOW-VALUES
  6142         MOVE AL-UANON           TO  GROUPA
  6143         MOVE GROUPI             TO  PI-CHEK-GROUPING
  6144                                     PI-GROUPING
  6145     ELSE
  6146         MOVE -1                 TO  GROUPL
  6147         MOVE AL-UABON           TO  GROUPA
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 108
* EL677.cbl
  6148         MOVE ER-0195            TO  EMI-ERROR
  6149         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6150
  6151     IF STATEI NOT = LOW-VALUES
  6152         MOVE AL-UANON           TO  STATEA
  6153         PERFORM 1300-VERIFY-STATE-ID THRU 1390-EXIT
  6154         MOVE STATEI             TO  PI-CHEK-STATE
  6155                                     PI-STATE
  6156     ELSE
  6157         MOVE -1                 TO  STATEL
  6158         MOVE AL-UABON           TO  STATEA
  6159         MOVE ER-0196            TO  EMI-ERROR
  6160         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6161
  6162     IF EFFDTL GREATER ZERO
  6163         MOVE EFFDTI             TO  WS-DT-DEEDIT-FIELD
  6164         PERFORM 8700-DEEDIT
  6165         IF WS-DEEDIT-FIELD-DATE-OUT IS NUMERIC
  6166             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EFFDTO
  6167             INSPECT EFFDTI CONVERTING SPACES TO '/'
  6168             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  6169             MOVE '4'                TO  DC-OPTION-CODE
  6170             PERFORM 8500-DATE-CONVERT
  6171             IF DC-ERROR-CODE NOT = SPACES
  6172                 MOVE ER-0215        TO  EMI-ERROR
  6173                 PERFORM 9900-ERROR-FORMAT
  6174                 MOVE -1             TO  EFFDTL
  6175                 MOVE AL-UABON       TO  EFFDTA
  6176               ELSE
  6177                 MOVE AL-UANON       TO  EFFDTA
  6178                 MOVE DC-BIN-DATE-1  TO  PI-CHEK-EFF-DT
  6179                                         PI-CERT-EFF-DT
  6180           ELSE
  6181             MOVE ER-0215        TO  EMI-ERROR
  6182             PERFORM 9900-ERROR-FORMAT
  6183             MOVE -1             TO  EFFDTL
  6184             MOVE AL-UABON       TO  EFFDTA
  6185       ELSE
  6186         MOVE ER-0216            TO  EMI-ERROR
  6187         PERFORM 9900-ERROR-FORMAT
  6188         MOVE -1                 TO  EFFDTL
  6189         MOVE AL-UABOF           TO  EFFDTA.
  6190
  6191     IF ACCTI NOT = LOW-VALUES
  6192         MOVE AL-UANON           TO  ACCTA
  6193         PERFORM 1400-VERIFY-ACCOUNT THRU 1490-EXIT
  6194         MOVE ACCTI              TO  PI-CHEK-ACCOUNT
  6195                                     PI-ACCOUNT
  6196     ELSE
  6197         MOVE -1                 TO  ACCTL
  6198         MOVE AL-UABON           TO  ACCTA
  6199         MOVE ER-0197            TO  EMI-ERROR
  6200         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6201
  6202     IF CERTNOI NOT = LOW-VALUES
  6203         MOVE AL-UANON           TO  CERTNOA
  6204         MOVE CERTNOI            TO  PI-CHEK-CERT-NO
  6205                                     PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 109
* EL677.cbl
  6206     ELSE
  6207         MOVE -1                 TO  CERTNOL
  6208         MOVE AL-UABON           TO  CERTNOA
  6209         MOVE ER-0203            TO  EMI-ERROR
  6210         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6211
  6212     IF SFXI  = LOW-VALUES
  6213         MOVE SPACE              TO  SFXI.
  6214
  6215     MOVE AL-UANON               TO  SFXA.
  6216
  6217     MOVE SFXI                   TO  PI-CHEK-SUF-NO
  6218                                     PI-CERT-SFX.
  6219     IF SEQI = LOW-VALUES
  6220         MOVE +1                 TO  SEQI.
  6221
  6222     MOVE AL-UNNON               TO  SEQA.
  6223     MOVE SEQI                   TO  PI-CHEK-SEQUENCE.
  6224
  6225     IF PAYTO1L > 0
  6226         MOVE PAYTO1I            TO  PI-PAYTO1
  6227     ELSE
  6228         MOVE SPACES             TO  PI-PAYTO1.
  6229
  6230     IF AMOUNTL > 0
  6231
  6232* EXEC CICS BIF DEEDIT
  6233*            FIELD   (AMOUNTI)
  6234*            LENGTH  (11)
  6235*        END-EXEC
  6236     MOVE 11
  6237       TO DFHEIV11
  6238*    MOVE '@"L                   #   #00006087' TO DFHEIV0
  6239     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6240     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6241     MOVE X'2020233030303036303837' TO DFHEIV0(25:11)
  6242     CALL 'kxdfhei1' USING DFHEIV0,
  6243           AMOUNTI,
  6244           DFHEIV11
  6245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6246         MOVE AMOUNTI            TO  PI-AMOUNT
  6247     ELSE
  6248         MOVE ZEROS              TO  PI-AMOUNT.
  6249
  6250     IF TYPEL > 0
  6251         MOVE TYPEI              TO  PI-TYPE
  6252     ELSE
  6253         MOVE SPACE              TO  PI-TYPE.
  6254
  6255*    IF REFL > 0
  6256*        MOVE REFI               TO  PI-REFERENCE
  6257*    ELSE
  6258*        MOVE SPACES             TO  PI-REFERENCE.
  6259     if rettol not = zeros
  6260        move rettoi              to pi-return-to
  6261        MOVE AL-UANON            TO  RETTOA
  6262     end-if
  6263     if dedcynl not = zeros
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 110
* EL677.cbl
  6264        if dedcyni = 'Y' OR 'N'
  6265           move al-uanon         to dedcyna
  6266           continue
  6267        else
  6268           move er-3451          to emi-error
  6269           move -1               to dedcynl
  6270           move al-uabon         to dedcyna
  6271           perform 9900-error-format
  6272                                 thru 9900-exit
  6273        end-if
  6274     end-if
  6275
  6276     if mainti = 'V' or 'R'
  6277        if ((vreasonl > zeros)
  6278           and (vreasoni (1:2) not = spaces))
  6279             or (pi-void-reissue-pass = '1' or '2')
  6280           continue
  6281        else
  6282           move er-3454          to emi-error
  6283           move -1               to vreasonl
  6284           move al-uabon         to vreasona
  6285           perform 9900-error-format
  6286                                 thru 9900-exit
  6287        end-if
  6288     end-if
  6289     if (mainti = 'A')
  6290        and (pi-prev-paid > zeros)
  6291        and (pi-check-type = 'C')
  6292        move er-3459             to emi-error
  6293        move -1                  to maintl
  6294        move al-uabon            to mainta
  6295        perform 9900-error-format
  6296                                 thru 9900-exit
  6297     end-if
  6298     if mainti = 'A'
  6299        continue
  6300     else
  6301        IF MAINTI = 'S'
  6302           or pi-prev-maint = 'S'
  6303           GO TO 1100-EDIT-COMPLETE
  6304        end-if
  6305     end-if
  6306     if (pi-void-reissue-pass = '1')
  6307        and (mainti = 'R')
  6308        if emi-error = zeros
  6309           if eibaid = dfhpf5 or dfhpf6 or dfhpf7
  6310              go to 7500-reissue-pass-1
  6311           else
  6312              if eibaid = dfhenter
  6313                 move er-3460    to emi-error
  6314                 move -1         to maintl
  6315                 move al-uabon   to mainta
  6316                 perform 9900-error-format
  6317                                 thru 9900-exit
  6318              end-if
  6319           end-if
  6320        end-if
  6321     end-if
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 111
* EL677.cbl
  6322
  6323     if (pi-void-reissue-pass = '2')
  6324        and (mainti = 'R')
  6325        if emi-error = zeros
  6326           if eibaid = dfhpf5 or dfhpf6 or dfhpf7
  6327              go to 7500-reissue-pass-1
  6328           else
  6329              if eibaid = dfhenter
  6330                 go to 7510-reissue-pass-2
  6331              end-if
  6332           end-if
  6333        end-if
  6334     end-if
  6335*    if (pi-void-reissue-pass = '1')
  6336*       and (mainti = 'R')
  6337*       if emi-error = zeros
  6338*          if eibaid = dfhpf5 or dfhpf6 or dfhpf7
  6339*             go to 7500-reissue-pass-1
  6340*          else
  6341*             if eibaid = dfhenter
  6342*                go to 7510-reissue-pass-2
  6343*                move '2'        to pi-void-reissue-pass
  6344*             end-if
  6345*          end-if
  6346*       end-if
  6347*    end-if
  6348     IF EIBAID = DFHPF5
  6349        IF EMI-ERROR = ZEROS
  6350          GO TO 6500-BUILD-ACCOUNT-SCREEN
  6351        ELSE
  6352          GO TO 1100-EDIT-COMPLETE.
  6353
  6354     IF EIBAID = DFHPF6
  6355        IF EMI-ERROR = ZEROS
  6356           GO TO 6300-BUILD-CERT-SCREEN
  6357         ELSE
  6358           GO TO 1100-EDIT-COMPLETE.
  6359
  6360     IF EIBAID = DFHPF7
  6361        IF EMI-ERROR = ZEROS
  6362           GO TO 6600-build-beneficiary-screen
  6363         ELSE
  6364           GO TO 1100-EDIT-COMPLETE.
  6365     if mainti = 'A'
  6366        if dedcynl not = zeros
  6367           if dedcyni <> pi-previous-deduct-comm
  6368              perform 6700-build-common
  6369                                 thru 6700-exit
  6370              MOVE WS-REFUND-AMOUNT
  6371                                 TO AMOUNTO
  6372              MOVE AL-UANON      TO PAYTO1A
  6373                                    PAYTO2A
  6374                                    PAYAD1A
  6375                                    PAYCTYA
  6376                                    paysta
  6377                                    PTOZIPA
  6378              GO TO 8100-send-initial-map
  6379           end-if
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 112
* EL677.cbl
  6380        end-if
  6381     end-if
  6382*    if mainti = 'V'
  6383*       if (vreasonl > zeros)
  6384*          and (vreasoni (1:2) not = spaces)
  6385*          continue
  6386*       else
  6387*          move er-3454          to emi-error
  6388*          move -1               to vreasonl
  6389*          move al-uabon         to vreasona
  6390*          perform 9900-error-format
  6391*                                thru 9900-exit
  6392*       end-if
  6393*    end-if
  6394     IF MAINTI = 'A'
  6395        if (payto1i not = spaces and low-values)
  6396           and (payad1i not = spaces and low-values)
  6397           and (payctyi not = spaces and low-values)
  6398           and (paysti not = spaces and low-values)
  6399           and (ptozipi not = spaces and low-values)
  6400           continue
  6401        else
  6402           MOVE -1               TO PAYTO1L
  6403           MOVE ER-2907          TO EMI-ERROR
  6404           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6405        end-if
  6406     end-if
  6407
  6408     IF MAINTI = 'A'
  6409         IF EIBAID NOT = DFHPF4
  6410             MOVE DFHENTER       TO  EIBAID
  6411             PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  6412
  6413     IF MAINTI = 'S' OR 'V' or 'R' or 'D'
  6414         GO TO 1100-EDIT-COMPLETE.
  6415
  6416     IF PRINTEDL GREATER THAN +0
  6417         MOVE PRINTEDI           TO  WS-DEEDIT-FIELD-A
  6418         PERFORM 8700-DEEDIT
  6419         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6420             MOVE WS-DEEDIT-FIELD-V0 TO  PRINTEDO
  6421             INSPECT PRINTEDI CONVERTING SPACES TO '/'
  6422             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  6423             MOVE '4'                TO  DC-OPTION-CODE
  6424             PERFORM 8500-DATE-CONVERT
  6425             IF DC-ERROR-CODE NOT = SPACES
  6426                 MOVE ER-3046        TO  EMI-ERROR
  6427                 PERFORM 9900-ERROR-FORMAT
  6428                 MOVE -1             TO  PRINTEDL
  6429                 MOVE AL-UABON       TO  PRINTEDA
  6430                 MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT
  6431             ELSE
  6432                 MOVE AL-UANON       TO  PRINTEDA
  6433                 MOVE DC-BIN-DATE-1  TO  WS-CHK-PRINT-DT
  6434         ELSE
  6435             MOVE ER-3046        TO  EMI-ERROR
  6436             PERFORM 9900-ERROR-FORMAT
  6437             MOVE -1             TO  PRINTEDL
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 113
* EL677.cbl
  6438             MOVE AL-UABON       TO  PRINTEDA
  6439             MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT.
  6440
  6441     IF AMOUNTL = ZEROS
  6442         GO TO 1050-CK-AMT.
  6443
  6444*    EXEC CICS BIF DEEDIT
  6445*        FIELD   (AMOUNTI)
  6446*        LENGTH  (11)
  6447*    END-EXEC.
  6448
  6449     IF AMOUNTI NOT NUMERIC     OR
  6450        AMOUNTI LESS THAN ZERO  OR
  6451       (AMOUNTI = ZEROS  AND
  6452               (PI-COMPANY-ID NOT = 'LAP' AND 'RMC'))
  6453          MOVE ER-1159            TO  EMI-ERROR
  6454          MOVE -1                 TO  AMOUNTL
  6455          MOVE AL-UNBON           TO  AMOUNTA
  6456          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6457          GO TO 1100-EDIT-COMPLETE.
  6458
  6459     MOVE AMOUNTI                TO  WS-AM-WORK.
  6460
  6461     IF WS-AM-SIGN = SPACES
  6462         MOVE WS-AM-NUM          TO  WS-AMT
  6463         ADD 0                   TO  WS-AMT
  6464       ELSE
  6465         MOVE AMOUNTI            TO  WS-AMT
  6466         ADD 0                   TO  WS-AMT.
  6467
  6468     IF MAINTI = 'A'
  6469        IF EIBAID = DFHENTER
  6470           if (ws-amt + pi-prev-paid) >
  6471              (cm-lf-premium-amt + cm-lf-alt-premium-amt +
  6472                 cm-ah-premium-amt)
  6473              move zeros to ws-amt
  6474           end-if
  6475        end-if
  6476     end-if
  6477      MOVE WS-AMT                TO  AMOUNTO.
  6478      MOVE AL-UNNON              TO  AMOUNTA.
  6479
  6480 1050-CK-AMT.
  6481     IF AMOUNTL = ZEROS AND
  6482        MAINTI  = 'A'
  6483         MOVE ER-1159            TO  EMI-ERROR
  6484         MOVE -1                 TO  AMOUNTL
  6485         MOVE AL-UNBON           TO  AMOUNTA
  6486         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6487
  6488*    MOVE AL-UANON              TO  TYPEA.
  6489     if (amountl <> zeros)
  6490        if (ws-amt <= zeros)
  6491           and (pi-check-type <> 'C')
  6492           MOVE ER-9999          TO EMI-ERROR
  6493           MOVE -1               TO AMOUNTL
  6494           MOVE AL-UNBON         TO AMOUNTA
  6495           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 114
* EL677.cbl
  6496                                 THRU 9900-EXIT
  6497        end-if
  6498     end-if
  6499     IF TYPEL GREATER THAN ZEROS
  6500         IF TYPEI = 'R' OR 'M' OR 'E' or 'C'
  6501             NEXT SENTENCE
  6502         ELSE
  6503             MOVE ER-3044    TO  EMI-ERROR
  6504             MOVE -1         TO  TYPEL
  6505             MOVE AL-PABON   TO  TYPEA
  6506             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6507     ELSE
  6508         IF MAINTI  = 'A'
  6509             MOVE ER-3044    TO  EMI-ERROR
  6510             MOVE -1         TO  TYPEL
  6511             MOVE AL-PABON   TO  TYPEA
  6512             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6513
  6514
  6515 1100-EDIT-COMPLETE.
  6516
  6517     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6518       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6519        EIBAID NOT = DFHPF4)
  6520         GO TO 8200-SEND-DATAONLY.
  6521
  6522     MOVE MAINTI                 TO  PI-PREV-MAINT.
  6523
  6524     IF MAINTI = 'A'
  6525         GO TO 2000-ADD-RECORD.
  6526
  6527*    IF MAINTI = 'C' OR 'V'
  6528     IF MAINTI = 'V' or 'R'
  6529         GO TO 3000-CHANGE-RECORD.
  6530
  6531     IF MAINTI = 'S' or 'C'
  6532         GO TO 5000-BROWSE-FILE.
  6533
  6534     if mainti = 'D'
  6535        go to 3400-delete-record
  6536     end-if
  6537     .
  6538 1200-VERIFY-CARRIER-ID.
  6539     MOVE SPACES                 TO ELCNTL-KEY.
  6540     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6541     MOVE '6'                    TO ELCNTL-REC-TYPE.
  6542     MOVE CARRIERI               TO ELCNTL-CARRIER.
  6543     MOVE +0                     TO ELCNTL-SEQ.
  6544
  6545
  6546* EXEC CICS HANDLE CONDITION
  6547*        NOTFND   (1290-NO-CARRIER)
  6548*    END-EXEC.
  6549*    MOVE '"$I                   ! $ #00006390' TO DFHEIV0
  6550     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6551     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6552     MOVE X'2420233030303036333930' TO DFHEIV0(25:11)
  6553     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 115
* EL677.cbl
  6554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6555
  6556
  6557
  6558* EXEC CICS READ
  6559*        DATASET   (ELCNTL-FILE-ID)
  6560*        SET       (ADDRESS OF CONTROL-FILE)
  6561*        RIDFLD    (ELCNTL-KEY)
  6562*    END-EXEC.
  6563*    MOVE '&"S        E          (   #00006394' TO DFHEIV0
  6564     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6565     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6566     MOVE X'2020233030303036333934' TO DFHEIV0(25:11)
  6567     CALL 'kxdfhei1' USING DFHEIV0,
  6568           ELCNTL-FILE-ID,
  6569           DFHEIV20,
  6570           DFHEIV99,
  6571           ELCNTL-KEY,
  6572           DFHEIV99,
  6573           DFHEIV99,
  6574           DFHEIV99
  6575     SET ADDRESS OF CONTROL-FILE TO
  6576         DFHEIV20
  6577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6578
  6579
  6580     GO TO 1200-EXIT.
  6581
  6582 1290-NO-CARRIER.
  6583     MOVE ER-2208                TO EMI-ERROR.
  6584     MOVE -1                     TO CARRIERL.
  6585     MOVE AL-UABON               TO CARRIERA.
  6586     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6587
  6588 1200-EXIT.
  6589      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 116
* EL677.cbl
  6591 1300-VERIFY-STATE-ID.
  6592     MOVE SPACES                 TO ELCNTL-KEY.
  6593     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6594     MOVE '3'                    TO ELCNTL-REC-TYPE.
  6595     MOVE STATEI                 TO ELCNTL-STATE.
  6596     MOVE +0                     TO ELCNTL-SEQ.
  6597
  6598
  6599* EXEC CICS HANDLE CONDITION
  6600*        NOTFND   (1380-NO-STATE)
  6601*    END-EXEC.
  6602*    MOVE '"$I                   ! % #00006418' TO DFHEIV0
  6603     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6605     MOVE X'2520233030303036343138' TO DFHEIV0(25:11)
  6606     CALL 'kxdfhei1' USING DFHEIV0
  6607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6608
  6609
  6610
  6611* EXEC CICS READ
  6612*        DATASET   (ELCNTL-FILE-ID)
  6613*        SET       (ADDRESS OF CONTROL-FILE)
  6614*        RIDFLD    (ELCNTL-KEY)
  6615*    END-EXEC.
  6616*    MOVE '&"S        E          (   #00006422' TO DFHEIV0
  6617     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6618     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6619     MOVE X'2020233030303036343232' TO DFHEIV0(25:11)
  6620     CALL 'kxdfhei1' USING DFHEIV0,
  6621           ELCNTL-FILE-ID,
  6622           DFHEIV20,
  6623           DFHEIV99,
  6624           ELCNTL-KEY,
  6625           DFHEIV99,
  6626           DFHEIV99,
  6627           DFHEIV99
  6628     SET ADDRESS OF CONTROL-FILE TO
  6629         DFHEIV20
  6630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6631
  6632
  6633     GO TO 1390-EXIT.
  6634
  6635 1380-NO-STATE.
  6636     MOVE ER-2209                TO EMI-ERROR.
  6637     MOVE -1                     TO STATEL.
  6638     MOVE AL-UABON               TO STATEA.
  6639     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6640
  6641 1390-EXIT.
  6642      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 117
* EL677.cbl
  6644
  6645 1400-VERIFY-ACCOUNT.
  6646     IF EIBAID = DFHPF5
  6647         GO TO 1410-BUILD-ACCOUNT-KEY.
  6648
  6649     IF MAINTL GREATER +0
  6650         NEXT SENTENCE
  6651       ELSE
  6652         GO TO 1490-EXIT.
  6653
  6654*    IF MAINTI = 'A' OR 'C' OR 'V'
  6655     IF MAINTI = 'A' OR 'V' or 'R'
  6656         NEXT SENTENCE
  6657       ELSE
  6658         GO TO 1490-EXIT.
  6659
  6660 1410-BUILD-ACCOUNT-KEY.
  6661     MOVE CARRIERI               TO ERACCT-CARRIER.
  6662     MOVE GROUPI                 TO ERACCT-GROUPING
  6663     MOVE STATEI                 TO ERACCT-STATE.
  6664     MOVE ACCTI                  TO ERACCT-ACCOUNT.
  6665     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  6666
  6667     MOVE '2'                    TO DC-OPTION-CODE.
  6668     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6669
  6670     PERFORM 8500-DATE-CONVERT.
  6671     IF DATE-CONVERSION-ERROR
  6672        GO TO 1480-ACCOUNT-INVALID.
  6673
  6674     MOVE DC-BIN-DATE-1          TO ERACCT-EXP-DATE.
  6675    .
  6676 1420-get-eracct.
  6677     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  6678
  6679
  6680* EXEC CICS HANDLE CONDITION
  6681*        NOTFND   (1480-ACCOUNT-INVALID)
  6682*        ENDFILE  (1480-ACCOUNT-INVALID)
  6683*    END-EXEC.
  6684*    MOVE '"$I''                  ! & #00006474' TO DFHEIV0
  6685     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6686     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6687     MOVE X'2620233030303036343734' TO DFHEIV0(25:11)
  6688     CALL 'kxdfhei1' USING DFHEIV0
  6689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6690
  6691
  6692
  6693* EXEC CICS STARTBR
  6694*        DATASET   (ERACCT-FILE-ID)
  6695*        RIDFLD    (ERACCT-KEY)
  6696*    END-EXEC.
  6697     MOVE 0
  6698       TO DFHEIV11
  6699*    MOVE '&,         G          &   #00006479' TO DFHEIV0
  6700     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6701     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 118
* EL677.cbl
  6702     MOVE X'2020233030303036343739' TO DFHEIV0(25:11)
  6703     CALL 'kxdfhei1' USING DFHEIV0,
  6704           ERACCT-FILE-ID,
  6705           ERACCT-KEY,
  6706           DFHEIV99,
  6707           DFHEIV11,
  6708           DFHEIV99
  6709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6710
  6711
  6712     set eracct-start to true
  6713     .
  6714 1420-READNEXT-ACCOUNT-MASTER.
  6715
  6716* EXEC CICS READNEXT
  6717*        DATASET   (ERACCT-FILE-ID)
  6718*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6719*        RIDFLD    (ERACCT-KEY)
  6720*    END-EXEC.
  6721     MOVE 0
  6722       TO DFHEIV11
  6723*    MOVE '&.S                   )   #00006487' TO DFHEIV0
  6724     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6725     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6726     MOVE X'2020233030303036343837' TO DFHEIV0(25:11)
  6727     CALL 'kxdfhei1' USING DFHEIV0,
  6728           ERACCT-FILE-ID,
  6729           DFHEIV20,
  6730           DFHEIV99,
  6731           ERACCT-KEY,
  6732           DFHEIV99,
  6733           DFHEIV11,
  6734           DFHEIV99,
  6735           DFHEIV99
  6736     SET ADDRESS OF ACCOUNT-MASTER TO
  6737         DFHEIV20
  6738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6739
  6740
  6741*    IF PI-COMPANY-CD    NOT = AM-COMPANY-CD   OR
  6742*       SV-ACCT-GROUPING NOT = AM-GROUPING     OR
  6743*       SV-ACCT-CARRIER  NOT = AM-CARRIER      OR
  6744*       SV-ACCT-STATE    NOT = AM-STATE        OR
  6745*       SV-ACCT-ACCOUNT  NOT = AM-ACCOUNT
  6746*         GO TO 1480-ACCOUNT-INVALID.
  6747*
  6748*    IF SV-ACCT-EXP-DATE LESS AM-EFFECTIVE-DT
  6749*        GO TO 1480-ACCOUNT-INVALID.
  6750*
  6751*    IF SV-ACCT-EXP-DATE NOT LESS AM-EXPIRATION-DT
  6752*        GO TO 1420-READNEXT-ACCOUNT-MASTER.
  6753
  6754     evaluate true
  6755        when (save-eracct-key (1:20) not =
  6756           am-control-primary (1:20))
  6757           and (not eracct-found)
  6758           go to 1480-account-invalid
  6759        when (save-eracct-key (1:20) not =
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 119
* EL677.cbl
  6760           am-control-primary (1:20))
  6761           and (eracct-found)
  6762           move ws-hold-eracct-record
  6763                                 to account-master
  6764        when (sv-acct-exp-date < am-effective-dt)
  6765           and (not eracct-found)
  6766           go to 1480-account-invalid
  6767        when sv-acct-exp-date >= am-expiration-dt
  6768           go to 1420-readnext-account-master
  6769        when am-expiration-dt = high-values
  6770           continue
  6771        when other
  6772           set eracct-found to true
  6773           move account-master   to ws-hold-eracct-record
  6774           go to 1420-readnext-account-master
  6775     end-evaluate
  6776     if eracct-start
  6777
  6778* exec cics endbr
  6779*          dataset  (eracct-file-id)
  6780*       end-exec
  6781     MOVE 0
  6782       TO DFHEIV11
  6783*    MOVE '&2                    $   #00006529' TO DFHEIV0
  6784     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6785     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6786     MOVE X'2020233030303036353239' TO DFHEIV0(25:11)
  6787     CALL 'kxdfhei1' USING DFHEIV0,
  6788           eracct-file-id,
  6789           DFHEIV11,
  6790           DFHEIV99
  6791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6792     end-if
  6793*    if am-expiration-dt = high-values
  6794*       continue
  6795*    else
  6796*       move account-master      to ws-hold-eracct-record
  6797*       go to 1420-readnext-account-master
  6798*    end-if
  6799     MOVE AM-CARRIER             TO PI-CR-CARRIER.
  6800     MOVE AM-GROUPING            TO PI-CR-GROUPING.
  6801     MOVE AM-STATE               TO PI-CR-STATE.
  6802     MOVE AM-AGT (AM-REMIT-TO)   TO PI-CR-FIN-RESP.
  6803
  6804     MOVE AM-NAME                TO PI-AM-NAME.
  6805     MOVE AM-ADDRS               TO PI-AM-ADDRS.
  6806     MOVE AM-CITY                TO PI-AM-CITY-st
  6807     MOVE AM-ZIP                 TO PI-AM-ZIP-CODE.
  6808     move am-csr-code            to pi-am-csr
  6809
  6810     MOVE +0                     TO WS-SUB.
  6811
  6812 1430-FIND-ACC-AGT.
  6813     ADD +1                      TO WS-SUB.
  6814
  6815     IF  WS-SUB GREATER +10
  6816         GO TO 1480-ACCOUNT-INVALID.
  6817
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 120
* EL677.cbl
  6818     IF (AM-COM-TYP (WS-SUB) = 'C' OR 'D' OR 'F')
  6819         MOVE AM-AGT (WS-SUB)    TO  PI-CR-ACCOUNT
  6820       ELSE
  6821         GO TO 1430-FIND-ACC-AGT.
  6822
  6823     MOVE AL-UANON               TO CARRIERA
  6824                                    GROUPA
  6825                                    STATEA.
  6826
  6827     PERFORM 6000-VERIFY-COMP-MASTER THRU 6090-EXIT.
  6828
  6829     GO TO 1490-EXIT.
  6830
  6831 1480-ACCOUNT-INVALID.
  6832     MOVE -1                     TO CARRIERL
  6833     MOVE AL-UANON               TO CARRIERA
  6834                                    GROUPA
  6835                                    STATEA
  6836                                    ACCTA.
  6837     MOVE ER-2210                TO EMI-ERROR.
  6838     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6839     GO TO 8200-SEND-DATAONLY.
  6840
  6841 1490-EXIT.
  6842      EXIT.
  6843
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 121
* EL677.cbl
  6845 1500-VERIFY-PENDING-BUS-REC.
  6846     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  6847     if pi-corr-check
  6848        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW
  6849        go to 1590-exit
  6850     end-if
  6851
  6852* EXEC CICS HANDLE CONDITION
  6853*        NOTFND   (1590-EXIT)
  6854*    END-EXEC.
  6855*    MOVE '"$I                   ! '' #00006591' TO DFHEIV0
  6856     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6857     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6858     MOVE X'2720233030303036353931' TO DFHEIV0(25:11)
  6859     CALL 'kxdfhei1' USING DFHEIV0
  6860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6861
  6862
  6863
  6864     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  6865     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  6866     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  6867     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  6868     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  6869     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  6870     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  6871     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  6872     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  6873     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  6874
  6875     IF ST-ACCNT-CNTL  OR
  6876        ACCNT-CNTL
  6877          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  6878
  6879     IF ST-ACCNT-CNTL      OR
  6880        CARR-ST-ACCNT-CNTL OR
  6881        ACCNT-CNTL         OR
  6882        CARR-ACCNT-CNTL
  6883          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  6884
  6885     IF ACCNT-CNTL OR
  6886        CARR-ACCNT-CNTL
  6887          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  6888
  6889
  6890* EXEC CICS READ
  6891*         DATASET   (ERPNDB-ALT-FILE-ID)
  6892*         SET       (ADDRESS OF PENDING-BUSINESS)
  6893*         RIDFLD    (ERPNDB-ALT-KEY)
  6894*     END-EXEC.
  6895*    MOVE '&"S        E          (   #00006621' TO DFHEIV0
  6896     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6897     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6898     MOVE X'2020233030303036363231' TO DFHEIV0(25:11)
  6899     CALL 'kxdfhei1' USING DFHEIV0,
  6900           ERPNDB-ALT-FILE-ID,
  6901           DFHEIV20,
  6902           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 122
* EL677.cbl
  6903           ERPNDB-ALT-KEY,
  6904           DFHEIV99,
  6905           DFHEIV99,
  6906           DFHEIV99
  6907     SET ADDRESS OF PENDING-BUSINESS TO
  6908         DFHEIV20
  6909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6910
  6911
  6912     MOVE 'Y'                    TO WS-PNDB-FOUND-SW.
  6913
  6914     IF PB-C-PAYEE-CODE GREATER SPACES
  6915        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW.
  6916
  6917     MOVE PB-C-REFERENCE         TO PI-REFERENCE.
  6918*    MOVE PB-CI-INSURED-NAME     TO PI-INSURED-NAME.
  6919
  6920     MOVE PB-C-LF-CANCEL-AMT     TO  PI-LF-REFUND.
  6921     MOVE PB-C-AH-CANCEL-AMT     TO  PI-AH-REFUND.
  6922
  6923     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  6924         MOVE PB-C-LF-CANCEL-DT  TO  PI-CANC-DT
  6925     ELSE
  6926         MOVE PB-C-AH-CANCEL-DT  TO  PI-CANC-DT.
  6927
  6928*    IF MAINTI = 'A' OR 'C'
  6929*      IF PB-C-REFUND-CREATED
  6930*          MOVE -1               TO  MAINTL
  6931*          MOVE ER-3445          TO  EMI-ERROR
  6932*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6933
  6934 1590-EXIT.
  6935      EXIT.
  6936
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 123
* EL677.cbl
  6938 2000-ADD-RECORD.
  6939
  6940* EXEC CICS GETMAIN
  6941*        SET      (ADDRESS OF CHECK-RECORDS)
  6942*        LENGTH   (600)
  6943*        INITIMG  (GETMAIN-SPACE)
  6944*    END-EXEC.
  6945     MOVE 600
  6946       TO DFHEIV11
  6947*    MOVE ',"IL                  $   #00006654' TO DFHEIV0
  6948     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6949     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6950     MOVE X'2020233030303036363534' TO DFHEIV0(25:11)
  6951     CALL 'kxdfhei1' USING DFHEIV0,
  6952           DFHEIV20,
  6953           DFHEIV11,
  6954           GETMAIN-SPACE
  6955     SET ADDRESS OF CHECK-RECORDS TO
  6956         DFHEIV20
  6957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6958
  6959
  6960     MOVE 'CH'                   TO CH-RECORD-ID.
  6961     MOVE PI-COMPANY-CD          TO CH-COMPANY-CD.
  6962     MOVE CARRIERI               TO CH-CARRIER.
  6963     MOVE GROUPI                 TO CH-GROUPING.
  6964     MOVE STATEI                 TO CH-STATE.
  6965     MOVE ACCTI                  TO CH-ACCOUNT.
  6966
  6967     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6968     MOVE '2'                    TO DC-OPTION-CODE.
  6969     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6970     MOVE DC-BIN-DATE-1          TO CH-CERT-EFF-DT.
  6971
  6972     MOVE CERTNOI                TO CH-CERT-PRIME.
  6973     MOVE SFXI                   TO CH-CERT-SFX.
  6974
  6975     MOVE SEQI                   TO CH-SEQUENCE-NO.
  6976
  6977     MOVE PI-PROCESSOR-ID        TO CH-RECORDED-BY
  6978                                    ch-released-by
  6979     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  6980
  6981     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6982     MOVE '5'                    TO DC-OPTION-CODE.
  6983     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6984     MOVE DC-BIN-DATE-1          TO CH-RECORDED-DT
  6985                                    ch-released-dt
  6986
  6987     move 'P'                    to ch-approval-status
  6988
  6989     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  6990                                    CH-VOID-DT
  6991                                    CH-CREDIT-ACCEPT-DT
  6992                                    CH-CANC-DT
  6993                                    ch-approval-dt
  6994                                    ch-check-cashed-dt
  6995     MOVE ZEROS                  TO CH-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 124
* EL677.cbl
  6996                                    CH-AH-REFUND
  6997*                                   CH-DEDUCT-WITHHELD
  6998*                                   CH-ADDITIONAL-CHARGE.
  6999
  7000     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7001
  7002     if pi-prev-paid not numeric
  7003        move zeros               to pi-prev-paid
  7004     end-if
  7005     if pi-prev-paid-this-month not numeric
  7006        move zeros               to pi-prev-paid-this-month
  7007     end-if
  7008     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7009       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7010        EIBAID NOT = DFHPF4)
  7011         GO TO 8200-SEND-DATAONLY.
  7012
  7013     add ch-amount-paid to pi-prev-paid
  7014     MOVE PI-CR-MONTH-END-DT     TO CH-CREDIT-SELECT-DT.
  7015     MOVE PI-CR-CARRIER          TO CH-COMP-CARRIER.
  7016     MOVE PI-CR-GROUPING         TO CH-COMP-GROUPING.
  7017     MOVE PI-CR-FIN-RESP         TO CH-COMP-FIN-RESP.
  7018     MOVE PI-CR-ACCOUNT          TO CH-COMP-ACCOUNT.
  7019     move pi-am-csr              to ch-csr
  7020     .
  7021 2100-WRITE-RECORD.
  7022
  7023* exec cics read
  7024*       dataset    (erchek-file-id)
  7025*       into       (ws-dummy-erchek)
  7026*       ridfld     (ch-control-primary)
  7027*       resp       (ws-response)
  7028*    end-exec
  7029     MOVE LENGTH OF
  7030      ws-dummy-erchek
  7031       TO DFHEIV11
  7032*    MOVE '&"IL       E          (  N#00006722' TO DFHEIV0
  7033     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7034     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7035     MOVE X'204E233030303036373232' TO DFHEIV0(25:11)
  7036     CALL 'kxdfhei1' USING DFHEIV0,
  7037           erchek-file-id,
  7038           ws-dummy-erchek,
  7039           DFHEIV11,
  7040           ch-control-primary,
  7041           DFHEIV99,
  7042           DFHEIV99,
  7043           DFHEIV99
  7044     MOVE EIBRESP  TO ws-response
  7045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7046     if RESP-NOTFND
  7047        continue
  7048     else
  7049        add +1 to ch-sequence-no
  7050        add 1 to seqi
  7051        go to 2100-write-record
  7052     end-if
  7053     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 125
* EL677.cbl
  7054
  7055* EXEC CICS HANDLE CONDITION
  7056*        DUPREC (2200-DUPREC)
  7057*    END-EXEC.
  7058*    MOVE '"$%                   ! ( #00006736' TO DFHEIV0
  7059     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7060     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7061     MOVE X'2820233030303036373336' TO DFHEIV0(25:11)
  7062     CALL 'kxdfhei1' USING DFHEIV0
  7063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7064
  7065
  7066     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  7067     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  7068                                    CH-CHECK-QUE-SEQUENCE
  7069
  7070
  7071* EXEC CICS WRITE
  7072*        DATASET  (ERCHEK-FILE-ID)
  7073*        FROM     (CHECK-RECORDS)
  7074*        RIDFLD   (CH-CONTROL-PRIMARY)
  7075*        resp     (ws-response)
  7076*    END-EXEC.
  7077     MOVE LENGTH OF
  7078      CHECK-RECORDS
  7079       TO DFHEIV11
  7080*    MOVE '&$ L                  ''  N#00006744' TO DFHEIV0
  7081     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7082     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7083     MOVE X'204E233030303036373434' TO DFHEIV0(25:11)
  7084     CALL 'kxdfhei1' USING DFHEIV0,
  7085           ERCHEK-FILE-ID,
  7086           CHECK-RECORDS,
  7087           DFHEIV11,
  7088           CH-CONTROL-PRIMARY,
  7089           DFHEIV99,
  7090           DFHEIV99
  7091     MOVE EIBRESP  TO ws-response
  7092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7093
  7094     if resp-normal and pi-check-type = 'C'
  7095        move 'Y'                 to pi-check-cut
  7096     end-if
  7097     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  7098             ERCHEK-RECORD-LENGTH + 23.
  7099
  7100     if pi-check-type not = 'C'
  7101        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7102                                 THRU 6200-EXIT
  7103        if resp-normal
  7104           MOVE 'Y'              TO PB-C-REFUND-SW
  7105           add +1 to pi-chek-rec-cnt
  7106           perform 6210-rewrite-pndb
  7107                                 thru 6210-exit
  7108*          PERFORM 2700-WRITE-SQL THRU 2700-EXIT
  7109        end-if
  7110     end-if
  7111     IF EMI-NO-ERRORS
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 126
* EL677.cbl
  7112         MOVE ER-0000            TO EMI-ERROR
  7113     ELSE
  7114         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7115            EIBAID = DFHPF4
  7116             MOVE ER-2600        TO EMI-ERROR.
  7117
  7118     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7119
  7120     MOVE LOW-VALUES             TO EL677AI.
  7121
  7122     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7123     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7124     MOVE PI-CHEK-STATE          TO STATEO.
  7125     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7126
  7127     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7128     MOVE SPACE                  TO DC-OPTION-CODE.
  7129     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7130     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7131
  7132     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7133     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7134     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7135
  7136     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7137                                    ACCTA     EFFDTA  CERTNOA
  7138                                    SFXA.
  7139     MOVE AL-UNNON               TO SEQA.
  7140     go to 5000-browse-file
  7141     GO TO 8100-SEND-INITIAL-MAP.
  7142
  7143 2200-DUPREC.
  7144     ADD +1 TO CH-SEQUENCE-NO.
  7145     MOVE CH-SEQUENCE-NO         TO SEQO
  7146                                    PI-CHEK-SEQUENCE
  7147                                    CHEK-RECORD-SEQ.
  7148     GO TO 2100-WRITE-RECORD.
  7149 2700-WRITE-SQL.
  7150     perform 2710-build-rec      thru 2710-exit
  7151     perform 2720-insert-row     thru 2720-exit
  7152     perform 4300-FINISH-UP-DB   thru 4300-exit
  7153     .
  7154 2700-EXIT.
  7155     EXIT.
  7156 2710-BUILD-REC.
  7157     move spaces                 to daily-check-request-rec
  7158     move pi-company-id          to db-compid
  7159     move ch-carrier             to db-carrier
  7160                                    db-fincar
  7161     move ch-grouping            to db-grouping
  7162                                    db-fingrp
  7163     move ch-state               to db-state
  7164     move ch-account             to db-account
  7165     move ch-cert-eff-dt         to dc-bin-date-1
  7166     move ' '                    to dc-option-code
  7167     perform 8500-date-convert   thru 8500-exit
  7168     if no-conversion-error
  7169        move dc-greg-date-a-edit to db-effdate
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 127
* EL677.cbl
  7170     else
  7171        move spaces              to db-effdate
  7172     end-if
  7173     move ch-cert-prime          to db-certificate
  7174     move ch-cert-sfx            to db-cert-sfx
  7175     move ch-sequence-no         to db-seq-no
  7176     move '1'                    to db-type
  7177                                    db-check-sub-type
  7178     if pi-check-type = 'C'
  7179        move '2'                 to db-check-sub-type
  7180     end-if
  7181     move ch-amount-paid         to db-amount-n
  7182     move zeros                  to db-checkstatus
  7183     move ch-check-que-control   to db-releasebatch
  7184     move save-bin-date          to dc-bin-date-1
  7185     move ' '                    to dc-option-code
  7186     perform 8500-date-convert   thru 8500-exit
  7187     if no-conversion-error
  7188        move dc-greg-date-a-edit to db-releasedt
  7189     else
  7190        move spaces              to db-releasedt
  7191     end-if
  7192     move pi-processor-id        to db-releaseby
  7193     move ch-payee-name-1        to db-payeename1
  7194     move ch-payee-name-2        to db-payeename2
  7195     move ch-payee-address-1     to db-payeeaddr1
  7196     move ch-payee-address-2     to db-payeeaddr2
  7197     move ch-payee-city          to db-payeecity
  7198     move ch-payee-state         to db-payeest
  7199     move ch-payee-zip-code      to db-payeezip
  7200     move ch-comp-fin-resp       to db-finresp
  7201     move ch-comp-account        to db-finacct
  7202     move ch-recorded-by         to db-preparer
  7203     move ch-return-to           to db-return-to
  7204     move pi-table-name          to db-insured-name
  7205     .
  7206 2710-EXIT.
  7207     EXIT.
  7208 2720-INSERT-ROW.
  7209     if not connected-to-db
  7210        perform 4100-CONNECT-TO-DB
  7211                                 thru 4100-exit
  7212     end-if
  7213     EXEC SQL
  7214        INSERT into ChkApp_Check (
  7215           Company,
  7216           CertCarrier,
  7217           CertGroup,
  7218           CertState,
  7219           CertAccount,
  7220           CertEffDate,
  7221           CertNumber,
  7222           CertNumberSuf,
  7223           CheckSeqNbr,
  7224           CheckType,
  7225           CheckAmount,
  7226           ReleaseBatchNbr,
  7227           ReleaseDate,
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 128
* EL677.cbl
  7228           ReleasedBy,
  7229           PayeeName1,
  7230           PayeeName2,
  7231           PayeeAddress1,
  7232           PayeeAddress2,
  7233           PayeeCity,
  7234           PayeeState,
  7235           PayeeZip,
  7236           CompCarrier,
  7237           CompGroup,
  7238           CompFinResp,
  7239           CompAccount,
  7240           Preparer,
  7241           ReturnTo,
  7242           InsuredName,
  7243           CheckSubType)
  7244         VALUES (
  7245           :DB-CompId,
  7246           :DB-Carrier,
  7247           :DB-Grouping,
  7248           :DB-State,
  7249           :DB-Account,
  7250           :DB-EffDate,
  7251           :DB-Certificate,
  7252           :db-cert-sfx,
  7253           :DB-Seq-No,
  7254           :DB-Type,
  7255           :db-amount,
  7256           :db-releasebatch,
  7257           :db-releasedt,
  7258           :db-releaseby,
  7259           :db-payeename1,
  7260           :db-payeename2,
  7261           :db-payeeaddr1,
  7262           :db-payeeaddr2,
  7263           :db-payeecity,
  7264           :db-payeest,
  7265           :db-payeezip,
  7266           :db-fincar,
  7267           :db-fingrp,
  7268           :db-finresp,
  7269           :db-finacct,
  7270           :db-preparer,
  7271           :db-return-to,
  7272           :db-insured-name,
  7273           :db-check-sub-type)
  7274     END-EXEC
  7275*    display ' db-compid     ' db-compid
  7276*    display ' db-carrier    ' db-carrier
  7277*    display ' db-group      ' db-grouping
  7278*    display ' db state      ' db-state
  7279*    display ' accounbt      ' db-account
  7280*    display ' effdt         ' db-effdate
  7281*    display ' cert          ' db-certificate
  7282*    display ' suffix        ' db-cert-sfx
  7283*    display ' seq no        ' db-seq-no
  7284*    display ' type          ' db-type
  7285     if sqlcode = -2601
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 129
* EL677.cbl
  7286        add +1                   to ch-sequence-no
  7287        move ch-sequence-no      to DB-Seq-No
  7288        go to 2720-insert-row
  7289     end-if
  7290     if sqlcode not = 0
  7291        display "Error: cannot insert row "
  7292        display ' sql return code ' sqlcode
  7293        move sqlcode to ws-sql-code
  7294        move ws-sql-code to ws-dis-sql-code
  7295        display ' dis sql code ' ws-dis-sql-code
  7296        display ' sql err mess    ' sqlerrmc
  7297        move sqlcode to ws-sql-code
  7298        move ws-sql-code to ws-dis-sql-code
  7299        string ws-dis-sql-code ' ' sqlerrmc (1:50)
  7300           into EMI-MESSAGE-AREA (1)
  7301        end-string
  7302        display ' msga1 ' emi-message-area (1)
  7303        perform 4300-FINISH-UP-DB thru 4300-exit
  7304        go to 8200-send-dataonly
  7305*       goback
  7306     end-if
  7307     .
  7308 2720-EXIT.
  7309     EXIT.
  7310 3000-CHANGE-RECORD.
  7311
  7312* EXEC CICS HANDLE CONDITION
  7313*        NOTFND (3900-RECORD-NOTFND)
  7314*    END-EXEC.
  7315*    MOVE '"$I                   ! ) #00006968' TO DFHEIV0
  7316     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7317     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7318     MOVE X'2920233030303036393638' TO DFHEIV0(25:11)
  7319     CALL 'kxdfhei1' USING DFHEIV0
  7320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7321
  7322
  7323
  7324* EXEC CICS READ
  7325*        DATASET  (ERCHEK-FILE-ID)
  7326*        SET      (ADDRESS OF CHECK-RECORDS)
  7327*        RIDFLD   (PI-ERCHEK-KEY)
  7328*        UPDATE
  7329*    END-EXEC.
  7330*    MOVE '&"S        EU         (   #00006972' TO DFHEIV0
  7331     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7332     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7333     MOVE X'2020233030303036393732' TO DFHEIV0(25:11)
  7334     CALL 'kxdfhei1' USING DFHEIV0,
  7335           ERCHEK-FILE-ID,
  7336           DFHEIV20,
  7337           DFHEIV99,
  7338           PI-ERCHEK-KEY,
  7339           DFHEIV99,
  7340           DFHEIV99,
  7341           DFHEIV99
  7342     SET ADDRESS OF CHECK-RECORDS TO
  7343         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 130
* EL677.cbl
  7344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7345
  7346
  7347     IF CH-LF-REFUND NOT NUMERIC
  7348         MOVE ZEROS              TO CH-LF-REFUND.
  7349     IF CH-AH-REFUND NOT NUMERIC
  7350         MOVE ZEROS              TO CH-AH-REFUND.
  7351*    IF CH-DEDUCT-WITHHELD NOT NUMERIC
  7352*        MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  7353*    IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  7354*        MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  7355
  7356     IF VREASONL NOT = ZEROS
  7357         MOVE VREASONI           TO  CH-VOID-REASON.
  7358
  7359     IF MAINTI = 'V' or 'R'
  7360        GO TO 3050-void-processing
  7361     end-if
  7362
  7363     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  7364
  7365     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7366
  7367     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7368       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7369        EIBAID NOT = DFHPF4)
  7370         GO TO 8200-SEND-DATAONLY.
  7371     go to 3100-rewrite-record
  7372     .
  7373 3050-void-processing.
  7374     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7375     if sqlcode = 0
  7376        perform 4200-get-tbl-row thru 4200-exit
  7377        if sqlcode = 0
  7378           if nu-app-date = -1
  7379              move -1            to maintl
  7380              move er-3453       to emi-error
  7381              move al-uabon      to mainta
  7382              perform 9900-error-format
  7383                                 thru 9900-exit
  7384              perform 4300-FINISH-UP-DB thru 4300-exit
  7385              go to 8200-send-dataonly
  7386           end-if
  7387        end-if
  7388        if connected-to-db
  7389           perform 4300-FINISH-UP-DB thru 4300-exit
  7390        end-if
  7391     end-if
  7392     if (ch-check-written-dt = low-values)
  7393        or (ch-check-no = spaces)
  7394        move -1                  to maintl
  7395        move er-3455             to emi-error
  7396        move al-uabon            to mainta
  7397        perform 9900-error-format
  7398                                 thru 9900-exit
  7399        perform 4300-FINISH-UP-DB thru 4300-exit
  7400        go to 8200-send-dataonly
  7401     end-if
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 131
* EL677.cbl
  7402     .
  7403 3100-REWRITE-RECORD.
  7404     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  7405
  7406     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7407     MOVE '5'                    TO DC-OPTION-CODE.
  7408     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7409
  7410     IF MAINTI = 'C'
  7411       MOVE PI-PROCESSOR-ID      TO CH-RECORDED-BY
  7412     end-if
  7413     IF MAINTI = 'V' or 'R'
  7414        IF (CH-VOID-DT = LOW-VALUES)
  7415           and (pi-check-cashed = spaces)
  7416           MOVE PI-PROCESSOR-ID  TO CH-VOID-BY
  7417           MOVE DC-BIN-DATE-1    TO CH-VOID-DT
  7418           PERFORM 3200-PAY-ADJS-REVERSAL      THRU 3290-EXIT
  7419           if pi-chek-rec-cnt = +1
  7420              PERFORM 6200-UPDATE-PENDING-BUS-REC
  7421                                 THRU 6200-EXIT
  7422              if resp-normal
  7423                 MOVE ' '        TO PB-C-REFUND-SW
  7424                 perform 6210-rewrite-pndb
  7425                                 thru 6210-exit
  7426              end-if
  7427           end-if
  7428        ELSE
  7429           MOVE -1               TO MAINTL
  7430           MOVE ER-2583          TO EMI-ERROR
  7431           MOVE AL-UABON         TO MAINTA
  7432           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7433           GO TO 8200-SEND-DATAONLY
  7434        end-if
  7435     end-if
  7436
  7437     MOVE CH-AMOUNT-PAID         TO WS-SV-AMOUNT-PAID.
  7438
  7439
  7440* EXEC CICS REWRITE
  7441*        DATASET  (ERCHEK-FILE-ID)
  7442*        FROM     (CHECK-RECORDS)
  7443*    END-EXEC.
  7444     MOVE LENGTH OF
  7445      CHECK-RECORDS
  7446       TO DFHEIV11
  7447*    MOVE '&& L                  %   #00007071' TO DFHEIV0
  7448     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7449     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7450     MOVE X'2020233030303037303731' TO DFHEIV0(25:11)
  7451     CALL 'kxdfhei1' USING DFHEIV0,
  7452           ERCHEK-FILE-ID,
  7453           CHECK-RECORDS,
  7454           DFHEIV11,
  7455           DFHEIV99
  7456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7457
  7458
  7459     IF (PI-COMPANY-ID EQUAL 'LGX' OR 'TMS') AND
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 132
* EL677.cbl
  7460        (MAINTI EQUAL 'C')          AND
  7461        (PI-PAYTO1 NOT EQUAL PAYTO1I)
  7462            PERFORM 3300-UPDATE-ERPYAJ THRU 3390-EXIT.
  7463
  7464     IF EMI-NO-ERRORS
  7465         MOVE ER-0000            TO EMI-ERROR
  7466     ELSE
  7467         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7468            EIBAID = DFHPF4
  7469             MOVE ER-2600        TO EMI-ERROR.
  7470     if mainti = 'R'
  7471        if pi-void-reissue-pass = ' '
  7472           move '1'              to pi-void-reissue-pass
  7473        MOVE ER-3274             TO EMI-ERROR
  7474        end-if
  7475     end-if
  7476     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7477
  7478     MOVE LOW-VALUES             TO EL677AI.
  7479
  7480     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7481     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7482     MOVE PI-CHEK-STATE          TO STATEO.
  7483     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7484
  7485     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7486     MOVE SPACE                  TO DC-OPTION-CODE.
  7487     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7488     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7489
  7490     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7491     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7492     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7493
  7494     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7495                                     ACCTA   EFFDTA
  7496                                    CERTNOA   SFXA.
  7497
  7498     MOVE AL-UNNON               TO SEQA.
  7499     go to 5000-browse-file
  7500*    GO TO 8100-SEND-INITIAL-MAP.
  7501
  7502     .
  7503 3200-PAY-ADJS-REVERSAL.
  7504
  7505     IF CH-AMOUNT-PAID NOT = ZEROS
  7506         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7507         PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7508
  7509     GO TO 3290-EXIT
  7510     .
  7511 3250-BUILD-ERPYAJ-REVERSAL.
  7512
  7513
  7514* EXEC CICS GETMAIN
  7515*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7516*        LENGTH  (200)
  7517*        INITIMG (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 133
* EL677.cbl
  7518*    END-EXEC.
  7519     MOVE 200
  7520       TO DFHEIV11
  7521*    MOVE ',"IL                  $   #00007130' TO DFHEIV0
  7522     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7523     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7524     MOVE X'2020233030303037313330' TO DFHEIV0(25:11)
  7525     CALL 'kxdfhei1' USING DFHEIV0,
  7526           DFHEIV20,
  7527           DFHEIV11,
  7528           GETMAIN-SPACE
  7529     SET ADDRESS OF PENDING-PAY-ADJ TO
  7530         DFHEIV20
  7531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7532
  7533
  7534     MOVE 'PY'                   TO PY-RECORD-ID.
  7535     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7536
  7537     MOVE CH-COMP-CARRIER        TO PY-CARRIER.
  7538     IF PI-ZERO-CARRIER  OR
  7539        PI-ZERO-CAR-GROUP
  7540         MOVE ZERO               TO PY-CARRIER.
  7541
  7542     MOVE CH-COMP-GROUPING       TO PY-GROUPING.
  7543     IF PI-ZERO-GROUPING  OR
  7544        PI-ZERO-CAR-GROUP
  7545         MOVE ZERO               TO PY-GROUPING.
  7546
  7547     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7548     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7549     MOVE 'R'                    TO PY-RECORD-TYPE.
  7550     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7551     move '1825011300'           to py-gl-account
  7552     move 'VOID REFCK'           TO py-gl-comment
  7553     move ch-amount-paid         to py-entry-amt
  7554*    COMPUTE PY-ENTRY-AMT = CH-AMOUNT-PAID * -1.
  7555
  7556     MOVE CH-CHECK-NO            TO WS-CHECK-WORK
  7557     MOVE WS-CHECK-NO            TO PY-CHECK-NUMBER.
  7558
  7559     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7560     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7561     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7562                                    PY-INPUT-DT.
  7563*    MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  7564*                                   PY-CHECK-QUE-SEQUENCE.
  7565     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7566                                    PY-BILLED-DATE
  7567                                    PY-REPORTED-DT
  7568                                    PY-CHECK-WRITTEN-DT
  7569                                    PY-AR-DATE
  7570                                    PY-GL-DATE.
  7571     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7572     MOVE CH-CHECK-ORIGIN-SW     TO PY-CHECK-ORIGIN-SW.
  7573*    MOVE 'V'                    TO PY-VOID-SW.
  7574*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7575
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 134
* EL677.cbl
  7576     IF PI-AR-PROCESSING
  7577         MOVE 'B'                TO PY-PYMT-TYPE
  7578         MOVE 'A'                TO PY-PMT-APPLIED.
  7579
  7580 3259-BUILD-EXIT.
  7581     EXIT.
  7582
  7583 3280-WRITE-ERPYAJ-REVERSAL.
  7584
  7585
  7586* EXEC CICS HANDLE CONDITION
  7587*        DUPREC (3287-DUPREC)
  7588*    END-EXEC.
  7589*    MOVE '"$%                   ! * #00007187' TO DFHEIV0
  7590     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7591     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7592     MOVE X'2A20233030303037313837' TO DFHEIV0(25:11)
  7593     CALL 'kxdfhei1' USING DFHEIV0
  7594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7595
  7596
  7597
  7598* EXEC CICS WRITE
  7599*        DATASET (ERPYAJ-FILE-ID)
  7600*        FROM    (PENDING-PAY-ADJ)
  7601*        RIDFLD  (PY-CONTROL-PRIMARY)
  7602*    END-EXEC.
  7603     MOVE LENGTH OF
  7604      PENDING-PAY-ADJ
  7605       TO DFHEIV11
  7606*    MOVE '&$ L                  ''   #00007191' TO DFHEIV0
  7607     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7608     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7609     MOVE X'2020233030303037313931' TO DFHEIV0(25:11)
  7610     CALL 'kxdfhei1' USING DFHEIV0,
  7611           ERPYAJ-FILE-ID,
  7612           PENDING-PAY-ADJ,
  7613           DFHEIV11,
  7614           PY-CONTROL-PRIMARY,
  7615           DFHEIV99,
  7616           DFHEIV99
  7617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7618
  7619
  7620     GO TO 3289-WRITE-EXIT.
  7621
  7622 3287-DUPREC.
  7623     ADD +1 TO PY-FILE-SEQ-NO.
  7624
  7625     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7626
  7627 3289-WRITE-EXIT.
  7628     EXIT.
  7629
  7630 3290-EXIT.
  7631      EXIT.
  7632
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 135
* EL677.cbl
  7634 3300-UPDATE-ERPYAJ.
  7635
  7636
  7637* EXEC CICS GETMAIN
  7638*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7639*        LENGTH  (200)
  7640*        INITIMG (GETMAIN-SPACE)
  7641*    END-EXEC.
  7642     MOVE 200
  7643       TO DFHEIV11
  7644*    MOVE ',"IL                  $   #00007213' TO DFHEIV0
  7645     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7646     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7647     MOVE X'2020233030303037323133' TO DFHEIV0(25:11)
  7648     CALL 'kxdfhei1' USING DFHEIV0,
  7649           DFHEIV20,
  7650           DFHEIV11,
  7651           GETMAIN-SPACE
  7652     SET ADDRESS OF PENDING-PAY-ADJ TO
  7653         DFHEIV20
  7654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7655
  7656
  7657     MOVE PI-COMPANY-CD          TO PYAJ-COMPANY-CD.
  7658     MOVE PI-CHEK-CARRIER        TO PYAJ-CARRIER.
  7659     MOVE PI-CHEK-GROUPING       TO PYAJ-GROUPING.
  7660     MOVE PI-CR-FIN-RESP         TO PYAJ-FIN-RESP.
  7661     MOVE PI-CR-ACCOUNT          TO PYAJ-ACCOUNT.
  7662     MOVE 'C'                    TO PYAJ-RECORD-TYPE.
  7663     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO.
  7664
  7665
  7666* EXEC CICS HANDLE CONDITION
  7667*        NOTFND   (3390-EXIT)
  7668*        ENDFILE  (3390-EXIT)
  7669*    END-EXEC.
  7670*    MOVE '"$I''                  ! + #00007227' TO DFHEIV0
  7671     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7673     MOVE X'2B20233030303037323237' TO DFHEIV0(25:11)
  7674     CALL 'kxdfhei1' USING DFHEIV0
  7675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7676
  7677
  7678 3320-READNEXT-ERPYAJ.
  7679
  7680
  7681* EXEC CICS READ
  7682*        DATASET  (ERPYAJ-FILE-ID)
  7683*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  7684*        RIDFLD   (ERPYAJ-KEY)
  7685*        GTEQ
  7686*    END-EXEC.
  7687*    MOVE '&"S        G          (   #00007234' TO DFHEIV0
  7688     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7689     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7690     MOVE X'2020233030303037323334' TO DFHEIV0(25:11)
  7691     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 136
* EL677.cbl
  7692           ERPYAJ-FILE-ID,
  7693           DFHEIV20,
  7694           DFHEIV99,
  7695           ERPYAJ-KEY,
  7696           DFHEIV99,
  7697           DFHEIV99,
  7698           DFHEIV99
  7699     SET ADDRESS OF PENDING-PAY-ADJ TO
  7700         DFHEIV20
  7701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7702
  7703
  7704     MOVE PY-CONTROL-PRIMARY TO ERPYAJ-KEY.
  7705
  7706     IF (PI-COMPANY-CD    NOT = PY-COMPANY-CD) OR
  7707        (PI-CHEK-CARRIER  NOT = PY-CARRIER)    OR
  7708        (PI-CHEK-GROUPING NOT = PY-GROUPING)   OR
  7709        (PI-CR-FIN-RESP   NOT = PY-FIN-RESP)   OR
  7710        (PI-CR-ACCOUNT    NOT = PY-ACCOUNT)    OR
  7711        (PY-RECORD-TYPE   NOT = 'C')
  7712          GO TO 3390-EXIT.
  7713
  7714     IF WS-SV-AMOUNT-PAID NOT EQUAL PY-ENTRY-AMT
  7715         ADD +1 TO PYAJ-FILE-SEQ-NO
  7716         GO TO 3320-READNEXT-ERPYAJ.
  7717
  7718
  7719* EXEC CICS READ UPDATE
  7720*        DATASET   (ERPYAJ-FILE-ID)
  7721*        RIDFLD    (ERPYAJ-KEY)
  7722*        SET       (ADDRESS OF PENDING-PAY-ADJ)
  7723*    END-EXEC.
  7724*    MOVE '&"S        EU         (   #00007255' TO DFHEIV0
  7725     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7726     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7727     MOVE X'2020233030303037323535' TO DFHEIV0(25:11)
  7728     CALL 'kxdfhei1' USING DFHEIV0,
  7729           ERPYAJ-FILE-ID,
  7730           DFHEIV20,
  7731           DFHEIV99,
  7732           ERPYAJ-KEY,
  7733           DFHEIV99,
  7734           DFHEIV99,
  7735           DFHEIV99
  7736     SET ADDRESS OF PENDING-PAY-ADJ TO
  7737         DFHEIV20
  7738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7739
  7740
  7741     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7742     MOVE CERTNOI                TO WS-TMS-PY-CERT.
  7743
  7744     MOVE WS-TMS-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  7745
  7746     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7747     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7748     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7749
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 137
* EL677.cbl
  7750
  7751* EXEC CICS REWRITE
  7752*        DATASET  (ERPYAJ-FILE-ID)
  7753*        FROM     (PENDING-PAY-ADJ)
  7754*    END-EXEC.
  7755     MOVE LENGTH OF
  7756      PENDING-PAY-ADJ
  7757       TO DFHEIV11
  7758*    MOVE '&& L                  %   #00007270' TO DFHEIV0
  7759     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7760     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7761     MOVE X'2020233030303037323730' TO DFHEIV0(25:11)
  7762     CALL 'kxdfhei1' USING DFHEIV0,
  7763           ERPYAJ-FILE-ID,
  7764           PENDING-PAY-ADJ,
  7765           DFHEIV11,
  7766           DFHEIV99
  7767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7768
  7769
  7770 3390-EXIT.
  7771      EXIT.
  7772
  7773 3400-delete-record.
  7774
  7775* EXEC CICS READ
  7776*        DATASET  (ERCHEK-FILE-ID)
  7777*        SET      (ADDRESS OF CHECK-RECORDS)
  7778*        RIDFLD   (PI-ERCHEK-KEY)
  7779*        UPDATE
  7780*        resp     (ws-response)
  7781*    END-EXEC
  7782*    MOVE '&"S        EU         (  N#00007279' TO DFHEIV0
  7783     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7784     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7785     MOVE X'204E233030303037323739' TO DFHEIV0(25:11)
  7786     CALL 'kxdfhei1' USING DFHEIV0,
  7787           ERCHEK-FILE-ID,
  7788           DFHEIV20,
  7789           DFHEIV99,
  7790           PI-ERCHEK-KEY,
  7791           DFHEIV99,
  7792           DFHEIV99,
  7793           DFHEIV99
  7794     SET ADDRESS OF CHECK-RECORDS TO
  7795         DFHEIV20
  7796     MOVE EIBRESP  TO ws-response
  7797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7798     if (ch-in-limbo or ch-approv-pending)
  7799        and (ch-void-dt = low-values)
  7800        and (ch-check-written-dt = low-values)
  7801        and (ch-credit-accept-dt = low-values)
  7802        perform 3500-check-tbl   thru 3500-exit
  7803        if (row-deleted and tbl-commited)
  7804*          or (emi-error = er-3450)
  7805
  7806* exec cics delete
  7807*             dataset   (erchek-file-id)
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 138
* EL677.cbl
  7808*          end-exec
  7809*    MOVE '&(                    &   #00007293' TO DFHEIV0
  7810     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7811     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7812     MOVE X'2020233030303037323933' TO DFHEIV0(25:11)
  7813     CALL 'kxdfhei1' USING DFHEIV0,
  7814           erchek-file-id,
  7815           DFHEIV99,
  7816           DFHEIV99,
  7817           DFHEIV99,
  7818           DFHEIV99
  7819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7820           move spaces to pi-check-cut
  7821        end-if
  7822     else
  7823        move -1               to maintl
  7824        move er-3452          to emi-error
  7825        move al-uabon         to mainta
  7826        perform 9900-error-format
  7827                                 thru 9900-exit
  7828        go to 8200-send-dataonly
  7829     end-if
  7830     if pi-chek-rec-cnt = +1
  7831        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7832                                 THRU 6200-EXIT
  7833        if resp-normal
  7834           MOVE ' '              TO PB-C-REFUND-SW
  7835           perform 6210-rewrite-pndb
  7836                                 thru 6210-exit
  7837        end-if
  7838     end-if
  7839     MOVE ER-0000            TO EMI-ERROR
  7840     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7841     MOVE LOW-VALUES             TO EL677AI.
  7842     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7843     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7844     MOVE PI-CHEK-STATE          TO STATEO.
  7845     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7846     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7847     MOVE SPACE                  TO DC-OPTION-CODE.
  7848     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7849     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7850     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7851     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7852     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7853     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7854                                    ACCTA   EFFDTA
  7855                                    CERTNOA   SFXA.
  7856     MOVE AL-UNNON               TO SEQA.
  7857     GO TO 8100-SEND-INITIAL-MAP
  7858     .
  7859 3400-exit.
  7860     exit.
  7861 3500-check-tbl.
  7862     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7863     if sqlcode = 0
  7864        perform 4200-get-tbl-row thru 4200-exit
  7865     end-if
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 139
* EL677.cbl
  7866      if sqlcode = 0
  7867         if (nu-app-date = -1)
  7868            or (db-app-status = '2')
  7869            perform 4250-delete-row thru 4250-exit
  7870         else
  7871           MOVE ER-3452            TO  EMI-ERROR
  7872           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7873           MOVE -1                 TO  PFENTERL
  7874           GO TO 8200-SEND-DATAONLY
  7875        end-if
  7876      else
  7877         MOVE ER-3450            TO  EMI-ERROR
  7878         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7879         MOVE -1                 TO  PFENTERL
  7880*        GO TO 8200-SEND-DATAONLY
  7881      end-if
  7882     if connected-to-db
  7883        perform 4300-FINISH-UP-DB thru 4300-exit
  7884     end-if
  7885     .
  7886 3500-exit.
  7887     exit.
  7888 3900-RECORD-NOTFND.
  7889     MOVE ER-2908                TO EMI-ERROR.
  7890     MOVE -1                     TO CARRIERL
  7891     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7892                                    ACCTA     EFFDTA  CERTNOA
  7893                                    SFXA      SEQA.
  7894     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7895     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 140
* EL677.cbl
  7897 4000-ADD-CHANGE.
  7898     IF PAYTO1L NOT = ZEROS
  7899        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  7900     END-IF
  7901
  7902     IF PAYTO2L NOT = ZEROS
  7903         MOVE PAYTO2I            TO CH-PAYEE-NAME-2.
  7904
  7905     IF PAYAD1L NOT = ZEROS
  7906         MOVE PAYAD1I            TO CH-PAYEE-ADDRESS-1.
  7907
  7908     IF PAYAD2L NOT = ZEROS
  7909         MOVE PAYAD2I            TO CH-PAYEE-ADDRESS-2.
  7910
  7911     IF PAYctyL NOT = ZEROS
  7912         MOVE payctyi            TO CH-PAYEE-CITY.
  7913
  7914     IF PAYstL NOT = ZEROS
  7915         MOVE paysti            TO CH-PAYEE-state.
  7916
  7917     IF PAYEEI GREATER SPACES
  7918        MOVE PAYEEI              TO CH-PAYEE-CODE.
  7919
  7920     IF PTOZIPL  =  ZEROS
  7921         MOVE ZEROS              TO CH-PAYEE-ZIP-CODE
  7922         GO TO 4000-CK-REST.
  7923
  7924     MOVE PTOZIPI                TO WS-ZIP-CODE.
  7925
  7926     IF NOT WS-CANADIAN-POST-CODE
  7927         MOVE WS-ZIP-PRIME       TO CH-PAYEE-ZIP
  7928         MOVE WS-ZIP-PLUS4       TO CH-PAYEE-ZIP-EXT
  7929         GO TO 4000-CK-REST.
  7930
  7931     MOVE SPACES                 TO CH-CANADIAN-POSTAL-CODE.
  7932     IF WS-CAN-POST-4TH = SPACE OR '-'
  7933         MOVE WS-CAN-POST2-1     TO CH-CAN-POSTAL-1
  7934         MOVE WS-CAN-POST2-2     TO CH-CAN-POSTAL-2
  7935     ELSE
  7936         MOVE WS-CAN-POST1-1     TO CH-CAN-POSTAL-1
  7937         MOVE WS-CAN-POST1-2     TO CH-CAN-POSTAL-2.
  7938
  7939 4000-CK-REST.
  7940
  7941     IF RETTOL NOT = ZEROS
  7942        MOVE RETTOI TO CH-RETURN-TO.
  7943     if dedcynl not = zeros
  7944        move dedcyni             to ch-deduct-commission
  7945     end-if
  7946*    if dedcynl not = zeros
  7947*       if (dedcyni = 'Y')
  7948*          or (pi-prev-ded-comm = 'Y')
  7949*          compute ws-amt =
  7950*             pi-refund-on-pending-rec -
  7951*                pi-prev-paid - pi-ue-comm
  7952*       else
  7953*          if dedcyni = 'N'
  7954*             compute ws-amt =
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 141
* EL677.cbl
  7955*                pi-refund-on-pending-rec -
  7956*                   pi-prev-paid-this-month
  7957*          end-if
  7958*       end-if
  7959*    end-if
  7960     if pi-check-type = 'C'
  7961        compute ws-amt =
  7962           pi-endt-prm-diff - pi-prev-paid
  7963        if (dedcyni = 'Y')
  7964           or (pi-prev-ded-comm = 'Y')
  7965           compute ws-amt =
  7966              ws-amt - pi-ue-comm
  7967        end-if
  7968        if ws-amt <= zeros
  7969           move pi-endt-prm-diff to ws-amt
  7970        end-if
  7971     end-if
  7972     IF AMOUNTL NOT = ZEROS
  7973         MOVE WS-AMT             TO CH-AMOUNT-PAID
  7974         MOVE CH-AMOUNT-PAID     TO AMOUNTO.
  7975
  7976     IF CHECKL NOT = ZEROS
  7977         MOVE CHECKI             TO CH-CHECK-NO.
  7978
  7979     IF REASONL NOT = ZEROS
  7980         MOVE REASONI            TO CH-REASON-FOR-CHECK.
  7981
  7982*    IF DEDAMTL NOT = ZEROS
  7983*        MOVE WS-DED             TO CH-DEDUCT-WITHHELD
  7984*                                   DEDAMTO.
  7985
  7986*    IF ADDLCHGL NOT = ZEROS
  7987*        MOVE WS-ADDL            TO CH-ADDITIONAL-CHARGE
  7988*                                   ADDLCHGO.
  7989
  7990     IF STUBL NOT = ZEROS
  7991         MOVE STUBI              TO CH-STUB-LINE-1.
  7992
  7993     IF TEXT1L NOT = ZEROS
  7994         MOVE TEXT1I             TO CH-TEXT-LINE-1.
  7995
  7996     IF TEXT2L NOT = ZEROS
  7997         MOVE TEXT2I             TO CH-TEXT-LINE-2.
  7998
  7999     IF TEXT3L NOT = ZEROS
  8000         MOVE TEXT3I             TO CH-TEXT-LINE-3.
  8001
  8002     IF TYPEL NOT = ZEROS
  8003         MOVE TYPEI              TO CH-CHECK-ORIGIN-SW.
  8004
  8005*    MOVE LETTER1I               TO CH-LETTERS (1).
  8006*    MOVE LETTER2I               TO CH-LETTERS (2).
  8007*    MOVE LETTER3I               TO CH-LETTERS (3).
  8008
  8009*    MOVE SPACES                 TO CH-CHECK-REFERENCE.
  8010     IF CH-CHECK-ORIGIN-SW = 'R'
  8011         PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  8012*        MOVE PI-REFERENCE           TO CH-CHECK-REFERENCE
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 142
* EL677.cbl
  8013         MOVE PI-CANC-DT             TO CH-CANC-DT
  8014         MOVE PI-LF-REFUND           TO CH-LF-REFUND
  8015         MOVE PI-AH-REFUND           TO CH-AH-REFUND
  8016     end-if
  8017     MOVE PI-INSURED-NAME        TO CH-INSURED-NAME.
  8018*    IF PI-AR-PROCESSING AND
  8019*       REFL NOT = ZERO
  8020*        MOVE REFI                   TO CH-CHECK-REFERENCE.
  8021
  8022 4000-EXIT.
  8023      EXIT.
  8024 4100-CONNECT-TO-DB.
  8025     move 'NTSQLTST2_ChkApprv'   to svr
  8026     move 'sa'                   to usr
  8027     move 'sql2008r2'            to pass
  8028
  8029     if ws-kix-myenv = 'cid1p'
  8030        move 'NTCSO2_ChkApprv'   to svr
  8031        move 'sa'                to usr
  8032        move 'ntcso2'            to pass
  8033     end-if
  8034     string
  8035         usr delimited space
  8036         "." delimited size
  8037         pass delimited space into usr-pass
  8038     end-string
  8039     EXEC SQL
  8040        CONNECT TO :svr USER :usr-pass
  8041     END-EXEC
  8042     if sqlcode not = 0
  8043        display "Error: cannot connect "
  8044        display sqlcode
  8045        display sqlerrmc
  8046     end-if
  8047     set connected-to-db to true
  8048     .
  8049 4100-EXIT.
  8050     EXIT.
  8051 4200-get-tbl-row.
  8052***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8053***                                                            ***
  8054***  I'm only expecting one row so no cursor is declared       ***
  8055***                                                            ***
  8056***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8057     move pi-company-id          to ws-compid
  8058     move ch-carrier             to ws-carrier
  8059     move ch-grouping            to ws-grouping
  8060     move ch-state               to ws-state
  8061     move ch-account             to ws-account
  8062     move ch-cert-eff-dt         to dc-bin-date-1
  8063     move ' '                    to dc-option-code
  8064     perform 8500-date-convert   thru 8500-exit
  8065     if no-conversion-error
  8066        move dc-greg-date-a-edit to ws-eff-date
  8067     end-if
  8068     move ch-cert-prime          to ws-certificate
  8069     move ch-cert-sfx            to ws-cert-sfx
  8070     move ch-sequence-no         to ws-seq-no
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 143
* EL677.cbl
  8071     move '1'                    to ws-type
  8072                                    ws-check-sub-type
  8073     if pi-check-type = 'C'
  8074        move '2'                 to ws-check-sub-type
  8075     end-if
  8076     exec sql
  8077        SELECT
  8078           ApprovalStatus,
  8079           MaintainedBy,
  8080           MaintainedDate,
  8081           ApprovalBatch
  8082        INTO
  8083           :db-app-status :nu-app-status,
  8084           :db-app-by :nu-app-by,
  8085           :db-app-date :nu-app-date,
  8086           :db-app-batch :nu-app-batch
  8087        FROM
  8088           ChkApp_Check
  8089        WHERE
  8090           Company           = :ws-compid
  8091           and CertCarrier   = :ws-carrier
  8092           and CertGroup     = :ws-grouping
  8093           and CertState     = :ws-state
  8094           and CertAccount   = :ws-account
  8095           and CertEffDate   = :ws-eff-date
  8096           and CertNumber    = :ws-certificate
  8097           and CertNumberSuf = :ws-cert-sfx
  8098           and CheckSeqNbr   = :ws-seq-no
  8099           and CheckType     = :ws-type
  8100           and CheckSubType  = :ws-check-sub-type
  8101     end-exec
  8102     if sqlcode not = 0
  8103        display "Error: cannot read row "
  8104        display ' sql return code ' sqlcode
  8105        display ' sql err mess    ' sqlerrmc
  8106        go to 4200-exit
  8107     end-if
  8108*    display ' status ' db-app-status
  8109*    display ' by     ' db-app-by
  8110*    display ' date   ' db-app-date
  8111*    display ' batch  ' db-app-batch
  8112*    if nu-app-date = -1
  8113*       display ' approval date is low-values '
  8114*    else
  8115*       display ' approval date is NOT low values '
  8116*    end-if
  8117     .
  8118 4200-exit.
  8119     exit.
  8120 4250-delete-row.
  8121     EXEC SQL
  8122        DELETE
  8123           from ChkApp_Check
  8124        WHERE
  8125           Company           = :ws-compid
  8126           and CertCarrier   = :ws-carrier
  8127           and CertGroup     = :ws-grouping
  8128           and CertState     = :ws-state
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 144
* EL677.cbl
  8129           and CertAccount   = :ws-account
  8130           and CertEffDate   = :ws-eff-date
  8131           and CertNumber    = :ws-certificate
  8132           and CertNumberSuf = :ws-cert-sfx
  8133           and CheckSeqNbr   = :ws-seq-no
  8134           and CheckType     = :ws-type
  8135           and CheckSubType  = :ws-check-sub-type
  8136     END-EXEC
  8137     if sqlcode not = 0
  8138        display "Error: cannot delete row  "
  8139        display ' sql retrun code ' sqlcode
  8140        display ' sql err mess    ' sqlerrmc
  8141        go to 4250-exit
  8142     end-if
  8143     set row-deleted         to true
  8144     EXEC SQL
  8145         commit transaction
  8146     END-EXEC
  8147     if sqlcode not = 0
  8148        display "Error: commit "
  8149        display ' sql return code ' sqlcode
  8150        display ' sql err mess    ' sqlerrmc
  8151        go to 4250-exit
  8152     end-if
  8153     set tbl-commited to true
  8154     .
  8155 4250-exit.
  8156     exit.
  8157 4300-FINISH-UP-DB.
  8158     EXEC SQL
  8159         commit work release
  8160     END-EXEC
  8161     if sqlcode not = 0
  8162        display "Error: commit release "
  8163        display ' sql return code ' sqlcode
  8164        display ' sql err mess    ' sqlerrmc
  8165     end-if
  8166     .
  8167 4300-EXIT.
  8168     EXIT.
  8169 5000-BROWSE-FILE.
  8170
  8171* EXEC CICS HANDLE CONDITION
  8172*        NOTFND   (5560-END-OF-FILE)
  8173*        ENDFILE  (5560-END-OF-FILE)
  8174*    END-EXEC.
  8175*    MOVE '"$I''                  ! , #00007646' TO DFHEIV0
  8176     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8177     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8178     MOVE X'2C20233030303037363436' TO DFHEIV0(25:11)
  8179     CALL 'kxdfhei1' USING DFHEIV0
  8180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8181
  8182
  8183     MOVE PI-ERCHEK-KEY          TO ERCHEK-KEY.
  8184
  8185     IF SEQI = LOW-VALUES
  8186         MOVE +1                 TO CHEK-RECORD-SEQ.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 145
* EL677.cbl
  8187
  8188     IF EIBAID = DFHPF2
  8189         GO TO 5100-BROWSE-BKWD.
  8190
  8191 5010-READ-LOOP.
  8192     IF EIBAID = DFHPF1
  8193         ADD +1                  TO CHEK-RECORD-SEQ.
  8194
  8195
  8196* EXEC CICS READ
  8197*        DATASET  (ERCHEK-FILE-ID)
  8198*        SET      (ADDRESS OF CHECK-RECORDS)
  8199*        RIDFLD   (ERCHEK-KEY)
  8200*        GTEQ
  8201*    END-EXEC.
  8202*    MOVE '&"S        G          (   #00007663' TO DFHEIV0
  8203     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8204     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8205     MOVE X'2020233030303037363633' TO DFHEIV0(25:11)
  8206     CALL 'kxdfhei1' USING DFHEIV0,
  8207           ERCHEK-FILE-ID,
  8208           DFHEIV20,
  8209           DFHEIV99,
  8210           ERCHEK-KEY,
  8211           DFHEIV99,
  8212           DFHEIV99,
  8213           DFHEIV99
  8214     SET ADDRESS OF CHECK-RECORDS TO
  8215         DFHEIV20
  8216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8217
  8218
  8219     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8220         IF EIBAID = DFHENTER
  8221             GO TO 5550-NO-RECORD
  8222         ELSE
  8223             GO TO 5560-END-OF-FILE.
  8224
  8225        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8226           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8227           PI-CHEK-STATE      = CH-STATE       AND
  8228           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8229           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8230           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8231           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8232              GO TO 5500-FORMAT-SCREEN
  8233            ELSE
  8234              IF EIBAID = DFHPF1
  8235                  GO TO 5560-END-OF-FILE
  8236                ELSE
  8237                  GO TO 5550-NO-RECORD.
  8238
  8239     IF EIBAID = DFHENTER
  8240        IF CHEK-CARRIER    = CH-CARRIER     AND
  8241           CHEK-GROUPING   = CH-GROUPING    AND
  8242           CHEK-STATE      = CH-STATE       AND
  8243           CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8244           CHEK-EFF-DT     = CH-CERT-EFF-DT AND
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 146
* EL677.cbl
  8245           CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8246           CHEK-SUF-NO     = CH-CERT-SFX    AND
  8247           CHEK-RECORD-SEQ = CH-SEQUENCE-NO
  8248              GO TO 5500-FORMAT-SCREEN
  8249        ELSE
  8250              GO TO 5550-NO-RECORD.
  8251
  8252     GO TO 5500-FORMAT-SCREEN.
  8253
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 147
* EL677.cbl
  8255
  8256 5100-BROWSE-BKWD.
  8257
  8258* EXEC CICS STARTBR
  8259*        DATASET  (ERCHEK-FILE-ID)
  8260*        RIDFLD   (ERCHEK-KEY)
  8261*    END-EXEC.
  8262     MOVE 0
  8263       TO DFHEIV11
  8264*    MOVE '&,         G          &   #00007708' TO DFHEIV0
  8265     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8266     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8267     MOVE X'2020233030303037373038' TO DFHEIV0(25:11)
  8268     CALL 'kxdfhei1' USING DFHEIV0,
  8269           ERCHEK-FILE-ID,
  8270           ERCHEK-KEY,
  8271           DFHEIV99,
  8272           DFHEIV11,
  8273           DFHEIV99
  8274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8275
  8276
  8277
  8278* EXEC CICS READPREV
  8279*        DATASET  (ERCHEK-FILE-ID)
  8280*        SET      (ADDRESS OF CHECK-RECORDS)
  8281*        RIDFLD   (ERCHEK-KEY)
  8282*    END-EXEC.
  8283     MOVE 0
  8284       TO DFHEIV11
  8285*    MOVE '&0S                   )   #00007713' TO DFHEIV0
  8286     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8287     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8288     MOVE X'2020233030303037373133' TO DFHEIV0(25:11)
  8289     CALL 'kxdfhei1' USING DFHEIV0,
  8290           ERCHEK-FILE-ID,
  8291           DFHEIV20,
  8292           DFHEIV99,
  8293           ERCHEK-KEY,
  8294           DFHEIV99,
  8295           DFHEIV11,
  8296           DFHEIV99,
  8297           DFHEIV99
  8298     SET ADDRESS OF CHECK-RECORDS TO
  8299         DFHEIV20
  8300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8301
  8302
  8303 5110-READ-LOOP.
  8304     IF PI-FILE-EOF
  8305         MOVE SPACE              TO PI-EOF-SW
  8306     ELSE
  8307
  8308* EXEC CICS READPREV
  8309*            DATASET  (ERCHEK-FILE-ID)
  8310*            SET      (ADDRESS OF CHECK-RECORDS)
  8311*            RIDFLD   (ERCHEK-KEY)
  8312*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 148
* EL677.cbl
  8313     MOVE 0
  8314       TO DFHEIV11
  8315*    MOVE '&0S                   )   #00007723' TO DFHEIV0
  8316     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8317     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8318     MOVE X'2020233030303037373233' TO DFHEIV0(25:11)
  8319     CALL 'kxdfhei1' USING DFHEIV0,
  8320           ERCHEK-FILE-ID,
  8321           DFHEIV20,
  8322           DFHEIV99,
  8323           ERCHEK-KEY,
  8324           DFHEIV99,
  8325           DFHEIV11,
  8326           DFHEIV99,
  8327           DFHEIV99
  8328     SET ADDRESS OF CHECK-RECORDS TO
  8329         DFHEIV20
  8330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8331
  8332
  8333     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8334         GO TO 5560-END-OF-FILE.
  8335
  8336        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8337           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8338           PI-CHEK-STATE      = CH-STATE       AND
  8339           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8340           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8341           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8342           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8343              GO TO 5500-FORMAT-SCREEN
  8344            ELSE
  8345              GO TO 5560-END-OF-FILE.
  8346
  8347     GO TO 5500-FORMAT-SCREEN.
  8348
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 149
* EL677.cbl
  8350*                          COPY ELCNPD.
  8351*****************************************************************
  8352*                                                               *
  8353*                                                               *
  8354*                            ELCNPD                             *
  8355*                            VMOD=2.001                         *
  8356*****************************************************************
  8357
  8358 5200-MOVE-NAME.
  8359*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8360*            NAME TO A WORK AREA WITH NO EMBEDDED               *
  8361*            BLANKS.                                            *
  8362*                                                               *
  8363*                  FIELD               VALUE                    *
  8364*                                                               *
  8365*                LAST NAME (CL15)      SMITH                    *
  8366*                1ST NAME  (CL12)      JOHN                     *
  8367*                MID NAME  (CL1)       A                        *
  8368*                                                               *
  8369*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8370*         *                                                     *
  8371*         *              JOHN A. SMITH                          *
  8372*         *                                                     *
  8373*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8374*         *  STORAGE COPYBOOK:                                  *
  8375*         *                                                     *
  8376*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8377*         *******************************************************.
  8378
  8379     MOVE SPACES                 TO  WS-NAME-WORK
  8380                                     WS-NAME-WORK2.
  8381     MOVE ZERO                   TO  WS-NAME-SW.
  8382     SET NWA-INDEX TO +1.
  8383
  8384     IF WS-INSURED-1ST-NAME = SPACES  AND
  8385        WS-INSURED-MID-INIT = SPACES
  8386         MOVE WS-INSURED-LAST-NAME TO WS-NAME-WORK
  8387         GO TO 5200-EXIT.
  8388
  8389     MOVE WS-INSURED-1ST-NAME    TO  WS-NAME-WORK2.
  8390     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8391
  8392     SET NWA-INDEX UP BY +1
  8393     IF WS-INSURED-MID-INIT NOT = SPACES
  8394        MOVE WS-INSURED-MID-INIT   TO  WS-NW (NWA-INDEX)
  8395        SET NWA-INDEX UP BY +1
  8396        MOVE '.'                   TO  WS-NW (NWA-INDEX)
  8397        SET NWA-INDEX UP BY +2.
  8398
  8399     MOVE WS-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8400     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8401
  8402
  8403 5200-EXIT.
  8404     EXIT.
  8405
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 150
* EL677.cbl
  8407 5300-MOVE-NAME SECTION.
  8408     IF WS-NAME-SW GREATER THAN +1
  8409         GO TO 5390-EXIT.
  8410
  8411     IF WS-NAME-WORK2 = SPACES
  8412         GO TO 5390-EXIT.
  8413
  8414     SET NWA-INDEX2 TO +1.
  8415     SET NWA-INDEX3 TO +2.
  8416
  8417 5310-MOVE-NAME.
  8418     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8419
  8420     IF NWA-INDEX LESS THAN +30
  8421        SET NWA-INDEX UP BY +1
  8422     ELSE
  8423        ADD +2  TO  WS-NAME-SW
  8424        GO TO 5390-EXIT.
  8425
  8426     IF NWA-INDEX2 LESS THAN +20
  8427         SET NWA-INDEX2 UP BY +1
  8428         SET NWA-INDEX3 UP BY +1.
  8429
  8430     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8431        WS-NW2 (NWA-INDEX3) = SPACES
  8432        GO TO 5390-EXIT.
  8433
  8434     GO TO 5310-MOVE-NAME.
  8435
  8436 5390-EXIT.
  8437     EXIT.
  8438
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 151
* EL677.cbl
  8441 5500-FORMAT-SCREEN.
  8442     MOVE LOW-VALUES             TO  EL677AI.
  8443     if pi-void-reissue-pass = '1'
  8444        move 'R'                 to mainti
  8445                                    pi-prev-maint
  8446     else
  8447        MOVE 'S'                 TO MAINTI
  8448                                    PI-PREV-MAINT
  8449     end-if
  8450     MOVE +1                     TO  MAINTL.
  8451     MOVE CH-CONTROL-PRIMARY     TO  PI-ERCHEK-KEY.
  8452     MOVE CH-CARRIER             TO  CARRIERO.
  8453     MOVE CH-GROUPING            TO  GROUPO.
  8454     MOVE CH-STATE               TO  STATEO.
  8455     MOVE CH-ACCOUNT             TO  ACCTO.
  8456
  8457     MOVE CH-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8458     MOVE SPACE                  TO  DC-OPTION-CODE.
  8459     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8460     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8461
  8462     MOVE CH-CERT-PRIME          TO  CERTNOO.
  8463     MOVE CH-CERT-SFX            TO  SFXO.
  8464     MOVE CH-SEQUENCE-NO         TO  SEQO.
  8465
  8466     MOVE AL-UANON               TO  CARRIERA
  8467                                     GROUPA
  8468                                     STATEA
  8469                                     ACCTA
  8470                                     EFFDTA
  8471                                     CERTNOA
  8472                                     SFXA.
  8473     MOVE CH-PAYEE-NAME-1         TO PI-PAYTO1.
  8474
  8475     if ch-approval-dt not = low-values
  8476        move ch-approval-dt      to dc-bin-date-1
  8477        move ' '                 to dc-option-code
  8478        perform 8500-date-convert thru 8500-exit
  8479        move dc-greg-date-1-edit to apvdto
  8480     end-if
  8481     evaluate ch-approval-status
  8482        when '2'
  8483           move 'PENDING '       TO APVSTATO
  8484        when 'P'
  8485           move 'PENDING '       TO APVSTATO
  8486        when 'A'
  8487           move 'APPROVED'       to apvstato
  8488        when 'D'
  8489           move 'DENIED'         to apvstato
  8490     end-evaluate
  8491     move ch-approved-by         to apvbyo
  8492*    IF PI-COMPANY-ID = 'TMS'
  8493*        MOVE CH-PAYEE-NAME-2    TO  PAYTO1O
  8494*        MOVE CH-LIENHOLDER-NAME TO  PAYTO1AO
  8495*    ELSE
  8496         MOVE CH-PAYEE-NAME-1    TO  PAYTO1O
  8497         MOVE CH-PAYEE-NAME-2    TO  PAYTO2O.
  8498
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 152
* EL677.cbl
  8499     MOVE CH-PAYEE-ADDRESS-1     TO  PAYAD1O.
  8500     MOVE CH-PAYEE-ADDRESS-2     TO  PAYAD2O.
  8501     move ch-payee-city          to payctyo
  8502     move ch-payee-state         to paysto
  8503     MOVE CH-PAYEE-CODE          TO  PAYEEO.
  8504
  8505     IF CH-PAYEE-ZIP-CODE NOT = ZEROS
  8506         MOVE CH-PAYEE-ZIP-CODE  TO  PTOZIPO
  8507         MOVE AL-UANON           TO  PTOZIPA.
  8508
  8509     MOVE CH-RETURN-TO           TO  RETTOO
  8510*    if ch-check-cashed-dt not = spaces and low-values
  8511*       move ch-check-cashed-dt  to dc-bin-date-1
  8512*       MOVE SPACE               TO  DC-OPTION-CODE
  8513*       PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8514*       MOVE DC-GREG-DATE-1-EDIT TO  CASHEDO
  8515*    end-if
  8516     MOVE CH-RECORDED-DT         TO  DC-BIN-DATE-1.
  8517     MOVE SPACE                  TO  DC-OPTION-CODE.
  8518     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8519     MOVE DC-GREG-DATE-1-EDIT    TO  CREATEDO.
  8520
  8521     MOVE CH-RECORDED-BY         TO  CBYO.
  8522
  8523     IF CH-VOID-DT = SPACES OR LOW-VALUES OR ZEROS
  8524         NEXT SENTENCE
  8525     ELSE
  8526         MOVE CH-VOID-DT             TO  DC-BIN-DATE-1
  8527         MOVE SPACE                  TO  DC-OPTION-CODE
  8528         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8529         MOVE DC-GREG-DATE-1-EDIT    TO  VOIDEDO
  8530         MOVE CH-VOID-BY             TO  VBYO.
  8531
  8532     IF CH-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES OR ZEROS
  8533         NEXT SENTENCE
  8534     ELSE
  8535         MOVE CH-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1
  8536         MOVE SPACE                  TO  DC-OPTION-CODE
  8537         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8538         MOVE DC-GREG-DATE-1-EDIT    TO  PRINTEDI.
  8539
  8540     MOVE CH-AMOUNT-PAID         TO  AMOUNTO
  8541                                     pi-void-reissue-amt
  8542     MOVE AL-SANOF               TO  AMOUNTA.
  8543     MOVE CH-CHECK-ORIGIN-SW     TO  TYPEI.
  8544     MOVE AL-SANOF               TO  TYPEA.
  8545     MOVE CH-CHECK-NO            TO  CHECKO.
  8546     move ch-deduct-commission   to dedcyno
  8547     MOVE CH-REASON-FOR-CHECK    TO  REASONO.
  8548     MOVE CH-VOID-REASON         TO  VREASONO.
  8549
  8550     MOVE CH-STUB-LINE-1         TO  STUBO.
  8551     MOVE CH-TEXT-LINE-1         TO  TEXT1O.
  8552     MOVE CH-TEXT-LINE-2         TO  TEXT2O.
  8553     MOVE CH-TEXT-LINE-3         TO  TEXT3O.
  8554     IF CH-LF-REFUND NOT NUMERIC
  8555         MOVE ZEROS              TO CH-LF-REFUND.
  8556     IF CH-AH-REFUND NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 153
* EL677.cbl
  8557         MOVE ZEROS              TO CH-AH-REFUND.
  8558     if (ch-check-no not = spaces and low-values)
  8559        and (ch-check-written-dt not = low-values)
  8560        perform 5800-fetch-check-cashed-dt
  8561                                 thru 5800-exit
  8562     end-if
  8563     IF CH-CHECK-WRITTEN-DT GREATER LOW-VALUES OR
  8564        CH-VOID-DT          GREATER LOW-VALUES
  8565        MOVE AL-SANON            TO  CHECKA    REASONA  VREASONA
  8566                                     STUBA     TEXT1A   TEXT2A
  8567                                     TEXT3A    PAYTO1A  SFXA
  8568                                     PAYTO2A   PAYAD1A  PAYctyA
  8569                                     paysta    RETTOA   PAYAD2A
  8570                                     PTOZIPA
  8571                                     PRINTEDA
  8572     ELSE
  8573        MOVE AL-UANON            TO  CARRIERA  GROUPA   STATEA
  8574                                     ACCTA     EFFDTA   CERTNOA
  8575                                     CHECKA    REASONA  VREASONA
  8576                                     STUBA     TEXT1A   TEXT2A
  8577                                     TEXT3A    PAYTO1A  SFXA
  8578                                     PAYTO2A   PAYAD1A  PAYctyA
  8579                                     paysta    RETTOA   PAYAD2A
  8580                                     PRINTEDA.
  8581
  8582     MOVE AL-UNNON               TO SEQA.
  8583     perform 5600-get-erpndb     thru 5600-exit
  8584     perform 5700-get-elcert     thru 5700-exit
  8585*    move pi-prev-paid           to prepdo
  8586     move al-sadof               to drefa
  8587*    if WS-PNDB-FOUND
  8588*       compute refo = pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8589*    end-if
  8590     if WS-CERT-FOUND
  8591        compute ws-tot-lf-prem = cm-lf-premium-amt +
  8592           cm-lf-alt-premium-amt
  8593        compute ws-tot-iss-prem  =
  8594           cm-ah-premium-amt + ws-tot-lf-prem
  8595        compute ws-tot-iss-comm =
  8596           (ws-tot-lf-prem * cm-life-comm-pct) +
  8597           (cm-ah-premium-amt * cm-ah-comm-pct)
  8598        compute ws-tot-ref-comm =
  8599           (pi-lf-refund * cm-life-comm-pct) +
  8600           (pi-ah-refund * cm-ah-comm-pct)
  8601        move ws-tot-iss-prem     to premo
  8602        move ws-tot-iss-comm     to isscommo
  8603*       move ws-tot-ref-comm     to uecommo
  8604     end-if
  8605     if PI-TO-EL677-FROM-EL1273
  8606        move zeros               to premo
  8607                                    isscommo
  8608                                    uecommo
  8609                                    prepdo
  8610                                    refo
  8611     end-if
  8612     GO TO 8100-SEND-INITIAL-MAP
  8613     .
  8614 5550-NO-RECORD.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 154
* EL677.cbl
  8615     MOVE ER-1162                TO  EMI-ERROR.
  8616     MOVE -1                     TO  CARRIERL.
  8617     MOVE AL-UABON               TO  CARRIERA  GROUPA  STATEA
  8618                                     ACCTA     EFFDTA  CERTNOA
  8619                                     SFXA      SEQA.
  8620     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8621
  8622     IF (NOT PI-TO-EL677-FROM-EL1273)
  8623        and (pi-return-to-program not = 'EL6315')
  8624         GO TO 8200-SEND-DATAONLY.
  8625
  8626     MOVE CHEK-CARRIER           TO  CARRIERO.
  8627     MOVE CHEK-GROUPING          TO  GROUPO.
  8628     MOVE CHEK-STATE             TO  STATEO.
  8629     MOVE CHEK-ACCOUNT           TO  ACCTO.
  8630
  8631     MOVE CHEK-EFF-DT            TO  DC-BIN-DATE-1.
  8632     MOVE SPACE                  TO  DC-OPTION-CODE.
  8633     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8634     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8635
  8636     MOVE CHEK-CERT-NO           TO  CERTNOO.
  8637     MOVE CHEK-SUF-NO            TO  SFXO.
  8638     GO TO 8100-SEND-INITIAL-MAP.
  8639
  8640 5560-END-OF-FILE.
  8641     IF EIBAID = DFHPF1
  8642         MOVE 'Y'                TO  PI-EOF-SW
  8643         MOVE ER-2237            TO  EMI-ERROR
  8644     ELSE
  8645     IF EIBAID = DFHENTER
  8646        GO TO 5550-NO-RECORD
  8647     ELSE
  8648*        MOVE SPACES             TO  PI-ERCHEK-KEY
  8649         MOVE ER-2238            TO  EMI-ERROR.
  8650
  8651     MOVE -1                     TO  MAINTL.
  8652     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8653     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 155
* EL677.cbl
  8655 5600-get-erpndb.
  8656     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  8657     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  8658     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  8659     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  8660     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  8661     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  8662     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  8663     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  8664     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  8665     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  8666     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  8667     IF ST-ACCNT-CNTL  OR
  8668        ACCNT-CNTL
  8669          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  8670     IF ST-ACCNT-CNTL      OR
  8671        CARR-ST-ACCNT-CNTL OR
  8672        ACCNT-CNTL         OR
  8673        CARR-ACCNT-CNTL
  8674          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  8675     IF ACCNT-CNTL OR
  8676        CARR-ACCNT-CNTL
  8677          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  8678
  8679* EXEC CICS READ
  8680*         DATASET   (ERPNDB-ALT-FILE-ID)
  8681*         SET       (ADDRESS OF PENDING-BUSINESS)
  8682*         RIDFLD    (ERPNDB-ALT-KEY)
  8683*         resp      (ws-response)
  8684*    END-EXEC
  8685*    MOVE '&"S        E          (  N#00008074' TO DFHEIV0
  8686     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8688     MOVE X'204E233030303038303734' TO DFHEIV0(25:11)
  8689     CALL 'kxdfhei1' USING DFHEIV0,
  8690           ERPNDB-ALT-FILE-ID,
  8691           DFHEIV20,
  8692           DFHEIV99,
  8693           ERPNDB-ALT-KEY,
  8694           DFHEIV99,
  8695           DFHEIV99,
  8696           DFHEIV99
  8697     SET ADDRESS OF PENDING-BUSINESS TO
  8698         DFHEIV20
  8699     MOVE EIBRESP  TO ws-response
  8700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8701     if resp-normal
  8702        MOVE 'Y'                 TO WS-PNDB-FOUND-SW
  8703        compute pi-refund-on-pending-rec =
  8704           pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8705     end-if
  8706     .
  8707 5600-exit.
  8708     exit.
  8709 5700-get-elcert.
  8710     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  8711     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  8712     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 156
* EL677.cbl
  8713     MOVE PI-STATE               TO  ELCERT-STATE.
  8714     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  8715     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  8716     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  8717     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  8718     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  8719
  8720* EXEC CICS READ
  8721*         DATASET   (ELCERT-FILE-ID)
  8722*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  8723*         RIDFLD    (ELCERT-KEY)
  8724*         resp      (ws-response)
  8725*    END-EXEC
  8726*    MOVE '&"S        E          (  N#00008098' TO DFHEIV0
  8727     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8728     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8729     MOVE X'204E233030303038303938' TO DFHEIV0(25:11)
  8730     CALL 'kxdfhei1' USING DFHEIV0,
  8731           ELCERT-FILE-ID,
  8732           DFHEIV20,
  8733           DFHEIV99,
  8734           ELCERT-KEY,
  8735           DFHEIV99,
  8736           DFHEIV99,
  8737           DFHEIV99
  8738     SET ADDRESS OF CERTIFICATE-MASTER TO
  8739         DFHEIV20
  8740     MOVE EIBRESP  TO ws-response
  8741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8742     if resp-normal
  8743        MOVE 'Y'                 TO WS-CERT-FOUND-SW
  8744     end-if
  8745     .
  8746 5700-exit.
  8747     exit.
  8748 5800-fetch-check-cashed-dt.
  8749     move ' '                    to ws-connect-sw
  8750                                    ws-match-sw
  8751                                    pi-check-cashed
  8752     move 'NTCSO2_PdBnkInfo'     to svr
  8753     move 'sa'                   to usr
  8754     move 'ntcso2'               to pass
  8755     string
  8756         usr delimited space
  8757         "." delimited size
  8758         pass delimited space into usr-pass
  8759     end-string
  8760     EXEC SQL
  8761        CONNECT TO :svr USER :usr-pass
  8762     END-EXEC
  8763     if sqlcode not = 0
  8764        display "Error: cannot connect to pdbnkinfo "
  8765        display sqlcode
  8766        display sqlerrmc
  8767        go to 5800-exit
  8768     end-if
  8769     set connected-to-db to true
  8770     if pi-company-id = 'CID'
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 157
* EL677.cbl
  8771        move 'CSO - AP%'         to ws-pb-compid
  8772     else
  8773        move 'AHL - AP%'         to ws-pb-compid
  8774     end-if
  8775     move '000'                  to ws-pb-check-no (1:3)
  8776     move ch-check-no            to ws-pb-check-no (4:7)
  8777     move spaces                 to ws-pb-bad-check-no
  8778     perform varying s1 from +1 by +1 until
  8779        (s1 > +10)
  8780        or (ws-pb-check-no (s1:1) not = '0')
  8781     end-perform
  8782     if s1 < +11
  8783        move ws-pb-check-no (s1:11 - s1)
  8784                            to ws-pb-bad-check-no (1: 11 - s1)
  8785     end-if
  8786*    display ' compid **' ws-pb-compid '**'
  8787*    display ' ckno  **' ws-pb-check-no '**'
  8788     MOVE ch-AMOUNT-PAID      TO WS-CHECK-AMT-TMP
  8789     MOVE WS-CHECK-AMT-TMPX   TO WS-CHECK-AMOUNT
  8790     MOVE SPACES              TO pb-paid-date
  8791
  8792     EXEC SQL
  8793        CALL pbi_GetCashDate_by_TransactionNbr
  8794           @compid          = :ws-pb-compid,
  8795           @checkno         = :ws-pb-check-no,
  8796           @badcheckno      = :ws-pb-bad-check-no,
  8797           @checkamount     = :ws-check-amount,
  8798           @checkcasheddate = :pb-paid-date OUT
  8799     END-EXEC
  8800     if sqlcode not = 0
  8801        display "Error: cannot run stor proc  "
  8802        move sqlcode            to ws-sql-code
  8803        move ws-sql-code to ws-dis-sql-code
  8804        display ' dis sql code ' ws-dis-sql-code
  8805        display ' sql return code ' sqlcode
  8806        display ' sql err mess    ' sqlerrmc
  8807        go to 5800-disconnect
  8808     end-if
  8809***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8810***                                                            ***
  8811***  The following code works just as well as the above        ***
  8812***  stored procedure and just as fast.                        ***
  8813***  Originally, I had declared a cursor and fetched through   ***
  8814***  the record set to find the correct check and that REALLY  ***
  8815***  slowed the response down to ~ 3/4 second.                 ***
  8816***                                                            ***
  8817***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8818*     EXEC SQL
  8819*        SELECT
  8820*           PaidDate
  8821*        INTO
  8822*           :pb-paid-date
  8823*        FROM
  8824*           dbo.cso_pbi_TransactionLookup
  8825*        WHERE
  8826*           (BankAcctDescr like :ws-pb-compid)
  8827*           and (Amount = :ws-check-amount)
  8828*           and ((transactionNbr = :ws-pb-check-no)
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 158
* EL677.cbl
  8829*                  or
  8830*               (transactionnbr = :ws-pb-bad-check-no))
  8831**          and (CAST(TransactionNbr AS INT) =
  8832**             :ws-pb-check-no-num)
  8833**          and (right('00000' + rtrim(TransactionNbr),10)
  8834**             = :ws-pb-check-no)
  8835**          and (TransactionNbr  = :ws-pb-check-no)
  8836*     END-EXEC
  8837*    display ' chkno  ' pb-check-no
  8838*    display ' desc   ' pb-bank-acct-desc
  8839*    display ' trn typ' pb-tran-type
  8840*    display ' amt   *' pb-amount '**'
  8841*    display ' pd dte ' pb-paid-date
  8842     string pb-paid-date (1:4)
  8843            pb-paid-date (6:2)
  8844            pb-paid-date (9:2)
  8845        delimited by size into dc-greg-date-cymd-r
  8846     end-string
  8847     move 'L'                    to dc-option-code
  8848     perform 8500-date-convert   thru 8500-exit
  8849     if no-conversion-error
  8850*       move dc-bin-date-1       to ws-bin-cashed-dt
  8851        move dc-greg-date-1-edit to cashedo
  8852        move 'Y' to pi-check-cashed
  8853     else
  8854        display ' error cvtdte cash dt ' pb-paid-date ' '
  8855           dc-error-code
  8856     end-if
  8857     .
  8858 5800-disconnect.
  8859     EXEC SQL
  8860        DISCONNECT ALL
  8861     END-EXEC
  8862     if sqlcode not = 0
  8863        display "Error: cannot disconnect pdbnk "
  8864        display ' sql return code ' sqlcode
  8865        display ' sql err mess    ' sqlerrmc
  8866     end-if
  8867     .
  8868 5800-exit.
  8869     exit.
  8870 6000-VERIFY-COMP-MASTER.
  8871
  8872* EXEC CICS HANDLE CONDITION
  8873*        NOTFND   (6070-NO-COMP-MSTR)
  8874*    END-EXEC.
  8875*    MOVE '"$I                   ! - #00008233' TO DFHEIV0
  8876     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8877     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8878     MOVE X'2D20233030303038323333' TO DFHEIV0(25:11)
  8879     CALL 'kxdfhei1' USING DFHEIV0
  8880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8881
  8882
  8883     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  8884
  8885     IF NOT PI-ZERO-CARRIER AND
  8886        NOT PI-ZERO-CAR-GROUP
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 159
* EL677.cbl
  8887         MOVE PI-CR-CARRIER      TO  ERCOMP-CARRIER
  8888     ELSE
  8889         MOVE ZEROS              TO  ERCOMP-CARRIER.
  8890
  8891     IF NOT PI-ZERO-GROUPING  AND
  8892        NOT PI-ZERO-CAR-GROUP
  8893         MOVE PI-CR-GROUPING     TO  ERCOMP-GROUPING
  8894     ELSE
  8895         MOVE ZEROS              TO  ERCOMP-GROUPING.
  8896
  8897     MOVE PI-CR-FIN-RESP         TO  ERCOMP-FIN-RESP.
  8898     MOVE PI-CR-ACCOUNT          TO  ERCOMP-ACCOUNT.
  8899     MOVE 'A'                    TO  ERCOMP-RECORD-TYPE.
  8900
  8901
  8902* EXEC CICS READ
  8903*         DATASET   (ERCOMP-FILE-ID)
  8904*         SET       (ADDRESS OF COMPENSATION-MASTER)
  8905*         RIDFLD    (ERCOMP-KEY)
  8906*     END-EXEC.
  8907*    MOVE '&"S        E          (   #00008255' TO DFHEIV0
  8908     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8909     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8910     MOVE X'2020233030303038323535' TO DFHEIV0(25:11)
  8911     CALL 'kxdfhei1' USING DFHEIV0,
  8912           ERCOMP-FILE-ID,
  8913           DFHEIV20,
  8914           DFHEIV99,
  8915           ERCOMP-KEY,
  8916           DFHEIV99,
  8917           DFHEIV99,
  8918           DFHEIV99
  8919     SET ADDRESS OF COMPENSATION-MASTER TO
  8920         DFHEIV20
  8921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8922
  8923
  8924     GO TO 6090-EXIT.
  8925
  8926 6070-NO-COMP-MSTR.
  8927     MOVE -1                     TO  CARRIERL.
  8928     MOVE ER-2230                TO  EMI-ERROR.
  8929     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8930     GO TO 8200-SEND-DATAONLY.
  8931
  8932 6090-EXIT.
  8933      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 160
* EL677.cbl
  8935 6100-VERIFY-CERTIFICATE.
  8936
  8937* EXEC CICS HANDLE CONDITION
  8938*        NOTFND   (6170-NO-CERTIFICATE)
  8939*    END-EXEC.
  8940*    MOVE '"$I                   ! . #00008273' TO DFHEIV0
  8941     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8942     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8943     MOVE X'2E20233030303038323733' TO DFHEIV0(25:11)
  8944     CALL 'kxdfhei1' USING DFHEIV0
  8945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8946
  8947
  8948     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  8949     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  8950     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  8951     MOVE PI-STATE               TO  ELCERT-STATE.
  8952     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  8953     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  8954     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  8955     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  8956
  8957     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  8958
  8959     MOVE SPACES                 TO  PI-REFERENCE
  8960*                                    PI-INSURED-NAME.
  8961     MOVE LOW-VALUES             TO  PI-CANC-DT.
  8962*    MOVE ZEROS                  TO  PI-LF-REFUND
  8963*                                    PI-AH-REFUND.
  8964
  8965
  8966* EXEC CICS READ
  8967*         DATASET   (ELCERT-FILE-ID)
  8968*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  8969*         RIDFLD    (ELCERT-KEY)
  8970*     END-EXEC.
  8971*    MOVE '&"S        E          (   #00008294' TO DFHEIV0
  8972     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8973     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8974     MOVE X'2020233030303038323934' TO DFHEIV0(25:11)
  8975     CALL 'kxdfhei1' USING DFHEIV0,
  8976           ELCERT-FILE-ID,
  8977           DFHEIV20,
  8978           DFHEIV99,
  8979           ELCERT-KEY,
  8980           DFHEIV99,
  8981           DFHEIV99,
  8982           DFHEIV99
  8983     SET ADDRESS OF CERTIFICATE-MASTER TO
  8984         DFHEIV20
  8985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8986
  8987
  8988     MOVE 'Y'                    TO  WS-CERT-FOUND-SW.
  8989
  8990*    MOVE CM-LF-ITD-CANCEL-AMT   TO  PI-LF-REFUND.
  8991*    MOVE CM-AH-ITD-CANCEL-AMT   TO  PI-AH-REFUND.
  8992     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 161
* EL677.cbl
  8993         MOVE CM-LF-CANCEL-DT    TO  PI-CANC-DT
  8994     ELSE
  8995         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  8996             MOVE CM-AH-CANCEL-DT TO PI-CANC-DT.
  8997*    MOVE CM-INSURED-LAST-NAME   TO  PI-INSURED-NAME.
  8998
  8999     GO TO 6190-EXIT.
  9000
  9001 6170-NO-CERTIFICATE.
  9002     MOVE -1                     TO  CARRIERL.
  9003     MOVE ER-2726                TO  EMI-ERROR.
  9004     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9005
  9006 6190-EXIT.
  9007      EXIT.
  9008
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 162
* EL677.cbl
  9010 6200-UPDATE-PENDING-BUS-REC.
  9011     MOVE PI-COMPANY-CD          TO  ERPNDB-ALT-COMPANY-CD.
  9012     MOVE PI-CARRIER             TO  ERPNDB-ALT-CARRIER.
  9013     MOVE PI-GROUPING            TO  ERPNDB-ALT-GROUPING.
  9014     MOVE PI-STATE               TO  ERPNDB-ALT-STATE.
  9015     MOVE PI-ACCOUNT             TO  ERPNDB-ALT-ACCOUNT.
  9016     MOVE PI-CERT-PRIME          TO  ERPNDB-ALT-CERT-PRIME.
  9017     MOVE PI-CERT-SFX            TO  ERPNDB-ALT-CERT-SFX.
  9018     MOVE PI-CERT-EFF-DT         TO  ERPNDB-ALT-CERT-EFF-DT.
  9019     MOVE ZEROS                  TO  ERPNDB-ALT-CH-SEQ-NO.
  9020     MOVE '2'                    TO  ERPNDB-ALT-RECORD-TYPE.
  9021
  9022     IF ST-ACCNT-CNTL  OR
  9023        ACCNT-CNTL
  9024          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9025
  9026     IF ST-ACCNT-CNTL      OR
  9027        CARR-ST-ACCNT-CNTL OR
  9028        ACCNT-CNTL         OR
  9029        CARR-ACCNT-CNTL
  9030          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9031
  9032     IF ACCNT-CNTL OR
  9033        CARR-ACCNT-CNTL
  9034          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9035
  9036
  9037* EXEC CICS READ
  9038*         DATASET   (ERPNDB-ALT-FILE-ID)
  9039*         SET       (ADDRESS OF PENDING-BUSINESS)
  9040*         RIDFLD    (ERPNDB-ALT-KEY)
  9041*         resp      (ws-response)
  9042*     END-EXEC.
  9043*    MOVE '&"S        E          (  N#00008348' TO DFHEIV0
  9044     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9046     MOVE X'204E233030303038333438' TO DFHEIV0(25:11)
  9047     CALL 'kxdfhei1' USING DFHEIV0,
  9048           ERPNDB-ALT-FILE-ID,
  9049           DFHEIV20,
  9050           DFHEIV99,
  9051           ERPNDB-ALT-KEY,
  9052           DFHEIV99,
  9053           DFHEIV99,
  9054           DFHEIV99
  9055     SET ADDRESS OF PENDING-BUSINESS TO
  9056         DFHEIV20
  9057     MOVE EIBRESP  TO ws-response
  9058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9059
  9060
  9061     if not resp-normal
  9062        go to 6200-exit
  9063     end-if
  9064     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-PRIMARY-KEY.
  9065
  9066
  9067* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 163
* EL677.cbl
  9068*         DATASET   (ERPNDB-FILE-ID)
  9069*         SET       (ADDRESS OF PENDING-BUSINESS)
  9070*         RIDFLD    (ERPNDB-PRIMARY-KEY)
  9071*         UPDATE
  9072*         resp      (ws-response)
  9073*     END-EXEC.
  9074*    MOVE '&"S        EU         (  N#00008360' TO DFHEIV0
  9075     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9076     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9077     MOVE X'204E233030303038333630' TO DFHEIV0(25:11)
  9078     CALL 'kxdfhei1' USING DFHEIV0,
  9079           ERPNDB-FILE-ID,
  9080           DFHEIV20,
  9081           DFHEIV99,
  9082           ERPNDB-PRIMARY-KEY,
  9083           DFHEIV99,
  9084           DFHEIV99,
  9085           DFHEIV99
  9086     SET ADDRESS OF PENDING-BUSINESS TO
  9087         DFHEIV20
  9088     MOVE EIBRESP  TO ws-response
  9089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9090
  9091
  9092 6200-EXIT.
  9093      EXIT.
  9094 6210-rewrite-pndb.
  9095
  9096* EXEC CICS REWRITE
  9097*        DATASET  (ERPNDB-FILE-ID)
  9098*        FROM     (PENDING-BUSINESS)
  9099*    END-EXEC
  9100     MOVE LENGTH OF
  9101      PENDING-BUSINESS
  9102       TO DFHEIV11
  9103*    MOVE '&& L                  %   #00008371' TO DFHEIV0
  9104     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9105     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9106     MOVE X'2020233030303038333731' TO DFHEIV0(25:11)
  9107     CALL 'kxdfhei1' USING DFHEIV0,
  9108           ERPNDB-FILE-ID,
  9109           PENDING-BUSINESS,
  9110           DFHEIV11,
  9111           DFHEIV99
  9112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9113     .
  9114 6210-exit.
  9115     exit.
  9116 6300-BUILD-CERT-SCREEN.
  9117*    move 'N'                    to dedcyni
  9118*                                   pi-prev-ded-comm
  9119     MOVE LOW-VALUES             TO  EL677AI.
  9120     perform 6700-build-common   thru 6700-exit
  9121     if ws-refund-amount = zeros
  9122        move pi-company-cd       to pi-chek-comp-cd
  9123        move pi-carrier          to pi-chek-carrier
  9124        move pi-grouping         to pi-chek-grouping
  9125        move pi-state            to pi-chek-state
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 164
* EL677.cbl
  9126        move pi-account          to pi-chek-account
  9127        move pi-cert-eff-dt      to pi-chek-eff-dt
  9128        move pi-cert-prime       to pi-chek-cert-no
  9129        move pi-cert-sfx         to pi-chek-suf-no
  9130        move +1                  to pi-chek-sequence
  9131             MOVE 'S'            TO MAINTI
  9132             MOVE 1              TO MAINTL
  9133             MOVE AL-UABON       TO MAINTA
  9134             MOVE DFHENTER       TO EIBAID
  9135        go to 5000-browse-file
  9136     end-if
  9137     IF WS-CERT-NOT-FOUND
  9138         GO TO 8100-SEND-INITIAL-MAP.
  9139
  9140*    IF WS-PNDB-FOUND
  9141*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9142*                                   PB-C-AH-CANCEL-AMT
  9143*        MOVE 'R'                TO  TYPEO
  9144*        IF PI-AR-PROCESSING
  9145*            MOVE AL-UANON       TO  REFA
  9146*            MOVE PB-C-REFERENCE TO  REFO
  9147*        END-IF
  9148*    ELSE
  9149*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9150*                                   CM-AH-ITD-CANCEL-AMT.
  9151     MOVE WS-REFUND-AMOUNT        TO AMOUNTO
  9152     MOVE pi-check-type           TO TYPEO
  9153
  9154     IF PI-COMPANY-ID = 'TMS'
  9155         MOVE WS-NAME-WORK         TO PAYTO1I
  9156                                      PI-PAYTO1
  9157         MOVE AL-UANON             TO PAYTO1A
  9158     ELSE
  9159         MOVE WS-NAME-WORK         TO PAYTO1I
  9160                                      PI-PAYTO1
  9161         MOVE AL-UANON             TO PAYTO1A.
  9162
  9163*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9164*    MOVE AL-UANON                 TO PAYTO1AA.
  9165     move 'N'                    to dedcyni
  9166     move al-uanon               to dedcyna
  9167     move 'INS'                  to payeeo
  9168     move al-panon               to payeea
  9169     IF PI-MAIL-YES
  9170         PERFORM 6400-MAILING-ADDRESS THRU 6490-EXIT.
  9171
  9172     GO TO 8100-SEND-INITIAL-MAP.
  9173
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 165
* EL677.cbl
  9175
  9176 6400-MAILING-ADDRESS.
  9177
  9178* EXEC CICS HANDLE CONDITION
  9179*        NOTFND   (6470-NO-ADDRESS)
  9180*    END-EXEC.
  9181*    MOVE '"$I                   ! / #00008439' TO DFHEIV0
  9182     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9184     MOVE X'2F20233030303038343339' TO DFHEIV0(25:11)
  9185     CALL 'kxdfhei1' USING DFHEIV0
  9186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9187
  9188
  9189
  9190* EXEC CICS READ
  9191*        DATASET   (ERMAIL-FILE-ID)
  9192*        SET       (ADDRESS OF MAILING-DATA)
  9193*        RIDFLD    (ELCERT-KEY)
  9194*    END-EXEC.
  9195*    MOVE '&"S        E          (   #00008443' TO DFHEIV0
  9196     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9197     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9198     MOVE X'2020233030303038343433' TO DFHEIV0(25:11)
  9199     CALL 'kxdfhei1' USING DFHEIV0,
  9200           ERMAIL-FILE-ID,
  9201           DFHEIV20,
  9202           DFHEIV99,
  9203           ELCERT-KEY,
  9204           DFHEIV99,
  9205           DFHEIV99,
  9206           DFHEIV99
  9207     SET ADDRESS OF MAILING-DATA TO
  9208         DFHEIV20
  9209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9210
  9211
  9212     MOVE MA-ADDRESS-LINE-1      TO PAYAD1I.
  9213     MOVE MA-ADDRESS-LINE-2      TO PAYAD2I.
  9214     move ma-city                to payctyi
  9215     move ma-addr-state          to paysti
  9216     MOVE MA-ZIP                 TO PTOZIPI.
  9217     MOVE AL-UANON               TO PAYAD1A
  9218                                    PAYAD2A
  9219                                    PAYctyA
  9220                                    paysta
  9221                                    PTOZIPA.
  9222
  9223     GO TO 6490-EXIT.
  9224
  9225 6470-NO-ADDRESS.
  9226     MOVE -1                     TO  PAYAD1L.
  9227     MOVE ER-2394                TO  EMI-ERROR.
  9228     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9229
  9230 6490-EXIT.
  9231      EXIT.
  9232
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 166
* EL677.cbl
  9234
  9235 6500-BUILD-ACCOUNT-SCREEN.
  9236     MOVE LOW-VALUES             TO  EL677AI.
  9237     perform 6700-build-common   thru 6700-exit
  9238     MOVE WS-REFUND-AMOUNT       TO AMOUNTO
  9239     MOVE PI-AM-NAME             TO PAYTO1I
  9240     MOVE SPACES                 TO PAYTO2I
  9241     MOVE PI-AM-ADDRS            TO PAYAD1I.
  9242     MOVE PI-AM-CITY             TO PAYCTYI
  9243     move pi-am-st               to paysti
  9244     MOVE PI-AM-ZIP-CODE         TO PTOZIPI
  9245     move 'ACCT'                 to payeeo
  9246     move al-panon               to payeea
  9247     MOVE AL-UANON               TO PAYTO1A
  9248                                    PAYTO2A
  9249                                    PAYAD1A
  9250                                    PAYCTYA
  9251                                    paysta
  9252                                    PTOZIPA
  9253     GO TO 8100-SEND-INITIAL-MAP
  9254     .
  9255 6600-BUILD-BENEFICIARY-SCREEN.
  9256     MOVE LOW-VALUES             TO  EL677AI.
  9257     perform 6700-build-common   thru 6700-exit
  9258     IF WS-CERT-NOT-FOUND
  9259         GO TO 8100-SEND-INITIAL-MAP.
  9260
  9261*    IF WS-PNDB-FOUND
  9262*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9263*                                   PB-C-AH-CANCEL-AMT
  9264*        MOVE 'R'                TO  TYPEO
  9265*        IF PI-AR-PROCESSING
  9266*            MOVE AL-UANON       TO  REFA
  9267*            MOVE PB-C-REFERENCE TO  REFO
  9268*        END-IF
  9269*    ELSE
  9270*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9271*                                   CM-AH-ITD-CANCEL-AMT.
  9272
  9273     MOVE WS-REFUND-AMOUNT        TO  AMOUNTO.
  9274     MOVE pi-check-type           TO  TYPEO.
  9275
  9276     IF PI-COMPANY-ID = 'TMS'
  9277         MOVE WS-NAME-WORK         TO PAYTO1I
  9278                                      PI-PAYTO1
  9279         MOVE AL-UANON             TO PAYTO1A
  9280     ELSE
  9281         MOVE WS-NAME-WORK         TO PAYTO1I
  9282                                      PI-PAYTO1
  9283         MOVE AL-UANON             TO PAYTO1A.
  9284
  9285*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9286*    MOVE AL-UANON                 TO PAYTO1AA.
  9287
  9288     move 'N'                    to dedcyni
  9289     move al-uanon               to dedcyna
  9290     move 'BENE'                 to payeeo
  9291     move al-panon               to payeea
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 167
* EL677.cbl
  9292     IF PI-MAIL-YES
  9293         PERFORM 6620-MAILING-ADDRESS THRU 6690-EXIT.
  9294
  9295     GO TO 8100-SEND-INITIAL-MAP.
  9296
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 168
* EL677.cbl
  9298
  9299 6620-MAILING-ADDRESS.
  9300
  9301* EXEC CICS HANDLE CONDITION
  9302*        NOTFND   (6670-NO-beneficiary)
  9303*    END-EXEC.
  9304*    MOVE '"$I                   ! 0 #00008537' TO DFHEIV0
  9305     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9306     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9307     MOVE X'3020233030303038353337' TO DFHEIV0(25:11)
  9308     CALL 'kxdfhei1' USING DFHEIV0
  9309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9310
  9311
  9312
  9313* EXEC CICS READ
  9314*        DATASET   (ERMAIL-FILE-ID)
  9315*        SET       (ADDRESS OF MAILING-DATA)
  9316*        RIDFLD    (ELCERT-KEY)
  9317*    END-EXEC.
  9318*    MOVE '&"S        E          (   #00008541' TO DFHEIV0
  9319     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9320     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9321     MOVE X'2020233030303038353431' TO DFHEIV0(25:11)
  9322     CALL 'kxdfhei1' USING DFHEIV0,
  9323           ERMAIL-FILE-ID,
  9324           DFHEIV20,
  9325           DFHEIV99,
  9326           ELCERT-KEY,
  9327           DFHEIV99,
  9328           DFHEIV99,
  9329           DFHEIV99
  9330     SET ADDRESS OF MAILING-DATA TO
  9331         DFHEIV20
  9332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9333
  9334
  9335     move spaces                 to payto2i
  9336     move ma-cred-bene-name      to payto1i
  9337     MOVE MA-cred-bene-addr      TO PAYad1I.
  9338     MOVE MA-cred-bene-addr2     TO PAYad2I.
  9339     move ma-cred-bene-city      to payctyi
  9340     move ma-cred-bene-state     to paysti
  9341     MOVE MA-cred-bene-zip       TO PTOZIPI.
  9342     MOVE AL-UANON               TO payto1a
  9343                                    PAYTO2A
  9344                                    PAYad1A
  9345                                    payad2a
  9346                                    PAYctyA
  9347                                    paysta
  9348                                    PTOZIPA.
  9349
  9350     GO TO 6690-EXIT.
  9351
  9352 6670-NO-BENEFICIARY.
  9353     MOVE -1                     TO  PAYTO1L.
  9354     MOVE ER-2394                TO  EMI-ERROR.
  9355     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 169
* EL677.cbl
  9356
  9357 6690-EXIT.
  9358      EXIT.
  9359 6700-build-common.
  9360     if not eracct-found
  9361        move pi-company-cd       to eracct-co
  9362        move pi-carrier          to eracct-carrier
  9363        move pi-grouping         to eracct-grouping
  9364        move pi-state            to eracct-state
  9365        move pi-account          to eracct-account
  9366        move pi-cert-eff-dt      to eracct-exp-date
  9367        perform 1420-get-eracct  thru 1490-exit
  9368     end-if
  9369*    if WS-PNDB-NOT-FOUND
  9370*       perform 5600-get-erpndb thru 5600-exit
  9371*    end-if
  9372*    MOVE LOW-VALUES             TO  EL677AI.
  9373     MOVE 'A'                    TO  MAINTI.
  9374     MOVE AL-UANON               TO  MAINTA.
  9375     MOVE +1                     TO  MAINTL.
  9376     MOVE PI-CARRIER             TO  CARRIERO.
  9377     MOVE PI-GROUPING            TO  GROUPO.
  9378     MOVE PI-STATE               TO  STATEO.
  9379     MOVE PI-ACCOUNT             TO  ACCTO.
  9380     MOVE PI-CERT-PRIME          TO  CERTNOO.
  9381     MOVE PI-CERT-SFX            TO  SFXO.
  9382     MOVE PI-AMOUNT              TO  AMOUNTO.
  9383*    MOVE PI-TYPE                TO  TYPEO.
  9384     move pi-check-type          to  typeo
  9385     move pi-return-to           to  rettoo
  9386*    MOVE PI-REFERENCE           TO  REFO.
  9387     MOVE PI-PAYTO1              TO  PAYTO1O.
  9388     MOVE AL-UANON               TO  CARRIERA
  9389                                     GROUPA
  9390                                     STATEA
  9391                                     ACCTA
  9392                                     CERTNOA
  9393                                     SFXA
  9394                                     PAYTO1A
  9395                                     PAYTO2A
  9396*                                    AMOUNTA
  9397*                                    TYPEA
  9398                                     rettoa
  9399                                     payeea.
  9400     move al-panon               to typea
  9401     move al-panon               to amounta
  9402     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  9403     MOVE ' '                    TO  DC-OPTION-CODE.
  9404     PERFORM 8500-DATE-CONVERT.
  9405     IF NO-CONVERSION-ERROR
  9406         MOVE DC-GREG-DATE-1-EDIT TO  EFFDTI
  9407         MOVE AL-UANON            TO  EFFDTA
  9408         MOVE 'Y'                 TO  PI-PROCESS-CERT-SW
  9409         PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT
  9410     ELSE
  9411         GO TO 8200-SEND-DATAONLY.
  9412     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9413         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 170
* EL677.cbl
  9414         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
  9415     ELSE
  9416         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9417         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9418     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9419     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9420     move spaces to pi-insured-name
  9421     string cm-insured-last-name ' '
  9422            cm-insured-first-name delimited by '  '
  9423        into pi-insured-name
  9424     end-string
  9425     move spaces                 to pi-table-name
  9426     string cm-insured-last-name ', '
  9427            cm-insured-first-name ' '
  9428            cm-insured-initial2
  9429        delimited by '  '
  9430        into
  9431           pi-table-name
  9432     end-string
  9433*    MOVE WS-NAME-WORK           TO PI-INSURED-NAME.
  9434     if eibaid = dfhpf5
  9435        move 'Y'                 to dedcyni
  9436        move al-uanon            to dedcyna
  9437     end-if
  9438    compute ws-tot-lf-prem = cm-lf-premium-amt +
  9439       cm-lf-alt-premium-amt
  9440    compute ws-tot-iss-prem  =
  9441       cm-ah-premium-amt + ws-tot-lf-prem
  9442    compute ws-tot-iss-comm =
  9443       (ws-tot-lf-prem * cm-life-comm-pct) +
  9444       (cm-ah-premium-amt * cm-ah-comm-pct)
  9445    compute ws-tot-ref-comm =
  9446       (pi-lf-refund * cm-life-comm-pct) +
  9447       (pi-ah-refund * cm-ah-comm-pct)
  9448     move ws-tot-iss-prem        to premo
  9449     move ws-tot-iss-comm        to isscommo
  9450     move al-sadof               to drefa
  9451                                    refa
  9452*    compute refo = pi-lf-refund + pi-ah-refund
  9453     move pi-prev-paid            to prepdo
  9454     move ws-tot-ref-comm         to uecommo
  9455                                     pi-ue-comm
  9456***  compute ws-refund-amount = pi-refund-on-pending-rec -
  9457***     pi-prev-paid
  9458     compute ws-refund-amount =
  9459        pi-refund-on-pending-rec - pi-prev-paid-this-month
  9460     if (pi-refund-on-pending-rec + pi-prev-paid) >
  9461        ws-tot-iss-prem
  9462        move zeros               to ws-refund-amount
  9463     end-if
  9464     if ((dedcyni = 'Y')
  9465        or (pi-prev-ded-comm = 'Y'))
  9466        and (ws-refund-amount >= ws-tot-ref-comm)
  9467        compute ws-refund-amount = ws-refund-amount -
  9468           ws-tot-ref-comm
  9469     end-if
  9470     if pi-check-type = 'C'
  9471*       move pi-endt-prm-diff    to refo
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 171
* EL677.cbl
  9472        move pi-endt-com-diff    to uecommo
  9473                                    pi-ue-comm
  9474        compute ws-refund-amount =
  9475           pi-endt-prm-diff - pi-prev-paid
  9476        if (dedcyni = 'Y')
  9477           or (pi-prev-ded-comm = 'Y')
  9478           compute ws-refund-amount = ws-refund-amount -
  9479              pi-endt-com-diff
  9480        end-if
  9481        if ws-refund-amount <= zeros
  9482           move pi-endt-prm-diff to ws-refund-amount
  9483        end-if
  9484     end-if
  9485     if not WS-CERT-NOT-FOUND
  9486        string
  9487           pi-cert-prime         ' : '
  9488           cm-insured-last-name  ', '
  9489           cm-insured-first-name ' : '
  9490           pi-account            ' : '
  9491           pi-am-csr delimited by '  ' into text1o
  9492        end-string
  9493        move al-uanon            to text1a
  9494        MOVE 'REF'               TO WS-USER-REASON
  9495        if pi-check-type = 'C'
  9496           move 'COR'            to ws-user-reason
  9497        end-if
  9498        MOVE pi-cert-no          TO WS-USER-CERT-NO
  9499        inspect ws-user-cert-no replacing leading zeros
  9500           by spaces
  9501        move pi-insured-name     to ws-user-name
  9502        perform varying s1 from +1 by +1 until
  9503           (s1 > +11)
  9504           or (ws-user-cert-no (s1:1)) <> ' '
  9505        end-perform
  9506        string ws-user-reason  ' ' delimited by size
  9507               ws-user-cert-no (s1:11 - s1 + 1) ' '
  9508                  delimited by size
  9509               cm-insured-last-name ' '
  9510               cm-insured-first-name delimited by '  '
  9511           into stubo
  9512        end-string
  9513        move al-uanon            to stuba
  9514     end-if
  9515     .
  9516 6700-exit.
  9517     exit.
  9518 6800-browse-previous-chek-recs.
  9519***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9520***                                                            ***
  9521**** this should be the first time through, we need to gather  ***
  9522**** all the erchek records for this pending record, add the   ***
  9523**** amounts and make sure this check request will not exceed  ***
  9524**** the collected premium                                     ***
  9525***                                                            ***
  9526***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9527     move zeros                  to pi-prev-paid
  9528                                    pi-prev-paid-this-month
  9529                                    ws-browse-sw
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 172
* EL677.cbl
  9530                                    pi-chek-rec-cnt
  9531     move spaces                 to pi-prev-ded-comm
  9532     move pi-company-cd          to chek-company-cd
  9533     move pi-carrier             to chek-carrier
  9534     move pi-grouping            to chek-grouping
  9535     move pi-state               to chek-state
  9536     move pi-account             to chek-account
  9537     move pi-cert-prime          to chek-cert-no
  9538     move pi-cert-sfx            to chek-suf-no
  9539     move pi-cert-eff-dt         to chek-eff-dt
  9540     move +0                     to chek-record-seq
  9541     move erchek-key             to ws-compare-erchek-key
  9542
  9543* EXEC CICS STARTBR
  9544*       DATASET  (ERCHEK-FILE-ID)
  9545*       RIDFLD   (ERCHEK-KEY)
  9546*       resp     (ws-response)
  9547*    END-EXEC
  9548     MOVE 0
  9549       TO DFHEIV11
  9550*    MOVE '&,         G          &  N#00008754' TO DFHEIV0
  9551     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9552     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9553     MOVE X'204E233030303038373534' TO DFHEIV0(25:11)
  9554     CALL 'kxdfhei1' USING DFHEIV0,
  9555           ERCHEK-FILE-ID,
  9556           ERCHEK-KEY,
  9557           DFHEIV99,
  9558           DFHEIV11,
  9559           DFHEIV99
  9560     MOVE EIBRESP  TO ws-response
  9561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9562     if not resp-normal
  9563        go to 6800-exit
  9564     end-if
  9565     perform until i-say-when
  9566
  9567* EXEC CICS READNEXT
  9568*          DATASET   (ERCHEK-FILE-ID)
  9569*          SET       (ADDRESS OF CHECK-RECORDS)
  9570*          RIDFLD    (ERCHEK-KEY)
  9571*          resp      (ws-response)
  9572*       END-EXEC
  9573     MOVE 0
  9574       TO DFHEIV11
  9575*    MOVE '&.S                   )  N#00008763' TO DFHEIV0
  9576     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9577     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9578     MOVE X'204E233030303038373633' TO DFHEIV0(25:11)
  9579     CALL 'kxdfhei1' USING DFHEIV0,
  9580           ERCHEK-FILE-ID,
  9581           DFHEIV20,
  9582           DFHEIV99,
  9583           ERCHEK-KEY,
  9584           DFHEIV99,
  9585           DFHEIV11,
  9586           DFHEIV99,
  9587           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 173
* EL677.cbl
  9588     SET ADDRESS OF CHECK-RECORDS TO
  9589         DFHEIV20
  9590     MOVE EIBRESP  TO ws-response
  9591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9592        if resp-normal
  9593           and erchek-key (1:33) = ws-compare-erchek-key
  9594           if (ch-void-dt = low-values)
  9595              and (not ch-denied)
  9596              if pi-check-type = 'R'
  9597                 and ch-check-origin-sw = 'C'
  9598                 continue
  9599              else
  9600                 compute pi-prev-paid = pi-prev-paid +
  9601                    ch-amount-paid
  9602                 add +1 to pi-chek-rec-cnt
  9603                 move ch-deduct-commission
  9604                                 to pi-prev-ded-comm
  9605                 if ch-credit-select-dt = pi-cr-month-end-dt
  9606                    compute pi-prev-paid-this-month =
  9607                       pi-prev-paid-this-month + ch-amount-paid
  9608                 end-if
  9609              end-if
  9610           end-if
  9611        else
  9612           set i-say-when to true
  9613        end-if
  9614     end-perform
  9615     .
  9616 6800-exit.
  9617     exit.
  9618 7000-SET-PI-AREA.
  9619     MOVE CARRIERI               TO  PI-CARRIER
  9620                                     PI-CHEK-CARRIER.
  9621     MOVE GROUPI                 TO  PI-GROUPING
  9622                                     PI-CHEK-GROUPING.
  9623     MOVE STATEI                 TO  PI-STATE
  9624                                     PI-CHEK-STATE.
  9625     MOVE ACCTI                  TO  PI-ACCOUNT
  9626                                     PI-CHEK-ACCOUNT.
  9627     MOVE CERTNOI                TO  PI-CERT-PRIME
  9628                                     PI-CHEK-CERT-NO.
  9629     IF SFXI NOT = LOW-VALUES
  9630         MOVE SFXI               TO  PI-CERT-SFX
  9631                                     PI-CHEK-SUF-NO
  9632     ELSE
  9633         MOVE SPACE              TO  PI-CERT-SFX
  9634                                     PI-CHEK-SUF-NO.
  9635
  9636     MOVE EFFDTI                 TO  DC-GREG-DATE-1-EDIT.
  9637     MOVE '2'                    TO  DC-OPTION-CODE.
  9638     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9639     IF DATE-CONVERSION-ERROR
  9640         MOVE ER-0215            TO  EMI-ERROR
  9641         MOVE -1                 TO  EFFDTL
  9642         MOVE AL-UNBON           TO  EFFDTA
  9643         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9644         GO TO 8200-SEND-DATAONLY
  9645     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 174
* EL677.cbl
  9646         MOVE DC-BIN-DATE-1      TO  PI-CERT-EFF-DT
  9647                                     PI-CHEK-EFF-DT.
  9648
  9649 7090-EXIT.
  9650      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 175
* EL677.cbl
  9652 7100-CREATE-TEMP-STORAGE.
  9653     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9654
  9655
  9656* EXEC CICS WRITEQ TS
  9657*        QUEUE   (QID)
  9658*        FROM    (PROGRAM-INTERFACE-BLOCK)
  9659*        LENGTH  (PI-COMM-LENGTH)
  9660*    END-EXEC.
  9661*    MOVE '*"     L              ''   #00008832' TO DFHEIV0
  9662     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  9663     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9664     MOVE X'2020233030303038383332' TO DFHEIV0(25:11)
  9665     CALL 'kxdfhei1' USING DFHEIV0,
  9666           QID,
  9667           PROGRAM-INTERFACE-BLOCK,
  9668           PI-COMM-LENGTH,
  9669           DFHEIV99,
  9670           DFHEIV99,
  9671           DFHEIV99
  9672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9673
  9674
  9675 7100-EXIT.
  9676      EXIT.
  9677
  9678 7200-RECOVER-TEMP-STORAGE.
  9679
  9680* EXEC CICS READQ TS
  9681*        QUEUE   (QID)
  9682*        INTO    (PROGRAM-INTERFACE-BLOCK)
  9683*        LENGTH  (PI-COMM-LENGTH)
  9684*    END-EXEC.
  9685*    MOVE '*$I    L              ''   #00008842' TO DFHEIV0
  9686     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9687     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9688     MOVE X'2020233030303038383432' TO DFHEIV0(25:11)
  9689     CALL 'kxdfhei1' USING DFHEIV0,
  9690           QID,
  9691           PROGRAM-INTERFACE-BLOCK,
  9692           PI-COMM-LENGTH,
  9693           DFHEIV99,
  9694           DFHEIV99,
  9695           DFHEIV99
  9696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9697
  9698
  9699     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9700
  9701 7200-EXIT.
  9702      EXIT.
  9703
  9704 7300-DELETE-TEMP-STORAGE.
  9705
  9706* EXEC CICS HANDLE CONDITION
  9707*        QIDERR  (7300-EXIT)
  9708*    END-EXEC.
  9709*    MOVE '"$N                   ! 1 #00008854' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 176
* EL677.cbl
  9710     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9711     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9712     MOVE X'3120233030303038383534' TO DFHEIV0(25:11)
  9713     CALL 'kxdfhei1' USING DFHEIV0
  9714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9715
  9716
  9717
  9718* EXEC CICS DELETEQ TS
  9719*        QUEUE  (QID)
  9720*    END-EXEC.
  9721*    MOVE '*&                    #   #00008858' TO DFHEIV0
  9722     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9723     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9724     MOVE X'2020233030303038383538' TO DFHEIV0(25:11)
  9725     CALL 'kxdfhei1' USING DFHEIV0,
  9726           QID,
  9727           DFHEIV99
  9728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9729
  9730
  9731 7300-EXIT.
  9732      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 177
* EL677.cbl
  9734 7500-reissue-pass-1.
  9735
  9736     move '2'                    to pi-void-reissue-pass
  9737
  9738     move pi-void-reissue-amt    to amounto
  9739
  9740     if eibaid = dfhpf5
  9741        MOVE PI-AM-NAME          TO PAYTO1I
  9742        MOVE SPACES              TO PAYTO2I
  9743        MOVE PI-AM-ADDRS         TO PAYAD1I
  9744        MOVE PI-AM-CITY          TO PAYCTYI
  9745        move pi-am-st            to paysti
  9746        MOVE PI-AM-ZIP-CODE      TO PTOZIPI
  9747        move 'ACCT'              to payeeo
  9748        move al-panon            to payeea
  9749
  9750        MOVE AL-UANON            TO PAYTO1A
  9751                                    PAYTO2A
  9752                                    PAYAD1A
  9753                                    PAYCTYA
  9754                                    paysta
  9755                                    PTOZIPA
  9756                                    payeea
  9757        GO TO 8100-SEND-INITIAL-MAP
  9758     end-if
  9759
  9760     perform 5700-get-elcert     thru 5700-exit
  9761     move spaces                 to pi-table-name
  9762     string cm-insured-last-name ', '
  9763            cm-insured-first-name ' '
  9764            cm-insured-initial2
  9765        delimited by '  '
  9766        into
  9767           pi-table-name
  9768     end-string
  9769
  9770     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9771         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
  9772         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
  9773     ELSE
  9774         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9775         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9776
  9777     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9778
  9779     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9780
  9781     if eibaid = dfhpf7
  9782
  9783* EXEC CICS READ
  9784*           DATASET   (ERMAIL-FILE-ID)
  9785*           SET       (ADDRESS OF MAILING-DATA)
  9786*           RIDFLD    (ELCERT-KEY)
  9787*           resp      (ws-response)
  9788*       END-EXEC
  9789*    MOVE '&"S        E          (  N#00008913' TO DFHEIV0
  9790     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9791     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 178
* EL677.cbl
  9792     MOVE X'204E233030303038393133' TO DFHEIV0(25:11)
  9793     CALL 'kxdfhei1' USING DFHEIV0,
  9794           ERMAIL-FILE-ID,
  9795           DFHEIV20,
  9796           DFHEIV99,
  9797           ELCERT-KEY,
  9798           DFHEIV99,
  9799           DFHEIV99,
  9800           DFHEIV99
  9801     SET ADDRESS OF MAILING-DATA TO
  9802         DFHEIV20
  9803     MOVE EIBRESP  TO ws-response
  9804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9805        if resp-normal
  9806           move spaces             to payto2i
  9807           move ma-cred-bene-name  to payto1i
  9808           MOVE MA-cred-bene-addr  TO PAYad1I
  9809           MOVE MA-cred-bene-addr2 TO PAYad2I
  9810           move ma-cred-bene-city  to payctyi
  9811           move ma-cred-bene-state to paysti
  9812           MOVE MA-cred-bene-zip   TO PTOZIPI
  9813           move 'BENE'              to payeeo
  9814           MOVE AL-UANON           TO payto1a
  9815                                      PAYTO2A
  9816                                      PAYad1A
  9817                                      payad2a
  9818                                      PAYctyA
  9819                                      paysta
  9820                                      PTOZIPA
  9821                                      payeea
  9822        end-if
  9823     end-if
  9824
  9825     if eibaid = dfhpf6
  9826
  9827* EXEC CICS READ
  9828*           DATASET   (ERMAIL-FILE-ID)
  9829*           SET       (ADDRESS OF MAILING-DATA)
  9830*           RIDFLD    (ELCERT-KEY)
  9831*           resp      (ws-response)
  9832*       END-EXEC
  9833*    MOVE '&"S        E          (  N#00008940' TO DFHEIV0
  9834     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9835     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9836     MOVE X'204E233030303038393430' TO DFHEIV0(25:11)
  9837     CALL 'kxdfhei1' USING DFHEIV0,
  9838           ERMAIL-FILE-ID,
  9839           DFHEIV20,
  9840           DFHEIV99,
  9841           ELCERT-KEY,
  9842           DFHEIV99,
  9843           DFHEIV99,
  9844           DFHEIV99
  9845     SET ADDRESS OF MAILING-DATA TO
  9846         DFHEIV20
  9847     MOVE EIBRESP  TO ws-response
  9848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9849        if resp-normal
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 179
* EL677.cbl
  9850           move spaces            to payto2i
  9851           move ws-name-work      to payto1i
  9852           MOVE MA-ADDRESS-LINE-1 TO PAYAD1I
  9853           MOVE MA-ADDRESS-LINE-2 TO PAYAD2I
  9854           move ma-city           to payctyi
  9855           move ma-addr-state     to paysti
  9856           move 'INS'             to payeeo
  9857           MOVE MA-ZIP            TO PTOZIPI
  9858           MOVE AL-UANON          TO PAYAD1A
  9859                                     PAYAD2A
  9860                                     PAYctyA
  9861                                     paysta
  9862                                     PTOZIPA
  9863                                     payto1a
  9864                                     payeea
  9865        end-if
  9866     end-if
  9867
  9868     GO TO 8100-SEND-INITIAL-MAP
  9869
  9870     .
  9871 7500-exit.
  9872     exit.
  9873
  9874 7510-reissue-pass-2.
  9875
  9876
  9877* EXEC CICS READ
  9878*        DATASET  (ERCHEK-FILE-ID)
  9879*        SET      (ADDRESS OF CHECK-RECORDS)
  9880*        RIDFLD   (PI-ERCHEK-KEY)
  9881*        resp     (ws-response)
  9882*    END-EXEC
  9883*    MOVE '&"S        E          (  N#00008973' TO DFHEIV0
  9884     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9885     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9886     MOVE X'204E233030303038393733' TO DFHEIV0(25:11)
  9887     CALL 'kxdfhei1' USING DFHEIV0,
  9888           ERCHEK-FILE-ID,
  9889           DFHEIV20,
  9890           DFHEIV99,
  9891           PI-ERCHEK-KEY,
  9892           DFHEIV99,
  9893           DFHEIV99,
  9894           DFHEIV99
  9895     SET ADDRESS OF CHECK-RECORDS TO
  9896         DFHEIV20
  9897     MOVE EIBRESP  TO ws-response
  9898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9899     display ' after read ' ws-response ' ' pi-erchek-key (2:19)
  9900     ' ' pi-erchek-key (22:11) ' ' pi-chek-sequence
  9901
  9902     if not resp-normal
  9903        go to 7510-exit
  9904     end-if
  9905
  9906     if ch-void-dt not = save-bin-date
  9907        display ' something went wrong here '
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 180
* EL677.cbl
  9908        go to 7510-exit
  9909     end-if
  9910
  9911     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS
  9912     MOVE save-bin-date          TO CH-RECORDED-DT
  9913                                    ch-released-dt
  9914     move pi-processor-id        to ch-recorded-by
  9915                                    ch-released-by
  9916                                    ch-return-to
  9917     move spaces                 to ch-check-no
  9918                                    ch-void-by
  9919                                    ch-void-reason
  9920                                    ch-approved-by
  9921
  9922
  9923     move 'P'                    to ch-approval-status
  9924
  9925     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  9926                                    CH-VOID-DT
  9927                                    CH-CREDIT-ACCEPT-DT
  9928                                    ch-approval-dt
  9929                                    ch-check-cashed-dt
  9930     add +1 to ch-sequence-no
  9931     if ch-check-origin-sw = 'R'
  9932        move 'R'                 to pi-check-type
  9933     else
  9934        move 'C'                 to pi-check-type
  9935     end-if
  9936
  9937     .
  9938 7510-WRITE-RECORD.
  9939
  9940
  9941* exec cics read
  9942*       dataset    (erchek-file-id)
  9943*       into       (ws-dummy-erchek)
  9944*       ridfld     (ch-control-primary)
  9945*       resp       (ws-response)
  9946*    end-exec
  9947     MOVE LENGTH OF
  9948      ws-dummy-erchek
  9949       TO DFHEIV11
  9950*    MOVE '&"IL       E          (  N#00009020' TO DFHEIV0
  9951     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9953     MOVE X'204E233030303039303230' TO DFHEIV0(25:11)
  9954     CALL 'kxdfhei1' USING DFHEIV0,
  9955           erchek-file-id,
  9956           ws-dummy-erchek,
  9957           DFHEIV11,
  9958           ch-control-primary,
  9959           DFHEIV99,
  9960           DFHEIV99,
  9961           DFHEIV99
  9962     MOVE EIBRESP  TO ws-response
  9963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9964     display ' after read ' ws-response
  9965     if RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 181
* EL677.cbl
  9966        continue
  9967     else
  9968        add +1                   to ch-sequence-no
  9969        add 1                    to seqi
  9970        go to 7510-write-record
  9971     end-if
  9972
  9973     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  9974     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  9975                                    CH-CHECK-QUE-SEQUENCE
  9976
  9977     IF PAYTO1L NOT = ZEROS
  9978        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  9979     END-IF
  9980     IF PAYTO2L NOT = ZEROS
  9981        MOVE PAYTO2I             TO CH-PAYEE-NAME-2
  9982     end-if
  9983     IF PAYAD1L NOT = ZEROS
  9984        MOVE PAYAD1I             TO CH-PAYEE-ADDRESS-1
  9985     end-if
  9986     IF PAYAD2L NOT = ZEROS
  9987        MOVE PAYAD2I             TO CH-PAYEE-ADDRESS-2
  9988     end-if
  9989     IF PAYctyL NOT = ZEROS
  9990        MOVE payctyi             TO CH-PAYEE-CITY
  9991     end-if
  9992     IF PAYstL NOT = ZEROS
  9993        MOVE paysti              TO CH-PAYEE-state
  9994     end-if
  9995     IF PAYEEI GREATER SPACES
  9996        mOVE PAYEEI               TO CH-PAYEE-CODE
  9997     end-if
  9998     IF PTOZIPL  =  ZEROS
  9999        MOVE ZEROS               TO CH-PAYEE-ZIP-CODE
 10000     else
 10001        MOVE PTOZIPI             TO WS-ZIP-CODE
 10002        IF NOT WS-CANADIAN-POST-CODE
 10003           MOVE WS-ZIP-PRIME     TO CH-PAYEE-ZIP
 10004           MOVE WS-ZIP-PLUS4     TO CH-PAYEE-ZIP-EXT
 10005        end-if
 10006     end-if
 10007
 10008     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
 10009     display ' back from 2700- '
 10010
 10011
 10012* EXEC CICS WRITE
 10013*        DATASET  (ERCHEK-FILE-ID)
 10014*        FROM     (CHECK-RECORDS)
 10015*        RIDFLD   (CH-CONTROL-PRIMARY)
 10016*        resp     (ws-response)
 10017*    END-EXEC.
 10018     MOVE LENGTH OF
 10019      CHECK-RECORDS
 10020       TO DFHEIV11
 10021*    MOVE '&$ L                  ''  N#00009073' TO DFHEIV0
 10022     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10023     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 182
* EL677.cbl
 10024     MOVE X'204E233030303039303733' TO DFHEIV0(25:11)
 10025     CALL 'kxdfhei1' USING DFHEIV0,
 10026           ERCHEK-FILE-ID,
 10027           CHECK-RECORDS,
 10028           DFHEIV11,
 10029           CH-CONTROL-PRIMARY,
 10030           DFHEIV99,
 10031           DFHEIV99
 10032     MOVE EIBRESP  TO ws-response
 10033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10034
 10035     display ' after write ' ws-response
 10036     COMPUTE WS-JOURNAL-RECORD-LENGTH =
 10037             ERCHEK-RECORD-LENGTH + 23.
 10038
 10039     IF EMI-NO-ERRORS
 10040        MOVE ER-0000             TO EMI-ERROR
 10041     ELSE
 10042        IF EMI-FORCABLE-CTR GREATER THAN +0  AND
 10043           EIBAID = DFHPF4
 10044           MOVE ER-2600          TO EMI-ERROR
 10045        end-if
 10046     end-if
 10047
 10048     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10049
 10050     MOVE LOW-VALUES             TO EL677AI.
 10051
 10052     MOVE PI-CHEK-CARRIER        TO CARRIERO.
 10053     MOVE PI-CHEK-GROUPING       TO GROUPO.
 10054     MOVE PI-CHEK-STATE          TO STATEO.
 10055     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
 10056
 10057     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
 10058     MOVE SPACE                  TO DC-OPTION-CODE.
 10059     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10060     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
 10061
 10062     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
 10063     MOVE PI-CHEK-SUF-NO         TO SFXO.
 10064     MOVE PI-CHEK-SEQUENCE       TO SEQO.
 10065
 10066     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
 10067                                    ACCTA     EFFDTA  CERTNOA
 10068                                    SFXA.
 10069     MOVE AL-UNNON               TO SEQA
 10070     move ' ' to pi-void-reissue-pass
 10071     go to 5000-browse-file
 10072
 10073     .
 10074 7510-exit.
 10075     exit.
 10076 8100-SEND-INITIAL-MAP.
 10077     MOVE SAVE-DATE              TO  DATEO.
 10078     MOVE EIBTIME                TO  TIME-IN.
 10079     MOVE TIME-OUT               TO  TIMEO.
 10080     MOVE -1                     TO  MAINTL
 10081     move al-uanon               to mainta
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 183
* EL677.cbl
 10082     move dedcyni                to pi-previous-deduct-comm
 10083     if (PI-TO-EL677-FROM-EL1273)
 10084        and (pi-void-reissue-pass = ' ')
 10085        move al-sadof            to pf3a
 10086                                    pf4a
 10087                                    pf57a
 10088                                    pf6a
 10089                                    dprema
 10090                                    dcomma
 10091                                    drefa
 10092                                    duecomma
 10093                                    dprepda
 10094                                    prema
 10095                                    isscomma
 10096                                    refa
 10097                                    uecomma
 10098                                    prepda
 10099        move ', VOID(V)'         to dmaint1o
 10100        move 'VOID & REISSUE(R), DELETE(D)'
 10101                                 TO dmaint2o
 10102     end-if
 10103     if (pi-to-el677-from-el1273)
 10104        and (pi-void-reissue-pass = '1')
 10105        move al-sadof            to pf3a
 10106                                    pf4a
 10107                                    dprema
 10108                                    dcomma
 10109                                    drefa
 10110                                    duecomma
 10111                                    dprepda
 10112                                    prema
 10113                                    isscomma
 10114                                    refa
 10115                                    uecomma
 10116                                    prepda
 10117        move ', VOID(V)'         to dmaint1o
 10118        move 'VOID AND REISSUE(R)'
 10119                                 TO dmaint2o
 10120     end-if
 10121     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10122     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10123
 10124
 10125* EXEC CICS SEND
 10126*        MAP      (EL677A)
 10127*        MAPSET   (MAPSET-NAME)
 10128*        FROM     (EL677AO)
 10129*        ERASE
 10130*        CURSOR
 10131*    END-EXEC.
 10132     MOVE LENGTH OF
 10133      EL677AO
 10134       TO DFHEIV12
 10135     MOVE -1
 10136       TO DFHEIV11
 10137*    MOVE '8$     CT  E    H L F ,   #00009168' TO DFHEIV0
 10138     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10139     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 184
* EL677.cbl
 10140     MOVE X'2020233030303039313638' TO DFHEIV0(25:11)
 10141     CALL 'kxdfhei1' USING DFHEIV0,
 10142           EL677A,
 10143           EL677AO,
 10144           DFHEIV12,
 10145           MAPSET-NAME,
 10146           DFHEIV99,
 10147           DFHEIV99,
 10148           DFHEIV99,
 10149           DFHEIV11,
 10150           DFHEIV99,
 10151           DFHEIV99,
 10152           DFHEIV99
 10153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10154
 10155
 10156     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 185
* EL677.cbl
 10158 8200-SEND-DATAONLY.
 10159     if connected-to-db
 10160        perform 4300-FINISH-UP-DB thru 4300-exit
 10161     end-if
 10162     MOVE SAVE-DATE              TO  DATEO.
 10163     MOVE EIBTIME                TO  TIME-IN.
 10164     MOVE TIME-OUT               TO  TIMEO.
 10165     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10166     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10167
 10168
 10169* EXEC CICS SEND
 10170*        MAP     (EL677A)
 10171*        MAPSET  (MAPSET-NAME)
 10172*        FROM    (EL677AO)
 10173*        DATAONLY
 10174*        CURSOR
 10175*    END-EXEC.
 10176     MOVE LENGTH OF
 10177      EL677AO
 10178       TO DFHEIV12
 10179     MOVE -1
 10180       TO DFHEIV11
 10181*    MOVE '8$D    CT       H L F ,   #00009188' TO DFHEIV0
 10182     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10183     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10184     MOVE X'2020233030303039313838' TO DFHEIV0(25:11)
 10185     CALL 'kxdfhei1' USING DFHEIV0,
 10186           EL677A,
 10187           EL677AO,
 10188           DFHEIV12,
 10189           MAPSET-NAME,
 10190           DFHEIV99,
 10191           DFHEIV99,
 10192           DFHEIV99,
 10193           DFHEIV11,
 10194           DFHEIV99,
 10195           DFHEIV99,
 10196           DFHEIV99
 10197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10198
 10199
 10200     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 186
* EL677.cbl
 10202 8300-SEND-TEXT.
 10203
 10204* EXEC CICS SEND TEXT
 10205*        FROM     (LOGOFF-TEXT)
 10206*        LENGTH   (LOGOFF-LENGTH)
 10207*        ERASE
 10208*        FREEKB
 10209*    END-EXEC.
 10210*    MOVE '8&      T  E F  H   F -   #00009199' TO DFHEIV0
 10211     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10212     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10213     MOVE X'2020233030303039313939' TO DFHEIV0(25:11)
 10214     CALL 'kxdfhei1' USING DFHEIV0,
 10215           LOGOFF-TEXT,
 10216           LOGOFF-LENGTH,
 10217           DFHEIV99,
 10218           DFHEIV99,
 10219           DFHEIV99,
 10220           DFHEIV99,
 10221           DFHEIV99,
 10222           DFHEIV99,
 10223           DFHEIV99,
 10224           DFHEIV99,
 10225           DFHEIV99,
 10226           DFHEIV99
 10227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10228
 10229
 10230
 10231* EXEC CICS RETURN
 10232*    END-EXEC.
 10233*    MOVE '.(                    ''   #00009206' TO DFHEIV0
 10234     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10235     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10236     MOVE X'2020233030303039323036' TO DFHEIV0(25:11)
 10237     CALL 'kxdfhei1' USING DFHEIV0,
 10238           DFHEIV99,
 10239           DFHEIV99,
 10240           DFHEIV99,
 10241           DFHEIV99,
 10242           DFHEIV99,
 10243           DFHEIV99
 10244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10245
 10246
 10247 8500-DATE-CONVERT.
 10248     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10249
 10250
 10251* EXEC CICS LINK
 10252*        PROGRAM    (PGM-NAME)
 10253*        COMMAREA   (DATE-CONVERSION-DATA)
 10254*        LENGTH     (DC-COMM-LENGTH)
 10255*    END-EXEC.
 10256*    MOVE '."C                   (   #00009212' TO DFHEIV0
 10257     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10258     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10259     MOVE X'2020233030303039323132' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 187
* EL677.cbl
 10260     CALL 'kxdfhei1' USING DFHEIV0,
 10261           PGM-NAME,
 10262           DATE-CONVERSION-DATA,
 10263           DC-COMM-LENGTH,
 10264           DFHEIV99,
 10265           DFHEIV99,
 10266           DFHEIV99,
 10267           DFHEIV99
 10268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10269
 10270
 10271 8500-EXIT.
 10272      EXIT.
 10273
 10274 8600-DEEDIT.
 10275
 10276* EXEC CICS BIF DEEDIT
 10277*        FIELD   (WS-DEEDIT-FIELD)
 10278*        LENGTH  (10)
 10279*    END-EXEC.
 10280     MOVE 10
 10281       TO DFHEIV11
 10282*    MOVE '@"L                   #   #00009222' TO DFHEIV0
 10283     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10284     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10285     MOVE X'2020233030303039323232' TO DFHEIV0(25:11)
 10286     CALL 'kxdfhei1' USING DFHEIV0,
 10287           WS-DEEDIT-FIELD,
 10288           DFHEIV11
 10289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10290
 10291
 10292 8600-EXIT.
 10293      EXIT.
 10294
 10295 8700-DEEDIT.
 10296
 10297* EXEC CICS BIF DEEDIT
 10298*        FIELD   (WS-DT-DEEDIT-FIELD)
 10299*        LENGTH  (10)
 10300*    END-EXEC.
 10301     MOVE 10
 10302       TO DFHEIV11
 10303*    MOVE '@"L                   #   #00009231' TO DFHEIV0
 10304     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10305     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10306     MOVE X'2020233030303039323331' TO DFHEIV0(25:11)
 10307     CALL 'kxdfhei1' USING DFHEIV0,
 10308           WS-DT-DEEDIT-FIELD,
 10309           DFHEIV11
 10310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10311
 10312
 10313 8700-EXIT.
 10314      EXIT.
 10315
 10316 8800-UNAUTHORIZED-ACCESS.
 10317     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 188
* EL677.cbl
 10318     GO TO 8300-SEND-TEXT.
 10319
 10320 8810-PF23.
 10321     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10322     MOVE XCTL-005               TO  PGM-NAME.
 10323     GO TO 9300-XCTL.
 10324
 10325
 10326 9100-RETURN-TRAN.
 10327     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10328     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10329
 10330* EXEC CICS RETURN
 10331*        TRANSID  (TRANS-ID)
 10332*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 10333*        LENGTH   (PI-COMM-LENGTH)
 10334*    END-EXEC.
 10335*    MOVE '.(CT                  ''   #00009252' TO DFHEIV0
 10336     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10337     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10338     MOVE X'2020233030303039323532' TO DFHEIV0(25:11)
 10339     CALL 'kxdfhei1' USING DFHEIV0,
 10340           TRANS-ID,
 10341           PROGRAM-INTERFACE-BLOCK,
 10342           PI-COMM-LENGTH,
 10343           DFHEIV99,
 10344           DFHEIV99,
 10345           DFHEIV99
 10346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10347
 10348
 10349
 10350* GOBACK.
 10351     MOVE '9%                    "   ' TO DFHEIV0
 10352     MOVE 'EL677' TO DFHEIV1
 10353     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10354     GOBACK.
 10355
 10356 9200-RETURN-MAIN-MENU.
 10357     MOVE XCTL-626               TO  PGM-NAME.
 10358     GO TO 9300-XCTL.
 10359
 10360 9300-XCTL.
 10361
 10362* EXEC CICS XCTL
 10363*        PROGRAM    (PGM-NAME)
 10364*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10365*        LENGTH     (PI-COMM-LENGTH)
 10366*    END-EXEC.
 10367*    MOVE '.$C                   %   #00009265' TO DFHEIV0
 10368     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10369     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10370     MOVE X'2020233030303039323635' TO DFHEIV0(25:11)
 10371     CALL 'kxdfhei1' USING DFHEIV0,
 10372           PGM-NAME,
 10373           PROGRAM-INTERFACE-BLOCK,
 10374           PI-COMM-LENGTH,
 10375           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 189
* EL677.cbl
 10376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10377
 10378
 10379 9400-CLEAR.
 10380     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10381     MOVE SPACES                 TO  PI-PFKEY.
 10382     GO TO 9300-XCTL.
 10383
 10384 9500-PF12.
 10385     MOVE XCTL-010               TO  PGM-NAME.
 10386     GO TO 9300-XCTL.
 10387
 10388 9600-PGMID-ERROR.
 10389
 10390* EXEC CICS HANDLE CONDITION
 10391*        PGMIDERR    (8300-SEND-TEXT)
 10392*    END-EXEC.
 10393*    MOVE '"$L                   ! 2 #00009281' TO DFHEIV0
 10394     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10396     MOVE X'3220233030303039323831' TO DFHEIV0(25:11)
 10397     CALL 'kxdfhei1' USING DFHEIV0
 10398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10399
 10400
 10401     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10402     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10403     MOVE XCTL-005               TO  PGM-NAME.
 10404     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10405     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10406
 10407     GO TO 9300-XCTL.
 10408
 10409 9900-ERROR-FORMAT.
 10410     IF NOT EMI-ERRORS-COMPLETE
 10411         MOVE LINK-001           TO  PGM-NAME
 10412
 10413* EXEC CICS LINK
 10414*            PROGRAM    (PGM-NAME)
 10415*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10416*            LENGTH     (EMI-COMM-LENGTH)
 10417*        END-EXEC.
 10418*    MOVE '."C                   (   #00009296' TO DFHEIV0
 10419     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10421     MOVE X'2020233030303039323936' TO DFHEIV0(25:11)
 10422     CALL 'kxdfhei1' USING DFHEIV0,
 10423           PGM-NAME,
 10424           ERROR-MESSAGE-INTERFACE-BLOCK,
 10425           EMI-COMM-LENGTH,
 10426           DFHEIV99,
 10427           DFHEIV99,
 10428           DFHEIV99,
 10429           DFHEIV99
 10430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10431
 10432
 10433 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 190
* EL677.cbl
 10434      EXIT.
 10435
 10436 9990-ABEND.
 10437     MOVE LINK-004               TO  PGM-NAME.
 10438     MOVE DFHEIBLK               TO  EMI-LINE1.
 10439
 10440* EXEC CICS LINK
 10441*        PROGRAM   (PGM-NAME)
 10442*        COMMAREA  (EMI-LINE1)
 10443*        LENGTH    (72)
 10444*    END-EXEC.
 10445     MOVE 72
 10446       TO DFHEIV11
 10447*    MOVE '."C                   (   #00009308' TO DFHEIV0
 10448     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10449     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10450     MOVE X'2020233030303039333038' TO DFHEIV0(25:11)
 10451     CALL 'kxdfhei1' USING DFHEIV0,
 10452           PGM-NAME,
 10453           EMI-LINE1,
 10454           DFHEIV11,
 10455           DFHEIV99,
 10456           DFHEIV99,
 10457           DFHEIV99,
 10458           DFHEIV99
 10459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10460
 10461
 10462     GO TO 8200-SEND-DATAONLY.
 10463
 10464 9995-SECURITY-VIOLATION.
 10465*                            COPY ELCSCTP.
 10466******************************************************************
 10467*                                                                *
 10468*                            ELCSCTP                             *
 10469*                            VMOD=2.001                          *
 10470*                                                                *
 10471*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10472******************************************************************
 10473
 10474
 10475     MOVE EIBDATE          TO SM-JUL-DATE.
 10476     MOVE EIBTRMID         TO SM-TERMID.
 10477     MOVE THIS-PGM         TO SM-PGM.
 10478     MOVE EIBTIME          TO TIME-IN.
 10479     MOVE TIME-OUT         TO SM-TIME.
 10480     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10481
 10482
 10483* EXEC CICS LINK
 10484*         PROGRAM  ('EL003')
 10485*         COMMAREA (SECURITY-MESSAGE)
 10486*         LENGTH   (80)
 10487*    END-EXEC.
 10488     MOVE 'EL003' TO DFHEIV1
 10489     MOVE 80
 10490       TO DFHEIV11
 10491*    MOVE '."C                   (   #00009334' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 191
* EL677.cbl
 10492     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10493     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10494     MOVE X'2020233030303039333334' TO DFHEIV0(25:11)
 10495     CALL 'kxdfhei1' USING DFHEIV0,
 10496           DFHEIV1,
 10497           SECURITY-MESSAGE,
 10498           DFHEIV11,
 10499           DFHEIV99,
 10500           DFHEIV99,
 10501           DFHEIV99,
 10502           DFHEIV99
 10503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10504
 10505
 10506******************************************************************
 10507
 10508
 10509 9995-EXIT.
 10510     EXIT.
 10511
 10512
 10513 9999-DFHBACK SECTION.
 10514     MOVE '9%                    "   ' TO DFHEIV0
 10515     MOVE 'EL677' TO DFHEIV1
 10516     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10517     GOBACK.
 10518 9999-DFHEXIT.
 10519     IF DFHEIGDJ EQUAL 0001
 10520         NEXT SENTENCE
 10521     ELSE IF DFHEIGDJ EQUAL 2
 10522         GO TO 9600-PGMID-ERROR,
 10523               9990-ABEND
 10524         DEPENDING ON DFHEIGDI
 10525     ELSE IF DFHEIGDJ EQUAL 3
 10526         GO TO 8100-SEND-INITIAL-MAP
 10527         DEPENDING ON DFHEIGDI
 10528     ELSE IF DFHEIGDJ EQUAL 4
 10529         GO TO 1290-NO-CARRIER
 10530         DEPENDING ON DFHEIGDI
 10531     ELSE IF DFHEIGDJ EQUAL 5
 10532         GO TO 1380-NO-STATE
 10533         DEPENDING ON DFHEIGDI
 10534     ELSE IF DFHEIGDJ EQUAL 6
 10535         GO TO 1480-ACCOUNT-INVALID,
 10536               1480-ACCOUNT-INVALID
 10537         DEPENDING ON DFHEIGDI
 10538     ELSE IF DFHEIGDJ EQUAL 7
 10539         GO TO 1590-EXIT
 10540         DEPENDING ON DFHEIGDI
 10541     ELSE IF DFHEIGDJ EQUAL 8
 10542         GO TO 2200-DUPREC
 10543         DEPENDING ON DFHEIGDI
 10544     ELSE IF DFHEIGDJ EQUAL 9
 10545         GO TO 3900-RECORD-NOTFND
 10546         DEPENDING ON DFHEIGDI
 10547     ELSE IF DFHEIGDJ EQUAL 10
 10548         GO TO 3287-DUPREC
 10549         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 22-Apr-19 07:56 Page 192
* EL677.cbl
 10550     ELSE IF DFHEIGDJ EQUAL 11
 10551         GO TO 3390-EXIT,
 10552               3390-EXIT
 10553         DEPENDING ON DFHEIGDI
 10554     ELSE IF DFHEIGDJ EQUAL 12
 10555         GO TO 5560-END-OF-FILE,
 10556               5560-END-OF-FILE
 10557         DEPENDING ON DFHEIGDI
 10558     ELSE IF DFHEIGDJ EQUAL 13
 10559         GO TO 6070-NO-COMP-MSTR
 10560         DEPENDING ON DFHEIGDI
 10561     ELSE IF DFHEIGDJ EQUAL 14
 10562         GO TO 6170-NO-CERTIFICATE
 10563         DEPENDING ON DFHEIGDI
 10564     ELSE IF DFHEIGDJ EQUAL 15
 10565         GO TO 6470-NO-ADDRESS
 10566         DEPENDING ON DFHEIGDI
 10567     ELSE IF DFHEIGDJ EQUAL 16
 10568         GO TO 6670-NO-beneficiary
 10569         DEPENDING ON DFHEIGDI
 10570     ELSE IF DFHEIGDJ EQUAL 17
 10571         GO TO 7300-EXIT
 10572         DEPENDING ON DFHEIGDI
 10573     ELSE IF DFHEIGDJ EQUAL 18
 10574         GO TO 8300-SEND-TEXT
 10575         DEPENDING ON DFHEIGDI.
 10576     MOVE '9%                    "   ' TO DFHEIV0
 10577     MOVE 'EL677' TO DFHEIV1
 10578     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10579     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      141500     Code:       38835
