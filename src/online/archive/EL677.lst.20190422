* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page   1
* EL677.cbl
* Options: int("EL677.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL677.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL677.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL677.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 ID DIVISION.
     3
     4 PROGRAM-ID.                 EL677.
     5*
     6*AUTHOR.     CSO
     7*            OMAHA, NEBRASKA.
     8
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page   2
* EL677.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*                                                                *
    17*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    TRANSACTION - EXF3 - CHECK MAINTENANCE
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    32* 021714  CR2014021700001  PEMA  ADD TEST DB FOR OTHER THAN cid1p
    33* 030414  IR2014030400001  PEMA  CHG PYAJ VOID TRANS TO R AND +
    34* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    35* 091615  CR2015082000001  PEMA  ADD TOTAL ENDT PROCESSING
    36* 020317  IR2016110900001  PEMA  FIXED MISC PROBLEMS
    37* 060717  CR2017032900002  PEMA  CHANGE TEST DB
    38* 111418  CR2018103100001  PEMA  ADD REISSUE CAPABILITY
    39******************************************************************
    40 ENVIRONMENT DIVISION.
    41
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*    EL677 WORKING STORAGE     *'.
    47 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    48 77  s1                          pic s999 comp-3 value +0.
    49 77  ws-tot-lf-prem              pic s9(7)v99 comp-3 value +0.
    50 77  ws-tot-iss-prem             pic s9(7)v99 comp-3 value +0.
    51 77  ws-tot-iss-comm             pic s9(7)v99 comp-3 value +0.
    52 77  ws-tot-ref-comm             pic s9(7)v99 comp-3 value +0.
    53 77  ws-browse-sw                pic x value spaces.
    54     88  i-say-when                 value 'Y'.
    55 77  ws-delete-sw                pic x value ' '.
    56     88  row-deleted                 value 'Y'.
    57 77  ws-sql-code                 pic s9(7) value zeros.
    58 77  ws-dis-sql-code             pic -9999999 value zeros.
    59 77  ws-match-sw                 pic x  value ' '.
    60     88  found-a-match             value 'Y'.
    61 77  ws-commit-sw                pic x value ' '.
    62     88  tbl-commited                value 'Y'.
    63 01  P pointer.
    64 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    65 01  var-ptr pointer.
    66 01  env-var-len                 pic 9(4)  binary.
    67
    68 01  WS-KIXSYS.
    69     05  WS-KIX-FIL1             PIC X(10).
    70     05  WS-KIX-APPS             PIC X(10).
    71     05  WS-KIX-ENV              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page   3
* EL677.cbl
    72     05  WS-KIX-MYENV            PIC X(10).
    73     05  WS-KIX-SYS              PIC X(10).
*   74 EXEC SQL
*   75    INCLUDE SQLDA
*   76 END-EXEC
    77 01 SQLDA sync.
    78    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    79    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    80    05 SQLN                  PIC S9(4) COMP-5 value 0.
    81    05 SQLD                  PIC S9(4) COMP-5 value 0.
    82    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    83       10 SQLTYPE            PIC S9(4) COMP-5.
    84       10 SQLLEN             PIC S9(4) COMP-5.
    85$IF P64 SET
    86X      *> For 64-bit environments, ensure that SQLDATA is
    87X      *> aligned on an 8-byte boundary.
    88X      10 FILLER             PIC S9(9) COMP-5.
    89$END
    90       10 SQLDATA            USAGE POINTER.
    91       10 SQLIND             USAGE POINTER.
    92       10 SQLNAME.
    93          15 SQLNAMEL        PIC S9(4) COMP-5.
    94          15 SQLNAMEC        PIC X(30).
    95
    96* Values for SQLTYPE
    97
    98 78  ESQL-DATE-CHAR              VALUE 384.
    99 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   100 78  ESQL-DATE-REC               VALUE 386.
   101 78  ESQL-DATE-REC-NULL          VALUE 387.
   102 78  ESQL-TIME-CHAR              VALUE 388.
   103 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   104 78  ESQL-TIME-REC               VALUE 390.
   105 78  ESQL-TIME-REC-NULL          VALUE 391.
   106 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   107 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   108 78  ESQL-TIMESTAMP-REC          VALUE 394.
   109 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   110 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   111 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   112 78  ESQL-TS-OFFSET-REC          VALUE 398.
   113 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   114 78  ESQL-LONGVARBINARY          VALUE 404.
   115 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   116 78  ESQL-LONGVARCHAR            VALUE 408.
   117 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   118 78  ESQL-BINARY                 VALUE 444.
   119 78  ESQL-BINARY-NULL            VALUE 445.
   120 78  ESQL-VARBINARY              VALUE 446.
   121 78  ESQL-VARBINARY-NULL         VALUE 447.
   122 78  ESQL-VARCHAR                VALUE 448.
   123 78  ESQL-VARCHAR-NULL           VALUE 449.
   124
   125 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   126 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   127
   128 78  ESQL-CHAR                   VALUE 452.
   129 78  ESQL-CHAR-NULL              VALUE 453.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page   4
* EL677.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130
   131 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   132 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   133
   134 78  ESQL-DOUBLE                 VALUE 480.
   135 78  ESQL-DOUBLE-NULL            VALUE 481.
   136 78  ESQL-REAL                   VALUE 482.
   137 78  ESQL-REAL-NULL              VALUE 483.
   138 78  ESQL-DECIMAL                VALUE 484.
   139 78  ESQL-DECIMAL-NULL           VALUE 485.
   140 78  ESQL-INTEGER                VALUE 496.
   141 78  ESQL-INTEGER-NULL           VALUE 497.
   142 78  ESQL-SMALLINT               VALUE 500.
   143 78  ESQL-SMALLINT-NULL          VALUE 501.
   144 78  ESQL-TINYINT                VALUE 502.
   145 78  ESQL-TINYINT-NULL           VALUE 503.
*  146 EXEC SQL
*  147    INCLUDE SQLCA
*  148 END-EXEC
   149 01 SQLCA.
   150     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   151     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   152     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   153     05  SQLERRM.
   154         49  SQLERRML    PIC S9(4) COMP-5.
   155         49  SQLERRMC    PIC X(70).
   156     05  SQLERRP         PIC X(8).
   157     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   158     05  SQLWARN.
   159         10  SQLWARN0    PIC X.
   160         10  SQLWARN1    PIC X.
   161         10  SQLWARN2    PIC X.
   162         10  SQLWARN3    PIC X.
   163         10  SQLWARN4    PIC X.
   164         10  SQLWARN5    PIC X.
   165         10  SQLWARN6    PIC X.
   166         10  SQLWARN7    PIC X.
   167     05  SQLEXT.
   168         10  SQLWARN8    PIC X.
   169         10  SQLWARN9    PIC X.
   170         10  SQLWARN10   PIC X.
   171         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   172     05  SQLSTATE    PIC X(5).
   173 EXEC SQL
   174    BEGIN DECLARE SECTION
   175 END-EXEC
   176 01  ws-paid-bank-work-area.
   177     05  ws-pb-compid            pic x(9).
   178     05  ws-pb-check-no          pic x(10).
   179     05  ws-pb-bad-check-no      pic x(10).
   180     05  ws-check-amount         pic x(10).
   181 01  Paid-Bank-Info.
   182     05  pb-check-no             pic 9(10).
   183     05  pb-tran-type            pic x.
   184     05  pb-bank-acct-desc       pic x(50).
   185     05  pb-amount               pic x(12).
   186     05  pb-paid-date            pic x(25).
   187 01  ws-key-stuff.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page   5
* EL677.cbl
   188     05  ws-compid               pic xxx.
   189     05  ws-carrier              pic x.
   190     05  ws-grouping             pic x(6).
   191     05  ws-state                pic xx.
   192     05  ws-account              pic x(10).
   193     05  ws-eff-date             pic x(10).
   194     05  ws-certificate          pic x(10).
   195     05  ws-cert-sfx             pic x.
   196     05  ws-seq-no               pic 999.
   197     05  ws-type                 pic x.
   198     05  ws-check-sub-type       pic x.
   199 01  svr                         pic x(32).
   200 01  usr                         pic x(32).
   201 01  pass                        pic x(32).
   202 01  usr-pass                    pic x(64).
   203 01  ws-disp-code                pic s9(11).
   204***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   205***                                                            ***
   206***  These indicators are used to determine if a variable      ***
   207***  is passed nulls from sql. The indicator will be -1        ***
   208***  if the value on sql is nulls and +0 if the value is       ***
   209***  something other than nulls. Here is an example on how     ***
   210***  to use the indicator variables.                           ***
   211***                                                            ***
   212***     EXEC SQL                                               ***
   213***        fetch checkapp into                                 ***
   214***           :db-app-status :nu-app-status,                   ***
   215***           :db-app-by     :nu-app-by,                       ***
   216***           :db-app-date   :nu-app-date,                     ***
   217***           :db-app-batch  :nu-app-batch                     ***
   218***     END-EXEC                                               ***
   219***                                                            ***
   220***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   221 01  indicator-vaiables-for-nulls.
   222     05  nu-app-status           pic s9(4) comp value +0.
   223     05  nu-app-by               pic s9(4) comp value +0.
   224     05  nu-app-date             pic s9(4) comp value +0.
   225     05  nu-app-batch            pic s9(4) comp value +0.
   226 01  daily-check-request-rec.
   227     05  db-compid               pic xxx.
   228     05  db-carrier              pic x.
   229     05  db-grouping             pic x(6).
   230     05  db-state                pic xx.
   231     05  db-account              pic x(10).
   232     05  db-effdate              pic x(10).
   233     05  db-certificate          pic x(10).
   234     05  db-cert-sfx             pic x.
   235     05  db-seq-no               pic 999.
   236     05  db-type                 pic x.
   237     05  db-amount-n             pic 9(7).99.
   238     05  db-amount redefines db-amount-n
   239                                 pic x(10).
   240     05  db-checkno              pic x(15).
   241     05  db-checkdate            pic x(10).
   242     05  db-checkstatus          pic 9(5).
   243     05  db-releasebatch         pic 9(5).
   244     05  db-releasedt            pic x(10).
   245     05  db-releaseby            pic x(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page   6
* EL677.cbl
   246     05  db-payeename1           pic x(30).
   247     05  db-payeename2           pic x(30).
   248     05  db-payeeaddr1           pic x(30).
   249     05  db-payeeaddr2           pic x(30).
   250     05  db-payeecity            pic x(30).
   251     05  db-payeest              pic xx.
   252     05  db-payeezip             pic x(10).
   253     05  db-fincar               pic x.
   254     05  db-fingrp               pic x(6).
   255     05  db-finresp              pic x(10).
   256     05  db-finacct              pic x(10).
   257     05  db-preparer             pic x(4).
   258     05  db-app-status           pic x(9).
   259     05  dp-app-status-n redefines db-app-status
   260                                 pic 9(9).
   261     05  db-app-by               pic x(20).
   262     05  db-app-date             pic x(30).
   263     05  db-app-batch            pic x(10).
   264     05  db-return-to            pic x(30).
   265     05  db-insured-name         pic x(30).
   266     05  db-check-sub-type       pic x.
   267 EXEC SQL
   268    END DECLARE SECTION
   269 END-EXEC
   270*                            COPY ELCSCTM.
   271******************************************************************
   272*                                                                *
   273*                                                                *
   274*                            ELCSCTM                             *
   275*                            VMOD=2.001                          *
   276*                                                                *
   277*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   278*                                                                *
   279******************************************************************
   280 01  SECURITY-MESSAGE.
   281     12  FILLER                          PIC X(30)
   282            VALUE '** LOGIC SECURITY VIOLATION -'.
   283     12  SM-READ                         PIC X(6).
   284     12  FILLER                          PIC X(5)
   285            VALUE ' PGM='.
   286     12  SM-PGM                          PIC X(6).
   287     12  FILLER                          PIC X(5)
   288            VALUE ' OPR='.
   289     12  SM-PROCESSOR-ID                 PIC X(4).
   290     12  FILLER                          PIC X(6)
   291            VALUE ' TERM='.
   292     12  SM-TERMID                       PIC X(4).
   293     12  FILLER                          PIC XX   VALUE SPACE.
   294     12  SM-JUL-DATE                     PIC 9(5).
   295     12  FILLER                          PIC X    VALUE SPACE.
   296     12  SM-TIME                         PIC 99.99.
   297
   298*                            COPY ELCSCRTY.
   299******************************************************************
   300*                                                                *
   301*                                                                *
   302*                            ELCSCRTY                            *
   303*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page   7
* EL677.cbl
   304*                                                                *
   305*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   306*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   307*        SAVED IN PI-SECURITY-ADDRESS.                           *
   308*                                                                *
   309******************************************************************
   310 01  SECURITY-CONTROL.
   311     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   312     12  FILLER                       PIC XX    VALUE 'SC'.
   313     12  SC-CREDIT-CODES.
   314         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   315             20  SC-CREDIT-DISPLAY    PIC X.
   316             20  SC-CREDIT-UPDATE     PIC X.
   317     12  SC-CLAIMS-CODES.
   318         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   319             20  SC-CLAIMS-DISPLAY    PIC X.
   320             20  SC-CLAIMS-UPDATE     PIC X.
   321 01  ws-dummy-erchek             pic x(600).
   322 01  filler.
   323     05  WS-CHECK-AMT-TMP        PIC Z(7).99.
   324     05  WS-CHECK-AMT-TMPX REDEFINES
   325         WS-CHECK-AMT-TMP        PIC X(10).
   326 01  ws-compare-erchek-key          pic x(33) value low-values.
   327 01  ws-eracct-sw                   pic x value ' '.
   328     88  eracct-found                 value 'Y'.
   329 01  ws-eracct-start-sw             pic x value ' '.
   330     88  eracct-start                 value 'Y'.
   331 01  WS-MISC-AREA.
   332     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   333     05  SAVE-CURRENT-DATE-MDY       PIC X(6)    VALUE SPACES.
   334     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   335
   336 01  ws-user-defined.
   337     05  ws-user-reason         pic xxx.
   338     05  ws-user-cert-no        pic x(11).
   339     05  ws-user-name           pic x(28).
   340 01  ws-hold-eracct-record       pic x(2000)  value spaces.
   341 01  STANDARD-AREAS.
   342     12  ws-connect-sw               pic x  value ' '.
   343         88  connected-to-db             value 'Y'.
   344     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
   345     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   346     12  EL677A                      PIC X(8)    VALUE 'EL677A'.
   347     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL677S'.
   348     12  SCREEN-NUMBER               PIC X(4)    VALUE '677A'.
   349     12  TRANS-ID                    PIC X(4)    VALUE 'EXF3'.
   350     12  EL6311-TRANS-ID             PIC X(4)    VALUE 'EXB1'.
   351     12  EL6318-TRANS-ID             PIC X(4)    VALUE 'EXBE'.
   352     12  THIS-PGM                    PIC X(8)    VALUE 'EL677'.
   353     12  PGM-NAME                    PIC X(8)   VALUE SPACES.
   354     12  TIME-IN                     PIC S9(7)  VALUE ZEROS.
   355     12  TIME-OUT-R  REDEFINES TIME-IN.
   356         16  FILLER                  PIC X.
   357         16  TIME-OUT                PIC 99V99.
   358         16  FILLER                  PIC XX.
   359     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   360     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   361     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page   8
* EL677.cbl
   362     12  XCTL-1273                   PIC X(8)    VALUE 'EL1273'.
   363     12  XCTL-114                    PIC X(8)    VALUE 'EL114'.
   364     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   365     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   366     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   367     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   368     12  ERACCT-FILE-ID              PIC X(8)    VALUE 'ERACCT'.
   369     12  ERCOMP-FILE-ID              PIC X(8)    VALUE 'ERCOMP'.
   370     12  ERCHEK-FILE-ID              PIC X(8)    VALUE 'ERCHEK'.
   371     12  ERPNDB-FILE-ID              PIC X(8)    VALUE 'ERPNDB'.
   372     12  ERPNDB-ALT-FILE-ID          PIC X(8)    VALUE 'ERPNDB2'.
   373     12  ELCERT-FILE-ID              PIC X(8)    VALUE 'ELCERT'.
   374     12  ERMAIL-FILE-ID              PIC X(8)    VALUE 'ERMAIL'.
   375     12  ERPYAJ-FILE-ID              PIC X(8)    VALUE 'ERPYAJ'.
   376     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +0    COMP.
   377     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   378     12  QID.
   379         16  QID-TERM                PIC X(4)    VALUE SPACES.
   380         16  FILLER                  PIC X(4)    VALUE '677A'.
   381
   382 01  WORK-AREAS.
   383     12  WS-AM-WORK                  PIC S9(8)V99 VALUE +0.
   384     12  WS-AM-WK REDEFINES WS-AM-WORK.
   385         16  WS-AM-NUM               PIC S9(7)V99.
   386         16  WS-AM-SIGN              PIC X.
   387     12  WS-CHECK-WORK.
   388         16  FILLER                  PIC X        VALUE SPACE.
   389         16  WS-CHECK-NO             PIC X(6)     VALUE SPACES.
   390     12  WS-CHK-PRINT-DT             PIC XX       VALUE LOW-VALUE.
   391     12  WS-SV-AMOUNT-PAID           PIC S9(7)V99 VALUE +0.
   392     12  WS-AMT                      PIC S9(7)V99 VALUE +0.
   393     12  WS-REFUND-AMOUNT            PIC S9(7)V99 VALUE +0.
   394     12  WS-DEEDIT-FIELD             PIC S9(9)V99 VALUE +0.
   395     12  WS-DT-DEEDIT-FIELD          PIC X(10)   VALUE ZERO.
   396     12  WS-DEEDIT-FIELD-DATE        REDEFINES
   397         WS-DT-DEEDIT-FIELD.
   398         16  FILLER                  PIC X(4).
   399         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   400     12  WS-DEEDIT-FIELD-A           PIC X(15)   VALUE ZERO.
   401     12  WS-DEEDIT-FIELD-V0          REDEFINES
   402         WS-DEEDIT-FIELD-A           PIC S9(15).
   403
   404     12  WS-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   405     12  WS-CERT-FOUND-SW            PIC X       VALUE 'N'.
   406         88 WS-CERT-FOUND                        VALUE 'Y'.
   407         88 WS-CERT-NOT-FOUND                    VALUE 'N'.
   408     12  WS-PNDB-FOUND-SW            PIC X       VALUE 'N'.
   409         88 WS-PNDB-FOUND                        VALUE 'Y'.
   410         88 WS-PNDB-NOT-FOUND                    VALUE 'N'.
   411     12  WS-PROCESS-CERT-SW          PIC X       VALUE SPACE.
   412         88  WS-PROCESS-CERT                     VALUE 'Y'.
   413     12  WS-PROCESS-BENEFICIARY-SW   PIC X       VALUE SPACE.
   414         88  WS-PROCESS-BENEFICIARY              VALUE 'Y'.
   415     12  WS-TMS-ENTRY-COMMENT.
   416         16  WS-TMS-PY-CERT          PIC X(10)   VALUE SPACES.
   417         16  FILLER                  PIC XX      VALUE SPACES.
   418         16  WS-TMS-PY-PAYEE         PIC X(18)   VALUE SPACES.
   419     12  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page   9
* EL677.cbl
   420         16  WS-ZIP-PRIME.
   421             20  WS-ZIP-PRI-1ST      PIC X.
   422                 88  WS-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   423             20  FILLER              PIC X(4).
   424         16  WS-ZIP-PLUS4            PIC X(4).
   425     12  WS-CANADIAN-POST-CODE1  REDEFINES  WS-ZIP-CODE.
   426         16  WS-CAN-POST1-1          PIC XXX.
   427         16  WS-CAN-POST1-2.
   428             20  WS-CAN-POST-4TH     PIC X.
   429             20  FILLER              PIC XX.
   430         16  FILLER                  PIC XXX.
   431     12  WS-CANADIAN-POST-CODE2  REDEFINES  WS-ZIP-CODE.
   432         16  WS-CAN-POST2-1          PIC XXX.
   433         16  FILLER                  PIC X.
   434         16  WS-CAN-POST2-2          PIC XXX.
   435         16  FILLER                  PIC XX.
   436
   437*                                    COPY ELCNWA.
   438*****************************************************************
   439*                                                               *
   440*                                                               *
   441*                            ELCNWA.                            *
   442*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   443*                            VMOD=2.003                         *
   444*                                                               *
   445*            M O V E   N A M E   W O R K   A R E A.             *
   446*                                                               *
   447*****************************************************************.
   448
   449 01  WS-NAME-WORK-AREA.
   450     05  WS-INSURED-LAST-NAME        PIC X(15).
   451     05  WS-INSURED-1ST-NAME         PIC X(12).
   452     05  WS-INSURED-MID-INIT         PIC X.
   453
   454     05  WS-NAME-WORK.
   455         10  WS-NW                   PIC X
   456             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   457
   458     05  WS-NAME-WORK2.
   459         10  WS-NW2                  PIC X
   460             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   461                                        NWA-INDEX0.
   462
   463     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   464                                     COMP-3.
   465
   466 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   467     88  RESP-NORMAL                    VALUE +0.
   468     88  resp-file-notfnd               value +12.
   469     88  RESP-NOTFND                    VALUE +13.
   470     88  resp-duprec                    value +14.
   471     88  resp-dupkey                    value +15.
   472     88  resp-invreq                    value +16.
   473     88  RESP-NOTOPEN                   VALUE +19.
   474     88  RESP-ENDFILE                   VALUE +20.
   475     88  resp-lengtherr                 value +22.
   476 01  ACCESS-KEYS.
   477     12  ELCNTL-KEY.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  10
* EL677.cbl
   478         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   479         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   480         16 ELCNTL-ACCESS.
   481             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   482             20  FILLER              PIC X       VALUE SPACES.
   483             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   484         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   485
   486     12  ERACCT-KEY.
   487         16  ERACCT-CO               PIC X       VALUE SPACES.
   488         16  ERACCT-CARRIER          PIC X       VALUE SPACES.
   489         16  ERACCT-GROUPING         PIC X(6)    VALUE SPACES.
   490         16  ERACCT-STATE            PIC XX      VALUE SPACES.
   491         16  ERACCT-ACCOUNT          PIC X(10)   VALUE SPACES.
   492         16  ERACCT-EXP-DATE         PIC XX      VALUE SPACES.
   493         16  ERACCT-EXP-DATE-FILLER  PIC X(4)    VALUE SPACES.
   494
   495     12  SAVE-ERACCT-KEY.
   496         16  SV-ACCT-CO              PIC X       VALUE SPACES.
   497         16  SV-ACCT-CARRIER         PIC X       VALUE SPACES.
   498         16  SV-ACCT-GROUPING        PIC X(6)    VALUE SPACES.
   499         16  SV-ACCT-STATE           PIC XX      VALUE SPACES.
   500         16  SV-ACCT-ACCOUNT         PIC X(10)   VALUE SPACES.
   501         16  SV-ACCT-EXP-DATE        PIC XX      VALUE SPACES.
   502         16  SV-ACCT-EXP-DATE-FILLER PIC X(4)    VALUE SPACES.
   503
   504     12  ERCOMP-KEY.
   505         16  ERCOMP-COMP-CD          PIC X       VALUE SPACE.
   506         16  ERCOMP-CARRIER          PIC X       VALUE SPACES.
   507         16  ERCOMP-GROUPING         PIC X(6)    VALUE SPACES.
   508         16  ERCOMP-FIN-RESP         PIC X(10)   VALUE SPACES.
   509         16  ERCOMP-ACCOUNT          PIC X(10)   VALUE SPACES.
   510         16  ERCOMP-RECORD-TYPE      PIC X       VALUE SPACES.
   511
   512     12  ELCERT-KEY.
   513         16 ELCERT-COMPANY-CD        PIC X       VALUE SPACES.
   514         16 ELCERT-CARRIER           PIC X       VALUE SPACES.
   515         16 ELCERT-GROUPING          PIC X(6)    VALUE SPACES.
   516         16 ELCERT-STATE             PIC XX      VALUE SPACES.
   517         16 ELCERT-ACCOUNT           PIC X(10)   VALUE SPACES.
   518         16 ELCERT-CERT-EFF-DT       PIC XX      VALUE SPACES.
   519         16 ELCERT-CERT-PRIME        PIC X(10)   VALUE SPACES.
   520         16 ELCERT-CERT-SFX          PIC X       VALUE SPACES.
   521
   522     12  ERPNDB-PRIMARY-KEY.
   523         16 ERPNDB-COMPANY-CD        PIC X       VALUE SPACES.
   524         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   525         16 ERPNDB-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   526         16 ERPNDB-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   527
   528     12  ERPNDB-ALT-KEY.
   529         16 ERPNDB-ALT-COMPANY-CD    PIC X       VALUE SPACES.
   530         16 ERPNDB-ALT-CARRIER       PIC X       VALUE SPACES.
   531         16 ERPNDB-ALT-GROUPING      PIC X(6)    VALUE SPACES.
   532         16 ERPNDB-ALT-STATE         PIC XX      VALUE SPACES.
   533         16 ERPNDB-ALT-ACCOUNT       PIC X(10)   VALUE SPACES.
   534         16 ERPNDB-ALT-CERT-EFF-DT   PIC XX      VALUE SPACES.
   535         16 ERPNDB-ALT-CERT-PRIME    PIC X(10)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  11
* EL677.cbl
   536         16 ERPNDB-ALT-CERT-SFX      PIC X       VALUE SPACES.
   537         16 ERPNDB-ALT-CH-SEQ-NO     PIC S9(4)   VALUE +0    COMP.
   538         16 ERPNDB-ALT-RECORD-TYPE   PIC X       VALUE SPACE.
   539
   540     12  ERCHEK-KEY.
   541         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   542         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   543         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   544         16  CHEK-STATE              PIC XX      VALUE SPACES.
   545         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   546         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   547         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   548         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   549         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   550
   551     12  ERCHEK-RECORD-LENGTH        PIC S9(4)   VALUE +600  COMP.
   552     12  ERPYAJ-KEY.
   553         16 PYAJ-COMPANY-CD          PIC X       VALUE LOW-VALUES.
   554         16 PYAJ-CARRIER             PIC X       VALUE SPACE.
   555         16 PYAJ-GROUPING            PIC X(06)   VALUE SPACES.
   556         16 PYAJ-FIN-RESP            PIC X(10)   VALUE SPACES.
   557         16 PYAJ-ACCOUNT             PIC X(10)   VALUE SPACES.
   558         16 PYAJ-FILE-SEQ-NO         PIC S9(8)   VALUE +0  COMP.
   559         16 PYAJ-RECORD-TYPE         PIC X       VALUE SPACE.
   560
   561 01  ERROR-NUMBERS.
   562     12  ER-0000                 PIC X(4)    VALUE '0000'.
   563     12  ER-0004                 PIC X(4)    VALUE '0004'.
   564     12  ER-0013                 PIC X(4)    VALUE '0013'.
   565     12  ER-0022                 PIC X(4)    VALUE '0022'.
   566     12  ER-0023                 PIC X(4)    VALUE '0023'.
   567     12  ER-0029                 PIC X(4)    VALUE '0029'.
   568     12  ER-0070                 PIC X(4)    VALUE '0070'.
   569     12  ER-0194                 PIC X(4)    VALUE '0194'.
   570     12  ER-0195                 PIC X(4)    VALUE '0195'.
   571     12  ER-0196                 PIC X(4)    VALUE '0196'.
   572     12  ER-0197                 PIC X(4)    VALUE '0197'.
   573     12  ER-0203                 PIC X(4)    VALUE '0203'.
   574     12  ER-0215                 PIC X(4)    VALUE '0215'.
   575     12  ER-0216                 PIC X(4)    VALUE '0216'.
   576     12  ER-0433                 PIC X(4)    VALUE '0433'.
   577     12  ER-1159                 PIC X(4)    VALUE '1159'.
   578     12  ER-1162                 PIC X(4)    VALUE '1162'.
   579     12  ER-2056                 PIC X(4)    VALUE '2056'.
   580     12  ER-2208                 PIC X(4)    VALUE '2208'.
   581     12  ER-2209                 PIC X(4)    VALUE '2209'.
   582     12  ER-2210                 PIC X(4)    VALUE '2210'.
   583     12  ER-2230                 PIC X(4)    VALUE '2230'.
   584     12  ER-2237                 PIC X(4)    VALUE '2237'.
   585     12  ER-2238                 PIC X(4)    VALUE '2238'.
   586     12  ER-2394                 PIC X(4)    VALUE '2394'.
   587     12  ER-2583                 PIC X(4)    VALUE '2583'.
   588     12  ER-2600                 PIC X(4)    VALUE '2600'.
   589     12  ER-2726                 PIC X(4)    VALUE '2726'.
   590     12  ER-2907                 PIC X(4)    VALUE '2907'.
   591     12  ER-2908                 PIC X(4)    VALUE '2908'.
   592     12  ER-3044                 PIC X(4)    VALUE '3044'.
   593     12  ER-3046                 PIC X(4)    VALUE '3046'.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  12
* EL677.cbl
   594     12  er-3274                 pic x(4)    value '3274'.
   595     12  er-3450                 pic x(4)    value '3450'.
   596     12  er-3451                 pic x(4)    value '3451'.
   597     12  er-3452                 pic x(4)    value '3452'.
   598     12  er-3453                 pic x(4)    value '3453'.
   599     12  er-3454                 pic x(4)    value '3454'.
   600     12  er-3455                 pic x(4)    value '3455'.
   601     12  er-3459                 pic x(4)    value '3459'.
   602     12  er-3460                 pic x(4)    value '3460'.
   603     12  er-9999                 pic x(4)    value '9999'.
   604*                                COPY ELCLOGOF.
   605******************************************************************
   606*                                                                *
   607*                                                                *
   608*                            ELCLOGOF.                           *
   609*                            VMOD=2.001                          *
   610*                                                                *
   611*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   612*                                                                *
   613******************************************************************
   614 01  CLASIC-LOGOFF.
   615     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   616     12  LOGOFF-TEXT.
   617         16  FILLER          PIC X(5)    VALUE SPACES.
   618         16  LOGOFF-MSG.
   619             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   620             20  FILLER      PIC X       VALUE SPACES.
   621             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   622         16  FILLER          PIC X(80)
   623           VALUE '* YOU ARE NOW LOGGED OFF'.
   624         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   625         16  FILLER          PIC X       VALUE QUOTE.
   626         16  LOGOFF-SYS-MSG  PIC X(17)
   627           VALUE 'S CLAS-IC SYSTEM '.
   628     12  TEXT-MESSAGES.
   629         16  UNACCESS-MSG    PIC X(29)
   630             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   631         16  PGMIDERR-MSG    PIC X(17)
   632             VALUE 'PROGRAM NOT FOUND'.
   633*                                COPY ELCDATE.
   634******************************************************************
   635*                                                                *
   636*                                                                *
   637*                            ELCDATE.                            *
   638*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   639*                            VMOD=2.003
   640*                                                                *
   641*                                                                *
   642*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   643*                 LENGTH = 200                                   *
   644******************************************************************
   645
   646 01  DATE-CONVERSION-DATA.
   647     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   648     12  DC-OPTION-CODE                PIC X.
   649         88  BIN-TO-GREG                VALUE ' '.
   650         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   651         88  EDIT-GREG-TO-BIN           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  13
* EL677.cbl
   652         88  YMD-GREG-TO-BIN            VALUE '3'.
   653         88  MDY-GREG-TO-BIN            VALUE '4'.
   654         88  JULIAN-TO-BIN              VALUE '5'.
   655         88  BIN-PLUS-ELAPSED           VALUE '6'.
   656         88  FIND-CENTURY               VALUE '7'.
   657         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   658         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   659         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   660         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   661         88  JULIAN-TO-BIN-3            VALUE 'C'.
   662         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   663         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   664         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   665         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   666         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   667         88  CHECK-LEAP-YEAR            VALUE 'H'.
   668         88  BIN-3-TO-GREG              VALUE 'I'.
   669         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   670         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   671         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   672         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   673         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   674         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   675         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   676         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   677         88  THREE-CHARACTER-BIN
   678                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   679         88  GREGORIAN-TO-BIN
   680                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   681         88  BIN-TO-GREGORIAN
   682                  VALUES ' ' '1' 'I' '8' 'G'.
   683         88  JULIAN-TO-BINARY
   684                  VALUES '5' 'C' 'E' 'F'.
   685     12  DC-ERROR-CODE                 PIC X.
   686         88  NO-CONVERSION-ERROR        VALUE ' '.
   687         88  DATE-CONVERSION-ERROR
   688                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   689         88  DATE-IS-ZERO               VALUE '1'.
   690         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   691         88  DATE-IS-INVALID            VALUE '3'.
   692         88  DATE1-GREATER-DATE2        VALUE '4'.
   693         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   694         88  DATE-INVALID-OPTION        VALUE '9'.
   695         88  INVALID-CENTURY            VALUE 'A'.
   696         88  ONLY-CENTURY               VALUE 'B'.
   697         88  ONLY-LEAP-YEAR             VALUE 'C'.
   698         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   699     12  DC-END-OF-MONTH               PIC X.
   700         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   701     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   702         88  USE-NORMAL-PROCESS         VALUE ' '.
   703         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   704         88  ADJUST-UP-100-YRS          VALUE '2'.
   705     12  FILLER                        PIC X.
   706     12  DC-CONVERSION-DATES.
   707         16  DC-BIN-DATE-1             PIC XX.
   708         16  DC-BIN-DATE-2             PIC XX.
   709         16  DC-GREG-DATE-1-EDIT       PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  14
* EL677.cbl
   710         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   711                       DC-GREG-DATE-1-EDIT.
   712             20  DC-EDIT1-MONTH        PIC 99.
   713             20  SLASH1-1              PIC X.
   714             20  DC-EDIT1-DAY          PIC 99.
   715             20  SLASH1-2              PIC X.
   716             20  DC-EDIT1-YEAR         PIC 99.
   717         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   718         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   719                     DC-GREG-DATE-2-EDIT.
   720             20  DC-EDIT2-MONTH        PIC 99.
   721             20  SLASH2-1              PIC X.
   722             20  DC-EDIT2-DAY          PIC 99.
   723             20  SLASH2-2              PIC X.
   724             20  DC-EDIT2-YEAR         PIC 99.
   725         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   726         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   727                     DC-GREG-DATE-1-YMD.
   728             20  DC-YMD-YEAR           PIC 99.
   729             20  DC-YMD-MONTH          PIC 99.
   730             20  DC-YMD-DAY            PIC 99.
   731         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   732         16  DC-GREG-DATE-1-MDY-R REDEFINES
   733                      DC-GREG-DATE-1-MDY.
   734             20  DC-MDY-MONTH          PIC 99.
   735             20  DC-MDY-DAY            PIC 99.
   736             20  DC-MDY-YEAR           PIC 99.
   737         16  DC-GREG-DATE-1-ALPHA.
   738             20  DC-ALPHA-MONTH        PIC X(10).
   739             20  DC-ALPHA-DAY          PIC 99.
   740             20  FILLER                PIC XX.
   741             20  DC-ALPHA-CENTURY.
   742                 24 DC-ALPHA-CEN-N     PIC 99.
   743             20  DC-ALPHA-YEAR         PIC 99.
   744         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   745         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   746         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   747         16  DC-JULIAN-DATE            PIC 9(05).
   748         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   749                                       PIC 9(05).
   750         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   751             20  DC-JULIAN-YEAR        PIC 99.
   752             20  DC-JULIAN-DAYS        PIC 999.
   753         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   754         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   755         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   756     12  DATE-CONVERSION-VARIBLES.
   757         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   758         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   759             20  FILLER                PIC 9(3).
   760             20  HOLD-CEN-1-CCYY.
   761                 24  HOLD-CEN-1-CC     PIC 99.
   762                 24  HOLD-CEN-1-YY     PIC 99.
   763             20  HOLD-CEN-1-MO         PIC 99.
   764             20  HOLD-CEN-1-DA         PIC 99.
   765         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   766             20  HOLD-CEN-1-R-MO       PIC 99.
   767             20  HOLD-CEN-1-R-DA       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  15
* EL677.cbl
   768             20  HOLD-CEN-1-R-CCYY.
   769                 24  HOLD-CEN-1-R-CC   PIC 99.
   770                 24  HOLD-CEN-1-R-YY   PIC 99.
   771             20  FILLER                PIC 9(3).
   772         16  HOLD-CENTURY-1-X.
   773             20  FILLER                PIC X(3)  VALUE SPACES.
   774             20  HOLD-CEN-1-X-CCYY.
   775                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   776                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   777             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   778             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   779         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   780             20  HOLD-CEN-1-R-X-MO     PIC XX.
   781             20  HOLD-CEN-1-R-X-DA     PIC XX.
   782             20  HOLD-CEN-1-R-X-CCYY.
   783                 24  HOLD-CEN-1-R-X-CC PIC XX.
   784                 24  HOLD-CEN-1-R-X-YY PIC XX.
   785             20  FILLER                PIC XXX.
   786         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   787         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   788         16  DC-JULIAN-DATE-1          PIC 9(07).
   789         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   790             20  DC-JULIAN-1-CCYY.
   791                 24  DC-JULIAN-1-CC    PIC 99.
   792                 24  DC-JULIAN-1-YR    PIC 99.
   793             20  DC-JULIAN-DA-1        PIC 999.
   794         16  DC-JULIAN-DATE-2          PIC 9(07).
   795         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   796             20  DC-JULIAN-2-CCYY.
   797                 24  DC-JULIAN-2-CC    PIC 99.
   798                 24  DC-JULIAN-2-YR    PIC 99.
   799             20  DC-JULIAN-DA-2        PIC 999.
   800         16  DC-GREG-DATE-A-EDIT.
   801             20  DC-EDITA-MONTH        PIC 99.
   802             20  SLASHA-1              PIC X VALUE '/'.
   803             20  DC-EDITA-DAY          PIC 99.
   804             20  SLASHA-2              PIC X VALUE '/'.
   805             20  DC-EDITA-CCYY.
   806                 24  DC-EDITA-CENT     PIC 99.
   807                 24  DC-EDITA-YEAR     PIC 99.
   808         16  DC-GREG-DATE-B-EDIT.
   809             20  DC-EDITB-MONTH        PIC 99.
   810             20  SLASHB-1              PIC X VALUE '/'.
   811             20  DC-EDITB-DAY          PIC 99.
   812             20  SLASHB-2              PIC X VALUE '/'.
   813             20  DC-EDITB-CCYY.
   814                 24  DC-EDITB-CENT     PIC 99.
   815                 24  DC-EDITB-YEAR     PIC 99.
   816         16  DC-GREG-DATE-CYMD         PIC 9(08).
   817         16  DC-GREG-DATE-CYMD-R REDEFINES
   818                              DC-GREG-DATE-CYMD.
   819             20  DC-CYMD-CEN           PIC 99.
   820             20  DC-CYMD-YEAR          PIC 99.
   821             20  DC-CYMD-MONTH         PIC 99.
   822             20  DC-CYMD-DAY           PIC 99.
   823         16  DC-GREG-DATE-MDCY         PIC 9(08).
   824         16  DC-GREG-DATE-MDCY-R REDEFINES
   825                              DC-GREG-DATE-MDCY.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  16
* EL677.cbl
   826             20  DC-MDCY-MONTH         PIC 99.
   827             20  DC-MDCY-DAY           PIC 99.
   828             20  DC-MDCY-CEN           PIC 99.
   829             20  DC-MDCY-YEAR          PIC 99.
   830    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   831        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   832    12  DC-EL310-DATE                  PIC X(21).
   833    12  FILLER                         PIC X(28).
   834*                                COPY ELCATTR.
   835******************************************************************
   836*                                                                *
   837*                            ELCATTR.                            *
   838*                            VMOD=2.001                          *
   839*                                                                *
   840*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   841*                                                                *
   842*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   843*                                                                *
   844*                   POS 1   P=PROTECTED                          *
   845*                           U=UNPROTECTED                        *
   846*                           S=ASKIP                              *
   847*                   POS 2   A=ALPHA/NUMERIC                      *
   848*                           N=NUMERIC                            *
   849*                   POS 3   N=NORMAL                             *
   850*                           B=BRIGHT                             *
   851*                           D=DARK                               *
   852*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   853*                           OF=MODIFIED DATA TAG OFF             *
   854*                                                                *
   855*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   856******************************************************************
   857 01  ATTRIBUTE-LIST.
   858     12  AL-PABOF            PIC X       VALUE 'Y'.
   859     12  AL-PABON            PIC X       VALUE 'Z'.
   860     12  AL-PADOF            PIC X       VALUE '%'.
   861     12  AL-PADON            PIC X       VALUE '_'.
   862     12  AL-PANOF            PIC X       VALUE '-'.
   863     12  AL-PANON            PIC X       VALUE '/'.
   864     12  AL-SABOF            PIC X       VALUE '8'.
   865     12  AL-SABON            PIC X       VALUE '9'.
   866     12  AL-SADOF            PIC X       VALUE '@'.
   867     12  AL-SADON            PIC X       VALUE QUOTE.
   868     12  AL-SANOF            PIC X       VALUE '0'.
   869     12  AL-SANON            PIC X       VALUE '1'.
   870     12  AL-UABOF            PIC X       VALUE 'H'.
   871     12  AL-UABON            PIC X       VALUE 'I'.
   872     12  AL-UADOF            PIC X       VALUE '<'.
   873     12  AL-UADON            PIC X       VALUE '('.
   874     12  AL-UANOF            PIC X       VALUE ' '.
   875     12  AL-UANON            PIC X       VALUE 'A'.
   876     12  AL-UNBOF            PIC X       VALUE 'Q'.
   877     12  AL-UNBON            PIC X       VALUE 'R'.
   878     12  AL-UNDOF            PIC X       VALUE '*'.
   879     12  AL-UNDON            PIC X       VALUE ')'.
   880     12  AL-UNNOF            PIC X       VALUE '&'.
   881     12  AL-UNNON            PIC X       VALUE 'J'.
   882*                                COPY ELCEMIB.
   883******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  17
* EL677.cbl
   884*                                                                *
   885*                                                                *
   886*                            ELCEMIB.                            *
   887*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   888*                            VMOD=2.005                          *
   889*                                                                *
   890*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   891*                                                                *
   892******************************************************************
   893 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   894     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   895     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   896     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   897     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   898     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   899     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   900     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   901     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   902     12  EMI-SWITCH1             PIC X        VALUE '1'.
   903         88  EMI-NO-ERRORS                    VALUE '1'.
   904         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   905         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   906     12  EMI-SWITCH2             PIC X        VALUE '1'.
   907         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   908     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   909         88  EMI-AREA1-EMPTY                  VALUE '1'.
   910         88  EMI-AREA1-FULL                   VALUE '2'.
   911     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   912         88  EMI-AREA2-EMPTY                  VALUE '1'.
   913         88  EMI-AREA2-FULL                   VALUE '2'.
   914     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   915         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   916         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   917         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   918         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   919         88  EMI-BYPASS-FATALS                VALUE 'X'.
   920     12  EMI-ERROR-LINES.
   921         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   922         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   923         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   924         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   925             20  EMI-ERR-CODES OCCURS 10 TIMES.
   926                 24  EMI-ERR-NUM         PIC X(4).
   927                 24  EMI-FILLER          PIC X.
   928                 24  EMI-SEV             PIC X.
   929                 24  FILLER              PIC X.
   930             20  FILLER                  PIC X(02).
   931     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   932         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   933             20  EMI-ERROR-NUMBER    PIC X(4).
   934             20  EMI-FILL            PIC X.
   935             20  EMI-SEVERITY        PIC X.
   936             20  FILLER              PIC X.
   937             20  EMI-ERROR-TEXT.
   938                 24  EMI-TEXT-VARIABLE   PIC X(10).
   939                 24  FILLER          PIC X(55).
   940     12  EMI-SEVERITY-SAVE           PIC X.
   941         88  EMI-NOTE                    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  18
* EL677.cbl
   942         88  EMI-WARNING                 VALUE 'W'.
   943         88  EMI-FORCABLE                VALUE 'F'.
   944         88  EMI-FATAL                   VALUE 'X'.
   945     12  EMI-MESSAGE-FLAG            PIC X.
   946         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   947         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   948     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   949     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   950         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   951         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   952         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   953     12  emi-claim-no                pic x(7).
   954     12  emi-claim-type              pic x(6).
   955     12  FILLER                      PIC X(124)  VALUE SPACES.
   956     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   957     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   958     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   959     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   960*                                COPY ELCINTF.
   961******************************************************************
   962*                                                                *
   963*                                                                *
   964*                            ELCINTF.                            *
   965*                            VMOD=2.017                          *
   966*                                                                *
   967*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   968*                                                                *
   969*       LENGTH = 1024                                            *
   970*                                                                *
   971******************************************************************
   972*                   C H A N G E   L O G
   973*
   974* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   975*-----------------------------------------------------------------
   976*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   977* EFFECTIVE    NUMBER
   978*-----------------------------------------------------------------
   979* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   980******************************************************************
   981 01  PROGRAM-INTERFACE-BLOCK.
   982     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   983     12  PI-CALLING-PROGRAM              PIC X(8).
   984     12  PI-SAVED-PROGRAM-1              PIC X(8).
   985     12  PI-SAVED-PROGRAM-2              PIC X(8).
   986     12  PI-SAVED-PROGRAM-3              PIC X(8).
   987     12  PI-SAVED-PROGRAM-4              PIC X(8).
   988     12  PI-SAVED-PROGRAM-5              PIC X(8).
   989     12  PI-SAVED-PROGRAM-6              PIC X(8).
   990     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   991     12  PI-COMPANY-ID                   PIC XXX.
   992     12  PI-COMPANY-CD                   PIC X.
   993
   994     12  PI-COMPANY-PASSWORD             PIC X(8).
   995
   996     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   997
   998     12  PI-CONTROL-IN-PROGRESS.
   999         16  PI-CARRIER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  19
* EL677.cbl
  1000         16  PI-GROUPING                 PIC X(6).
  1001         16  PI-STATE                    PIC XX.
  1002         16  PI-ACCOUNT                  PIC X(10).
  1003         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1004                                         PIC X(10).
  1005         16  PI-CLAIM-CERT-GRP.
  1006             20  PI-CLAIM-NO             PIC X(7).
  1007             20  PI-CERT-NO.
  1008                 25  PI-CERT-PRIME       PIC X(10).
  1009                 25  PI-CERT-SFX         PIC X.
  1010             20  PI-CERT-EFF-DT          PIC XX.
  1011         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1012             20  PI-PLAN-CODE            PIC X(2).
  1013             20  PI-REVISION-NUMBER      PIC X(3).
  1014             20  PI-PLAN-EFF-DT          PIC X(2).
  1015             20  PI-PLAN-EXP-DT          PIC X(2).
  1016             20  FILLER                  PIC X(11).
  1017         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1018             20  PI-OE-REFERENCE-1.
  1019                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1020                 25  PI-OE-REF-1-SUFF    PIC XX.
  1021
  1022     12  PI-SESSION-IN-PROGRESS          PIC X.
  1023         88  CLAIM-SESSION                   VALUE '1'.
  1024         88  CREDIT-SESSION                  VALUE '2'.
  1025         88  WARRANTY-SESSION                VALUE '3'.
  1026         88  MORTGAGE-SESSION                VALUE '4'.
  1027         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1028
  1029
  1030*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1031
  1032     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1033     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1034
  1035     12  PI-CREDIT-USER                  PIC X.
  1036         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1037         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1038
  1039     12  PI-CLAIM-USER                   PIC X.
  1040         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1041         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1042
  1043     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1044         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1045         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1046         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1047         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1048         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1049
  1050     12  PI-PROCESSOR-ID                 PIC X(4).
  1051
  1052     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1053
  1054     12  PI-MEMBER-CAPTION               PIC X(10).
  1055
  1056     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1057         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  20
* EL677.cbl
  1058
  1059     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1060     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1061     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1062     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1063
  1064     12  PI-AH-OVERRIDE-L1               PIC X.
  1065     12  PI-AH-OVERRIDE-L2               PIC XX.
  1066     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1067     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1068
  1069     12  PI-NEW-SYSTEM                   PIC X(2).
  1070
  1071     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1072     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1073         88  PI-USES-PAID-TO                 VALUE '1'.
  1074     12  PI-CRDTCRD-SYSTEM.
  1075         16  PI-CRDTCRD-USER             PIC X.
  1076             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1077             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1078         16  PI-CC-MONTH-END-DT          PIC XX.
  1079     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1080
  1081     12  PI-OE-REFERENCE-2.
  1082         16  PI-OE-REF-2-PRIME           PIC X(10).
  1083         16  PI-OE-REF-2-SUFF            PIC X.
  1084
  1085     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1086
  1087     12  PI-LANGUAGE-TYPE                PIC X.
  1088             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1089             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1090             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1091
  1092     12  PI-POLICY-LINKAGE-IND           PIC X.
  1093         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1094         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1095                                                   LOW-VALUES.
  1096
  1097     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1098     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1099         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1100         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1101
  1102     12  PI-PROCESSOR-CSR-IND            PIC X.
  1103         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1104         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1105
  1106     12  FILLER                          PIC X(3).
  1107
  1108     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1109
  1110     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1111         PI-SYSTEM-LEVEL.
  1112
  1113         16  PI-ENTRY-CODES.
  1114             20  PI-ENTRY-CD-1           PIC X.
  1115             20  PI-ENTRY-CD-2           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  21
* EL677.cbl
  1116
  1117         16  PI-RETURN-CODES.
  1118             20  PI-RETURN-CD-1          PIC X.
  1119             20  PI-RETURN-CD-2          PIC X.
  1120
  1121         16  PI-UPDATE-STATUS-SAVE.
  1122             20  PI-UPDATE-BY            PIC X(4).
  1123             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1124
  1125         16  PI-LOWER-CASE-LETTERS       PIC X.
  1126             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1127
  1128*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1129*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1130*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1131
  1132         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1133             88  ST-ACCNT-CNTL               VALUE ' '.
  1134             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1135             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1136             88  ACCNT-CNTL                  VALUE '3'.
  1137             88  CARR-ACCNT-CNTL             VALUE '4'.
  1138
  1139         16  PI-PROCESSOR-CAP-LIST.
  1140             20  PI-SYSTEM-CONTROLS.
  1141                24 PI-SYSTEM-DISPLAY     PIC X.
  1142                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1143                24 PI-SYSTEM-MODIFY      PIC X.
  1144                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1145             20  FILLER                  PIC XX.
  1146             20  PI-DISPLAY-CAP          PIC X.
  1147                 88  DISPLAY-CAP             VALUE 'Y'.
  1148             20  PI-MODIFY-CAP           PIC X.
  1149                 88  MODIFY-CAP              VALUE 'Y'.
  1150             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1151                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1152             20  PI-FORCE-CAP            PIC X.
  1153                 88  FORCE-CAP               VALUE 'Y'.
  1154
  1155         16  PI-PROGRAM-CONTROLS.
  1156             20  PI-PGM-PRINT-OPT        PIC X.
  1157             20  PI-PGM-FORMAT-OPT       PIC X.
  1158             20  PI-PGM-PROCESS-OPT      PIC X.
  1159             20  PI-PGM-TOTALS-OPT       PIC X.
  1160
  1161         16  PI-HELP-INTERFACE.
  1162             20  PI-LAST-ERROR-NO        PIC X(4).
  1163             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1164
  1165         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1166             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1167
  1168         16  PI-CR-CONTROL-IN-PROGRESS.
  1169             20  PI-CR-CARRIER           PIC X.
  1170             20  PI-CR-GROUPING          PIC X(6).
  1171             20  PI-CR-STATE             PIC XX.
  1172             20  PI-CR-ACCOUNT           PIC X(10).
  1173             20  PI-CR-FIN-RESP          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  22
* EL677.cbl
  1174             20  PI-CR-TYPE              PIC X.
  1175
  1176         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1177
  1178         16  PI-CR-MONTH-END-DT          PIC XX.
  1179
  1180         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1181             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1182             88  PI-ZERO-CARRIER             VALUE '1'.
  1183             88  PI-ZERO-GROUPING            VALUE '2'.
  1184             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1185
  1186         16  PI-CARRIER-SECURITY         PIC X.
  1187             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1188
  1189         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1190             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1191             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1192
  1193         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1194             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1195                                         INDEXED BY PI-ACCESS-NDX
  1196                                         PIC X.
  1197
  1198         16  PI-GA-BILLING-CONTROL       PIC X.
  1199             88  PI-GA-BILLING               VALUE '1'.
  1200
  1201         16  PI-MAIL-PROCESSING          PIC X.
  1202             88  PI-MAIL-YES                 VALUE 'Y'.
  1203
  1204         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1205
  1206         16  PI-AR-SYSTEM.
  1207             20  PI-AR-PROCESSING-CNTL   PIC X.
  1208                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1209             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1210             20  PI-AR-MONTH-END-DT      PIC XX.
  1211
  1212         16  PI-MP-SYSTEM.
  1213             20  PI-MORTGAGE-USER            PIC X.
  1214                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1215                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1216             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1217                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1218                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1219                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1220                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1221                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1222             20  PI-MP-MONTH-END-DT          PIC XX.
  1223             20  PI-MP-REFERENCE-NO.
  1224                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1225                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1226
  1227         16  PI-LABEL-CONTROL            PIC X(01).
  1228             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1229             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1230
  1231         16  PI-BILL-GROUPING-CODE       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  23
* EL677.cbl
  1232             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1233
  1234         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1235             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1236             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1237
  1238         16  FILLER                      PIC X(14).
  1239
  1240     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1241******************************************************************
  1242     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1243         16  PI-EOF-SW               PIC X.
  1244             88  PI-FILE-EOF                     VALUE 'Y'.
  1245         16  PI-PREV-MAINT           PIC X.
  1246         16  PI-WORK-SEQ-NO          PIC S9(9)   COMP-3.
  1247         16  PI-ERCHEK-KEY.
  1248             20  PI-CHEK-COMP-CD     PIC X.
  1249             20  PI-CHEK-CARRIER     PIC X.
  1250             20  PI-CHEK-GROUPING    PIC X(6).
  1251             20  PI-CHEK-STATE       PIC XX.
  1252             20  PI-CHEK-ACCOUNT     PIC X(10).
  1253             20  PI-CHEK-EFF-DT      PIC XX.
  1254             20  PI-CHEK-CERT-NO     PIC X(10).
  1255             20  PI-CHEK-SUF-NO      PIC X.
  1256             20  PI-CHEK-SEQUENCE    PIC S9(4)  COMP.
  1257         16  PI-ACCOUNT-ADDRESS.
  1258             20  PI-AM-NAME          PIC X(30).
  1259             20  PI-AM-ADDRS         PIC X(30).
  1260             20  PI-AM-CITY-st.
  1261                 24  pi-am-city      PIC X(28).
  1262                 24  pi-am-st        pic xx.
  1263             20  PI-AM-ZIP-CODE.
  1264                 24  PI-AM-ZIP-PRIME PIC X(5).
  1265                 24  PI-AM-ZIP-PLUS4 PIC X(4).
  1266         16  PI-PROCESS-CERT-SW          PIC X.
  1267             88  PI-PROCESS-CERT                     VALUE 'Y'.
  1268         16  PI-PROCESS-BENEFICIARY-SW   PIC X.
  1269             88  PI-PROCESS-BENEFICIARY              VALUE 'Y'.
  1270         16  PI-PAYTO1                   PIC X(30).
  1271         16  PI-REFERENCE                PIC X(12).
  1272         16  PI-CANC-DT                  PIC XX.
  1273         16  PI-LF-REFUND                PIC S9(7)V99  COMP-3.
  1274         16  PI-AH-REFUND                PIC S9(7)V99  COMP-3.
  1275         16  PI-INSURED-NAME             PIC X(28).
  1276         16  PI-PFKEY                    PIC XXX.
  1277             88  PI-TO-EL1273-FROM-EL677        VALUE 'PF3'.
  1278             88  PI-TO-EL677-FROM-EL1273        VALUE 'PF8'.
  1279         16  PI-AMOUNT                   PIC S9(9)V99  COMP-3.
  1280         16  PI-TYPE                     PIC X.
  1281         16  pi-prev-paid                pic s9(7)v99 comp-3.
  1282         16  pi-refund-on-pending-rec    pic s9(7)v99 comp-3.
  1283         16  pi-ue-comm                  pic s9(7)v99 comp-3.
  1284         16  pi-chek-rec-cnt             pic s999 comp-3.
  1285         16  pi-am-csr                   pic x(4).
  1286         16  pi-return-to                pic x(30).
  1287         16  pi-prev-ded-comm            pic x.
  1288         16  pi-table-name               pic x(30).
  1289         16  pi-check-cashed             pic x.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  24
* EL677.cbl
  1290         16  pi-endt-prm-diff            pic s9(7)v99 comp-3.
  1291         16  pi-endt-com-diff            pic s9(5)v99 comp-3.
  1292         16  pi-check-type               pic x.
  1293             88  pi-corr-check              value 'C'.
  1294             88  pi-ref-check               value 'R'.
  1295         16  pi-check-cut                pic x.
  1296         16  pi-prev-paid-this-month     pic s9(7)v99 comp-3.
  1297         16  pi-previous-deduct-comm     pic x.
  1298         16  pi-void-reissue-pass        pic x.
  1299             88  pi-void-complete           value '1'.
  1300             88  pi-address-selected        value '2'.
  1301         16  pi-void-reissue-amt         pic s9(7)v99 comp-3.
  1302         16  FILLER                      PIC X(304). *> wass 311
  1303*                                    COPY ELCAID.
  1304******************************************************************
  1305*                                                                *
  1306*                            ELCAID.                             *
  1307*                            VMOD=2.001                          *
  1308*                                                                *
  1309*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1310*                                                                *
  1311*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1312*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1313******************************************************************
  1314
  1315 01  DFHAID.
  1316   02  DFHNULL   PIC  X  VALUE  ' '.
  1317   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1318   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1319   02  DFHPEN    PIC  X  VALUE  '='.
  1320   02  DFHOPID   PIC  X  VALUE  'W'.
  1321   02  DFHPA1    PIC  X  VALUE  '%'.
  1322   02  DFHPA2    PIC  X  VALUE  '>'.
  1323   02  DFHPA3    PIC  X  VALUE  ','.
  1324   02  DFHPF1    PIC  X  VALUE  '1'.
  1325   02  DFHPF2    PIC  X  VALUE  '2'.
  1326   02  DFHPF3    PIC  X  VALUE  '3'.
  1327   02  DFHPF4    PIC  X  VALUE  '4'.
  1328   02  DFHPF5    PIC  X  VALUE  '5'.
  1329   02  DFHPF6    PIC  X  VALUE  '6'.
  1330   02  DFHPF7    PIC  X  VALUE  '7'.
  1331   02  DFHPF8    PIC  X  VALUE  '8'.
  1332   02  DFHPF9    PIC  X  VALUE  '9'.
  1333   02  DFHPF10   PIC  X  VALUE  ':'.
  1334   02  DFHPF11   PIC  X  VALUE  '#'.
  1335   02  DFHPF12   PIC  X  VALUE  '@'.
  1336   02  DFHPF13   PIC  X  VALUE  'A'.
  1337   02  DFHPF14   PIC  X  VALUE  'B'.
  1338   02  DFHPF15   PIC  X  VALUE  'C'.
  1339   02  DFHPF16   PIC  X  VALUE  'D'.
  1340   02  DFHPF17   PIC  X  VALUE  'E'.
  1341   02  DFHPF18   PIC  X  VALUE  'F'.
  1342   02  DFHPF19   PIC  X  VALUE  'G'.
  1343   02  DFHPF20   PIC  X  VALUE  'H'.
  1344   02  DFHPF21   PIC  X  VALUE  'I'.
  1345*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1346   02  DFHPF22   PIC  X  VALUE  '['.
  1347   02  DFHPF23   PIC  X  VALUE  '.'.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  25
* EL677.cbl
  1348   02  DFHPF24   PIC  X  VALUE  '<'.
  1349   02  DFHMSRE   PIC  X  VALUE  'X'.
  1350   02  DFHSTRF   PIC  X  VALUE  'h'.
  1351   02  DFHTRIG   PIC  X  VALUE  '"'.
  1352 01  FILLER    REDEFINES DFHAID.
  1353     12  FILLER                      PIC X(8).
  1354     12  PF-VALUES                   PIC X       OCCURS 24.
  1355     12  FILLER                      PIC X(3).
  1356*                                    COPY EL677S.
  1357 01  EL677AI.
  1358     05  FILLER            PIC  X(0012).
  1359*    -------------------------------
  1360     05  DATEL PIC S9(0004) COMP.
  1361     05  DATEF PIC  X(0001).
  1362     05  FILLER REDEFINES DATEF.
  1363         10  DATEA PIC  X(0001).
  1364     05  DATEI PIC  X(0008).
  1365*    -------------------------------
  1366     05  TIMEL PIC S9(0004) COMP.
  1367     05  TIMEF PIC  X(0001).
  1368     05  FILLER REDEFINES TIMEF.
  1369         10  TIMEA PIC  X(0001).
  1370     05  TIMEI PIC  X(0005).
  1371*    -------------------------------
  1372     05  MAINTL PIC S9(0004) COMP.
  1373     05  MAINTF PIC  X(0001).
  1374     05  FILLER REDEFINES MAINTF.
  1375         10  MAINTA PIC  X(0001).
  1376     05  MAINTI PIC  X(0001).
  1377*    -------------------------------
  1378     05  DMAINT1L PIC S9(0004) COMP.
  1379     05  DMAINT1F PIC  X(0001).
  1380     05  FILLER REDEFINES DMAINT1F.
  1381         10  DMAINT1A PIC  X(0001).
  1382     05  DMAINT1I PIC  X(0009).
  1383*    -------------------------------
  1384     05  DMAINT2L PIC S9(0004) COMP.
  1385     05  DMAINT2F PIC  X(0001).
  1386     05  FILLER REDEFINES DMAINT2F.
  1387         10  DMAINT2A PIC  X(0001).
  1388     05  DMAINT2I PIC  X(0029).
  1389*    -------------------------------
  1390     05  CARRIERL PIC S9(0004) COMP.
  1391     05  CARRIERF PIC  X(0001).
  1392     05  FILLER REDEFINES CARRIERF.
  1393         10  CARRIERA PIC  X(0001).
  1394     05  CARRIERI PIC  X(0001).
  1395*    -------------------------------
  1396     05  GROUPL PIC S9(0004) COMP.
  1397     05  GROUPF PIC  X(0001).
  1398     05  FILLER REDEFINES GROUPF.
  1399         10  GROUPA PIC  X(0001).
  1400     05  GROUPI PIC  X(0006).
  1401*    -------------------------------
  1402     05  STATEL PIC S9(0004) COMP.
  1403     05  STATEF PIC  X(0001).
  1404     05  FILLER REDEFINES STATEF.
  1405         10  STATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  26
* EL677.cbl
  1406     05  STATEI PIC  X(0002).
  1407*    -------------------------------
  1408     05  ACCTL PIC S9(0004) COMP.
  1409     05  ACCTF PIC  X(0001).
  1410     05  FILLER REDEFINES ACCTF.
  1411         10  ACCTA PIC  X(0001).
  1412     05  ACCTI PIC  X(0010).
  1413*    -------------------------------
  1414     05  EFFDTL PIC S9(0004) COMP.
  1415     05  EFFDTF PIC  X(0001).
  1416     05  FILLER REDEFINES EFFDTF.
  1417         10  EFFDTA PIC  X(0001).
  1418     05  EFFDTI PIC  X(0008).
  1419*    -------------------------------
  1420     05  CERTNOL PIC S9(0004) COMP.
  1421     05  CERTNOF PIC  X(0001).
  1422     05  FILLER REDEFINES CERTNOF.
  1423         10  CERTNOA PIC  X(0001).
  1424     05  CERTNOI PIC  X(0010).
  1425*    -------------------------------
  1426     05  SFXL PIC S9(0004) COMP.
  1427     05  SFXF PIC  X(0001).
  1428     05  FILLER REDEFINES SFXF.
  1429         10  SFXA PIC  X(0001).
  1430     05  SFXI PIC  X(0001).
  1431*    -------------------------------
  1432     05  SEQL PIC S9(0004) COMP.
  1433     05  SEQF PIC  X(0001).
  1434     05  FILLER REDEFINES SEQF.
  1435         10  SEQA PIC  X(0001).
  1436     05  SEQI PIC  99.
  1437*    -------------------------------
  1438     05  PAYTO1L PIC S9(0004) COMP.
  1439     05  PAYTO1F PIC  X(0001).
  1440     05  FILLER REDEFINES PAYTO1F.
  1441         10  PAYTO1A PIC  X(0001).
  1442     05  PAYTO1I PIC  X(0030).
  1443*    -------------------------------
  1444     05  CREATEDL PIC S9(0004) COMP.
  1445     05  CREATEDF PIC  X(0001).
  1446     05  FILLER REDEFINES CREATEDF.
  1447         10  CREATEDA PIC  X(0001).
  1448     05  CREATEDI PIC  X(0008).
  1449*    -------------------------------
  1450     05  CBYL PIC S9(0004) COMP.
  1451     05  CBYF PIC  X(0001).
  1452     05  FILLER REDEFINES CBYF.
  1453         10  CBYA PIC  X(0001).
  1454     05  CBYI PIC  X(0004).
  1455*    -------------------------------
  1456     05  PAYTO2L PIC S9(0004) COMP.
  1457     05  PAYTO2F PIC  X(0001).
  1458     05  FILLER REDEFINES PAYTO2F.
  1459         10  PAYTO2A PIC  X(0001).
  1460     05  PAYTO2I PIC  X(0030).
  1461*    -------------------------------
  1462     05  PAYEEL PIC S9(0004) COMP.
  1463     05  PAYEEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  27
* EL677.cbl
  1464     05  FILLER REDEFINES PAYEEF.
  1465         10  PAYEEA PIC  X(0001).
  1466     05  PAYEEI PIC  X(0006).
  1467*    -------------------------------
  1468     05  APVSTATL PIC S9(0004) COMP.
  1469     05  APVSTATF PIC  X(0001).
  1470     05  FILLER REDEFINES APVSTATF.
  1471         10  APVSTATA PIC  X(0001).
  1472     05  APVSTATI PIC  X(0009).
  1473*    -------------------------------
  1474     05  PAYAD1L PIC S9(0004) COMP.
  1475     05  PAYAD1F PIC  X(0001).
  1476     05  FILLER REDEFINES PAYAD1F.
  1477         10  PAYAD1A PIC  X(0001).
  1478     05  PAYAD1I PIC  X(0030).
  1479*    -------------------------------
  1480     05  APVDTL PIC S9(0004) COMP.
  1481     05  APVDTF PIC  X(0001).
  1482     05  FILLER REDEFINES APVDTF.
  1483         10  APVDTA PIC  X(0001).
  1484     05  APVDTI PIC  X(0008).
  1485*    -------------------------------
  1486     05  APVBYL PIC S9(0004) COMP.
  1487     05  APVBYF PIC  X(0001).
  1488     05  FILLER REDEFINES APVBYF.
  1489         10  APVBYA PIC  X(0001).
  1490     05  APVBYI PIC  X(0004).
  1491*    -------------------------------
  1492     05  PAYAD2L PIC S9(0004) COMP.
  1493     05  PAYAD2F PIC  X(0001).
  1494     05  FILLER REDEFINES PAYAD2F.
  1495         10  PAYAD2A PIC  X(0001).
  1496     05  PAYAD2I PIC  X(0030).
  1497*    -------------------------------
  1498     05  VOIDEDL PIC S9(0004) COMP.
  1499     05  VOIDEDF PIC  X(0001).
  1500     05  FILLER REDEFINES VOIDEDF.
  1501         10  VOIDEDA PIC  X(0001).
  1502     05  VOIDEDI PIC  X(0008).
  1503*    -------------------------------
  1504     05  VBYL PIC S9(0004) COMP.
  1505     05  VBYF PIC  X(0001).
  1506     05  FILLER REDEFINES VBYF.
  1507         10  VBYA PIC  X(0001).
  1508     05  VBYI PIC  X(0004).
  1509*    -------------------------------
  1510     05  PAYCTYL PIC S9(0004) COMP.
  1511     05  PAYCTYF PIC  X(0001).
  1512     05  FILLER REDEFINES PAYCTYF.
  1513         10  PAYCTYA PIC  X(0001).
  1514     05  PAYCTYI PIC  X(0028).
  1515*    -------------------------------
  1516     05  PAYSTL PIC S9(0004) COMP.
  1517     05  PAYSTF PIC  X(0001).
  1518     05  FILLER REDEFINES PAYSTF.
  1519         10  PAYSTA PIC  X(0001).
  1520     05  PAYSTI PIC  X(0002).
  1521*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  28
* EL677.cbl
  1522     05  PRINTEDL PIC S9(0004) COMP.
  1523     05  PRINTEDF PIC  X(0001).
  1524     05  FILLER REDEFINES PRINTEDF.
  1525         10  PRINTEDA PIC  X(0001).
  1526     05  PRINTEDI PIC  X(0008).
  1527*    -------------------------------
  1528     05  PTOZIPL PIC S9(0004) COMP.
  1529     05  PTOZIPF PIC  X(0001).
  1530     05  FILLER REDEFINES PTOZIPF.
  1531         10  PTOZIPA PIC  X(0001).
  1532     05  PTOZIPI PIC  X(0009).
  1533*    -------------------------------
  1534     05  DEDCYNL PIC S9(0004) COMP.
  1535     05  DEDCYNF PIC  X(0001).
  1536     05  FILLER REDEFINES DEDCYNF.
  1537         10  DEDCYNA PIC  X(0001).
  1538     05  DEDCYNI PIC  X(0001).
  1539*    -------------------------------
  1540     05  CASHEDL PIC S9(0004) COMP.
  1541     05  CASHEDF PIC  X(0001).
  1542     05  FILLER REDEFINES CASHEDF.
  1543         10  CASHEDA PIC  X(0001).
  1544     05  CASHEDI PIC  X(0008).
  1545*    -------------------------------
  1546     05  RETTOL PIC S9(0004) COMP.
  1547     05  RETTOF PIC  X(0001).
  1548     05  FILLER REDEFINES RETTOF.
  1549         10  RETTOA PIC  X(0001).
  1550     05  RETTOI PIC  X(0030).
  1551*    -------------------------------
  1552     05  DPREML PIC S9(0004) COMP.
  1553     05  DPREMF PIC  X(0001).
  1554     05  FILLER REDEFINES DPREMF.
  1555         10  DPREMA PIC  X(0001).
  1556     05  DPREMI PIC  X(0005).
  1557*    -------------------------------
  1558     05  PREML PIC S9(0004) COMP.
  1559     05  PREMF PIC  X(0001).
  1560     05  FILLER REDEFINES PREMF.
  1561         10  PREMA PIC  X(0001).
  1562     05  PREMI PIC  X(0008).
  1563*    -------------------------------
  1564     05  DCOMML PIC S9(0004) COMP.
  1565     05  DCOMMF PIC  X(0001).
  1566     05  FILLER REDEFINES DCOMMF.
  1567         10  DCOMMA PIC  X(0001).
  1568     05  DCOMMI PIC  X(0005).
  1569*    -------------------------------
  1570     05  ISSCOMML PIC S9(0004) COMP.
  1571     05  ISSCOMMF PIC  X(0001).
  1572     05  FILLER REDEFINES ISSCOMMF.
  1573         10  ISSCOMMA PIC  X(0001).
  1574     05  ISSCOMMI PIC  X(0008).
  1575*    -------------------------------
  1576     05  DREFL PIC S9(0004) COMP.
  1577     05  DREFF PIC  X(0001).
  1578     05  FILLER REDEFINES DREFF.
  1579         10  DREFA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  29
* EL677.cbl
  1580     05  DREFI PIC  X(0004).
  1581*    -------------------------------
  1582     05  REFL PIC S9(0004) COMP.
  1583     05  REFF PIC  X(0001).
  1584     05  FILLER REDEFINES REFF.
  1585         10  REFA PIC  X(0001).
  1586     05  REFI PIC  X(0008).
  1587*    -------------------------------
  1588     05  DUECOMML PIC S9(0004) COMP.
  1589     05  DUECOMMF PIC  X(0001).
  1590     05  FILLER REDEFINES DUECOMMF.
  1591         10  DUECOMMA PIC  X(0001).
  1592     05  DUECOMMI PIC  X(0007).
  1593*    -------------------------------
  1594     05  UECOMML PIC S9(0004) COMP.
  1595     05  UECOMMF PIC  X(0001).
  1596     05  FILLER REDEFINES UECOMMF.
  1597         10  UECOMMA PIC  X(0001).
  1598     05  UECOMMI PIC  X(0008).
  1599*    -------------------------------
  1600     05  DPREPDL PIC S9(0004) COMP.
  1601     05  DPREPDF PIC  X(0001).
  1602     05  FILLER REDEFINES DPREPDF.
  1603         10  DPREPDA PIC  X(0001).
  1604     05  DPREPDI PIC  X(0006).
  1605*    -------------------------------
  1606     05  PREPDL PIC S9(0004) COMP.
  1607     05  PREPDF PIC  X(0001).
  1608     05  FILLER REDEFINES PREPDF.
  1609         10  PREPDA PIC  X(0001).
  1610     05  PREPDI PIC  X(0008).
  1611*    -------------------------------
  1612     05  AMOUNTL PIC S9(0004) COMP.
  1613     05  AMOUNTF PIC  X(0001).
  1614     05  FILLER REDEFINES AMOUNTF.
  1615         10  AMOUNTA PIC  X(0001).
  1616     05  AMOUNTI PIC  S9(9)V99.
  1617*    -------------------------------
  1618     05  CHECKL PIC S9(0004) COMP.
  1619     05  CHECKF PIC  X(0001).
  1620     05  FILLER REDEFINES CHECKF.
  1621         10  CHECKA PIC  X(0001).
  1622     05  CHECKI PIC  X(0007).
  1623*    -------------------------------
  1624     05  TYPEL PIC S9(0004) COMP.
  1625     05  TYPEF PIC  X(0001).
  1626     05  FILLER REDEFINES TYPEF.
  1627         10  TYPEA PIC  X(0001).
  1628     05  TYPEI PIC  X(0001).
  1629*    -------------------------------
  1630     05  REASONL PIC S9(0004) COMP.
  1631     05  REASONF PIC  X(0001).
  1632     05  FILLER REDEFINES REASONF.
  1633         10  REASONA PIC  X(0001).
  1634     05  REASONI PIC  X(0025).
  1635*    -------------------------------
  1636     05  VREASONL PIC S9(0004) COMP.
  1637     05  VREASONF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  30
* EL677.cbl
  1638     05  FILLER REDEFINES VREASONF.
  1639         10  VREASONA PIC  X(0001).
  1640     05  VREASONI PIC  X(0024).
  1641*    -------------------------------
  1642     05  STUBL PIC S9(0004) COMP.
  1643     05  STUBF PIC  X(0001).
  1644     05  FILLER REDEFINES STUBF.
  1645         10  STUBA PIC  X(0001).
  1646     05  STUBI PIC  X(0030).
  1647*    -------------------------------
  1648     05  TEXT1L PIC S9(0004) COMP.
  1649     05  TEXT1F PIC  X(0001).
  1650     05  FILLER REDEFINES TEXT1F.
  1651         10  TEXT1A PIC  X(0001).
  1652     05  TEXT1I PIC  X(0050).
  1653*    -------------------------------
  1654     05  TEXT2L PIC S9(0004) COMP.
  1655     05  TEXT2F PIC  X(0001).
  1656     05  FILLER REDEFINES TEXT2F.
  1657         10  TEXT2A PIC  X(0001).
  1658     05  TEXT2I PIC  X(0050).
  1659*    -------------------------------
  1660     05  TEXT3L PIC S9(0004) COMP.
  1661     05  TEXT3F PIC  X(0001).
  1662     05  FILLER REDEFINES TEXT3F.
  1663         10  TEXT3A PIC  X(0001).
  1664     05  TEXT3I PIC  X(0040).
  1665*    -------------------------------
  1666     05  ERRMSG1L PIC S9(0004) COMP.
  1667     05  ERRMSG1F PIC  X(0001).
  1668     05  FILLER REDEFINES ERRMSG1F.
  1669         10  ERRMSG1A PIC  X(0001).
  1670     05  ERRMSG1I PIC  X(0079).
  1671*    -------------------------------
  1672     05  ERRMSG2L PIC S9(0004) COMP.
  1673     05  ERRMSG2F PIC  X(0001).
  1674     05  FILLER REDEFINES ERRMSG2F.
  1675         10  ERRMSG2A PIC  X(0001).
  1676     05  ERRMSG2I PIC  X(0079).
  1677*    -------------------------------
  1678     05  PFENTERL PIC S9(0004) COMP.
  1679     05  PFENTERF PIC  X(0001).
  1680     05  FILLER REDEFINES PFENTERF.
  1681         10  PFENTERA PIC  X(0001).
  1682     05  PFENTERI PIC  9(2).
  1683*    -------------------------------
  1684     05  PF3L PIC S9(0004) COMP.
  1685     05  PF3F PIC  X(0001).
  1686     05  FILLER REDEFINES PF3F.
  1687         10  PF3A PIC  X(0001).
  1688     05  PF3I PIC  X(0016).
  1689*    -------------------------------
  1690     05  PF57L PIC S9(0004) COMP.
  1691     05  PF57F PIC  X(0001).
  1692     05  FILLER REDEFINES PF57F.
  1693         10  PF57A PIC  X(0001).
  1694     05  PF57I PIC  X(0030).
  1695*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  31
* EL677.cbl
  1696     05  PF4L PIC S9(0004) COMP.
  1697     05  PF4F PIC  X(0001).
  1698     05  FILLER REDEFINES PF4F.
  1699         10  PF4A PIC  X(0001).
  1700     05  PF4I PIC  X(0018).
  1701*    -------------------------------
  1702     05  PF6L PIC S9(0004) COMP.
  1703     05  PF6F PIC  X(0001).
  1704     05  FILLER REDEFINES PF6F.
  1705         10  PF6A PIC  X(0001).
  1706     05  PF6I PIC  X(0013).
  1707 01  EL677AO REDEFINES EL677AI.
  1708     05  FILLER            PIC  X(0012).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  DATEO PIC  X(0008).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  TIMEO PIC  99.99.
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  MAINTO PIC  X(0001).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  DMAINT1O PIC  X(0009).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  DMAINT2O PIC  X(0029).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  CARRIERO PIC  X(0001).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  GROUPO PIC  X(0006).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  STATEO PIC  X(0002).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  ACCTO PIC  X(0010).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  EFFDTO PIC  99B99B99.
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  CERTNOO PIC  X(0010).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  SFXO PIC  X(0001).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  SEQO PIC  99.
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  PAYTO1O PIC  X(0030).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  CREATEDO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  32
* EL677.cbl
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  CBYO PIC  X(0004).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  PAYTO2O PIC  X(0030).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  PAYEEO PIC  X(0006).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  APVSTATO PIC  X(0009).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  PAYAD1O PIC  X(0030).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  APVDTO PIC  X(0008).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  APVBYO PIC  X(0004).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  PAYAD2O PIC  X(0030).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  VOIDEDO PIC  X(0008).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  VBYO PIC  X(0004).
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  PAYCTYO PIC  X(0028).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
  1789     05  PAYSTO PIC  X(0002).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  PRINTEDO PIC  99B99B99.
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  PTOZIPO PIC  X(0009).
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  DEDCYNO PIC  X(0001).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  CASHEDO PIC  X(0008).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  RETTOO PIC  X(0030).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  DPREMO PIC  X(0005).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  PREMO PIC  Z(5).99.
  1811*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  33
* EL677.cbl
  1812     05  FILLER            PIC  X(0003).
  1813     05  DCOMMO PIC  X(0005).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  ISSCOMMO PIC  Z(5).99.
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  DREFO PIC  X(0004).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  REFO PIC  Z(5).99.
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  DUECOMMO PIC  X(0007).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  UECOMMO PIC  Z(5).99.
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  DPREPDO PIC  X(0006).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  PREPDO PIC  Z(5).99.
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  AMOUNTO PIC  Z(7).ZZ-.
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  CHECKO PIC  X(0007).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  TYPEO PIC  X(0001).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  REASONO PIC  X(0025).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  VREASONO PIC  X(0024).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  STUBO PIC  X(0030).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  TEXT1O PIC  X(0050).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  TEXT2O PIC  X(0050).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  TEXT3O PIC  X(0040).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  ERRMSG1O PIC  X(0079).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  ERRMSG2O PIC  X(0079).
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  34
* EL677.cbl
  1870     05  PFENTERO PIC  99.
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  PF3O PIC  X(0016).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  PF57O PIC  X(0030).
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  PF4O PIC  X(0018).
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  PF6O PIC  X(0013).
  1883*    -------------------------------
  1884****************************************************************
  1885*
  1886* Copyright (c) 2007-2013 Dell Inc.
  1887* All rights reserved.
  1888*
  1889****************************************************************
  1890 01  DFHEIV.
  1891   02  DFHEIV0               PIC X(35).
  1892   02  DFHEIV1               PIC X(08).
  1893   02  DFHEIV2               PIC X(08).
  1894   02  DFHEIV3               PIC X(08).
  1895   02  DFHEIV4               PIC X(06).
  1896   02  DFHEIV5               PIC X(04).
  1897   02  DFHEIV6               PIC X(04).
  1898   02  DFHEIV7               PIC X(02).
  1899   02  DFHEIV8               PIC X(02).
  1900   02  DFHEIV9               PIC X(01).
  1901   02  DFHEIV10              PIC S9(7) COMP-3.
  1902   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1903   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1904   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1905   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1906   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1907   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1908   02  DFHEIV17              PIC X(04).
  1909   02  DFHEIV18              PIC X(04).
  1910   02  DFHEIV19              PIC X(04).
  1911   02  DFHEIV20              USAGE IS POINTER.
  1912   02  DFHEIV21              USAGE IS POINTER.
  1913   02  DFHEIV22              USAGE IS POINTER.
  1914   02  DFHEIV23              USAGE IS POINTER.
  1915   02  DFHEIV24              USAGE IS POINTER.
  1916   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1917   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1918   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1919   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1920   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1921   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1922   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1923   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1924   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1925   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1926   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1927   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  35
* EL677.cbl
  1928   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1929   02  FILLER                PIC X(02).
  1930   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1931   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1932   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1933   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1934   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1935   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1936   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1937 LINKAGE  SECTION.
  1938*****************************************************************
  1939*                                                               *
  1940* Copyright (c) 2007-2013 Dell Inc.                             *
  1941* All rights reserved.                                          *
  1942*                                                               *
  1943*****************************************************************
  1944 01  dfheiblk.
  1945     02  eibtime          pic s9(7) comp-3.
  1946     02  eibdate          pic s9(7) comp-3.
  1947     02  eibtrnid         pic x(4).
  1948     02  eibtaskn         pic s9(7) comp-3.
  1949     02  eibtrmid         pic x(4).
  1950     02  dfheigdi         pic s9(4) comp.
  1951     02  eibcposn         pic s9(4) comp.
  1952     02  eibcalen         pic s9(4) comp.
  1953     02  eibaid           pic x(1).
  1954     02  eibfiller1       pic x(1).
  1955     02  eibfn            pic x(2).
  1956     02  eibfiller2       pic x(2).
  1957     02  eibrcode         pic x(6).
  1958     02  eibfiller3       pic x(2).
  1959     02  eibds            pic x(8).
  1960     02  eibreqid         pic x(8).
  1961     02  eibrsrce         pic x(8).
  1962     02  eibsync          pic x(1).
  1963     02  eibfree          pic x(1).
  1964     02  eibrecv          pic x(1).
  1965     02  eibsend          pic x(1).
  1966     02  eibatt           pic x(1).
  1967     02  eibeoc           pic x(1).
  1968     02  eibfmh           pic x(1).
  1969     02  eibcompl         pic x(1).
  1970     02  eibsig           pic x(1).
  1971     02  eibconf          pic x(1).
  1972     02  eiberr           pic x(1).
  1973     02  eibrldbk         pic x(1).
  1974     02  eiberrcd         pic x(4).
  1975     02  eibsynrb         pic x(1).
  1976     02  eibnodat         pic x(1).
  1977     02  eibfiller5       pic x(2).
  1978     02  eibresp          pic s9(8) comp.
  1979     02  eibresp2         pic s9(8) comp.
  1980     02  dfheigdj         pic s9(4) comp.
  1981     02  dfheigdk         pic s9(4) comp.
  1982 01  DFHCOMMAREA.
  1983     05  filler                  PIC X(1024).
  1984 01  var  pic x(30).
  1985*                                COPY ELCCNTL.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  36
* EL677.cbl
  1986******************************************************************
  1987*                                                                *
  1988*                                                                *
  1989*                            ELCCNTL.                            *
  1990*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1991*                            VMOD=2.059                          *
  1992*                                                                *
  1993*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1994*                                                                *
  1995*   FILE TYPE = VSAM,KSDS                                        *
  1996*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1997*                                                                *
  1998*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1999*       ALTERNATE INDEX = NONE                                   *
  2000*                                                                *
  2001*   LOG = YES                                                    *
  2002*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2003******************************************************************
  2004*                   C H A N G E   L O G
  2005*
  2006* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2007*-----------------------------------------------------------------
  2008*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2009* EFFECTIVE    NUMBER
  2010*-----------------------------------------------------------------
  2011* 082503                   PEMA  ADD BENEFIT GROUP
  2012* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2013* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2014* 092705    2005050300006  PEMA  ADD SPP LEASES
  2015* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2016* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2017* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2018* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2019* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2020* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2021* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2022* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2023* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2024* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2025* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2026******************************************************************
  2027*
  2028 01  CONTROL-FILE.
  2029     12  CF-RECORD-ID                       PIC XX.
  2030         88  VALID-CF-ID                        VALUE 'CF'.
  2031
  2032     12  CF-CONTROL-PRIMARY.
  2033         16  CF-COMPANY-ID                  PIC XXX.
  2034         16  CF-RECORD-TYPE                 PIC X.
  2035             88  CF-COMPANY-MASTER              VALUE '1'.
  2036             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2037             88  CF-STATE-MASTER                VALUE '3'.
  2038             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2039             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2040             88  CF-CARRIER-MASTER              VALUE '6'.
  2041             88  CF-MORTALITY-MASTER            VALUE '7'.
  2042             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2043             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  37
* EL677.cbl
  2044             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2045             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2046             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2047             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2048             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2049             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2050             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2051             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2052             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2053         16  CF-ACCESS-CD-GENL              PIC X(4).
  2054         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2055             20  CF-PROCESSOR               PIC X(4).
  2056         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2057             20  CF-STATE-CODE              PIC XX.
  2058             20  FILLER                     PIC XX.
  2059         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2060             20  FILLER                     PIC XX.
  2061             20  CF-HI-BEN-IN-REC           PIC XX.
  2062         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2063             20  FILLER                     PIC XXX.
  2064             20  CF-CARRIER-CNTL            PIC X.
  2065         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2066             20  FILLER                     PIC XX.
  2067             20  CF-HI-TYPE-IN-REC          PIC 99.
  2068         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2069             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2070                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2071             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2072             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2073         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2074             20  FILLER                     PIC X.
  2075             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2076         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2077             20  FILLER                     PIC XX.
  2078             20  CF-MORTGAGE-PLAN           PIC XX.
  2079         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2080
  2081     12  CF-LAST-MAINT-DT                   PIC XX.
  2082     12  CF-LAST-MAINT-BY                   PIC X(4).
  2083     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2084
  2085     12  CF-RECORD-BODY                     PIC X(728).
  2086
  2087
  2088****************************************************************
  2089*             COMPANY MASTER RECORD                            *
  2090****************************************************************
  2091
  2092     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2093         16  CF-COMPANY-ADDRESS.
  2094             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2095             20  CF-CL-IN-CARE-OF           PIC X(30).
  2096             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2097             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2098             20  CF-CL-CITY-STATE           PIC X(30).
  2099             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2100             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2101         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  38
* EL677.cbl
  2102         16  CF-COMPANY-PASSWORD            PIC X(8).
  2103         16  CF-SECURITY-OPTION             PIC X.
  2104             88  ALL-SECURITY                   VALUE '1'.
  2105             88  COMPANY-VERIFY                 VALUE '2'.
  2106             88  PROCESSOR-VERIFY               VALUE '3'.
  2107             88  NO-SECURITY                    VALUE '4'.
  2108             88  ALL-BUT-TERM                   VALUE '5'.
  2109         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2110             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2111         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2112             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2113         16  CF-INFORCE-LOCATION            PIC X.
  2114             88  CERTS-ARE-ONLINE               VALUE '1'.
  2115             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2116             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2117         16  CF-LOWER-CASE-LETTERS          PIC X.
  2118         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2119             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2120             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2121             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2122             88  CF-ACCNT-CNTL                  VALUE '3'.
  2123             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2124
  2125         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2126         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2127
  2128         16  CF-LGX-CREDIT-USER             PIC X.
  2129             88  CO-IS-NOT-USER                 VALUE 'N'.
  2130             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2131
  2132         16 CF-CREDIT-CALC-CODES.
  2133             20  CF-CR-REM-TERM-CALC PIC X.
  2134               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2135               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2136               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2137               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2138               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2139               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2140               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2141             20  CF-CR-R78-METHOD           PIC X.
  2142               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2143               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2144
  2145         16  CF-CLAIM-CONTROL-COUNTS.
  2146             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2147                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2148
  2149             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2150                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2151
  2152             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2153                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2154
  2155             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2156                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2157
  2158         16  CF-CURRENT-MONTH-END           PIC XX.
  2159
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  39
* EL677.cbl
  2160         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2161             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2162             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2163             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2164             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2165                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2166                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2167             20  CF-CO-PREM-REJECT-SW       PIC X.
  2168                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2169                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2170             20  CF-CO-REF-REJECT-SW        PIC X.
  2171                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2172                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2173
  2174         16  CF-CO-REPORTING-DT             PIC XX.
  2175         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2176         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2177           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2178           88  CF-CO-MONTH-END                  VALUE '1'.
  2179
  2180         16  CF-LGX-CLAIM-USER              PIC X.
  2181             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2182             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2183
  2184         16  CF-CREDIT-EDIT-CONTROLS.
  2185             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2186             20  CF-MIN-AGE                 PIC 99.
  2187             20  CF-DEFAULT-AGE             PIC 99.
  2188             20  CF-MIN-TERM                PIC S999      COMP-3.
  2189             20  CF-MAX-TERM                PIC S999      COMP-3.
  2190             20  CF-DEFAULT-SEX             PIC X.
  2191             20  CF-JOINT-AGE-INPUT         PIC X.
  2192                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2193             20  CF-BIRTH-DATE-INPUT        PIC X.
  2194                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2195             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2196                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2197                 88  CF-ZERO-CARRIER            VALUE '1'.
  2198                 88  CF-ZERO-GROUPING           VALUE '2'.
  2199                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2200             20  CF-EDIT-SW                 PIC X.
  2201                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2202             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2203             20  CF-CR-PR-METHOD            PIC X.
  2204               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2205               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2206             20  FILLER                     PIC X.
  2207
  2208         16  CF-CREDIT-MISC-CONTROLS.
  2209             20  CF-REIN-TABLE-SW           PIC X.
  2210                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2211             20  CF-COMP-TABLE-SW           PIC X.
  2212                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2213             20  CF-EXPERIENCE-RETENTION-AGE
  2214                                            PIC S9        COMP-3.
  2215             20  CF-CONVERSION-DT           PIC XX.
  2216             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2217             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  40
* EL677.cbl
  2218                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2219                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2220
  2221             20  CF-CR-CHECK-NO-CONTROL.
  2222                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2223                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2224                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2225                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2226                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2227                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2228
  2229                 24  CF-CR-CHECK-COUNT       REDEFINES
  2230                     CF-CR-CHECK-COUNTER      PIC X(4).
  2231
  2232                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2233                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2234
  2235                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2236                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2237                 24  CF-MAIL-PROCESSING       PIC X.
  2238                     88  MAIL-PROCESSING          VALUE 'Y'.
  2239
  2240         16  CF-MISC-SYSTEM-CONTROL.
  2241             20  CF-SYSTEM-C                 PIC X.
  2242                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2243             20  CF-SYSTEM-D                 PIC X.
  2244                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2245             20  CF-SOC-SEC-NO-SW            PIC X.
  2246                 88  SOC-SEC-NO-USED             VALUE '1'.
  2247             20  CF-MEMBER-NO-SW             PIC X.
  2248                 88  MEMBER-NO-USED              VALUE '1'.
  2249             20  CF-TAX-ID-NUMBER            PIC X(11).
  2250             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2251             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2252                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2253                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2254                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2255                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2256             20  CF-SYSTEM-E                 PIC X.
  2257                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2258
  2259         16  CF-LGX-LIFE-USER               PIC X.
  2260             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2261             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2262
  2263         16  CF-CR-MONTH-END-DT             PIC XX.
  2264
  2265         16  CF-FILE-MAINT-DATES.
  2266             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2267                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2268             20  CF-LAST-BATCH       REDEFINES
  2269                 CF-LAST-BATCH-NO               PIC X(4).
  2270             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2271             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2272             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2273             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2274             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2275             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  41
* EL677.cbl
  2276             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2277             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2278             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2279             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2280
  2281         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2282         16  FILLER                         PIC X.
  2283
  2284         16  CF-ALT-MORT-CODE               PIC X(4).
  2285         16  CF-MEMBER-CAPTION              PIC X(10).
  2286
  2287         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2288             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2289             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2290             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2291             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2292             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2293
  2294         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2295
  2296         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2297         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2298         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2299         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2300
  2301         16  CF-AH-OVERRIDE-L1              PIC X.
  2302         16  CF-AH-OVERRIDE-L2              PIC XX.
  2303         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2304         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2305
  2306         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2307         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2308
  2309         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2310         16  CF-AR-LAST-EL860-DT            PIC XX.
  2311         16  CF-MP-MONTH-END-DT             PIC XX.
  2312
  2313         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2314         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2315             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2316
  2317         16  CF-AR-MONTH-END-DT             PIC XX.
  2318
  2319         16  CF-CRDTCRD-USER                PIC X.
  2320             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2321             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2322
  2323         16  CF-CC-MONTH-END-DT             PIC XX.
  2324
  2325         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2326
  2327         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2328             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2329             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2330             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2331         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2332         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2333         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  42
* EL677.cbl
  2334         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2335             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2336             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2337         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2338         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2339         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2340             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2341         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2342
  2343         16  CF-CL-ZIP-CODE.
  2344             20  CF-CL-ZIP-PRIME.
  2345                 24  CF-CL-ZIP-1ST          PIC X.
  2346                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2347                 24  FILLER                 PIC X(4).
  2348             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2349         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2350             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2351             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2352             20  FILLER                     PIC XXX.
  2353
  2354         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2355         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2356         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2357         16  CF-CO-OPTION-START-DATE        PIC XX.
  2358         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2359           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2360                                                      '3' '4'.
  2361           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2362           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2363           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2364           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2365           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2366           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2367
  2368         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2369
  2370         16  CF-PAYMENT-APPROVAL-LEVELS.
  2371             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2372             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2373             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2374             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2375             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2376             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2377
  2378         16  CF-END-USER-REPORTING-USER     PIC X.
  2379             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2380             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2381
  2382         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2383             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2384             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2385
  2386         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2387
  2388         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2389         16  FILLER                         PIC X.
  2390
  2391         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  43
* EL677.cbl
  2392             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2393             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2394             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2395
  2396         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2397
  2398         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2399             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2400             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2401
  2402         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2403             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2404             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2405
  2406         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2407
  2408         16  CF-CO-ACH-ID-CODE              PIC  X.
  2409             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2410             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2411             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2412         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2413         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2414         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2415         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2416         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2417         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2418         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2419         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2420         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2421                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2422         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2423                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2424
  2425         16  CF-CO-OVER-SHORT.
  2426             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2427             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2428
  2429*         16  FILLER                         PIC X(102).
  2430         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2431             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2432             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2433
  2434         16  CF-AH-APPROVAL-DAYS.
  2435             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2436             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2437             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2438             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2439
  2440         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2441
  2442         16  CF-APPROV-LEV-5.
  2443             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2444             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2445             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2446
  2447         16  FILLER                         PIC X(68).
  2448****************************************************************
  2449*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  44
* EL677.cbl
  2450****************************************************************
  2451
  2452     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2453         16  CF-PROCESSOR-NAME              PIC X(30).
  2454         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2455         16  CF-PROCESSOR-TITLE             PIC X(26).
  2456         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2457                 88  MESSAGE-YES                VALUE 'Y'.
  2458                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2459
  2460*****************************************************
  2461****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2462****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2463****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2464****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2465*****************************************************
  2466
  2467         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2468             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2469             20  CF-APPLICATION-FORCE       PIC X.
  2470             20  CF-INDIVIDUAL-APP.
  2471                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2472                     28  CF-BROWSE-APP      PIC X.
  2473                     28  CF-UPDATE-APP      PIC X.
  2474
  2475         16  CF-CURRENT-TERM-ON             PIC X(4).
  2476         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2477             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2478             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2479             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2480             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2481             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2482             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2483             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2484         16  CF-PROCESSOR-CARRIER           PIC X.
  2485             88  NO-CARRIER-SECURITY            VALUE ' '.
  2486         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2487             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2488         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2489             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2490         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2491             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2492
  2493         16  CF-PROC-SYS-ACCESS-SW.
  2494             20  CF-PROC-CREDIT-CLAIMS-SW.
  2495                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2496                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2497                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2498                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2499             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2500                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2501                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2502             20  CF-PROC-LIFE-GNRLDGR-SW.
  2503                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2504                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2505                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2506                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2507             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  45
* EL677.cbl
  2508                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2509                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2510         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2511             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2512             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2513         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2514
  2515         16  CF-APPROVAL-LEVEL                  PIC X.
  2516             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2517             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2518             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2519             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2520             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2521
  2522         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2523
  2524         16  CF-LANGUAGE-TYPE                   PIC X.
  2525             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2526             88  CF-LANG-IS-FR                      VALUE 'F'.
  2527
  2528         16  CF-CSR-IND                         PIC X.
  2529         16  FILLER                             PIC X(239).
  2530
  2531****************************************************************
  2532*             PROCESSOR/REMINDERS RECORD                       *
  2533****************************************************************
  2534
  2535     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2536         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2537             20  CF-START-REMIND-DT         PIC XX.
  2538             20  CF-END-REMIND-DT           PIC XX.
  2539             20  CF-REMINDER-TEXT           PIC X(50).
  2540         16  FILLER                         PIC X(296).
  2541
  2542
  2543****************************************************************
  2544*             STATE MASTER RECORD                              *
  2545****************************************************************
  2546
  2547     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2548         16  CF-STATE-ABBREVIATION          PIC XX.
  2549         16  CF-STATE-NAME                  PIC X(25).
  2550         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2551         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2552             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2553             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2554             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2555             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2556                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2557                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2558             20  CF-ST-PREM-REJECT-SW       PIC X.
  2559                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2560                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2561             20  CF-ST-REF-REJECT-SW        PIC X.
  2562                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2563                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2564         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2565         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  46
* EL677.cbl
  2566         16  CF-ST-REFUND-RULES.
  2567             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2568             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2569             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2570         16  CF-ST-FST-PMT-EXTENSION.
  2571             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2572             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2573                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2574                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2575                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2576                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2577         16  CF-ST-STATE-CALL.
  2578             20  CF-ST-CALL-UNEARNED        PIC X.
  2579             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2580             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2581         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2582             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2583             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2584         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2585         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2586         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2587         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2588         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2589         16  FILLER                         PIC X.
  2590         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2591             20  CF-ST-BENEFIT-CD           PIC XX.
  2592             20  CF-ST-BENEFIT-KIND         PIC X.
  2593                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2594                 88  CF-ST-AH-KIND              VALUE 'A'.
  2595             20  CF-ST-REM-TERM-CALC        PIC X.
  2596                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2597                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2598                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2599                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2600                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2601                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2602                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2603                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2604
  2605             20  CF-ST-REFUND-CALC          PIC X.
  2606                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2607                 88  ST-REFD-BY-R78             VALUE '1'.
  2608                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2609                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2610                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2611                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2612                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2613                 88  ST-REFD-UTAH               VALUE '7'.
  2614                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2615                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2616                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2617
  2618             20  CF-ST-EARNING-CALC         PIC X.
  2619                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2620                 88  ST-EARN-BY-R78             VALUE '1'.
  2621                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2622                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2623                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  47
* EL677.cbl
  2624                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2625                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2626                 88  ST-EARN-MEAN               VALUE '8'.
  2627                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2628
  2629             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2630                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2631                 88  ST-OVRD-BY-R78             VALUE '1'.
  2632                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2633                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2634                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2635                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2636                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2637                 88  ST-OVRD-MEAN               VALUE '8'.
  2638                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2639             20  cf-st-extra-periods        pic 9.
  2640*            20  FILLER                     PIC X.
  2641
  2642         16  CF-ST-COMMISSION-CAPS.
  2643             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2644             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2645             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2646             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2647         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2648                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2649                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  2650                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  2651
  2652         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2653
  2654         16  CF-ST-STATUTORY-INTEREST.
  2655             20  CF-ST-STAT-DATE-FROM       PIC X.
  2656                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2657                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2658             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2659             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2660             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2661             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2662             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2663
  2664         16  CF-ST-OVER-SHORT.
  2665             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2666             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2667
  2668         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2669
  2670         16  CF-ST-RT-CALC                  PIC X.
  2671
  2672         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2673         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2674         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2675         16  CF-ST-RF-LR-CALC               PIC X.
  2676         16  CF-ST-RF-LL-CALC               PIC X.
  2677         16  CF-ST-RF-LN-CALC               PIC X.
  2678         16  CF-ST-RF-AH-CALC               PIC X.
  2679         16  CF-ST-RF-CP-CALC               PIC X.
  2680*        16  FILLER                         PIC X(206).
  2681*CIDMOD         16  FILLER                         PIC X(192).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  48
* EL677.cbl
  2682         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2683             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2684         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2685         16  CF-ST-VFY-2ND-BENE             PIC X.
  2686         16  CF-ST-CAUSAL-STATE             PIC X.
  2687         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2688         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2689         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2690             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2691         16  CF-ST-NET-ONLY-STATE           PIC X.
  2692             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2693         16  cf-commission-cap-required     pic x.
  2694         16  CF-ST-GA-COMMISSION-CAPS.
  2695             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2696             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2697             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2698             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2699         16  CF-ST-TOT-COMMISSION-CAPS.
  2700             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2701             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2702             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2703             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2704         16  FILLER                         PIC X(156).
  2705
  2706****************************************************************
  2707*             BENEFIT MASTER RECORD                            *
  2708****************************************************************
  2709
  2710     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2711         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2712             20  CF-BENEFIT-CODE            PIC XX.
  2713             20  CF-BENEFIT-NUMERIC  REDEFINES
  2714                 CF-BENEFIT-CODE            PIC XX.
  2715             20  CF-BENEFIT-ALPHA           PIC XXX.
  2716             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2717             20  CF-BENEFIT-COMMENT         PIC X(10).
  2718
  2719             20  CF-LF-COVERAGE-TYPE        PIC X.
  2720                 88  CF-REDUCING                VALUE 'R'.
  2721                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2722
  2723             20  CF-SPECIAL-CALC-CD         PIC X.
  2724                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2725                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2726                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2727                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2728                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2729                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2730                 88  CF-FARM-PLAN               VALUE 'F'.
  2731                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2732                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2733                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2734                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2735                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2736                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2737                 88  CF-PRUDENTIAL              VALUE 'P'.
  2738                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2739                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  49
* EL677.cbl
  2740                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2741                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2742                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2743                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2744
  2745             20  CF-JOINT-INDICATOR         PIC X.
  2746                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2747
  2748*            20  FILLER                     PIC X(12).
  2749             20  cf-maximum-benefits        pic s999 comp-3.
  2750             20  FILLER                     PIC X(09).
  2751             20  CF-BENEFIT-CATEGORY        PIC X.
  2752             20  CF-LOAN-TYPE               PIC X(8).
  2753
  2754             20  CF-CO-REM-TERM-CALC        PIC X.
  2755                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2756                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2757                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2758                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2759                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2760
  2761             20  CF-CO-EARNINGS-CALC        PIC X.
  2762                 88  CO-EARN-BY-R78             VALUE '1'.
  2763                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2764                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2765                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2766                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2767                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2768                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2769                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2770
  2771             20  CF-CO-REFUND-CALC          PIC X.
  2772                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2773                 88  CO-REFD-BY-R78             VALUE '1'.
  2774                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2775                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2776                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2777                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2778                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2779                 88  CO-REFD-MEAN               VALUE '8'.
  2780                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2781                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2782                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2783
  2784             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2785                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2786                 88  CO-OVRD-BY-R78             VALUE '1'.
  2787                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2788                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2789                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2790                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2791                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2792                 88  CO-OVRD-MEAN               VALUE '8'.
  2793                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2794
  2795             20  CF-CO-BEN-I-G-CD           PIC X.
  2796                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2797                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  50
* EL677.cbl
  2798                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2799
  2800         16  FILLER                         PIC X(304).
  2801
  2802
  2803****************************************************************
  2804*             CARRIER MASTER RECORD                            *
  2805****************************************************************
  2806
  2807     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2808         16  CF-ADDRESS-DATA.
  2809             20  CF-MAIL-TO-NAME            PIC X(30).
  2810             20  CF-IN-CARE-OF              PIC X(30).
  2811             20  CF-ADDRESS-LINE-1          PIC X(30).
  2812             20  CF-ADDRESS-LINE-2          PIC X(30).
  2813             20  CF-CITY-STATE              PIC X(30).
  2814             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2815             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2816
  2817         16  CF-CLAIM-NO-CONTROL.
  2818             20  CF-CLAIM-NO-METHOD         PIC X.
  2819                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2820                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2821                 88  CLAIM-NO-SEQ               VALUE '3'.
  2822                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2823             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2824                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2825                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2826                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2827
  2828         16  CF-CHECK-NO-CONTROL.
  2829             20  CF-CHECK-NO-METHOD         PIC X.
  2830                 88  CHECK-NO-MANUAL            VALUE '1'.
  2831                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2832                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2833                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2834             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2835                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2836
  2837         16  CF-DOMICILE-STATE              PIC XX.
  2838
  2839         16  CF-EXPENSE-CONTROLS.
  2840             20  CF-EXPENSE-METHOD          PIC X.
  2841                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2842                 88  DOLLARS-PER-PMT            VALUE '2'.
  2843                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2844                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2845             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2846             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2847
  2848         16  CF-CORRESPONDENCE-CONTROL.
  2849             20  CF-LETTER-RESEND-OPT       PIC X.
  2850                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2851                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2852             20  FILLER                     PIC X(4).
  2853
  2854         16  CF-RESERVE-CONTROLS.
  2855             20  CF-MANUAL-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  51
* EL677.cbl
  2856                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2857             20  CF-FUTURE-SW               PIC X.
  2858                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2859             20  CF-PTC-SW                  PIC X.
  2860                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2861             20  CF-IBNR-SW                 PIC X.
  2862                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2863             20  CF-PTC-LF-SW               PIC X.
  2864                 88  CF-LF-PTC-USED             VALUE '1'.
  2865             20  CF-CDT-ACCESS-METHOD       PIC X.
  2866                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2867                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2868                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2869             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2870
  2871         16  CF-CLAIM-CALC-METHOD           PIC X.
  2872             88  360-PLUS-MONTHS                VALUE '1'.
  2873             88  365-PLUS-MONTHS                VALUE '2'.
  2874             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2875             88  360-DAILY                      VALUE '4'.
  2876             88  365-DAILY                      VALUE '5'.
  2877
  2878         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2879         16  FILLER                         PIC X(11).
  2880
  2881         16  CF-LIMIT-AMOUNTS.
  2882             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2883             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2884             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2885             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2886             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2887             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2888             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2889             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2890             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2891             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2892
  2893         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2894         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2895         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2896
  2897         16  CF-ZIP-CODE.
  2898             20  CF-ZIP-PRIME.
  2899                 24  CF-ZIP-1ST             PIC X.
  2900                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2901                 24  FILLER                 PIC X(4).
  2902             20  CF-ZIP-PLUS4               PIC X(4).
  2903         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2904             20  CF-CAN-POSTAL-1            PIC XXX.
  2905             20  CF-CAN-POSTAL-2            PIC XXX.
  2906             20  FILLER                     PIC XXX.
  2907
  2908         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2909         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2910         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2911
  2912         16  CF-RATING-SWITCH               PIC X.
  2913             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  52
* EL677.cbl
  2914             88  CF-NO-RATING                   VALUE 'N'.
  2915
  2916         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2917
  2918         16  CF-CARRIER-OVER-SHORT.
  2919             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2920             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2921
  2922         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2923         16  CF-SECPAY-SWITCH               PIC X.
  2924             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2925             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2926         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2927         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2928         16  FILLER                         PIC X(444).
  2929*        16  FILLER                         PIC X(452).
  2930
  2931
  2932****************************************************************
  2933*             MORTALITY MASTER RECORD                          *
  2934****************************************************************
  2935
  2936     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2937         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2938                                INDEXED BY CF-MORT-NDX.
  2939             20  CF-MORT-TABLE              PIC X(5).
  2940             20  CF-MORT-TABLE-TYPE         PIC X.
  2941                 88  CF-MORT-JOINT              VALUE 'J'.
  2942                 88  CF-MORT-SINGLE             VALUE 'S'.
  2943                 88  CF-MORT-COMBINED           VALUE 'C'.
  2944                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2945                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2946             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2947             20  CF-MORT-AGE-METHOD         PIC XX.
  2948                 88  CF-AGE-LAST                VALUE 'AL'.
  2949                 88  CF-AGE-NEAR                VALUE 'AN'.
  2950             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2951             20  CF-MORT-ADJUSTMENT-DIRECTION
  2952                                            PIC X.
  2953                 88  CF-MINUS                   VALUE '-'.
  2954                 88  CF-PLUS                    VALUE '+'.
  2955             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2956             20  CF-MORT-JOINT-CODE         PIC X.
  2957                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2958             20  CF-MORT-PC-Q               PIC X.
  2959                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2960             20  CF-MORT-TABLE-CODE         PIC X(4).
  2961             20  CF-MORT-COMMENTS           PIC X(15).
  2962             20  FILLER                     PIC X(14).
  2963
  2964         16  FILLER                         PIC X(251).
  2965
  2966
  2967****************************************************************
  2968*             BUSSINESS TYPE MASTER RECORD                     *
  2969****************************************************************
  2970
  2971     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  53
* EL677.cbl
  2972* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2973* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2974* AND RECORD 05 IS TYPES 81-99
  2975         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2976             20  CF-BUSINESS-TITLE          PIC  X(19).
  2977             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2978                                            PIC S9V9(4) COMP-3.
  2979             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2980             20  FILLER                     PIC  X.
  2981         16  FILLER                         PIC  X(248).
  2982
  2983
  2984****************************************************************
  2985*             TERMINAL MASTER RECORD                           *
  2986****************************************************************
  2987
  2988     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2989
  2990         16  CF-COMPANY-TERMINALS.
  2991             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2992                                  PIC X(4).
  2993         16  FILLER               PIC X(248).
  2994
  2995
  2996****************************************************************
  2997*             LIFE EDIT MASTER RECORD                          *
  2998****************************************************************
  2999
  3000     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3001         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3002             20  CF-LIFE-CODE-IN            PIC XX.
  3003             20  CF-LIFE-CODE-OUT           PIC XX.
  3004         16  FILLER                         PIC X(248).
  3005
  3006
  3007****************************************************************
  3008*             AH EDIT MASTER RECORD                            *
  3009****************************************************************
  3010
  3011     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3012         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3013             20  CF-AH-CODE-IN              PIC XXX.
  3014             20  CF-AH-CODE-OUT             PIC XX.
  3015         16  FILLER                         PIC X(248).
  3016
  3017
  3018****************************************************************
  3019*             CREDIBILITY TABLES                               *
  3020****************************************************************
  3021
  3022     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3023         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3024                             INDEXED BY CF-CRDB-NDX.
  3025             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3026             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3027             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3028         16  FILLER                         PIC  X(332).
  3029
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  54
* EL677.cbl
  3030
  3031****************************************************************
  3032*             REPORT CUSTOMIZATION RECORD                      *
  3033****************************************************************
  3034
  3035     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3036         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3037             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3038             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3039             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3040**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3041****       A T-TRANSFER.                                   ****
  3042             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3043
  3044         16  FILLER                         PIC XX.
  3045
  3046         16  CF-CARRIER-CNTL-OPT.
  3047             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3048                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3049                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3050             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3051                                            PIC X.
  3052         16  CF-GROUP-CNTL-OPT.
  3053             20  CF-GROUP-OPT-SEQ           PIC 9.
  3054                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3055                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3056             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3057                                            PIC X(6).
  3058         16  CF-STATE-CNTL-OPT.
  3059             20  CF-STATE-OPT-SEQ           PIC 9.
  3060                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3061                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3062             20  CF-STATE-SELECT OCCURS 3 TIMES
  3063                                            PIC XX.
  3064         16  CF-ACCOUNT-CNTL-OPT.
  3065             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3066                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3067                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3068             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3069                                            PIC X(10).
  3070         16  CF-BUS-TYP-CNTL-OPT.
  3071             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3072                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3073                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3074             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3075                                            PIC XX.
  3076         16  CF-LF-TYP-CNTL-OPT.
  3077             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3078                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3079                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3080             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3081                                            PIC XX.
  3082         16  CF-AH-TYP-CNTL-OPT.
  3083             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3084                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3085                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3086             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3087                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  55
* EL677.cbl
  3088         16  CF-REPTCD1-CNTL-OPT.
  3089             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3090                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3091                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3092             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3093                                            PIC X(10).
  3094         16  CF-REPTCD2-CNTL-OPT.
  3095             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3096                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3097                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3098             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3099                                            PIC X(10).
  3100         16  CF-USER1-CNTL-OPT.
  3101             20  CF-USER1-OPT-SEQ           PIC 9.
  3102                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3103                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3104             20  CF-USER1-SELECT OCCURS 3 TIMES
  3105                                            PIC X(10).
  3106         16  CF-USER2-CNTL-OPT.
  3107             20  CF-USER2-OPT-SEQ           PIC 9.
  3108                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3109                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3110             20  CF-USER2-SELECT OCCURS 3 TIMES
  3111                                            PIC X(10).
  3112         16  CF-USER3-CNTL-OPT.
  3113             20  CF-USER3-OPT-SEQ           PIC 9.
  3114                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3115                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3116             20  CF-USER3-SELECT OCCURS 3 TIMES
  3117                                            PIC X(10).
  3118         16  CF-USER4-CNTL-OPT.
  3119             20  CF-USER4-OPT-SEQ           PIC 9.
  3120                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3121                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3122             20  CF-USER4-SELECT OCCURS 3 TIMES
  3123                                            PIC X(10).
  3124         16  CF-USER5-CNTL-OPT.
  3125             20  CF-USER5-OPT-SEQ           PIC 9.
  3126                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3127                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3128             20  CF-USER5-SELECT OCCURS 3 TIMES
  3129                                            PIC X(10).
  3130         16  CF-REINS-CNTL-OPT.
  3131             20  CF-REINS-OPT-SEQ           PIC 9.
  3132                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3133                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3134             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3135                 24  CF-REINS-PRIME         PIC XXX.
  3136                 24  CF-REINS-SUB           PIC XXX.
  3137
  3138         16  CF-AGENT-CNTL-OPT.
  3139             20  CF-AGENT-OPT-SEQ           PIC 9.
  3140                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3141                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3142             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3143                                            PIC X(10).
  3144
  3145         16  FILLER                         PIC X(43).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  56
* EL677.cbl
  3146
  3147         16  CF-LOSS-RATIO-SELECT.
  3148             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3149             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3150         16  CF-ENTRY-DATE-SELECT.
  3151             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3152             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3153         16  CF-EFFECTIVE-DATE-SELECT.
  3154             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3155             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3156
  3157         16  CF-EXCEPTION-LIST-IND          PIC X.
  3158             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3159
  3160         16  FILLER                         PIC X(318).
  3161
  3162****************************************************************
  3163*                  EXCEPTION REPORTING RECORD                  *
  3164****************************************************************
  3165
  3166     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3167         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3168             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3169
  3170         16  CF-COMBINED-LIFE-AH-OPT.
  3171             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3172             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3173             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3174             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3175
  3176         16  CF-LIFE-OPT.
  3177             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3178             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3179             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3180             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3181             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3182             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3183             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3184             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3185             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3186             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3187
  3188         16  CF-AH-OPT.
  3189             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3190             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3191             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3192             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3193             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3194             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3195             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3196             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3197             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3198             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3199
  3200         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3201             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3202             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3203             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  57
* EL677.cbl
  3204
  3205         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3206
  3207         16  FILLER                         PIC X(673).
  3208
  3209
  3210****************************************************************
  3211*             MORTGAGE SYSTEM PLAN RECORD                      *
  3212****************************************************************
  3213
  3214     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3215         16  CF-PLAN-TYPE                   PIC X.
  3216             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3217             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3218             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3219         16  CF-PLAN-ABBREV                 PIC XXX.
  3220         16  CF-PLAN-DESCRIPT               PIC X(10).
  3221         16  CF-PLAN-NOTES                  PIC X(20).
  3222         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3223         16  CF-PLAN-UNDERWRITING.
  3224             20  CF-PLAN-TERM-DATA.
  3225                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3226                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3227             20  CF-PLAN-AGE-DATA.
  3228                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3229                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3230                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3231             20  CF-PLAN-BENEFIT-DATA.
  3232                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3233                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3234                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3235                                            PIC S9(7)V99  COMP-3.
  3236         16  CF-PLAN-POLICY-FORMS.
  3237             20  CF-POLICY-FORM             PIC X(12).
  3238             20  CF-MASTER-APPLICATION      PIC X(12).
  3239             20  CF-MASTER-POLICY           PIC X(12).
  3240         16  CF-PLAN-RATING.
  3241             20  CF-RATE-CODE               PIC X(5).
  3242             20  CF-SEX-RATING              PIC X.
  3243                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3244                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3245             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3246             20  CF-SUB-STD-TYPE            PIC X.
  3247                 88  CF-PCT-OF-PREM            VALUE '1'.
  3248                 88  CF-PCT-OF-BENE            VALUE '2'.
  3249         16  CF-PLAN-PREM-TOLERANCES.
  3250             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3251             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3252         16  CF-PLAN-PYMT-TOLERANCES.
  3253             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3254             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3255         16  CF-PLAN-MISC-DATA.
  3256             20  FILLER                     PIC X.
  3257             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3258             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3259         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3260         16  CF-PLAN-IND-GRP                PIC X.
  3261             88  CF-MORT-INDIV-PLAN            VALUE 'I'
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  58
* EL677.cbl
  3262                                                     '1'.
  3263             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3264                                                     '2'.
  3265         16  CF-MIB-SEARCH-SW               PIC X.
  3266             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3267             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3268             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3269             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3270         16  CF-ALPHA-SEARCH-SW             PIC X.
  3271             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3272             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3273             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3274             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3275             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3276             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3277             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3278             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3279             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3280             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3281                                                     'A' 'B' 'C'
  3282                                                     'X' 'Y' 'Z'.
  3283         16  CF-EFF-DT-RULE-SW              PIC X.
  3284             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3285             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3286             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3287             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3288             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3289         16  FILLER                         PIC X(4).
  3290         16  CF-HEALTH-QUESTIONS            PIC X.
  3291             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3292         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3293         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3294         16  CF-PLAN-SNGL-JNT               PIC X.
  3295             88  CF-COMBINED-PLAN              VALUE 'C'.
  3296             88  CF-JNT-PLAN                   VALUE 'J'.
  3297             88  CF-SNGL-PLAN                  VALUE 'S'.
  3298         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3299         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3300         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3301         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3302         16  CF-RERATE-CNTL                 PIC  X.
  3303             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3304             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3305             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3306             88  CF-AUTO-RECALC                 VALUE '4'.
  3307         16  CF-BENEFIT-TYPE                PIC  X.
  3308             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3309             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3310         16  CF-POLICY-FEE                  PIC S999V99
  3311                                                    COMP-3.
  3312         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3313         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3314         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3315         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3316         16  FILLER                         PIC  X(32).
  3317         16  CF-TERMINATION-FORM            PIC  X(04).
  3318         16  FILLER                         PIC  X(08).
  3319         16  CF-CLAIM-CAP                   PIC S9(7)V99
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  59
* EL677.cbl
  3320                                                       COMP-3.
  3321         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3322         16  CF-ISSUE-LETTER                PIC  X(4).
  3323         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3324         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3325             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3326             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3327         16  CF-MP-REFUND-CALC              PIC X.
  3328             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3329             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3330             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3331             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3332             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3333             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3334             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3335             88  CF-MP-REFD-MEAN                VALUE '8'.
  3336         16  CF-ALT-RATE-CODE               PIC  X(5).
  3337
  3338
  3339         16  FILLER                         PIC X(498).
  3340****************************************************************
  3341*             MORTGAGE COMPANY MASTER RECORD                   *
  3342****************************************************************
  3343
  3344     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3345         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3346         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3347             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3348             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3349             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3350             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3351             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3352
  3353         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3354         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3355         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3356         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3357         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3358
  3359         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3360             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3361         16  CF-MP-RECON-USE-IND            PIC X(1).
  3362             88  CF-MP-USE-RECON             VALUE 'Y'.
  3363         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3364             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3365         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3366             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3367             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3368         16  FILLER                         PIC X(1).
  3369         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3370             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3371         16  CF-MORTG-MIB-VERSION           PIC X.
  3372             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3373             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3374             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3375         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3376             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3377                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  60
* EL677.cbl
  3378             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3379                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3380             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3381                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3382             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3383                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3384             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3385                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3386             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3387                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3388         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3389         16  FILLER                         PIC X(7).
  3390         16  CF-MORTG-DESTINATION-SYMBOL.
  3391             20  CF-MORTG-MIB-COMM          PIC X(5).
  3392             20  CF-MORTG-MIB-TERM          PIC X(5).
  3393         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3394             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3395         16  FILLER                         PIC X(03).
  3396         16  CF-MP-CHECK-NO-CONTROL.
  3397             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3398                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3399                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3400                                                ' ' LOW-VALUES.
  3401                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3402                                               VALUE '3'.
  3403         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3404         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3405         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3406             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3407                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3408             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3409                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3410             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3411                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3412             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3413                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3414             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3415                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3416             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3417                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3418         16  CF-MORTG-BILLING-AREA.
  3419             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3420                                            PIC X.
  3421         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3422         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3423         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3424         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3425             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3426             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3427         16  FILLER                         PIC X.
  3428         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3429             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3430             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3431         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3432         16  FILLER                         PIC X(8).
  3433         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3434         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3435         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  61
* EL677.cbl
  3436         16  CF-ACH-COMPANY-ID.
  3437             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3438                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3439                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3440                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3441             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3442         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3443             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3444         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3445             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3446             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3447         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3448         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3449         16  FILLER                         PIC X(536).
  3450
  3451****************************************************************
  3452*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3453****************************************************************
  3454
  3455     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3456         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3457             20  CF-FEMALE-HEIGHT.
  3458                 24  CF-FEMALE-FT           PIC 99.
  3459                 24  CF-FEMALE-IN           PIC 99.
  3460             20  CF-FEMALE-MIN-WT           PIC 999.
  3461             20  CF-FEMALE-MAX-WT           PIC 999.
  3462         16  FILLER                         PIC X(428).
  3463
  3464     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3465         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3466             20  CF-MALE-HEIGHT.
  3467                 24  CF-MALE-FT             PIC 99.
  3468                 24  CF-MALE-IN             PIC 99.
  3469             20  CF-MALE-MIN-WT             PIC 999.
  3470             20  CF-MALE-MAX-WT             PIC 999.
  3471         16  FILLER                         PIC X(428).
  3472******************************************************************
  3473*             AUTOMATIC ACTIVITY RECORD                          *
  3474******************************************************************
  3475     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3476         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3477             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3478             20  CF-SYS-LETTER-ID           PIC X(04).
  3479             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3480             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3481             20  CF-SYS-RESET-SW            PIC X(01).
  3482             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3483             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3484
  3485         16  FILLER                         PIC X(50).
  3486
  3487         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3488             20  CF-USER-ACTIVE-SW          PIC X(01).
  3489             20  CF-USER-LETTER-ID          PIC X(04).
  3490             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3491             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3492             20  CF-USER-RESET-SW           PIC X(01).
  3493             20  CF-USER-REPORT-DAYS        PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  62
* EL677.cbl
  3494             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3495             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3496
  3497         16  FILLER                         PIC X(246).
  3498*                                COPY ERCCHEK.
  3499******************************************************************
  3500*                                                                *
  3501*                                                                *
  3502*                            ERCCHEK                             *
  3503*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3504*                            VMOD=2.008                          *
  3505*                                                                *
  3506*   FILE DESCRIPTION = CHECK RECORDS                             *
  3507*                                                                *
  3508*   FILE TYPE = VSAM,KSDS                                        *
  3509*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3510*                                                                *
  3511*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3512*       ALTERNATE INDEX = NONE                                   *
  3513*                                                                *
  3514*   LOG = YES                                                    *
  3515*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3516******************************************************************
  3517*                   C H A N G E   L O G
  3518*
  3519* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3520*-----------------------------------------------------------------
  3521*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3522* EFFECTIVE    NUMBER
  3523*-----------------------------------------------------------------
  3524* 021414    2003053000001  PEMA  changes for auto chk request
  3525******************************************************************
  3526 01  CHECK-RECORDS.
  3527     12  CH-RECORD-ID                      PIC XX.
  3528         88  VALID-CH-ID                      VALUE 'CH'.
  3529
  3530     12  CH-CONTROL-PRIMARY.
  3531         16  CH-COMPANY-CD                 PIC X.
  3532         16  CH-CARRIER                    PIC X.
  3533         16  CH-GROUPING                   PIC X(6).
  3534         16  CH-STATE                      PIC XX.
  3535         16  CH-ACCOUNT                    PIC X(10).
  3536         16  CH-CERT-EFF-DT                PIC XX.
  3537         16  CH-CERT-NO.
  3538             20  CH-CERT-PRIME             PIC X(10).
  3539             20  CH-CERT-SFX               PIC X.
  3540         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3541
  3542     12  CH-RECORDED-DT                    PIC XX.
  3543     12  CH-RECORDED-BY                    PIC X(4).
  3544     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3545
  3546     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3547     12  CH-CHECK-NO                       PIC X(7).
  3548     12  CH-REASON-FOR-CHECK               PIC X(25).
  3549     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3550     12  FILLER                            PIC X.
  3551
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  63
* EL677.cbl
  3552     12  CH-PAYEE-INFO.
  3553         16  CH-PAYEE-NAME-1               PIC X(30).
  3554         16  CH-PAYEE-NAME-2               PIC X(30).
  3555         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3556         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3557         16  CH-PAYEE-CITY-ST.
  3558             20  CH-PAYEE-CITY             PIC X(28).
  3559             20  CH-PAYEE-STATE            PIC XX.
  3560         16  CH-PAYEE-ZIP-CODE.
  3561             20  CH-PAYEE-ZIP.
  3562                 24  CH-ZIP-PRI-1ST        PIC X.
  3563                     88  CH-CANADIAN-POST-CODE
  3564                                           VALUES 'A' THRU 'Z'.
  3565                 24  FILLER                PIC X(4).
  3566             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3567         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3568             20  CH-CAN-POSTAL-1           PIC XXX.
  3569             20  CH-CAN-POSTAL-2           PIC XXX.
  3570             20  FILLER                    PIC XXX.
  3571
  3572     12  CH-CHECK-STUB-TEXT.
  3573         16  CH-STUB-LINE-1                PIC X(30).
  3574         16  CH-TEXT-LINE-1                PIC X(50).
  3575         16  CH-TEXT-LINE-2                PIC X(50).
  3576         16  CH-TEXT-LINE-3                PIC X(40).
  3577     12  CH-RETURN-TO                      PIC X(30).
  3578
  3579     12  CH-COMPENSATION-CONTROL.
  3580         16  CH-COMP-CARRIER               PIC X.
  3581         16  CH-COMP-GROUPING              PIC X(6).
  3582         16  CH-COMP-FIN-RESP              PIC X(10).
  3583         16  CH-COMP-ACCOUNT               PIC X(10).
  3584
  3585     12  CH-CREDIT-SELECT-DT               PIC XX.
  3586     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3587     12  CH-PAYEE-CODE                     PIC X(6).
  3588
  3589     12  CH-VOID-DATA.
  3590         20  CH-VOID-DT                    PIC XX.
  3591         20  CH-VOID-BY                    PIC X(4).
  3592         20  CH-VOID-REASON                PIC X(25).
  3593
  3594     12  CH-APPROVAL-DATA.
  3595         20  CH-APPROVAL-DT                PIC XX.
  3596         20  CH-APPROVAL-STATUS            PIC X.
  3597             88  CH-IN-LIMBO                  VALUE ' '.
  3598             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  3599             88  CH-APPROVED                  VALUE 'A'.
  3600             88  CH-DENIED                    VALUE 'D'.
  3601         20  CH-APPROVED-BY                PIC XXXX.
  3602     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3603             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3604     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3605
  3606     12  ch-released-dt                    pic xx.
  3607     12  ch-check-cashed-dt                pic xx.
  3608     12  FILLER                            PIC X.
  3609*    12  CH-CHECK-REFERENCE                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  64
* EL677.cbl
  3610     12  CH-CHECK-ORIGIN-SW                PIC X.
  3611             88  CH-REFUND-CHECK              VALUE 'R'.
  3612             88  CH-MAINT-CHECK               VALUE 'M'.
  3613
  3614     12  CH-CANC-DT                        PIC XX.
  3615     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3616     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3617
  3618     12  CH-INSURED-NAME                   PIC X(28).
  3619
  3620     12  ch-released-by                    pic x(4).
  3621     12  ch-csr                            pic x(4).
  3622     12  ch-deduct-commission              pic x.
  3623         88  ch-deduct-comm                  value 'Y'.
  3624         88  ch-do-not-deduct-comm           value 'N'.
  3625
  3626     12  FILLER                            PIC X(11).
  3627*    12  CH-LETTER-TABLE.
  3628*        16  CH-LETTERS OCCURS 3 TIMES
  3629*                       INDEXED BY CH-LT-NDX
  3630*                                          PIC X(04).
  3631
  3632     12  FILLER                            PIC X(07).
  3633
  3634*                                COPY ERCACCT.
  3635******************************************************************
  3636*                                                                *
  3637*                                                                *
  3638*                            ERCACCT                             *
  3639*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3640*                            VMOD=2.031                          *
  3641*                                                                *
  3642*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3643*                                                                *
  3644*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3645*   VSAM ACCOUNT MASTER FILES.                                   *
  3646*                                                                *
  3647*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3648*                                                                *
  3649*   FILE TYPE = VSAM,KSDS                                        *
  3650*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3651*                                                                *
  3652*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3653*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3654*                                                                *
  3655*   LOG = NO                                                     *
  3656*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3657*                                                                *
  3658*                                                                *
  3659******************************************************************
  3660*                   C H A N G E   L O G
  3661*
  3662* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3663*-----------------------------------------------------------------
  3664*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3665* EFFECTIVE    NUMBER
  3666*-----------------------------------------------------------------
  3667* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  65
* EL677.cbl
  3668* 092705    2005050300006  PEMA  ADD SPP LEASES
  3669* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3670* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3671* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3672* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3673* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3674* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  3675******************************************************************
  3676
  3677 01  ACCOUNT-MASTER.
  3678     12  AM-RECORD-ID                      PIC XX.
  3679         88  VALID-AM-ID                      VALUE 'AM'.
  3680
  3681     12  AM-CONTROL-PRIMARY.
  3682         16  AM-COMPANY-CD                 PIC X.
  3683         16  AM-MSTR-CNTRL.
  3684             20  AM-CONTROL-A.
  3685                 24  AM-CARRIER            PIC X.
  3686                 24  AM-GROUPING.
  3687                     28 AM-GROUPING-PREFIX PIC XXX.
  3688                     28 AM-GROUPING-PRIME  PIC XXX.
  3689                 24  AM-STATE              PIC XX.
  3690                 24  AM-ACCOUNT.
  3691                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3692                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3693             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3694                                           PIC X(19).
  3695             20  AM-CNTRL-B.
  3696                 24  AM-EXPIRATION-DT      PIC XX.
  3697                 24  FILLER                PIC X(4).
  3698             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3699                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3700
  3701     12  AM-CONTROL-BY-VAR-GRP.
  3702         16  AM-COMPANY-CD-A1              PIC X.
  3703         16  AM-VG-CARRIER                 PIC X.
  3704         16  AM-VG-GROUPING                PIC X(6).
  3705         16  AM-VG-STATE                   PIC XX.
  3706         16  AM-VG-ACCOUNT                 PIC X(10).
  3707         16  AM-VG-DATE.
  3708             20  AM-VG-EXPIRATION-DT       PIC XX.
  3709             20  FILLER                    PIC X(4).
  3710         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3711                                           PIC 9(11)      COMP-3.
  3712     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3713         16  FILLER                        PIC X(10).
  3714         16  AM-VG-KEY3.
  3715             20  AM-VG3-ACCOUNT            PIC X(10).
  3716             20  AM-VG3-EXP-DT             PIC XX.
  3717         16  FILLER                        PIC X(4).
  3718     12  AM-MAINT-INFORMATION.
  3719         16  AM-LAST-MAINT-DT              PIC XX.
  3720         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3721         16  AM-LAST-MAINT-USER            PIC X(4).
  3722         16  FILLER                        PIC XX.
  3723
  3724     12  AM-EFFECTIVE-DT                   PIC XX.
  3725     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  66
* EL677.cbl
  3726
  3727     12  AM-PREV-DATES  COMP-3.
  3728         16  AM-PREV-EXP-DT                PIC 9(11).
  3729         16  AM-PREV-EFF-DT                PIC 9(11).
  3730
  3731     12  AM-REPORT-CODE-1                  PIC X(10).
  3732     12  AM-REPORT-CODE-2                  PIC X(10).
  3733
  3734     12  AM-CITY-CODE                      PIC X(4).
  3735     12  AM-COUNTY-PARISH                  PIC X(6).
  3736
  3737     12  AM-NAME                           PIC X(30).
  3738     12  AM-PERSON                         PIC X(30).
  3739     12  AM-ADDRS                          PIC X(30).
  3740     12  AM-CITY.
  3741         16  AM-ADDR-CITY                  PIC X(28).
  3742         16  AM-ADDR-STATE                 PIC XX.
  3743     12  AM-ZIP.
  3744         16  AM-ZIP-PRIME.
  3745             20  AM-ZIP-PRI-1ST            PIC X.
  3746                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3747             20  FILLER                    PIC X(4).
  3748         16  AM-ZIP-PLUS4                  PIC X(4).
  3749     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3750         16  AM-CAN-POSTAL-1               PIC XXX.
  3751         16  AM-CAN-POSTAL-2               PIC XXX.
  3752         16  FILLER                        PIC XXX.
  3753     12  AM-TEL-NO.
  3754         16  AM-AREA-CODE                  PIC 999.
  3755         16  AM-TEL-PRE                    PIC 999.
  3756         16  AM-TEL-NBR                    PIC 9(4).
  3757     12  AM-TEL-LOC                        PIC X.
  3758         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3759         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3760
  3761     12  AM-COMM-STRUCTURE.
  3762         16  AM-DEFN-1.
  3763             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3764                 24  AM-AGT.
  3765                     28  AM-AGT-PREFIX     PIC X(4).
  3766                     28  AM-AGT-PRIME      PIC X(6).
  3767                 24  AM-COM-TYP            PIC X.
  3768                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3769                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3770                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3771                 24  AM-RECALC-LV-INDIC    PIC X.
  3772                 24  AM-RETRO-LV-INDIC     PIC X.
  3773                 24  AM-GL-CODES           PIC X.
  3774                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3775                 24  FILLER                PIC X(01).
  3776         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3777             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3778                 24  FILLER                PIC X(11).
  3779                 24  AM-L-COMA             PIC XXX.
  3780                 24  AM-J-COMA             PIC XXX.
  3781                 24  AM-A-COMA             PIC XXX.
  3782                 24  FILLER                PIC X(6).
  3783
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  67
* EL677.cbl
  3784     12  AM-COMM-CHANGE-STATUS             PIC X.
  3785         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3786
  3787     12  AM-CSR-CODE                       PIC X(4).
  3788
  3789     12  AM-BILLING-STATUS                 PIC X.
  3790         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3791         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3792     12  AM-AUTO-REFUND-SW                 PIC X.
  3793         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3794         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3795     12  AM-GPCD                           PIC 99.
  3796     12  AM-IG                             PIC X.
  3797         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3798         88  AM-HAS-GROUP                     VALUE '2'.
  3799     12  AM-STATUS                         PIC X.
  3800         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3801         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3802         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3803         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3804         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3805         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3806         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  3807         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  3808         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  3809         88  AM-ACCOUNT-PENDING               VALUE '9'.
  3810     12  AM-REMIT-TO                       PIC 99.
  3811     12  AM-ID-NO                          PIC X(11).
  3812
  3813     12  AM-CAL-TABLE                      PIC XX.
  3814     12  AM-LF-DEVIATION                   PIC XXX.
  3815     12  AM-AH-DEVIATION                   PIC XXX.
  3816     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3817     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3818     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3819     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3820     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3821     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3822
  3823     12  AM-USER-FIELDS.
  3824         16  AM-FLD-1                      PIC XX.
  3825         16  AM-FLD-2                      PIC XX.
  3826         16  AM-FLD-3                      PIC XX.
  3827         16  AM-FLD-4                      PIC XX.
  3828         16  AM-FLD-5                      PIC XX.
  3829
  3830     12  AM-1ST-PROD-DATE.
  3831         16  AM-1ST-PROD-YR                PIC XX.
  3832         16  AM-1ST-PROD-MO                PIC XX.
  3833         16  AM-1ST-PROD-DA                PIC XX.
  3834     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3835     12  AM-CERTS-PURGED-DATE.
  3836         16  AM-PUR-YR                     PIC XX.
  3837         16  AM-PUR-MO                     PIC XX.
  3838         16  AM-PUR-DA                     PIC XX.
  3839     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3840     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3841     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  68
* EL677.cbl
  3842     12  AM-INACTIVE-DATE.
  3843         16  AM-INA-MO                     PIC 99.
  3844         16  AM-INA-DA                     PIC 99.
  3845         16  AM-INA-YR                     PIC 99.
  3846     12  AM-AR-HI-CERT-DATE                PIC XX.
  3847
  3848     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3849     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3850
  3851     12  AM-OB-PAYMENT-MODE                PIC X.
  3852         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3853         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3854         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3855         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3856
  3857     12  AM-AH-ONLY-INDICATOR              PIC X.
  3858         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3859         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3860
  3861     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3862
  3863     12  AM-OVER-SHORT.
  3864         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3865         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3866
  3867     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3868     12  AM-DCC-CLP-STATE                  PIC XX.
  3869
  3870     12  AM-RECALC-COMM                    PIC X.
  3871     12  AM-RECALC-REIN                    PIC X.
  3872
  3873     12  AM-REI-TABLE                      PIC XXX.
  3874     12  AM-REI-ET-LF                      PIC X.
  3875     12  AM-REI-ET-AH                      PIC X.
  3876     12  AM-REI-PE-LF                      PIC X.
  3877     12  AM-REI-PE-AH                      PIC X.
  3878     12  AM-REI-PRT-ST                     PIC X.
  3879     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3880     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3881     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3882     12  AM-REI-GROUP-A                    PIC X(6).
  3883     12  AM-REI-MORT                       PIC X(4).
  3884     12  AM-REI-PRT-OW                     PIC X.
  3885     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3886     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3887     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3888     12  AM-REI-GROUP-B                    PIC X(6).
  3889
  3890     12  AM-TRUST-TYPE                     PIC X(2).
  3891
  3892     12  AM-EMPLOYER-STMT-USED             PIC X.
  3893     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3894
  3895     12  AM-STD-AH-TYPE                    PIC XX.
  3896     12  AM-EARN-METHODS.
  3897         16  AM-EARN-METHOD-R              PIC X.
  3898             88 AM-REF-RL-R78                 VALUE 'R'.
  3899             88 AM-REF-RL-PR                  VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  69
* EL677.cbl
  3900             88 AM-REF-RL-MEAN                VALUE 'M'.
  3901             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3902         16  AM-EARN-METHOD-L              PIC X.
  3903             88 AM-REF-LL-R78                 VALUE 'R'.
  3904             88 AM-REF-LL-PR                  VALUE 'P'.
  3905             88 AM-REF-LL-MEAN                VALUE 'M'.
  3906             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3907         16  AM-EARN-METHOD-A              PIC X.
  3908             88 AM-REF-AH-R78                 VALUE 'R'.
  3909             88 AM-REF-AH-PR                  VALUE 'P'.
  3910             88 AM-REF-AH-MEAN                VALUE 'M'.
  3911             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3912             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3913             88 AM-REF-AH-NET                 VALUE 'N'.
  3914
  3915     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3916     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3917     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3918
  3919     12  AM-RET-Y-N                        PIC X.
  3920     12  AM-RET-P-E                        PIC X.
  3921     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3922     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3923     12  AM-RET-GRP                        PIC X(6).
  3924     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3925         16  AM-POOL-PRIME                 PIC XXX.
  3926         16  AM-POOL-SUB                   PIC XXX.
  3927     12  AM-RETRO-EARNINGS.
  3928         16  AM-RET-EARN-R                 PIC X.
  3929         16  AM-RET-EARN-L                 PIC X.
  3930         16  AM-RET-EARN-A                 PIC X.
  3931     12  AM-RET-ST-TAX-USE                 PIC X.
  3932         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3933         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3934     12  AM-RETRO-BEG-EARNINGS.
  3935         16  AM-RET-BEG-EARN-R             PIC X.
  3936         16  AM-RET-BEG-EARN-L             PIC X.
  3937         16  AM-RET-BEG-EARN-A             PIC X.
  3938     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3939     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3940
  3941     12  AM-USER-SELECT-OPTIONS.
  3942         16  AM-USER-SELECT-1              PIC X(10).
  3943         16  AM-USER-SELECT-2              PIC X(10).
  3944         16  AM-USER-SELECT-3              PIC X(10).
  3945         16  AM-USER-SELECT-4              PIC X(10).
  3946         16  AM-USER-SELECT-5              PIC X(10).
  3947
  3948     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3949
  3950     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3951
  3952     12  AM-RPT045A-SWITCH                 PIC X.
  3953         88  RPT045A-OFF                   VALUE 'N'.
  3954
  3955     12  AM-INSURANCE-LIMITS.
  3956         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3957         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  70
* EL677.cbl
  3958
  3959     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3960         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3961
  3962     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3963         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3964         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3965
  3966     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3967
  3968     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3969     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3970     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3971     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3972     12  AM-DCC-UEF-STATE                  PIC XX.
  3973     12  FILLER                            PIC XXX.
  3974     12  AM-REPORT-CODE-3                  PIC X(10).
  3975*    12  FILLER                            PIC X(22).
  3976
  3977     12  AM-RESERVE-DATE.
  3978         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3979         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3980         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3981
  3982     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3983     12  AM-NOTIFICATION-TYPES.
  3984         16  AM-NOTIF-OF-LETTERS           PIC X.
  3985         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3986         16  AM-NOTIF-OF-REPORTS           PIC X.
  3987         16  AM-NOTIF-OF-STATUS            PIC X.
  3988
  3989     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3990         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3991         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3992         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3993         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3994
  3995     12  AM-BENEFIT-CONTROLS.
  3996         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  3997             20  AM-BENEFIT-CODE           PIC XX.
  3998             20  AM-BENEFIT-TYPE           PIC X.
  3999             20  AM-BENEFIT-REVISION       PIC XXX.
  4000             20  AM-BENEFIT-REM-TERM       PIC X.
  4001             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4002             20  FILLER                    PIC XX.
  4003         16  FILLER                        PIC X(80).
  4004
  4005     12  AM-TRANSFER-DATA.
  4006         16  AM-TRANSFERRED-FROM.
  4007             20  AM-TRNFROM-CARRIER        PIC X.
  4008             20  AM-TRNFROM-GROUPING.
  4009                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4010                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4011             20  AM-TRNFROM-STATE          PIC XX.
  4012             20  AM-TRNFROM-ACCOUNT.
  4013                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4014                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4015             20  AM-TRNFROM-DTE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  71
* EL677.cbl
  4016         16  AM-TRANSFERRED-TO.
  4017             20  AM-TRNTO-CARRIER          PIC X.
  4018             20  AM-TRNTO-GROUPING.
  4019                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4020                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4021             20  AM-TRNTO-STATE            PIC XX.
  4022             20  AM-TRNTO-ACCOUNT.
  4023                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4024                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4025             20  AM-TRNTO-DTE              PIC XX.
  4026         16  FILLER                        PIC X(10).
  4027
  4028     12  AM-SAVED-REMIT-TO                 PIC 99.
  4029
  4030     12  AM-COMM-STRUCTURE-SAVED.
  4031         16  AM-DEFN-1-SAVED.
  4032             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4033                 24  AM-AGT-SV             PIC X(10).
  4034                 24  AM-COM-TYP-SV         PIC X.
  4035                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4036                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4037                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4038                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4039                 24  FILLER                PIC X.
  4040                 24  AM-GL-CODES-SV        PIC X.
  4041                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4042                 24  FILLER                PIC X.
  4043         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4044             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4045                 24  FILLER                PIC X(11).
  4046                 24  AM-L-COMA-SV          PIC XXX.
  4047                 24  AM-J-COMA-SV          PIC XXX.
  4048                 24  AM-A-COMA-SV          PIC XXX.
  4049                 24  FILLER                PIC X(6).
  4050
  4051     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4052         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4053            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4054            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4055            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4056
  4057     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4058     12  FILLER                            PIC X(120).
  4059
  4060     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4061         16  AM-CONTROL-NAME               PIC X(30).
  4062         16  AM-EXECUTIVE-ONE.
  4063             20  AM-EXEC1-NAME             PIC X(15).
  4064             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4065                                                          COMP-3.
  4066             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4067                                                          COMP-3.
  4068         16  AM-EXECUTIVE-TWO.
  4069             20  AM-EXEC2-NAME             PIC X(15).
  4070             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4071                                                          COMP-3.
  4072             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4073                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  72
* EL677.cbl
  4074
  4075     12  AM-RETRO-ADDITIONAL-DATA.
  4076         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4077         16  AM-RETRO-PREM-P-E             PIC X.
  4078         16  AM-RETRO-CLMS-P-I             PIC X.
  4079         16  AM-RETRO-RET-BRACKET-LF.
  4080             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4081                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4082                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4083             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4084                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4085                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4086             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4087                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4088                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4089         16  AM-RETRO-RET-BRACKET-AH.
  4090             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4091                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4092                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4093                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4094             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4095                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4096                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4097             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4098                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4099                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4100
  4101     12  AM-COMMENTS.
  4102         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4103
  4104     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4105         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4106         16  AM-FLI-BILLING-CODE           PIC X.
  4107         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4108         16  AM-FLI-UNITED-IDENT           PIC X.
  4109         16  AM-FLI-INTEREST-LOST-DATA.
  4110             20  AM-FLI-BANK-NO            PIC X(5).
  4111             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4112             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4113             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4114         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4115             20  AM-FLI-AGT                PIC X(9).
  4116             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4117             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4118         16  FILLER                        PIC X(102).
  4119
  4120     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4121         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4122             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4123             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4124             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4125             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4126             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4127         16  FILLER                          PIC X(10).
  4128******************************************************************
  4129*                                COPY ERCCOMP.
  4130******************************************************************
  4131*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  73
* EL677.cbl
  4132*                                                                *
  4133*                            ERCCOMP                             *
  4134*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4135*                            VMOD=2.019                          *
  4136*                                                                *
  4137*   ONLINE CREDIT SYSTEM                                         *
  4138*                                                                *
  4139*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4140*                                                                *
  4141*   FILE TYPE = VSAM,KSDS                                        *
  4142*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4143*                                                                *
  4144*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4145*       ALTERNATE PATH = NONE                                    *
  4146*                                                                *
  4147*   LOG = NO                                                     *
  4148*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4149*                                                                *
  4150******************************************************************
  4151*                   C H A N G E   L O G
  4152*
  4153* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4154*-----------------------------------------------------------------
  4155*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4156* EFFECTIVE    NUMBER
  4157*-----------------------------------------------------------------
  4158* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4159* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4160* 092205    2005050300006  PEMA  ADD LEASE FEE
  4161* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4162* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4163* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4164* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4165* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4166* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4167******************************************************************
  4168
  4169 01  COMPENSATION-MASTER.
  4170     12  CO-RECORD-ID                          PIC XX.
  4171         88  VALID-CO-ID                          VALUE 'CO'.
  4172
  4173     12  CO-CONTROL-PRIMARY.
  4174         16  CO-COMPANY-CD                     PIC X.
  4175         16  CO-CONTROL.
  4176             20  CO-CTL-1.
  4177                 24  CO-CARR-GROUP.
  4178                     28  CO-CARRIER            PIC X.
  4179                     28  CO-GROUPING.
  4180                         32  CO-GROUP-PREFIX   PIC XXX.
  4181                         32  CO-GROUP-PRIME    PIC XXX.
  4182                 24  CO-RESP-NO.
  4183                     28  CO-RESP-PREFIX        PIC X(4).
  4184                     28  CO-RESP-PRIME         PIC X(6).
  4185             20  CO-CTL-2.
  4186                 24  CO-ACCOUNT.
  4187                     28  CO-ACCT-PREFIX        PIC X(4).
  4188                     28  CO-ACCT-PRIME         PIC X(6).
  4189         16  CO-TYPE                           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  74
* EL677.cbl
  4190             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4191             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4192             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4193
  4194     12  CO-MAINT-INFORMATION.
  4195         16  CO-LAST-MAINT-DT                  PIC XX.
  4196         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4197         16  CO-LAST-MAINT-USER                PIC X(4).
  4198     12  FILLER                                PIC XX.
  4199     12  CO-STMT-TYPE                          PIC XXX.
  4200     12  CO-COMP-TYPE                          PIC X.
  4201         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4202     12  CO-STMT-OWNER                         PIC X(4).
  4203     12  CO-BALANCE-CONTROL                    PIC X.
  4204         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4205         88  CO-NO-BALANCE                        VALUE 'N'.
  4206
  4207     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4208         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4209         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4210         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4211
  4212     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4213         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4214         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4215
  4216     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4217     12  CO-GA-DIRECT-DEP                      PIC X.
  4218     12  CO-FUTURE-SPACE                       PIC X.
  4219         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4220
  4221     12  CO-ACCT-NAME                          PIC X(30).
  4222     12  CO-MAIL-NAME                          PIC X(30).
  4223     12  CO-ADDR-1                             PIC X(30).
  4224     12  CO-ADDR-2                             PIC X(30).
  4225     12  CO-ADDR-3.
  4226         16  CO-ADDR-CITY                      PIC X(27).
  4227         16  CO-ADDR-STATE                     PIC XX.
  4228     12  CO-CSO-1099                           PIC X.
  4229     12  CO-ZIP.
  4230         16  CO-ZIP-PRIME.
  4231             20  CO-ZIP-PRI-1ST                PIC X.
  4232                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4233             20  FILLER                        PIC X(4).
  4234         16  CO-ZIP-PLUS4                      PIC X(4).
  4235     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4236         16  CO-CAN-POSTAL-1                   PIC XXX.
  4237         16  CO-CAN-POSTAL-2                   PIC XXX.
  4238         16  FILLER                            PIC XXX.
  4239     12  CO-SOC-SEC                            PIC X(13).
  4240     12  CO-TELEPHONE.
  4241         16  CO-AREA-CODE                      PIC XXX.
  4242         16  CO-PREFIX                         PIC XXX.
  4243         16  CO-PHONE                          PIC X(4).
  4244
  4245     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4246
  4247     12  CO-AR-BAL-LEVEL                       PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  75
* EL677.cbl
  4248         88  CO-AR-REF-LVL                        VALUE '1'.
  4249         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4250         88  CO-AR-BILL-LVL                       VALUE '2'.
  4251         88  CO-AR-AGT-LVL                        VALUE '3'.
  4252         88  CO-AR-FR-LVL                         VALUE '4'.
  4253
  4254     12  CO-AR-NORMAL-PRINT                    PIC X.
  4255         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4256         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4257
  4258     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4259
  4260     12  CO-AR-REPORTING                       PIC X.
  4261         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4262         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4263
  4264     12  CO-AR-PULL-CHECK                      PIC X.
  4265         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4266         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4267
  4268     12  CO-AR-BALANCE-PRINT                   PIC X.
  4269         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4270
  4271     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4272         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4273         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4274         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4275
  4276     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4277
  4278     12  CO-USER-CODE                          PIC X.
  4279     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4280
  4281******************************************************************
  4282*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4283*    THE LAST MONTH END RUN.
  4284******************************************************************
  4285
  4286     12  CO-LAST-ACTIVITY-DATE.
  4287         16  CO-ACT-YEAR                       PIC 99.
  4288         16  CO-ACT-MONTH                      PIC 99.
  4289         16  CO-ACT-DAY                        PIC 99.
  4290
  4291     12  CO-LAST-STMT-DT.
  4292         16  CO-LAST-STMT-YEAR                 PIC 99.
  4293         16  CO-LAST-STMT-MONTH                PIC 99.
  4294         16  CO-LAST-STMT-DAY                  PIC 99.
  4295
  4296     12  CO-MO-END-TOTALS.
  4297         16  CO-MONTHLY-TOTALS.
  4298             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4299             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4300             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4301             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4302             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4303
  4304         16  CO-AGING-TOTALS.
  4305             20  CO-CUR                    PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  76
* EL677.cbl
  4306             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4307             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4308             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4309
  4310         16  CO-YTD-TOTALS.
  4311             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4312             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4313
  4314         16  CO-OVER-UNDER-TOTALS.
  4315             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4316             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4317
  4318     12  CO-MISCELLANEOUS-TOTALS.
  4319         16  CO-FICA-TOTALS.
  4320             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4321             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4322
  4323         16  CO-CLAIM-TOTALS.
  4324             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4325             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4326
  4327******************************************************************
  4328*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4329*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4330******************************************************************
  4331
  4332     12  CO-CURRENT-TOTALS.
  4333         16  CO-CURRENT-LAST-STMT-DT.
  4334             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4335             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4336             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4337
  4338         16  CO-CURRENT-MONTHLY-TOTALS.
  4339             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4340             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4341             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4342             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4343             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4344
  4345         16  CO-CURRENT-AGING-TOTALS.
  4346             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4347             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4348             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4349             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4350
  4351         16  CO-CURRENT-YTD-TOTALS.
  4352             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4353             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4354
  4355     12  CO-PAID-COMM-TOTALS.
  4356         16  CO-YTD-PAID-COMMS.
  4357             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4358             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4359
  4360     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4361         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4362         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4363
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  77
* EL677.cbl
  4364     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4365         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4366         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4367         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4368         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4369         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4370         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4371         88  CO-FINAL-LETTER                  VALUE 'F'.
  4372         88  CO-RECONCILING                   VALUE 'R'.
  4373         88  CO-PHONE-CALL                    VALUE 'P'.
  4374         88  CO-LEGAL                         VALUE 'L'.
  4375         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4376         88  CO-WRITE-OFF                     VALUE 'W'.
  4377         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4378
  4379     12  CO-CSR-CODE                       PIC X(4).
  4380
  4381     12  CO-GA-STATUS-INFO.
  4382         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4383         16  CO-GA-TERMINATION-DT          PIC XX.
  4384         16  CO-GA-STATUS-CODE             PIC X.
  4385             88  CO-GA-ACTIVE                 VALUE 'A'.
  4386             88  CO-GA-INACTIVE               VALUE 'I'.
  4387             88  CO-GA-PENDING                VALUE 'P'.
  4388         16  CO-GA-COMMENTS.
  4389             20  CO-GA-COMMENT-1           PIC X(40).
  4390             20  CO-GA-COMMENT-2           PIC X(40).
  4391             20  CO-GA-COMMENT-3           PIC X(40).
  4392             20  CO-GA-COMMENT-4           PIC X(40).
  4393
  4394     12  CO-RPTCD2                         PIC X(10).
  4395     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4396         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4397         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4398
  4399     12  CO-TYPE-AGENT                     PIC X(01).
  4400         88  CO-CORPORATION                   VALUE 'C'.
  4401         88  CO-PARTNERSHIP                   VALUE 'P'.
  4402         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4403         88  CO-TRUST                         VALUE 'T'.
  4404         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4405
  4406     12  CO-FAXNO.
  4407         16  CO-FAX-AREA-CODE                  PIC XXX.
  4408         16  CO-FAX-PREFIX                     PIC XXX.
  4409         16  CO-FAX-PHONE                      PIC X(4).
  4410
  4411     12  CO-BANK-INFORMATION.
  4412         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4413         16  CO-BANK-TRANSIT-NON REDEFINES
  4414             CO-BANK-TRANSIT-NO                PIC 9(8).
  4415
  4416         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4417     12  CO-MISC-DEDUCT-INFO REDEFINES
  4418                  CO-BANK-INFORMATION.
  4419         16  CO-MD-GL-ACCT                     PIC X(10).
  4420         16  CO-MD-DIV                         PIC XX.
  4421         16  CO-MD-CENTER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  78
* EL677.cbl
  4422         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4423         16  CO-CREATE-AP-CHECK                PIC X.
  4424         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4425         16  FILLER                            PIC XXX.
  4426     12  CO-ACH-STATUS                         PIC X.
  4427         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4428         88  CO-ACH-PENDING                        VALUE 'P'.
  4429
  4430     12  CO-BILL-SW                            PIC X.
  4431     12  CO-CONTROL-NAME                       PIC X(30).
  4432     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4433     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4434     12  CO-CLP-STATE                          PIC XX.
  4435     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4436     12  CO-SPP-REFUND-EDIT                    PIC X.
  4437
  4438******************************************************************
  4439*                                COPY ELCCERT.
  4440******************************************************************
  4441*                                                                *
  4442*                            ELCCERT.                            *
  4443*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4444*                            VMOD=2.013                          *
  4445*                                                                *
  4446*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4447*                                                                *
  4448*   FILE TYPE = VSAM,KSDS                                        *
  4449*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4450*                                                                *
  4451*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4452*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4453*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4454*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4455*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4456*                                                                *
  4457*   LOG = YES                                                    *
  4458*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4459******************************************************************
  4460*                   C H A N G E   L O G
  4461*
  4462* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4463*-----------------------------------------------------------------
  4464*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4465* EFFECTIVE    NUMBER
  4466*-----------------------------------------------------------------
  4467* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4468* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4469* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4470* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4471* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4472* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4473* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4474* 032612  CR2011110200001  PEMA  AHL CHANGES
  4475* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4476* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4477* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4478******************************************************************
  4479
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  79
* EL677.cbl
  4480 01  CERTIFICATE-MASTER.
  4481     12  CM-RECORD-ID                      PIC XX.
  4482         88  VALID-CM-ID                      VALUE 'CM'.
  4483
  4484     12  CM-CONTROL-PRIMARY.
  4485         16  CM-COMPANY-CD                 PIC X.
  4486         16  CM-CARRIER                    PIC X.
  4487         16  CM-GROUPING.
  4488             20  CM-GROUPING-PREFIX        PIC X(3).
  4489             20  CM-GROUPING-PRIME         PIC X(3).
  4490         16  CM-STATE                      PIC XX.
  4491         16  CM-ACCOUNT.
  4492             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4493             20  CM-ACCOUNT-PRIME          PIC X(6).
  4494         16  CM-CERT-EFF-DT                PIC XX.
  4495         16  CM-CERT-NO.
  4496             20  CM-CERT-PRIME             PIC X(10).
  4497             20  CM-CERT-SFX               PIC X.
  4498
  4499     12  CM-CONTROL-BY-NAME.
  4500         16  CM-COMPANY-CD-A1              PIC X.
  4501         16  CM-INSURED-LAST-NAME          PIC X(15).
  4502         16  CM-INSURED-INITIALS.
  4503             20  CM-INSURED-INITIAL1       PIC X.
  4504             20  CM-INSURED-INITIAL2       PIC X.
  4505
  4506     12  CM-CONTROL-BY-SSN.
  4507         16  CM-COMPANY-CD-A2              PIC X.
  4508         16  CM-SOC-SEC-NO.
  4509             20  CM-SSN-STATE              PIC XX.
  4510             20  CM-SSN-ACCOUNT            PIC X(6).
  4511             20  CM-SSN-LN3.
  4512                 25  CM-INSURED-INITIALS-A2.
  4513                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4514                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4515                 25 CM-PART-LAST-NAME-A2         PIC X.
  4516
  4517     12  CM-CONTROL-BY-CERT-NO.
  4518         16  CM-COMPANY-CD-A4              PIC X.
  4519         16  CM-CERT-NO-A4                 PIC X(11).
  4520
  4521     12  CM-CONTROL-BY-MEMB.
  4522         16  CM-COMPANY-CD-A5              PIC X.
  4523         16  CM-MEMBER-NO.
  4524             20  CM-MEMB-STATE             PIC XX.
  4525             20  CM-MEMB-ACCOUNT           PIC X(6).
  4526             20  CM-MEMB-LN4.
  4527                 25  CM-INSURED-INITIALS-A5.
  4528                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4529                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4530                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4531
  4532     12  CM-INSURED-PROFILE-DATA.
  4533         16  CM-INSURED-FIRST-NAME.
  4534             20  CM-INSURED-1ST-INIT       PIC X.
  4535             20  FILLER                    PIC X(9).
  4536         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4537         16  CM-INSURED-SEX                PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  80
* EL677.cbl
  4538             88  CM-SEX-MALE                  VALUE 'M'.
  4539             88  CM-SEX-FEMAL                 VALUE 'F'.
  4540         16  CM-INSURED-JOINT-AGE          PIC 99.
  4541         16  CM-JOINT-INSURED-NAME.
  4542             20  CM-JT-LAST-NAME           PIC X(15).
  4543             20  CM-JT-FIRST-NAME.
  4544                 24  CM-JT-1ST-INIT        PIC X.
  4545                 24  FILLER                PIC X(9).
  4546             20  CM-JT-INITIAL             PIC X.
  4547
  4548     12  CM-LIFE-DATA.
  4549         16  CM-LF-BENEFIT-CD              PIC XX.
  4550         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4551         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4552         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4553         16  CM-LF-DEV-CODE                PIC XXX.
  4554         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4555         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4556         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4557         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4558         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4559         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4560         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4561         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4562         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4563         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4564         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4565         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4566         16  cm-temp-epiq                  pic xx.
  4567             88  EPIQ-CLASS                  value 'EQ'.
  4568*        16  FILLER                        PIC XX.
  4569
  4570     12  CM-AH-DATA.
  4571         16  CM-AH-BENEFIT-CD              PIC XX.
  4572         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4573         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4574         16  CM-AH-DEV-CODE                PIC XXX.
  4575         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4576         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4577         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4578         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4579         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4580         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4581         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4582         16  CM-AH-PAID-THRU-DT            PIC XX.
  4583             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4584         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4585         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4586         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4587         16  FILLER                        PIC X.
  4588
  4589     12  CM-LOAN-INFORMATION.
  4590         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4591         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4592                                           PIC S9(5)V99  COMP-3.
  4593         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4594         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4595         16  CM-PAY-FREQUENCY              PIC S99.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  81
* EL677.cbl
  4596         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4597         16  CM-RATE-CLASS                 PIC XX.
  4598         16  CM-BENEFICIARY                PIC X(25).
  4599         16  CM-POLICY-FORM-NO             PIC X(12).
  4600         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4601         16  CM-LAST-ADD-ON-DT             PIC XX.
  4602         16  CM-DEDUCTIBLE-AMOUNTS.
  4603             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4604             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4605         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4606             20  CM-RESIDENT-STATE         PIC XX.
  4607             20  CM-RATE-CODE              PIC X(4).
  4608             20  FILLER                    PIC XX.
  4609         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4610             20  CM-LOAN-OFFICER           PIC X(5).
  4611             20  FILLER                    PIC XXX.
  4612         16  CM-CSR-CODE                   PIC XXX.
  4613         16  CM-UNDERWRITING-CODE          PIC X.
  4614             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4615         16  CM-POST-CARD-IND              PIC X.
  4616         16  CM-REF-INTERFACE-SW           PIC X.
  4617         16  CM-PREMIUM-TYPE               PIC X.
  4618             88  CM-SING-PRM                  VALUE '1'.
  4619             88  CM-O-B-COVERAGE              VALUE '2'.
  4620             88  CM-OPEN-END                  VALUE '3'.
  4621         16  CM-IND-GRP-TYPE               PIC X.
  4622             88  CM-INDIVIDUAL                VALUE 'I'.
  4623             88  CM-GROUP                     VALUE 'G'.
  4624         16  CM-SKIP-CODE                  PIC X.
  4625             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4626             88  SKIP-JULY                    VALUE '1'.
  4627             88  SKIP-AUGUST                  VALUE '2'.
  4628             88  SKIP-SEPTEMBER               VALUE '3'.
  4629             88  SKIP-JULY-AUG                VALUE '4'.
  4630             88  SKIP-AUG-SEPT                VALUE '5'.
  4631             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4632             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4633             88  SKIP-JUNE                    VALUE '8'.
  4634             88  SKIP-JUNE-JULY               VALUE '9'.
  4635             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4636             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4637         16  CM-PAYMENT-MODE               PIC X.
  4638             88  PAY-MONTHLY                  VALUE SPACE.
  4639             88  PAY-WEEKLY                   VALUE '1'.
  4640             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4641             88  PAY-BI-WEEKLY                VALUE '3'.
  4642             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4643         16  CM-LOAN-NUMBER                PIC X(8).
  4644         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4645         16  CM-OLD-LOF                    PIC XXX.
  4646*        16  CM-LOAN-OFFICER               PIC XXX.
  4647         16  CM-REIN-TABLE                 PIC XXX.
  4648         16  CM-SPECIAL-REIN-CODE          PIC X.
  4649         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4650         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4651         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4652
  4653     12  CM-STATUS-DATA.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  82
* EL677.cbl
  4654         16  CM-ENTRY-STATUS               PIC X.
  4655         16  CM-ENTRY-DT                   PIC XX.
  4656
  4657         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4658         16  CM-LF-CANCEL-DT               PIC XX.
  4659         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4660
  4661         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4662         16  CM-LF-DEATH-DT                PIC XX.
  4663         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4664
  4665         16  CM-LF-CURRENT-STATUS          PIC X.
  4666             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4667                                                'M' '4' '5' '9'.
  4668             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4669             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4670             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4671             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4672             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4673             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4674             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4675             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4676             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4677             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4678             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4679             88  CM-LF-DECLINED               VALUE 'D'.
  4680             88  CM-LF-VOIDED                 VALUE 'V'.
  4681
  4682         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4683         16  CM-AH-CANCEL-DT               PIC XX.
  4684         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4685
  4686         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4687         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4688         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4689
  4690         16  CM-AH-CURRENT-STATUS          PIC X.
  4691             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4692                                                'M' '4' '5' '9'.
  4693             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4694             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4695             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4696             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4697             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4698             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4699             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4700             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4701             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4702             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4703             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4704             88  CM-AH-DECLINED               VALUE 'D'.
  4705             88  CM-AH-VOIDED                 VALUE 'V'.
  4706
  4707         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4708             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4709             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4710             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4711         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  83
* EL677.cbl
  4712
  4713         16  CM-ENTRY-BATCH                PIC X(6).
  4714         16  CM-LF-EXIT-BATCH              PIC X(6).
  4715         16  CM-AH-EXIT-BATCH              PIC X(6).
  4716         16  CM-LAST-MONTH-END             PIC XX.
  4717
  4718     12  CM-NOTE-SW                        PIC X.
  4719         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4720         88  CERT-NOTES-PRESENT               VALUE '1'.
  4721         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4722         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4723         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4724         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4725         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4726         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4727     12  CM-COMP-EXCP-SW                   PIC X.
  4728         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4729         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4730     12  CM-INSURED-ADDRESS-SW             PIC X.
  4731         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4732         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4733
  4734*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4735     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4736     12  FILLER                            PIC X.
  4737
  4738*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4739     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4740     12  FILLER                            PIC X.
  4741*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4742     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  4743
  4744     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4745         88  CERT-ADDED-BATCH                 VALUE ' '.
  4746         88  CERT-ADDED-ONLINE                VALUE '1'.
  4747         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4748         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4749         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4750     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4751         88  CERT-AS-LOADED                   VALUE ' '.
  4752         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4753         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4754         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4755         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4756         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4757         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4758         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4759
  4760     12  CM-ACCOUNT-COMM-PCTS.
  4761         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4762         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4763
  4764     12  CM-USER-FIELD                     PIC X.
  4765     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4766     12  CM-CLP-STATE                      PIC XX.
  4767     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4768     12  CM-USER-RESERVED                  PIC XXX.
  4769     12  FILLER REDEFINES CM-USER-RESERVED.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  84
* EL677.cbl
  4770         16  CM-AH-CLASS-CD                PIC XX.
  4771         16  F                             PIC X.
  4772******************************************************************
  4773*                                COPY ERCPNDB.
  4774******************************************************************
  4775*                                                                *
  4776*                                                                *
  4777*                            ERCPNDB.                            *
  4778*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4779*                            VMOD=2.025                          *
  4780*                                                                *
  4781*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4782*                                                                *
  4783******************************************************************
  4784*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4785*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4786******************************************************************
  4787*                                                                *
  4788*                                                                *
  4789*   FILE TYPE = VSAM,KSDS                                        *
  4790*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4791*                                                                *
  4792*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4793*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4794*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4795*                                                 RKP=13,LEN=36  *
  4796*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4797*                                      AND CHG-SEQ.)             *
  4798*                                                RKP=49,LEN=11   *
  4799*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4800*                                      AND CHG-SEQ.)             *
  4801*                                                RKP=60,LEN=15   *
  4802*                                                                *
  4803*   LOG = NO                                                     *
  4804*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4805******************************************************************
  4806******************************************************************
  4807*                   C H A N G E   L O G
  4808*
  4809* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4810*-----------------------------------------------------------------
  4811*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4812* EFFECTIVE    NUMBER
  4813*-----------------------------------------------------------------
  4814* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4815* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4816* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4817* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4818* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4819* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4820* 032306                   PEMA  ADD BOW LOAN NUMBER
  4821* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4822* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4823* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4824* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4825* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4826* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4827* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  85
* EL677.cbl
  4828* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4829* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4830* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4831* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4832* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4833******************************************************************
  4834
  4835 01  PENDING-BUSINESS.
  4836     12  PB-RECORD-ID                     PIC XX.
  4837         88  VALID-PB-ID                        VALUE 'PB'.
  4838
  4839     12  PB-CONTROL-PRIMARY.
  4840         16  PB-COMPANY-CD                PIC X.
  4841         16  PB-ENTRY-BATCH               PIC X(6).
  4842         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4843         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4844
  4845     12  PB-CONTROL-BY-ACCOUNT.
  4846         16  PB-COMPANY-CD-A1             PIC X.
  4847         16  PB-CARRIER                   PIC X.
  4848         16  PB-GROUPING.
  4849             20  PB-GROUPING-PREFIX       PIC XXX.
  4850             20  PB-GROUPING-PRIME        PIC XXX.
  4851         16  PB-STATE                     PIC XX.
  4852         16  PB-ACCOUNT.
  4853             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4854             20  PB-ACCOUNT-PRIME         PIC X(6).
  4855         16  PB-CERT-EFF-DT               PIC XX.
  4856         16  PB-CERT-NO.
  4857             20  PB-CERT-PRIME            PIC X(10).
  4858             20  PB-CERT-SFX              PIC X.
  4859         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4860
  4861         16  PB-RECORD-TYPE               PIC X.
  4862             88  PB-MAILING-DATA                VALUE '0'.
  4863             88  PB-ISSUE                       VALUE '1'.
  4864             88  PB-CANCELLATION                VALUE '2'.
  4865             88  PB-BATCH-TRAILER               VALUE '9'.
  4866
  4867     12  PB-CONTROL-BY-ORIG-BATCH.
  4868         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4869         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4870         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4871         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4872
  4873     12  PB-CONTROL-BY-CSR.
  4874         16  PB-CSR-COMPANY-CD            PIC X.
  4875         16  PB-CSR-ID                    PIC X(4).
  4876         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4877         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4878         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4879******************************************************************
  4880*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4881******************************************************************
  4882
  4883     12  PB-LAST-MAINT-DT                 PIC XX.
  4884     12  PB-LAST-MAINT-BY                 PIC X(4).
  4885     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  86
* EL677.cbl
  4886
  4887     12  PB-RECORD-BODY                   PIC X(375).
  4888
  4889     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4890         16  PB-CERT-ORIGIN               PIC X.
  4891             88  CLASIC-CREATED-CERT         VALUE '1'.
  4892         16  PB-I-NAME.
  4893             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4894             20  PB-I-INSURED-FIRST-NAME.
  4895                 24  PB-I-INSURED-1ST-INIT PIC X.
  4896                 24  FILLER                PIC X(9).
  4897             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4898         16  PB-I-AGE                     PIC S99   COMP-3.
  4899         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4900         16  PB-I-BIRTHDAY                PIC XX.
  4901         16  PB-I-INSURED-SEX             PIC X.
  4902             88  PB-SEX-MALE     VALUE 'M'.
  4903             88  PB-SEX-FEMALE   VALUE 'F'.
  4904
  4905         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4906         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4907         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4908         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4909         16  PB-I-SKIP-CODE               PIC X.
  4910             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4911             88  PB-SKIP-JULY              VALUE '1'.
  4912             88  PB-SKIP-AUGUST            VALUE '2'.
  4913             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4914             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4915             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4916             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4917             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4918             88  PB-SKIP-JUNE              VALUE '8'.
  4919             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4920             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4921             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4922         16  PB-I-TERM-TYPE               PIC X.
  4923             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4924             88  PB-PAID-WEEKLY            VALUE 'W'.
  4925             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4926             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4927             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4928         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4929         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4930         16  PB-I-DATA-ENTRY-SW           PIC X.
  4931             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4932             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4933             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4934             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4935         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4936         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4937*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4938         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4939         16  FILLER                       PIC X.
  4940
  4941         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4942             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4943             88  PB-INVALID-LIFE             VALUE '  ' '00'
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  87
* EL677.cbl
  4944                                                   '90' THRU '99'.
  4945         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4946                                          PIC XX.
  4947         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4948         16  PB-I-AMOUNT-FINANCED REDEFINES
  4949                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4950         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4951         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4952                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4953         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4954         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4955         16  PB-I-CLP-AMOUNT REDEFINES
  4956                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4957         16  PB-I-LF-CALC-FLAG            PIC X.
  4958             88 PB-COMP-LF-PREM               VALUE '?'.
  4959         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4960         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4961         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4962         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4963         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4964         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4965         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4966         16  PB-I-LF-ABBR                 PIC XXX.
  4967         16  PB-I-LF-INPUT-CD             PIC XX.
  4968
  4969         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4970             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4971             88  PB-INVALID-AH               VALUE '  ' '00'
  4972                                                   '90' THRU '99'.
  4973         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4974         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4975         16  PB-I-AH-CALC-FLAG            PIC X.
  4976             88 PB-COMP-AH-PREM                  VALUE '?'.
  4977         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4978         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4979         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4980         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4981         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4982         16  PB-I-AH-ABBR                 PIC XXX.
  4983         16  PB-I-AH-INPUT-CD             PIC XXX.
  4984
  4985         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4986         16  PB-I-REIN-TABLE              PIC XXX.
  4987         16  PB-I-BUSINESS-TYPE           PIC 99.
  4988         16  PB-I-INDV-GRP-CD             PIC X.
  4989         16  PB-I-MORT-CODE.
  4990             20  PB-I-TABLE               PIC X.
  4991             20  PB-I-INTEREST            PIC XX.
  4992             20  PB-I-MORT-TYP            PIC X.
  4993         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4994         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4995         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4996         16  PB-I-INDV-GRP-OVRD           PIC X.
  4997         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4998         16  PB-I-SIG-SW                  PIC X.
  4999             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5000         16  PB-I-RATE-CLASS              PIC XX.
  5001         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  88
* EL677.cbl
  5002         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5003         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5004         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5005         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5006         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5007         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5008         16  PB-I-BENEFIT-TYPE            PIC XXX.
  5009         16  PB-I-OB-FLAG                 PIC X.
  5010             88  PB-I-OB                      VALUE 'B'.
  5011             88  PB-I-SUMMARY                 VALUE 'Z'.
  5012         16  PB-I-ENTRY-STATUS            PIC X.
  5013             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5014                                              'M' '5' '9' '2'.
  5015             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5016             88  PB-I-POLICY-PENDING          VALUE '2'.
  5017             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5018             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5019             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  5020             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5021             88  PB-I-REIN-ONLY               VALUE '9'.
  5022             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5023             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5024             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5025             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5026         16  PB-I-INT-CODE                PIC X.
  5027             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5028             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5029         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5030         16  PB-I-SOC-SEC-NO              PIC X(11).
  5031         16  PB-I-MEMBER-NO               PIC X(12).
  5032         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5033*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5034         16  PB-I-OLD-LOF                 PIC XXX.
  5035         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5036         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5037         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5038         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5039         16  PB-I-LIFE-INDICATOR          PIC X.
  5040             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5041         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5042         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5043                                          PIC S9(5)V99    COMP-3.
  5044         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5045             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5046             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5047         16  PB-I-1ST-PMT-DT              PIC XX.
  5048         16  PB-I-JOINT-INSURED.
  5049             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5050             20 PB-I-JOINT-FIRST-NAME.
  5051                24  PB-I-JOINT-FIRST-INIT PIC X.
  5052                24  FILLER                PIC X(9).
  5053             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5054*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5055         16  PB-I-BENEFICIARY-NAME.
  5056             20  PB-I-BANK-NUMBER         PIC X(10).
  5057             20  FILLER                   PIC X(15).
  5058         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  5059         16  PB-I-REFERENCE               PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  89
* EL677.cbl
  5060         16  FILLER REDEFINES PB-I-REFERENCE.
  5061             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5062             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5063             20  PB-I-CLP-STATE           PIC XX.
  5064         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5065             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  5066             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5067             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  5068         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5069         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5070         16  PB-I-RESIDENT-STATE          PIC XX.
  5071         16  PB-I-RATE-CODE               PIC X(4).
  5072         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  5073         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5074         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5075         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5076         16  PB-I-BANK-NOCHRGB            PIC 99.
  5077         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5078         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5079
  5080     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5081         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5082             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5083         16  PB-C-CANCEL-ORIGIN           PIC X.
  5084             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5085         16  PB-C-LF-CANCEL-DT            PIC XX.
  5086         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5087         16  PB-C-LF-CALC-REQ             PIC X.
  5088             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5089         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5090         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5091         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5092             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5093         16  PB-C-AH-CANCEL-DT            PIC XX.
  5094         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5095         16  PB-C-AH-CALC-REQ             PIC X.
  5096             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5097         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5098         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5099         16  PB-C-LAST-NAME               PIC X(15).
  5100         16  PB-C-REFUND-SW               PIC X.
  5101             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5102             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5103         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5104         16  PB-C-PAYEE-CODE              PIC X(6).
  5105         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5106         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5107         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5108         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  5109         16  PB-C-REFERENCE               PIC X(12).
  5110         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5111         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5112         16  PB-C-POST-CARD-IND           PIC X.
  5113         16  PB-C-CANCEL-REASON           PIC X.
  5114         16  PB-C-REF-INTERFACE-SW        PIC X.
  5115         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  5116         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  5117         16  FILLER                       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  90
* EL677.cbl
  5118*        16  FILLER                       PIC X(18).
  5119         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5120*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  5121         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  5122         16  PB-CANCELED-CERT-DATA.
  5123             20  PB-CI-INSURED-NAME.
  5124                 24  PB-CI-LAST-NAME      PIC X(15).
  5125                 24  PB-CI-INITIALS       PIC XX.
  5126             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5127             20  PB-CI-INSURED-SEX        PIC X.
  5128             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5129             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  5130             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  5131             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5132             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5133             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5134             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5135             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5136             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5137             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5138             20  PB-CI-RATE-CLASS         PIC XX.
  5139             20  PB-CI-RATE-DEV-LF        PIC XXX.
  5140             20  PB-CI-RATE-DEV-AH        PIC XXX.
  5141             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5142             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5143             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  5144             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5145             20  PB-CI-LF-ABBR            PIC X(3).
  5146             20  PB-CI-AH-ABBR            PIC X(3).
  5147             20  PB-CI-OB-FLAG            PIC X.
  5148                 88  PB-CI-OB                VALUE 'B'.
  5149             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5150                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5151                                           'M' '4' '5' '9' '2'.
  5152                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  5153                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5154                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5155                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5156                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5157                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  5158                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5159                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5160                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5161                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5162                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5163                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5164                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5165             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5166                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5167                                           'M' '4' '5' '9' '2'.
  5168                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5169                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5170                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5171                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5172                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5173                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  5174                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5175                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  91
* EL677.cbl
  5176                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5177                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5178                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5179                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5180                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5181             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5182             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5183             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5184             20  PB-CI-MEMBER-NO          PIC X(12).
  5185             20  PB-CI-INT-CODE           PIC X.
  5186                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5187                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5188             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5189             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5190             20  PB-CI-COMP-EXCP-SW       PIC X.
  5191                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5192                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5193             20  PB-CI-ENTRY-STATUS       PIC X.
  5194             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5195             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5196             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5197             20  PB-CI-DEATH-DT           PIC XX.
  5198             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5199             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5200             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5201             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5202             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5203             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5204             20  PB-CI-ENTRY-DT              PIC XX.
  5205             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5206             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5207             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5208             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5209             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5210             20  PB-CI-OLD-LOF               PIC XXX.
  5211*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5212             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5213             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5214             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5215             20  PB-CI-INDV-GRP-CD           PIC X.
  5216             20  PB-CI-BENEFICIARY-NAME.
  5217                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5218                 24  FILLER                  PIC X(15).
  5219             20  PB-CI-NOTE-SW               PIC X.
  5220             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5221             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5222             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5223             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5224             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5225             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5226             20  PB-CI-FIRST-NAME            PIC X(10).
  5227             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5228
  5229         16  FILLER                       PIC X(13).
  5230*032306  16  FILLER                       PIC X(27).
  5231*        16  FILLER                       PIC X(46).
  5232
  5233     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  92
* EL677.cbl
  5234         16  FILLER                       PIC X(10).
  5235         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5236         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5237         16  PB-M-INSURED-MID-INIT        PIC X.
  5238         16  PB-M-INSURED-AGE             PIC 99.
  5239         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5240         16  PB-M-INSURED-SEX             PIC X.
  5241         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5242         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5243         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5244         16  PB-M-INSURED-CITY-STATE.
  5245             20  PB-M-INSURED-CITY        PIC X(28).
  5246             20  PB-M-INSURED-STATE       PIC XX.
  5247         16  PB-M-INSURED-ZIP-CODE.
  5248             20  PB-M-INSURED-ZIP-PRIME.
  5249                 24  PB-M-INSURED-ZIP-1   PIC X.
  5250                     88  PB-M-CANADIAN-POST-CODE
  5251                                             VALUE 'A' THRU 'Z'.
  5252                 24  FILLER               PIC X(4).
  5253             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5254         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5255                                        PB-M-INSURED-ZIP-CODE.
  5256             20  PM-M-INS-CAN-POST1       PIC XXX.
  5257             20  PM-M-INS-CAN-POST2       PIC XXX.
  5258             20  FILLER                   PIC XXX.
  5259         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5260         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5261         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5262         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5263         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5264         16  PB-M-CRED-BENE-CITYST.
  5265             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5266             20  PB-M-CRED-BENE-STATE     PIC XX.
  5267         16  FILLER                       PIC X(92).
  5268
  5269     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5270         16  FILLER                       PIC X(10).
  5271         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5272         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5273         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5274         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5275         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5276         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5277         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5278         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5279         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5280         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5281         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5282         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5283         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5284         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5285         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5286         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5287         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5288         16  PB-ACCOUNT-NAME              PIC X(30).
  5289         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5290         16  PB-REFERENCE                 PIC X(12).
  5291         16  PB-B-RECEIVED-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  93
* EL677.cbl
  5292         16  FILLER                       PIC X(234).
  5293
  5294     12  PB-RECORD-STATUS.
  5295         16  PB-CREDIT-SELECT-DT          PIC XX.
  5296         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5297         16  PB-BILLED-DT                 PIC XX.
  5298         16  PB-BILLING-STATUS            PIC X.
  5299             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5300             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5301             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5302         16  PB-RECORD-BILL               PIC X.
  5303             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5304             88  PB-RECORD-RETURNED           VALUE 'R'.
  5305             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5306             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5307             88  PB-OVERRIDE-AH               VALUE 'A'.
  5308             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5309         16  PB-BATCH-ENTRY               PIC X.
  5310             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5311             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5312             88  PB-REISSUED-CERT             VALUE 'E'.
  5313             88  PB-CASH-CERT                 VALUE 'C'.
  5314             88  PB-MONTHLY-CERT              VALUE 'M'.
  5315             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5316             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5317             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5318         16  PB-FORCE-CODE                PIC X.
  5319             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5320             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5321             88  PB-CANCEL-FORCE              VALUE '8'.
  5322             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5323             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5324             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5325             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5326             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5327             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5328             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  5329             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5330         16  PB-FATAL-FLAG                PIC X.
  5331             88  PB-FATAL-ERRORS              VALUE 'X'.
  5332         16  PB-FORCE-ER-CD               PIC X.
  5333             88  PB-FORCE-ERRORS              VALUE 'F'.
  5334             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5335         16  PB-WARN-ER-CD                PIC X.
  5336             88  PB-WARNING-ERRORS            VALUE 'W'.
  5337         16  FILLER                       PIC X.
  5338         16  PB-OUT-BAL-CD                PIC X.
  5339             88  PB-OUT-OF-BAL                VALUE 'O'.
  5340         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5341         16  PB-AH-OVERRIDE-L1            PIC X.
  5342         16  PB-INPUT-DT                  PIC XX.
  5343         16  PB-INPUT-BY                  PIC X(4).
  5344         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5345         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5346         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5347         16  PB-LF-EARNING-METHOD         PIC X.
  5348         16  PB-AH-EARNING-METHOD         PIC X.
  5349         16  PB-LF-TERM-CALC-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  94
* EL677.cbl
  5350         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5351         16  PB-REIN-CD                   PIC XXX.
  5352         16  PB-LF-REFUND-TYPE            PIC X.
  5353         16  PB-AH-REFUND-TYPE            PIC X.
  5354         16  PB-ACCT-EFF-DT               PIC XX.
  5355         16  PB-ACCT-EXP-DT               PIC XX.
  5356         16  PB-COMPANY-ID                PIC X(3).
  5357         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5358         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5359         16  PB-SV-CARRIER                PIC X.
  5360         16  PB-SV-GROUPING               PIC X(6).
  5361         16  PB-SV-STATE                  PIC XX.
  5362         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5363         16  PB-GA-BILLING-INFO.
  5364             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5365                                          PIC XX.
  5366         16  PB-SV-REMIT-TO  REDEFINES
  5367             PB-GA-BILLING-INFO           PIC X(10).
  5368         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5369         16  PB-I-LOAN-OFFICER            PIC X(5).
  5370         16  PB-I-VIN                     PIC X(17).
  5371
  5372         16  FILLER                       PIC X(04).
  5373         16  IMNET-BYPASS-SW              PIC X.
  5374
  5375******************************************************************
  5376*                COMMON EDIT ERRORS                              *
  5377******************************************************************
  5378
  5379     12  PB-COMMON-ERRORS.
  5380         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5381                                           PIC S9(4)     COMP.
  5382
  5383******************************************************************
  5384*                                COPY ERCPNDM.
  5385******************************************************************
  5386*                                                                *
  5387*                                                                *
  5388*                            ERCPNDM                             *
  5389*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5390*                            VMOD=2.003                          *
  5391*                                                                *
  5392*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5393*                                                                *
  5394*   FILE TYPE = VSAM,KSDS                                        *
  5395*   RECORD SIZE = 374   RECFORM = FIX                            *
  5396*                                                                *
  5397*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5398*   ALTERNATE PATH    = NOT USED                                 *
  5399*                                                                *
  5400*   LOG = YES                                                    *
  5401*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5402******************************************************************
  5403*                   C H A N G E   L O G
  5404*
  5405* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5406*-----------------------------------------------------------------
  5407*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  95
* EL677.cbl
  5408* EFFECTIVE    NUMBER
  5409*-----------------------------------------------------------------
  5410* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5411* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5412* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5413* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  5414******************************************************************
  5415
  5416 01  PENDING-MAILING-DATA.
  5417     12  PM-RECORD-ID                      PIC XX.
  5418         88  VALID-MA-ID                       VALUE 'PM'.
  5419
  5420     12  PM-CONTROL-PRIMARY.
  5421         16  PM-COMPANY-CD                 PIC X.
  5422         16  PM-ENTRY-BATCH                PIC X(6).
  5423         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5424         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5425
  5426     12  FILLER                            PIC X(14).
  5427
  5428     12  PM-ACCESS-CONTROL.
  5429         16  PM-SOURCE-SYSTEM              PIC XX.
  5430             88  PM-FROM-CREDIT                VALUE 'CR'.
  5431             88  PM-FROM-VSI                   VALUE 'VS'.
  5432             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5433             88  PM-FROM-OTHER                 VALUE 'OT'.
  5434         16  PM-RECORD-ADD-DT              PIC XX.
  5435         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5436         16  PM-LAST-MAINT-DT              PIC XX.
  5437         16  PM-LAST-MAINT-BY              PIC XXXX.
  5438         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5439
  5440     12  PM-PROFILE-INFO.
  5441         16  PM-QUALIFY-CODE-1             PIC XX.
  5442         16  PM-QUALIFY-CODE-2             PIC XX.
  5443         16  PM-QUALIFY-CODE-3             PIC XX.
  5444         16  PM-QUALIFY-CODE-4             PIC XX.
  5445         16  PM-QUALIFY-CODE-5             PIC XX.
  5446
  5447         16  PM-INSURED-LAST-NAME          PIC X(15).
  5448         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5449         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5450         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5451         16  PM-INSURED-BIRTH-DT           PIC XX.
  5452         16  PM-INSURED-SEX                PIC X.
  5453             88  PM-SEX-MALE                   VALUE 'M'.
  5454             88  PM-SEX-FEMALE                 VALUE 'F'.
  5455         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5456
  5457         16  PM-ADDRESS-CORRECTED          PIC X.
  5458         16  PM-JOINT-BIRTH-DT             PIC XX.
  5459*        16  FILLER                        PIC X(12).
  5460
  5461         16  PM-ADDRESS-LINE-1             PIC X(30).
  5462         16  PM-ADDRESS-LINE-2             PIC X(30).
  5463         16  PM-CITY-STATE.
  5464             20  PM-CITY                   PIC X(28).
  5465             20  PM-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  96
* EL677.cbl
  5466         16  PM-ZIP.
  5467             20  PM-ZIP-CODE.
  5468                 24  PM-ZIP-1              PIC X.
  5469                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5470                 24  FILLER                PIC X(4).
  5471             20  PM-ZIP-PLUS4              PIC X(4).
  5472         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5473             20  PM-CAN-POST1              PIC XXX.
  5474             20  PM-CAN-POST2              PIC XXX.
  5475             20  FILLER                    PIC XXX.
  5476
  5477         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5478         16  pm-city-st-zip-verified       pic x.
  5479         16  FILLER                        PIC XX.
  5480
  5481     12  PM-CRED-BENE-INFO.
  5482         16  PM-CRED-BENE-NAME             PIC X(25).
  5483         16  PM-CRED-BENE-ADDR             PIC X(30).
  5484         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5485         16  PM-CRED-BENE-CTYST.
  5486             20  PM-CRED-BENE-CITY         PIC X(28).
  5487             20  PM-CRED-BENE-STATE        PIC XX.
  5488         16  PM-CRED-BENE-ZIP.
  5489             20  PM-CB-ZIP-CODE.
  5490                 24  PM-CB-ZIP-1           PIC X.
  5491                     88  PM-CB-CANADIAN-POST-CODE
  5492                                  VALUE 'A' THRU 'Z'.
  5493                 24  FILLER                PIC X(4).
  5494             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5495         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5496             20  PM-CB-CAN-POST1           PIC XXX.
  5497             20  PM-CB-CAN-POST2           PIC XXX.
  5498             20  FILLER                    PIC XXX.
  5499     12  PM-POST-CARD-MAIL-DATA.
  5500         16  PM-MAIL-DATA OCCURS 7.
  5501             20  PM-MAIL-TYPE              PIC X.
  5502                 88  PM-12MO-MAILING           VALUE '1'.
  5503                 88  PM-EXP-MAILING            VALUE '2'.
  5504             20  PM-MAIL-STATUS            PIC X.
  5505                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5506                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5507                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5508             20  PM-MAIL-DATE              PIC XX.
  5509     12  FILLER                            PIC XX.
  5510     12  FILLER                            PIC X(12).
  5511*    12  FILLER                            PIC X(30).
  5512
  5513******************************************************************
  5514*                                COPY ERCMAIL.
  5515******************************************************************
  5516*                                                                *
  5517*                                                                *
  5518*                            ERCMAIL                             *
  5519*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5520*                            VMOD=2.003                          *
  5521*                                                                *
  5522*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5523*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  97
* EL677.cbl
  5524*   FILE TYPE = VSAM,KSDS                                        *
  5525*   RECORD SIZE = 374   RECFORM = FIX                            *
  5526*                                                                *
  5527*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5528*   ALTERNATE PATH    = NOT USED                                 *
  5529*                                                                *
  5530*   LOG = YES                                                    *
  5531*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5532******************************************************************
  5533*                   C H A N G E   L O G
  5534*
  5535* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5536*-----------------------------------------------------------------
  5537*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5538* EFFECTIVE    NUMBER
  5539*-----------------------------------------------------------------
  5540* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5541* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5542* 111108                   PEMA  ADD CRED BENE ADDR2
  5543******************************************************************
  5544
  5545 01  MAILING-DATA.
  5546     12  MA-RECORD-ID                      PIC XX.
  5547         88  VALID-MA-ID                       VALUE 'MA'.
  5548
  5549     12  MA-CONTROL-PRIMARY.
  5550         16  MA-COMPANY-CD                 PIC X.
  5551         16  MA-CARRIER                    PIC X.
  5552         16  MA-GROUPING.
  5553             20  MA-GROUPING-PREFIX        PIC XXX.
  5554             20  MA-GROUPING-PRIME         PIC XXX.
  5555         16  MA-STATE                      PIC XX.
  5556         16  MA-ACCOUNT.
  5557             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5558             20  MA-ACCOUNT-PRIME          PIC X(6).
  5559         16  MA-CERT-EFF-DT                PIC XX.
  5560         16  MA-CERT-NO.
  5561             20  MA-CERT-PRIME             PIC X(10).
  5562             20  MA-CERT-SFX               PIC X.
  5563
  5564     12  FILLER                            PIC XX.
  5565
  5566     12  MA-ACCESS-CONTROL.
  5567         16  MA-SOURCE-SYSTEM              PIC XX.
  5568             88  MA-FROM-CREDIT                VALUE 'CR'.
  5569             88  MA-FROM-VSI                   VALUE 'VS'.
  5570             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5571             88  MA-FROM-OTHER                 VALUE 'OT'.
  5572         16  MA-RECORD-ADD-DT              PIC XX.
  5573         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5574         16  MA-LAST-MAINT-DT              PIC XX.
  5575         16  MA-LAST-MAINT-BY              PIC XXXX.
  5576         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5577
  5578     12  MA-PROFILE-INFO.
  5579         16  MA-QUALIFY-CODE-1             PIC XX.
  5580         16  MA-QUALIFY-CODE-2             PIC XX.
  5581         16  MA-QUALIFY-CODE-3             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  98
* EL677.cbl
  5582         16  MA-QUALIFY-CODE-4             PIC XX.
  5583         16  MA-QUALIFY-CODE-5             PIC XX.
  5584
  5585         16  MA-INSURED-LAST-NAME          PIC X(15).
  5586         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5587         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5588         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5589         16  MA-INSURED-BIRTH-DT           PIC XX.
  5590         16  MA-INSURED-SEX                PIC X.
  5591             88  MA-SEX-MALE                   VALUE 'M'.
  5592             88  MA-SEX-FEMALE                 VALUE 'F'.
  5593         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5594
  5595         16  MA-ADDRESS-CORRECTED          PIC X.
  5596         16  MA-JOINT-BIRTH-DT             PIC XX.
  5597*        16  FILLER                        PIC X(12).
  5598
  5599         16  MA-ADDRESS-LINE-1             PIC X(30).
  5600         16  MA-ADDRESS-LINE-2             PIC X(30).
  5601         16  MA-CITY-STATE.
  5602             20  MA-CITY                   PIC X(28).
  5603             20  MA-ADDR-STATE             PIC XX.
  5604         16  MA-ZIP.
  5605             20  MA-ZIP-CODE.
  5606                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5607                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5608                 24  FILLER                PIC X(4).
  5609             20  MA-ZIP-PLUS4              PIC X(4).
  5610         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5611             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5612             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5613             20  FILLER                    PIC X(3).
  5614
  5615         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5616
  5617         16  FILLER                        PIC XXX.
  5618*        16  FILLER                        PIC X(10).
  5619
  5620     12  MA-CRED-BENE-INFO.
  5621         16  MA-CRED-BENE-NAME                 PIC X(25).
  5622         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5623         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5624         16  MA-CRED-BENE-CTYST.
  5625             20  MA-CRED-BENE-CITY             PIC X(28).
  5626             20  MA-CRED-BENE-STATE            PIC XX.
  5627         16  MA-CRED-BENE-ZIP.
  5628             20  MA-CB-ZIP-CODE.
  5629                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5630                     88  MA-CB-CANADIAN-POST-CODE
  5631                                           VALUE 'A' THRU 'Z'.
  5632                 24  FILLER                    PIC X(4).
  5633             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5634         16  MA-CB-CANADIAN-POSTAL-CODE
  5635                            REDEFINES MA-CRED-BENE-ZIP.
  5636             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5637             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5638             20  FILLER                        PIC X(3).
  5639     12  MA-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page  99
* EL677.cbl
  5640         16  MA-MAIL-DATA OCCURS 7.
  5641             20  MA-MAIL-TYPE              PIC X.
  5642                 88  MA-12MO-MAILING           VALUE '1'.
  5643                 88  MA-EXP-MAILING            VALUE '2'.
  5644             20  MA-MAIL-STATUS            PIC X.
  5645                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5646                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5647                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5648             20  MA-MAIL-DATE              PIC XX.
  5649     12  FILLER                            PIC XX.
  5650     12  FILLER                            PIC XX.
  5651*    12  FILLER                            PIC X(30).
  5652******************************************************************
  5653*                                COPY ERCPYAJ.
  5654******************************************************************
  5655*                                                                *
  5656*                            ERCPYAJ                             *
  5657*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5658*                            VMOD=2.015                          *
  5659*                                                                *
  5660*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  5661*                                                                *
  5662*                                                                *
  5663*   FILE TYPE = VSAM,KSDS                                        *
  5664*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5665*                                                                *
  5666*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  5667*       ALTERNATE PATHS = NONE                                   *
  5668*                                                                *
  5669*   LOG = YES                                                    *
  5670*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5671******************************************************************
  5672******************************************************************
  5673*                   C H A N G E   L O G
  5674*
  5675* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5676*-----------------------------------------------------------------
  5677*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5678* EFFECTIVE    NUMBER
  5679*-----------------------------------------------------------------
  5680* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  5681* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  5682******************************************************************
  5683
  5684 01  PENDING-PAY-ADJ.
  5685     12  PY-RECORD-ID                     PIC XX.
  5686         88  VALID-PY-ID                        VALUE 'PY'.
  5687
  5688     12  PY-CONTROL-PRIMARY.
  5689         16  PY-COMPANY-CD                PIC X.
  5690         16  PY-CARRIER                   PIC X.
  5691         16  PY-GROUPING                  PIC X(6).
  5692         16  PY-FIN-RESP                  PIC X(10).
  5693         16  PY-ACCOUNT                   PIC X(10).
  5694         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  5695                                          PIC X(10).
  5696         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  5697         16  PY-RECORD-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 100
* EL677.cbl
  5698             88  PY-REMIT-RECEIVED            VALUE 'R'.
  5699             88  PY-DEPOSIT                   VALUE 'D'.
  5700             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  5701             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  5702             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  5703             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  5704             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  5705             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  5706             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  5707             88  PY-FICA-ENTRY                VALUE 'F'.
  5708             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  5709             88  PY-POLICY-FEE                VALUE 'W'.
  5710             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  5711
  5712     12  PY-PYMT-TYPE                     PIC X.
  5713             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  5714             88  PY-REINS-PYMT                VALUE 'R'.
  5715             88  PY-EXP-PYMT                  VALUE 'E'.
  5716
  5717     12  PY-BIL-INV                       PIC X(6).
  5718     12  PY-REF-NO                        PIC X(12).
  5719
  5720     12  PY-LAST-MAINT-DT                 PIC XX.
  5721     12  PY-LAST-MAINT-BY                 PIC X(4).
  5722     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5723
  5724     12  PY-PYADJ-RECORD.
  5725         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  5726         16  PY-ENTRY-COMMENT             PIC X(30).
  5727         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  5728             20  PY-GL-ACCOUNT            PIC X(10).
  5729             20  PY-GL-STATE              PIC X(02).
  5730             20  PY-GL-CANC-SW            PIC X(01).
  5731                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  5732                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  5733             20  PY-GL-COMMENT            PIC X(10).
  5734             20  FILLER      REDEFINES PY-GL-COMMENT.
  5735                 24  PY-GL-CHECK-NO       PIC 9(06).
  5736                 24  FILLER               PIC X(04).
  5737             20  FILLER                   PIC X(07).
  5738         16  PY-SAVE-ACCOUNT              PIC X(10).
  5739         16  PY-SAVE-TYPE                 PIC X(01).
  5740
  5741         16  PY-LETTERS.
  5742             20  PY-LETTER OCCURS 3 TIMES
  5743                           INDEXED BY PY-LET-NDX
  5744                                          PIC X(04).
  5745
  5746         16  PY-ERCOMP-TYPE               PIC X.
  5747             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  5748             88  PY-GA-TYPE                   VALUE 'G'.
  5749             88  PY-BANK-TYPE                 VALUE 'B'.
  5750         16  FILLER                       PIC X(05).
  5751
  5752     12  PY-RECORD-STATUS.
  5753         16  PY-CREDIT-SELECT-DT          PIC XX.
  5754         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  5755         16  PY-BILLED-DATE               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 101
* EL677.cbl
  5756         16  PY-REPORTED-DT               PIC XX.
  5757         16  PY-PMT-APPLIED               PIC X.
  5758             88  PY-ACCOUNT-PMT               VALUE 'A'.
  5759             88  PY-GA-PMT                    VALUE 'G'.
  5760             88  PY-OVWRITE-PMT               VALUE 'O'.
  5761             88  PY-NON-AR-PMT                VALUE 'N'.
  5762         16  FILLER                       PIC X(5).
  5763         16  PY-INPUT-DT                  PIC XX.
  5764         16  PY-CHECK-NUMBER              PIC X(6).
  5765         16  PY-VOID-SW                   PIC X.
  5766             88  PY-CHECK-VOIDED              VALUE 'V'.
  5767         16  PY-CHECK-ORIGIN-SW           PIC X.
  5768             88  PY-BILLING-CHECK             VALUE 'B'.
  5769             88  PY-REFUND-CHECK              VALUE 'R'.
  5770             88  PY-GA-CHECK                  VALUE 'G'.
  5771             88  PY-CHECK-WRITTEN             VALUE 'W'.
  5772             88  PY-CHECK-REVERSAL            VALUE 'V'.
  5773         16  PY-CHECK-WRITTEN-DT          PIC XX.
  5774         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  5775         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  5776         16  PY-BILL-FLAG                 PIC X.
  5777             88  PY-BILLED                    VALUE 'B'.
  5778         16  PY-AR-FLAG                   PIC X.
  5779             88  PY-AR-CYCLE                  VALUE 'C'.
  5780             88  PY-AR-MONTH-END              VALUE 'M'.
  5781         16  PY-AR-DATE                   PIC XX.
  5782
  5783     12  PY-GL-CODES.
  5784         16  PY-GL-DB                     PIC X(14).
  5785         16  PY-GL-CR                     PIC X(14).
  5786         16  PY-GL-FLAG                   PIC X.
  5787         16  PY-GL-DATE                   PIC XX.
  5788
  5789     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  5790     12  FILLER                           PIC X(3).
  5791******************************************************************
  5792 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CONTROL-FILE
  5793                          CHECK-RECORDS ACCOUNT-MASTER
  5794                          COMPENSATION-MASTER
  5795                          CERTIFICATE-MASTER PENDING-BUSINESS
  5796                          PENDING-MAILING-DATA MAILING-DATA
  5797                          PENDING-PAY-ADJ.
  5798 0000-DFHEXIT SECTION.
  5799     MOVE '9#                    $   ' TO DFHEIV0.
  5800     MOVE 'EL677' TO DFHEIV1.
  5801     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5802
  5803     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5804     MOVE '5'                    TO  DC-OPTION-CODE.
  5805     PERFORM 8500-DATE-CONVERT.
  5806     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5807     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5808     MOVE DC-GREG-DATE-1-MDY     TO  SAVE-CURRENT-DATE-MDY.
  5809
  5810     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5811
  5812     IF PI-AMOUNT NOT NUMERIC
  5813         MOVE ZEROS              TO  PI-AMOUNT.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 102
* EL677.cbl
  5814
  5815     IF EIBCALEN = 0
  5816         GO TO 8800-UNAUTHORIZED-ACCESS.
  5817     set P to address of KIXSYS
  5818     CALL "getenv" using by value P returning var-ptr
  5819     if var-ptr = null then
  5820        display ' kixsys not set '
  5821     else
  5822        set address of var to var-ptr
  5823        move 0 to env-var-len
  5824        inspect var tallying env-var-len
  5825          for characters before X'00'
  5826        unstring var (1:env-var-len) delimited by '/'
  5827           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5828              WS-KIX-SYS
  5829        end-unstring
  5830     end-if
  5831     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5832     MOVE 2                      TO  EMI-SWITCH2.
  5833     MOVE EIBTRMID               TO  QID-TERM.
  5834
  5835     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5836         MOVE PI-CALLING-PROGRAM TO  RETURNED-FROM.
  5837
  5838     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5839         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5840             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  5841             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  5842             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  5843             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  5844             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  5845             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  5846             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  5847             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  5848         ELSE
  5849             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  5850             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  5851             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  5852             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  5853             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  5854             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  5855             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  5856             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  5857
  5858     MOVE LOW-VALUES             TO  EL677AI.
  5859
  5860     if eibtrnid not = trans-id
  5861        evaluate true
  5862           when pi-return-to-program = 'EL6315'
  5863              move pi-company-cd to pi-chek-comp-cd
  5864              move pi-carrier    to pi-chek-carrier
  5865              move pi-grouping   to pi-chek-grouping
  5866              move pi-state      to pi-chek-state
  5867              move pi-account    to pi-chek-account
  5868              move pi-cert-eff-dt to pi-chek-eff-dt
  5869              move pi-cert-prime to pi-chek-cert-no
  5870              move pi-cert-sfx   to pi-chek-suf-no
  5871              move +1            to pi-chek-sequence
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 103
* EL677.cbl
  5872              move 'C'           to pi-check-type *> Correction
  5873              move 'S'           to mainti
  5874              move +1            to maintl
  5875              move al-uanon      to mainta
  5876              move dfhenter      to eibaid
  5877              go to 5000-browse-file
  5878           when pi-return-to-program = 'EL6318'
  5879              move 'C'           to pi-check-type *> Correction
  5880           when other
  5881              move 'R'           to pi-check-type *> Refund
  5882        end-evaluate
  5883     end-if
  5884     IF EIBTRNID NOT = TRANS-ID
  5885         move pi-processor-id    to pi-return-to
  5886         move +1                 to dedcynl
  5887         move 'N'                to dedcyno
  5888         move al-uanon           to dedcyna
  5889         move dfhpf7             to eibaid
  5890         move ' '                to pi-void-reissue-pass
  5891         move zeros              to pi-void-reissue-amt
  5892         perform 6800-browse-previous-chek-recs *> totals up prev
  5893                                 thru 6800-exit
  5894         perform 5600-get-erpndb thru 5600-exit *> calc refund on
  5895                                                *> pending record
  5896         IF PI-TO-EL677-FROM-EL1273
  5897             MOVE 'S'            TO MAINTI
  5898             MOVE 1              TO MAINTL
  5899             MOVE AL-UABON       TO MAINTA
  5900             MOVE DFHENTER       TO EIBAID
  5901             GO TO 5000-BROWSE-FILE.
  5902
  5903     IF EIBTRNID NOT = TRANS-ID
  5904        IF RETURNED-FROM = XCTL-1273 OR XCTL-114
  5905           PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT
  5906           PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5907           IF PI-PROCESS-BENEFICIARY
  5908              GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5909           ELSE
  5910              GO TO 6300-BUILD-CERT-SCREEN
  5911           end-if
  5912        ELSE
  5913           IF EIBTRNID NOT = EL6311-TRANS-ID and el6318-trans-id
  5914              GO TO 8100-SEND-INITIAL-MAP
  5915           ELSE
  5916              PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5917              IF PI-PROCESS-BENEFICIARY
  5918                 GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5919              ELSE
  5920                 GO TO 6300-BUILD-CERT-SCREEN
  5921              end-if
  5922           end-if
  5923        end-if
  5924      end-if
  5925
  5926     MOVE PI-COMPANY-CD          TO  CHEK-COMPANY-CD
  5927                                     PI-CHEK-COMP-CD.
  5928
  5929
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 104
* EL677.cbl
  5930* EXEC CICS HANDLE CONDITION
  5931*        PGMIDERR  (9600-PGMID-ERROR)
  5932*        ERROR     (9990-ABEND)
  5933*    END-EXEC.
  5934*    MOVE '"$L.                  ! " #00005832' TO DFHEIV0
  5935     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5936     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5937     MOVE X'2220233030303035383332' TO DFHEIV0(25:11)
  5938     CALL 'kxdfhei1' USING DFHEIV0
  5939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5940
  5941
  5942     IF EIBAID = DFHCLEAR
  5943         GO TO 9400-CLEAR.
  5944
  5945     IF PI-PROCESSOR-ID = 'LGXX'
  5946         GO TO 0200-RECEIVE.
  5947
  5948
  5949* EXEC CICS READQ TS
  5950*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5951*        INTO   (SECURITY-CONTROL)
  5952*        LENGTH (SC-COMM-LENGTH)
  5953*        ITEM   (SC-ITEM)
  5954*    END-EXEC.
  5955*    MOVE '*$II   L              ''   #00005843' TO DFHEIV0
  5956     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5957     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5958     MOVE X'2020233030303035383433' TO DFHEIV0(25:11)
  5959     CALL 'kxdfhei1' USING DFHEIV0,
  5960           PI-SECURITY-TEMP-STORE-ID,
  5961           SECURITY-CONTROL,
  5962           SC-COMM-LENGTH,
  5963           SC-ITEM,
  5964           DFHEIV99,
  5965           DFHEIV99
  5966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5967
  5968
  5969     MOVE SC-CREDIT-DISPLAY (17)  TO PI-DISPLAY-CAP.
  5970     MOVE SC-CREDIT-UPDATE  (17)  TO PI-MODIFY-CAP.
  5971
  5972     IF NOT DISPLAY-CAP
  5973         MOVE 'READ'          TO SM-READ
  5974         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5975         MOVE ER-0070         TO  EMI-ERROR
  5976         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5977         GO TO 8100-SEND-INITIAL-MAP.
  5978
  5979 0200-RECEIVE.
  5980     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5981         MOVE ER-1159            TO  EMI-ERROR
  5982         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5983         MOVE -1                 TO  PFENTERL
  5984         GO TO 8200-SEND-DATAONLY.
  5985
  5986
  5987* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 105
* EL677.cbl
  5988*        MAPFAIL (8100-SEND-INITIAL-MAP)
  5989*    END-EXEC.
  5990*    MOVE '"$?                   ! # #00005867' TO DFHEIV0
  5991     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  5992     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5993     MOVE X'2320233030303035383637' TO DFHEIV0(25:11)
  5994     CALL 'kxdfhei1' USING DFHEIV0
  5995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5996
  5997
  5998
  5999* EXEC CICS RECEIVE
  6000*        MAP      (EL677A)
  6001*        MAPSET   (MAPSET-NAME)
  6002*        INTO     (EL677AI)
  6003*    END-EXEC.
  6004     MOVE LENGTH OF
  6005      EL677AI
  6006       TO DFHEIV11
  6007*    MOVE '8"T I  L              ''   #00005871' TO DFHEIV0
  6008     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6009     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6010     MOVE X'2020233030303035383731' TO DFHEIV0(25:11)
  6011     CALL 'kxdfhei1' USING DFHEIV0,
  6012           EL677A,
  6013           EL677AI,
  6014           DFHEIV11,
  6015           MAPSET-NAME,
  6016           DFHEIV99,
  6017           DFHEIV99
  6018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6019
  6020
  6021     IF PFENTERL GREATER ZERO
  6022         IF EIBAID NOT = DFHENTER
  6023             MOVE ER-0004        TO  EMI-ERROR
  6024             MOVE AL-UNBOF       TO  PFENTERA
  6025             MOVE -1             TO  PFENTERL
  6026             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6027             GO TO 8200-SEND-DATAONLY
  6028         ELSE
  6029             IF (PFENTERI NUMERIC) AND
  6030                (PFENTERI GREATER 0 AND LESS 25)
  6031                 MOVE PF-VALUES (PFENTERI)   TO  EIBAID
  6032             ELSE
  6033                 MOVE ER-0029    TO  EMI-ERROR
  6034                 MOVE AL-UNBOF   TO  PFENTERA
  6035                 MOVE -1         TO  PFENTERL
  6036                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6037                 GO TO 8200-SEND-DATAONLY.
  6038 0300-CHECK-PFKEYS.
  6039     IF EIBAID = DFHPF23
  6040         GO TO 8810-PF23.
  6041
  6042     IF EIBAID = DFHPF24
  6043         GO TO 9200-RETURN-MAIN-MENU.
  6044
  6045     IF EIBAID = DFHPF12
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 106
* EL677.cbl
  6046         GO TO 9500-PF12.
  6047
  6048     IF EIBAID = DFHPF1 OR DFHPF2
  6049         GO TO 5000-BROWSE-FILE.
  6050
  6051     if PI-TO-EL677-FROM-EL1273
  6052        and (eibaid not = dfhenter)
  6053        and (pi-void-reissue-pass not = '1' and '2')
  6054        go to 0320-input-error
  6055     end-if
  6056     IF EIBAID = DFHPF3
  6057         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6058         MOVE 'PF3'              TO  PI-PFKEY
  6059         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6060         IF PI-RETURN-TO-PROGRAM IS EQUAL TO 'EL1273  '
  6061             GO TO 9400-CLEAR
  6062         ELSE
  6063             MOVE XCTL-1273      TO  PGM-NAME
  6064             GO TO 9300-XCTL.
  6065
  6066     IF EIBAID = DFHPF4
  6067         IF NOT FORCE-CAP
  6068             MOVE ER-0433        TO EMI-ERROR
  6069             MOVE -1             TO PFENTERL
  6070             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6071             GO TO 8200-SEND-DATAONLY.
  6072
  6073     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2 OR DFHPF4 OR
  6074                             DFHPF5 OR DFHPF6 or dfhpf7
  6075         GO TO 1000-EDIT-DATA.
  6076
  6077*    IF EIBAID = DFHPF7
  6078*        PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6079*        PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6080*        MOVE XCTL-114           TO  PGM-NAME
  6081*        GO TO 9300-XCTL.
  6082
  6083 0320-INPUT-ERROR.
  6084     MOVE ER-0029                TO  EMI-ERROR.
  6085     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6086     MOVE -1                     TO  PFENTERL.
  6087     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 107
* EL677.cbl
  6089
  6090 1000-EDIT-DATA.
  6091     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D' or 'R'
  6092         MOVE AL-UANON           TO MAINTA
  6093         IF MAINTI = 'C' OR 'V' OR 'R'
  6094             IF PI-PREV-MAINT = 'S'  OR  'C' or 'R'
  6095                 NEXT SENTENCE
  6096             ELSE
  6097                 MOVE ER-2056    TO  EMI-ERROR
  6098                 MOVE -1         TO  MAINTL
  6099                 MOVE AL-UABON   TO  MAINTA
  6100                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6101                 GO TO 1100-EDIT-COMPLETE
  6102         ELSE
  6103             NEXT SENTENCE
  6104     ELSE
  6105         IF EIBAID = DFHPF5 OR DFHPF6 or dfhpf7
  6106            NEXT SENTENCE
  6107         ELSE
  6108            MOVE ER-0023            TO  EMI-ERROR
  6109            MOVE -1                 TO  MAINTL
  6110            MOVE AL-UABON           TO  MAINTA
  6111            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6112
  6113     IF MODIFY-CAP
  6114         NEXT SENTENCE
  6115       ELSE
  6116         IF MAINTI NOT = 'S'
  6117            MOVE 'UPDATE'       TO SM-READ
  6118            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6119            MOVE ER-0070        TO EMI-ERROR
  6120            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6121            GO TO 8100-SEND-INITIAL-MAP.
  6122
  6123     if (pi-return-to-program = 'EL1273')
  6124        and (MAINTI not = 'S' and 'V' and 'R' and 'D')
  6125        move 'S'                 to mainti
  6126        move +1                  to maintl
  6127        move al-uanon            to mainta
  6128     end-if
  6129     IF CARRIERI NOT = LOW-VALUES
  6130         MOVE AL-UANON           TO  CARRIERA
  6131         PERFORM 1200-VERIFY-CARRIER-ID THRU 1200-EXIT
  6132         MOVE CARRIERI           TO  PI-CHEK-CARRIER
  6133                                     PI-CARRIER
  6134     ELSE
  6135         MOVE -1                 TO  CARRIERL
  6136         MOVE AL-UABON           TO  CARRIERA
  6137         MOVE ER-0194            TO  EMI-ERROR
  6138         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6139
  6140     IF GROUPI NOT = LOW-VALUES
  6141         MOVE AL-UANON           TO  GROUPA
  6142         MOVE GROUPI             TO  PI-CHEK-GROUPING
  6143                                     PI-GROUPING
  6144     ELSE
  6145         MOVE -1                 TO  GROUPL
  6146         MOVE AL-UABON           TO  GROUPA
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 108
* EL677.cbl
  6147         MOVE ER-0195            TO  EMI-ERROR
  6148         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6149
  6150     IF STATEI NOT = LOW-VALUES
  6151         MOVE AL-UANON           TO  STATEA
  6152         PERFORM 1300-VERIFY-STATE-ID THRU 1390-EXIT
  6153         MOVE STATEI             TO  PI-CHEK-STATE
  6154                                     PI-STATE
  6155     ELSE
  6156         MOVE -1                 TO  STATEL
  6157         MOVE AL-UABON           TO  STATEA
  6158         MOVE ER-0196            TO  EMI-ERROR
  6159         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6160
  6161     IF EFFDTL GREATER ZERO
  6162         MOVE EFFDTI             TO  WS-DT-DEEDIT-FIELD
  6163         PERFORM 8700-DEEDIT
  6164         IF WS-DEEDIT-FIELD-DATE-OUT IS NUMERIC
  6165             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EFFDTO
  6166             INSPECT EFFDTI CONVERTING SPACES TO '/'
  6167             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  6168             MOVE '4'                TO  DC-OPTION-CODE
  6169             PERFORM 8500-DATE-CONVERT
  6170             IF DC-ERROR-CODE NOT = SPACES
  6171                 MOVE ER-0215        TO  EMI-ERROR
  6172                 PERFORM 9900-ERROR-FORMAT
  6173                 MOVE -1             TO  EFFDTL
  6174                 MOVE AL-UABON       TO  EFFDTA
  6175               ELSE
  6176                 MOVE AL-UANON       TO  EFFDTA
  6177                 MOVE DC-BIN-DATE-1  TO  PI-CHEK-EFF-DT
  6178                                         PI-CERT-EFF-DT
  6179           ELSE
  6180             MOVE ER-0215        TO  EMI-ERROR
  6181             PERFORM 9900-ERROR-FORMAT
  6182             MOVE -1             TO  EFFDTL
  6183             MOVE AL-UABON       TO  EFFDTA
  6184       ELSE
  6185         MOVE ER-0216            TO  EMI-ERROR
  6186         PERFORM 9900-ERROR-FORMAT
  6187         MOVE -1                 TO  EFFDTL
  6188         MOVE AL-UABOF           TO  EFFDTA.
  6189
  6190     IF ACCTI NOT = LOW-VALUES
  6191         MOVE AL-UANON           TO  ACCTA
  6192         PERFORM 1400-VERIFY-ACCOUNT THRU 1490-EXIT
  6193         MOVE ACCTI              TO  PI-CHEK-ACCOUNT
  6194                                     PI-ACCOUNT
  6195     ELSE
  6196         MOVE -1                 TO  ACCTL
  6197         MOVE AL-UABON           TO  ACCTA
  6198         MOVE ER-0197            TO  EMI-ERROR
  6199         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6200
  6201     IF CERTNOI NOT = LOW-VALUES
  6202         MOVE AL-UANON           TO  CERTNOA
  6203         MOVE CERTNOI            TO  PI-CHEK-CERT-NO
  6204                                     PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 109
* EL677.cbl
  6205     ELSE
  6206         MOVE -1                 TO  CERTNOL
  6207         MOVE AL-UABON           TO  CERTNOA
  6208         MOVE ER-0203            TO  EMI-ERROR
  6209         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6210
  6211     IF SFXI  = LOW-VALUES
  6212         MOVE SPACE              TO  SFXI.
  6213
  6214     MOVE AL-UANON               TO  SFXA.
  6215
  6216     MOVE SFXI                   TO  PI-CHEK-SUF-NO
  6217                                     PI-CERT-SFX.
  6218     IF SEQI = LOW-VALUES
  6219         MOVE +1                 TO  SEQI.
  6220
  6221     MOVE AL-UNNON               TO  SEQA.
  6222     MOVE SEQI                   TO  PI-CHEK-SEQUENCE.
  6223
  6224     IF PAYTO1L > 0
  6225         MOVE PAYTO1I            TO  PI-PAYTO1
  6226     ELSE
  6227         MOVE SPACES             TO  PI-PAYTO1.
  6228
  6229     IF AMOUNTL > 0
  6230
  6231* EXEC CICS BIF DEEDIT
  6232*            FIELD   (AMOUNTI)
  6233*            LENGTH  (11)
  6234*        END-EXEC
  6235     MOVE 11
  6236       TO DFHEIV11
  6237*    MOVE '@"L                   #   #00006086' TO DFHEIV0
  6238     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6239     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6240     MOVE X'2020233030303036303836' TO DFHEIV0(25:11)
  6241     CALL 'kxdfhei1' USING DFHEIV0,
  6242           AMOUNTI,
  6243           DFHEIV11
  6244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6245         MOVE AMOUNTI            TO  PI-AMOUNT
  6246     ELSE
  6247         MOVE ZEROS              TO  PI-AMOUNT.
  6248
  6249     IF TYPEL > 0
  6250         MOVE TYPEI              TO  PI-TYPE
  6251     ELSE
  6252         MOVE SPACE              TO  PI-TYPE.
  6253
  6254*    IF REFL > 0
  6255*        MOVE REFI               TO  PI-REFERENCE
  6256*    ELSE
  6257*        MOVE SPACES             TO  PI-REFERENCE.
  6258     if rettol not = zeros
  6259        move rettoi              to pi-return-to
  6260        MOVE AL-UANON            TO  RETTOA
  6261     end-if
  6262     if dedcynl not = zeros
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 110
* EL677.cbl
  6263        if dedcyni = 'Y' OR 'N'
  6264           move al-uanon         to dedcyna
  6265           continue
  6266        else
  6267           move er-3451          to emi-error
  6268           move -1               to dedcynl
  6269           move al-uabon         to dedcyna
  6270           perform 9900-error-format
  6271                                 thru 9900-exit
  6272        end-if
  6273     end-if
  6274
  6275     if mainti = 'V' or 'R'
  6276        if ((vreasonl > zeros)
  6277           and (vreasoni (1:2) not = spaces))
  6278             or (pi-void-reissue-pass = '1' or '2')
  6279           continue
  6280        else
  6281           move er-3454          to emi-error
  6282           move -1               to vreasonl
  6283           move al-uabon         to vreasona
  6284           perform 9900-error-format
  6285                                 thru 9900-exit
  6286        end-if
  6287     end-if
  6288     if (mainti = 'A')
  6289        and (pi-prev-paid > zeros)
  6290        and (pi-check-type = 'C')
  6291        move er-3459             to emi-error
  6292        move -1                  to maintl
  6293        move al-uabon            to mainta
  6294        perform 9900-error-format
  6295                                 thru 9900-exit
  6296     end-if
  6297     if mainti = 'A'
  6298        continue
  6299     else
  6300        IF MAINTI = 'S'
  6301           or pi-prev-maint = 'S'
  6302           GO TO 1100-EDIT-COMPLETE
  6303        end-if
  6304     end-if
  6305     if (pi-void-reissue-pass = '1')
  6306        and (mainti = 'R')
  6307        if emi-error = zeros
  6308           if eibaid = dfhpf5 or dfhpf6 or dfhpf7
  6309              go to 7500-reissue-pass-1
  6310           else
  6311              if eibaid = dfhenter
  6312                 move er-3460    to emi-error
  6313                 move -1         to maintl
  6314                 move al-uabon   to mainta
  6315                 perform 9900-error-format
  6316                                 thru 9900-exit
  6317              end-if
  6318           end-if
  6319        end-if
  6320     end-if
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 111
* EL677.cbl
  6321
  6322     if (pi-void-reissue-pass = '2')
  6323        and (mainti = 'R')
  6324        if emi-error = zeros
  6325           if eibaid = dfhpf5 or dfhpf6 or dfhpf7
  6326              go to 7500-reissue-pass-1
  6327           else
  6328              if eibaid = dfhenter
  6329                 go to 7510-reissue-pass-2
  6330              end-if
  6331           end-if
  6332        end-if
  6333     end-if
  6334*    if (pi-void-reissue-pass = '1')
  6335*       and (mainti = 'R')
  6336*       if emi-error = zeros
  6337*          if eibaid = dfhpf5 or dfhpf6 or dfhpf7
  6338*             go to 7500-reissue-pass-1
  6339*          else
  6340*             if eibaid = dfhenter
  6341*                go to 7510-reissue-pass-2
  6342*                move '2'        to pi-void-reissue-pass
  6343*             end-if
  6344*          end-if
  6345*       end-if
  6346*    end-if
  6347     IF EIBAID = DFHPF5
  6348        IF EMI-ERROR = ZEROS
  6349          GO TO 6500-BUILD-ACCOUNT-SCREEN
  6350        ELSE
  6351          GO TO 1100-EDIT-COMPLETE.
  6352
  6353     IF EIBAID = DFHPF6
  6354        IF EMI-ERROR = ZEROS
  6355           GO TO 6300-BUILD-CERT-SCREEN
  6356         ELSE
  6357           GO TO 1100-EDIT-COMPLETE.
  6358
  6359     IF EIBAID = DFHPF7
  6360        IF EMI-ERROR = ZEROS
  6361           GO TO 6600-build-beneficiary-screen
  6362         ELSE
  6363           GO TO 1100-EDIT-COMPLETE.
  6364     if mainti = 'A'
  6365        if dedcynl not = zeros
  6366           if dedcyni <> pi-previous-deduct-comm
  6367              perform 6700-build-common
  6368                                 thru 6700-exit
  6369              MOVE WS-REFUND-AMOUNT
  6370                                 TO AMOUNTO
  6371              MOVE AL-UANON      TO PAYTO1A
  6372                                    PAYTO2A
  6373                                    PAYAD1A
  6374                                    PAYCTYA
  6375                                    paysta
  6376                                    PTOZIPA
  6377              GO TO 8100-send-initial-map
  6378           end-if
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 112
* EL677.cbl
  6379        end-if
  6380     end-if
  6381*    if mainti = 'V'
  6382*       if (vreasonl > zeros)
  6383*          and (vreasoni (1:2) not = spaces)
  6384*          continue
  6385*       else
  6386*          move er-3454          to emi-error
  6387*          move -1               to vreasonl
  6388*          move al-uabon         to vreasona
  6389*          perform 9900-error-format
  6390*                                thru 9900-exit
  6391*       end-if
  6392*    end-if
  6393     IF MAINTI = 'A'
  6394        if (payto1i not = spaces and low-values)
  6395           and (payad1i not = spaces and low-values)
  6396           and (payctyi not = spaces and low-values)
  6397           and (paysti not = spaces and low-values)
  6398           and (ptozipi not = spaces and low-values)
  6399           continue
  6400        else
  6401           MOVE -1               TO PAYTO1L
  6402           MOVE ER-2907          TO EMI-ERROR
  6403           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6404        end-if
  6405     end-if
  6406
  6407     IF MAINTI = 'A'
  6408         IF EIBAID NOT = DFHPF4
  6409             MOVE DFHENTER       TO  EIBAID
  6410             PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  6411
  6412     IF MAINTI = 'S' OR 'V' or 'R' or 'D'
  6413         GO TO 1100-EDIT-COMPLETE.
  6414
  6415     IF PRINTEDL GREATER THAN +0
  6416         MOVE PRINTEDI           TO  WS-DEEDIT-FIELD-A
  6417         PERFORM 8700-DEEDIT
  6418         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6419             MOVE WS-DEEDIT-FIELD-V0 TO  PRINTEDO
  6420             INSPECT PRINTEDI CONVERTING SPACES TO '/'
  6421             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  6422             MOVE '4'                TO  DC-OPTION-CODE
  6423             PERFORM 8500-DATE-CONVERT
  6424             IF DC-ERROR-CODE NOT = SPACES
  6425                 MOVE ER-3046        TO  EMI-ERROR
  6426                 PERFORM 9900-ERROR-FORMAT
  6427                 MOVE -1             TO  PRINTEDL
  6428                 MOVE AL-UABON       TO  PRINTEDA
  6429                 MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT
  6430             ELSE
  6431                 MOVE AL-UANON       TO  PRINTEDA
  6432                 MOVE DC-BIN-DATE-1  TO  WS-CHK-PRINT-DT
  6433         ELSE
  6434             MOVE ER-3046        TO  EMI-ERROR
  6435             PERFORM 9900-ERROR-FORMAT
  6436             MOVE -1             TO  PRINTEDL
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 113
* EL677.cbl
  6437             MOVE AL-UABON       TO  PRINTEDA
  6438             MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT.
  6439
  6440     IF AMOUNTL = ZEROS
  6441         GO TO 1050-CK-AMT.
  6442
  6443*    EXEC CICS BIF DEEDIT
  6444*        FIELD   (AMOUNTI)
  6445*        LENGTH  (11)
  6446*    END-EXEC.
  6447
  6448     IF AMOUNTI NOT NUMERIC     OR
  6449        AMOUNTI LESS THAN ZERO  OR
  6450       (AMOUNTI = ZEROS  AND
  6451               (PI-COMPANY-ID NOT = 'LAP' AND 'RMC'))
  6452          MOVE ER-1159            TO  EMI-ERROR
  6453          MOVE -1                 TO  AMOUNTL
  6454          MOVE AL-UNBON           TO  AMOUNTA
  6455          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6456          GO TO 1100-EDIT-COMPLETE.
  6457
  6458     MOVE AMOUNTI                TO  WS-AM-WORK.
  6459
  6460     IF WS-AM-SIGN = SPACES
  6461         MOVE WS-AM-NUM          TO  WS-AMT
  6462         ADD 0                   TO  WS-AMT
  6463       ELSE
  6464         MOVE AMOUNTI            TO  WS-AMT
  6465         ADD 0                   TO  WS-AMT.
  6466
  6467     IF MAINTI = 'A'
  6468        IF EIBAID = DFHENTER
  6469           if (ws-amt + pi-prev-paid) >
  6470              (cm-lf-premium-amt + cm-lf-alt-premium-amt +
  6471                 cm-ah-premium-amt)
  6472              move zeros to ws-amt
  6473           end-if
  6474        end-if
  6475     end-if
  6476      MOVE WS-AMT                TO  AMOUNTO.
  6477      MOVE AL-UNNON              TO  AMOUNTA.
  6478
  6479 1050-CK-AMT.
  6480     IF AMOUNTL = ZEROS AND
  6481        MAINTI  = 'A'
  6482         MOVE ER-1159            TO  EMI-ERROR
  6483         MOVE -1                 TO  AMOUNTL
  6484         MOVE AL-UNBON           TO  AMOUNTA
  6485         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6486
  6487*    MOVE AL-UANON              TO  TYPEA.
  6488     if (amountl <> zeros)
  6489        if (ws-amt <= zeros)
  6490           and (pi-check-type <> 'C')
  6491           MOVE ER-9999          TO EMI-ERROR
  6492           MOVE -1               TO AMOUNTL
  6493           MOVE AL-UNBON         TO AMOUNTA
  6494           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 114
* EL677.cbl
  6495                                 THRU 9900-EXIT
  6496        end-if
  6497     end-if
  6498     IF TYPEL GREATER THAN ZEROS
  6499         IF TYPEI = 'R' OR 'M' OR 'E' or 'C'
  6500             NEXT SENTENCE
  6501         ELSE
  6502             MOVE ER-3044    TO  EMI-ERROR
  6503             MOVE -1         TO  TYPEL
  6504             MOVE AL-PABON   TO  TYPEA
  6505             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6506     ELSE
  6507         IF MAINTI  = 'A'
  6508             MOVE ER-3044    TO  EMI-ERROR
  6509             MOVE -1         TO  TYPEL
  6510             MOVE AL-PABON   TO  TYPEA
  6511             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6512
  6513
  6514 1100-EDIT-COMPLETE.
  6515
  6516     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6517       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6518        EIBAID NOT = DFHPF4)
  6519         GO TO 8200-SEND-DATAONLY.
  6520
  6521     MOVE MAINTI                 TO  PI-PREV-MAINT.
  6522
  6523     IF MAINTI = 'A'
  6524         GO TO 2000-ADD-RECORD.
  6525
  6526*    IF MAINTI = 'C' OR 'V'
  6527     IF MAINTI = 'V' or 'R'
  6528         GO TO 3000-CHANGE-RECORD.
  6529
  6530     IF MAINTI = 'S' or 'C'
  6531         GO TO 5000-BROWSE-FILE.
  6532
  6533     if mainti = 'D'
  6534        go to 3400-delete-record
  6535     end-if
  6536     .
  6537 1200-VERIFY-CARRIER-ID.
  6538     MOVE SPACES                 TO ELCNTL-KEY.
  6539     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6540     MOVE '6'                    TO ELCNTL-REC-TYPE.
  6541     MOVE CARRIERI               TO ELCNTL-CARRIER.
  6542     MOVE +0                     TO ELCNTL-SEQ.
  6543
  6544
  6545* EXEC CICS HANDLE CONDITION
  6546*        NOTFND   (1290-NO-CARRIER)
  6547*    END-EXEC.
  6548*    MOVE '"$I                   ! $ #00006389' TO DFHEIV0
  6549     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6550     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6551     MOVE X'2420233030303036333839' TO DFHEIV0(25:11)
  6552     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 115
* EL677.cbl
  6553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6554
  6555
  6556
  6557* EXEC CICS READ
  6558*        DATASET   (ELCNTL-FILE-ID)
  6559*        SET       (ADDRESS OF CONTROL-FILE)
  6560*        RIDFLD    (ELCNTL-KEY)
  6561*    END-EXEC.
  6562*    MOVE '&"S        E          (   #00006393' TO DFHEIV0
  6563     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6564     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6565     MOVE X'2020233030303036333933' TO DFHEIV0(25:11)
  6566     CALL 'kxdfhei1' USING DFHEIV0,
  6567           ELCNTL-FILE-ID,
  6568           DFHEIV20,
  6569           DFHEIV99,
  6570           ELCNTL-KEY,
  6571           DFHEIV99,
  6572           DFHEIV99,
  6573           DFHEIV99
  6574     SET ADDRESS OF CONTROL-FILE TO
  6575         DFHEIV20
  6576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6577
  6578
  6579     GO TO 1200-EXIT.
  6580
  6581 1290-NO-CARRIER.
  6582     MOVE ER-2208                TO EMI-ERROR.
  6583     MOVE -1                     TO CARRIERL.
  6584     MOVE AL-UABON               TO CARRIERA.
  6585     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6586
  6587 1200-EXIT.
  6588      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 116
* EL677.cbl
  6590 1300-VERIFY-STATE-ID.
  6591     MOVE SPACES                 TO ELCNTL-KEY.
  6592     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6593     MOVE '3'                    TO ELCNTL-REC-TYPE.
  6594     MOVE STATEI                 TO ELCNTL-STATE.
  6595     MOVE +0                     TO ELCNTL-SEQ.
  6596
  6597
  6598* EXEC CICS HANDLE CONDITION
  6599*        NOTFND   (1380-NO-STATE)
  6600*    END-EXEC.
  6601*    MOVE '"$I                   ! % #00006417' TO DFHEIV0
  6602     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6603     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6604     MOVE X'2520233030303036343137' TO DFHEIV0(25:11)
  6605     CALL 'kxdfhei1' USING DFHEIV0
  6606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6607
  6608
  6609
  6610* EXEC CICS READ
  6611*        DATASET   (ELCNTL-FILE-ID)
  6612*        SET       (ADDRESS OF CONTROL-FILE)
  6613*        RIDFLD    (ELCNTL-KEY)
  6614*    END-EXEC.
  6615*    MOVE '&"S        E          (   #00006421' TO DFHEIV0
  6616     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6617     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6618     MOVE X'2020233030303036343231' TO DFHEIV0(25:11)
  6619     CALL 'kxdfhei1' USING DFHEIV0,
  6620           ELCNTL-FILE-ID,
  6621           DFHEIV20,
  6622           DFHEIV99,
  6623           ELCNTL-KEY,
  6624           DFHEIV99,
  6625           DFHEIV99,
  6626           DFHEIV99
  6627     SET ADDRESS OF CONTROL-FILE TO
  6628         DFHEIV20
  6629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6630
  6631
  6632     GO TO 1390-EXIT.
  6633
  6634 1380-NO-STATE.
  6635     MOVE ER-2209                TO EMI-ERROR.
  6636     MOVE -1                     TO STATEL.
  6637     MOVE AL-UABON               TO STATEA.
  6638     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6639
  6640 1390-EXIT.
  6641      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 117
* EL677.cbl
  6643
  6644 1400-VERIFY-ACCOUNT.
  6645     IF EIBAID = DFHPF5
  6646         GO TO 1410-BUILD-ACCOUNT-KEY.
  6647
  6648     IF MAINTL GREATER +0
  6649         NEXT SENTENCE
  6650       ELSE
  6651         GO TO 1490-EXIT.
  6652
  6653*    IF MAINTI = 'A' OR 'C' OR 'V'
  6654     IF MAINTI = 'A' OR 'V' or 'R'
  6655         NEXT SENTENCE
  6656       ELSE
  6657         GO TO 1490-EXIT.
  6658
  6659 1410-BUILD-ACCOUNT-KEY.
  6660     MOVE CARRIERI               TO ERACCT-CARRIER.
  6661     MOVE GROUPI                 TO ERACCT-GROUPING
  6662     MOVE STATEI                 TO ERACCT-STATE.
  6663     MOVE ACCTI                  TO ERACCT-ACCOUNT.
  6664     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  6665
  6666     MOVE '2'                    TO DC-OPTION-CODE.
  6667     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6668
  6669     PERFORM 8500-DATE-CONVERT.
  6670     IF DATE-CONVERSION-ERROR
  6671        GO TO 1480-ACCOUNT-INVALID.
  6672
  6673     MOVE DC-BIN-DATE-1          TO ERACCT-EXP-DATE.
  6674    .
  6675 1420-get-eracct.
  6676     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  6677
  6678
  6679* EXEC CICS HANDLE CONDITION
  6680*        NOTFND   (1480-ACCOUNT-INVALID)
  6681*        ENDFILE  (1480-ACCOUNT-INVALID)
  6682*    END-EXEC.
  6683*    MOVE '"$I''                  ! & #00006473' TO DFHEIV0
  6684     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6685     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6686     MOVE X'2620233030303036343733' TO DFHEIV0(25:11)
  6687     CALL 'kxdfhei1' USING DFHEIV0
  6688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6689
  6690
  6691
  6692* EXEC CICS STARTBR
  6693*        DATASET   (ERACCT-FILE-ID)
  6694*        RIDFLD    (ERACCT-KEY)
  6695*    END-EXEC.
  6696     MOVE 0
  6697       TO DFHEIV11
  6698*    MOVE '&,         G          &   #00006478' TO DFHEIV0
  6699     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6700     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 118
* EL677.cbl
  6701     MOVE X'2020233030303036343738' TO DFHEIV0(25:11)
  6702     CALL 'kxdfhei1' USING DFHEIV0,
  6703           ERACCT-FILE-ID,
  6704           ERACCT-KEY,
  6705           DFHEIV99,
  6706           DFHEIV11,
  6707           DFHEIV99
  6708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6709
  6710
  6711     set eracct-start to true
  6712     .
  6713 1420-READNEXT-ACCOUNT-MASTER.
  6714
  6715* EXEC CICS READNEXT
  6716*        DATASET   (ERACCT-FILE-ID)
  6717*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6718*        RIDFLD    (ERACCT-KEY)
  6719*    END-EXEC.
  6720     MOVE 0
  6721       TO DFHEIV11
  6722*    MOVE '&.S                   )   #00006486' TO DFHEIV0
  6723     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6724     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6725     MOVE X'2020233030303036343836' TO DFHEIV0(25:11)
  6726     CALL 'kxdfhei1' USING DFHEIV0,
  6727           ERACCT-FILE-ID,
  6728           DFHEIV20,
  6729           DFHEIV99,
  6730           ERACCT-KEY,
  6731           DFHEIV99,
  6732           DFHEIV11,
  6733           DFHEIV99,
  6734           DFHEIV99
  6735     SET ADDRESS OF ACCOUNT-MASTER TO
  6736         DFHEIV20
  6737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6738
  6739
  6740*    IF PI-COMPANY-CD    NOT = AM-COMPANY-CD   OR
  6741*       SV-ACCT-GROUPING NOT = AM-GROUPING     OR
  6742*       SV-ACCT-CARRIER  NOT = AM-CARRIER      OR
  6743*       SV-ACCT-STATE    NOT = AM-STATE        OR
  6744*       SV-ACCT-ACCOUNT  NOT = AM-ACCOUNT
  6745*         GO TO 1480-ACCOUNT-INVALID.
  6746*
  6747*    IF SV-ACCT-EXP-DATE LESS AM-EFFECTIVE-DT
  6748*        GO TO 1480-ACCOUNT-INVALID.
  6749*
  6750*    IF SV-ACCT-EXP-DATE NOT LESS AM-EXPIRATION-DT
  6751*        GO TO 1420-READNEXT-ACCOUNT-MASTER.
  6752
  6753     evaluate true
  6754        when (save-eracct-key (1:20) not =
  6755           am-control-primary (1:20))
  6756           and (not eracct-found)
  6757           go to 1480-account-invalid
  6758        when (save-eracct-key (1:20) not =
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 119
* EL677.cbl
  6759           am-control-primary (1:20))
  6760           and (eracct-found)
  6761           move ws-hold-eracct-record
  6762                                 to account-master
  6763        when (sv-acct-exp-date < am-effective-dt)
  6764           and (not eracct-found)
  6765           go to 1480-account-invalid
  6766        when sv-acct-exp-date >= am-expiration-dt
  6767           go to 1420-readnext-account-master
  6768        when am-expiration-dt = high-values
  6769           continue
  6770        when other
  6771           set eracct-found to true
  6772           move account-master   to ws-hold-eracct-record
  6773           go to 1420-readnext-account-master
  6774     end-evaluate
  6775     if eracct-start
  6776
  6777* exec cics endbr
  6778*          dataset  (eracct-file-id)
  6779*       end-exec
  6780     MOVE 0
  6781       TO DFHEIV11
  6782*    MOVE '&2                    $   #00006528' TO DFHEIV0
  6783     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6784     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6785     MOVE X'2020233030303036353238' TO DFHEIV0(25:11)
  6786     CALL 'kxdfhei1' USING DFHEIV0,
  6787           eracct-file-id,
  6788           DFHEIV11,
  6789           DFHEIV99
  6790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6791     end-if
  6792*    if am-expiration-dt = high-values
  6793*       continue
  6794*    else
  6795*       move account-master      to ws-hold-eracct-record
  6796*       go to 1420-readnext-account-master
  6797*    end-if
  6798     MOVE AM-CARRIER             TO PI-CR-CARRIER.
  6799     MOVE AM-GROUPING            TO PI-CR-GROUPING.
  6800     MOVE AM-STATE               TO PI-CR-STATE.
  6801     MOVE AM-AGT (AM-REMIT-TO)   TO PI-CR-FIN-RESP.
  6802
  6803     MOVE AM-NAME                TO PI-AM-NAME.
  6804     MOVE AM-ADDRS               TO PI-AM-ADDRS.
  6805     MOVE AM-CITY                TO PI-AM-CITY-st
  6806     MOVE AM-ZIP                 TO PI-AM-ZIP-CODE.
  6807     move am-csr-code            to pi-am-csr
  6808
  6809     MOVE +0                     TO WS-SUB.
  6810
  6811 1430-FIND-ACC-AGT.
  6812     ADD +1                      TO WS-SUB.
  6813
  6814     IF  WS-SUB GREATER +10
  6815         GO TO 1480-ACCOUNT-INVALID.
  6816
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 120
* EL677.cbl
  6817     IF (AM-COM-TYP (WS-SUB) = 'C' OR 'D' OR 'F')
  6818         MOVE AM-AGT (WS-SUB)    TO  PI-CR-ACCOUNT
  6819       ELSE
  6820         GO TO 1430-FIND-ACC-AGT.
  6821
  6822     MOVE AL-UANON               TO CARRIERA
  6823                                    GROUPA
  6824                                    STATEA.
  6825
  6826     PERFORM 6000-VERIFY-COMP-MASTER THRU 6090-EXIT.
  6827
  6828     GO TO 1490-EXIT.
  6829
  6830 1480-ACCOUNT-INVALID.
  6831     MOVE -1                     TO CARRIERL
  6832     MOVE AL-UANON               TO CARRIERA
  6833                                    GROUPA
  6834                                    STATEA
  6835                                    ACCTA.
  6836     MOVE ER-2210                TO EMI-ERROR.
  6837     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6838     GO TO 8200-SEND-DATAONLY.
  6839
  6840 1490-EXIT.
  6841      EXIT.
  6842
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 121
* EL677.cbl
  6844 1500-VERIFY-PENDING-BUS-REC.
  6845     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  6846     if pi-corr-check
  6847        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW
  6848        go to 1590-exit
  6849     end-if
  6850
  6851* EXEC CICS HANDLE CONDITION
  6852*        NOTFND   (1590-EXIT)
  6853*    END-EXEC.
  6854*    MOVE '"$I                   ! '' #00006590' TO DFHEIV0
  6855     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6856     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6857     MOVE X'2720233030303036353930' TO DFHEIV0(25:11)
  6858     CALL 'kxdfhei1' USING DFHEIV0
  6859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6860
  6861
  6862
  6863     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  6864     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  6865     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  6866     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  6867     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  6868     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  6869     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  6870     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  6871     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  6872     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  6873
  6874     IF ST-ACCNT-CNTL  OR
  6875        ACCNT-CNTL
  6876          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  6877
  6878     IF ST-ACCNT-CNTL      OR
  6879        CARR-ST-ACCNT-CNTL OR
  6880        ACCNT-CNTL         OR
  6881        CARR-ACCNT-CNTL
  6882          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  6883
  6884     IF ACCNT-CNTL OR
  6885        CARR-ACCNT-CNTL
  6886          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  6887
  6888
  6889* EXEC CICS READ
  6890*         DATASET   (ERPNDB-ALT-FILE-ID)
  6891*         SET       (ADDRESS OF PENDING-BUSINESS)
  6892*         RIDFLD    (ERPNDB-ALT-KEY)
  6893*     END-EXEC.
  6894*    MOVE '&"S        E          (   #00006620' TO DFHEIV0
  6895     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6896     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6897     MOVE X'2020233030303036363230' TO DFHEIV0(25:11)
  6898     CALL 'kxdfhei1' USING DFHEIV0,
  6899           ERPNDB-ALT-FILE-ID,
  6900           DFHEIV20,
  6901           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 122
* EL677.cbl
  6902           ERPNDB-ALT-KEY,
  6903           DFHEIV99,
  6904           DFHEIV99,
  6905           DFHEIV99
  6906     SET ADDRESS OF PENDING-BUSINESS TO
  6907         DFHEIV20
  6908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6909
  6910
  6911     MOVE 'Y'                    TO WS-PNDB-FOUND-SW.
  6912
  6913     IF PB-C-PAYEE-CODE GREATER SPACES
  6914        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW.
  6915
  6916     MOVE PB-C-REFERENCE         TO PI-REFERENCE.
  6917*    MOVE PB-CI-INSURED-NAME     TO PI-INSURED-NAME.
  6918
  6919     MOVE PB-C-LF-CANCEL-AMT     TO  PI-LF-REFUND.
  6920     MOVE PB-C-AH-CANCEL-AMT     TO  PI-AH-REFUND.
  6921
  6922     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  6923         MOVE PB-C-LF-CANCEL-DT  TO  PI-CANC-DT
  6924     ELSE
  6925         MOVE PB-C-AH-CANCEL-DT  TO  PI-CANC-DT.
  6926
  6927*    IF MAINTI = 'A' OR 'C'
  6928*      IF PB-C-REFUND-CREATED
  6929*          MOVE -1               TO  MAINTL
  6930*          MOVE ER-3445          TO  EMI-ERROR
  6931*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6932
  6933 1590-EXIT.
  6934      EXIT.
  6935
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 123
* EL677.cbl
  6937 2000-ADD-RECORD.
  6938
  6939* EXEC CICS GETMAIN
  6940*        SET      (ADDRESS OF CHECK-RECORDS)
  6941*        LENGTH   (600)
  6942*        INITIMG  (GETMAIN-SPACE)
  6943*    END-EXEC.
  6944     MOVE 600
  6945       TO DFHEIV11
  6946*    MOVE ',"IL                  $   #00006653' TO DFHEIV0
  6947     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6948     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6949     MOVE X'2020233030303036363533' TO DFHEIV0(25:11)
  6950     CALL 'kxdfhei1' USING DFHEIV0,
  6951           DFHEIV20,
  6952           DFHEIV11,
  6953           GETMAIN-SPACE
  6954     SET ADDRESS OF CHECK-RECORDS TO
  6955         DFHEIV20
  6956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6957
  6958
  6959     MOVE 'CH'                   TO CH-RECORD-ID.
  6960     MOVE PI-COMPANY-CD          TO CH-COMPANY-CD.
  6961     MOVE CARRIERI               TO CH-CARRIER.
  6962     MOVE GROUPI                 TO CH-GROUPING.
  6963     MOVE STATEI                 TO CH-STATE.
  6964     MOVE ACCTI                  TO CH-ACCOUNT.
  6965
  6966     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6967     MOVE '2'                    TO DC-OPTION-CODE.
  6968     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6969     MOVE DC-BIN-DATE-1          TO CH-CERT-EFF-DT.
  6970
  6971     MOVE CERTNOI                TO CH-CERT-PRIME.
  6972     MOVE SFXI                   TO CH-CERT-SFX.
  6973
  6974     MOVE SEQI                   TO CH-SEQUENCE-NO.
  6975
  6976     MOVE PI-PROCESSOR-ID        TO CH-RECORDED-BY
  6977                                    ch-released-by
  6978     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  6979
  6980     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6981     MOVE '5'                    TO DC-OPTION-CODE.
  6982     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6983     MOVE DC-BIN-DATE-1          TO CH-RECORDED-DT
  6984                                    ch-released-dt
  6985
  6986     move 'P'                    to ch-approval-status
  6987
  6988     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  6989                                    CH-VOID-DT
  6990                                    CH-CREDIT-ACCEPT-DT
  6991                                    CH-CANC-DT
  6992                                    ch-approval-dt
  6993                                    ch-check-cashed-dt
  6994     MOVE ZEROS                  TO CH-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 124
* EL677.cbl
  6995                                    CH-AH-REFUND
  6996*                                   CH-DEDUCT-WITHHELD
  6997*                                   CH-ADDITIONAL-CHARGE.
  6998
  6999     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7000
  7001     if pi-prev-paid not numeric
  7002        move zeros               to pi-prev-paid
  7003     end-if
  7004     if pi-prev-paid-this-month not numeric
  7005        move zeros               to pi-prev-paid-this-month
  7006     end-if
  7007     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7008       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7009        EIBAID NOT = DFHPF4)
  7010         GO TO 8200-SEND-DATAONLY.
  7011
  7012     add ch-amount-paid to pi-prev-paid
  7013     MOVE PI-CR-MONTH-END-DT     TO CH-CREDIT-SELECT-DT.
  7014     MOVE PI-CR-CARRIER          TO CH-COMP-CARRIER.
  7015     MOVE PI-CR-GROUPING         TO CH-COMP-GROUPING.
  7016     MOVE PI-CR-FIN-RESP         TO CH-COMP-FIN-RESP.
  7017     MOVE PI-CR-ACCOUNT          TO CH-COMP-ACCOUNT.
  7018     move pi-am-csr              to ch-csr
  7019     .
  7020 2100-WRITE-RECORD.
  7021
  7022* exec cics read
  7023*       dataset    (erchek-file-id)
  7024*       into       (ws-dummy-erchek)
  7025*       ridfld     (ch-control-primary)
  7026*       resp       (ws-response)
  7027*    end-exec
  7028     MOVE LENGTH OF
  7029      ws-dummy-erchek
  7030       TO DFHEIV11
  7031*    MOVE '&"IL       E          (  N#00006721' TO DFHEIV0
  7032     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7033     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7034     MOVE X'204E233030303036373231' TO DFHEIV0(25:11)
  7035     CALL 'kxdfhei1' USING DFHEIV0,
  7036           erchek-file-id,
  7037           ws-dummy-erchek,
  7038           DFHEIV11,
  7039           ch-control-primary,
  7040           DFHEIV99,
  7041           DFHEIV99,
  7042           DFHEIV99
  7043     MOVE EIBRESP  TO ws-response
  7044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7045     if RESP-NOTFND
  7046        continue
  7047     else
  7048        add +1 to ch-sequence-no
  7049        add 1 to seqi
  7050        go to 2100-write-record
  7051     end-if
  7052     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 125
* EL677.cbl
  7053
  7054* EXEC CICS HANDLE CONDITION
  7055*        DUPREC (2200-DUPREC)
  7056*    END-EXEC.
  7057*    MOVE '"$%                   ! ( #00006735' TO DFHEIV0
  7058     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7059     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7060     MOVE X'2820233030303036373335' TO DFHEIV0(25:11)
  7061     CALL 'kxdfhei1' USING DFHEIV0
  7062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7063
  7064
  7065     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  7066     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  7067                                    CH-CHECK-QUE-SEQUENCE
  7068
  7069
  7070* EXEC CICS WRITE
  7071*        DATASET  (ERCHEK-FILE-ID)
  7072*        FROM     (CHECK-RECORDS)
  7073*        RIDFLD   (CH-CONTROL-PRIMARY)
  7074*        resp     (ws-response)
  7075*    END-EXEC.
  7076     MOVE LENGTH OF
  7077      CHECK-RECORDS
  7078       TO DFHEIV11
  7079*    MOVE '&$ L                  ''  N#00006743' TO DFHEIV0
  7080     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7081     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7082     MOVE X'204E233030303036373433' TO DFHEIV0(25:11)
  7083     CALL 'kxdfhei1' USING DFHEIV0,
  7084           ERCHEK-FILE-ID,
  7085           CHECK-RECORDS,
  7086           DFHEIV11,
  7087           CH-CONTROL-PRIMARY,
  7088           DFHEIV99,
  7089           DFHEIV99
  7090     MOVE EIBRESP  TO ws-response
  7091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7092
  7093     if resp-normal and pi-check-type = 'C'
  7094        move 'Y'                 to pi-check-cut
  7095     end-if
  7096     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  7097             ERCHEK-RECORD-LENGTH + 23.
  7098
  7099     if pi-check-type not = 'C'
  7100        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7101                                 THRU 6200-EXIT
  7102        if resp-normal
  7103           MOVE 'Y'              TO PB-C-REFUND-SW
  7104           add +1 to pi-chek-rec-cnt
  7105           perform 6210-rewrite-pndb
  7106                                 thru 6210-exit
  7107*          PERFORM 2700-WRITE-SQL THRU 2700-EXIT
  7108        end-if
  7109     end-if
  7110     IF EMI-NO-ERRORS
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 126
* EL677.cbl
  7111         MOVE ER-0000            TO EMI-ERROR
  7112     ELSE
  7113         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7114            EIBAID = DFHPF4
  7115             MOVE ER-2600        TO EMI-ERROR.
  7116
  7117     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7118
  7119     MOVE LOW-VALUES             TO EL677AI.
  7120
  7121     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7122     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7123     MOVE PI-CHEK-STATE          TO STATEO.
  7124     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7125
  7126     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7127     MOVE SPACE                  TO DC-OPTION-CODE.
  7128     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7129     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7130
  7131     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7132     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7133     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7134
  7135     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7136                                    ACCTA     EFFDTA  CERTNOA
  7137                                    SFXA.
  7138     MOVE AL-UNNON               TO SEQA.
  7139     go to 5000-browse-file
  7140     GO TO 8100-SEND-INITIAL-MAP.
  7141
  7142 2200-DUPREC.
  7143     ADD +1 TO CH-SEQUENCE-NO.
  7144     MOVE CH-SEQUENCE-NO         TO SEQO
  7145                                    PI-CHEK-SEQUENCE
  7146                                    CHEK-RECORD-SEQ.
  7147     GO TO 2100-WRITE-RECORD.
  7148 2700-WRITE-SQL.
  7149     perform 2710-build-rec      thru 2710-exit
  7150     perform 2720-insert-row     thru 2720-exit
  7151     perform 4300-FINISH-UP-DB   thru 4300-exit
  7152     .
  7153 2700-EXIT.
  7154     EXIT.
  7155 2710-BUILD-REC.
  7156     move spaces                 to daily-check-request-rec
  7157     move pi-company-id          to db-compid
  7158     move ch-carrier             to db-carrier
  7159                                    db-fincar
  7160     move ch-grouping            to db-grouping
  7161                                    db-fingrp
  7162     move ch-state               to db-state
  7163     move ch-account             to db-account
  7164     move ch-cert-eff-dt         to dc-bin-date-1
  7165     move ' '                    to dc-option-code
  7166     perform 8500-date-convert   thru 8500-exit
  7167     if no-conversion-error
  7168        move dc-greg-date-a-edit to db-effdate
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 127
* EL677.cbl
  7169     else
  7170        move spaces              to db-effdate
  7171     end-if
  7172     move ch-cert-prime          to db-certificate
  7173     move ch-cert-sfx            to db-cert-sfx
  7174     move ch-sequence-no         to db-seq-no
  7175     move '1'                    to db-type
  7176                                    db-check-sub-type
  7177     if pi-check-type = 'C'
  7178        move '2'                 to db-check-sub-type
  7179     end-if
  7180     move ch-amount-paid         to db-amount-n
  7181     move zeros                  to db-checkstatus
  7182     move ch-check-que-control   to db-releasebatch
  7183     move save-bin-date          to dc-bin-date-1
  7184     move ' '                    to dc-option-code
  7185     perform 8500-date-convert   thru 8500-exit
  7186     if no-conversion-error
  7187        move dc-greg-date-a-edit to db-releasedt
  7188     else
  7189        move spaces              to db-releasedt
  7190     end-if
  7191     move pi-processor-id        to db-releaseby
  7192     move ch-payee-name-1        to db-payeename1
  7193     move ch-payee-name-2        to db-payeename2
  7194     move ch-payee-address-1     to db-payeeaddr1
  7195     move ch-payee-address-2     to db-payeeaddr2
  7196     move ch-payee-city          to db-payeecity
  7197     move ch-payee-state         to db-payeest
  7198     move ch-payee-zip-code      to db-payeezip
  7199     move ch-comp-fin-resp       to db-finresp
  7200     move ch-comp-account        to db-finacct
  7201     move ch-recorded-by         to db-preparer
  7202     move ch-return-to           to db-return-to
  7203     move pi-table-name          to db-insured-name
  7204     .
  7205 2710-EXIT.
  7206     EXIT.
  7207 2720-INSERT-ROW.
  7208     if not connected-to-db
  7209        perform 4100-CONNECT-TO-DB
  7210                                 thru 4100-exit
  7211     end-if
  7212     EXEC SQL
  7213        INSERT into ChkApp_Check (
  7214           Company,
  7215           CertCarrier,
  7216           CertGroup,
  7217           CertState,
  7218           CertAccount,
  7219           CertEffDate,
  7220           CertNumber,
  7221           CertNumberSuf,
  7222           CheckSeqNbr,
  7223           CheckType,
  7224           CheckAmount,
  7225           ReleaseBatchNbr,
  7226           ReleaseDate,
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 128
* EL677.cbl
  7227           ReleasedBy,
  7228           PayeeName1,
  7229           PayeeName2,
  7230           PayeeAddress1,
  7231           PayeeAddress2,
  7232           PayeeCity,
  7233           PayeeState,
  7234           PayeeZip,
  7235           CompCarrier,
  7236           CompGroup,
  7237           CompFinResp,
  7238           CompAccount,
  7239           Preparer,
  7240           ReturnTo,
  7241           InsuredName,
  7242           CheckSubType)
  7243         VALUES (
  7244           :DB-CompId,
  7245           :DB-Carrier,
  7246           :DB-Grouping,
  7247           :DB-State,
  7248           :DB-Account,
  7249           :DB-EffDate,
  7250           :DB-Certificate,
  7251           :db-cert-sfx,
  7252           :DB-Seq-No,
  7253           :DB-Type,
  7254           :db-amount,
  7255           :db-releasebatch,
  7256           :db-releasedt,
  7257           :db-releaseby,
  7258           :db-payeename1,
  7259           :db-payeename2,
  7260           :db-payeeaddr1,
  7261           :db-payeeaddr2,
  7262           :db-payeecity,
  7263           :db-payeest,
  7264           :db-payeezip,
  7265           :db-fincar,
  7266           :db-fingrp,
  7267           :db-finresp,
  7268           :db-finacct,
  7269           :db-preparer,
  7270           :db-return-to,
  7271           :db-insured-name,
  7272           :db-check-sub-type)
  7273     END-EXEC
  7274*    display ' db-compid     ' db-compid
  7275*    display ' db-carrier    ' db-carrier
  7276*    display ' db-group      ' db-grouping
  7277*    display ' db state      ' db-state
  7278*    display ' accounbt      ' db-account
  7279*    display ' effdt         ' db-effdate
  7280*    display ' cert          ' db-certificate
  7281*    display ' suffix        ' db-cert-sfx
  7282*    display ' seq no        ' db-seq-no
  7283*    display ' type          ' db-type
  7284     if sqlcode = -2601
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 129
* EL677.cbl
  7285        add +1                   to ch-sequence-no
  7286        move ch-sequence-no      to DB-Seq-No
  7287        go to 2720-insert-row
  7288     end-if
  7289     if sqlcode not = 0
  7290        display "Error: cannot insert row "
  7291        display ' sql return code ' sqlcode
  7292        move sqlcode to ws-sql-code
  7293        move ws-sql-code to ws-dis-sql-code
  7294        display ' dis sql code ' ws-dis-sql-code
  7295        display ' sql err mess    ' sqlerrmc
  7296        move sqlcode to ws-sql-code
  7297        move ws-sql-code to ws-dis-sql-code
  7298        string ws-dis-sql-code ' ' sqlerrmc (1:50)
  7299           into EMI-MESSAGE-AREA (1)
  7300        end-string
  7301        display ' msga1 ' emi-message-area (1)
  7302        perform 4300-FINISH-UP-DB thru 4300-exit
  7303        go to 8200-send-dataonly
  7304*       goback
  7305     end-if
  7306     .
  7307 2720-EXIT.
  7308     EXIT.
  7309 3000-CHANGE-RECORD.
  7310
  7311* EXEC CICS HANDLE CONDITION
  7312*        NOTFND (3900-RECORD-NOTFND)
  7313*    END-EXEC.
  7314*    MOVE '"$I                   ! ) #00006967' TO DFHEIV0
  7315     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7316     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7317     MOVE X'2920233030303036393637' TO DFHEIV0(25:11)
  7318     CALL 'kxdfhei1' USING DFHEIV0
  7319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7320
  7321
  7322
  7323* EXEC CICS READ
  7324*        DATASET  (ERCHEK-FILE-ID)
  7325*        SET      (ADDRESS OF CHECK-RECORDS)
  7326*        RIDFLD   (PI-ERCHEK-KEY)
  7327*        UPDATE
  7328*    END-EXEC.
  7329*    MOVE '&"S        EU         (   #00006971' TO DFHEIV0
  7330     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7331     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7332     MOVE X'2020233030303036393731' TO DFHEIV0(25:11)
  7333     CALL 'kxdfhei1' USING DFHEIV0,
  7334           ERCHEK-FILE-ID,
  7335           DFHEIV20,
  7336           DFHEIV99,
  7337           PI-ERCHEK-KEY,
  7338           DFHEIV99,
  7339           DFHEIV99,
  7340           DFHEIV99
  7341     SET ADDRESS OF CHECK-RECORDS TO
  7342         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 130
* EL677.cbl
  7343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7344
  7345
  7346     IF CH-LF-REFUND NOT NUMERIC
  7347         MOVE ZEROS              TO CH-LF-REFUND.
  7348     IF CH-AH-REFUND NOT NUMERIC
  7349         MOVE ZEROS              TO CH-AH-REFUND.
  7350*    IF CH-DEDUCT-WITHHELD NOT NUMERIC
  7351*        MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  7352*    IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  7353*        MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  7354
  7355     IF VREASONL NOT = ZEROS
  7356         MOVE VREASONI           TO  CH-VOID-REASON.
  7357
  7358     IF MAINTI = 'V' or 'R'
  7359        GO TO 3050-void-processing
  7360     end-if
  7361
  7362     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  7363
  7364     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7365
  7366     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7367       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7368        EIBAID NOT = DFHPF4)
  7369         GO TO 8200-SEND-DATAONLY.
  7370     go to 3100-rewrite-record
  7371     .
  7372 3050-void-processing.
  7373     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7374     if sqlcode = 0
  7375        perform 4200-get-tbl-row thru 4200-exit
  7376        if sqlcode = 0
  7377           if nu-app-date = -1
  7378              move -1            to maintl
  7379              move er-3453       to emi-error
  7380              move al-uabon      to mainta
  7381              perform 9900-error-format
  7382                                 thru 9900-exit
  7383              perform 4300-FINISH-UP-DB thru 4300-exit
  7384              go to 8200-send-dataonly
  7385           end-if
  7386        end-if
  7387        if connected-to-db
  7388           perform 4300-FINISH-UP-DB thru 4300-exit
  7389        end-if
  7390     end-if
  7391     if (ch-check-written-dt = low-values)
  7392        or (ch-check-no = spaces)
  7393        move -1                  to maintl
  7394        move er-3455             to emi-error
  7395        move al-uabon            to mainta
  7396        perform 9900-error-format
  7397                                 thru 9900-exit
  7398        perform 4300-FINISH-UP-DB thru 4300-exit
  7399        go to 8200-send-dataonly
  7400     end-if
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 131
* EL677.cbl
  7401     .
  7402 3100-REWRITE-RECORD.
  7403     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  7404
  7405     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7406     MOVE '5'                    TO DC-OPTION-CODE.
  7407     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7408
  7409     IF MAINTI = 'C'
  7410       MOVE PI-PROCESSOR-ID      TO CH-RECORDED-BY
  7411     end-if
  7412     IF MAINTI = 'V' or 'R'
  7413        IF (CH-VOID-DT = LOW-VALUES)
  7414           and (pi-check-cashed = spaces)
  7415           MOVE PI-PROCESSOR-ID  TO CH-VOID-BY
  7416           MOVE DC-BIN-DATE-1    TO CH-VOID-DT
  7417           PERFORM 3200-PAY-ADJS-REVERSAL      THRU 3290-EXIT
  7418           if pi-chek-rec-cnt = +1
  7419              PERFORM 6200-UPDATE-PENDING-BUS-REC
  7420                                 THRU 6200-EXIT
  7421              if resp-normal
  7422                 MOVE ' '        TO PB-C-REFUND-SW
  7423                 perform 6210-rewrite-pndb
  7424                                 thru 6210-exit
  7425              end-if
  7426           end-if
  7427        ELSE
  7428           MOVE -1               TO MAINTL
  7429           MOVE ER-2583          TO EMI-ERROR
  7430           MOVE AL-UABON         TO MAINTA
  7431           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7432           GO TO 8200-SEND-DATAONLY
  7433        end-if
  7434     end-if
  7435
  7436     MOVE CH-AMOUNT-PAID         TO WS-SV-AMOUNT-PAID.
  7437
  7438
  7439* EXEC CICS REWRITE
  7440*        DATASET  (ERCHEK-FILE-ID)
  7441*        FROM     (CHECK-RECORDS)
  7442*    END-EXEC.
  7443     MOVE LENGTH OF
  7444      CHECK-RECORDS
  7445       TO DFHEIV11
  7446*    MOVE '&& L                  %   #00007070' TO DFHEIV0
  7447     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7448     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7449     MOVE X'2020233030303037303730' TO DFHEIV0(25:11)
  7450     CALL 'kxdfhei1' USING DFHEIV0,
  7451           ERCHEK-FILE-ID,
  7452           CHECK-RECORDS,
  7453           DFHEIV11,
  7454           DFHEIV99
  7455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7456
  7457
  7458     IF (PI-COMPANY-ID EQUAL 'LGX' OR 'TMS') AND
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 132
* EL677.cbl
  7459        (MAINTI EQUAL 'C')          AND
  7460        (PI-PAYTO1 NOT EQUAL PAYTO1I)
  7461            PERFORM 3300-UPDATE-ERPYAJ THRU 3390-EXIT.
  7462
  7463     IF EMI-NO-ERRORS
  7464         MOVE ER-0000            TO EMI-ERROR
  7465     ELSE
  7466         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7467            EIBAID = DFHPF4
  7468             MOVE ER-2600        TO EMI-ERROR.
  7469     if mainti = 'R'
  7470        if pi-void-reissue-pass = ' '
  7471           move '1'              to pi-void-reissue-pass
  7472        MOVE ER-3274             TO EMI-ERROR
  7473        end-if
  7474     end-if
  7475     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7476
  7477     MOVE LOW-VALUES             TO EL677AI.
  7478
  7479     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7480     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7481     MOVE PI-CHEK-STATE          TO STATEO.
  7482     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7483
  7484     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7485     MOVE SPACE                  TO DC-OPTION-CODE.
  7486     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7487     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7488
  7489     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7490     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7491     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7492
  7493     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7494                                     ACCTA   EFFDTA
  7495                                    CERTNOA   SFXA.
  7496
  7497     MOVE AL-UNNON               TO SEQA.
  7498     go to 5000-browse-file
  7499*    GO TO 8100-SEND-INITIAL-MAP.
  7500
  7501     .
  7502 3200-PAY-ADJS-REVERSAL.
  7503
  7504     IF CH-AMOUNT-PAID NOT = ZEROS
  7505         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7506         PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7507
  7508     GO TO 3290-EXIT
  7509     .
  7510 3250-BUILD-ERPYAJ-REVERSAL.
  7511
  7512
  7513* EXEC CICS GETMAIN
  7514*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7515*        LENGTH  (200)
  7516*        INITIMG (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 133
* EL677.cbl
  7517*    END-EXEC.
  7518     MOVE 200
  7519       TO DFHEIV11
  7520*    MOVE ',"IL                  $   #00007129' TO DFHEIV0
  7521     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7522     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7523     MOVE X'2020233030303037313239' TO DFHEIV0(25:11)
  7524     CALL 'kxdfhei1' USING DFHEIV0,
  7525           DFHEIV20,
  7526           DFHEIV11,
  7527           GETMAIN-SPACE
  7528     SET ADDRESS OF PENDING-PAY-ADJ TO
  7529         DFHEIV20
  7530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7531
  7532
  7533     MOVE 'PY'                   TO PY-RECORD-ID.
  7534     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7535
  7536     MOVE CH-COMP-CARRIER        TO PY-CARRIER.
  7537     IF PI-ZERO-CARRIER  OR
  7538        PI-ZERO-CAR-GROUP
  7539         MOVE ZERO               TO PY-CARRIER.
  7540
  7541     MOVE CH-COMP-GROUPING       TO PY-GROUPING.
  7542     IF PI-ZERO-GROUPING  OR
  7543        PI-ZERO-CAR-GROUP
  7544         MOVE ZERO               TO PY-GROUPING.
  7545
  7546     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7547     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7548     MOVE 'R'                    TO PY-RECORD-TYPE.
  7549     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7550     move '1825011300'           to py-gl-account
  7551     move 'VOID REFCK'           TO py-gl-comment
  7552     move ch-amount-paid         to py-entry-amt
  7553*    COMPUTE PY-ENTRY-AMT = CH-AMOUNT-PAID * -1.
  7554
  7555     MOVE CH-CHECK-NO            TO WS-CHECK-WORK
  7556     MOVE WS-CHECK-NO            TO PY-CHECK-NUMBER.
  7557
  7558     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7559     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7560     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7561                                    PY-INPUT-DT.
  7562*    MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  7563*                                   PY-CHECK-QUE-SEQUENCE.
  7564     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7565                                    PY-BILLED-DATE
  7566                                    PY-REPORTED-DT
  7567                                    PY-CHECK-WRITTEN-DT
  7568                                    PY-AR-DATE
  7569                                    PY-GL-DATE.
  7570     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7571     MOVE CH-CHECK-ORIGIN-SW     TO PY-CHECK-ORIGIN-SW.
  7572*    MOVE 'V'                    TO PY-VOID-SW.
  7573*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7574
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 134
* EL677.cbl
  7575     IF PI-AR-PROCESSING
  7576         MOVE 'B'                TO PY-PYMT-TYPE
  7577         MOVE 'A'                TO PY-PMT-APPLIED.
  7578
  7579 3259-BUILD-EXIT.
  7580     EXIT.
  7581
  7582 3280-WRITE-ERPYAJ-REVERSAL.
  7583
  7584
  7585* EXEC CICS HANDLE CONDITION
  7586*        DUPREC (3287-DUPREC)
  7587*    END-EXEC.
  7588*    MOVE '"$%                   ! * #00007186' TO DFHEIV0
  7589     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7590     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7591     MOVE X'2A20233030303037313836' TO DFHEIV0(25:11)
  7592     CALL 'kxdfhei1' USING DFHEIV0
  7593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7594
  7595
  7596
  7597* EXEC CICS WRITE
  7598*        DATASET (ERPYAJ-FILE-ID)
  7599*        FROM    (PENDING-PAY-ADJ)
  7600*        RIDFLD  (PY-CONTROL-PRIMARY)
  7601*    END-EXEC.
  7602     MOVE LENGTH OF
  7603      PENDING-PAY-ADJ
  7604       TO DFHEIV11
  7605*    MOVE '&$ L                  ''   #00007190' TO DFHEIV0
  7606     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7607     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7608     MOVE X'2020233030303037313930' TO DFHEIV0(25:11)
  7609     CALL 'kxdfhei1' USING DFHEIV0,
  7610           ERPYAJ-FILE-ID,
  7611           PENDING-PAY-ADJ,
  7612           DFHEIV11,
  7613           PY-CONTROL-PRIMARY,
  7614           DFHEIV99,
  7615           DFHEIV99
  7616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7617
  7618
  7619     GO TO 3289-WRITE-EXIT.
  7620
  7621 3287-DUPREC.
  7622     ADD +1 TO PY-FILE-SEQ-NO.
  7623
  7624     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7625
  7626 3289-WRITE-EXIT.
  7627     EXIT.
  7628
  7629 3290-EXIT.
  7630      EXIT.
  7631
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 135
* EL677.cbl
  7633 3300-UPDATE-ERPYAJ.
  7634
  7635
  7636* EXEC CICS GETMAIN
  7637*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7638*        LENGTH  (200)
  7639*        INITIMG (GETMAIN-SPACE)
  7640*    END-EXEC.
  7641     MOVE 200
  7642       TO DFHEIV11
  7643*    MOVE ',"IL                  $   #00007212' TO DFHEIV0
  7644     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7645     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7646     MOVE X'2020233030303037323132' TO DFHEIV0(25:11)
  7647     CALL 'kxdfhei1' USING DFHEIV0,
  7648           DFHEIV20,
  7649           DFHEIV11,
  7650           GETMAIN-SPACE
  7651     SET ADDRESS OF PENDING-PAY-ADJ TO
  7652         DFHEIV20
  7653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7654
  7655
  7656     MOVE PI-COMPANY-CD          TO PYAJ-COMPANY-CD.
  7657     MOVE PI-CHEK-CARRIER        TO PYAJ-CARRIER.
  7658     MOVE PI-CHEK-GROUPING       TO PYAJ-GROUPING.
  7659     MOVE PI-CR-FIN-RESP         TO PYAJ-FIN-RESP.
  7660     MOVE PI-CR-ACCOUNT          TO PYAJ-ACCOUNT.
  7661     MOVE 'C'                    TO PYAJ-RECORD-TYPE.
  7662     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO.
  7663
  7664
  7665* EXEC CICS HANDLE CONDITION
  7666*        NOTFND   (3390-EXIT)
  7667*        ENDFILE  (3390-EXIT)
  7668*    END-EXEC.
  7669*    MOVE '"$I''                  ! + #00007226' TO DFHEIV0
  7670     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7671     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7672     MOVE X'2B20233030303037323236' TO DFHEIV0(25:11)
  7673     CALL 'kxdfhei1' USING DFHEIV0
  7674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7675
  7676
  7677 3320-READNEXT-ERPYAJ.
  7678
  7679
  7680* EXEC CICS READ
  7681*        DATASET  (ERPYAJ-FILE-ID)
  7682*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  7683*        RIDFLD   (ERPYAJ-KEY)
  7684*        GTEQ
  7685*    END-EXEC.
  7686*    MOVE '&"S        G          (   #00007233' TO DFHEIV0
  7687     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7688     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7689     MOVE X'2020233030303037323333' TO DFHEIV0(25:11)
  7690     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 136
* EL677.cbl
  7691           ERPYAJ-FILE-ID,
  7692           DFHEIV20,
  7693           DFHEIV99,
  7694           ERPYAJ-KEY,
  7695           DFHEIV99,
  7696           DFHEIV99,
  7697           DFHEIV99
  7698     SET ADDRESS OF PENDING-PAY-ADJ TO
  7699         DFHEIV20
  7700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7701
  7702
  7703     MOVE PY-CONTROL-PRIMARY TO ERPYAJ-KEY.
  7704
  7705     IF (PI-COMPANY-CD    NOT = PY-COMPANY-CD) OR
  7706        (PI-CHEK-CARRIER  NOT = PY-CARRIER)    OR
  7707        (PI-CHEK-GROUPING NOT = PY-GROUPING)   OR
  7708        (PI-CR-FIN-RESP   NOT = PY-FIN-RESP)   OR
  7709        (PI-CR-ACCOUNT    NOT = PY-ACCOUNT)    OR
  7710        (PY-RECORD-TYPE   NOT = 'C')
  7711          GO TO 3390-EXIT.
  7712
  7713     IF WS-SV-AMOUNT-PAID NOT EQUAL PY-ENTRY-AMT
  7714         ADD +1 TO PYAJ-FILE-SEQ-NO
  7715         GO TO 3320-READNEXT-ERPYAJ.
  7716
  7717
  7718* EXEC CICS READ UPDATE
  7719*        DATASET   (ERPYAJ-FILE-ID)
  7720*        RIDFLD    (ERPYAJ-KEY)
  7721*        SET       (ADDRESS OF PENDING-PAY-ADJ)
  7722*    END-EXEC.
  7723*    MOVE '&"S        EU         (   #00007254' TO DFHEIV0
  7724     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7725     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7726     MOVE X'2020233030303037323534' TO DFHEIV0(25:11)
  7727     CALL 'kxdfhei1' USING DFHEIV0,
  7728           ERPYAJ-FILE-ID,
  7729           DFHEIV20,
  7730           DFHEIV99,
  7731           ERPYAJ-KEY,
  7732           DFHEIV99,
  7733           DFHEIV99,
  7734           DFHEIV99
  7735     SET ADDRESS OF PENDING-PAY-ADJ TO
  7736         DFHEIV20
  7737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7738
  7739
  7740     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7741     MOVE CERTNOI                TO WS-TMS-PY-CERT.
  7742
  7743     MOVE WS-TMS-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  7744
  7745     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7746     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7747     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7748
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 137
* EL677.cbl
  7749
  7750* EXEC CICS REWRITE
  7751*        DATASET  (ERPYAJ-FILE-ID)
  7752*        FROM     (PENDING-PAY-ADJ)
  7753*    END-EXEC.
  7754     MOVE LENGTH OF
  7755      PENDING-PAY-ADJ
  7756       TO DFHEIV11
  7757*    MOVE '&& L                  %   #00007269' TO DFHEIV0
  7758     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7759     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7760     MOVE X'2020233030303037323639' TO DFHEIV0(25:11)
  7761     CALL 'kxdfhei1' USING DFHEIV0,
  7762           ERPYAJ-FILE-ID,
  7763           PENDING-PAY-ADJ,
  7764           DFHEIV11,
  7765           DFHEIV99
  7766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7767
  7768
  7769 3390-EXIT.
  7770      EXIT.
  7771
  7772 3400-delete-record.
  7773
  7774* EXEC CICS READ
  7775*        DATASET  (ERCHEK-FILE-ID)
  7776*        SET      (ADDRESS OF CHECK-RECORDS)
  7777*        RIDFLD   (PI-ERCHEK-KEY)
  7778*        UPDATE
  7779*        resp     (ws-response)
  7780*    END-EXEC
  7781*    MOVE '&"S        EU         (  N#00007278' TO DFHEIV0
  7782     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7783     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7784     MOVE X'204E233030303037323738' TO DFHEIV0(25:11)
  7785     CALL 'kxdfhei1' USING DFHEIV0,
  7786           ERCHEK-FILE-ID,
  7787           DFHEIV20,
  7788           DFHEIV99,
  7789           PI-ERCHEK-KEY,
  7790           DFHEIV99,
  7791           DFHEIV99,
  7792           DFHEIV99
  7793     SET ADDRESS OF CHECK-RECORDS TO
  7794         DFHEIV20
  7795     MOVE EIBRESP  TO ws-response
  7796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7797     if (ch-in-limbo or ch-approv-pending)
  7798        and (ch-void-dt = low-values)
  7799        and (ch-check-written-dt = low-values)
  7800        and (ch-credit-accept-dt = low-values)
  7801        perform 3500-check-tbl   thru 3500-exit
  7802        if (row-deleted and tbl-commited)
  7803*          or (emi-error = er-3450)
  7804
  7805* exec cics delete
  7806*             dataset   (erchek-file-id)
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 138
* EL677.cbl
  7807*          end-exec
  7808*    MOVE '&(                    &   #00007292' TO DFHEIV0
  7809     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7810     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7811     MOVE X'2020233030303037323932' TO DFHEIV0(25:11)
  7812     CALL 'kxdfhei1' USING DFHEIV0,
  7813           erchek-file-id,
  7814           DFHEIV99,
  7815           DFHEIV99,
  7816           DFHEIV99,
  7817           DFHEIV99
  7818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7819           move spaces to pi-check-cut
  7820        end-if
  7821     else
  7822        move -1               to maintl
  7823        move er-3452          to emi-error
  7824        move al-uabon         to mainta
  7825        perform 9900-error-format
  7826                                 thru 9900-exit
  7827        go to 8200-send-dataonly
  7828     end-if
  7829     if pi-chek-rec-cnt = +1
  7830        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7831                                 THRU 6200-EXIT
  7832        if resp-normal
  7833           MOVE ' '              TO PB-C-REFUND-SW
  7834           perform 6210-rewrite-pndb
  7835                                 thru 6210-exit
  7836        end-if
  7837     end-if
  7838     MOVE ER-0000            TO EMI-ERROR
  7839     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7840     MOVE LOW-VALUES             TO EL677AI.
  7841     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7842     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7843     MOVE PI-CHEK-STATE          TO STATEO.
  7844     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7845     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7846     MOVE SPACE                  TO DC-OPTION-CODE.
  7847     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7848     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7849     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7850     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7851     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7852     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7853                                    ACCTA   EFFDTA
  7854                                    CERTNOA   SFXA.
  7855     MOVE AL-UNNON               TO SEQA.
  7856     GO TO 8100-SEND-INITIAL-MAP
  7857     .
  7858 3400-exit.
  7859     exit.
  7860 3500-check-tbl.
  7861     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7862     if sqlcode = 0
  7863        perform 4200-get-tbl-row thru 4200-exit
  7864     end-if
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 139
* EL677.cbl
  7865      if sqlcode = 0
  7866         if (nu-app-date = -1)
  7867            or (db-app-status = '2')
  7868            perform 4250-delete-row thru 4250-exit
  7869         else
  7870           MOVE ER-3452            TO  EMI-ERROR
  7871           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7872           MOVE -1                 TO  PFENTERL
  7873           GO TO 8200-SEND-DATAONLY
  7874        end-if
  7875      else
  7876         MOVE ER-3450            TO  EMI-ERROR
  7877         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7878         MOVE -1                 TO  PFENTERL
  7879*        GO TO 8200-SEND-DATAONLY
  7880      end-if
  7881     if connected-to-db
  7882        perform 4300-FINISH-UP-DB thru 4300-exit
  7883     end-if
  7884     .
  7885 3500-exit.
  7886     exit.
  7887 3900-RECORD-NOTFND.
  7888     MOVE ER-2908                TO EMI-ERROR.
  7889     MOVE -1                     TO CARRIERL
  7890     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7891                                    ACCTA     EFFDTA  CERTNOA
  7892                                    SFXA      SEQA.
  7893     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7894     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 140
* EL677.cbl
  7896 4000-ADD-CHANGE.
  7897     IF PAYTO1L NOT = ZEROS
  7898        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  7899     END-IF
  7900
  7901     IF PAYTO2L NOT = ZEROS
  7902         MOVE PAYTO2I            TO CH-PAYEE-NAME-2.
  7903
  7904     IF PAYAD1L NOT = ZEROS
  7905         MOVE PAYAD1I            TO CH-PAYEE-ADDRESS-1.
  7906
  7907     IF PAYAD2L NOT = ZEROS
  7908         MOVE PAYAD2I            TO CH-PAYEE-ADDRESS-2.
  7909
  7910     IF PAYctyL NOT = ZEROS
  7911         MOVE payctyi            TO CH-PAYEE-CITY.
  7912
  7913     IF PAYstL NOT = ZEROS
  7914         MOVE paysti            TO CH-PAYEE-state.
  7915
  7916     IF PAYEEI GREATER SPACES
  7917        MOVE PAYEEI              TO CH-PAYEE-CODE.
  7918
  7919     IF PTOZIPL  =  ZEROS
  7920         MOVE ZEROS              TO CH-PAYEE-ZIP-CODE
  7921         GO TO 4000-CK-REST.
  7922
  7923     MOVE PTOZIPI                TO WS-ZIP-CODE.
  7924
  7925     IF NOT WS-CANADIAN-POST-CODE
  7926         MOVE WS-ZIP-PRIME       TO CH-PAYEE-ZIP
  7927         MOVE WS-ZIP-PLUS4       TO CH-PAYEE-ZIP-EXT
  7928         GO TO 4000-CK-REST.
  7929
  7930     MOVE SPACES                 TO CH-CANADIAN-POSTAL-CODE.
  7931     IF WS-CAN-POST-4TH = SPACE OR '-'
  7932         MOVE WS-CAN-POST2-1     TO CH-CAN-POSTAL-1
  7933         MOVE WS-CAN-POST2-2     TO CH-CAN-POSTAL-2
  7934     ELSE
  7935         MOVE WS-CAN-POST1-1     TO CH-CAN-POSTAL-1
  7936         MOVE WS-CAN-POST1-2     TO CH-CAN-POSTAL-2.
  7937
  7938 4000-CK-REST.
  7939
  7940     IF RETTOL NOT = ZEROS
  7941        MOVE RETTOI TO CH-RETURN-TO.
  7942     if dedcynl not = zeros
  7943        move dedcyni             to ch-deduct-commission
  7944     end-if
  7945*    if dedcynl not = zeros
  7946*       if (dedcyni = 'Y')
  7947*          or (pi-prev-ded-comm = 'Y')
  7948*          compute ws-amt =
  7949*             pi-refund-on-pending-rec -
  7950*                pi-prev-paid - pi-ue-comm
  7951*       else
  7952*          if dedcyni = 'N'
  7953*             compute ws-amt =
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 141
* EL677.cbl
  7954*                pi-refund-on-pending-rec -
  7955*                   pi-prev-paid-this-month
  7956*          end-if
  7957*       end-if
  7958*    end-if
  7959     if pi-check-type = 'C'
  7960        compute ws-amt =
  7961           pi-endt-prm-diff - pi-prev-paid
  7962        if (dedcyni = 'Y')
  7963           or (pi-prev-ded-comm = 'Y')
  7964           compute ws-amt =
  7965              ws-amt - pi-ue-comm
  7966        end-if
  7967        if ws-amt <= zeros
  7968           move pi-endt-prm-diff to ws-amt
  7969        end-if
  7970     end-if
  7971     IF AMOUNTL NOT = ZEROS
  7972         MOVE WS-AMT             TO CH-AMOUNT-PAID
  7973         MOVE CH-AMOUNT-PAID     TO AMOUNTO.
  7974
  7975     IF CHECKL NOT = ZEROS
  7976         MOVE CHECKI             TO CH-CHECK-NO.
  7977
  7978     IF REASONL NOT = ZEROS
  7979         MOVE REASONI            TO CH-REASON-FOR-CHECK.
  7980
  7981*    IF DEDAMTL NOT = ZEROS
  7982*        MOVE WS-DED             TO CH-DEDUCT-WITHHELD
  7983*                                   DEDAMTO.
  7984
  7985*    IF ADDLCHGL NOT = ZEROS
  7986*        MOVE WS-ADDL            TO CH-ADDITIONAL-CHARGE
  7987*                                   ADDLCHGO.
  7988
  7989     IF STUBL NOT = ZEROS
  7990         MOVE STUBI              TO CH-STUB-LINE-1.
  7991
  7992     IF TEXT1L NOT = ZEROS
  7993         MOVE TEXT1I             TO CH-TEXT-LINE-1.
  7994
  7995     IF TEXT2L NOT = ZEROS
  7996         MOVE TEXT2I             TO CH-TEXT-LINE-2.
  7997
  7998     IF TEXT3L NOT = ZEROS
  7999         MOVE TEXT3I             TO CH-TEXT-LINE-3.
  8000
  8001     IF TYPEL NOT = ZEROS
  8002         MOVE TYPEI              TO CH-CHECK-ORIGIN-SW.
  8003
  8004*    MOVE LETTER1I               TO CH-LETTERS (1).
  8005*    MOVE LETTER2I               TO CH-LETTERS (2).
  8006*    MOVE LETTER3I               TO CH-LETTERS (3).
  8007
  8008*    MOVE SPACES                 TO CH-CHECK-REFERENCE.
  8009     IF CH-CHECK-ORIGIN-SW = 'R'
  8010         PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  8011*        MOVE PI-REFERENCE           TO CH-CHECK-REFERENCE
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 142
* EL677.cbl
  8012         MOVE PI-CANC-DT             TO CH-CANC-DT
  8013         MOVE PI-LF-REFUND           TO CH-LF-REFUND
  8014         MOVE PI-AH-REFUND           TO CH-AH-REFUND
  8015     end-if
  8016     MOVE PI-INSURED-NAME        TO CH-INSURED-NAME.
  8017*    IF PI-AR-PROCESSING AND
  8018*       REFL NOT = ZERO
  8019*        MOVE REFI                   TO CH-CHECK-REFERENCE.
  8020
  8021 4000-EXIT.
  8022      EXIT.
  8023 4100-CONNECT-TO-DB.
  8024     move 'NTSQLTST2_ChkApprv'   to svr
  8025     move 'sa'                   to usr
  8026     move 'sql2008r2'            to pass
  8027
  8028     if ws-kix-myenv = 'cid1p'
  8029        move 'NTCSO2_ChkApprv'   to svr
  8030        move 'sa'                to usr
  8031        move 'ntcso2'            to pass
  8032     end-if
  8033     string
  8034         usr delimited space
  8035         "." delimited size
  8036         pass delimited space into usr-pass
  8037     end-string
  8038     EXEC SQL
  8039        CONNECT TO :svr USER :usr-pass
  8040     END-EXEC
  8041     if sqlcode not = 0
  8042        display "Error: cannot connect "
  8043        display sqlcode
  8044        display sqlerrmc
  8045     end-if
  8046     set connected-to-db to true
  8047     .
  8048 4100-EXIT.
  8049     EXIT.
  8050 4200-get-tbl-row.
  8051***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8052***                                                            ***
  8053***  I'm only expecting one row so no cursor is declared       ***
  8054***                                                            ***
  8055***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8056     move pi-company-id          to ws-compid
  8057     move ch-carrier             to ws-carrier
  8058     move ch-grouping            to ws-grouping
  8059     move ch-state               to ws-state
  8060     move ch-account             to ws-account
  8061     move ch-cert-eff-dt         to dc-bin-date-1
  8062     move ' '                    to dc-option-code
  8063     perform 8500-date-convert   thru 8500-exit
  8064     if no-conversion-error
  8065        move dc-greg-date-a-edit to ws-eff-date
  8066     end-if
  8067     move ch-cert-prime          to ws-certificate
  8068     move ch-cert-sfx            to ws-cert-sfx
  8069     move ch-sequence-no         to ws-seq-no
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 143
* EL677.cbl
  8070     move '1'                    to ws-type
  8071                                    ws-check-sub-type
  8072     if pi-check-type = 'C'
  8073        move '2'                 to ws-check-sub-type
  8074     end-if
  8075     exec sql
  8076        SELECT
  8077           ApprovalStatus,
  8078           MaintainedBy,
  8079           MaintainedDate,
  8080           ApprovalBatch
  8081        INTO
  8082           :db-app-status :nu-app-status,
  8083           :db-app-by :nu-app-by,
  8084           :db-app-date :nu-app-date,
  8085           :db-app-batch :nu-app-batch
  8086        FROM
  8087           ChkApp_Check
  8088        WHERE
  8089           Company           = :ws-compid
  8090           and CertCarrier   = :ws-carrier
  8091           and CertGroup     = :ws-grouping
  8092           and CertState     = :ws-state
  8093           and CertAccount   = :ws-account
  8094           and CertEffDate   = :ws-eff-date
  8095           and CertNumber    = :ws-certificate
  8096           and CertNumberSuf = :ws-cert-sfx
  8097           and CheckSeqNbr   = :ws-seq-no
  8098           and CheckType     = :ws-type
  8099           and CheckSubType  = :ws-check-sub-type
  8100     end-exec
  8101     if sqlcode not = 0
  8102        display "Error: cannot read row "
  8103        display ' sql return code ' sqlcode
  8104        display ' sql err mess    ' sqlerrmc
  8105        go to 4200-exit
  8106     end-if
  8107*    display ' status ' db-app-status
  8108*    display ' by     ' db-app-by
  8109*    display ' date   ' db-app-date
  8110*    display ' batch  ' db-app-batch
  8111*    if nu-app-date = -1
  8112*       display ' approval date is low-values '
  8113*    else
  8114*       display ' approval date is NOT low values '
  8115*    end-if
  8116     .
  8117 4200-exit.
  8118     exit.
  8119 4250-delete-row.
  8120     EXEC SQL
  8121        DELETE
  8122           from ChkApp_Check
  8123        WHERE
  8124           Company           = :ws-compid
  8125           and CertCarrier   = :ws-carrier
  8126           and CertGroup     = :ws-grouping
  8127           and CertState     = :ws-state
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 144
* EL677.cbl
  8128           and CertAccount   = :ws-account
  8129           and CertEffDate   = :ws-eff-date
  8130           and CertNumber    = :ws-certificate
  8131           and CertNumberSuf = :ws-cert-sfx
  8132           and CheckSeqNbr   = :ws-seq-no
  8133           and CheckType     = :ws-type
  8134           and CheckSubType  = :ws-check-sub-type
  8135     END-EXEC
  8136     if sqlcode not = 0
  8137        display "Error: cannot delete row  "
  8138        display ' sql retrun code ' sqlcode
  8139        display ' sql err mess    ' sqlerrmc
  8140        go to 4250-exit
  8141     end-if
  8142     set row-deleted         to true
  8143     EXEC SQL
  8144         commit transaction
  8145     END-EXEC
  8146     if sqlcode not = 0
  8147        display "Error: commit "
  8148        display ' sql return code ' sqlcode
  8149        display ' sql err mess    ' sqlerrmc
  8150        go to 4250-exit
  8151     end-if
  8152     set tbl-commited to true
  8153     .
  8154 4250-exit.
  8155     exit.
  8156 4300-FINISH-UP-DB.
  8157     EXEC SQL
  8158         commit work release
  8159     END-EXEC
  8160     if sqlcode not = 0
  8161        display "Error: commit release "
  8162        display ' sql return code ' sqlcode
  8163        display ' sql err mess    ' sqlerrmc
  8164     end-if
  8165     .
  8166 4300-EXIT.
  8167     EXIT.
  8168 5000-BROWSE-FILE.
  8169
  8170* EXEC CICS HANDLE CONDITION
  8171*        NOTFND   (5560-END-OF-FILE)
  8172*        ENDFILE  (5560-END-OF-FILE)
  8173*    END-EXEC.
  8174*    MOVE '"$I''                  ! , #00007645' TO DFHEIV0
  8175     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8176     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8177     MOVE X'2C20233030303037363435' TO DFHEIV0(25:11)
  8178     CALL 'kxdfhei1' USING DFHEIV0
  8179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8180
  8181
  8182     MOVE PI-ERCHEK-KEY          TO ERCHEK-KEY.
  8183
  8184     IF SEQI = LOW-VALUES
  8185         MOVE +1                 TO CHEK-RECORD-SEQ.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 145
* EL677.cbl
  8186
  8187     IF EIBAID = DFHPF2
  8188         GO TO 5100-BROWSE-BKWD.
  8189
  8190 5010-READ-LOOP.
  8191     IF EIBAID = DFHPF1
  8192         ADD +1                  TO CHEK-RECORD-SEQ.
  8193
  8194
  8195* EXEC CICS READ
  8196*        DATASET  (ERCHEK-FILE-ID)
  8197*        SET      (ADDRESS OF CHECK-RECORDS)
  8198*        RIDFLD   (ERCHEK-KEY)
  8199*        GTEQ
  8200*    END-EXEC.
  8201*    MOVE '&"S        G          (   #00007662' TO DFHEIV0
  8202     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8203     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8204     MOVE X'2020233030303037363632' TO DFHEIV0(25:11)
  8205     CALL 'kxdfhei1' USING DFHEIV0,
  8206           ERCHEK-FILE-ID,
  8207           DFHEIV20,
  8208           DFHEIV99,
  8209           ERCHEK-KEY,
  8210           DFHEIV99,
  8211           DFHEIV99,
  8212           DFHEIV99
  8213     SET ADDRESS OF CHECK-RECORDS TO
  8214         DFHEIV20
  8215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8216
  8217
  8218     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8219         IF EIBAID = DFHENTER
  8220             GO TO 5550-NO-RECORD
  8221         ELSE
  8222             GO TO 5560-END-OF-FILE.
  8223
  8224        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8225           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8226           PI-CHEK-STATE      = CH-STATE       AND
  8227           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8228           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8229           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8230           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8231              GO TO 5500-FORMAT-SCREEN
  8232            ELSE
  8233              IF EIBAID = DFHPF1
  8234                  GO TO 5560-END-OF-FILE
  8235                ELSE
  8236                  GO TO 5550-NO-RECORD.
  8237
  8238     IF EIBAID = DFHENTER
  8239        IF CHEK-CARRIER    = CH-CARRIER     AND
  8240           CHEK-GROUPING   = CH-GROUPING    AND
  8241           CHEK-STATE      = CH-STATE       AND
  8242           CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8243           CHEK-EFF-DT     = CH-CERT-EFF-DT AND
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 146
* EL677.cbl
  8244           CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8245           CHEK-SUF-NO     = CH-CERT-SFX    AND
  8246           CHEK-RECORD-SEQ = CH-SEQUENCE-NO
  8247              GO TO 5500-FORMAT-SCREEN
  8248        ELSE
  8249              GO TO 5550-NO-RECORD.
  8250
  8251     GO TO 5500-FORMAT-SCREEN.
  8252
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 147
* EL677.cbl
  8254
  8255 5100-BROWSE-BKWD.
  8256
  8257* EXEC CICS STARTBR
  8258*        DATASET  (ERCHEK-FILE-ID)
  8259*        RIDFLD   (ERCHEK-KEY)
  8260*    END-EXEC.
  8261     MOVE 0
  8262       TO DFHEIV11
  8263*    MOVE '&,         G          &   #00007707' TO DFHEIV0
  8264     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8265     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8266     MOVE X'2020233030303037373037' TO DFHEIV0(25:11)
  8267     CALL 'kxdfhei1' USING DFHEIV0,
  8268           ERCHEK-FILE-ID,
  8269           ERCHEK-KEY,
  8270           DFHEIV99,
  8271           DFHEIV11,
  8272           DFHEIV99
  8273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8274
  8275
  8276
  8277* EXEC CICS READPREV
  8278*        DATASET  (ERCHEK-FILE-ID)
  8279*        SET      (ADDRESS OF CHECK-RECORDS)
  8280*        RIDFLD   (ERCHEK-KEY)
  8281*    END-EXEC.
  8282     MOVE 0
  8283       TO DFHEIV11
  8284*    MOVE '&0S                   )   #00007712' TO DFHEIV0
  8285     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8286     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8287     MOVE X'2020233030303037373132' TO DFHEIV0(25:11)
  8288     CALL 'kxdfhei1' USING DFHEIV0,
  8289           ERCHEK-FILE-ID,
  8290           DFHEIV20,
  8291           DFHEIV99,
  8292           ERCHEK-KEY,
  8293           DFHEIV99,
  8294           DFHEIV11,
  8295           DFHEIV99,
  8296           DFHEIV99
  8297     SET ADDRESS OF CHECK-RECORDS TO
  8298         DFHEIV20
  8299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8300
  8301
  8302 5110-READ-LOOP.
  8303     IF PI-FILE-EOF
  8304         MOVE SPACE              TO PI-EOF-SW
  8305     ELSE
  8306
  8307* EXEC CICS READPREV
  8308*            DATASET  (ERCHEK-FILE-ID)
  8309*            SET      (ADDRESS OF CHECK-RECORDS)
  8310*            RIDFLD   (ERCHEK-KEY)
  8311*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 148
* EL677.cbl
  8312     MOVE 0
  8313       TO DFHEIV11
  8314*    MOVE '&0S                   )   #00007722' TO DFHEIV0
  8315     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8316     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8317     MOVE X'2020233030303037373232' TO DFHEIV0(25:11)
  8318     CALL 'kxdfhei1' USING DFHEIV0,
  8319           ERCHEK-FILE-ID,
  8320           DFHEIV20,
  8321           DFHEIV99,
  8322           ERCHEK-KEY,
  8323           DFHEIV99,
  8324           DFHEIV11,
  8325           DFHEIV99,
  8326           DFHEIV99
  8327     SET ADDRESS OF CHECK-RECORDS TO
  8328         DFHEIV20
  8329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8330
  8331
  8332     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8333         GO TO 5560-END-OF-FILE.
  8334
  8335        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8336           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8337           PI-CHEK-STATE      = CH-STATE       AND
  8338           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8339           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8340           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8341           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8342              GO TO 5500-FORMAT-SCREEN
  8343            ELSE
  8344              GO TO 5560-END-OF-FILE.
  8345
  8346     GO TO 5500-FORMAT-SCREEN.
  8347
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 149
* EL677.cbl
  8349*                          COPY ELCNPD.
  8350*****************************************************************
  8351*                                                               *
  8352*                                                               *
  8353*                            ELCNPD                             *
  8354*                            VMOD=2.001                         *
  8355*****************************************************************
  8356
  8357 5200-MOVE-NAME.
  8358*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8359*            NAME TO A WORK AREA WITH NO EMBEDDED               *
  8360*            BLANKS.                                            *
  8361*                                                               *
  8362*                  FIELD               VALUE                    *
  8363*                                                               *
  8364*                LAST NAME (CL15)      SMITH                    *
  8365*                1ST NAME  (CL12)      JOHN                     *
  8366*                MID NAME  (CL1)       A                        *
  8367*                                                               *
  8368*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8369*         *                                                     *
  8370*         *              JOHN A. SMITH                          *
  8371*         *                                                     *
  8372*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8373*         *  STORAGE COPYBOOK:                                  *
  8374*         *                                                     *
  8375*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8376*         *******************************************************.
  8377
  8378     MOVE SPACES                 TO  WS-NAME-WORK
  8379                                     WS-NAME-WORK2.
  8380     MOVE ZERO                   TO  WS-NAME-SW.
  8381     SET NWA-INDEX TO +1.
  8382
  8383     IF WS-INSURED-1ST-NAME = SPACES  AND
  8384        WS-INSURED-MID-INIT = SPACES
  8385         MOVE WS-INSURED-LAST-NAME TO WS-NAME-WORK
  8386         GO TO 5200-EXIT.
  8387
  8388     MOVE WS-INSURED-1ST-NAME    TO  WS-NAME-WORK2.
  8389     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8390
  8391     SET NWA-INDEX UP BY +1
  8392     IF WS-INSURED-MID-INIT NOT = SPACES
  8393        MOVE WS-INSURED-MID-INIT   TO  WS-NW (NWA-INDEX)
  8394        SET NWA-INDEX UP BY +1
  8395        MOVE '.'                   TO  WS-NW (NWA-INDEX)
  8396        SET NWA-INDEX UP BY +2.
  8397
  8398     MOVE WS-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8399     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8400
  8401
  8402 5200-EXIT.
  8403     EXIT.
  8404
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 150
* EL677.cbl
  8406 5300-MOVE-NAME SECTION.
  8407     IF WS-NAME-SW GREATER THAN +1
  8408         GO TO 5390-EXIT.
  8409
  8410     IF WS-NAME-WORK2 = SPACES
  8411         GO TO 5390-EXIT.
  8412
  8413     SET NWA-INDEX2 TO +1.
  8414     SET NWA-INDEX3 TO +2.
  8415
  8416 5310-MOVE-NAME.
  8417     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8418
  8419     IF NWA-INDEX LESS THAN +30
  8420        SET NWA-INDEX UP BY +1
  8421     ELSE
  8422        ADD +2  TO  WS-NAME-SW
  8423        GO TO 5390-EXIT.
  8424
  8425     IF NWA-INDEX2 LESS THAN +20
  8426         SET NWA-INDEX2 UP BY +1
  8427         SET NWA-INDEX3 UP BY +1.
  8428
  8429     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8430        WS-NW2 (NWA-INDEX3) = SPACES
  8431        GO TO 5390-EXIT.
  8432
  8433     GO TO 5310-MOVE-NAME.
  8434
  8435 5390-EXIT.
  8436     EXIT.
  8437
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 151
* EL677.cbl
  8440 5500-FORMAT-SCREEN.
  8441     MOVE LOW-VALUES             TO  EL677AI.
  8442     if pi-void-reissue-pass = '1'
  8443        move 'R'                 to mainti
  8444                                    pi-prev-maint
  8445     else
  8446        MOVE 'S'                 TO MAINTI
  8447                                    PI-PREV-MAINT
  8448     end-if
  8449     MOVE +1                     TO  MAINTL.
  8450     MOVE CH-CONTROL-PRIMARY     TO  PI-ERCHEK-KEY.
  8451     MOVE CH-CARRIER             TO  CARRIERO.
  8452     MOVE CH-GROUPING            TO  GROUPO.
  8453     MOVE CH-STATE               TO  STATEO.
  8454     MOVE CH-ACCOUNT             TO  ACCTO.
  8455
  8456     MOVE CH-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8457     MOVE SPACE                  TO  DC-OPTION-CODE.
  8458     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8459     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8460
  8461     MOVE CH-CERT-PRIME          TO  CERTNOO.
  8462     MOVE CH-CERT-SFX            TO  SFXO.
  8463     MOVE CH-SEQUENCE-NO         TO  SEQO.
  8464
  8465     MOVE AL-UANON               TO  CARRIERA
  8466                                     GROUPA
  8467                                     STATEA
  8468                                     ACCTA
  8469                                     EFFDTA
  8470                                     CERTNOA
  8471                                     SFXA.
  8472     MOVE CH-PAYEE-NAME-1         TO PI-PAYTO1.
  8473
  8474     if ch-approval-dt not = low-values
  8475        move ch-approval-dt      to dc-bin-date-1
  8476        move ' '                 to dc-option-code
  8477        perform 8500-date-convert thru 8500-exit
  8478        move dc-greg-date-1-edit to apvdto
  8479     end-if
  8480     evaluate ch-approval-status
  8481        when '2'
  8482           move 'PENDING '       TO APVSTATO
  8483        when 'P'
  8484           move 'PENDING '       TO APVSTATO
  8485        when 'A'
  8486           move 'APPROVED'       to apvstato
  8487        when 'D'
  8488           move 'DENIED'         to apvstato
  8489     end-evaluate
  8490     move ch-approved-by         to apvbyo
  8491*    IF PI-COMPANY-ID = 'TMS'
  8492*        MOVE CH-PAYEE-NAME-2    TO  PAYTO1O
  8493*        MOVE CH-LIENHOLDER-NAME TO  PAYTO1AO
  8494*    ELSE
  8495         MOVE CH-PAYEE-NAME-1    TO  PAYTO1O
  8496         MOVE CH-PAYEE-NAME-2    TO  PAYTO2O.
  8497
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 152
* EL677.cbl
  8498     MOVE CH-PAYEE-ADDRESS-1     TO  PAYAD1O.
  8499     MOVE CH-PAYEE-ADDRESS-2     TO  PAYAD2O.
  8500     move ch-payee-city          to payctyo
  8501     move ch-payee-state         to paysto
  8502     MOVE CH-PAYEE-CODE          TO  PAYEEO.
  8503
  8504     IF CH-PAYEE-ZIP-CODE NOT = ZEROS
  8505         MOVE CH-PAYEE-ZIP-CODE  TO  PTOZIPO
  8506         MOVE AL-UANON           TO  PTOZIPA.
  8507
  8508     MOVE CH-RETURN-TO           TO  RETTOO
  8509*    if ch-check-cashed-dt not = spaces and low-values
  8510*       move ch-check-cashed-dt  to dc-bin-date-1
  8511*       MOVE SPACE               TO  DC-OPTION-CODE
  8512*       PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8513*       MOVE DC-GREG-DATE-1-EDIT TO  CASHEDO
  8514*    end-if
  8515     MOVE CH-RECORDED-DT         TO  DC-BIN-DATE-1.
  8516     MOVE SPACE                  TO  DC-OPTION-CODE.
  8517     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8518     MOVE DC-GREG-DATE-1-EDIT    TO  CREATEDO.
  8519
  8520     MOVE CH-RECORDED-BY         TO  CBYO.
  8521
  8522     IF CH-VOID-DT = SPACES OR LOW-VALUES OR ZEROS
  8523         NEXT SENTENCE
  8524     ELSE
  8525         MOVE CH-VOID-DT             TO  DC-BIN-DATE-1
  8526         MOVE SPACE                  TO  DC-OPTION-CODE
  8527         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8528         MOVE DC-GREG-DATE-1-EDIT    TO  VOIDEDO
  8529         MOVE CH-VOID-BY             TO  VBYO.
  8530
  8531     IF CH-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES OR ZEROS
  8532         NEXT SENTENCE
  8533     ELSE
  8534         MOVE CH-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1
  8535         MOVE SPACE                  TO  DC-OPTION-CODE
  8536         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8537         MOVE DC-GREG-DATE-1-EDIT    TO  PRINTEDI.
  8538
  8539     MOVE CH-AMOUNT-PAID         TO  AMOUNTO
  8540                                     pi-void-reissue-amt
  8541     MOVE AL-SANOF               TO  AMOUNTA.
  8542     MOVE CH-CHECK-ORIGIN-SW     TO  TYPEI.
  8543     MOVE AL-SANOF               TO  TYPEA.
  8544     MOVE CH-CHECK-NO            TO  CHECKO.
  8545     move ch-deduct-commission   to dedcyno
  8546     MOVE CH-REASON-FOR-CHECK    TO  REASONO.
  8547     MOVE CH-VOID-REASON         TO  VREASONO.
  8548
  8549     MOVE CH-STUB-LINE-1         TO  STUBO.
  8550     MOVE CH-TEXT-LINE-1         TO  TEXT1O.
  8551     MOVE CH-TEXT-LINE-2         TO  TEXT2O.
  8552     MOVE CH-TEXT-LINE-3         TO  TEXT3O.
  8553     IF CH-LF-REFUND NOT NUMERIC
  8554         MOVE ZEROS              TO CH-LF-REFUND.
  8555     IF CH-AH-REFUND NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 153
* EL677.cbl
  8556         MOVE ZEROS              TO CH-AH-REFUND.
  8557     if (ch-check-no not = spaces and low-values)
  8558        and (ch-check-written-dt not = low-values)
  8559        perform 5800-fetch-check-cashed-dt
  8560                                 thru 5800-exit
  8561     end-if
  8562     IF CH-CHECK-WRITTEN-DT GREATER LOW-VALUES OR
  8563        CH-VOID-DT          GREATER LOW-VALUES
  8564        MOVE AL-SANON            TO  CHECKA    REASONA  VREASONA
  8565                                     STUBA     TEXT1A   TEXT2A
  8566                                     TEXT3A    PAYTO1A  SFXA
  8567                                     PAYTO2A   PAYAD1A  PAYctyA
  8568                                     paysta    RETTOA   PAYAD2A
  8569                                     PTOZIPA
  8570                                     PRINTEDA
  8571     ELSE
  8572        MOVE AL-UANON            TO  CARRIERA  GROUPA   STATEA
  8573                                     ACCTA     EFFDTA   CERTNOA
  8574                                     CHECKA    REASONA  VREASONA
  8575                                     STUBA     TEXT1A   TEXT2A
  8576                                     TEXT3A    PAYTO1A  SFXA
  8577                                     PAYTO2A   PAYAD1A  PAYctyA
  8578                                     paysta    RETTOA   PAYAD2A
  8579                                     PRINTEDA.
  8580
  8581     MOVE AL-UNNON               TO SEQA.
  8582     perform 5600-get-erpndb     thru 5600-exit
  8583     perform 5700-get-elcert     thru 5700-exit
  8584*    move pi-prev-paid           to prepdo
  8585     move al-sadof               to drefa
  8586*    if WS-PNDB-FOUND
  8587*       compute refo = pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8588*    end-if
  8589     if WS-CERT-FOUND
  8590        compute ws-tot-lf-prem = cm-lf-premium-amt +
  8591           cm-lf-alt-premium-amt
  8592        compute ws-tot-iss-prem  =
  8593           cm-ah-premium-amt + ws-tot-lf-prem
  8594        compute ws-tot-iss-comm =
  8595           (ws-tot-lf-prem * cm-life-comm-pct) +
  8596           (cm-ah-premium-amt * cm-ah-comm-pct)
  8597        compute ws-tot-ref-comm =
  8598           (pi-lf-refund * cm-life-comm-pct) +
  8599           (pi-ah-refund * cm-ah-comm-pct)
  8600        move ws-tot-iss-prem     to premo
  8601        move ws-tot-iss-comm     to isscommo
  8602*       move ws-tot-ref-comm     to uecommo
  8603     end-if
  8604     if PI-TO-EL677-FROM-EL1273
  8605        move zeros               to premo
  8606                                    isscommo
  8607                                    uecommo
  8608                                    prepdo
  8609                                    refo
  8610     end-if
  8611     GO TO 8100-SEND-INITIAL-MAP
  8612     .
  8613 5550-NO-RECORD.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 154
* EL677.cbl
  8614     MOVE ER-1162                TO  EMI-ERROR.
  8615     MOVE -1                     TO  CARRIERL.
  8616     MOVE AL-UABON               TO  CARRIERA  GROUPA  STATEA
  8617                                     ACCTA     EFFDTA  CERTNOA
  8618                                     SFXA      SEQA.
  8619     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8620
  8621     IF (NOT PI-TO-EL677-FROM-EL1273)
  8622        and (pi-return-to-program not = 'EL6315')
  8623         GO TO 8200-SEND-DATAONLY.
  8624
  8625     MOVE CHEK-CARRIER           TO  CARRIERO.
  8626     MOVE CHEK-GROUPING          TO  GROUPO.
  8627     MOVE CHEK-STATE             TO  STATEO.
  8628     MOVE CHEK-ACCOUNT           TO  ACCTO.
  8629
  8630     MOVE CHEK-EFF-DT            TO  DC-BIN-DATE-1.
  8631     MOVE SPACE                  TO  DC-OPTION-CODE.
  8632     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8633     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8634
  8635     MOVE CHEK-CERT-NO           TO  CERTNOO.
  8636     MOVE CHEK-SUF-NO            TO  SFXO.
  8637     GO TO 8100-SEND-INITIAL-MAP.
  8638
  8639 5560-END-OF-FILE.
  8640     IF EIBAID = DFHPF1
  8641         MOVE 'Y'                TO  PI-EOF-SW
  8642         MOVE ER-2237            TO  EMI-ERROR
  8643     ELSE
  8644     IF EIBAID = DFHENTER
  8645        GO TO 5550-NO-RECORD
  8646     ELSE
  8647*        MOVE SPACES             TO  PI-ERCHEK-KEY
  8648         MOVE ER-2238            TO  EMI-ERROR.
  8649
  8650     MOVE -1                     TO  MAINTL.
  8651     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8652     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 155
* EL677.cbl
  8654 5600-get-erpndb.
  8655     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  8656     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  8657     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  8658     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  8659     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  8660     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  8661     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  8662     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  8663     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  8664     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  8665     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  8666     IF ST-ACCNT-CNTL  OR
  8667        ACCNT-CNTL
  8668          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  8669     IF ST-ACCNT-CNTL      OR
  8670        CARR-ST-ACCNT-CNTL OR
  8671        ACCNT-CNTL         OR
  8672        CARR-ACCNT-CNTL
  8673          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  8674     IF ACCNT-CNTL OR
  8675        CARR-ACCNT-CNTL
  8676          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  8677
  8678* EXEC CICS READ
  8679*         DATASET   (ERPNDB-ALT-FILE-ID)
  8680*         SET       (ADDRESS OF PENDING-BUSINESS)
  8681*         RIDFLD    (ERPNDB-ALT-KEY)
  8682*         resp      (ws-response)
  8683*    END-EXEC
  8684*    MOVE '&"S        E          (  N#00008073' TO DFHEIV0
  8685     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8686     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8687     MOVE X'204E233030303038303733' TO DFHEIV0(25:11)
  8688     CALL 'kxdfhei1' USING DFHEIV0,
  8689           ERPNDB-ALT-FILE-ID,
  8690           DFHEIV20,
  8691           DFHEIV99,
  8692           ERPNDB-ALT-KEY,
  8693           DFHEIV99,
  8694           DFHEIV99,
  8695           DFHEIV99
  8696     SET ADDRESS OF PENDING-BUSINESS TO
  8697         DFHEIV20
  8698     MOVE EIBRESP  TO ws-response
  8699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8700     if resp-normal
  8701        MOVE 'Y'                 TO WS-PNDB-FOUND-SW
  8702        compute pi-refund-on-pending-rec =
  8703           pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8704     end-if
  8705     .
  8706 5600-exit.
  8707     exit.
  8708 5700-get-elcert.
  8709     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  8710     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  8711     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 156
* EL677.cbl
  8712     MOVE PI-STATE               TO  ELCERT-STATE.
  8713     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  8714     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  8715     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  8716     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  8717     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  8718
  8719* EXEC CICS READ
  8720*         DATASET   (ELCERT-FILE-ID)
  8721*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  8722*         RIDFLD    (ELCERT-KEY)
  8723*         resp      (ws-response)
  8724*    END-EXEC
  8725*    MOVE '&"S        E          (  N#00008097' TO DFHEIV0
  8726     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8727     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8728     MOVE X'204E233030303038303937' TO DFHEIV0(25:11)
  8729     CALL 'kxdfhei1' USING DFHEIV0,
  8730           ELCERT-FILE-ID,
  8731           DFHEIV20,
  8732           DFHEIV99,
  8733           ELCERT-KEY,
  8734           DFHEIV99,
  8735           DFHEIV99,
  8736           DFHEIV99
  8737     SET ADDRESS OF CERTIFICATE-MASTER TO
  8738         DFHEIV20
  8739     MOVE EIBRESP  TO ws-response
  8740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8741     if resp-normal
  8742        MOVE 'Y'                 TO WS-CERT-FOUND-SW
  8743     end-if
  8744     .
  8745 5700-exit.
  8746     exit.
  8747 5800-fetch-check-cashed-dt.
  8748     move ' '                    to ws-connect-sw
  8749                                    ws-match-sw
  8750                                    pi-check-cashed
  8751     move 'NTCSO2_PdBnkInfo'     to svr
  8752     move 'sa'                   to usr
  8753     move 'ntcso2'               to pass
  8754     string
  8755         usr delimited space
  8756         "." delimited size
  8757         pass delimited space into usr-pass
  8758     end-string
  8759     EXEC SQL
  8760        CONNECT TO :svr USER :usr-pass
  8761     END-EXEC
  8762     if sqlcode not = 0
  8763        display "Error: cannot connect to pdbnkinfo "
  8764        display sqlcode
  8765        display sqlerrmc
  8766        go to 5800-exit
  8767     end-if
  8768     set connected-to-db to true
  8769     if pi-company-id = 'CID'
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 157
* EL677.cbl
  8770        move 'CSO - AP%'         to ws-pb-compid
  8771     else
  8772        move 'AHL - AP%'         to ws-pb-compid
  8773     end-if
  8774     move '000'                  to ws-pb-check-no (1:3)
  8775     move ch-check-no            to ws-pb-check-no (4:7)
  8776     move spaces                 to ws-pb-bad-check-no
  8777     perform varying s1 from +1 by +1 until
  8778        (s1 > +10)
  8779        or (ws-pb-check-no (s1:1) not = '0')
  8780     end-perform
  8781     if s1 < +11
  8782        move ws-pb-check-no (s1:11 - s1)
  8783                            to ws-pb-bad-check-no (1: 11 - s1)
  8784     end-if
  8785*    display ' compid **' ws-pb-compid '**'
  8786*    display ' ckno  **' ws-pb-check-no '**'
  8787     MOVE ch-AMOUNT-PAID      TO WS-CHECK-AMT-TMP
  8788     MOVE WS-CHECK-AMT-TMPX   TO WS-CHECK-AMOUNT
  8789     MOVE SPACES              TO pb-paid-date
  8790
  8791     EXEC SQL
  8792        CALL pbi_GetCashDate_by_TransactionNbr
  8793           @compid          = :ws-pb-compid,
  8794           @checkno         = :ws-pb-check-no,
  8795           @badcheckno      = :ws-pb-bad-check-no,
  8796           @checkamount     = :ws-check-amount,
  8797           @checkcasheddate = :pb-paid-date OUT
  8798     END-EXEC
  8799     if sqlcode not = 0
  8800        display "Error: cannot run stor proc  "
  8801        move sqlcode            to ws-sql-code
  8802        move ws-sql-code to ws-dis-sql-code
  8803        display ' dis sql code ' ws-dis-sql-code
  8804        display ' sql return code ' sqlcode
  8805        display ' sql err mess    ' sqlerrmc
  8806        go to 5800-disconnect
  8807     end-if
  8808***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8809***                                                            ***
  8810***  The following code works just as well as the above        ***
  8811***  stored procedure and just as fast.                        ***
  8812***  Originally, I had declared a cursor and fetched through   ***
  8813***  the record set to find the correct check and that REALLY  ***
  8814***  slowed the response down to ~ 3/4 second.                 ***
  8815***                                                            ***
  8816***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8817*     EXEC SQL
  8818*        SELECT
  8819*           PaidDate
  8820*        INTO
  8821*           :pb-paid-date
  8822*        FROM
  8823*           dbo.cso_pbi_TransactionLookup
  8824*        WHERE
  8825*           (BankAcctDescr like :ws-pb-compid)
  8826*           and (Amount = :ws-check-amount)
  8827*           and ((transactionNbr = :ws-pb-check-no)
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 158
* EL677.cbl
  8828*                  or
  8829*               (transactionnbr = :ws-pb-bad-check-no))
  8830**          and (CAST(TransactionNbr AS INT) =
  8831**             :ws-pb-check-no-num)
  8832**          and (right('00000' + rtrim(TransactionNbr),10)
  8833**             = :ws-pb-check-no)
  8834**          and (TransactionNbr  = :ws-pb-check-no)
  8835*     END-EXEC
  8836*    display ' chkno  ' pb-check-no
  8837*    display ' desc   ' pb-bank-acct-desc
  8838*    display ' trn typ' pb-tran-type
  8839*    display ' amt   *' pb-amount '**'
  8840*    display ' pd dte ' pb-paid-date
  8841     string pb-paid-date (1:4)
  8842            pb-paid-date (6:2)
  8843            pb-paid-date (9:2)
  8844        delimited by size into dc-greg-date-cymd-r
  8845     end-string
  8846     move 'L'                    to dc-option-code
  8847     perform 8500-date-convert   thru 8500-exit
  8848     if no-conversion-error
  8849*       move dc-bin-date-1       to ws-bin-cashed-dt
  8850        move dc-greg-date-1-edit to cashedo
  8851        move 'Y' to pi-check-cashed
  8852     else
  8853        display ' error cvtdte cash dt ' pb-paid-date ' '
  8854           dc-error-code
  8855     end-if
  8856     .
  8857 5800-disconnect.
  8858     EXEC SQL
  8859        DISCONNECT ALL
  8860     END-EXEC
  8861     if sqlcode not = 0
  8862        display "Error: cannot disconnect pdbnk "
  8863        display ' sql return code ' sqlcode
  8864        display ' sql err mess    ' sqlerrmc
  8865     end-if
  8866     .
  8867 5800-exit.
  8868     exit.
  8869 6000-VERIFY-COMP-MASTER.
  8870
  8871* EXEC CICS HANDLE CONDITION
  8872*        NOTFND   (6070-NO-COMP-MSTR)
  8873*    END-EXEC.
  8874*    MOVE '"$I                   ! - #00008232' TO DFHEIV0
  8875     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8876     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8877     MOVE X'2D20233030303038323332' TO DFHEIV0(25:11)
  8878     CALL 'kxdfhei1' USING DFHEIV0
  8879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8880
  8881
  8882     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  8883
  8884     IF NOT PI-ZERO-CARRIER AND
  8885        NOT PI-ZERO-CAR-GROUP
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 159
* EL677.cbl
  8886         MOVE PI-CR-CARRIER      TO  ERCOMP-CARRIER
  8887     ELSE
  8888         MOVE ZEROS              TO  ERCOMP-CARRIER.
  8889
  8890     IF NOT PI-ZERO-GROUPING  AND
  8891        NOT PI-ZERO-CAR-GROUP
  8892         MOVE PI-CR-GROUPING     TO  ERCOMP-GROUPING
  8893     ELSE
  8894         MOVE ZEROS              TO  ERCOMP-GROUPING.
  8895
  8896     MOVE PI-CR-FIN-RESP         TO  ERCOMP-FIN-RESP.
  8897     MOVE PI-CR-ACCOUNT          TO  ERCOMP-ACCOUNT.
  8898     MOVE 'A'                    TO  ERCOMP-RECORD-TYPE.
  8899
  8900
  8901* EXEC CICS READ
  8902*         DATASET   (ERCOMP-FILE-ID)
  8903*         SET       (ADDRESS OF COMPENSATION-MASTER)
  8904*         RIDFLD    (ERCOMP-KEY)
  8905*     END-EXEC.
  8906*    MOVE '&"S        E          (   #00008254' TO DFHEIV0
  8907     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8908     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8909     MOVE X'2020233030303038323534' TO DFHEIV0(25:11)
  8910     CALL 'kxdfhei1' USING DFHEIV0,
  8911           ERCOMP-FILE-ID,
  8912           DFHEIV20,
  8913           DFHEIV99,
  8914           ERCOMP-KEY,
  8915           DFHEIV99,
  8916           DFHEIV99,
  8917           DFHEIV99
  8918     SET ADDRESS OF COMPENSATION-MASTER TO
  8919         DFHEIV20
  8920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8921
  8922
  8923     GO TO 6090-EXIT.
  8924
  8925 6070-NO-COMP-MSTR.
  8926     MOVE -1                     TO  CARRIERL.
  8927     MOVE ER-2230                TO  EMI-ERROR.
  8928     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8929     GO TO 8200-SEND-DATAONLY.
  8930
  8931 6090-EXIT.
  8932      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 160
* EL677.cbl
  8934 6100-VERIFY-CERTIFICATE.
  8935
  8936* EXEC CICS HANDLE CONDITION
  8937*        NOTFND   (6170-NO-CERTIFICATE)
  8938*    END-EXEC.
  8939*    MOVE '"$I                   ! . #00008272' TO DFHEIV0
  8940     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8941     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8942     MOVE X'2E20233030303038323732' TO DFHEIV0(25:11)
  8943     CALL 'kxdfhei1' USING DFHEIV0
  8944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8945
  8946
  8947     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  8948     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  8949     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  8950     MOVE PI-STATE               TO  ELCERT-STATE.
  8951     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  8952     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  8953     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  8954     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  8955
  8956     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  8957
  8958     MOVE SPACES                 TO  PI-REFERENCE
  8959*                                    PI-INSURED-NAME.
  8960     MOVE LOW-VALUES             TO  PI-CANC-DT.
  8961*    MOVE ZEROS                  TO  PI-LF-REFUND
  8962*                                    PI-AH-REFUND.
  8963
  8964
  8965* EXEC CICS READ
  8966*         DATASET   (ELCERT-FILE-ID)
  8967*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  8968*         RIDFLD    (ELCERT-KEY)
  8969*     END-EXEC.
  8970*    MOVE '&"S        E          (   #00008293' TO DFHEIV0
  8971     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8972     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8973     MOVE X'2020233030303038323933' TO DFHEIV0(25:11)
  8974     CALL 'kxdfhei1' USING DFHEIV0,
  8975           ELCERT-FILE-ID,
  8976           DFHEIV20,
  8977           DFHEIV99,
  8978           ELCERT-KEY,
  8979           DFHEIV99,
  8980           DFHEIV99,
  8981           DFHEIV99
  8982     SET ADDRESS OF CERTIFICATE-MASTER TO
  8983         DFHEIV20
  8984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8985
  8986
  8987     MOVE 'Y'                    TO  WS-CERT-FOUND-SW.
  8988
  8989*    MOVE CM-LF-ITD-CANCEL-AMT   TO  PI-LF-REFUND.
  8990*    MOVE CM-AH-ITD-CANCEL-AMT   TO  PI-AH-REFUND.
  8991     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 161
* EL677.cbl
  8992         MOVE CM-LF-CANCEL-DT    TO  PI-CANC-DT
  8993     ELSE
  8994         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  8995             MOVE CM-AH-CANCEL-DT TO PI-CANC-DT.
  8996*    MOVE CM-INSURED-LAST-NAME   TO  PI-INSURED-NAME.
  8997
  8998     GO TO 6190-EXIT.
  8999
  9000 6170-NO-CERTIFICATE.
  9001     MOVE -1                     TO  CARRIERL.
  9002     MOVE ER-2726                TO  EMI-ERROR.
  9003     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9004
  9005 6190-EXIT.
  9006      EXIT.
  9007
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 162
* EL677.cbl
  9009 6200-UPDATE-PENDING-BUS-REC.
  9010     MOVE PI-COMPANY-CD          TO  ERPNDB-ALT-COMPANY-CD.
  9011     MOVE PI-CARRIER             TO  ERPNDB-ALT-CARRIER.
  9012     MOVE PI-GROUPING            TO  ERPNDB-ALT-GROUPING.
  9013     MOVE PI-STATE               TO  ERPNDB-ALT-STATE.
  9014     MOVE PI-ACCOUNT             TO  ERPNDB-ALT-ACCOUNT.
  9015     MOVE PI-CERT-PRIME          TO  ERPNDB-ALT-CERT-PRIME.
  9016     MOVE PI-CERT-SFX            TO  ERPNDB-ALT-CERT-SFX.
  9017     MOVE PI-CERT-EFF-DT         TO  ERPNDB-ALT-CERT-EFF-DT.
  9018     MOVE ZEROS                  TO  ERPNDB-ALT-CH-SEQ-NO.
  9019     MOVE '2'                    TO  ERPNDB-ALT-RECORD-TYPE.
  9020
  9021     IF ST-ACCNT-CNTL  OR
  9022        ACCNT-CNTL
  9023          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9024
  9025     IF ST-ACCNT-CNTL      OR
  9026        CARR-ST-ACCNT-CNTL OR
  9027        ACCNT-CNTL         OR
  9028        CARR-ACCNT-CNTL
  9029          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9030
  9031     IF ACCNT-CNTL OR
  9032        CARR-ACCNT-CNTL
  9033          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9034
  9035
  9036* EXEC CICS READ
  9037*         DATASET   (ERPNDB-ALT-FILE-ID)
  9038*         SET       (ADDRESS OF PENDING-BUSINESS)
  9039*         RIDFLD    (ERPNDB-ALT-KEY)
  9040*         resp      (ws-response)
  9041*     END-EXEC.
  9042*    MOVE '&"S        E          (  N#00008347' TO DFHEIV0
  9043     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9044     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9045     MOVE X'204E233030303038333437' TO DFHEIV0(25:11)
  9046     CALL 'kxdfhei1' USING DFHEIV0,
  9047           ERPNDB-ALT-FILE-ID,
  9048           DFHEIV20,
  9049           DFHEIV99,
  9050           ERPNDB-ALT-KEY,
  9051           DFHEIV99,
  9052           DFHEIV99,
  9053           DFHEIV99
  9054     SET ADDRESS OF PENDING-BUSINESS TO
  9055         DFHEIV20
  9056     MOVE EIBRESP  TO ws-response
  9057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9058
  9059
  9060     if not resp-normal
  9061        go to 6200-exit
  9062     end-if
  9063     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-PRIMARY-KEY.
  9064
  9065
  9066* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 163
* EL677.cbl
  9067*         DATASET   (ERPNDB-FILE-ID)
  9068*         SET       (ADDRESS OF PENDING-BUSINESS)
  9069*         RIDFLD    (ERPNDB-PRIMARY-KEY)
  9070*         UPDATE
  9071*         resp      (ws-response)
  9072*     END-EXEC.
  9073*    MOVE '&"S        EU         (  N#00008359' TO DFHEIV0
  9074     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9075     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9076     MOVE X'204E233030303038333539' TO DFHEIV0(25:11)
  9077     CALL 'kxdfhei1' USING DFHEIV0,
  9078           ERPNDB-FILE-ID,
  9079           DFHEIV20,
  9080           DFHEIV99,
  9081           ERPNDB-PRIMARY-KEY,
  9082           DFHEIV99,
  9083           DFHEIV99,
  9084           DFHEIV99
  9085     SET ADDRESS OF PENDING-BUSINESS TO
  9086         DFHEIV20
  9087     MOVE EIBRESP  TO ws-response
  9088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9089
  9090
  9091 6200-EXIT.
  9092      EXIT.
  9093 6210-rewrite-pndb.
  9094
  9095* EXEC CICS REWRITE
  9096*        DATASET  (ERPNDB-FILE-ID)
  9097*        FROM     (PENDING-BUSINESS)
  9098*    END-EXEC
  9099     MOVE LENGTH OF
  9100      PENDING-BUSINESS
  9101       TO DFHEIV11
  9102*    MOVE '&& L                  %   #00008370' TO DFHEIV0
  9103     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9104     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9105     MOVE X'2020233030303038333730' TO DFHEIV0(25:11)
  9106     CALL 'kxdfhei1' USING DFHEIV0,
  9107           ERPNDB-FILE-ID,
  9108           PENDING-BUSINESS,
  9109           DFHEIV11,
  9110           DFHEIV99
  9111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9112     .
  9113 6210-exit.
  9114     exit.
  9115 6300-BUILD-CERT-SCREEN.
  9116*    move 'N'                    to dedcyni
  9117*                                   pi-prev-ded-comm
  9118     MOVE LOW-VALUES             TO  EL677AI.
  9119     perform 6700-build-common   thru 6700-exit
  9120     if ws-refund-amount = zeros
  9121        move pi-company-cd       to pi-chek-comp-cd
  9122        move pi-carrier          to pi-chek-carrier
  9123        move pi-grouping         to pi-chek-grouping
  9124        move pi-state            to pi-chek-state
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 164
* EL677.cbl
  9125        move pi-account          to pi-chek-account
  9126        move pi-cert-eff-dt      to pi-chek-eff-dt
  9127        move pi-cert-prime       to pi-chek-cert-no
  9128        move pi-cert-sfx         to pi-chek-suf-no
  9129        move +1                  to pi-chek-sequence
  9130             MOVE 'S'            TO MAINTI
  9131             MOVE 1              TO MAINTL
  9132             MOVE AL-UABON       TO MAINTA
  9133             MOVE DFHENTER       TO EIBAID
  9134        go to 5000-browse-file
  9135     end-if
  9136     IF WS-CERT-NOT-FOUND
  9137         GO TO 8100-SEND-INITIAL-MAP.
  9138
  9139*    IF WS-PNDB-FOUND
  9140*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9141*                                   PB-C-AH-CANCEL-AMT
  9142*        MOVE 'R'                TO  TYPEO
  9143*        IF PI-AR-PROCESSING
  9144*            MOVE AL-UANON       TO  REFA
  9145*            MOVE PB-C-REFERENCE TO  REFO
  9146*        END-IF
  9147*    ELSE
  9148*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9149*                                   CM-AH-ITD-CANCEL-AMT.
  9150     MOVE WS-REFUND-AMOUNT        TO AMOUNTO
  9151     MOVE pi-check-type           TO TYPEO
  9152
  9153     IF PI-COMPANY-ID = 'TMS'
  9154         MOVE WS-NAME-WORK         TO PAYTO1I
  9155                                      PI-PAYTO1
  9156         MOVE AL-UANON             TO PAYTO1A
  9157     ELSE
  9158         MOVE WS-NAME-WORK         TO PAYTO1I
  9159                                      PI-PAYTO1
  9160         MOVE AL-UANON             TO PAYTO1A.
  9161
  9162*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9163*    MOVE AL-UANON                 TO PAYTO1AA.
  9164     move 'N'                    to dedcyni
  9165     move al-uanon               to dedcyna
  9166     move 'INS'                  to payeeo
  9167     move al-panon               to payeea
  9168     IF PI-MAIL-YES
  9169         PERFORM 6400-MAILING-ADDRESS THRU 6490-EXIT.
  9170
  9171     GO TO 8100-SEND-INITIAL-MAP.
  9172
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 165
* EL677.cbl
  9174
  9175 6400-MAILING-ADDRESS.
  9176
  9177* EXEC CICS HANDLE CONDITION
  9178*        NOTFND   (6470-NO-ADDRESS)
  9179*    END-EXEC.
  9180*    MOVE '"$I                   ! / #00008438' TO DFHEIV0
  9181     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9183     MOVE X'2F20233030303038343338' TO DFHEIV0(25:11)
  9184     CALL 'kxdfhei1' USING DFHEIV0
  9185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9186
  9187
  9188
  9189* EXEC CICS READ
  9190*        DATASET   (ERMAIL-FILE-ID)
  9191*        SET       (ADDRESS OF MAILING-DATA)
  9192*        RIDFLD    (ELCERT-KEY)
  9193*    END-EXEC.
  9194*    MOVE '&"S        E          (   #00008442' TO DFHEIV0
  9195     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9196     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9197     MOVE X'2020233030303038343432' TO DFHEIV0(25:11)
  9198     CALL 'kxdfhei1' USING DFHEIV0,
  9199           ERMAIL-FILE-ID,
  9200           DFHEIV20,
  9201           DFHEIV99,
  9202           ELCERT-KEY,
  9203           DFHEIV99,
  9204           DFHEIV99,
  9205           DFHEIV99
  9206     SET ADDRESS OF MAILING-DATA TO
  9207         DFHEIV20
  9208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9209
  9210
  9211     MOVE MA-ADDRESS-LINE-1      TO PAYAD1I.
  9212     MOVE MA-ADDRESS-LINE-2      TO PAYAD2I.
  9213     move ma-city                to payctyi
  9214     move ma-addr-state          to paysti
  9215     MOVE MA-ZIP                 TO PTOZIPI.
  9216     MOVE AL-UANON               TO PAYAD1A
  9217                                    PAYAD2A
  9218                                    PAYctyA
  9219                                    paysta
  9220                                    PTOZIPA.
  9221
  9222     GO TO 6490-EXIT.
  9223
  9224 6470-NO-ADDRESS.
  9225     MOVE -1                     TO  PAYAD1L.
  9226     MOVE ER-2394                TO  EMI-ERROR.
  9227     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9228
  9229 6490-EXIT.
  9230      EXIT.
  9231
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 166
* EL677.cbl
  9233
  9234 6500-BUILD-ACCOUNT-SCREEN.
  9235     MOVE LOW-VALUES             TO  EL677AI.
  9236     perform 6700-build-common   thru 6700-exit
  9237     MOVE WS-REFUND-AMOUNT       TO AMOUNTO
  9238     MOVE PI-AM-NAME             TO PAYTO1I
  9239     MOVE SPACES                 TO PAYTO2I
  9240     MOVE PI-AM-ADDRS            TO PAYAD1I.
  9241     MOVE PI-AM-CITY             TO PAYCTYI
  9242     move pi-am-st               to paysti
  9243     MOVE PI-AM-ZIP-CODE         TO PTOZIPI
  9244     move 'ACCT'                 to payeeo
  9245     move al-panon               to payeea
  9246     MOVE AL-UANON               TO PAYTO1A
  9247                                    PAYTO2A
  9248                                    PAYAD1A
  9249                                    PAYCTYA
  9250                                    paysta
  9251                                    PTOZIPA
  9252     GO TO 8100-SEND-INITIAL-MAP
  9253     .
  9254 6600-BUILD-BENEFICIARY-SCREEN.
  9255     MOVE LOW-VALUES             TO  EL677AI.
  9256     perform 6700-build-common   thru 6700-exit
  9257     IF WS-CERT-NOT-FOUND
  9258         GO TO 8100-SEND-INITIAL-MAP.
  9259
  9260*    IF WS-PNDB-FOUND
  9261*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9262*                                   PB-C-AH-CANCEL-AMT
  9263*        MOVE 'R'                TO  TYPEO
  9264*        IF PI-AR-PROCESSING
  9265*            MOVE AL-UANON       TO  REFA
  9266*            MOVE PB-C-REFERENCE TO  REFO
  9267*        END-IF
  9268*    ELSE
  9269*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9270*                                   CM-AH-ITD-CANCEL-AMT.
  9271
  9272     MOVE WS-REFUND-AMOUNT        TO  AMOUNTO.
  9273     MOVE pi-check-type           TO  TYPEO.
  9274
  9275     IF PI-COMPANY-ID = 'TMS'
  9276         MOVE WS-NAME-WORK         TO PAYTO1I
  9277                                      PI-PAYTO1
  9278         MOVE AL-UANON             TO PAYTO1A
  9279     ELSE
  9280         MOVE WS-NAME-WORK         TO PAYTO1I
  9281                                      PI-PAYTO1
  9282         MOVE AL-UANON             TO PAYTO1A.
  9283
  9284*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9285*    MOVE AL-UANON                 TO PAYTO1AA.
  9286
  9287     move 'N'                    to dedcyni
  9288     move al-uanon               to dedcyna
  9289     move 'BENE'                 to payeeo
  9290     move al-panon               to payeea
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 167
* EL677.cbl
  9291     IF PI-MAIL-YES
  9292         PERFORM 6620-MAILING-ADDRESS THRU 6690-EXIT.
  9293
  9294     GO TO 8100-SEND-INITIAL-MAP.
  9295
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 168
* EL677.cbl
  9297
  9298 6620-MAILING-ADDRESS.
  9299
  9300* EXEC CICS HANDLE CONDITION
  9301*        NOTFND   (6670-NO-beneficiary)
  9302*    END-EXEC.
  9303*    MOVE '"$I                   ! 0 #00008536' TO DFHEIV0
  9304     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9306     MOVE X'3020233030303038353336' TO DFHEIV0(25:11)
  9307     CALL 'kxdfhei1' USING DFHEIV0
  9308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9309
  9310
  9311
  9312* EXEC CICS READ
  9313*        DATASET   (ERMAIL-FILE-ID)
  9314*        SET       (ADDRESS OF MAILING-DATA)
  9315*        RIDFLD    (ELCERT-KEY)
  9316*    END-EXEC.
  9317*    MOVE '&"S        E          (   #00008540' TO DFHEIV0
  9318     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9319     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9320     MOVE X'2020233030303038353430' TO DFHEIV0(25:11)
  9321     CALL 'kxdfhei1' USING DFHEIV0,
  9322           ERMAIL-FILE-ID,
  9323           DFHEIV20,
  9324           DFHEIV99,
  9325           ELCERT-KEY,
  9326           DFHEIV99,
  9327           DFHEIV99,
  9328           DFHEIV99
  9329     SET ADDRESS OF MAILING-DATA TO
  9330         DFHEIV20
  9331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9332
  9333
  9334     move spaces                 to payto2i
  9335     move ma-cred-bene-name      to payto1i
  9336     MOVE MA-cred-bene-addr      TO PAYad1I.
  9337     MOVE MA-cred-bene-addr2     TO PAYad2I.
  9338     move ma-cred-bene-city      to payctyi
  9339     move ma-cred-bene-state     to paysti
  9340     MOVE MA-cred-bene-zip       TO PTOZIPI.
  9341     MOVE AL-UANON               TO payto1a
  9342                                    PAYTO2A
  9343                                    PAYad1A
  9344                                    payad2a
  9345                                    PAYctyA
  9346                                    paysta
  9347                                    PTOZIPA.
  9348
  9349     GO TO 6690-EXIT.
  9350
  9351 6670-NO-BENEFICIARY.
  9352     MOVE -1                     TO  PAYTO1L.
  9353     MOVE ER-2394                TO  EMI-ERROR.
  9354     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 169
* EL677.cbl
  9355
  9356 6690-EXIT.
  9357      EXIT.
  9358 6700-build-common.
  9359     if not eracct-found
  9360        move pi-company-cd       to eracct-co
  9361        move pi-carrier          to eracct-carrier
  9362        move pi-grouping         to eracct-grouping
  9363        move pi-state            to eracct-state
  9364        move pi-account          to eracct-account
  9365        move pi-cert-eff-dt      to eracct-exp-date
  9366        perform 1420-get-eracct  thru 1490-exit
  9367     end-if
  9368*    if WS-PNDB-NOT-FOUND
  9369*       perform 5600-get-erpndb thru 5600-exit
  9370*    end-if
  9371*    MOVE LOW-VALUES             TO  EL677AI.
  9372     MOVE 'A'                    TO  MAINTI.
  9373     MOVE AL-UANON               TO  MAINTA.
  9374     MOVE +1                     TO  MAINTL.
  9375     MOVE PI-CARRIER             TO  CARRIERO.
  9376     MOVE PI-GROUPING            TO  GROUPO.
  9377     MOVE PI-STATE               TO  STATEO.
  9378     MOVE PI-ACCOUNT             TO  ACCTO.
  9379     MOVE PI-CERT-PRIME          TO  CERTNOO.
  9380     MOVE PI-CERT-SFX            TO  SFXO.
  9381     MOVE PI-AMOUNT              TO  AMOUNTO.
  9382*    MOVE PI-TYPE                TO  TYPEO.
  9383     move pi-check-type          to  typeo
  9384     move pi-return-to           to  rettoo
  9385*    MOVE PI-REFERENCE           TO  REFO.
  9386     MOVE PI-PAYTO1              TO  PAYTO1O.
  9387     MOVE AL-UANON               TO  CARRIERA
  9388                                     GROUPA
  9389                                     STATEA
  9390                                     ACCTA
  9391                                     CERTNOA
  9392                                     SFXA
  9393                                     PAYTO1A
  9394                                     PAYTO2A
  9395*                                    AMOUNTA
  9396*                                    TYPEA
  9397                                     rettoa
  9398                                     payeea.
  9399     move al-panon               to typea
  9400     move al-panon               to amounta
  9401     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  9402     MOVE ' '                    TO  DC-OPTION-CODE.
  9403     PERFORM 8500-DATE-CONVERT.
  9404     IF NO-CONVERSION-ERROR
  9405         MOVE DC-GREG-DATE-1-EDIT TO  EFFDTI
  9406         MOVE AL-UANON            TO  EFFDTA
  9407         MOVE 'Y'                 TO  PI-PROCESS-CERT-SW
  9408         PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT
  9409     ELSE
  9410         GO TO 8200-SEND-DATAONLY.
  9411     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9412         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 170
* EL677.cbl
  9413         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
  9414     ELSE
  9415         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9416         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9417     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9418     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9419     move spaces to pi-insured-name
  9420     string cm-insured-last-name ' '
  9421            cm-insured-first-name delimited by '  '
  9422        into pi-insured-name
  9423     end-string
  9424     move spaces                 to pi-table-name
  9425     string cm-insured-last-name ', '
  9426            cm-insured-first-name ' '
  9427            cm-insured-initial2
  9428        delimited by '  '
  9429        into
  9430           pi-table-name
  9431     end-string
  9432*    MOVE WS-NAME-WORK           TO PI-INSURED-NAME.
  9433     if eibaid = dfhpf5
  9434        move 'Y'                 to dedcyni
  9435        move al-uanon            to dedcyna
  9436     end-if
  9437    compute ws-tot-lf-prem = cm-lf-premium-amt +
  9438       cm-lf-alt-premium-amt
  9439    compute ws-tot-iss-prem  =
  9440       cm-ah-premium-amt + ws-tot-lf-prem
  9441    compute ws-tot-iss-comm =
  9442       (ws-tot-lf-prem * cm-life-comm-pct) +
  9443       (cm-ah-premium-amt * cm-ah-comm-pct)
  9444    compute ws-tot-ref-comm =
  9445       (pi-lf-refund * cm-life-comm-pct) +
  9446       (pi-ah-refund * cm-ah-comm-pct)
  9447     move ws-tot-iss-prem        to premo
  9448     move ws-tot-iss-comm        to isscommo
  9449     move al-sadof               to drefa
  9450                                    refa
  9451*    compute refo = pi-lf-refund + pi-ah-refund
  9452     move pi-prev-paid            to prepdo
  9453     move ws-tot-ref-comm         to uecommo
  9454                                     pi-ue-comm
  9455***  compute ws-refund-amount = pi-refund-on-pending-rec -
  9456***     pi-prev-paid
  9457     compute ws-refund-amount =
  9458        pi-refund-on-pending-rec - pi-prev-paid-this-month
  9459     if (pi-refund-on-pending-rec + pi-prev-paid) >
  9460        ws-tot-iss-prem
  9461        move zeros               to ws-refund-amount
  9462     end-if
  9463     if ((dedcyni = 'Y')
  9464        or (pi-prev-ded-comm = 'Y'))
  9465        and (ws-refund-amount >= ws-tot-ref-comm)
  9466        compute ws-refund-amount = ws-refund-amount -
  9467           ws-tot-ref-comm
  9468     end-if
  9469     if pi-check-type = 'C'
  9470*       move pi-endt-prm-diff    to refo
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 171
* EL677.cbl
  9471        move pi-endt-com-diff    to uecommo
  9472                                    pi-ue-comm
  9473        compute ws-refund-amount =
  9474           pi-endt-prm-diff - pi-prev-paid
  9475        if (dedcyni = 'Y')
  9476           or (pi-prev-ded-comm = 'Y')
  9477           compute ws-refund-amount = ws-refund-amount -
  9478              pi-endt-com-diff
  9479        end-if
  9480        if ws-refund-amount <= zeros
  9481           move pi-endt-prm-diff to ws-refund-amount
  9482        end-if
  9483     end-if
  9484     if not WS-CERT-NOT-FOUND
  9485        string
  9486           pi-cert-prime         ' : '
  9487           cm-insured-last-name  ', '
  9488           cm-insured-first-name ' : '
  9489           pi-account            ' : '
  9490           pi-am-csr delimited by '  ' into text1o
  9491        end-string
  9492        move al-uanon            to text1a
  9493        MOVE 'REF'               TO WS-USER-REASON
  9494        if pi-check-type = 'C'
  9495           move 'COR'            to ws-user-reason
  9496        end-if
  9497        MOVE pi-cert-no          TO WS-USER-CERT-NO
  9498        inspect ws-user-cert-no replacing leading zeros
  9499           by spaces
  9500        move pi-insured-name     to ws-user-name
  9501        perform varying s1 from +1 by +1 until
  9502           (s1 > +11)
  9503           or (ws-user-cert-no (s1:1)) <> ' '
  9504        end-perform
  9505        string ws-user-reason  ' ' delimited by size
  9506               ws-user-cert-no (s1:11 - s1 + 1) ' '
  9507                  delimited by size
  9508               cm-insured-last-name ' '
  9509               cm-insured-first-name delimited by '  '
  9510           into stubo
  9511        end-string
  9512        move al-uanon            to stuba
  9513     end-if
  9514     .
  9515 6700-exit.
  9516     exit.
  9517 6800-browse-previous-chek-recs.
  9518***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9519***                                                            ***
  9520**** this should be the first time through, we need to gather  ***
  9521**** all the erchek records for this pending record, add the   ***
  9522**** amounts and make sure this check request will not exceed  ***
  9523**** the collected premium                                     ***
  9524***                                                            ***
  9525***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9526     move zeros                  to pi-prev-paid
  9527                                    pi-prev-paid-this-month
  9528                                    ws-browse-sw
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 172
* EL677.cbl
  9529                                    pi-chek-rec-cnt
  9530     move spaces                 to pi-prev-ded-comm
  9531     move pi-company-cd          to chek-company-cd
  9532     move pi-carrier             to chek-carrier
  9533     move pi-grouping            to chek-grouping
  9534     move pi-state               to chek-state
  9535     move pi-account             to chek-account
  9536     move pi-cert-prime          to chek-cert-no
  9537     move pi-cert-sfx            to chek-suf-no
  9538     move pi-cert-eff-dt         to chek-eff-dt
  9539     move +0                     to chek-record-seq
  9540     move erchek-key             to ws-compare-erchek-key
  9541
  9542* EXEC CICS STARTBR
  9543*       DATASET  (ERCHEK-FILE-ID)
  9544*       RIDFLD   (ERCHEK-KEY)
  9545*       resp     (ws-response)
  9546*    END-EXEC
  9547     MOVE 0
  9548       TO DFHEIV11
  9549*    MOVE '&,         G          &  N#00008753' TO DFHEIV0
  9550     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9551     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9552     MOVE X'204E233030303038373533' TO DFHEIV0(25:11)
  9553     CALL 'kxdfhei1' USING DFHEIV0,
  9554           ERCHEK-FILE-ID,
  9555           ERCHEK-KEY,
  9556           DFHEIV99,
  9557           DFHEIV11,
  9558           DFHEIV99
  9559     MOVE EIBRESP  TO ws-response
  9560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9561     if not resp-normal
  9562        go to 6800-exit
  9563     end-if
  9564     perform until i-say-when
  9565
  9566* EXEC CICS READNEXT
  9567*          DATASET   (ERCHEK-FILE-ID)
  9568*          SET       (ADDRESS OF CHECK-RECORDS)
  9569*          RIDFLD    (ERCHEK-KEY)
  9570*          resp      (ws-response)
  9571*       END-EXEC
  9572     MOVE 0
  9573       TO DFHEIV11
  9574*    MOVE '&.S                   )  N#00008762' TO DFHEIV0
  9575     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9576     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9577     MOVE X'204E233030303038373632' TO DFHEIV0(25:11)
  9578     CALL 'kxdfhei1' USING DFHEIV0,
  9579           ERCHEK-FILE-ID,
  9580           DFHEIV20,
  9581           DFHEIV99,
  9582           ERCHEK-KEY,
  9583           DFHEIV99,
  9584           DFHEIV11,
  9585           DFHEIV99,
  9586           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 173
* EL677.cbl
  9587     SET ADDRESS OF CHECK-RECORDS TO
  9588         DFHEIV20
  9589     MOVE EIBRESP  TO ws-response
  9590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9591        if resp-normal
  9592           and erchek-key (1:33) = ws-compare-erchek-key
  9593           if (ch-void-dt = low-values)
  9594              and (not ch-denied)
  9595              if pi-check-type = 'R'
  9596                 and ch-check-origin-sw = 'C'
  9597                 continue
  9598              else
  9599                 compute pi-prev-paid = pi-prev-paid +
  9600                    ch-amount-paid
  9601                 add +1 to pi-chek-rec-cnt
  9602                 move ch-deduct-commission
  9603                                 to pi-prev-ded-comm
  9604                 if ch-credit-select-dt = pi-cr-month-end-dt
  9605                    compute pi-prev-paid-this-month =
  9606                       pi-prev-paid-this-month + ch-amount-paid
  9607                 end-if
  9608              end-if
  9609           end-if
  9610        else
  9611           set i-say-when to true
  9612        end-if
  9613     end-perform
  9614     .
  9615 6800-exit.
  9616     exit.
  9617 7000-SET-PI-AREA.
  9618     MOVE CARRIERI               TO  PI-CARRIER
  9619                                     PI-CHEK-CARRIER.
  9620     MOVE GROUPI                 TO  PI-GROUPING
  9621                                     PI-CHEK-GROUPING.
  9622     MOVE STATEI                 TO  PI-STATE
  9623                                     PI-CHEK-STATE.
  9624     MOVE ACCTI                  TO  PI-ACCOUNT
  9625                                     PI-CHEK-ACCOUNT.
  9626     MOVE CERTNOI                TO  PI-CERT-PRIME
  9627                                     PI-CHEK-CERT-NO.
  9628     IF SFXI NOT = LOW-VALUES
  9629         MOVE SFXI               TO  PI-CERT-SFX
  9630                                     PI-CHEK-SUF-NO
  9631     ELSE
  9632         MOVE SPACE              TO  PI-CERT-SFX
  9633                                     PI-CHEK-SUF-NO.
  9634
  9635     MOVE EFFDTI                 TO  DC-GREG-DATE-1-EDIT.
  9636     MOVE '2'                    TO  DC-OPTION-CODE.
  9637     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9638     IF DATE-CONVERSION-ERROR
  9639         MOVE ER-0215            TO  EMI-ERROR
  9640         MOVE -1                 TO  EFFDTL
  9641         MOVE AL-UNBON           TO  EFFDTA
  9642         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9643         GO TO 8200-SEND-DATAONLY
  9644     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 174
* EL677.cbl
  9645         MOVE DC-BIN-DATE-1      TO  PI-CERT-EFF-DT
  9646                                     PI-CHEK-EFF-DT.
  9647
  9648 7090-EXIT.
  9649      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 175
* EL677.cbl
  9651 7100-CREATE-TEMP-STORAGE.
  9652     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9653
  9654
  9655* EXEC CICS WRITEQ TS
  9656*        QUEUE   (QID)
  9657*        FROM    (PROGRAM-INTERFACE-BLOCK)
  9658*        LENGTH  (PI-COMM-LENGTH)
  9659*    END-EXEC.
  9660*    MOVE '*"     L              ''   #00008831' TO DFHEIV0
  9661     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  9662     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9663     MOVE X'2020233030303038383331' TO DFHEIV0(25:11)
  9664     CALL 'kxdfhei1' USING DFHEIV0,
  9665           QID,
  9666           PROGRAM-INTERFACE-BLOCK,
  9667           PI-COMM-LENGTH,
  9668           DFHEIV99,
  9669           DFHEIV99,
  9670           DFHEIV99
  9671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9672
  9673
  9674 7100-EXIT.
  9675      EXIT.
  9676
  9677 7200-RECOVER-TEMP-STORAGE.
  9678
  9679* EXEC CICS READQ TS
  9680*        QUEUE   (QID)
  9681*        INTO    (PROGRAM-INTERFACE-BLOCK)
  9682*        LENGTH  (PI-COMM-LENGTH)
  9683*    END-EXEC.
  9684*    MOVE '*$I    L              ''   #00008841' TO DFHEIV0
  9685     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9686     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9687     MOVE X'2020233030303038383431' TO DFHEIV0(25:11)
  9688     CALL 'kxdfhei1' USING DFHEIV0,
  9689           QID,
  9690           PROGRAM-INTERFACE-BLOCK,
  9691           PI-COMM-LENGTH,
  9692           DFHEIV99,
  9693           DFHEIV99,
  9694           DFHEIV99
  9695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9696
  9697
  9698     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9699
  9700 7200-EXIT.
  9701      EXIT.
  9702
  9703 7300-DELETE-TEMP-STORAGE.
  9704
  9705* EXEC CICS HANDLE CONDITION
  9706*        QIDERR  (7300-EXIT)
  9707*    END-EXEC.
  9708*    MOVE '"$N                   ! 1 #00008853' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 176
* EL677.cbl
  9709     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9710     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9711     MOVE X'3120233030303038383533' TO DFHEIV0(25:11)
  9712     CALL 'kxdfhei1' USING DFHEIV0
  9713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9714
  9715
  9716
  9717* EXEC CICS DELETEQ TS
  9718*        QUEUE  (QID)
  9719*    END-EXEC.
  9720*    MOVE '*&                    #   #00008857' TO DFHEIV0
  9721     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9722     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9723     MOVE X'2020233030303038383537' TO DFHEIV0(25:11)
  9724     CALL 'kxdfhei1' USING DFHEIV0,
  9725           QID,
  9726           DFHEIV99
  9727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9728
  9729
  9730 7300-EXIT.
  9731      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 177
* EL677.cbl
  9733 7500-reissue-pass-1.
  9734
  9735     move '2'                    to pi-void-reissue-pass
  9736
  9737     move pi-void-reissue-amt    to amounto
  9738
  9739     if eibaid = dfhpf5
  9740        MOVE PI-AM-NAME          TO PAYTO1I
  9741        MOVE SPACES              TO PAYTO2I
  9742        MOVE PI-AM-ADDRS         TO PAYAD1I
  9743        MOVE PI-AM-CITY          TO PAYCTYI
  9744        move pi-am-st            to paysti
  9745        MOVE PI-AM-ZIP-CODE      TO PTOZIPI
  9746        move 'ACCT'              to payeeo
  9747        move al-panon            to payeea
  9748
  9749        MOVE AL-UANON            TO PAYTO1A
  9750                                    PAYTO2A
  9751                                    PAYAD1A
  9752                                    PAYCTYA
  9753                                    paysta
  9754                                    PTOZIPA
  9755                                    payeea
  9756        GO TO 8100-SEND-INITIAL-MAP
  9757     end-if
  9758
  9759     perform 5700-get-elcert     thru 5700-exit
  9760     move spaces                 to pi-table-name
  9761     string cm-insured-last-name ', '
  9762            cm-insured-first-name ' '
  9763            cm-insured-initial2
  9764        delimited by '  '
  9765        into
  9766           pi-table-name
  9767     end-string
  9768
  9769     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9770         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
  9771         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
  9772     ELSE
  9773         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9774         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9775
  9776     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9777
  9778     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9779
  9780     if eibaid = dfhpf7
  9781
  9782* EXEC CICS READ
  9783*           DATASET   (ERMAIL-FILE-ID)
  9784*           SET       (ADDRESS OF MAILING-DATA)
  9785*           RIDFLD    (ELCERT-KEY)
  9786*           resp      (ws-response)
  9787*       END-EXEC
  9788*    MOVE '&"S        E          (  N#00008912' TO DFHEIV0
  9789     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9790     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 178
* EL677.cbl
  9791     MOVE X'204E233030303038393132' TO DFHEIV0(25:11)
  9792     CALL 'kxdfhei1' USING DFHEIV0,
  9793           ERMAIL-FILE-ID,
  9794           DFHEIV20,
  9795           DFHEIV99,
  9796           ELCERT-KEY,
  9797           DFHEIV99,
  9798           DFHEIV99,
  9799           DFHEIV99
  9800     SET ADDRESS OF MAILING-DATA TO
  9801         DFHEIV20
  9802     MOVE EIBRESP  TO ws-response
  9803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9804        if resp-normal
  9805           move spaces             to payto2i
  9806           move ma-cred-bene-name  to payto1i
  9807           MOVE MA-cred-bene-addr  TO PAYad1I
  9808           MOVE MA-cred-bene-addr2 TO PAYad2I
  9809           move ma-cred-bene-city  to payctyi
  9810           move ma-cred-bene-state to paysti
  9811           MOVE MA-cred-bene-zip   TO PTOZIPI
  9812           move 'BENE'              to payeeo
  9813           MOVE AL-UANON           TO payto1a
  9814                                      PAYTO2A
  9815                                      PAYad1A
  9816                                      payad2a
  9817                                      PAYctyA
  9818                                      paysta
  9819                                      PTOZIPA
  9820                                      payeea
  9821        end-if
  9822     end-if
  9823
  9824     if eibaid = dfhpf6
  9825
  9826* EXEC CICS READ
  9827*           DATASET   (ERMAIL-FILE-ID)
  9828*           SET       (ADDRESS OF MAILING-DATA)
  9829*           RIDFLD    (ELCERT-KEY)
  9830*           resp      (ws-response)
  9831*       END-EXEC
  9832*    MOVE '&"S        E          (  N#00008939' TO DFHEIV0
  9833     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9834     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9835     MOVE X'204E233030303038393339' TO DFHEIV0(25:11)
  9836     CALL 'kxdfhei1' USING DFHEIV0,
  9837           ERMAIL-FILE-ID,
  9838           DFHEIV20,
  9839           DFHEIV99,
  9840           ELCERT-KEY,
  9841           DFHEIV99,
  9842           DFHEIV99,
  9843           DFHEIV99
  9844     SET ADDRESS OF MAILING-DATA TO
  9845         DFHEIV20
  9846     MOVE EIBRESP  TO ws-response
  9847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9848        if resp-normal
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 179
* EL677.cbl
  9849           move spaces            to payto2i
  9850           move ws-name-work      to payto1i
  9851           MOVE MA-ADDRESS-LINE-1 TO PAYAD1I
  9852           MOVE MA-ADDRESS-LINE-2 TO PAYAD2I
  9853           move ma-city           to payctyi
  9854           move ma-addr-state     to paysti
  9855           move 'INS'             to payeeo
  9856           MOVE MA-ZIP            TO PTOZIPI
  9857           MOVE AL-UANON          TO PAYAD1A
  9858                                     PAYAD2A
  9859                                     PAYctyA
  9860                                     paysta
  9861                                     PTOZIPA
  9862                                     payto1a
  9863                                     payeea
  9864        end-if
  9865     end-if
  9866
  9867     GO TO 8100-SEND-INITIAL-MAP
  9868
  9869     .
  9870 7500-exit.
  9871     exit.
  9872
  9873 7510-reissue-pass-2.
  9874
  9875
  9876* EXEC CICS READ
  9877*        DATASET  (ERCHEK-FILE-ID)
  9878*        SET      (ADDRESS OF CHECK-RECORDS)
  9879*        RIDFLD   (PI-ERCHEK-KEY)
  9880*        resp     (ws-response)
  9881*    END-EXEC
  9882*    MOVE '&"S        E          (  N#00008972' TO DFHEIV0
  9883     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9884     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9885     MOVE X'204E233030303038393732' TO DFHEIV0(25:11)
  9886     CALL 'kxdfhei1' USING DFHEIV0,
  9887           ERCHEK-FILE-ID,
  9888           DFHEIV20,
  9889           DFHEIV99,
  9890           PI-ERCHEK-KEY,
  9891           DFHEIV99,
  9892           DFHEIV99,
  9893           DFHEIV99
  9894     SET ADDRESS OF CHECK-RECORDS TO
  9895         DFHEIV20
  9896     MOVE EIBRESP  TO ws-response
  9897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9898     display ' after read ' ws-response ' ' pi-erchek-key (2:19)
  9899     ' ' pi-erchek-key (22:11) ' ' pi-chek-sequence
  9900
  9901     if not resp-normal
  9902        go to 7510-exit
  9903     end-if
  9904
  9905     if ch-void-dt not = save-bin-date
  9906        display ' something went wrong here '
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 180
* EL677.cbl
  9907        go to 7510-exit
  9908     end-if
  9909
  9910     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS
  9911     MOVE save-bin-date          TO CH-RECORDED-DT
  9912                                    ch-released-dt
  9913     move pi-processor-id        to ch-recorded-by
  9914                                    ch-released-by
  9915     move spaces                 to ch-check-no
  9916                                    ch-void-by
  9917                                    ch-void-reason
  9918                                    ch-approved-by
  9919
  9920
  9921     move 'P'                    to ch-approval-status
  9922
  9923     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  9924                                    CH-VOID-DT
  9925                                    CH-CREDIT-ACCEPT-DT
  9926                                    ch-approval-dt
  9927                                    ch-check-cashed-dt
  9928     add +1 to ch-sequence-no
  9929     if ch-check-origin-sw = 'R'
  9930        move 'R'                 to pi-check-type
  9931     else
  9932        move 'C'                 to pi-check-type
  9933     end-if
  9934
  9935     .
  9936 7510-WRITE-RECORD.
  9937
  9938
  9939* exec cics read
  9940*       dataset    (erchek-file-id)
  9941*       into       (ws-dummy-erchek)
  9942*       ridfld     (ch-control-primary)
  9943*       resp       (ws-response)
  9944*    end-exec
  9945     MOVE LENGTH OF
  9946      ws-dummy-erchek
  9947       TO DFHEIV11
  9948*    MOVE '&"IL       E          (  N#00009018' TO DFHEIV0
  9949     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9950     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9951     MOVE X'204E233030303039303138' TO DFHEIV0(25:11)
  9952     CALL 'kxdfhei1' USING DFHEIV0,
  9953           erchek-file-id,
  9954           ws-dummy-erchek,
  9955           DFHEIV11,
  9956           ch-control-primary,
  9957           DFHEIV99,
  9958           DFHEIV99,
  9959           DFHEIV99
  9960     MOVE EIBRESP  TO ws-response
  9961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9962     display ' after read ' ws-response
  9963     if RESP-NOTFND
  9964        continue
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 181
* EL677.cbl
  9965     else
  9966        add +1                   to ch-sequence-no
  9967        add 1                    to seqi
  9968        go to 7510-write-record
  9969     end-if
  9970
  9971     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  9972     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  9973                                    CH-CHECK-QUE-SEQUENCE
  9974
  9975     IF PAYTO1L NOT = ZEROS
  9976        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  9977     END-IF
  9978     IF PAYTO2L NOT = ZEROS
  9979        MOVE PAYTO2I             TO CH-PAYEE-NAME-2
  9980     end-if
  9981     IF PAYAD1L NOT = ZEROS
  9982        MOVE PAYAD1I             TO CH-PAYEE-ADDRESS-1
  9983     end-if
  9984     IF PAYAD2L NOT = ZEROS
  9985        MOVE PAYAD2I             TO CH-PAYEE-ADDRESS-2
  9986     end-if
  9987     IF PAYctyL NOT = ZEROS
  9988        MOVE payctyi             TO CH-PAYEE-CITY
  9989     end-if
  9990     IF PAYstL NOT = ZEROS
  9991        MOVE paysti              TO CH-PAYEE-state
  9992     end-if
  9993     IF PAYEEI GREATER SPACES
  9994        mOVE PAYEEI               TO CH-PAYEE-CODE
  9995     end-if
  9996     IF PTOZIPL  =  ZEROS
  9997        MOVE ZEROS               TO CH-PAYEE-ZIP-CODE
  9998     else
  9999        MOVE PTOZIPI             TO WS-ZIP-CODE
 10000        IF NOT WS-CANADIAN-POST-CODE
 10001           MOVE WS-ZIP-PRIME     TO CH-PAYEE-ZIP
 10002           MOVE WS-ZIP-PLUS4     TO CH-PAYEE-ZIP-EXT
 10003        end-if
 10004     end-if
 10005
 10006     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
 10007     display ' back from 2700- '
 10008
 10009
 10010* EXEC CICS WRITE
 10011*        DATASET  (ERCHEK-FILE-ID)
 10012*        FROM     (CHECK-RECORDS)
 10013*        RIDFLD   (CH-CONTROL-PRIMARY)
 10014*        resp     (ws-response)
 10015*    END-EXEC.
 10016     MOVE LENGTH OF
 10017      CHECK-RECORDS
 10018       TO DFHEIV11
 10019*    MOVE '&$ L                  ''  N#00009071' TO DFHEIV0
 10020     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10021     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10022     MOVE X'204E233030303039303731' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 182
* EL677.cbl
 10023     CALL 'kxdfhei1' USING DFHEIV0,
 10024           ERCHEK-FILE-ID,
 10025           CHECK-RECORDS,
 10026           DFHEIV11,
 10027           CH-CONTROL-PRIMARY,
 10028           DFHEIV99,
 10029           DFHEIV99
 10030     MOVE EIBRESP  TO ws-response
 10031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10032
 10033     display ' after write ' ws-response
 10034     COMPUTE WS-JOURNAL-RECORD-LENGTH =
 10035             ERCHEK-RECORD-LENGTH + 23.
 10036
 10037     IF EMI-NO-ERRORS
 10038        MOVE ER-0000             TO EMI-ERROR
 10039     ELSE
 10040        IF EMI-FORCABLE-CTR GREATER THAN +0  AND
 10041           EIBAID = DFHPF4
 10042           MOVE ER-2600          TO EMI-ERROR
 10043        end-if
 10044     end-if
 10045
 10046     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10047
 10048     MOVE LOW-VALUES             TO EL677AI.
 10049
 10050     MOVE PI-CHEK-CARRIER        TO CARRIERO.
 10051     MOVE PI-CHEK-GROUPING       TO GROUPO.
 10052     MOVE PI-CHEK-STATE          TO STATEO.
 10053     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
 10054
 10055     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
 10056     MOVE SPACE                  TO DC-OPTION-CODE.
 10057     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10058     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
 10059
 10060     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
 10061     MOVE PI-CHEK-SUF-NO         TO SFXO.
 10062     MOVE PI-CHEK-SEQUENCE       TO SEQO.
 10063
 10064     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
 10065                                    ACCTA     EFFDTA  CERTNOA
 10066                                    SFXA.
 10067     MOVE AL-UNNON               TO SEQA
 10068     move ' ' to pi-void-reissue-pass
 10069     go to 5000-browse-file
 10070
 10071     .
 10072 7510-exit.
 10073     exit.
 10074 8100-SEND-INITIAL-MAP.
 10075     MOVE SAVE-DATE              TO  DATEO.
 10076     MOVE EIBTIME                TO  TIME-IN.
 10077     MOVE TIME-OUT               TO  TIMEO.
 10078     MOVE -1                     TO  MAINTL
 10079     move al-uanon               to mainta
 10080     move dedcyni                to pi-previous-deduct-comm
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 183
* EL677.cbl
 10081     if (PI-TO-EL677-FROM-EL1273)
 10082        and (pi-void-reissue-pass = ' ')
 10083        move al-sadof            to pf3a
 10084                                    pf4a
 10085                                    pf57a
 10086                                    pf6a
 10087                                    dprema
 10088                                    dcomma
 10089                                    drefa
 10090                                    duecomma
 10091                                    dprepda
 10092                                    prema
 10093                                    isscomma
 10094                                    refa
 10095                                    uecomma
 10096                                    prepda
 10097        move ', VOID(V)'         to dmaint1o
 10098        move 'VOID & REISSUE(R), DELETE(D)'
 10099                                 TO dmaint2o
 10100     end-if
 10101     if (pi-to-el677-from-el1273)
 10102        and (pi-void-reissue-pass = '1')
 10103        move al-sadof            to pf3a
 10104                                    pf4a
 10105                                    dprema
 10106                                    dcomma
 10107                                    drefa
 10108                                    duecomma
 10109                                    dprepda
 10110                                    prema
 10111                                    isscomma
 10112                                    refa
 10113                                    uecomma
 10114                                    prepda
 10115        move ', VOID(V)'         to dmaint1o
 10116        move 'VOID AND REISSUE(R)'
 10117                                 TO dmaint2o
 10118     end-if
 10119     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10120     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10121
 10122
 10123* EXEC CICS SEND
 10124*        MAP      (EL677A)
 10125*        MAPSET   (MAPSET-NAME)
 10126*        FROM     (EL677AO)
 10127*        ERASE
 10128*        CURSOR
 10129*    END-EXEC.
 10130     MOVE LENGTH OF
 10131      EL677AO
 10132       TO DFHEIV12
 10133     MOVE -1
 10134       TO DFHEIV11
 10135*    MOVE '8$     CT  E    H L F ,   #00009166' TO DFHEIV0
 10136     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10137     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10138     MOVE X'2020233030303039313636' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 184
* EL677.cbl
 10139     CALL 'kxdfhei1' USING DFHEIV0,
 10140           EL677A,
 10141           EL677AO,
 10142           DFHEIV12,
 10143           MAPSET-NAME,
 10144           DFHEIV99,
 10145           DFHEIV99,
 10146           DFHEIV99,
 10147           DFHEIV11,
 10148           DFHEIV99,
 10149           DFHEIV99,
 10150           DFHEIV99
 10151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10152
 10153
 10154     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 185
* EL677.cbl
 10156 8200-SEND-DATAONLY.
 10157     if connected-to-db
 10158        perform 4300-FINISH-UP-DB thru 4300-exit
 10159     end-if
 10160     MOVE SAVE-DATE              TO  DATEO.
 10161     MOVE EIBTIME                TO  TIME-IN.
 10162     MOVE TIME-OUT               TO  TIMEO.
 10163     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10164     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10165
 10166
 10167* EXEC CICS SEND
 10168*        MAP     (EL677A)
 10169*        MAPSET  (MAPSET-NAME)
 10170*        FROM    (EL677AO)
 10171*        DATAONLY
 10172*        CURSOR
 10173*    END-EXEC.
 10174     MOVE LENGTH OF
 10175      EL677AO
 10176       TO DFHEIV12
 10177     MOVE -1
 10178       TO DFHEIV11
 10179*    MOVE '8$D    CT       H L F ,   #00009186' TO DFHEIV0
 10180     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10181     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10182     MOVE X'2020233030303039313836' TO DFHEIV0(25:11)
 10183     CALL 'kxdfhei1' USING DFHEIV0,
 10184           EL677A,
 10185           EL677AO,
 10186           DFHEIV12,
 10187           MAPSET-NAME,
 10188           DFHEIV99,
 10189           DFHEIV99,
 10190           DFHEIV99,
 10191           DFHEIV11,
 10192           DFHEIV99,
 10193           DFHEIV99,
 10194           DFHEIV99
 10195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10196
 10197
 10198     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 186
* EL677.cbl
 10200 8300-SEND-TEXT.
 10201
 10202* EXEC CICS SEND TEXT
 10203*        FROM     (LOGOFF-TEXT)
 10204*        LENGTH   (LOGOFF-LENGTH)
 10205*        ERASE
 10206*        FREEKB
 10207*    END-EXEC.
 10208*    MOVE '8&      T  E F  H   F -   #00009197' TO DFHEIV0
 10209     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10210     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10211     MOVE X'2020233030303039313937' TO DFHEIV0(25:11)
 10212     CALL 'kxdfhei1' USING DFHEIV0,
 10213           LOGOFF-TEXT,
 10214           LOGOFF-LENGTH,
 10215           DFHEIV99,
 10216           DFHEIV99,
 10217           DFHEIV99,
 10218           DFHEIV99,
 10219           DFHEIV99,
 10220           DFHEIV99,
 10221           DFHEIV99,
 10222           DFHEIV99,
 10223           DFHEIV99,
 10224           DFHEIV99
 10225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10226
 10227
 10228
 10229* EXEC CICS RETURN
 10230*    END-EXEC.
 10231*    MOVE '.(                    ''   #00009204' TO DFHEIV0
 10232     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10233     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10234     MOVE X'2020233030303039323034' TO DFHEIV0(25:11)
 10235     CALL 'kxdfhei1' USING DFHEIV0,
 10236           DFHEIV99,
 10237           DFHEIV99,
 10238           DFHEIV99,
 10239           DFHEIV99,
 10240           DFHEIV99,
 10241           DFHEIV99
 10242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10243
 10244
 10245 8500-DATE-CONVERT.
 10246     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10247
 10248
 10249* EXEC CICS LINK
 10250*        PROGRAM    (PGM-NAME)
 10251*        COMMAREA   (DATE-CONVERSION-DATA)
 10252*        LENGTH     (DC-COMM-LENGTH)
 10253*    END-EXEC.
 10254*    MOVE '."C                   (   #00009210' TO DFHEIV0
 10255     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10256     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10257     MOVE X'2020233030303039323130' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 187
* EL677.cbl
 10258     CALL 'kxdfhei1' USING DFHEIV0,
 10259           PGM-NAME,
 10260           DATE-CONVERSION-DATA,
 10261           DC-COMM-LENGTH,
 10262           DFHEIV99,
 10263           DFHEIV99,
 10264           DFHEIV99,
 10265           DFHEIV99
 10266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10267
 10268
 10269 8500-EXIT.
 10270      EXIT.
 10271
 10272 8600-DEEDIT.
 10273
 10274* EXEC CICS BIF DEEDIT
 10275*        FIELD   (WS-DEEDIT-FIELD)
 10276*        LENGTH  (10)
 10277*    END-EXEC.
 10278     MOVE 10
 10279       TO DFHEIV11
 10280*    MOVE '@"L                   #   #00009220' TO DFHEIV0
 10281     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10282     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10283     MOVE X'2020233030303039323230' TO DFHEIV0(25:11)
 10284     CALL 'kxdfhei1' USING DFHEIV0,
 10285           WS-DEEDIT-FIELD,
 10286           DFHEIV11
 10287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10288
 10289
 10290 8600-EXIT.
 10291      EXIT.
 10292
 10293 8700-DEEDIT.
 10294
 10295* EXEC CICS BIF DEEDIT
 10296*        FIELD   (WS-DT-DEEDIT-FIELD)
 10297*        LENGTH  (10)
 10298*    END-EXEC.
 10299     MOVE 10
 10300       TO DFHEIV11
 10301*    MOVE '@"L                   #   #00009229' TO DFHEIV0
 10302     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10303     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10304     MOVE X'2020233030303039323239' TO DFHEIV0(25:11)
 10305     CALL 'kxdfhei1' USING DFHEIV0,
 10306           WS-DT-DEEDIT-FIELD,
 10307           DFHEIV11
 10308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10309
 10310
 10311 8700-EXIT.
 10312      EXIT.
 10313
 10314 8800-UNAUTHORIZED-ACCESS.
 10315     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 188
* EL677.cbl
 10316     GO TO 8300-SEND-TEXT.
 10317
 10318 8810-PF23.
 10319     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10320     MOVE XCTL-005               TO  PGM-NAME.
 10321     GO TO 9300-XCTL.
 10322
 10323
 10324 9100-RETURN-TRAN.
 10325     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10326     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10327
 10328* EXEC CICS RETURN
 10329*        TRANSID  (TRANS-ID)
 10330*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 10331*        LENGTH   (PI-COMM-LENGTH)
 10332*    END-EXEC.
 10333*    MOVE '.(CT                  ''   #00009250' TO DFHEIV0
 10334     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10335     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10336     MOVE X'2020233030303039323530' TO DFHEIV0(25:11)
 10337     CALL 'kxdfhei1' USING DFHEIV0,
 10338           TRANS-ID,
 10339           PROGRAM-INTERFACE-BLOCK,
 10340           PI-COMM-LENGTH,
 10341           DFHEIV99,
 10342           DFHEIV99,
 10343           DFHEIV99
 10344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10345
 10346
 10347
 10348* GOBACK.
 10349     MOVE '9%                    "   ' TO DFHEIV0
 10350     MOVE 'EL677' TO DFHEIV1
 10351     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10352     GOBACK.
 10353
 10354 9200-RETURN-MAIN-MENU.
 10355     MOVE XCTL-626               TO  PGM-NAME.
 10356     GO TO 9300-XCTL.
 10357
 10358 9300-XCTL.
 10359
 10360* EXEC CICS XCTL
 10361*        PROGRAM    (PGM-NAME)
 10362*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10363*        LENGTH     (PI-COMM-LENGTH)
 10364*    END-EXEC.
 10365*    MOVE '.$C                   %   #00009263' TO DFHEIV0
 10366     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10367     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10368     MOVE X'2020233030303039323633' TO DFHEIV0(25:11)
 10369     CALL 'kxdfhei1' USING DFHEIV0,
 10370           PGM-NAME,
 10371           PROGRAM-INTERFACE-BLOCK,
 10372           PI-COMM-LENGTH,
 10373           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 189
* EL677.cbl
 10374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10375
 10376
 10377 9400-CLEAR.
 10378     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10379     MOVE SPACES                 TO  PI-PFKEY.
 10380     GO TO 9300-XCTL.
 10381
 10382 9500-PF12.
 10383     MOVE XCTL-010               TO  PGM-NAME.
 10384     GO TO 9300-XCTL.
 10385
 10386 9600-PGMID-ERROR.
 10387
 10388* EXEC CICS HANDLE CONDITION
 10389*        PGMIDERR    (8300-SEND-TEXT)
 10390*    END-EXEC.
 10391*    MOVE '"$L                   ! 2 #00009279' TO DFHEIV0
 10392     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10393     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10394     MOVE X'3220233030303039323739' TO DFHEIV0(25:11)
 10395     CALL 'kxdfhei1' USING DFHEIV0
 10396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10397
 10398
 10399     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10400     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10401     MOVE XCTL-005               TO  PGM-NAME.
 10402     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10403     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10404
 10405     GO TO 9300-XCTL.
 10406
 10407 9900-ERROR-FORMAT.
 10408     IF NOT EMI-ERRORS-COMPLETE
 10409         MOVE LINK-001           TO  PGM-NAME
 10410
 10411* EXEC CICS LINK
 10412*            PROGRAM    (PGM-NAME)
 10413*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10414*            LENGTH     (EMI-COMM-LENGTH)
 10415*        END-EXEC.
 10416*    MOVE '."C                   (   #00009294' TO DFHEIV0
 10417     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10418     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10419     MOVE X'2020233030303039323934' TO DFHEIV0(25:11)
 10420     CALL 'kxdfhei1' USING DFHEIV0,
 10421           PGM-NAME,
 10422           ERROR-MESSAGE-INTERFACE-BLOCK,
 10423           EMI-COMM-LENGTH,
 10424           DFHEIV99,
 10425           DFHEIV99,
 10426           DFHEIV99,
 10427           DFHEIV99
 10428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10429
 10430
 10431 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 190
* EL677.cbl
 10432      EXIT.
 10433
 10434 9990-ABEND.
 10435     MOVE LINK-004               TO  PGM-NAME.
 10436     MOVE DFHEIBLK               TO  EMI-LINE1.
 10437
 10438* EXEC CICS LINK
 10439*        PROGRAM   (PGM-NAME)
 10440*        COMMAREA  (EMI-LINE1)
 10441*        LENGTH    (72)
 10442*    END-EXEC.
 10443     MOVE 72
 10444       TO DFHEIV11
 10445*    MOVE '."C                   (   #00009306' TO DFHEIV0
 10446     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10447     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10448     MOVE X'2020233030303039333036' TO DFHEIV0(25:11)
 10449     CALL 'kxdfhei1' USING DFHEIV0,
 10450           PGM-NAME,
 10451           EMI-LINE1,
 10452           DFHEIV11,
 10453           DFHEIV99,
 10454           DFHEIV99,
 10455           DFHEIV99,
 10456           DFHEIV99
 10457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10458
 10459
 10460     GO TO 8200-SEND-DATAONLY.
 10461
 10462 9995-SECURITY-VIOLATION.
 10463*                            COPY ELCSCTP.
 10464******************************************************************
 10465*                                                                *
 10466*                            ELCSCTP                             *
 10467*                            VMOD=2.001                          *
 10468*                                                                *
 10469*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10470******************************************************************
 10471
 10472
 10473     MOVE EIBDATE          TO SM-JUL-DATE.
 10474     MOVE EIBTRMID         TO SM-TERMID.
 10475     MOVE THIS-PGM         TO SM-PGM.
 10476     MOVE EIBTIME          TO TIME-IN.
 10477     MOVE TIME-OUT         TO SM-TIME.
 10478     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10479
 10480
 10481* EXEC CICS LINK
 10482*         PROGRAM  ('EL003')
 10483*         COMMAREA (SECURITY-MESSAGE)
 10484*         LENGTH   (80)
 10485*    END-EXEC.
 10486     MOVE 'EL003' TO DFHEIV1
 10487     MOVE 80
 10488       TO DFHEIV11
 10489*    MOVE '."C                   (   #00009332' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 191
* EL677.cbl
 10490     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10491     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10492     MOVE X'2020233030303039333332' TO DFHEIV0(25:11)
 10493     CALL 'kxdfhei1' USING DFHEIV0,
 10494           DFHEIV1,
 10495           SECURITY-MESSAGE,
 10496           DFHEIV11,
 10497           DFHEIV99,
 10498           DFHEIV99,
 10499           DFHEIV99,
 10500           DFHEIV99
 10501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10502
 10503
 10504******************************************************************
 10505
 10506
 10507 9995-EXIT.
 10508     EXIT.
 10509
 10510
 10511 9999-DFHBACK SECTION.
 10512     MOVE '9%                    "   ' TO DFHEIV0
 10513     MOVE 'EL677' TO DFHEIV1
 10514     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10515     GOBACK.
 10516 9999-DFHEXIT.
 10517     IF DFHEIGDJ EQUAL 0001
 10518         NEXT SENTENCE
 10519     ELSE IF DFHEIGDJ EQUAL 2
 10520         GO TO 9600-PGMID-ERROR,
 10521               9990-ABEND
 10522         DEPENDING ON DFHEIGDI
 10523     ELSE IF DFHEIGDJ EQUAL 3
 10524         GO TO 8100-SEND-INITIAL-MAP
 10525         DEPENDING ON DFHEIGDI
 10526     ELSE IF DFHEIGDJ EQUAL 4
 10527         GO TO 1290-NO-CARRIER
 10528         DEPENDING ON DFHEIGDI
 10529     ELSE IF DFHEIGDJ EQUAL 5
 10530         GO TO 1380-NO-STATE
 10531         DEPENDING ON DFHEIGDI
 10532     ELSE IF DFHEIGDJ EQUAL 6
 10533         GO TO 1480-ACCOUNT-INVALID,
 10534               1480-ACCOUNT-INVALID
 10535         DEPENDING ON DFHEIGDI
 10536     ELSE IF DFHEIGDJ EQUAL 7
 10537         GO TO 1590-EXIT
 10538         DEPENDING ON DFHEIGDI
 10539     ELSE IF DFHEIGDJ EQUAL 8
 10540         GO TO 2200-DUPREC
 10541         DEPENDING ON DFHEIGDI
 10542     ELSE IF DFHEIGDJ EQUAL 9
 10543         GO TO 3900-RECORD-NOTFND
 10544         DEPENDING ON DFHEIGDI
 10545     ELSE IF DFHEIGDJ EQUAL 10
 10546         GO TO 3287-DUPREC
 10547         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 10-Jan-19 14:50 Page 192
* EL677.cbl
 10548     ELSE IF DFHEIGDJ EQUAL 11
 10549         GO TO 3390-EXIT,
 10550               3390-EXIT
 10551         DEPENDING ON DFHEIGDI
 10552     ELSE IF DFHEIGDJ EQUAL 12
 10553         GO TO 5560-END-OF-FILE,
 10554               5560-END-OF-FILE
 10555         DEPENDING ON DFHEIGDI
 10556     ELSE IF DFHEIGDJ EQUAL 13
 10557         GO TO 6070-NO-COMP-MSTR
 10558         DEPENDING ON DFHEIGDI
 10559     ELSE IF DFHEIGDJ EQUAL 14
 10560         GO TO 6170-NO-CERTIFICATE
 10561         DEPENDING ON DFHEIGDI
 10562     ELSE IF DFHEIGDJ EQUAL 15
 10563         GO TO 6470-NO-ADDRESS
 10564         DEPENDING ON DFHEIGDI
 10565     ELSE IF DFHEIGDJ EQUAL 16
 10566         GO TO 6670-NO-beneficiary
 10567         DEPENDING ON DFHEIGDI
 10568     ELSE IF DFHEIGDJ EQUAL 17
 10569         GO TO 7300-EXIT
 10570         DEPENDING ON DFHEIGDI
 10571     ELSE IF DFHEIGDJ EQUAL 18
 10572         GO TO 8300-SEND-TEXT
 10573         DEPENDING ON DFHEIGDI.
 10574     MOVE '9%                    "   ' TO DFHEIV0
 10575     MOVE 'EL677' TO DFHEIV1
 10576     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10577     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      141500     Code:       38828
