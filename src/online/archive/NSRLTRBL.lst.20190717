* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page   1
* NSRLTRBL.cbl
* Options: int("NSRLTRBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRLTRBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRLTRBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "NSRLTRBL.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRLTRBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSREQLTR
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page   2
* NSRLTRBL.cbl
    14* 121802    2009122800001  PEMA  NEW PROGRAM
    15* 022212    2011120900003  AJRA  ADD AHL
    16* 031912    2011120900003  AJRA  ADD AHL CLAIM NO TO EXTRACT
    17* 020513    2011090100001  PEMA  CORRECT ISS WITH MULT &
    18* 020613    2012110800002  AJRA  ADD BUS TYPE (GPCD) TO NAPERSOFT
    19* 031116    2015110400001  TANA  ADD EL150D FIELDS
    20* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    21* 031319  IR2019031100002  TANA  Correct iss w/ letters with ???
    22******************************************************************
    23 ENVIRONMENT DIVISION.
    24 DATA DIVISION.
    25 working-storage section.
    26 01  DFH-START PIC X(04).
    27 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    28 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    29 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    30 77  S1                          PIC S999 COMP-3 VALUE +0.
    31 77  S2                          PIC S999 COMP-3 VALUE +0.
    32 77  S3                          PIC S999 COMP-3 VALUE +0.
    33 77  E1                          PIC S999 COMP-3 VALUE +0.
    34 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    35 77  M1                          PIC S999 COMP-3 VALUE +0.
    36 77  P1                          PIC S999 COMP-3 VALUE +0.
    37 77  WS-HOLD-KEY                 PIC X(20).
    38 77  WS-HOLD-S1                  PIC S999 COMP-3 VALUE +0.
    39 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    40 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    41 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    42 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    43 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    44 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    45 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    46 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    47 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    48 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    49     88  FOUND-BENE                  VALUE 'Y'.
    50 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    51 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    52 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    53 77  WS-CNTR                     pic s999 comp-3 value +0.
    54 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    55 77  WS-ACCUM-DAYS               PIC S9(5) COMP-3 VALUE +0.
    56 77  WS-ACCUM-AMT                PIC S9(9)V99 COMP-3 VALUE +0.
    57 77  WS-ACCUM-PD-BENS            PIC S999 COMP-3 VALUE +0.
    58 77  WS-PREV-CLM-TYPE            PIC X   VALUE ' '.
    59 77  WS-PREV-INS-TYPE            PIC X   VALUE ' '.
    60 77  WS-PREV-BEN-PER             PIC 99 VALUE ZEROS.
    61 77  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
    62     88  PDEF-FOUND                   VALUE 'Y'.
    63 77  wk1                         pic 999 value zeros.
    64 77  wk2                         pic 999 value zeros.
    65 77  WS-WORK-BEN-PCT             PIC S9V999 COMP-3 VALUE +0.
    66 77  WS-MAX-SUB                  PIC 9(4)    VALUE ZEROS.
    67 01  OUTPUT-SCREEN-WORK-AREA.
    68     05  OS-PREV-KEY.
    69         10  OS-PREV-CLM-TYPE        PIC X.
    70         10  OS-PREV-INS-TYPE        PIC X.
    71     05  WS-PD-BENS                  PIC 999 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page   3
* NSRLTRBL.cbl
    72     05  WS-COV-REM-BENS             PIC S999 VALUE ZEROS.
    73 01  WS-XML-WORK                 PIC X(2500)  VALUE SPACES.
    74 01 response-code         pic s9(8) comp.
    75 01 display-response      pic 9(8).
    76 01 bl-index              pic 9(8) comp.
    77 01 max-last-name         pic x(18).
    78 01 first-initial         pic x.
    79 01 name-in-range-flag    pic 9.
    80 01 max-entries           pic s9(8) comp value 100.
    81 01 lower-case    pic x(26) value
    82            "abcdefghijklmnopqrstuvwxyz".
    83 01 upper-case    pic x(26) value
    84            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
    85 01  W-Z-CONTROL-DATA.
    86     05  W-NUMBER-OF-COPIES  PIC  9(01).
    87     05  FILLER              PIC  X(01).
    88     05  W-DAYS-TO-FOLLOW-UP PIC  9(03).
    89     05  FILLER              PIC  X(01).
    90     05  W-DAYS-TO-RESEND-1  PIC  9(03).
    91     05  FILLER              PIC  X(01).
    92     05  W-FORM-TO-RESEND    PIC  X(04).
    93     05  FILLER              PIC  X(01).
    94     05  W-PROMPT-LETTER     PIC  X(01).
    95     05  FILLER              PIC  X(01).
    96     05  W-ENCLOSURE-CD      PIC  X(03).
    97     05  FILLER              PIC  X(1).
    98     05  W-AUTO-CLOSE-IND    PIC  X(1).
    99     05  FILLER              PIC  X(1).
   100     05  W-LETTER-TO-BENE    PIC  X(1).
   101 01  MISC.
   102     12  WS-RESPONSE             PIC S9(8)   COMP.
   103         88  RESP-NORMAL                  VALUE +00.
   104         88  RESP-NOTFND                  VALUE +13.
   105         88  RESP-DUPREC                  VALUE +14.
   106         88  RESP-DUPKEY                  VALUE +15.
   107         88  RESP-NOTOPEN                 VALUE +19.
   108         88  RESP-ENDFILE                 VALUE +20.
   109 01  WS-ELENCC-KEY.
   110     05  WS-ELENCC-COMPANY-CD    PIC X.
   111     05  WS-ELENCC-REC-TYPE      PIC X.
   112     05  WS-ELENCC-ENC-CODE      PIC X(5).
   113     05  F                       PIC X(09).
   114 01  WS-ELMSTR-KEY.
   115     05  WS-ELMSTR-COMPANY-CD    PIC X.
   116     05  WS-ELMSTR-CARRIER       PIC X.
   117     05  WS-ELMSTR-CLAIM-NO      PIC X(7).
   118     05  WS-ELMSTR-CERT-NO       PIC X(11).
   119 01  WS-ELTRLR-KEY.
   120     05  WS-ELTRLR-COMPANY-CD    PIC X.
   121     05  WS-ELTRLR-CARRIER       PIC X.
   122     05  WS-ELTRLR-CLAIM-NO      PIC X(7).
   123     05  WS-ELTRLR-CERT-NO       PIC X(11).
   124     05  WS-ELTRLR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   125 01  WS-ELCERT-KEY.
   126     05  WS-ELCERT-COMPANY-CD    PIC X.
   127     05  WS-ELCERT-CARRIER       PIC X.
   128     05  WS-ELCERT-GROUP         PIC X(6).
   129     05  WS-ELCERT-STATE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page   4
* NSRLTRBL.cbl
   130     05  WS-ELCERT-ACCOUNT       PIC X(10).
   131     05  WS-ELCERT-EFF-DT        PIC XX.
   132     05  WS-ELCERT-CERT-NO       PIC X(11).
   133 01  WS-ERACCT-KEY.
   134     05  WS-ERACCT-COMPANY-CD    PIC X.
   135     05  WS-ERACCT-CARRIER       PIC X.
   136     05  WS-ERACCT-GROUP         PIC X(6).
   137     05  WS-ERACCT-STATE         PIC XX.
   138     05  WS-ERACCT-ACCOUNT       PIC X(10).
   139     05  WS-ERACCT-EXP-DT        PIC XX.
   140     05  FILLER                  PIC XXXX.
   141 01  WS-ELBENE-KEY.
   142     05  WS-ELBENE-COMPANY-CD    PIC X.
   143     05  WS-ELBENE-REC-TYPE      PIC X.
   144     05  WS-ELBENE-BENE          PIC X(10).
   145 01  WS-ELLETR-KEY.
   146     05  WS-ELLETR-COMPANY-CD    PIC X.
   147     05  WS-ELLETR-LETTER-ID     PIC X(12).
   148     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   149 01  WS-ELCNTL-KEY.
   150     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   151     05  WS-ELCNTL-REC-TYPE      PIC X.
   152     05  WS-ELCNTL-GENL.
   153         10  FILLER              PIC XX  VALUE SPACES.
   154         10  WS-ELCNTL-BEN-CD    PIC XX.
   155     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   156 01  ACCESS-KEYS.
   157     12  ELCRTT-KEY.
   158         16  CRTT-COMP-CD            PIC X.
   159         16  CRTT-CARRIER            PIC X.
   160         16  CRTT-GROUPING           PIC X(6).
   161         16  CRTT-STATE              PIC XX.
   162         16  CRTT-ACCOUNT            PIC X(10).
   163         16  CRTT-EFF-DT             PIC XX.
   164         16  CRTT-CERT-NO            PIC X(11).
   165         16  CRTT-REC-TYPE           PIC X.
   166
   167 01  ERPDEF-KEY-SAVE             PIC X(18).
   168 01  ERPDEF-KEY.
   169     12  ERPDEF-COMPANY-CD       PIC X.
   170     12  ERPDEF-STATE            PIC XX.
   171     12  ERPDEF-PROD-CD          PIC XXX.
   172     12  F                       PIC X(7).
   173     12  ERPDEF-BEN-TYPE         PIC X.
   174     12  ERPDEF-BEN-CODE         PIC XX.
   175     12  ERPDEF-EXP-DT           PIC XX.
   176 01  TEXT-WORK-AREAS.
   177     05  WS-COV-TYPE             PIC X(4) VALUE SPACES.
   178 01  WS-UNSORTED-TABLE.
   179     12  WS-UNSRTD-TABLE   OCCURS 25 TIMES.
   180         16  WS-KEY.
   181             20  WS-CLM-TYPE     PIC X.
   182             20  WS-INS-TYPE     PIC X.
   183             20  WS-BEN-PER      PIC 99.
   184             20  WS-INC-DT       PIC XX.
   185         16  WS-EXCL-PER         PIC 999.
   186         16  WS-COV-ENDS         PIC 999.
   187         16  WS-ACC-PER          PIC 999.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page   5
* NSRLTRBL.cbl
   188         16  WS-MAX-BENS         PIC 999.
   189         16  WS-REC-MOS          PIC 99.
   190         16  WS-MAX-EXTEN        PIC 99.
   191         16  WS-STATUS           PIC X.
   192         16  WS-PD-THRU-DT       PIC XX.
   193         16  WS-CLAIM-NO         PIC X(7).
   194         16  WS-MAX-MOBEN        PIC S9(7)V99 COMP-3.
   195         16  WS-TOTAL-PAID       PIC S9(7)V99 COMP-3.
   196         16  WS-REM-BENS         PIC 999.
   197         16  WS-SORTED-SW        PIC X.
   198 01  WS-SORTED-TABLE.
   199     12  WS-SRTD-TABLE OCCURS 25 TIMES.
   200         16  WS-SRTD-KEY.
   201             20  WS-SRTD-CLM-TYPE PIC X.
   202             20  WS-SRTD-INS-TYPE PIC X.
   203             20  WS-SRTD-BEN-PER PIC 99.
   204             20  WS-SRTD-INC-DT  PIC XX.
   205         16  WS-SRTD-EXCL-PER    PIC 999.
   206         16  WS-SRTD-COV-ENDS    PIC 999.
   207         16  WS-SRTD-ACC-PER     PIC 999.
   208         16  WS-SRTD-MAX-BENS    PIC 999.
   209         16  WS-SRTD-REC-MOS     PIC 99.
   210         16  WS-SRTD-MAX-EXTEN   PIC 99.
   211         16  WS-SRTD-STATUS      PIC X.
   212         16  WS-SRTD-PD-THRU-DT  PIC XX.
   213         16  WS-SRTD-CLAIM-NO    PIC X(7).
   214         16  WS-SRTD-MAX-MOBEN   PIC S9(7)V99 COMP-3.
   215         16  WS-SRTD-TOTAL-PAID  PIC S9(7)V99 COMP-3.
   216         16  WS-SRTD-REM-BENS    PIC 999.
   217         16  WS-SRTD-SW          PIC X.
   218 01  SAVE-ACCOUNT-MASTER         PIC X(2000) VALUE SPACES.
   219*                                COPY ELCDATE.
   220******************************************************************
   221*                                                                *
   222*                                                                *
   223*                            ELCDATE.                            *
   224*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   225*                            VMOD=2.003
   226*                                                                *
   227*                                                                *
   228*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   229*                 LENGTH = 200                                   *
   230******************************************************************
   231
   232 01  DATE-CONVERSION-DATA.
   233     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   234     12  DC-OPTION-CODE                PIC X.
   235         88  BIN-TO-GREG                VALUE ' '.
   236         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   237         88  EDIT-GREG-TO-BIN           VALUE '2'.
   238         88  YMD-GREG-TO-BIN            VALUE '3'.
   239         88  MDY-GREG-TO-BIN            VALUE '4'.
   240         88  JULIAN-TO-BIN              VALUE '5'.
   241         88  BIN-PLUS-ELAPSED           VALUE '6'.
   242         88  FIND-CENTURY               VALUE '7'.
   243         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   244         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   245         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page   6
* NSRLTRBL.cbl
   246         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   247         88  JULIAN-TO-BIN-3            VALUE 'C'.
   248         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   249         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   250         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   251         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   252         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   253         88  CHECK-LEAP-YEAR            VALUE 'H'.
   254         88  BIN-3-TO-GREG              VALUE 'I'.
   255         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   256         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   257         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   258         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   259         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   260         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   261         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   262         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   263         88  THREE-CHARACTER-BIN
   264                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   265         88  GREGORIAN-TO-BIN
   266                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   267         88  BIN-TO-GREGORIAN
   268                  VALUES ' ' '1' 'I' '8' 'G'.
   269         88  JULIAN-TO-BINARY
   270                  VALUES '5' 'C' 'E' 'F'.
   271     12  DC-ERROR-CODE                 PIC X.
   272         88  NO-CONVERSION-ERROR        VALUE ' '.
   273         88  DATE-CONVERSION-ERROR
   274                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   275         88  DATE-IS-ZERO               VALUE '1'.
   276         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   277         88  DATE-IS-INVALID            VALUE '3'.
   278         88  DATE1-GREATER-DATE2        VALUE '4'.
   279         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   280         88  DATE-INVALID-OPTION        VALUE '9'.
   281         88  INVALID-CENTURY            VALUE 'A'.
   282         88  ONLY-CENTURY               VALUE 'B'.
   283         88  ONLY-LEAP-YEAR             VALUE 'C'.
   284         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   285     12  DC-END-OF-MONTH               PIC X.
   286         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   287     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   288         88  USE-NORMAL-PROCESS         VALUE ' '.
   289         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   290         88  ADJUST-UP-100-YRS          VALUE '2'.
   291     12  FILLER                        PIC X.
   292     12  DC-CONVERSION-DATES.
   293         16  DC-BIN-DATE-1             PIC XX.
   294         16  DC-BIN-DATE-2             PIC XX.
   295         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   296         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   297                       DC-GREG-DATE-1-EDIT.
   298             20  DC-EDIT1-MONTH        PIC 99.
   299             20  SLASH1-1              PIC X.
   300             20  DC-EDIT1-DAY          PIC 99.
   301             20  SLASH1-2              PIC X.
   302             20  DC-EDIT1-YEAR         PIC 99.
   303         16  DC-GREG-DATE-2-EDIT       PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page   7
* NSRLTRBL.cbl
   304         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   305                     DC-GREG-DATE-2-EDIT.
   306             20  DC-EDIT2-MONTH        PIC 99.
   307             20  SLASH2-1              PIC X.
   308             20  DC-EDIT2-DAY          PIC 99.
   309             20  SLASH2-2              PIC X.
   310             20  DC-EDIT2-YEAR         PIC 99.
   311         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   312         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   313                     DC-GREG-DATE-1-YMD.
   314             20  DC-YMD-YEAR           PIC 99.
   315             20  DC-YMD-MONTH          PIC 99.
   316             20  DC-YMD-DAY            PIC 99.
   317         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   318         16  DC-GREG-DATE-1-MDY-R REDEFINES
   319                      DC-GREG-DATE-1-MDY.
   320             20  DC-MDY-MONTH          PIC 99.
   321             20  DC-MDY-DAY            PIC 99.
   322             20  DC-MDY-YEAR           PIC 99.
   323         16  DC-GREG-DATE-1-ALPHA.
   324             20  DC-ALPHA-MONTH        PIC X(10).
   325             20  DC-ALPHA-DAY          PIC 99.
   326             20  FILLER                PIC XX.
   327             20  DC-ALPHA-CENTURY.
   328                 24 DC-ALPHA-CEN-N     PIC 99.
   329             20  DC-ALPHA-YEAR         PIC 99.
   330         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   331         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   332         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   333         16  DC-JULIAN-DATE            PIC 9(05).
   334         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   335                                       PIC 9(05).
   336         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   337             20  DC-JULIAN-YEAR        PIC 99.
   338             20  DC-JULIAN-DAYS        PIC 999.
   339         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   340         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   341         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   342     12  DATE-CONVERSION-VARIBLES.
   343         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   344         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   345             20  FILLER                PIC 9(3).
   346             20  HOLD-CEN-1-CCYY.
   347                 24  HOLD-CEN-1-CC     PIC 99.
   348                 24  HOLD-CEN-1-YY     PIC 99.
   349             20  HOLD-CEN-1-MO         PIC 99.
   350             20  HOLD-CEN-1-DA         PIC 99.
   351         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   352             20  HOLD-CEN-1-R-MO       PIC 99.
   353             20  HOLD-CEN-1-R-DA       PIC 99.
   354             20  HOLD-CEN-1-R-CCYY.
   355                 24  HOLD-CEN-1-R-CC   PIC 99.
   356                 24  HOLD-CEN-1-R-YY   PIC 99.
   357             20  FILLER                PIC 9(3).
   358         16  HOLD-CENTURY-1-X.
   359             20  FILLER                PIC X(3)  VALUE SPACES.
   360             20  HOLD-CEN-1-X-CCYY.
   361                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page   8
* NSRLTRBL.cbl
   362                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   363             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   364             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   365         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   366             20  HOLD-CEN-1-R-X-MO     PIC XX.
   367             20  HOLD-CEN-1-R-X-DA     PIC XX.
   368             20  HOLD-CEN-1-R-X-CCYY.
   369                 24  HOLD-CEN-1-R-X-CC PIC XX.
   370                 24  HOLD-CEN-1-R-X-YY PIC XX.
   371             20  FILLER                PIC XXX.
   372         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   373         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   374         16  DC-JULIAN-DATE-1          PIC 9(07).
   375         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   376             20  DC-JULIAN-1-CCYY.
   377                 24  DC-JULIAN-1-CC    PIC 99.
   378                 24  DC-JULIAN-1-YR    PIC 99.
   379             20  DC-JULIAN-DA-1        PIC 999.
   380         16  DC-JULIAN-DATE-2          PIC 9(07).
   381         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   382             20  DC-JULIAN-2-CCYY.
   383                 24  DC-JULIAN-2-CC    PIC 99.
   384                 24  DC-JULIAN-2-YR    PIC 99.
   385             20  DC-JULIAN-DA-2        PIC 999.
   386         16  DC-GREG-DATE-A-EDIT.
   387             20  DC-EDITA-MONTH        PIC 99.
   388             20  SLASHA-1              PIC X VALUE '/'.
   389             20  DC-EDITA-DAY          PIC 99.
   390             20  SLASHA-2              PIC X VALUE '/'.
   391             20  DC-EDITA-CCYY.
   392                 24  DC-EDITA-CENT     PIC 99.
   393                 24  DC-EDITA-YEAR     PIC 99.
   394         16  DC-GREG-DATE-B-EDIT.
   395             20  DC-EDITB-MONTH        PIC 99.
   396             20  SLASHB-1              PIC X VALUE '/'.
   397             20  DC-EDITB-DAY          PIC 99.
   398             20  SLASHB-2              PIC X VALUE '/'.
   399             20  DC-EDITB-CCYY.
   400                 24  DC-EDITB-CENT     PIC 99.
   401                 24  DC-EDITB-YEAR     PIC 99.
   402         16  DC-GREG-DATE-CYMD         PIC 9(08).
   403         16  DC-GREG-DATE-CYMD-R REDEFINES
   404                              DC-GREG-DATE-CYMD.
   405             20  DC-CYMD-CEN           PIC 99.
   406             20  DC-CYMD-YEAR          PIC 99.
   407             20  DC-CYMD-MONTH         PIC 99.
   408             20  DC-CYMD-DAY           PIC 99.
   409         16  DC-GREG-DATE-MDCY         PIC 9(08).
   410         16  DC-GREG-DATE-MDCY-R REDEFINES
   411                              DC-GREG-DATE-MDCY.
   412             20  DC-MDCY-MONTH         PIC 99.
   413             20  DC-MDCY-DAY           PIC 99.
   414             20  DC-MDCY-CEN           PIC 99.
   415             20  DC-MDCY-YEAR          PIC 99.
   416    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   417        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   418    12  DC-EL310-DATE                  PIC X(21).
   419    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page   9
* NSRLTRBL.cbl
   420*                                COPY ELCMSTR.
   421******************************************************************
   422*                                                                *
   423*                            ELCMSTR.                            *
   424*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   425*                            VMOD=2.012                          *
   426*                                                                *
   427*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   428*                                                                *
   429*   FILE TYPE = VSAM,KSDS                                        *
   430*   RECORD SIZE = 350  RECFORM = FIXED                           *
   431*                                                                *
   432*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   433*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   434*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   435*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   436*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   437*                                                 RKP=75,LEN=21  *
   438*                                                                *
   439*   **** NOTE ****                                               *
   440*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   441*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   442*                                                                *
   443*   LOG = YES                                                    *
   444*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   445******************************************************************
   446*                   C H A N G E   L O G
   447*
   448* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   449*-----------------------------------------------------------------
   450*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   451* EFFECTIVE    NUMBER
   452*-----------------------------------------------------------------
   453* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   454* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   455* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   456* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   457* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   458* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
   459* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   460******************************************************************
   461 01  CLAIM-MASTER.
   462     12  CL-RECORD-ID                PIC XX.
   463         88  VALID-CL-ID         VALUE 'CL'.
   464
   465     12  CL-CONTROL-PRIMARY.
   466         16  CL-COMPANY-CD           PIC X.
   467         16  CL-CARRIER              PIC X.
   468         16  CL-CLAIM-NO             PIC X(7).
   469         16  CL-CERT-NO.
   470             20  CL-CERT-PRIME       PIC X(10).
   471             20  CL-CERT-SFX         PIC X.
   472
   473     12  CL-CONTROL-BY-NAME.
   474         16  CL-COMPANY-CD-A1        PIC X.
   475         16  CL-INSURED-LAST-NAME    PIC X(15).
   476         16  CL-INSURED-NAME.
   477             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  10
* NSRLTRBL.cbl
   478             20  CL-INSURED-MID-INIT PIC X.
   479
   480     12  CL-CONTROL-BY-SSN.
   481         16  CL-COMPANY-CD-A2        PIC X.
   482         16  CL-SOC-SEC-NO.
   483             20  CL-SSN-STATE        PIC XX.
   484             20  CL-SSN-ACCOUNT      PIC X(6).
   485             20  CL-SSN-LN3          PIC X(3).
   486
   487     12  CL-CONTROL-BY-CERT-NO.
   488         16  CL-COMPANY-CD-A4        PIC X.
   489         16  CL-CERT-NO-A4.
   490             20  CL-CERT-A4-PRIME    PIC X(10).
   491             20  CL-CERT-A4-SFX      PIC X.
   492
   493     12  CL-CONTROL-BY-CCN.
   494         16  CL-COMPANY-CD-A5        PIC X.
   495         16  CL-CCN-A5.
   496             20  CL-CCN.
   497                 24  CL-CCN-PREFIX-A5 PIC X(4).
   498                 24  CL-CCN-PRIME-A5 PIC X(12).
   499             20  CL-CCN-FILLER-A5    PIC X(4).
   500
   501     12  CL-INSURED-PROFILE-DATA.
   502         16  CL-INSURED-BIRTH-DT     PIC XX.
   503         16  CL-INSURED-SEX-CD       PIC X.
   504             88  INSURED-IS-MALE        VALUE 'M'.
   505             88  INSURED-IS-FEMALE      VALUE 'F'.
   506             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   507         16  CL-INSURED-OCC-CD       PIC X(6).
   508         16  FILLER                  PIC X(5).
   509
   510     12  CL-PROCESSING-INFO.
   511         16  CL-PROCESSOR-ID         PIC X(4).
   512         16  CL-CLAIM-STATUS         PIC X.
   513             88  CLAIM-IS-OPEN          VALUE 'O'.
   514             88  CLAIM-IS-CLOSED        VALUE 'C'.
   515         16  CL-CLAIM-TYPE           PIC X.
   516*            88  AH-CLAIM               VALUE 'A'.
   517*            88  LIFE-CLAIM             VALUE 'L'.
   518*            88  PROPERTY-CLAIM         VALUE 'P'.
   519*            88  IUI-CLAIM              VALUE 'I'.
   520*            88  GAP-CLAIM              VALUE 'G'.
   521*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   522*            88  OTHER-CLAIM            VALUE 'O'.
   523         16  CL-CLAIM-PREM-TYPE      PIC X.
   524             88  SINGLE-PREMIUM         VALUE '1'.
   525             88  O-B-COVERAGE           VALUE '2'.
   526             88  OPEN-END-COVERAGE      VALUE '3'.
   527         16  CL-INCURRED-DT          PIC XX.
   528         16  CL-REPORTED-DT          PIC XX.
   529         16  CL-FILE-ESTABLISH-DT    PIC XX.
   530         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   531         16  CL-LAST-PMT-DT          PIC XX.
   532         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   533         16  CL-PAID-THRU-DT         PIC XX.
   534         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   535         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  11
* NSRLTRBL.cbl
   536         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   537         16  CL-PMT-CALC-METHOD      PIC X.
   538             88  CL-360-DAY-YR          VALUE '1'.
   539             88  CL-365-DAY-YR          VALUE '2'.
   540             88  CL-FULL-MONTHS         VALUE '3'.
   541         16  CL-CAUSE-CD             PIC X(6).
   542
   543         16  CL-PRIME-CERT-NO.
   544             20  CL-PRIME-CERT-PRIME PIC X(10).
   545             20  CL-PRIME-CERT-SFX   PIC X.
   546
   547         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   548             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   549             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   550
   551         16  CL-MICROFILM-NO         PIC X(10).
   552         16  FILLER REDEFINES CL-MICROFILM-NO.
   553             20  CL-BENEFIT-PERIOD   PIC 99.
   554             20  FILLER              PIC X(8).
   555         16  CL-PROG-FORM-TYPE       PIC X.
   556         16  CL-LAST-ADD-ON-DT       PIC XX.
   557
   558         16  CL-LAST-REOPEN-DT       PIC XX.
   559         16  CL-LAST-CLOSE-DT        PIC XX.
   560         16  CL-LAST-CLOSE-REASON    PIC X(01).
   561             88  FINAL-PAID             VALUE '1'.
   562             88  CLAIM-DENIED           VALUE '2'.
   563             88  AUTO-CLOSE             VALUE '3'.
   564             88  MANUAL-CLOSE           VALUE '4'.
   565             88  BENEFITS-CHANGED       VALUE 'C'.
   566             88  SETUP-ERRORS           VALUE 'E'.
   567         16  CL-ASSOC-CERT-SEQU      PIC S99.
   568         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   569         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   570             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   571         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   572         16  FILLER                  PIC X.
   573
   574     12  CL-CERTIFICATE-DATA.
   575         16  CL-CERT-ORIGIN          PIC X.
   576             88  CERT-WAS-ONLINE        VALUE '1'.
   577             88  CERT-WAS-CREATED       VALUE '2'.
   578             88  COVERAGE-WAS-ADDED     VALUE '3'.
   579         16  CL-CERT-KEY-DATA.
   580             20  CL-CERT-CARRIER     PIC X.
   581             20  CL-CERT-GROUPING    PIC X(6).
   582             20  CL-CERT-STATE       PIC XX.
   583             20  CL-CERT-ACCOUNT.
   584                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   585                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   586             20  CL-CERT-EFF-DT      PIC XX.
   587
   588     12  CL-STATUS-CONTROLS.
   589         16  CL-PRIORITY-CD          PIC X.
   590             88  CONFIDENTIAL-DATA      VALUE '8'.
   591             88  HIGHEST-PRIORITY       VALUE '9'.
   592         16  CL-SUPV-ATTN-CD         PIC X.
   593             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  12
* NSRLTRBL.cbl
   594             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   595         16  CL-PURGED-DT            PIC XX.
   596         16  CL-RESTORED-DT          PIC XX.
   597         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   598         16  CL-NEXT-RESEND-DT       PIC XX.
   599         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   600         16  CL-CRITICAL-PERIOD      PIC 99.
   601*        16  FILLER                  PIC XX.
   602         16  CL-LAST-MAINT-DT        PIC XX.
   603         16  CL-LAST-MAINT-USER      PIC X(4).
   604         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   605         16  CL-LAST-MAINT-TYPE      PIC X.
   606             88  CLAIM-SET-UP           VALUE ' '.
   607             88  PAYMENT-MADE           VALUE '1'.
   608             88  LETTER-SENT            VALUE '2'.
   609             88  MASTER-WAS-ALTERED     VALUE '3'.
   610             88  MASTER-WAS-RESTORED    VALUE '4'.
   611             88  INCURRED-DATE-CHANGED  VALUE '5'.
   612             88  FILE-CONVERTED         VALUE '6'.
   613             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   614             88  ERROR-CORRECTION       VALUE 'E'.
   615         16  CL-RELATED-CLAIM-NO     PIC X(7).
   616         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   617         16  CL-BENEFICIARY          PIC X(10).
   618         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   619         16  CL-DENIAL-TYPE          PIC X.
   620             88  CL-TYPE-DENIAL          VALUE '1'.
   621             88  CL-TYPE-RESCISSION      VALUE '2'.
   622             88  CL-TYPE-REFORMATION     VALUE '3'.
   623             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   624             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   625         16  CL-NO-OF-EXTENSIONS     PIC 99.
   626         16  filler                  pic x(3).
   627*        16  CL-CRIT-PER-RECURRENT   PIC X.
   628*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   629*        16  CL-RTW-DT               PIC XX.
   630
   631     12  CL-TRAILER-CONTROLS.
   632         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   633             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   634             88  CL-LAST-TRL-AVAIL      VALUE +100.
   635             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   636         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   637         16  FILLER                  PIC XX.
   638         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   639         16  CL-ADDRESS-TRAILER-CNT.
   640             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   641                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   642             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   643                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   644             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   645                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   646             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   647                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   648             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   649                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   650             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   651                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  13
* NSRLTRBL.cbl
   652             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   653                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   654
   655     12  CL-CV-REFERENCE-NO.
   656         16  CL-CV-REFNO-PRIME       PIC X(18).
   657         16  CL-CV-REFNO-SFX         PIC XX.
   658
   659     12  CL-FILE-LOCATION            PIC X(4).
   660
   661     12  CL-PROCESS-ERRORS.
   662         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   663             88  NO-FATAL-ERRORS        VALUE ZERO.
   664         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   665             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   666
   667     12  CL-PRODUCT-CD               PIC X.
   668
   669     12  CL-CURRENT-KEY-DATA.
   670         16  CL-CURRENT-CARRIER      PIC X.
   671         16  CL-CURRENT-GROUPING     PIC X(6).
   672         16  CL-CURRENT-STATE        PIC XX.
   673         16  CL-CURRENT-ACCOUNT      PIC X(10).
   674
   675     12  CL-ASSOCIATES               PIC X.
   676         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   677         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   678         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   679         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   680
   681     12  CL-ACTIVITY-CODE            PIC 99.
   682     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   683     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   684
   685     12  CL-LAPSE-REPORT-CODE        PIC 9.
   686     12  CL-LAG-REPORT-CODE          PIC 9.
   687     12  CL-LOAN-TYPE                PIC XX.
   688     12  CL-LEGAL-STATE              PIC XX.
   689
   690     12  CL-YESNOSW                  PIC X.
   691     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   692         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   693         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   694         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   695     12  cl-insured-type             pic x.
   696         88  cl-claim-on-primary         value 'P'.
   697         88  cl-claim-on-co-borrower     value 'C'.
   698     12  cl-benefit-expiration-dt    PIC XX.
   699*                                COPY ELCTRLR.
   700******************************************************************
   701*                                                                *
   702*                            ELCTRLR.                            *
   703*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   704*                            VMOD=2.014                          *
   705*                                                                *
   706*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
   707*                                                                *
   708*   FILE TYPE = VSAM,KSDS                                        *
   709*   RECORD SIZE = 200    RECFORM = FIXED                         *
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  14
* NSRLTRBL.cbl
   710*                                                                *
   711*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
   712*       ALTERNATE INDEX = NONE                                   *
   713*                                                                *
   714*   LOG = YES                                                    *
   715*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   716******************************************************************
   717*                   C H A N G E   L O G
   718*
   719* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   720*-----------------------------------------------------------------
   721*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   722* EFFECTIVE    NUMBER
   723*-----------------------------------------------------------------
   724* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   725* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
   726* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
   727* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
   728* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
   729* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
   730* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
   731* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
   732* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
   733* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
   734* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
   735* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
   736* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
   737* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
   738* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
   739* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
   740* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
   741* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
   742* 040814    2014030500002  AJRA  ADD ICD CODES
   743* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   744* 013017  CR2016053100001  PEMA  ACH PROCESSING
   745* 062217  CR2017050300002  TANA  ADD AUTH RCVD
   746* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   747* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
   748******************************************************************
   749 01  ACTIVITY-TRAILERS.
   750     12  AT-RECORD-ID                    PIC XX.
   751         88  VALID-AT-ID                       VALUE 'AT'.
   752
   753     12  AT-CONTROL-PRIMARY.
   754         16  AT-COMPANY-CD               PIC X.
   755         16  AT-CARRIER                  PIC X.
   756         16  AT-CLAIM-NO                 PIC X(7).
   757         16  AT-CERT-NO.
   758             20  AT-CERT-PRIME           PIC X(10).
   759             20  AT-CERT-SFX             PIC X.
   760         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
   761             88  AT-1ST-TRL-AVAIL             VALUE +4095.
   762             88  AT-LAST-TRL-AVAIL            VALUE +100.
   763             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
   764             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
   765             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
   766             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
   767             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  15
* NSRLTRBL.cbl
   768             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
   769             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
   770             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
   771             88  AT-DIAGNOSIS-TRL             VALUE +90.
   772             88  AT-BENEFICIARY-TRL           VALUE +91.
   773             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
   774             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
   775             88  AT-VFY-CAUSAL-STATE          VALUE +94.
   776             88  AT-ERROR-MSGS-TRL            VALUE +95.
   777
   778     12  AT-TRAILER-TYPE                 PIC X.
   779         88  RESERVE-EXPENSE-TR               VALUE '1'.
   780         88  PAYMENT-TR                       VALUE '2'.
   781         88  AUTO-PAY-TR                      VALUE '3'.
   782         88  CORRESPONDENCE-TR                VALUE '4'.
   783         88  ADDRESS-TR                       VALUE '5'.
   784         88  GENERAL-INFO-TR                  VALUE '6'.
   785         88  AUTO-PROMPT-TR                   VALUE '7'.
   786         88  DENIAL-TR                        VALUE '8'.
   787         88  INCURRED-CHG-TR                  VALUE '9'.
   788         88  FORM-CONTROL-TR                  VALUE 'A'.
   789
   790     12  AT-RECORDED-DT                  PIC XX.
   791     12  AT-RECORDED-BY                  PIC X(4).
   792     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
   793
   794     12  AT-TRAILER-BODY                 PIC X(165).
   795
   796     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
   797         16  AT-RESERVE-CONTROLS.
   798             20  AT-MANUAL-SW            PIC X.
   799                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
   800             20  AT-FUTURE-SW            PIC X.
   801                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
   802             20  AT-PTC-SW               PIC X.
   803                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
   804             20  AT-IBNR-SW              PIC X.
   805                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
   806             20  AT-PTC-LF-SW            PIC X.
   807                 88  AT-LF-PTC-USED          VALUE '1'.
   808             20  AT-CDT-ACCESS-METHOD    PIC X.
   809                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
   810                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
   811                 88  AT-CDT-INTERPOLATED     VALUE '3'.
   812             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
   813         16  AT-LAST-COMPUTED-DT         PIC XX.
   814         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
   815         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
   816         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
   817         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
   818         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
   819         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
   820         16  AT-EXPENSE-CONTROLS.
   821             20  AT-EXPENSE-METHOD       PIC X.
   822                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
   823                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
   824                 88  PERCENT-OF-PMT           VALUE '3'.
   825                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  16
* NSRLTRBL.cbl
   826             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
   827             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
   828         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
   829         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
   830
   831         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
   832         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
   833
   834*        16  FILLER                      PIC X(53).
   835         16  FILLER                      PIC X(47).
   836
   837         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
   838         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
   839
   840         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
   841             20  AT-OPEN-CLOSE-DATE      PIC XX.
   842             20  AT-OPEN-CLOSE-TYPE      PIC X.
   843*                    C = CLOSED
   844*                    O = OPEN
   845             20  AT-OPEN-CLOSE-REASON    PIC X(5).
   846*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
   847
   848     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
   849         16  AT-PAYMENT-TYPE             PIC X.
   850             88  PARTIAL-PAYMENT                VALUE '1'.
   851             88  FINAL-PAYMENT                  VALUE '2'.
   852             88  LUMP-SUM-PAYMENT               VALUE '3'.
   853             88  ADDITIONAL-PAYMENT             VALUE '4'.
   854             88  CHARGEABLE-EXPENSE             VALUE '5'.
   855             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
   856             88  VOIDED-PAYMENT                 VALUE '9'.
   857             88  TRANSFER                       VALUE 'T'.
   858             88  LIFE-INTEREST                  VALUE 'I'.
   859
   860         16  AT-CLAIM-TYPE               PIC X.
   861             88  PAID-FOR-AH                    VALUE 'A'.
   862             88  PAID-FOR-LIFE                  VALUE 'L'.
   863             88  PAID-FOR-IUI                   VALUE 'I'.
   864             88  PAID-FOR-GAP                   VALUE 'G'.
   865             88  PAID-FOR-FAM                   VALUE 'F'.
   866             88  PAID-FOR-OTH                   VALUE 'O'.
   867         16  AT-CLAIM-PREM-TYPE          PIC X.
   868             88  AT-SINGLE-PREMIUM              VALUE '1'.
   869             88  AT-O-B-COVERAGE                VALUE '2'.
   870             88  AT-OPEN-END-COVERAGE           VALUE '3'.
   871         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
   872         16  AT-CHECK-NO                 PIC X(7).
   873         16  AT-PAID-FROM-DT             PIC XX.
   874         16  AT-PAID-THRU-DT             PIC XX.
   875         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
   876         16  AT-ACH-PAYMENT              PIC X.
   877*        16  FILLER                      PIC X.
   878         16  AT-PAYEES-NAME              PIC X(30).
   879         16  AT-PAYMENT-ORIGIN           PIC X.
   880             88  ONLINE-MANUAL-PMT              VALUE '1'.
   881             88  ONLINE-AUTO-PMT                VALUE '2'.
   882             88  OFFLINE-PMT                    VALUE '3'.
   883         16  AT-CHECK-WRITTEN-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  17
* NSRLTRBL.cbl
   884         16  AT-TO-BE-WRITTEN-DT         PIC XX.
   885         16  AT-VOID-DATA.
   886             20  AT-VOID-DT              PIC XX.
   887*00144       20  AT-VOID-REASON          PIC X(30).
   888             20  AT-VOID-REASON          PIC X(26).
   889         16  AT-PMT-APPROVED-BY          PIC X(04).
   890         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
   891         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
   892         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
   893                                         PIC S99V9(5)  COMP-3.
   894         16  AT-CREDIT-INTERFACE.
   895             20  AT-PMT-SELECT-DT        PIC XX.
   896                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
   897             20  AT-PMT-ACCEPT-DT        PIC XX.
   898                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
   899             20  AT-VOID-SELECT-DT       PIC XX.
   900                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
   901             20  AT-VOID-ACCEPT-DT       PIC XX.
   902                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
   903
   904         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
   905                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   906                 88  CONVERSION-PAYMENT           VALUE +99999999.
   907         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
   908
   909         16  AT-FORCE-CONTROL            PIC X.
   910             88  PAYMENT-WAS-FORCED           VALUE '1'.
   911         16  AT-PREV-LAST-PMT-DT         PIC XX.
   912         16  AT-PREV-PAID-THRU-DT        PIC XX.
   913         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
   914         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
   915         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
   916         16  AT-BENEFIT-TYPE             PIC X.
   917
   918         16  AT-EXPENSE-TYPE             PIC X.
   919         16  AT-PAYMENT-APPROVAL-SW      PIC X.
   920
   921         16  AT-PAYEE-TYPE-CD.
   922             20  AT-PAYEE-TYPE           PIC X.
   923                 88  INSURED-PAID           VALUE 'I'.
   924                 88  BENEFICIARY-PAID       VALUE 'B'.
   925                 88  ACCOUNT-PAID           VALUE 'A'.
   926                 88  OTHER-1-PAID           VALUE 'O'.
   927                 88  OTHER-2-PAID           VALUE 'Q'.
   928                 88  DOCTOR-PAID            VALUE 'P'.
   929                 88  EMPLOYER-PAID          VALUE 'E'.
   930             20  AT-PAYEE-SEQ            PIC X.
   931
   932         16  AT-CASH-PAYMENT             PIC X.
   933         16  AT-GROUPED-PAYMENT          PIC X.
   934         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
   935         16  AT-APPROVAL-LEVEL-REQD      PIC X.
   936         16  AT-APPROVED-LEVEL           PIC X.
   937         16  AT-VOID-TYPE                PIC X.
   938             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
   939             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
   940         16  AT-AIG-UNEMP-IND            PIC X.
   941             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  18
* NSRLTRBL.cbl
   942         16  AT-ASSOCIATES               PIC X.
   943             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
   944             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
   945
   946         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
   947         16  AT-CV-PMT-CODE              PIC X.
   948             88  FULL-DEATH-PAYMENT         VALUE '1'.
   949             88  HALF-DEATH-PAYMENT         VALUE '2'.
   950             88  FULL-ADD-PAYMENT           VALUE '3'.
   951             88  HALF-ADD-PAYMENT           VALUE '4'.
   952             88  FULL-RIDER-PAYMENT         VALUE '5'.
   953             88  HALF-RIDER-PAYMENT         VALUE '6'.
   954             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
   955             88  ADDL-PAYMENT               VALUE '8'.
   956
   957         16  AT-EOB-CODE1                PIC XXX.
   958         16  AT-EOB-CODE2                PIC XXX.
   959         16  AT-EOB-CODE3                PIC XXX.
   960         16  FILLER REDEFINES AT-EOB-CODE3.
   961             20  AT-PRINT-CLM-FORM       PIC X.
   962             20  AT-PRINT-SURVEY         PIC X.
   963             20  AT-SPECIAL-RELEASE      PIC X.
   964         16  AT-EOB-CODE4                PIC XXX.
   965         16  FILLER REDEFINES AT-EOB-CODE4.
   966             20  AT-INT-PMT-SELECT-DT    PIC XX.
   967             20  FILLER                  PIC X.
   968         16  AT-EOB-CODE5                PIC XXX.
   969         16  FILLER REDEFINES AT-EOB-CODE5.
   970             20  AT-PMT-PROOF-DT         PIC XX.
   971             20  FILLER                  PIC X.
   972
   973         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
   974             88  AT-PRINT-EOB            VALUE 'Y'.
   975
   976         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
   977         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
   978
   979     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
   980         16  AT-SCHEDULE-START-DT        PIC XX.
   981         16  AT-SCHEDULE-END-DT          PIC XX.
   982         16  AT-TERMINATED-DT            PIC XX.
   983         16  AT-LAST-PMT-TYPE            PIC X.
   984             88  LAST-PMT-IS-FINAL              VALUE 'F'.
   985             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
   986         16  AT-FIRST-PMT-DATA.
   987             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
   988             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
   989             20  AT-1ST-PAY-THRU-DT      PIC XX.
   990         16  AT-REGULAR-PMT-DATA.
   991             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
   992             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
   993             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
   994         16  AT-AUTO-PAYEE-CD.
   995             20  AT-AUTO-PAYEE-TYPE      PIC X.
   996                 88  INSURED-PAID-AUTO      VALUE 'I'.
   997                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
   998                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
   999                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  19
* NSRLTRBL.cbl
  1000                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  1001             20  AT-AUTO-PAYEE-SEQ       PIC X.
  1002         16  AT-AUTO-PAY-DAY             PIC 99.
  1003         16  AT-AUTO-CASH                PIC X.
  1004             88  AT-CASH                      VALUE 'Y'.
  1005             88  AT-NON-CASH                  VALUE 'N'.
  1006*        16  FILLER                      PIC X(129).
  1007         16  AT-AUTO-END-LETTER          PIC X(4).
  1008         16  FILLER                      PIC X(125).
  1009
  1010         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  1011         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  1012
  1013     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  1014         16  AT-LETTER-SENT-DT           PIC XX.
  1015         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  1016         16  AT-AUTO-RE-SEND-DT          PIC XX.
  1017         16  AT-LETTER-ANSWERED-DT       PIC XX.
  1018         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  1019         16  AT-LETTER-ORIGIN            PIC X.
  1020             88  ONLINE-CREATION              VALUE '1' '3'.
  1021             88  OFFLINE-CREATION             VALUE '2' '4'.
  1022             88  NAPER-ONLINE-CREATION        VALUE '3'.
  1023             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  1024         16  AT-STD-LETTER-FORM          PIC X(4).
  1025         16  AT-REASON-TEXT              PIC X(70).
  1026         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  1027         16  AT-ADDRESEE-TYPE            PIC X.
  1028              88  INSURED-ADDRESEE            VALUE 'I'.
  1029              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  1030              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  1031              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  1032              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  1033              88  OTHER-ADDRESEE-1            VALUE 'O'.
  1034              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  1035         16  AT-ADDRESSEE-NAME           PIC X(30).
  1036         16  AT-INITIAL-PRINT-DATE       PIC XX.
  1037         16  AT-RESEND-PRINT-DATE        PIC XX.
  1038         16  AT-CORR-SOL-UNSOL           PIC X.
  1039         16  AT-LETTER-PURGED-DT         PIC XX.
  1040*
  1041*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  1042*
  1043         16  AT-CSO-REDEFINITION.
  1044             20  AT-RESEND-LETTER-FORM   PIC X(4).
  1045             20  AT-AUTO-CLOSE-IND       PIC X(1).
  1046             20  AT-LETTER-TO-BENE       PIC X(1).
  1047             20  AT-STOP-LETTER-DT       PIC X(2).
  1048             20  AT-AUTH-RCVD            PIC X(1).
  1049             20  FILLER                  PIC X(18).
  1050*             20  FILLER                  PIC X(27).
  1051             20  AT-CSO-LETTER-STATUS    PIC X.
  1052                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  1053                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  1054                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  1055             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  1056             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  1057*
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  20
* NSRLTRBL.cbl
  1058*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  1059*
  1060*        16  FILLER                      PIC X(26).
  1061*
  1062*        16  AT-DMD-BSR-CODE             PIC X.
  1063*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  1064*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  1065*
  1066*        16  AT-DMD-LETTER-STATUS        PIC X.
  1067*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  1068*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  1069*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  1070*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  1071*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  1072
  1073         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  1074         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  1075
  1076     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  1077         16  AT-ADDRESS-TYPE             PIC X.
  1078             88  INSURED-ADDRESS               VALUE 'I'.
  1079             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  1080             88  ACCOUNT-ADDRESS               VALUE 'A'.
  1081             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  1082             88  EMPLOYER-ADDRESS              VALUE 'E'.
  1083             88  OTHER-ADDRESS-1               VALUE 'O'.
  1084             88  OTHER-ADDRESS-2               VALUE 'Q'.
  1085         16  AT-MAIL-TO-NAME             PIC X(30).
  1086         16  AT-ADDRESS-LINE-1           PIC X(30).
  1087         16  AT-ADDRESS-LINE-2           PIC X(30).
  1088         16  AT-CITY-STATE.
  1089             20  AT-CITY                 PIC X(28).
  1090             20  AT-STATE                PIC XX.
  1091         16  AT-ZIP.
  1092             20  AT-ZIP-CODE.
  1093                 24  AT-ZIP-1ST          PIC X.
  1094                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1095                 24  FILLER              PIC X(4).
  1096             20  AT-ZIP-PLUS4            PIC X(4).
  1097         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  1098             20  AT-CAN-POSTAL-1         PIC XXX.
  1099             20  AT-CAN-POSTAL-2         PIC XXX.
  1100             20  FILLER                  PIC XXX.
  1101         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  1102*         16  FILLER                      PIC X(23).
  1103         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  1104         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  1105         16  FILLER                      PIC X(13).
  1106         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  1107         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  1108
  1109     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1110         16  AT-INFO-LINE-1              PIC X(60).
  1111         16  FILLER REDEFINES AT-INFO-LINE-1.
  1112             20  AT-NOTE-ERROR-NO OCCURS 15
  1113                                         PIC X(4).
  1114         16  AT-INFO-LINE-2              PIC X(60).
  1115         16  FILLER REDEFINES AT-INFO-LINE-2.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  21
* NSRLTRBL.cbl
  1116             20  AT-ICD-CODE-1           PIC X(8).
  1117             20  AT-ICD-CODE-2           PIC X(8).
  1118             20  FILLER                  PIC X(44).
  1119         16  AT-INFO-TRAILER-TYPE        PIC X.
  1120             88  AT-ERRORS-NOTE          VALUE 'E'.
  1121             88  AT-PAYMENT-NOTE         VALUE 'P'.
  1122             88  AT-CALL-NOTE            VALUE 'C'.
  1123             88  AT-MAINT-NOTE           VALUE 'M'.
  1124             88  AT-CERT-CHANGE          VALUE 'X'.
  1125             88  AT-APPROVAL-NOTE        VALUE 'R'.
  1126             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  1127             88  AT-CERT-CANCELLED       VALUE 'T'.
  1128         16  AT-CALL-TYPE                PIC X.
  1129             88  AT-PHONE-CALL-IN        VALUE 'I'.
  1130             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  1131             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  1132         16  AT-NOTE-CONTINUATION        PIC X.
  1133             88  AT-CONTINUED-NOTE       VALUE 'X'.
  1134         16  AT-EOB-CODES-EXIST          PIC X.
  1135             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  1136         16  FILLER                      PIC X(35).
  1137         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  1138         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  1139
  1140     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  1141         16  AT-PROMPT-LINE-1            PIC X(60).
  1142         16  AT-PROMPT-LINE-2            PIC X(60).
  1143         16  AT-PROMPT-START-DT          PIC XX.
  1144         16  AT-PROMPT-END-DT            PIC XX.
  1145         16  FILLER                      PIC X(35).
  1146         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  1147         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  1148
  1149     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1150         16  AT-DENIAL-INFO-1            PIC X(60).
  1151         16  AT-DENIAL-INFO-2            PIC X(60).
  1152         16  AT-DENIAL-DT                PIC XX.
  1153         16  AT-RETRACTION-DT            PIC XX.
  1154         16  AT-DENIAL-REASON-CODE       PIC X(4).
  1155*         16  FILLER                      PIC X(31).
  1156         16  AT-DENIAL-PROOF-DT          PIC XX.
  1157         16  FILLER                      PIC X(29).
  1158         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  1159         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  1160
  1161     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  1162         16  AT-OLD-INCURRED-DT          PIC XX.
  1163         16  AT-OLD-REPORTED-DT          PIC XX.
  1164         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  1165         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  1166         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  1167         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  1168         16  AT-OLD-PAID-THRU-DT         PIC XX.
  1169         16  AT-LAST-PMT-MADE-DT         PIC XX.
  1170         16  FILLER                      PIC X(26).
  1171         16  AT-OLD-DIAG-CODE            PIC X(6).
  1172         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  1173         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  22
* NSRLTRBL.cbl
  1174         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  1175         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  1176         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  1177         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  1178         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  1179         16  AT-OLD-ICD-CODE-1           PIC X(8).
  1180         16  AT-OLD-ICD-CODE-2           PIC X(8).
  1181         16  FILLER                      PIC X(9).
  1182         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  1183
  1184     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  1185         16  AT-FORM-SEND-ON-DT          PIC XX.
  1186         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  1187         16  AT-FORM-RE-SEND-DT          PIC XX.
  1188         16  AT-FORM-ANSWERED-DT         PIC XX.
  1189         16  AT-FORM-PRINTED-DT          PIC XX.
  1190         16  AT-FORM-REPRINT-DT          PIC XX.
  1191         16  AT-FORM-TYPE                PIC X.
  1192             88  INITIAL-FORM                  VALUE '1'.
  1193             88  PROGRESS-FORM                 VALUE '2'.
  1194         16  AT-INSTRUCT-LN-1            PIC X(28).
  1195         16  AT-INSTRUCT-LN-2            PIC X(28).
  1196         16  AT-INSTRUCT-LN-3            PIC X(28).
  1197         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  1198         16  AT-FORM-ADDRESS             PIC X.
  1199             88  FORM-TO-INSURED              VALUE 'I'.
  1200             88  FORM-TO-ACCOUNT              VALUE 'A'.
  1201             88  FORM-TO-OTHER-1              VALUE 'O'.
  1202             88  FORM-TO-OTHER-2              VALUE 'Q'.
  1203         16  AT-RELATED-1.
  1204             20 AT-REL-CARR-1            PIC X.
  1205             20 AT-REL-CLAIM-1           PIC X(7).
  1206             20 AT-REL-CERT-1            PIC X(11).
  1207         16  AT-RELATED-2.
  1208             20 AT-REL-CARR-2            PIC X.
  1209             20 AT-REL-CLAIM-2           PIC X(7).
  1210             20 AT-REL-CERT-2            PIC X(11).
  1211         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  1212         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  1213         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  1214         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  1215         16  AT-FORM-REM-PRINT-DT        PIC XX.
  1216         16  AT-STOP-FORM-DT             PIC X(2).
  1217
  1218         16  FILLER                      PIC X(09).
  1219         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  1220         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  1221******************************************************************
  1222*                                COPY ELCCERT.
  1223******************************************************************
  1224*                                                                *
  1225*                            ELCCERT.                            *
  1226*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1227*                            VMOD=2.013                          *
  1228*                                                                *
  1229*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1230*                                                                *
  1231*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  23
* NSRLTRBL.cbl
  1232*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1233*                                                                *
  1234*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1235*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1236*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1237*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1238*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1239*                                                                *
  1240*   LOG = YES                                                    *
  1241*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1242******************************************************************
  1243*                   C H A N G E   L O G
  1244*
  1245* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1246*-----------------------------------------------------------------
  1247*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1248* EFFECTIVE    NUMBER
  1249*-----------------------------------------------------------------
  1250* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1251* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1252* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1253* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1254* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1255* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1256* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1257* 032612  CR2011110200001  PEMA  AHL CHANGES
  1258* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1259* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1260* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  1261******************************************************************
  1262
  1263 01  CERTIFICATE-MASTER.
  1264     12  CM-RECORD-ID                      PIC XX.
  1265         88  VALID-CM-ID                      VALUE 'CM'.
  1266
  1267     12  CM-CONTROL-PRIMARY.
  1268         16  CM-COMPANY-CD                 PIC X.
  1269         16  CM-CARRIER                    PIC X.
  1270         16  CM-GROUPING.
  1271             20  CM-GROUPING-PREFIX        PIC X(3).
  1272             20  CM-GROUPING-PRIME         PIC X(3).
  1273         16  CM-STATE                      PIC XX.
  1274         16  CM-ACCOUNT.
  1275             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1276             20  CM-ACCOUNT-PRIME          PIC X(6).
  1277         16  CM-CERT-EFF-DT                PIC XX.
  1278         16  CM-CERT-NO.
  1279             20  CM-CERT-PRIME             PIC X(10).
  1280             20  CM-CERT-SFX               PIC X.
  1281
  1282     12  CM-CONTROL-BY-NAME.
  1283         16  CM-COMPANY-CD-A1              PIC X.
  1284         16  CM-INSURED-LAST-NAME          PIC X(15).
  1285         16  CM-INSURED-INITIALS.
  1286             20  CM-INSURED-INITIAL1       PIC X.
  1287             20  CM-INSURED-INITIAL2       PIC X.
  1288
  1289     12  CM-CONTROL-BY-SSN.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  24
* NSRLTRBL.cbl
  1290         16  CM-COMPANY-CD-A2              PIC X.
  1291         16  CM-SOC-SEC-NO.
  1292             20  CM-SSN-STATE              PIC XX.
  1293             20  CM-SSN-ACCOUNT            PIC X(6).
  1294             20  CM-SSN-LN3.
  1295                 25  CM-INSURED-INITIALS-A2.
  1296                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1297                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1298                 25 CM-PART-LAST-NAME-A2         PIC X.
  1299
  1300     12  CM-CONTROL-BY-CERT-NO.
  1301         16  CM-COMPANY-CD-A4              PIC X.
  1302         16  CM-CERT-NO-A4                 PIC X(11).
  1303
  1304     12  CM-CONTROL-BY-MEMB.
  1305         16  CM-COMPANY-CD-A5              PIC X.
  1306         16  CM-MEMBER-NO.
  1307             20  CM-MEMB-STATE             PIC XX.
  1308             20  CM-MEMB-ACCOUNT           PIC X(6).
  1309             20  CM-MEMB-LN4.
  1310                 25  CM-INSURED-INITIALS-A5.
  1311                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1312                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1313                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1314
  1315     12  CM-INSURED-PROFILE-DATA.
  1316         16  CM-INSURED-FIRST-NAME.
  1317             20  CM-INSURED-1ST-INIT       PIC X.
  1318             20  FILLER                    PIC X(9).
  1319         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1320         16  CM-INSURED-SEX                PIC X.
  1321             88  CM-SEX-MALE                  VALUE 'M'.
  1322             88  CM-SEX-FEMAL                 VALUE 'F'.
  1323         16  CM-INSURED-JOINT-AGE          PIC 99.
  1324         16  CM-JOINT-INSURED-NAME.
  1325             20  CM-JT-LAST-NAME           PIC X(15).
  1326             20  CM-JT-FIRST-NAME.
  1327                 24  CM-JT-1ST-INIT        PIC X.
  1328                 24  FILLER                PIC X(9).
  1329             20  CM-JT-INITIAL             PIC X.
  1330
  1331     12  CM-LIFE-DATA.
  1332         16  CM-LF-BENEFIT-CD              PIC XX.
  1333         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1334         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1335         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1336         16  CM-LF-DEV-CODE                PIC XXX.
  1337         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1338         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1339         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1340         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1341         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1342         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1343         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1344         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1345         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1346         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1347         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  25
* NSRLTRBL.cbl
  1348         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1349         16  cm-temp-epiq                  pic xx.
  1350             88  EPIQ-CLASS                  value 'EQ'.
  1351*        16  FILLER                        PIC XX.
  1352
  1353     12  CM-AH-DATA.
  1354         16  CM-AH-BENEFIT-CD              PIC XX.
  1355         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1356         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1357         16  CM-AH-DEV-CODE                PIC XXX.
  1358         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1359         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1360         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1361         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1362         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1363         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1364         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1365         16  CM-AH-PAID-THRU-DT            PIC XX.
  1366             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1367         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1368         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1369         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1370         16  FILLER                        PIC X.
  1371
  1372     12  CM-LOAN-INFORMATION.
  1373         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1374         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1375                                           PIC S9(5)V99  COMP-3.
  1376         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1377         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1378         16  CM-PAY-FREQUENCY              PIC S99.
  1379         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1380         16  CM-RATE-CLASS                 PIC XX.
  1381         16  CM-BENEFICIARY                PIC X(25).
  1382         16  CM-POLICY-FORM-NO             PIC X(12).
  1383         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1384         16  CM-LAST-ADD-ON-DT             PIC XX.
  1385         16  CM-DEDUCTIBLE-AMOUNTS.
  1386             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1387             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1388         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1389             20  CM-RESIDENT-STATE         PIC XX.
  1390             20  CM-RATE-CODE              PIC X(4).
  1391             20  FILLER                    PIC XX.
  1392         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1393             20  CM-LOAN-OFFICER           PIC X(5).
  1394             20  FILLER                    PIC XXX.
  1395         16  CM-CSR-CODE                   PIC XXX.
  1396         16  CM-UNDERWRITING-CODE          PIC X.
  1397             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1398         16  CM-POST-CARD-IND              PIC X.
  1399         16  CM-REF-INTERFACE-SW           PIC X.
  1400         16  CM-PREMIUM-TYPE               PIC X.
  1401             88  CM-SING-PRM                  VALUE '1'.
  1402             88  CM-O-B-COVERAGE              VALUE '2'.
  1403             88  CM-OPEN-END                  VALUE '3'.
  1404         16  CM-IND-GRP-TYPE               PIC X.
  1405             88  CM-INDIVIDUAL                VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  26
* NSRLTRBL.cbl
  1406             88  CM-GROUP                     VALUE 'G'.
  1407         16  CM-SKIP-CODE                  PIC X.
  1408             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1409             88  SKIP-JULY                    VALUE '1'.
  1410             88  SKIP-AUGUST                  VALUE '2'.
  1411             88  SKIP-SEPTEMBER               VALUE '3'.
  1412             88  SKIP-JULY-AUG                VALUE '4'.
  1413             88  SKIP-AUG-SEPT                VALUE '5'.
  1414             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1415             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1416             88  SKIP-JUNE                    VALUE '8'.
  1417             88  SKIP-JUNE-JULY               VALUE '9'.
  1418             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1419             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1420         16  CM-PAYMENT-MODE               PIC X.
  1421             88  PAY-MONTHLY                  VALUE SPACE.
  1422             88  PAY-WEEKLY                   VALUE '1'.
  1423             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1424             88  PAY-BI-WEEKLY                VALUE '3'.
  1425             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1426         16  CM-LOAN-NUMBER                PIC X(8).
  1427         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1428         16  CM-OLD-LOF                    PIC XXX.
  1429*        16  CM-LOAN-OFFICER               PIC XXX.
  1430         16  CM-REIN-TABLE                 PIC XXX.
  1431         16  CM-SPECIAL-REIN-CODE          PIC X.
  1432         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1433         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1434         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1435
  1436     12  CM-STATUS-DATA.
  1437         16  CM-ENTRY-STATUS               PIC X.
  1438         16  CM-ENTRY-DT                   PIC XX.
  1439
  1440         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1441         16  CM-LF-CANCEL-DT               PIC XX.
  1442         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1443
  1444         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1445         16  CM-LF-DEATH-DT                PIC XX.
  1446         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1447
  1448         16  CM-LF-CURRENT-STATUS          PIC X.
  1449             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1450                                                'M' '4' '5' '9'.
  1451             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1452             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1453             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1454             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1455             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1456             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1457             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1458             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1459             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1460             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1461             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1462             88  CM-LF-DECLINED               VALUE 'D'.
  1463             88  CM-LF-VOIDED                 VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  27
* NSRLTRBL.cbl
  1464
  1465         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1466         16  CM-AH-CANCEL-DT               PIC XX.
  1467         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1468
  1469         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1470         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1471         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1472
  1473         16  CM-AH-CURRENT-STATUS          PIC X.
  1474             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1475                                                'M' '4' '5' '9'.
  1476             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1477             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1478             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1479             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1480             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1481             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1482             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1483             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1484             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1485             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1486             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1487             88  CM-AH-DECLINED               VALUE 'D'.
  1488             88  CM-AH-VOIDED                 VALUE 'V'.
  1489
  1490         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1491             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1492             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1493             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1494         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1495
  1496         16  CM-ENTRY-BATCH                PIC X(6).
  1497         16  CM-LF-EXIT-BATCH              PIC X(6).
  1498         16  CM-AH-EXIT-BATCH              PIC X(6).
  1499         16  CM-LAST-MONTH-END             PIC XX.
  1500
  1501     12  CM-NOTE-SW                        PIC X.
  1502         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1503         88  CERT-NOTES-PRESENT               VALUE '1'.
  1504         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1505         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1506         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1507         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1508         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1509         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1510     12  CM-COMP-EXCP-SW                   PIC X.
  1511         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1512         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1513     12  CM-INSURED-ADDRESS-SW             PIC X.
  1514         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1515         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1516
  1517*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1518     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1519     12  FILLER                            PIC X.
  1520
  1521*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  28
* NSRLTRBL.cbl
  1522     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1523     12  FILLER                            PIC X.
  1524*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1525     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  1526
  1527     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1528         88  CERT-ADDED-BATCH                 VALUE ' '.
  1529         88  CERT-ADDED-ONLINE                VALUE '1'.
  1530         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1531         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1532         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1533     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1534         88  CERT-AS-LOADED                   VALUE ' '.
  1535         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1536         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1537         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1538         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1539         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1540         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1541         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1542
  1543     12  CM-ACCOUNT-COMM-PCTS.
  1544         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1545         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1546
  1547     12  CM-USER-FIELD                     PIC X.
  1548     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1549     12  CM-CLP-STATE                      PIC XX.
  1550     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1551     12  CM-USER-RESERVED                  PIC XXX.
  1552     12  FILLER REDEFINES CM-USER-RESERVED.
  1553         16  CM-AH-CLASS-CD                PIC XX.
  1554         16  F                             PIC X.
  1555******************************************************************
  1556*                                COPY ERCACCT.
  1557******************************************************************
  1558*                                                                *
  1559*                                                                *
  1560*                            ERCACCT                             *
  1561*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1562*                            VMOD=2.031                          *
  1563*                                                                *
  1564*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1565*                                                                *
  1566*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1567*   VSAM ACCOUNT MASTER FILES.                                   *
  1568*                                                                *
  1569*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1570*                                                                *
  1571*   FILE TYPE = VSAM,KSDS                                        *
  1572*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1573*                                                                *
  1574*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1575*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1576*                                                                *
  1577*   LOG = NO                                                     *
  1578*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1579*                                                                *
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  29
* NSRLTRBL.cbl
  1580*                                                                *
  1581******************************************************************
  1582*                   C H A N G E   L O G
  1583*
  1584* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1585*-----------------------------------------------------------------
  1586*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1587* EFFECTIVE    NUMBER
  1588*-----------------------------------------------------------------
  1589* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1590* 092705    2005050300006  PEMA  ADD SPP LEASES
  1591* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1592* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1593* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1594* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1595* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1596* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1597******************************************************************
  1598
  1599 01  ACCOUNT-MASTER.
  1600     12  AM-RECORD-ID                      PIC XX.
  1601         88  VALID-AM-ID                      VALUE 'AM'.
  1602
  1603     12  AM-CONTROL-PRIMARY.
  1604         16  AM-COMPANY-CD                 PIC X.
  1605         16  AM-MSTR-CNTRL.
  1606             20  AM-CONTROL-A.
  1607                 24  AM-CARRIER            PIC X.
  1608                 24  AM-GROUPING.
  1609                     28 AM-GROUPING-PREFIX PIC XXX.
  1610                     28 AM-GROUPING-PRIME  PIC XXX.
  1611                 24  AM-STATE              PIC XX.
  1612                 24  AM-ACCOUNT.
  1613                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1614                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1615             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1616                                           PIC X(19).
  1617             20  AM-CNTRL-B.
  1618                 24  AM-EXPIRATION-DT      PIC XX.
  1619                 24  FILLER                PIC X(4).
  1620             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1621                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1622
  1623     12  AM-CONTROL-BY-VAR-GRP.
  1624         16  AM-COMPANY-CD-A1              PIC X.
  1625         16  AM-VG-CARRIER                 PIC X.
  1626         16  AM-VG-GROUPING                PIC X(6).
  1627         16  AM-VG-STATE                   PIC XX.
  1628         16  AM-VG-ACCOUNT                 PIC X(10).
  1629         16  AM-VG-DATE.
  1630             20  AM-VG-EXPIRATION-DT       PIC XX.
  1631             20  FILLER                    PIC X(4).
  1632         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1633                                           PIC 9(11)      COMP-3.
  1634     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1635         16  FILLER                        PIC X(10).
  1636         16  AM-VG-KEY3.
  1637             20  AM-VG3-ACCOUNT            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  30
* NSRLTRBL.cbl
  1638             20  AM-VG3-EXP-DT             PIC XX.
  1639         16  FILLER                        PIC X(4).
  1640     12  AM-MAINT-INFORMATION.
  1641         16  AM-LAST-MAINT-DT              PIC XX.
  1642         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1643         16  AM-LAST-MAINT-USER            PIC X(4).
  1644         16  FILLER                        PIC XX.
  1645
  1646     12  AM-EFFECTIVE-DT                   PIC XX.
  1647     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1648
  1649     12  AM-PREV-DATES  COMP-3.
  1650         16  AM-PREV-EXP-DT                PIC 9(11).
  1651         16  AM-PREV-EFF-DT                PIC 9(11).
  1652
  1653     12  AM-REPORT-CODE-1                  PIC X(10).
  1654     12  AM-REPORT-CODE-2                  PIC X(10).
  1655
  1656     12  AM-CITY-CODE                      PIC X(4).
  1657     12  AM-COUNTY-PARISH                  PIC X(6).
  1658
  1659     12  AM-NAME                           PIC X(30).
  1660     12  AM-PERSON                         PIC X(30).
  1661     12  AM-ADDRS                          PIC X(30).
  1662     12  AM-CITY.
  1663         16  AM-ADDR-CITY                  PIC X(28).
  1664         16  AM-ADDR-STATE                 PIC XX.
  1665     12  AM-ZIP.
  1666         16  AM-ZIP-PRIME.
  1667             20  AM-ZIP-PRI-1ST            PIC X.
  1668                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1669             20  FILLER                    PIC X(4).
  1670         16  AM-ZIP-PLUS4                  PIC X(4).
  1671     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1672         16  AM-CAN-POSTAL-1               PIC XXX.
  1673         16  AM-CAN-POSTAL-2               PIC XXX.
  1674         16  FILLER                        PIC XXX.
  1675     12  AM-TEL-NO.
  1676         16  AM-AREA-CODE                  PIC 999.
  1677         16  AM-TEL-PRE                    PIC 999.
  1678         16  AM-TEL-NBR                    PIC 9(4).
  1679     12  AM-TEL-LOC                        PIC X.
  1680         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1681         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1682
  1683     12  AM-COMM-STRUCTURE.
  1684         16  AM-DEFN-1.
  1685             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1686                 24  AM-AGT.
  1687                     28  AM-AGT-PREFIX     PIC X(4).
  1688                     28  AM-AGT-PRIME      PIC X(6).
  1689                 24  AM-COM-TYP            PIC X.
  1690                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1691                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1692                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1693                 24  AM-RECALC-LV-INDIC    PIC X.
  1694                 24  AM-RETRO-LV-INDIC     PIC X.
  1695                 24  AM-GL-CODES           PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  31
* NSRLTRBL.cbl
  1696                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1697                 24  FILLER                PIC X(01).
  1698         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1699             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1700                 24  FILLER                PIC X(11).
  1701                 24  AM-L-COMA             PIC XXX.
  1702                 24  AM-J-COMA             PIC XXX.
  1703                 24  AM-A-COMA             PIC XXX.
  1704                 24  FILLER                PIC X(6).
  1705
  1706     12  AM-COMM-CHANGE-STATUS             PIC X.
  1707         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1708
  1709     12  AM-CSR-CODE                       PIC X(4).
  1710
  1711     12  AM-BILLING-STATUS                 PIC X.
  1712         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1713         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1714     12  AM-AUTO-REFUND-SW                 PIC X.
  1715         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1716         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1717     12  AM-GPCD                           PIC 99.
  1718     12  AM-IG                             PIC X.
  1719         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1720         88  AM-HAS-GROUP                     VALUE '2'.
  1721     12  AM-STATUS                         PIC X.
  1722         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1723         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1724         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1725         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1726         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1727         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1728         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1729         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1730         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1731         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1732     12  AM-REMIT-TO                       PIC 99.
  1733     12  AM-ID-NO                          PIC X(11).
  1734
  1735     12  AM-CAL-TABLE                      PIC XX.
  1736     12  AM-LF-DEVIATION                   PIC XXX.
  1737     12  AM-AH-DEVIATION                   PIC XXX.
  1738     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1739     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1740     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1741     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1742     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1743     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1744
  1745     12  AM-USER-FIELDS.
  1746         16  AM-FLD-1                      PIC XX.
  1747         16  AM-FLD-2                      PIC XX.
  1748         16  AM-FLD-3                      PIC XX.
  1749         16  AM-FLD-4                      PIC XX.
  1750         16  AM-FLD-5                      PIC XX.
  1751
  1752     12  AM-1ST-PROD-DATE.
  1753         16  AM-1ST-PROD-YR                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  32
* NSRLTRBL.cbl
  1754         16  AM-1ST-PROD-MO                PIC XX.
  1755         16  AM-1ST-PROD-DA                PIC XX.
  1756     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1757     12  AM-CERTS-PURGED-DATE.
  1758         16  AM-PUR-YR                     PIC XX.
  1759         16  AM-PUR-MO                     PIC XX.
  1760         16  AM-PUR-DA                     PIC XX.
  1761     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1762     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1763     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1764     12  AM-INACTIVE-DATE.
  1765         16  AM-INA-MO                     PIC 99.
  1766         16  AM-INA-DA                     PIC 99.
  1767         16  AM-INA-YR                     PIC 99.
  1768     12  AM-AR-HI-CERT-DATE                PIC XX.
  1769
  1770     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1771     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1772
  1773     12  AM-OB-PAYMENT-MODE                PIC X.
  1774         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1775         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1776         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1777         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1778
  1779     12  AM-AH-ONLY-INDICATOR              PIC X.
  1780         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1781         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1782
  1783     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1784
  1785     12  AM-OVER-SHORT.
  1786         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1787         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1788
  1789     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1790     12  AM-DCC-CLP-STATE                  PIC XX.
  1791
  1792     12  AM-RECALC-COMM                    PIC X.
  1793     12  AM-RECALC-REIN                    PIC X.
  1794
  1795     12  AM-REI-TABLE                      PIC XXX.
  1796     12  AM-REI-ET-LF                      PIC X.
  1797     12  AM-REI-ET-AH                      PIC X.
  1798     12  AM-REI-PE-LF                      PIC X.
  1799     12  AM-REI-PE-AH                      PIC X.
  1800     12  AM-REI-PRT-ST                     PIC X.
  1801     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1802     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1803     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1804     12  AM-REI-GROUP-A                    PIC X(6).
  1805     12  AM-REI-MORT                       PIC X(4).
  1806     12  AM-REI-PRT-OW                     PIC X.
  1807     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1808     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1809     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1810     12  AM-REI-GROUP-B                    PIC X(6).
  1811
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  33
* NSRLTRBL.cbl
  1812     12  AM-TRUST-TYPE                     PIC X(2).
  1813
  1814     12  AM-EMPLOYER-STMT-USED             PIC X.
  1815     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1816
  1817     12  AM-STD-AH-TYPE                    PIC XX.
  1818     12  AM-EARN-METHODS.
  1819         16  AM-EARN-METHOD-R              PIC X.
  1820             88 AM-REF-RL-R78                 VALUE 'R'.
  1821             88 AM-REF-RL-PR                  VALUE 'P'.
  1822             88 AM-REF-RL-MEAN                VALUE 'M'.
  1823             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1824         16  AM-EARN-METHOD-L              PIC X.
  1825             88 AM-REF-LL-R78                 VALUE 'R'.
  1826             88 AM-REF-LL-PR                  VALUE 'P'.
  1827             88 AM-REF-LL-MEAN                VALUE 'M'.
  1828             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1829         16  AM-EARN-METHOD-A              PIC X.
  1830             88 AM-REF-AH-R78                 VALUE 'R'.
  1831             88 AM-REF-AH-PR                  VALUE 'P'.
  1832             88 AM-REF-AH-MEAN                VALUE 'M'.
  1833             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1834             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1835             88 AM-REF-AH-NET                 VALUE 'N'.
  1836
  1837     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1838     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1839     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1840
  1841     12  AM-RET-Y-N                        PIC X.
  1842     12  AM-RET-P-E                        PIC X.
  1843     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1844     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1845     12  AM-RET-GRP                        PIC X(6).
  1846     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1847         16  AM-POOL-PRIME                 PIC XXX.
  1848         16  AM-POOL-SUB                   PIC XXX.
  1849     12  AM-RETRO-EARNINGS.
  1850         16  AM-RET-EARN-R                 PIC X.
  1851         16  AM-RET-EARN-L                 PIC X.
  1852         16  AM-RET-EARN-A                 PIC X.
  1853     12  AM-RET-ST-TAX-USE                 PIC X.
  1854         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1855         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1856     12  AM-RETRO-BEG-EARNINGS.
  1857         16  AM-RET-BEG-EARN-R             PIC X.
  1858         16  AM-RET-BEG-EARN-L             PIC X.
  1859         16  AM-RET-BEG-EARN-A             PIC X.
  1860     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1861     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1862
  1863     12  AM-USER-SELECT-OPTIONS.
  1864         16  AM-USER-SELECT-1              PIC X(10).
  1865         16  AM-USER-SELECT-2              PIC X(10).
  1866         16  AM-USER-SELECT-3              PIC X(10).
  1867         16  AM-USER-SELECT-4              PIC X(10).
  1868         16  AM-USER-SELECT-5              PIC X(10).
  1869
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  34
* NSRLTRBL.cbl
  1870     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1871
  1872     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1873
  1874     12  AM-RPT045A-SWITCH                 PIC X.
  1875         88  RPT045A-OFF                   VALUE 'N'.
  1876
  1877     12  AM-INSURANCE-LIMITS.
  1878         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1879         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1880
  1881     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1882         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1883
  1884     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1885         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1886         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1887
  1888     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1889
  1890     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1891     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1892     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1893     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1894     12  AM-DCC-UEF-STATE                  PIC XX.
  1895     12  FILLER                            PIC XXX.
  1896     12  AM-REPORT-CODE-3                  PIC X(10).
  1897*    12  FILLER                            PIC X(22).
  1898
  1899     12  AM-RESERVE-DATE.
  1900         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1901         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1902         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1903
  1904     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1905     12  AM-NOTIFICATION-TYPES.
  1906         16  AM-NOTIF-OF-LETTERS           PIC X.
  1907         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1908         16  AM-NOTIF-OF-REPORTS           PIC X.
  1909         16  AM-NOTIF-OF-STATUS            PIC X.
  1910
  1911     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1912         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1913         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1914         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1915         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1916
  1917     12  AM-BENEFIT-CONTROLS.
  1918         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1919             20  AM-BENEFIT-CODE           PIC XX.
  1920             20  AM-BENEFIT-TYPE           PIC X.
  1921             20  AM-BENEFIT-REVISION       PIC XXX.
  1922             20  AM-BENEFIT-REM-TERM       PIC X.
  1923             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1924             20  FILLER                    PIC XX.
  1925         16  FILLER                        PIC X(80).
  1926
  1927     12  AM-TRANSFER-DATA.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  35
* NSRLTRBL.cbl
  1928         16  AM-TRANSFERRED-FROM.
  1929             20  AM-TRNFROM-CARRIER        PIC X.
  1930             20  AM-TRNFROM-GROUPING.
  1931                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1932                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1933             20  AM-TRNFROM-STATE          PIC XX.
  1934             20  AM-TRNFROM-ACCOUNT.
  1935                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1936                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1937             20  AM-TRNFROM-DTE            PIC XX.
  1938         16  AM-TRANSFERRED-TO.
  1939             20  AM-TRNTO-CARRIER          PIC X.
  1940             20  AM-TRNTO-GROUPING.
  1941                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1942                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1943             20  AM-TRNTO-STATE            PIC XX.
  1944             20  AM-TRNTO-ACCOUNT.
  1945                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1946                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1947             20  AM-TRNTO-DTE              PIC XX.
  1948         16  FILLER                        PIC X(10).
  1949
  1950     12  AM-SAVED-REMIT-TO                 PIC 99.
  1951
  1952     12  AM-COMM-STRUCTURE-SAVED.
  1953         16  AM-DEFN-1-SAVED.
  1954             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1955                 24  AM-AGT-SV             PIC X(10).
  1956                 24  AM-COM-TYP-SV         PIC X.
  1957                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1958                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1959                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1960                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1961                 24  FILLER                PIC X.
  1962                 24  AM-GL-CODES-SV        PIC X.
  1963                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1964                 24  FILLER                PIC X.
  1965         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1966             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1967                 24  FILLER                PIC X(11).
  1968                 24  AM-L-COMA-SV          PIC XXX.
  1969                 24  AM-J-COMA-SV          PIC XXX.
  1970                 24  AM-A-COMA-SV          PIC XXX.
  1971                 24  FILLER                PIC X(6).
  1972
  1973     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1974         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1975            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1976            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1977            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1978
  1979     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1980     12  FILLER                            PIC X(120).
  1981
  1982     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1983         16  AM-CONTROL-NAME               PIC X(30).
  1984         16  AM-EXECUTIVE-ONE.
  1985             20  AM-EXEC1-NAME             PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  36
* NSRLTRBL.cbl
  1986             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1987                                                          COMP-3.
  1988             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1989                                                          COMP-3.
  1990         16  AM-EXECUTIVE-TWO.
  1991             20  AM-EXEC2-NAME             PIC X(15).
  1992             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1993                                                          COMP-3.
  1994             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1995                                                          COMP-3.
  1996
  1997     12  AM-RETRO-ADDITIONAL-DATA.
  1998         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1999         16  AM-RETRO-PREM-P-E             PIC X.
  2000         16  AM-RETRO-CLMS-P-I             PIC X.
  2001         16  AM-RETRO-RET-BRACKET-LF.
  2002             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2003                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2004                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2005             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2006                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2007                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2008             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2009                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2010                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2011         16  AM-RETRO-RET-BRACKET-AH.
  2012             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2013                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2014                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2015                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2016             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2017                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2018                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2019             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2020                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2021                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2022
  2023     12  AM-COMMENTS.
  2024         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2025
  2026     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2027         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2028         16  AM-FLI-BILLING-CODE           PIC X.
  2029         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2030         16  AM-FLI-UNITED-IDENT           PIC X.
  2031         16  AM-FLI-INTEREST-LOST-DATA.
  2032             20  AM-FLI-BANK-NO            PIC X(5).
  2033             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2034             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2035             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2036         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2037             20  AM-FLI-AGT                PIC X(9).
  2038             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2039             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2040         16  FILLER                        PIC X(102).
  2041
  2042     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2043         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  37
* NSRLTRBL.cbl
  2044             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2045             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2046             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2047             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2048             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2049         16  FILLER                          PIC X(10).
  2050******************************************************************
  2051*                                COPY ELCBENE.
  2052******************************************************************
  2053*                                                                *
  2054*                            ELCBENE.                            *
  2055*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2056*                            VMOD=2.006                          *
  2057*                                                                *
  2058*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  2059*                                                                *
  2060*   FILE TYPE = VSAM,KSDS                                        *
  2061*   RECORD SIZE = 500   RECFORM = FIX                            *
  2062*                                                                *
  2063*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  2064*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  2065*                                                                *
  2066*   LOG = YES                                                    *
  2067*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2068*                                                                *
  2069*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  2070******************************************************************
  2071*                   C H A N G E   L O G
  2072*
  2073* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2074*-----------------------------------------------------------------
  2075*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2076* EFFECTIVE    NUMBER
  2077*-----------------------------------------------------------------
  2078* 013017  CR2016053100001  PEMA  ACH PROCESSING
  2079* 082317  CR2017082100003  PEMA  Add sub type
  2080******************************************************************
  2081
  2082 01  BENEFICIARY-MASTER.
  2083     12  BE-RECORD-ID                PIC XX.
  2084         88  VALID-BE-ID                VALUE 'BE'.
  2085
  2086     12  BE-CONTROL-PRIMARY.
  2087         16  BE-COMPANY-CD           PIC X.
  2088         16  BE-RECORD-TYPE          PIC X.
  2089             88  BENEFICIARY-RECORD  VALUE 'B'.
  2090             88  ADJUSTOR-RECORD     VALUE 'A'.
  2091         16  BE-BENEFICIARY          PIC X(10).
  2092     12  BE-CONTROL-BY-NAME.
  2093         16  BE-COMPANY-CD-A1        PIC X.
  2094         16  BE-RECORD-TYPE-A1       PIC X.
  2095         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  2096         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  2097
  2098     12  BE-LAST-MAINT-DT            PIC XX.
  2099     12  BE-LAST-MAINT-BY            PIC X(4).
  2100     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  2101
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  38
* NSRLTRBL.cbl
  2102     12  BE-ADDRESS-DATA.
  2103         16  BE-MAIL-TO-NAME         PIC X(30).
  2104         16  BE-ADDRESS-LINE-1       PIC X(30).
  2105         16  BE-ADDRESS-LINE-2       PIC X(30).
  2106         16  BE-ADDRESS-LINE-3       PIC X(30).
  2107         16  BE-CITY-STATE.
  2108             20  BE-CITY             PIC X(28).
  2109             20  BE-STATE            PIC XX.
  2110         16  BE-ZIP-CODE.
  2111             20  BE-ZIP-PRIME.
  2112                 24  BE-ZIP-1ST      PIC X.
  2113                     88  BE-CANADIAN-POST-CODE
  2114                                         VALUE 'A' THRU 'Z'.
  2115                 24  FILLER          PIC X(4).
  2116             20  BE-ZIP-PLUS4        PIC X(4).
  2117         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  2118             20  BE-CAN-POSTAL-1     PIC XXX.
  2119             20  BE-CAN-POSTAL-2     PIC XXX.
  2120             20  FILLER              PIC XXX.
  2121         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  2122         16  BE-GROUP-CHECKS-Y-N     PIC X.
  2123
  2124******************************************************************
  2125*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  2126*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  2127******************************************************************
  2128     12  BE-CARRIER                  PIC X.
  2129
  2130     12  BE-ADDRESS-DATA2.
  2131         16  BE-MAIL-TO-NAME2        PIC X(30).
  2132         16  BE-ADDRESS-LINE-12      PIC X(30).
  2133         16  BE-ADDRESS-LINE-22      PIC X(30).
  2134         16  BE-ADDRESS-LINE-32      PIC X(30).
  2135         16  BE-CITY-STATE2.
  2136             20  BE-CITY2            PIC X(28).
  2137             20  BE-STATE2           PIC XX.
  2138         16  BE-ZIP-CODE2.
  2139             20  BE-ZIP-PRIME2.
  2140                 24  BE-ZIP-1ST2     PIC X.
  2141                     88  BE-CANADIAN-POST-CODE2
  2142                                         VALUE 'A' THRU 'Z'.
  2143                 24  FILLER          PIC X(4).
  2144             20  BE-ZIP-PLUS42       PIC X(4).
  2145         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  2146             20  BE-CAN-POSTAL-12    PIC XXX.
  2147             20  BE-CAN-POSTAL-22    PIC XXX.
  2148             20  FILLER              PIC XXX.
  2149         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  2150         16  BE-ACH-DATA.
  2151             20  BE-ACH-YES-OR-NO    PIC X.
  2152                 88  BE-ON-ACH       VALUE 'Y'.
  2153                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  2154             20  BE-ACH-ABA-ROUTING-NUMBER
  2155                                     PIC X(15).
  2156             20  BE-ACH-BANK-ACCOUNT-NUMBER
  2157                                     PIC X(20).
  2158             20  BE-ACH-SUB-TYPE     PIC XX.
  2159             20  FILLER              PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  39
* NSRLTRBL.cbl
  2160         16  BE-BILLING-STMT-DATA.
  2161*            20  BE-BSR              PIC X.
  2162*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  2163*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  2164*            20  BE-BSR-FROM         PIC X(30).
  2165*            20  BE-BSR-DEPT         PIC X(30).
  2166             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  2167             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  2168             20  BE-OUTPUT-TYPE      PIC X.
  2169                 88  BE-FAX-OUTPUT         VALUE 'F'.
  2170                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  2171
  2172     12  FILLER                      PIC X(28).
  2173******************************************************************
  2174*                                COPY ELCTEXT.
  2175******************************************************************
  2176*                                                                *
  2177*                                                                *
  2178*                            ELCTEXT.                            *
  2179*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2180*                            VMOD=2.008                          *
  2181*                                                                *
  2182*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2183*                                     FORM LETTERS,              *
  2184*                                     CERT FORM DISPLAY.
  2185*                                                                *
  2186*   FILE TYPE = VSAM,KSDS                                        *
  2187*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2188*                                                                *
  2189*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2190*       ALTERNATE INDEX = NONE                                   *
  2191*                                                                *
  2192*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2193*       ALTERNATE INDEX = NONE                                   *
  2194*                                                                *
  2195*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  2196*       ALTERNATE INDEX = NONE                                   *
  2197*                                                                *
  2198*   LOG = NO                                                     *
  2199*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2200******************************************************************
  2201 01  TEXT-FILES.
  2202     12  TEXT-FILE-ID                PIC XX.
  2203         88  FORMS-FILE-TEXT            VALUE 'TF'.
  2204         88  LETTER-FILE-TEXT           VALUE 'TL'.
  2205         88  HELP-FILE-TEXT             VALUE 'TH'.
  2206
  2207     12  TX-CONTROL-PRIMARY.
  2208         16  TX-COMPANY-CD           PIC X.
  2209             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  2210         16  TX-ACCESS-CD-GENL       PIC X(12).
  2211
  2212         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2213             20  TX-LETTER-NO        PIC X(4).
  2214             20  FILLER              PIC X(8).
  2215
  2216         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2217             20  TX-FORM-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  40
* NSRLTRBL.cbl
  2218
  2219         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2220             20  TX-HELP-TYPE        PIC X.
  2221                 88  HELP-FOR-GENERAL   VALUE ' '.
  2222                 88  HELP-BY-SCREEN     VALUE 'S'.
  2223                 88  HELP-BY-ERROR      VALUE 'E'.
  2224             20  TX-SCREEN-OR-ERROR  PIC X(4).
  2225                 88  GENERAL-INFO-HELP  VALUE '0000'.
  2226             20  TX-HELP-FOR-COMPANY  PIC XXX.
  2227                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  2228             20  FILLER              PIC X(4).
  2229
  2230         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  2231
  2232     12  TX-PROCESS-CONTROL          PIC XX.
  2233         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  2234
  2235     12  TX-TEXT-LINE                PIC X(70).
  2236
  2237     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  2238         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  2239         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  2240         88  TX-VALID-FORM-SQUEEZE-VALUE
  2241                                        VALUE 'Y' ' '.
  2242
  2243     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  2244         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  2245         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  2246         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  2247         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  2248         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  2249         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  2250         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  2251                                              'K' 'N' ' '
  2252                                              'Z'.
  2253
  2254     12  TX-ARCHIVE-SW               PIC X.
  2255         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  2256         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  2257         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  2258
  2259     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  2260     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  2261
  2262     12  TX-BSR-CODE                 PIC X.
  2263         88  TX-BSR-LETTER              VALUE 'B'.
  2264         88  TX-NON-BSR-LETTER          VALUE ' '.
  2265
  2266     12  FILLER                      PIC X.
  2267*****************************************************************
  2268*                                COPY ELCCNTL.
  2269******************************************************************
  2270*                                                                *
  2271*                                                                *
  2272*                            ELCCNTL.                            *
  2273*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2274*                            VMOD=2.059                          *
  2275*                                                                *
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  41
* NSRLTRBL.cbl
  2276*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2277*                                                                *
  2278*   FILE TYPE = VSAM,KSDS                                        *
  2279*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2280*                                                                *
  2281*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2282*       ALTERNATE INDEX = NONE                                   *
  2283*                                                                *
  2284*   LOG = YES                                                    *
  2285*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2286******************************************************************
  2287*                   C H A N G E   L O G
  2288*
  2289* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2290*-----------------------------------------------------------------
  2291*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2292* EFFECTIVE    NUMBER
  2293*-----------------------------------------------------------------
  2294* 082503                   PEMA  ADD BENEFIT GROUP
  2295* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2296* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2297* 092705    2005050300006  PEMA  ADD SPP LEASES
  2298* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2299* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2300* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2301* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2302* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2303* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2304* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2305* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2306* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2307* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2308* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2309******************************************************************
  2310*
  2311 01  CONTROL-FILE.
  2312     12  CF-RECORD-ID                       PIC XX.
  2313         88  VALID-CF-ID                        VALUE 'CF'.
  2314
  2315     12  CF-CONTROL-PRIMARY.
  2316         16  CF-COMPANY-ID                  PIC XXX.
  2317         16  CF-RECORD-TYPE                 PIC X.
  2318             88  CF-COMPANY-MASTER              VALUE '1'.
  2319             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2320             88  CF-STATE-MASTER                VALUE '3'.
  2321             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2322             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2323             88  CF-CARRIER-MASTER              VALUE '6'.
  2324             88  CF-MORTALITY-MASTER            VALUE '7'.
  2325             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2326             88  CF-TERMINAL-MASTER             VALUE '9'.
  2327             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2328             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2329             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2330             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2331             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2332             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2333             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  42
* NSRLTRBL.cbl
  2334             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2335             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2336         16  CF-ACCESS-CD-GENL              PIC X(4).
  2337         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2338             20  CF-PROCESSOR               PIC X(4).
  2339         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2340             20  CF-STATE-CODE              PIC XX.
  2341             20  FILLER                     PIC XX.
  2342         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2343             20  FILLER                     PIC XX.
  2344             20  CF-HI-BEN-IN-REC           PIC XX.
  2345         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2346             20  FILLER                     PIC XXX.
  2347             20  CF-CARRIER-CNTL            PIC X.
  2348         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2349             20  FILLER                     PIC XX.
  2350             20  CF-HI-TYPE-IN-REC          PIC 99.
  2351         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2352             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2353                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2354             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2355             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2356         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2357             20  FILLER                     PIC X.
  2358             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2359         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2360             20  FILLER                     PIC XX.
  2361             20  CF-MORTGAGE-PLAN           PIC XX.
  2362         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2363
  2364     12  CF-LAST-MAINT-DT                   PIC XX.
  2365     12  CF-LAST-MAINT-BY                   PIC X(4).
  2366     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2367
  2368     12  CF-RECORD-BODY                     PIC X(728).
  2369
  2370
  2371****************************************************************
  2372*             COMPANY MASTER RECORD                            *
  2373****************************************************************
  2374
  2375     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2376         16  CF-COMPANY-ADDRESS.
  2377             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2378             20  CF-CL-IN-CARE-OF           PIC X(30).
  2379             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2380             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2381             20  CF-CL-CITY-STATE           PIC X(30).
  2382             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2383             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2384         16  CF-COMPANY-CD                  PIC X.
  2385         16  CF-COMPANY-PASSWORD            PIC X(8).
  2386         16  CF-SECURITY-OPTION             PIC X.
  2387             88  ALL-SECURITY                   VALUE '1'.
  2388             88  COMPANY-VERIFY                 VALUE '2'.
  2389             88  PROCESSOR-VERIFY               VALUE '3'.
  2390             88  NO-SECURITY                    VALUE '4'.
  2391             88  ALL-BUT-TERM                   VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  43
* NSRLTRBL.cbl
  2392         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2393             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2394         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2395             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2396         16  CF-INFORCE-LOCATION            PIC X.
  2397             88  CERTS-ARE-ONLINE               VALUE '1'.
  2398             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2399             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2400         16  CF-LOWER-CASE-LETTERS          PIC X.
  2401         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2402             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2403             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2404             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2405             88  CF-ACCNT-CNTL                  VALUE '3'.
  2406             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2407
  2408         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2409         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2410
  2411         16  CF-LGX-CREDIT-USER             PIC X.
  2412             88  CO-IS-NOT-USER                 VALUE 'N'.
  2413             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2414
  2415         16 CF-CREDIT-CALC-CODES.
  2416             20  CF-CR-REM-TERM-CALC PIC X.
  2417               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2418               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2419               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2420               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2421               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2422               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2423               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2424             20  CF-CR-R78-METHOD           PIC X.
  2425               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2426               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2427
  2428         16  CF-CLAIM-CONTROL-COUNTS.
  2429             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2430                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2431
  2432             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2433                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2434
  2435             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2436                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2437
  2438             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2439                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2440
  2441         16  CF-CURRENT-MONTH-END           PIC XX.
  2442
  2443         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2444             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2445             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2446             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2447             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2448                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2449                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  44
* NSRLTRBL.cbl
  2450             20  CF-CO-PREM-REJECT-SW       PIC X.
  2451                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2452                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2453             20  CF-CO-REF-REJECT-SW        PIC X.
  2454                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2455                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2456
  2457         16  CF-CO-REPORTING-DT             PIC XX.
  2458         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2459         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2460           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2461           88  CF-CO-MONTH-END                  VALUE '1'.
  2462
  2463         16  CF-LGX-CLAIM-USER              PIC X.
  2464             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2465             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2466
  2467         16  CF-CREDIT-EDIT-CONTROLS.
  2468             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2469             20  CF-MIN-AGE                 PIC 99.
  2470             20  CF-DEFAULT-AGE             PIC 99.
  2471             20  CF-MIN-TERM                PIC S999      COMP-3.
  2472             20  CF-MAX-TERM                PIC S999      COMP-3.
  2473             20  CF-DEFAULT-SEX             PIC X.
  2474             20  CF-JOINT-AGE-INPUT         PIC X.
  2475                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2476             20  CF-BIRTH-DATE-INPUT        PIC X.
  2477                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2478             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2479                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2480                 88  CF-ZERO-CARRIER            VALUE '1'.
  2481                 88  CF-ZERO-GROUPING           VALUE '2'.
  2482                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2483             20  CF-EDIT-SW                 PIC X.
  2484                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2485             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2486             20  CF-CR-PR-METHOD            PIC X.
  2487               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2488               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2489             20  FILLER                     PIC X.
  2490
  2491         16  CF-CREDIT-MISC-CONTROLS.
  2492             20  CF-REIN-TABLE-SW           PIC X.
  2493                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2494             20  CF-COMP-TABLE-SW           PIC X.
  2495                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2496             20  CF-EXPERIENCE-RETENTION-AGE
  2497                                            PIC S9        COMP-3.
  2498             20  CF-CONVERSION-DT           PIC XX.
  2499             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2500             20  CF-RUN-FREQUENCY-SW        PIC X.
  2501                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2502                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2503
  2504             20  CF-CR-CHECK-NO-CONTROL.
  2505                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2506                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2507                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  45
* NSRLTRBL.cbl
  2508                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2509                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2510                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2511
  2512                 24  CF-CR-CHECK-COUNT       REDEFINES
  2513                     CF-CR-CHECK-COUNTER      PIC X(4).
  2514
  2515                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2516                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2517
  2518                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2519                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2520                 24  CF-MAIL-PROCESSING       PIC X.
  2521                     88  MAIL-PROCESSING          VALUE 'Y'.
  2522
  2523         16  CF-MISC-SYSTEM-CONTROL.
  2524             20  CF-SYSTEM-C                 PIC X.
  2525                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2526             20  CF-SYSTEM-D                 PIC X.
  2527                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2528             20  CF-SOC-SEC-NO-SW            PIC X.
  2529                 88  SOC-SEC-NO-USED             VALUE '1'.
  2530             20  CF-MEMBER-NO-SW             PIC X.
  2531                 88  MEMBER-NO-USED              VALUE '1'.
  2532             20  CF-TAX-ID-NUMBER            PIC X(11).
  2533             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2534             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2535                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2536                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2537                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2538                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2539             20  CF-SYSTEM-E                 PIC X.
  2540                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2541
  2542         16  CF-LGX-LIFE-USER               PIC X.
  2543             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2544             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2545
  2546         16  CF-CR-MONTH-END-DT             PIC XX.
  2547
  2548         16  CF-FILE-MAINT-DATES.
  2549             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2550                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2551             20  CF-LAST-BATCH       REDEFINES
  2552                 CF-LAST-BATCH-NO               PIC X(4).
  2553             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2554             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2555             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2556             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2557             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2558             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2559             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2560             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2561             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2562             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2563
  2564         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2565         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  46
* NSRLTRBL.cbl
  2566
  2567         16  CF-ALT-MORT-CODE               PIC X(4).
  2568         16  CF-MEMBER-CAPTION              PIC X(10).
  2569
  2570         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2571             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2572             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2573             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2574             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2575             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2576
  2577         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2578
  2579         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2580         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2581         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2582         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2583
  2584         16  CF-AH-OVERRIDE-L1              PIC X.
  2585         16  CF-AH-OVERRIDE-L2              PIC XX.
  2586         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2587         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2588
  2589         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2590         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2591
  2592         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2593         16  CF-AR-LAST-EL860-DT            PIC XX.
  2594         16  CF-MP-MONTH-END-DT             PIC XX.
  2595
  2596         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2597         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2598             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2599
  2600         16  CF-AR-MONTH-END-DT             PIC XX.
  2601
  2602         16  CF-CRDTCRD-USER                PIC X.
  2603             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2604             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2605
  2606         16  CF-CC-MONTH-END-DT             PIC XX.
  2607
  2608         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2609
  2610         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2611             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2612             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2613             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2614         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2615         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2616         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2617         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2618             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2619             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2620         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2621         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2622         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2623             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  47
* NSRLTRBL.cbl
  2624         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2625
  2626         16  CF-CL-ZIP-CODE.
  2627             20  CF-CL-ZIP-PRIME.
  2628                 24  CF-CL-ZIP-1ST          PIC X.
  2629                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2630                 24  FILLER                 PIC X(4).
  2631             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2632         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2633             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2634             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2635             20  FILLER                     PIC XXX.
  2636
  2637         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2638         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2639         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2640         16  CF-CO-OPTION-START-DATE        PIC XX.
  2641         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2642           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2643                                                      '3' '4'.
  2644           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2645           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2646           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2647           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2648           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2649           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2650
  2651         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2652
  2653         16  CF-PAYMENT-APPROVAL-LEVELS.
  2654             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2655             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2656             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2657             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2658             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2659             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2660
  2661         16  CF-END-USER-REPORTING-USER     PIC X.
  2662             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2663             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2664
  2665         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2666             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2667             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2668
  2669         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2670
  2671         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2672         16  FILLER                         PIC X.
  2673
  2674         16  CF-CREDIT-ARCHIVE-CNTL.
  2675             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2676             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2677             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2678
  2679         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2680
  2681         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  48
* NSRLTRBL.cbl
  2682             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2683             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2684
  2685         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2686             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2687             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2688
  2689         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2690
  2691         16  CF-CO-ACH-ID-CODE              PIC  X.
  2692             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2693             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2694             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2695         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2696         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2697         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2698         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2699         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2700         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2701         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2702         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2703         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2704                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2705         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2706                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2707
  2708         16  CF-CO-OVER-SHORT.
  2709             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2710             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2711
  2712*         16  FILLER                         PIC X(102).
  2713         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2714             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2715             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2716
  2717         16  CF-AH-APPROVAL-DAYS.
  2718             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2719             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2720             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2721             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2722
  2723         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2724
  2725         16  CF-APPROV-LEV-5.
  2726             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2727             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2728             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2729
  2730         16  FILLER                         PIC X(68).
  2731****************************************************************
  2732*             PROCESSOR/USER RECORD                            *
  2733****************************************************************
  2734
  2735     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2736         16  CF-PROCESSOR-NAME              PIC X(30).
  2737         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2738         16  CF-PROCESSOR-TITLE             PIC X(26).
  2739         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  49
* NSRLTRBL.cbl
  2740                 88  MESSAGE-YES                VALUE 'Y'.
  2741                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2742
  2743*****************************************************
  2744****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2745****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2746****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2747****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2748*****************************************************
  2749
  2750         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2751             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2752             20  CF-APPLICATION-FORCE       PIC X.
  2753             20  CF-INDIVIDUAL-APP.
  2754                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2755                     28  CF-BROWSE-APP      PIC X.
  2756                     28  CF-UPDATE-APP      PIC X.
  2757
  2758         16  CF-CURRENT-TERM-ON             PIC X(4).
  2759         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2760             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2761             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2762             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2763             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2764             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2765             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2766             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2767         16  CF-PROCESSOR-CARRIER           PIC X.
  2768             88  NO-CARRIER-SECURITY            VALUE ' '.
  2769         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2770             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2771         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2772             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2773         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2774             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2775
  2776         16  CF-PROC-SYS-ACCESS-SW.
  2777             20  CF-PROC-CREDIT-CLAIMS-SW.
  2778                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2779                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2780                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2781                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2782             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2783                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2784                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2785             20  CF-PROC-LIFE-GNRLDGR-SW.
  2786                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2787                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2788                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2789                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2790             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2791                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2792                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2793         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2794             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2795             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2796         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2797
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  50
* NSRLTRBL.cbl
  2798         16  CF-APPROVAL-LEVEL                  PIC X.
  2799             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2800             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2801             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2802             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2803             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2804
  2805         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2806
  2807         16  CF-LANGUAGE-TYPE                   PIC X.
  2808             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2809             88  CF-LANG-IS-FR                      VALUE 'F'.
  2810
  2811         16  CF-CSR-IND                         PIC X.
  2812         16  FILLER                             PIC X(239).
  2813
  2814****************************************************************
  2815*             PROCESSOR/REMINDERS RECORD                       *
  2816****************************************************************
  2817
  2818     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2819         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2820             20  CF-START-REMIND-DT         PIC XX.
  2821             20  CF-END-REMIND-DT           PIC XX.
  2822             20  CF-REMINDER-TEXT           PIC X(50).
  2823         16  FILLER                         PIC X(296).
  2824
  2825
  2826****************************************************************
  2827*             STATE MASTER RECORD                              *
  2828****************************************************************
  2829
  2830     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2831         16  CF-STATE-ABBREVIATION          PIC XX.
  2832         16  CF-STATE-NAME                  PIC X(25).
  2833         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2834         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2835             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2836             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2837             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2838             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2839                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2840                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2841             20  CF-ST-PREM-REJECT-SW       PIC X.
  2842                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2843                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2844             20  CF-ST-REF-REJECT-SW        PIC X.
  2845                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2846                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2847         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2848         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2849         16  CF-ST-REFUND-RULES.
  2850             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2851             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2852             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2853         16  CF-ST-FST-PMT-EXTENSION.
  2854             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2855             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  51
* NSRLTRBL.cbl
  2856                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2857                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2858                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2859                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2860         16  CF-ST-STATE-CALL.
  2861             20  CF-ST-CALL-UNEARNED        PIC X.
  2862             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2863             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2864         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2865             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2866             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2867         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2868         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2869         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2870         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2871         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2872         16  FILLER                         PIC X.
  2873         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2874             20  CF-ST-BENEFIT-CD           PIC XX.
  2875             20  CF-ST-BENEFIT-KIND         PIC X.
  2876                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2877                 88  CF-ST-AH-KIND              VALUE 'A'.
  2878             20  CF-ST-REM-TERM-CALC        PIC X.
  2879                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2880                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2881                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2882                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2883                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2884                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2885                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2886                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2887
  2888             20  CF-ST-REFUND-CALC          PIC X.
  2889                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2890                 88  ST-REFD-BY-R78             VALUE '1'.
  2891                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2892                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2893                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2894                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2895                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2896                 88  ST-REFD-UTAH               VALUE '7'.
  2897                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2898                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2899                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2900
  2901             20  CF-ST-EARNING-CALC         PIC X.
  2902                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2903                 88  ST-EARN-BY-R78             VALUE '1'.
  2904                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2905                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2906                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2907                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2908                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2909                 88  ST-EARN-MEAN               VALUE '8'.
  2910                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2911
  2912             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2913                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  52
* NSRLTRBL.cbl
  2914                 88  ST-OVRD-BY-R78             VALUE '1'.
  2915                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2916                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2917                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2918                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2919                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2920                 88  ST-OVRD-MEAN               VALUE '8'.
  2921                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2922             20  cf-st-extra-periods        pic 9.
  2923*            20  FILLER                     PIC X.
  2924
  2925         16  CF-ST-COMMISSION-CAPS.
  2926             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2927             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2928             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2929             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2930         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2931                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2932                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  2933                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  2934
  2935         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2936
  2937         16  CF-ST-STATUTORY-INTEREST.
  2938             20  CF-ST-STAT-DATE-FROM       PIC X.
  2939                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2940                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2941             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2942             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2943             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2944             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2945             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2946
  2947         16  CF-ST-OVER-SHORT.
  2948             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2949             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2950
  2951         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2952
  2953         16  CF-ST-RT-CALC                  PIC X.
  2954
  2955         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2956         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2957         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2958         16  CF-ST-RF-LR-CALC               PIC X.
  2959         16  CF-ST-RF-LL-CALC               PIC X.
  2960         16  CF-ST-RF-LN-CALC               PIC X.
  2961         16  CF-ST-RF-AH-CALC               PIC X.
  2962         16  CF-ST-RF-CP-CALC               PIC X.
  2963*        16  FILLER                         PIC X(206).
  2964*CIDMOD         16  FILLER                         PIC X(192).
  2965         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2966             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2967         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2968         16  CF-ST-VFY-2ND-BENE             PIC X.
  2969         16  CF-ST-CAUSAL-STATE             PIC X.
  2970         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2971         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  53
* NSRLTRBL.cbl
  2972         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2973             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2974         16  CF-ST-NET-ONLY-STATE           PIC X.
  2975             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2976         16  cf-commission-cap-required     pic x.
  2977         16  CF-ST-GA-COMMISSION-CAPS.
  2978             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2979             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2980             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2981             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2982         16  CF-ST-TOT-COMMISSION-CAPS.
  2983             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2984             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2985             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2986             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2987         16  FILLER                         PIC X(156).
  2988
  2989****************************************************************
  2990*             BENEFIT MASTER RECORD                            *
  2991****************************************************************
  2992
  2993     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2994         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2995             20  CF-BENEFIT-CODE            PIC XX.
  2996             20  CF-BENEFIT-NUMERIC  REDEFINES
  2997                 CF-BENEFIT-CODE            PIC XX.
  2998             20  CF-BENEFIT-ALPHA           PIC XXX.
  2999             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3000             20  CF-BENEFIT-COMMENT         PIC X(10).
  3001
  3002             20  CF-LF-COVERAGE-TYPE        PIC X.
  3003                 88  CF-REDUCING                VALUE 'R'.
  3004                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3005
  3006             20  CF-SPECIAL-CALC-CD         PIC X.
  3007                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3008                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3009                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3010                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3011                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3012                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3013                 88  CF-FARM-PLAN               VALUE 'F'.
  3014                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3015                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3016                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3017                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3018                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3019                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3020                 88  CF-PRUDENTIAL              VALUE 'P'.
  3021                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3022                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3023                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3024                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3025                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3026                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3027
  3028             20  CF-JOINT-INDICATOR         PIC X.
  3029                 88  CF-JOINT-COVERAGE          VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  54
* NSRLTRBL.cbl
  3030
  3031*            20  FILLER                     PIC X(12).
  3032             20  cf-maximum-benefits        pic s999 comp-3.
  3033             20  FILLER                     PIC X(09).
  3034             20  CF-BENEFIT-CATEGORY        PIC X.
  3035             20  CF-LOAN-TYPE               PIC X(8).
  3036
  3037             20  CF-CO-REM-TERM-CALC        PIC X.
  3038                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3039                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3040                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3041                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3042                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3043
  3044             20  CF-CO-EARNINGS-CALC        PIC X.
  3045                 88  CO-EARN-BY-R78             VALUE '1'.
  3046                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3047                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3048                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3049                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3050                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3051                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3052                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3053
  3054             20  CF-CO-REFUND-CALC          PIC X.
  3055                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3056                 88  CO-REFD-BY-R78             VALUE '1'.
  3057                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3058                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3059                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3060                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3061                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3062                 88  CO-REFD-MEAN               VALUE '8'.
  3063                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3064                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3065                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3066
  3067             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3068                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3069                 88  CO-OVRD-BY-R78             VALUE '1'.
  3070                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3071                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3072                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3073                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3074                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3075                 88  CO-OVRD-MEAN               VALUE '8'.
  3076                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3077
  3078             20  CF-CO-BEN-I-G-CD           PIC X.
  3079                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3080                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3081                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3082
  3083         16  FILLER                         PIC X(304).
  3084
  3085
  3086****************************************************************
  3087*             CARRIER MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  55
* NSRLTRBL.cbl
  3088****************************************************************
  3089
  3090     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3091         16  CF-ADDRESS-DATA.
  3092             20  CF-MAIL-TO-NAME            PIC X(30).
  3093             20  CF-IN-CARE-OF              PIC X(30).
  3094             20  CF-ADDRESS-LINE-1          PIC X(30).
  3095             20  CF-ADDRESS-LINE-2          PIC X(30).
  3096             20  CF-CITY-STATE              PIC X(30).
  3097             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3098             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3099
  3100         16  CF-CLAIM-NO-CONTROL.
  3101             20  CF-CLAIM-NO-METHOD         PIC X.
  3102                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3103                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3104                 88  CLAIM-NO-SEQ               VALUE '3'.
  3105                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3106             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3107                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3108                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3109                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3110
  3111         16  CF-CHECK-NO-CONTROL.
  3112             20  CF-CHECK-NO-METHOD         PIC X.
  3113                 88  CHECK-NO-MANUAL            VALUE '1'.
  3114                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3115                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3116                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3117             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3118                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3119
  3120         16  CF-DOMICILE-STATE              PIC XX.
  3121
  3122         16  CF-EXPENSE-CONTROLS.
  3123             20  CF-EXPENSE-METHOD          PIC X.
  3124                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3125                 88  DOLLARS-PER-PMT            VALUE '2'.
  3126                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3127                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3128             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3129             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3130
  3131         16  CF-CORRESPONDENCE-CONTROL.
  3132             20  CF-LETTER-RESEND-OPT       PIC X.
  3133                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3134                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3135             20  FILLER                     PIC X(4).
  3136
  3137         16  CF-RESERVE-CONTROLS.
  3138             20  CF-MANUAL-SW               PIC X.
  3139                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3140             20  CF-FUTURE-SW               PIC X.
  3141                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3142             20  CF-PTC-SW                  PIC X.
  3143                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3144             20  CF-IBNR-SW                 PIC X.
  3145                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  56
* NSRLTRBL.cbl
  3146             20  CF-PTC-LF-SW               PIC X.
  3147                 88  CF-LF-PTC-USED             VALUE '1'.
  3148             20  CF-CDT-ACCESS-METHOD       PIC X.
  3149                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3150                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3151                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3152             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3153
  3154         16  CF-CLAIM-CALC-METHOD           PIC X.
  3155             88  360-PLUS-MONTHS                VALUE '1'.
  3156             88  365-PLUS-MONTHS                VALUE '2'.
  3157             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3158             88  360-DAILY                      VALUE '4'.
  3159             88  365-DAILY                      VALUE '5'.
  3160
  3161         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3162         16  FILLER                         PIC X(11).
  3163
  3164         16  CF-LIMIT-AMOUNTS.
  3165             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3166             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3167             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3168             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3169             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3170             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3171             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3172             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3173             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3174             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3175
  3176         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3177         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3178         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3179
  3180         16  CF-ZIP-CODE.
  3181             20  CF-ZIP-PRIME.
  3182                 24  CF-ZIP-1ST             PIC X.
  3183                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3184                 24  FILLER                 PIC X(4).
  3185             20  CF-ZIP-PLUS4               PIC X(4).
  3186         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3187             20  CF-CAN-POSTAL-1            PIC XXX.
  3188             20  CF-CAN-POSTAL-2            PIC XXX.
  3189             20  FILLER                     PIC XXX.
  3190
  3191         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3192         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3193         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3194
  3195         16  CF-RATING-SWITCH               PIC X.
  3196             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3197             88  CF-NO-RATING                   VALUE 'N'.
  3198
  3199         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3200
  3201         16  CF-CARRIER-OVER-SHORT.
  3202             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3203             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  57
* NSRLTRBL.cbl
  3204
  3205         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3206         16  CF-SECPAY-SWITCH               PIC X.
  3207             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3208             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3209         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3210         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3211         16  FILLER                         PIC X(444).
  3212*        16  FILLER                         PIC X(452).
  3213
  3214
  3215****************************************************************
  3216*             MORTALITY MASTER RECORD                          *
  3217****************************************************************
  3218
  3219     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3220         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3221                                INDEXED BY CF-MORT-NDX.
  3222             20  CF-MORT-TABLE              PIC X(5).
  3223             20  CF-MORT-TABLE-TYPE         PIC X.
  3224                 88  CF-MORT-JOINT              VALUE 'J'.
  3225                 88  CF-MORT-SINGLE             VALUE 'S'.
  3226                 88  CF-MORT-COMBINED           VALUE 'C'.
  3227                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3228                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3229             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3230             20  CF-MORT-AGE-METHOD         PIC XX.
  3231                 88  CF-AGE-LAST                VALUE 'AL'.
  3232                 88  CF-AGE-NEAR                VALUE 'AN'.
  3233             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3234             20  CF-MORT-ADJUSTMENT-DIRECTION
  3235                                            PIC X.
  3236                 88  CF-MINUS                   VALUE '-'.
  3237                 88  CF-PLUS                    VALUE '+'.
  3238             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3239             20  CF-MORT-JOINT-CODE         PIC X.
  3240                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3241             20  CF-MORT-PC-Q               PIC X.
  3242                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3243             20  CF-MORT-TABLE-CODE         PIC X(4).
  3244             20  CF-MORT-COMMENTS           PIC X(15).
  3245             20  FILLER                     PIC X(14).
  3246
  3247         16  FILLER                         PIC X(251).
  3248
  3249
  3250****************************************************************
  3251*             BUSSINESS TYPE MASTER RECORD                     *
  3252****************************************************************
  3253
  3254     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3255* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3256* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3257* AND RECORD 05 IS TYPES 81-99
  3258         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3259             20  CF-BUSINESS-TITLE          PIC  X(19).
  3260             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3261                                            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  58
* NSRLTRBL.cbl
  3262             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3263             20  FILLER                     PIC  X.
  3264         16  FILLER                         PIC  X(248).
  3265
  3266
  3267****************************************************************
  3268*             TERMINAL MASTER RECORD                           *
  3269****************************************************************
  3270
  3271     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3272
  3273         16  CF-COMPANY-TERMINALS.
  3274             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3275                                  PIC X(4).
  3276         16  FILLER               PIC X(248).
  3277
  3278
  3279****************************************************************
  3280*             LIFE EDIT MASTER RECORD                          *
  3281****************************************************************
  3282
  3283     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3284         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3285             20  CF-LIFE-CODE-IN            PIC XX.
  3286             20  CF-LIFE-CODE-OUT           PIC XX.
  3287         16  FILLER                         PIC X(248).
  3288
  3289
  3290****************************************************************
  3291*             AH EDIT MASTER RECORD                            *
  3292****************************************************************
  3293
  3294     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3295         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3296             20  CF-AH-CODE-IN              PIC XXX.
  3297             20  CF-AH-CODE-OUT             PIC XX.
  3298         16  FILLER                         PIC X(248).
  3299
  3300
  3301****************************************************************
  3302*             CREDIBILITY TABLES                               *
  3303****************************************************************
  3304
  3305     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3306         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3307                             INDEXED BY CF-CRDB-NDX.
  3308             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3309             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3310             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3311         16  FILLER                         PIC  X(332).
  3312
  3313
  3314****************************************************************
  3315*             REPORT CUSTOMIZATION RECORD                      *
  3316****************************************************************
  3317
  3318     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3319         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  59
* NSRLTRBL.cbl
  3320             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3321             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3322             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3323**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3324****       A T-TRANSFER.                                   ****
  3325             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3326
  3327         16  FILLER                         PIC XX.
  3328
  3329         16  CF-CARRIER-CNTL-OPT.
  3330             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3331                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3332                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3333             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3334                                            PIC X.
  3335         16  CF-GROUP-CNTL-OPT.
  3336             20  CF-GROUP-OPT-SEQ           PIC 9.
  3337                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3338                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3339             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3340                                            PIC X(6).
  3341         16  CF-STATE-CNTL-OPT.
  3342             20  CF-STATE-OPT-SEQ           PIC 9.
  3343                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3344                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3345             20  CF-STATE-SELECT OCCURS 3 TIMES
  3346                                            PIC XX.
  3347         16  CF-ACCOUNT-CNTL-OPT.
  3348             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3349                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3350                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3351             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3352                                            PIC X(10).
  3353         16  CF-BUS-TYP-CNTL-OPT.
  3354             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3355                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3356                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3357             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3358                                            PIC XX.
  3359         16  CF-LF-TYP-CNTL-OPT.
  3360             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3361                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3362                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3363             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3364                                            PIC XX.
  3365         16  CF-AH-TYP-CNTL-OPT.
  3366             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3367                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3368                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3369             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3370                                            PIC XX.
  3371         16  CF-REPTCD1-CNTL-OPT.
  3372             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3373                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3374                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3375             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3376                                            PIC X(10).
  3377         16  CF-REPTCD2-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  60
* NSRLTRBL.cbl
  3378             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3379                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3380                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3381             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3382                                            PIC X(10).
  3383         16  CF-USER1-CNTL-OPT.
  3384             20  CF-USER1-OPT-SEQ           PIC 9.
  3385                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3386                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3387             20  CF-USER1-SELECT OCCURS 3 TIMES
  3388                                            PIC X(10).
  3389         16  CF-USER2-CNTL-OPT.
  3390             20  CF-USER2-OPT-SEQ           PIC 9.
  3391                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3392                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3393             20  CF-USER2-SELECT OCCURS 3 TIMES
  3394                                            PIC X(10).
  3395         16  CF-USER3-CNTL-OPT.
  3396             20  CF-USER3-OPT-SEQ           PIC 9.
  3397                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3398                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3399             20  CF-USER3-SELECT OCCURS 3 TIMES
  3400                                            PIC X(10).
  3401         16  CF-USER4-CNTL-OPT.
  3402             20  CF-USER4-OPT-SEQ           PIC 9.
  3403                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3404                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3405             20  CF-USER4-SELECT OCCURS 3 TIMES
  3406                                            PIC X(10).
  3407         16  CF-USER5-CNTL-OPT.
  3408             20  CF-USER5-OPT-SEQ           PIC 9.
  3409                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3410                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3411             20  CF-USER5-SELECT OCCURS 3 TIMES
  3412                                            PIC X(10).
  3413         16  CF-REINS-CNTL-OPT.
  3414             20  CF-REINS-OPT-SEQ           PIC 9.
  3415                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3416                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3417             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3418                 24  CF-REINS-PRIME         PIC XXX.
  3419                 24  CF-REINS-SUB           PIC XXX.
  3420
  3421         16  CF-AGENT-CNTL-OPT.
  3422             20  CF-AGENT-OPT-SEQ           PIC 9.
  3423                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3424                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3425             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3426                                            PIC X(10).
  3427
  3428         16  FILLER                         PIC X(43).
  3429
  3430         16  CF-LOSS-RATIO-SELECT.
  3431             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3432             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3433         16  CF-ENTRY-DATE-SELECT.
  3434             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3435             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  61
* NSRLTRBL.cbl
  3436         16  CF-EFFECTIVE-DATE-SELECT.
  3437             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3438             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3439
  3440         16  CF-EXCEPTION-LIST-IND          PIC X.
  3441             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3442
  3443         16  FILLER                         PIC X(318).
  3444
  3445****************************************************************
  3446*                  EXCEPTION REPORTING RECORD                  *
  3447****************************************************************
  3448
  3449     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3450         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3451             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3452
  3453         16  CF-COMBINED-LIFE-AH-OPT.
  3454             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3455             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3456             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3457             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3458
  3459         16  CF-LIFE-OPT.
  3460             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3461             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3462             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3463             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3464             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3465             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3466             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3467             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3468             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3469             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3470
  3471         16  CF-AH-OPT.
  3472             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3473             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3474             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3475             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3476             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3477             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3478             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3479             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3480             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3481             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3482
  3483         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3484             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3485             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3486             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3487
  3488         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3489
  3490         16  FILLER                         PIC X(673).
  3491
  3492
  3493****************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  62
* NSRLTRBL.cbl
  3494*             MORTGAGE SYSTEM PLAN RECORD                      *
  3495****************************************************************
  3496
  3497     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3498         16  CF-PLAN-TYPE                   PIC X.
  3499             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3500             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3501             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3502         16  CF-PLAN-ABBREV                 PIC XXX.
  3503         16  CF-PLAN-DESCRIPT               PIC X(10).
  3504         16  CF-PLAN-NOTES                  PIC X(20).
  3505         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3506         16  CF-PLAN-UNDERWRITING.
  3507             20  CF-PLAN-TERM-DATA.
  3508                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3509                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3510             20  CF-PLAN-AGE-DATA.
  3511                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3512                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3513                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3514             20  CF-PLAN-BENEFIT-DATA.
  3515                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3516                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3517                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3518                                            PIC S9(7)V99  COMP-3.
  3519         16  CF-PLAN-POLICY-FORMS.
  3520             20  CF-POLICY-FORM             PIC X(12).
  3521             20  CF-MASTER-APPLICATION      PIC X(12).
  3522             20  CF-MASTER-POLICY           PIC X(12).
  3523         16  CF-PLAN-RATING.
  3524             20  CF-RATE-CODE               PIC X(5).
  3525             20  CF-SEX-RATING              PIC X.
  3526                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3527                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3528             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3529             20  CF-SUB-STD-TYPE            PIC X.
  3530                 88  CF-PCT-OF-PREM            VALUE '1'.
  3531                 88  CF-PCT-OF-BENE            VALUE '2'.
  3532         16  CF-PLAN-PREM-TOLERANCES.
  3533             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3534             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3535         16  CF-PLAN-PYMT-TOLERANCES.
  3536             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3537             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3538         16  CF-PLAN-MISC-DATA.
  3539             20  FILLER                     PIC X.
  3540             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3541             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3542         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3543         16  CF-PLAN-IND-GRP                PIC X.
  3544             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3545                                                     '1'.
  3546             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3547                                                     '2'.
  3548         16  CF-MIB-SEARCH-SW               PIC X.
  3549             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3550             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3551             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  63
* NSRLTRBL.cbl
  3552             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3553         16  CF-ALPHA-SEARCH-SW             PIC X.
  3554             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3555             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3556             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3557             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3558             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3559             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3560             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3561             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3562             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3563             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3564                                                     'A' 'B' 'C'
  3565                                                     'X' 'Y' 'Z'.
  3566         16  CF-EFF-DT-RULE-SW              PIC X.
  3567             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3568             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3569             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3570             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3571             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3572         16  FILLER                         PIC X(4).
  3573         16  CF-HEALTH-QUESTIONS            PIC X.
  3574             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3575         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3576         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3577         16  CF-PLAN-SNGL-JNT               PIC X.
  3578             88  CF-COMBINED-PLAN              VALUE 'C'.
  3579             88  CF-JNT-PLAN                   VALUE 'J'.
  3580             88  CF-SNGL-PLAN                  VALUE 'S'.
  3581         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3582         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3583         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3584         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3585         16  CF-RERATE-CNTL                 PIC  X.
  3586             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3587             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3588             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3589             88  CF-AUTO-RECALC                 VALUE '4'.
  3590         16  CF-BENEFIT-TYPE                PIC  X.
  3591             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3592             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3593         16  CF-POLICY-FEE                  PIC S999V99
  3594                                                    COMP-3.
  3595         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3596         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3597         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3598         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3599         16  FILLER                         PIC  X(32).
  3600         16  CF-TERMINATION-FORM            PIC  X(04).
  3601         16  FILLER                         PIC  X(08).
  3602         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3603                                                       COMP-3.
  3604         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3605         16  CF-ISSUE-LETTER                PIC  X(4).
  3606         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3607         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3608             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3609             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  64
* NSRLTRBL.cbl
  3610         16  CF-MP-REFUND-CALC              PIC X.
  3611             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3612             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3613             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3614             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3615             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3616             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3617             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3618             88  CF-MP-REFD-MEAN                VALUE '8'.
  3619         16  CF-ALT-RATE-CODE               PIC  X(5).
  3620
  3621
  3622         16  FILLER                         PIC X(498).
  3623****************************************************************
  3624*             MORTGAGE COMPANY MASTER RECORD                   *
  3625****************************************************************
  3626
  3627     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3628         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3629         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3630             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3631             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3632             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3633             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3634             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3635
  3636         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3637         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3638         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3639         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3640         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3641
  3642         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3643             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3644         16  CF-MP-RECON-USE-IND            PIC X(1).
  3645             88  CF-MP-USE-RECON             VALUE 'Y'.
  3646         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3647             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3648         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3649             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3650             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3651         16  FILLER                         PIC X(1).
  3652         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3653             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3654         16  CF-MORTG-MIB-VERSION           PIC X.
  3655             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3656             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3657             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3658         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3659             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3660                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3661             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3662                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3663             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3664                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3665             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3666                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3667             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  65
* NSRLTRBL.cbl
  3668                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3669             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3670                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3671         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3672         16  FILLER                         PIC X(7).
  3673         16  CF-MORTG-DESTINATION-SYMBOL.
  3674             20  CF-MORTG-MIB-COMM          PIC X(5).
  3675             20  CF-MORTG-MIB-TERM          PIC X(5).
  3676         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3677             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3678         16  FILLER                         PIC X(03).
  3679         16  CF-MP-CHECK-NO-CONTROL.
  3680             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3681                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3682                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3683                                                ' ' LOW-VALUES.
  3684                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3685                                               VALUE '3'.
  3686         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3687         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3688         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3689             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3690                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3691             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3692                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3693             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3694                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3695             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3696                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3697             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3698                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3699             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3700                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3701         16  CF-MORTG-BILLING-AREA.
  3702             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3703                                            PIC X.
  3704         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3705         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3706         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3707         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3708             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3709             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3710         16  FILLER                         PIC X.
  3711         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3712             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3713             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3714         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3715         16  FILLER                         PIC X(8).
  3716         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3717         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3718         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3719         16  CF-ACH-COMPANY-ID.
  3720             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3721                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3722                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3723                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3724             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3725         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  66
* NSRLTRBL.cbl
  3726             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3727         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3728             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3729             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3730         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3731         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3732         16  FILLER                         PIC X(536).
  3733
  3734****************************************************************
  3735*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3736****************************************************************
  3737
  3738     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3739         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3740             20  CF-FEMALE-HEIGHT.
  3741                 24  CF-FEMALE-FT           PIC 99.
  3742                 24  CF-FEMALE-IN           PIC 99.
  3743             20  CF-FEMALE-MIN-WT           PIC 999.
  3744             20  CF-FEMALE-MAX-WT           PIC 999.
  3745         16  FILLER                         PIC X(428).
  3746
  3747     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3748         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3749             20  CF-MALE-HEIGHT.
  3750                 24  CF-MALE-FT             PIC 99.
  3751                 24  CF-MALE-IN             PIC 99.
  3752             20  CF-MALE-MIN-WT             PIC 999.
  3753             20  CF-MALE-MAX-WT             PIC 999.
  3754         16  FILLER                         PIC X(428).
  3755******************************************************************
  3756*             AUTOMATIC ACTIVITY RECORD                          *
  3757******************************************************************
  3758     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3759         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3760             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3761             20  CF-SYS-LETTER-ID           PIC X(04).
  3762             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3763             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3764             20  CF-SYS-RESET-SW            PIC X(01).
  3765             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3766             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3767
  3768         16  FILLER                         PIC X(50).
  3769
  3770         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3771             20  CF-USER-ACTIVE-SW          PIC X(01).
  3772             20  CF-USER-LETTER-ID          PIC X(04).
  3773             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3774             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3775             20  CF-USER-RESET-SW           PIC X(01).
  3776             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3777             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3778             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3779
  3780         16  FILLER                         PIC X(246).
  3781*                                COPY NSCVARS.
  3782******************************************************************
  3783*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  67
* NSRLTRBL.cbl
  3784*
  3785* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3786*-----------------------------------------------------------------
  3787*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3788* EFFECTIVE    NUMBER
  3789*-----------------------------------------------------------------
  3790* 031912    2011110200002  AJRA  AHL CLAIM NUM
  3791* 013013    2012110080002  AJRA  ADD ACCOUNT GPCD
  3792* 031116    2015110400001  TANA  ADD EL150D FIELDS
  3793* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  3794******************************************************************
  3795 01 NAPER-OUTPUT-DATA.
  3796    05 FILLER              PIC X(6) VALUE "TEMPL=".
  3797    05 OUT-TEMP            PIC X(4).
  3798    05 FILLER              PIC X(8) VALUE "&LETTER=".
  3799    05 OUT-LETTER          PIC X(4).
  3800    05 FILLER              PIC X(6) VALUE "&CARR=".
  3801    05 OUT-CARR            PIC X.
  3802    05 FILLER              PIC X(7) VALUE "&CLMNO=".
  3803    05 OUT-CLMNO           PIC X(7).
  3804    05 FILLER              PIC X(7) VALUE "&CRTNO=".
  3805    05 OUT-CRTNO           PIC X(11).
  3806    05 FILLER              PIC X(7) VALUE "&ACTNO=".
  3807    05 OUT-ACTNO           PIC X(10).
  3808    05 FILLER              PIC X(8) VALUE "&ILNAME=".
  3809    05 OUT-ILNAME          PIC X(15).
  3810    05 FILLER              PIC X(8) VALUE "&IFNAME=".
  3811    05 OUT-IFNAME          PIC X(10).
  3812    05 FILLER              PIC X(7) VALUE "&SEXCD=".
  3813    05 OUT-SEX-CD          PIC X.
  3814    05 FILLER              PIC X(5) VALUE "&SSN=".
  3815    05 OUT-SSN             PIC X(11).
  3816    05 FILLER              PIC X(9) VALUE "&CLMSTAT=".
  3817    05 OUT-CLMSTAT         PIC X.
  3818    05 FILLER              PIC X(8) VALUE "&CLMTYP=".
  3819    05 OUT-CLMTYPE         PIC X.
  3820    05 FILLER              PIC X(7) VALUE "&ESTDT=".
  3821    05 OUT-EST-DT          PIC X(21).
  3822    05 FILLER              PIC X(7) VALUE "&INCDT=".
  3823    05 OUT-INC-DT          PIC X(21).
  3824    05 FILLER              PIC X(7) VALUE "&RPTDT=".
  3825    05 OUT-RPT-DT          PIC X(21).
  3826    05 FILLER              PIC X(10) VALUE "&PDTHRUDT=".
  3827    05 OUT-PD-THRU-DT      PIC X(21).
  3828    05 FILLER              PIC X(11) VALUE "&FORMDUEDT=".
  3829    05 OUT-FORM-DUE-DT     PIC X(21).
  3830    05 FILLER              PIC X(8) VALUE "&LPMTDT=".
  3831    05 OUT-LST-PMT-DT      PIC X(21).
  3832    05 FILLER              PIC X(8) VALUE "&NOPMTS=".
  3833    05 OUT-NO-OF-PMTS      PIC X(10).
  3834    05 FILLER              PIC X(9) VALUE "&TOTPAID=".
  3835    05 OUT-TOT-PAID        PIC 9999999.99.
  3836    05 FILLER              PIC X(8) VALUE "&LPDAMT=".
  3837    05 OUT-LST-PD-AMT      PIC 9999999.99.
  3838    05 FILLER              PIC X(9) VALUE "&ADDRCNT=".
  3839    05 OUT-ADDR-CNT        PIC 9.
  3840    05 FILLER              PIC X(7) VALUE "&CRTST=".
  3841    05 OUT-CRT-ST          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  68
* NSRLTRBL.cbl
  3842    05 FILLER              PIC X(10) VALUE "&CERTACCT=".
  3843    05 OUT-CERTACCT        PIC X(10).
  3844    05 FILLER              PIC X(7) VALUE "&EFFDT=".
  3845    05 OUT-EFF-DT          PIC X(21).
  3846    05 FILLER              PIC X(8) VALUE "&LMNTDT=".
  3847    05 OUT-LST-MAINT-DT    PIC X(21).
  3848    05 FILLER              PIC X(10) VALUE "&LMNTUSER=".
  3849    05 OUT-LST-MAINT-USER  PIC X(10).
  3850    05 FILLER              PIC X(10) VALUE "&LMNTTYPE=".
  3851    05 OUT-LST-MAINT-TYPE  PIC X(10).
  3852    05 FILLER              PIC X(6) VALUE "&DIAG=".
  3853    05 OUT-DIAG            PIC X(66).
  3854    05 FILLER              PIC X(7) VALUE "&EXPDT=".
  3855    05 OUT-EXP-DT          PIC X(21).
  3856    05 FILLER              PIC X(12) VALUE "&LCLSREASON=".
  3857    05 OUT-LST-CLS-REA     PIC X(10).
  3858    05 FILLER              PIC X(8) VALUE "&BRTHDT=".
  3859    05 OUT-BIRTH-DT        PIC X(21).
  3860    05 FILLER              PIC X(6) VALUE "&TERM=".
  3861    05 OUT-TERM            PIC 999.
  3862    05 FILLER              PIC X(7) VALUE "&BENCD=".
  3863    05 OUT-BEN-CD          PIC XX.
  3864    05 FILLER              PIC X(8) VALUE "&BENAMT=".
  3865    05 OUT-BENAMT          PIC 9999999.99.
  3866    05 FILLER              PIC X(9) VALUE "&CRITPER=".
  3867    05 OUT-CRIT-PER        PIC 999.
  3868    05 FILLER              PIC X(9) VALUE "&WAITPER=".
  3869    05 OUT-WAIT-PER        PIC XX.
  3870    05 FILLER              PIC X(11)  VALUE "&LFINTRATE=".
  3871    05 OUT-LF-INT-RATE     PIC 99.99999.
  3872    05 FILLER              PIC X(10) VALUE "&AUTOPYDT=".
  3873    05 OUT-AUTO-PY-DT      PIC X(21).
  3874    05 FILLER              PIC X(12) VALUE "&AUTOSCHEND=".
  3875    05 OUT-AUTO-SCHD-END   PIC X(21).
  3876    05 FILLER              PIC X(8) VALUE "&LOANNO=".
  3877    05 OUT-LOAN-NO         PIC X(25).
  3878    05 FILLER              PIC X(5) VALUE "&APR=".
  3879    05 OUT-APR             PIC 99.99999.
  3880    05 FILLER              PIC X(8) VALUE "&LACTDT=".
  3881    05 OUT-LST-ACT-DT      PIC X(21).
  3882    05 FILLER              PIC X(7) VALUE "&ACTDT=".
  3883    05 OUT-ACT-DT          PIC X(21).
  3884    05 FILLER              PIC X(10) VALUE "&LACTTYPE=".
  3885    05 OUT-LST-ACT-TYPE    PIC X(15).
  3886    05 FILLER              PIC X(9) VALUE "&ACTTYPE=".
  3887    05 OUT-ACT-TYPE        PIC X(15).
  3888    05 FILLER              PIC X(6) VALUE "&FORM=".
  3889    05 OUT-FORM            PIC X(4).
  3890    05 FILLER              PIC X(9) VALUE "&INSNAME=".
  3891    05 OUT-INS-NAME        PIC X(36).
  3892    05 FILLER              PIC X(10) VALUE "&INSADDR1=".
  3893    05 OUT-INS-ADDR1       PIC X(36).
  3894    05 FILLER              PIC X(10) VALUE "&INSADDR2=".
  3895    05 OUT-INS-ADDR2       PIC X(36).
  3896    05 FILLER              PIC X(9) VALUE "&INSCITY=".
  3897    05 OUT-INS-CITY        PIC X(28).
  3898    05 FILLER              PIC X(10) VALUE "&INSSTATE=".
  3899    05 OUT-INS-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  69
* NSRLTRBL.cbl
  3900    05 FILLER              PIC X(8) VALUE "&INSZIP=".
  3901    05 OUT-INS-ZIP         PIC X(10).
  3902    05 FILLER              PIC X(10) VALUE "&INSPHONE=".
  3903    05 OUT-INS-PHONE       PIC X(13).
  3904    05 FILLER              PIC X(10) VALUE "&BENENAME=".
  3905    05 OUT-BEN-NAME        PIC X(32).
  3906    05 FILLER              PIC X(11) VALUE "&BENEADDR1=".
  3907    05 OUT-BEN-ADDR1       PIC X(36).
  3908    05 FILLER              PIC X(11) VALUE "&BENEADDR2=".
  3909    05 OUT-BEN-ADDR2       PIC X(32).
  3910    05 FILLER              PIC X(10) VALUE "&BENECITY=".
  3911    05 OUT-BEN-CITY        PIC X(28).
  3912    05 FILLER              PIC X(11) VALUE "&BENESTATE=".
  3913    05 OUT-BEN-STATE       PIC XX.
  3914    05 FILLER              PIC X(9) VALUE "&BENEZIP=".
  3915    05 OUT-BEN-ZIP         PIC X(10).
  3916    05 FILLER              PIC X(11) VALUE "&BENEPHONE=".
  3917    05 OUT-BEN-PHONE       PIC X(13).
  3918    05 FILLER              PIC X(8) VALUE "&OANAME=".
  3919    05 OUT-ORIG-NAME       PIC X(32).
  3920    05 FILLER              PIC X(10) VALUE "&ACCTNAME=".
  3921    05 OUT-ACCT-NAME       PIC X(32).
  3922    05 FILLER              PIC X(11) VALUE "&ACCTADDR1=".
  3923    05 OUT-ACCT-ADDR1      PIC X(36).
  3924    05 FILLER              PIC X(11) VALUE "&ACCTADDR2=".
  3925    05 OUT-ACCT-ADDR2      PIC X(32).
  3926    05 FILLER              PIC X(10) VALUE "&ACCTCITY=".
  3927    05 OUT-ACCT-CITY       PIC X(30).
  3928    05 FILLER              PIC X(11) VALUE "&ACCTSTATE=".
  3929    05 OUT-ACCT-STATE      PIC XX.
  3930    05 FILLER              PIC X(9)  VALUE "&ACCTZIP=".
  3931    05 OUT-ACCT-ZIP        PIC X(10).
  3932    05 FILLER              PIC X(11) VALUE "&ACCTPHONE=".
  3933    05 OUT-ACCT-PHONE      PIC X(13).
  3934    05 FILLER              PIC X(7) VALUE "&ENCCD=".
  3935    05 OUT-ENC-CODE        PIC XXX.
  3936    05 FILLER              PIC X(7) VALUE "&ENCST=".
  3937    05 OUT-ENC-ST          PIC XX.
  3938    05 FILLER              PIC X(8) VALUE "&ARCHNO=".
  3939    05 OUT-ARCHNO          PIC 999999999.
  3940    05 FILLER              PIC X(11) VALUE "&FLTRPRTDT=".
  3941    05 OUT-1ST-LTR-PRT-DT  PIC X(21).
  3942    05 FILLER              PIC X(11) VALUE "&NEXTDUEDT=".
  3943    05 OUT-NEXT-DUE-DT     PIC X(21).
  3944    05 FILLER              PIC X(8) VALUE "&JLNAME=".
  3945    05 OUT-JLNAME          PIC X(15).
  3946    05 FILLER              PIC X(8) VALUE "&JFNAME=".
  3947    05 OUT-JFNAME          PIC X(10).
  3948    05 FILLER              PIC X(9)  VALUE "&ENCLINE=".
  3949    05 OUT-ENCLINE         PIC X(100).
  3950    05 FILLER              PIC X(9) VALUE "&ENCATTS=".
  3951    05 OUT-ENCATTS         PIC X(255).
  3952    05 FILLER              PIC X(10) VALUE "&OUTSTACK=".
  3953    05 OUT-OUTSTACK        PIC X.
  3954    05 FILLER              PIC X(8) VALUE "&PROCID=".
  3955    05 OUT-PROCID          PIC XXXX.
  3956    05 FILLER              PIC X(8) VALUE "&COMPID=".
  3957    05 OUT-COMPID          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  70
* NSRLTRBL.cbl
  3958    05 FILLER              PIC X(8) VALUE "&PRTNOW=".
  3959    05 OUT-PRINT-NOW-SW    PIC X.
  3960    05 FILLER              PIC X(11) VALUE "&CYCLEDATE=".
  3961    05 OUT-CYCLE-DATE      PIC X(8).
  3962    05 FILLER              PIC X(11) VALUE "&ENCSTNAME=".
  3963    05 OUT-ENC-ST-NAME     PIC XX.
  3964    05 FILLER              PIC X(10) VALUE "&CARRIDLU=".
  3965    05 OUT-CARR-LU         PIC X.
  3966    05 FILLER              PIC X(5)  VALUE "&CCN=".
  3967    05 OUT-AHL-CLAIM-NO    PIC X(9).
  3968    05 FILLER              PIC X(4) VALUE "&GP=".
  3969    05 OUT-ACCT-GPCD       PIC 99.
  3970    05 FILLER              PIC X(9) VALUE "&MAXBENS=".
  3971    05 OUT-MAX-BENS        PIC 9(3).
  3972    05 FILLER              PIC X(10) VALUE "&PAIDBENS=".
  3973    05 OUT-PAID-BENS       PIC 9(3).
  3974    05 FILLER              PIC X(9) VALUE "&REMBENS=".
  3975    05 OUT-REM-BENS        PIC 9(3).
  3976    05 FILLER              PIC X(9) VALUE "&EXCLPER=".
  3977    05 OUT-EXCL-PER        PIC 9(3).
  3978    05 FILLER              PIC X(8) VALUE "&RECMOS=".
  3979    05 OUT-REC-MOS         PIC 9(2).
  3980    05 FILLER              PIC X(8) VALUE "&INSTYP=".
  3981    05 OUT-INS-TYP         PIC X(4).
  3982    05 FILLER              PIC X(8) VALUE "&BENPER=".
  3983    05 OUT-BEN-PER         PIC 9(2).
  3984    05 FILLER              PIC X(7) VALUE "&ACCSW=".
  3985    05 OUT-ACC-SW          PIC X.
  3986 01  FILLER                      PIC X(500)  VALUE SPACES.
  3987*                                COPY ELCNAPS.
  3988******************************************************************
  3989*                                                                *
  3990*                            ELCNAPS                             *
  3991*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3992*                            VMOD=2.003                          *
  3993*                                                                *
  3994*        FILE DESCRIPTION = NAPERSOFT LETTER FILE                *
  3995*                                                                *
  3996*        FILE TYPE= VSAM,KSDS                                    *
  3997*        RECORD SIZE = 150    RECFORM = FIXED                    *
  3998*                                                                *
  3999*        BASE CLUSTER = ELNAPS        RKP=2,LEN=28               *
  4000*                                                                *
  4001*        LOG = YES                                               *
  4002*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  4003*                                                                *
  4004******************************************************************
  4005*                   C H A N G E   L O G
  4006*
  4007* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4008*-----------------------------------------------------------------
  4009*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4010* EFFECTIVE    NUMBER
  4011*-----------------------------------------------------------------
  4012* 033110  CR2009122800001  AJRA  NEW FILE FOR NAPERSOFT.
  4013******************************************************************
  4014
  4015 01  NAPERSOFT-FILE.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  71
* NSRLTRBL.cbl
  4016     12  NA-RECORD-ID                PIC  XX.
  4017         88  VALID-NA-ID                  VALUE 'NA'.
  4018
  4019     12  NA-CONTROL-PRIMARY.
  4020         16  NA-COMPANY-CD           PIC X.
  4021         16  NA-CARRIER              PIC X.
  4022         16  NA-CLAIM-NO             PIC X(7).
  4023         16  NA-CERT-NO.
  4024             20  NA-CERT-PRIME       PIC X(10).
  4025             20  NA-CERT-SFX         PIC X.
  4026         16  NA-ARCHIVE-NO           PIC 9(8).
  4027
  4028     12  NA-LETTER-INFORMATION.
  4029         16  NA-LETTER-ID            PIC X(4).
  4030         16  NA-PROCESSOR-ID         PIC X(4).
  4031         16  NA-CREATION-DT          PIC X(2).
  4032         16  NA-INITIAL-PRINT-DT     PIC X(2).
  4033         16  NA-FOLLOW-UP-DT         PIC X(2).
  4034         16  NA-RESEND-DT            PIC X(2).
  4035         16  NA-RESEND-LETTER-ID     PIC X(4).
  4036         16  NA-NO-OF-COPIES         PIC 9(2).
  4037         16  NA-ADDRESS-TYPE         PIC X(2).
  4038         16  NA-CORR-TRLR-SEQ        PIC 9(4).
  4039         16  NA-RESEND-PRINT-DT      PIC X(2).
  4040         16  NA-1ST-LTR-PRINT-DT     PIC X(2).
  4041         16  NA-NEXT-DUE-DT          PIC X(2).
  4042         16  NA-AUTOPYDT             PIC X(2).
  4043         16  NA-ENCLOSURE-CD         PIC X(3).
  4044         16  NA-CREATED-IN-NAPERSOFT PIC X(1).
  4045         16  NA-ORIG-ARCHIVE-NO      PIC 9(9).
  4046         16  NA-RESEND-PROMPT-IND    PIC X(1).
  4047         16  NA-ORIG-ENCLOSURE-CD    PIC X(3).
  4048         16  FILLER                  PIC X(67).
  4049******************************************************************
  4050*                                COPY ELCENCC.
  4051******************************************************************
  4052*                                                                *
  4053*                                                                *
  4054*                            ELCENCC                             *
  4055*                            VMOD=2.001                          *
  4056*                                                                *
  4057*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  4058*                                                                *
  4059*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  4060*   A NAPERSOFT DOCUMENT                                         *
  4061*                                                                *
  4062*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  4063*                                                                *
  4064*   FILE TYPE = VSAM,KSDS                                        *
  4065*   RECORD SIZE = 400   RECFORM = FIX                            *
  4066*                                                                *
  4067*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  4068*                                                                *
  4069*   LOG = NO                                                     *
  4070*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4071*                                                                *
  4072*                                                                *
  4073******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  72
* NSRLTRBL.cbl
  4074*                   C H A N G E   L O G
  4075*
  4076* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4077*-----------------------------------------------------------------
  4078*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4079* EFFECTIVE    NUMBER
  4080*-----------------------------------------------------------------
  4081* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  4082* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  4083******************************************************************
  4084 01  ENCLOSURE-CODES.
  4085     12  NC-RECORD-ID                      PIC XX.
  4086         88  VALID-NC-ID                      VALUE 'NC'.
  4087     12  NC-CONTROL-PRIMARY.
  4088         16  NC-COMPANY-CD                 PIC X.
  4089         16  NC-REC-TYPE                   PIC X.
  4090             88  NC-CLAIMS                   VALUE '1'.
  4091             88  NC-ADMIN                    VALUE '2'.
  4092         16  NC-ENC-CODE                   PIC X(5).
  4093         16  FILLER                        PIC X(09).
  4094     12  NC-MAINT-INFORMATION.
  4095         16  NC-LAST-MAINT-DT              PIC XX.
  4096         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4097         16  NC-LAST-MAINT-USER            PIC X(4).
  4098         16  FILLER                        PIC XX.
  4099     12  NC-OUTPUT-STACK                   PIC XXX.
  4100     12  NC-ENCLOSURE-LINE                 PIC X(100).
  4101     12  NC-ATTACHMENTS                    PIC X(255).
  4102     12  NC-FUTURE                         PIC X(12).
  4103******************************************************************
  4104*                                COPY ELCCRTT.
  4105******************************************************************
  4106*                                                                *
  4107*                            ELCCRTT.                            *
  4108*                                                                *
  4109*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  4110*                                                                *
  4111*   FILE TYPE = VSAM,KSDS                                        *
  4112*   RECORD SIZE = 552  RECFORM = FIXED                           *
  4113*                                                                *
  4114*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  4115*                                                                *
  4116*   LOG = YES                                                    *
  4117*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4118******************************************************************
  4119*                   C H A N G E   L O G
  4120*
  4121* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4122*-----------------------------------------------------------------
  4123*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4124* EFFECTIVE    NUMBER
  4125*-----------------------------------------------------------------
  4126* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4127* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  4128* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  4129* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4130* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4131* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  73
* NSRLTRBL.cbl
  4132* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4133* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  4134* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  4135* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  4136* 091318  CR2018073000001  PEMA  ADD Refund methods
  4137* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  4138******************************************************************
  4139
  4140 01  CERTIFICATE-TRAILERS.
  4141     12  CS-RECORD-ID                      PIC XX.
  4142         88  VALID-CS-ID                      VALUE 'CS'.
  4143
  4144     12  CS-CONTROL-PRIMARY.
  4145         16  CS-COMPANY-CD                 PIC X.
  4146         16  CS-CARRIER                    PIC X.
  4147         16  CS-GROUPING                   PIC X(6).
  4148         16  CS-STATE                      PIC XX.
  4149         16  CS-ACCOUNT                    PIC X(10).
  4150         16  CS-CERT-EFF-DT                PIC XX.
  4151         16  CS-CERT-NO.
  4152             20  CS-CERT-PRIME             PIC X(10).
  4153             20  CS-CERT-SFX               PIC X.
  4154         16  CS-TRAILER-TYPE               PIC X.
  4155             88  COMM-TRLR           VALUE 'A'.
  4156             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  4157             88  CERT-DATA-TRLR      VALUE 'C'.
  4158
  4159     12  CS-DATA-AREA                      PIC X(516).
  4160
  4161     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  4162         16  CS-BANK-COMMISSION-AREA.
  4163             20  CS-BANK-COMMS       OCCURS 10.
  4164                 24  CS-AGT                PIC X(10).
  4165                 24  CS-COM-TYP            PIC X.
  4166                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  4167                 24  CS-RECALC-LV-INDIC    PIC X.
  4168                 24  FILLER                PIC X(10).
  4169         16  FILLER                        PIC X(256).
  4170
  4171     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  4172****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  4173         16  CS-MB-CLAIM-DATA OCCURS 24.
  4174             20  CS-CLAIM-NO               PIC X(7).
  4175             20  CS-CLAIM-TYPE             PIC X.
  4176                 88  CS-AH-CLM               VALUE 'A'.
  4177                 88  CS-IU-CLM               VALUE 'I'.
  4178                 88  CS-GP-CLM               VALUE 'G'.
  4179                 88  CS-LF-CLM               VALUE 'L'.
  4180                 88  CS-PR-CLM               VALUE 'P'.
  4181                 88  CS-FL-CLM               VALUE 'F'.
  4182                 88  CS-OT-CLM               VALUE 'O'.
  4183             20  CS-INSURED-TYPE           PIC X.
  4184                 88  CS-PRIM-INSURED          VALUE 'P'.
  4185                 88  CS-CO-BORROWER           VALUE 'C'.
  4186             20  CS-BENEFIT-PERIOD         PIC 99.
  4187             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  4188             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  4189             20  CS-REMAINING-BENS         PIC S999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  74
* NSRLTRBL.cbl
  4190         16  FILLER                        PIC X(12).
  4191     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  4192         16  CS-VIN-NUMBER                 PIC X(17).
  4193         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  4194         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  4195         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  4196         16  cs-agent-name.
  4197             20  cs-agent-fname            pic x(20).
  4198             20  cs-agent-mi               pic x.
  4199             20  cs-agent-lname            pic x(25).
  4200         16  cs-license-no                 pic x(15).
  4201         16  cs-npn-number                 pic x(10).
  4202         16  cs-agent-edit-status          pic x.
  4203             88  cs-ae-refer-to-manager      value 'M'.
  4204             88  cs-ae-cover-sheet           value 'C'.
  4205             88  cs-ae-sig-form              value 'S'.
  4206             88  cs-ae-verified              value 'V'.
  4207             88  cs-unidentified-signature   value 'U'.
  4208             88  cs-cert-returned            value 'R'.
  4209             88  cs-accept-no-commission     value 'N'.
  4210         16  cs-year                       pic 9999.
  4211         16  cs-make                       pic x(20).
  4212         16  cs-model                      pic x(20).
  4213         16  cs-future                     pic x(20).
  4214         16  cs-vehicle-odometer           pic s9(7) comp-3.
  4215         16  cs-claim-verification-status  pic x.
  4216             88  cs-clm-ver-eligible         value 'A'.
  4217             88  cs-clm-ver-partial-elig     value 'B'.
  4218             88  cs-clm-ver-not-eligible     value 'C'.
  4219             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  4220             88  cs-clm-ver-not-part-elig-rw value 'E'.
  4221             88  cs-clm-ver-ND-CERT          value 'F'.
  4222             88  cs-clm-ver-spec-other       value 'G'.
  4223             88  cs-clam-ver-pratial-corrected
  4224                                             value 'H'.
  4225             88  cs-clm-ver-no-matches       value 'I'.
  4226             88  cs-clm-ver-not-elig-corrected
  4227                                             value 'J'.
  4228             88  cs-clm-ver-needs-review     value 'R'.
  4229             88  cs-clm-ver-sent-to-claims   value 'W'.
  4230         16  CS-LF-REFUND-METHOD           PIC X.
  4231         16  CS-AH-REFUND-METHOD           PIC X.
  4232         16  FILLER                        PIC X(353). *> was 420
  4233*        16  FILLER                        PIC X(496).
  4234*                                COPY ERCPDEF.
  4235******************************************************************
  4236*                                                                *
  4237*                                                                *
  4238*                            ERCPDEF.                            *
  4239*                                                                *
  4240*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  4241*                                                                *
  4242*    FILE TYPE = VSAM,KSDS                                       *
  4243*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  4244*                                                                *
  4245*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  4246*                                                                *
  4247*    LOG = YES                                                   *
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  75
* NSRLTRBL.cbl
  4248*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4249******************************************************************
  4250*                   C H A N G E   L O G
  4251*
  4252* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4253*-----------------------------------------------------------------
  4254*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4255* EFFECTIVE    NUMBER
  4256*-----------------------------------------------------------------
  4257* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4258* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4259* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  4260* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  4261******************************************************************
  4262 01  PRODUCT-MASTER.
  4263    12  PD-RECORD-ID                 PIC X(02).
  4264        88  VALID-PD-ID                  VALUE 'PD'.
  4265    12  PD-CONTROL-PRIMARY.
  4266        16  PD-COMPANY-CD            PIC X.
  4267        16  PD-STATE                 PIC XX.
  4268        16  PD-PRODUCT-CD            PIC XXX.
  4269        16  PD-FILLER                PIC X(7).
  4270        16  PD-BEN-TYPE              PIC X.
  4271        16  PD-BEN-CODE              PIC XX.
  4272        16  PD-PROD-EXP-DT           PIC XX.
  4273    12  FILLER                       PIC X(50).
  4274    12  PD-PRODUCT-DATA OCCURS 8.
  4275        16  PD-PROD-CODE             PIC X.
  4276            88  PD-PROD-LIFE           VALUE 'L'.
  4277            88  PD-PROD-PROP           VALUE 'P'.
  4278            88  PD-PROD-AH             VALUE 'A'.
  4279            88  PD-PROD-IU             VALUE 'I'.
  4280            88  PD-PROD-GAP            VALUE 'G'.
  4281            88  PD-PROD-FAML           VALUE 'F'.
  4282            88  PD-PROD-OTH            VALUE 'O'.
  4283        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  4284        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  4285        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  4286        16  PD-MAX-TERM              PIC S999        COMP-3.
  4287        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  4288        16  FILLER                   PIC X.
  4289        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  4290        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  4291        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  4292        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  4293        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  4294        16  PD-REC-CRIT-PERIOD       PIC 99.
  4295        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  4296            20  PD-RECURRING-YN      PIC X.
  4297            20  FILLER               PIC X.
  4298        16  PD-RTW-MOS               PIC 99.
  4299        16  PD-MAX-EXTENSION         PIC 99.
  4300        16  pd-ben-pct               pic sv999 comp-3.
  4301*       16  FILLER                   PIC XX.
  4302    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  4303    12  PD-TERM-LIMITS OCCURS 15.
  4304        16  PD-LOW-TERM              PIC S999        COMP-3.
  4305        16  PD-HI-TERM               PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  76
* NSRLTRBL.cbl
  4306*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  4307    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  4308        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  4309        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  4310    12  PD-EARN-FACTORS.
  4311        16  FILLER OCCURS 15.
  4312            20  FILLER OCCURS 15.
  4313                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  4314    12  PD-PRODUCT-DESC              PIC X(80).
  4315    12  PD-TRUNCATED                 PIC X.
  4316    12  FILLER                       PIC X(59).
  4317    12  PD-MAINT-INFORMATION.
  4318        16  PD-LAST-MAINT-DT         PIC X(02).
  4319        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  4320        16  PD-LAST-MAINT-BY         PIC X(04).
  4321****************************************************************
  4322*
  4323* Copyright (c) 2007-2013 Dell Inc.
  4324* All rights reserved.
  4325*
  4326****************************************************************
  4327 01  DFHEIV.
  4328   02  DFHEIV0               PIC X(35).
  4329   02  DFHEIV1               PIC X(08).
  4330   02  DFHEIV2               PIC X(08).
  4331   02  DFHEIV3               PIC X(08).
  4332   02  DFHEIV4               PIC X(06).
  4333   02  DFHEIV5               PIC X(04).
  4334   02  DFHEIV6               PIC X(04).
  4335   02  DFHEIV7               PIC X(02).
  4336   02  DFHEIV8               PIC X(02).
  4337   02  DFHEIV9               PIC X(01).
  4338   02  DFHEIV10              PIC S9(7) COMP-3.
  4339   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4340   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4341   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4342   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4343   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4344   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4345   02  DFHEIV17              PIC X(04).
  4346   02  DFHEIV18              PIC X(04).
  4347   02  DFHEIV19              PIC X(04).
  4348   02  DFHEIV20              USAGE IS POINTER.
  4349   02  DFHEIV21              USAGE IS POINTER.
  4350   02  DFHEIV22              USAGE IS POINTER.
  4351   02  DFHEIV23              USAGE IS POINTER.
  4352   02  DFHEIV24              USAGE IS POINTER.
  4353   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4354   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4355   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4356   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4357   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4358   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4359   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4360   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4361   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4362   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4363   02  DFHEIV35              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  77
* NSRLTRBL.cbl
  4364   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4365   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4366   02  FILLER                PIC X(02).
  4367   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4368   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4369   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4370   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4371   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4372   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4373   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4374 LINKAGE  SECTION.
  4375*****************************************************************
  4376*                                                               *
  4377* Copyright (c) 2007-2013 Dell Inc.                             *
  4378* All rights reserved.                                          *
  4379*                                                               *
  4380*****************************************************************
  4381 01  dfheiblk.
  4382     02  eibtime          pic s9(7) comp-3.
  4383     02  eibdate          pic s9(7) comp-3.
  4384     02  eibtrnid         pic x(4).
  4385     02  eibtaskn         pic s9(7) comp-3.
  4386     02  eibtrmid         pic x(4).
  4387     02  dfheigdi         pic s9(4) comp.
  4388     02  eibcposn         pic s9(4) comp.
  4389     02  eibcalen         pic s9(4) comp.
  4390     02  eibaid           pic x(1).
  4391     02  eibfiller1       pic x(1).
  4392     02  eibfn            pic x(2).
  4393     02  eibfiller2       pic x(2).
  4394     02  eibrcode         pic x(6).
  4395     02  eibfiller3       pic x(2).
  4396     02  eibds            pic x(8).
  4397     02  eibreqid         pic x(8).
  4398     02  eibrsrce         pic x(8).
  4399     02  eibsync          pic x(1).
  4400     02  eibfree          pic x(1).
  4401     02  eibrecv          pic x(1).
  4402     02  eibsend          pic x(1).
  4403     02  eibatt           pic x(1).
  4404     02  eibeoc           pic x(1).
  4405     02  eibfmh           pic x(1).
  4406     02  eibcompl         pic x(1).
  4407     02  eibsig           pic x(1).
  4408     02  eibconf          pic x(1).
  4409     02  eiberr           pic x(1).
  4410     02  eibrldbk         pic x(1).
  4411     02  eiberrcd         pic x(4).
  4412     02  eibsynrb         pic x(1).
  4413     02  eibnodat         pic x(1).
  4414     02  eibfiller5       pic x(2).
  4415     02  eibresp          pic s9(8) comp.
  4416     02  eibresp2         pic s9(8) comp.
  4417     02  dfheigdj         pic s9(4) comp.
  4418     02  dfheigdk         pic s9(4) comp.
  4419 01 dfhcommarea.
  4420*                                copy ELCLTRSPI.
  4421******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  78
* NSRLTRBL.cbl
  4422*                   C H A N G E   L O G
  4423*
  4424* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4425*-----------------------------------------------------------------
  4426*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4427* EFFECTIVE    NUMBER
  4428*-----------------------------------------------------------------
  4429* 121802    2009122800001  PEMA  NEW COPYBOOK
  4430******************************************************************
  4431****************************************
  4432*  commarea for NaperSoft On Demand Claim letters
  4433*  (business logic input & output)
  4434****************************************
  4435     03  BL-INPUT.
  4436         05  BL-CARRIER          PIC X.
  4437         05  BL-CLAIM-NO         PIC X(7).
  4438         05  BL-CERT-NO          PIC X(11).
  4439         05  BL-LETTER-ID        PIC XXXX.
  4440         05  BL-FOLLOW-UP-DT     PIC X(10).
  4441         05  BL-RESEND-DT        PIC X(10).
  4442         05  BL-NO-OF-COPIES     PIC 99.
  4443         05  BL-PROC-ID          PIC XXXX.
  4444         05  BL-COMP-ID          PIC XXX.
  4445         05  BL-PRINT-NOW-SW     PIC X.
  4446         05  BL-ENC-CD           PIC XXX.
  4447         05  BL-ARCHIVE-NO       PIC 9(8).
  4448         05  BL-REGARDING        PIC X(70).
  4449     03  BL-OUTPUT.
  4450         05  BL-STATUS                   PIC X.
  4451             88  BL-OK                      VALUE "P".
  4452             88  BL-FAIL                  VALUE "F".
  4453         05  BL-MESSAGE          PIC X(50).
  4454     03  BL-RECORD-PASSED-DATA   PIC X(2500).
  4455 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  4456 0000-DFHEXIT SECTION.
  4457     MOVE '9#                    $   ' TO DFHEIV0.
  4458     MOVE 'NSRLTRBL' TO DFHEIV1.
  4459     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4460     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  4461     MOVE '5'                    TO DC-OPTION-CODE
  4462     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4463     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE
  4464     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  4465     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE
  4466*****************************************************
  4467* The full claim key has been established and passed
  4468* to this program via NSREQLTR
  4469*****************************************************
  4470     INITIALIZE NAPER-OUTPUT-DATA
  4471     IF BL-COMP-ID = 'DCC'
  4472        MOVE X'05'               TO WS-ELMSTR-COMPANY-CD
  4473     ELSE
  4474       IF BL-COMP-ID = 'AHL'
  4475        MOVE X'06'               TO WS-ELMSTR-COMPANY-CD
  4476       ELSE
  4477        MOVE X'04'               TO WS-ELMSTR-COMPANY-CD
  4478       END-IF
  4479     END-IF
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  79
* NSRLTRBL.cbl
  4480     MOVE BL-CARRIER             TO WS-ELMSTR-CARRIER
  4481     MOVE BL-CLAIM-NO            TO WS-ELMSTR-CLAIM-NO
  4482     MOVE BL-CERT-NO             TO WS-ELMSTR-CERT-NO
  4483     SET BL-FAIL TO TRUE
  4484
  4485* EXEC CICS READ
  4486*         DATASET    ('ELMSTR')
  4487*         INTO       (CLAIM-MASTER)
  4488*         RIDFLD     (WS-ELMSTR-KEY)
  4489*         RESP       (WS-RESPONSE)
  4490*    END-EXEC.
  4491     MOVE LENGTH OF
  4492      CLAIM-MASTER
  4493       TO DFHEIV11
  4494     MOVE 'ELMSTR' TO DFHEIV1
  4495*    MOVE '&"IL       E          (  N#00004480' TO DFHEIV0
  4496     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4497     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4498     MOVE X'204E233030303034343830' TO DFHEIV0(25:11)
  4499     CALL 'kxdfhei1' USING DFHEIV0,
  4500           DFHEIV1,
  4501           CLAIM-MASTER,
  4502           DFHEIV11,
  4503           WS-ELMSTR-KEY,
  4504           DFHEIV99,
  4505           DFHEIV99,
  4506           DFHEIV99
  4507     MOVE EIBRESP  TO WS-RESPONSE
  4508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4509
  4510     IF RESP-NORMAL
  4511        MOVE BL-LETTER-ID        TO OUT-TEMP
  4512                                    OUT-LETTER
  4513        MOVE BL-PROC-ID          TO OUT-PROCID
  4514        MOVE BL-COMP-ID          TO OUT-COMPID
  4515        MOVE BL-PRINT-NOW-SW     TO OUT-PRINT-NOW-SW
  4516        MOVE CL-CARRIER          TO OUT-CARR
  4517                                    OUT-CARR-LU
  4518        MOVE CL-INSURED-LAST-NAME
  4519                                 TO OUT-ILNAME
  4520        MOVE CL-INSURED-1ST-NAME TO OUT-IFNAME
  4521        MOVE CL-CLAIM-NO         TO OUT-CLMNO
  4522        MOVE CL-CERT-NO          TO OUT-CRTNO
  4523        MOVE CL-CERT-ACCOUNT     TO OUT-ACTNO
  4524        MOVE CL-SOC-SEC-NO       TO OUT-SSN
  4525        MOVE CL-CLAIM-STATUS     TO OUT-CLMSTAT
  4526        MOVE CL-CCN (1:9)        TO OUT-AHL-CLAIM-NO
  4527        MOVE WS-SAVE-EDIT-A-DATE TO DC-GREG-DATE-A-EDIT
  4528        STRING DC-EDITA-CCYY  DC-EDITA-MONTH DC-EDITA-DAY
  4529          DELIMITED BY SIZE INTO OUT-CYCLE-DATE
  4530        END-STRING
  4531*       IF CLAIM-IS-CLOSED
  4532*          MOVE 'CLOSED'         TO OUT-CLMSTAT
  4533*       ELSE
  4534*          MOVE 'OPEN'           TO OUT-CLMSTAT
  4535*       END-IF
  4536        MOVE CL-CLAIM-TYPE       TO OUT-CLMTYPE
  4537        MOVE CL-FILE-ESTABLISH-DT
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  80
* NSRLTRBL.cbl
  4538                                 TO DC-BIN-DATE-1
  4539        MOVE ' '                 TO DC-OPTION-CODE
  4540        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4541        IF NO-CONVERSION-ERROR
  4542           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4543              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4544              INTO OUT-EST-DT
  4545           END-STRING
  4546        ELSE
  4547           MOVE SPACES           TO OUT-EST-DT
  4548        END-IF
  4549        MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  4550        MOVE ' '                 TO DC-OPTION-CODE
  4551        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4552        IF NO-CONVERSION-ERROR
  4553           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4554              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4555              INTO OUT-PD-THRU-DT
  4556           END-STRING
  4557        ELSE
  4558           MOVE SPACES           TO OUT-PD-THRU-DT
  4559        END-IF
  4560        MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  4561        MOVE +0                  TO DC-ELAPSED-MONTHS
  4562        MOVE +30                 TO DC-ELAPSED-DAYS
  4563        MOVE '6'                 TO DC-OPTION-CODE
  4564        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4565        IF NO-CONVERSION-ERROR
  4566           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4567              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4568              INTO OUT-FORM-DUE-DT
  4569           END-STRING
  4570        ELSE
  4571           MOVE SPACES           TO OUT-FORM-DUE-DT
  4572        END-IF
  4573        MOVE CL-TOTAL-PAID-AMT   TO OUT-TOT-PAID
  4574        MOVE CL-INSURED-SEX-CD   TO OUT-SEX-CD
  4575        MOVE CL-CERT-STATE       TO OUT-CRT-ST
  4576                                    OUT-ENC-ST
  4577                                    OUT-ENC-ST-NAME
  4578        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
  4579        MOVE ' '                 TO DC-OPTION-CODE
  4580        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4581        IF NO-CONVERSION-ERROR
  4582           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4583              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4584              INTO OUT-EFF-DT
  4585           END-STRING
  4586        ELSE
  4587           MOVE SPACES           TO OUT-EFF-DT
  4588        END-IF
  4589        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
  4590        MOVE ' '                 TO DC-OPTION-CODE
  4591        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4592        IF NO-CONVERSION-ERROR
  4593           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4594              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4595              INTO OUT-INC-DT
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  81
* NSRLTRBL.cbl
  4596           END-STRING
  4597        ELSE
  4598           MOVE SPACES           TO OUT-INC-DT
  4599        END-IF
  4600        MOVE CL-REPORTED-DT      TO DC-BIN-DATE-1
  4601        MOVE ' '                 TO DC-OPTION-CODE
  4602        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4603        IF NO-CONVERSION-ERROR
  4604           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4605              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4606              INTO OUT-RPT-DT
  4607           END-STRING
  4608        ELSE
  4609           MOVE SPACES           TO OUT-RPT-DT
  4610        END-IF
  4611        MOVE CL-LAST-PMT-DT      TO DC-BIN-DATE-1
  4612        MOVE ' '                 TO DC-OPTION-CODE
  4613        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4614        IF NO-CONVERSION-ERROR
  4615           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4616              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4617              INTO OUT-LST-PMT-DT
  4618           END-STRING
  4619        ELSE
  4620           MOVE SPACES           TO OUT-LST-PMT-DT
  4621        END-IF
  4622        MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
  4623        MOVE ' '                 TO DC-OPTION-CODE
  4624        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4625        IF NO-CONVERSION-ERROR
  4626           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4627              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4628              INTO OUT-BIRTH-DT
  4629           END-STRING
  4630        ELSE
  4631           MOVE SPACES           TO OUT-BIRTH-DT
  4632        END-IF
  4633        MOVE CL-LAST-MAINT-DT    TO DC-BIN-DATE-1
  4634        MOVE ' '                 TO DC-OPTION-CODE
  4635        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4636        IF NO-CONVERSION-ERROR
  4637           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4638              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4639              INTO OUT-LST-MAINT-DT
  4640           END-STRING
  4641        ELSE
  4642           MOVE SPACES           TO OUT-LST-MAINT-DT
  4643        END-IF
  4644        MOVE CL-LAST-MAINT-USER  TO OUT-LST-MAINT-USER
  4645        MOVE CL-LAST-MAINT-TYPE  TO OUT-LST-MAINT-TYPE
  4646        MOVE CL-NO-OF-PMTS-MADE  TO OUT-NO-OF-PMTS
  4647        MOVE CL-LAST-PMT-AMT     TO OUT-LST-PD-AMT
  4648        MOVE CL-ACCOUNT-ADDR-CNT TO OUT-ADDR-CNT
  4649        MOVE CL-LAST-CLOSE-REASON TO OUT-LST-CLS-REA
  4650        MOVE BL-ENC-CD           TO OUT-ENC-CODE
  4651        PERFORM 1000-GET-FILES   THRU 1000-EXIT
  4652        PERFORM 1800-SET-EL150D-FIELDS THRU 1800-EXIT
  4653        SET BL-OK TO TRUE
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  82
* NSRLTRBL.cbl
  4654     END-IF
  4655     IF BL-OK
  4656        PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  4657        MOVE WS-ARCHIVE-NO       TO OUT-ARCHNO
  4658        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  4659        MOVE NAPER-OUTPUT-DATA   TO BL-RECORD-PASSED-DATA
  4660*       PERFORM 1600-ADD-CORR-TRLR
  4661*                                THRU 1600-EXIT
  4662     END-IF
  4663
  4664* exec cics return end-exec.
  4665*    MOVE '.(                    ''   #00004639' TO DFHEIV0
  4666     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4667     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4668     MOVE X'2020233030303034363339' TO DFHEIV0(25:11)
  4669     CALL 'kxdfhei1' USING DFHEIV0,
  4670           DFHEIV99,
  4671           DFHEIV99,
  4672           DFHEIV99,
  4673           DFHEIV99,
  4674           DFHEIV99,
  4675           DFHEIV99
  4676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4677
  4678 0500-SCRUB-DATA.
  4679*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  4680*   A DIFFERENT DELIMITER IN PROGRAM NSREQLTR BUT
  4681*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  4682*   TO A HEX 26 TO GET BY THE DECODER
  4683     MOVE FUNCTION LENGTH(OUT-ILNAME)
  4684                                 TO M1
  4685     MOVE SPACES                 TO WS-WORK-FIELD
  4686     perform varying a1 from +1 by +1 until a1 > m1
  4687        if out-ilname (a1:1) = '&'
  4688           MOVE OUT-ILNAME (1:A1 - 1)
  4689                                 TO WS-WORK-FIELD (1:A1 - 1)
  4690           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4691           MOVE OUT-ILNAME (A1 + 1:M1 - A1)
  4692                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4693           MOVE WS-WORK-FIELD    TO OUT-ILNAME
  4694           add +2 to a1
  4695        end-if
  4696     end-perform
  4697     MOVE FUNCTION LENGTH(OUT-ACCT-ADDR1)
  4698                                 TO M1
  4699     MOVE SPACES                 TO WS-WORK-FIELD
  4700     perform varying a1 from +1 by +1 until a1 > m1
  4701        if out-acct-addr1 (a1:1) = '&'
  4702           MOVE out-acct-addr1 (1:A1 - 1)
  4703                                 TO WS-WORK-FIELD (1:A1 - 1)
  4704           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4705           MOVE out-acct-addr1 (A1 + 1:M1 - A1)
  4706                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4707           MOVE WS-WORK-FIELD    TO out-acct-addr1
  4708           add +2 to a1
  4709        end-if
  4710     end-perform
  4711     MOVE FUNCTION LENGTH(OUT-ACCT-ADDR2)
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  83
* NSRLTRBL.cbl
  4712                                 TO M1
  4713     MOVE SPACES                 TO WS-WORK-FIELD
  4714     perform varying a1 from +1 by +1 until a1 > m1
  4715        if out-acct-addr2 (a1:1) = '&'
  4716           MOVE out-acct-addr2 (1:A1 - 1)
  4717                                 TO WS-WORK-FIELD (1:A1 - 1)
  4718           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4719           MOVE out-acct-addr2 (A1 + 1:M1 - A1)
  4720                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4721           MOVE WS-WORK-FIELD    TO out-acct-addr2
  4722           add +2 to a1
  4723        end-if
  4724     end-perform
  4725     MOVE FUNCTION LENGTH(OUT-ACCT-CITY)
  4726                                 TO M1
  4727     MOVE SPACES                 TO WS-WORK-FIELD
  4728     perform varying a1 from +1 by +1 until a1 > m1
  4729        if out-acct-city (a1:1) = '&'
  4730           MOVE out-acct-city (1:A1 - 1)
  4731                                 TO WS-WORK-FIELD (1:A1 - 1)
  4732           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4733           MOVE out-acct-city (A1 + 1:M1 - A1)
  4734                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4735           MOVE WS-WORK-FIELD    TO out-acct-city
  4736           add +2 to a1
  4737        end-if
  4738     end-perform
  4739     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  4740                                 TO M1
  4741     MOVE SPACES                 TO WS-WORK-FIELD
  4742     perform varying a1 from +1 by +1 until a1 > m1
  4743        if out-acct-name (a1:1) = '&'
  4744           MOVE out-acct-name (1:A1 - 1)
  4745                                 TO WS-WORK-FIELD (1:A1 - 1)
  4746           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4747           MOVE out-acct-name (A1 + 1:M1 - A1)
  4748                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4749           MOVE WS-WORK-FIELD    TO out-acct-name
  4750           add +2 to a1
  4751        end-if
  4752     end-perform
  4753     MOVE FUNCTION LENGTH(OUT-ORIG-NAME)
  4754                                 TO M1
  4755     MOVE SPACES                 TO WS-WORK-FIELD
  4756     perform varying a1 from +1 by +1 until a1 > m1
  4757        if out-orig-name (a1:1) = '&'
  4758           MOVE out-orig-name (1:A1 - 1)
  4759                                 TO WS-WORK-FIELD (1:A1 - 1)
  4760           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4761           MOVE out-orig-name (A1 + 1:M1 - A1)
  4762                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4763           MOVE WS-WORK-FIELD    TO out-orig-name
  4764           add +2 to a1
  4765        end-if
  4766     end-perform
  4767     MOVE FUNCTION LENGTH(OUT-INS-NAME)
  4768                                 TO M1
  4769     MOVE SPACES                 TO WS-WORK-FIELD
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  84
* NSRLTRBL.cbl
  4770     perform varying a1 from +1 by +1 until a1 > m1
  4771        if out-ins-name (a1:1) = '&'
  4772           MOVE out-ins-name (1:A1 - 1)
  4773                                 TO WS-WORK-FIELD (1:A1 - 1)
  4774           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4775           MOVE out-ins-name (A1 + 1:M1 - A1)
  4776                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4777           MOVE WS-WORK-FIELD    TO out-ins-name
  4778           add +2 to a1
  4779        end-if
  4780     end-perform
  4781     MOVE FUNCTION LENGTH(OUT-INS-ADDR1)
  4782                                 TO M1
  4783     MOVE SPACES                 TO WS-WORK-FIELD
  4784     perform varying a1 from +1 by +1 until a1 > m1
  4785        if out-ins-addr1 (a1:1) = '&'
  4786           MOVE out-ins-addr1 (1:A1 - 1)
  4787                                 TO WS-WORK-FIELD (1:A1 - 1)
  4788           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4789           MOVE out-ins-addr1 (A1 + 1:M1 - A1)
  4790                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4791           MOVE WS-WORK-FIELD    TO out-ins-addr1
  4792           add +2 to a1
  4793        end-if
  4794     end-perform
  4795     MOVE FUNCTION LENGTH(OUT-INS-ADDR2)
  4796                                 TO M1
  4797     MOVE SPACES                 TO WS-WORK-FIELD
  4798     perform varying a1 from +1 by +1 until a1 > m1
  4799        if out-ins-addr2 (a1:1) = '&'
  4800           MOVE out-ins-addr2 (1:A1 - 1)
  4801                                 TO WS-WORK-FIELD (1:A1 - 1)
  4802           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4803           MOVE out-ins-addr2 (A1 + 1:M1 - A1)
  4804                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4805           MOVE WS-WORK-FIELD    TO out-ins-addr2
  4806           add +2 to a1
  4807        end-if
  4808     end-perform
  4809     MOVE FUNCTION LENGTH(OUT-BEN-NAME)   TO M1
  4810     MOVE SPACES                 TO WS-WORK-FIELD
  4811     perform varying a1 from +1 by +1 until a1 > m1
  4812        if out-ben-name (a1:1) = '&'
  4813           MOVE out-ben-name (1:A1 - 1)
  4814                                 TO WS-WORK-FIELD (1:A1 - 1)
  4815           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4816           MOVE out-ben-name (A1 + 1:M1 - A1)
  4817                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4818           MOVE WS-WORK-FIELD    TO out-ben-name
  4819           add +2 to a1
  4820        end-if
  4821     end-perform
  4822     MOVE FUNCTION LENGTH(OUT-BEN-ADDR1)
  4823                                 TO M1
  4824     MOVE SPACES                 TO WS-WORK-FIELD
  4825     perform varying a1 from +1 by +1 until a1 > m1
  4826        if out-ben-addr1 (a1:1) = '&'
  4827           MOVE out-ben-addr1 (1:A1 - 1)
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  85
* NSRLTRBL.cbl
  4828                                 TO WS-WORK-FIELD (1:A1 - 1)
  4829           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4830           MOVE out-ben-addr1 (A1 + 1:M1 - A1)
  4831                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4832           MOVE WS-WORK-FIELD    TO out-ben-addr1
  4833           add +2 to a1
  4834        end-if
  4835     end-perform
  4836     MOVE FUNCTION LENGTH(OUT-BEN-ADDR2)
  4837                                 TO M1
  4838     MOVE SPACES                 TO WS-WORK-FIELD
  4839     perform varying a1 from +1 by +1 until a1 > m1
  4840        if out-ben-addr2 (a1:1) = '&'
  4841           MOVE out-ben-addr2 (1:A1 - 1)
  4842                                 TO WS-WORK-FIELD (1:A1 - 1)
  4843           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4844           MOVE out-ben-addr2 (A1 + 1:M1 - A1)
  4845                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4846           MOVE WS-WORK-FIELD    TO out-ben-addr2
  4847           add +2 to a1
  4848        end-if
  4849     end-perform
  4850     MOVE FUNCTION LENGTH(OUT-DIAG)       TO M1
  4851     MOVE SPACES                 TO WS-WORK-FIELD
  4852     perform varying a1 from +1 by +1 until a1 > m1
  4853        if out-diag (a1:1) = '&'
  4854           MOVE out-diag (1:A1 - 1)
  4855                                 TO WS-WORK-FIELD (1:A1 - 1)
  4856           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4857           MOVE out-diag (A1 + 1:M1 - A1)
  4858                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4859           MOVE WS-WORK-FIELD    TO out-diag
  4860           add +2 to a1
  4861        end-if
  4862     end-perform
  4863     MOVE ZEROS TO WS-TALLY WS-TALLY1
  4864     INSPECT NAPER-OUTPUT-DATA TALLYING WS-TALLY
  4865        FOR ALL '%'
  4866     INSPECT NAPER-OUTPUT-DATA TALLYING WS-TALLY1
  4867        FOR ALL '%26'
  4868     IF (WS-TALLY > 0)
  4869        AND (WS-TALLY NOT = WS-TALLY1)
  4870        MOVE +1                  TO A1
  4871        MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  4872                                 TO NS-LEN
  4873        PERFORM WS-TALLY TIMES
  4874           PERFORM VARYING A1 FROM A1 BY +1 UNTIL
  4875              (A1 > NS-LEN)
  4876              OR (NAPER-OUTPUT-DATA (A1:1) = '%')
  4877           END-PERFORM
  4878           IF A1 > NS-LEN
  4879              CONTINUE
  4880           ELSE
  4881              IF NAPER-OUTPUT-DATA (A1:3) = '%26'
  4882                 ADD +1 TO A1
  4883              ELSE
  4884                 MOVE NAPER-OUTPUT-DATA (1:A1 - 1)
  4885                                 TO WS-XML-WORK
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  86
* NSRLTRBL.cbl
  4886                 MOVE '%25'      TO WS-XML-WORK (A1:3)
  4887                 MOVE NAPER-OUTPUT-DATA (A1 + 1:NS-LEN - A1)
  4888                              TO WS-XML-WORK (A1 + 3:NS-LEN - A1)
  4889                 MOVE WS-XML-WORK TO NAPER-OUTPUT-DATA
  4890                 ADD +3 TO A1
  4891              END-IF
  4892           END-IF
  4893        END-PERFORM
  4894     END-IF
  4895     .
  4896 0500-EXIT.
  4897     EXIT.
  4898 1000-GET-FILES.
  4899     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  4900     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  4901     MOVE ' '                    TO WS-FOUND-BENE-SW
  4902     PERFORM 1250-GET-ELLETR     THRU 1250-EXIT
  4903     PERFORM 1300-GET-ELTRLRS    THRU 1300-EXIT
  4904     PERFORM 1700-GET-ELENCC     THRU 1700-EXIT
  4905     IF CL-CLAIM-TYPE NOT = 'L' AND 'P' AND 'O'
  4906        PERFORM 1400-GET-WAIT-PER THRU 1400-EXIT
  4907     END-IF
  4908     IF NOT FOUND-BENE
  4909        MOVE CL-COMPANY-CD       TO WS-ELBENE-COMPANY-CD
  4910        MOVE 'B'                 TO WS-ELBENE-REC-TYPE
  4911        MOVE CL-BENEFICIARY      TO WS-ELBENE-BENE
  4912
  4913* EXEC CICS READ
  4914*            DATASET    ('ELBENE')
  4915*            INTO       (BENEFICIARY-MASTER)
  4916*            RIDFLD     (WS-ELBENE-KEY)
  4917*            RESP       (WS-RESPONSE)
  4918*       END-EXEC
  4919     MOVE LENGTH OF
  4920      BENEFICIARY-MASTER
  4921       TO DFHEIV11
  4922     MOVE 'ELBENE' TO DFHEIV1
  4923*    MOVE '&"IL       E          (  N#00004874' TO DFHEIV0
  4924     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4925     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4926     MOVE X'204E233030303034383734' TO DFHEIV0(25:11)
  4927     CALL 'kxdfhei1' USING DFHEIV0,
  4928           DFHEIV1,
  4929           BENEFICIARY-MASTER,
  4930           DFHEIV11,
  4931           WS-ELBENE-KEY,
  4932           DFHEIV99,
  4933           DFHEIV99,
  4934           DFHEIV99
  4935     MOVE EIBRESP  TO WS-RESPONSE
  4936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4937        IF RESP-NORMAL
  4938           MOVE BE-MAIL-TO-NAME   TO OUT-BEN-NAME
  4939           MOVE BE-ADDRESS-LINE-1 TO OUT-BEN-ADDR1
  4940           MOVE BE-ADDRESS-LINE-2 TO OUT-BEN-ADDR2
  4941           MOVE BE-CITY           TO OUT-BEN-CITY
  4942           MOVE BE-STATE          TO OUT-BEN-STATE
  4943           MOVE BE-ZIP-PRIME      TO OUT-BEN-ZIP
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  87
* NSRLTRBL.cbl
  4944           IF BE-ZIP-PLUS4 NOT = SPACES AND ZEROS
  4945              STRING '-' BE-ZIP-PLUS4 DELIMITED BY SIZE
  4946                 INTO OUT-BEN-ZIP (6:5)
  4947              END-STRING
  4948           END-IF
  4949           MOVE BE-PHONE-NO       TO OUT-BEN-PHONE
  4950        END-IF
  4951     END-IF
  4952     .
  4953 1000-EXIT.
  4954     EXIT.
  4955 1100-GET-ELCERT.
  4956     MOVE CL-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  4957     MOVE CL-CERT-KEY-DATA       TO WS-ELCERT-KEY (2:21)
  4958     MOVE CL-CERT-NO             TO WS-ELCERT-CERT-NO
  4959
  4960* EXEC CICS READ
  4961*         DATASET    ('ELCERT')
  4962*         INTO       (CERTIFICATE-MASTER)
  4963*         RIDFLD     (WS-ELCERT-KEY)
  4964*         RESP       (WS-RESPONSE)
  4965*    END-EXEC.
  4966     MOVE LENGTH OF
  4967      CERTIFICATE-MASTER
  4968       TO DFHEIV11
  4969     MOVE 'ELCERT' TO DFHEIV1
  4970*    MOVE '&"IL       E          (  N#00004902' TO DFHEIV0
  4971     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4972     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4973     MOVE X'204E233030303034393032' TO DFHEIV0(25:11)
  4974     CALL 'kxdfhei1' USING DFHEIV0,
  4975           DFHEIV1,
  4976           CERTIFICATE-MASTER,
  4977           DFHEIV11,
  4978           WS-ELCERT-KEY,
  4979           DFHEIV99,
  4980           DFHEIV99,
  4981           DFHEIV99
  4982     MOVE EIBRESP  TO WS-RESPONSE
  4983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4984
  4985     IF RESP-NORMAL
  4986        IF CL-CLAIM-TYPE = 'L' OR 'P' OR 'O'
  4987           MOVE CM-LF-BENEFIT-AMT TO OUT-BENAMT
  4988           MOVE CM-LF-ORIG-TERM  TO OUT-TERM
  4989           MOVE CM-LF-BENEFIT-CD TO OUT-BEN-CD
  4990           MOVE CM-LF-CRITICAL-PERIOD
  4991                                 TO OUT-CRIT-PER
  4992           MOVE CM-LF-LOAN-EXPIRE-DT
  4993                                 TO DC-BIN-DATE-1
  4994           MOVE ' '              TO DC-OPTION-CODE
  4995           PERFORM 9700-DATE-LINK
  4996                                 THRU 9700-EXIT
  4997           IF NO-CONVERSION-ERROR
  4998              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4999                 DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5000                 INTO OUT-EXP-DT
  5001              END-STRING
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  88
* NSRLTRBL.cbl
  5002           ELSE
  5003              MOVE SPACES        TO OUT-EXP-DT
  5004           END-IF
  5005        ELSE
  5006           MOVE CM-AH-BENEFIT-AMT TO OUT-BENAMT
  5007           MOVE CM-AH-ORIG-TERM  TO OUT-TERM
  5008           MOVE CM-AH-BENEFIT-CD TO OUT-BEN-CD
  5009           MOVE CM-AH-CRITICAL-PERIOD
  5010                                 TO OUT-CRIT-PER
  5011           MOVE CM-AH-LOAN-EXPIRE-DT
  5012                                 TO DC-BIN-DATE-1
  5013           MOVE ' '              TO DC-OPTION-CODE
  5014           PERFORM 9700-DATE-LINK
  5015                                 THRU 9700-EXIT
  5016           IF NO-CONVERSION-ERROR
  5017              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5018                 DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5019                 INTO OUT-EXP-DT
  5020              END-STRING
  5021           ELSE
  5022              MOVE SPACES        TO OUT-EXP-DT
  5023           END-IF
  5024        END-IF
  5025        MOVE CM-ACCOUNT          TO OUT-CERTACCT
  5026        IF CL-INSURED-1ST-NAME = CM-INSURED-FIRST-NAME
  5027            MOVE CM-JT-FIRST-NAME TO OUT-JFNAME
  5028            MOVE CM-JT-LAST-NAME  TO OUT-JLNAME
  5029        ELSE
  5030            MOVE CM-INSURED-FIRST-NAME TO OUT-JFNAME
  5031            MOVE CM-INSURED-LAST-NAME TO OUT-JLNAME
  5032        END-IF
  5033        MOVE CM-LOAN-APR         TO OUT-APR
  5034     END-IF
  5035     .
  5036 1100-EXIT.
  5037     EXIT.
  5038 1200-GET-ERACCT.
  5039    MOVE LOW-VALUES              TO WS-ERACCT-KEY
  5040    MOVE WS-ELCERT-KEY (1:22)    TO WS-ERACCT-KEY (1:22)
  5041
  5042* EXEC CICS STARTBR
  5043*        DATASET   ('ERACCT')
  5044*        RIDFLD    (WS-ERACCT-KEY)
  5045*        GTEQ
  5046*        RESP      (WS-RESPONSE)
  5047*    END-EXEC
  5048     MOVE 'ERACCT' TO DFHEIV1
  5049     MOVE 0
  5050       TO DFHEIV11
  5051*    MOVE '&,         G          &  N#00004964' TO DFHEIV0
  5052     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5053     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5054     MOVE X'204E233030303034393634' TO DFHEIV0(25:11)
  5055     CALL 'kxdfhei1' USING DFHEIV0,
  5056           DFHEIV1,
  5057           WS-ERACCT-KEY,
  5058           DFHEIV99,
  5059           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  89
* NSRLTRBL.cbl
  5060           DFHEIV99
  5061     MOVE EIBRESP  TO WS-RESPONSE
  5062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5063     IF RESP-NORMAL
  5064
  5065* EXEC CICS READNEXT
  5066*          INTO    (ACCOUNT-MASTER)
  5067*          DATASET ('ERACCT')
  5068*          RIDFLD  (WS-ERACCT-KEY)
  5069*          RESP    (WS-RESPONSE)
  5070*       END-EXEC
  5071     MOVE LENGTH OF
  5072      ACCOUNT-MASTER
  5073       TO DFHEIV12
  5074     MOVE 'ERACCT' TO DFHEIV1
  5075     MOVE 0
  5076       TO DFHEIV11
  5077*    MOVE '&.IL                  )  N#00004971' TO DFHEIV0
  5078     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5079     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5080     MOVE X'204E233030303034393731' TO DFHEIV0(25:11)
  5081     CALL 'kxdfhei1' USING DFHEIV0,
  5082           DFHEIV1,
  5083           ACCOUNT-MASTER,
  5084           DFHEIV12,
  5085           WS-ERACCT-KEY,
  5086           DFHEIV99,
  5087           DFHEIV11,
  5088           DFHEIV99,
  5089           DFHEIV99
  5090     MOVE EIBRESP  TO WS-RESPONSE
  5091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5092     END-IF
  5093     IF RESP-NORMAL
  5094        PERFORM WITH TEST AFTER UNTIL
  5095           NOT (RESP-NORMAL)
  5096           OR (CM-CONTROL-PRIMARY (1:20) NOT =
  5097                        AM-CONTROL-PRIMARY (1:20))
  5098           IF (CM-CONTROL-PRIMARY (1:20)
  5099              = AM-CONTROL-PRIMARY (1:20))
  5100              IF (CL-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5101                 AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5102                 MOVE AM-NAME    TO OUT-ORIG-NAME
  5103                 MOVE ACCOUNT-MASTER TO SAVE-ACCOUNT-MASTER
  5104              END-IF
  5105              MOVE AM-NAME       TO OUT-ACCT-NAME
  5106              MOVE AM-ADDRS      TO OUT-ACCT-ADDR1
  5107              MOVE SPACES        TO OUT-ACCT-ADDR2
  5108              MOVE AM-ADDR-CITY  TO OUT-ACCT-CITY
  5109              MOVE AM-ADDR-STATE TO OUT-ACCT-STATE
  5110              MOVE AM-ZIP-PRIME  TO OUT-ACCT-ZIP
  5111              IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5112                 STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  5113                    INTO OUT-ACCT-ZIP (6:5)
  5114                 END-STRING
  5115              END-IF
  5116              MOVE AM-TEL-NO     TO OUT-ACCT-PHONE
  5117              MOVE AM-GPCD       TO OUT-ACCT-GPCD
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  90
* NSRLTRBL.cbl
  5118
  5119* EXEC CICS READNEXT
  5120*                INTO    (ACCOUNT-MASTER)
  5121*                DATASET ('ERACCT')
  5122*                RIDFLD  (WS-ERACCT-KEY)
  5123*                RESP    (WS-RESPONSE)
  5124*             END-EXEC
  5125     MOVE LENGTH OF
  5126      ACCOUNT-MASTER
  5127       TO DFHEIV12
  5128     MOVE 'ERACCT' TO DFHEIV1
  5129     MOVE 0
  5130       TO DFHEIV11
  5131*    MOVE '&.IL                  )  N#00005003' TO DFHEIV0
  5132     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5133     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5134     MOVE X'204E233030303035303033' TO DFHEIV0(25:11)
  5135     CALL 'kxdfhei1' USING DFHEIV0,
  5136           DFHEIV1,
  5137           ACCOUNT-MASTER,
  5138           DFHEIV12,
  5139           WS-ERACCT-KEY,
  5140           DFHEIV99,
  5141           DFHEIV11,
  5142           DFHEIV99,
  5143           DFHEIV99
  5144     MOVE EIBRESP  TO WS-RESPONSE
  5145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5146           END-IF
  5147        END-PERFORM
  5148     END-IF
  5149     MOVE SAVE-ACCOUNT-MASTER  TO ACCOUNT-MASTER
  5150    .
  5151 1200-EXIT.
  5152     EXIT.
  5153 1250-GET-ELLETR.
  5154     MOVE CL-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  5155     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  5156     MOVE +0                     TO WS-ELLETR-SEQ-NO
  5157
  5158* EXEC CICS READ
  5159*         DATASET    ('ELLETR')
  5160*         INTO       (TEXT-FILES)
  5161*         RIDFLD     (WS-ELLETR-KEY)
  5162*         RESP       (WS-RESPONSE)
  5163*         GTEQ
  5164*    END-EXEC
  5165     MOVE LENGTH OF
  5166      TEXT-FILES
  5167       TO DFHEIV11
  5168     MOVE 'ELLETR' TO DFHEIV1
  5169*    MOVE '&"IL       G          (  N#00005020' TO DFHEIV0
  5170     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5171     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5172     MOVE X'204E233030303035303230' TO DFHEIV0(25:11)
  5173     CALL 'kxdfhei1' USING DFHEIV0,
  5174           DFHEIV1,
  5175           TEXT-FILES,
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  91
* NSRLTRBL.cbl
  5176           DFHEIV11,
  5177           WS-ELLETR-KEY,
  5178           DFHEIV99,
  5179           DFHEIV99,
  5180           DFHEIV99
  5181     MOVE EIBRESP  TO WS-RESPONSE
  5182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5183     IF RESP-NORMAL
  5184        IF (LETTER-FILE-TEXT)
  5185           AND (BL-LETTER-ID = TX-LETTER-NO)
  5186           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  5187           PERFORM 1280-PROCESS-Z-CONTROLS
  5188                                 THRU 1280-EXIT
  5189        END-IF
  5190     END-IF
  5191     .
  5192 1250-EXIT.
  5193     EXIT.
  5194 1280-PROCESS-Z-CONTROLS.
  5195     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  5196     IF W-FORM-TO-RESEND > SPACES
  5197        MOVE W-FORM-TO-RESEND    TO OUT-FORM
  5198     ELSE
  5199        MOVE SPACES              TO OUT-FORM
  5200     END-IF.
  5201*    MOVE W-ENCLOSURE-CD         TO OUT-ENC-CODE
  5202     .
  5203 1280-EXIT.
  5204     EXIT.
  5205 1300-GET-ELTRLRS.
  5206     MOVE CL-CONTROL-PRIMARY     TO WS-ELTRLR-KEY
  5207     MOVE +0                     TO WS-ELTRLR-SEQ-NO
  5208
  5209* EXEC CICS STARTBR
  5210*        DATASET   ('ELTRLR')
  5211*        RIDFLD    (WS-ELTRLR-KEY)
  5212*        GTEQ
  5213*        RESP      (WS-RESPONSE)
  5214*    END-EXEC
  5215     MOVE 'ELTRLR' TO DFHEIV1
  5216     MOVE 0
  5217       TO DFHEIV11
  5218*    MOVE '&,         G          &  N#00005052' TO DFHEIV0
  5219     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5220     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5221     MOVE X'204E233030303035303532' TO DFHEIV0(25:11)
  5222     CALL 'kxdfhei1' USING DFHEIV0,
  5223           DFHEIV1,
  5224           WS-ELTRLR-KEY,
  5225           DFHEIV99,
  5226           DFHEIV11,
  5227           DFHEIV99
  5228     MOVE EIBRESP  TO WS-RESPONSE
  5229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5230    IF RESP-NORMAL
  5231
  5232* EXEC CICS READNEXT
  5233*         INTO    (ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  92
* NSRLTRBL.cbl
  5234*         DATASET ('ELTRLR')
  5235*         RIDFLD  (WS-ELTRLR-KEY)
  5236*         RESP    (WS-RESPONSE)
  5237*      END-EXEC
  5238     MOVE LENGTH OF
  5239      ACTIVITY-TRAILERS
  5240       TO DFHEIV12
  5241     MOVE 'ELTRLR' TO DFHEIV1
  5242     MOVE 0
  5243       TO DFHEIV11
  5244*    MOVE '&.IL                  )  N#00005059' TO DFHEIV0
  5245     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5246     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5247     MOVE X'204E233030303035303539' TO DFHEIV0(25:11)
  5248     CALL 'kxdfhei1' USING DFHEIV0,
  5249           DFHEIV1,
  5250           ACTIVITY-TRAILERS,
  5251           DFHEIV12,
  5252           WS-ELTRLR-KEY,
  5253           DFHEIV99,
  5254           DFHEIV11,
  5255           DFHEIV99,
  5256           DFHEIV99
  5257     MOVE EIBRESP  TO WS-RESPONSE
  5258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5259       PERFORM 1310-GET-ELTRLRS THRU 1310-EXIT
  5260    END-IF
  5261     .
  5262 1300-EXIT.
  5263     EXIT.
  5264 1310-GET-ELTRLRS.
  5265     IF RESP-NORMAL
  5266     IF CL-CONTROL-PRIMARY = AT-CONTROL-PRIMARY (1:20)
  5267        EVALUATE TRUE
  5268           WHEN AT-INSURED-ADDR-TRL
  5269              MOVE AT-MAIL-TO-NAME   TO OUT-INS-NAME
  5270              MOVE AT-ADDRESS-LINE-1 TO OUT-INS-ADDR1
  5271              MOVE AT-ADDRESS-LINE-2 TO OUT-INS-ADDR2
  5272              MOVE AT-CITY           TO OUT-INS-CITY
  5273              MOVE AT-STATE          TO OUT-INS-STATE
  5274              MOVE AT-ZIP-CODE       TO OUT-INS-ZIP
  5275              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5276                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5277                    INTO OUT-INS-ZIP (6:5)
  5278                 END-STRING
  5279              END-IF
  5280              MOVE AT-PHONE-NO       TO OUT-INS-PHONE
  5281           WHEN AT-BENEFICIARY-ADDR-TRL
  5282              SET FOUND-BENE TO TRUE
  5283              MOVE AT-MAIL-TO-NAME   TO OUT-BEN-NAME
  5284              MOVE AT-ADDRESS-LINE-1 TO OUT-BEN-ADDR1
  5285              MOVE AT-ADDRESS-LINE-2 TO OUT-BEN-ADDR2
  5286              MOVE AT-CITY           TO OUT-BEN-CITY
  5287              MOVE AT-STATE          TO OUT-BEN-STATE
  5288              MOVE AT-ZIP-CODE       TO OUT-BEN-ZIP
  5289              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5290                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5291                    INTO OUT-BEN-ZIP (6:5)
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  93
* NSRLTRBL.cbl
  5292                 END-STRING
  5293              END-IF
  5294              MOVE AT-PHONE-NO       TO OUT-BEN-PHONE
  5295           WHEN AT-ACCOUNT-ADDR-TRL
  5296              MOVE AT-MAIL-TO-NAME   TO OUT-ACCT-NAME
  5297              MOVE AT-ADDRESS-LINE-1 TO OUT-ACCT-ADDR1
  5298              MOVE AT-ADDRESS-LINE-2 TO OUT-ACCT-ADDR2
  5299              MOVE AT-CITY           TO OUT-ACCT-CITY
  5300              MOVE AT-STATE          TO OUT-ACCT-STATE
  5301              MOVE AT-ZIP-CODE       TO OUT-ACCT-ZIP
  5302              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5303                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5304                    INTO OUT-ACCT-ZIP (6:5)
  5305                 END-STRING
  5306              END-IF
  5307              MOVE AT-PHONE-NO       TO OUT-ACCT-PHONE
  5308           WHEN AT-SEQUENCE-NO = +90
  5309              MOVE AT-INFO-LINE-1   TO OUT-DIAG
  5310           WHEN AT-SEQUENCE-NO = +91
  5311              MOVE AT-INFO-LINE-1 TO OUT-LOAN-NO
  5312           WHEN AT-TRAILER-TYPE = '2' AND AT-PAYMENT-TYPE = 'I'
  5313              IF AT-INT-RATE NUMERIC AND
  5314                 AT-INT-RATE NOT EQUAL ZEROS
  5315                    COMPUTE OUT-LF-INT-RATE = AT-INT-RATE * 100
  5316              END-IF
  5317           WHEN AT-TRAILER-TYPE = '3'
  5318              IF (SAVE-BIN-DATE >= AT-SCHEDULE-START-DT)
  5319                 AND (SAVE-BIN-DATE <= AT-SCHEDULE-END-DT)
  5320                 AND (AT-TERMINATED-DT = LOW-VALUES OR SPACES)
  5321                 MOVE AT-SCHEDULE-END-DT TO WS-AUTO-LAST-SCHED-DT
  5322              END-IF
  5323           WHEN AT-TRAILER-TYPE = '8'
  5324              IF AT-RECORDED-DT > WS-LAST-ACT-DT
  5325                 MOVE AT-RECORDED-DT
  5326                              TO WS-LAST-ACT-DT
  5327                 MOVE 'DENIAL'
  5328                              TO WS-LAST-ACT-TYPE
  5329              END-IF
  5330           WHEN AT-TRAILER-TYPE = 'A'
  5331              IF AT-RECORDED-DT > WS-LAST-ACT-DT
  5332                 MOVE AT-RECORDED-DT
  5333                              TO WS-LAST-ACT-DT
  5334                 MOVE 'FORMS' TO WS-LAST-ACT-TYPE
  5335                 IF INITIAL-FORM
  5336                    MOVE 'INIT'
  5337                              TO WS-FORM
  5338                 END-IF
  5339                 IF PROGRESS-FORM
  5340                    MOVE 'PROG'
  5341                              TO WS-FORM
  5342                 END-IF
  5343              END-IF
  5344              IF AT-FORM-SEND-ON-DT > WS-ACTIVITY-DT
  5345                 MOVE AT-FORM-SEND-ON-DT
  5346                              TO WS-ACTIVITY-DT
  5347              END-IF
  5348              IF AT-FORM-REPRINT-DT > WS-ACTIVITY-DT
  5349                 MOVE AT-FORM-REPRINT-DT
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  94
* NSRLTRBL.cbl
  5350                              TO WS-ACTIVITY-DT
  5351              END-IF
  5352              IF AT-FORM-ANSWERED-DT > WS-ACTIVITY-DT
  5353                 MOVE AT-FORM-ANSWERED-DT
  5354                              TO WS-ACTIVITY-DT
  5355              END-IF
  5356        END-EVALUATE
  5357
  5358* EXEC CICS READNEXT
  5359*         INTO    (ACTIVITY-TRAILERS)
  5360*         DATASET ('ELTRLR')
  5361*         RIDFLD  (WS-ELTRLR-KEY)
  5362*         RESP    (WS-RESPONSE)
  5363*       END-EXEC
  5364     MOVE LENGTH OF
  5365      ACTIVITY-TRAILERS
  5366       TO DFHEIV12
  5367     MOVE 'ELTRLR' TO DFHEIV1
  5368     MOVE 0
  5369       TO DFHEIV11
  5370*    MOVE '&.IL                  )  N#00005163' TO DFHEIV0
  5371     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5372     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5373     MOVE X'204E233030303035313633' TO DFHEIV0(25:11)
  5374     CALL 'kxdfhei1' USING DFHEIV0,
  5375           DFHEIV1,
  5376           ACTIVITY-TRAILERS,
  5377           DFHEIV12,
  5378           WS-ELTRLR-KEY,
  5379           DFHEIV99,
  5380           DFHEIV11,
  5381           DFHEIV99,
  5382           DFHEIV99
  5383     MOVE EIBRESP  TO WS-RESPONSE
  5384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5385        GO TO 1310-GET-ELTRLRS
  5386     END-IF
  5387     END-IF
  5388     .
  5389 1310-EXIT.
  5390     EXIT.
  5391 1400-GET-WAIT-PER.
  5392     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  5393     MOVE CM-AH-BENEFIT-CD       TO WS-ELCNTL-BEN-CD
  5394     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  5395     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  5396
  5397* EXEC CICS READ
  5398*       INTO    (CONTROL-FILE)
  5399*       DATASET ('ELCNTL')
  5400*       RIDFLD  (WS-ELCNTL-KEY)
  5401*       GTEQ
  5402*       RESP    (WS-RESPONSE)
  5403*    END-EXEC
  5404     MOVE LENGTH OF
  5405      CONTROL-FILE
  5406       TO DFHEIV11
  5407     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  95
* NSRLTRBL.cbl
  5408*    MOVE '&"IL       G          (  N#00005180' TO DFHEIV0
  5409     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5410     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5411     MOVE X'204E233030303035313830' TO DFHEIV0(25:11)
  5412     CALL 'kxdfhei1' USING DFHEIV0,
  5413           DFHEIV1,
  5414           CONTROL-FILE,
  5415           DFHEIV11,
  5416           WS-ELCNTL-KEY,
  5417           DFHEIV99,
  5418           DFHEIV99,
  5419           DFHEIV99
  5420     MOVE EIBRESP  TO WS-RESPONSE
  5421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5422     IF RESP-NORMAL
  5423        AND (CF-COMPANY-ID  = BL-COMP-ID)
  5424        AND (CF-RECORD-TYPE = '5')
  5425        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5426           (S1 > +8)
  5427           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5428        END-PERFORM
  5429        IF S1 > +8
  5430           MOVE '**'             TO OUT-WAIT-PER
  5431        ELSE
  5432           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  5433                                 TO OUT-WAIT-PER
  5434        END-IF
  5435     ELSE
  5436        MOVE '**'                TO OUT-WAIT-PER
  5437     END-IF
  5438    .
  5439 1400-EXIT.
  5440     EXIT.
  5441 1500-GET-ARCH-NO.
  5442     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  5443     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  5444     MOVE SPACES                 TO WS-ELCNTL-GENL
  5445     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  5446
  5447* EXEC CICS READ
  5448*       INTO    (CONTROL-FILE)
  5449*       DATASET ('ELCNTL')
  5450*       RIDFLD  (WS-ELCNTL-KEY)
  5451*       UPDATE
  5452*       RESP    (WS-RESPONSE)
  5453*    END-EXEC
  5454     MOVE LENGTH OF
  5455      CONTROL-FILE
  5456       TO DFHEIV11
  5457     MOVE 'ELCNTL' TO DFHEIV1
  5458*    MOVE '&"IL       EU         (  N#00005212' TO DFHEIV0
  5459     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5460     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5461     MOVE X'204E233030303035323132' TO DFHEIV0(25:11)
  5462     CALL 'kxdfhei1' USING DFHEIV0,
  5463           DFHEIV1,
  5464           CONTROL-FILE,
  5465           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  96
* NSRLTRBL.cbl
  5466           WS-ELCNTL-KEY,
  5467           DFHEIV99,
  5468           DFHEIV99,
  5469           DFHEIV99
  5470     MOVE EIBRESP  TO WS-RESPONSE
  5471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5472     IF RESP-NORMAL
  5473        AND (CF-COMPANY-ID  = BL-COMP-ID)
  5474        AND (CF-RECORD-TYPE = '1')
  5475        ADD +1                   TO CF-CO-ARCHIVE-COUNTER
  5476        MOVE CF-CO-ARCHIVE-COUNTER TO WS-ARCHIVE-NO
  5477        MOVE WS-ARCHIVE-NO       TO BL-ARCHIVE-NO
  5478
  5479* EXEC CICS REWRITE
  5480*          FROM    (CONTROL-FILE)
  5481*          DATASET ('ELCNTL')
  5482*       END-EXEC
  5483     MOVE LENGTH OF
  5484      CONTROL-FILE
  5485       TO DFHEIV11
  5486     MOVE 'ELCNTL' TO DFHEIV1
  5487*    MOVE '&& L                  %   #00005225' TO DFHEIV0
  5488     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5489     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5490     MOVE X'2020233030303035323235' TO DFHEIV0(25:11)
  5491     CALL 'kxdfhei1' USING DFHEIV0,
  5492           DFHEIV1,
  5493           CONTROL-FILE,
  5494           DFHEIV11,
  5495           DFHEIV99
  5496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5497     ELSE
  5498        MOVE +0                  TO WS-ARCHIVE-NO
  5499     END-IF
  5500    .
  5501 1500-EXIT.
  5502     EXIT.
  5503 1600-ADD-CORR-TRLR.
  5504
  5505* EXEC CICS READ
  5506*         DATASET    ('ELMSTR')
  5507*         INTO       (CLAIM-MASTER)
  5508*         RIDFLD     (WS-ELMSTR-KEY)
  5509*         UPDATE
  5510*         RESP       (WS-RESPONSE)
  5511*    END-EXEC
  5512     MOVE LENGTH OF
  5513      CLAIM-MASTER
  5514       TO DFHEIV11
  5515     MOVE 'ELMSTR' TO DFHEIV1
  5516*    MOVE '&"IL       EU         (  N#00005236' TO DFHEIV0
  5517     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5518     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5519     MOVE X'204E233030303035323336' TO DFHEIV0(25:11)
  5520     CALL 'kxdfhei1' USING DFHEIV0,
  5521           DFHEIV1,
  5522           CLAIM-MASTER,
  5523           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  97
* NSRLTRBL.cbl
  5524           WS-ELMSTR-KEY,
  5525           DFHEIV99,
  5526           DFHEIV99,
  5527           DFHEIV99
  5528     MOVE EIBRESP  TO WS-RESPONSE
  5529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5530     IF NOT RESP-NORMAL
  5531        DISPLAY ' 1600 READ UPD MSTR ' WS-RESPONSE
  5532        GO TO 1600-EXIT
  5533     END-IF
  5534     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
  5535     PERFORM 2000-BUILD-ELNAPS   THRU 2000-EXIT
  5536     IF WS-FOLLOW-UP-DT > CL-NEXT-FOLLOWUP-DT
  5537        MOVE WS-FOLLOW-UP-DT     TO CL-NEXT-FOLLOWUP-DT
  5538     END-IF
  5539     IF WS-RESEND-DT > CL-NEXT-FOLLOWUP-DT
  5540        MOVE WS-RESEND-DT        TO CL-NEXT-FOLLOWUP-DT
  5541     END-IF
  5542     MOVE '2'                    TO CL-LAST-MAINT-TYPE
  5543     MOVE 'AT'                   TO ACTIVITY-TRAILERS
  5544     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY
  5545     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
  5546     MOVE  4                     TO AT-TRAILER-TYPE
  5547     MOVE SAVE-BIN-DATE          TO AT-RECORDED-DT
  5548                                    CL-LAST-MAINT-DT
  5549                                    AT-CORR-LAST-MAINT-DT
  5550     MOVE BL-PROC-ID             TO AT-RECORDED-BY
  5551                                    CL-LAST-MAINT-USER
  5552                                    AT-CORR-LAST-UPDATED-BY
  5553     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  5554                                    CL-LAST-MAINT-HHMMSS.
  5555     MOVE SAVE-BIN-DATE          TO AT-LETTER-SENT-DT.
  5556     MOVE WS-FOLLOW-UP-DT        TO AT-RECEIPT-FOLLOW-UP.
  5557     MOVE WS-RESEND-DT           TO AT-AUTO-RE-SEND-DT.
  5558     MOVE LOW-VALUES             TO AT-LETTER-ANSWERED-DT
  5559                                    AT-LETTER-PURGED-DT.
  5560     MOVE WS-ARCHIVE-NO          TO AT-LETTER-ARCHIVE-NO.
  5561     MOVE '3'                    TO AT-LETTER-ORIGIN
  5562     MOVE BL-LETTER-ID           TO AT-STD-LETTER-FORM
  5563     MOVE SAVE-BIN-DATE          TO AT-INITIAL-PRINT-DATE
  5564     MOVE LOW-VALUES             TO AT-RESEND-PRINT-DATE
  5565
  5566* EXEC CICS WRITE
  5567*         DATASET    ('ELTRLR')
  5568*         FROM       (ACTIVITY-TRAILERS)
  5569*         RIDFLD     (AT-CONTROL-PRIMARY)
  5570*         RESP       (WS-RESPONSE)
  5571*    END-EXEC
  5572     MOVE LENGTH OF
  5573      ACTIVITY-TRAILERS
  5574       TO DFHEIV11
  5575     MOVE 'ELTRLR' TO DFHEIV1
  5576*    MOVE '&$ L                  ''  N#00005278' TO DFHEIV0
  5577     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5578     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5579     MOVE X'204E233030303035323738' TO DFHEIV0(25:11)
  5580     CALL 'kxdfhei1' USING DFHEIV0,
  5581           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  98
* NSRLTRBL.cbl
  5582           ACTIVITY-TRAILERS,
  5583           DFHEIV11,
  5584           AT-CONTROL-PRIMARY,
  5585           DFHEIV99,
  5586           DFHEIV99
  5587     MOVE EIBRESP  TO WS-RESPONSE
  5588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5589     IF NOT RESP-NORMAL
  5590        DISPLAY ' 1600 WRITE TRLR ' WS-RESPONSE
  5591        GO TO 1600-EXIT
  5592     END-IF
  5593
  5594* EXEC CICS REWRITE
  5595*         DATASET    ('ELMSTR')
  5596*         FROM       (CLAIM-MASTER)
  5597*         RESP       (WS-RESPONSE)
  5598*    END-EXEC
  5599     MOVE LENGTH OF
  5600      CLAIM-MASTER
  5601       TO DFHEIV11
  5602     MOVE 'ELMSTR' TO DFHEIV1
  5603*    MOVE '&& L                  %  N#00005288' TO DFHEIV0
  5604     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5605     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5606     MOVE X'204E233030303035323838' TO DFHEIV0(25:11)
  5607     CALL 'kxdfhei1' USING DFHEIV0,
  5608           DFHEIV1,
  5609           CLAIM-MASTER,
  5610           DFHEIV11,
  5611           DFHEIV99
  5612     MOVE EIBRESP  TO WS-RESPONSE
  5613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5614     IF NOT RESP-NORMAL
  5615        DISPLAY ' 1600 REWRITE MSTR ' WS-RESPONSE
  5616     END-IF
  5617     .
  5618 1600-EXIT.
  5619     EXIT.
  5620 1700-GET-ELENCC.
  5621     MOVE CL-COMPANY-CD          TO WS-ELENCC-KEY
  5622     MOVE '1'                    TO WS-ELENCC-REC-TYPE
  5623     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  5624     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  5625        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  5626        OR (E1 > +5)
  5627     END-PERFORM
  5628     IF E1 < +5
  5629        MOVE CL-CERT-STATE       TO WS-ELENCC-ENC-CODE (E1:2)
  5630     END-IF
  5631
  5632* EXEC CICS READ
  5633*        DATASET   ('ELENCC')
  5634*        INTO      (ENCLOSURE-CODES)
  5635*        RIDFLD    (WS-ELENCC-KEY)
  5636*        RESP      (WS-RESPONSE)
  5637*    END-EXEC
  5638     MOVE LENGTH OF
  5639      ENCLOSURE-CODES
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page  99
* NSRLTRBL.cbl
  5640       TO DFHEIV11
  5641     MOVE 'ELENCC' TO DFHEIV1
  5642*    MOVE '&"IL       E          (  N#00005310' TO DFHEIV0
  5643     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5644     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5645     MOVE X'204E233030303035333130' TO DFHEIV0(25:11)
  5646     CALL 'kxdfhei1' USING DFHEIV0,
  5647           DFHEIV1,
  5648           ENCLOSURE-CODES,
  5649           DFHEIV11,
  5650           WS-ELENCC-KEY,
  5651           DFHEIV99,
  5652           DFHEIV99,
  5653           DFHEIV99
  5654     MOVE EIBRESP  TO WS-RESPONSE
  5655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5656     IF NOT RESP-NORMAL
  5657        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  5658
  5659* EXEC CICS READ
  5660*           DATASET   ('ELENCC')
  5661*           INTO      (ENCLOSURE-CODES)
  5662*           RIDFLD    (WS-ELENCC-KEY)
  5663*           RESP      (WS-RESPONSE)
  5664*       END-EXEC
  5665     MOVE LENGTH OF
  5666      ENCLOSURE-CODES
  5667       TO DFHEIV11
  5668     MOVE 'ELENCC' TO DFHEIV1
  5669*    MOVE '&"IL       E          (  N#00005318' TO DFHEIV0
  5670     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5671     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5672     MOVE X'204E233030303035333138' TO DFHEIV0(25:11)
  5673     CALL 'kxdfhei1' USING DFHEIV0,
  5674           DFHEIV1,
  5675           ENCLOSURE-CODES,
  5676           DFHEIV11,
  5677           WS-ELENCC-KEY,
  5678           DFHEIV99,
  5679           DFHEIV99,
  5680           DFHEIV99
  5681     MOVE EIBRESP  TO WS-RESPONSE
  5682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5683     END-IF
  5684     IF RESP-NORMAL
  5685        MOVE NC-OUTPUT-STACK     TO OUT-OUTSTACK
  5686        MOVE NC-ENCLOSURE-LINE   TO OUT-ENCLINE
  5687        MOVE NC-ATTACHMENTS      TO OUT-ENCATTS
  5688     END-IF
  5689     .
  5690 1700-EXIT.
  5691     EXIT.
  5692 1800-SET-EL150D-FIELDS.
  5693     MOVE SPACES TO WS-UNSORTED-TABLE
  5694                    WS-SORTED-TABLE
  5695
  5696     MOVE ' '                    TO WS-PDEF-RECORD-SW
  5697
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page 100
* NSRLTRBL.cbl
  5698     MOVE CM-CONTROL-PRIMARY     TO ELCRTT-KEY
  5699     MOVE 'B'                    TO CRTT-REC-TYPE
  5700
  5701
  5702* EXEC CICS READ
  5703*       DATASET   ('ELCRTT')
  5704*       INTO      (CERTIFICATE-TRAILERS)
  5705*       RIDFLD    (ELCRTT-KEY)
  5706*       RESP      (WS-RESPONSE)
  5707*    END-EXEC
  5708     MOVE LENGTH OF
  5709      CERTIFICATE-TRAILERS
  5710       TO DFHEIV11
  5711     MOVE 'ELCRTT' TO DFHEIV1
  5712*    MOVE '&"IL       E          (  N#00005342' TO DFHEIV0
  5713     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5714     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5715     MOVE X'204E233030303035333432' TO DFHEIV0(25:11)
  5716     CALL 'kxdfhei1' USING DFHEIV0,
  5717           DFHEIV1,
  5718           CERTIFICATE-TRAILERS,
  5719           DFHEIV11,
  5720           ELCRTT-KEY,
  5721           DFHEIV99,
  5722           DFHEIV99,
  5723           DFHEIV99
  5724     MOVE EIBRESP  TO WS-RESPONSE
  5725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5726
  5727     IF NOT RESP-NORMAL
  5728        DISPLAY ' NSRLTRBL- NO TRLRS ' CL-CERT-NO
  5729        GO TO 1800-EXIT
  5730     END-IF
  5731
  5732     DISPLAY ' NSRLTRBL- GOOD READ ON ELCRTT '
  5733     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5734       (S1 > +24)
  5735       OR (CS-CLAIM-NO (S1) = SPACES)
  5736        MOVE CS-CLAIM-NO (S1)    TO WS-CLAIM-NO (S1)
  5737        MOVE CS-CLAIM-TYPE (S1)  TO WS-CLM-TYPE (S1)
  5738        IF CS-INSURED-TYPE (S1) = 'C'
  5739           MOVE '2'              TO WS-INS-TYPE (S1)
  5740        ELSE
  5741           MOVE '1'              TO WS-INS-TYPE (S1)
  5742        END-IF
  5743        MOVE CS-BENEFIT-PERIOD (S1)
  5744                                 TO WS-BEN-PER (S1)
  5745*       MOVE CS-DAYS-PAID (S1)   TO WS-DAYS-PAID (S1)
  5746        MOVE CS-TOTAL-PAID (S1)  TO WS-TOTAL-PAID (S1)
  5747        MOVE ' '                 TO WS-SORTED-SW (S1)
  5748
  5749        MOVE CS-COMPANY-CD          TO WS-ELMSTR-COMPANY-CD
  5750        MOVE CS-CARRIER             TO WS-ELMSTR-CARRIER
  5751        MOVE CS-CLAIM-NO (S1)       TO WS-ELMSTR-CLAIM-NO
  5752        MOVE CS-CERT-NO             TO WS-ELMSTR-CERT-NO
  5753
  5754
  5755* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page 101
* NSRLTRBL.cbl
  5756*          DATASET        ('ELMSTR')
  5757*          RIDFLD         (WS-ELMSTR-KEY)
  5758*          INTO           (CLAIM-MASTER)
  5759*          RESP           (WS-RESPONSE)
  5760*       END-EXEC
  5761     MOVE LENGTH OF
  5762      CLAIM-MASTER
  5763       TO DFHEIV11
  5764     MOVE 'ELMSTR' TO DFHEIV1
  5765*    MOVE '&"IL       E          (  N#00005376' TO DFHEIV0
  5766     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5767     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5768     MOVE X'204E233030303035333736' TO DFHEIV0(25:11)
  5769     CALL 'kxdfhei1' USING DFHEIV0,
  5770           DFHEIV1,
  5771           CLAIM-MASTER,
  5772           DFHEIV11,
  5773           WS-ELMSTR-KEY,
  5774           DFHEIV99,
  5775           DFHEIV99,
  5776           DFHEIV99
  5777     MOVE EIBRESP  TO WS-RESPONSE
  5778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5779        IF RESP-NORMAL
  5780           MOVE CL-INCURRED-DT   TO WS-INC-DT (S1)
  5781           MOVE CL-PAID-THRU-DT  TO WS-PD-THRU-DT (S1)
  5782           MOVE CL-CLAIM-STATUS  TO WS-STATUS (S1)
  5783           IF CL-CRITICAL-PERIOD NOT NUMERIC
  5784              MOVE ZEROS TO CL-CRITICAL-PERIOD
  5785           END-IF
  5786           MOVE CL-CRITICAL-PERIOD
  5787                                 TO WS-MAX-BENS (S1)
  5788           IF CL-CRITICAL-PERIOD = ZEROS
  5789              IF CL-CLAIM-TYPE = 'L' OR 'P' OR 'O'
  5790                 MOVE 01         TO WS-MAX-BENS (S1)
  5791              ELSE
  5792                 MOVE CM-AH-ORIG-TERM
  5793                                 TO WS-MAX-BENS (S1)
  5794              END-IF
  5795           END-IF
  5796           IF CL-DENIAL-TYPE = '1' OR '2' OR '3' OR '4'
  5797              MOVE 'D'           TO WS-STATUS (S1)
  5798           END-IF
  5799           IF CS-CLAIM-NO (S1) = BL-CLAIM-NO
  5800              MOVE CL-ACCIDENT-CLAIM-SW TO OUT-ACC-SW
  5801           END-IF
  5802
  5803           MOVE ' '                    TO WS-PDEF-RECORD-SW
  5804           IF (AM-DCC-PRODUCT-CODE NOT = SPACES)
  5805              PERFORM 1850-GET-DDF-LIMITS
  5806                                 THRU 1850-EXIT
  5807           END-IF
  5808           IF PDEF-FOUND
  5809              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  5810                 (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
  5811                 OR (P1 > +8)
  5812              END-PERFORM
  5813              IF P1 < +9
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page 102
* NSRLTRBL.cbl
  5814                 IF CL-CLAIM-TYPE = 'L' OR 'P' OR 'O'
  5815                    IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5816                       AND (PD-MAX-AMT (P1) < CM-LF-BENEFIT-AMT)
  5817                       MOVE PD-MAX-AMT (P1)
  5818                                 TO WS-MAX-MOBEN (S1)
  5819                    ELSE
  5820                       MOVE CM-LF-BENEFIT-AMT
  5821                                 TO WS-MAX-MOBEN (S1)
  5822                    END-IF
  5823                 ELSE
  5824                    IF PD-BEN-PCT (P1) NOT NUMERIC
  5825                       MOVE ZEROS   TO PD-BEN-PCT (P1)
  5826                    END-IF
  5827                    IF PD-BEN-PCT (P1) = ZEROS
  5828                       MOVE +1      TO WS-WORK-BEN-PCT
  5829                    ELSE
  5830                       MOVE PD-BEN-PCT (P1)
  5831                                    TO WS-WORK-BEN-PCT
  5832                    END-IF
  5833                    COMPUTE WS-MAX-MOBEN (S1) =
  5834                       CM-AH-BENEFIT-AMT * WS-WORK-BEN-PCT
  5835                    IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5836                       AND (PD-MAX-AMT (P1) < WS-MAX-MOBEN (S1))
  5837                       MOVE PD-MAX-AMT (P1)
  5838                                 TO WS-MAX-MOBEN (S1)
  5839                    END-IF
  5840                 END-IF
  5841*                IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5842*                   AND (PD-MAX-AMT (P1) < CM-AH-BENEFIT-AMT)
  5843*                   MOVE PD-MAX-AMT (P1) TO WS-MAX-MOBEN (S1)
  5844*                ELSE
  5845*                   MOVE CM-AH-BENEFIT-AMT TO WS-MAX-MOBEN (S1)
  5846*                END-IF
  5847                 MOVE PD-EXCLUSION-PERIOD-DAYS (P1)
  5848                                 TO WS-EXCL-PER (S1)
  5849                 MOVE PD-COVERAGE-ENDS-MOS (P1)
  5850                                 TO WS-COV-ENDS (S1)
  5851                 MOVE PD-ACCIDENT-ONLY-MOS (P1)
  5852                                 TO WS-ACC-PER (S1)
  5853                 MOVE PD-MAX-EXTENSION (P1)
  5854                                 TO WS-MAX-EXTEN (S1)
  5855                 EVALUATE TRUE
  5856                    WHEN PD-RECURRING-YN (P1) = 'N'
  5857                       MOVE 00   TO WS-REC-MOS (S1)
  5858                    WHEN PD-RECURRING-YN (P1) = 'Y'
  5859                       MOVE 99   TO WS-REC-MOS (S1)
  5860                    WHEN PD-REC-CRIT-PERIOD (P1) NUMERIC
  5861                       MOVE PD-REC-CRIT-PERIOD (P1)
  5862                                 TO WS-REC-MOS (S1)
  5863                    WHEN OTHER
  5864                       MOVE ZEROS TO WS-REC-MOS (S1)
  5865                 END-EVALUATE
  5866                 IF WS-REC-MOS (S1) = ZEROS
  5867                    MOVE 01      TO WS-REC-MOS (S1)
  5868                 END-IF
  5869                 DISPLAY ' NSRLTRBL- PDEF FOUND ' WS-EXCL-PER (S1)
  5870              END-IF
  5871           ELSE
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page 103
* NSRLTRBL.cbl
  5872              IF CL-CLAIM-TYPE NOT = 'L' AND 'P' AND 'O'
  5873                 MOVE CM-AH-BENEFIT-AMT
  5874                                 TO WS-MAX-MOBEN (S1)
  5875              ELSE
  5876                 MOVE ZEROS      TO WS-MAX-MOBEN (S1)
  5877              END-IF
  5878              MOVE ZEROS         TO WS-EXCL-PER (S1)
  5879                                    WS-MAX-EXTEN (S1)
  5880                                    WS-ACC-PER  (S1)
  5881              MOVE 999           TO WS-COV-ENDS (S1)
  5882              MOVE 01            TO WS-REC-MOS  (S1)
  5883           END-IF
  5884        END-IF
  5885     END-PERFORM
  5886
  5887*      SORT THE TABLE
  5888     MOVE HIGH-VALUES            TO WS-KEY (S1)
  5889     COMPUTE WS-MAX-SUB = S1 - +1
  5890     DISPLAY ' NSRLTRBL- JUST BUILT TABLE '   WS-MAX-SUB
  5891
  5892     MOVE WS-MAX-SUB             TO WS-CNTR
  5893
  5894     MOVE +1                     TO S2
  5895     MOVE +0                     TO S3
  5896     PERFORM UNTIL (WS-CNTR = ZERO) OR (S3 > 700)
  5897        MOVE +0 TO WS-HOLD-S1
  5898        MOVE HIGH-VALUES TO WS-HOLD-KEY
  5899        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5900           (S1 > WS-MAX-SUB)
  5901           IF (WS-SORTED-SW (S1) NOT = 'Y')
  5902              AND (WS-KEY (S1) <= WS-HOLD-KEY)
  5903              MOVE WS-KEY (S1)   TO WS-HOLD-KEY
  5904              MOVE S1            TO WS-HOLD-S1
  5905           END-IF
  5906        END-PERFORM
  5907        IF WS-HOLD-S1 NOT = ZEROS
  5908           MOVE WS-HOLD-S1         TO S1
  5909           MOVE WS-KEY        (S1) TO WS-SRTD-KEY        (S2)
  5910           MOVE WS-STATUS     (S1) TO WS-SRTD-STATUS     (S2)
  5911           MOVE WS-MAX-BENS   (S1) TO WS-SRTD-MAX-BENS   (S2)
  5912           MOVE WS-EXCL-PER   (S1) TO WS-SRTD-EXCL-PER   (S2)
  5913           MOVE WS-COV-ENDS   (S1) TO WS-SRTD-COV-ENDS   (S2)
  5914           MOVE WS-ACC-PER    (S1) TO WS-SRTD-ACC-PER    (S2)
  5915           MOVE WS-REC-MOS    (S1) TO WS-SRTD-REC-MOS    (S2)
  5916           MOVE WS-MAX-EXTEN  (S1) TO WS-SRTD-MAX-EXTEN  (S2)
  5917           MOVE WS-PD-THRU-DT (S1) TO WS-SRTD-PD-THRU-DT (S2)
  5918           MOVE WS-CLAIM-NO   (S1) TO WS-SRTD-CLAIM-NO   (S2)
  5919           MOVE WS-MAX-MOBEN  (S1) TO WS-SRTD-MAX-MOBEN  (S2)
  5920           MOVE WS-TOTAL-PAID (S1) TO WS-SRTD-TOTAL-PAID (S2)
  5921*          MOVE WS-REM-BENS   (S1) TO WS-SRTD-REM-BENS   (S2)
  5922           MOVE 'Y'                TO WS-SORTED-SW       (S1)
  5923           SUBTRACT 1 FROM WS-CNTR
  5924           ADD +1 TO S2
  5925        END-IF
  5926        ADD 1 TO S3
  5927     END-PERFORM
  5928
  5929     DISPLAY ' NSRLTRBL- JUST SORTED TABLE '
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page 104
* NSRLTRBL.cbl
  5930
  5931***  -----------------------
  5932     IF BL-COMP-ID NOT = 'DCC' AND 'VPP'
  5933        PERFORM 1900-BUILD-NON-DCC
  5934        GO TO 1800-EXIT
  5935     END-IF
  5936
  5937     MOVE SPACES                 TO WS-PREV-CLM-TYPE
  5938                                    WS-PREV-INS-TYPE
  5939     MOVE ZEROS                  TO WS-PREV-BEN-PER
  5940                                    WS-ACCUM-DAYS
  5941                                    WS-ACCUM-AMT
  5942                                    WS-ACCUM-PD-BENS
  5943
  5944     MOVE +1                     TO M1
  5945     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5946        S1 > WS-MAX-SUB
  5947        IF (WS-SRTD-CLM-TYPE (S1) = WS-PREV-CLM-TYPE)
  5948           AND (WS-SRTD-BEN-PER (S1) = WS-PREV-BEN-PER)
  5949           AND (WS-SRTD-INS-TYPE (S1) NOT = WS-PREV-INS-TYPE)
  5950           MOVE ZEROS            TO WS-ACCUM-DAYS
  5951                                    WS-ACCUM-AMT
  5952                                    WS-ACCUM-PD-BENS
  5953        END-IF
  5954        MOVE WS-SRTD-INS-TYPE (S1) TO WS-PREV-INS-TYPE
  5955        IF (WS-SRTD-CLM-TYPE (S1) = WS-PREV-CLM-TYPE)
  5956           AND (WS-SRTD-BEN-PER (S1) NOT = WS-PREV-BEN-PER)
  5957           MOVE ZEROS            TO WS-ACCUM-DAYS
  5958                                    WS-ACCUM-AMT
  5959                                    WS-ACCUM-PD-BENS
  5960        END-IF
  5961        MOVE WS-SRTD-BEN-PER (S1) TO WS-PREV-BEN-PER
  5962        IF WS-SRTD-CLM-TYPE (S1) NOT = WS-PREV-CLM-TYPE
  5963           PERFORM 1810-SET-NEW-HEAD
  5964                                 THRU 1810-EXIT
  5965           MOVE WS-SRTD-CLM-TYPE (S1)
  5966                                 TO WS-PREV-CLM-TYPE
  5967           ADD +1                TO M1
  5968        END-IF
  5969
  5970        MOVE WS-SRTD-BEN-PER (S1)  TO OUT-BEN-PER
  5971        IF WS-SRTD-INS-TYPE (S1) = '1'
  5972           MOVE 'PRIM'             TO OUT-INS-TYP
  5973        ELSE
  5974           MOVE 'COBO'             TO OUT-INS-TYP
  5975        END-IF
  5976*       EVALUATE WS-SRTD-STATUS (S1)
  5977*          WHEN 'C'
  5978*             MOVE 'CLOSED'        TO WSM-STATUS (M1)
  5979*          WHEN 'D'
  5980*             MOVE 'DENIED'        TO WSM-STATUS (M1)
  5981*          WHEN 'O'
  5982*             MOVE 'OPEN'          TO WSM-STATUS (M1)
  5983*          WHEN OTHER
  5984*             MOVE 'OTHER'         TO WSM-STATUS (M1)
  5985*       END-EVALUATE
  5986*       MOVE WS-SRTD-CLAIM-NO (S1) TO WSM-CLAIM-NO (M1)
  5987*                                     PI-WSM-CLAIM-NOS (S1)
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page 105
* NSRLTRBL.cbl
  5988*       MOVE WS-SRTD-TOTAL-PAID (S1) TO WSM-TOTAL-PAID (M1)
  5989
  5990        COMPUTE OUT-MAX-BENS =
  5991           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  5992
  5993        DISPLAY ' NSRLTRBL- MAX BENS 1 ' OUT-MAX-BENS ' '
  5994           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  5995
  5996        MOVE ZEROS TO WK1 WK2
  5997        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  5998           COMPUTE WS-PD-BENS ROUNDED =
  5999              WS-SRTD-TOTAL-PAID (S1) / WS-SRTD-MAX-MOBEN (S1)
  6000           IF WS-SRTD-CLM-TYPE (S1) NOT = 'L' AND 'P'
  6001              DIVIDE WS-SRTD-TOTAL-PAID (S1) BY
  6002                 WS-SRTD-MAX-MOBEN(S1) GIVING WK1
  6003                 REMAINDER WK2
  6004           END-IF
  6005        ELSE
  6006           MOVE ZEROS            TO WS-PD-BENS
  6007        END-IF
  6008        IF (WS-PD-BENS = ZEROS)
  6009           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6010           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6011           MOVE 1                TO WS-PD-BENS
  6012        END-IF
  6013        MOVE WS-PD-BENS          TO OUT-PAID-BENS
  6014*       if wk2 not = zeros
  6015*          move '*'              to wsm-part (m1)
  6016*       end-if
  6017*       compute ws-accum-days =
  6018*          ws-accum-days + ws-srtd-days-paid (s1)
  6019        COMPUTE WS-ACCUM-AMT =
  6020           WS-ACCUM-AMT + WS-SRTD-TOTAL-PAID (S1)
  6021        DISPLAY ' NSRLTRBL- COMPUTE A PD BENS ' M1 ' '
  6022           WS-ACCUM-AMT ' ' WS-SRTD-MAX-MOBEN (S1)
  6023        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6024           COMPUTE WS-ACCUM-PD-BENS ROUNDED =
  6025              WS-ACCUM-AMT / WS-SRTD-MAX-MOBEN (S1)
  6026        ELSE
  6027           MOVE ZEROS            TO WS-ACCUM-PD-BENS
  6028        END-IF
  6029        IF (WS-ACCUM-PD-BENS = ZEROS)
  6030           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6031           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6032           MOVE 1                TO WS-ACCUM-PD-BENS
  6033        END-IF
  6034        DISPLAY ' NSRLTRBL- COMPUTE REM BENS ' M1 ' '
  6035           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6036        COMPUTE OUT-REM-BENS =
  6037           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6038        PERFORM 1820-FIND-QUALIFY THRU 1820-EXIT
  6039
  6040*       MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-1
  6041*       MOVE ' '                    TO DC-OPTION-CODE
  6042*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6043*       IF NO-CONVERSION-ERROR
  6044*          MOVE DC-GREG-DATE-A-EDIT TO wsm-inc-date (m1)
  6045*       ELSE
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page 106
* NSRLTRBL.cbl
  6046*          MOVE SPACES              TO wsm-inc-date (m1)
  6047*       END-IF
  6048*       MOVE ws-srtd-pd-thru-dt (s1) TO DC-BIN-DATE-1
  6049*       MOVE ' '                     TO DC-OPTION-CODE
  6050*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6051*       IF NO-CONVERSION-ERROR
  6052*          MOVE DC-GREG-DATE-A-EDIT TO wsm-pd-thru-dt (m1)
  6053*       ELSE
  6054*          MOVE SPACES              TO wsm-pd-thru-dt (m1)
  6055*       END-IF
  6056        ADD +1                   TO M1
  6057        IF WS-SRTD-CLAIM-NO (S1) = BL-CLAIM-NO
  6058           MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6059           MOVE 26 TO S1
  6060        END-IF
  6061
  6062     END-PERFORM
  6063
  6064    DISPLAY ' NSRLTRBL- 1800 end MAX BENS '  OUT-MAX-BENS
  6065    display  ' PAID BENS ' OUT-PAID-BENS ' REM BENS ' OUT-REM-BENS
  6066    display  ' EXCL PER ' OUT-EXCL-PER ' REC MOS ' OUT-REC-MOS
  6067    display  ' INS TYP ' OUT-INS-TYP ' BEN PER ' OUT-BEN-PER
  6068    display  ' ACC SW ' OUT-ACC-SW
  6069
  6070     .
  6071 1800-EXIT.
  6072     EXIT.
  6073
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page 107
* NSRLTRBL.cbl
  6075
  6076 1810-SET-NEW-HEAD.
  6077     MOVE ZEROS                  TO WS-ACCUM-DAYS
  6078                                    WS-ACCUM-AMT
  6079                                    WS-ACCUM-PD-BENS
  6080     EVALUATE WS-SRTD-CLM-TYPE (S1)
  6081        WHEN 'A'
  6082           MOVE 'A&H'            TO WS-COV-TYPE
  6083        WHEN 'F'
  6084           MOVE 'FAM '           TO WS-COV-TYPE
  6085        WHEN 'I'
  6086           MOVE ' IU '           TO WS-COV-TYPE
  6087        WHEN 'L'
  6088           MOVE 'LIFE'           TO WS-COV-TYPE
  6089        WHEN OTHER
  6090           MOVE WS-SRTD-CLM-TYPE (S1)
  6091                                 TO WS-COV-TYPE
  6092     END-EVALUATE
  6093
  6094     MOVE WS-SRTD-REC-MOS (S1) TO OUT-REC-MOS
  6095     MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6096
  6097*    string '  ' ws-cov-type ' ExPer ' OUT-EXCL-PER
  6098*       ' CovEnd ' ws-srtd-cov-ends (s1)
  6099*       ' MaxBens ' ws-srtd-max-bens (s1)
  6100*       ' Recurring ' OUT-REC-MOS
  6101*       delimited by size into ws-map-output (m1)
  6102*    end-string
  6103
  6104     .
  6105 1810-EXIT.
  6106     EXIT.
  6107
  6108 1820-FIND-QUALIFY.
  6109     IF NOT PDEF-FOUND
  6110        GO TO 1820-EXIT
  6111     END-IF
  6112
  6113     DISPLAY ' NSRLTRBL- MAX BENS 2 ' OUT-MAX-BENS ' '
  6114        WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6115
  6116     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  6117     MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-2
  6118     MOVE '1'                    TO DC-OPTION-CODE
  6119     MOVE +0                     TO DC-ELAPSED-MONTHS
  6120                                    DC-ELAPSED-DAYS
  6121     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6122
  6123     IF NO-CONVERSION-ERROR
  6124        DISPLAY ' NSRLTRBL- GOOD DATE CONVERT '
  6125        MOVE DC-ELAPSED-MONTHS   TO WS-MONTHS-BETWEEN
  6126        IF DC-ELAPSED-DAYS > 1
  6127           ADD 1 TO WS-MONTHS-BETWEEN
  6128        END-IF
  6129     ELSE
  6130        MOVE ZEROS               TO WS-MONTHS-BETWEEN
  6131     END-IF
  6132
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page 108
* NSRLTRBL.cbl
  6133     DISPLAY ' NSRLTRBL- DISPLAY 3 ' OUT-EXCL-PER
  6134        ' ' WS-SRTD-COV-ENDS (S1) ' ' WS-MONTHS-BETWEEN
  6135
  6136     EVALUATE TRUE
  6137        WHEN (OUT-EXCL-PER NOT = ZEROS)
  6138           AND (WS-MONTHS-BETWEEN <= OUT-EXCL-PER)
  6139           DISPLAY ' NSRLTRBL- ZERO 1 '
  6140           MOVE ZEROS TO OUT-MAX-BENS
  6141                         OUT-REM-BENS
  6142        WHEN (WS-SRTD-COV-ENDS (S1) NOT = ZEROS)
  6143           AND (WS-MONTHS-BETWEEN > WS-SRTD-COV-ENDS (S1))
  6144           DISPLAY ' NSRLTRBL- ZERO 2 '
  6145           MOVE ZEROS TO OUT-MAX-BENS
  6146     END-EVALUATE
  6147     IF OUT-REC-MOS < WS-SRTD-BEN-PER (S1)
  6148        MOVE ZEROS               TO OUT-REM-BENS
  6149     END-IF
  6150
  6151     .
  6152 1820-EXIT.
  6153     EXIT.
  6154
  6155 1850-GET-DDF-LIMITS.
  6156
  6157     IF CM-CLP-STATE = SPACES OR LOW-VALUES OR ZEROS
  6158        MOVE CM-STATE            TO CM-CLP-STATE
  6159     END-IF
  6160
  6161     MOVE CL-COMPANY-CD          TO ERPDEF-KEY
  6162     MOVE CM-CLP-STATE           TO ERPDEF-STATE
  6163     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6164
  6165     IF (CL-CLAIM-TYPE = 'L' OR 'P' OR 'O')
  6166        AND (CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD')
  6167        MOVE 'L'                 TO ERPDEF-BEN-TYPE
  6168        MOVE CM-LF-BENEFIT-CD    TO ERPDEF-BEN-CODE
  6169     ELSE
  6170        MOVE 'A'                 TO ERPDEF-BEN-TYPE
  6171        MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  6172     END-IF
  6173
  6174     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6175
  6176     DISPLAY ' NSRLTRBL- MADE 1850 ' ERPDEF-KEY (2:15)
  6177     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  6178
  6179
  6180* EXEC CICS STARTBR
  6181*        DATASET  ('ERPDEF')
  6182*        RIDFLD   (ERPDEF-KEY)
  6183*        GTEQ
  6184*        RESP     (WS-RESPONSE)
  6185*    END-EXEC
  6186     MOVE 'ERPDEF' TO DFHEIV1
  6187     MOVE 0
  6188       TO DFHEIV11
  6189*    MOVE '&,         G          &  N#00005782' TO DFHEIV0
  6190     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page 109
* NSRLTRBL.cbl
  6191     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6192     MOVE X'204E233030303035373832' TO DFHEIV0(25:11)
  6193     CALL 'kxdfhei1' USING DFHEIV0,
  6194           DFHEIV1,
  6195           ERPDEF-KEY,
  6196           DFHEIV99,
  6197           DFHEIV11,
  6198           DFHEIV99
  6199     MOVE EIBRESP  TO WS-RESPONSE
  6200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6201
  6202     IF NOT RESP-NORMAL
  6203        GO TO 1850-EXIT
  6204     END-IF
  6205
  6206     .
  6207 1850-READNEXT.
  6208
  6209
  6210* EXEC CICS READNEXT
  6211*       DATASET  ('ERPDEF')
  6212*       INTO     (PRODUCT-MASTER)
  6213*       RIDFLD   (ERPDEF-KEY)
  6214*       RESP     (WS-RESPONSE)
  6215*    END-EXEC
  6216     MOVE LENGTH OF
  6217      PRODUCT-MASTER
  6218       TO DFHEIV12
  6219     MOVE 'ERPDEF' TO DFHEIV1
  6220     MOVE 0
  6221       TO DFHEIV11
  6222*    MOVE '&.IL                  )  N#00005796' TO DFHEIV0
  6223     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6224     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6225     MOVE X'204E233030303035373936' TO DFHEIV0(25:11)
  6226     CALL 'kxdfhei1' USING DFHEIV0,
  6227           DFHEIV1,
  6228           PRODUCT-MASTER,
  6229           DFHEIV12,
  6230           ERPDEF-KEY,
  6231           DFHEIV99,
  6232           DFHEIV11,
  6233           DFHEIV99,
  6234           DFHEIV99
  6235     MOVE EIBRESP  TO WS-RESPONSE
  6236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6237
  6238     IF NOT RESP-NORMAL
  6239        GO TO 1850-ENDBR
  6240     END-IF
  6241
  6242     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  6243        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  6244           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  6245           DISPLAY ' NSRLTRBL- SETTING PDEF FOUND TO TRUE '
  6246        ELSE
  6247           GO TO 1850-READNEXT
  6248        END-IF
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page 110
* NSRLTRBL.cbl
  6249     ELSE
  6250        GO TO 1850-ENDBR
  6251     END-IF
  6252
  6253     .
  6254 1850-ENDBR.
  6255
  6256
  6257* EXEC CICS ENDBR
  6258*       DATASET  ('ERPDEF')
  6259*    END-EXEC
  6260     MOVE 'ERPDEF' TO DFHEIV1
  6261     MOVE 0
  6262       TO DFHEIV11
  6263*    MOVE '&2                    $   #00005821' TO DFHEIV0
  6264     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6265     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6266     MOVE X'2020233030303035383231' TO DFHEIV0(25:11)
  6267     CALL 'kxdfhei1' USING DFHEIV0,
  6268           DFHEIV1,
  6269           DFHEIV11,
  6270           DFHEIV99
  6271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6272
  6273     .
  6274 1850-EXIT.
  6275     EXIT.
  6276
  6277 1900-BUILD-NON-DCC.
  6278
  6279     MOVE SPACES                 TO WS-PREV-CLM-TYPE
  6280                                    WS-PREV-INS-TYPE
  6281     MOVE ZEROS                  TO WS-PREV-BEN-PER
  6282                                    WS-ACCUM-DAYS
  6283                                    WS-ACCUM-AMT
  6284                                    WS-ACCUM-PD-BENS
  6285
  6286     MOVE +1                     TO M1
  6287     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6288        S1 > WS-MAX-SUB
  6289        IF WS-SRTD-CLM-TYPE (S1) NOT = WS-PREV-CLM-TYPE
  6290           PERFORM 1810-SET-NEW-HEAD
  6291                                 THRU 1810-EXIT
  6292           MOVE WS-SRTD-CLM-TYPE (S1)
  6293                                 TO WS-PREV-CLM-TYPE
  6294           ADD +1                TO M1
  6295        END-IF
  6296        MOVE WS-SRTD-BEN-PER (S1)  TO OUT-BEN-PER
  6297        IF WS-SRTD-INS-TYPE (S1) = '1'
  6298           MOVE 'PRIM'             TO OUT-INS-TYP
  6299        ELSE
  6300           MOVE 'COBO'             TO OUT-INS-TYP
  6301        END-IF
  6302*       evaluate ws-srtd-status (s1)
  6303*          when 'C'
  6304*             MOVE 'CLOSED'        TO WSM-STATUS (M1)
  6305*          WHEN 'D'
  6306*             MOVE 'DENIED'        TO WSM-STATUS (M1)
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page 111
* NSRLTRBL.cbl
  6307*          WHEN 'O'
  6308*             MOVE 'OPEN'          TO WSM-STATUS (M1)
  6309*          WHEN OTHER
  6310*             MOVE 'OTHER'         TO WSM-STATUS (M1)
  6311*       END-EVALUATE
  6312*       move ws-srtd-claim-no (s1) to wsm-claim-no (m1)
  6313*                                     pi-wsm-claim-nos (s1)
  6314*       move ws-srtd-total-paid (s1) to wsm-total-paid (m1)
  6315
  6316        COMPUTE OUT-MAX-BENS =
  6317           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6318
  6319        DISPLAY ' NSRLTRBL- MAX BENS 1 ' OUT-MAX-BENS ' '
  6320           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6321
  6322        MOVE ZEROS TO WK1 WK2
  6323        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6324           COMPUTE WS-PD-BENS ROUNDED =
  6325              WS-SRTD-TOTAL-PAID (S1) / WS-SRTD-MAX-MOBEN (S1)
  6326           IF WS-SRTD-CLM-TYPE (S1) NOT = 'L' AND 'P'
  6327              DIVIDE WS-SRTD-TOTAL-PAID (S1) BY
  6328                 WS-SRTD-MAX-MOBEN(S1) GIVING WK1
  6329                 REMAINDER WK2
  6330           END-IF
  6331        ELSE
  6332           MOVE ZEROS            TO WS-PD-BENS
  6333        END-IF
  6334        IF (WS-PD-BENS = ZEROS)
  6335           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6336           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6337           MOVE 1                TO WS-PD-BENS
  6338        END-IF
  6339        MOVE WS-PD-BENS          TO OUT-PAID-BENS
  6340*       IF WK2 NOT = ZEROS
  6341*          MOVE '*'              TO WSM-PART (M1)
  6342*       END-IF
  6343        COMPUTE WS-ACCUM-AMT =
  6344           WS-ACCUM-AMT + WS-SRTD-TOTAL-PAID (S1)
  6345        DISPLAY ' NSRLTRBL- COMPUTE A PD BENS ' M1 ' '
  6346           WS-ACCUM-AMT ' ' WS-SRTD-MAX-MOBEN (S1)
  6347        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6348           COMPUTE WS-ACCUM-PD-BENS ROUNDED =
  6349              WS-ACCUM-AMT / WS-SRTD-MAX-MOBEN (S1)
  6350        ELSE
  6351           MOVE ZEROS            TO WS-ACCUM-PD-BENS
  6352        END-IF
  6353        IF (WS-ACCUM-PD-BENS = ZEROS)
  6354           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6355           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6356           MOVE 1                TO WS-ACCUM-PD-BENS
  6357        END-IF
  6358        DISPLAY ' NSRLTRBL- COMPUTE REM BENS ' M1 ' '
  6359           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6360        COMPUTE OUT-REM-BENS =
  6361           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6362
  6363*       MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-1
  6364*       MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page 112
* NSRLTRBL.cbl
  6365*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6366*       IF NO-CONVERSION-ERROR
  6367*          MOVE DC-GREG-DATE-A-EDIT TO wsm-inc-date (m1)
  6368*       ELSE
  6369*          MOVE SPACES              TO wsm-inc-date (m1)
  6370*       END-IF
  6371*       MOVE ws-srtd-pd-thru-dt (s1) TO DC-BIN-DATE-1
  6372*       MOVE ' '                     TO DC-OPTION-CODE
  6373*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6374*       IF NO-CONVERSION-ERROR
  6375*          MOVE DC-GREG-DATE-A-EDIT TO wsm-pd-thru-dt (m1)
  6376*       ELSE
  6377*          MOVE SPACES              TO wsm-pd-thru-dt (m1)
  6378*       END-IF
  6379*       move WS-MAP-OUTPUT (m1)  to replineo (m1)
  6380        IF WS-SRTD-CLAIM-NO (S1) = BL-CLAIM-NO
  6381           MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6382           MOVE 26 TO S1
  6383        END-IF
  6384
  6385        ADD +1                   TO M1
  6386     END-PERFORM
  6387     DISPLAY ' NSRLTRBL- 1900 end MAX BENS '  OUT-MAX-BENS
  6388     display ' PAID BENS ' OUT-PAID-BENS ' REM BENS ' OUT-REM-BENS
  6389     display ' EXCL PER ' OUT-EXCL-PER ' REC MOS ' OUT-REC-MOS
  6390     display ' INS TYP ' OUT-INS-TYP ' BEN PER ' OUT-BEN-PER
  6391     display ' ACC SW ' OUT-ACC-SW
  6392     .
  6393 2000-BUILD-ELNAPS.
  6394     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6395     MOVE 'NA'                   TO NAPERSOFT-FILE
  6396     MOVE CL-COMPANY-CD          TO NA-COMPANY-CD
  6397     MOVE BL-CARRIER             TO NA-CARRIER
  6398     MOVE BL-CLAIM-NO            TO NA-CLAIM-NO
  6399     MOVE BL-CERT-NO             TO NA-CERT-NO
  6400     MOVE WS-ARCHIVE-NO          TO NA-ARCHIVE-NO
  6401                                    BL-ARCHIVE-NO
  6402     MOVE BL-LETTER-ID           TO NA-LETTER-ID
  6403     MOVE BL-NO-OF-COPIES        TO NA-NO-OF-COPIES
  6404     MOVE SAVE-BIN-DATE          TO NA-CREATION-DT
  6405                                    NA-INITIAL-PRINT-DT
  6406     MOVE LOW-VALUES             TO NA-FOLLOW-UP-DT
  6407                                    NA-RESEND-DT
  6408                                    NA-RESEND-PRINT-DT
  6409                                    NA-1ST-LTR-PRINT-DT
  6410                                    NA-NEXT-DUE-DT
  6411                                    NA-AUTOPYDT
  6412     MOVE CL-TRAILER-SEQ-CNT     TO NA-CORR-TRLR-SEQ
  6413     IF BL-FOLLOW-UP-DT NOT = SPACES AND LOW-VALUES
  6414        STRING BL-FOLLOW-UP-DT (7:2) BL-FOLLOW-UP-DT (1:2)
  6415           BL-FOLLOW-UP-DT (4:2) DELIMITED BY SIZE
  6416             INTO DC-GREG-DATE-1-YMD-R
  6417        END-STRING
  6418        MOVE '3'                 TO DC-OPTION-CODE
  6419        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6420        IF NO-CONVERSION-ERROR
  6421           MOVE DC-BIN-DATE-1    TO NA-FOLLOW-UP-DT
  6422                                    WS-FOLLOW-UP-DT
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page 113
* NSRLTRBL.cbl
  6423        ELSE
  6424           MOVE LOW-VALUES       TO NA-FOLLOW-UP-DT
  6425                                    WS-FOLLOW-UP-DT
  6426        END-IF
  6427     END-IF
  6428     IF BL-RESEND-DT NOT = SPACES AND LOW-VALUES
  6429        STRING BL-RESEND-DT (7:2) BL-RESEND-DT (1:2)
  6430           BL-RESEND-DT (4:2) DELIMITED BY SIZE
  6431             INTO DC-GREG-DATE-1-YMD-R
  6432        END-STRING
  6433        MOVE '3'                 TO DC-OPTION-CODE
  6434        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6435        IF NO-CONVERSION-ERROR
  6436           MOVE DC-BIN-DATE-1    TO NA-RESEND-DT
  6437                                    WS-RESEND-DT
  6438        ELSE
  6439           MOVE LOW-VALUES       TO NA-RESEND-DT
  6440                                    WS-RESEND-DT
  6441        END-IF
  6442     END-IF
  6443     PERFORM WITH TEST AFTER UNTIL RESP-NORMAL
  6444
  6445* EXEC CICS WRITE
  6446*          DATASET   ('ELNAPS')
  6447*          FROM      (NAPERSOFT-FILE)
  6448*          RIDFLD    (NA-CONTROL-PRIMARY)
  6449*          RESP      (WS-RESPONSE)
  6450*       END-EXEC
  6451     MOVE LENGTH OF
  6452      NAPERSOFT-FILE
  6453       TO DFHEIV11
  6454     MOVE 'ELNAPS' TO DFHEIV1
  6455*    MOVE '&$ L                  ''  N#00005996' TO DFHEIV0
  6456     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6457     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6458     MOVE X'204E233030303035393936' TO DFHEIV0(25:11)
  6459     CALL 'kxdfhei1' USING DFHEIV0,
  6460           DFHEIV1,
  6461           NAPERSOFT-FILE,
  6462           DFHEIV11,
  6463           NA-CONTROL-PRIMARY,
  6464           DFHEIV99,
  6465           DFHEIV99
  6466     MOVE EIBRESP  TO WS-RESPONSE
  6467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6468        IF RESP-NORMAL
  6469           CONTINUE
  6470        ELSE
  6471           IF RESP-DUPREC OR RESP-DUPKEY
  6472              ADD +1 TO NA-ARCHIVE-NO
  6473           ELSE
  6474              DISPLAY ' BAD WRITE ELNAPS ' WS-RESPONSE
  6475                 ' ' NA-CONTROL-PRIMARY (2:19)
  6476              SET RESP-NORMAL TO TRUE
  6477           END-IF
  6478        END-IF
  6479     END-PERFORM
  6480    .
* Micro Focus Server Express         V5.1 revision 000 13-Mar-19 13:52 Page 114
* NSRLTRBL.cbl
  6481 2000-EXIT.
  6482     EXIT.
  6483 9700-DATE-LINK.
  6484
  6485* EXEC CICS LINK
  6486*        PROGRAM   ('ELDATCV')
  6487*        COMMAREA  (DATE-CONVERSION-DATA)
  6488*        LENGTH    (DC-COMM-LENGTH)
  6489*    END-EXEC.
  6490     MOVE 'ELDATCV' TO DFHEIV1
  6491*    MOVE '."C                   (   #00006018' TO DFHEIV0
  6492     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6493     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6494     MOVE X'2020233030303036303138' TO DFHEIV0(25:11)
  6495     CALL 'kxdfhei1' USING DFHEIV0,
  6496           DFHEIV1,
  6497           DATE-CONVERSION-DATA,
  6498           DC-COMM-LENGTH,
  6499           DFHEIV99,
  6500           DFHEIV99,
  6501           DFHEIV99,
  6502           DFHEIV99
  6503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6504
  6505 9700-EXIT.
  6506      EXIT.
  6507
  6508 9999-DFHBACK SECTION.
  6509     MOVE '9%                    "   ' TO DFHEIV0
  6510     MOVE 'NSRLTRBL' TO DFHEIV1
  6511     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6512     GOBACK.
  6513 9999-DFHEXIT.
  6514     IF DFHEIGDJ EQUAL 0001
  6515         NEXT SENTENCE.
  6516     MOVE '9%                    "   ' TO DFHEIV0
  6517     MOVE 'NSRLTRBL' TO DFHEIV1
  6518     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6519     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       19080     Code:       16868
