* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page   1
* NSRASBL.cbl
* Options: int("NSRASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASBL.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSRASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID.   NSRASBL.
     4*AUTHOR.     PABLO
     5*            COLLEYVILLE, TEXAS.
     6*REMARKS.    EXECUTED FROM NSRASLTR
     7******************************************************************
     8*                   C H A N G E   L O G
     9*
    10* ChangeS ARE MARKED BY THE Change EFFECTIVE DATE.
    11*-----------------------------------------------------------------
    12*  Change   Change REQUEST PGMR  DESCRIPTION OF Change
    13* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page   2
* NSRASBL.cbl
    14*-----------------------------------------------------------------
    15* 060611    2011022800001  PEMA  NEW PROGRAM
    16* 122911    2011022800001  AJRA  ADD VA DISCLOSURE TO CERT PRINT
    17* 071212    2011022800001  AJRA  ADD UNDW ID
    18* 072312    2011022800001  AJRA    ADD NEW FIELDS
    19* 090612  IR2012090600001  AJRA  NAPERSOFT
    20* 091112  IR2012091100002  AJRA  FIX AKA
    21* 091312  IR2012091100004  AJRA  FIX JOINT NAME
    22* 092412  IR2012092350004  AJRA  FIX CANCEL AMT
    23* 100112  IR2012100100002  AJRA  FIX ADDRESS WITH 2 SPACES
    24* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    25* 101412    2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    26* 101812    2012101700002  AJRA  READ ENDT BY ARCHIVE NO
    27* 110612    2012101700002  AJRA  ADD NEW FIELDS
    28* 121112    2012101700002  AJRA  HANDLE .01 PREM AND 9999999 BEN
    29* 121712    2012101700002  AJRA  ADD DEFAULT AGE FLAG
    30* 050213    2013050100001  AJRA  FIX AH REFUND ON DEATH CLAIM
    31* 091213    2013090300001  AJRA  NAPERSOFT PHASE 2
    32* 123113    2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    33* 011314  IR2014011300001  AJRA  FIX NEXT BUS DT AND ENDORSEMENT A
    34* 011514    2013090300001  AJRA  CALL SQL STORED PROC FOR NEXT BUS
    35* 021214  IR2014021200002  AJRA  ADD SQL DISCONNECT
    36******************************************************************
    37 ENVIRONMENT DIVISION.
    38 DATA DIVISION.
    39 working-storage section.
    40 01  DFH-START PIC X(04).
    41 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    42 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    43 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    44 77  SAVE-BIN-NEXT-BUS-DT        PIC XX      VALUE SPACES.
    45 77  SAVE-NEXT-BUS-DT-EDIT-A     PIC X(10)   VALUE SPACES.
    46 77  SAVE-CYCLE-DAY-OF-WEEK      PIC S9   COMP-3 VALUE +0.
    47 77  S1                          PIC S999 COMP-3 VALUE +0.
    48 77  E1                          PIC S999 COMP-3 VALUE +0.
    49 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    50 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    51 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    52 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    53 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    54 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    55 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    56 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    57 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    58 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    59 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    60 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    61     88  FOUND-BENE                  VALUE 'Y'.
    62 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    63 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    64 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    65 77  WS-ERPNDB-SW                PIC X  VALUE ' '.
    66     88  END-OF-ERPNDB              VALUE 'Y'.
    67 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    68     88  ACCT-FOUND                 VALUE 'Y'.
    69 77  WS-ELCERT-SW                PIC X  VALUE ' '.
    70     88  CERT-FOUND                 VALUE 'Y'.
    71     88  CERT-NOT-FOUND             VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page   3
* NSRASBL.cbl
    72 77  WS-ERENDT-SW                PIC X  VALUE ' '.
    73     88  ENDT-FOUND                 VALUE 'Y'.
    74     88  ENDT-NOT-FOUND             VALUE 'N'.
    75 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    76     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
    77 77  WS-LF-ABBRV                 PIC X(10) VALUE SPACES.
    78 77  WS-LF-DESC                  PIC X(02) VALUE SPACES.
    79 77  WS-LF-EARN                  PIC X     VALUE ' '.
    80 77  WS-WAIT-PER                 PIC X(03) VALUE ZEROS.
    81 77  WS-RET-ELIM                 PIC X(01) VALUE SPACES.
    82 77  WS-AH-DESC                  PIC X(35) VALUE SPACES.
    83 77  WS-BEN-DAYS                 PIC X(02) VALUE ZEROS.
    84 77  WS-CSR-ID                   PIC XXXX  VALUE SPACES.
    85 77  WS-LF-BENCD                 PIC XX    VALUE '00'.
    86 77  WS-AH-BENCD                 PIC XX    VALUE '00'.
    87 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    88 77  WS-COMPANY-CD               PIC X  VALUE LOW-VALUES.
    89 77  WS-WORK-PREM                PIC S9(9)V99 COMP-3 VALUE +0.
    90 77  WS-WORK-LF-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    91 77  WS-WORK-ALT-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    92 77  WS-WORK-CMB-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    93 77  WS-WORK-AH-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    94 77  WS-WORK-REF                 PIC S9(9)V99 COMP-3 VALUE +0.
    95 77  WS-WORK-LF-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    96 77  WS-WORK-AH-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    97 77  WS-ISSUE-CANCEL-SW          PIC X  VALUE SPACES.
    98     88  PROCESS-ISSUE               VALUE 'I'.
    99     88  PROCESS-CANCEL              VALUE 'C'.
   100 77  WS-SAVE-OUT-LETTER          PIC X(6)  VALUE SPACES.
   101 77  WS-WORK-COMM                PIC 9(7)V99 VALUE ZEROS.
   102 77  WS-DIFF                     PIC 999 VALUE ZEROS.
   103 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
   104 77  WS-CHGBK-LIFE-PCT           PIC S9V9(5) COMP-3 VALUE +0.
   105 77  WS-CHGBK-AH-PCT             PIC S9V9(5) COMP-3 VALUE +0.
   106 77  WS-CERT-EFF-DT              PIC XX  VALUE SPACES.
   107 77  LINK-ELVADS                 PIC X(8) VALUE 'ELVADS'.
*  108 EXEC SQL
*  109    INCLUDE SQLDA
*  110 END-EXEC
   111 01 SQLDA sync.
   112    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   113    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   114    05 SQLN                  PIC S9(4) COMP-5 value 0.
   115    05 SQLD                  PIC S9(4) COMP-5 value 0.
   116    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   117       10 SQLTYPE            PIC S9(4) COMP-5.
   118       10 SQLLEN             PIC S9(4) COMP-5.
   119$IF P64 SET
   120X      *> For 64-bit environments, ensure that SQLDATA is
   121X      *> aligned on an 8-byte boundary.
   122X      10 FILLER             PIC S9(9) COMP-5.
   123$END
   124       10 SQLDATA            USAGE POINTER.
   125       10 SQLIND             USAGE POINTER.
   126       10 SQLNAME.
   127          15 SQLNAMEL        PIC S9(4) COMP-5.
   128          15 SQLNAMEC        PIC X(30).
   129
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page   4
* NSRASBL.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130* Values for SQLTYPE
   131
   132 78  ESQL-DATE-CHAR              VALUE 384.
   133 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   134 78  ESQL-DATE-REC               VALUE 386.
   135 78  ESQL-DATE-REC-NULL          VALUE 387.
   136 78  ESQL-TIME-CHAR              VALUE 388.
   137 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   138 78  ESQL-TIME-REC               VALUE 390.
   139 78  ESQL-TIME-REC-NULL          VALUE 391.
   140 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   141 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   142 78  ESQL-TIMESTAMP-REC          VALUE 394.
   143 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   144 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   145 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   146 78  ESQL-TS-OFFSET-REC          VALUE 398.
   147 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   148 78  ESQL-LONGVARBINARY          VALUE 404.
   149 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   150 78  ESQL-LONGVARCHAR            VALUE 408.
   151 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   152 78  ESQL-BINARY                 VALUE 444.
   153 78  ESQL-BINARY-NULL            VALUE 445.
   154 78  ESQL-VARBINARY              VALUE 446.
   155 78  ESQL-VARBINARY-NULL         VALUE 447.
   156 78  ESQL-VARCHAR                VALUE 448.
   157 78  ESQL-VARCHAR-NULL           VALUE 449.
   158
   159 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   160 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   161
   162 78  ESQL-CHAR                   VALUE 452.
   163 78  ESQL-CHAR-NULL              VALUE 453.
   164
   165 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   166 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   167
   168 78  ESQL-DOUBLE                 VALUE 480.
   169 78  ESQL-DOUBLE-NULL            VALUE 481.
   170 78  ESQL-REAL                   VALUE 482.
   171 78  ESQL-REAL-NULL              VALUE 483.
   172 78  ESQL-DECIMAL                VALUE 484.
   173 78  ESQL-DECIMAL-NULL           VALUE 485.
   174 78  ESQL-INTEGER                VALUE 496.
   175 78  ESQL-INTEGER-NULL           VALUE 497.
   176 78  ESQL-SMALLINT               VALUE 500.
   177 78  ESQL-SMALLINT-NULL          VALUE 501.
   178 78  ESQL-TINYINT                VALUE 502.
   179 78  ESQL-TINYINT-NULL           VALUE 503.
   180
*  181 EXEC SQL
*  182    INCLUDE SQLCA
*  183 END-EXEC
   184 01 SQLCA.
   185     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   186     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   187     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page   5
* NSRASBL.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188     05  SQLERRM.
   189         49  SQLERRML    PIC S9(4) COMP-5.
   190         49  SQLERRMC    PIC X(70).
   191     05  SQLERRP         PIC X(8).
   192     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   193     05  SQLWARN.
   194         10  SQLWARN0    PIC X.
   195         10  SQLWARN1    PIC X.
   196         10  SQLWARN2    PIC X.
   197         10  SQLWARN3    PIC X.
   198         10  SQLWARN4    PIC X.
   199         10  SQLWARN5    PIC X.
   200         10  SQLWARN6    PIC X.
   201         10  SQLWARN7    PIC X.
   202     05  SQLEXT.
   203         10  SQLWARN8    PIC X.
   204         10  SQLWARN9    PIC X.
   205         10  SQLWARN10   PIC X.
   206         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   207     05  SQLSTATE    PIC X(5).
   208
   209 EXEC SQL
   210    BEGIN DECLARE SECTION
   211 END-EXEC
   212
   213 01  SQLCMD                      PIC X(1024).
   214 01  SVR                         PIC X(32).
   215 01  USR                         PIC X(32).
   216 01  PASS                        PIC X(32).
   217 01  USR-PASS                    PIC X(64).
   218
   219 01  WS-SQL-DATA.
   220     05  WS-CYCLE-DATE           PIC X(10).
   221     05  WS-NEXT-BUS-DT          PIC X(10).
   222
   223 EXEC SQL
   224    END DECLARE SECTION
   225 END-EXEC
   226
   227
   228 01  P pointer.
   229 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   230 01  KIXHOST             pic x(9) value Z"HOSTNAME".
   231 01  var-ptr pointer.
   232 01  env-var-len                 pic 9(4)  binary.
   233 01  rc                          pic 9(9)  binary.
   234
   235 01  WS-KIXHOST                  PIC X(10).
   236 01  WS-KIXSYS.
   237     05  WS-KIX-FIL1             PIC X(10).
   238     05  WS-KIX-APPS             PIC X(10).
   239     05  WS-KIX-ENV              PIC X(10).
   240     05  WS-KIX-MYENV            PIC X(10).
   241     05  WS-KIX-SYS              PIC X(10).
   242
   243 01  WS-CALC-FIELDS.
   244     12  WS-WRK-AMOUNT           PIC S9(7)V99 COMP-3 VALUE +0.
   245     12  WS-WRK-AMOUNT2          PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page   6
* NSRASBL.cbl
   246     12  WS-CSO-LF-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   247     12  WS-CSO-ALT-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   248     12  WS-CSO-CMB-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   249     12  WS-CSO-AH-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   250     12  WS-CSO-PORTION          PIC S9(7)V99 COMP-3 VALUE +0.
   251     12  WS-ACCT-LF-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   252     12  WS-ACCT-ALT-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   253     12  WS-ACCT-CMB-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   254     12  WS-ACCT-AH-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   255     12  WS-ACCT-PORTION         PIC S9(7)V99 COMP-3 VALUE +0.
   256     12  WS-CSO-ORIG-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   257     12  WS-CSO-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   258     12  WS-CSO-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   259     12  WS-CSO-ORIG-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   260     12  WS-CSO-ORIG-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   261     12  WS-ACCT-ORIG-LF-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   262     12  WS-ACCT-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   263     12  WS-ACCT-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   264     12  WS-ACCT-ORIG-AH-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   265     12  WS-ACCT-ORIG-PORTION    PIC S9(7)V99 COMP-3 VALUE +0.
   266     12  WS-CSO-NEW-LF-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   267     12  WS-CSO-NEW-ALT-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   268     12  WS-CSO-NEW-CMB-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   269     12  WS-CSO-NEW-AH-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   270     12  WS-CSO-NEW-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   271     12  WS-ACCT-NEW-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   272     12  WS-ACCT-NEW-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   273     12  WS-ACCT-NEW-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   274     12  WS-ACCT-NEW-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   275     12  WS-ACCT-NEW-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   276     12  WS-CSO-LF-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   277     12  WS-CSO-ALT-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   278     12  WS-CSO-CMB-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   279     12  WS-CSO-AH-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   280     12  WS-CSO-PORTION-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   281     12  WS-ACCT-LF-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   282     12  WS-ACCT-ALT-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   283     12  WS-ACCT-CMB-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   284     12  WS-ACCT-AH-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   285     12  WS-ACCT-PORTION-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   286 01  WS-SAVE-ERACCT-REC          PIC X(2000).
   287 01  WS-XML-WORK                 PIC X(4200)  VALUE SPACES.
   288 01 response-code         pic s9(8) comp.
   289 01 display-response      pic 9(8).
   290 01 bl-index              pic 9(8) comp.
   291 01 max-last-name         pic x(18).
   292 01 first-initial         pic x.
   293 01 name-in-range-flag    pic 9.
   294 01 max-entries           pic s9(8) comp value 100.
   295 01 WS-PASSED-DT          PIC XX   VALUE LOW-VALUES.
   296 01 lower-case    pic x(26) value
   297            "abcdefghijklmnopqrstuvwxyz".
   298 01 upper-case    pic x(26) value
   299            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
   300
   301*                                COPY ELCVADS.
   302******************************************************************
   303*                                                                *
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page   7
* NSRASBL.cbl
   304*                                                                *
   305*                            ELCVADS.                            *
   306*                                                                *
   307*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   308*   ELVADS                  LENGTH = 350                         *
   309******************************************************************
   310******************************************************************
   311*                   C H A N G E   L O G
   312*
   313* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   314*-----------------------------------------------------------------
   315*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   316* EFFECTIVE    NUMBER
   317*-----------------------------------------------------------------
   318* 100111    2011022800001  AJRA  NAPERSOFT
   319******************************************************************
   320
   321 01  VIRGINIA-DISCLOSURE.
   322     12  VD-COMPANY-CD              PIC X.
   323     12  VD-CARRIER                 PIC X.
   324     12  VD-GROUPING.
   325         20  VD-GROUPING-PREFIX     PIC XXX.
   326         20  VD-GROUPING-PRIME      PIC XXX.
   327     12  VD-STATE                   PIC XX.
   328     12  VD-ACCOUNT.
   329         20  VD-ACCOUNT-PREFIX      PIC X(4).
   330         20  VD-ACCOUNT-PRIME       PIC X(6).
   331     12  VD-CERT-EFF-DT             PIC XX.
   332     12  VD-CERT-NO.
   333         20  VD-CERT-PRIME          PIC X(10).
   334         20  VD-CERT-SFX            PIC X.
   335     12  VD-ENTRY-BATCH             PIC X(6).
   336     12  VD-CSR-ID                  PIC X(4).
   337     12  VD-NAME.
   338         20  VD-INSURED-LAST-NAME   PIC X(15).
   339         20  VD-INSURED-FIRST-NAME.
   340             24  VD-INSURED-1ST-INIT PIC X.
   341             24  FILLER             PIC X(9).
   342         20  VD-INSURED-MIDDLE-INIT PIC X.
   343     12  VD-JOINT-INSURED.
   344         20 VD-JOINT-LAST-NAME      PIC X(15).
   345         20 VD-JOINT-FIRST-NAME.
   346            24  VD-JOINT-FIRST-INIT PIC X.
   347            24  FILLER              PIC X(9).
   348         20 VD-JOINT-MIDDLE-INIT    PIC X.
   349     12  VD-INSURED-ADDRESS-1       PIC X(30).
   350     12  VD-INSURED-ADDRESS-2       PIC X(30).
   351     12  VD-INSURED-CITY-STATE.
   352         20  VD-INSURED-CITY        PIC X(28).
   353         20  VD-INSURED-STATE       PIC XX.
   354     12  VD-INSURED-ZIP-CODE.
   355         20  VD-INSURED-ZIP-PRIME.
   356             24  VD-INSURED-ZIP-1   PIC X.
   357                 88  VD-CANADIAN-POST-CODE
   358                                       VALUE 'A' THRU 'Z'.
   359             24  FILLER             PIC X(4).
   360         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
   361     12  VD-BENEFICIARY-NAME        PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page   8
* NSRASBL.cbl
   362     12  VD-ACCOUNT-NAME            PIC X(30).
   363     12  VD-LOAN-TERM               PIC S999   COMP-3.
   364     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   365     12  VD-1ST-PMT-DT              PIC XX.
   366     12  VD-LIFE-BENEFIT-CD         PIC XX.
   367         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   368         88  VD-INVALID-LIFE           VALUE '  ' '00'
   369                                             '90' THRU '99'.
   370     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   371                                    PIC XX.
   372     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   373     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   374     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   375     12  VD-LF-TERM                 PIC S999   COMP-3.
   376     12  VD-AH-BENEFIT-CD           PIC XX.
   377         88  VD-VALID-AH               VALUE '01' THRU '89'.
   378         88  VD-INVALID-AH             VALUE '  ' '00'
   379                                             '90' THRU '99'.
   380     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   381     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   382     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   383     12  VD-AH-TERM                 PIC S999   COMP-3.
   384     12  VD-LETTER-ID               PIC X(4).
   385     12  VD-PROC-ID                 PIC X(4).
   386     12  VD-COMP-ID                 PIC X(3).
   387     12  VD-CURRENT-DATE            PIC XX.
   388     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   389     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
   390     12  FILLER                     PIC X(32).
   391 01  WS-PASS-AREA.
   392     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   393     05  WS-PASS-VADS-REC    PIC X(350).
   394
   395*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   396*                         COPY ELCZREC.
   397******************************************************************
   398*                                                                *
   399*                                                                *
   400*                            ELCZREC.                            *
   401*                                                                *
   402*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   403*                                                                *
   404******************************************************************
   405*-----------------------------------------------------------------
   406*                   C H A N G E   L O G
   407*
   408* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   409*-----------------------------------------------------------------
   410*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   411* EFFECTIVE    NUMBER
   412*-----------------------------------------------------------------
   413* 122011    2011022800001  AJRA  NEW FILE
   414* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   415* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   416* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   417* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   418*-----------------------------------------------------------------
   419 01  W-Z-CONTROL-DATA.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page   9
* NSRASBL.cbl
   420     05  W-NUMBER-OF-COPIES      PIC  9.
   421     05  FILLER                  PIC  X.
   422     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   423     05  FILLER                  PIC  X.
   424     05  W-DAYS-TO-RESEND        PIC  999.
   425     05  FILLER                  PIC  X.
   426     05  W-FORM-TO-RESEND        PIC  X(4).
   427     05  W-ADD-BAR-CODE          PIC  X.
   428     05  W-PROMPT-LETTER         PIC  X.
   429     05  W-HAS-RETURN-ENV        PIC  X.
   430     05  W-ENCLOSURE-CD          PIC  XXX.
   431     05  W-SIG-FLAG-DEFAULT      PIC  X.
   432     05  W-AUTO-CLOSE-IND        PIC  X.
   433     05  FILLER                  PIC  X.
   434     05  W-LETTER-TO-BENE        PIC  X.
   435     05  FILLER                  PIC  X.
   436     05  W-LETTER-TO-ACCT        PIC  X.
   437     05  FILLER                  PIC  X.
   438     05  W-LETTER-TYPE           PIC  X.
   439     05  FILLER                  PIC  X.
   440     05  W-PRINT-CERTIFICATE     PIC  X.
   441     05  FILLER                  PIC  X.
   442     05  W-REFUND-REQUIRED       PIC  X.
   443     05  FILLER                  PIC  X.
   444     05  W-ONBASE-CODE           PIC  XX.
   445     05  FILLER                  PIC  X.
   446     05  W-ACCT-SUMM             PIC  X.
   447     05  FILLER                  PIC  X.
   448     05  W-CSO-SUMM              PIC  X.
   449     05  FILLER                  PIC  X.
   450     05  W-REASONS-REQUIRED      PIC  X.
   451     05  FILLER                  PIC  X(29).
   452 01  MISC.
   453     12  WS-RESPONSE             PIC S9(8)   COMP.
   454         88  RESP-NORMAL                  VALUE +00.
   455         88  RESP-NOTFND                  VALUE +13.
   456         88  RESP-DUPREC                  VALUE +14.
   457         88  RESP-DUPKEY                  VALUE +15.
   458         88  RESP-NOTOPEN                 VALUE +19.
   459         88  RESP-ENDFILE                 VALUE +20.
   460
   461     12  WS-EDIT-A-DATE.
   462         16  WS-EDIT-A-MM                 PIC X(2).
   463         16  FILLER                       PIC X(1).
   464         16  WS-EDIT-A-DD                 PIC X(2).
   465         16  FILLER                       PIC X(1).
   466         16  WS-EDIT-A-CCYY.
   467             20  WS-EDIT-A-CC             PIC X(2).
   468             20  WS-EDIT-A-YY             PIC X(2).
   469 01  srch-commarea.
   470*                                copy ELCADLTRSPI.
   471******************************************************************
   472*                   C H A N G E   L O G
   473*
   474* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   475*-----------------------------------------------------------------
   476*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   477* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  10
* NSRASBL.cbl
   478*-----------------------------------------------------------------
   479* 060611    2011022800001  PEMA  NEW COPYBOOK
   480* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   481* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   482******************************************************************
   483****************************************
   484*  commarea for NaperSoft On Demand Admin services letters
   485*  (business logic input & output)
   486****************************************
   487     03  BL-INPUT.
   488         05  BL-DATA-SRCE        PIC X.
   489         05  BL-LETTER-ID        PIC XXXX.
   490         05  BL-CARRIER          PIC X.
   491         05  BL-GROUP            PIC X(6).
   492         05  BL-STATE            PIC XX.
   493         05  BL-ACCOUNT          PIC X(10).
   494         05  BL-EFF-DT           PIC X(10).
   495         05  BL-CERT-NO          PIC X(11).
   496         05  BL-BATCH-NO         PIC X(6).
   497         05  BL-BATCH-SEQ        PIC 9(8).
   498         05  BL-RESP-NO          PIC X(10).
   499         05  BL-NO-OF-COPIES     PIC 99.
   500         05  BL-PROC-ID          PIC XXXX.
   501         05  BL-COMP-ID          PIC XXX.
   502         05  BL-PRINT-NOW-SW     PIC X.
   503         05  BL-ENC-CD           PIC XXX.
   504         05  BL-RESEND-DT        PIC X(10).
   505         05  BL-FOLLOW-UP-DT     PIC X(10).
   506         05  BL-ARCHIVE-NO       PIC 9(8).
   507         05  BL-FUNC             PIC X(8).
   508         05  BL-COMMENTS         PIC X(100).
   509         05  FILLER REDEFINES BL-COMMENTS.
   510             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   511             10  BL-LETTER-TO-ACCT PIC X.
   512             10  BL-LETTER-TO-BENE PIC X.
   513             10  BL-WRITE-ERARCH   PIC X.
   514                 88  ERARCH-QWS      VALUE 'Q'.
   515                 88  ERARCH-BATCH    VALUE 'B'.
   516                 88  ERARCH-TEMP     VALUE 'T'.
   517             10  BL-PROCESS-TYPE PIC X(07).
   518             10  BL-CERT-FORM-ID PIC X(05).
   519             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   520             10  BL-SOURCE-SCREEN PIC X(8).
   521             10  FILLER          PIC X(25).
   522     03  BL-OUTPUT.
   523         05  BL-STATUS                   PIC X.
   524             88  BL-OK                      VALUE "P".
   525             88  BL-FAIL                  VALUE "F".
   526         05  BL-MESSAGE          PIC X(50).
   527     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   528     03  FILLER                  PIC X(31).
   529 01  filler                      pic x(500).
   530 01  WS-SAVE-CARRIER-INFO.
   531     05  WS-PREV-CARRIER         PIC X      VALUE SPACES.
   532     05  WS-CARR-NAME            PIC X(30)  VALUE SPACES.
   533     05  WS-CARR-ICO             PIC X(30)  VALUE SPACES.
   534     05  WS-CARR-ADDR1           PIC X(30)  VALUE SPACES.
   535     05  WS-CARR-ADDR2           PIC X(30)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  11
* NSRASBL.cbl
   536     05  WS-CARR-CITYST          PIC X(30)  VALUE SPACES.
   537     05  WS-CARR-ZIP             PIC X(9)   VALUE SPACES.
   538     05  WS-CARR-PHONE           PIC X(11)  VALUE SPACES.
   539 01  WS-SAVE-STATE-INFO.
   540     05  WS-PREV-STATE           PIC XX     VALUE SPACES.
   541     05  WS-STATE-NAME           PIC X(25)  VALUE SPACES.
   542 01  WS-SAVE-LFBEN-INFO.
   543     05  WS-PREV-LFBEN           PIC XX     VALUE SPACES.
   544     05  WS-LFBEN-ALPH           PIC XXX    VALUE SPACES.
   545     05  WS-LFBEN-DESC           PIC X(10)  VALUE SPACES.
   546 01  WS-SAVE-AHBEN-INFO.
   547     05  WS-PREV-AHBEN           PIC XX     VALUE SPACES.
   548     05  WS-AHBEN-DESC           PIC X(10)  VALUE SPACES.
   549     05  WS-AHBEN-RET-ELIM       PIC X      VALUE SPACES.
   550     05  WS-AHBEN-DAYS           PIC XX     VALUE SPACES.
   551 01  WS-ERPNDB-KEY.
   552     05  WS-ERPNDB-COMPANY-CD    PIC X.
   553     05  WS-ERPNDB-BATCH-NO      PIC X(6).
   554     05  WS-ERPNDB-BATCH-SEQ     PIC S9(4) COMP  VALUE +0.
   555     05  WS-ERPNDB-CHG-SEQ       PIC S9(4) COMP  VALUE +0.
   556 01  WS-ELENCC-KEY.
   557     05  WS-ELENCC-COMPANY-CD    PIC X.
   558     05  WS-ELENCC-REC-TYPE      PIC X.
   559     05  WS-ELENCC-ENC-CODE      PIC X(5).
   560     05  F                       PIC X(9).
   561 01  WS-ELCERT-KEY.
   562     05  WS-ELCERT-COMPANY-CD    PIC X.
   563     05  WS-ELCERT-CARRIER       PIC X.
   564     05  WS-ELCERT-GROUP         PIC X(6).
   565     05  WS-ELCERT-STATE         PIC XX.
   566     05  WS-ELCERT-ACCOUNT       PIC X(10).
   567     05  WS-ELCERT-EFF-DT        PIC XX.
   568     05  WS-ELCERT-CERT-NO       PIC X(11).
   569 01  WS-ELCRTT-KEY.
   570     05  WS-ELCRTT-PRIMARY       PIC X(33).
   571     05  WS-ELCRTT-REC-TYPE      PIC X(1).
   572
   573 01  WS-ERENDT-KEY.
   574     05  WS-ERENDT-COMPANY-CD    PIC X.
   575     05  WS-ERENDT-CARRIER       PIC X.
   576     05  WS-ERENDT-GROUP         PIC X(6).
   577     05  WS-ERENDT-STATE         PIC XX.
   578     05  WS-ERENDT-ACCOUNT       PIC X(10).
   579     05  WS-ERENDT-EFF-DT        PIC XX.
   580     05  WS-ERENDT-CERT-NO       PIC X(11).
   581     05  WS-ERENDT-REC-TYPE      PIC X.
   582     05  WS-ERENDT-SEQ-NO        PIC 9(4) BINARY.
   583
   584 01  WS-ERENDT-KEY-BY-ARCH.
   585     05  WS-ERENDT-COMPANY-CD-A1 PIC X.
   586     05  WS-ERENDT-ARCHIVE       PIC 9(8) BINARY.
   587 01  WS-ERCOMP-KEY.
   588     05  WS-ERCOMP-COMPANY-CD    PIC X.
   589     05  WS-ERCOMP-CARRIER       PIC X.
   590     05  WS-ERCOMP-GROUP         PIC X(6).
   591     05  WS-ERCOMP-RESP-NO       PIC X(10).
   592     05  WS-ERCOMP-ACCOUNT       PIC X(10).
   593     05  WS-ERCOMP-REC-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  12
* NSRASBL.cbl
   594 01  WS-ERMAIL-KEY.
   595     05  WS-ERMAIL-COMPANY-CD    PIC X.
   596     05  WS-ERMAIL-CARRIER       PIC X.
   597     05  WS-ERMAIL-GROUP         PIC X(6).
   598     05  WS-ERMAIL-STATE         PIC XX.
   599     05  WS-ERMAIL-ACCOUNT       PIC X(10).
   600     05  WS-ERMAIL-EFF-DT        PIC XX.
   601     05  WS-ERMAIL-CERT-NO       PIC X(11).
   602 01  WS-ERACCT-KEY.
   603     05  WS-ERACCT-COMPANY-CD    PIC X.
   604     05  WS-ERACCT-CARRIER       PIC X.
   605     05  WS-ERACCT-GROUP         PIC X(6).
   606     05  WS-ERACCT-STATE         PIC XX.
   607     05  WS-ERACCT-ACCOUNT       PIC X(10).
   608     05  WS-ERACCT-EXP-DT        PIC XX.
   609     05  FILLER                  PIC XXXX.
   610 01  WS-ELLETR-KEY.
   611     05  WS-ELLETR-COMPANY-CD    PIC X.
   612     05  WS-ELLETR-LETTER-ID     PIC X(12).
   613     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   614 01  WS-ELCNTL-KEY.
   615     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   616     05  WS-ELCNTL-REC-TYPE      PIC X.
   617     05  WS-ELCNTL-GENL.
   618         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   619         10  WS-ELCNTL-BEN-CD.
   620             15  F               PIC X.
   621             15  WS-ELCNTL-CARR  PIC X.
   622     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   623*                                COPY ELCDATE.
   624******************************************************************
   625*                                                                *
   626*                                                                *
   627*                            ELCDATE.                            *
   628*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   629*                            VMOD=2.003
   630*                                                                *
   631*                                                                *
   632*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   633*                 LENGTH = 200                                   *
   634******************************************************************
   635
   636 01  DATE-CONVERSION-DATA.
   637     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   638     12  DC-OPTION-CODE                PIC X.
   639         88  BIN-TO-GREG                VALUE ' '.
   640         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   641         88  EDIT-GREG-TO-BIN           VALUE '2'.
   642         88  YMD-GREG-TO-BIN            VALUE '3'.
   643         88  MDY-GREG-TO-BIN            VALUE '4'.
   644         88  JULIAN-TO-BIN              VALUE '5'.
   645         88  BIN-PLUS-ELAPSED           VALUE '6'.
   646         88  FIND-CENTURY               VALUE '7'.
   647         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   648         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   649         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   650         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   651         88  JULIAN-TO-BIN-3            VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  13
* NSRASBL.cbl
   652         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   653         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   654         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   655         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   656         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   657         88  CHECK-LEAP-YEAR            VALUE 'H'.
   658         88  BIN-3-TO-GREG              VALUE 'I'.
   659         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   660         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   661         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   662         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   663         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   664         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   665         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   666         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   667         88  THREE-CHARACTER-BIN
   668                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   669         88  GREGORIAN-TO-BIN
   670                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   671         88  BIN-TO-GREGORIAN
   672                  VALUES ' ' '1' 'I' '8' 'G'.
   673         88  JULIAN-TO-BINARY
   674                  VALUES '5' 'C' 'E' 'F'.
   675     12  DC-ERROR-CODE                 PIC X.
   676         88  NO-CONVERSION-ERROR        VALUE ' '.
   677         88  DATE-CONVERSION-ERROR
   678                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   679         88  DATE-IS-ZERO               VALUE '1'.
   680         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   681         88  DATE-IS-INVALID            VALUE '3'.
   682         88  DATE1-GREATER-DATE2        VALUE '4'.
   683         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   684         88  DATE-INVALID-OPTION        VALUE '9'.
   685         88  INVALID-CENTURY            VALUE 'A'.
   686         88  ONLY-CENTURY               VALUE 'B'.
   687         88  ONLY-LEAP-YEAR             VALUE 'C'.
   688         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   689     12  DC-END-OF-MONTH               PIC X.
   690         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   691     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   692         88  USE-NORMAL-PROCESS         VALUE ' '.
   693         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   694         88  ADJUST-UP-100-YRS          VALUE '2'.
   695     12  FILLER                        PIC X.
   696     12  DC-CONVERSION-DATES.
   697         16  DC-BIN-DATE-1             PIC XX.
   698         16  DC-BIN-DATE-2             PIC XX.
   699         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   700         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   701                       DC-GREG-DATE-1-EDIT.
   702             20  DC-EDIT1-MONTH        PIC 99.
   703             20  SLASH1-1              PIC X.
   704             20  DC-EDIT1-DAY          PIC 99.
   705             20  SLASH1-2              PIC X.
   706             20  DC-EDIT1-YEAR         PIC 99.
   707         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   708         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   709                     DC-GREG-DATE-2-EDIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  14
* NSRASBL.cbl
   710             20  DC-EDIT2-MONTH        PIC 99.
   711             20  SLASH2-1              PIC X.
   712             20  DC-EDIT2-DAY          PIC 99.
   713             20  SLASH2-2              PIC X.
   714             20  DC-EDIT2-YEAR         PIC 99.
   715         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   716         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   717                     DC-GREG-DATE-1-YMD.
   718             20  DC-YMD-YEAR           PIC 99.
   719             20  DC-YMD-MONTH          PIC 99.
   720             20  DC-YMD-DAY            PIC 99.
   721         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   722         16  DC-GREG-DATE-1-MDY-R REDEFINES
   723                      DC-GREG-DATE-1-MDY.
   724             20  DC-MDY-MONTH          PIC 99.
   725             20  DC-MDY-DAY            PIC 99.
   726             20  DC-MDY-YEAR           PIC 99.
   727         16  DC-GREG-DATE-1-ALPHA.
   728             20  DC-ALPHA-MONTH        PIC X(10).
   729             20  DC-ALPHA-DAY          PIC 99.
   730             20  FILLER                PIC XX.
   731             20  DC-ALPHA-CENTURY.
   732                 24 DC-ALPHA-CEN-N     PIC 99.
   733             20  DC-ALPHA-YEAR         PIC 99.
   734         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   735         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   736         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   737         16  DC-JULIAN-DATE            PIC 9(05).
   738         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   739                                       PIC 9(05).
   740         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   741             20  DC-JULIAN-YEAR        PIC 99.
   742             20  DC-JULIAN-DAYS        PIC 999.
   743         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   744         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   745         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   746     12  DATE-CONVERSION-VARIBLES.
   747         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   748         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   749             20  FILLER                PIC 9(3).
   750             20  HOLD-CEN-1-CCYY.
   751                 24  HOLD-CEN-1-CC     PIC 99.
   752                 24  HOLD-CEN-1-YY     PIC 99.
   753             20  HOLD-CEN-1-MO         PIC 99.
   754             20  HOLD-CEN-1-DA         PIC 99.
   755         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   756             20  HOLD-CEN-1-R-MO       PIC 99.
   757             20  HOLD-CEN-1-R-DA       PIC 99.
   758             20  HOLD-CEN-1-R-CCYY.
   759                 24  HOLD-CEN-1-R-CC   PIC 99.
   760                 24  HOLD-CEN-1-R-YY   PIC 99.
   761             20  FILLER                PIC 9(3).
   762         16  HOLD-CENTURY-1-X.
   763             20  FILLER                PIC X(3)  VALUE SPACES.
   764             20  HOLD-CEN-1-X-CCYY.
   765                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   766                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   767             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  15
* NSRASBL.cbl
   768             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   769         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   770             20  HOLD-CEN-1-R-X-MO     PIC XX.
   771             20  HOLD-CEN-1-R-X-DA     PIC XX.
   772             20  HOLD-CEN-1-R-X-CCYY.
   773                 24  HOLD-CEN-1-R-X-CC PIC XX.
   774                 24  HOLD-CEN-1-R-X-YY PIC XX.
   775             20  FILLER                PIC XXX.
   776         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   777         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   778         16  DC-JULIAN-DATE-1          PIC 9(07).
   779         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   780             20  DC-JULIAN-1-CCYY.
   781                 24  DC-JULIAN-1-CC    PIC 99.
   782                 24  DC-JULIAN-1-YR    PIC 99.
   783             20  DC-JULIAN-DA-1        PIC 999.
   784         16  DC-JULIAN-DATE-2          PIC 9(07).
   785         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   786             20  DC-JULIAN-2-CCYY.
   787                 24  DC-JULIAN-2-CC    PIC 99.
   788                 24  DC-JULIAN-2-YR    PIC 99.
   789             20  DC-JULIAN-DA-2        PIC 999.
   790         16  DC-GREG-DATE-A-EDIT.
   791             20  DC-EDITA-MONTH        PIC 99.
   792             20  SLASHA-1              PIC X VALUE '/'.
   793             20  DC-EDITA-DAY          PIC 99.
   794             20  SLASHA-2              PIC X VALUE '/'.
   795             20  DC-EDITA-CCYY.
   796                 24  DC-EDITA-CENT     PIC 99.
   797                 24  DC-EDITA-YEAR     PIC 99.
   798         16  DC-GREG-DATE-B-EDIT.
   799             20  DC-EDITB-MONTH        PIC 99.
   800             20  SLASHB-1              PIC X VALUE '/'.
   801             20  DC-EDITB-DAY          PIC 99.
   802             20  SLASHB-2              PIC X VALUE '/'.
   803             20  DC-EDITB-CCYY.
   804                 24  DC-EDITB-CENT     PIC 99.
   805                 24  DC-EDITB-YEAR     PIC 99.
   806         16  DC-GREG-DATE-CYMD         PIC 9(08).
   807         16  DC-GREG-DATE-CYMD-R REDEFINES
   808                              DC-GREG-DATE-CYMD.
   809             20  DC-CYMD-CEN           PIC 99.
   810             20  DC-CYMD-YEAR          PIC 99.
   811             20  DC-CYMD-MONTH         PIC 99.
   812             20  DC-CYMD-DAY           PIC 99.
   813         16  DC-GREG-DATE-MDCY         PIC 9(08).
   814         16  DC-GREG-DATE-MDCY-R REDEFINES
   815                              DC-GREG-DATE-MDCY.
   816             20  DC-MDCY-MONTH         PIC 99.
   817             20  DC-MDCY-DAY           PIC 99.
   818             20  DC-MDCY-CEN           PIC 99.
   819             20  DC-MDCY-YEAR          PIC 99.
   820    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   821        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   822    12  DC-EL310-DATE                  PIC X(21).
   823    12  FILLER                         PIC X(28).
   824*                                COPY NSCASEXTR.
   825******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  16
* NSRASBL.cbl
   826*                                                                *
   827*                                                                *
   828*                            NSCASEXTR.                          *
   829*                            VMOD=2.001                          *
   830*                                                                *
   831*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   832*                                                                *
   833*   FILE TYPE = VSAM,KSDS                                        *
   834*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   835*                                                                *
   836*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   837*                                                                *
   838*   LOG = NO                                                     *
   839*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   840******************************************************************
   841*-----------------------------------------------------------------
   842*                   C H A N G E   L O G
   843*
   844* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   845*-----------------------------------------------------------------
   846*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   847* EFFECTIVE    NUMBER
   848*-----------------------------------------------------------------
   849* 072211    2011022800001  PEMA  NEW FILE
   850*-----------------------------------------------------------------
   851 01 NSAS-EXTRACT-RECORD.
   852    05  NSAS-CONTROL-PRIMARY.
   853        10  NSAS-COMPANY-CD      PIC X.
   854        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   855        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   856    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   857    05  FILLER                   PIC X(143).
   858*                                COPY ERCPNDB.
   859******************************************************************
   860*                                                                *
   861*                                                                *
   862*                            ERCPNDB.                            *
   863*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   864*                            VMOD=2.025                          *
   865*                                                                *
   866*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   867*                                                                *
   868******************************************************************
   869*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   870*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   871******************************************************************
   872*                                                                *
   873*                                                                *
   874*   FILE TYPE = VSAM,KSDS                                        *
   875*   RECORD SIZE = 585  RECFORM = FIXED                           *
   876*                                                                *
   877*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   878*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   879*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   880*                                                 RKP=13,LEN=36  *
   881*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   882*                                      AND CHG-SEQ.)             *
   883*                                                RKP=49,LEN=11   *
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  17
* NSRASBL.cbl
   884*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   885*                                      AND CHG-SEQ.)             *
   886*                                                RKP=60,LEN=15   *
   887*                                                                *
   888*   LOG = NO                                                     *
   889*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   890******************************************************************
   891******************************************************************
   892*                   C H A N G E   L O G
   893*
   894* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   895*-----------------------------------------------------------------
   896*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   897* EFFECTIVE    NUMBER
   898*-----------------------------------------------------------------
   899* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   900* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   901* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   902* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   903* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   904* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   905* 032306                   PEMA  ADD BOW LOAN NUMBER
   906* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   907* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   908* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   909* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   910* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   911* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   912* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   913* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   914******************************************************************
   915
   916 01  PENDING-BUSINESS.
   917     12  PB-RECORD-ID                     PIC XX.
   918         88  VALID-PB-ID                        VALUE 'PB'.
   919
   920     12  PB-CONTROL-PRIMARY.
   921         16  PB-COMPANY-CD                PIC X.
   922         16  PB-ENTRY-BATCH               PIC X(6).
   923         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   924         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   925
   926     12  PB-CONTROL-BY-ACCOUNT.
   927         16  PB-COMPANY-CD-A1             PIC X.
   928         16  PB-CARRIER                   PIC X.
   929         16  PB-GROUPING.
   930             20  PB-GROUPING-PREFIX       PIC XXX.
   931             20  PB-GROUPING-PRIME        PIC XXX.
   932         16  PB-STATE                     PIC XX.
   933         16  PB-ACCOUNT.
   934             20  PB-ACCOUNT-PREFIX        PIC X(4).
   935             20  PB-ACCOUNT-PRIME         PIC X(6).
   936         16  PB-CERT-EFF-DT               PIC XX.
   937         16  PB-CERT-NO.
   938             20  PB-CERT-PRIME            PIC X(10).
   939             20  PB-CERT-SFX              PIC X.
   940         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   941
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  18
* NSRASBL.cbl
   942         16  PB-RECORD-TYPE               PIC X.
   943             88  PB-MAILING-DATA                VALUE '0'.
   944             88  PB-ISSUE                       VALUE '1'.
   945             88  PB-CANCELLATION                VALUE '2'.
   946             88  PB-BATCH-TRAILER               VALUE '9'.
   947
   948     12  PB-CONTROL-BY-ORIG-BATCH.
   949         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   950         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   951         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   952         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   953
   954     12  PB-CONTROL-BY-CSR.
   955         16  PB-CSR-COMPANY-CD            PIC X.
   956         16  PB-CSR-ID                    PIC X(4).
   957         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   958         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   959         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   960******************************************************************
   961*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   962******************************************************************
   963
   964     12  PB-LAST-MAINT-DT                 PIC XX.
   965     12  PB-LAST-MAINT-BY                 PIC X(4).
   966     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   967
   968     12  PB-RECORD-BODY                   PIC X(375).
   969
   970     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   971         16  PB-CERT-ORIGIN               PIC X.
   972             88  CLASIC-CREATED-CERT         VALUE '1'.
   973         16  PB-I-NAME.
   974             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   975             20  PB-I-INSURED-FIRST-NAME.
   976                 24  PB-I-INSURED-1ST-INIT PIC X.
   977                 24  FILLER                PIC X(9).
   978             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   979         16  PB-I-AGE                     PIC S99   COMP-3.
   980         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   981         16  PB-I-BIRTHDAY                PIC XX.
   982         16  PB-I-INSURED-SEX             PIC X.
   983             88  PB-SEX-MALE     VALUE 'M'.
   984             88  PB-SEX-FEMALE   VALUE 'F'.
   985
   986         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   987         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   988         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   989         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   990         16  PB-I-SKIP-CODE               PIC X.
   991             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   992             88  PB-SKIP-JULY              VALUE '1'.
   993             88  PB-SKIP-AUGUST            VALUE '2'.
   994             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   995             88  PB-SKIP-JULY-AUG          VALUE '4'.
   996             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   997             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   998             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   999             88  PB-SKIP-JUNE              VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  19
* NSRASBL.cbl
  1000             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1001             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1002             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1003         16  PB-I-TERM-TYPE               PIC X.
  1004             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1005             88  PB-PAID-WEEKLY            VALUE 'W'.
  1006             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1007             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1008             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1009         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1010         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1011         16  PB-I-DATA-ENTRY-SW           PIC X.
  1012             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1013             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1014             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1015             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1016         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1017         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1018*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1019         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1020         16  FILLER                       PIC X.
  1021
  1022         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1023             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1024             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1025                                                   '90' THRU '99'.
  1026         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1027                                          PIC XX.
  1028         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1029         16  PB-I-AMOUNT-FINANCED REDEFINES
  1030                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  1031         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1032         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1033                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1034         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1035         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1036         16  PB-I-CLP-AMOUNT REDEFINES
  1037                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1038         16  PB-I-LF-CALC-FLAG            PIC X.
  1039             88 PB-COMP-LF-PREM               VALUE '?'.
  1040         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1041         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1042         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  1043         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  1044         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1045         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  1046         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  1047         16  PB-I-LF-ABBR                 PIC XXX.
  1048         16  PB-I-LF-INPUT-CD             PIC XX.
  1049
  1050         16  PB-I-AH-BENEFIT-CD           PIC XX.
  1051             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  1052             88  PB-INVALID-AH               VALUE '  ' '00'
  1053                                                   '90' THRU '99'.
  1054         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1055         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1056         16  PB-I-AH-CALC-FLAG            PIC X.
  1057             88 PB-COMP-AH-PREM                  VALUE '?'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  20
* NSRASBL.cbl
  1058         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  1059         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  1060         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1061         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  1062         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  1063         16  PB-I-AH-ABBR                 PIC XXX.
  1064         16  PB-I-AH-INPUT-CD             PIC XXX.
  1065
  1066         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  1067         16  PB-I-REIN-TABLE              PIC XXX.
  1068         16  PB-I-BUSINESS-TYPE           PIC 99.
  1069         16  PB-I-INDV-GRP-CD             PIC X.
  1070         16  PB-I-MORT-CODE.
  1071             20  PB-I-TABLE               PIC X.
  1072             20  PB-I-INTEREST            PIC XX.
  1073             20  PB-I-MORT-TYP            PIC X.
  1074         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  1075         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  1076         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  1077         16  PB-I-INDV-GRP-OVRD           PIC X.
  1078         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  1079         16  PB-I-SIG-SW                  PIC X.
  1080             88  PB-POLICY-SIGNED             VALUE 'Y'.
  1081         16  PB-I-RATE-CLASS              PIC XX.
  1082         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  1083         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  1084         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  1085         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  1086         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  1087         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  1088         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  1089         16  PB-I-BENEFIT-TYPE            PIC XXX.
  1090         16  PB-I-OB-FLAG                 PIC X.
  1091             88  PB-I-OB                      VALUE 'B'.
  1092             88  PB-I-SUMMARY                 VALUE 'Z'.
  1093         16  PB-I-ENTRY-STATUS            PIC X.
  1094             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  1095                                              'M' '5' '9' '2'.
  1096             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  1097             88  PB-I-POLICY-PENDING          VALUE '2'.
  1098             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  1099             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  1100             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  1101             88  PB-I-REIN-ONLY               VALUE '9'.
  1102             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  1103             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  1104             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  1105             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  1106         16  PB-I-INT-CODE                PIC X.
  1107             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  1108             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  1109         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1110         16  PB-I-SOC-SEC-NO              PIC X(11).
  1111         16  PB-I-MEMBER-NO               PIC X(12).
  1112         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  1113*        16  PB-I-LOAN-OFFICER            PIC XXX.
  1114         16  PB-I-OLD-LOF                 PIC XXX.
  1115         16  PB-I-LF-EXPIRE-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  21
* NSRASBL.cbl
  1116         16  PB-I-AH-EXPIRE-DT            PIC XX.
  1117         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  1118         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  1119         16  PB-I-LIFE-INDICATOR          PIC X.
  1120             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  1121         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  1122         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  1123                                          PIC S9(5)V99    COMP-3.
  1124         16  PB-I-MAIL-ADDRS-SW           PIC X.
  1125             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  1126             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  1127         16  PB-I-1ST-PMT-DT              PIC XX.
  1128         16  PB-I-JOINT-INSURED.
  1129             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  1130             20 PB-I-JOINT-FIRST-NAME.
  1131                24  PB-I-JOINT-FIRST-INIT PIC X.
  1132                24  FILLER                PIC X(9).
  1133             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  1134*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  1135         16  PB-I-BENEFICIARY-NAME.
  1136             20  PB-I-BANK-NUMBER         PIC X(10).
  1137             20  FILLER                   PIC X(15).
  1138         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  1139         16  PB-I-REFERENCE               PIC X(12).
  1140         16  FILLER REDEFINES PB-I-REFERENCE.
  1141             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  1142             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  1143             20  PB-I-CLP-STATE           PIC XX.
  1144         16  PB-I-UNDERWRITING-STATUS     PIC X.
  1145             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  1146             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  1147             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  1148         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  1149         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  1150         16  PB-I-RESIDENT-STATE          PIC XX.
  1151         16  PB-I-RATE-CODE               PIC X(4).
  1152         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  1153         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1154         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1155         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  1156         16  PB-I-BANK-NOCHRGB            PIC 99.
  1157         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  1158         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  1159
  1160     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  1161         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  1162             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  1163         16  PB-C-CANCEL-ORIGIN           PIC X.
  1164             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  1165         16  PB-C-LF-CANCEL-DT            PIC XX.
  1166         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1167         16  PB-C-LF-CALC-REQ             PIC X.
  1168             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1169         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1170         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  1171         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1172             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1173         16  PB-C-AH-CANCEL-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  22
* NSRASBL.cbl
  1174         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1175         16  PB-C-AH-CALC-REQ             PIC X.
  1176             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1177         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1178         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1179         16  PB-C-LAST-NAME               PIC X(15).
  1180         16  PB-C-REFUND-SW               PIC X.
  1181             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1182             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1183         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1184         16  PB-C-PAYEE-CODE              PIC X(6).
  1185         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1186         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1187         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1188         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1189         16  PB-C-REFERENCE               PIC X(12).
  1190         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1191         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1192         16  PB-C-POST-CARD-IND           PIC X.
  1193         16  PB-C-CANCEL-REASON           PIC X.
  1194         16  PB-C-REF-INTERFACE-SW        PIC X.
  1195         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1196         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1197         16  FILLER                       PIC X(01).
  1198*        16  FILLER                       PIC X(18).
  1199         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1200*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1201         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  1202         16  PB-CANCELED-CERT-DATA.
  1203             20  PB-CI-INSURED-NAME.
  1204                 24  PB-CI-LAST-NAME      PIC X(15).
  1205                 24  PB-CI-INITIALS       PIC XX.
  1206             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  1207             20  PB-CI-INSURED-SEX        PIC X.
  1208             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1209             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1210             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1211             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1212             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1213             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  1214             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1215             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1216             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1217             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1218             20  PB-CI-RATE-CLASS         PIC XX.
  1219             20  PB-CI-RATE-DEV-LF        PIC XXX.
  1220             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1221             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1222             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1223             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1224             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  1225             20  PB-CI-LF-ABBR            PIC X(3).
  1226             20  PB-CI-AH-ABBR            PIC X(3).
  1227             20  PB-CI-OB-FLAG            PIC X.
  1228                 88  PB-CI-OB                VALUE 'B'.
  1229             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1230                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1231                                           'M' '4' '5' '9' '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  23
* NSRASBL.cbl
  1232                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1233                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1234                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1235                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1236                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1237                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1238                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1239                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1240                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1241                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1242                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1243                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1244             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1245                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1246                                           'M' '4' '5' '9' '2'.
  1247                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1248                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1249                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1250                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1251                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1252                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1253                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1254                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1255                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1256                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1257                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1258                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1259             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1260             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1261             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1262             20  PB-CI-MEMBER-NO          PIC X(12).
  1263             20  PB-CI-INT-CODE           PIC X.
  1264                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1265                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1266             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1267             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1268             20  PB-CI-COMP-EXCP-SW       PIC X.
  1269                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1270                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1271             20  PB-CI-ENTRY-STATUS       PIC X.
  1272             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1273             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1274             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1275             20  PB-CI-DEATH-DT           PIC XX.
  1276             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1277             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1278             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1279             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1280             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1281             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1282             20  PB-CI-ENTRY-DT              PIC XX.
  1283             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1284             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1285             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1286             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1287             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1288             20  PB-CI-OLD-LOF               PIC XXX.
  1289*            20  PB-CI-LOAN-OFFICER          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  24
* NSRASBL.cbl
  1290             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1291             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1292             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1293             20  PB-CI-INDV-GRP-CD           PIC X.
  1294             20  PB-CI-BENEFICIARY-NAME.
  1295                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1296                 24  FILLER                  PIC X(15).
  1297             20  PB-CI-NOTE-SW               PIC X.
  1298             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1299             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1300             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1301             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1302             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1303             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1304             20  PB-CI-FIRST-NAME            PIC X(10).
  1305             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1306
  1307         16  FILLER                       PIC X(13).
  1308*032306  16  FILLER                       PIC X(27).
  1309*        16  FILLER                       PIC X(46).
  1310
  1311     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1312         16  FILLER                       PIC X(10).
  1313         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1314         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1315         16  PB-M-INSURED-MID-INIT        PIC X.
  1316         16  PB-M-INSURED-AGE             PIC 99.
  1317         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1318         16  PB-M-INSURED-SEX             PIC X.
  1319         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1320         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1321         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1322         16  PB-M-INSURED-CITY-STATE.
  1323             20  PB-M-INSURED-CITY        PIC X(28).
  1324             20  PB-M-INSURED-STATE       PIC XX.
  1325         16  PB-M-INSURED-ZIP-CODE.
  1326             20  PB-M-INSURED-ZIP-PRIME.
  1327                 24  PB-M-INSURED-ZIP-1   PIC X.
  1328                     88  PB-M-CANADIAN-POST-CODE
  1329                                             VALUE 'A' THRU 'Z'.
  1330                 24  FILLER               PIC X(4).
  1331             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1332         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1333                                        PB-M-INSURED-ZIP-CODE.
  1334             20  PM-M-INS-CAN-POST1       PIC XXX.
  1335             20  PM-M-INS-CAN-POST2       PIC XXX.
  1336             20  FILLER                   PIC XXX.
  1337         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1338         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1339         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1340         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1341         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1342         16  PB-M-CRED-BENE-CITYST.
  1343             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1344             20  PB-M-CRED-BENE-STATE     PIC XX.
  1345         16  FILLER                       PIC X(92).
  1346
  1347     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  25
* NSRASBL.cbl
  1348         16  FILLER                       PIC X(10).
  1349         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1350         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1351         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1352         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1353         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1354         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1355         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1356         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1357         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1358         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1359         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1360         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1361         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1362         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1363         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1364         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1365         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1366         16  PB-ACCOUNT-NAME              PIC X(30).
  1367         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1368         16  PB-REFERENCE                 PIC X(12).
  1369         16  PB-B-RECEIVED-DT             PIC XX.
  1370         16  FILLER                       PIC X(234).
  1371
  1372     12  PB-RECORD-STATUS.
  1373         16  PB-CREDIT-SELECT-DT          PIC XX.
  1374         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  1375         16  PB-BILLED-DT                 PIC XX.
  1376         16  PB-BILLING-STATUS            PIC X.
  1377             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1378             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1379             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1380         16  PB-RECORD-BILL               PIC X.
  1381             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1382             88  PB-RECORD-RETURNED           VALUE 'R'.
  1383             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1384             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1385             88  PB-OVERRIDE-AH               VALUE 'A'.
  1386             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1387         16  PB-BATCH-ENTRY               PIC X.
  1388             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1389             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1390             88  PB-REISSUED-CERT             VALUE 'E'.
  1391             88  PB-MONTHLY-CERT              VALUE 'M'.
  1392             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1393             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1394             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1395         16  PB-FORCE-CODE                PIC X.
  1396             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1397             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1398             88  PB-CANCEL-FORCE              VALUE '8'.
  1399             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1400             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1401             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1402             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1403             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1404             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1405             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  26
* NSRASBL.cbl
  1406         16  PB-FATAL-FLAG                PIC X.
  1407             88  PB-FATAL-ERRORS              VALUE 'X'.
  1408         16  PB-FORCE-ER-CD               PIC X.
  1409             88  PB-FORCE-ERRORS              VALUE 'F'.
  1410             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1411         16  PB-WARN-ER-CD                PIC X.
  1412             88  PB-WARNING-ERRORS            VALUE 'W'.
  1413         16  FILLER                       PIC X.
  1414         16  PB-OUT-BAL-CD                PIC X.
  1415             88  PB-OUT-OF-BAL                VALUE 'O'.
  1416         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1417         16  PB-AH-OVERRIDE-L1            PIC X.
  1418         16  PB-INPUT-DT                  PIC XX.
  1419         16  PB-INPUT-BY                  PIC X(4).
  1420         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1421         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1422         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1423         16  PB-LF-EARNING-METHOD         PIC X.
  1424         16  PB-AH-EARNING-METHOD         PIC X.
  1425         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1426         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1427         16  PB-REIN-CD                   PIC XXX.
  1428         16  PB-LF-REFUND-TYPE            PIC X.
  1429         16  PB-AH-REFUND-TYPE            PIC X.
  1430         16  PB-ACCT-EFF-DT               PIC XX.
  1431         16  PB-ACCT-EXP-DT               PIC XX.
  1432         16  PB-COMPANY-ID                PIC X(3).
  1433         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1434         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1435         16  PB-SV-CARRIER                PIC X.
  1436         16  PB-SV-GROUPING               PIC X(6).
  1437         16  PB-SV-STATE                  PIC XX.
  1438         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1439         16  PB-GA-BILLING-INFO.
  1440             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1441                                          PIC XX.
  1442         16  PB-SV-REMIT-TO  REDEFINES
  1443             PB-GA-BILLING-INFO           PIC X(10).
  1444         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1445         16  PB-I-LOAN-OFFICER            PIC X(5).
  1446         16  PB-I-VIN                     PIC X(17).
  1447
  1448         16  FILLER                       PIC X(04).
  1449         16  IMNET-BYPASS-SW              PIC X.
  1450
  1451******************************************************************
  1452*                COMMON EDIT ERRORS                              *
  1453******************************************************************
  1454
  1455     12  PB-COMMON-ERRORS.
  1456         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1457                                           PIC S9(4)     COMP.
  1458
  1459******************************************************************
  1460*                                COPY ERCENDT.
  1461******************************************************************
  1462*                                                                *
  1463*                                                                *
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  27
* NSRASBL.cbl
  1464*                            ERCENDT.                            *
  1465*                            VMOD=2.001                          *
  1466*                                                                *
  1467*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1468*                                                                *
  1469*   FILE TYPE = VSAM,KSDS                                        *
  1470*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1471*                                                                *
  1472*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1473*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1474*                                                                *
  1475*   LOG = NO                                                     *
  1476*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1477******************************************************************
  1478*-----------------------------------------------------------------
  1479*                   C H A N G E   L O G
  1480*
  1481* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1482*-----------------------------------------------------------------
  1483*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1484* EFFECTIVE    NUMBER
  1485*-----------------------------------------------------------------
  1486* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1487*                                WITH OPEN CLAIMS
  1488* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1489* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1490* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1491*-----------------------------------------------------------------
  1492 01  ENDORSEMENT-RECORD.
  1493     12  EN-RECORD-ID                PIC XX.
  1494         88  VALID-EN-ID                VALUE 'EN'.
  1495     12  EN-CONTROL-PRIMARY.
  1496         16  EN-COMPANY-CD           PIC X.
  1497         16  EN-CARRIER              PIC X.
  1498         16  EN-GROUPING             PIC X(6).
  1499         16  EN-STATE                PIC XX.
  1500         16  EN-ACCOUNT              PIC X(10).
  1501         16  EN-CERT-EFF-DT          PIC XX.
  1502         16  EN-CERT-NO.
  1503             20  EN-CERT-PRIME       PIC X(10).
  1504             20  EN-CERT-SFX         PIC X.
  1505         16  EN-REC-TYPE             PIC X.
  1506             88  EN-ISSUE               VALUE 'I'.
  1507             88  EN-CANCELLATION        VALUE 'C'.
  1508         16  EN-SEQ-NO               PIC 9(04) BINARY.
  1509     12  EN-CONTROL-BY-ARCH-NO.
  1510         16  EN-COMPANY-CD-A1              PIC X.
  1511         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  1512     12  EN-LAST-MAINT-DT            PIC XX.
  1513     12  EN-LAST-MAINT-BY            PIC X(4).
  1514     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1515     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  1516     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1517         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  1518         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  1519         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  1520         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  1521         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  28
* NSRASBL.cbl
  1522         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  1523         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  1524         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  1525         16  EN-LF-ORIG-BENCD        PIC XX.
  1526         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  1527         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1528         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1529         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1530         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1531         16  EN-LF-ORIG-EXP-DT       PIC XX.
  1532*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1533         16  EN-ORIG-CRED-BENE       PIC X(25).
  1534         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1535         16  FILLER                  PIC X.
  1536         16  EN-AH-ORIG-BENCD        PIC XX.
  1537         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  1538         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1539         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1540         16  EN-AH-ORIG-EXP-DT       PIC XX.
  1541*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1542*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1543         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1544         16  F                       PIC X(09).
  1545         16  EN-AH-ORIG-CP           PIC 99.
  1546         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  1547         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  1548         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  1549         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  1550         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  1551         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  1552         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  1553         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  1554         16  EN-LF-NEW-BENCD         PIC XX.
  1555         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  1556         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1557         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1558         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1559         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1560         16  EN-LF-NEW-EXP-DT        PIC XX.
  1561         16  EN-NEW-CRED-BENE        PIC X(25).
  1562         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1563         16  FILLER                  PIC X.
  1564         16  EN-AH-NEW-BENCD         PIC XX.
  1565         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  1566         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1567         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1568         16  EN-AH-NEW-EXP-DT        PIC XX.
  1569*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1570*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1571*        16  F                       PIC X(12).
  1572         16  EN-AH-NEW-CP            PIC 99.
  1573         16  EN-SIG-SW               PIC X.
  1574         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1575         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  1576         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  1577         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  1578         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  1579         16  FILLER                  PIC X(33).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  29
* NSRASBL.cbl
  1580     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1581         16  EN-LF-ORIG-REF-DT       PIC XX.
  1582         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1583         16  EN-AH-ORIG-REF-DT       PIC XX.
  1584         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1585         16  EN-LF-NEW-REF-DT        PIC XX.
  1586         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1587         16  EN-AH-NEW-REF-DT        PIC XX.
  1588         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1589         16  EN-FLAG-CERT            PIC X.
  1590         16  EN-INS-LAST-NAME        PIC X(15).
  1591         16  EN-INS-FIRST-NAME       PIC X(10).
  1592         16  EN-INS-MIDDLE-INIT      PIC X.
  1593         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1594         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1595         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1596         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1597         16  FILLER                  PIC X(262).
  1598     12  EN-MONEY-SW             PIC X.
  1599     12  EN-HEALTH-APP           PIC X.
  1600     12  EN-VOUCHER-SW           PIC X.
  1601     12  EN-PAYEE                PIC X(14).
  1602     12  EN-INPUT-DT             PIC XX.
  1603     12  EN-PROCESS-DT           PIC XX.
  1604     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1605     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1606     12  EN-REASON-CODES.
  1607         16  F OCCURS 12.
  1608             20  EN-REASON-CODE  PIC X(4).
  1609     12  EN-TEMPLATE-USED        PIC X(8).
  1610     12  EN-DOCU-TYPE            PIC X.
  1611         88  EN-VERI-DOCU          VALUE 'V'.
  1612         88  EN-GCE-DOCU           VALUE 'G'.
  1613         88  EN-CANC-DOCU          VALUE 'C'.
  1614     12  EN-COMMENTS1            PIC X(13).
  1615     12  EN-COMMENTS2            PIC X(70).
  1616     12  EN-COMM-CHGBK           PIC X.
  1617         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  1618         88  EN-CHG-ACCT           VALUE 'Y'.
  1619     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  1620     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  1621     12  EN-BATCH-NUMBER         PIC X(6).
  1622     12  EN-ACCT-SUMM            PIC X.
  1623     12  EN-CSO-SUMM             PIC X.
  1624     12  FILLER                  PIC X(13).
  1625******************************************************************
  1626*                                COPY ERCMAIL.
  1627******************************************************************
  1628*                                                                *
  1629*                                                                *
  1630*                            ERCMAIL                             *
  1631*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1632*                            VMOD=2.003                          *
  1633*                                                                *
  1634*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1635*                                                                *
  1636*   FILE TYPE = VSAM,KSDS                                        *
  1637*   RECORD SIZE = 374   RECFORM = FIX                            *
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  30
* NSRASBL.cbl
  1638*                                                                *
  1639*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1640*   ALTERNATE PATH    = NOT USED                                 *
  1641*                                                                *
  1642*   LOG = YES                                                    *
  1643*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1644******************************************************************
  1645*                   C H A N G E   L O G
  1646*
  1647* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1648*-----------------------------------------------------------------
  1649*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1650* EFFECTIVE    NUMBER
  1651*-----------------------------------------------------------------
  1652* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1653* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1654* 111108                   PEMA  ADD CRED BENE ADDR2
  1655******************************************************************
  1656
  1657 01  MAILING-DATA.
  1658     12  MA-RECORD-ID                      PIC XX.
  1659         88  VALID-MA-ID                       VALUE 'MA'.
  1660
  1661     12  MA-CONTROL-PRIMARY.
  1662         16  MA-COMPANY-CD                 PIC X.
  1663         16  MA-CARRIER                    PIC X.
  1664         16  MA-GROUPING.
  1665             20  MA-GROUPING-PREFIX        PIC XXX.
  1666             20  MA-GROUPING-PRIME         PIC XXX.
  1667         16  MA-STATE                      PIC XX.
  1668         16  MA-ACCOUNT.
  1669             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1670             20  MA-ACCOUNT-PRIME          PIC X(6).
  1671         16  MA-CERT-EFF-DT                PIC XX.
  1672         16  MA-CERT-NO.
  1673             20  MA-CERT-PRIME             PIC X(10).
  1674             20  MA-CERT-SFX               PIC X.
  1675
  1676     12  FILLER                            PIC XX.
  1677
  1678     12  MA-ACCESS-CONTROL.
  1679         16  MA-SOURCE-SYSTEM              PIC XX.
  1680             88  MA-FROM-CREDIT                VALUE 'CR'.
  1681             88  MA-FROM-VSI                   VALUE 'VS'.
  1682             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1683             88  MA-FROM-OTHER                 VALUE 'OT'.
  1684         16  MA-RECORD-ADD-DT              PIC XX.
  1685         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1686         16  MA-LAST-MAINT-DT              PIC XX.
  1687         16  MA-LAST-MAINT-BY              PIC XXXX.
  1688         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1689
  1690     12  MA-PROFILE-INFO.
  1691         16  MA-QUALIFY-CODE-1             PIC XX.
  1692         16  MA-QUALIFY-CODE-2             PIC XX.
  1693         16  MA-QUALIFY-CODE-3             PIC XX.
  1694         16  MA-QUALIFY-CODE-4             PIC XX.
  1695         16  MA-QUALIFY-CODE-5             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  31
* NSRASBL.cbl
  1696
  1697         16  MA-INSURED-LAST-NAME          PIC X(15).
  1698         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1699         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1700         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1701         16  MA-INSURED-BIRTH-DT           PIC XX.
  1702         16  MA-INSURED-SEX                PIC X.
  1703             88  MA-SEX-MALE                   VALUE 'M'.
  1704             88  MA-SEX-FEMALE                 VALUE 'F'.
  1705         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1706
  1707         16  MA-ADDRESS-CORRECTED          PIC X.
  1708         16  MA-JOINT-BIRTH-DT             PIC XX.
  1709*        16  FILLER                        PIC X(12).
  1710
  1711         16  MA-ADDRESS-LINE-1             PIC X(30).
  1712         16  MA-ADDRESS-LINE-2             PIC X(30).
  1713         16  MA-CITY-STATE.
  1714             20  MA-CITY                   PIC X(28).
  1715             20  MA-ADDR-STATE             PIC XX.
  1716         16  MA-ZIP.
  1717             20  MA-ZIP-CODE.
  1718                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1719                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1720                 24  FILLER                PIC X(4).
  1721             20  MA-ZIP-PLUS4              PIC X(4).
  1722         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1723             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1724             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1725             20  FILLER                    PIC X(3).
  1726
  1727         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1728
  1729         16  FILLER                        PIC XXX.
  1730*        16  FILLER                        PIC X(10).
  1731
  1732     12  MA-CRED-BENE-INFO.
  1733         16  MA-CRED-BENE-NAME                 PIC X(25).
  1734         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1735         16  MA-CRED-BENE-ADDR2                PIC X(30).
  1736         16  MA-CRED-BENE-CTYST.
  1737             20  MA-CRED-BENE-CITY             PIC X(28).
  1738             20  MA-CRED-BENE-STATE            PIC XX.
  1739         16  MA-CRED-BENE-ZIP.
  1740             20  MA-CB-ZIP-CODE.
  1741                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1742                     88  MA-CB-CANADIAN-POST-CODE
  1743                                           VALUE 'A' THRU 'Z'.
  1744                 24  FILLER                    PIC X(4).
  1745             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1746         16  MA-CB-CANADIAN-POSTAL-CODE
  1747                            REDEFINES MA-CRED-BENE-ZIP.
  1748             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1749             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1750             20  FILLER                        PIC X(3).
  1751     12  MA-POST-CARD-MAIL-DATA.
  1752         16  MA-MAIL-DATA OCCURS 7.
  1753             20  MA-MAIL-TYPE              PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  32
* NSRASBL.cbl
  1754                 88  MA-12MO-MAILING           VALUE '1'.
  1755                 88  MA-EXP-MAILING            VALUE '2'.
  1756             20  MA-MAIL-STATUS            PIC X.
  1757                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1758                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1759                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1760             20  MA-MAIL-DATE              PIC XX.
  1761     12  FILLER                            PIC XX.
  1762     12  FILLER                            PIC XX.
  1763*    12  FILLER                            PIC X(30).
  1764******************************************************************
  1765*                                COPY ERCCOMP.
  1766******************************************************************
  1767*                                                                *
  1768*                                                                *
  1769*                            ERCCOMP                             *
  1770*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1771*                            VMOD=2.019                          *
  1772*                                                                *
  1773*   ONLINE CREDIT SYSTEM                                         *
  1774*                                                                *
  1775*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1776*                                                                *
  1777*   FILE TYPE = VSAM,KSDS                                        *
  1778*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1779*                                                                *
  1780*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1781*       ALTERNATE PATH = NONE                                    *
  1782*                                                                *
  1783*   LOG = NO                                                     *
  1784*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1785*                                                                *
  1786******************************************************************
  1787*                   C H A N G E   L O G
  1788*
  1789* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1790*-----------------------------------------------------------------
  1791*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1792* EFFECTIVE    NUMBER
  1793*-----------------------------------------------------------------
  1794* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1795* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1796* 092205    2005050300006  PEMA  ADD LEASE FEE
  1797* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1798* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1799* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1800* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1801* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1802* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1803******************************************************************
  1804
  1805 01  COMPENSATION-MASTER.
  1806     12  CO-RECORD-ID                          PIC XX.
  1807         88  VALID-CO-ID                          VALUE 'CO'.
  1808
  1809     12  CO-CONTROL-PRIMARY.
  1810         16  CO-COMPANY-CD                     PIC X.
  1811         16  CO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  33
* NSRASBL.cbl
  1812             20  CO-CTL-1.
  1813                 24  CO-CARR-GROUP.
  1814                     28  CO-CARRIER            PIC X.
  1815                     28  CO-GROUPING.
  1816                         32  CO-GROUP-PREFIX   PIC XXX.
  1817                         32  CO-GROUP-PRIME    PIC XXX.
  1818                 24  CO-RESP-NO.
  1819                     28  CO-RESP-PREFIX        PIC X(4).
  1820                     28  CO-RESP-PRIME         PIC X(6).
  1821             20  CO-CTL-2.
  1822                 24  CO-ACCOUNT.
  1823                     28  CO-ACCT-PREFIX        PIC X(4).
  1824                     28  CO-ACCT-PRIME         PIC X(6).
  1825         16  CO-TYPE                           PIC X.
  1826             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1827             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1828             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1829
  1830     12  CO-MAINT-INFORMATION.
  1831         16  CO-LAST-MAINT-DT                  PIC XX.
  1832         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1833         16  CO-LAST-MAINT-USER                PIC X(4).
  1834     12  FILLER                                PIC XX.
  1835     12  CO-STMT-TYPE                          PIC XXX.
  1836     12  CO-COMP-TYPE                          PIC X.
  1837         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1838     12  CO-STMT-OWNER                         PIC X(4).
  1839     12  CO-BALANCE-CONTROL                    PIC X.
  1840         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1841         88  CO-NO-BALANCE                        VALUE 'N'.
  1842
  1843     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1844         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1845         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1846         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1847
  1848     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1849         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1850         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1851
  1852     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1853     12  CO-GA-DIRECT-DEP                      PIC X.
  1854     12  CO-FUTURE-SPACE                       PIC X.
  1855         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1856
  1857     12  CO-ACCT-NAME                          PIC X(30).
  1858     12  CO-MAIL-NAME                          PIC X(30).
  1859     12  CO-ADDR-1                             PIC X(30).
  1860     12  CO-ADDR-2                             PIC X(30).
  1861     12  CO-ADDR-3.
  1862         16  CO-ADDR-CITY                      PIC X(27).
  1863         16  CO-ADDR-STATE                     PIC XX.
  1864     12  CO-CSO-1099                           PIC X.
  1865     12  CO-ZIP.
  1866         16  CO-ZIP-PRIME.
  1867             20  CO-ZIP-PRI-1ST                PIC X.
  1868                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1869             20  FILLER                        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  34
* NSRASBL.cbl
  1870         16  CO-ZIP-PLUS4                      PIC X(4).
  1871     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1872         16  CO-CAN-POSTAL-1                   PIC XXX.
  1873         16  CO-CAN-POSTAL-2                   PIC XXX.
  1874         16  FILLER                            PIC XXX.
  1875     12  CO-SOC-SEC                            PIC X(13).
  1876     12  CO-TELEPHONE.
  1877         16  CO-AREA-CODE                      PIC XXX.
  1878         16  CO-PREFIX                         PIC XXX.
  1879         16  CO-PHONE                          PIC X(4).
  1880
  1881     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1882
  1883     12  CO-AR-BAL-LEVEL                       PIC X.
  1884         88  CO-AR-REF-LVL                        VALUE '1'.
  1885         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1886         88  CO-AR-BILL-LVL                       VALUE '2'.
  1887         88  CO-AR-AGT-LVL                        VALUE '3'.
  1888         88  CO-AR-FR-LVL                         VALUE '4'.
  1889
  1890     12  CO-AR-NORMAL-PRINT                    PIC X.
  1891         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1892         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1893
  1894     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1895
  1896     12  CO-AR-REPORTING                       PIC X.
  1897         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1898         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1899
  1900     12  CO-AR-PULL-CHECK                      PIC X.
  1901         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1902         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1903
  1904     12  CO-AR-BALANCE-PRINT                   PIC X.
  1905         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1906
  1907     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1908         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1909         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1910         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1911
  1912     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1913
  1914     12  CO-USER-CODE                          PIC X.
  1915     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1916
  1917******************************************************************
  1918*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1919*    THE LAST MONTH END RUN.
  1920******************************************************************
  1921
  1922     12  CO-LAST-ACTIVITY-DATE.
  1923         16  CO-ACT-YEAR                       PIC 99.
  1924         16  CO-ACT-MONTH                      PIC 99.
  1925         16  CO-ACT-DAY                        PIC 99.
  1926
  1927     12  CO-LAST-STMT-DT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  35
* NSRASBL.cbl
  1928         16  CO-LAST-STMT-YEAR                 PIC 99.
  1929         16  CO-LAST-STMT-MONTH                PIC 99.
  1930         16  CO-LAST-STMT-DAY                  PIC 99.
  1931
  1932     12  CO-MO-END-TOTALS.
  1933         16  CO-MONTHLY-TOTALS.
  1934             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1935             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1936             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1937             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1938             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1939
  1940         16  CO-AGING-TOTALS.
  1941             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1942             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1943             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1944             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1945
  1946         16  CO-YTD-TOTALS.
  1947             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1948             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1949
  1950         16  CO-OVER-UNDER-TOTALS.
  1951             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1952             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1953
  1954     12  CO-MISCELLANEOUS-TOTALS.
  1955         16  CO-FICA-TOTALS.
  1956             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1957             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1958
  1959         16  CO-CLAIM-TOTALS.
  1960             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1961             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1962
  1963******************************************************************
  1964*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1965*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1966******************************************************************
  1967
  1968     12  CO-CURRENT-TOTALS.
  1969         16  CO-CURRENT-LAST-STMT-DT.
  1970             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1971             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1972             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1973
  1974         16  CO-CURRENT-MONTHLY-TOTALS.
  1975             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1976             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1977             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1978             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1979             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1980
  1981         16  CO-CURRENT-AGING-TOTALS.
  1982             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1983             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1984             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1985             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  36
* NSRASBL.cbl
  1986
  1987         16  CO-CURRENT-YTD-TOTALS.
  1988             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1989             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1990
  1991     12  CO-PAID-COMM-TOTALS.
  1992         16  CO-YTD-PAID-COMMS.
  1993             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1994             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1995
  1996     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1997         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1998         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1999
  2000     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2001         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2002         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2003         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2004         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2005         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2006         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2007         88  CO-FINAL-LETTER                  VALUE 'F'.
  2008         88  CO-RECONCILING                   VALUE 'R'.
  2009         88  CO-PHONE-CALL                    VALUE 'P'.
  2010         88  CO-LEGAL                         VALUE 'L'.
  2011         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2012         88  CO-WRITE-OFF                     VALUE 'W'.
  2013         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2014
  2015     12  CO-CSR-CODE                       PIC X(4).
  2016
  2017     12  CO-GA-STATUS-INFO.
  2018         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2019         16  CO-GA-TERMINATION-DT          PIC XX.
  2020         16  CO-GA-STATUS-CODE             PIC X.
  2021             88  CO-GA-ACTIVE                 VALUE 'A'.
  2022             88  CO-GA-INACTIVE               VALUE 'I'.
  2023             88  CO-GA-PENDING                VALUE 'P'.
  2024         16  CO-GA-COMMENTS.
  2025             20  CO-GA-COMMENT-1           PIC X(40).
  2026             20  CO-GA-COMMENT-2           PIC X(40).
  2027             20  CO-GA-COMMENT-3           PIC X(40).
  2028             20  CO-GA-COMMENT-4           PIC X(40).
  2029
  2030     12  CO-RPTCD2                         PIC X(10).
  2031     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  2032         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2033         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2034
  2035     12  CO-TYPE-AGENT                     PIC X(01).
  2036         88  CO-CORPORATION                   VALUE 'C'.
  2037         88  CO-PARTNERSHIP                   VALUE 'P'.
  2038         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2039         88  CO-TRUST                         VALUE 'T'.
  2040         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2041
  2042     12  CO-FAXNO.
  2043         16  CO-FAX-AREA-CODE                  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  37
* NSRASBL.cbl
  2044         16  CO-FAX-PREFIX                     PIC XXX.
  2045         16  CO-FAX-PHONE                      PIC X(4).
  2046
  2047     12  CO-BANK-INFORMATION.
  2048         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2049         16  CO-BANK-TRANSIT-NON REDEFINES
  2050             CO-BANK-TRANSIT-NO                PIC 9(8).
  2051
  2052         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2053     12  CO-MISC-DEDUCT-INFO REDEFINES
  2054                  CO-BANK-INFORMATION.
  2055         16  CO-MD-GL-ACCT                     PIC X(10).
  2056         16  CO-MD-DIV                         PIC XX.
  2057         16  CO-MD-CENTER                      PIC X(4).
  2058         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2059         16  CO-CREATE-AP-CHECK                PIC X.
  2060         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2061         16  FILLER                            PIC XXX.
  2062     12  CO-ACH-STATUS                         PIC X.
  2063         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2064         88  CO-ACH-PENDING                        VALUE 'P'.
  2065
  2066     12  CO-BILL-SW                            PIC X.
  2067     12  CO-CONTROL-NAME                       PIC X(30).
  2068     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2069     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2070     12  CO-CLP-STATE                          PIC XX.
  2071     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2072     12  CO-SPP-REFUND-EDIT                    PIC X.
  2073
  2074******************************************************************
  2075*                                COPY ELCCERT.
  2076******************************************************************
  2077*                                                                *
  2078*                            ELCCERT.                            *
  2079*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2080*                            VMOD=2.013                          *
  2081*                                                                *
  2082*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2083*                                                                *
  2084*   FILE TYPE = VSAM,KSDS                                        *
  2085*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2086*                                                                *
  2087*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2088*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2089*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2090*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2091*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2092*                                                                *
  2093*   LOG = YES                                                    *
  2094*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2095******************************************************************
  2096*                   C H A N G E   L O G
  2097*
  2098* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2099*-----------------------------------------------------------------
  2100*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2101* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  38
* NSRASBL.cbl
  2102*-----------------------------------------------------------------
  2103* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2104* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2105* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2106* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2107* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2108* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2109* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2110* 032612  CR2011110200001  PEMA  AHL CHANGES
  2111******************************************************************
  2112
  2113 01  CERTIFICATE-MASTER.
  2114     12  CM-RECORD-ID                      PIC XX.
  2115         88  VALID-CM-ID                      VALUE 'CM'.
  2116
  2117     12  CM-CONTROL-PRIMARY.
  2118         16  CM-COMPANY-CD                 PIC X.
  2119         16  CM-CARRIER                    PIC X.
  2120         16  CM-GROUPING.
  2121             20  CM-GROUPING-PREFIX        PIC X(3).
  2122             20  CM-GROUPING-PRIME         PIC X(3).
  2123         16  CM-STATE                      PIC XX.
  2124         16  CM-ACCOUNT.
  2125             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2126             20  CM-ACCOUNT-PRIME          PIC X(6).
  2127         16  CM-CERT-EFF-DT                PIC XX.
  2128         16  CM-CERT-NO.
  2129             20  CM-CERT-PRIME             PIC X(10).
  2130             20  CM-CERT-SFX               PIC X.
  2131
  2132     12  CM-CONTROL-BY-NAME.
  2133         16  CM-COMPANY-CD-A1              PIC X.
  2134         16  CM-INSURED-LAST-NAME          PIC X(15).
  2135         16  CM-INSURED-INITIALS.
  2136             20  CM-INSURED-INITIAL1       PIC X.
  2137             20  CM-INSURED-INITIAL2       PIC X.
  2138
  2139     12  CM-CONTROL-BY-SSN.
  2140         16  CM-COMPANY-CD-A2              PIC X.
  2141         16  CM-SOC-SEC-NO.
  2142             20  CM-SSN-STATE              PIC XX.
  2143             20  CM-SSN-ACCOUNT            PIC X(6).
  2144             20  CM-SSN-LN3.
  2145                 25  CM-INSURED-INITIALS-A2.
  2146                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2147                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2148                 25 CM-PART-LAST-NAME-A2         PIC X.
  2149
  2150     12  CM-CONTROL-BY-CERT-NO.
  2151         16  CM-COMPANY-CD-A4              PIC X.
  2152         16  CM-CERT-NO-A4                 PIC X(11).
  2153
  2154     12  CM-CONTROL-BY-MEMB.
  2155         16  CM-COMPANY-CD-A5              PIC X.
  2156         16  CM-MEMBER-NO.
  2157             20  CM-MEMB-STATE             PIC XX.
  2158             20  CM-MEMB-ACCOUNT           PIC X(6).
  2159             20  CM-MEMB-LN4.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  39
* NSRASBL.cbl
  2160                 25  CM-INSURED-INITIALS-A5.
  2161                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2162                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2163                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2164
  2165     12  CM-INSURED-PROFILE-DATA.
  2166         16  CM-INSURED-FIRST-NAME.
  2167             20  CM-INSURED-1ST-INIT       PIC X.
  2168             20  FILLER                    PIC X(9).
  2169         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2170         16  CM-INSURED-SEX                PIC X.
  2171             88  CM-SEX-MALE                  VALUE 'M'.
  2172             88  CM-SEX-FEMAL                 VALUE 'F'.
  2173         16  CM-INSURED-JOINT-AGE          PIC 99.
  2174         16  CM-JOINT-INSURED-NAME.
  2175             20  CM-JT-LAST-NAME           PIC X(15).
  2176             20  CM-JT-FIRST-NAME.
  2177                 24  CM-JT-1ST-INIT        PIC X.
  2178                 24  FILLER                PIC X(9).
  2179             20  CM-JT-INITIAL             PIC X.
  2180
  2181     12  CM-LIFE-DATA.
  2182         16  CM-LF-BENEFIT-CD              PIC XX.
  2183         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2184         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2185         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2186         16  CM-LF-DEV-CODE                PIC XXX.
  2187         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2188         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2189         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2190         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2191         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2192         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2193         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2194         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2195         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2196         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2197         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2198         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2199         16  FILLER                        PIC XX.
  2200
  2201     12  CM-AH-DATA.
  2202         16  CM-AH-BENEFIT-CD              PIC XX.
  2203         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2204         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2205         16  CM-AH-DEV-CODE                PIC XXX.
  2206         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2207         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2208         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2209         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2210         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2211         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2212         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2213         16  CM-AH-PAID-THRU-DT            PIC XX.
  2214             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2215         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2216         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2217         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  40
* NSRASBL.cbl
  2218         16  FILLER                        PIC X.
  2219
  2220     12  CM-LOAN-INFORMATION.
  2221         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2222         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2223                                           PIC S9(5)V99  COMP-3.
  2224         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2225         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2226         16  CM-PAY-FREQUENCY              PIC S99.
  2227         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2228         16  CM-RATE-CLASS                 PIC XX.
  2229         16  CM-BENEFICIARY                PIC X(25).
  2230         16  CM-POLICY-FORM-NO             PIC X(12).
  2231         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2232         16  CM-LAST-ADD-ON-DT             PIC XX.
  2233         16  CM-DEDUCTIBLE-AMOUNTS.
  2234             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2235             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2236         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2237             20  CM-RESIDENT-STATE         PIC XX.
  2238             20  CM-RATE-CODE              PIC X(4).
  2239             20  FILLER                    PIC XX.
  2240         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2241             20  CM-LOAN-OFFICER           PIC X(5).
  2242             20  FILLER                    PIC XXX.
  2243         16  CM-CSR-CODE                   PIC XXX.
  2244         16  CM-UNDERWRITING-CODE          PIC X.
  2245             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2246         16  CM-POST-CARD-IND              PIC X.
  2247         16  CM-NH-INTERFACE-SW            PIC X.
  2248         16  CM-PREMIUM-TYPE               PIC X.
  2249             88  CM-SING-PRM                  VALUE '1'.
  2250             88  CM-O-B-COVERAGE              VALUE '2'.
  2251             88  CM-OPEN-END                  VALUE '3'.
  2252         16  CM-IND-GRP-TYPE               PIC X.
  2253             88  CM-INDIVIDUAL                VALUE 'I'.
  2254             88  CM-GROUP                     VALUE 'G'.
  2255         16  CM-SKIP-CODE                  PIC X.
  2256             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2257             88  SKIP-JULY                    VALUE '1'.
  2258             88  SKIP-AUGUST                  VALUE '2'.
  2259             88  SKIP-SEPTEMBER               VALUE '3'.
  2260             88  SKIP-JULY-AUG                VALUE '4'.
  2261             88  SKIP-AUG-SEPT                VALUE '5'.
  2262             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2263             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2264             88  SKIP-JUNE                    VALUE '8'.
  2265             88  SKIP-JUNE-JULY               VALUE '9'.
  2266             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2267             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2268         16  CM-PAYMENT-MODE               PIC X.
  2269             88  PAY-MONTHLY                  VALUE SPACE.
  2270             88  PAY-WEEKLY                   VALUE '1'.
  2271             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2272             88  PAY-BI-WEEKLY                VALUE '3'.
  2273             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2274         16  CM-LOAN-NUMBER                PIC X(8).
  2275         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  41
* NSRASBL.cbl
  2276         16  CM-OLD-LOF                    PIC XXX.
  2277*        16  CM-LOAN-OFFICER               PIC XXX.
  2278         16  CM-REIN-TABLE                 PIC XXX.
  2279         16  CM-SPECIAL-REIN-CODE          PIC X.
  2280         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2281         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2282         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2283
  2284     12  CM-STATUS-DATA.
  2285         16  CM-ENTRY-STATUS               PIC X.
  2286         16  CM-ENTRY-DT                   PIC XX.
  2287
  2288         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2289         16  CM-LF-CANCEL-DT               PIC XX.
  2290         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2291
  2292         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2293         16  CM-LF-DEATH-DT                PIC XX.
  2294         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2295
  2296         16  CM-LF-CURRENT-STATUS          PIC X.
  2297             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2298                                                'M' '4' '5' '9'.
  2299             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2300             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2301             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2302             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2303             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2304             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2305             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2306             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2307             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2308             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2309             88  CM-LF-DECLINED               VALUE 'D'.
  2310             88  CM-LF-VOIDED                 VALUE 'V'.
  2311
  2312         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2313         16  CM-AH-CANCEL-DT               PIC XX.
  2314         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2315
  2316         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2317         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2318         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2319
  2320         16  CM-AH-CURRENT-STATUS          PIC X.
  2321             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2322                                                'M' '4' '5' '9'.
  2323             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2324             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2325             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2326             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2327             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2328             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2329             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2330             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2331             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2332             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2333             88  CM-AH-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  42
* NSRASBL.cbl
  2334             88  CM-AH-VOIDED                 VALUE 'V'.
  2335
  2336         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2337             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2338             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2339             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2340         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2341
  2342         16  CM-ENTRY-BATCH                PIC X(6).
  2343         16  CM-LF-EXIT-BATCH              PIC X(6).
  2344         16  CM-AH-EXIT-BATCH              PIC X(6).
  2345         16  CM-LAST-MONTH-END             PIC XX.
  2346
  2347     12  CM-NOTE-SW                        PIC X.
  2348         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2349         88  CERT-NOTES-PRESENT               VALUE '1'.
  2350         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2351         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2352         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2353         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2354         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2355         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2356     12  CM-COMP-EXCP-SW                   PIC X.
  2357         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2358         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2359     12  CM-INSURED-ADDRESS-SW             PIC X.
  2360         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2361         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2362
  2363*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2364     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2365     12  FILLER                            PIC X.
  2366
  2367*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2368     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2369     12  FILLER                            PIC X.
  2370*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2371     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2372
  2373     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2374         88  CERT-ADDED-BATCH                 VALUE ' '.
  2375         88  CERT-ADDED-ONLINE                VALUE '1'.
  2376         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2377         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2378         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2379     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2380         88  CERT-AS-LOADED                   VALUE ' '.
  2381         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2382         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2383         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2384         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2385         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2386         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2387         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2388
  2389     12  CM-ACCOUNT-COMM-PCTS.
  2390         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2391         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  43
* NSRASBL.cbl
  2392
  2393     12  CM-USER-FIELD                     PIC X.
  2394     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2395     12  CM-CLP-STATE                      PIC XX.
  2396     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2397     12  CM-USER-RESERVED                  PIC XXX.
  2398     12  FILLER REDEFINES CM-USER-RESERVED.
  2399         16  CM-AH-CLASS-CD                PIC XX.
  2400         16  F                             PIC X.
  2401******************************************************************
  2402*                                COPY ELCCRTO.
  2403******************************************************************
  2404*                                                                *
  2405*                            ELCCRTO.                            *
  2406*                                                                *
  2407*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2408*                                                                *
  2409*   FILE TYPE = VSAM,KSDS                                        *
  2410*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2411*                                                                *
  2412*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2413*                                                                *
  2414*   LOG = YES                                                    *
  2415*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2416******************************************************************
  2417*                   C H A N G E   L O G
  2418*
  2419* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2420*-----------------------------------------------------------------
  2421*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2422* EFFECTIVE    NUMBER
  2423*-----------------------------------------------------------------
  2424* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2425* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2426* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2427* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2428* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2429******************************************************************
  2430 01  ORIGINAL-CERTIFICATE.
  2431     12  OC-RECORD-ID                      PIC XX.
  2432         88  VALID-OC-ID                      VALUE 'OC'.
  2433     12  OC-CONTROL-PRIMARY.
  2434         16  OC-COMPANY-CD                 PIC X.
  2435         16  OC-CARRIER                    PIC X.
  2436         16  OC-GROUPING                   PIC X(6).
  2437         16  OC-STATE                      PIC XX.
  2438         16  OC-ACCOUNT                    PIC X(10).
  2439         16  OC-CERT-EFF-DT                PIC XX.
  2440         16  OC-CERT-NO.
  2441             20  OC-CERT-PRIME             PIC X(10).
  2442             20  OC-CERT-SFX               PIC X.
  2443         16  OC-RECORD-TYPE                PIC X.
  2444         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2445     12  OC-LAST-MAINT-DT                  PIC XX.
  2446     12  OC-LAST-MAINT-BY                  PIC X(4).
  2447     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2448     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2449     12  FILLER                            PIC X(49).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  44
* NSRASBL.cbl
  2450     12  OC-ORIG-REC.
  2451         16  OC-INS-LAST-NAME              PIC X(15).
  2452         16  OC-INS-FIRST-NAME             PIC X(10).
  2453         16  OC-INS-MIDDLE-INIT            PIC X.
  2454         16  OC-INS-AGE                    PIC S999     COMP-3.
  2455         16  OC-JNT-LAST-NAME              PIC X(15).
  2456         16  OC-JNT-FIRST-NAME             PIC X(10).
  2457         16  OC-JNT-MIDDLE-INIT            PIC X.
  2458         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2459         16  OC-LF-BENCD                   PIC XX.
  2460         16  OC-LF-TERM                    PIC S999      COMP-3.
  2461         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2462         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2463         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2464         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2465         16  OC-LF-EXP-DT                  PIC XX.
  2466         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2467         16  OC-LF-CANCEL-DT               PIC XX.
  2468         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2469         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2470         16  OC-AH-BENCD                   PIC XX.
  2471         16  OC-AH-TERM                    PIC S999      COMP-3.
  2472         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2473         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2474         16  OC-AH-EXP-DT                  PIC XX.
  2475         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2476         16  OC-AH-CP                      PIC 99.
  2477         16  OC-AH-CANCEL-DT               PIC XX.
  2478         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2479         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2480         16  OC-CRED-BENE-NAME             PIC X(25).
  2481         16  OC-1ST-PMT-DT                 PIC XX.
  2482         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  2483         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  2484         16  OC-ISSUE-TRAN-IND             PIC X.
  2485         16  OC-CANCEL-TRAN-IND            PIC X.
  2486         16  FILLER                        PIC X(211).
  2487
  2488     12  FILLER                            PIC X(50).
  2489******************************************************************
  2490*                                COPY ERCACCT.
  2491******************************************************************
  2492*                                                                *
  2493*                                                                *
  2494*                            ERCACCT                             *
  2495*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2496*                            VMOD=2.031                          *
  2497*                                                                *
  2498*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2499*                                                                *
  2500*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2501*   VSAM ACCOUNT MASTER FILES.                                   *
  2502*                                                                *
  2503*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2504*                                                                *
  2505*   FILE TYPE = VSAM,KSDS                                        *
  2506*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2507*                                                                *
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  45
* NSRASBL.cbl
  2508*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2509*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2510*                                                                *
  2511*   LOG = NO                                                     *
  2512*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2513*                                                                *
  2514*                                                                *
  2515******************************************************************
  2516*                   C H A N G E   L O G
  2517*
  2518* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2519*-----------------------------------------------------------------
  2520*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2521* EFFECTIVE    NUMBER
  2522*-----------------------------------------------------------------
  2523* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2524* 092705    2005050300006  PEMA  ADD SPP LEASES
  2525* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2526* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2527* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2528* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2529* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2530******************************************************************
  2531
  2532 01  ACCOUNT-MASTER.
  2533     12  AM-RECORD-ID                      PIC XX.
  2534         88  VALID-AM-ID                      VALUE 'AM'.
  2535
  2536     12  AM-CONTROL-PRIMARY.
  2537         16  AM-COMPANY-CD                 PIC X.
  2538         16  AM-MSTR-CNTRL.
  2539             20  AM-CONTROL-A.
  2540                 24  AM-CARRIER            PIC X.
  2541                 24  AM-GROUPING.
  2542                     28 AM-GROUPING-PREFIX PIC XXX.
  2543                     28 AM-GROUPING-PRIME  PIC XXX.
  2544                 24  AM-STATE              PIC XX.
  2545                 24  AM-ACCOUNT.
  2546                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2547                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2548             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2549                                           PIC X(19).
  2550             20  AM-CNTRL-B.
  2551                 24  AM-EXPIRATION-DT      PIC XX.
  2552                 24  FILLER                PIC X(4).
  2553             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2554                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2555
  2556     12  AM-CONTROL-BY-VAR-GRP.
  2557         16  AM-COMPANY-CD-A1              PIC X.
  2558         16  AM-VG-CARRIER                 PIC X.
  2559         16  AM-VG-GROUPING                PIC X(6).
  2560         16  AM-VG-STATE                   PIC XX.
  2561         16  AM-VG-ACCOUNT                 PIC X(10).
  2562         16  AM-VG-DATE.
  2563             20  AM-VG-EXPIRATION-DT       PIC XX.
  2564             20  FILLER                    PIC X(4).
  2565         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  46
* NSRASBL.cbl
  2566                                           PIC 9(11)      COMP-3.
  2567     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2568         16  FILLER                        PIC X(10).
  2569         16  AM-VG-KEY3.
  2570             20  AM-VG3-ACCOUNT            PIC X(10).
  2571             20  AM-VG3-EXP-DT             PIC XX.
  2572         16  FILLER                        PIC X(4).
  2573     12  AM-MAINT-INFORMATION.
  2574         16  AM-LAST-MAINT-DT              PIC XX.
  2575         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2576         16  AM-LAST-MAINT-USER            PIC X(4).
  2577         16  FILLER                        PIC XX.
  2578
  2579     12  AM-EFFECTIVE-DT                   PIC XX.
  2580     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2581
  2582     12  AM-PREV-DATES  COMP-3.
  2583         16  AM-PREV-EXP-DT                PIC 9(11).
  2584         16  AM-PREV-EFF-DT                PIC 9(11).
  2585
  2586     12  AM-REPORT-CODE-1                  PIC X(10).
  2587     12  AM-REPORT-CODE-2                  PIC X(10).
  2588
  2589     12  AM-CITY-CODE                      PIC X(4).
  2590     12  AM-COUNTY-PARISH                  PIC X(6).
  2591
  2592     12  AM-NAME                           PIC X(30).
  2593     12  AM-PERSON                         PIC X(30).
  2594     12  AM-ADDRS                          PIC X(30).
  2595     12  AM-CITY.
  2596         16  AM-ADDR-CITY                  PIC X(28).
  2597         16  AM-ADDR-STATE                 PIC XX.
  2598     12  AM-ZIP.
  2599         16  AM-ZIP-PRIME.
  2600             20  AM-ZIP-PRI-1ST            PIC X.
  2601                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2602             20  FILLER                    PIC X(4).
  2603         16  AM-ZIP-PLUS4                  PIC X(4).
  2604     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2605         16  AM-CAN-POSTAL-1               PIC XXX.
  2606         16  AM-CAN-POSTAL-2               PIC XXX.
  2607         16  FILLER                        PIC XXX.
  2608     12  AM-TEL-NO.
  2609         16  AM-AREA-CODE                  PIC 999.
  2610         16  AM-TEL-PRE                    PIC 999.
  2611         16  AM-TEL-NBR                    PIC 9(4).
  2612     12  AM-TEL-LOC                        PIC X.
  2613         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2614         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2615
  2616     12  AM-COMM-STRUCTURE.
  2617         16  AM-DEFN-1.
  2618             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2619                 24  AM-AGT.
  2620                     28  AM-AGT-PREFIX     PIC X(4).
  2621                     28  AM-AGT-PRIME      PIC X(6).
  2622                 24  AM-COM-TYP            PIC X.
  2623                 24  AM-L-COM              PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  47
* NSRASBL.cbl
  2624                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2625                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2626                 24  AM-RECALC-LV-INDIC    PIC X.
  2627                 24  AM-RETRO-LV-INDIC     PIC X.
  2628                 24  AM-GL-CODES           PIC X.
  2629                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2630                 24  FILLER                PIC X(01).
  2631         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2632             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2633                 24  FILLER                PIC X(11).
  2634                 24  AM-L-COMA             PIC XXX.
  2635                 24  AM-J-COMA             PIC XXX.
  2636                 24  AM-A-COMA             PIC XXX.
  2637                 24  FILLER                PIC X(6).
  2638
  2639     12  AM-COMM-CHANGE-STATUS             PIC X.
  2640         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2641
  2642     12  AM-CSR-CODE                       PIC X(4).
  2643
  2644     12  AM-BILLING-STATUS                 PIC X.
  2645         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2646         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2647     12  AM-AUTO-REFUND-SW                 PIC X.
  2648         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2649         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2650     12  AM-GPCD                           PIC 99.
  2651     12  AM-IG                             PIC X.
  2652         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2653         88  AM-HAS-GROUP                     VALUE '2'.
  2654     12  AM-STATUS                         PIC X.
  2655         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2656         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2657         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2658         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2659         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2660         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2661     12  AM-REMIT-TO                       PIC 99.
  2662     12  AM-ID-NO                          PIC X(11).
  2663
  2664     12  AM-CAL-TABLE                      PIC XX.
  2665     12  AM-LF-DEVIATION                   PIC XXX.
  2666     12  AM-AH-DEVIATION                   PIC XXX.
  2667     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2668     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2669     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2670     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2671     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2672     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2673
  2674     12  AM-USER-FIELDS.
  2675         16  AM-FLD-1                      PIC XX.
  2676         16  AM-FLD-2                      PIC XX.
  2677         16  AM-FLD-3                      PIC XX.
  2678         16  AM-FLD-4                      PIC XX.
  2679         16  AM-FLD-5                      PIC XX.
  2680
  2681     12  AM-1ST-PROD-DATE.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  48
* NSRASBL.cbl
  2682         16  AM-1ST-PROD-YR                PIC XX.
  2683         16  AM-1ST-PROD-MO                PIC XX.
  2684         16  AM-1ST-PROD-DA                PIC XX.
  2685     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2686     12  AM-CERTS-PURGED-DATE.
  2687         16  AM-PUR-YR                     PIC XX.
  2688         16  AM-PUR-MO                     PIC XX.
  2689         16  AM-PUR-DA                     PIC XX.
  2690     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2691     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2692     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2693     12  AM-INACTIVE-DATE.
  2694         16  AM-INA-MO                     PIC 99.
  2695         16  AM-INA-DA                     PIC 99.
  2696         16  AM-INA-YR                     PIC 99.
  2697     12  AM-AR-HI-CERT-DATE                PIC XX.
  2698
  2699     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2700     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2701
  2702     12  AM-OB-PAYMENT-MODE                PIC X.
  2703         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2704         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2705         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2706         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2707
  2708     12  AM-AH-ONLY-INDICATOR              PIC X.
  2709         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2710         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2711
  2712     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2713
  2714     12  AM-OVER-SHORT.
  2715         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2716         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2717
  2718     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2719     12  AM-DCC-CLP-STATE                  PIC XX.
  2720
  2721     12  AM-RECALC-COMM                    PIC X.
  2722     12  AM-RECALC-REIN                    PIC X.
  2723
  2724     12  AM-REI-TABLE                      PIC XXX.
  2725     12  AM-REI-ET-LF                      PIC X.
  2726     12  AM-REI-ET-AH                      PIC X.
  2727     12  AM-REI-PE-LF                      PIC X.
  2728     12  AM-REI-PE-AH                      PIC X.
  2729     12  AM-REI-PRT-ST                     PIC X.
  2730     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2731     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2732     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2733     12  AM-REI-GROUP-A                    PIC X(6).
  2734     12  AM-REI-MORT                       PIC X(4).
  2735     12  AM-REI-PRT-OW                     PIC X.
  2736     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2737     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2738     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2739     12  AM-REI-GROUP-B                    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  49
* NSRASBL.cbl
  2740
  2741     12  AM-TRUST-TYPE                     PIC X(2).
  2742
  2743     12  AM-EMPLOYER-STMT-USED             PIC X.
  2744     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2745
  2746     12  AM-STD-AH-TYPE                    PIC XX.
  2747     12  AM-EARN-METHODS.
  2748         16  AM-EARN-METHOD-R              PIC X.
  2749             88 AM-REF-RL-R78                 VALUE 'R'.
  2750             88 AM-REF-RL-PR                  VALUE 'P'.
  2751             88 AM-REF-RL-MEAN                VALUE 'M'.
  2752             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2753         16  AM-EARN-METHOD-L              PIC X.
  2754             88 AM-REF-LL-R78                 VALUE 'R'.
  2755             88 AM-REF-LL-PR                  VALUE 'P'.
  2756             88 AM-REF-LL-MEAN                VALUE 'M'.
  2757             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2758         16  AM-EARN-METHOD-A              PIC X.
  2759             88 AM-REF-AH-R78                 VALUE 'R'.
  2760             88 AM-REF-AH-PR                  VALUE 'P'.
  2761             88 AM-REF-AH-MEAN                VALUE 'M'.
  2762             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2763             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2764             88 AM-REF-AH-NET                 VALUE 'N'.
  2765
  2766     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2767     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2768     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2769
  2770     12  AM-RET-Y-N                        PIC X.
  2771     12  AM-RET-P-E                        PIC X.
  2772     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2773     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2774     12  AM-RET-GRP                        PIC X(6).
  2775     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2776         16  AM-POOL-PRIME                 PIC XXX.
  2777         16  AM-POOL-SUB                   PIC XXX.
  2778     12  AM-RETRO-EARNINGS.
  2779         16  AM-RET-EARN-R                 PIC X.
  2780         16  AM-RET-EARN-L                 PIC X.
  2781         16  AM-RET-EARN-A                 PIC X.
  2782     12  AM-RET-ST-TAX-USE                 PIC X.
  2783         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2784         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2785     12  AM-RETRO-BEG-EARNINGS.
  2786         16  AM-RET-BEG-EARN-R             PIC X.
  2787         16  AM-RET-BEG-EARN-L             PIC X.
  2788         16  AM-RET-BEG-EARN-A             PIC X.
  2789     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2790     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2791
  2792     12  AM-USER-SELECT-OPTIONS.
  2793         16  AM-USER-SELECT-1              PIC X(10).
  2794         16  AM-USER-SELECT-2              PIC X(10).
  2795         16  AM-USER-SELECT-3              PIC X(10).
  2796         16  AM-USER-SELECT-4              PIC X(10).
  2797         16  AM-USER-SELECT-5              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  50
* NSRASBL.cbl
  2798
  2799     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2800
  2801     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2802
  2803     12  AM-RPT045A-SWITCH                 PIC X.
  2804         88  RPT045A-OFF                   VALUE 'N'.
  2805
  2806     12  AM-INSURANCE-LIMITS.
  2807         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2808         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2809
  2810     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2811         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2812
  2813     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2814         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2815         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2816
  2817     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2818
  2819     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2820     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2821     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2822     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2823     12  AM-DCC-UEF-STATE                  PIC XX.
  2824     12  FILLER                            PIC XXX.
  2825     12  AM-REPORT-CODE-3                  PIC X(10).
  2826*    12  FILLER                            PIC X(22).
  2827
  2828     12  AM-RESERVE-DATE.
  2829         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2830         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2831         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2832
  2833     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2834     12  AM-NOTIFICATION-TYPES.
  2835         16  AM-NOTIF-OF-LETTERS           PIC X.
  2836         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2837         16  AM-NOTIF-OF-REPORTS           PIC X.
  2838         16  AM-NOTIF-OF-STATUS            PIC X.
  2839
  2840     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2841         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2842         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2843         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2844         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2845
  2846     12  AM-BENEFIT-CONTROLS.
  2847         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2848             20  AM-BENEFIT-CODE           PIC XX.
  2849             20  AM-BENEFIT-TYPE           PIC X.
  2850             20  AM-BENEFIT-REVISION       PIC XXX.
  2851             20  AM-BENEFIT-REM-TERM       PIC X.
  2852             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2853             20  FILLER                    PIC XX.
  2854         16  FILLER                        PIC X(80).
  2855
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  51
* NSRASBL.cbl
  2856     12  AM-TRANSFER-DATA.
  2857         16  AM-TRANSFERRED-FROM.
  2858             20  AM-TRNFROM-CARRIER        PIC X.
  2859             20  AM-TRNFROM-GROUPING.
  2860                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2861                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2862             20  AM-TRNFROM-STATE          PIC XX.
  2863             20  AM-TRNFROM-ACCOUNT.
  2864                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2865                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2866             20  AM-TRNFROM-DTE            PIC XX.
  2867         16  AM-TRANSFERRED-TO.
  2868             20  AM-TRNTO-CARRIER          PIC X.
  2869             20  AM-TRNTO-GROUPING.
  2870                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2871                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2872             20  AM-TRNTO-STATE            PIC XX.
  2873             20  AM-TRNTO-ACCOUNT.
  2874                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2875                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2876             20  AM-TRNTO-DTE              PIC XX.
  2877         16  FILLER                        PIC X(10).
  2878
  2879     12  AM-SAVED-REMIT-TO                 PIC 99.
  2880
  2881     12  AM-COMM-STRUCTURE-SAVED.
  2882         16  AM-DEFN-1-SAVED.
  2883             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2884                 24  AM-AGT-SV             PIC X(10).
  2885                 24  AM-COM-TYP-SV         PIC X.
  2886                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2887                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2888                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2889                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2890                 24  FILLER                PIC X.
  2891                 24  AM-GL-CODES-SV        PIC X.
  2892                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2893                 24  FILLER                PIC X.
  2894         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2895             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2896                 24  FILLER                PIC X(11).
  2897                 24  AM-L-COMA-SV          PIC XXX.
  2898                 24  AM-J-COMA-SV          PIC XXX.
  2899                 24  AM-A-COMA-SV          PIC XXX.
  2900                 24  FILLER                PIC X(6).
  2901
  2902     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2903         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2904            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2905            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2906            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2907
  2908     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2909     12  FILLER                            PIC X(120).
  2910
  2911     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2912         16  AM-CONTROL-NAME               PIC X(30).
  2913         16  AM-EXECUTIVE-ONE.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  52
* NSRASBL.cbl
  2914             20  AM-EXEC1-NAME             PIC X(15).
  2915             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2916                                                          COMP-3.
  2917             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2918                                                          COMP-3.
  2919         16  AM-EXECUTIVE-TWO.
  2920             20  AM-EXEC2-NAME             PIC X(15).
  2921             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2922                                                          COMP-3.
  2923             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2924                                                          COMP-3.
  2925
  2926     12  AM-RETRO-ADDITIONAL-DATA.
  2927         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2928         16  AM-RETRO-PREM-P-E             PIC X.
  2929         16  AM-RETRO-CLMS-P-I             PIC X.
  2930         16  AM-RETRO-RET-BRACKET-LF.
  2931             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2932                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2933                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2934             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2935                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2936                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2937             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2938                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2939                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2940         16  AM-RETRO-RET-BRACKET-AH.
  2941             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2942                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2943                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2944                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2945             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2946                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2947                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2948             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2949                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2950                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2951
  2952     12  AM-COMMENTS.
  2953         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2954
  2955     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2956         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2957         16  AM-FLI-BILLING-CODE           PIC X.
  2958         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2959         16  AM-FLI-UNITED-IDENT           PIC X.
  2960         16  AM-FLI-INTEREST-LOST-DATA.
  2961             20  AM-FLI-BANK-NO            PIC X(5).
  2962             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2963             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2964             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2965         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2966             20  AM-FLI-AGT                PIC X(9).
  2967             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2968             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2969         16  FILLER                        PIC X(102).
  2970
  2971     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  53
* NSRASBL.cbl
  2972         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2973             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2974             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2975             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2976             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2977             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2978         16  FILLER                          PIC X(10).
  2979******************************************************************
  2980*                                COPY ELCTEXT.
  2981******************************************************************
  2982*                                                                *
  2983*                                                                *
  2984*                            ELCTEXT.                            *
  2985*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2986*                            VMOD=2.008                          *
  2987*                                                                *
  2988*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2989*                                     FORM LETTERS,              *
  2990*                                     CERT FORM DISPLAY.
  2991*                                                                *
  2992*   FILE TYPE = VSAM,KSDS                                        *
  2993*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2994*                                                                *
  2995*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2996*       ALTERNATE INDEX = NONE                                   *
  2997*                                                                *
  2998*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2999*       ALTERNATE INDEX = NONE                                   *
  3000*                                                                *
  3001*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  3002*       ALTERNATE INDEX = NONE                                   *
  3003*                                                                *
  3004*   LOG = NO                                                     *
  3005*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3006******************************************************************
  3007 01  TEXT-FILES.
  3008     12  TEXT-FILE-ID                PIC XX.
  3009         88  FORMS-FILE-TEXT            VALUE 'TF'.
  3010         88  LETTER-FILE-TEXT           VALUE 'TL'.
  3011         88  HELP-FILE-TEXT             VALUE 'TH'.
  3012
  3013     12  TX-CONTROL-PRIMARY.
  3014         16  TX-COMPANY-CD           PIC X.
  3015             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  3016         16  TX-ACCESS-CD-GENL       PIC X(12).
  3017
  3018         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3019             20  TX-LETTER-NO        PIC X(4).
  3020             20  FILLER              PIC X(8).
  3021
  3022         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3023             20  TX-FORM-NO          PIC X(12).
  3024
  3025         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3026             20  TX-HELP-TYPE        PIC X.
  3027                 88  HELP-FOR-GENERAL   VALUE ' '.
  3028                 88  HELP-BY-SCREEN     VALUE 'S'.
  3029                 88  HELP-BY-ERROR      VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  54
* NSRASBL.cbl
  3030             20  TX-SCREEN-OR-ERROR  PIC X(4).
  3031                 88  GENERAL-INFO-HELP  VALUE '0000'.
  3032             20  TX-HELP-FOR-COMPANY  PIC XXX.
  3033                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  3034             20  FILLER              PIC X(4).
  3035
  3036         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  3037
  3038     12  TX-PROCESS-CONTROL          PIC XX.
  3039         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  3040
  3041     12  TX-TEXT-LINE                PIC X(70).
  3042
  3043     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  3044         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  3045         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  3046         88  TX-VALID-FORM-SQUEEZE-VALUE
  3047                                        VALUE 'Y' ' '.
  3048
  3049     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  3050         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  3051         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  3052         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  3053         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  3054         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  3055         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  3056         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  3057                                              'K' 'N' ' '
  3058                                              'Z'.
  3059
  3060     12  TX-ARCHIVE-SW               PIC X.
  3061         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  3062         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  3063         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  3064
  3065     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  3066     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  3067
  3068     12  TX-BSR-CODE                 PIC X.
  3069         88  TX-BSR-LETTER              VALUE 'B'.
  3070         88  TX-NON-BSR-LETTER          VALUE ' '.
  3071
  3072     12  FILLER                      PIC X.
  3073*****************************************************************
  3074*                                COPY ELCCNTL.
  3075******************************************************************
  3076*                                                                *
  3077*                                                                *
  3078*                            ELCCNTL.                            *
  3079*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3080*                            VMOD=2.059                          *
  3081*                                                                *
  3082*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3083*                                                                *
  3084*   FILE TYPE = VSAM,KSDS                                        *
  3085*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3086*                                                                *
  3087*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  55
* NSRASBL.cbl
  3088*       ALTERNATE INDEX = NONE                                   *
  3089*                                                                *
  3090*   LOG = YES                                                    *
  3091*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3092******************************************************************
  3093*                   C H A N G E   L O G
  3094*
  3095* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3096*-----------------------------------------------------------------
  3097*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3098* EFFECTIVE    NUMBER
  3099*-----------------------------------------------------------------
  3100* 082503                   PEMA  ADD BENEFIT GROUP
  3101* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3102* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3103* 092705    2005050300006  PEMA  ADD SPP LEASES
  3104* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3105* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3106* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3107* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3108* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3109* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3110* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3111* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3112* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3113******************************************************************
  3114*
  3115 01  CONTROL-FILE.
  3116     12  CF-RECORD-ID                       PIC XX.
  3117         88  VALID-CF-ID                        VALUE 'CF'.
  3118
  3119     12  CF-CONTROL-PRIMARY.
  3120         16  CF-COMPANY-ID                  PIC XXX.
  3121         16  CF-RECORD-TYPE                 PIC X.
  3122             88  CF-COMPANY-MASTER              VALUE '1'.
  3123             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3124             88  CF-STATE-MASTER                VALUE '3'.
  3125             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3126             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3127             88  CF-CARRIER-MASTER              VALUE '6'.
  3128             88  CF-MORTALITY-MASTER            VALUE '7'.
  3129             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3130             88  CF-TERMINAL-MASTER             VALUE '9'.
  3131             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3132             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3133             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3134             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3135             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3136             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3137             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3138             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3139             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3140         16  CF-ACCESS-CD-GENL              PIC X(4).
  3141         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3142             20  CF-PROCESSOR               PIC X(4).
  3143         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3144             20  CF-STATE-CODE              PIC XX.
  3145             20  FILLER                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  56
* NSRASBL.cbl
  3146         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3147             20  FILLER                     PIC XX.
  3148             20  CF-HI-BEN-IN-REC           PIC XX.
  3149         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3150             20  FILLER                     PIC XXX.
  3151             20  CF-CARRIER-CNTL            PIC X.
  3152         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3153             20  FILLER                     PIC XX.
  3154             20  CF-HI-TYPE-IN-REC          PIC 99.
  3155         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3156             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3157                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3158             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3159             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3160         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3161             20  FILLER                     PIC X.
  3162             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3163         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3164             20  FILLER                     PIC XX.
  3165             20  CF-MORTGAGE-PLAN           PIC XX.
  3166         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3167
  3168     12  CF-LAST-MAINT-DT                   PIC XX.
  3169     12  CF-LAST-MAINT-BY                   PIC X(4).
  3170     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3171
  3172     12  CF-RECORD-BODY                     PIC X(728).
  3173
  3174
  3175****************************************************************
  3176*             COMPANY MASTER RECORD                            *
  3177****************************************************************
  3178
  3179     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3180         16  CF-COMPANY-ADDRESS.
  3181             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3182             20  CF-CL-IN-CARE-OF           PIC X(30).
  3183             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3184             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3185             20  CF-CL-CITY-STATE           PIC X(30).
  3186             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3187             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3188         16  CF-COMPANY-CD                  PIC X.
  3189         16  CF-COMPANY-PASSWORD            PIC X(8).
  3190         16  CF-SECURITY-OPTION             PIC X.
  3191             88  ALL-SECURITY                   VALUE '1'.
  3192             88  COMPANY-VERIFY                 VALUE '2'.
  3193             88  PROCESSOR-VERIFY               VALUE '3'.
  3194             88  NO-SECURITY                    VALUE '4'.
  3195             88  ALL-BUT-TERM                   VALUE '5'.
  3196         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3197             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3198         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3199             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3200         16  CF-INFORCE-LOCATION            PIC X.
  3201             88  CERTS-ARE-ONLINE               VALUE '1'.
  3202             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3203             88  NO-CERTS-AVAILABLE             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  57
* NSRASBL.cbl
  3204         16  CF-LOWER-CASE-LETTERS          PIC X.
  3205         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3206             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3207             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3208             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3209             88  CF-ACCNT-CNTL                  VALUE '3'.
  3210             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3211
  3212         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3213         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3214
  3215         16  CF-LGX-CREDIT-USER             PIC X.
  3216             88  CO-IS-NOT-USER                 VALUE 'N'.
  3217             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3218
  3219         16 CF-CREDIT-CALC-CODES.
  3220             20  CF-CR-REM-TERM-CALC PIC X.
  3221               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3222               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3223               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3224               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3225               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3226               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3227               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3228             20  CF-CR-R78-METHOD           PIC X.
  3229               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3230               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3231
  3232         16  CF-CLAIM-CONTROL-COUNTS.
  3233             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3234                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3235
  3236             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3237                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3238
  3239             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3240                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3241
  3242             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3243                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3244
  3245         16  CF-CURRENT-MONTH-END           PIC XX.
  3246
  3247         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3248             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3249             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3250             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3251             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3252                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3253                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3254             20  CF-CO-PREM-REJECT-SW       PIC X.
  3255                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3256                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3257             20  CF-CO-REF-REJECT-SW        PIC X.
  3258                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3259                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3260
  3261         16  CF-CO-REPORTING-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  58
* NSRASBL.cbl
  3262         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3263         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3264           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3265           88  CF-CO-MONTH-END                  VALUE '1'.
  3266
  3267         16  CF-LGX-CLAIM-USER              PIC X.
  3268             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3269             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3270
  3271         16  CF-CREDIT-EDIT-CONTROLS.
  3272             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3273             20  CF-MIN-AGE                 PIC 99.
  3274             20  CF-DEFAULT-AGE             PIC 99.
  3275             20  CF-MIN-TERM                PIC S999      COMP-3.
  3276             20  CF-MAX-TERM                PIC S999      COMP-3.
  3277             20  CF-DEFAULT-SEX             PIC X.
  3278             20  CF-JOINT-AGE-INPUT         PIC X.
  3279                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3280             20  CF-BIRTH-DATE-INPUT        PIC X.
  3281                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3282             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3283                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3284                 88  CF-ZERO-CARRIER            VALUE '1'.
  3285                 88  CF-ZERO-GROUPING           VALUE '2'.
  3286                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3287             20  CF-EDIT-SW                 PIC X.
  3288                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3289             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3290             20  CF-CR-PR-METHOD            PIC X.
  3291               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3292               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3293             20  FILLER                     PIC X.
  3294
  3295         16  CF-CREDIT-MISC-CONTROLS.
  3296             20  CF-REIN-TABLE-SW           PIC X.
  3297                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3298             20  CF-COMP-TABLE-SW           PIC X.
  3299                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3300             20  CF-EXPERIENCE-RETENTION-AGE
  3301                                            PIC S9        COMP-3.
  3302             20  CF-CONVERSION-DT           PIC XX.
  3303             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3304             20  CF-RUN-FREQUENCY-SW        PIC X.
  3305                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3306                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3307
  3308             20  CF-CR-CHECK-NO-CONTROL.
  3309                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3310                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3311                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3312                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3313                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3314                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3315
  3316                 24  CF-CR-CHECK-COUNT       REDEFINES
  3317                     CF-CR-CHECK-COUNTER      PIC X(4).
  3318
  3319                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  59
* NSRASBL.cbl
  3320                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3321
  3322                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3323                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3324                 24  CF-MAIL-PROCESSING       PIC X.
  3325                     88  MAIL-PROCESSING          VALUE 'Y'.
  3326
  3327         16  CF-MISC-SYSTEM-CONTROL.
  3328             20  CF-SYSTEM-C                 PIC X.
  3329                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3330             20  CF-SYSTEM-D                 PIC X.
  3331                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3332             20  CF-SOC-SEC-NO-SW            PIC X.
  3333                 88  SOC-SEC-NO-USED             VALUE '1'.
  3334             20  CF-MEMBER-NO-SW             PIC X.
  3335                 88  MEMBER-NO-USED              VALUE '1'.
  3336             20  CF-TAX-ID-NUMBER            PIC X(11).
  3337             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3338             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3339                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3340                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3341                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3342                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3343             20  CF-SYSTEM-E                 PIC X.
  3344                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3345
  3346         16  CF-LGX-LIFE-USER               PIC X.
  3347             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3348             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3349
  3350         16  CF-CR-MONTH-END-DT             PIC XX.
  3351
  3352         16  CF-FILE-MAINT-DATES.
  3353             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3354                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3355             20  CF-LAST-BATCH       REDEFINES
  3356                 CF-LAST-BATCH-NO               PIC X(4).
  3357             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3358             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3359             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3360             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3361             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3362             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3363             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3364             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3365             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3366             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3367
  3368         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3369         16  FILLER                         PIC X.
  3370
  3371         16  CF-ALT-MORT-CODE               PIC X(4).
  3372         16  CF-MEMBER-CAPTION              PIC X(10).
  3373
  3374         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3375             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3376             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3377             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  60
* NSRASBL.cbl
  3378             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3379             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3380
  3381         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3382
  3383         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3384         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3385         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3386         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3387
  3388         16  CF-AH-OVERRIDE-L1              PIC X.
  3389         16  CF-AH-OVERRIDE-L2              PIC XX.
  3390         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3391         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3392
  3393         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3394         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3395
  3396         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3397         16  CF-AR-LAST-EL860-DT            PIC XX.
  3398         16  CF-MP-MONTH-END-DT             PIC XX.
  3399
  3400         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3401         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3402             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3403
  3404         16  CF-AR-MONTH-END-DT             PIC XX.
  3405
  3406         16  CF-CRDTCRD-USER                PIC X.
  3407             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3408             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3409
  3410         16  CF-CC-MONTH-END-DT             PIC XX.
  3411
  3412         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3413
  3414         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3415             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3416             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3417             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3418         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3419         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3420         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3421         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3422             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3423             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3424         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3425         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3426         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3427             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3428         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3429
  3430         16  CF-CL-ZIP-CODE.
  3431             20  CF-CL-ZIP-PRIME.
  3432                 24  CF-CL-ZIP-1ST          PIC X.
  3433                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3434                 24  FILLER                 PIC X(4).
  3435             20  CF-CL-ZIP-PLUS4            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  61
* NSRASBL.cbl
  3436         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3437             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3438             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3439             20  FILLER                     PIC XXX.
  3440
  3441         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3442         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3443         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3444         16  CF-CO-OPTION-START-DATE        PIC XX.
  3445         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3446           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3447                                                      '3' '4'.
  3448           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3449           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3450           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3451           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3452           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3453           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3454
  3455         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3456
  3457         16  CF-PAYMENT-APPROVAL-LEVELS.
  3458             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3459             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3460             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3461             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3462             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3463             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3464
  3465         16  CF-END-USER-REPORTING-USER     PIC X.
  3466             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3467             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3468
  3469         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3470             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3471             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3472
  3473         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3474
  3475         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3476         16  FILLER                         PIC X.
  3477
  3478         16  CF-CREDIT-ARCHIVE-CNTL.
  3479             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3480             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3481             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3482
  3483         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3484
  3485         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3486             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3487             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3488
  3489         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3490             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3491             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3492
  3493         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  62
* NSRASBL.cbl
  3494
  3495         16  CF-CO-ACH-ID-CODE              PIC  X.
  3496             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3497             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3498             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3499         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3500         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3501         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3502         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3503         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3504         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3505         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3506         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3507         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3508                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3509         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3510                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3511
  3512         16  CF-CO-OVER-SHORT.
  3513             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3514             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3515
  3516*         16  FILLER                         PIC X(102).
  3517         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3518             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3519             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3520
  3521         16  CF-AH-APPROVAL-DAYS.
  3522             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3523             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3524             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3525             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3526
  3527         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3528
  3529         16  CF-APPROV-LEV-5.
  3530             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3531             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3532             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3533
  3534         16  FILLER                         PIC X(68).
  3535****************************************************************
  3536*             PROCESSOR/USER RECORD                            *
  3537****************************************************************
  3538
  3539     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3540         16  CF-PROCESSOR-NAME              PIC X(30).
  3541         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3542         16  CF-PROCESSOR-TITLE             PIC X(26).
  3543         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3544                 88  MESSAGE-YES                VALUE 'Y'.
  3545                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3546
  3547*****************************************************
  3548****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3549****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3550****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3551****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  63
* NSRASBL.cbl
  3552*****************************************************
  3553
  3554         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3555             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3556             20  CF-APPLICATION-FORCE       PIC X.
  3557             20  CF-INDIVIDUAL-APP.
  3558                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3559                     28  CF-BROWSE-APP      PIC X.
  3560                     28  CF-UPDATE-APP      PIC X.
  3561
  3562         16  CF-CURRENT-TERM-ON             PIC X(4).
  3563         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3564             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3565             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3566             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3567             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3568             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3569             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3570             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3571         16  CF-PROCESSOR-CARRIER           PIC X.
  3572             88  NO-CARRIER-SECURITY            VALUE ' '.
  3573         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3574             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3575         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3576             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3577         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3578             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3579
  3580         16  CF-PROC-SYS-ACCESS-SW.
  3581             20  CF-PROC-CREDIT-CLAIMS-SW.
  3582                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3583                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3584                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3585                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3586             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3587                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3588                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3589             20  CF-PROC-LIFE-GNRLDGR-SW.
  3590                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3591                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3592                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3593                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3594             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3595                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3596                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3597         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3598             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3599             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3600         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3601
  3602         16  CF-APPROVAL-LEVEL                  PIC X.
  3603             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3604             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3605             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3606             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3607             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3608
  3609         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  64
* NSRASBL.cbl
  3610
  3611         16  CF-LANGUAGE-TYPE                   PIC X.
  3612             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3613             88  CF-LANG-IS-FR                      VALUE 'F'.
  3614
  3615         16  CF-CSR-IND                         PIC X.
  3616         16  FILLER                             PIC X(239).
  3617
  3618****************************************************************
  3619*             PROCESSOR/REMINDERS RECORD                       *
  3620****************************************************************
  3621
  3622     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3623         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3624             20  CF-START-REMIND-DT         PIC XX.
  3625             20  CF-END-REMIND-DT           PIC XX.
  3626             20  CF-REMINDER-TEXT           PIC X(50).
  3627         16  FILLER                         PIC X(296).
  3628
  3629
  3630****************************************************************
  3631*             STATE MASTER RECORD                              *
  3632****************************************************************
  3633
  3634     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3635         16  CF-STATE-ABBREVIATION          PIC XX.
  3636         16  CF-STATE-NAME                  PIC X(25).
  3637         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3638         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3639             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3640             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3641             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3642             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3643                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3644                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3645             20  CF-ST-PREM-REJECT-SW       PIC X.
  3646                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3647                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3648             20  CF-ST-REF-REJECT-SW        PIC X.
  3649                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3650                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3651         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3652         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3653         16  CF-ST-REFUND-RULES.
  3654             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3655             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3656             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3657         16  CF-ST-FST-PMT-EXTENSION.
  3658             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3659             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3660                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3661                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3662                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3663                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3664         16  CF-ST-STATE-CALL.
  3665             20  CF-ST-CALL-UNEARNED        PIC X.
  3666             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3667             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  65
* NSRASBL.cbl
  3668         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3669             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3670             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3671         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3672         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3673         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3674         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3675         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3676         16  FILLER                         PIC X.
  3677         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3678             20  CF-ST-BENEFIT-CD           PIC XX.
  3679             20  CF-ST-BENEFIT-KIND         PIC X.
  3680                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3681                 88  CF-ST-AH-KIND              VALUE 'A'.
  3682             20  CF-ST-REM-TERM-CALC        PIC X.
  3683                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3684                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3685                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3686                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3687                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3688                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3689                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3690                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3691
  3692             20  CF-ST-REFUND-CALC          PIC X.
  3693                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3694                 88  ST-REFD-BY-R78             VALUE '1'.
  3695                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3696                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3697                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3698                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3699                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3700                 88  ST-REFD-UTAH               VALUE '7'.
  3701                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3702                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3703                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3704
  3705             20  CF-ST-EARNING-CALC         PIC X.
  3706                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3707                 88  ST-EARN-BY-R78             VALUE '1'.
  3708                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3709                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3710                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3711                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3712                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3713                 88  ST-EARN-MEAN               VALUE '8'.
  3714                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3715
  3716             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3717                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3718                 88  ST-OVRD-BY-R78             VALUE '1'.
  3719                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3720                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3721                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3722                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3723                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3724                 88  ST-OVRD-MEAN               VALUE '8'.
  3725                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  66
* NSRASBL.cbl
  3726             20  FILLER                     PIC X.
  3727
  3728         16  CF-ST-COMMISSION-CAPS.
  3729             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3730             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3731             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3732             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3733         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3734                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3735
  3736         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3737
  3738         16  CF-ST-STATUTORY-INTEREST.
  3739             20  CF-ST-STAT-DATE-FROM       PIC X.
  3740                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3741                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3742             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3743             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3744             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3745             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3746             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3747
  3748         16  CF-ST-OVER-SHORT.
  3749             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3750             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3751
  3752         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3753
  3754         16  CF-ST-RT-CALC                  PIC X.
  3755
  3756         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3757         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3758         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3759         16  CF-ST-RF-LR-CALC               PIC X.
  3760         16  CF-ST-RF-LL-CALC               PIC X.
  3761         16  CF-ST-RF-LN-CALC               PIC X.
  3762         16  CF-ST-RF-AH-CALC               PIC X.
  3763         16  CF-ST-RF-CP-CALC               PIC X.
  3764*        16  FILLER                         PIC X(206).
  3765*CIDMOD         16  FILLER                         PIC X(192).
  3766         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3767             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3768         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3769         16  CF-ST-VFY-2ND-BENE             PIC X.
  3770         16  CF-ST-CAUSAL-STATE             PIC X.
  3771         16  FILLER                         PIC X(185).
  3772
  3773****************************************************************
  3774*             BENEFIT MASTER RECORD                            *
  3775****************************************************************
  3776
  3777     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3778         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3779             20  CF-BENEFIT-CODE            PIC XX.
  3780             20  CF-BENEFIT-NUMERIC  REDEFINES
  3781                 CF-BENEFIT-CODE            PIC XX.
  3782             20  CF-BENEFIT-ALPHA           PIC XXX.
  3783             20  CF-BENEFIT-DESCRIP         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  67
* NSRASBL.cbl
  3784             20  CF-BENEFIT-COMMENT         PIC X(10).
  3785
  3786             20  CF-LF-COVERAGE-TYPE        PIC X.
  3787                 88  CF-REDUCING                VALUE 'R'.
  3788                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3789
  3790             20  CF-SPECIAL-CALC-CD         PIC X.
  3791                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3792                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3793                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3794                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3795                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3796                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3797                 88  CF-FARM-PLAN               VALUE 'F'.
  3798                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3799                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3800                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3801                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3802                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3803                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3804                 88  CF-PRUDENTIAL              VALUE 'P'.
  3805                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3806                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3807                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3808                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3809                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3810                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3811
  3812             20  CF-JOINT-INDICATOR         PIC X.
  3813                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3814
  3815*            20  FILLER                     PIC X(12).
  3816             20  FILLER                     PIC X(11).
  3817             20  CF-BENEFIT-CATEGORY        PIC X.
  3818             20  CF-LOAN-TYPE               PIC X(8).
  3819
  3820             20  CF-CO-REM-TERM-CALC        PIC X.
  3821                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3822                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3823                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3824                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3825                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3826
  3827             20  CF-CO-EARNINGS-CALC        PIC X.
  3828                 88  CO-EARN-BY-R78             VALUE '1'.
  3829                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3830                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3831                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3832                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3833                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3834                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3835                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3836
  3837             20  CF-CO-REFUND-CALC          PIC X.
  3838                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3839                 88  CO-REFD-BY-R78             VALUE '1'.
  3840                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3841                 88  CO-REFD-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  68
* NSRASBL.cbl
  3842                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3843                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3844                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3845                 88  CO-REFD-MEAN               VALUE '8'.
  3846                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3847                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3848                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3849
  3850             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3851                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3852                 88  CO-OVRD-BY-R78             VALUE '1'.
  3853                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3854                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3855                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3856                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3857                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3858                 88  CO-OVRD-MEAN               VALUE '8'.
  3859                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3860
  3861             20  CF-CO-BEN-I-G-CD           PIC X.
  3862                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3863                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3864                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3865
  3866         16  FILLER                         PIC X(304).
  3867
  3868
  3869****************************************************************
  3870*             CARRIER MASTER RECORD                            *
  3871****************************************************************
  3872
  3873     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3874         16  CF-ADDRESS-DATA.
  3875             20  CF-MAIL-TO-NAME            PIC X(30).
  3876             20  CF-IN-CARE-OF              PIC X(30).
  3877             20  CF-ADDRESS-LINE-1          PIC X(30).
  3878             20  CF-ADDRESS-LINE-2          PIC X(30).
  3879             20  CF-CITY-STATE              PIC X(30).
  3880             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3881             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3882
  3883         16  CF-CLAIM-NO-CONTROL.
  3884             20  CF-CLAIM-NO-METHOD         PIC X.
  3885                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3886                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3887                 88  CLAIM-NO-SEQ               VALUE '3'.
  3888                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3889             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3890                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3891                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3892                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3893
  3894         16  CF-CHECK-NO-CONTROL.
  3895             20  CF-CHECK-NO-METHOD         PIC X.
  3896                 88  CHECK-NO-MANUAL            VALUE '1'.
  3897                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3898                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3899                 88  CHECK-NO-AT-PRINT          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  69
* NSRASBL.cbl
  3900             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3901                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3902
  3903         16  CF-DOMICILE-STATE              PIC XX.
  3904
  3905         16  CF-EXPENSE-CONTROLS.
  3906             20  CF-EXPENSE-METHOD          PIC X.
  3907                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3908                 88  DOLLARS-PER-PMT            VALUE '2'.
  3909                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3910                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3911             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3912             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3913
  3914         16  CF-CORRESPONDENCE-CONTROL.
  3915             20  CF-LETTER-RESEND-OPT       PIC X.
  3916                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3917                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3918             20  FILLER                     PIC X(4).
  3919
  3920         16  CF-RESERVE-CONTROLS.
  3921             20  CF-MANUAL-SW               PIC X.
  3922                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3923             20  CF-FUTURE-SW               PIC X.
  3924                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3925             20  CF-PTC-SW                  PIC X.
  3926                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3927             20  CF-IBNR-SW                 PIC X.
  3928                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3929             20  CF-PTC-LF-SW               PIC X.
  3930                 88  CF-LF-PTC-USED             VALUE '1'.
  3931             20  CF-CDT-ACCESS-METHOD       PIC X.
  3932                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3933                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3934                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3935             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3936
  3937         16  CF-CLAIM-CALC-METHOD           PIC X.
  3938             88  360-PLUS-MONTHS                VALUE '1'.
  3939             88  365-PLUS-MONTHS                VALUE '2'.
  3940             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3941             88  360-DAILY                      VALUE '4'.
  3942             88  365-DAILY                      VALUE '5'.
  3943
  3944         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3945         16  FILLER                         PIC X(11).
  3946
  3947         16  CF-LIMIT-AMOUNTS.
  3948             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3949             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3950             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3951             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3952             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3953             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3954             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3955             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3956             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3957             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  70
* NSRASBL.cbl
  3958
  3959         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3960         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3961         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3962
  3963         16  CF-ZIP-CODE.
  3964             20  CF-ZIP-PRIME.
  3965                 24  CF-ZIP-1ST             PIC X.
  3966                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3967                 24  FILLER                 PIC X(4).
  3968             20  CF-ZIP-PLUS4               PIC X(4).
  3969         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3970             20  CF-CAN-POSTAL-1            PIC XXX.
  3971             20  CF-CAN-POSTAL-2            PIC XXX.
  3972             20  FILLER                     PIC XXX.
  3973
  3974         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3975         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3976         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3977
  3978         16  CF-RATING-SWITCH               PIC X.
  3979             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3980             88  CF-NO-RATING                   VALUE 'N'.
  3981
  3982         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3983
  3984         16  CF-CARRIER-OVER-SHORT.
  3985             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3986             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3987
  3988         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3989         16  CF-SECPAY-SWITCH               PIC X.
  3990             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3991             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3992         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3993         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3994         16  FILLER                         PIC X(444).
  3995*        16  FILLER                         PIC X(452).
  3996
  3997
  3998****************************************************************
  3999*             MORTALITY MASTER RECORD                          *
  4000****************************************************************
  4001
  4002     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4003         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4004                                INDEXED BY CF-MORT-NDX.
  4005             20  CF-MORT-TABLE              PIC X(5).
  4006             20  CF-MORT-TABLE-TYPE         PIC X.
  4007                 88  CF-MORT-JOINT              VALUE 'J'.
  4008                 88  CF-MORT-SINGLE             VALUE 'S'.
  4009                 88  CF-MORT-COMBINED           VALUE 'C'.
  4010                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4011                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4012             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4013             20  CF-MORT-AGE-METHOD         PIC XX.
  4014                 88  CF-AGE-LAST                VALUE 'AL'.
  4015                 88  CF-AGE-NEAR                VALUE 'AN'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  71
* NSRASBL.cbl
  4016             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4017             20  CF-MORT-ADJUSTMENT-DIRECTION
  4018                                            PIC X.
  4019                 88  CF-MINUS                   VALUE '-'.
  4020                 88  CF-PLUS                    VALUE '+'.
  4021             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4022             20  CF-MORT-JOINT-CODE         PIC X.
  4023                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4024             20  CF-MORT-PC-Q               PIC X.
  4025                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4026             20  CF-MORT-TABLE-CODE         PIC X(4).
  4027             20  CF-MORT-COMMENTS           PIC X(15).
  4028             20  FILLER                     PIC X(14).
  4029
  4030         16  FILLER                         PIC X(251).
  4031
  4032
  4033****************************************************************
  4034*             BUSSINESS TYPE MASTER RECORD                     *
  4035****************************************************************
  4036
  4037     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4038* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4039* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4040* AND RECORD 05 IS TYPES 81-99
  4041         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4042             20  CF-BUSINESS-TITLE          PIC  X(19).
  4043             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4044                                            PIC S9V9(4) COMP-3.
  4045             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4046             20  FILLER                     PIC  X.
  4047         16  FILLER                         PIC  X(248).
  4048
  4049
  4050****************************************************************
  4051*             TERMINAL MASTER RECORD                           *
  4052****************************************************************
  4053
  4054     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4055
  4056         16  CF-COMPANY-TERMINALS.
  4057             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4058                                  PIC X(4).
  4059         16  FILLER               PIC X(248).
  4060
  4061
  4062****************************************************************
  4063*             LIFE EDIT MASTER RECORD                          *
  4064****************************************************************
  4065
  4066     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4067         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4068             20  CF-LIFE-CODE-IN            PIC XX.
  4069             20  CF-LIFE-CODE-OUT           PIC XX.
  4070         16  FILLER                         PIC X(248).
  4071
  4072
  4073****************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  72
* NSRASBL.cbl
  4074*             AH EDIT MASTER RECORD                            *
  4075****************************************************************
  4076
  4077     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4078         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4079             20  CF-AH-CODE-IN              PIC XXX.
  4080             20  CF-AH-CODE-OUT             PIC XX.
  4081         16  FILLER                         PIC X(248).
  4082
  4083
  4084****************************************************************
  4085*             CREDIBILITY TABLES                               *
  4086****************************************************************
  4087
  4088     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4089         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4090                             INDEXED BY CF-CRDB-NDX.
  4091             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4092             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4093             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4094         16  FILLER                         PIC  X(332).
  4095
  4096
  4097****************************************************************
  4098*             REPORT CUSTOMIZATION RECORD                      *
  4099****************************************************************
  4100
  4101     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4102         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4103             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4104             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4105             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4106**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4107****       A T-TRANSFER.                                   ****
  4108             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4109
  4110         16  FILLER                         PIC XX.
  4111
  4112         16  CF-CARRIER-CNTL-OPT.
  4113             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4114                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4115                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4116             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4117                                            PIC X.
  4118         16  CF-GROUP-CNTL-OPT.
  4119             20  CF-GROUP-OPT-SEQ           PIC 9.
  4120                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4121                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4122             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4123                                            PIC X(6).
  4124         16  CF-STATE-CNTL-OPT.
  4125             20  CF-STATE-OPT-SEQ           PIC 9.
  4126                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4127                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4128             20  CF-STATE-SELECT OCCURS 3 TIMES
  4129                                            PIC XX.
  4130         16  CF-ACCOUNT-CNTL-OPT.
  4131             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  73
* NSRASBL.cbl
  4132                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4133                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4134             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4135                                            PIC X(10).
  4136         16  CF-BUS-TYP-CNTL-OPT.
  4137             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4138                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4139                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4140             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4141                                            PIC XX.
  4142         16  CF-LF-TYP-CNTL-OPT.
  4143             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4144                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4145                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4146             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4147                                            PIC XX.
  4148         16  CF-AH-TYP-CNTL-OPT.
  4149             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4150                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4151                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4152             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4153                                            PIC XX.
  4154         16  CF-REPTCD1-CNTL-OPT.
  4155             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4156                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4157                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4158             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4159                                            PIC X(10).
  4160         16  CF-REPTCD2-CNTL-OPT.
  4161             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4162                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4163                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4164             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4165                                            PIC X(10).
  4166         16  CF-USER1-CNTL-OPT.
  4167             20  CF-USER1-OPT-SEQ           PIC 9.
  4168                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4169                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4170             20  CF-USER1-SELECT OCCURS 3 TIMES
  4171                                            PIC X(10).
  4172         16  CF-USER2-CNTL-OPT.
  4173             20  CF-USER2-OPT-SEQ           PIC 9.
  4174                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4175                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4176             20  CF-USER2-SELECT OCCURS 3 TIMES
  4177                                            PIC X(10).
  4178         16  CF-USER3-CNTL-OPT.
  4179             20  CF-USER3-OPT-SEQ           PIC 9.
  4180                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4181                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4182             20  CF-USER3-SELECT OCCURS 3 TIMES
  4183                                            PIC X(10).
  4184         16  CF-USER4-CNTL-OPT.
  4185             20  CF-USER4-OPT-SEQ           PIC 9.
  4186                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4187                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4188             20  CF-USER4-SELECT OCCURS 3 TIMES
  4189                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  74
* NSRASBL.cbl
  4190         16  CF-USER5-CNTL-OPT.
  4191             20  CF-USER5-OPT-SEQ           PIC 9.
  4192                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4193                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4194             20  CF-USER5-SELECT OCCURS 3 TIMES
  4195                                            PIC X(10).
  4196         16  CF-REINS-CNTL-OPT.
  4197             20  CF-REINS-OPT-SEQ           PIC 9.
  4198                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4199                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4200             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4201                 24  CF-REINS-PRIME         PIC XXX.
  4202                 24  CF-REINS-SUB           PIC XXX.
  4203
  4204         16  CF-AGENT-CNTL-OPT.
  4205             20  CF-AGENT-OPT-SEQ           PIC 9.
  4206                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4207                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4208             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4209                                            PIC X(10).
  4210
  4211         16  FILLER                         PIC X(43).
  4212
  4213         16  CF-LOSS-RATIO-SELECT.
  4214             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4215             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4216         16  CF-ENTRY-DATE-SELECT.
  4217             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4218             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4219         16  CF-EFFECTIVE-DATE-SELECT.
  4220             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4221             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4222
  4223         16  CF-EXCEPTION-LIST-IND          PIC X.
  4224             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4225
  4226         16  FILLER                         PIC X(318).
  4227
  4228****************************************************************
  4229*                  EXCEPTION REPORTING RECORD                  *
  4230****************************************************************
  4231
  4232     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4233         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4234             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4235
  4236         16  CF-COMBINED-LIFE-AH-OPT.
  4237             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4238             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4239             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4240             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4241
  4242         16  CF-LIFE-OPT.
  4243             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4244             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4245             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4246             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4247             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  75
* NSRASBL.cbl
  4248             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4249             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4250             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4251             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4252             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4253
  4254         16  CF-AH-OPT.
  4255             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4256             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4257             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4258             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4259             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4260             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4261             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4262             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4263             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4264             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4265
  4266         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4267             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4268             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4269             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4270
  4271         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4272
  4273         16  FILLER                         PIC X(673).
  4274
  4275
  4276****************************************************************
  4277*             MORTGAGE SYSTEM PLAN RECORD                      *
  4278****************************************************************
  4279
  4280     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4281         16  CF-PLAN-TYPE                   PIC X.
  4282             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4283             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4284             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4285         16  CF-PLAN-ABBREV                 PIC XXX.
  4286         16  CF-PLAN-DESCRIPT               PIC X(10).
  4287         16  CF-PLAN-NOTES                  PIC X(20).
  4288         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4289         16  CF-PLAN-UNDERWRITING.
  4290             20  CF-PLAN-TERM-DATA.
  4291                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4292                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4293             20  CF-PLAN-AGE-DATA.
  4294                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4295                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4296                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4297             20  CF-PLAN-BENEFIT-DATA.
  4298                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4299                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4300                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4301                                            PIC S9(7)V99  COMP-3.
  4302         16  CF-PLAN-POLICY-FORMS.
  4303             20  CF-POLICY-FORM             PIC X(12).
  4304             20  CF-MASTER-APPLICATION      PIC X(12).
  4305             20  CF-MASTER-POLICY           PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  76
* NSRASBL.cbl
  4306         16  CF-PLAN-RATING.
  4307             20  CF-RATE-CODE               PIC X(5).
  4308             20  CF-SEX-RATING              PIC X.
  4309                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4310                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4311             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4312             20  CF-SUB-STD-TYPE            PIC X.
  4313                 88  CF-PCT-OF-PREM            VALUE '1'.
  4314                 88  CF-PCT-OF-BENE            VALUE '2'.
  4315         16  CF-PLAN-PREM-TOLERANCES.
  4316             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4317             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4318         16  CF-PLAN-PYMT-TOLERANCES.
  4319             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4320             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4321         16  CF-PLAN-MISC-DATA.
  4322             20  FILLER                     PIC X.
  4323             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4324             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4325         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4326         16  CF-PLAN-IND-GRP                PIC X.
  4327             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4328                                                     '1'.
  4329             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4330                                                     '2'.
  4331         16  CF-MIB-SEARCH-SW               PIC X.
  4332             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4333             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4334             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4335             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4336         16  CF-ALPHA-SEARCH-SW             PIC X.
  4337             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4338             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4339             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4340             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4341             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4342             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4343             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4344             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4345             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4346             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4347                                                     'A' 'B' 'C'
  4348                                                     'X' 'Y' 'Z'.
  4349         16  CF-EFF-DT-RULE-SW              PIC X.
  4350             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4351             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4352             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4353             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4354             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4355         16  FILLER                         PIC X(4).
  4356         16  CF-HEALTH-QUESTIONS            PIC X.
  4357             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4358         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4359         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4360         16  CF-PLAN-SNGL-JNT               PIC X.
  4361             88  CF-COMBINED-PLAN              VALUE 'C'.
  4362             88  CF-JNT-PLAN                   VALUE 'J'.
  4363             88  CF-SNGL-PLAN                  VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  77
* NSRASBL.cbl
  4364         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4365         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4366         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4367         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4368         16  CF-RERATE-CNTL                 PIC  X.
  4369             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4370             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4371             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4372             88  CF-AUTO-RECALC                 VALUE '4'.
  4373         16  CF-BENEFIT-TYPE                PIC  X.
  4374             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4375             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4376         16  CF-POLICY-FEE                  PIC S999V99
  4377                                                    COMP-3.
  4378         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4379         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4380         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4381         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4382         16  FILLER                         PIC  X(32).
  4383         16  CF-TERMINATION-FORM            PIC  X(04).
  4384         16  FILLER                         PIC  X(08).
  4385         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4386                                                       COMP-3.
  4387         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4388         16  CF-ISSUE-LETTER                PIC  X(4).
  4389         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4390         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4391             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4392             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4393         16  CF-MP-REFUND-CALC              PIC X.
  4394             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4395             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4396             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4397             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4398             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4399             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4400             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4401             88  CF-MP-REFD-MEAN                VALUE '8'.
  4402         16  CF-ALT-RATE-CODE               PIC  X(5).
  4403
  4404
  4405         16  FILLER                         PIC X(498).
  4406****************************************************************
  4407*             MORTGAGE COMPANY MASTER RECORD                   *
  4408****************************************************************
  4409
  4410     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4411         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4412         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4413             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4414             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4415             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4416             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4417             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4418
  4419         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4420         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4421         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  78
* NSRASBL.cbl
  4422         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4423         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4424
  4425         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4426             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4427         16  CF-MP-RECON-USE-IND            PIC X(1).
  4428             88  CF-MP-USE-RECON             VALUE 'Y'.
  4429         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4430             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4431         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4432             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4433             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4434         16  FILLER                         PIC X(1).
  4435         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4436             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4437         16  CF-MORTG-MIB-VERSION           PIC X.
  4438             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4439             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4440             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4441         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4442             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4443                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4444             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4445                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4446             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4447                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4448             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4449                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4450             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4451                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4452             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4453                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4454         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4455         16  FILLER                         PIC X(7).
  4456         16  CF-MORTG-DESTINATION-SYMBOL.
  4457             20  CF-MORTG-MIB-COMM          PIC X(5).
  4458             20  CF-MORTG-MIB-TERM          PIC X(5).
  4459         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4460             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4461         16  FILLER                         PIC X(03).
  4462         16  CF-MP-CHECK-NO-CONTROL.
  4463             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4464                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4465                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4466                                                ' ' LOW-VALUES.
  4467                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4468                                               VALUE '3'.
  4469         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4470         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4471         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4472             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4473                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4474             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4475                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4476             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4477                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4478             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4479                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  79
* NSRASBL.cbl
  4480             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4481                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4482             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4483                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4484         16  CF-MORTG-BILLING-AREA.
  4485             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4486                                            PIC X.
  4487         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4488         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4489         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4490         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4491             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4492             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4493         16  FILLER                         PIC X.
  4494         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4495             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4496             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4497         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4498         16  FILLER                         PIC X(8).
  4499         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4500         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4501         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4502         16  CF-ACH-COMPANY-ID.
  4503             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4504                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4505                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4506                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4507             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4508         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4509             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4510         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4511             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4512             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4513         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4514         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4515         16  FILLER                         PIC X(536).
  4516
  4517****************************************************************
  4518*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4519****************************************************************
  4520
  4521     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4522         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4523             20  CF-FEMALE-HEIGHT.
  4524                 24  CF-FEMALE-FT           PIC 99.
  4525                 24  CF-FEMALE-IN           PIC 99.
  4526             20  CF-FEMALE-MIN-WT           PIC 999.
  4527             20  CF-FEMALE-MAX-WT           PIC 999.
  4528         16  FILLER                         PIC X(428).
  4529
  4530     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4531         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4532             20  CF-MALE-HEIGHT.
  4533                 24  CF-MALE-FT             PIC 99.
  4534                 24  CF-MALE-IN             PIC 99.
  4535             20  CF-MALE-MIN-WT             PIC 999.
  4536             20  CF-MALE-MAX-WT             PIC 999.
  4537         16  FILLER                         PIC X(428).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  80
* NSRASBL.cbl
  4538******************************************************************
  4539*             AUTOMATIC ACTIVITY RECORD                          *
  4540******************************************************************
  4541     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4542         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4543             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4544             20  CF-SYS-LETTER-ID           PIC X(04).
  4545             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4546             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4547             20  CF-SYS-RESET-SW            PIC X(01).
  4548             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4549             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4550
  4551         16  FILLER                         PIC X(50).
  4552
  4553         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4554             20  CF-USER-ACTIVE-SW          PIC X(01).
  4555             20  CF-USER-LETTER-ID          PIC X(04).
  4556             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4557             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4558             20  CF-USER-RESET-SW           PIC X(01).
  4559             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4560             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4561             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4562
  4563         16  FILLER                         PIC X(246).
  4564*                                COPY NSCASVARS.
  4565******************************************************************
  4566*                   C H A N G E   L O G
  4567*
  4568*        CURRENT SIZE - 6150
  4569*
  4570* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4571*-----------------------------------------------------------------
  4572*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4573* EFFECTIVE    NUMBER
  4574*-----------------------------------------------------------------
  4575* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
  4576* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
  4577* 091213  CR2013090300001  AJRA  ADD NEXT BUSINESS DATE
  4578******************************************************************
  4579 01 NAPER-OUTPUT-DATA.
  4580    05  F                       PIC X(07) VALUE "LETTER=".
  4581    05  OUT-LETTER              PIC X(06) VALUE SPACES.
  4582    05  F                       PIC X(08) VALUE "~PROCID=".
  4583    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
  4584    05  F                       PIC X(10) VALUE "~PROCNAME=".
  4585    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
  4586    05  F                       PIC X(11) VALUE "~PROCTITLE=".
  4587    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
  4588    05  F                       PIC X(09) VALUE "~CSRNAME=".
  4589    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
  4590    05  F                       PIC X(10) VALUE "~CSRTITLE=".
  4591    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
  4592    05  F                       PIC X(06) VALUE "~CARR=".
  4593    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
  4594    05  F                       PIC X(10) VALUE "~GROUPING=".
  4595    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  81
* NSRASBL.cbl
  4596    05  F                       PIC X(08) VALUE "~CERTST=".
  4597    05  OUT-STATE               PIC X(02) VALUE SPACES.
  4598    05  F                       PIC X(09) VALUE "~ACCOUNT=".
  4599    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
  4600    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
  4601    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
  4602    05  F                       PIC X(07) VALUE "~CRTNO=".
  4603    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
  4604    05  F                       PIC X(08) VALUE "~CRTSUF=".
  4605    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
  4606    05  F                       PIC X(08) VALUE "~ILNAME=".
  4607    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
  4608    05  F                       PIC X(08) VALUE "~IFNAME=".
  4609    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
  4610    05  F                       PIC X(08) VALUE "~IFINIT=".
  4611    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
  4612    05  F                       PIC X(08) VALUE "~IMINIT=".
  4613    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
  4614    05  F                       PIC X(09) VALUE "~IISSAGE=".
  4615    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
  4616    05  F                       PIC X(06) VALUE "~ISEX=".
  4617    05  OUT-ISEX                PIC X(01) VALUE SPACES.
  4618    05  F                       PIC X(10) VALUE "~INSADDR1=".
  4619    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
  4620    05  F                       PIC X(10) VALUE "~INSADDR2=".
  4621    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
  4622    05  F                       PIC X(09) VALUE "~INSCITY=".
  4623    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
  4624    05  F                       PIC X(10) VALUE "~INSSTATE=".
  4625    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
  4626    05  F                       PIC X(08) VALUE "~INSZIP=".
  4627    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
  4628    05  F                       PIC X(05) VALUE "~SSN=".
  4629    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
  4630    05  F                       PIC X(07) VALUE "~MEMNO=".
  4631    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
  4632    05  F                       PIC X(08) VALUE "~JLNAME=".
  4633    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
  4634    05  F                       PIC X(08) VALUE "~JFNAME=".
  4635    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
  4636    05  F                       PIC X(08) VALUE "~JMINIT=".
  4637    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
  4638    05  F                       PIC X(08) VALUE "~JNTAGE=".
  4639    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
  4640    05  F                       PIC X(10) VALUE "~ACCTNAME=".
  4641    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
  4642    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
  4643    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
  4644    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
  4645    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
  4646    05  F                       PIC X(10) VALUE "~ACCTCITY=".
  4647    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
  4648    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
  4649    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
  4650    05  F                       PIC X(09) VALUE "~ACCTZIP=".
  4651    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
  4652    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
  4653    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  82
* NSRASBL.cbl
  4654    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
  4655    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
  4656    05  F                       PIC X(09) VALUE "~BUSTYPE=".
  4657    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
  4658    05  F                       PIC X(10) VALUE "~BENENAME=".
  4659    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
  4660    05  F                       PIC X(11) VALUE "~BENEADDR1=".
  4661    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
  4662    05  F                       PIC X(11) VALUE "~BENEADDR2=".
  4663    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
  4664    05  F                       PIC X(10) VALUE "~BENECITY=".
  4665    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
  4666    05  F                       PIC X(11) VALUE "~BENESTATE=".
  4667    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
  4668    05  F                       PIC X(09) VALUE "~BENEZIP=".
  4669    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
  4670    05  F                       PIC X(10) VALUE "~CARRNAME=".
  4671    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
  4672    05  F                       PIC X(08) VALUE "~RESPNO=".
  4673    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
  4674    05  F                       PIC X(12) VALUE "~COACCTNAME=".
  4675    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
  4676    05  F                       PIC X(12) VALUE "~COMAILNAME=".
  4677    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
  4678    05  F                       PIC X(11) VALUE "~COMPADDR1=".
  4679    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
  4680    05  F                       PIC X(11) VALUE "~COMPADDR2=".
  4681    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
  4682    05  F                       PIC X(10) VALUE "~COMPCITY=".
  4683    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
  4684    05  F                       PIC X(11) VALUE "~COMPSTATE=".
  4685    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
  4686    05  F                       PIC X(09) VALUE "~COMPZIP=".
  4687    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
  4688    05  F                       PIC X(11) VALUE "~COMPPHONE=".
  4689    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
  4690    05  F                       PIC X(09) VALUE "~COMPFAX=".
  4691    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
  4692    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
  4693    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
  4694    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
  4695    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
  4696    05  F                       PIC X(08) VALUE "~RPTCD1=".
  4697    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
  4698    05  F                       PIC X(08) VALUE "~RPTCD2=".
  4699    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
  4700    05  F                       PIC X(09) VALUE "~ENTRYDT=".
  4701    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
  4702    05  F                       PIC X(07) VALUE "~BATCH=".
  4703    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
  4704    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
  4705    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
  4706    05  F                       PIC X(10) VALUE "~1STPMTDT=".
  4707    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
  4708    05  F                       PIC X(05) VALUE "~APR=".
  4709    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
  4710    05  F                       PIC X(08) VALUE "~LNTERM=".
  4711    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  83
* NSRASBL.cbl
  4712    05  F                       PIC X(11) VALUE "~RATECLASS=".
  4713    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
  4714    05  F                       PIC X(09) VALUE "~EXTDAYS=".
  4715    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
  4716    05  F                       PIC X(09) VALUE "~CSRCODE=".
  4717    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
  4718    05  F                       PIC X(07) VALUE "~UCODE=".
  4719    05  OUT-UCODE               PIC X(01) VALUE SPACES.
  4720    05  F                       PIC X(10) VALUE "~PREMTYPE=".
  4721    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
  4722    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
  4723    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
  4724    05  F                       PIC X(06) VALUE "~SKIP=".
  4725    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
  4726    05  F                       PIC X(06) VALUE "~MODE=".
  4727    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
  4728    05  F                       PIC X(09) VALUE "~LOANOFF=".
  4729    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
  4730    05  F                       PIC X(06) VALUE "~RTBL=".
  4731    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
  4732    05  F                       PIC X(10) VALUE "~SPECREIN=".
  4733    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
  4734    05  F                       PIC X(09) VALUE "~LFBENCD=".
  4735    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
  4736    05  F                       PIC X(08) VALUE "~LFTERM=".
  4737    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
  4738    05  F                       PIC X(07) VALUE "~LFDEV=".
  4739    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
  4740    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
  4741    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
  4742    05  F                       PIC X(07) VALUE "~LFBEN=".
  4743    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
  4744    05  F                       PIC X(08) VALUE "~LFPREM=".
  4745    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4746    05  F                       PIC X(08) VALUE "~LFABEN=".
  4747    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4748    05  F                       PIC X(09) VALUE "~LFAPREM=".
  4749    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
  4750    05  F                       PIC X(07) VALUE "~LFNSP=".
  4751    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4752    05  F                       PIC X(08) VALUE "~LFRBEN=".
  4753    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4754    05  F                       PIC X(07) VALUE "~LFCAN=".
  4755    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4756    05  F                       PIC X(07) VALUE "~LFDTH=".
  4757    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
  4758    05  F                       PIC X(08) VALUE "~LFRATE=".
  4759    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4760    05  F                       PIC X(09) VALUE "~LFARATE=".
  4761    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
  4762    05  F                       PIC X(09) VALUE "~LFEXPDT=".
  4763    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
  4764    05  F                       PIC X(08) VALUE "~LFSTAT=".
  4765    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
  4766    05  F                       PIC X(09) VALUE "~LFCANDT=".
  4767    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
  4768    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
  4769    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  84
* NSRASBL.cbl
  4770    05  F                       PIC X(07) VALUE "~DTHDT=".
  4771    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
  4772    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
  4773    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
  4774    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
  4775    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4776    05  F                       PIC X(08) VALUE "~LFCOMM=".
  4777    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4778    05  F                       PIC X(11) VALUE "~LFBENDESC=".
  4779    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
  4780    05  F                       PIC X(11) VALUE "~LFBENABRV=".
  4781    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
  4782    05  F                       PIC X(09) VALUE "~AHBENCD=".
  4783    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
  4784    05  F                       PIC X(08) VALUE "~AHTERM=".
  4785    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
  4786    05  F                       PIC X(11) VALUE "~AHCRITPER=".
  4787    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
  4788    05  F                       PIC X(09) VALUE "~AHDEVCD=".
  4789    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
  4790    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
  4791    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
  4792    05  F                       PIC X(07) VALUE "~AHBEN=".
  4793    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
  4794    05  F                       PIC X(08) VALUE "~AHPREM=".
  4795    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4796    05  F                       PIC X(07) VALUE "~AHNSP=".
  4797    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4798    05  F                       PIC X(07) VALUE "~AHCAN=".
  4799    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4800    05  F                       PIC X(10) VALUE "~AHITDPMT=".
  4801    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
  4802    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
  4803    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4804    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
  4805    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
  4806    05  F                       PIC X(08) VALUE "~AHRATE=".
  4807    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4808    05  F                       PIC X(09) VALUE "~AHEXPDT=".
  4809    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
  4810    05  F                       PIC X(08) VALUE "~AHSTAT=".
  4811    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
  4812    05  F                       PIC X(09) VALUE "~AHCANDT=".
  4813    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
  4814    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
  4815    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4816    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
  4817    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4818    05  F                       PIC X(08) VALUE "~AHCOMM=".
  4819    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4820    05  F                       PIC X(11) VALUE "~AHBENDESC=".
  4821    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
  4822    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
  4823    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
  4824    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
  4825    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
  4826    05  F                       PIC X(08) VALUE "~AHWAIT=".
  4827    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  85
* NSRASBL.cbl
  4828    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
  4829    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
  4830    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
  4831                                PIC X(2).
  4832    05  F                       PIC X(09) VALUE "~TOTPREM=".
  4833    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
  4834    05  F                       PIC X(08) VALUE "~TOTREF=".
  4835    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
  4836    05  F                       PIC X(08) VALUE "~SEXPDT=".
  4837    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
  4838    05  F                       PIC X(07) VALUE "~STERM=".
  4839    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
  4840    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
  4841    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
  4842    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
  4843    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
  4844    05  F                       PIC X(11) VALUE "~IORIGINIT=".
  4845    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
  4846    05  F                       PIC X(10) VALUE "~IORIGAGE=".
  4847    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
  4848    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
  4849    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
  4850    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
  4851    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
  4852    05  F                       PIC X(11) VALUE "~JORIGINIT=".
  4853    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
  4854    05  F                       PIC X(10) VALUE "~JORIGAGE=".
  4855    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
  4856    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
  4857    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
  4858    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
  4859    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
  4860    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
  4861    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
  4862    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
  4863                                PIC X(12).
  4864    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
  4865    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
  4866    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
  4867                                PIC X(12).
  4868    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
  4869    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
  4870    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
  4871    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
  4872    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
  4873    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4874    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
  4875    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
  4876    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
  4877                                PIC X(12).
  4878    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
  4879    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
  4880    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
  4881                                PIC X(10).
  4882    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
  4883    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
  4884    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
  4885    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  86
* NSRASBL.cbl
  4886    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
  4887    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
  4888    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
  4889    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
  4890    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
  4891    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
  4892    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
  4893    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
  4894    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
  4895                                PIC X(10).
  4896    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
  4897    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
  4898    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
  4899                                PIC X(10).
  4900    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
  4901    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
  4902    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
  4903    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
  4904    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
  4905    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4906    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
  4907    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
  4908    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
  4909    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
  4910    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
  4911    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
  4912    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
  4913    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
  4914    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
  4915    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
  4916    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
  4917    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
  4918    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
  4919                                PIC X(2).
  4920    05  F                       PIC X(09) VALUE "~OSEXPDT=".
  4921    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
  4922    05  F                       PIC X(08) VALUE "~OSTERM=".
  4923    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
  4924    05  F                       PIC X(11) VALUE "~INEWLNAME=".
  4925    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
  4926    05  F                       PIC X(11) VALUE "~INEWFNAME=".
  4927    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
  4928    05  F                       PIC X(10) VALUE "~INEWINIT=".
  4929    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
  4930    05  F                       PIC X(09) VALUE "~INEWAGE=".
  4931    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
  4932    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
  4933                                PIC X(09).
  4934    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
  4935    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
  4936    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
  4937    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
  4938    05  F                       PIC X(10) VALUE "~JNEWINIT=".
  4939    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
  4940    05  F                       PIC X(09) VALUE "~JNEWAGE=".
  4941    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
  4942    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
  4943                                PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  87
* NSRASBL.cbl
  4944    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
  4945    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
  4946    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
  4947    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
  4948    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
  4949                                PIC X(09).
  4950    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
  4951    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
  4952    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
  4953                                PIC X(12).
  4954    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
  4955    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
  4956    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
  4957                                PIC X(10).
  4958    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
  4959    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
  4960    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
  4961    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
  4962    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
  4963                                PIC X(12).
  4964    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
  4965    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
  4966    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
  4967                                PIC X(10).
  4968    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
  4969    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
  4970    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
  4971    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
  4972    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
  4973    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
  4974    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
  4975    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
  4976    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
  4977                                PIC X(09).
  4978    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
  4979    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
  4980    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
  4981                                PIC X(09).
  4982    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
  4983    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
  4984    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
  4985                                PIC X(10).
  4986    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
  4987    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
  4988    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
  4989                                PIC X(10).
  4990    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
  4991    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
  4992    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
  4993    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
  4994    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
  4995    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
  4996    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
  4997    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
  4998    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
  4999    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
  5000    05  F                       PIC X(09) VALUE "~NEWWAIT=".
  5001    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  88
* NSRASBL.cbl
  5002    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
  5003    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
  5004    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
  5005                                PIC X(09).
  5006    05  F                       PIC X(09) VALUE "~NSEXPDT=".
  5007    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
  5008    05  F                       PIC X(08) VALUE "~NSTERM=".
  5009    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
  5010    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
  5011                                PIC X(09).
  5012    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
  5013    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
  5014    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
  5015    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
  5016    05  F                       PIC X(11) VALUE "~PAYABLETO=".
  5017    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
  5018    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
  5019    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
  5020    05  F                       PIC X(09) VALUE "~BALLOON=".
  5021    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
  5022    05  F                       PIC X(10) VALUE "~LEASEIND=".
  5023    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
  5024    05  F                       PIC X(09) VALUE "~RESCIND=".
  5025    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
  5026    05  F                       PIC X(07) VALUE "~RCD01=".
  5027    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
  5028    05  F                       PIC X(07) VALUE "~RCD02=".
  5029    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
  5030    05  F                       PIC X(07) VALUE "~RCD03=".
  5031    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
  5032    05  F                       PIC X(07) VALUE "~RCD04=".
  5033    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
  5034    05  F                       PIC X(07) VALUE "~RCD05=".
  5035    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
  5036    05  F                       PIC X(07) VALUE "~RCD06=".
  5037    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
  5038    05  F                       PIC X(07) VALUE "~RCD07=".
  5039    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
  5040    05  F                       PIC X(07) VALUE "~RCD08=".
  5041    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
  5042    05  F                       PIC X(07) VALUE "~RCD09=".
  5043    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
  5044    05  F                       PIC X(07) VALUE "~RCD10=".
  5045    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
  5046    05  F                       PIC X(07) VALUE "~RCD11=".
  5047    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
  5048    05  F                       PIC X(07) VALUE "~RCD12=".
  5049    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
  5050    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
  5051    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
  5052    05  F                       PIC X(08) VALUE "~ARCHNO=".
  5053    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
  5054    05  F                       PIC X(06) VALUE "~FORM=".
  5055    05  OUT-FORM                PIC X(03) VALUE SPACES.
  5056    05  F                       PIC X(09) VALUE "~ENCLINE=".
  5057    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
  5058    05  F                       PIC X(08) VALUE "~ATTACH=".
  5059    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  89
* NSRASBL.cbl
  5060    05  F                       PIC X(10) VALUE "~OUTSTACK=".
  5061    05  OUT-STACK               PIC X(10) VALUE SPACES.
  5062    05  F                       PIC X(11) VALUE "~STATENAME=".
  5063    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
  5064    05  F                       PIC X(08) VALUE "~PRTNOW=".
  5065    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
  5066    05  F                       PIC X(05) VALUE "~NCB=".
  5067    05  OUT-CHGBACK             PIC X     VALUE ' '.
  5068    05  F                       PIC X(8) VALUE "~CSOAMT=".
  5069    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
  5070    05  F                       PIC X(9) VALUE "~ACCTAMT=".
  5071    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
  5072    05  F                       PIC X(09) VALUE "~LETRTYP=".
  5073    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
  5074    05  F                       PIC X(10) VALUE "~PRNTCERT=".
  5075    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
  5076    05  F                       PIC X(08) VALUE "~INSBDT=".
  5077    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
  5078    05  F                       PIC X(08) VALUE "~JNTBDT=".
  5079    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
  5080    05  F                       PIC X(08) VALUE "~TOTINT=".
  5081    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
  5082    05  F                       PIC X(8) VALUE "~TOPREM=".
  5083    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  5084    05  F                       PIC X(7) VALUE "~TOREF=".
  5085    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  5086    05  F                       PIC X(7) VALUE "~CANDT=".
  5087    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  5088    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  5089    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  5090    05  F                       PIC X(08) VALUE "~CERTID=".
  5091    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
  5092    05  F                       PIC X(08) VALUE "~UNDWID=".
  5093    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
  5094    05  F                       PIC X(8) VALUE "~TNPREM=".
  5095    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  5096    05  F                       PIC X(7) VALUE "~TNREF=".
  5097    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  5098    05  F                       PIC X(8)  VALUE "~COVIND=".
  5099    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
  5100    05  F                       PIC X(9)  VALUE "~OCOVIND=".
  5101    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
  5102    05  F                       PIC X(9)  VALUE "~NCOVIND=".
  5103    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  5104    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  5105    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  5106    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  5107    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  5108    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
  5109    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  5110    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  5111                                PIC X(10).
  5112    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  5113    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  5114    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  5115    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  5116    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  5117    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  90
* NSRASBL.cbl
  5118    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
  5119    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  5120    05  F                       PIC X(10) VALUE "~LFREFCHG=".
  5121    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  5122    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  5123    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  5124    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  5125    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  5126    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  5127    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5128    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  5129    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5130    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  5131    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  5132    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  5133    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  5134    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  5135    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5136    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
  5137    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5138    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  5139    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
  5140    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  5141    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  5142    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  5143    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5144    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  5145    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5146    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  5147    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  5148    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
  5149    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  5150    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
  5151    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5152    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  5153    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5154    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
  5155    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5156    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  5157    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5158    05  F                       PIC X(09) VALUE "~CSOOAMT=".
  5159    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  5160    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
  5161    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5162    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  5163    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5164    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  5165    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5166    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
  5167    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5168    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  5169    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  5170    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  5171    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5172    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  5173    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5174    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  5175    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  91
* NSRASBL.cbl
  5176    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
  5177    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  5178    05  F                       PIC X(09) VALUE "~CSONAMT=".
  5179    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
  5180    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  5181    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5182    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  5183    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5184    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  5185    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5186    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  5187    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5188    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  5189    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  5190    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  5191    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5192    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  5193    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5194    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
  5195    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5196    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  5197    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5198    05  F                       PIC X(08) VALUE "~CSOCHG=".
  5199    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  5200    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  5201    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  5202    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  5203    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  5204    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  5205    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  5206    05  F                       PIC X(10) VALUE "~AHNCANDT=".
  5207    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  5208    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
  5209    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
  5210    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  5211    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  5212    05  F                       PIC X(8)  VALUE "~SCREEN=".
  5213    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  5214    05  F                       PIC X(9)  VALUE "~NXTBSDT=".
  5215    05  OUT-NEXT-BUS-DT         PIC X(21) VALUE SPACES.
  5216    05  F                       PIC X(11) VALUE 'EndOfString'.
  5217    05  f                       pic x(2) value spaces.
  5218*                                COPY ERCARCH.
  5219******************************************************************
  5220*                                                                *
  5221*                            ERCARCH.                            *
  5222*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5223*                            VMOD=2.002                          *
  5224*                                                                *
  5225*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5226*                                                                *
  5227*   FILE TYPE = VSAM,KSDS                                        *
  5228*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5229*                                                                *
  5230*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5231*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5232*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5233*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  92
* NSRASBL.cbl
  5234*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5235*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5236*                                                                *
  5237*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5238******************************************************************
  5239*                   C H A N G E   L O G
  5240*
  5241* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5242*-----------------------------------------------------------------
  5243*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5244* EFFECTIVE    NUMBER
  5245*-----------------------------------------------------------------
  5246* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5247* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5248* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5249******************************************************************
  5250 01  LETTER-ARCHIVE.
  5251     12  LA-RECORD-ID                PIC  X(02).
  5252         88  LA-VALID-ID                VALUE 'LA'.
  5253
  5254     12  LA-CONTROL-PRIMARY.
  5255         16  LA-COMPANY-CD           PIC  X(01).
  5256         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5257
  5258     12  LA-CONTROL-BY-CERT-RESP.
  5259         16  LA-COMPANY-CD-A2        PIC  X(01).
  5260         16  LA-CERT-NO-A2.
  5261             20  LA-CERT-PRIME-A2    PIC  X(10).
  5262             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5263         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5264             20  LA-RESP-PERSON-A2   PIC  X(10).
  5265             20  LA-TYPE-A2          PIC  X(01).
  5266         16  LA-CARRIER-A2           PIC  X(01).
  5267         16  LA-GROUPING-A2          PIC  X(06).
  5268         16  LA-STATE-A2             PIC  X(02).
  5269         16  LA-ACCOUNT-A2           PIC  X(10).
  5270         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5271         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5272
  5273     12  LA-CONTROL-BY-FORM.
  5274         16  LA-COMPANY-CD-A3        PIC  X(01).
  5275         16  LA-FORM-A3              PIC  X(04).
  5276         16  LA-CARRIER-A3           PIC  X(01).
  5277         16  LA-GROUPING-A3          PIC  X(06).
  5278         16  LA-STATE-A3             PIC  X(02).
  5279         16  LA-ACCOUNT-A3           PIC  X(10).
  5280         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5281
  5282     12  LA-CONTROL-BY-PROCESSOR.
  5283         16  LA-COMPANY-CD-A4        PIC  X(01).
  5284         16  LA-PROCESSOR-CD         PIC  X(04).
  5285         16  LA-CARRIER-A4           PIC  X(01).
  5286         16  LA-GROUPING-A4          PIC  X(06).
  5287         16  LA-STATE-A4             PIC  X(02).
  5288         16  LA-ACCOUNT-A4           PIC  X(10).
  5289         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5290
  5291     12  LA-CONTROL-BY-KEY-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  93
* NSRASBL.cbl
  5292         16  LA-COMPANY-CD-A5        PIC  X(01).
  5293         16  LA-CARRIER-A5           PIC  X(01).
  5294         16  LA-GROUPING-A5          PIC  X(06).
  5295         16  LA-STATE-A5             PIC  X(02).
  5296         16  LA-ACCOUNT-A5           PIC  X(10).
  5297         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5298
  5299     12  LA-CONTROL-BY-GROUP-CODE.
  5300         16  LA-COMPANY-CD-A6        PIC  X(01).
  5301         16  LA-ENTRY-A6.
  5302             20  LA-FILLER           PIC  X(02).
  5303             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5304         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5305
  5306     12  FILLER                      PIC  X(09).
  5307
  5308     12  LA-HEADER-RECORD.
  5309         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5310         16  LA-CREATION-DATE        PIC  X(02).
  5311         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5312         16  LA-FINAL-ACT-DATE       REDEFINES
  5313               LA-FOLLOW-UP-DATE     PIC  X(02).
  5314         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5315         16  LA-NO-OF-COPIES         PIC S9(01).
  5316         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5317         16  LA-REPLY-DATE           PIC  X(02).
  5318         16  LA-RESEND-DATES.
  5319             20  LA-RESEND-DATE      PIC  X(02).
  5320             20  LA-SENT-DATE        PIC  X(02).
  5321             20  FILLER              PIC  X(08).
  5322         16  LA-SOURCE-INFORMATION.
  5323             20  LA-DATA-SOURCE      PIC  X(01).
  5324             20  LA-ADDR-SOURCE      PIC  X(01).
  5325         16  LA-STATUS               PIC  X(01).
  5326             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5327             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5328             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5329             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5330             88  LA-STATUS-PURGED         VALUE 'P'.
  5331             88  LA-STATUS-VOIDED         VALUE 'V'.
  5332         16  LA-LAST-RESENT-PRINT-DATE
  5333                                     PIC  X(02).
  5334         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5335             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5336                                          VALUE 'C'.
  5337             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5338                                          VALUE 'F'.
  5339             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5340                                          VALUE 'P'.
  5341         16  LA-PURGED-DATE          PIC  X(02).
  5342         16  LA-VOIDED-DATE          PIC  X(02).
  5343         16  LA-RESEND-LETR          PIC  X(4).
  5344         16  FILLER                  PIC  X(08).
  5345*        16  LA-RESEND-LETR-2        PIC  X(4).
  5346*        16  LA-RESEND-LETR-3        PIC  X(4).
  5347*        16  FILLER                  PIC  X(59).
  5348         16  LA-ARCHIVE-STATUS       PIC  X.
  5349             88  LA-TEMP                VALUE 'T'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  94
* NSRASBL.cbl
  5350             88  LA-QWS                 VALUE 'Q'.
  5351             88  LA-BATCH               VALUE 'B'.
  5352         16  LA-FINAL-ACT-IND        PIC  X(1).
  5353         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5354         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5355         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5356                                     PIC X(4).
  5357         16  FILLER                  PIC  X(42).
  5358*        16  FILLER                  PIC  X(71).
  5359         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5360         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5361         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5362                                     PIC  X(4).
  5363         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5364
  5365******************************************************************
  5366*                                COPY ELCCRTT.
  5367******************************************************************
  5368*                                                                *
  5369*                            ELCCRTT.                            *
  5370*                                                                *
  5371*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5372*                                                                *
  5373*   FILE TYPE = VSAM,KSDS                                        *
  5374*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5375*                                                                *
  5376*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5377*                                                                *
  5378*   LOG = YES                                                    *
  5379*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5380******************************************************************
  5381*                   C H A N G E   L O G
  5382*
  5383* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5384*-----------------------------------------------------------------
  5385*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5386* EFFECTIVE    NUMBER
  5387*-----------------------------------------------------------------
  5388* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5389* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5390* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5391* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5392* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5393******************************************************************
  5394
  5395 01  CERTIFICATE-TRAILERS.
  5396     12  CS-RECORD-ID                      PIC XX.
  5397         88  VALID-CS-ID                      VALUE 'CS'.
  5398
  5399     12  CS-CONTROL-PRIMARY.
  5400         16  CS-COMPANY-CD                 PIC X.
  5401         16  CS-CARRIER                    PIC X.
  5402         16  CS-GROUPING                   PIC X(6).
  5403         16  CS-STATE                      PIC XX.
  5404         16  CS-ACCOUNT                    PIC X(10).
  5405         16  CS-CERT-EFF-DT                PIC XX.
  5406         16  CS-CERT-NO.
  5407             20  CS-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  95
* NSRASBL.cbl
  5408             20  CS-CERT-SFX               PIC X.
  5409         16  CS-TRAILER-TYPE               PIC X.
  5410             88  COMM-TRLR           VALUE 'A'.
  5411             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5412             88  CERT-DATA-TRLR      VALUE 'C'.
  5413
  5414     12  CS-DATA-AREA                      PIC X(516).
  5415
  5416     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5417         16  CS-BANK-COMMISSION-AREA.
  5418             20  CS-BANK-COMMS       OCCURS 10.
  5419                 24  CS-AGT                PIC X(10).
  5420                 24  CS-COM-TYP            PIC X.
  5421                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5422                 24  CS-RECALC-LV-INDIC    PIC X.
  5423                 24  FILLER                PIC X(10).
  5424         16  FILLER                        PIC X(256).
  5425
  5426     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5427****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5428****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5429         16  CS-MB-CLAIM-DATA OCCURS 2.
  5430             20  FILLER OCCURS 10.
  5431                 24  CS-CLAIM-TYPE         PIC X.
  5432                     88  CS-AH-CLM           VALUE 'A'.
  5433                     88  CS-IU-CLM           VALUE 'I'.
  5434                     88  CS-GP-CLM           VALUE 'G'.
  5435                     88  CS-LF-CLM           VALUE 'L'.
  5436                     88  CS-PR-CLM           VALUE 'P'.
  5437                 24  CS-BANK               PIC S999 COMP-3.
  5438                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5439                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5440                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5441         16  FILLER                        PIC X(216).
  5442     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5443         16  CS-VIN-NUMBER                 PIC X(17).
  5444         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5445         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5446         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5447         16  FILLER                        PIC X(496).
  5448******************************************************************
  5449 01  FILLER                      PIC X(500)  VALUE SPACES.
  5450*                                COPY ELCENCC.
  5451******************************************************************
  5452*                                                                *
  5453*                                                                *
  5454*                            ELCENCC                             *
  5455*                            VMOD=2.001                          *
  5456*                                                                *
  5457*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5458*                                                                *
  5459*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5460*   A NAPERSOFT DOCUMENT                                         *
  5461*                                                                *
  5462*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5463*                                                                *
  5464*   FILE TYPE = VSAM,KSDS                                        *
  5465*   RECORD SIZE = 400   RECFORM = FIX                            *
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  96
* NSRASBL.cbl
  5466*                                                                *
  5467*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5468*                                                                *
  5469*   LOG = NO                                                     *
  5470*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5471*                                                                *
  5472*                                                                *
  5473******************************************************************
  5474*                   C H A N G E   L O G
  5475*
  5476* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5477*-----------------------------------------------------------------
  5478*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5479* EFFECTIVE    NUMBER
  5480*-----------------------------------------------------------------
  5481* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5482******************************************************************
  5483 01  ENCLOSURE-CODES.
  5484     12  NC-RECORD-ID                      PIC XX.
  5485         88  VALID-NC-ID                      VALUE 'NC'.
  5486     12  NC-CONTROL-PRIMARY.
  5487         16  NC-COMPANY-CD                 PIC X.
  5488         16  NC-REC-TYPE                   PIC X.
  5489             88  NC-CLAIMS                   VALUE '1'.
  5490             88  NC-ADMIN                    VALUE '2'.
  5491         16  NC-ENC-CODE                   PIC X(5).
  5492         16  FILLER                        PIC X(09).
  5493     12  NC-MAINT-INFORMATION.
  5494         16  NC-LAST-MAINT-DT              PIC XX.
  5495         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5496         16  NC-LAST-MAINT-USER            PIC X(4).
  5497         16  FILLER                        PIC XX.
  5498     12  NC-OUTPUT-STACK                   PIC XXX.
  5499     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5500     12  NC-ATTACHMENTS                    PIC X(100).
  5501     12  NC-FUTURE                         PIC X(50).
  5502     12  FILLER                            PIC X(117).
  5503******************************************************************
  5504****************************************************************
  5505*
  5506* Copyright (c) 2007 by Clerity Solutions, Inc.
  5507* All rights reserved.
  5508*
  5509****************************************************************
  5510 01  DFHEIV.
  5511   02  DFHEIV0               PIC X(35).
  5512   02  DFHEIV1               PIC X(08).
  5513   02  DFHEIV2               PIC X(08).
  5514   02  DFHEIV3               PIC X(08).
  5515   02  DFHEIV4               PIC X(06).
  5516   02  DFHEIV5               PIC X(04).
  5517   02  DFHEIV6               PIC X(04).
  5518   02  DFHEIV7               PIC X(02).
  5519   02  DFHEIV8               PIC X(02).
  5520   02  DFHEIV9               PIC X(01).
  5521   02  DFHEIV10              PIC S9(7) COMP-3.
  5522   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5523   02  DFHEIV12              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  97
* NSRASBL.cbl
  5524   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5525   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5526   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5527   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5528   02  DFHEIV17              PIC X(04).
  5529   02  DFHEIV18              PIC X(04).
  5530   02  DFHEIV19              PIC X(04).
  5531   02  DFHEIV20              USAGE IS POINTER.
  5532   02  DFHEIV21              USAGE IS POINTER.
  5533   02  DFHEIV22              USAGE IS POINTER.
  5534   02  DFHEIV23              USAGE IS POINTER.
  5535   02  DFHEIV24              USAGE IS POINTER.
  5536   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5537   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5538   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5539   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5540   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5541   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5542   02  FILLER                PIC X(02).
  5543   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5544   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5545   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5546   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5547   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5548 LINKAGE  SECTION.
  5549*****************************************************************
  5550*                                                               *
  5551* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5552* All rights reserved.                                          *
  5553*                                                               *
  5554*****************************************************************
  5555 01  dfheiblk.
  5556     02  eibtime          pic s9(7) comp-3.
  5557     02  eibdate          pic s9(7) comp-3.
  5558     02  eibtrnid         pic x(4).
  5559     02  eibtaskn         pic s9(7) comp-3.
  5560     02  eibtrmid         pic x(4).
  5561     02  dfheigdi         pic s9(4) comp.
  5562     02  eibcposn         pic s9(4) comp.
  5563     02  eibcalen         pic s9(4) comp.
  5564     02  eibaid           pic x(1).
  5565     02  eibfiller1       pic x(1).
  5566     02  eibfn            pic x(2).
  5567     02  eibfiller2       pic x(2).
  5568     02  eibrcode         pic x(6).
  5569     02  eibfiller3       pic x(2).
  5570     02  eibds            pic x(8).
  5571     02  eibreqid         pic x(8).
  5572     02  eibrsrce         pic x(8).
  5573     02  eibsync          pic x(1).
  5574     02  eibfree          pic x(1).
  5575     02  eibrecv          pic x(1).
  5576     02  eibsend          pic x(1).
  5577     02  eibatt           pic x(1).
  5578     02  eibeoc           pic x(1).
  5579     02  eibfmh           pic x(1).
  5580     02  eibcompl         pic x(1).
  5581     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  98
* NSRASBL.cbl
  5582     02  eibconf          pic x(1).
  5583     02  eiberr           pic x(1).
  5584     02  eibrldbk         pic x(1).
  5585     02  eiberrcd         pic x(4).
  5586     02  eibsynrb         pic x(1).
  5587     02  eibnodat         pic x(1).
  5588     02  eibfiller5       pic x(2).
  5589     02  eibresp          pic 9(09) comp.
  5590     02  eibresp2         pic 9(09) comp.
  5591     02  dfheigdj         pic s9(4) comp.
  5592     02  dfheigdk         pic s9(4) comp.
  5593 01 dfhcommarea                  PIC X(6500).
  5594
  5595 01  var  pic x(30).
  5596 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  5597 0000-DFHEXIT SECTION.
  5598     MOVE '9#                    $   ' TO DFHEIV0.
  5599     MOVE 'NSRASBL' TO DFHEIV1.
  5600     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5601     display ' entering pgm nsrasbl '
  5602     display ' commarea ' dfhcommarea
  5603     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5604     MOVE '5'                    TO DC-OPTION-CODE
  5605     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5606     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  5607     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  5608     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  5609     MOVE DC-DAY-OF-WEEK         TO SAVE-CYCLE-DAY-OF-WEEK
  5610     move dfhcommarea            to srch-commarea
  5611*****************************************************
  5612* The full       key has been established and passed
  5613* to this program via NSRASLTR
  5614*****************************************************
  5615     PERFORM 1115-MATCH-COMPANY  THRU 1115-EXIT
  5616     display ' input data ' bl-carrier ' ' bl-group ' '
  5617        bl-account ' ' bl-eff-dt ' ' bl-cert-no
  5618     MOVE BL-LETTER-ID           TO OUT-LETTER
  5619     MOVE BL-PROC-ID             TO OUT-PROC-ID
  5620     MOVE BL-CARRIER             TO OUT-CARRIER
  5621     MOVE BL-GROUP               TO OUT-GROUPING
  5622     MOVE BL-ACCOUNT             TO OUT-ACCOUNT
  5623     MOVE BL-PRINT-NOW-SW        TO OUT-PRINT-NOW
  5624     MOVE BL-CERT-FORM-ID        TO OUT-CERTIFICATE-ID
  5625     MOVE BL-SOURCE-SCREEN       TO OUT-SCREEN-ID
  5626     STRING DC-EDITA-CCYY DC-EDITA-MONTH
  5627        DC-EDITA-DAY  DELIMITED BY SIZE
  5628        INTO OUT-CYCLE-DT
  5629     END-STRING
  5630
  5631     set P to address of KIXSYS
  5632     CALL "getenv" using by value P returning var-ptr
  5633     if var-ptr = null then
  5634        display ' kixsys not set '
  5635     else
  5636        set address of var to var-ptr
  5637        move 0 to env-var-len
  5638        inspect var tallying env-var-len
  5639          for characters before X'00'
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page  99
* NSRASBL.cbl
  5640        unstring var (1:env-var-len) delimited by '/'
  5641        into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5642              WS-KIX-SYS
  5643        end-unstring
  5644     end-if
  5645
  5646     set P to address of KIXHOST
  5647     CALL "getenv" using by value P returning var-ptr
  5648     if var-ptr = null then
  5649        display ' kixhost not set '
  5650     else
  5651        set address of var to var-ptr
  5652        move 0 to env-var-len
  5653        inspect var tallying env-var-len
  5654          for characters before X'00'
  5655        MOVE var(1:env-var-len)  to ws-kixhost
  5656        DISPLAY ' WS KIX HOST ' WS-KIXHOST
  5657     end-if
  5658
  5659**** This routine will connect to the Logic Database on SQL Server
  5660**** and call a stored procedure to determine the next business da
  5661
  5662     PERFORM 4100-CONNECT-TO-DB  THRU 4100-EXIT
  5663     IF SQLCODE = 0
  5664        PERFORM 4200-GET-NEXT-BUS-DT  THRU 4200-EXIT
  5665        IF SQLCODE = 0
  5666            MOVE WS-NEXT-BUS-DT TO SAVE-NEXT-BUS-DT-EDIT-A
  5667                                   WS-EDIT-A-DATE
  5668            MOVE WS-EDIT-A-YY   TO DC-YMD-YEAR
  5669            MOVE WS-EDIT-A-MM   TO DC-YMD-MONTH
  5670            MOVE WS-EDIT-A-DD   TO DC-YMD-DAY
  5671            MOVE '3'            TO DC-OPTION-CODE
  5672            PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5673            IF NO-CONVERSION-ERROR
  5674               MOVE DC-BIN-DATE-1 TO SAVE-BIN-NEXT-BUS-DT
  5675            ELSE
  5676               MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5677               MOVE '6'         TO DC-OPTION-CODE
  5678               MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5679               IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5680                  MOVE 3        TO DC-ELAPSED-DAYS
  5681               ELSE
  5682                 IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5683                    MOVE 2     TO DC-ELAPSED-DAYS
  5684                 ELSE
  5685                    MOVE 1     TO DC-ELAPSED-DAYS
  5686                 END-IF
  5687               END-IF
  5688               PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5689               IF NO-CONVERSION-ERROR
  5690                   MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5691                   MOVE DC-GREG-DATE-A-EDIT TO
  5692                                SAVE-NEXT-BUS-DT-EDIT-A
  5693               ELSE
  5694                   MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5695                   MOVE WS-SAVE-EDIT-A-DATE TO
  5696                                SAVE-NEXT-BUS-DT-EDIT-A
  5697               END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 100
* NSRASBL.cbl
  5698            END-IF
  5699        ELSE
  5700            MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5701            MOVE '6'         TO DC-OPTION-CODE
  5702            MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5703            IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5704               MOVE 3        TO DC-ELAPSED-DAYS
  5705            ELSE
  5706              IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5707                 MOVE 2     TO DC-ELAPSED-DAYS
  5708              ELSE
  5709                 MOVE 1     TO DC-ELAPSED-DAYS
  5710              END-IF
  5711            END-IF
  5712            PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5713            IF NO-CONVERSION-ERROR
  5714                MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5715                MOVE DC-GREG-DATE-A-EDIT TO
  5716                                SAVE-NEXT-BUS-DT-EDIT-A
  5717            ELSE
  5718                MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5719                MOVE WS-SAVE-EDIT-A-DATE TO
  5720                                SAVE-NEXT-BUS-DT-EDIT-A
  5721            END-IF
  5722        END-IF
  5723     ELSE
  5724        MOVE SAVE-BIN-DATE TO DC-BIN-DATE-1
  5725        MOVE '6'         TO DC-OPTION-CODE
  5726        MOVE ZEROS       TO DC-ELAPSED-MONTHS
  5727        IF SAVE-CYCLE-DAY-OF-WEEK = 6
  5728           MOVE 3        TO DC-ELAPSED-DAYS
  5729        ELSE
  5730          IF SAVE-CYCLE-DAY-OF-WEEK = 7
  5731             MOVE 2     TO DC-ELAPSED-DAYS
  5732          ELSE
  5733             MOVE 1     TO DC-ELAPSED-DAYS
  5734          END-IF
  5735        END-IF
  5736        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5737        IF NO-CONVERSION-ERROR
  5738            MOVE DC-BIN-DATE-2 TO SAVE-BIN-NEXT-BUS-DT
  5739            MOVE DC-GREG-DATE-A-EDIT TO
  5740                                SAVE-NEXT-BUS-DT-EDIT-A
  5741        ELSE
  5742            MOVE SAVE-BIN-DATE TO SAVE-BIN-NEXT-BUS-DT
  5743            MOVE WS-SAVE-EDIT-A-DATE TO
  5744                                SAVE-NEXT-BUS-DT-EDIT-A
  5745        END-IF
  5746     END-IF
  5747     PERFORM 4300-DISCONNECT THRU 4300-EXIT
  5748
  5749     MOVE SAVE-NEXT-BUS-DT-EDIT-A  TO WS-EDIT-A-DATE
  5750     STRING WS-EDIT-A-CCYY '-' WS-EDIT-A-MM '-'
  5751           WS-EDIT-A-DD ' 00:00:00.0' DELIMITED BY SIZE
  5752              INTO OUT-NEXT-BUS-DT
  5753     END-STRING
  5754     IF BL-EFF-DT = '99/99/99' OR '99/99/9999'
  5755        MOVE HIGH-VALUES         TO WS-PASSED-DT
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 101
* NSRASBL.cbl
  5756     ELSE
  5757        IF BL-EFF-DT = SPACES
  5758           display ' bad eff data ' bl-eff-dt ' ' bl-cert-no
  5759        ELSE
  5760           IF BL-EFF-DT (9:2) = SPACES
  5761              STRING BL-EFF-DT (7:2) BL-EFF-DT (1:2)
  5762                     BL-EFF-DT (4:2)
  5763                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5764              END-STRING
  5765           ELSE
  5766              STRING BL-EFF-DT (9:2) BL-EFF-DT (1:2)
  5767                     BL-EFF-DT (4:2)
  5768                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5769              END-STRING
  5770           END-IF
  5771           MOVE '3'              TO DC-OPTION-CODE
  5772           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5773           IF NO-CONVERSION-ERROR
  5774              MOVE DC-BIN-DATE-1 TO WS-PASSED-DT
  5775           ELSE
  5776              MOVE 'BAD EFF DATE CONVERT ' TO BL-MESSAGE
  5777              SET BL-FAIL TO TRUE
  5778              GO TO 0000-RETURN
  5779           END-IF
  5780        END-IF
  5781     END-IF
  5782     perform 0800-init-out-data  thru 0800-exit
  5783     SET BL-FAIL TO TRUE
  5784******************************************************************
  5785* DATA SOURCE MEANINGS  BL-DATA-SRCE
  5786*    1) FROM ACCT MAINT
  5787*    2) FROM CERT UPDATE
  5788*    3) FROM COMP MAINT
  5789*    4) FROM REVIEW AND CORRECTIONS
  5790******************************************************************
  5791     EVALUATE BL-DATA-SRCE
  5792        WHEN '1'
  5793           PERFORM 0100-DATA-SRCE-1 THRU 0100-EXIT
  5794        WHEN '2'
  5795           PERFORM 0200-DATA-SRCE-2 THRU 0200-EXIT
  5796        WHEN '3'
  5797           PERFORM 0300-DATA-SRCE-3 THRU 0300-EXIT
  5798        WHEN '4'
  5799           PERFORM 0400-DATA-SRCE-4 THRU 0400-EXIT
  5800        WHEN OTHER
  5801           MOVE ' BAD DATA SOURCE CODE ' TO BL-MESSAGE
  5802     END-EVALUATE
  5803     IF BL-OK
  5804        display ' bl write erarch ' bl-write-erarch
  5805        PERFORM 1250-GET-ELLETR  THRU 1250-EXIT
  5806        PERFORM 1700-GET-ELENCC  THRU 1700-EXIT
  5807        IF BL-ARCHIVE-NO = ZEROS
  5808           PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  5809           MOVE WS-ARCHIVE-NO    TO BL-ARCHIVE-NO
  5810           display ' arch zeros, new arch ' bl-archive-no
  5811        END-IF
  5812        MOVE BL-ARCHIVE-NO       TO OUT-ARCH-NO
  5813        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 102
* NSRASBL.cbl
  5814        display ' bl write erarch ' bl-write-erarch
  5815        IF BL-WRITE-ERARCH = 'T' OR 'B'
  5816           PERFORM 0700-WRITE-EXTR THRU 0700-EXIT
  5817           IF BL-FAIL
  5818              GO TO 0000-RETURN
  5819           END-IF
  5820        END-IF
  5821        MOVE W-LETTER-TO-ACCT    TO BL-LETTER-TO-ACCT
  5822        MOVE W-LETTER-TO-BENE    TO BL-LETTER-TO-BENE
  5823     END-IF
  5824     .
  5825 0000-RETURN.
  5826     move srch-commarea          to dfhcommarea
  5827
  5828* exec cics
  5829*       return
  5830*    end-exec
  5831*    MOVE '.(                    ''   #00005730' TO DFHEIV0
  5832     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5833     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5834     MOVE X'2020233030303035373330' TO DFHEIV0(25:11)
  5835     CALL 'kxdfhei1' USING DFHEIV0,
  5836           DFHEIV99,
  5837           DFHEIV99,
  5838           DFHEIV99,
  5839           DFHEIV99,
  5840           DFHEIV99,
  5841           DFHEIV99
  5842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5843     .
  5844 0100-DATA-SRCE-1.
  5845     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5846     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5847     MOVE ' '                    TO WS-ERACCT-SW
  5848     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  5849     MOVE WS-COMPANY-CD          TO WS-ERACCT-COMPANY-CD
  5850     MOVE BL-CARRIER             TO WS-ERACCT-CARRIER
  5851     MOVE BL-GROUP               TO WS-ERACCT-GROUP
  5852     MOVE BL-STATE               TO WS-ERACCT-STATE
  5853     MOVE BL-ACCOUNT             TO WS-ERACCT-ACCOUNT
  5854     MOVE WS-PASSED-DT           TO WS-ERACCT-EXP-DT
  5855                                    WS-CERT-EFF-DT
  5856     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  5857     IF ACCT-FOUND
  5858        MOVE AM-CSR-CODE         TO WS-CSR-ID
  5859        PERFORM 1025-GET-CSR-INFO
  5860                                 THRU 1025-EXIT
  5861        PERFORM 1300-DETERMINE-COMM
  5862                                 THRU 1300-EXIT
  5863        SET BL-OK TO TRUE
  5864     ELSE
  5865        MOVE ' ACCOUNT MASTER NOT FOUND ' TO BL-MESSAGE
  5866        SET BL-FAIL TO TRUE
  5867     END-IF
  5868     .
  5869 0100-EXIT.
  5870     EXIT.
  5871 0200-DATA-SRCE-2.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 103
* NSRASBL.cbl
  5872     display ' made it to data srce 2 '
  5873     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5874     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5875     MOVE ' '                    TO WS-ELCERT-SW
  5876     MOVE WS-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  5877     MOVE BL-CARRIER             TO WS-ELCERT-CARRIER
  5878     MOVE BL-GROUP               TO WS-ELCERT-GROUP
  5879     MOVE BL-STATE               TO WS-ELCERT-STATE
  5880     MOVE BL-ACCOUNT             TO WS-ELCERT-ACCOUNT
  5881     MOVE WS-PASSED-DT           TO WS-ELCERT-EFF-DT
  5882                                    WS-CERT-EFF-DT
  5883     MOVE BL-CERT-NO             TO WS-ELCERT-CERT-NO
  5884
  5885     MOVE ' '                 TO WS-ERACCT-SW
  5886     MOVE LOW-VALUES          TO WS-ERACCT-KEY
  5887     MOVE WS-ELCERT-KEY (1:22) TO WS-ERACCT-KEY (1:22)
  5888     PERFORM 1200-GET-ERACCT  THRU 1200-EXIT
  5889     IF ACCT-FOUND
  5890        MOVE AM-CSR-CODE      TO WS-CSR-ID
  5891        PERFORM 1025-GET-CSR-INFO THRU 1025-EXIT
  5892     END-IF
  5893     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  5894     IF CERT-FOUND
  5895        PERFORM 1130-MATCH-BENCDS THRU 1130-EXIT
  5896        MOVE WS-LF-ABBRV         TO OUT-LF-ABBRV
  5897        MOVE WS-LF-DESC          TO OUT-LF-DESC
  5898        IF WS-LF-EARN = 'B'
  5899           MOVE 'B'              TO OUT-BALLOON-IND
  5900        END-IF
  5901        MOVE WS-WAIT-PER         TO OUT-WAIT-PER
  5902        MOVE WS-RET-ELIM         TO OUT-RET-ELIM
  5903        MOVE WS-AH-DESC          TO OUT-AH-DESC
  5904        MOVE WS-BEN-DAYS         TO OUT-BEN-DAYS
  5905
  5906        IF BL-ENDT-ARCH-NO > ZERO
  5907           MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5908           MOVE BL-ENDT-ARCH-NO    TO WS-ERENDT-ARCHIVE
  5909           PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5910        ELSE
  5911           IF BL-ARCHIVE-NO > ZERO
  5912              MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5913              MOVE BL-ARCHIVE-NO      TO WS-ERENDT-ARCHIVE
  5914              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5915           END-IF
  5916        END-IF
  5917
  5918        IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  5919           AND (OUT-BALLOON-IND = 'B')
  5920           MOVE 'B'              TO OUT-FORM (3:1)
  5921        END-IF
  5922        SET BL-OK TO TRUE
  5923     ELSE
  5924        display ' cert not found ' ws-elcert-cert-no
  5925        MOVE ' CERTIFICATE NOT FOUND ' TO BL-MESSAGE
  5926        SET BL-FAIL TO TRUE
  5927     END-IF
  5928     .
  5929 0200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 104
* NSRASBL.cbl
  5930     EXIT.
  5931 0300-DATA-SRCE-3.
  5932     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5933     MOVE WS-COMPANY-CD          TO WS-ERCOMP-COMPANY-CD
  5934     MOVE BL-CARRIER             TO WS-ERCOMP-CARRIER
  5935     MOVE BL-GROUP               TO WS-ERCOMP-GROUP
  5936     MOVE BL-RESP-NO             TO WS-ERCOMP-RESP-NO
  5937     MOVE BL-ACCOUNT             TO WS-ERCOMP-ACCOUNT
  5938     IF WS-ERCOMP-ACCOUNT = SPACES
  5939        MOVE LOW-VALUES          TO WS-ERCOMP-ACCOUNT
  5940        MOVE 'G'                 TO WS-ERCOMP-REC-TYPE
  5941     ELSE
  5942        MOVE 'A'                 TO WS-ERCOMP-REC-TYPE
  5943     END-IF
  5944     PERFORM 1225-GET-ERCOMP     THRU 1225-EXIT
  5945     IF RESP-NORMAL
  5946        MOVE CO-CSR-CODE         TO WS-CSR-ID
  5947        PERFORM 1025-GET-CSR-INFO
  5948                                 THRU 1025-EXIT
  5949        SET BL-OK TO TRUE
  5950     ELSE
  5951        MOVE ' COMPENSATION MASTER NOT FOUND ' TO BL-MESSAGE
  5952        SET BL-FAIL TO TRUE
  5953     END-IF
  5954     .
  5955 0300-EXIT.
  5956     EXIT.
  5957 0400-DATA-SRCE-4.
  5958     MOVE WS-COMPANY-CD          TO WS-ERPNDB-COMPANY-CD
  5959     MOVE BL-BATCH-NO            TO WS-ERPNDB-BATCH-NO
  5960     MOVE BL-BATCH-SEQ           TO WS-ERPNDB-BATCH-SEQ
  5961     MOVE +0                     TO WS-ERPNDB-CHG-SEQ
  5962     MOVE ' '                    TO WS-ERPNDB-SW WS-ERACCT-SW
  5963                                    WS-ELCERT-SW WS-ERENDT-SW
  5964
  5965* EXEC CICS READ
  5966*         DATASET    ('ERPNDB')
  5967*         INTO       (PENDING-BUSINESS)
  5968*         RIDFLD     (WS-ERPNDB-KEY)
  5969*         RESP       (WS-RESPONSE)
  5970*    END-EXEC
  5971     MOVE LENGTH OF
  5972      PENDING-BUSINESS
  5973       TO DFHEIV11
  5974     MOVE 'ERPNDB' TO DFHEIV1
  5975*    MOVE '&"IL       E          (  N#00005854' TO DFHEIV0
  5976     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5977     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5978     MOVE X'204E233030303035383534' TO DFHEIV0(25:11)
  5979     CALL 'kxdfhei1' USING DFHEIV0,
  5980           DFHEIV1,
  5981           PENDING-BUSINESS,
  5982           DFHEIV11,
  5983           WS-ERPNDB-KEY,
  5984           DFHEIV99,
  5985           DFHEIV99,
  5986           DFHEIV99
  5987     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 105
* NSRASBL.cbl
  5988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5989     IF RESP-NORMAL
  5990        IF PB-RECORD-TYPE = '1' OR '2'
  5991           MOVE PB-CARRIER       TO BL-CARRIER
  5992           MOVE PB-GROUPING      TO BL-GROUP
  5993           MOVE PB-STATE         TO BL-STATE
  5994           MOVE PB-ACCOUNT       TO BL-ACCOUNT
  5995           MOVE PB-CERT-NO       TO BL-CERT-NO
  5996           MOVE PB-CSR-ID        TO WS-CSR-ID
  5997           IF PB-ISSUE
  5998              SET PROCESS-ISSUE TO TRUE
  5999              MOVE PB-I-LF-BENEFIT-CD TO WS-LF-BENCD
  6000              MOVE PB-I-AH-BENEFIT-CD TO WS-AH-BENCD
  6001              MOVE PB-I-LF-PREM-CALC TO OUT-LF-CALC-PRM
  6002              MOVE PB-I-AH-PREM-CALC TO OUT-AH-CALC-PRM
  6003           ELSE
  6004              SET PROCESS-CANCEL TO TRUE
  6005              MOVE PB-CI-LF-BENEFIT-CD TO WS-LF-BENCD
  6006              MOVE PB-CI-AH-BENEFIT-CD TO WS-AH-BENCD
  6007              MOVE PB-C-LF-REF-CALC TO OUT-LF-CALC-REF
  6008              MOVE PB-C-AH-REF-CALC TO OUT-AH-CALC-REF
  6009           END-IF
  6010           PERFORM 1120-MATCH-CARRIER
  6011                                 THRU 1120-EXIT
  6012           PERFORM 1125-MATCH-STATE
  6013                                 THRU 1125-EXIT
  6014           PERFORM 1130-MATCH-BENCDS
  6015                                 THRU 1130-EXIT
  6016           MOVE WS-LF-ABBRV      TO OUT-LF-ABBRV
  6017           MOVE WS-LF-DESC       TO OUT-LF-DESC
  6018                                    OUT-ORIG-LF-DESC
  6019           IF WS-LF-EARN = 'B'
  6020              MOVE 'B'           TO OUT-BALLOON-IND
  6021           END-IF
  6022           MOVE WS-WAIT-PER      TO OUT-WAIT-PER
  6023                                    OUT-ORIG-WAIT-PER
  6024           MOVE WS-RET-ELIM      TO OUT-RET-ELIM
  6025                                    OUT-ORIG-RET-ELIM
  6026           MOVE WS-AH-DESC       TO OUT-AH-DESC
  6027                                    OUT-ORIG-AH-DESC
  6028           MOVE WS-BEN-DAYS      TO OUT-BEN-DAYS
  6029                                    OUT-ORIG-BEN-DAYS
  6030           PERFORM 1025-GET-CSR-INFO
  6031                                 THRU 1025-EXIT
  6032
  6033           MOVE LOW-VALUES       TO WS-ERACCT-KEY
  6034           MOVE PB-CONTROL-BY-ACCOUNT (1:22)
  6035                                 TO WS-ERACCT-KEY (1:22)
  6036           MOVE PB-CERT-EFF-DT   TO WS-CERT-EFF-DT
  6037           PERFORM 1200-GET-ERACCT THRU 1200-EXIT
  6038           IF ACCT-FOUND
  6039              MOVE AM-CSR-CODE      TO WS-CSR-ID
  6040              PERFORM 1025-GET-CSR-INFO
  6041                                    THRU 1025-EXIT
  6042              PERFORM 1300-DETERMINE-COMM
  6043                                    THRU 1300-EXIT
  6044           END-IF
  6045
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 106
* NSRASBL.cbl
  6046           MOVE PB-CONTROL-BY-ACCOUNT (1:33)
  6047                                 TO WS-ELCERT-KEY
  6048           PERFORM 1100-GET-ELCERT
  6049                                 THRU 1100-EXIT
  6050
  6051           IF BL-ENDT-ARCH-NO > ZERO
  6052              MOVE PB-COMPANY-CD   TO WS-ERENDT-COMPANY-CD-A1
  6053              MOVE BL-ENDT-ARCH-NO TO WS-ERENDT-ARCHIVE
  6054              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6055           ELSE
  6056              IF BL-ARCHIVE-NO > ZERO
  6057                 MOVE PB-COMPANY-CD TO WS-ERENDT-COMPANY-CD-A1
  6058                 MOVE BL-ARCHIVE-NO TO WS-ERENDT-ARCHIVE
  6059                 PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  6060              END-IF
  6061           END-IF
  6062
  6063           SET BL-OK TO TRUE
  6064           IF (PB-STATE = 'KY' OR 'MD' OR 'WI')
  6065              AND (OUT-BALLOON-IND = 'B')
  6066              MOVE 'B'           TO OUT-FORM (3:1)
  6067           END-IF
  6068        END-IF
  6069     END-IF
  6070     .
  6071 0400-EXIT.
  6072     EXIT.
  6073 0500-SCRUB-DATA.
  6074*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  6075*   A DIFFERENT DELIMITER IN PROGRAM NSRASLTR BUT
  6076*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  6077*   TO A HEX 26 TO GET BY THE DECODER
  6078     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  6079                                 TO M1
  6080     MOVE OUT-ACCT-NAME          TO WS-WORK-FIELD
  6081     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6082        (A1 > M1)
  6083        OR (WS-WORK-FIELD (A1:1) = '*')
  6084        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  6085        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  6086     END-PERFORM
  6087     IF A1 > M1
  6088        CONTINUE
  6089     ELSE
  6090        MOVE WS-WORK-FIELD (1:A1 - 1)
  6091                                 TO OUT-ACCT-NAME
  6092     END-IF
  6093     MOVE FUNCTION LENGTH(OUT-BENE-NAME)
  6094                                 TO M1
  6095     MOVE OUT-BENE-NAME          TO WS-WORK-FIELD
  6096     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6097        (A1 > M1)
  6098        OR (WS-WORK-FIELD (A1:1) = '*')
  6099        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  6100        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  6101     END-PERFORM
  6102     IF A1 > M1
  6103        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 107
* NSRASBL.cbl
  6104     ELSE
  6105        MOVE WS-WORK-FIELD (1:A1 - 1)
  6106                                 TO OUT-BENE-NAME
  6107     END-IF
  6108     IF OUT-CERT-NO = LOW-VALUES OR SPACES
  6109         MOVE '0000000000 '  TO OUT-CERT-NO
  6110     END-IF
  6111     MOVE +1 TO M1
  6112     MOVE SPACES TO BL-RECORD-PASSED-DATA
  6113     MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  6114                                 TO NS-LEN
  6115     display ' naper output data length ' ns-len
  6116     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  6117        (NAPER-OUTPUT-DATA (A1:11) = 'EndOfString')
  6118        OR (A1 > NS-LEN)
  6119        IF NAPER-OUTPUT-DATA (A1:3) = SPACES
  6120           CONTINUE
  6121        ELSE
  6122           IF NAPER-OUTPUT-DATA (A1:1) = '~'
  6123              MOVE '&'           TO BL-RECORD-PASSED-DATA (M1:1)
  6124              MOVE ' '           TO NAPER-OUTPUT-DATA (A1:1)
  6125              ADD +1 TO M1
  6126           ELSE
  6127              IF NAPER-OUTPUT-DATA (A1:1) = '&'
  6128                 MOVE '%26'      TO BL-RECORD-PASSED-DATA (M1:3)
  6129                 ADD +3 TO M1
  6130              ELSE
  6131                 MOVE NAPER-OUTPUT-DATA (A1:1)
  6132                                 TO BL-RECORD-PASSED-DATA (M1:1)
  6133                 ADD +1 TO M1
  6134              END-IF
  6135           END-IF
  6136        END-IF
  6137     END-PERFORM
  6138     .
  6139 0500-EXIT.
  6140     EXIT.
  6141 0600-GET-ERENDT.
  6142
  6143* EXEC CICS READ
  6144*         DATASET    ('ERENDT2')
  6145*         INTO       (ENDORSEMENT-RECORD)
  6146*         RIDFLD     (WS-ERENDT-KEY-BY-ARCH)
  6147*         RESP       (WS-RESPONSE)
  6148*    END-EXEC
  6149     MOVE LENGTH OF
  6150      ENDORSEMENT-RECORD
  6151       TO DFHEIV11
  6152     MOVE 'ERENDT2' TO DFHEIV1
  6153*    MOVE '&"IL       E          (  N#00006013' TO DFHEIV0
  6154     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6155     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6156     MOVE X'204E233030303036303133' TO DFHEIV0(25:11)
  6157     CALL 'kxdfhei1' USING DFHEIV0,
  6158           DFHEIV1,
  6159           ENDORSEMENT-RECORD,
  6160           DFHEIV11,
  6161           WS-ERENDT-KEY-BY-ARCH,
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 108
* NSRASBL.cbl
  6162           DFHEIV99,
  6163           DFHEIV99,
  6164           DFHEIV99
  6165     MOVE EIBRESP  TO WS-RESPONSE
  6166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6167     DISPLAY ' JUST READ ENDT ' WS-RESPONSE ' '
  6168         WS-ERENDT-ARCHIVE
  6169     IF (RESP-NORMAL)
  6170        SET ENDT-FOUND TO TRUE
  6171        PERFORM 0620-BUILD-ENDT  THRU 0620-EXIT
  6172        PERFORM 0650-PROCESS-NO-Change
  6173                                 THRU 0650-EXIT
  6174     END-IF
  6175     .
  6176 0600-EXIT.
  6177     EXIT.
  6178 0620-BUILD-ENDT.
  6179     MOVE SPACES                 TO OUT-ORIG-LF-CAN-DT
  6180                                    OUT-NEW-LF-CAN-DT
  6181                                    OUT-ORIG-AH-CAN-DT
  6182                                    OUT-NEW-AH-CAN-DT
  6183                                    OUT-ORIG-CAN-DT
  6184                                    OUT-NEW-CAN-DT
  6185     IF EN-REC-TYPE = 'C'
  6186        GO TO 0620-PROCESS-CANCEL
  6187     END-IF
  6188     MOVE EN-LF-ORIG-BENCD       TO WS-LF-BENCD
  6189     MOVE EN-AH-ORIG-BENCD       TO WS-AH-BENCD
  6190     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6191     MOVE WS-LF-DESC             TO OUT-ORIG-LF-DESC
  6192     IF WS-LF-EARN = 'B'
  6193        MOVE 'B'                 TO OUT-BALLOON-IND
  6194     END-IF
  6195     MOVE WS-AH-DESC             TO OUT-ORIG-AH-DESC
  6196     MOVE WS-RET-ELIM            TO OUT-ORIG-RET-ELIM
  6197     MOVE WS-BEN-DAYS            TO OUT-ORIG-BEN-DAYS
  6198     MOVE WS-WAIT-PER            TO OUT-ORIG-WAIT-PER
  6199     MOVE EN-INS-ORIG-LAST-NAME    TO OUT-ORIG-ILNAME
  6200     MOVE EN-INS-ORIG-FIRST-NAME   TO OUT-ORIG-IFNAME
  6201     MOVE EN-INS-ORIG-MIDDLE-INIT  TO OUT-ORIG-MINIT
  6202     IF EN-INS-ORIG-AGE-DEF-FLAG = 'Y'
  6203         MOVE ZERO                 TO OUT-ORIG-IAGE
  6204     ELSE
  6205         MOVE EN-INS-ORIG-AGE      TO OUT-ORIG-IAGE
  6206     END-IF
  6207     MOVE EN-JNT-ORIG-LAST-NAME    TO OUT-ORIG-JLNAME
  6208     MOVE EN-JNT-ORIG-FIRST-NAME   TO OUT-ORIG-JFNAME
  6209     MOVE EN-JNT-ORIG-MIDDLE-INIT  TO OUT-ORIG-JMINIT
  6210     IF EN-JNT-ORIG-AGE-DEF-FLAG = 'Y'
  6211         MOVE ZERO                 TO OUT-ORIG-JAGE
  6212     ELSE
  6213         MOVE EN-JNT-ORIG-AGE      TO OUT-ORIG-JAGE
  6214     END-IF
  6215     MOVE EN-LF-ORIG-BENCD         TO OUT-ORIG-LF-BENCD
  6216     MOVE EN-LF-ORIG-TERM          TO OUT-ORIG-LF-TERM
  6217     MOVE EN-LF-ORIG-BEN-AMT       TO OUT-ORIG-LF-BEN
  6218     MOVE EN-LF-ORIG-PRM-AMT       TO OUT-ORIG-LF-PRM
  6219     MOVE EN-LF-ORIG-ALT-BEN-AMT   TO OUT-ORIG-LF-ALT-BEN
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 109
* NSRASBL.cbl
  6220     MOVE EN-LF-ORIG-ALT-PRM-AMT   TO OUT-ORIG-LF-ALT-PRM
  6221     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6222                             EN-LF-ORIG-ALT-PRM-AMT
  6223     MOVE WS-WRK-AMOUNT          TO OUT-ORIG-LF-CMB-PREM
  6224     IF EN-LF-ORIG-BENCD EQUAL '00' OR SPACES
  6225         MOVE SPACES             TO OUT-ORIG-LF-BEN-A
  6226                                    OUT-ORIG-LF-PRM-A
  6227                                    OUT-ORIG-LF-ALT-BEN-A
  6228                                    OUT-ORIG-LF-ALT-PRM-A
  6229                                    OUT-ORIG-COVERAGE-IND
  6230     ELSE
  6231         MOVE 'LIFE'             TO OUT-ORIG-COVERAGE-IND
  6232         IF EN-LF-ORIG-PRM-AMT = .01
  6233             MOVE SPACES         TO OUT-ORIG-LF-PRM-A
  6234         END-IF
  6235         IF EN-LF-ORIG-BEN-AMT = 999999999.99
  6236             MOVE SPACES         TO OUT-ORIG-LF-BEN-A
  6237         END-IF
  6238         IF EN-LF-ORIG-ALT-PRM-AMT = .01
  6239             MOVE SPACES         TO OUT-ORIG-LF-ALT-PRM-A
  6240         END-IF
  6241         IF EN-LF-ORIG-ALT-BEN-AMT = 999999999.99
  6242             MOVE SPACES         TO OUT-ORIG-LF-ALT-BEN-A
  6243         END-IF
  6244     END-IF
  6245     MOVE EN-LF-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6246     MOVE ' '                    TO DC-OPTION-CODE
  6247     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6248     IF NO-CONVERSION-ERROR
  6249        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6250           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6251              INTO OUT-ORIG-LF-EXP-DT
  6252        END-STRING
  6253     END-IF
  6254     MOVE EN-AH-ORIG-BENCD       TO OUT-ORIG-AH-BENCD
  6255     MOVE EN-AH-ORIG-TERM        TO OUT-ORIG-AH-TERM
  6256     MOVE EN-AH-ORIG-BEN-AMT     TO OUT-ORIG-AH-BEN
  6257     MOVE EN-AH-ORIG-PRM-AMT     TO OUT-ORIG-AH-PRM
  6258     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6259         MOVE SPACES             TO OUT-ORIG-AH-BEN-A
  6260                                    OUT-ORIG-AH-PRM-A
  6261     ELSE
  6262        IF OUT-ORIG-COVERAGE-IND = 'LIFE'
  6263            MOVE 'BOTH'          TO OUT-ORIG-COVERAGE-IND
  6264        ELSE
  6265            MOVE 'AH  '          TO OUT-ORIG-COVERAGE-IND
  6266        END-IF
  6267        IF EN-AH-ORIG-PRM-AMT = .01
  6268            MOVE SPACES          TO OUT-ORIG-AH-PRM-A
  6269        END-IF
  6270        IF EN-AH-ORIG-BEN-AMT = 9999999.99
  6271            MOVE SPACES          TO OUT-ORIG-AH-BEN-A
  6272        END-IF
  6273     END-IF
  6274     COMPUTE WS-WORK-PREM =
  6275        EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT
  6276           + EN-AH-ORIG-PRM-AMT
  6277     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-PREM
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 110
* NSRASBL.cbl
  6278     MOVE EN-AH-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6279     MOVE ' '                    TO DC-OPTION-CODE
  6280     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6281     IF NO-CONVERSION-ERROR
  6282        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6283           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6284              INTO OUT-ORIG-AH-EXP-DT
  6285        END-STRING
  6286     END-IF
  6287     MOVE EN-AH-ORIG-CP          TO OUT-ORIG-CRIT-PER
  6288                                    OUT-ORIG-MAX-PMTS
  6289     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6290         MOVE SPACES             TO OUT-ORIG-MAX-PMTS-A
  6291     END-IF
  6292     MOVE EN-INS-NEW-LAST-NAME    TO OUT-NEW-ILNAME
  6293     MOVE EN-INS-NEW-FIRST-NAME   TO OUT-NEW-IFNAME
  6294     MOVE EN-INS-NEW-MIDDLE-INIT  TO OUT-NEW-IMINIT
  6295     IF EN-INS-NEW-AGE-DEF-FLAG = 'Y'
  6296         MOVE ZERO                TO OUT-NEW-IAGE
  6297     ELSE
  6298         MOVE EN-INS-NEW-AGE      TO OUT-NEW-IAGE
  6299     END-IF
  6300     MOVE EN-JNT-NEW-LAST-NAME    TO OUT-NEW-JLNAME
  6301     MOVE EN-JNT-NEW-FIRST-NAME   TO OUT-NEW-JFNAME
  6302     MOVE EN-JNT-NEW-MIDDLE-INIT  TO OUT-NEW-JMINIT
  6303     IF EN-JNT-NEW-AGE-DEF-FLAG = 'Y'
  6304         MOVE ZERO                TO OUT-NEW-JAGE
  6305     ELSE
  6306         MOVE EN-JNT-NEW-AGE      TO OUT-NEW-JAGE
  6307     END-IF
  6308     MOVE EN-LF-NEW-BENCD        TO WS-LF-BENCD
  6309     MOVE EN-AH-NEW-BENCD        TO WS-AH-BENCD
  6310     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6311     MOVE WS-LF-DESC             TO OUT-NEW-LF-DESC
  6312     IF WS-LF-EARN = 'B'
  6313        MOVE 'B'                 TO OUT-BALLOON-IND
  6314     END-IF
  6315     MOVE WS-AH-DESC             TO OUT-NEW-AH-DESC
  6316     MOVE WS-RET-ELIM            TO OUT-NEW-RET-ELIM
  6317     MOVE WS-BEN-DAYS            TO OUT-NEW-BEN-DAYS
  6318     MOVE WS-WAIT-PER            TO OUT-NEW-WAIT-PER
  6319     MOVE EN-LF-NEW-BENCD         TO OUT-NEW-LF-BENCD
  6320     MOVE EN-LF-NEW-TERM          TO OUT-NEW-LF-TERM
  6321     MOVE EN-LF-NEW-BEN-AMT       TO OUT-NEW-LF-BEN
  6322     MOVE EN-LF-NEW-PRM-AMT       TO OUT-NEW-LF-PRM
  6323     MOVE EN-LF-NEW-ALT-BEN-AMT   TO OUT-NEW-LF-ALT-BEN
  6324     MOVE EN-LF-NEW-ALT-PRM-AMT   TO OUT-NEW-LF-ALT-PRM
  6325     COMPUTE WS-WRK-AMOUNT = EN-LF-NEW-PRM-AMT +
  6326                             EN-LF-NEW-ALT-PRM-AMT
  6327     MOVE WS-WRK-AMOUNT           TO OUT-NEW-LF-CMB-PREM
  6328     IF EN-LF-NEW-BENCD EQUAL '00' OR SPACES
  6329         MOVE SPACES             TO OUT-NEW-LF-BEN-A
  6330                                    OUT-NEW-LF-PRM-A
  6331                                    OUT-NEW-LF-ALT-BEN-A
  6332                                    OUT-NEW-LF-ALT-PRM-A
  6333                                    OUT-NEW-LF-CMB-PREM-A
  6334                                    OUT-NEW-COVERAGE-IND
  6335     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 111
* NSRASBL.cbl
  6336         MOVE 'LIFE'             TO OUT-NEW-COVERAGE-IND
  6337     END-IF
  6338    MOVE EN-LF-NEW-EXP-DT        TO DC-BIN-DATE-1
  6339     MOVE ' '                     TO DC-OPTION-CODE
  6340     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6341     IF NO-CONVERSION-ERROR
  6342        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6343           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6344              INTO OUT-NEW-LF-EXP-DT
  6345        END-STRING
  6346     END-IF
  6347     MOVE EN-AH-NEW-BENCD         TO OUT-NEW-AH-BENCD
  6348     MOVE EN-AH-NEW-TERM          TO OUT-NEW-AH-TERM
  6349     MOVE EN-AH-NEW-BEN-AMT       TO OUT-NEW-AH-BEN
  6350     MOVE EN-AH-NEW-PRM-AMT       TO OUT-NEW-AH-PRM
  6351     COMPUTE WS-WORK-PREM =
  6352        EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT
  6353           + EN-AH-NEW-PRM-AMT
  6354     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-PREM
  6355     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6356         MOVE SPACES             TO OUT-NEW-AH-BEN-A
  6357                                    OUT-NEW-AH-PRM-A
  6358     ELSE
  6359        IF OUT-NEW-COVERAGE-IND = 'LIFE'
  6360            MOVE 'BOTH'          TO OUT-NEW-COVERAGE-IND
  6361        ELSE
  6362            MOVE 'AH  '          TO OUT-NEW-COVERAGE-IND
  6363        END-IF
  6364     END-IF
  6365     MOVE EN-AH-NEW-EXP-DT        TO DC-BIN-DATE-1
  6366     MOVE ' '                     TO DC-OPTION-CODE
  6367     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6368     IF NO-CONVERSION-ERROR
  6369        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6370           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6371              INTO OUT-NEW-AH-EXP-DT
  6372        END-STRING
  6373     END-IF
  6374     MOVE EN-AH-NEW-CP            TO OUT-NEW-CRIT-PER
  6375                                     OUT-NEW-MAX-PMTS
  6376     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6377         MOVE SPACES             TO OUT-NEW-MAX-PMTS-A
  6378     END-IF
  6379     IF EN-LF-ORIG-EXP-DT > EN-AH-ORIG-EXP-DT
  6380        MOVE OUT-ORIG-LF-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6381     ELSE
  6382        MOVE OUT-ORIG-AH-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6383     END-IF
  6384     IF EN-LF-NEW-EXP-DT > EN-AH-NEW-EXP-DT
  6385        MOVE OUT-NEW-LF-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6386     ELSE
  6387        MOVE OUT-NEW-AH-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6388     END-IF
  6389     IF EN-LF-ORIG-TERM > EN-AH-ORIG-TERM
  6390        MOVE EN-LF-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6391     ELSE
  6392        MOVE EN-AH-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6393     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 112
* NSRASBL.cbl
  6394     IF EN-LF-NEW-TERM > EN-AH-NEW-TERM
  6395        MOVE EN-LF-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6396     ELSE
  6397        MOVE EN-AH-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6398     END-IF
  6399     COMPUTE WS-WORK-PREM =
  6400        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6401        EN-AH-NEW-PRM-AMT) -
  6402        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT +
  6403        EN-AH-ORIG-PRM-AMT)
  6404     MOVE WS-WORK-PREM           TO OUT-TOT-PRM-CHG
  6405     IF EN-CSO-PORTION NOT NUMERIC
  6406        MOVE ZEROS               TO EN-CSO-PORTION
  6407     END-IF
  6408     IF EN-ACCT-PORTION NOT NUMERIC
  6409        MOVE ZERO                TO EN-ACCT-PORTION
  6410     END-IF
  6411*    MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6412*    MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6413     IF WS-WORK-PREM > +0
  6414        MOVE 'CSO'               TO OUT-PAYEE
  6415     ELSE
  6416      IF WS-WORK-PREM = +0
  6417         MOVE 'ZERO'             TO OUT-PAYEE
  6418      ELSE
  6419         MOVE 'ACCT'             TO OUT-PAYEE
  6420      END-IF
  6421     END-IF
  6422     COMPUTE WS-ACCT-ORIG-LF-PORT =
  6423        EN-LF-ORIG-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6424     MOVE WS-ACCT-ORIG-LF-PORT TO OUT-ACCT-ORIG-LF-PORT
  6425     COMPUTE WS-ACCT-ORIG-ALT-LF-PORT =
  6426        EN-LF-ORIG-ALT-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6427     MOVE WS-ACCT-ORIG-ALT-LF-PORT TO OUT-ACCT-ORIG-ALT-LF-PORT
  6428     COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6429        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6430        * EN-LF-ORIG-COMM-PCT
  6431     MOVE WS-ACCT-ORIG-CMB-LF-PORT TO OUT-ACCT-ORIG-CMB-LF-PORT
  6432     COMPUTE WS-ACCT-ORIG-AH-PORT =
  6433        EN-AH-ORIG-PRM-AMT * EN-AH-ORIG-COMM-PCT
  6434     MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6435     COMPUTE WS-ACCT-ORIG-PORTION =
  6436        WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6437     MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6438
  6439     COMPUTE WS-CSO-ORIG-LF-PORT =
  6440       EN-LF-ORIG-PRM-AMT - WS-ACCT-ORIG-LF-PORT
  6441     MOVE WS-CSO-ORIG-LF-PORT TO OUT-CSO-ORIG-LF-PORT
  6442     COMPUTE WS-CSO-ORIG-ALT-LF-PORT =
  6443       EN-LF-ORIG-ALT-PRM-AMT - WS-ACCT-ORIG-ALT-LF-PORT
  6444     MOVE WS-CSO-ORIG-ALT-LF-PORT TO OUT-CSO-ORIG-ALT-LF-PORT
  6445     COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6446       (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6447        WS-ACCT-ORIG-CMB-LF-PORT
  6448     MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6449     COMPUTE WS-CSO-ORIG-AH-PORT =
  6450        EN-AH-ORIG-PRM-AMT - WS-ACCT-ORIG-AH-PORT
  6451     MOVE WS-CSO-ORIG-AH-PORT TO OUT-CSO-ORIG-AH-PORT
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 113
* NSRASBL.cbl
  6452     COMPUTE WS-CSO-ORIG-PORTION =
  6453        WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6454     MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6455     COMPUTE WS-ACCT-NEW-LF-PORT =
  6456        EN-LF-NEW-PRM-AMT * EN-LF-NEW-COMM-PCT
  6457     MOVE WS-ACCT-NEW-LF-PORT TO OUT-ACCT-NEW-LF-PORT
  6458     COMPUTE WS-ACCT-NEW-ALT-LF-PORT =
  6459        EN-LF-NEW-ALT-PRM-AMT * EN-LF-NEW-COMM-PCT
  6460     MOVE WS-ACCT-NEW-ALT-LF-PORT TO OUT-ACCT-NEW-ALT-LF-PORT
  6461     COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6462        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT)
  6463        * EN-LF-NEW-COMM-PCT
  6464     MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6465     COMPUTE WS-ACCT-NEW-AH-PORT =
  6466        EN-AH-NEW-PRM-AMT * EN-AH-NEW-COMM-PCT
  6467     MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6468     COMPUTE WS-ACCT-NEW-PORTION =
  6469        WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6470     MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6471
  6472     COMPUTE WS-CSO-NEW-LF-PORT =
  6473       EN-LF-NEW-PRM-AMT - WS-ACCT-NEW-LF-PORT
  6474     MOVE WS-CSO-NEW-LF-PORT TO OUT-CSO-NEW-LF-PORT
  6475     COMPUTE WS-CSO-NEW-ALT-LF-PORT =
  6476       EN-LF-NEW-ALT-PRM-AMT - WS-ACCT-NEW-ALT-LF-PORT
  6477     MOVE WS-CSO-NEW-ALT-LF-PORT TO OUT-CSO-NEW-ALT-LF-PORT
  6478     COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6479       (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6480        WS-ACCT-NEW-CMB-LF-PORT
  6481     MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6482     COMPUTE WS-CSO-NEW-AH-PORT =
  6483        EN-AH-NEW-PRM-AMT - WS-ACCT-NEW-AH-PORT
  6484     MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6485     COMPUTE WS-CSO-NEW-PORTION =
  6486        WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6487     MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6488
  6489     COMPUTE WS-ACCT-LF-PORT-CHG =
  6490        WS-ACCT-NEW-LF-PORT - WS-ACCT-ORIG-LF-PORT
  6491     MOVE WS-ACCT-LF-PORT-CHG TO OUT-ACCT-LF-PORT-CHG
  6492     COMPUTE WS-ACCT-ALT-LF-PORT-CHG =
  6493        WS-ACCT-NEW-ALT-LF-PORT - WS-ACCT-ORIG-ALT-LF-PORT
  6494     MOVE WS-ACCT-ALT-LF-PORT-CHG TO OUT-ACCT-ALT-LF-PORT-CHG
  6495     COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6496        WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6497     MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6498     COMPUTE WS-ACCT-AH-PORT-CHG =
  6499        WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6500     MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6501     COMPUTE WS-ACCT-PORTION-CHG =
  6502        WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6503     MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6504
  6505     COMPUTE WS-CSO-LF-PORT-CHG =
  6506        WS-CSO-NEW-LF-PORT - WS-CSO-ORIG-LF-PORT
  6507     MOVE WS-CSO-LF-PORT-CHG TO OUT-CSO-LF-PORT-CHG
  6508     COMPUTE WS-CSO-ALT-LF-PORT-CHG =
  6509        WS-CSO-NEW-ALT-LF-PORT - WS-CSO-ORIG-ALT-LF-PORT
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 114
* NSRASBL.cbl
  6510     MOVE WS-CSO-ALT-LF-PORT-CHG TO OUT-CSO-ALT-LF-PORT-CHG
  6511     COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6512        WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6513     MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6514     COMPUTE WS-CSO-AH-PORT-CHG =
  6515        WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6516     MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6517     COMPUTE WS-CSO-PORTION-CHG =
  6518        WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6519     MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6520
  6521     COMPUTE WS-WORK-PREM =
  6522         EN-LF-NEW-PRM-AMT - EN-LF-ORIG-PRM-AMT
  6523     MOVE WS-WORK-PREM           TO OUT-LF-PREM-CHG
  6524     COMPUTE WS-WORK-PREM =
  6525         EN-LF-NEW-ALT-PRM-AMT - EN-LF-ORIG-ALT-PRM-AMT
  6526     MOVE WS-WORK-PREM           TO OUT-LF-ALT-PREM-CHG
  6527     COMPUTE WS-WORK-PREM =
  6528        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6529        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6530     MOVE WS-WORK-PREM           TO OUT-LF-CMB-PREM-CHG
  6531     COMPUTE WS-WORK-PREM =
  6532        (EN-AH-NEW-PRM-AMT - EN-AH-ORIG-PRM-AMT)
  6533     MOVE WS-WORK-PREM           TO OUT-AH-PREM-CHG
  6534
  6535     move en-sig-sw              to out-sig-sw
  6536     MOVE EN-HEALTH-APP          TO OUT-HEALTH-APP
  6537     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6538     GO TO 0620-CONTINUE
  6539     .
  6540 0620-PROCESS-CANCEL.
  6541     IF EN-LF-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6542        MOVE EN-LF-ORIG-REF-DT   TO DC-BIN-DATE-1
  6543        MOVE ' '                 TO DC-OPTION-CODE
  6544        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6545        IF NO-CONVERSION-ERROR
  6546           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6547              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6548                 INTO OUT-ORIG-LF-CAN-DT
  6549           END-STRING
  6550        END-IF
  6551        MOVE OUT-ORIG-LF-CAN-DT  TO OUT-ORIG-CAN-DT
  6552     END-IF
  6553
  6554     IF EN-LF-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6555        MOVE EN-LF-NEW-REF-DT    TO DC-BIN-DATE-1
  6556        MOVE ' '                 TO DC-OPTION-CODE
  6557        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6558        IF NO-CONVERSION-ERROR
  6559           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6560              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6561                 INTO OUT-NEW-LF-CAN-DT
  6562           END-STRING
  6563        END-IF
  6564        MOVE OUT-NEW-LF-CAN-DT   TO OUT-NEW-CAN-DT
  6565     END-IF
  6566
  6567     IF EN-AH-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 115
* NSRASBL.cbl
  6568        MOVE EN-AH-ORIG-REF-DT      TO DC-BIN-DATE-1
  6569        MOVE ' '                    TO DC-OPTION-CODE
  6570        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6571        IF NO-CONVERSION-ERROR
  6572           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6573              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6574                 INTO OUT-ORIG-AH-CAN-DT
  6575           END-STRING
  6576        END-IF
  6577        IF EN-AH-ORIG-REF-DT > EN-LF-ORIG-REF-DT
  6578           MOVE OUT-ORIG-AH-CAN-DT  TO OUT-ORIG-CAN-DT
  6579        END-IF
  6580     END-IF
  6581
  6582     IF EN-AH-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6583        MOVE EN-AH-NEW-REF-DT       TO DC-BIN-DATE-1
  6584        MOVE ' '                    TO DC-OPTION-CODE
  6585        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6586        IF NO-CONVERSION-ERROR
  6587           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6588              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6589                 INTO OUT-NEW-AH-CAN-DT
  6590           END-STRING
  6591        END-IF
  6592        IF EN-AH-NEW-REF-DT > EN-LF-NEW-REF-DT
  6593           MOVE OUT-NEW-AH-CAN-DT  TO OUT-NEW-CAN-DT
  6594        END-IF
  6595     END-IF
  6596     MOVE EN-LF-ORIG-REF-AMT     TO OUT-ORIG-LF-REF
  6597     MOVE EN-AH-ORIG-REF-AMT     TO OUT-ORIG-AH-REF
  6598     MOVE EN-LF-NEW-REF-AMT      TO OUT-NEW-LF-REF
  6599     MOVE EN-AH-NEW-REF-AMT      TO OUT-NEW-AH-REF
  6600     COMPUTE WS-WORK-PREM =
  6601        EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6602     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-REF
  6603     COMPUTE WS-WORK-PREM =
  6604        EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6605     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-REF
  6606     COMPUTE WS-WORK-PREM =
  6607        (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6608        (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6609     MOVE WS-WORK-PREM           TO OUT-TOT-REF-CHG
  6610
  6611     COMPUTE WS-WORK-PREM =
  6612        (EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT)
  6613     MOVE WS-WORK-PREM           TO OUT-LF-REF-CHG
  6614     COMPUTE WS-WORK-PREM =
  6615        (EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT)
  6616     MOVE WS-WORK-PREM           TO OUT-AH-REF-CHG
  6617
  6618*     MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6619*     MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6620     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6621
  6622     IF EN-COMM-CHGBK = 'N'
  6623         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6624                                   OUT-CSO-ORIG-ALT-LF-PORT
  6625         MOVE EN-LF-ORIG-REF-AMT TO OUT-CSO-ORIG-CMB-LF-PORT
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 116
* NSRASBL.cbl
  6626         MOVE EN-AH-ORIG-REF-AMT TO OUT-CSO-ORIG-AH-PORT
  6627         COMPUTE WS-CSO-ORIG-PORTION =
  6628             EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6629         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6630         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6631                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6632                                   OUT-ACCT-ORIG-CMB-LF-PORT
  6633                                   OUT-ACCT-ORIG-AH-PORT
  6634                                   OUT-ACCT-ORIG-PORTION
  6635
  6636         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6637                                   OUT-CSO-NEW-ALT-LF-PORT
  6638         MOVE EN-LF-NEW-REF-AMT TO OUT-CSO-NEW-CMB-LF-PORT
  6639         MOVE EN-AH-NEW-REF-AMT TO OUT-CSO-NEW-AH-PORT
  6640         COMPUTE WS-CSO-NEW-PORTION =
  6641             EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6642         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6643         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6644                                   OUT-ACCT-NEW-ALT-LF-PORT
  6645                                   OUT-ACCT-NEW-CMB-LF-PORT
  6646                                   OUT-ACCT-NEW-AH-PORT
  6647                                   OUT-ACCT-NEW-PORTION
  6648
  6649         MOVE ZERO              TO OUT-CSO-LF-PORT-CHG
  6650                                   OUT-CSO-ALT-LF-PORT-CHG
  6651         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6652           EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT
  6653         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6654         COMPUTE WS-CSO-AH-PORT-CHG =
  6655           EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT
  6656         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6657         COMPUTE WS-CSO-PORTION-CHG =
  6658           (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6659           (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6660         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6661         MOVE ZERO              TO OUT-ACCT-LF-PORT-CHG
  6662                                   OUT-ACCT-ALT-LF-PORT-CHG
  6663                                   OUT-ACCT-CMB-LF-PORT-CHG
  6664                                   OUT-ACCT-AH-PORT-CHG
  6665                                   OUT-ACCT-PORTION-CHG
  6666     ELSE
  6667         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6668                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6669         COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6670           (EN-LF-ORIG-REF-AMT * EN-LF-ORIG-REF-COMM-PCT)
  6671         MOVE WS-ACCT-ORIG-CMB-LF-PORT TO
  6672                                  OUT-ACCT-ORIG-CMB-LF-PORT
  6673         COMPUTE WS-ACCT-ORIG-AH-PORT =
  6674           (EN-AH-ORIG-REF-AMT * EN-AH-ORIG-REF-COMM-PCT)
  6675         MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6676         COMPUTE WS-ACCT-ORIG-PORTION =
  6677            WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6678         MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6679
  6680         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6681                                   OUT-CSO-ORIG-ALT-LF-PORT
  6682         COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6683           (EN-LF-ORIG-REF-AMT - WS-ACCT-ORIG-CMB-LF-PORT)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 117
* NSRASBL.cbl
  6684         MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6685         COMPUTE WS-CSO-ORIG-AH-PORT =
  6686           (EN-AH-ORIG-REF-AMT - WS-ACCT-ORIG-AH-PORT)
  6687         MOVE WS-CSO-AH-PORTION  TO OUT-CSO-ORIG-AH-PORT
  6688         COMPUTE WS-CSO-ORIG-PORTION =
  6689            WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6690         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6691
  6692         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6693                                   OUT-ACCT-NEW-ALT-LF-PORT
  6694         COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6695           (EN-LF-NEW-REF-AMT * EN-LF-NEW-REF-COMM-PCT)
  6696         MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6697         COMPUTE WS-ACCT-NEW-AH-PORT =
  6698           (EN-AH-NEW-REF-AMT * EN-AH-NEW-REF-COMM-PCT)
  6699         MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6700         COMPUTE WS-ACCT-NEW-PORTION =
  6701            WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6702         MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6703
  6704         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6705                                   OUT-CSO-NEW-ALT-LF-PORT
  6706         COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6707           (EN-LF-NEW-REF-AMT - WS-ACCT-NEW-CMB-LF-PORT)
  6708         MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6709         COMPUTE WS-CSO-NEW-AH-PORT =
  6710           (EN-AH-NEW-REF-AMT - WS-ACCT-NEW-AH-PORT)
  6711         MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6712         COMPUTE WS-CSO-NEW-PORTION =
  6713            WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6714         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6715
  6716         MOVE ZERO               TO OUT-ACCT-LF-PORT-CHG
  6717                                    OUT-ACCT-ALT-LF-PORT-CHG
  6718         COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6719            WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6720         MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6721         COMPUTE WS-ACCT-AH-PORT-CHG =
  6722            WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6723         MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6724         COMPUTE WS-ACCT-PORTION-CHG =
  6725            WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6726         MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6727
  6728         MOVE ZERO               TO OUT-CSO-LF-PORT-CHG
  6729                                    OUT-CSO-ALT-LF-PORT-CHG
  6730         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6731            WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6732         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6733         COMPUTE WS-CSO-AH-PORT-CHG =
  6734            WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6735         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6736         COMPUTE WS-CSO-PORTION-CHG =
  6737            WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6738         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6739
  6740     END-IF
  6741     .
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 118
* NSRASBL.cbl
  6742 0620-CONTINUE.
  6743     display ' about to bld reason codes ' en-reason-code (1)
  6744     move en-reason-code (1)     to out-rea-cd1
  6745     move en-reason-code (2)     to out-rea-cd2
  6746     move en-reason-code (3)     to out-rea-cd3
  6747     move en-reason-code (4)     to out-rea-cd4
  6748     move en-reason-code (5)     to out-rea-cd5
  6749     move en-reason-code (6)     to out-rea-cd6
  6750     move en-reason-code (7)     to out-rea-cd7
  6751     move en-reason-code (8)     to out-rea-cd8
  6752     move en-reason-code (9)     to out-rea-cd9
  6753     move en-reason-code (10)    to out-rea-cd10
  6754     move en-reason-code (11)    to out-rea-cd11
  6755     move en-reason-code (12)    to out-rea-cd12
  6756*    PERFORM 1300-DETERMINE-COMM
  6757*                                THRU 1300-EXIT
  6758     .
  6759 0620-EXIT.
  6760     EXIT.
  6761 0650-PROCESS-NO-Change.
  6762     IF EN-REC-TYPE = 'C'
  6763        GO TO 0650-PROCESS-CANCEL
  6764     END-IF
  6765     if ((OUT-NEW-ILNAME = OUT-ORIG-ILNAME)
  6766        AND (OUT-NEW-ILNAME NOT = SPACES))
  6767                      AND
  6768        ((OUT-NEW-IFNAME = OUT-ORIG-IFNAME)
  6769        AND (OUT-NEW-IFNAME NOT = SPACES))
  6770                      AND
  6771        ((OUT-NEW-IMINIT = OUT-ORIG-MINIT)
  6772        AND (OUT-NEW-IFNAME NOT = SPACES))
  6773        move 'No Change'         to out-new-Ifname
  6774        MOVE SPACES              TO OUT-NEW-IMINIT
  6775        move spaces              to out-new-Ilname
  6776     ELSE
  6777         IF OUT-NEW-ILNAME = SPACES
  6778           AND OUT-NEW-IFNAME = SPACES
  6779           AND OUT-NEW-IMINIT = SPACES
  6780           AND OUT-ORIG-ILNAME NOT = SPACES
  6781            MOVE 'None'          TO OUT-NEW-IFNAME
  6782            MOVE SPACES          TO OUT-NEW-IMINIT
  6783            MOVE SPACES          TO OUT-NEW-ILNAME
  6784         END-IF
  6785     END-IF
  6786     IF ((OUT-NEW-JLNAME = OUT-ORIG-JLNAME)
  6787        AND (OUT-NEW-JLNAME NOT = SPACES))
  6788                    AND
  6789        ((OUT-NEW-JFNAME = OUT-ORIG-JFNAME)
  6790        AND (OUT-NEW-JFNAME NOT = SPACES))
  6791                    AND
  6792        ((OUT-NEW-JMINIT = OUT-ORIG-JMINIT)
  6793        AND (OUT-NEW-JFNAME NOT = SPACES))
  6794        MOVE 'No Change'         TO OUT-NEW-JFNAME
  6795        MOVE SPACES              TO OUT-NEW-JMINIT
  6796        MOVE SPACES              TO OUT-NEW-JLNAME
  6797     ELSE
  6798         IF OUT-NEW-JLNAME = SPACES
  6799           AND OUT-NEW-JFNAME = SPACES
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 119
* NSRASBL.cbl
  6800           AND OUT-NEW-JMINIT = SPACES
  6801           AND OUT-ORIG-JLNAME NOT = SPACES
  6802            MOVE 'None'          TO OUT-NEW-JFNAME
  6803            MOVE SPACES          TO OUT-NEW-JMINIT
  6804            MOVE SPACES          TO OUT-NEW-JLNAME
  6805         END-IF
  6806     END-IF
  6807     IF (EN-LF-NEW-BEN-AMT = EN-LF-ORIG-BEN-AMT)
  6808        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6809        MOVE 'No Change'         TO OUT-NEW-LF-BEN-A
  6810     ELSE
  6811         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6812           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6813             MOVE ZEROS          TO OUT-NEW-LF-BEN
  6814         END-IF
  6815     END-IF
  6816     IF (EN-LF-NEW-PRM-AMT = EN-LF-ORIG-PRM-AMT)
  6817        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6818        MOVE 'No Change'         TO OUT-NEW-LF-PRM-A
  6819     ELSE
  6820         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6821           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6822             MOVE ZEROS          TO OUT-NEW-LF-PRM
  6823         END-IF
  6824     END-IF
  6825     IF (EN-LF-NEW-ALT-BEN-AMT = EN-LF-ORIG-ALT-BEN-AMT)
  6826        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6827        MOVE 'No Change'         TO OUT-NEW-LF-ALT-BEN-A
  6828     ELSE
  6829         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6830           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6831             MOVE ZEROS          TO OUT-NEW-LF-ALT-BEN
  6832         END-IF
  6833     END-IF
  6834     IF (EN-LF-NEW-ALT-PRM-AMT = EN-LF-ORIG-ALT-PRM-AMT)
  6835        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6836        MOVE 'No Change'         TO OUT-NEW-LF-ALT-PRM-A
  6837     ELSE
  6838         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6839           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6840             MOVE ZEROS          TO OUT-NEW-LF-ALT-PRM
  6841         END-IF
  6842     END-IF
  6843
  6844     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6845                              EN-LF-ORIG-ALT-PRM-AMT
  6846     COMPUTE WS-WRK-AMOUNT2 = EN-LF-NEW-PRM-AMT +
  6847                               EN-LF-NEW-ALT-PRM-AMT
  6848     IF (WS-WRK-AMOUNT2 = WS-WRK-AMOUNT)
  6849        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6850        MOVE 'No Change'         TO OUT-NEW-LF-CMB-PREM-A
  6851     ELSE
  6852         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6853           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6854            MOVE ZEROS          TO OUT-NEW-LF-CMB-PREM
  6855         END-IF
  6856     END-IF
  6857     IF OUT-NEW-SCHED-EXP-DT = OUT-ORIG-SCHED-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 120
* NSRASBL.cbl
  6858        MOVE 'No Change'         TO OUT-NEW-SCHED-EXP-DT
  6859     END-IF
  6860     IF (OUT-NEW-LF-EXP-DT = OUT-ORIG-LF-EXP-DT)
  6861        AND (OUT-NEW-LF-EXP-DT NOT = SPACES)
  6862        MOVE 'No Change'         TO OUT-NEW-LF-EXP-DT
  6863     END-IF
  6864     IF (OUT-NEW-LF-DESC = OUT-ORIG-LF-DESC)
  6865        AND (OUT-NEW-LF-DESC NOT = SPACES)
  6866        MOVE 'No Change'         to OUT-NEW-LF-DESC
  6867     ELSE
  6868        IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6869          AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6870            MOVE 'None'          TO OUT-NEW-LF-DESC
  6871        END-IF
  6872     end-if
  6873     IF (OUT-NEW-AH-EXP-DT = OUT-ORIG-AH-EXP-DT)
  6874       AND (OUT-NEW-AH-EXP-DT NOT = SPACES)
  6875        MOVE 'No Change'          TO OUT-NEW-AH-EXP-DT
  6876     END-IF
  6877     IF (EN-AH-NEW-BEN-AMT = EN-AH-ORIG-BEN-AMT)
  6878        AND (EN-AH-ORIG-BEN-AMT NOT = ZEROS)
  6879        MOVE 'No Change'         TO OUT-NEW-AH-BEN-A
  6880     ELSE
  6881         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6882           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6883             MOVE ZEROS          TO OUT-NEW-AH-BEN
  6884         END-IF
  6885     END-IF
  6886     IF (EN-AH-NEW-PRM-AMT = EN-AH-ORIG-PRM-AMT)
  6887        AND (EN-AH-ORIG-PRM-AMT NOT = ZEROS)
  6888        MOVE 'No Change'         TO OUT-NEW-AH-PRM-A
  6889     ELSE
  6890         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6891           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6892             MOVE ZEROS          TO OUT-NEW-AH-PRM
  6893         END-IF
  6894     END-IF
  6895     IF (OUT-NEW-AH-DESC = OUT-ORIG-AH-DESC)
  6896        AND (OUT-ORIG-AH-DESC NOT = SPACES)
  6897        MOVE 'No Change'         TO OUT-NEW-AH-DESC
  6898     ELSE
  6899         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6900           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6901             MOVE 'None'         TO OUT-NEW-AH-DESC
  6902         END-IF
  6903     END-IF
  6904     IF EN-INS-ORIG-AGE-DEF-FLAG <> 'Y'
  6905         MOVE 'N' TO EN-INS-ORIG-AGE-DEF-FLAG
  6906     END-IF
  6907     IF EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  6908         MOVE 'N' TO EN-INS-NEW-AGE-DEF-FLAG
  6909     END-IF
  6910     IF EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y'
  6911         MOVE 'N' TO EN-JNT-ORIG-AGE-DEF-FLAG
  6912     END-IF
  6913     IF EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  6914         MOVE 'N' TO EN-JNT-NEW-AGE-DEF-FLAG
  6915     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 121
* NSRASBL.cbl
  6916
  6917     IF EN-INS-NEW-AGE = EN-INS-ORIG-AGE
  6918       AND EN-INS-NEW-AGE-DEF-FLAG = EN-INS-ORIG-AGE-DEF-FLAG
  6919       AND EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  6920       AND EN-INS-NEW-LAST-NAME = EN-INS-ORIG-LAST-NAME
  6921       AND EN-INS-NEW-FIRST-NAME = EN-INS-ORIG-FIRST-NAME
  6922       AND EN-INS-NEW-MIDDLE-INIT = EN-INS-ORIG-MIDDLE-INIT
  6923        MOVE 'No Change'         TO OUT-NEW-IAGE-A
  6924     END-IF
  6925     IF (EN-JNT-NEW-AGE = EN-JNT-ORIG-AGE)
  6926        AND (EN-JNT-ORIG-AGE NOT = ZEROS)
  6927        AND EN-JNT-NEW-AGE-DEF-FLAG = EN-JNT-ORIG-AGE-DEF-FLAG
  6928        AND EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  6929        AND EN-JNT-NEW-LAST-NAME = EN-JNT-ORIG-LAST-NAME
  6930        AND EN-JNT-NEW-FIRST-NAME = EN-JNT-ORIG-FIRST-NAME
  6931        AND EN-JNT-NEW-MIDDLE-INIT = EN-JNT-ORIG-MIDDLE-INIT
  6932        MOVE 'No Change'         TO OUT-NEW-JAGE-A
  6933     ELSE
  6934         IF (EN-JNT-ORIG-AGE > ZEROS)
  6935           AND (EN-JNT-ORIG-AGE-DEF-FLAG <> 'Y')
  6936           AND (EN-JNT-NEW-AGE = ZEROS OR SPACES)
  6937             MOVE 'None'         TO OUT-NEW-JAGE-A
  6938         END-IF
  6939     END-IF
  6940     IF (EN-LF-NEW-TERM = EN-LF-ORIG-TERM)
  6941        AND (EN-LF-ORIG-TERM NOT = ZEROS)
  6942        MOVE 'No Change'         TO OUT-NEW-LF-TERM-A
  6943     ELSE
  6944         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6945           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6946             MOVE ZEROS          TO OUT-NEW-LF-TERM
  6947         END-IF
  6948     END-IF
  6949     IF (EN-AH-NEW-TERM = EN-AH-ORIG-TERM)
  6950        AND (EN-AH-ORIG-TERM NOT = ZEROS)
  6951        MOVE 'No Change'         TO OUT-NEW-AH-TERM-A
  6952     ELSE
  6953         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6954           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6955             MOVE ZEROS          TO OUT-NEW-AH-TERM
  6956         END-IF
  6957     END-IF
  6958     IF (EN-AH-NEW-CP = EN-AH-ORIG-CP)
  6959        AND (EN-AH-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6960        MOVE 'No Change'         TO OUT-NEW-CRIT-PER-A
  6961                                    OUT-NEW-MAX-PMTS-A
  6962     ELSE
  6963         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6964           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6965             MOVE 'None'         TO OUT-NEW-CRIT-PER-A
  6966                                    OUT-NEW-MAX-PMTS-A
  6967         END-IF
  6968     END-IF
  6969     IF OUT-NEW-SCHED-TERM = OUT-ORIG-SCHED-TERM
  6970        MOVE 'No Change'         TO OUT-NEW-SCHED-TERM-A
  6971     END-IF
  6972     IF (OUT-NEW-WAIT-PER = OUT-ORIG-WAIT-PER)
  6973       AND (OUT-ORIG-WAIT-PER NOT = SPACES)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 122
* NSRASBL.cbl
  6974         MOVE 'No Change'        TO OUT-NEW-WAIT-PER
  6975     ELSE
  6976         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6977           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6978             MOVE 'None'         TO OUT-NEW-WAIT-PER
  6979         END-IF
  6980     END-IF
  6981     .
  6982 0650-PROCESS-CANCEL.
  6983     .
  6984 0650-EXIT.
  6985     EXIT.
  6986 0700-WRITE-EXTR.
  6987     display ' made it to 0700 '
  6988     PERFORM 1000-BUILD-ERARCH   THRU 1000-EXIT
  6989     IF BL-FAIL
  6990        MOVE ' COULDNT BUILD ERARCH ' TO BL-MESSAGE
  6991        GO TO 0700-EXIT
  6992     END-IF
  6993     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  6994     MOVE BL-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  6995     MOVE +0                     TO NSAS-SEQ-NO
  6996     PERFORM 0710-BUILD-NSASEXTR THRU 0710-EXIT
  6997     PERFORM 0720-WRITE-NSASEXTR THRU 0720-EXIT
  6998     IF BL-FAIL
  6999        MOVE ' COULDNT BUILD STD NSASEXTR ' TO BL-MESSAGE
  7000        GO TO 0700-EXIT
  7001     END-IF
  7002     IF W-LETTER-TO-ACCT NOT = SPACES
  7003        display ' acct ne spaces ' bl-archive-no
  7004        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  7005        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  7006        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  7007        MOVE +1                  TO NSAS-SEQ-NO
  7008        PERFORM 0720-WRITE-NSASEXTR
  7009                                 THRU 0720-EXIT
  7010        IF BL-FAIL
  7011           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO BL-MESSAGE
  7012           GO TO 0700-EXIT
  7013        END-IF
  7014     END-IF
  7015     IF W-LETTER-TO-BENE NOT = SPACES
  7016        display ' bene ne spaces ' bl-archive-no
  7017        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  7018        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  7019        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  7020        MOVE +2                  TO NSAS-SEQ-NO
  7021        PERFORM 0720-WRITE-NSASEXTR
  7022                                 THRU 0720-EXIT
  7023        IF BL-FAIL
  7024           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO BL-MESSAGE
  7025        END-IF
  7026     END-IF
  7027     IF W-PRINT-CERTIFICATE = 'Y' AND
  7028        BL-STATE = 'VA'
  7029           MOVE OUT-ACCT-NAME       TO VD-ACCOUNT-NAME
  7030           MOVE WS-COMPANY-CD       TO VD-COMPANY-CD
  7031           MOVE BL-CARRIER          TO VD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 123
* NSRASBL.cbl
  7032           MOVE BL-GROUP            TO VD-GROUPING
  7033           MOVE BL-STATE            TO VD-STATE
  7034           MOVE BL-ACCOUNT          TO VD-ACCOUNT
  7035           MOVE WS-ELCERT-EFF-DT    TO VD-CERT-EFF-DT
  7036           MOVE BL-CERT-NO          TO VD-CERT-NO
  7037           MOVE OUT-ILNAME          TO VD-INSURED-LAST-NAME
  7038           MOVE OUT-IFNAME          TO VD-INSURED-FIRST-NAME
  7039           MOVE OUT-IMINIT          TO VD-INSURED-MIDDLE-INIT
  7040           MOVE OUT-JLNAME          TO VD-JOINT-LAST-NAME
  7041           MOVE OUT-JFNAME          TO VD-JOINT-FIRST-NAME
  7042           MOVE OUT-JMINIT          TO VD-JOINT-MIDDLE-INIT
  7043           MOVE OUT-BENE-NAME       TO VD-BENEFICIARY-NAME
  7044           MOVE OUT-ENTRY-BATCH     TO VD-ENTRY-BATCH
  7045           MOVE OUT-CSR-CODE        TO VD-CSR-ID
  7046           MOVE CM-LF-BENEFIT-CD    TO VD-LF-BENEFIT-CD
  7047           MOVE CM-LF-PREMIUM-AMT   TO VD-LF-PREMIUM-AMT
  7048           MOVE CM-LF-BENEFIT-AMT   TO VD-LF-BENEFIT-AMT
  7049           MOVE CM-LF-ORIG-TERM     TO VD-LF-TERM
  7050           MOVE CM-LF-PREMIUM-RATE  TO VD-LF-RATE
  7051           MOVE CM-AH-BENEFIT-CD    TO VD-AH-BENEFIT-CD
  7052           MOVE CM-AH-PREMIUM-AMT   TO VD-AH-PREMIUM-AMT
  7053           MOVE CM-AH-BENEFIT-AMT   TO VD-AH-BENEFIT-AMT
  7054           MOVE CM-AH-ORIG-TERM     TO VD-AH-TERM
  7055           MOVE CM-AH-PREMIUM-RATE  TO VD-AH-RATE
  7056           MOVE CM-LOAN-TERM        TO VD-LOAN-TERM
  7057           MOVE CM-LOAN-APR         TO VD-LOAN-APR
  7058           MOVE CM-LOAN-1ST-PMT-DT  TO VD-1ST-PMT-DT
  7059           MOVE OUT-INS-ADDR1       TO VD-INSURED-ADDRESS-1
  7060           MOVE OUT-INS-ADDR2       TO VD-INSURED-ADDRESS-2
  7061           MOVE OUT-INS-CITY        TO VD-INSURED-CITY
  7062           MOVE OUT-INS-STATE       TO VD-INSURED-STATE
  7063           MOVE OUT-INS-ZIP         TO VD-INSURED-ZIP-CODE
  7064           MOVE 'VADS'              TO VD-LETTER-ID
  7065           MOVE OUT-PROC-ID         TO VD-PROC-ID
  7066           MOVE BL-COMP-ID          TO VD-COMP-ID
  7067           MOVE EIBTIME             TO VD-CURRENT-TIME
  7068           MOVE SAVE-BIN-DATE       TO VD-CURRENT-DATE
  7069           MOVE BL-ARCHIVE-NO       TO VD-ARCHIVE-NO
  7070           MOVE VIRGINIA-DISCLOSURE TO WS-PASS-VADS-REC
  7071
  7072* EXEC CICS LINK
  7073*              PROGRAM    (LINK-ELVADS)
  7074*              COMMAREA   (WS-PASS-AREA)
  7075*              LENGTH     (WS-PASS-AREA-LENGTH)
  7076*          END-EXEC
  7077*    MOVE '."C                   (   #00006923' TO DFHEIV0
  7078     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7079     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7080     MOVE X'2020233030303036393233' TO DFHEIV0(25:11)
  7081     CALL 'kxdfhei1' USING DFHEIV0,
  7082           LINK-ELVADS,
  7083           WS-PASS-AREA,
  7084           WS-PASS-AREA-LENGTH,
  7085           DFHEIV99,
  7086           DFHEIV99,
  7087           DFHEIV99,
  7088           DFHEIV99
  7089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 124
* NSRASBL.cbl
  7090     END-IF
  7091     .
  7092 0700-EXIT.
  7093     EXIT.
  7094  0710-BUILD-NSASEXTR.
  7095***  i added the extra space in front of the 1st ~
  7096***  only because there may be a letter to acct or bene
  7097     STRING
  7098         OUT-LETTER             ' ~'
  7099         OUT-PROC-ID            '~'
  7100         OUT-PROC-NAME          '~'
  7101         OUT-PROC-TITLE         '~'
  7102         OUT-CSR-NAME           '~'
  7103         OUT-CSR-TITLE          '~'
  7104         OUT-CARRIER            '~'
  7105         OUT-GROUPING           '~'
  7106         OUT-STATE              '~'
  7107         OUT-ACCOUNT            '~'
  7108         OUT-CERT-EFF-DT        '~'
  7109         OUT-CERT-NO            '~'
  7110         OUT-CERT-SFX           '~'
  7111         OUT-ILNAME             '~'
  7112         OUT-IFNAME             '~'
  7113         OUT-IFINIT             '~'
  7114         OUT-IMINIT             '~'
  7115         OUT-IAGE               '~'
  7116         OUT-ISEX               '~'
  7117         OUT-INS-ADDR1          '~'
  7118         OUT-INS-ADDR2          '~'
  7119         OUT-INS-CITY           '~'
  7120         OUT-INS-STATE          '~'
  7121         OUT-INS-ZIP            '~'
  7122         OUT-SOC-SEC-NO         '~'
  7123         OUT-MEMBER-NO          '~'
  7124         OUT-JLNAME             '~'
  7125         OUT-JFNAME             '~'
  7126         OUT-JMINIT             '~'
  7127         OUT-JAGE               '~'
  7128         OUT-ACCT-NAME          '~'
  7129         OUT-ACCT-ADDR1         '~'
  7130         OUT-ACCT-ADDR2         '~'
  7131         OUT-ACCT-CITY          '~'
  7132         OUT-ACCT-STATE         '~'
  7133         OUT-ACCT-ZIP           '~'
  7134         OUT-ACCT-PHONE         '~'
  7135         OUT-ACCT-CNTRL-NAME    '~'
  7136         OUT-ACCT-BUS-TYPE      '~'
  7137         OUT-BENE-NAME          '~'
  7138         OUT-BENE-ADDR1         '~'
  7139         OUT-BENE-ADDR2         '~'
  7140         OUT-BENE-CITY          '~'
  7141         OUT-BENE-STATE         '~'
  7142         OUT-BENE-ZIP           '~'
  7143         OUT-CARR-NAME          '~'
  7144         OUT-RESP-NO            '~'
  7145         OUT-COMP-NAME          '~'
  7146         OUT-COMP-MAIL-TO       '~'
  7147         OUT-COMP-ADDR1         '~'
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 125
* NSRASBL.cbl
  7148         OUT-COMP-ADDR2         '~'
  7149         OUT-COMP-CITY          '~'
  7150         OUT-COMP-STATE         '~'
  7151         OUT-COMP-ZIP           '~'
  7152         OUT-COMP-PHONE         '~'
  7153         OUT-COMP-FAX           '~'
  7154         OUT-COMP-STATUS        '~'
  7155         OUT-BILL-SW            '~'
  7156         OUT-RPT-CD1            '~'
  7157         OUT-RPT-CD2            '~'
  7158         OUT-ENTRY-DT           '~'
  7159         OUT-ENTRY-BATCH        '~'
  7160         OUT-ENTRY-STATUS       '~'
  7161         OUT-1ST-PMT-DT         '~'
  7162         OUT-LOAN-APR           '~'
  7163         OUT-LOAN-TERM          '~'
  7164         OUT-RATE-CLASS         '~'
  7165         OUT-EXT-DAYS           '~'
  7166         OUT-CSR-CODE           '~'
  7167         OUT-UCODE              '~'
  7168         OUT-PREM-TYPE          '~'
  7169         OUT-IND-GRP            '~'
  7170         OUT-SKIP-CD            '~'
  7171         OUT-PMT-MODE           '~'
  7172         OUT-LOAN-OFF           '~'
  7173         OUT-REIN-TABLE         '~'
  7174         OUT-SPEC-REIN          '~'
  7175         OUT-LF-BENCD           '~'
  7176         OUT-LF-TERM            '~'
  7177         OUT-LF-DEV-CD          '~'
  7178         OUT-LF-DEV-PCT         '~'
  7179         OUT-LF-BEN             '~'
  7180         OUT-LF-PRM             '~'
  7181         OUT-LF-ALT-BEN         '~'
  7182         OUT-LF-ALT-PRM         '~'
  7183         OUT-LF-NSP             '~'
  7184         OUT-LF-REM-BEN         '~'
  7185         OUT-LF-REF             '~'
  7186         OUT-LF-DTH             '~'
  7187         OUT-LF-RATE            '~'
  7188         OUT-LF-ALT-RATE        '~'
  7189         OUT-LF-EXP-DT          '~'
  7190         OUT-LF-CUR-STATUS      '~'
  7191         OUT-LF-CAN-DT          '~'
  7192         OUT-LF-CAN-EXIT-DT     '~'
  7193         OUT-LF-DTH-DT          '~'
  7194         OUT-LF-DTH-EXIT-DT     '~'
  7195         OUT-LF-EXIT-BATCH      '~'
  7196         OUT-LF-COMM-PCT        '~'
  7197         OUT-LF-DESC            '~'
  7198         OUT-LF-ABBRV           '~'
  7199         OUT-AH-BENCD           '~'
  7200         OUT-AH-TERM            '~'
  7201         OUT-CRIT-PER           '~'
  7202         OUT-AH-DEV-CD          '~'
  7203         OUT-AH-DEV-PCT         '~'
  7204         OUT-AH-BEN             '~'
  7205         OUT-AH-PRM             '~'
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 126
* NSRASBL.cbl
  7206         OUT-AH-NSP             '~'
  7207         OUT-AH-REF             '~'
  7208         OUT-AH-CLM             '~'
  7209         OUT-AH-TOT-BEN         '~'
  7210         OUT-AH-PDTHRU-DT       '~'
  7211         OUT-AH-RATE            '~'
  7212         OUT-AH-EXP-DT          '~'
  7213         OUT-AH-CUR-STATUS      '~'
  7214         OUT-AH-CAN-DT          '~'
  7215         OUT-AH-CAN-EXIT-DT     '~'
  7216         OUT-AH-EXIT-BATCH      '~'
  7217         OUT-AH-COMM-PCT        '~'
  7218         OUT-AH-DESC            '~'
  7219         OUT-RET-ELIM           '~'
  7220         OUT-BEN-DAYS           '~'
  7221         OUT-WAIT-PER           '~'
  7222         OUT-MAX-PMTS           '~'
  7223         OUT-TOT-PRM            '~'
  7224         OUT-TOT-REF            '~'
  7225         OUT-SCHED-EXP-DT       '~'
  7226         OUT-SCHED-TERM         '~'
  7227         OUT-ORIG-ILNAME        '~'
  7228         OUT-ORIG-IFNAME        '~'
  7229         OUT-ORIG-MINIT         '~'
  7230         OUT-ORIG-IAGE          '~'
  7231         OUT-ORIG-JLNAME        '~'
  7232         OUT-ORIG-JFNAME        '~'
  7233         OUT-ORIG-JMINIT        '~'
  7234         OUT-ORIG-JAGE          '~'
  7235         OUT-ORIG-LF-BENCD      '~'
  7236         OUT-ORIG-LF-TERM       '~'
  7237         OUT-ORIG-LF-BEN        '~'
  7238         OUT-ORIG-LF-PRM        '~'
  7239         OUT-LF-CALC-PRM        '~'
  7240         OUT-ORIG-LF-REF        '~'
  7241         OUT-LF-CALC-REF        '~'
  7242         OUT-ORIG-LF-ALT-BEN    '~'
  7243         OUT-ORIG-LF-ALT-PRM    '~'
  7244         OUT-ORIG-LF-EXP-DT     '~'
  7245         OUT-ORIG-LF-DESC       '~'
  7246         OUT-ORIG-AH-BENCD      '~'
  7247         OUT-ORIG-AH-TERM       '~'
  7248         OUT-ORIG-CRIT-PER      '~'
  7249         OUT-ORIG-AH-BEN        '~'
  7250         OUT-ORIG-AH-PRM        '~'
  7251         OUT-AH-CALC-PRM        '~'
  7252         OUT-ORIG-AH-REF        '~'
  7253         OUT-AH-CALC-REF        '~'
  7254         OUT-ORIG-AH-EXP-DT     '~'
  7255         OUT-ORIG-AH-DESC       '~'
  7256         OUT-ORIG-RET-ELIM      '~'
  7257         OUT-ORIG-BEN-DAYS      '~'
  7258         OUT-ORIG-WAIT-PER      '~'
  7259         OUT-ORIG-MAX-PMTS      '~'
  7260         OUT-ORIG-SCHED-EXP-DT  '~'
  7261         OUT-ORIG-SCHED-TERM    '~'
  7262         OUT-NEW-ILNAME         '~'
  7263         OUT-NEW-IFNAME         '~'
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 127
* NSRASBL.cbl
  7264         OUT-NEW-IMINIT         '~'
  7265         OUT-NEW-IAGE           '~'
  7266         OUT-NEW-JLNAME         '~'
  7267         OUT-NEW-JFNAME         '~'
  7268         OUT-NEW-JMINIT         '~'
  7269         OUT-NEW-JAGE           '~'
  7270         OUT-NEW-LF-BENCD       '~'
  7271         OUT-NEW-LF-TERM        '~'
  7272         OUT-NEW-LF-BEN         '~'
  7273         OUT-NEW-LF-PRM         '~'
  7274         OUT-NEW-LF-REF         '~'
  7275         OUT-NEW-LF-ALT-BEN     '~'
  7276         OUT-NEW-LF-ALT-PRM     '~'
  7277         OUT-NEW-LF-EXP-DT      '~'
  7278         OUT-NEW-LF-DESC        '~'
  7279         OUT-NEW-AH-BENCD       '~'
  7280         OUT-NEW-AH-TERM        '~'
  7281         OUT-NEW-CRIT-PER       '~'
  7282         OUT-NEW-AH-BEN         '~'
  7283         OUT-NEW-AH-PRM         '~'
  7284         OUT-NEW-AH-REF         '~'
  7285         OUT-NEW-AH-EXP-DT      '~'
  7286         OUT-NEW-AH-DESC        '~'
  7287         OUT-NEW-RET-ELIM       '~'
  7288         OUT-NEW-BEN-DAYS       '~'
  7289         OUT-NEW-WAIT-PER       '~'
  7290         OUT-NEW-MAX-PMTS       '~'
  7291         OUT-NEW-SCHED-EXP-DT   '~'
  7292         OUT-NEW-SCHED-TERM     '~'
  7293         OUT-TOT-PRM-CHG        '~'
  7294         OUT-TOT-REF-CHG        '~'
  7295         OUT-PAYEE              '~'
  7296         OUT-SIG-SW             '~'
  7297         OUT-BALLOON-IND        '~'
  7298         OUT-LEASE-IND          '~'
  7299         OUT-RESCIND            '~'
  7300         OUT-REA-CD1            '~'
  7301         OUT-REA-CD2            '~'
  7302         OUT-REA-CD3            '~'
  7303         OUT-REA-CD4            '~'
  7304         OUT-REA-CD5            '~'
  7305         OUT-REA-CD6            '~'
  7306         OUT-REA-CD7            '~'
  7307         OUT-REA-CD8            '~'
  7308         OUT-REA-CD9            '~'
  7309         OUT-REA-CD10           '~'
  7310         OUT-REA-CD11           '~'
  7311         OUT-REA-CD12           '~'
  7312         OUT-CYCLE-DT           '~'
  7313         OUT-ARCH-NO            '~'
  7314         OUT-FORM               '~'
  7315         OUT-ENC-LINE           '~'
  7316         OUT-ATTACH             '~'
  7317         OUT-STACK              '~'
  7318         OUT-STATE-NAME         '~'
  7319         OUT-PRINT-NOW          '~'
  7320         OUT-CHGBACK            '~'
  7321         OUT-CSO-PORTION        '~'
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 128
* NSRASBL.cbl
  7322         OUT-ACCT-PORTION       '~'
  7323         OUT-LETTER-TYPE        '~'
  7324         OUT-PRINT-CERTIFICATE  '~'
  7325         OUT-INS-BIRTHDATE      '~'
  7326         OUT-JNT-BIRTHDATE      '~'
  7327         OUT-TOT-INTEREST       '~'
  7328         OUT-ORIG-TOT-PREM      '~'
  7329         OUT-ORIG-TOT-REF       '~'
  7330         OUT-CANCEL-DT          '~'
  7331         OUT-HEALTH-APP         '~'
  7332         OUT-CERTIFICATE-ID     '~'
  7333         OUT-UNDW-ID            '~'
  7334         OUT-NEW-TOT-PREM       '~'
  7335         OUT-NEW-TOT-REF        '~'
  7336         OUT-COVERAGE-IND       '~'
  7337         OUT-ORIG-COVERAGE-IND  '~'
  7338         OUT-NEW-COVERAGE-IND   '~'
  7339         OUT-LF-CMB-PREM        '~'
  7340         OUT-ORIG-LF-CMB-PREM   '~'
  7341         OUT-NEW-LF-CMB-PREM    '~'
  7342         OUT-LF-PREM-CHG        '~'
  7343         OUT-LF-ALT-PREM-CHG    '~'
  7344         OUT-LF-CMB-PREM-CHG    '~'
  7345         OUT-AH-PREM-CHG        '~'
  7346         OUT-LF-REF-CHG         '~'
  7347         OUT-AH-REF-CHG         '~'
  7348         OUT-ACCT-LF-PORTION    '~'
  7349         OUT-ACCT-ALT-LF-PORT   '~'
  7350         OUT-ACCT-CMB-LF-PORT   '~'
  7351         OUT-ACCT-AH-PORTION    '~'
  7352         OUT-CSO-LF-PORTION     '~'
  7353         OUT-CSO-ALT-LF-PORT    '~'
  7354         OUT-CSO-CMB-LF-PORT    '~'
  7355         OUT-CSO-AH-PORTION     '~'
  7356         OUT-ACCT-ORIG-LF-PORT  '~'
  7357         OUT-ACCT-ORIG-ALT-LF-PORT '~'
  7358         OUT-ACCT-ORIG-CMB-LF-PORT '~'
  7359         OUT-ACCT-ORIG-AH-PORT  '~'
  7360         OUT-ACCT-ORIG-PORTION  '~'
  7361         OUT-CSO-ORIG-LF-PORT   '~'
  7362         OUT-CSO-ORIG-ALT-LF-PORT '~'
  7363         OUT-CSO-ORIG-CMB-LF-PORT '~'
  7364         OUT-CSO-ORIG-AH-PORT   '~'
  7365         OUT-CSO-ORIG-PORTION   '~'
  7366         OUT-ACCT-NEW-LF-PORT   '~'
  7367         OUT-ACCT-NEW-ALT-LF-PORT '~'
  7368         OUT-ACCT-NEW-CMB-LF-PORT '~'
  7369         OUT-ACCT-NEW-AH-PORT   '~'
  7370         OUT-ACCT-NEW-PORTION   '~'
  7371         OUT-CSO-NEW-LF-PORT    '~'
  7372         OUT-CSO-NEW-ALT-LF-PORT '~'
  7373         OUT-CSO-NEW-CMB-LF-PORT '~'
  7374         OUT-CSO-NEW-AH-PORT    '~'
  7375         OUT-CSO-NEW-PORTION    '~'
  7376         OUT-ACCT-LF-PORT-CHG   '~'
  7377         OUT-ACCT-ALT-LF-PORT-CHG '~'
  7378         OUT-ACCT-CMB-LF-PORT-CHG '~'
  7379         OUT-ACCT-AH-PORT-CHG   '~'
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 129
* NSRASBL.cbl
  7380         OUT-ACCT-PORTION-CHG   '~'
  7381         OUT-CSO-LF-PORT-CHG    '~'
  7382         OUT-CSO-ALT-LF-PORT-CHG '~'
  7383         OUT-CSO-CMB-LF-PORT-CHG '~'
  7384         OUT-CSO-AH-PORT-CHG    '~'
  7385         OUT-CSO-PORTION-CHG    '~'
  7386         OUT-ORIG-LF-CAN-DT     '~'
  7387         OUT-NEW-LF-CAN-DT      '~'
  7388         OUT-ORIG-AH-CAN-DT     '~'
  7389         OUT-NEW-AH-CAN-DT      '~'
  7390         OUT-ORIG-CAN-DT        '~'
  7391         OUT-NEW-CAN-DT         '~'
  7392         OUT-SCREEN-ID          '~'
  7393         OUT-NEXT-BUS-DT        '~'
  7394            DELIMITED BY '   ' INTO NSAS-LETTER-VARIABLES
  7395     END-STRING
  7396     .
  7397 0710-exit.
  7398     EXIT.
  7399 0720-WRITE-NSASEXTR.
  7400
  7401* EXEC CICS WRITE
  7402*       DATASET    ('NSASEXTR')
  7403*       FROM       (NSAS-EXTRACT-RECORD)
  7404*       RIDFLD     (NSAS-CONTROL-PRIMARY)
  7405*       RESP       (WS-RESPONSE)
  7406*    END-EXEC
  7407     MOVE LENGTH OF
  7408      NSAS-EXTRACT-RECORD
  7409       TO DFHEIV11
  7410     MOVE 'NSASEXTR' TO DFHEIV1
  7411*    MOVE '&$ L                  ''  N#00007238' TO DFHEIV0
  7412     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7413     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7414     MOVE X'204E233030303037323338' TO DFHEIV0(25:11)
  7415     CALL 'kxdfhei1' USING DFHEIV0,
  7416           DFHEIV1,
  7417           NSAS-EXTRACT-RECORD,
  7418           DFHEIV11,
  7419           NSAS-CONTROL-PRIMARY,
  7420           DFHEIV99,
  7421           DFHEIV99
  7422     MOVE EIBRESP  TO WS-RESPONSE
  7423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7424     IF NOT RESP-NORMAL
  7425        display ' bad write nsasextr ' ws-response
  7426        SET BL-FAIL TO TRUE
  7427     END-IF
  7428     .
  7429 0720-EXIT.
  7430     EXIT.
  7431 0800-init-out-data.
  7432     MOVE ZEROS                  TO OUT-IAGE
  7433                                    OUT-JAGE
  7434                                    OUT-LOAN-APR
  7435                                    OUT-LOAN-TERM
  7436                                    OUT-EXT-DAYS
  7437                                    OUT-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 130
* NSRASBL.cbl
  7438                                    OUT-AH-TERM
  7439                                    OUT-LF-DEV-PCT
  7440                                    OUT-AH-DEV-PCT
  7441                                    OUT-LF-BEN
  7442                                    OUT-AH-BEN
  7443                                    OUT-CRIT-PER
  7444                                    OUT-MAX-PMTS
  7445                                    OUT-SCHED-TERM
  7446                                    OUT-ORIG-IAGE
  7447                                    OUT-ORIG-JAGE
  7448                                    OUT-NEW-IAGE
  7449                                    OUT-NEW-JAGE
  7450                                    OUT-ORIG-LF-TERM
  7451                                    OUT-ORIG-AH-TERM
  7452                                    OUT-NEW-LF-TERM
  7453                                    OUT-NEW-AH-TERM
  7454                                    OUT-ORIG-CRIT-PER
  7455                                    OUT-ORIG-MAX-PMTS
  7456                                    OUT-ORIG-SCHED-TERM
  7457                                    OUT-NEW-SCHED-TERM
  7458                                    OUT-NEW-CRIT-PER
  7459                                    OUT-NEW-MAX-PMTS
  7460                                    OUT-CSO-PORTION
  7461                                    OUT-CSO-LF-PORTION
  7462                                    OUT-CSO-ALT-LF-PORT
  7463                                    OUT-CSO-CMB-LF-PORT
  7464                                    OUT-CSO-AH-PORTION
  7465                                    OUT-ACCT-PORTION
  7466                                    OUT-ACCT-LF-PORTION
  7467                                    OUT-ACCT-ALT-LF-PORT
  7468                                    OUT-ACCT-CMB-LF-PORT
  7469                                    OUT-ACCT-AH-PORTION
  7470                                    OUT-LF-PREM-CHG
  7471                                    OUT-LF-ALT-PREM-CHG
  7472                                    OUT-LF-CMB-PREM-CHG
  7473                                    OUT-AH-PREM-CHG
  7474                                    OUT-LF-REF-CHG
  7475                                    OUT-AH-REF-CHG
  7476     .
  7477 0800-exit.
  7478     exit.
  7479 1000-BUILD-ERARCH.
  7480* DATA SOURCE MEANINGS  BL-DATA-SRCE
  7481*    1) FROM ACCT MAINT
  7482*    2) FROM CERT UPDATE
  7483*    3) FROM COMP MAINT
  7484*    4) FROM REVIEW AND CORRECTIONS
  7485******************************************************************
  7486     MOVE 'LA'                   TO LETTER-ARCHIVE
  7487     MOVE BL-ARCHIVE-NO          TO LA-ARCHIVE-NO
  7488                                    LA-ARCHIVE-NO-A2
  7489                                    LA-ARCHIVE-NO-A3
  7490                                    LA-ARCHIVE-NO-A4
  7491                                    LA-ARCHIVE-NO-A5
  7492                                    LA-ARCHIVE-NO-A6
  7493     MOVE WS-COMPANY-CD          TO LA-COMPANY-CD
  7494                                    LA-COMPANY-CD-A2
  7495                                    LA-COMPANY-CD-A3
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 131
* NSRASBL.cbl
  7496                                    LA-COMPANY-CD-A4
  7497                                    LA-COMPANY-CD-A5
  7498                                    LA-COMPANY-CD-A6
  7499     MOVE BL-CARRIER             TO LA-CARRIER-A2
  7500                                    LA-CARRIER-A3
  7501                                    LA-CARRIER-A4
  7502                                    LA-CARRIER-A5
  7503     MOVE BL-GROUP               TO LA-GROUPING-A2
  7504                                    LA-GROUPING-A3
  7505                                    LA-GROUPING-A4
  7506                                    LA-GROUPING-A5
  7507     MOVE BL-ACCOUNT             TO LA-ACCOUNT-A2
  7508                                    LA-ACCOUNT-A3
  7509                                    LA-ACCOUNT-A4
  7510                                    LA-ACCOUNT-A5
  7511     MOVE BL-STATE               TO LA-STATE-A2
  7512                                    LA-STATE-A3
  7513                                    LA-STATE-A4
  7514                                    LA-STATE-A5
  7515     IF BL-DATA-SRCE = '2' OR '4'
  7516        MOVE WS-ELCERT-EFF-DT    TO LA-EFFECT-DATE-A2
  7517        MOVE BL-CERT-NO          TO LA-CERT-NO-A2
  7518     ELSE
  7519        MOVE LOW-VALUES          TO LA-EFFECT-DATE-A2
  7520     END-IF
  7521     IF BL-DATA-SRCE = '4'
  7522        MOVE BL-BATCH-NO         TO LA-ENTRY-A6
  7523     END-IF
  7524     MOVE BL-PROC-ID             TO LA-PROCESSOR-CD
  7525                                    LA-LAST-UPDATED-BY
  7526     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7527                                    LA-INITIAL-PRINT-DATE
  7528                                    LA-SENT-DATE
  7529                                    LA-REPLY-DATE
  7530                                    LA-RESEND-DATE
  7531                                    LA-FOLLOW-UP-DATE
  7532     MOVE 'A'                    TO LA-STATUS
  7533     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7534     MOVE W-FORM-TO-RESEND       TO LA-RESEND-LETR
  7535     IF W-DAYS-TO-RESEND NOT NUMERIC
  7536        MOVE ZEROS               TO W-DAYS-TO-RESEND
  7537     END-IF
  7538     IF W-DAYS-TO-RESEND > ZEROS
  7539        MOVE SAVE-BIN-NEXT-BUS-DT TO DC-BIN-DATE-1
  7540        MOVE W-DAYS-TO-RESEND  TO DC-ELAPSED-DAYS
  7541        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7542        MOVE '6'                 TO DC-OPTION-CODE
  7543        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7544        IF NO-CONVERSION-ERROR
  7545           MOVE DC-BIN-DATE-2    TO LA-RESEND-DATE
  7546        END-IF
  7547     END-IF
  7548     IF W-DAYS-TO-FOLLOW-UP >= ZEROS
  7549        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7550        MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  7551        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7552        MOVE '6'                 TO DC-OPTION-CODE
  7553        PERFORM 9700-DATE-LINK THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 132
* NSRASBL.cbl
  7554        IF NO-CONVERSION-ERROR
  7555           MOVE DC-BIN-DATE-2    TO LA-FOLLOW-UP-DATE
  7556        END-IF
  7557     END-IF
  7558
  7559     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7560     MOVE BL-LETTER-ID           TO LA-FORM-A3
  7561     MOVE BL-DATA-SRCE           TO LA-DATA-SOURCE
  7562     MOVE BL-WRITE-ERARCH        TO LA-ARCHIVE-STATUS
  7563     IF BL-ENDT-ARCH-NO > ZEROS
  7564        MOVE BL-ENDT-ARCH-NO     TO LA-ENDT-ARCH-NO
  7565     ELSE
  7566        MOVE BL-ARCHIVE-NO       TO LA-ENDT-ARCH-NO
  7567     END-IF
  7568     MOVE SAVE-BIN-DATE          TO LA-CREATION-DATE
  7569                                    LA-LAST-MAINT-DATE
  7570     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7571                                    LA-NO-OF-TEXT-RECORDS
  7572     MOVE EIBTIME                TO LA-LAST-MAINT-TIME
  7573
  7574* EXEC CICS WRITE
  7575*         DATASET   ('ERARCH')
  7576*         FROM      (LETTER-ARCHIVE)
  7577*         RIDFLD    (LA-CONTROL-PRIMARY)
  7578*         RESP      (WS-RESPONSE)
  7579*    END-EXEC
  7580     MOVE LENGTH OF
  7581      LETTER-ARCHIVE
  7582       TO DFHEIV11
  7583     MOVE 'ERARCH' TO DFHEIV1
  7584*    MOVE '&$ L                  ''  N#00007393' TO DFHEIV0
  7585     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7586     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7587     MOVE X'204E233030303037333933' TO DFHEIV0(25:11)
  7588     CALL 'kxdfhei1' USING DFHEIV0,
  7589           DFHEIV1,
  7590           LETTER-ARCHIVE,
  7591           DFHEIV11,
  7592           LA-CONTROL-PRIMARY,
  7593           DFHEIV99,
  7594           DFHEIV99
  7595     MOVE EIBRESP  TO WS-RESPONSE
  7596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7597     IF NOT RESP-NORMAL
  7598        DISPLAY ' BAD WRITE ON ERARCH ' WS-RESPONSE ' '
  7599        la-archive-no
  7600        SET BL-FAIL TO TRUE
  7601     END-IF
  7602     .
  7603 1000-EXIT.
  7604     EXIT.
  7605 1025-GET-CSR-INFO.
  7606     MOVE WS-CSR-ID              TO OUT-CSR-CODE
  7607                                    OUT-CSR-TITLE
  7608                                    OUT-PROC-TITLE
  7609                                    OUT-UNDW-ID
  7610     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7611     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 133
* NSRASBL.cbl
  7612     MOVE WS-CSR-ID              TO WS-ELCNTL-GENL
  7613     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7614
  7615* EXEC CICS READ
  7616*       INTO    (CONTROL-FILE)
  7617*       DATASET ('ELCNTL')
  7618*       RIDFLD  (WS-ELCNTL-KEY)
  7619*       RESP    (WS-RESPONSE)
  7620*    END-EXEC
  7621     MOVE LENGTH OF
  7622      CONTROL-FILE
  7623       TO DFHEIV11
  7624     MOVE 'ELCNTL' TO DFHEIV1
  7625*    MOVE '&"IL       E          (  N#00007416' TO DFHEIV0
  7626     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7627     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7628     MOVE X'204E233030303037343136' TO DFHEIV0(25:11)
  7629     CALL 'kxdfhei1' USING DFHEIV0,
  7630           DFHEIV1,
  7631           CONTROL-FILE,
  7632           DFHEIV11,
  7633           WS-ELCNTL-KEY,
  7634           DFHEIV99,
  7635           DFHEIV99,
  7636           DFHEIV99
  7637     MOVE EIBRESP  TO WS-RESPONSE
  7638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7639     IF RESP-NORMAL
  7640        MOVE CF-PROCESSOR-NAME   TO OUT-CSR-NAME
  7641                                    OUT-PROC-NAME
  7642*       MOVE CF-PROCESSOR-TITLE  TO OUT-CSR-TITLE
  7643*                                   OUT-PROC-TITLE
  7644     END-IF
  7645     IF BL-PROC-ID NOT = PB-CSR-ID
  7646        MOVE BL-COMP-ID          TO WS-ELCNTL-KEY
  7647        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
  7648        MOVE BL-PROC-ID          TO WS-ELCNTL-GENL
  7649                                    OUT-PROC-TITLE
  7650        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  7651
  7652* EXEC CICS READ
  7653*          INTO    (CONTROL-FILE)
  7654*          DATASET ('ELCNTL')
  7655*          RIDFLD  (WS-ELCNTL-KEY)
  7656*          RESP    (WS-RESPONSE)
  7657*       END-EXEC
  7658     MOVE LENGTH OF
  7659      CONTROL-FILE
  7660       TO DFHEIV11
  7661     MOVE 'ELCNTL' TO DFHEIV1
  7662*    MOVE '&"IL       E          (  N#00007434' TO DFHEIV0
  7663     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7664     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7665     MOVE X'204E233030303037343334' TO DFHEIV0(25:11)
  7666     CALL 'kxdfhei1' USING DFHEIV0,
  7667           DFHEIV1,
  7668           CONTROL-FILE,
  7669           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 134
* NSRASBL.cbl
  7670           WS-ELCNTL-KEY,
  7671           DFHEIV99,
  7672           DFHEIV99,
  7673           DFHEIV99
  7674     MOVE EIBRESP  TO WS-RESPONSE
  7675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7676        IF RESP-NORMAL
  7677           MOVE CF-PROCESSOR-NAME   TO OUT-PROC-NAME
  7678*          MOVE CF-PROCESSOR-TITLE  TO OUT-PROC-TITLE
  7679        END-IF
  7680     END-IF
  7681     .
  7682 1025-EXIT.
  7683     EXIT.
  7684 1050-GET-ERMAIL.
  7685     MOVE CM-CONTROL-PRIMARY     TO WS-ERMAIL-KEY
  7686
  7687* EXEC CICS READ
  7688*         DATASET    ('ERMAIL')
  7689*         INTO       (MAILING-DATA)
  7690*         RIDFLD     (WS-ERMAIL-KEY)
  7691*         RESP       (WS-RESPONSE)
  7692*    END-EXEC
  7693     MOVE LENGTH OF
  7694      MAILING-DATA
  7695       TO DFHEIV11
  7696     MOVE 'ERMAIL' TO DFHEIV1
  7697*    MOVE '&"IL       E          (  N#00007450' TO DFHEIV0
  7698     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7699     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7700     MOVE X'204E233030303037343530' TO DFHEIV0(25:11)
  7701     CALL 'kxdfhei1' USING DFHEIV0,
  7702           DFHEIV1,
  7703           MAILING-DATA,
  7704           DFHEIV11,
  7705           WS-ERMAIL-KEY,
  7706           DFHEIV99,
  7707           DFHEIV99,
  7708           DFHEIV99
  7709     MOVE EIBRESP  TO WS-RESPONSE
  7710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7711     IF RESP-NORMAL
  7712        MOVE MA-ADDRESS-LINE-1   TO OUT-INS-ADDR1
  7713        MOVE MA-ADDRESS-LINE-2   TO OUT-INS-ADDR2
  7714        MOVE MA-CITY             TO OUT-INS-CITY
  7715        MOVE MA-ADDR-STATE       TO OUT-INS-STATE
  7716        MOVE MA-ZIP              TO OUT-INS-ZIP
  7717        MOVE MA-CRED-BENE-NAME   TO OUT-BENE-NAME
  7718        MOVE MA-CRED-BENE-ADDR   TO OUT-BENE-ADDR1
  7719        MOVE MA-CRED-BENE-ADDR2  TO OUT-BENE-ADDR2
  7720        MOVE MA-CRED-BENE-CITY   TO OUT-BENE-CITY
  7721        MOVE MA-CRED-BENE-STATE  TO OUT-BENE-STATE
  7722        MOVE MA-CRED-BENE-ZIP    TO OUT-BENE-ZIP
  7723        IF MA-INSURED-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7724           MOVE MA-INSURED-BIRTH-DT
  7725                                 TO DC-BIN-DATE-1
  7726           MOVE ' '              TO DC-OPTION-CODE
  7727           PERFORM 9700-DATE-LINK THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 135
* NSRASBL.cbl
  7728           IF NO-CONVERSION-ERROR
  7729              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7730                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7731                INTO OUT-INS-BIRTHDATE
  7732              END-STRING
  7733           END-IF
  7734        END-IF
  7735        IF MA-JOINT-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7736           MOVE MA-JOINT-BIRTH-DT
  7737                                 TO DC-BIN-DATE-1
  7738           MOVE ' '              TO DC-OPTION-CODE
  7739           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7740           IF NO-CONVERSION-ERROR
  7741              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7742                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7743                INTO OUT-JNT-BIRTHDATE
  7744              END-STRING
  7745           END-IF
  7746        END-IF
  7747     END-IF
  7748     .
  7749 1050-EXIT.
  7750     EXIT.
  7751 1100-GET-ELCERT.
  7752
  7753* EXEC CICS READ
  7754*         DATASET    ('ELCERT')
  7755*         INTO       (CERTIFICATE-MASTER)
  7756*         RIDFLD     (WS-ELCERT-KEY)
  7757*         RESP       (WS-RESPONSE)
  7758*    END-EXEC.
  7759     MOVE LENGTH OF
  7760      CERTIFICATE-MASTER
  7761       TO DFHEIV11
  7762     MOVE 'ELCERT' TO DFHEIV1
  7763*    MOVE '&"IL       E          (  N#00007497' TO DFHEIV0
  7764     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7765     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7766     MOVE X'204E233030303037343937' TO DFHEIV0(25:11)
  7767     CALL 'kxdfhei1' USING DFHEIV0,
  7768           DFHEIV1,
  7769           CERTIFICATE-MASTER,
  7770           DFHEIV11,
  7771           WS-ELCERT-KEY,
  7772           DFHEIV99,
  7773           DFHEIV99,
  7774           DFHEIV99
  7775     MOVE EIBRESP  TO WS-RESPONSE
  7776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7777
  7778     IF RESP-NORMAL
  7779        SET CERT-FOUND TO TRUE
  7780        PERFORM 1110-BUILD-CERT  THRU 1110-EXIT
  7781        PERFORM 1050-GET-ERMAIL  THRU 1050-EXIT
  7782     END-IF
  7783     .
  7784 1100-EXIT.
  7785     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 136
* NSRASBL.cbl
  7786 1110-BUILD-CERT.
  7787     PERFORM 1300-DETERMINE-COMM THRU 1300-EXIT
  7788     MOVE SPACES                 TO OUT-COVERAGE-IND
  7789     MOVE SPACES                 TO OUT-ORIG-COVERAGE-IND
  7790     MOVE SPACES                 TO OUT-NEW-COVERAGE-IND
  7791     MOVE CM-CARRIER             TO OUT-CARRIER
  7792     MOVE CM-GROUPING            TO OUT-GROUPING
  7793     MOVE CM-STATE               TO OUT-STATE
  7794     MOVE CM-ACCOUNT             TO OUT-ACCOUNT
  7795     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  7796     MOVE ' '                    TO DC-OPTION-CODE
  7797     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7798     IF NO-CONVERSION-ERROR
  7799        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7800           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7801              INTO OUT-CERT-EFF-DT
  7802        END-STRING
  7803     END-IF
  7804     MOVE CM-CERT-NO             TO OUT-CERT-NO
  7805     MOVE CM-INSURED-LAST-NAME   TO OUT-ILNAME
  7806                                    OUT-ORIG-ILNAME
  7807     MOVE CM-INSURED-INITIAL1    TO OUT-IFINIT
  7808     MOVE CM-INSURED-INITIAL2    TO OUT-IMINIT
  7809                                    OUT-ORIG-MINIT
  7810     IF (CM-SSN-STATE = CM-STATE)
  7811        AND (CM-SSN-ACCOUNT = CM-ACCOUNT (5:6))
  7812        MOVE SPACES              TO OUT-SOC-SEC-NO
  7813     ELSE
  7814        MOVE CM-SOC-SEC-NO       TO OUT-SOC-SEC-NO
  7815     END-IF
  7816     IF (CM-MEMB-STATE = CM-STATE)
  7817        AND (CM-MEMB-ACCOUNT = CM-ACCOUNT (5:6))
  7818        MOVE SPACES              TO OUT-MEMBER-NO
  7819     ELSE
  7820        MOVE CM-MEMBER-NO        TO OUT-MEMBER-NO
  7821     END-IF
  7822     MOVE CM-INSURED-FIRST-NAME  TO OUT-IFNAME
  7823                                    OUT-ORIG-IFNAME
  7824     MOVE CM-INSURED-ISSUE-AGE   TO OUT-IAGE
  7825                                    OUT-ORIG-IAGE
  7826     MOVE CM-INSURED-SEX         TO OUT-ISEX
  7827     MOVE CM-INSURED-JOINT-AGE   TO OUT-JAGE
  7828                                    OUT-ORIG-JAGE
  7829     MOVE CM-JT-LAST-NAME        TO OUT-JLNAME
  7830                                    OUT-ORIG-JLNAME
  7831     MOVE CM-JT-FIRST-NAME       TO OUT-JFNAME
  7832                                    OUT-ORIG-JFNAME
  7833     MOVE CM-JT-INITIAL          TO OUT-JMINIT
  7834                                    OUT-ORIG-JMINIT
  7835     MOVE CM-LF-BENEFIT-CD       TO OUT-LF-BENCD
  7836                                    OUT-ORIG-LF-BENCD
  7837     MOVE CM-LF-ORIG-TERM        TO OUT-LF-TERM
  7838                                    OUT-ORIG-LF-TERM
  7839     MOVE CM-LF-DEV-CODE         TO OUT-LF-DEV-CD
  7840     IF CM-LF-DEV-PCT NOT NUMERIC
  7841        MOVE ZEROS               TO CM-LF-DEV-PCT
  7842     END-IF
  7843     MOVE CM-LF-DEV-PCT          TO OUT-LF-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 137
* NSRASBL.cbl
  7844     PERFORM 1160-READ-CERT-TRAILER THRU 1160-EXIT
  7845     IF NOT CERT-TRL-REC-NOT-FOUND
  7846         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
  7847             MOVE ZERO           TO OUT-IAGE
  7848                                    OUT-ORIG-IAGE
  7849         END-IF
  7850         IF CS-JNT-AGE-DEFAULT-FLAG = 'Y'
  7851             MOVE ZERO           TO OUT-JAGE
  7852                                    OUT-ORIG-JAGE
  7853         END-IF
  7854     END-IF
  7855
  7856     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7857        IF (PB-C-LF-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7858          ((CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES) OR
  7859           (CM-LF-DEATH-DT NOT = LOW-VALUES AND SPACES))
  7860             MOVE SPACES          TO OUT-LF-BENCD
  7861                                     WS-LF-BENCD
  7862                                     OUT-LF-CAN-DT
  7863             MOVE ZEROS           TO OUT-LF-TERM
  7864                                     OUT-LF-BEN
  7865                                     OUT-LF-PRM
  7866                                     OUT-LF-ALT-BEN
  7867                                     OUT-LF-ALT-PRM
  7868                                     OUT-LF-COMM-PCT
  7869                                     OUT-LF-NSP
  7870                                     OUT-LF-REM-BEN
  7871                                     WS-WORK-LF-PREM
  7872                                     WS-WORK-ALT-LF-PREM
  7873                                     WS-WORK-CMB-LF-PREM
  7874                                     OUT-LF-REF
  7875                                     OUT-ORIG-LF-REF
  7876                                     WS-WORK-LF-REF
  7877             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7878             GO TO 1100-LF-CONT
  7879        END-IF
  7880     END-IF
  7881
  7882     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7883        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7884             MOVE SPACES          TO OUT-LF-BENCD
  7885                                     WS-LF-BENCD
  7886                                     OUT-LF-CAN-DT
  7887             MOVE ZEROS           TO OUT-LF-TERM
  7888                                     OUT-LF-BEN
  7889                                     OUT-LF-PRM
  7890                                     OUT-LF-ALT-BEN
  7891                                     OUT-LF-ALT-PRM
  7892                                     OUT-LF-COMM-PCT
  7893                                     OUT-LF-NSP
  7894                                     OUT-LF-REM-BEN
  7895                                     WS-WORK-LF-PREM
  7896                                     WS-WORK-ALT-LF-PREM
  7897                                     WS-WORK-CMB-LF-PREM
  7898                                     OUT-LF-REF
  7899                                     OUT-ORIG-LF-REF
  7900                                     WS-WORK-LF-REF
  7901             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 138
* NSRASBL.cbl
  7902             GO TO 1100-LF-CONT
  7903        END-IF
  7904     END-IF
  7905     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  7906         MOVE 'LIFE'             TO OUT-COVERAGE-IND
  7907                                    OUT-ORIG-COVERAGE-IND
  7908     END-IF
  7909
  7910     MOVE CM-LF-BENEFIT-CD       TO WS-LF-BENCD
  7911     MOVE CM-LF-BENEFIT-AMT      TO OUT-LF-BEN
  7912                                    OUT-ORIG-LF-BEN
  7913     IF CM-LF-BENEFIT-AMT = 999999999.99
  7914        MOVE SPACES              TO OUT-ORIG-LF-BEN-A
  7915     END-IF
  7916     MOVE CM-LF-PREMIUM-AMT      TO OUT-LF-PRM
  7917                                    OUT-ORIG-LF-PRM
  7918                                    WS-WORK-LF-PREM
  7919     IF CM-LF-PREMIUM-AMT = .01
  7920         MOVE SPACES             TO OUT-ORIG-LF-PRM-A
  7921     END-IF
  7922     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
  7923        MOVE ZEROS               TO CM-LF-ALT-BENEFIT-AMT
  7924     END-IF
  7925     MOVE CM-LF-ALT-BENEFIT-AMT  TO OUT-LF-ALT-BEN
  7926                                    OUT-ORIG-LF-ALT-BEN
  7927     IF CM-LF-ALT-BENEFIT-AMT = 999999999.99
  7928        MOVE SPACES              TO OUT-ORIG-LF-ALT-BEN-A
  7929     END-IF
  7930     IF CM-LF-ALT-PREMIUM-AMT NOT NUMERIC
  7931        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-AMT
  7932     END-IF
  7933     MOVE CM-LF-ALT-PREMIUM-AMT  TO OUT-LF-ALT-PRM
  7934                                    OUT-ORIG-LF-ALT-PRM
  7935                                    WS-WORK-ALT-LF-PREM
  7936     IF CM-LF-ALT-PREMIUM-AMT = .01
  7937         MOVE SPACES             TO OUT-ORIG-LF-ALT-PRM-A
  7938     END-IF
  7939     COMPUTE WS-WRK-AMOUNT = CM-LF-PREMIUM-AMT +
  7940                             CM-LF-ALT-PREMIUM-AMT
  7941     MOVE WS-WRK-AMOUNT          TO OUT-LF-CMB-PREM
  7942                                 OUT-ORIG-LF-CMB-PREM
  7943                                 WS-WORK-CMB-LF-PREM
  7944     IF CM-LF-NSP-PREMIUM-AMT NOT NUMERIC
  7945        MOVE ZEROS               TO CM-LF-NSP-PREMIUM-AMT
  7946     END-IF
  7947     MOVE CM-LF-NSP-PREMIUM-AMT  TO OUT-LF-NSP
  7948     MOVE CM-LF-REMAINING-AMT    TO OUT-LF-REM-BEN
  7949     MOVE CM-LF-ITD-CANCEL-AMT   TO OUT-LF-REF
  7950                                    OUT-ORIG-LF-REF
  7951                                    WS-WORK-LF-REF
  7952     IF CM-LF-DEATH-CLAIM-APPLIED
  7953        AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  7954            MOVE PB-C-LF-CANCEL-AMT TO OUT-LF-REF
  7955                                    OUT-ORIG-LF-REF
  7956                                    WS-WORK-LF-REF
  7957     END-IF
  7958     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  7959     MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 139
* NSRASBL.cbl
  7960     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7961     IF NO-CONVERSION-ERROR
  7962        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7963           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7964              INTO OUT-LF-CAN-DT
  7965        END-STRING
  7966     END-IF
  7967
  7968     IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7969         MOVE ZEROS          TO WS-WORK-LF-PREM
  7970                                WS-WORK-ALT-LF-PREM
  7971                                WS-WORK-CMB-LF-PREM
  7972     END-IF
  7973
  7974      .
  7975 1100-LF-CONT.
  7976
  7977     MOVE CM-LF-ITD-DEATH-AMT    TO OUT-LF-DTH
  7978     IF CM-LF-PREMIUM-RATE NOT NUMERIC
  7979        MOVE ZEROS               TO CM-LF-PREMIUM-RATE
  7980     END-IF
  7981     MOVE CM-LF-PREMIUM-RATE     TO OUT-LF-RATE
  7982     IF CM-LF-ALT-PREMIUM-RATE NOT NUMERIC
  7983        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-RATE
  7984     END-IF
  7985     MOVE CM-LF-ALT-PREMIUM-RATE TO OUT-LF-ALT-RATE
  7986     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7987        IF (PB-C-AH-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7988          (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7989              MOVE SPACES              TO OUT-AH-BENCD
  7990                                          WS-AH-BENCD
  7991                                          OUT-AH-CAN-DT
  7992              MOVE ZEROS               TO OUT-AH-TERM
  7993                                          OUT-AH-BEN
  7994                                          OUT-AH-PRM
  7995                                          OUT-AH-NSP
  7996                                          OUT-AH-COMM-PCT
  7997                                          OUT-CRIT-PER
  7998                                          WS-WORK-AH-PREM
  7999                                          OUT-AH-REF
  8000                                          OUT-ORIG-AH-REF
  8001                                          WS-WORK-AH-REF
  8002              MOVE SPACES              TO OUT-MAX-PMTS-A
  8003                                          OUT-WAIT-PER
  8004                                          OUT-RET-ELIM
  8005                                          OUT-AH-DESC
  8006                                          OUT-BEN-DAYS
  8007              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  8008             GO TO 1100-AH-CONT
  8009        END-IF
  8010     END-IF
  8011
  8012     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  8013        IF (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8014              MOVE SPACES              TO OUT-AH-BENCD
  8015                                          WS-AH-BENCD
  8016                                          OUT-AH-CAN-DT
  8017              MOVE ZEROS               TO OUT-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 140
* NSRASBL.cbl
  8018                                          OUT-AH-BEN
  8019                                          OUT-AH-PRM
  8020                                          OUT-AH-NSP
  8021                                          OUT-AH-COMM-PCT
  8022                                          OUT-CRIT-PER
  8023                                          WS-WORK-AH-PREM
  8024                                          OUT-AH-REF
  8025                                          OUT-ORIG-AH-REF
  8026                                          WS-WORK-AH-REF
  8027              MOVE SPACES              TO OUT-MAX-PMTS-A
  8028                                          OUT-WAIT-PER
  8029                                          OUT-RET-ELIM
  8030                                          OUT-AH-DESC
  8031                                          OUT-BEN-DAYS
  8032              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  8033             GO TO 1100-AH-CONT
  8034        END-IF
  8035     END-IF
  8036     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BENCD
  8037     MOVE CM-AH-BENEFIT-CD       TO OUT-AH-BENCD
  8038                                    OUT-ORIG-AH-BENCD
  8039     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  8040        COMPUTE OUT-AH-TOT-BEN = CM-AH-ORIG-TERM *
  8041           CM-AH-BENEFIT-AMT
  8042        IF OUT-COVERAGE-IND = 'LIFE'
  8043            MOVE 'BOTH'          TO OUT-COVERAGE-IND
  8044                                    OUT-ORIG-COVERAGE-IND
  8045        ELSE
  8046            MOVE 'AH  '          TO OUT-COVERAGE-IND
  8047                                    OUT-ORIG-COVERAGE-IND
  8048        END-IF
  8049     ELSE
  8050        MOVE ZEROS               TO OUT-AH-TOT-BEN
  8051     END-IF
  8052     MOVE CM-AH-ORIG-TERM        TO OUT-AH-TERM
  8053                                    OUT-ORIG-AH-TERM
  8054     MOVE CM-AH-CRITICAL-PERIOD  TO OUT-CRIT-PER
  8055                                    OUT-ORIG-CRIT-PER
  8056                                    OUT-MAX-PMTS
  8057                                    OUT-ORIG-MAX-PMTS
  8058     IF CM-AH-BENEFIT-CD EQUAL '00' OR SPACES
  8059         MOVE SPACES             TO OUT-MAX-PMTS-A
  8060     END-IF
  8061     MOVE CM-AH-DEV-CODE         TO OUT-AH-DEV-CD
  8062     IF CM-AH-DEV-PCT NOT NUMERIC
  8063        MOVE ZEROS               TO CM-AH-DEV-PCT
  8064     END-IF
  8065     MOVE CM-AH-DEV-PCT          TO OUT-AH-DEV-PCT
  8066     MOVE CM-AH-BENEFIT-AMT      TO OUT-AH-BEN
  8067                                    OUT-ORIG-AH-BEN
  8068     IF CM-AH-BENEFIT-AMT = 9999999.99
  8069        MOVE SPACES              TO OUT-ORIG-AH-BEN-A
  8070     END-IF
  8071     MOVE CM-AH-PREMIUM-AMT      TO OUT-AH-PRM
  8072                                    OUT-ORIG-AH-PRM
  8073                                    WS-WORK-AH-PREM
  8074     IF CM-AH-PREMIUM-AMT = .01
  8075         MOVE SPACES             TO OUT-ORIG-AH-PRM-A
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 141
* NSRASBL.cbl
  8076     END-IF
  8077     MOVE CM-AH-NSP-PREMIUM-AMT  TO OUT-AH-NSP
  8078     MOVE CM-AH-ITD-CANCEL-AMT   TO OUT-AH-REF
  8079                                    OUT-ORIG-AH-REF
  8080                                    WS-WORK-AH-REF
  8081     IF CM-AH-DEATH-CLAIM-APPLIED
  8082        AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  8083            MOVE PB-C-AH-CANCEL-AMT TO OUT-AH-REF
  8084                                    OUT-ORIG-AH-REF
  8085                                    WS-WORK-AH-REF
  8086     END-IF
  8087     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  8088     MOVE ' '                    TO DC-OPTION-CODE
  8089     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8090     IF NO-CONVERSION-ERROR
  8091        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8092           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8093              INTO OUT-AH-CAN-DT
  8094        END-STRING
  8095     END-IF
  8096
  8097     IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8098         MOVE ZEROS          TO WS-WORK-AH-PREM
  8099     END-IF
  8100
  8101      .
  8102 1100-AH-CONT.
  8103
  8104     MOVE CM-AH-ITD-AH-PMT       TO OUT-AH-CLM
  8105     MOVE CM-AH-PAID-THRU-DT     TO DC-BIN-DATE-1
  8106     MOVE ' '                    TO DC-OPTION-CODE
  8107     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8108     IF NO-CONVERSION-ERROR
  8109        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8110           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8111              INTO OUT-AH-PDTHRU-DT
  8112        END-STRING
  8113     END-IF
  8114     IF CM-AH-PREMIUM-RATE NOT NUMERIC
  8115        MOVE ZEROS               TO CM-AH-PREMIUM-RATE
  8116     END-IF
  8117     MOVE CM-AH-PREMIUM-RATE     TO OUT-AH-RATE
  8118     IF CM-LOAN-APR NOT NUMERIC
  8119        MOVE ZEROS               TO CM-LOAN-APR
  8120     END-IF
  8121     MOVE CM-LOAN-APR            TO OUT-LOAN-APR
  8122     MOVE CM-LOAN-TERM           TO OUT-LOAN-TERM
  8123     MOVE CM-RATE-CLASS          TO OUT-RATE-CLASS
  8124     MOVE CM-PMT-EXTENSION-DAYS  TO OUT-EXT-DAYS
  8125     MOVE CM-UNDERWRITING-CODE   TO OUT-UCODE
  8126     MOVE CM-PREMIUM-TYPE        TO OUT-PREM-TYPE
  8127     MOVE CM-IND-GRP-TYPE        TO OUT-IND-GRP
  8128     MOVE CM-LOAN-OFFICER        TO OUT-LOAN-OFF
  8129     MOVE CM-REIN-TABLE          TO OUT-REIN-TABLE
  8130     MOVE CM-SPECIAL-REIN-CODE   TO OUT-SPEC-REIN
  8131     MOVE CM-LF-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  8132     MOVE ' '                    TO DC-OPTION-CODE
  8133     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 142
* NSRASBL.cbl
  8134     IF NO-CONVERSION-ERROR
  8135        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8136           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8137              INTO OUT-LF-EXP-DT
  8138        END-STRING
  8139     END-IF
  8140     MOVE OUT-LF-EXP-DT          TO OUT-ORIG-LF-EXP-DT
  8141     MOVE CM-AH-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  8142     MOVE ' '                    TO DC-OPTION-CODE
  8143     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8144     IF NO-CONVERSION-ERROR
  8145        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8146           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8147              INTO OUT-AH-EXP-DT
  8148        END-STRING
  8149     END-IF
  8150     MOVE OUT-AH-EXP-DT          TO OUT-ORIG-AH-EXP-DT
  8151     MOVE CM-LOAN-1ST-PMT-DT     TO DC-BIN-DATE-1
  8152     MOVE ' '                    TO DC-OPTION-CODE
  8153     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8154     IF NO-CONVERSION-ERROR
  8155        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8156           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8157              INTO OUT-1ST-PMT-DT
  8158        END-STRING
  8159     END-IF
  8160     MOVE CM-ENTRY-STATUS        TO OUT-ENTRY-STATUS
  8161     MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  8162     MOVE ' '                    TO DC-OPTION-CODE
  8163     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8164     IF NO-CONVERSION-ERROR
  8165        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8166           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8167              INTO OUT-ENTRY-DT
  8168        END-STRING
  8169     END-IF
  8170     MOVE CM-LF-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  8171     MOVE ' '                    TO DC-OPTION-CODE
  8172     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8173     IF NO-CONVERSION-ERROR
  8174        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8175           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8176              INTO OUT-LF-CAN-EXIT-DT
  8177        END-STRING
  8178     END-IF
  8179     MOVE CM-LF-DEATH-DT         TO DC-BIN-DATE-1
  8180     MOVE ' '                    TO DC-OPTION-CODE
  8181     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8182     IF NO-CONVERSION-ERROR
  8183        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8184           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8185              INTO OUT-LF-DTH-DT
  8186        END-STRING
  8187     END-IF
  8188     MOVE CM-LF-DEATH-EXIT-DT    TO DC-BIN-DATE-1
  8189     MOVE ' '                    TO DC-OPTION-CODE
  8190     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8191     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 143
* NSRASBL.cbl
  8192        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8193           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8194              INTO OUT-LF-DTH-EXIT-DT
  8195        END-STRING
  8196     END-IF
  8197     MOVE CM-LF-CURRENT-STATUS   TO OUT-LF-CUR-STATUS
  8198     IF OUT-AH-CAN-DT NOT = SPACES
  8199        MOVE OUT-AH-CAN-DT       TO OUT-CANCEL-DT
  8200     ELSE
  8201        MOVE OUT-LF-CAN-DT       TO OUT-CANCEL-DT
  8202     END-IF
  8203     MOVE CM-AH-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  8204     MOVE ' '                    TO DC-OPTION-CODE
  8205     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  8206     IF NO-CONVERSION-ERROR
  8207        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  8208           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  8209              INTO OUT-AH-CAN-EXIT-DT
  8210        END-STRING
  8211     END-IF
  8212     MOVE CM-AH-CURRENT-STATUS   TO OUT-AH-CUR-STATUS
  8213     IF CM-ENTRY-BATCH = LOW-VALUES
  8214        MOVE SPACES              TO CM-ENTRY-BATCH
  8215     END-IF
  8216     MOVE CM-ENTRY-BATCH         TO OUT-ENTRY-BATCH
  8217     IF CM-LF-EXIT-BATCH = LOW-VALUES
  8218        MOVE SPACES              TO CM-LF-EXIT-BATCH
  8219     END-IF
  8220     MOVE CM-LF-EXIT-BATCH       TO OUT-LF-EXIT-BATCH
  8221     IF CM-AH-EXIT-BATCH = LOW-VALUES
  8222        MOVE SPACES              TO CM-AH-EXIT-BATCH
  8223     END-IF
  8224     MOVE CM-AH-EXIT-BATCH       TO OUT-AH-EXIT-BATCH
  8225     MOVE WS-CHGBK-LIFE-PCT      TO OUT-LF-COMM-PCT
  8226     MOVE WS-CHGBK-AH-PCT        TO OUT-AH-COMM-PCT
  8227     MOVE CM-CERT-SFX            TO OUT-CERT-SFX
  8228     MOVE CM-CONTROL-PRIMARY     TO MA-CONTROL-PRIMARY
  8229     COMPUTE WS-WORK-PREM =
  8230        (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT
  8231           + CM-AH-PREMIUM-AMT)
  8232     MOVE WS-WORK-PREM           TO OUT-TOT-PRM
  8233                                    OUT-ORIG-TOT-PREM
  8234     COMPUTE WS-WORK-REF =
  8235        (WS-WORK-LF-REF + WS-WORK-AH-REF)
  8236     MOVE WS-WORK-REF            TO OUT-TOT-REF
  8237                                    OUT-ORIG-TOT-REF
  8238     IF CM-LF-LOAN-EXPIRE-DT > CM-AH-LOAN-EXPIRE-DT
  8239        MOVE OUT-LF-EXP-DT       TO OUT-SCHED-EXP-DT
  8240     ELSE
  8241        MOVE OUT-AH-EXP-DT       TO OUT-SCHED-EXP-DT
  8242     END-IF
  8243     MOVE OUT-SCHED-EXP-DT       TO OUT-ORIG-SCHED-EXP-DT
  8244     IF CM-LF-ORIG-TERM > CM-AH-ORIG-TERM
  8245        MOVE CM-LF-ORIG-TERM     TO OUT-SCHED-TERM
  8246     ELSE
  8247        MOVE CM-AH-ORIG-TERM     TO OUT-SCHED-TERM
  8248     END-IF
  8249     MOVE OUT-SCHED-TERM         TO OUT-ORIG-SCHED-TERM
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 144
* NSRASBL.cbl
  8250     IF CM-NH-INT-ON-REFS NUMERIC
  8251        IF CM-NH-INT-ON-REFS NOT = ZEROS
  8252           MOVE CM-NH-INT-ON-REFS TO OUT-TOT-INTEREST
  8253        END-IF
  8254     END-IF
  8255
  8256     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  8257        IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8258            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8259        END-IF
  8260        IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8261            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8262        END-IF
  8263     END-IF
  8264*
  8265*     IF BL-DATA-SRCE = '2'
  8266*        IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8267*            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8268*        END-IF
  8269*        IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8270*            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8271*        END-IF
  8272*     END-IF
  8273
  8274     COMPUTE WS-ACCT-LF-PORTION =
  8275        WS-WORK-LF-PREM * WS-CHGBK-LIFE-PCT
  8276     MOVE WS-ACCT-LF-PORTION TO OUT-ACCT-LF-PORTION
  8277                                OUT-ACCT-ORIG-LF-PORT
  8278     COMPUTE WS-ACCT-ALT-LF-PORTION =
  8279        WS-WORK-ALT-LF-PREM * WS-CHGBK-LIFE-PCT
  8280     MOVE WS-ACCT-ALT-LF-PORTION TO OUT-ACCT-ALT-LF-PORT
  8281                                OUT-ACCT-ORIG-ALT-LF-PORT
  8282     COMPUTE WS-ACCT-CMB-LF-PORTION =
  8283        WS-WORK-CMB-LF-PREM * WS-CHGBK-LIFE-PCT
  8284     MOVE WS-ACCT-CMB-LF-PORTION TO OUT-ACCT-CMB-LF-PORT
  8285                                OUT-ACCT-ORIG-CMB-LF-PORT
  8286     COMPUTE WS-ACCT-AH-PORTION =
  8287        WS-WORK-AH-PREM * WS-CHGBK-AH-PCT
  8288     MOVE WS-ACCT-AH-PORTION TO OUT-ACCT-AH-PORTION
  8289                                OUT-ACCT-ORIG-AH-PORT
  8290     COMPUTE WS-ACCT-PORTION =
  8291        WS-ACCT-CMB-LF-PORTION + WS-ACCT-AH-PORTION
  8292     MOVE WS-ACCT-PORTION TO OUT-ACCT-PORTION
  8293                                OUT-ACCT-ORIG-PORTION
  8294
  8295     COMPUTE WS-CSO-LF-PORTION =
  8296       WS-WORK-LF-PREM - WS-ACCT-LF-PORTION
  8297     MOVE WS-CSO-LF-PORTION TO OUT-CSO-LF-PORTION
  8298                               OUT-CSO-ORIG-LF-PORT
  8299     COMPUTE WS-CSO-ALT-LF-PORTION =
  8300       WS-WORK-ALT-LF-PREM - WS-ACCT-ALT-LF-PORTION
  8301     MOVE WS-CSO-ALT-LF-PORTION TO OUT-CSO-ALT-LF-PORT
  8302                                   OUT-CSO-ORIG-ALT-LF-PORT
  8303     COMPUTE WS-CSO-CMB-LF-PORTION =
  8304       WS-WORK-CMB-LF-PREM - WS-ACCT-CMB-LF-PORTION
  8305     MOVE WS-CSO-CMB-LF-PORTION TO OUT-CSO-CMB-LF-PORT
  8306                                   OUT-CSO-ORIG-CMB-LF-PORT
  8307     COMPUTE WS-CSO-AH-PORTION =
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 145
* NSRASBL.cbl
  8308        WS-WORK-AH-PREM - WS-ACCT-AH-PORTION
  8309     MOVE WS-CSO-AH-PORTION TO OUT-CSO-AH-PORTION
  8310                               OUT-CSO-ORIG-AH-PORT
  8311     COMPUTE WS-CSO-PORTION =
  8312        WS-CSO-CMB-LF-PORTION + WS-CSO-AH-PORTION
  8313     MOVE WS-CSO-PORTION TO OUT-CSO-PORTION
  8314                            OUT-CSO-ORIG-PORTION
  8315     .
  8316 1110-EXIT.
  8317     EXIT.
  8318 1115-MATCH-COMPANY.
  8319     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8320     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8321     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8322
  8323* EXEC CICS READ
  8324*       INTO    (CONTROL-FILE)
  8325*       DATASET ('ELCNTL')
  8326*       RIDFLD  (WS-ELCNTL-KEY)
  8327*       RESP    (WS-RESPONSE)
  8328*    END-EXEC
  8329     MOVE LENGTH OF
  8330      CONTROL-FILE
  8331       TO DFHEIV11
  8332     MOVE 'ELCNTL' TO DFHEIV1
  8333*    MOVE '&"IL       E          (  N#00008047' TO DFHEIV0
  8334     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8335     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8336     MOVE X'204E233030303038303437' TO DFHEIV0(25:11)
  8337     CALL 'kxdfhei1' USING DFHEIV0,
  8338           DFHEIV1,
  8339           CONTROL-FILE,
  8340           DFHEIV11,
  8341           WS-ELCNTL-KEY,
  8342           DFHEIV99,
  8343           DFHEIV99,
  8344           DFHEIV99
  8345     MOVE EIBRESP  TO WS-RESPONSE
  8346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8347     IF RESP-NORMAL
  8348        MOVE CF-COMPANY-CD       TO WS-COMPANY-CD
  8349     END-IF
  8350     .
  8351 1115-EXIT.
  8352     EXIT.
  8353 1120-MATCH-CARRIER.
  8354     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8355     MOVE '6'                    TO WS-ELCNTL-REC-TYPE
  8356     MOVE BL-CARRIER             TO WS-ELCNTL-CARR
  8357     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8358
  8359* EXEC CICS READ
  8360*       INTO    (CONTROL-FILE)
  8361*       DATASET ('ELCNTL')
  8362*       RIDFLD  (WS-ELCNTL-KEY)
  8363*       RESP    (WS-RESPONSE)
  8364*    END-EXEC
  8365     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 146
* NSRASBL.cbl
  8366      CONTROL-FILE
  8367       TO DFHEIV11
  8368     MOVE 'ELCNTL' TO DFHEIV1
  8369*    MOVE '&"IL       E          (  N#00008064' TO DFHEIV0
  8370     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8371     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8372     MOVE X'204E233030303038303634' TO DFHEIV0(25:11)
  8373     CALL 'kxdfhei1' USING DFHEIV0,
  8374           DFHEIV1,
  8375           CONTROL-FILE,
  8376           DFHEIV11,
  8377           WS-ELCNTL-KEY,
  8378           DFHEIV99,
  8379           DFHEIV99,
  8380           DFHEIV99
  8381     MOVE EIBRESP  TO WS-RESPONSE
  8382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8383     IF RESP-NORMAL
  8384        MOVE CF-MAIL-TO-NAME     TO OUT-CARR-NAME
  8385     ELSE
  8386        MOVE 'UNKNOWN'           TO OUT-CARR-NAME
  8387     END-IF
  8388     .
  8389 1120-EXIT.
  8390     EXIT.
  8391 1125-MATCH-STATE.
  8392     MOVE BL-STATE               TO OUT-STATE
  8393     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8394     MOVE '3'                    TO WS-ELCNTL-REC-TYPE
  8395     MOVE BL-STATE               TO WS-ELCNTL-STATE
  8396     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8397
  8398* EXEC CICS READ
  8399*       INTO    (CONTROL-FILE)
  8400*       DATASET ('ELCNTL')
  8401*       RIDFLD  (WS-ELCNTL-KEY)
  8402*       RESP    (WS-RESPONSE)
  8403*    END-EXEC
  8404     MOVE LENGTH OF
  8405      CONTROL-FILE
  8406       TO DFHEIV11
  8407     MOVE 'ELCNTL' TO DFHEIV1
  8408*    MOVE '&"IL       E          (  N#00008084' TO DFHEIV0
  8409     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8410     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8411     MOVE X'204E233030303038303834' TO DFHEIV0(25:11)
  8412     CALL 'kxdfhei1' USING DFHEIV0,
  8413           DFHEIV1,
  8414           CONTROL-FILE,
  8415           DFHEIV11,
  8416           WS-ELCNTL-KEY,
  8417           DFHEIV99,
  8418           DFHEIV99,
  8419           DFHEIV99
  8420     MOVE EIBRESP  TO WS-RESPONSE
  8421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8422     IF RESP-NORMAL
  8423        MOVE CF-STATE-NAME       TO OUT-STATE-NAME
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 147
* NSRASBL.cbl
  8424     ELSE
  8425        MOVE 'UNKNOWN'           TO OUT-STATE-NAME
  8426     END-IF
  8427     .
  8428 1125-EXIT.
  8429     EXIT.
  8430 1130-MATCH-BENCDS.
  8431     MOVE SPACES                 TO WS-LF-ABBRV
  8432                                    WS-LF-DESC
  8433                                    WS-LF-EARN
  8434                                    WS-WAIT-PER
  8435                                    WS-RET-ELIM
  8436                                    WS-AH-DESC
  8437                                    WS-BEN-DAYS
  8438     IF WS-LF-BENCD NOT = ZEROS AND SPACES
  8439        PERFORM 1140-MATCH-LFBEN THRU 1140-EXIT
  8440     END-IF
  8441     IF WS-AH-BENCD NOT = ZEROS AND SPACES
  8442        PERFORM 1150-MATCH-AHBEN THRU 1150-EXIT
  8443     END-IF
  8444     .
  8445 1130-EXIT.
  8446     EXIT.
  8447 1140-MATCH-LFBEN.
  8448     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8449     MOVE '4'                    TO WS-ELCNTL-REC-TYPE
  8450     MOVE WS-LF-BENCD            TO WS-ELCNTL-BEN-CD
  8451     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8452
  8453* EXEC CICS READ
  8454*       INTO    (CONTROL-FILE)
  8455*       DATASET ('ELCNTL')
  8456*       RIDFLD  (WS-ELCNTL-KEY)
  8457*       GTEQ
  8458*       RESP    (WS-RESPONSE)
  8459*    END-EXEC
  8460     MOVE LENGTH OF
  8461      CONTROL-FILE
  8462       TO DFHEIV11
  8463     MOVE 'ELCNTL' TO DFHEIV1
  8464*    MOVE '&"IL       G          (  N#00008120' TO DFHEIV0
  8465     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8466     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8467     MOVE X'204E233030303038313230' TO DFHEIV0(25:11)
  8468     CALL 'kxdfhei1' USING DFHEIV0,
  8469           DFHEIV1,
  8470           CONTROL-FILE,
  8471           DFHEIV11,
  8472           WS-ELCNTL-KEY,
  8473           DFHEIV99,
  8474           DFHEIV99,
  8475           DFHEIV99
  8476     MOVE EIBRESP  TO WS-RESPONSE
  8477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8478     IF RESP-NORMAL
  8479        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8480           (WS-LF-BENCD = CF-BENEFIT-CODE (S1))
  8481           OR (S1 > +8)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 148
* NSRASBL.cbl
  8482        END-PERFORM
  8483        IF S1 < + 9
  8484           MOVE CF-BENEFIT-ALPHA (S1)
  8485                                 TO WS-LF-ABBRV
  8486           MOVE WS-LF-BENCD      TO WS-LF-DESC
  8487           MOVE CF-CO-EARNINGS-CALC (S1)
  8488                                 TO WS-LF-EARN
  8489        ELSE
  8490           MOVE 'XX'             TO WS-LF-DESC
  8491           MOVE 'XXX'            TO WS-LF-ABBRV
  8492        END-IF
  8493     ELSE
  8494        DISPLAY ' NO LF BEN CD ' WS-LF-BENCD
  8495     END-IF
  8496     .
  8497 1140-EXIT.
  8498     EXIT.
  8499 1150-MATCH-AHBEN.
  8500     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8501     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  8502     MOVE WS-AH-BENCD            TO WS-ELCNTL-BEN-CD
  8503     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8504
  8505* EXEC CICS READ
  8506*       INTO    (CONTROL-FILE)
  8507*       DATASET ('ELCNTL')
  8508*       RIDFLD  (WS-ELCNTL-KEY)
  8509*       GTEQ
  8510*       RESP    (WS-RESPONSE)
  8511*    END-EXEC
  8512     MOVE LENGTH OF
  8513      CONTROL-FILE
  8514       TO DFHEIV11
  8515     MOVE 'ELCNTL' TO DFHEIV1
  8516*    MOVE '&"IL       G          (  N#00008153' TO DFHEIV0
  8517     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8518     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8519     MOVE X'204E233030303038313533' TO DFHEIV0(25:11)
  8520     CALL 'kxdfhei1' USING DFHEIV0,
  8521           DFHEIV1,
  8522           CONTROL-FILE,
  8523           DFHEIV11,
  8524           WS-ELCNTL-KEY,
  8525           DFHEIV99,
  8526           DFHEIV99,
  8527           DFHEIV99
  8528     MOVE EIBRESP  TO WS-RESPONSE
  8529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8530     IF RESP-NORMAL
  8531        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8532           (WS-AH-BENCD = CF-BENEFIT-CODE (S1))
  8533           OR (S1 > +8)
  8534        END-PERFORM
  8535        IF S1 < + 9
  8536           MOVE CF-BENEFIT-ALPHA (S1)
  8537                                 TO WS-WAIT-PER
  8538           MOVE CF-BENEFIT-ALPHA (S1) (3:1)
  8539                                 TO WS-RET-ELIM
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 149
* NSRASBL.cbl
  8540           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  8541                                 TO WS-BEN-DAYS
  8542           IF CF-SPECIAL-CALC-CD (S1) = 'C'
  8543              IF CF-JOINT-INDICATOR (S1) = 'J'
  8544                 MOVE 'Joint Critical Period Disability'
  8545                                 TO WS-AH-DESC
  8546              ELSE
  8547                 MOVE 'Single Critical Period-Primary Only'
  8548                                 TO WS-AH-DESC
  8549              END-IF
  8550           ELSE
  8551              IF CF-JOINT-INDICATOR (S1) = 'J'
  8552                 MOVE 'Joint Disability'
  8553                                 TO WS-AH-DESC
  8554              ELSE
  8555                 MOVE 'Single Disability (Primary Only)'
  8556                                 TO WS-AH-DESC
  8557              END-IF
  8558           END-IF
  8559        ELSE
  8560           MOVE 'NOT FOUND'      TO WS-AH-DESC
  8561        END-IF
  8562     ELSE
  8563        DISPLAY ' NO AH BEN CD ' WS-AH-BENCD
  8564     END-IF
  8565     .
  8566 1150-EXIT.
  8567     EXIT.
  8568
  8569 1160-READ-CERT-TRAILER.
  8570
  8571     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
  8572     MOVE WS-ELCERT-KEY          TO  WS-ELCRTT-PRIMARY.
  8573     MOVE 'C'                    TO  WS-ELCRTT-REC-TYPE.
  8574
  8575
  8576* EXEC CICS HANDLE CONDITION
  8577*        NOTFND (1160-CERT-TRL-REC-NOTFND)
  8578*    END-EXEC.
  8579*    MOVE '"$I                   ! " #00008205' TO DFHEIV0
  8580     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8581     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8582     MOVE X'2220233030303038323035' TO DFHEIV0(25:11)
  8583     CALL 'kxdfhei1' USING DFHEIV0
  8584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8585
  8586
  8587
  8588* EXEC CICS READ
  8589*        DATASET  ('ELCRTT')
  8590*        RIDFLD   (WS-ELCRTT-KEY)
  8591*        INTO     (CERTIFICATE-TRAILERS)
  8592*    END-EXEC.
  8593     MOVE LENGTH OF
  8594      CERTIFICATE-TRAILERS
  8595       TO DFHEIV11
  8596     MOVE 'ELCRTT' TO DFHEIV1
  8597*    MOVE '&"IL       E          (   #00008209' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 150
* NSRASBL.cbl
  8598     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8599     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8600     MOVE X'2020233030303038323039' TO DFHEIV0(25:11)
  8601     CALL 'kxdfhei1' USING DFHEIV0,
  8602           DFHEIV1,
  8603           CERTIFICATE-TRAILERS,
  8604           DFHEIV11,
  8605           WS-ELCRTT-KEY,
  8606           DFHEIV99,
  8607           DFHEIV99,
  8608           DFHEIV99
  8609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8610
  8611
  8612     GO TO 1160-EXIT.
  8613
  8614 1160-CERT-TRL-REC-NOTFND.
  8615     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
  8616
  8617 1160-EXIT.
  8618     EXIT.
  8619 1200-GET-ERACCT.
  8620     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  8621     MOVE ' UNKNOWN '            TO OUT-ACCT-NAME
  8622                                    OUT-ACCT-ADDR1
  8623                                    OUT-ACCT-ADDR2
  8624                                    OUT-ACCT-CITY
  8625     MOVE ZEROS                  TO WS-CHGBACK
  8626
  8627* EXEC CICS STARTBR
  8628*        DATASET   ('ERACCT')
  8629*        RIDFLD    (WS-ERACCT-KEY)
  8630*        GTEQ
  8631*        RESP      (WS-RESPONSE)
  8632*    END-EXEC
  8633     MOVE 'ERACCT' TO DFHEIV1
  8634     MOVE 0
  8635       TO DFHEIV11
  8636*    MOVE '&,         G          &  N#00008229' TO DFHEIV0
  8637     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8638     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8639     MOVE X'204E233030303038323239' TO DFHEIV0(25:11)
  8640     CALL 'kxdfhei1' USING DFHEIV0,
  8641           DFHEIV1,
  8642           WS-ERACCT-KEY,
  8643           DFHEIV99,
  8644           DFHEIV11,
  8645           DFHEIV99
  8646     MOVE EIBRESP  TO WS-RESPONSE
  8647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8648     IF RESP-NORMAL
  8649
  8650* EXEC CICS READNEXT
  8651*          INTO    (ACCOUNT-MASTER)
  8652*          DATASET ('ERACCT')
  8653*          RIDFLD  (WS-ERACCT-KEY)
  8654*          RESP    (WS-RESPONSE)
  8655*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 151
* NSRASBL.cbl
  8656     MOVE LENGTH OF
  8657      ACCOUNT-MASTER
  8658       TO DFHEIV12
  8659     MOVE 'ERACCT' TO DFHEIV1
  8660     MOVE 0
  8661       TO DFHEIV11
  8662*    MOVE '&.IL                  )  N#00008236' TO DFHEIV0
  8663     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8664     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8665     MOVE X'204E233030303038323336' TO DFHEIV0(25:11)
  8666     CALL 'kxdfhei1' USING DFHEIV0,
  8667           DFHEIV1,
  8668           ACCOUNT-MASTER,
  8669           DFHEIV12,
  8670           WS-ERACCT-KEY,
  8671           DFHEIV99,
  8672           DFHEIV11,
  8673           DFHEIV99,
  8674           DFHEIV99
  8675     MOVE EIBRESP  TO WS-RESPONSE
  8676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8677     END-IF
  8678     IF RESP-NORMAL
  8679        PERFORM UNTIL
  8680           NOT (RESP-NORMAL)
  8681           OR (WS-SAVE-ERACCT-KEY NOT =
  8682                        AM-CONTROL-PRIMARY (1:20))
  8683           IF BL-DATA-SRCE = '4' OR '2'
  8684              IF (WS-CERT-EFF-DT < AM-EXPIRATION-DT
  8685                 AND >= AM-EFFECTIVE-DT)
  8686                 PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8687                    (AM-COM-TYP (S1) = 'C' OR 'D')
  8688                    OR (S1 > +10)
  8689                 END-PERFORM
  8690                 IF S1 < +11
  8691                    MOVE AM-COMM-CHARGEBACK (S1)
  8692                                 TO WS-CHGBACK
  8693                 END-IF
  8694              END-IF
  8695           END-IF
  8696           MOVE ACCOUNT-MASTER   TO WS-SAVE-ERACCT-REC
  8697
  8698* EXEC CICS READNEXT
  8699*             INTO    (ACCOUNT-MASTER)
  8700*             DATASET ('ERACCT')
  8701*             RIDFLD  (WS-ERACCT-KEY)
  8702*             RESP    (WS-RESPONSE)
  8703*          END-EXEC
  8704     MOVE LENGTH OF
  8705      ACCOUNT-MASTER
  8706       TO DFHEIV12
  8707     MOVE 'ERACCT' TO DFHEIV1
  8708     MOVE 0
  8709       TO DFHEIV11
  8710*    MOVE '&.IL                  )  N#00008262' TO DFHEIV0
  8711     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8712     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8713     MOVE X'204E233030303038323632' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 152
* NSRASBL.cbl
  8714     CALL 'kxdfhei1' USING DFHEIV0,
  8715           DFHEIV1,
  8716           ACCOUNT-MASTER,
  8717           DFHEIV12,
  8718           WS-ERACCT-KEY,
  8719           DFHEIV99,
  8720           DFHEIV11,
  8721           DFHEIV99,
  8722           DFHEIV99
  8723     MOVE EIBRESP  TO WS-RESPONSE
  8724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8725        END-PERFORM
  8726        MOVE WS-SAVE-ERACCT-REC  TO ACCOUNT-MASTER
  8727        IF WS-SAVE-ERACCT-KEY = AM-CONTROL-PRIMARY (1:20)
  8728           SET ACCT-FOUND TO TRUE
  8729           MOVE AM-NAME          TO OUT-ACCT-NAME
  8730           MOVE AM-ADDRS         TO OUT-ACCT-ADDR1
  8731           MOVE SPACES           TO OUT-ACCT-ADDR2
  8732           MOVE AM-ADDR-CITY     TO OUT-ACCT-CITY
  8733           MOVE AM-ADDR-STATE    TO OUT-ACCT-STATE
  8734           MOVE AM-ZIP-PRIME     TO OUT-ACCT-ZIP
  8735           MOVE AM-CONTROL-NAME  TO OUT-ACCT-CNTRL-NAME
  8736           MOVE AM-REPORT-CODE-1 TO OUT-RPT-CD1
  8737           MOVE AM-REPORT-CODE-2 TO OUT-RPT-CD2
  8738           IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  8739              STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  8740                 INTO OUT-ACCT-ZIP (6:5)
  8741              END-STRING
  8742           END-IF
  8743           MOVE AM-TEL-NO        TO OUT-ACCT-PHONE
  8744           MOVE AM-GPCD          TO OUT-ACCT-BUS-TYPE
  8745           MOVE AM-STATE         TO OUT-FORM
  8746           IF AM-ACCOUNT (10:1) = 'L'
  8747              MOVE 'L'           TO OUT-FORM (3:1)
  8748                                    OUT-LEASE-IND
  8749           END-IF
  8750           MOVE AM-CONTROL-PRIMARY (1:8)
  8751                                 TO WS-ERCOMP-KEY
  8752           IF AM-REMIT-TO NOT NUMERIC
  8753              MOVE 01            TO AM-REMIT-TO
  8754           END-IF
  8755           MOVE AM-AGT (AM-REMIT-TO) TO WS-ERCOMP-RESP-NO
  8756           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8757              (AM-COM-TYP (S1) = 'C' OR 'D')
  8758              OR (S1 > +10)
  8759           END-PERFORM
  8760           IF S1 < +11
  8761              MOVE AM-AGT (S1)   TO WS-ERCOMP-ACCOUNT
  8762           END-IF
  8763           MOVE 'A'              TO WS-ERCOMP-REC-TYPE
  8764           PERFORM 1225-GET-ERCOMP THRU 1225-EXIT
  8765        END-IF
  8766     END-IF
  8767
  8768* EXEC CICS ENDBR
  8769*        DATASET   ('ERACCT')
  8770*    END-EXEC
  8771     MOVE 'ERACCT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 153
* NSRASBL.cbl
  8772     MOVE 0
  8773       TO DFHEIV11
  8774*    MOVE '&2                    $   #00008310' TO DFHEIV0
  8775     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8776     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8777     MOVE X'2020233030303038333130' TO DFHEIV0(25:11)
  8778     CALL 'kxdfhei1' USING DFHEIV0,
  8779           DFHEIV1,
  8780           DFHEIV11,
  8781           DFHEIV99
  8782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8783    .
  8784 1200-EXIT.
  8785     EXIT.
  8786 1225-GET-ERCOMP.
  8787
  8788* EXEC CICS READ
  8789*       INTO    (COMPENSATION-MASTER)
  8790*       DATASET ('ERCOMP')
  8791*       RIDFLD  (WS-ERCOMP-KEY)
  8792*       RESP    (WS-RESPONSE)
  8793*    END-EXEC
  8794     MOVE LENGTH OF
  8795      COMPENSATION-MASTER
  8796       TO DFHEIV11
  8797     MOVE 'ERCOMP' TO DFHEIV1
  8798*    MOVE '&"IL       E          (  N#00008317' TO DFHEIV0
  8799     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8800     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8801     MOVE X'204E233030303038333137' TO DFHEIV0(25:11)
  8802     CALL 'kxdfhei1' USING DFHEIV0,
  8803           DFHEIV1,
  8804           COMPENSATION-MASTER,
  8805           DFHEIV11,
  8806           WS-ERCOMP-KEY,
  8807           DFHEIV99,
  8808           DFHEIV99,
  8809           DFHEIV99
  8810     MOVE EIBRESP  TO WS-RESPONSE
  8811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8812     IF RESP-NORMAL
  8813        MOVE CO-RESP-NO          TO OUT-RESP-NO
  8814        MOVE CO-ACCT-NAME        TO OUT-COMP-NAME
  8815        MOVE CO-MAIL-NAME        TO OUT-COMP-MAIL-TO
  8816        MOVE CO-ADDR-1           TO OUT-COMP-ADDR1
  8817        MOVE CO-ADDR-2           TO OUT-COMP-ADDR2
  8818        MOVE CO-ADDR-CITY        TO OUT-COMP-CITY
  8819        MOVE CO-ADDR-STATE       TO OUT-COMP-STATE
  8820        MOVE CO-ZIP              TO OUT-COMP-ZIP
  8821        MOVE CO-TELEPHONE        TO OUT-COMP-PHONE
  8822        MOVE CO-FAXNO            TO OUT-COMP-FAX
  8823        MOVE CO-GA-STATUS-CODE   TO OUT-COMP-STATUS
  8824        MOVE CO-BILL-SW          TO OUT-BILL-SW
  8825     END-IF
  8826     .
  8827 1225-EXIT.
  8828     EXIT.
  8829 1250-GET-ELLETR.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 154
* NSRASBL.cbl
  8830     display ' made it to 1250 '
  8831     move spaces                 to W-Z-CONTROL-DATA
  8832     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  8833     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  8834     MOVE +0                     TO WS-ELLETR-SEQ-NO
  8835
  8836* EXEC CICS READ
  8837*         DATASET    ('ELLETR')
  8838*         INTO       (TEXT-FILES)
  8839*         RIDFLD     (WS-ELLETR-KEY)
  8840*         RESP       (WS-RESPONSE)
  8841*         GTEQ
  8842*    END-EXEC
  8843     MOVE LENGTH OF
  8844      TEXT-FILES
  8845       TO DFHEIV11
  8846     MOVE 'ELLETR' TO DFHEIV1
  8847*    MOVE '&"IL       G          (  N#00008346' TO DFHEIV0
  8848     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8849     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8850     MOVE X'204E233030303038333436' TO DFHEIV0(25:11)
  8851     CALL 'kxdfhei1' USING DFHEIV0,
  8852           DFHEIV1,
  8853           TEXT-FILES,
  8854           DFHEIV11,
  8855           WS-ELLETR-KEY,
  8856           DFHEIV99,
  8857           DFHEIV99,
  8858           DFHEIV99
  8859     MOVE EIBRESP  TO WS-RESPONSE
  8860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8861     IF RESP-NORMAL
  8862        IF (LETTER-FILE-TEXT)
  8863           AND (BL-LETTER-ID = TX-LETTER-NO)
  8864           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  8865           display ' found good z record '
  8866           PERFORM 1280-PROCESS-Z-CONTROLS
  8867                                 THRU 1280-EXIT
  8868        END-IF
  8869     END-IF
  8870     .
  8871 1250-EXIT.
  8872     EXIT.
  8873 1280-PROCESS-Z-CONTROLS.
  8874     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  8875*    IF W-FORM-TO-RESEND > SPACES
  8876*       MOVE W-FORM-TO-RESEND    TO OUT-FORM
  8877*    ELSE
  8878*       MOVE SPACES              TO OUT-FORM
  8879*    END-IF
  8880     IF BL-ENC-CD = SPACES OR LOW-VALUES
  8881        MOVE W-ENCLOSURE-CD         TO BL-ENC-CD
  8882     END-IF
  8883     MOVE W-LETTER-TYPE          TO OUT-LETTER-TYPE
  8884     MOVE W-PRINT-CERTIFICATE    TO OUT-PRINT-CERTIFICATE
  8885     .
  8886 1280-EXIT.
  8887     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 155
* NSRASBL.cbl
  8888 1300-DETERMINE-COMM.
  8889******************************************************************
  8890* DATA SOURCE MEANINGS  BL-DATA-SRCE
  8891*    1) FROM ACCT MAINT
  8892*    2) FROM CERT UPDATE
  8893*    3) FROM COMP MAINT
  8894*    4) FROM REVIEW AND CORRECTIONS
  8895******************************************************************
  8896     MOVE 'Y'                    TO OUT-CHGBACK
  8897     MOVE ZEROS                  TO WS-DIFF
  8898                                    WS-CHGBK-LIFE-PCT
  8899                                    WS-CHGBK-AH-PCT
  8900     IF BL-DATA-SRCE = '4'
  8901        IF PB-CANCELLATION
  8902           MOVE PB-CI-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8903           MOVE PB-CI-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8904           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
  8905           MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-2
  8906           IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  8907              MOVE PB-C-LF-CANCEL-DT
  8908                                 TO DC-BIN-DATE-2
  8909           END-IF
  8910           MOVE '1'              TO DC-OPTION-CODE
  8911           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8912           IF NO-CONVERSION-ERROR
  8913              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8914              IF DC-ODD-DAYS-OVER > +1
  8915                 ADD +1          TO WS-DIFF
  8916              END-IF
  8917              IF (WS-CHGBACK = 99)
  8918                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8919                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8920                                WS-CHGBK-AH-PCT
  8921                   MOVE 'N'  TO OUT-CHGBACK
  8922              END-IF
  8923           END-IF
  8924        ELSE
  8925           MOVE PB-I-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8926           MOVE PB-I-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8927        END-IF
  8928     ELSE
  8929        MOVE CM-LIFE-COMM-PCT TO WS-CHGBK-LIFE-PCT
  8930        MOVE CM-AH-COMM-PCT   TO WS-CHGBK-AH-PCT
  8931        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8932           OR (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8933           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  8934           MOVE CM-AH-CANCEL-DT  TO DC-BIN-DATE-2
  8935           IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  8936              MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  8937           END-IF
  8938           MOVE '1'              TO DC-OPTION-CODE
  8939           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8940           IF NO-CONVERSION-ERROR
  8941              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8942              IF DC-ODD-DAYS-OVER > +1
  8943                 ADD +1          TO WS-DIFF
  8944              END-IF
  8945              IF (WS-CHGBACK = 99)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 156
* NSRASBL.cbl
  8946                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8947                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8948                                WS-CHGBK-AH-PCT
  8949                   MOVE 'N'  TO OUT-CHGBACK
  8950              END-IF
  8951           END-IF
  8952        END-IF
  8953     END-IF
  8954     .
  8955 1300-EXIT.
  8956     EXIT.
  8957 1500-GET-ARCH-NO.
  8958     DISPLAY ' MADE IT TO 1500 '
  8959     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  8960     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8961     MOVE SPACES                 TO WS-ELCNTL-GENL
  8962     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8963
  8964* EXEC CICS READ
  8965*       INTO    (CONTROL-FILE)
  8966*       DATASET ('ELCNTL')
  8967*       RIDFLD  (WS-ELCNTL-KEY)
  8968*       UPDATE
  8969*       RESP    (WS-RESPONSE)
  8970*    END-EXEC
  8971     MOVE LENGTH OF
  8972      CONTROL-FILE
  8973       TO DFHEIV11
  8974     MOVE 'ELCNTL' TO DFHEIV1
  8975*    MOVE '&"IL       EU         (  N#00008455' TO DFHEIV0
  8976     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8977     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8978     MOVE X'204E233030303038343535' TO DFHEIV0(25:11)
  8979     CALL 'kxdfhei1' USING DFHEIV0,
  8980           DFHEIV1,
  8981           CONTROL-FILE,
  8982           DFHEIV11,
  8983           WS-ELCNTL-KEY,
  8984           DFHEIV99,
  8985           DFHEIV99,
  8986           DFHEIV99
  8987     MOVE EIBRESP  TO WS-RESPONSE
  8988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8989     IF RESP-NORMAL
  8990        AND (CF-COMPANY-ID  = BL-COMP-ID)
  8991        AND (CF-RECORD-TYPE = '1')
  8992        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  8993        MOVE CF-CREDIT-LAST-ARCH-NUM
  8994                                 TO WS-ARCHIVE-NO
  8995
  8996* EXEC CICS REWRITE
  8997*          FROM    (CONTROL-FILE)
  8998*          DATASET ('ELCNTL')
  8999*       END-EXEC
  9000     MOVE LENGTH OF
  9001      CONTROL-FILE
  9002       TO DFHEIV11
  9003     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 157
* NSRASBL.cbl
  9004*    MOVE '&& L                  %   #00008468' TO DFHEIV0
  9005     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9006     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9007     MOVE X'2020233030303038343638' TO DFHEIV0(25:11)
  9008     CALL 'kxdfhei1' USING DFHEIV0,
  9009           DFHEIV1,
  9010           CONTROL-FILE,
  9011           DFHEIV11,
  9012           DFHEIV99
  9013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9014     ELSE
  9015        MOVE +0                  TO WS-ARCHIVE-NO
  9016     END-IF
  9017    .
  9018 1500-EXIT.
  9019     EXIT.
  9020 1700-GET-ELENCC.
  9021     MOVE WS-COMPANY-CD          TO WS-ELENCC-KEY
  9022     MOVE '2'                    TO WS-ELENCC-REC-TYPE
  9023     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  9024     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  9025        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  9026        OR (E1 > +5)
  9027     END-PERFORM
  9028     IF E1 < +5
  9029        MOVE BL-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  9030     END-IF
  9031
  9032* EXEC CICS READ
  9033*        DATASET   ('ELENCC')
  9034*        INTO      (ENCLOSURE-CODES)
  9035*        RIDFLD    (WS-ELENCC-KEY)
  9036*        RESP      (WS-RESPONSE)
  9037*    END-EXEC
  9038     MOVE LENGTH OF
  9039      ENCLOSURE-CODES
  9040       TO DFHEIV11
  9041     MOVE 'ELENCC' TO DFHEIV1
  9042*    MOVE '&"IL       E          (  N#00008489' TO DFHEIV0
  9043     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9044     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9045     MOVE X'204E233030303038343839' TO DFHEIV0(25:11)
  9046     CALL 'kxdfhei1' USING DFHEIV0,
  9047           DFHEIV1,
  9048           ENCLOSURE-CODES,
  9049           DFHEIV11,
  9050           WS-ELENCC-KEY,
  9051           DFHEIV99,
  9052           DFHEIV99,
  9053           DFHEIV99
  9054     MOVE EIBRESP  TO WS-RESPONSE
  9055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9056     IF NOT RESP-NORMAL
  9057        display ' elencc resp not normal ' ws-response
  9058        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  9059
  9060* EXEC CICS READ
  9061*           DATASET   ('ELENCC')
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 158
* NSRASBL.cbl
  9062*           INTO      (ENCLOSURE-CODES)
  9063*           RIDFLD    (WS-ELENCC-KEY)
  9064*           RESP      (WS-RESPONSE)
  9065*       END-EXEC
  9066     MOVE LENGTH OF
  9067      ENCLOSURE-CODES
  9068       TO DFHEIV11
  9069     MOVE 'ELENCC' TO DFHEIV1
  9070*    MOVE '&"IL       E          (  N#00008498' TO DFHEIV0
  9071     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9073     MOVE X'204E233030303038343938' TO DFHEIV0(25:11)
  9074     CALL 'kxdfhei1' USING DFHEIV0,
  9075           DFHEIV1,
  9076           ENCLOSURE-CODES,
  9077           DFHEIV11,
  9078           WS-ELENCC-KEY,
  9079           DFHEIV99,
  9080           DFHEIV99,
  9081           DFHEIV99
  9082     MOVE EIBRESP  TO WS-RESPONSE
  9083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9084     END-IF
  9085     IF RESP-NORMAL
  9086        display ' elencc resp normal ' ws-response
  9087        MOVE NC-OUTPUT-STACK     TO OUT-STACK
  9088        MOVE NC-ENCLOSURE-LINE   TO OUT-ENC-LINE
  9089        MOVE NC-ATTACHMENTS      TO OUT-ATTACH
  9090     END-IF
  9091     .
  9092 1700-EXIT.
  9093     EXIT.
  9094
  9095
  9096 4100-CONNECT-TO-DB.
  9097
  9098     MOVE 'NTCSO2_LOGIC'         TO SVR
  9099     MOVE 'sa'                   TO USR
  9100     MOVE 'ntcso2'               TO PASS
  9101
  9102     STRING
  9103         USR DELIMITED SPACE
  9104         "." DELIMITED SIZE
  9105         PASS DELIMITED SPACE INTO USR-PASS
  9106     END-STRING
  9107
  9108     EXEC SQL
  9109        CONNECT TO :SVR USER :USR-PASS
  9110     END-EXEC
  9111
  9112     IF SQLCODE NOT = 0
  9113        DISPLAY "ERROR: CANNOT CONNECT "
  9114        DISPLAY SQLCODE
  9115        DISPLAY SQLERRMC
  9116        GO TO 4100-EXIT
  9117     END-IF
  9118
  9119     .
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 159
* NSRASBL.cbl
  9120 4100-EXIT.
  9121     EXIT.
  9122
  9123
  9124
  9125 4200-GET-NEXT-BUS-DT.
  9126
  9127     MOVE WS-SAVE-EDIT-A-DATE    TO WS-CYCLE-DATE
  9128     MOVE SPACES                 TO WS-NEXT-BUS-DT
  9129
  9130     IF WS-KIXHOST = 'logictest'
  9131        EXEC SQL
  9132          CALL NaperTestCalcNextBusDt
  9133                        @cycledate = :WS-CYCLE-DATE,
  9134                        @nextbusdate = :WS-NEXT-BUS-DT OUT
  9135        END-EXEC
  9136     ELSE
  9137        EXEC SQL
  9138          CALL NaperProdCalcNextBusDt
  9139                        @cycledate = :WS-CYCLE-DATE,
  9140                        @nextbusdate = :WS-NEXT-BUS-DT OUT
  9141        END-EXEC
  9142     END-IF
  9143
  9144     IF SQLCODE NOT = 0
  9145        DISPLAY "ERROR: DID NOT RETURN NEXT BUS DT "
  9146        DISPLAY ' SQL RETURN CODE ' SQLCODE
  9147        DISPLAY ' SQL ERR MESS    ' SQLERRMC
  9148        GO TO 4200-EXIT
  9149     END-IF
  9150
  9151     .
  9152 4200-EXIT.
  9153     EXIT.
  9154
  9155
  9156
  9157 4300-DISCONNECT.
  9158
  9159     EXEC SQL
  9160        DISCONNECT
  9161     END-EXEC
  9162     .
  9163 4300-EXIT.
  9164     EXIT.
  9165
  9166 9700-DATE-LINK.
  9167
  9168* EXEC CICS LINK
  9169*        PROGRAM   ('ELDATCV')
  9170*        COMMAREA  (DATE-CONVERSION-DATA)
  9171*        LENGTH    (DC-COMM-LENGTH)
  9172*    END-EXEC.
  9173     MOVE 'ELDATCV' TO DFHEIV1
  9174*    MOVE '."C                   (   #00008587' TO DFHEIV0
  9175     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9176     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9177     MOVE X'2020233030303038353837' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:29 Page 160
* NSRASBL.cbl
  9178     CALL 'kxdfhei1' USING DFHEIV0,
  9179           DFHEIV1,
  9180           DATE-CONVERSION-DATA,
  9181           DC-COMM-LENGTH,
  9182           DFHEIV99,
  9183           DFHEIV99,
  9184           DFHEIV99,
  9185           DFHEIV99
  9186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9187
  9188 9700-EXIT.
  9189      EXIT.
  9190
  9191 9999-DFHBACK SECTION.
  9192     MOVE '9%                    "   ' TO DFHEIV0
  9193     MOVE 'NSRASBL' TO DFHEIV1
  9194     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9195     GOBACK.
  9196 9999-DFHEXIT.
  9197     IF DFHEIGDJ EQUAL 0001
  9198         NEXT SENTENCE
  9199     ELSE IF DFHEIGDJ EQUAL 2
  9200         GO TO 1160-CERT-TRL-REC-NOTFND
  9201         DEPENDING ON DFHEIGDI.
  9202     MOVE '9%                    "   ' TO DFHEIV0
  9203     MOVE 'NSRASBL' TO DFHEIV1
  9204     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9205     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      168468     Code:       57435
