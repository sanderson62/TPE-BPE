* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page   1
* EL202.cbl
* Options: int("EL202.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL202.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL202.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL202.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 identification division.
     9 program-id. EL202.
    10*
    11*AUTHOR.    Cowtown.
    12*           Colleyville, TEXAS.
    13*REMARKS.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page   2
* EL202.cbl
    14***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    15***                                                            ***
    16***  This program is waken up by a webservice request/http     ***
    17***  request and is passed a remit id. The program will next   ***
    18***  read tables CUC_Logic_Remittance and CUC_Logic_Remittance_***
    19***  cert using the remit id passed and will in turn generate  ***
    20***  a ERPYAJ record, ERPNDB and ERPNDM records.               ***
    21***                                                            ***
    22***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 091114  CR2013121800001  PEMA  NEW PROGRAM
    32* 111715  IR2015111600001  PEMA  CHG G/L ACCTNO ON CID ACH
    33*-----------------------------------------------------------------
    34 environment division.
    35 data division.
    36 working-storage section.
    37 01  DFH-START PIC X(04).
    38 77  s1                          pic s999 comp-3 value +0.
    39 77  s2                          pic s999 comp-3 value +0.
    40 77  i1                          pic s999 comp-3 value +0.
    41 77  o1                          pic s999 comp-3 value +0.
    42 77  ws-bin-current-dt           pic xx value low-values.
    43 77  ws-bin-eom-dt               pic xx value low-values.
    44 77  ws-table-sw                 pic x    value spaces.
    45     88  table-found               value 'Y'.
    46 77  ws-sql-code                 pic s9(7) value zeros.
    47 77  ws-dis-sql-code             pic -9999999 value zeros.
    48 77  ws-remit-sw                 pic x value ' '.
    49     88  ws-remit-not-found        value 'N'.
    50 77  work-seq-no                 pic s9(8) comp-3 value +0.
    51 77  ws-rollback-sw              pic x  value spaces.
    52     88  rollback-needed            value 'Y'.
    53 77  ws-commit-sw                pic x  value spaces.
    54     88  commit-needed              value 'Y'.
    55 77  ROLL-BACK                   PIC X(08) VALUE 'ROLLBACK'.
    56 01  P pointer.
    57 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    58 01  var-ptr pointer.
    59 01  env-var-len                 pic 9(4)  binary.
    60 01  rc                          pic 9(9)  binary.
    61 01  WS-KIXSYS.
    62     05  WS-KIX-FIL1             PIC X(10).
    63     05  WS-KIX-APPS             PIC X(10).
    64     05  WS-KIX-ENV              PIC X(10).
    65     05  WS-KIX-MYENV            PIC X(10).
    66     05  WS-KIX-SYS              PIC X(10).
*   67 EXEC SQL
*   68    INCLUDE SQLDA
*   69 END-EXEC
    70 01 SQLDA sync.
    71    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page   3
* EL202.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
    72    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    73    05 SQLN                  PIC S9(4) COMP-5 value 0.
    74    05 SQLD                  PIC S9(4) COMP-5 value 0.
    75    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    76       10 SQLTYPE            PIC S9(4) COMP-5.
    77       10 SQLLEN             PIC S9(4) COMP-5.
    78$IF P64 SET
    79X      *> For 64-bit environments, ensure that SQLDATA is
    80X      *> aligned on an 8-byte boundary.
    81X      10 FILLER             PIC S9(9) COMP-5.
    82$END
    83       10 SQLDATA            USAGE POINTER.
    84       10 SQLIND             USAGE POINTER.
    85       10 SQLNAME.
    86          15 SQLNAMEL        PIC S9(4) COMP-5.
    87          15 SQLNAMEC        PIC X(30).
    88
    89* Values for SQLTYPE
    90
    91 78  ESQL-DATE-CHAR              VALUE 384.
    92 78  ESQL-DATE-CHAR-NULL         VALUE 385.
    93 78  ESQL-DATE-REC               VALUE 386.
    94 78  ESQL-DATE-REC-NULL          VALUE 387.
    95 78  ESQL-TIME-CHAR              VALUE 388.
    96 78  ESQL-TIME-CHAR-NULL         VALUE 389.
    97 78  ESQL-TIME-REC               VALUE 390.
    98 78  ESQL-TIME-REC-NULL          VALUE 391.
    99 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   100 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   101 78  ESQL-TIMESTAMP-REC          VALUE 394.
   102 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   103 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   104 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   105 78  ESQL-TS-OFFSET-REC          VALUE 398.
   106 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   107 78  ESQL-LONGVARBINARY          VALUE 404.
   108 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   109 78  ESQL-LONGVARCHAR            VALUE 408.
   110 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   111 78  ESQL-BINARY                 VALUE 444.
   112 78  ESQL-BINARY-NULL            VALUE 445.
   113 78  ESQL-VARBINARY              VALUE 446.
   114 78  ESQL-VARBINARY-NULL         VALUE 447.
   115 78  ESQL-VARCHAR                VALUE 448.
   116 78  ESQL-VARCHAR-NULL           VALUE 449.
   117
   118 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   119 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   120
   121 78  ESQL-CHAR                   VALUE 452.
   122 78  ESQL-CHAR-NULL              VALUE 453.
   123
   124 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   125 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   126
   127 78  ESQL-DOUBLE                 VALUE 480.
   128 78  ESQL-DOUBLE-NULL            VALUE 481.
   129 78  ESQL-REAL                   VALUE 482.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page   4
* EL202.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-REAL-NULL              VALUE 483.
   131 78  ESQL-DECIMAL                VALUE 484.
   132 78  ESQL-DECIMAL-NULL           VALUE 485.
   133 78  ESQL-INTEGER                VALUE 496.
   134 78  ESQL-INTEGER-NULL           VALUE 497.
   135 78  ESQL-SMALLINT               VALUE 500.
   136 78  ESQL-SMALLINT-NULL          VALUE 501.
   137 78  ESQL-TINYINT                VALUE 502.
   138 78  ESQL-TINYINT-NULL           VALUE 503.
*  139 EXEC SQL
*  140    INCLUDE SQLCA
*  141 END-EXEC
   142 01 SQLCA.
   143     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   144     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   145     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   146     05  SQLERRM.
   147         49  SQLERRML    PIC S9(4) COMP-5.
   148         49  SQLERRMC    PIC X(70).
   149     05  SQLERRP         PIC X(8).
   150     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   151     05  SQLWARN.
   152         10  SQLWARN0    PIC X.
   153         10  SQLWARN1    PIC X.
   154         10  SQLWARN2    PIC X.
   155         10  SQLWARN3    PIC X.
   156         10  SQLWARN4    PIC X.
   157         10  SQLWARN5    PIC X.
   158         10  SQLWARN6    PIC X.
   159         10  SQLWARN7    PIC X.
   160     05  SQLEXT.
   161         10  SQLWARN8    PIC X.
   162         10  SQLWARN9    PIC X.
   163         10  SQLWARN10   PIC X.
   164         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   165     05  SQLSTATE    PIC X(5).
   166 EXEC SQL
   167    BEGIN DECLARE SECTION
   168 END-EXEC
   169 01  ws-remit-id-a               pic x(10).
   170 01  ws-remit-id redefines
   171     ws-remit-id-a               pic 9(10).
   172 01  ws-key-stuff.
   173     05  ws-batch-no             pic x(6) value zeros.
   174     05  ws-batch-no-n redefines
   175         ws-batch-no             pic 9(6).
   176     05  ws-check-key            pic 9(7).
   177     05  ws-check-no             pic x(7).
   178     05  ws-compid               pic xxx.
   179     05  ws-carrier              pic x.
   180     05  ws-grouping             pic x(6).
   181     05  ws-state                pic xx.
   182     05  ws-account              pic x(10).
   183     05  ws-eff-date             pic x(10).
   184     05  ws-certificate          pic x(10).
   185     05  ws-cert-sfx             pic x.
   186     05  ws-seq-no               pic 999.
   187     05  ws-type                 pic 999.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page   5
* EL202.cbl
   188 01  ws-status-code-a            pic x(7) value zeros.
   189 01  ws-status-code redefines
   190     ws-status-code-a            pic 9(7).
   191 01  ws-error-message            pic x(50) value spaces.
   192 01  ws-status-date              pic x(10).
   193 01  sqlcmd                      pic x(1024).
   194 01  svr                         pic x(32).
   195 01  usr                         pic x(32).
   196 01  pass                        pic x(32).
   197 01  usr-pass                    pic x(64).
   198 01  ws-disp-code                pic s9(11).
   199***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   200***                                                            ***
   201***  These indicators are used to determine if a variable      ***
   202***  is        null.           The indicator will be -1        ***
   203***  if the value        is null  and +0 if the value is       ***
   204***  something other than null.  Here is an example on how     ***
   205***  to use the indicator variables.                           ***
   206***                                                            ***
   207***     EXEC SQL                                               ***
   208***        fetch checkapp into                                 ***
   209***           :db-app-status :nu-app-status,                   ***
   210***           :db-app-by     :nu-app-by,                       ***
   211***           :db-app-date   :nu-app-date,                     ***
   212***           :db-app-batch  :nu-app-batch                     ***
   213***     END-EXEC                                               ***
   214***                                                            ***
   215***           OR This way on an update                         ***
   216***                                                            ***
   217***     EXEC SQL                                               ***
   218***        UPDATE                                              ***
   219***           CUC_Logic_Remittance                             ***
   220***        SET                                                 ***
   221***           LogicStatus     = :ws-status-code,               ***
   222***           LogicStatusDate = :ws-status-date,               ***
   223***           BatchNumber     = :ws-batch-no :nu-batchno       ***
   224***        WHERE                                               ***
   225***           RemitId = :ws-remit-id                           ***
   226***     END-EXEC                                               ***
   227***                                                            ***
   228***    Also, when the table has a column with a data type of   ***
   229***  "BIT" and used as true/false move the 1 byte receiving    ***
   230***  field to ws-bit and check out ws-bit-comp. if = zeros,    ***
   231***  then its false. I think true would be 256.                ***
   232***                                                            ***
   233***                                                            ***
   234***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   235 01  ws-bit                      pic x.
   236 01  ws-bit-comp redefines ws-bit pic s9(4) comp.
   237 01  indicator-vaiables-for-nulls.
   238     05  nu-app-status           pic s9(4) comp value +0.
   239     05  nu-app-by               pic s9(4) comp value +0.
   240     05  nu-app-date             pic s9(4) comp value +0.
   241     05  nu-app-batch            pic s9(4) comp value +0.
   242     05  nu-fincar               pic s9(4) comp value +0.
   243     05  nu-batchno              pic s9(4) comp value +0.
   244     05  nu-error-message        pic s9(4) comp value +0.
   245 01  sql-remit-record.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page   6
* EL202.cbl
   246     05  sql-py-RemitId          pic 9(9).
   247     05  sql-py-Carrier          pic x.
   248     05  sql-py-Group            pic x(6).
   249     05  sql-py-State            pic xx.
   250     05  sql-py-AccountNumber    pic x(10).
   251     05  sql-py-Name             pic x(50).
   252     05  sql-py-Addr1            pic x(50).
   253     05  sql-py-Addr2            pic x(50).
   254     05  sql-py-AddrCity         pic x(50).
   255     05  sql-py-AddrState        pic xx.
   256     05  sql-py-AddrZIP          pic x(9).
   257     05  sql-py-ResponsibleCarrier
   258                                 pic x.
   259     05  sql-py-ResponsibleNumber
   260                                 pic x(10).
   261     05  sql-py-LogicStatus      pic 9(7).
   262     05  sql-py-LogicStatusDate  pic x(30).
   263     05  sql-py-company          pic xxx.
   264     05  sql-py-tot-prem         pic x(12).
   265     05  sql-py-tot-prem-n redefines
   266         sql-py-tot-prem         pic 9(9).99.
   267     05  sql-is-ach              pic x.
   268 01  sql-cert-records.
   269     05  sql-pb-CertId           pic 9(9).
   270     05  sql-pb-RemitId          pic 9(9).
   271     05  sql-pb-CertNumber       pic x(11).
   272     05  sql-pb-EffectiveDate    pic x(30).
   273     05  sql-pb-FirstPaymentDate pic x(30).
   274     05  sql-pb-FirstName        pic x(30).
   275     05  sql-pb-LastName         pic x(30).
   276     05  sql-pb-CashIndicator    pic x.
   277     05  sql-pb-LivesCovered     pic 9(7).
   278     05  sql-pb-LfBenCode        pic xx.
   279     05  sql-pb-LfTerm           pic 999.
   280     05  sql-pb-LfBenefit        pic x(12).
   281     05  sql-pb-lfbenefit-n redefines
   282         sql-pb-lfbenefit        pic 9(9).99.
   283     05  sql-pb-LfPremium        pic x(10).
   284     05  sql-pb-lfpremium-n redefines
   285         sql-pb-lfpremium        pic 9(7).99.
   286     05  sql-pb-AhBenCode        pic xx.
   287     05  sql-pb-AhTerm           pic 999.
   288     05  sql-pb-AhBenefit        pic x(10).
   289     05  sql-pb-ahbenefit-n redefines
   290         sql-pb-ahbenefit        pic 9(7).99.
   291     05  sql-pb-AhPremium        pic x(10).
   292     05  sql-pb-ahpremium-n redefines
   293         sql-pb-ahpremium        pic 9(7).99.
   294     05  sql-pb-ErrorMessage     pic x(50).
   295 EXEC SQL
   296    END DECLARE SECTION
   297 END-EXEC
   298 01  ws-roll-back-keys.
   299     05  ws-rb-erpyaj-key        pic x(33) value spaces.
   300 01  ws-batch-header-work-area.
   301     05  ws-lf-iss-premium          pic s9(9)v99 comp-3 value +0.
   302     05  ws-ah-iss-premium          pic s9(9)v99 comp-3 value +0.
   303     05  ws-iss-cnt                 pic s9(3) comp-3 value +0.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page   7
* EL202.cbl
   304     05  ws-cnc-cnt                 pic s9(3) comp-3 value +0.
   305     05  ws-highest-seq-no          pic s9(4) comp value +0.
   306 01  FILE-KEYS.
   307     12  ELCNTL-KEY.
   308         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   309         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   310         16 ELCNTL-ACCESS.
   311             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   312             20  FILLER              PIC X       VALUE SPACES.
   313             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   314         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   315 01  ws-init-erpndb-rec          pic x(585) value spaces.
   316 01  ws-init-erpndm              pic x(374) value spaces.
   317 01  f.
   318     05  ws-batch-seq-no         pic s9(4) comp value +0.
   319     05  ws-connect-sw               pic x  value ' '.
   320         88  connected-to-db             value 'Y'.
   321     05  ws-comp-id              pic xxx.
   322     05  ws-comp-cd              pic x.
   323 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   324     88  RESP-NORMAL                    VALUE +0.
   325     88  resp-file-notfnd               value +12.
   326     88  RESP-NOTFND                    VALUE +13.
   327     88  resp-duprec                    value +14.
   328     88  resp-dupkey                    value +15.
   329     88  resp-invreq                    value +16.
   330     88  RESP-NOTOPEN                   VALUE +19.
   331     88  RESP-ENDFILE                   VALUE +20.
   332     88  resp-lengtherr                 value +22.
   333 01  ws-display-response         pic s9(5) value zeros.
   334 01  ws-work-time-a              pic x(6).
   335 01  ws-work-time redefines ws-work-time-a
   336                                 pic 9(6).
   337 01  ws-work-amt-alpha           pic x(11).
   338 01  ws-work-amt-num redefines ws-work-amt-alpha
   339                                 pic 9(9)v99.
   340 01  ws-qry-string               pic x(80) value spaces.
   341 01  ws-qrystr-len               pic s9(8) comp value +60.
   342 01  ws-var-alpha                pic x(10).
   343 01  ws-seq-alpha                pic x(5).
   344 01  ws-seq-no-num redefines ws-seq-alpha
   345                                 pic 9(5).
   346*                                copy ELCFUNDT.
   347*****************************************************************
   348*                                                               *
   349*                            ELCFUNDT.                          *
   350*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   351*                            VMOD=2.001                         *
   352*                                                               *
   353*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   354*                                                               *
   355*****************************************************************
   356
   357
   358 01  FUNCTION-DATE.
   359     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   360     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   361         10  WS-FN-CCYR            PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page   8
* EL202.cbl
   362         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   363             15  WS-FN-CC          PIC 99.
   364             15  WS-FN-YR          PIC 99.
   365         10  WS-FN-MO              PIC 99.
   366         10  WS-FN-DA              PIC 99.
   367     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   368     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   369     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   370     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   371     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   372         88  WS-BEHIND-GMT                     VALUE '-'.
   373         88  WS-AFTER-GMT                      VALUE '+'.
   374         88  WS-NO-GMT                         VALUE ZERO.
   375     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   376     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   377*                                COPY ELCDATE.
   378******************************************************************
   379*                                                                *
   380*                                                                *
   381*                            ELCDATE.                            *
   382*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   383*                            VMOD=2.003
   384*                                                                *
   385*                                                                *
   386*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   387*                 LENGTH = 200                                   *
   388******************************************************************
   389
   390 01  DATE-CONVERSION-DATA.
   391     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   392     12  DC-OPTION-CODE                PIC X.
   393         88  BIN-TO-GREG                VALUE ' '.
   394         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   395         88  EDIT-GREG-TO-BIN           VALUE '2'.
   396         88  YMD-GREG-TO-BIN            VALUE '3'.
   397         88  MDY-GREG-TO-BIN            VALUE '4'.
   398         88  JULIAN-TO-BIN              VALUE '5'.
   399         88  BIN-PLUS-ELAPSED           VALUE '6'.
   400         88  FIND-CENTURY               VALUE '7'.
   401         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   402         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   403         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   404         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   405         88  JULIAN-TO-BIN-3            VALUE 'C'.
   406         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   407         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   408         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   409         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   410         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   411         88  CHECK-LEAP-YEAR            VALUE 'H'.
   412         88  BIN-3-TO-GREG              VALUE 'I'.
   413         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   414         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   415         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   416         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   417         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   418         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   419         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page   9
* EL202.cbl
   420         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   421         88  THREE-CHARACTER-BIN
   422                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   423         88  GREGORIAN-TO-BIN
   424                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   425         88  BIN-TO-GREGORIAN
   426                  VALUES ' ' '1' 'I' '8' 'G'.
   427         88  JULIAN-TO-BINARY
   428                  VALUES '5' 'C' 'E' 'F'.
   429     12  DC-ERROR-CODE                 PIC X.
   430         88  NO-CONVERSION-ERROR        VALUE ' '.
   431         88  DATE-CONVERSION-ERROR
   432                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   433         88  DATE-IS-ZERO               VALUE '1'.
   434         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   435         88  DATE-IS-INVALID            VALUE '3'.
   436         88  DATE1-GREATER-DATE2        VALUE '4'.
   437         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   438         88  DATE-INVALID-OPTION        VALUE '9'.
   439         88  INVALID-CENTURY            VALUE 'A'.
   440         88  ONLY-CENTURY               VALUE 'B'.
   441         88  ONLY-LEAP-YEAR             VALUE 'C'.
   442         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   443     12  DC-END-OF-MONTH               PIC X.
   444         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   445     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   446         88  USE-NORMAL-PROCESS         VALUE ' '.
   447         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   448         88  ADJUST-UP-100-YRS          VALUE '2'.
   449     12  FILLER                        PIC X.
   450     12  DC-CONVERSION-DATES.
   451         16  DC-BIN-DATE-1             PIC XX.
   452         16  DC-BIN-DATE-2             PIC XX.
   453         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   454         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   455                       DC-GREG-DATE-1-EDIT.
   456             20  DC-EDIT1-MONTH        PIC 99.
   457             20  SLASH1-1              PIC X.
   458             20  DC-EDIT1-DAY          PIC 99.
   459             20  SLASH1-2              PIC X.
   460             20  DC-EDIT1-YEAR         PIC 99.
   461         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   462         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   463                     DC-GREG-DATE-2-EDIT.
   464             20  DC-EDIT2-MONTH        PIC 99.
   465             20  SLASH2-1              PIC X.
   466             20  DC-EDIT2-DAY          PIC 99.
   467             20  SLASH2-2              PIC X.
   468             20  DC-EDIT2-YEAR         PIC 99.
   469         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   470         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   471                     DC-GREG-DATE-1-YMD.
   472             20  DC-YMD-YEAR           PIC 99.
   473             20  DC-YMD-MONTH          PIC 99.
   474             20  DC-YMD-DAY            PIC 99.
   475         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   476         16  DC-GREG-DATE-1-MDY-R REDEFINES
   477                      DC-GREG-DATE-1-MDY.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  10
* EL202.cbl
   478             20  DC-MDY-MONTH          PIC 99.
   479             20  DC-MDY-DAY            PIC 99.
   480             20  DC-MDY-YEAR           PIC 99.
   481         16  DC-GREG-DATE-1-ALPHA.
   482             20  DC-ALPHA-MONTH        PIC X(10).
   483             20  DC-ALPHA-DAY          PIC 99.
   484             20  FILLER                PIC XX.
   485             20  DC-ALPHA-CENTURY.
   486                 24 DC-ALPHA-CEN-N     PIC 99.
   487             20  DC-ALPHA-YEAR         PIC 99.
   488         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   489         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   490         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   491         16  DC-JULIAN-DATE            PIC 9(05).
   492         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   493                                       PIC 9(05).
   494         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   495             20  DC-JULIAN-YEAR        PIC 99.
   496             20  DC-JULIAN-DAYS        PIC 999.
   497         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   498         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   499         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   500     12  DATE-CONVERSION-VARIBLES.
   501         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   502         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   503             20  FILLER                PIC 9(3).
   504             20  HOLD-CEN-1-CCYY.
   505                 24  HOLD-CEN-1-CC     PIC 99.
   506                 24  HOLD-CEN-1-YY     PIC 99.
   507             20  HOLD-CEN-1-MO         PIC 99.
   508             20  HOLD-CEN-1-DA         PIC 99.
   509         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   510             20  HOLD-CEN-1-R-MO       PIC 99.
   511             20  HOLD-CEN-1-R-DA       PIC 99.
   512             20  HOLD-CEN-1-R-CCYY.
   513                 24  HOLD-CEN-1-R-CC   PIC 99.
   514                 24  HOLD-CEN-1-R-YY   PIC 99.
   515             20  FILLER                PIC 9(3).
   516         16  HOLD-CENTURY-1-X.
   517             20  FILLER                PIC X(3)  VALUE SPACES.
   518             20  HOLD-CEN-1-X-CCYY.
   519                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   520                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   521             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   522             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   523         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   524             20  HOLD-CEN-1-R-X-MO     PIC XX.
   525             20  HOLD-CEN-1-R-X-DA     PIC XX.
   526             20  HOLD-CEN-1-R-X-CCYY.
   527                 24  HOLD-CEN-1-R-X-CC PIC XX.
   528                 24  HOLD-CEN-1-R-X-YY PIC XX.
   529             20  FILLER                PIC XXX.
   530         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   531         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   532         16  DC-JULIAN-DATE-1          PIC 9(07).
   533         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   534             20  DC-JULIAN-1-CCYY.
   535                 24  DC-JULIAN-1-CC    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  11
* EL202.cbl
   536                 24  DC-JULIAN-1-YR    PIC 99.
   537             20  DC-JULIAN-DA-1        PIC 999.
   538         16  DC-JULIAN-DATE-2          PIC 9(07).
   539         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   540             20  DC-JULIAN-2-CCYY.
   541                 24  DC-JULIAN-2-CC    PIC 99.
   542                 24  DC-JULIAN-2-YR    PIC 99.
   543             20  DC-JULIAN-DA-2        PIC 999.
   544         16  DC-GREG-DATE-A-EDIT.
   545             20  DC-EDITA-MONTH        PIC 99.
   546             20  SLASHA-1              PIC X VALUE '/'.
   547             20  DC-EDITA-DAY          PIC 99.
   548             20  SLASHA-2              PIC X VALUE '/'.
   549             20  DC-EDITA-CCYY.
   550                 24  DC-EDITA-CENT     PIC 99.
   551                 24  DC-EDITA-YEAR     PIC 99.
   552         16  DC-GREG-DATE-B-EDIT.
   553             20  DC-EDITB-MONTH        PIC 99.
   554             20  SLASHB-1              PIC X VALUE '/'.
   555             20  DC-EDITB-DAY          PIC 99.
   556             20  SLASHB-2              PIC X VALUE '/'.
   557             20  DC-EDITB-CCYY.
   558                 24  DC-EDITB-CENT     PIC 99.
   559                 24  DC-EDITB-YEAR     PIC 99.
   560         16  DC-GREG-DATE-CYMD         PIC 9(08).
   561         16  DC-GREG-DATE-CYMD-R REDEFINES
   562                              DC-GREG-DATE-CYMD.
   563             20  DC-CYMD-CEN           PIC 99.
   564             20  DC-CYMD-YEAR          PIC 99.
   565             20  DC-CYMD-MONTH         PIC 99.
   566             20  DC-CYMD-DAY           PIC 99.
   567         16  DC-GREG-DATE-MDCY         PIC 9(08).
   568         16  DC-GREG-DATE-MDCY-R REDEFINES
   569                              DC-GREG-DATE-MDCY.
   570             20  DC-MDCY-MONTH         PIC 99.
   571             20  DC-MDCY-DAY           PIC 99.
   572             20  DC-MDCY-CEN           PIC 99.
   573             20  DC-MDCY-YEAR          PIC 99.
   574    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   575        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   576    12  DC-EL310-DATE                  PIC X(21).
   577    12  FILLER                         PIC X(28).
   578*                                COPY ELCCNTL.
   579******************************************************************
   580*                                                                *
   581*                                                                *
   582*                            ELCCNTL.                            *
   583*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   584*                            VMOD=2.059                          *
   585*                                                                *
   586*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   587*                                                                *
   588*   FILE TYPE = VSAM,KSDS                                        *
   589*   RECORD SIZE = 750  RECFORM = FIXED                           *
   590*                                                                *
   591*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   592*       ALTERNATE INDEX = NONE                                   *
   593*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  12
* EL202.cbl
   594*   LOG = YES                                                    *
   595*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   596******************************************************************
   597*                   C H A N G E   L O G
   598*
   599* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   600*-----------------------------------------------------------------
   601*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   602* EFFECTIVE    NUMBER
   603*-----------------------------------------------------------------
   604* 082503                   PEMA  ADD BENEFIT GROUP
   605* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   606* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   607* 092705    2005050300006  PEMA  ADD SPP LEASES
   608* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   609* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   610* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   611* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   612* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   613* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   614* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   615* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   616* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   617* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   618******************************************************************
   619*
   620 01  CONTROL-FILE.
   621     12  CF-RECORD-ID                       PIC XX.
   622         88  VALID-CF-ID                        VALUE 'CF'.
   623
   624     12  CF-CONTROL-PRIMARY.
   625         16  CF-COMPANY-ID                  PIC XXX.
   626         16  CF-RECORD-TYPE                 PIC X.
   627             88  CF-COMPANY-MASTER              VALUE '1'.
   628             88  CF-PROCESSOR-MASTER            VALUE '2'.
   629             88  CF-STATE-MASTER                VALUE '3'.
   630             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   631             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   632             88  CF-CARRIER-MASTER              VALUE '6'.
   633             88  CF-MORTALITY-MASTER            VALUE '7'.
   634             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   635             88  CF-TERMINAL-MASTER             VALUE '9'.
   636             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   637             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   638             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   639             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   640             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   641             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   642             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   643             88  CF-REMINDERS-MASTER            VALUE 'R'.
   644             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   645         16  CF-ACCESS-CD-GENL              PIC X(4).
   646         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   647             20  CF-PROCESSOR               PIC X(4).
   648         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   649             20  CF-STATE-CODE              PIC XX.
   650             20  FILLER                     PIC XX.
   651         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  13
* EL202.cbl
   652             20  FILLER                     PIC XX.
   653             20  CF-HI-BEN-IN-REC           PIC XX.
   654         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   655             20  FILLER                     PIC XXX.
   656             20  CF-CARRIER-CNTL            PIC X.
   657         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   658             20  FILLER                     PIC XX.
   659             20  CF-HI-TYPE-IN-REC          PIC 99.
   660         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   661             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   662                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   663             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   664             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   665         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   666             20  FILLER                     PIC X.
   667             20  CF-CUSTOM-REPORT-NO        PIC 999.
   668         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   669             20  FILLER                     PIC XX.
   670             20  CF-MORTGAGE-PLAN           PIC XX.
   671         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   672
   673     12  CF-LAST-MAINT-DT                   PIC XX.
   674     12  CF-LAST-MAINT-BY                   PIC X(4).
   675     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   676
   677     12  CF-RECORD-BODY                     PIC X(728).
   678
   679
   680****************************************************************
   681*             COMPANY MASTER RECORD                            *
   682****************************************************************
   683
   684     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   685         16  CF-COMPANY-ADDRESS.
   686             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   687             20  CF-CL-IN-CARE-OF           PIC X(30).
   688             20  CF-CL-ADDR-LINE-1          PIC X(30).
   689             20  CF-CL-ADDR-LINE-2          PIC X(30).
   690             20  CF-CL-CITY-STATE           PIC X(30).
   691             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   692             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   693         16  CF-COMPANY-CD                  PIC X.
   694         16  CF-COMPANY-PASSWORD            PIC X(8).
   695         16  CF-SECURITY-OPTION             PIC X.
   696             88  ALL-SECURITY                   VALUE '1'.
   697             88  COMPANY-VERIFY                 VALUE '2'.
   698             88  PROCESSOR-VERIFY               VALUE '3'.
   699             88  NO-SECURITY                    VALUE '4'.
   700             88  ALL-BUT-TERM                   VALUE '5'.
   701         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   702             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   703         16  CF-LGX-INTERFACE-CNTL          PIC X.
   704             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   705         16  CF-INFORCE-LOCATION            PIC X.
   706             88  CERTS-ARE-ONLINE               VALUE '1'.
   707             88  CERTS-ARE-OFFLINE              VALUE '2'.
   708             88  NO-CERTS-AVAILABLE             VALUE '3'.
   709         16  CF-LOWER-CASE-LETTERS          PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  14
* EL202.cbl
   710         16  CF-CERT-ACCESS-CONTROL         PIC X.
   711             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   712             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   713             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   714             88  CF-ACCNT-CNTL                  VALUE '3'.
   715             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   716
   717         16  CF-FORMS-PRINTER-ID            PIC X(4).
   718         16  CF-CHECK-PRINTER-ID            PIC X(4).
   719
   720         16  CF-LGX-CREDIT-USER             PIC X.
   721             88  CO-IS-NOT-USER                 VALUE 'N'.
   722             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   723
   724         16 CF-CREDIT-CALC-CODES.
   725             20  CF-CR-REM-TERM-CALC PIC X.
   726               88  CR-EARN-AFTER-15TH           VALUE '1'.
   727               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   728               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   729               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   730               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   731               88  CR-EARN-AFTER-14TH           VALUE '6'.
   732               88  CR-EARN-AFTER-16TH           VALUE '7'.
   733             20  CF-CR-R78-METHOD           PIC X.
   734               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   735               88  DONT-USE-PLUS-ONE            VALUE '1'.
   736
   737         16  CF-CLAIM-CONTROL-COUNTS.
   738             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   739                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   740
   741             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   742                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   743
   744             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   745                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   746
   747             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   748                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   749
   750         16  CF-CURRENT-MONTH-END           PIC XX.
   751
   752         16  CF-CO-CALC-QUOTE-TOLERANCE.
   753             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   754             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   755             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   756             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   757                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   758                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   759             20  CF-CO-PREM-REJECT-SW       PIC X.
   760                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   761                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   762             20  CF-CO-REF-REJECT-SW        PIC X.
   763                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   764                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   765
   766         16  CF-CO-REPORTING-DT             PIC XX.
   767         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  15
* EL202.cbl
   768         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   769           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   770           88  CF-CO-MONTH-END                  VALUE '1'.
   771
   772         16  CF-LGX-CLAIM-USER              PIC X.
   773             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   774             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   775
   776         16  CF-CREDIT-EDIT-CONTROLS.
   777             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   778             20  CF-MIN-AGE                 PIC 99.
   779             20  CF-DEFAULT-AGE             PIC 99.
   780             20  CF-MIN-TERM                PIC S999      COMP-3.
   781             20  CF-MAX-TERM                PIC S999      COMP-3.
   782             20  CF-DEFAULT-SEX             PIC X.
   783             20  CF-JOINT-AGE-INPUT         PIC X.
   784                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   785             20  CF-BIRTH-DATE-INPUT        PIC X.
   786                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   787             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   788                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   789                 88  CF-ZERO-CARRIER            VALUE '1'.
   790                 88  CF-ZERO-GROUPING           VALUE '2'.
   791                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   792             20  CF-EDIT-SW                 PIC X.
   793                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   794             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   795             20  CF-CR-PR-METHOD            PIC X.
   796               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   797               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   798             20  FILLER                     PIC X.
   799
   800         16  CF-CREDIT-MISC-CONTROLS.
   801             20  CF-REIN-TABLE-SW           PIC X.
   802                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   803             20  CF-COMP-TABLE-SW           PIC X.
   804                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   805             20  CF-EXPERIENCE-RETENTION-AGE
   806                                            PIC S9        COMP-3.
   807             20  CF-CONVERSION-DT           PIC XX.
   808             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   809             20  CF-RUN-FREQUENCY-SW        PIC X.
   810                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   811                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   812
   813             20  CF-CR-CHECK-NO-CONTROL.
   814                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   815                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   816                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   817                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   818                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   819                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   820
   821                 24  CF-CR-CHECK-COUNT       REDEFINES
   822                     CF-CR-CHECK-COUNTER      PIC X(4).
   823
   824                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   825                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  16
* EL202.cbl
   826
   827                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   828                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   829                 24  CF-MAIL-PROCESSING       PIC X.
   830                     88  MAIL-PROCESSING          VALUE 'Y'.
   831
   832         16  CF-MISC-SYSTEM-CONTROL.
   833             20  CF-SYSTEM-C                 PIC X.
   834                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   835             20  CF-SYSTEM-D                 PIC X.
   836                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   837             20  CF-SOC-SEC-NO-SW            PIC X.
   838                 88  SOC-SEC-NO-USED             VALUE '1'.
   839             20  CF-MEMBER-NO-SW             PIC X.
   840                 88  MEMBER-NO-USED              VALUE '1'.
   841             20  CF-TAX-ID-NUMBER            PIC X(11).
   842             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   843             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   844                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   845                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   846                 88  CF-ALL-APPROVED             VALUE 'Y'.
   847                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   848             20  CF-SYSTEM-E                 PIC X.
   849                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   850
   851         16  CF-LGX-LIFE-USER               PIC X.
   852             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   853             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   854
   855         16  CF-CR-MONTH-END-DT             PIC XX.
   856
   857         16  CF-FILE-MAINT-DATES.
   858             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   859                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   860             20  CF-LAST-BATCH       REDEFINES
   861                 CF-LAST-BATCH-NO               PIC X(4).
   862             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   863             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   864             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   865             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   866             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   867             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   868             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   869             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   870             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   871             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   872
   873         16  CF-NEXT-COMPANY-ID             PIC XXX.
   874         16  FILLER                         PIC X.
   875
   876         16  CF-ALT-MORT-CODE               PIC X(4).
   877         16  CF-MEMBER-CAPTION              PIC X(10).
   878
   879         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   880             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   881             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   882             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   883             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  17
* EL202.cbl
   884             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   885
   886         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   887
   888         16  CF-LIFE-OVERRIDE-L1            PIC X.
   889         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   890         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   891         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   892
   893         16  CF-AH-OVERRIDE-L1              PIC X.
   894         16  CF-AH-OVERRIDE-L2              PIC XX.
   895         16  CF-AH-OVERRIDE-L6              PIC X(6).
   896         16  CF-AH-OVERRIDE-L12             PIC X(12).
   897
   898         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   899         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   900
   901         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   902         16  CF-AR-LAST-EL860-DT            PIC XX.
   903         16  CF-MP-MONTH-END-DT             PIC XX.
   904
   905         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   906         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   907             88  CF-CLAIM-PAID-TO               VALUE '1'.
   908
   909         16  CF-AR-MONTH-END-DT             PIC XX.
   910
   911         16  CF-CRDTCRD-USER                PIC X.
   912             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   913             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   914
   915         16  CF-CC-MONTH-END-DT             PIC XX.
   916
   917         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   918
   919         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   920             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   921             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   922             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   923         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   924         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
   925         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
   926         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   927             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
   928             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   929         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   930         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   931         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   932             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   933         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   934
   935         16  CF-CL-ZIP-CODE.
   936             20  CF-CL-ZIP-PRIME.
   937                 24  CF-CL-ZIP-1ST          PIC X.
   938                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   939                 24  FILLER                 PIC X(4).
   940             20  CF-CL-ZIP-PLUS4            PIC X(4).
   941         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  18
* EL202.cbl
   942             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   943             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   944             20  FILLER                     PIC XXX.
   945
   946         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   947         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   948         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   949         16  CF-CO-OPTION-START-DATE        PIC XX.
   950         16  CF-REM-TRM-CALC-OPTION         PIC X.
   951           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   952                                                      '3' '4'.
   953           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   954           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   955           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   956           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   957           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   958           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   959
   960         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   961
   962         16  CF-PAYMENT-APPROVAL-LEVELS.
   963             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   964             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   965             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   966             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   967             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   968             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   969
   970         16  CF-END-USER-REPORTING-USER     PIC X.
   971             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   972             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   973
   974         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   975             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   976             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   977
   978         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   979
   980         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   981         16  FILLER                         PIC X.
   982
   983         16  CF-CREDIT-ARCHIVE-CNTL.
   984             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   985             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
   986             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   987
   988         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   989
   990         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   991             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   992             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   993
   994         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   995             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   996             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   997
   998         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
   999
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  19
* EL202.cbl
  1000         16  CF-CO-ACH-ID-CODE              PIC  X.
  1001             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1002             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1003             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1004         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1005         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1006         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1007         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1008         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1009         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1010         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1011         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1012         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1013                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1014         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1015                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1016
  1017         16  CF-CO-OVER-SHORT.
  1018             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1019             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1020
  1021*         16  FILLER                         PIC X(102).
  1022         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1023             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1024             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1025
  1026         16  CF-AH-APPROVAL-DAYS.
  1027             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1028             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1029             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1030             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1031
  1032         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1033
  1034         16  CF-APPROV-LEV-5.
  1035             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1036             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1037             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1038
  1039         16  FILLER                         PIC X(68).
  1040****************************************************************
  1041*             PROCESSOR/USER RECORD                            *
  1042****************************************************************
  1043
  1044     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1045         16  CF-PROCESSOR-NAME              PIC X(30).
  1046         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1047         16  CF-PROCESSOR-TITLE             PIC X(26).
  1048         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1049                 88  MESSAGE-YES                VALUE 'Y'.
  1050                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1051
  1052*****************************************************
  1053****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1054****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1055****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1056****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1057*****************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  20
* EL202.cbl
  1058
  1059         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1060             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1061             20  CF-APPLICATION-FORCE       PIC X.
  1062             20  CF-INDIVIDUAL-APP.
  1063                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1064                     28  CF-BROWSE-APP      PIC X.
  1065                     28  CF-UPDATE-APP      PIC X.
  1066
  1067         16  CF-CURRENT-TERM-ON             PIC X(4).
  1068         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1069             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1070             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1071             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1072             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1073             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1074             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1075             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1076         16  CF-PROCESSOR-CARRIER           PIC X.
  1077             88  NO-CARRIER-SECURITY            VALUE ' '.
  1078         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1079             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1080         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1081             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1082         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1083             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1084
  1085         16  CF-PROC-SYS-ACCESS-SW.
  1086             20  CF-PROC-CREDIT-CLAIMS-SW.
  1087                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1088                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1089                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1090                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1091             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1092                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1093                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1094             20  CF-PROC-LIFE-GNRLDGR-SW.
  1095                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1096                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1097                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1098                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1099             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1100                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1101                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1102         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1103             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1104             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1105         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1106
  1107         16  CF-APPROVAL-LEVEL                  PIC X.
  1108             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1109             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1110             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1111             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1112             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1113
  1114         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1115
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  21
* EL202.cbl
  1116         16  CF-LANGUAGE-TYPE                   PIC X.
  1117             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1118             88  CF-LANG-IS-FR                      VALUE 'F'.
  1119
  1120         16  CF-CSR-IND                         PIC X.
  1121         16  FILLER                             PIC X(239).
  1122
  1123****************************************************************
  1124*             PROCESSOR/REMINDERS RECORD                       *
  1125****************************************************************
  1126
  1127     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1128         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1129             20  CF-START-REMIND-DT         PIC XX.
  1130             20  CF-END-REMIND-DT           PIC XX.
  1131             20  CF-REMINDER-TEXT           PIC X(50).
  1132         16  FILLER                         PIC X(296).
  1133
  1134
  1135****************************************************************
  1136*             STATE MASTER RECORD                              *
  1137****************************************************************
  1138
  1139     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1140         16  CF-STATE-ABBREVIATION          PIC XX.
  1141         16  CF-STATE-NAME                  PIC X(25).
  1142         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1143         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1144             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1145             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1146             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1147             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1148                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1149                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1150             20  CF-ST-PREM-REJECT-SW       PIC X.
  1151                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1152                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1153             20  CF-ST-REF-REJECT-SW        PIC X.
  1154                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1155                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1156         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1157         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1158         16  CF-ST-REFUND-RULES.
  1159             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1160             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1161             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1162         16  CF-ST-FST-PMT-EXTENSION.
  1163             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1164             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1165                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1166                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1167                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1168                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1169         16  CF-ST-STATE-CALL.
  1170             20  CF-ST-CALL-UNEARNED        PIC X.
  1171             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1172             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1173         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  22
* EL202.cbl
  1174             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1175             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1176         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1177         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1178         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1179         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1180         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1181         16  FILLER                         PIC X.
  1182         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1183             20  CF-ST-BENEFIT-CD           PIC XX.
  1184             20  CF-ST-BENEFIT-KIND         PIC X.
  1185                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1186                 88  CF-ST-AH-KIND              VALUE 'A'.
  1187             20  CF-ST-REM-TERM-CALC        PIC X.
  1188                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1189                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1190                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1191                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1192                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1193                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1194                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1195                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1196
  1197             20  CF-ST-REFUND-CALC          PIC X.
  1198                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1199                 88  ST-REFD-BY-R78             VALUE '1'.
  1200                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1201                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1202                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1203                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1204                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1205                 88  ST-REFD-UTAH               VALUE '7'.
  1206                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1207                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1208                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1209
  1210             20  CF-ST-EARNING-CALC         PIC X.
  1211                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1212                 88  ST-EARN-BY-R78             VALUE '1'.
  1213                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1214                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1215                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1216                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1217                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1218                 88  ST-EARN-MEAN               VALUE '8'.
  1219                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1220
  1221             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1222                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1223                 88  ST-OVRD-BY-R78             VALUE '1'.
  1224                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1225                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1226                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1227                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1228                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1229                 88  ST-OVRD-MEAN               VALUE '8'.
  1230                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1231             20  cf-st-extra-periods        pic 9.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  23
* EL202.cbl
  1232*            20  FILLER                     PIC X.
  1233
  1234         16  CF-ST-COMMISSION-CAPS.
  1235             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1236             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1237             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1238             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1239         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1240                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1241
  1242         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1243
  1244         16  CF-ST-STATUTORY-INTEREST.
  1245             20  CF-ST-STAT-DATE-FROM       PIC X.
  1246                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1247                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1248             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1249             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1250             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1251             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1252             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1253
  1254         16  CF-ST-OVER-SHORT.
  1255             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1256             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1257
  1258         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1259
  1260         16  CF-ST-RT-CALC                  PIC X.
  1261
  1262         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1263         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1264         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1265         16  CF-ST-RF-LR-CALC               PIC X.
  1266         16  CF-ST-RF-LL-CALC               PIC X.
  1267         16  CF-ST-RF-LN-CALC               PIC X.
  1268         16  CF-ST-RF-AH-CALC               PIC X.
  1269         16  CF-ST-RF-CP-CALC               PIC X.
  1270*        16  FILLER                         PIC X(206).
  1271*CIDMOD         16  FILLER                         PIC X(192).
  1272         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1273             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1274         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1275         16  CF-ST-VFY-2ND-BENE             PIC X.
  1276         16  CF-ST-CAUSAL-STATE             PIC X.
  1277         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1278         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1279         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1280             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1281         16  CF-ST-NET-ONLY-STATE           PIC X.
  1282             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1283         16  FILLER                         PIC X(181).
  1284
  1285****************************************************************
  1286*             BENEFIT MASTER RECORD                            *
  1287****************************************************************
  1288
  1289     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  24
* EL202.cbl
  1290         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1291             20  CF-BENEFIT-CODE            PIC XX.
  1292             20  CF-BENEFIT-NUMERIC  REDEFINES
  1293                 CF-BENEFIT-CODE            PIC XX.
  1294             20  CF-BENEFIT-ALPHA           PIC XXX.
  1295             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1296             20  CF-BENEFIT-COMMENT         PIC X(10).
  1297
  1298             20  CF-LF-COVERAGE-TYPE        PIC X.
  1299                 88  CF-REDUCING                VALUE 'R'.
  1300                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1301
  1302             20  CF-SPECIAL-CALC-CD         PIC X.
  1303                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1304                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1305                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1306                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1307                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1308                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1309                 88  CF-FARM-PLAN               VALUE 'F'.
  1310                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1311                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1312                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1313                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1314                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1315                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1316                 88  CF-PRUDENTIAL              VALUE 'P'.
  1317                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1318                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1319                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1320                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1321                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1322                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1323
  1324             20  CF-JOINT-INDICATOR         PIC X.
  1325                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1326
  1327*            20  FILLER                     PIC X(12).
  1328             20  cf-maximum-benefits        pic s999 comp-3.
  1329             20  FILLER                     PIC X(09).
  1330             20  CF-BENEFIT-CATEGORY        PIC X.
  1331             20  CF-LOAN-TYPE               PIC X(8).
  1332
  1333             20  CF-CO-REM-TERM-CALC        PIC X.
  1334                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1335                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1336                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1337                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1338                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1339
  1340             20  CF-CO-EARNINGS-CALC        PIC X.
  1341                 88  CO-EARN-BY-R78             VALUE '1'.
  1342                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1343                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1344                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1345                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1346                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1347                 88  CO-EARN-AS-MEAN            VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  25
* EL202.cbl
  1348                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1349
  1350             20  CF-CO-REFUND-CALC          PIC X.
  1351                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1352                 88  CO-REFD-BY-R78             VALUE '1'.
  1353                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1354                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1355                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1356                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1357                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1358                 88  CO-REFD-MEAN               VALUE '8'.
  1359                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1360                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1361                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1362
  1363             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1364                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1365                 88  CO-OVRD-BY-R78             VALUE '1'.
  1366                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1367                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1368                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1369                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1370                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1371                 88  CO-OVRD-MEAN               VALUE '8'.
  1372                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1373
  1374             20  CF-CO-BEN-I-G-CD           PIC X.
  1375                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1376                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1377                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1378
  1379         16  FILLER                         PIC X(304).
  1380
  1381
  1382****************************************************************
  1383*             CARRIER MASTER RECORD                            *
  1384****************************************************************
  1385
  1386     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1387         16  CF-ADDRESS-DATA.
  1388             20  CF-MAIL-TO-NAME            PIC X(30).
  1389             20  CF-IN-CARE-OF              PIC X(30).
  1390             20  CF-ADDRESS-LINE-1          PIC X(30).
  1391             20  CF-ADDRESS-LINE-2          PIC X(30).
  1392             20  CF-CITY-STATE              PIC X(30).
  1393             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1394             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1395
  1396         16  CF-CLAIM-NO-CONTROL.
  1397             20  CF-CLAIM-NO-METHOD         PIC X.
  1398                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1399                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1400                 88  CLAIM-NO-SEQ               VALUE '3'.
  1401                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1402             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1403                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1404                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1405                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  26
* EL202.cbl
  1406
  1407         16  CF-CHECK-NO-CONTROL.
  1408             20  CF-CHECK-NO-METHOD         PIC X.
  1409                 88  CHECK-NO-MANUAL            VALUE '1'.
  1410                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1411                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1412                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1413             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1414                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1415
  1416         16  CF-DOMICILE-STATE              PIC XX.
  1417
  1418         16  CF-EXPENSE-CONTROLS.
  1419             20  CF-EXPENSE-METHOD          PIC X.
  1420                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1421                 88  DOLLARS-PER-PMT            VALUE '2'.
  1422                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1423                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1424             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1425             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1426
  1427         16  CF-CORRESPONDENCE-CONTROL.
  1428             20  CF-LETTER-RESEND-OPT       PIC X.
  1429                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1430                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1431             20  FILLER                     PIC X(4).
  1432
  1433         16  CF-RESERVE-CONTROLS.
  1434             20  CF-MANUAL-SW               PIC X.
  1435                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1436             20  CF-FUTURE-SW               PIC X.
  1437                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1438             20  CF-PTC-SW                  PIC X.
  1439                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1440             20  CF-IBNR-SW                 PIC X.
  1441                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1442             20  CF-PTC-LF-SW               PIC X.
  1443                 88  CF-LF-PTC-USED             VALUE '1'.
  1444             20  CF-CDT-ACCESS-METHOD       PIC X.
  1445                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1446                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1447                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1448             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1449
  1450         16  CF-CLAIM-CALC-METHOD           PIC X.
  1451             88  360-PLUS-MONTHS                VALUE '1'.
  1452             88  365-PLUS-MONTHS                VALUE '2'.
  1453             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1454             88  360-DAILY                      VALUE '4'.
  1455             88  365-DAILY                      VALUE '5'.
  1456
  1457         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1458         16  FILLER                         PIC X(11).
  1459
  1460         16  CF-LIMIT-AMOUNTS.
  1461             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1462             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1463             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  27
* EL202.cbl
  1464             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1465             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1466             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1467             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1468             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1469             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1470             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1471
  1472         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1473         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1474         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1475
  1476         16  CF-ZIP-CODE.
  1477             20  CF-ZIP-PRIME.
  1478                 24  CF-ZIP-1ST             PIC X.
  1479                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1480                 24  FILLER                 PIC X(4).
  1481             20  CF-ZIP-PLUS4               PIC X(4).
  1482         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1483             20  CF-CAN-POSTAL-1            PIC XXX.
  1484             20  CF-CAN-POSTAL-2            PIC XXX.
  1485             20  FILLER                     PIC XXX.
  1486
  1487         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1488         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1489         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1490
  1491         16  CF-RATING-SWITCH               PIC X.
  1492             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1493             88  CF-NO-RATING                   VALUE 'N'.
  1494
  1495         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1496
  1497         16  CF-CARRIER-OVER-SHORT.
  1498             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1499             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1500
  1501         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1502         16  CF-SECPAY-SWITCH               PIC X.
  1503             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1504             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1505         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1506         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1507         16  FILLER                         PIC X(444).
  1508*        16  FILLER                         PIC X(452).
  1509
  1510
  1511****************************************************************
  1512*             MORTALITY MASTER RECORD                          *
  1513****************************************************************
  1514
  1515     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1516         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1517                                INDEXED BY CF-MORT-NDX.
  1518             20  CF-MORT-TABLE              PIC X(5).
  1519             20  CF-MORT-TABLE-TYPE         PIC X.
  1520                 88  CF-MORT-JOINT              VALUE 'J'.
  1521                 88  CF-MORT-SINGLE             VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  28
* EL202.cbl
  1522                 88  CF-MORT-COMBINED           VALUE 'C'.
  1523                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1524                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1525             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1526             20  CF-MORT-AGE-METHOD         PIC XX.
  1527                 88  CF-AGE-LAST                VALUE 'AL'.
  1528                 88  CF-AGE-NEAR                VALUE 'AN'.
  1529             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1530             20  CF-MORT-ADJUSTMENT-DIRECTION
  1531                                            PIC X.
  1532                 88  CF-MINUS                   VALUE '-'.
  1533                 88  CF-PLUS                    VALUE '+'.
  1534             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1535             20  CF-MORT-JOINT-CODE         PIC X.
  1536                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1537             20  CF-MORT-PC-Q               PIC X.
  1538                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1539             20  CF-MORT-TABLE-CODE         PIC X(4).
  1540             20  CF-MORT-COMMENTS           PIC X(15).
  1541             20  FILLER                     PIC X(14).
  1542
  1543         16  FILLER                         PIC X(251).
  1544
  1545
  1546****************************************************************
  1547*             BUSSINESS TYPE MASTER RECORD                     *
  1548****************************************************************
  1549
  1550     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1551* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1552* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1553* AND RECORD 05 IS TYPES 81-99
  1554         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1555             20  CF-BUSINESS-TITLE          PIC  X(19).
  1556             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1557                                            PIC S9V9(4) COMP-3.
  1558             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1559             20  FILLER                     PIC  X.
  1560         16  FILLER                         PIC  X(248).
  1561
  1562
  1563****************************************************************
  1564*             TERMINAL MASTER RECORD                           *
  1565****************************************************************
  1566
  1567     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1568
  1569         16  CF-COMPANY-TERMINALS.
  1570             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1571                                  PIC X(4).
  1572         16  FILLER               PIC X(248).
  1573
  1574
  1575****************************************************************
  1576*             LIFE EDIT MASTER RECORD                          *
  1577****************************************************************
  1578
  1579     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  29
* EL202.cbl
  1580         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1581             20  CF-LIFE-CODE-IN            PIC XX.
  1582             20  CF-LIFE-CODE-OUT           PIC XX.
  1583         16  FILLER                         PIC X(248).
  1584
  1585
  1586****************************************************************
  1587*             AH EDIT MASTER RECORD                            *
  1588****************************************************************
  1589
  1590     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1591         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1592             20  CF-AH-CODE-IN              PIC XXX.
  1593             20  CF-AH-CODE-OUT             PIC XX.
  1594         16  FILLER                         PIC X(248).
  1595
  1596
  1597****************************************************************
  1598*             CREDIBILITY TABLES                               *
  1599****************************************************************
  1600
  1601     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1602         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1603                             INDEXED BY CF-CRDB-NDX.
  1604             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1605             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1606             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1607         16  FILLER                         PIC  X(332).
  1608
  1609
  1610****************************************************************
  1611*             REPORT CUSTOMIZATION RECORD                      *
  1612****************************************************************
  1613
  1614     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1615         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1616             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1617             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1618             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1619**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1620****       A T-TRANSFER.                                   ****
  1621             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1622
  1623         16  FILLER                         PIC XX.
  1624
  1625         16  CF-CARRIER-CNTL-OPT.
  1626             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1627                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1628                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1629             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1630                                            PIC X.
  1631         16  CF-GROUP-CNTL-OPT.
  1632             20  CF-GROUP-OPT-SEQ           PIC 9.
  1633                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1634                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1635             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1636                                            PIC X(6).
  1637         16  CF-STATE-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  30
* EL202.cbl
  1638             20  CF-STATE-OPT-SEQ           PIC 9.
  1639                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1640                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1641             20  CF-STATE-SELECT OCCURS 3 TIMES
  1642                                            PIC XX.
  1643         16  CF-ACCOUNT-CNTL-OPT.
  1644             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1645                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1646                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1647             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1648                                            PIC X(10).
  1649         16  CF-BUS-TYP-CNTL-OPT.
  1650             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1651                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1652                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1653             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1654                                            PIC XX.
  1655         16  CF-LF-TYP-CNTL-OPT.
  1656             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1657                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1658                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1659             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1660                                            PIC XX.
  1661         16  CF-AH-TYP-CNTL-OPT.
  1662             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1663                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1664                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1665             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1666                                            PIC XX.
  1667         16  CF-REPTCD1-CNTL-OPT.
  1668             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1669                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1670                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1671             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1672                                            PIC X(10).
  1673         16  CF-REPTCD2-CNTL-OPT.
  1674             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1675                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1676                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1677             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1678                                            PIC X(10).
  1679         16  CF-USER1-CNTL-OPT.
  1680             20  CF-USER1-OPT-SEQ           PIC 9.
  1681                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1682                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1683             20  CF-USER1-SELECT OCCURS 3 TIMES
  1684                                            PIC X(10).
  1685         16  CF-USER2-CNTL-OPT.
  1686             20  CF-USER2-OPT-SEQ           PIC 9.
  1687                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1688                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1689             20  CF-USER2-SELECT OCCURS 3 TIMES
  1690                                            PIC X(10).
  1691         16  CF-USER3-CNTL-OPT.
  1692             20  CF-USER3-OPT-SEQ           PIC 9.
  1693                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1694                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1695             20  CF-USER3-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  31
* EL202.cbl
  1696                                            PIC X(10).
  1697         16  CF-USER4-CNTL-OPT.
  1698             20  CF-USER4-OPT-SEQ           PIC 9.
  1699                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1700                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1701             20  CF-USER4-SELECT OCCURS 3 TIMES
  1702                                            PIC X(10).
  1703         16  CF-USER5-CNTL-OPT.
  1704             20  CF-USER5-OPT-SEQ           PIC 9.
  1705                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1706                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1707             20  CF-USER5-SELECT OCCURS 3 TIMES
  1708                                            PIC X(10).
  1709         16  CF-REINS-CNTL-OPT.
  1710             20  CF-REINS-OPT-SEQ           PIC 9.
  1711                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1712                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1713             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1714                 24  CF-REINS-PRIME         PIC XXX.
  1715                 24  CF-REINS-SUB           PIC XXX.
  1716
  1717         16  CF-AGENT-CNTL-OPT.
  1718             20  CF-AGENT-OPT-SEQ           PIC 9.
  1719                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1720                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1721             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1722                                            PIC X(10).
  1723
  1724         16  FILLER                         PIC X(43).
  1725
  1726         16  CF-LOSS-RATIO-SELECT.
  1727             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1728             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1729         16  CF-ENTRY-DATE-SELECT.
  1730             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1731             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1732         16  CF-EFFECTIVE-DATE-SELECT.
  1733             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1734             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1735
  1736         16  CF-EXCEPTION-LIST-IND          PIC X.
  1737             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1738
  1739         16  FILLER                         PIC X(318).
  1740
  1741****************************************************************
  1742*                  EXCEPTION REPORTING RECORD                  *
  1743****************************************************************
  1744
  1745     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1746         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1747             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1748
  1749         16  CF-COMBINED-LIFE-AH-OPT.
  1750             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1751             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1752             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1753             20  CF-CANCELLATION-RATIO      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  32
* EL202.cbl
  1754
  1755         16  CF-LIFE-OPT.
  1756             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1757             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1758             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1759             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1760             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1761             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1762             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1763             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1764             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1765             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1766
  1767         16  CF-AH-OPT.
  1768             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1769             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1770             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1771             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1772             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1773             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1774             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1775             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1776             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1777             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1778
  1779         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1780             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1781             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1782             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1783
  1784         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1785
  1786         16  FILLER                         PIC X(673).
  1787
  1788
  1789****************************************************************
  1790*             MORTGAGE SYSTEM PLAN RECORD                      *
  1791****************************************************************
  1792
  1793     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1794         16  CF-PLAN-TYPE                   PIC X.
  1795             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1796             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1797             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1798         16  CF-PLAN-ABBREV                 PIC XXX.
  1799         16  CF-PLAN-DESCRIPT               PIC X(10).
  1800         16  CF-PLAN-NOTES                  PIC X(20).
  1801         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1802         16  CF-PLAN-UNDERWRITING.
  1803             20  CF-PLAN-TERM-DATA.
  1804                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1805                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1806             20  CF-PLAN-AGE-DATA.
  1807                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1808                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1809                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1810             20  CF-PLAN-BENEFIT-DATA.
  1811                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  33
* EL202.cbl
  1812                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1813                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1814                                            PIC S9(7)V99  COMP-3.
  1815         16  CF-PLAN-POLICY-FORMS.
  1816             20  CF-POLICY-FORM             PIC X(12).
  1817             20  CF-MASTER-APPLICATION      PIC X(12).
  1818             20  CF-MASTER-POLICY           PIC X(12).
  1819         16  CF-PLAN-RATING.
  1820             20  CF-RATE-CODE               PIC X(5).
  1821             20  CF-SEX-RATING              PIC X.
  1822                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1823                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1824             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1825             20  CF-SUB-STD-TYPE            PIC X.
  1826                 88  CF-PCT-OF-PREM            VALUE '1'.
  1827                 88  CF-PCT-OF-BENE            VALUE '2'.
  1828         16  CF-PLAN-PREM-TOLERANCES.
  1829             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1830             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1831         16  CF-PLAN-PYMT-TOLERANCES.
  1832             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1833             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1834         16  CF-PLAN-MISC-DATA.
  1835             20  FILLER                     PIC X.
  1836             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1837             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1838         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1839         16  CF-PLAN-IND-GRP                PIC X.
  1840             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1841                                                     '1'.
  1842             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1843                                                     '2'.
  1844         16  CF-MIB-SEARCH-SW               PIC X.
  1845             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1846             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1847             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1848             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1849         16  CF-ALPHA-SEARCH-SW             PIC X.
  1850             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1851             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1852             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1853             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1854             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1855             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1856             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1857             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1858             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1859             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1860                                                     'A' 'B' 'C'
  1861                                                     'X' 'Y' 'Z'.
  1862         16  CF-EFF-DT-RULE-SW              PIC X.
  1863             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1864             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1865             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1866             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1867             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1868         16  FILLER                         PIC X(4).
  1869         16  CF-HEALTH-QUESTIONS            PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  34
* EL202.cbl
  1870             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1871         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1872         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1873         16  CF-PLAN-SNGL-JNT               PIC X.
  1874             88  CF-COMBINED-PLAN              VALUE 'C'.
  1875             88  CF-JNT-PLAN                   VALUE 'J'.
  1876             88  CF-SNGL-PLAN                  VALUE 'S'.
  1877         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1878         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1879         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1880         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1881         16  CF-RERATE-CNTL                 PIC  X.
  1882             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1883             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1884             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1885             88  CF-AUTO-RECALC                 VALUE '4'.
  1886         16  CF-BENEFIT-TYPE                PIC  X.
  1887             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1888             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1889         16  CF-POLICY-FEE                  PIC S999V99
  1890                                                    COMP-3.
  1891         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1892         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1893         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1894         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1895         16  FILLER                         PIC  X(32).
  1896         16  CF-TERMINATION-FORM            PIC  X(04).
  1897         16  FILLER                         PIC  X(08).
  1898         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1899                                                       COMP-3.
  1900         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1901         16  CF-ISSUE-LETTER                PIC  X(4).
  1902         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1903         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1904             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1905             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1906         16  CF-MP-REFUND-CALC              PIC X.
  1907             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1908             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1909             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1910             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1911             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1912             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1913             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1914             88  CF-MP-REFD-MEAN                VALUE '8'.
  1915         16  CF-ALT-RATE-CODE               PIC  X(5).
  1916
  1917
  1918         16  FILLER                         PIC X(498).
  1919****************************************************************
  1920*             MORTGAGE COMPANY MASTER RECORD                   *
  1921****************************************************************
  1922
  1923     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1924         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1925         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1926             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  1927             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  35
* EL202.cbl
  1928             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1929             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1930             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  1931
  1932         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1933         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1934         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1935         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1936         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1937
  1938         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1939             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1940         16  CF-MP-RECON-USE-IND            PIC X(1).
  1941             88  CF-MP-USE-RECON             VALUE 'Y'.
  1942         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1943             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1944         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1945             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1946             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1947         16  FILLER                         PIC X(1).
  1948         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1949             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1950         16  CF-MORTG-MIB-VERSION           PIC X.
  1951             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1952             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1953             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1954         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1955             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1956                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1957             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1958                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1959             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1960                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1961             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1962                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1963             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1964                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1965             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1966                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1967         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1968         16  FILLER                         PIC X(7).
  1969         16  CF-MORTG-DESTINATION-SYMBOL.
  1970             20  CF-MORTG-MIB-COMM          PIC X(5).
  1971             20  CF-MORTG-MIB-TERM          PIC X(5).
  1972         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1973             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1974         16  FILLER                         PIC X(03).
  1975         16  CF-MP-CHECK-NO-CONTROL.
  1976             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1977                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  1978                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1979                                                ' ' LOW-VALUES.
  1980                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1981                                               VALUE '3'.
  1982         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1983         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1984         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  1985             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  36
* EL202.cbl
  1986                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1987             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1988                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  1989             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1990                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1991             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1992                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1993             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1994                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1995             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1996                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1997         16  CF-MORTG-BILLING-AREA.
  1998             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  1999                                            PIC X.
  2000         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2001         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2002         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2003         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2004             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2005             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2006         16  FILLER                         PIC X.
  2007         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2008             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2009             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2010         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2011         16  FILLER                         PIC X(8).
  2012         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2013         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2014         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2015         16  CF-ACH-COMPANY-ID.
  2016             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2017                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2018                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2019                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2020             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2021         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2022             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2023         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2024             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2025             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2026         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2027         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2028         16  FILLER                         PIC X(536).
  2029
  2030****************************************************************
  2031*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2032****************************************************************
  2033
  2034     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2035         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2036             20  CF-FEMALE-HEIGHT.
  2037                 24  CF-FEMALE-FT           PIC 99.
  2038                 24  CF-FEMALE-IN           PIC 99.
  2039             20  CF-FEMALE-MIN-WT           PIC 999.
  2040             20  CF-FEMALE-MAX-WT           PIC 999.
  2041         16  FILLER                         PIC X(428).
  2042
  2043     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  37
* EL202.cbl
  2044         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2045             20  CF-MALE-HEIGHT.
  2046                 24  CF-MALE-FT             PIC 99.
  2047                 24  CF-MALE-IN             PIC 99.
  2048             20  CF-MALE-MIN-WT             PIC 999.
  2049             20  CF-MALE-MAX-WT             PIC 999.
  2050         16  FILLER                         PIC X(428).
  2051******************************************************************
  2052*             AUTOMATIC ACTIVITY RECORD                          *
  2053******************************************************************
  2054     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2055         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2056             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2057             20  CF-SYS-LETTER-ID           PIC X(04).
  2058             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2059             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2060             20  CF-SYS-RESET-SW            PIC X(01).
  2061             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2062             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2063
  2064         16  FILLER                         PIC X(50).
  2065
  2066         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2067             20  CF-USER-ACTIVE-SW          PIC X(01).
  2068             20  CF-USER-LETTER-ID          PIC X(04).
  2069             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2070             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2071             20  CF-USER-RESET-SW           PIC X(01).
  2072             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2073             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2074             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2075
  2076         16  FILLER                         PIC X(246).
  2077*                                copy ERCPYAJ.
  2078******************************************************************
  2079*                                                                *
  2080*                            ERCPYAJ                             *
  2081*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2082*                            VMOD=2.015                          *
  2083*                                                                *
  2084*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2085*                                                                *
  2086*                                                                *
  2087*   FILE TYPE = VSAM,KSDS                                        *
  2088*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2089*                                                                *
  2090*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2091*       ALTERNATE PATHS = NONE                                   *
  2092*                                                                *
  2093*   LOG = YES                                                    *
  2094*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2095******************************************************************
  2096******************************************************************
  2097*                   C H A N G E   L O G
  2098*
  2099* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2100*-----------------------------------------------------------------
  2101*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  38
* EL202.cbl
  2102* EFFECTIVE    NUMBER
  2103*-----------------------------------------------------------------
  2104* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2105* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2106******************************************************************
  2107
  2108 01  PENDING-PAY-ADJ.
  2109     12  PY-RECORD-ID                     PIC XX.
  2110         88  VALID-PY-ID                        VALUE 'PY'.
  2111
  2112     12  PY-CONTROL-PRIMARY.
  2113         16  PY-COMPANY-CD                PIC X.
  2114         16  PY-CARRIER                   PIC X.
  2115         16  PY-GROUPING                  PIC X(6).
  2116         16  PY-FIN-RESP                  PIC X(10).
  2117         16  PY-ACCOUNT                   PIC X(10).
  2118         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2119                                          PIC X(10).
  2120         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2121         16  PY-RECORD-TYPE               PIC X.
  2122             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2123             88  PY-DEPOSIT                   VALUE 'D'.
  2124             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2125             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2126             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2127             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2128             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2129             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2130             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2131             88  PY-FICA-ENTRY                VALUE 'F'.
  2132             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2133             88  PY-POLICY-FEE                VALUE 'W'.
  2134             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2135
  2136     12  PY-PYMT-TYPE                     PIC X.
  2137             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2138             88  PY-REINS-PYMT                VALUE 'R'.
  2139             88  PY-EXP-PYMT                  VALUE 'E'.
  2140
  2141     12  PY-BIL-INV                       PIC X(6).
  2142     12  PY-REF-NO                        PIC X(12).
  2143
  2144     12  PY-LAST-MAINT-DT                 PIC XX.
  2145     12  PY-LAST-MAINT-BY                 PIC X(4).
  2146     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2147
  2148     12  PY-PYADJ-RECORD.
  2149         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2150         16  PY-ENTRY-COMMENT             PIC X(30).
  2151         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2152             20  PY-GL-ACCOUNT            PIC X(10).
  2153             20  PY-GL-STATE              PIC X(02).
  2154             20  PY-GL-CANC-SW            PIC X(01).
  2155                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2156                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2157             20  PY-GL-COMMENT            PIC X(10).
  2158             20  FILLER      REDEFINES PY-GL-COMMENT.
  2159                 24  PY-GL-CHECK-NO       PIC 9(06).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  39
* EL202.cbl
  2160                 24  FILLER               PIC X(04).
  2161             20  FILLER                   PIC X(07).
  2162         16  PY-SAVE-ACCOUNT              PIC X(10).
  2163         16  PY-SAVE-TYPE                 PIC X(01).
  2164
  2165         16  PY-LETTERS.
  2166             20  PY-LETTER OCCURS 3 TIMES
  2167                           INDEXED BY PY-LET-NDX
  2168                                          PIC X(04).
  2169
  2170         16  PY-ERCOMP-TYPE               PIC X.
  2171             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2172             88  PY-GA-TYPE                   VALUE 'G'.
  2173             88  PY-BANK-TYPE                 VALUE 'B'.
  2174         16  FILLER                       PIC X(05).
  2175
  2176     12  PY-RECORD-STATUS.
  2177         16  PY-CREDIT-SELECT-DT          PIC XX.
  2178         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2179         16  PY-BILLED-DATE               PIC XX.
  2180         16  PY-REPORTED-DT               PIC XX.
  2181         16  PY-PMT-APPLIED               PIC X.
  2182             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2183             88  PY-GA-PMT                    VALUE 'G'.
  2184             88  PY-OVWRITE-PMT               VALUE 'O'.
  2185             88  PY-NON-AR-PMT                VALUE 'N'.
  2186         16  FILLER                       PIC X(5).
  2187         16  PY-INPUT-DT                  PIC XX.
  2188         16  PY-CHECK-NUMBER              PIC X(6).
  2189         16  PY-VOID-SW                   PIC X.
  2190             88  PY-CHECK-VOIDED              VALUE 'V'.
  2191         16  PY-CHECK-ORIGIN-SW           PIC X.
  2192             88  PY-BILLING-CHECK             VALUE 'B'.
  2193             88  PY-REFUND-CHECK              VALUE 'R'.
  2194             88  PY-GA-CHECK                  VALUE 'G'.
  2195             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2196             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2197         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2198         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2199         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2200         16  PY-BILL-FLAG                 PIC X.
  2201             88  PY-BILLED                    VALUE 'B'.
  2202         16  PY-AR-FLAG                   PIC X.
  2203             88  PY-AR-CYCLE                  VALUE 'C'.
  2204             88  PY-AR-MONTH-END              VALUE 'M'.
  2205         16  PY-AR-DATE                   PIC XX.
  2206
  2207     12  PY-GL-CODES.
  2208         16  PY-GL-DB                     PIC X(14).
  2209         16  PY-GL-CR                     PIC X(14).
  2210         16  PY-GL-FLAG                   PIC X.
  2211         16  PY-GL-DATE                   PIC XX.
  2212
  2213     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2214     12  FILLER                           PIC X(3).
  2215******************************************************************
  2216*                                copy ERCPNDB.
  2217******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  40
* EL202.cbl
  2218*                                                                *
  2219*                                                                *
  2220*                            ERCPNDB.                            *
  2221*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2222*                            VMOD=2.025                          *
  2223*                                                                *
  2224*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2225*                                                                *
  2226******************************************************************
  2227*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2228*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2229******************************************************************
  2230*                                                                *
  2231*                                                                *
  2232*   FILE TYPE = VSAM,KSDS                                        *
  2233*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2234*                                                                *
  2235*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2236*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2237*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2238*                                                 RKP=13,LEN=36  *
  2239*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2240*                                      AND CHG-SEQ.)             *
  2241*                                                RKP=49,LEN=11   *
  2242*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2243*                                      AND CHG-SEQ.)             *
  2244*                                                RKP=60,LEN=15   *
  2245*                                                                *
  2246*   LOG = NO                                                     *
  2247*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2248******************************************************************
  2249******************************************************************
  2250*                   C H A N G E   L O G
  2251*
  2252* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2253*-----------------------------------------------------------------
  2254*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2255* EFFECTIVE    NUMBER
  2256*-----------------------------------------------------------------
  2257* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2258* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2259* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2260* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2261* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2262* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2263* 032306                   PEMA  ADD BOW LOAN NUMBER
  2264* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2265* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2266* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2267* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2268* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2269* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2270* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2271* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2272* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  2273******************************************************************
  2274
  2275 01  PENDING-BUSINESS.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  41
* EL202.cbl
  2276     12  PB-RECORD-ID                     PIC XX.
  2277         88  VALID-PB-ID                        VALUE 'PB'.
  2278
  2279     12  PB-CONTROL-PRIMARY.
  2280         16  PB-COMPANY-CD                PIC X.
  2281         16  PB-ENTRY-BATCH               PIC X(6).
  2282         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2283         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2284
  2285     12  PB-CONTROL-BY-ACCOUNT.
  2286         16  PB-COMPANY-CD-A1             PIC X.
  2287         16  PB-CARRIER                   PIC X.
  2288         16  PB-GROUPING.
  2289             20  PB-GROUPING-PREFIX       PIC XXX.
  2290             20  PB-GROUPING-PRIME        PIC XXX.
  2291         16  PB-STATE                     PIC XX.
  2292         16  PB-ACCOUNT.
  2293             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2294             20  PB-ACCOUNT-PRIME         PIC X(6).
  2295         16  PB-CERT-EFF-DT               PIC XX.
  2296         16  PB-CERT-NO.
  2297             20  PB-CERT-PRIME            PIC X(10).
  2298             20  PB-CERT-SFX              PIC X.
  2299         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2300
  2301         16  PB-RECORD-TYPE               PIC X.
  2302             88  PB-MAILING-DATA                VALUE '0'.
  2303             88  PB-ISSUE                       VALUE '1'.
  2304             88  PB-CANCELLATION                VALUE '2'.
  2305             88  PB-BATCH-TRAILER               VALUE '9'.
  2306
  2307     12  PB-CONTROL-BY-ORIG-BATCH.
  2308         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2309         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2310         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2311         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2312
  2313     12  PB-CONTROL-BY-CSR.
  2314         16  PB-CSR-COMPANY-CD            PIC X.
  2315         16  PB-CSR-ID                    PIC X(4).
  2316         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2317         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2318         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2319******************************************************************
  2320*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2321******************************************************************
  2322
  2323     12  PB-LAST-MAINT-DT                 PIC XX.
  2324     12  PB-LAST-MAINT-BY                 PIC X(4).
  2325     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2326
  2327     12  PB-RECORD-BODY                   PIC X(375).
  2328
  2329     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2330         16  PB-CERT-ORIGIN               PIC X.
  2331             88  CLASIC-CREATED-CERT         VALUE '1'.
  2332         16  PB-I-NAME.
  2333             20  PB-I-INSURED-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  42
* EL202.cbl
  2334             20  PB-I-INSURED-FIRST-NAME.
  2335                 24  PB-I-INSURED-1ST-INIT PIC X.
  2336                 24  FILLER                PIC X(9).
  2337             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2338         16  PB-I-AGE                     PIC S99   COMP-3.
  2339         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2340         16  PB-I-BIRTHDAY                PIC XX.
  2341         16  PB-I-INSURED-SEX             PIC X.
  2342             88  PB-SEX-MALE     VALUE 'M'.
  2343             88  PB-SEX-FEMALE   VALUE 'F'.
  2344
  2345         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2346         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2347         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2348         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2349         16  PB-I-SKIP-CODE               PIC X.
  2350             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2351             88  PB-SKIP-JULY              VALUE '1'.
  2352             88  PB-SKIP-AUGUST            VALUE '2'.
  2353             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2354             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2355             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2356             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2357             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2358             88  PB-SKIP-JUNE              VALUE '8'.
  2359             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2360             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2361             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2362         16  PB-I-TERM-TYPE               PIC X.
  2363             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2364             88  PB-PAID-WEEKLY            VALUE 'W'.
  2365             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2366             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2367             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2368         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2369         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2370         16  PB-I-DATA-ENTRY-SW           PIC X.
  2371             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2372             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2373             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2374             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2375         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2376         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2377*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2378         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2379         16  FILLER                       PIC X.
  2380
  2381         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2382             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2383             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2384                                                   '90' THRU '99'.
  2385         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2386                                          PIC XX.
  2387         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2388         16  PB-I-AMOUNT-FINANCED REDEFINES
  2389                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  2390         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  2391         16  PB-I-UNPAID-CASH-PRICE REDEFINES
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  43
* EL202.cbl
  2392                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  2393         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2394         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2395         16  PB-I-CLP-AMOUNT REDEFINES
  2396                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2397         16  PB-I-LF-CALC-FLAG            PIC X.
  2398             88 PB-COMP-LF-PREM               VALUE '?'.
  2399         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2400         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2401         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2402         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2403         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2404         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2405         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2406         16  PB-I-LF-ABBR                 PIC XXX.
  2407         16  PB-I-LF-INPUT-CD             PIC XX.
  2408
  2409         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2410             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2411             88  PB-INVALID-AH               VALUE '  ' '00'
  2412                                                   '90' THRU '99'.
  2413         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2414         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2415         16  PB-I-AH-CALC-FLAG            PIC X.
  2416             88 PB-COMP-AH-PREM                  VALUE '?'.
  2417         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2418         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2419         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2420         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2421         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2422         16  PB-I-AH-ABBR                 PIC XXX.
  2423         16  PB-I-AH-INPUT-CD             PIC XXX.
  2424
  2425         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2426         16  PB-I-REIN-TABLE              PIC XXX.
  2427         16  PB-I-BUSINESS-TYPE           PIC 99.
  2428         16  PB-I-INDV-GRP-CD             PIC X.
  2429         16  PB-I-MORT-CODE.
  2430             20  PB-I-TABLE               PIC X.
  2431             20  PB-I-INTEREST            PIC XX.
  2432             20  PB-I-MORT-TYP            PIC X.
  2433         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2434         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2435         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2436         16  PB-I-INDV-GRP-OVRD           PIC X.
  2437         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2438         16  PB-I-SIG-SW                  PIC X.
  2439             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2440         16  PB-I-RATE-CLASS              PIC XX.
  2441         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2442         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2443         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2444         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2445         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2446         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2447         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  2448         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2449         16  PB-I-OB-FLAG                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  44
* EL202.cbl
  2450             88  PB-I-OB                      VALUE 'B'.
  2451             88  PB-I-SUMMARY                 VALUE 'Z'.
  2452         16  PB-I-ENTRY-STATUS            PIC X.
  2453             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2454                                              'M' '5' '9' '2'.
  2455             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2456             88  PB-I-POLICY-PENDING          VALUE '2'.
  2457             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2458             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2459             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  2460             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2461             88  PB-I-REIN-ONLY               VALUE '9'.
  2462             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2463             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2464             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2465             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2466         16  PB-I-INT-CODE                PIC X.
  2467             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2468             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2469         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2470         16  PB-I-SOC-SEC-NO              PIC X(11).
  2471         16  PB-I-MEMBER-NO               PIC X(12).
  2472         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2473*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2474         16  PB-I-OLD-LOF                 PIC XXX.
  2475         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2476         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2477         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2478         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2479         16  PB-I-LIFE-INDICATOR          PIC X.
  2480             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2481         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2482         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2483                                          PIC S9(5)V99    COMP-3.
  2484         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2485             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2486             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2487         16  PB-I-1ST-PMT-DT              PIC XX.
  2488         16  PB-I-JOINT-INSURED.
  2489             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2490             20 PB-I-JOINT-FIRST-NAME.
  2491                24  PB-I-JOINT-FIRST-INIT PIC X.
  2492                24  FILLER                PIC X(9).
  2493             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2494*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2495         16  PB-I-BENEFICIARY-NAME.
  2496             20  PB-I-BANK-NUMBER         PIC X(10).
  2497             20  FILLER                   PIC X(15).
  2498         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2499         16  PB-I-REFERENCE               PIC X(12).
  2500         16  FILLER REDEFINES PB-I-REFERENCE.
  2501             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2502             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2503             20  PB-I-CLP-STATE           PIC XX.
  2504         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2505             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2506             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  2507             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  45
* EL202.cbl
  2508         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2509         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2510         16  PB-I-RESIDENT-STATE          PIC XX.
  2511         16  PB-I-RATE-CODE               PIC X(4).
  2512         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2513         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2514         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2515         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2516         16  PB-I-BANK-NOCHRGB            PIC 99.
  2517         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2518         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2519
  2520     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2521         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2522             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2523         16  PB-C-CANCEL-ORIGIN           PIC X.
  2524             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2525         16  PB-C-LF-CANCEL-DT            PIC XX.
  2526         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2527         16  PB-C-LF-CALC-REQ             PIC X.
  2528             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2529         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2530         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2531         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2532             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2533         16  PB-C-AH-CANCEL-DT            PIC XX.
  2534         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2535         16  PB-C-AH-CALC-REQ             PIC X.
  2536             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2537         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2538         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2539         16  PB-C-LAST-NAME               PIC X(15).
  2540         16  PB-C-REFUND-SW               PIC X.
  2541             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2542             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2543         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2544         16  PB-C-PAYEE-CODE              PIC X(6).
  2545         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2546         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2547         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2548         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2549         16  PB-C-REFERENCE               PIC X(12).
  2550         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2551         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2552         16  PB-C-POST-CARD-IND           PIC X.
  2553         16  PB-C-CANCEL-REASON           PIC X.
  2554         16  PB-C-REF-INTERFACE-SW        PIC X.
  2555         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2556         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2557         16  FILLER                       PIC X(01).
  2558*        16  FILLER                       PIC X(18).
  2559         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2560*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2561         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2562         16  PB-CANCELED-CERT-DATA.
  2563             20  PB-CI-INSURED-NAME.
  2564                 24  PB-CI-LAST-NAME      PIC X(15).
  2565                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  46
* EL202.cbl
  2566             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2567             20  PB-CI-INSURED-SEX        PIC X.
  2568             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2569             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2570             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2571             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2572             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2573             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2574             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2575             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2576             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2577             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2578             20  PB-CI-RATE-CLASS         PIC XX.
  2579             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2580             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2581             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2582             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2583             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2584             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2585             20  PB-CI-LF-ABBR            PIC X(3).
  2586             20  PB-CI-AH-ABBR            PIC X(3).
  2587             20  PB-CI-OB-FLAG            PIC X.
  2588                 88  PB-CI-OB                VALUE 'B'.
  2589             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2590                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2591                                           'M' '4' '5' '9' '2'.
  2592                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2593                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2594                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2595                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2596                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2597                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  2598                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2599                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2600                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2601                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2602                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2603                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2604                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2605             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2606                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2607                                           'M' '4' '5' '9' '2'.
  2608                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2609                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2610                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2611                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2612                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2613                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  2614                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2615                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2616                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2617                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2618                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2619                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2620                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2621             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2622             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2623             20  PB-CI-SOC-SEC-NO         PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  47
* EL202.cbl
  2624             20  PB-CI-MEMBER-NO          PIC X(12).
  2625             20  PB-CI-INT-CODE           PIC X.
  2626                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2627                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2628             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2629             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2630             20  PB-CI-COMP-EXCP-SW       PIC X.
  2631                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2632                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2633             20  PB-CI-ENTRY-STATUS       PIC X.
  2634             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2635             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2636             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2637             20  PB-CI-DEATH-DT           PIC XX.
  2638             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2639             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2640             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2641             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2642             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2643             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2644             20  PB-CI-ENTRY-DT              PIC XX.
  2645             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2646             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2647             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2648             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2649             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2650             20  PB-CI-OLD-LOF               PIC XXX.
  2651*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2652             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2653             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2654             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2655             20  PB-CI-INDV-GRP-CD           PIC X.
  2656             20  PB-CI-BENEFICIARY-NAME.
  2657                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2658                 24  FILLER                  PIC X(15).
  2659             20  PB-CI-NOTE-SW               PIC X.
  2660             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2661             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2662             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2663             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2664             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2665             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2666             20  PB-CI-FIRST-NAME            PIC X(10).
  2667             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2668
  2669         16  FILLER                       PIC X(13).
  2670*032306  16  FILLER                       PIC X(27).
  2671*        16  FILLER                       PIC X(46).
  2672
  2673     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2674         16  FILLER                       PIC X(10).
  2675         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2676         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2677         16  PB-M-INSURED-MID-INIT        PIC X.
  2678         16  PB-M-INSURED-AGE             PIC 99.
  2679         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2680         16  PB-M-INSURED-SEX             PIC X.
  2681         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  48
* EL202.cbl
  2682         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  2683         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2684         16  PB-M-INSURED-CITY-STATE.
  2685             20  PB-M-INSURED-CITY        PIC X(28).
  2686             20  PB-M-INSURED-STATE       PIC XX.
  2687         16  PB-M-INSURED-ZIP-CODE.
  2688             20  PB-M-INSURED-ZIP-PRIME.
  2689                 24  PB-M-INSURED-ZIP-1   PIC X.
  2690                     88  PB-M-CANADIAN-POST-CODE
  2691                                             VALUE 'A' THRU 'Z'.
  2692                 24  FILLER               PIC X(4).
  2693             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2694         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2695                                        PB-M-INSURED-ZIP-CODE.
  2696             20  PM-M-INS-CAN-POST1       PIC XXX.
  2697             20  PM-M-INS-CAN-POST2       PIC XXX.
  2698             20  FILLER                   PIC XXX.
  2699         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2700         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2701         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2702         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2703         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2704         16  PB-M-CRED-BENE-CITYST.
  2705             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2706             20  PB-M-CRED-BENE-STATE     PIC XX.
  2707         16  FILLER                       PIC X(92).
  2708
  2709     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2710         16  FILLER                       PIC X(10).
  2711         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2712         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2713         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2714         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2715         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2716         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2717         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2718         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2719         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2720         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2721         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2722         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2723         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2724         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2725         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2726         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2727         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2728         16  PB-ACCOUNT-NAME              PIC X(30).
  2729         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2730         16  PB-REFERENCE                 PIC X(12).
  2731         16  PB-B-RECEIVED-DT             PIC XX.
  2732         16  FILLER                       PIC X(234).
  2733
  2734     12  PB-RECORD-STATUS.
  2735         16  PB-CREDIT-SELECT-DT          PIC XX.
  2736         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2737         16  PB-BILLED-DT                 PIC XX.
  2738         16  PB-BILLING-STATUS            PIC X.
  2739             88  PB-ENTRY-REVERSED            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  49
* EL202.cbl
  2740             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2741             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2742         16  PB-RECORD-BILL               PIC X.
  2743             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2744             88  PB-RECORD-RETURNED           VALUE 'R'.
  2745             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2746             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2747             88  PB-OVERRIDE-AH               VALUE 'A'.
  2748             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2749         16  PB-BATCH-ENTRY               PIC X.
  2750             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2751             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2752             88  PB-REISSUED-CERT             VALUE 'E'.
  2753             88  PB-CASH-CERT                 VALUE 'C'.
  2754             88  PB-MONTHLY-CERT              VALUE 'M'.
  2755             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2756             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2757             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2758         16  PB-FORCE-CODE                PIC X.
  2759             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2760             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2761             88  PB-CANCEL-FORCE              VALUE '8'.
  2762             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2763             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2764             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2765             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2766             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2767             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2768             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2769         16  PB-FATAL-FLAG                PIC X.
  2770             88  PB-FATAL-ERRORS              VALUE 'X'.
  2771         16  PB-FORCE-ER-CD               PIC X.
  2772             88  PB-FORCE-ERRORS              VALUE 'F'.
  2773             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2774         16  PB-WARN-ER-CD                PIC X.
  2775             88  PB-WARNING-ERRORS            VALUE 'W'.
  2776         16  FILLER                       PIC X.
  2777         16  PB-OUT-BAL-CD                PIC X.
  2778             88  PB-OUT-OF-BAL                VALUE 'O'.
  2779         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2780         16  PB-AH-OVERRIDE-L1            PIC X.
  2781         16  PB-INPUT-DT                  PIC XX.
  2782         16  PB-INPUT-BY                  PIC X(4).
  2783         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2784         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2785         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2786         16  PB-LF-EARNING-METHOD         PIC X.
  2787         16  PB-AH-EARNING-METHOD         PIC X.
  2788         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2789         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2790         16  PB-REIN-CD                   PIC XXX.
  2791         16  PB-LF-REFUND-TYPE            PIC X.
  2792         16  PB-AH-REFUND-TYPE            PIC X.
  2793         16  PB-ACCT-EFF-DT               PIC XX.
  2794         16  PB-ACCT-EXP-DT               PIC XX.
  2795         16  PB-COMPANY-ID                PIC X(3).
  2796         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2797         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  50
* EL202.cbl
  2798         16  PB-SV-CARRIER                PIC X.
  2799         16  PB-SV-GROUPING               PIC X(6).
  2800         16  PB-SV-STATE                  PIC XX.
  2801         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2802         16  PB-GA-BILLING-INFO.
  2803             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2804                                          PIC XX.
  2805         16  PB-SV-REMIT-TO  REDEFINES
  2806             PB-GA-BILLING-INFO           PIC X(10).
  2807         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2808         16  PB-I-LOAN-OFFICER            PIC X(5).
  2809         16  PB-I-VIN                     PIC X(17).
  2810
  2811         16  FILLER                       PIC X(04).
  2812         16  IMNET-BYPASS-SW              PIC X.
  2813
  2814******************************************************************
  2815*                COMMON EDIT ERRORS                              *
  2816******************************************************************
  2817
  2818     12  PB-COMMON-ERRORS.
  2819         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2820                                           PIC S9(4)     COMP.
  2821
  2822******************************************************************
  2823*                                copy ERCPNDM.
  2824******************************************************************
  2825*                                                                *
  2826*                                                                *
  2827*                            ERCPNDM                             *
  2828*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2829*                            VMOD=2.003                          *
  2830*                                                                *
  2831*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2832*                                                                *
  2833*   FILE TYPE = VSAM,KSDS                                        *
  2834*   RECORD SIZE = 374   RECFORM = FIX                            *
  2835*                                                                *
  2836*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2837*   ALTERNATE PATH    = NOT USED                                 *
  2838*                                                                *
  2839*   LOG = YES                                                    *
  2840*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2841******************************************************************
  2842*                   C H A N G E   L O G
  2843*
  2844* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2845*-----------------------------------------------------------------
  2846*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2847* EFFECTIVE    NUMBER
  2848*-----------------------------------------------------------------
  2849* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2850* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2851* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2852******************************************************************
  2853
  2854 01  PENDING-MAILING-DATA.
  2855     12  PM-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  51
* EL202.cbl
  2856         88  VALID-MA-ID                       VALUE 'PM'.
  2857
  2858     12  PM-CONTROL-PRIMARY.
  2859         16  PM-COMPANY-CD                 PIC X.
  2860         16  PM-ENTRY-BATCH                PIC X(6).
  2861         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2862         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2863
  2864     12  FILLER                            PIC X(14).
  2865
  2866     12  PM-ACCESS-CONTROL.
  2867         16  PM-SOURCE-SYSTEM              PIC XX.
  2868             88  PM-FROM-CREDIT                VALUE 'CR'.
  2869             88  PM-FROM-VSI                   VALUE 'VS'.
  2870             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2871             88  PM-FROM-OTHER                 VALUE 'OT'.
  2872         16  PM-RECORD-ADD-DT              PIC XX.
  2873         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2874         16  PM-LAST-MAINT-DT              PIC XX.
  2875         16  PM-LAST-MAINT-BY              PIC XXXX.
  2876         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2877
  2878     12  PM-PROFILE-INFO.
  2879         16  PM-QUALIFY-CODE-1             PIC XX.
  2880         16  PM-QUALIFY-CODE-2             PIC XX.
  2881         16  PM-QUALIFY-CODE-3             PIC XX.
  2882         16  PM-QUALIFY-CODE-4             PIC XX.
  2883         16  PM-QUALIFY-CODE-5             PIC XX.
  2884
  2885         16  PM-INSURED-LAST-NAME          PIC X(15).
  2886         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2887         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2888         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2889         16  PM-INSURED-BIRTH-DT           PIC XX.
  2890         16  PM-INSURED-SEX                PIC X.
  2891             88  PM-SEX-MALE                   VALUE 'M'.
  2892             88  PM-SEX-FEMALE                 VALUE 'F'.
  2893         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2894
  2895         16  PM-ADDRESS-CORRECTED          PIC X.
  2896         16  PM-JOINT-BIRTH-DT             PIC XX.
  2897*        16  FILLER                        PIC X(12).
  2898
  2899         16  PM-ADDRESS-LINE-1             PIC X(30).
  2900         16  PM-ADDRESS-LINE-2             PIC X(30).
  2901         16  PM-CITY-STATE.
  2902             20  PM-CITY                   PIC X(28).
  2903             20  PM-STATE                  PIC XX.
  2904         16  PM-ZIP.
  2905             20  PM-ZIP-CODE.
  2906                 24  PM-ZIP-1              PIC X.
  2907                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2908                 24  FILLER                PIC X(4).
  2909             20  PM-ZIP-PLUS4              PIC X(4).
  2910         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2911             20  PM-CAN-POST1              PIC XXX.
  2912             20  PM-CAN-POST2              PIC XXX.
  2913             20  FILLER                    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  52
* EL202.cbl
  2914
  2915         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2916
  2917         16  FILLER                        PIC X(03).
  2918
  2919     12  PM-CRED-BENE-INFO.
  2920         16  PM-CRED-BENE-NAME             PIC X(25).
  2921         16  PM-CRED-BENE-ADDR             PIC X(30).
  2922         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2923         16  PM-CRED-BENE-CTYST.
  2924             20  PM-CRED-BENE-CITY         PIC X(28).
  2925             20  PM-CRED-BENE-STATE        PIC XX.
  2926         16  PM-CRED-BENE-ZIP.
  2927             20  PM-CB-ZIP-CODE.
  2928                 24  PM-CB-ZIP-1           PIC X.
  2929                     88  PM-CB-CANADIAN-POST-CODE
  2930                                  VALUE 'A' THRU 'Z'.
  2931                 24  FILLER                PIC X(4).
  2932             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2933         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2934             20  PM-CB-CAN-POST1           PIC XXX.
  2935             20  PM-CB-CAN-POST2           PIC XXX.
  2936             20  FILLER                    PIC XXX.
  2937     12  PM-POST-CARD-MAIL-DATA.
  2938         16  PM-MAIL-DATA OCCURS 7.
  2939             20  PM-MAIL-TYPE              PIC X.
  2940                 88  PM-12MO-MAILING           VALUE '1'.
  2941                 88  PM-EXP-MAILING            VALUE '2'.
  2942             20  PM-MAIL-STATUS            PIC X.
  2943                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2944                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2945                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2946             20  PM-MAIL-DATE              PIC XX.
  2947     12  FILLER                            PIC XX.
  2948     12  FILLER                            PIC X(12).
  2949*    12  FILLER                            PIC X(30).
  2950
  2951******************************************************************
  2952 01  w-doctoken                  pic x(16).
  2953 01  BATCH-TO-PROCESS.
  2954     05  EDIT-COMPANY-CD         PIC X       VALUE LOW-VALUES.
  2955     05  EDIT-BATCH              PIC X(6)    VALUE SPACES.
  2956     05  EDIT-COMPANY-ID         PIC XXX     VALUE SPACES.
  2957     05  EDIT-RESTART-BATCH      PIC X(6)    VALUE SPACES.
  2958 01 output-data.
  2959    05  filler                   pic x(6) value "TITLE=".
  2960    05  output-title             pic x(26) value 'Check Posting'.
  2961    05  filler                   pic x(8) value "&COMPID=".
  2962    05  out-comp-id              pic xxx.
  2963    05  filler                   pic x(5) value "&MSG=".
  2964    05  output-msg               pic x(50).
  2965****************************************************************
  2966*
  2967* Copyright (c) 2007 by Clerity Solutions, Inc.
  2968* All rights reserved.
  2969*
  2970****************************************************************
  2971 01  DFHEIV.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  53
* EL202.cbl
  2972   02  DFHEIV0               PIC X(35).
  2973   02  DFHEIV1               PIC X(08).
  2974   02  DFHEIV2               PIC X(08).
  2975   02  DFHEIV3               PIC X(08).
  2976   02  DFHEIV4               PIC X(06).
  2977   02  DFHEIV5               PIC X(04).
  2978   02  DFHEIV6               PIC X(04).
  2979   02  DFHEIV7               PIC X(02).
  2980   02  DFHEIV8               PIC X(02).
  2981   02  DFHEIV9               PIC X(01).
  2982   02  DFHEIV10              PIC S9(7) COMP-3.
  2983   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2984   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2985   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2986   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2987   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2988   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2989   02  DFHEIV17              PIC X(04).
  2990   02  DFHEIV18              PIC X(04).
  2991   02  DFHEIV19              PIC X(04).
  2992   02  DFHEIV20              USAGE IS POINTER.
  2993   02  DFHEIV21              USAGE IS POINTER.
  2994   02  DFHEIV22              USAGE IS POINTER.
  2995   02  DFHEIV23              USAGE IS POINTER.
  2996   02  DFHEIV24              USAGE IS POINTER.
  2997   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2998   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2999   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3000   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3001   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3002   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3003   02  FILLER                PIC X(02).
  3004   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3005   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3006   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3007   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3008   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3009 LINKAGE  SECTION.
  3010*****************************************************************
  3011*                                                               *
  3012* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3013* All rights reserved.                                          *
  3014*                                                               *
  3015*****************************************************************
  3016 01  dfheiblk.
  3017     02  eibtime          pic s9(7) comp-3.
  3018     02  eibdate          pic s9(7) comp-3.
  3019     02  eibtrnid         pic x(4).
  3020     02  eibtaskn         pic s9(7) comp-3.
  3021     02  eibtrmid         pic x(4).
  3022     02  dfheigdi         pic s9(4) comp.
  3023     02  eibcposn         pic s9(4) comp.
  3024     02  eibcalen         pic s9(4) comp.
  3025     02  eibaid           pic x(1).
  3026     02  eibfiller1       pic x(1).
  3027     02  eibfn            pic x(2).
  3028     02  eibfiller2       pic x(2).
  3029     02  eibrcode         pic x(6).
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  54
* EL202.cbl
  3030     02  eibfiller3       pic x(2).
  3031     02  eibds            pic x(8).
  3032     02  eibreqid         pic x(8).
  3033     02  eibrsrce         pic x(8).
  3034     02  eibsync          pic x(1).
  3035     02  eibfree          pic x(1).
  3036     02  eibrecv          pic x(1).
  3037     02  eibsend          pic x(1).
  3038     02  eibatt           pic x(1).
  3039     02  eibeoc           pic x(1).
  3040     02  eibfmh           pic x(1).
  3041     02  eibcompl         pic x(1).
  3042     02  eibsig           pic x(1).
  3043     02  eibconf          pic x(1).
  3044     02  eiberr           pic x(1).
  3045     02  eibrldbk         pic x(1).
  3046     02  eiberrcd         pic x(4).
  3047     02  eibsynrb         pic x(1).
  3048     02  eibnodat         pic x(1).
  3049     02  eibfiller5       pic x(2).
  3050     02  eibresp          pic 9(09) comp.
  3051     02  eibresp2         pic 9(09) comp.
  3052     02  dfheigdj         pic s9(4) comp.
  3053     02  dfheigdk         pic s9(4) comp.
  3054 01  DFHCOMMAREA                     PIC X(1024).
  3055 01  var  pic x(30).
  3056 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  3057 0000-DFHEXIT SECTION.
  3058     MOVE '9#                    $   ' TO DFHEIV0.
  3059     MOVE 'EL202' TO DFHEIV1.
  3060     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3061***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3062***                                                            ***
  3063***                                                We don't    ***
  3064***  have any form fields to browse through, we are getting    ***
  3065***  the information we need through the variables that are    ***
  3066***  included in the URL. These variables are retrieved by     ***
  3067***  the           exec cics web extract                       ***
  3068***                   querystring  (data-value)                ***
  3069***                   querystrlen  (data-value)                ***
  3070***                end-exec                                    ***
  3071***  BTW, you must provide the length, it isn't passed to you. ***
  3072***  Allow for extra on the length or you will get a length    ***
  3073***  error instead of just truncation.                         ***
  3074***                                                            ***
  3075***  This program is expecting                                 ***
  3076*** http://logictest:5002/cics/cwba/EL202?comp=DCC&remit=00001 ***
  3077***http://slunikix:7001/cics/cwba/EL202?comp=DCC&remit=0000000001*
  3078***                                                            ***
  3079***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3080     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  3081     string ws-fn-hours ws-fn-minutes ws-fn-seconds
  3082        delimited by size into ws-work-time-a
  3083     end-string
  3084     string ws-fn-mo     '/'
  3085            ws-fn-da     '/'
  3086            ws-fn-ccyr
  3087        delimited by size into ws-status-date
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  55
* EL202.cbl
  3088     end-string
  3089     move ws-fn-cymd             to dc-greg-date-cymd
  3090     move 'L'                    to dc-option-code
  3091     perform 9700-date-convert   thru 9700-exit
  3092     if no-conversion-error
  3093        move dc-bin-date-1       to ws-bin-current-dt
  3094     else
  3095        display ' error current dt invalid ' dc-error-code
  3096     end-if
  3097     set P to address of KIXSYS
  3098     CALL "getenv" using by value P returning var-ptr
  3099     if var-ptr = null then
  3100        display ' kixsys not set '
  3101     else
  3102        set address of var to var-ptr
  3103        move 0 to env-var-len
  3104        inspect var tallying env-var-len
  3105          for characters before X'00'
  3106        unstring var (1:env-var-len) delimited by '/'
  3107           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  3108              WS-KIX-SYS
  3109        end-unstring
  3110     end-if
  3111
  3112* exec cics web extract
  3113*       querystring  (ws-qry-string)
  3114*       querystrlen  (ws-qrystr-len)
  3115*    end-exec
  3116*    MOVE 'X0  QL                .   #00003014' TO DFHEIV0
  3117     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  3118     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  3119     MOVE X'2020233030303033303134' TO DFHEIV0(25:11)
  3120     CALL 'kxdfhei1' USING DFHEIV0,
  3121           DFHEIV99,
  3122           DFHEIV99,
  3123           ws-qry-string,
  3124           ws-qrystr-len,
  3125           DFHEIV99,
  3126           DFHEIV99,
  3127           DFHEIV99,
  3128           DFHEIV99,
  3129           DFHEIV99,
  3130           DFHEIV99,
  3131           DFHEIV99,
  3132           DFHEIV99,
  3133           DFHEIV99
  3134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3135     display ' qry string ' ws-qry-string
  3136     display ' gry len    ' ws-qrystr-len
  3137     move ws-qry-string (6:3)    to ws-comp-id
  3138     move ws-qry-string (16:10)  to ws-var-alpha
  3139     move zeros                  to ws-remit-id-a
  3140     move +10                    to o1
  3141     perform varying i1 from +10 by -1 until i1 < +1
  3142        if ws-var-alpha (i1:1) numeric
  3143           move ws-var-alpha (i1:1) to ws-remit-id-a (o1:1)
  3144           subtract +1 from o1
  3145        end-if
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  56
* EL202.cbl
  3146     end-perform
  3147     move 'Successful Run   '    to output-msg
  3148     move ws-comp-id             to elcntl-key
  3149     move '1'                    to elcntl-rec-type
  3150     move +0                     to elcntl-seq
  3151
  3152* exec cics read
  3153*       dataset  ('ELCNTL')
  3154*       into     (control-file)
  3155*       ridfld   (elcntl-key)
  3156*       resp     (ws-response)
  3157*    end-exec
  3158     MOVE LENGTH OF
  3159      control-file
  3160       TO DFHEIV11
  3161     MOVE 'ELCNTL' TO DFHEIV1
  3162*    MOVE '&"IL       E          (  N#00003034' TO DFHEIV0
  3163     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3164     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3165     MOVE X'204E233030303033303334' TO DFHEIV0(25:11)
  3166     CALL 'kxdfhei1' USING DFHEIV0,
  3167           DFHEIV1,
  3168           control-file,
  3169           DFHEIV11,
  3170           elcntl-key,
  3171           DFHEIV99,
  3172           DFHEIV99,
  3173           DFHEIV99
  3174     MOVE EIBRESP  TO ws-response
  3175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3176     if resp-normal
  3177        display ' good cntl read '
  3178        move cf-cr-month-end-dt  to ws-bin-eom-dt
  3179        move cf-company-cd       to ws-comp-cd
  3180     else
  3181        move 'Company Rec not found ' to output-msg
  3182        display ' error elcntl read ' ws-response ' '
  3183           elcntl-key (1:8)
  3184        go to 0000-return
  3185     end-if
  3186     perform 0010-connect-db     thru 0010-exit
  3187     perform 0020-process-remit  thru 0020-exit
  3188     perform 0050-open-cursor    thru 0050-exit
  3189     perform 0060-process-input  thru 0060-exit
  3190     perform 0130-start-edit     thru 0130-exit
  3191     perform 0226-update-remit-table
  3192                                 thru 0226-exit
  3193     perform 0225-commit-work    thru 0225-exit
  3194     .
  3195 0000-return.
  3196     if connected-to-db
  3197        perform 0230-disconnect  thru 0230-exit
  3198     end-if
  3199     perform 0220-send-form      thru 0220-exit
  3200     if rollback-needed
  3201        display ' executing roll back '
  3202        perform 0005-rollback    thru 0005-exit
  3203*       CALL 'kixvsam' USING ROLL-BACK
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  57
* EL202.cbl
  3204*       exec cics syncpoint
  3205*          rollback
  3206*          resp (ws-response)
  3207*       end-exec
  3208*       display ' rollback resp ' ws-response
  3209     end-if
  3210
  3211* exec cics
  3212*       return
  3213*    end-exec
  3214*    MOVE '.(                    ''   #00003074' TO DFHEIV0
  3215     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3216     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3217     MOVE X'2020233030303033303734' TO DFHEIV0(25:11)
  3218     CALL 'kxdfhei1' USING DFHEIV0,
  3219           DFHEIV99,
  3220           DFHEIV99,
  3221           DFHEIV99,
  3222           DFHEIV99,
  3223           DFHEIV99,
  3224           DFHEIV99
  3225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3226
  3227* goback
  3228
  3229     MOVE '9%                    "   ' TO DFHEIV0
  3230     MOVE 'EL202' TO DFHEIV1
  3231     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3232     goback
  3233     .
  3234 0005-rollback.
  3235     if ws-rb-erpyaj-key not = spaces
  3236        move ws-rb-erpyaj-key    to py-control-primary
  3237
  3238* EXEC CICS DELETE
  3239*          DATASET  ('ERPYAJ')
  3240*          RIDFLD   (PY-CONTROL-PRIMARY)
  3241*          resp     (ws-response)
  3242*       END-EXEC
  3243     MOVE 'ERPYAJ' TO DFHEIV1
  3244*    MOVE '&(  R                 &  N#00003082' TO DFHEIV0
  3245     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3246     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3247     MOVE X'204E233030303033303832' TO DFHEIV0(25:11)
  3248     CALL 'kxdfhei1' USING DFHEIV0,
  3249           DFHEIV1,
  3250           PY-CONTROL-PRIMARY,
  3251           DFHEIV99,
  3252           DFHEIV99,
  3253           DFHEIV99
  3254     MOVE EIBRESP  TO ws-response
  3255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3256        if resp-normal
  3257           display ' good delete on erpyaj '
  3258        else
  3259           display ' bad delete on erpyaj ' ws-response
  3260        end-if
  3261     end-if
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  58
* EL202.cbl
  3262     if ws-batch-no not = zeros
  3263        move ws-comp-cd          to pb-company-cd
  3264        move ws-batch-no         to pb-entry-batch
  3265        move +0                  to pb-batch-seq-no
  3266                                    pb-batch-chg-seq-no
  3267
  3268* exec cics delete
  3269*          dataset   ('ERPNDB')
  3270*          ridfld    (pb-control-primary)
  3271*          keylength (7)
  3272*          generic
  3273*          resp     (ws-response)
  3274*       end-exec
  3275     MOVE 'ERPNDB' TO DFHEIV1
  3276     MOVE 7
  3277       TO DFHEIV11
  3278*    MOVE '&(  RKG               &  N#00003098' TO DFHEIV0
  3279     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  3280     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3281     MOVE X'204E233030303033303938' TO DFHEIV0(25:11)
  3282     CALL 'kxdfhei1' USING DFHEIV0,
  3283           DFHEIV1,
  3284           pb-control-primary,
  3285           DFHEIV11,
  3286           DFHEIV99,
  3287           DFHEIV99
  3288     MOVE EIBRESP  TO ws-response
  3289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3290        if resp-normal
  3291           display ' good delete on erpndb '
  3292        else
  3293           display ' bad delete on erpndp ' ws-response
  3294        end-if
  3295     end-if
  3296     if ws-batch-no not = zeros
  3297        move ws-comp-cd          to pm-company-cd
  3298        move ws-batch-no         to pm-entry-batch
  3299        move +0                  to pm-batch-seq-no
  3300                                    pm-batch-chg-seq-no
  3301
  3302* exec cics delete
  3303*          dataset   ('ERPNDM')
  3304*          ridfld    (pm-control-primary)
  3305*          keylength (7)
  3306*          generic
  3307*          resp     (ws-response)
  3308*       end-exec
  3309     MOVE 'ERPNDM' TO DFHEIV1
  3310     MOVE 7
  3311       TO DFHEIV11
  3312*    MOVE '&(  RKG               &  N#00003116' TO DFHEIV0
  3313     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  3314     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3315     MOVE X'204E233030303033313136' TO DFHEIV0(25:11)
  3316     CALL 'kxdfhei1' USING DFHEIV0,
  3317           DFHEIV1,
  3318           pm-control-primary,
  3319           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  59
* EL202.cbl
  3320           DFHEIV99,
  3321           DFHEIV99
  3322     MOVE EIBRESP  TO ws-response
  3323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3324        if resp-normal
  3325           display ' good delete on erpndm '
  3326        else
  3327           display ' bad delete on erpndm ' ws-response
  3328        end-if
  3329     end-if
  3330     .
  3331 0005-exit.
  3332     exit.
  3333 0010-CONNECT-DB.
  3334***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3335***                                                            ***
  3336***  Even though it's on ntcso2, CUConnect is the test DB      ***
  3337***  The production DB is ezLink_Prod.  The table names are    ***
  3338***  the same.                                                 ***
  3339***                                                            ***
  3340***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3341     move 'NTCSO2_CUConnect'     to svr
  3342     move 'sa'                   to usr
  3343     move 'ntcso2'               to pass
  3344     if ws-kix-myenv = 'cid1p'
  3345        move 'NTCSO2_ezLink_Prod' to svr
  3346        move 'sa'                to usr
  3347        move 'ntcso2'            to pass
  3348     end-if
  3349     string
  3350         usr delimited space
  3351         "." delimited size
  3352         pass delimited space into usr-pass
  3353     end-string
  3354     display ' About to connect to ' svr ' ' usr-pass
  3355     EXEC SQL
  3356        CONNECT TO :svr USER :usr-pass
  3357     END-EXEC
  3358     if sqlcode not = 0
  3359        display "Error: cannot connect to " svr
  3360        display sqlcode
  3361        display sqlerrmc
  3362        move 'Failed to connect to DB'
  3363                                 to output-msg
  3364        go to 0000-return
  3365     else
  3366        set connected-to-db to true
  3367        display ' Successful Connect ' sqlcode
  3368     end-if
  3369     .
  3370 0010-EXIT.
  3371     EXIT.
  3372 0020-process-remit.
  3373     perform 0030-get-tbl-row    thru 0030-exit
  3374     perform 0040-build-erpyaj   thru 0040-exit
  3375     .
  3376 0020-exit.
  3377     exit.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  60
* EL202.cbl
  3378 0030-get-tbl-row.
  3379***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3380***                                                            ***
  3381***  I'm only expecting one row so no cursor is declared       ***
  3382***                                                            ***
  3383***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3384     display ' about to get table row ' ws-remit-id
  3385     move ' '                    to ws-remit-sw
  3386*    exec sql
  3387*       SELECT
  3388*          RemitId,
  3389*          Carrier,
  3390*          Group,
  3391*          State,
  3392*          AccountNumber,
  3393*          Name,
  3394*          Addr1,
  3395*          Addr2,
  3396*          AddrCity,
  3397*          AddrState,
  3398*          AddrZIP,
  3399*          ResponsibleCarrier,
  3400*          ResponsibleNumber,
  3401*          LogicStatus,
  3402*          LogicStatusDate,
  3403*          Company,
  3404*          TotalPremium
  3405*       INTO
  3406*          :sql-py-RemitId,
  3407*          :sql-py-Carrier,
  3408*          :sql-py-Group,
  3409*          :sql-py-State,
  3410*          :sql-py-AccountNumber,
  3411*          :sql-py-Name,
  3412*          :sql-py-Addr1,
  3413*          :sql-py-Addr2,
  3414*          :sql-py-AddrCity,
  3415*          :sql-py-AddrState,
  3416*          :sql-py-AddrZIP,
  3417*          :sql-py-ResponsibleCarrier,
  3418*          :sql-py-ResponsibleNumber,
  3419*          :sql-py-LogicStatus,
  3420*          :sql-py-LogicStatusDate,
  3421*          :sql-py-company,
  3422*          :sql-py-tot-prem
  3423*       FROM
  3424*          CUC_Logic_Remittance
  3425*       WHERE
  3426*          RemitId = :ws-remit-id
  3427*    end-exec
  3428     exec sql
  3429        SELECT
  3430           CUC_Logic_Remittance.RemitId,
  3431           Carrier,
  3432           [Group],
  3433           [State],
  3434           AccountNumber,
  3435           Name,
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  61
* EL202.cbl
  3436           Addr1,
  3437           Addr2,
  3438           AddrCity,
  3439           AddrState,
  3440           AddrZIP,
  3441           ResponsibleCarrier,
  3442           ResponsibleNumber,
  3443           LogicStatus,
  3444           Company,
  3445           TotalPremium,
  3446           CUC_Remittance.IsACH
  3447        INTO
  3448           :sql-py-RemitId,
  3449           :sql-py-Carrier,
  3450           :sql-py-Group,
  3451           :sql-py-State,
  3452           :sql-py-AccountNumber,
  3453           :sql-py-Name,
  3454           :sql-py-Addr1,
  3455           :sql-py-Addr2,
  3456           :sql-py-AddrCity,
  3457           :sql-py-AddrState,
  3458           :sql-py-AddrZIP,
  3459           :sql-py-ResponsibleCarrier,
  3460           :sql-py-ResponsibleNumber,
  3461           :sql-py-LogicStatus,
  3462           :sql-py-company,
  3463           :sql-py-tot-prem,
  3464           :sql-is-ach
  3465        FROM
  3466           CUC_Logic_Remittance inner join CUC_Remittance on
  3467              CUC_Logic_Remittance.RemitId =
  3468                 CUC_Remittance.RemitId
  3469        WHERE
  3470           CUC_Logic_Remittance.RemitId = :ws-remit-id
  3471     end-exec
  3472     if sqlcode not = 0
  3473        set ws-remit-not-found   to true
  3474        move sqlcode             to ws-sql-code
  3475        move ws-sql-code         to ws-dis-sql-code
  3476        display ' dis sql code ' ws-dis-sql-code
  3477        display "Error: cannot read row "
  3478        display ' sql return code ' sqlcode
  3479        display ' sql err mess    ' sqlerrmc
  3480        move ' Remittance Not Found '
  3481                                 to output-msg
  3482        go to 0000-return
  3483     end-if
  3484     display ' good get on table ' sqlcode
  3485     if sql-py-LogicStatus = 2
  3486        move 'Remit previously processed '
  3487                                 to output-msg
  3488        go to 0000-return
  3489     end-if
  3490     .
  3491 0030-exit.
  3492     exit.
  3493 0040-build-erpyaj.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  62
* EL202.cbl
  3494     compute work-seq-no = ws-work-time * 3
  3495     MOVE 'PY'                   TO pending-pay-adj
  3496     move zeros                  to py-file-seq-no
  3497                                    py-last-maint-hhmmss
  3498                                    py-entry-amt
  3499                                    py-check-que-control
  3500                                    py-check-que-sequence
  3501     move low-values             to py-last-maint-dt
  3502                                    py-credit-select-dt
  3503                                    py-credit-accept-dt
  3504                                    py-billed-date
  3505                                    py-reported-dt
  3506                                    py-input-dt
  3507                                    py-check-written-dt
  3508                                    py-ar-date
  3509                                    py-gl-date
  3510     MOVE cf-COMPANY-CD          TO PY-COMPANY-CD
  3511     MOVE sql-py-responsiblecarrier
  3512                                 TO PY-CARRIER
  3513     MOVE sql-py-group           TO PY-GROUPING
  3514     MOVE sql-py-responsiblenumber
  3515                                 TO PY-FIN-RESP
  3516     MOVE sql-py-accountnumber   TO PY-ACCOUNT
  3517     ADD +1                      TO WORK-SEQ-NO.
  3518     MOVE WORK-SEQ-NO            TO PY-FILE-SEQ-NO.
  3519     move 'R'                    to py-record-type
  3520     move 'E202'                 to py-last-maint-by
  3521     move ws-bin-current-dt      to py-last-maint-dt
  3522                                    py-input-dt
  3523     move ws-work-time           to py-last-maint-hhmmss
  3524*    move +20.00                 to py-entry-amt
  3525     move ws-bin-eom-dt          to py-credit-select-dt
  3526     move 'A'                    to py-ercomp-type
  3527     move sql-is-ach             to ws-bit
  3528     display ' bit comp ' ws-bit-comp
  3529     evaluate true
  3530        when (ws-comp-id = 'DCC')
  3531           and (py-carrier = '9')
  3532           and (ws-bit-comp = zeros)      *> ACH FALSE
  3533           move '2725040310'     to py-gl-account
  3534        when (ws-comp-id = 'DCC')
  3535           and (py-carrier = '7')
  3536           and (ws-bit-comp not = zeros)  *> ACH TRUE
  3537           move '1108121010'     to py-gl-account
  3538        when (ws-comp-id = 'DCC')
  3539           and (py-carrier = '9')
  3540           and (ws-bit-comp not = zeros)  *> ACH TRUE
  3541           move '1108121250'     to py-gl-account
  3542        when (ws-comp-id = 'CID')
  3543           and (ws-bit-comp not = zeros)  *> ACH TRUE
  3544           move '1108124700'     to py-gl-account
  3545        when (ws-comp-id = 'DCC')
  3546           move '1825013400'     to py-gl-account
  3547        when other
  3548           move '1825099050'     to py-gl-account
  3549     end-evaluate
  3550     if ws-bit-comp not = zeros     *>  ACH TRUE
  3551        move 'ACH'               to py-gl-comment
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  63
* EL202.cbl
  3552     end-if
  3553*    if ws-comp-id = 'CID'
  3554*       move '1825099050'        to py-gl-account
  3555*    else
  3556*       move '1825013400'        to py-gl-account
  3557*    end-if
  3558     move +11                    to s2
  3559     move zeros                  to ws-work-amt-alpha
  3560     perform varying s1 from +11 by -1 until s1 < +1
  3561        if sql-py-tot-prem (s1:1) numeric
  3562           move sql-py-tot-prem (s1:1)
  3563                                 to ws-work-amt-alpha (s2:1)
  3564           subtract +1 from s2
  3565        end-if
  3566     end-perform
  3567     display ' tot premium ' ws-work-amt-num
  3568     move ws-work-amt-num        to py-entry-amt
  3569     .
  3570 0040-write.
  3571     display ' about to write pyaj '
  3572
  3573* EXEC CICS WRITE
  3574*        DATASET  ('ERPYAJ')
  3575*        FROM     (PENDING-PAY-ADJ)
  3576*        RIDFLD   (PY-CONTROL-PRIMARY)
  3577*        resp     (ws-response)
  3578*    END-EXEC
  3579     MOVE LENGTH OF
  3580      PENDING-PAY-ADJ
  3581       TO DFHEIV11
  3582     MOVE 'ERPYAJ' TO DFHEIV1
  3583*    MOVE '&$ L                  ''  N#00003371' TO DFHEIV0
  3584     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3585     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3586     MOVE X'204E233030303033333731' TO DFHEIV0(25:11)
  3587     CALL 'kxdfhei1' USING DFHEIV0,
  3588           DFHEIV1,
  3589           PENDING-PAY-ADJ,
  3590           DFHEIV11,
  3591           PY-CONTROL-PRIMARY,
  3592           DFHEIV99,
  3593           DFHEIV99
  3594     MOVE EIBRESP  TO ws-response
  3595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3596     if resp-normal
  3597        move py-control-primary  to ws-rb-erpyaj-key
  3598        move 2                   to ws-status-code
  3599     else
  3600        if resp-duprec
  3601           add +1                to py-file-seq-no
  3602           go to 0040-write
  3603        else
  3604           move 3                to ws-status-code
  3605           move ws-response      to ws-display-response
  3606           move spaces           to ws-error-message
  3607           string ' Bad write on ERPYAJ FILE ' ws-display-response
  3608              delimited by size into ws-error-message
  3609           end-string
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  64
* EL202.cbl
  3610           perform 0226-update-remit-table
  3611                                 thru 0226-exit
  3612           perform 0225-commit-work
  3613                                 thru 0225-exit
  3614           go to 0000-return
  3615        end-if
  3616     end-if
  3617     .
  3618 0040-exit.
  3619     exit.
  3620 0050-open-cursor.
  3621*    display ' declare cursor ' ws-begin-dt ' ' ws-end-dt
  3622***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3623***                                                            ***
  3624***  The dates on the sql table have values in the time        ***
  3625***  so I convert it to a string and just use mm/dd/yyyy       ***
  3626***  to perform the comparison.                                ***
  3627***                                                            ***
  3628***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3629     EXEC SQL
  3630        DECLARE
  3631           remitcerts cursor for
  3632        SELECT
  3633           CertId,
  3634           RemitId,
  3635           CertNumber,
  3636           EffectiveDate,
  3637           FirstPaymentDate,
  3638           FirstName,
  3639           LastName,
  3640           CashIndicator,
  3641           LivesCovered,
  3642           LfBenCode,
  3643           LfTerm,
  3644           LfBenefit,
  3645           LfPremium,
  3646           AhBenCode,
  3647           AhTerm,
  3648           AhBenefit,
  3649           AhPremium,
  3650           ErrorMessage
  3651        FROM
  3652           CUC_Logic_Remittance_Cert
  3653        WHERE
  3654           RemitId = :ws-remit-id
  3655     end-exec
  3656     if sqlcode not = 0
  3657        display "Error: cannot declare cursor "
  3658        display ' sql retrun code ' sqlcode
  3659        display ' sql err mess    ' sqlerrmc
  3660        move ' Error declaring cursor '
  3661                                 to output-msg
  3662        move 3                   to ws-status-code
  3663        move sqlcode             to ws-display-response
  3664        move spaces              to ws-error-message
  3665        string ' Error declaring cursor   ' ws-display-response
  3666           delimited by size into ws-error-message
  3667        end-string
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  65
* EL202.cbl
  3668        perform 0226-update-remit-table
  3669                                 thru 0226-exit
  3670        perform 0225-commit-work thru 0225-exit
  3671        go to 0000-return
  3672     end-if
  3673     display ' good declare cursor ' ws-remit-id
  3674     EXEC SQL
  3675        open remitcerts
  3676     END-EXEC
  3677     if sqlcode not = 0
  3678        display "Error: cannot open cursor "
  3679        display ' sql retrun code ' sqlcode
  3680        display ' sql err mess    ' sqlerrmc
  3681        move ' Error opening cursor '
  3682                                 to output-msg
  3683        move 3                   to ws-status-code
  3684        move sqlcode             to ws-display-response
  3685        move spaces              to ws-error-message
  3686        string ' Error openning cursor    ' ws-display-response
  3687           delimited by size into ws-error-message
  3688        end-string
  3689        perform 0226-update-remit-table
  3690                                 thru 0226-exit
  3691        perform 0225-commit-work thru 0225-exit
  3692        go to 0000-return
  3693     end-if
  3694     display ' good open cursor ' ws-remit-id
  3695     .
  3696 0050-exit.
  3697     exit.
  3698 0060-process-input.
  3699     perform until sqlcode not = 0
  3700        EXEC SQL
  3701           fetch remitcerts into
  3702              :sql-pb-CertId,
  3703              :sql-pb-RemitId,
  3704              :sql-pb-CertNumber,
  3705              :sql-pb-EffectiveDate,
  3706              :sql-pb-FirstPaymentDate,
  3707              :sql-pb-FirstName,
  3708              :sql-pb-LastName,
  3709              :sql-pb-CashIndicator,
  3710              :sql-pb-LivesCovered,
  3711              :sql-pb-LfBenCode,
  3712              :sql-pb-LfTerm,
  3713              :sql-pb-LfBenefit,
  3714              :sql-pb-LfPremium,
  3715              :sql-pb-AhBenCode,
  3716              :sql-pb-AhTerm,
  3717              :sql-pb-AhBenefit,
  3718              :sql-pb-AhPremium,
  3719              :sql-pb-ErrorMessage
  3720        END-EXEC
  3721        if sqlcode = 0
  3722           perform 0070-bld-erpndb
  3723                                 thru 0070-exit
  3724           perform 0110-write-erpndb
  3725                                 thru 0110-exit
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  66
* EL202.cbl
  3726           perform 0120-write-erpndm
  3727                                 thru 0120-exit
  3728        else
  3729           if sqlcode not = 0 and 100
  3730              display "Error: cannot fetch row "
  3731              display ' sql return code ' sqlcode
  3732              display ' sql err mess    ' sqlerrmc
  3733              move ' Error fetching cursor '
  3734                                 to output-msg
  3735              set rollback-needed to true
  3736              move 3             to ws-status-code
  3737              move sqlcode       to ws-display-response
  3738              move spaces        to ws-error-message
  3739              string ' Error during fetch cursor '
  3740                ws-display-response
  3741                 delimited by size into ws-error-message
  3742              end-string
  3743              perform 0226-update-remit-table
  3744                                 thru 0226-exit
  3745              perform 0225-commit-work
  3746                                 thru 0225-exit
  3747              go to 0000-return
  3748           end-if
  3749        end-if
  3750     end-perform
  3751     if sqlcode = 100
  3752        display ' Normal end of record set '
  3753        perform 0100-build-batch-hdr
  3754                                 thru 0100-exit
  3755        perform 0110-write-erpndb
  3756                                 thru 0110-exit
  3757     end-if
  3758     EXEC SQL
  3759         close remitcerts
  3760     END-EXEC
  3761     if sqlcode not = 0
  3762        display "Error: cannot close cursor "
  3763        display ' sql retrun code ' sqlcode
  3764        display ' sql err mess    ' sqlerrmc
  3765     end-if
  3766     .
  3767 0060-exit.
  3768     exit.
  3769 0070-bld-erpndb.
  3770     if ws-batch-no-n = zeros
  3771        perform 0080-get-batch-no thru 0080-exit
  3772     end-if
  3773     move ws-init-erpndb-rec     to pending-business
  3774     move ws-batch-no            to pb-entry-batch
  3775                                    pb-original-entry-batch
  3776                                    pb-csr-entry-batch
  3777     add +1 to ws-batch-seq-no
  3778     move ws-batch-seq-no        to pb-batch-seq-no
  3779                                    pb-original-seq-no
  3780                                    pb-csr-batch-seq-no
  3781     move sql-pb-certnumber      to pb-cert-no
  3782     string sql-pb-effectivedate (1:4)
  3783            sql-pb-effectivedate (6:2)
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  67
* EL202.cbl
  3784            sql-pb-effectivedate (9:2)
  3785        delimited by size into dc-greg-date-cymd-r
  3786     end-string
  3787     move 'L'                    to dc-option-code
  3788     perform 9700-date-convert   thru 9700-exit
  3789     if no-conversion-error
  3790        move dc-bin-date-1       to pb-cert-eff-dt
  3791     else
  3792        display ' error cvtdte eff dt ' sql-pb-effectivedate
  3793           ' ' dc-error-code
  3794     end-if
  3795     move function upper-case(sql-pb-lastname)
  3796                                 to pb-i-insured-last-name
  3797     move function upper-case(sql-pb-firstname)
  3798                                 to pb-i-insured-first-name
  3799     if sql-pb-lfbencode = zeros
  3800        move spaces              to sql-pb-lfbencode
  3801     end-if
  3802     move sql-pb-lfbencode       to pb-i-life-benefit-cd
  3803                                    pb-i-lf-input-cd
  3804     if pb-i-life-benefit-cd = spaces
  3805        move zeros               to pb-i-life-benefit-cd
  3806     end-if
  3807     move sql-pb-lfterm          to pb-i-lf-term
  3808     move 'L'                    to pb-ah-override-l1
  3809     move +11                    to s2
  3810     move zeros                  to ws-work-amt-alpha
  3811     perform varying s1 from +12 by -1 until s1 < +1
  3812        if sql-pb-lfbenefit (s1:1) numeric
  3813           move sql-pb-lfbenefit (s1:1)
  3814                                 to ws-work-amt-alpha (s2:1)
  3815           subtract +1 from s2
  3816        end-if
  3817     end-perform
  3818     display ' lf benefit  ' ws-work-amt-num
  3819     move ws-work-amt-num        to pb-i-lf-benefit-amt
  3820     move +11                    to s2
  3821     move zeros                  to ws-work-amt-alpha
  3822     perform varying s1 from +10 by -1 until s1 < +1
  3823        if sql-pb-lfpremium (s1:1) numeric
  3824           move sql-pb-lfpremium (s1:1)
  3825                                 to ws-work-amt-alpha (s2:1)
  3826           subtract +1 from s2
  3827        end-if
  3828     end-perform
  3829     display ' lf premium  ' ws-work-amt-num
  3830     move ws-work-amt-num        to pb-i-lf-premium-amt
  3831     if sql-pb-ahbencode = zeros
  3832        move spaces              to sql-pb-ahbencode
  3833     end-if
  3834     move sql-pb-ahbencode       to pb-i-ah-benefit-cd
  3835                                    pb-i-ah-input-cd
  3836     if pb-i-ah-benefit-cd = spaces
  3837        move zeros               to pb-i-ah-benefit-cd
  3838     end-if
  3839     move 'A'                    to pb-ah-override-l1
  3840     move sql-pb-ahterm          to pb-i-ah-term
  3841     move +11                    to s2
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  68
* EL202.cbl
  3842     move zeros                  to ws-work-amt-alpha
  3843     perform varying s1 from +10 by -1 until s1 < +1
  3844        if sql-pb-ahbenefit (s1:1) numeric
  3845           move sql-pb-ahbenefit (s1:1)
  3846                                 to ws-work-amt-alpha (s2:1)
  3847           subtract +1 from s2
  3848        end-if
  3849     end-perform
  3850     display ' ah benefit  ' ws-work-amt-num
  3851     move ws-work-amt-num        to pb-i-ah-benefit-amt
  3852     move +11                    to s2
  3853     move zeros                  to ws-work-amt-alpha
  3854     perform varying s1 from +10 by -1 until s1 < +1
  3855        if sql-pb-ahpremium (s1:1) numeric
  3856           move sql-pb-ahpremium (s1:1)
  3857                                 to ws-work-amt-alpha (s2:1)
  3858           subtract +1 from s2
  3859        end-if
  3860     end-perform
  3861     display ' ah premium  ' ws-work-amt-num
  3862     move ws-bin-eom-dt          to pb-credit-select-dt
  3863     move ws-work-amt-num        to pb-i-ah-premium-amt
  3864     move sql-pb-LivesCovered    to pb-i-lives
  3865     move sql-pb-CashIndicator   to pb-i-entry-status
  3866                                    pb-batch-entry
  3867     compute ws-lf-iss-premium =
  3868        ws-lf-iss-premium + pb-i-lf-premium-amt
  3869     compute ws-ah-iss-premium =
  3870        ws-ah-iss-premium + pb-i-ah-premium-amt
  3871     move 'A'                    to pb-force-code
  3872     compute ws-iss-cnt = ws-iss-cnt + +1
  3873     move pb-batch-seq-no           to ws-highest-seq-no
  3874*    display ' sql-pb-CertId           ' sql-pb-CertId
  3875*    display ' sql-pb-RemitId          ' sql-pb-RemitId
  3876*    display ' sql-pb-CertNumber       ' sql-pb-CertNumber
  3877*    display ' sql-pb-EffectiveDate    ' sql-pb-EffectiveDate
  3878*    display ' sql-pb-FirstPaymentDate ' sql-pb-FirstPaymentDate
  3879*    display ' sql-pb-FirstName        ' sql-pb-FirstName
  3880*    display ' sql-pb-LastName         ' sql-pb-LastName
  3881*    display ' sql-pb-CashIndicator    ' sql-pb-CashIndicator
  3882*    display ' sql-pb-LivesCovered     ' sql-pb-LivesCovered
  3883*    display ' sql-pb-LfBenCode        ' sql-pb-LfBenCode
  3884*    display ' sql-pb-LfTerm           ' sql-pb-LfTerm
  3885*    display ' sql-pb-LfBenefit        ' sql-pb-LfBenefit
  3886*    display ' sql-pb-LfPremium        ' sql-pb-LfPremium
  3887*    display ' sql-pb-AhBenCode        ' sql-pb-AhBenCode
  3888*    display ' sql-pb-AhTerm           ' sql-pb-AhTerm
  3889*    display ' sql-pb-AhBenefit        ' sql-pb-AhBenefit
  3890*    display ' sql-pb-AhPremium        ' sql-pb-AhPremium
  3891*    display ' sql-pb-ErrorMessage     ' sql-pb-ErrorMessage
  3892     .
  3893 0070-exit.
  3894     exit.
  3895 0080-get-batch-no.
  3896     perform 0090-init-erpndb    thru 0090-exit
  3897     perform 0240-init-erpndm    thru 0240-exit
  3898     move ws-comp-id             to elcntl-key
  3899     move '1'                    to elcntl-rec-type
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  69
* EL202.cbl
  3900     move +0                     to elcntl-seq
  3901
  3902* exec cics read update
  3903*       dataset  ('ELCNTL')
  3904*       into     (control-file)
  3905*       ridfld   (elcntl-key)
  3906*       resp     (ws-response)
  3907*    end-exec
  3908     MOVE LENGTH OF
  3909      control-file
  3910       TO DFHEIV11
  3911     MOVE 'ELCNTL' TO DFHEIV1
  3912*    MOVE '&"IL       EU         (  N#00003682' TO DFHEIV0
  3913     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3914     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3915     MOVE X'204E233030303033363832' TO DFHEIV0(25:11)
  3916     CALL 'kxdfhei1' USING DFHEIV0,
  3917           DFHEIV1,
  3918           control-file,
  3919           DFHEIV11,
  3920           elcntl-key,
  3921           DFHEIV99,
  3922           DFHEIV99,
  3923           DFHEIV99
  3924     MOVE EIBRESP  TO ws-response
  3925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3926     if resp-normal
  3927        add +1                   to cf-last-batch-no
  3928        move cf-last-batch-no    to ws-batch-no-n
  3929        move +0                  to ws-batch-seq-no
  3930
  3931* exec cics rewrite
  3932*          dataset  ('ELCNTL')
  3933*          from     (control-file)
  3934*          resp     (ws-response)
  3935*       end-exec
  3936     MOVE LENGTH OF
  3937      control-file
  3938       TO DFHEIV11
  3939     MOVE 'ELCNTL' TO DFHEIV1
  3940*    MOVE '&& L                  %  N#00003692' TO DFHEIV0
  3941     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3942     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3943     MOVE X'204E233030303033363932' TO DFHEIV0(25:11)
  3944     CALL 'kxdfhei1' USING DFHEIV0,
  3945           DFHEIV1,
  3946           control-file,
  3947           DFHEIV11,
  3948           DFHEIV99
  3949     MOVE EIBRESP  TO ws-response
  3950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3951        if not resp-normal
  3952           display ' bad rewrite on cntl - batch no '
  3953              ws-batch-no-n
  3954           move ' Error rewrite ELCNTL '
  3955                                 to output-msg
  3956           set rollback-needed   to true
  3957           move ws-response         to ws-display-response
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  70
* EL202.cbl
  3958           move spaces              to ws-error-message
  3959           string ' Bad rewrite  ELCNTL FILE '
  3960              ws-display-response
  3961              delimited by size into ws-error-message
  3962           end-string
  3963           move 3                to ws-status-code
  3964           perform 0226-update-remit-table
  3965                                 thru 0226-exit
  3966           perform 0225-commit-work
  3967                                 thru 0225-exit
  3968           go to 0000-return
  3969        end-if
  3970     else
  3971        display ' bad read upde on cntl - batch no '
  3972              elcntl-key (1:4)
  3973     end-if
  3974     .
  3975 0080-exit.
  3976     exit.
  3977 0090-init-erpndb.
  3978     move 'PB'                   to pending-business
  3979     INITIALIZE PB-issue-RECORD
  3980     initialize pb-record-status
  3981     move low-values             to pb-i-lf-expire-dt
  3982                                    pb-i-ah-expire-dt
  3983                                    pb-i-1st-pmt-dt
  3984                                    pb-i-last-add-on-dt
  3985                                    pb-i-birthday
  3986                                    pb-i-joint-birthday
  3987                                    pb-credit-select-dt
  3988                                    pb-credit-accept-dt
  3989                                    pb-billed-dt
  3990                                    pb-input-dt
  3991                                    pb-acct-eff-dt
  3992                                    pb-acct-exp-dt
  3993                                    pb-confirmation-rept-dt
  3994                                    pb-ga-bill-dt (1)
  3995                                    pb-ga-bill-dt (2)
  3996                                    pb-ga-bill-dt (3)
  3997                                    pb-ga-bill-dt (4)
  3998                                    pb-ga-bill-dt (5)
  3999     move ws-comp-id             to pb-company-id
  4000     move ws-comp-cd             to pb-company-cd
  4001                                    pb-company-cd-a1
  4002                                    pb-original-company-cd
  4003                                    pb-csr-company-cd
  4004     move zeros                  to pb-chg-count
  4005                                    pb-batch-chg-seq-no
  4006                                    pb-alt-chg-seq-no
  4007                                    pb-original-chg-seq-no
  4008                                    pb-csr-batch-chg-seq-no
  4009                                    pb-i-rate-deviation-lf
  4010                                    pb-i-rate-deviation-ah
  4011                                    pb-no-of-errors
  4012                                    pb-lf-billed-amts
  4013                                    pb-ah-billed-amts
  4014     move sql-py-carrier         to pb-carrier
  4015                                    pb-sv-carrier
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  71
* EL202.cbl
  4016     move sql-py-group           to pb-grouping
  4017                                    pb-sv-grouping
  4018     move sql-py-state           to pb-state
  4019                                    pb-sv-state
  4020     move sql-py-accountnumber   to pb-account
  4021     move '1'                    to pb-record-type
  4022     move 'E202'                 to pb-last-maint-by
  4023                                    pb-input-by
  4024     move ws-bin-current-dt      to pb-last-maint-dt
  4025                                    pb-input-dt
  4026     move ws-work-time           to pb-last-maint-hhmmss
  4027     perform varying s1 from +1 by +1 until s1 > +10
  4028        move +0                  to pb-common-error (s1)
  4029     end-perform
  4030     move pending-business       to ws-init-erpndb-rec
  4031     .
  4032 0090-exit.
  4033     exit.
  4034 0100-BUILD-BATCH-HDR.
  4035     display ' about to build batch hdr '
  4036     move ws-init-erpndb-rec     to pending-business
  4037     move ws-batch-no            to pb-entry-batch
  4038                                    pb-original-entry-batch
  4039                                    pb-csr-entry-batch
  4040                                    pb-cert-no
  4041     add +1 to ws-batch-seq-no
  4042     move 9999                   to pb-batch-seq-no
  4043                                    pb-original-seq-no
  4044                                    pb-csr-batch-seq-no
  4045     move high-values            to pb-cert-eff-dt
  4046     move zeros                  to PB-B-LF-ISS-PRM-REMITTED
  4047                                    PB-B-LF-ISS-PRM-ENTERED
  4048                                    PB-B-LF-ISS-PRM-COMPUTED
  4049                                    PB-B-LF-CAN-PRM-REMITTED
  4050                                    PB-B-LF-CAN-PRM-ENTERED
  4051                                    PB-B-LF-CAN-PRM-COMPUTED
  4052                                    PB-B-AH-ISS-PRM-REMITTED
  4053                                    PB-B-AH-ISS-PRM-ENTERED
  4054                                    PB-B-AH-ISS-PRM-COMPUTED
  4055                                    PB-B-AH-CAN-PRM-REMITTED
  4056                                    PB-B-AH-CAN-PRM-ENTERED
  4057                                    PB-B-AH-CAN-PRM-COMPUTED
  4058                                    PB-B-ISSUE-CNT-REMITTED
  4059                                    PB-B-ISSUE-CNT-ENTERED
  4060                                    PB-B-CANCEL-CNT-REMITTED
  4061                                    PB-B-CANCEL-CNT-ENTERED
  4062                                    PB-B-HIGHEST-SEQ-NO
  4063                                    PB-LF-BILLED-AMTS
  4064                                    PB-AH-BILLED-AMTS
  4065                                    PB-CHG-COUNT
  4066                                    PB-CALC-TOLERANCE
  4067     move spaces                 to pb-account-name
  4068                                    pb-prem-ref-rpt-flag
  4069                                    pb-reference
  4070     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
  4071                                    PB-BILLED-DT
  4072                                    PB-ACCT-EFF-DT
  4073                                    PB-ACCT-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  72
* EL202.cbl
  4074     MOVE '9'                    TO PB-RECORD-TYPE
  4075     move ws-iss-cnt             to pb-b-issue-cnt-remitted
  4076     move ws-lf-iss-premium      to pb-b-lf-iss-prm-remitted
  4077     move ws-ah-iss-premium      to pb-b-ah-iss-prm-remitted
  4078     move ws-highest-seq-no      to pb-b-highest-seq-no
  4079     move ws-bin-current-dt      to pb-b-received-dt
  4080     move ws-bin-eom-dt          to pb-credit-select-dt
  4081     move function upper-case(sql-py-Name)
  4082                                 to PB-ACCOUNT-NAME
  4083     .
  4084 0100-EXIT.
  4085     EXIT.
  4086 0110-write-erpndb.
  4087     display ' about to write pend bus ' pb-record-type
  4088
  4089* EXEC CICS WRITE
  4090*        DATASET  ('ERPNDB')
  4091*        FROM     (PENDING-BUSINESS)
  4092*        RIDFLD   (PB-CONTROL-PRIMARY)
  4093*        RESP     (WS-RESPONSE)
  4094*    END-EXEC
  4095     MOVE LENGTH OF
  4096      PENDING-BUSINESS
  4097       TO DFHEIV11
  4098     MOVE 'ERPNDB' TO DFHEIV1
  4099*    MOVE '&$ L                  ''  N#00003834' TO DFHEIV0
  4100     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4101     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4102     MOVE X'204E233030303033383334' TO DFHEIV0(25:11)
  4103     CALL 'kxdfhei1' USING DFHEIV0,
  4104           DFHEIV1,
  4105           PENDING-BUSINESS,
  4106           DFHEIV11,
  4107           PB-CONTROL-PRIMARY,
  4108           DFHEIV99,
  4109           DFHEIV99
  4110     MOVE EIBRESP  TO WS-RESPONSE
  4111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4112     IF NOT RESP-NORMAL
  4113        DISPLAY ' ERPNDB BTCH WRITE ERROR ' WS-RESPONSE
  4114        move ' Error writing erpndb  '
  4115                           to output-msg
  4116        set rollback-needed to true
  4117        move ws-response         to ws-display-response
  4118        move spaces              to ws-error-message
  4119        string ' Bad write on ERPNDB FILE ' ws-display-response
  4120           delimited by size into ws-error-message
  4121        end-string
  4122        move 3             to ws-status-code
  4123        perform 0226-update-remit-table
  4124                           thru 0226-exit
  4125        perform 0225-commit-work
  4126                           thru 0225-exit
  4127        go to 0000-return
  4128     END-IF
  4129     .
  4130 0110-exit.
  4131     exit.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  73
* EL202.cbl
  4132 0120-write-erpndm.
  4133     display ' about to write pend mail '
  4134     move ws-init-erpndm         to pending-mailing-data
  4135     move pb-control-primary     to pm-control-primary
  4136     move function upper-case(sql-py-Name)
  4137                                 to PM-CRED-BENE-NAME
  4138     move function upper-case(sql-py-Addr1)
  4139                                 to PM-CRED-BENE-ADDR
  4140     move function upper-case(sql-py-Addr2)
  4141                                 to PM-CRED-BENE-ADDR2
  4142     move function upper-case(sql-py-AddrCity)
  4143                                 to PM-CRED-BENE-CITY
  4144     move function upper-case(sql-py-AddrState)
  4145                                 to pm-cred-bene-state
  4146     move sql-py-AddrZIP         to pm-cred-bene-zip
  4147
  4148* EXEC CICS WRITE
  4149*        DATASET  ('ERPNDM')
  4150*        FROM     (PENDING-MAILING-DATA)
  4151*        RIDFLD   (PM-CONTROL-PRIMARY)
  4152*        RESP     (WS-RESPONSE)
  4153*    END-EXEC
  4154     MOVE LENGTH OF
  4155      PENDING-MAILING-DATA
  4156       TO DFHEIV11
  4157     MOVE 'ERPNDM' TO DFHEIV1
  4158*    MOVE '&$ L                  ''  N#00003875' TO DFHEIV0
  4159     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4160     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4161     MOVE X'204E233030303033383735' TO DFHEIV0(25:11)
  4162     CALL 'kxdfhei1' USING DFHEIV0,
  4163           DFHEIV1,
  4164           PENDING-MAILING-DATA,
  4165           DFHEIV11,
  4166           PM-CONTROL-PRIMARY,
  4167           DFHEIV99,
  4168           DFHEIV99
  4169     MOVE EIBRESP  TO WS-RESPONSE
  4170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4171     IF NOT RESP-NORMAL
  4172        move ' Error writing erpndm  '
  4173                                 to output-msg
  4174        set rollback-needed to true
  4175        move ws-response         to ws-display-response
  4176        move spaces              to ws-error-message
  4177        string ' Bad write on ERPNDM FILE ' ws-display-response
  4178           delimited by size into ws-error-message
  4179        end-string
  4180        move 3                   to ws-status-code
  4181        perform 0226-update-remit-table
  4182                                 thru 0226-exit
  4183        perform 0225-commit-work
  4184                                 thru 0225-exit
  4185        go to 0000-return
  4186        DISPLAY ' ERPNDM WRITE ERROR ' WS-RESPONSE
  4187     END-IF
  4188     .
  4189 0120-exit.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  74
* EL202.cbl
  4190     exit.
  4191 0130-start-edit.
  4192     display ' about to start edit '
  4193     MOVE ws-comp-cd             TO EDIT-COMPANY-CD
  4194     MOVE WS-BATCH-NO            TO EDIT-BATCH
  4195     MOVE ws-comp-id             TO EDIT-COMPANY-ID
  4196     MOVE SPACES                 TO EDIT-RESTART-BATCH
  4197
  4198* EXEC CICS START
  4199*         TRANSID       ('EXEB')
  4200*         FROM          (BATCH-TO-PROCESS)
  4201*    END-EXEC
  4202     MOVE LENGTH OF
  4203      BATCH-TO-PROCESS
  4204       TO DFHEIV11
  4205     MOVE 'EXEB' TO DFHEIV5
  4206*    MOVE '0( LF                 1   #00003907' TO DFHEIV0
  4207     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  4208     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  4209     MOVE X'2020233030303033393037' TO DFHEIV0(25:11)
  4210     CALL 'kxdfhei1' USING DFHEIV0,
  4211           DFHEIV99,
  4212           DFHEIV5,
  4213           DFHEIV99,
  4214           BATCH-TO-PROCESS,
  4215           DFHEIV11,
  4216           DFHEIV99,
  4217           DFHEIV99,
  4218           DFHEIV99,
  4219           DFHEIV99,
  4220           DFHEIV99,
  4221           DFHEIV99,
  4222           DFHEIV99,
  4223           DFHEIV99,
  4224           DFHEIV99,
  4225           DFHEIV99,
  4226           DFHEIV99
  4227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4228
  4229* EXEC CICS DELAY
  4230*       INTERVAL    (02)
  4231*    END-EXEC
  4232     MOVE 02 TO DFHEIV10
  4233*    MOVE '0$I                   &   #00003911' TO DFHEIV0
  4234     MOVE X'302449202020202020202020' TO DFHEIV0(1:12)
  4235     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4236     MOVE X'2020233030303033393131' TO DFHEIV0(25:11)
  4237     CALL 'kxdfhei1' USING DFHEIV0,
  4238           DFHEIV10,
  4239           DFHEIV99,
  4240           DFHEIV99,
  4241           DFHEIV99,
  4242           DFHEIV99
  4243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4244     .
  4245 0130-exit.
  4246     exit.
  4247 0220-send-form.
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  75
* EL202.cbl
  4248     move ws-comp-id             to out-comp-id
  4249     move 'CU CONNECT '          to output-title
  4250     display ' about to send form '
  4251
  4252* exec cics document create
  4253*       doctoken   (w-doctoken)
  4254*       template   ('WCHECKS')
  4255*       symbollist (output-data)
  4256*       listlength (length of output-data)
  4257*    end-exec
  4258     MOVE 'WCHECKS'
  4259      TO DFHEIVL0
  4260     MOVE LENGTH OF
  4261      output-data TO DFHEIV16
  4262*    MOVE '\"D tSL               )   #00003921' TO DFHEIV0
  4263     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  4264     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4265     MOVE X'2020233030303033393231' TO DFHEIV0(25:11)
  4266     CALL 'kxdfhei1' USING DFHEIV0,
  4267           w-doctoken,
  4268           DFHEIV99,
  4269           DFHEIVL0,
  4270           output-data,
  4271           DFHEIV16,
  4272           DFHEIV99,
  4273           DFHEIV99,
  4274           DFHEIV99
  4275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4276
  4277* exec cics web send
  4278*       doctoken(w-doctoken)
  4279*    end-exec
  4280*    MOVE 'X$D                   *   #00003927' TO DFHEIV0
  4281     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  4282     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  4283     MOVE X'2020233030303033393237' TO DFHEIV0(25:11)
  4284     CALL 'kxdfhei1' USING DFHEIV0,
  4285           w-doctoken,
  4286           DFHEIV99,
  4287           DFHEIV99,
  4288           DFHEIV99,
  4289           DFHEIV99,
  4290           DFHEIV99,
  4291           DFHEIV99,
  4292           DFHEIV99,
  4293           DFHEIV99
  4294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4295     .
  4296 0220-exit.
  4297     exit.
  4298 0225-commit-work.
  4299     display ' about to commit work   '
  4300     if connected-to-db
  4301        EXEC SQL
  4302            commit work
  4303        END-EXEC
  4304     end-if
  4305     .
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  76
* EL202.cbl
  4306 0225-exit.
  4307     exit.
  4308 0226-update-remit-table.
  4309     if ws-batch-no = zeros
  4310        move -1                  to nu-batchno
  4311     else
  4312        move +0                  to nu-batchno
  4313     end-if
  4314     if ws-error-message = spaces
  4315        move -1                  to nu-error-message
  4316     else
  4317        move +0                  to nu-error-message
  4318     end-if
  4319     EXEC SQL
  4320        UPDATE
  4321           CUC_Logic_Remittance
  4322        SET
  4323           LogicStatus = :ws-status-code,
  4324           LogicStatusDate = :ws-status-date,
  4325           BatchNumber = :ws-batch-no :nu-batchno,
  4326           ErrorMessage = :ws-error-message :nu-error-message
  4327        WHERE
  4328           RemitId = :ws-remit-id
  4329     END-EXEC
  4330     .
  4331 0226-exit.
  4332     exit.
  4333 0230-disconnect.
  4334     display ' about to disconnect DB '
  4335     if connected-to-db
  4336        EXEC SQL
  4337            disconnect all
  4338        END-EXEC
  4339        move ' ' to ws-connect-sw
  4340     end-if
  4341     .
  4342 0230-exit.
  4343     exit.
  4344 0240-init-erpndm.
  4345     display ' made it to init pndm '
  4346     move spaces                 to pending-mailing-data
  4347     move 'PM'                   to pm-record-id
  4348     move zeros                  to pm-batch-seq-no
  4349                                    pm-batch-chg-seq-no
  4350                                    pm-last-maint-hhmmss
  4351                                    pm-insured-issue-age
  4352                                    pm-phone-no
  4353     move low-values             to pm-record-add-dt
  4354                                    pm-last-maint-dt
  4355                                    pm-insured-birth-dt
  4356                                    pm-joint-birth-dt
  4357     perform varying s1 from +1 by +1 until s1 > +7
  4358        move low-values          to pm-mail-date (s1)
  4359     end-perform
  4360     move 'CR'                   to pm-source-system
  4361     move ws-bin-current-dt      to pm-record-add-dt
  4362                                    pm-last-maint-dt
  4363     move 'E202'                 to pm-last-maint-by
* Micro Focus Server Express         V5.1 revision 000 18-Nov-15 08:08 Page  77
* EL202.cbl
  4364                                    pm-record-added-by
  4365     move ws-work-time           to pm-last-maint-hhmmss
  4366     move pending-mailing-data   to ws-init-erpndm
  4367     .
  4368 0240-exit.
  4369     exit.
  4370 9700-DATE-CONVERT.
  4371
  4372* EXEC CICS LINK
  4373*         PROGRAM  ('ELDATCV')
  4374*         COMMAREA (DATE-CONVERSION-DATA)
  4375*         LENGTH   (DC-COMM-LENGTH)
  4376*    END-EXEC.
  4377     MOVE 'ELDATCV' TO DFHEIV1
  4378*    MOVE '."C                   (   #00004006' TO DFHEIV0
  4379     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4380     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4381     MOVE X'2020233030303034303036' TO DFHEIV0(25:11)
  4382     CALL 'kxdfhei1' USING DFHEIV0,
  4383           DFHEIV1,
  4384           DATE-CONVERSION-DATA,
  4385           DC-COMM-LENGTH,
  4386           DFHEIV99,
  4387           DFHEIV99,
  4388           DFHEIV99,
  4389           DFHEIV99
  4390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4391
  4392 9700-EXIT.
  4393      EXIT.
  4394
  4395 9999-DFHBACK SECTION.
  4396     MOVE '9%                    "   ' TO DFHEIV0
  4397     MOVE 'EL202' TO DFHEIV1
  4398     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4399     GOBACK.
  4400 9999-DFHEXIT.
  4401     IF DFHEIGDJ EQUAL 0001
  4402         NEXT SENTENCE.
  4403     MOVE '9%                    "   ' TO DFHEIV0
  4404     MOVE 'EL202' TO DFHEIV1
  4405     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4406     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      138620     Code:       17376
