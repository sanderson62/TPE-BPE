* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57******************************************************************
    58 ENVIRONMENT DIVISION.
    59
    60 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page   3
* EL050.cbl
    62 WORKING-STORAGE SECTION.
    63 01  DFH-START PIC X(04).
    64
    65 77  FILLER   PIC X(32) VALUE '********************************'.
    66 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    67 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    68
    69 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    70 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    71                                   USAGE POINTER.
    72 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    73 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    75                                   USAGE IS POINTER.
    76 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    77 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    78                                   USAGE IS POINTER.
    79 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    80 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    81                                   USAGE IS POINTER.
    82
    83 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    84 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    85                                   USAGE IS POINTER.
    86
    87*    COPY ELC50WS.
    88*****************************************************************
    89*                                                               *
    90*                            ELC50WS.                           *
    91*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    92*                            VMOD=2.061.                        *
    93*                                                               *
    94*   THIS IS THE WORKING STORAGE FOR EL050                       *
    95*                                   EL517                       *
    96*****************************************************************
    97******************************************************************
    98*                   C H A N G E   L O G
    99*
   100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   101*-----------------------------------------------------------------
   102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   103* EFFECTIVE    NUMBER
   104*-----------------------------------------------------------------
   105* 123102                   PEMA  ADD DCC PROCESSING
   106* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   107* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   108* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   109* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   110* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   111* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   112* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   113* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   114* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   115* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   116* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   117* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   118* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   119* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page   4
* EL050.cbl
   120* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   121* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   122* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   123* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   124* 030309  CR2009021700001  PEMA  ADD ER-2883
   125* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   126* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   127* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   128* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   129* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   130* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   131* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   132* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   133* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   134* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   135* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   136* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   137* 061412  CR2011022800001  AJRA  NAPERSOFT
   138* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   139* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   140* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   141* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   142* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   143* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   144* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   145* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   146* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   147* 091114  IR2014091000001  TANA  ADD ERROR 2898
   148* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   149* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   150* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   151* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   152* 100617  CR2017062000003  PEMA  Inforce state comm cap
   153*-----------------------------------------------------------------
   154
   155 01  WORK-AREAS.
   156
   157*****************************************************************
   158*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   159*****************************************************************
   160
   161     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   162     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   163     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   164     12  WS-NAME-EDIT-WORK-AREA.
   165         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   166         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   167             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   168         16  WS-WORK-NAME.
   169             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   170             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   171             20  FILLER           PIC X(10)     VALUE SPACES.
   172         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   173             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   174
   175*****************************************************************
   176*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   177*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page   5
* EL050.cbl
   178
   179     12  WS-ERRESC-KEY.
   180         16 WS-ERRESC-SEARCH-KEY.
   181             20  WS-ERRESC-COMPANY-CD PIC  X.
   182             20  WS-ERRESC-CARRIER    PIC  X.
   183             20  WS-ERRESC-GROUP      PIC X(6).
   184             20  WS-ERRESC-STATE      PIC XX.
   185             20  WS-ERRESC-ACCOUNT    PIC X(10).
   186         16 WS-ERRESC-RESIDUAL-KEY.
   187             20  WS-ERRESC-AGENT      PIC X(10).
   188             20  WS-ERRESC-RES-STATE  PIC XX.
   189             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   190*                                          YYYYMMDD
   191     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   192     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   193
   194*RESIDENT STATE TAX MASTER(ERRESS)
   195*
   196     12  WS-ERRESS-KEY.
   197         16  WS-ERRESS-COMPANY-CD      PIC  X.
   198         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   199         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   200         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   201*                                          YYYYMMDD
   202
   203     12  WS-CONTRACT-DATE              PIC 9(8).
   204*                                          YYYYMMDD
   205     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   206     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   207         16 WS-YEAR-YY                 PIC   9999.
   208         16 FILLER                     PIC 9(4).
   209*                                          YYYYMMDD
   210     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   211     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   212     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   213     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   214
   215     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   216         88  DPRB-1ST-TIME                      VALUE ' '.
   217
   218*****************************************************************
   219*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   220*****************************************************************
   221
   222     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   223     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   224     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   225     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   226     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   227     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   228     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   229     12  ws-st-agent-sig-edit    pic x          value spaces.
   230     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   231     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   232     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   233     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   234         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   235         88 NO-AH-COVERAGE           VALUE '  ' '00'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page   6
* EL050.cbl
   236     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   237         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   238         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   239     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   240
   241     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   242     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   243
   244     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   245     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   255     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   256     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   257     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   258     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   259     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   271     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   272     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   273     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   274     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   275     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   276     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   277     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   278     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   279     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   280     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   281     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   282     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   283     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   284     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   285     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   286     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   287     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   288     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   289     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   290     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   291     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   292     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   293     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page   7
* EL050.cbl
   294     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   295     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   296     12  WS-2671-SW               PIC X         VALUE SPACE.
   297     12  WS-2672-SW               PIC X         VALUE SPACE.
   298     12  ws-9813-sw               pic x         value spaces.
   299     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   300         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   301     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   302         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   303     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   304
   305     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   306         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   307         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   308         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   309         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   310
   311     12  WS-CREDIT-EDIT-CONTROLS.
   312         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   313         16  WS-MIN-AGE           PIC 99                VALUE  0.
   314         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   315         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   316         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   317         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   318
   319     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   320     12  WS-AGE-FIELDS.
   321         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   322         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   323         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   324         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   325
   326     12  WS-SAVE-ALLOWABLE-BENEFIT.
   327         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   328         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   329         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   330         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   331         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   332         16  FILLER                      PIC XX.
   333
   334     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   335     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   336     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   337     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   338     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   339     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   340     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   341     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   342     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   343     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   344
   345     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   346     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   347     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   348     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   349     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   350     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   351     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page   8
* EL050.cbl
   352     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   353         88  WS-REDUCING              VALUE 'R'.
   354         88  WS-LEVEL                 VALUE 'L' 'P'.
   355     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   356
   357     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   358     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   359     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   360     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   361     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   362     12  ws-ah-max-bens           pic 99        value zeros.
   363     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   364     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   365     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   366     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   367
   368     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   369     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   370     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   371     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   372     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   373     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   374     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   375     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   376     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   377     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   378     12  WS-ACCT-SIG-SW.
   379         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   380         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   381     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   382     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   383     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   384     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   385     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   386     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   387     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   388     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   389     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   390     12  WS-INITIALS.
   391         16  WS-INIT-1            PIC X         VALUE SPACES.
   392         16  WS-INIT-2            PIC X         VALUE SPACES.
   393
   394     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   395     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   396     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   397     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   398     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   399*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   400     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   401     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   402     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   403     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   404     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   405     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   406     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   407     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   408     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   409     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page   9
* EL050.cbl
   410     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   411     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   412     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   413     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   414     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   415     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   416     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   417     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   418     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   419     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   420     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   421     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   422******** FLA
   423     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   424     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   425     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   426     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   427     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   428********
   429     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   430     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   431     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   432     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   433     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   434     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   435     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   436     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   437     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   438     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   439
   440     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   441         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   442                                         '0' THRU '9'.
   443
   444     12  NUMBER-OF-MONTHS.
   445         16  SK-MO OCCURS 12 TIMES PIC X.
   446
   447     12  WS-WORK-DATE.
   448         16  WS-YEAR            PIC 99    VALUE 00.
   449         16  WS-MONTH           PIC 99    VALUE 00.
   450         16  WS-DAY             PIC 99    VALUE 00.
   451
   452     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   453     12  WS-WORK-CRIT-DEV       REDEFINES
   454         WS-WORK-LF-CRIT-PER    PIC X(03).
   455
   456     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   457     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   458
   459     12  WS-WORK-DATE-FROM.
   460         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   461         16  FILLER             PIC X  VALUE SPACE.
   462         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   463         16  FILLER             PIC X         VALUE SPACE.
   464         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   465
   466     12  WS-WORK-DATE-THRU.
   467         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  10
* EL050.cbl
   468         16  FILLER             PIC X         VALUE SPACE.
   469         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   470         16  FILLER             PIC X         VALUE SPACE.
   471         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   472
   473     12  WS-LF-INPUT-CD.
   474         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   475         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   476
   477     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   478     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   479         16  WS-AH-INPUT-CD-1   PIC X.
   480         16  WS-AH-INPUT-CD-2-3 PIC XX.
   481
   482     12  WS-SWITCHES.
   483         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   484         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   485             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   486         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   487             88  BANK-ACCT-FOUND          VALUE 'Y'.
   488         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   489             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   490         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   491             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   492         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   493             88  COMP-MASTER-FOUND        VALUE 'Y'.
   494         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   495             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   496         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   497             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   498         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   499             88  STAT-MASTER-FOUND        VALUE 'Y'.
   500         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   501             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   502         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   503             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   504         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   505             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   506         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   507             88  FORM-MASTER-FOUND        VALUE 'Y'.
   508         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   509             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   510         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   511             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   512         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   513             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   514         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   515             88  NO-BENEFIT-FOUND         VALUE 'N'.
   516         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   517             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   518         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   519             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   520         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   521             88  AH-BENEFIT-FOUND         VALUE ' '.
   522             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   523         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   524             88  LF-BENEFIT-FOUND         VALUE ' '.
   525             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  11
* EL050.cbl
   526         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   527             88  NO-STATE-RECORD          VALUE '1'.
   528         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   529             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   530         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   531             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   532         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   533             88  CERT-WAS-FOUND           VALUE ' '.
   534             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   535         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   536             88  BROWSE-STARTED           VALUE 'Y'.
   537         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   538             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   539         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   540             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   541         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   542             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   543         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   544             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   545         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   546             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   547         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   548             88  APP-CERT-USED            VALUE 'Y' 'A'.
   549         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   550             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   551             88  FIRST-TIME-THROUGH       VALUE '1'.
   552             88  CTBL-NOT-FOUND           VALUE '2'.
   553
   554         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   555             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   556
   557         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   558             88  DLO-ERROR-FOUND          VALUE 'Y'.
   559
   560********FLA
   561     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   562     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   563********
   564     12  RC-SW-1                  PIC X           VALUE '0'.
   565     12  RC-SW-2                  PIC X           VALUE '0'.
   566     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   567     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   568     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   569     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   570     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   571     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   572     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   573     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   574     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   575     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   576     12  LIT-SPACES               PIC X           VALUE SPACES.
   577     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   578     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   579     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   580     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   581     12  erpndm-unlock-sw         pic x           value spaces.
   582         88  need-to-unlock-erpndm  value 'Y'.
   583     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  12
* EL050.cbl
   584     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   585     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   586         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   587         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   588     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   589         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   590
   591 01  WS-EXTRA-PERIODS-BY-STATE.
   592     12  WS-INT-PERIODS          PIC 9.
   593     12  WS-EXTRA-PMTS           PIC 9.
   594 01  ws-net-only-state           pic x value 'N'.
   595 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   596     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   597     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   598 01  WS-CRI-SSN-WORK-AREA.
   599     05  WS-CRI-SOC-SEC-NO.
   600         10  WS-SS-REPT-CD       PIC X(5).
   601         10  WS-SS-LAST-NAME     PIC X(5).
   602         10  WS-SS-INITIAL       PIC X.
   603
   604     05  WS-CRI-REPORT-CODE.
   605         10  FILLER              PIC X(5).
   606         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   607
   608     05  WS-CRI-LAST-NAME.
   609         10  WS-CRI-NAME-MOVE    PIC X(5).
   610         10  FILLER              PIC X(10).
   611
   612 01  ws-state-commission-caps.
   613     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   614     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   615     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   616     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   617     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   618     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   619     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   620     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   621     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   622     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   623     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   624     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   625     05  ws-st-cap-limit-to      pic x.
   626     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   627     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   628     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   629     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   630     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   631     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   632     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
   633     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   634     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   635     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   636     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   637     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   638 01  WS-NUM-TABLE                PIC X(26)  VALUE
   639     '12345678012345070923456789'.
   640 01  FILLER REDEFINES WS-NUM-TABLE.
   641     05  WS-NUM OCCURS 26        PIC 9.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  13
* EL050.cbl
   642 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   643 01  V1                          PIC S999 COMP-3.
   644 01  V2                          PIC S999 COMP-3.
   645 01  V3                          PIC S999 COMP-3.
   646 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   647 01  FILLER REDEFINES WS-WORK-VIN.
   648     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   649 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   650 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   651 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   652 01  WS-HEX-WORK.
   653     05  FILLER                  PIC X  VALUE LOW-VALUES.
   654     05  WS-HEX-BYTE             PIC X.
   655 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   656 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   657 01  WS-WORK-HIN-ROW-B.
   658     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   659
   660 01  ws-benefit-cd-chg-sw      pic x value spaces.
   661     88  benefit-code-chg           value 'Y'.
   662 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   663 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   664     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   665 01  WS-ROW-D-TABLE.
   666     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   667
   668 01  WS-HIN-TABLE-B.
   669     05  F                       PIC XX VALUE 'A2'.
   670     05  F                       PIC XX VALUE 'B3'.
   671     05  F                       PIC XX VALUE 'C4'.
   672     05  F                       PIC XX VALUE 'D5'.
   673     05  F                       PIC XX VALUE 'E6'.
   674     05  F                       PIC XX VALUE 'F7'.
   675     05  F                       PIC XX VALUE 'G8'.
   676     05  F                       PIC XX VALUE 'H9'.
   677     05  F                       PIC XX VALUE 'I1'.
   678     05  F                       PIC XX VALUE 'J2'.
   679     05  F                       PIC XX VALUE 'K3'.
   680     05  F                       PIC XX VALUE 'L4'.
   681     05  F                       PIC XX VALUE 'M5'.
   682     05  F                       PIC XX VALUE 'N6'.
   683     05  F                       PIC XX VALUE 'O0'.
   684     05  F                       PIC XX VALUE 'P7'.
   685     05  F                       PIC XX VALUE 'Q0'.
   686     05  F                       PIC XX VALUE 'R8'.
   687     05  F                       PIC XX VALUE 'S9'.
   688     05  F                       PIC XX VALUE 'T2'.
   689     05  F                       PIC XX VALUE 'U3'.
   690     05  F                       PIC XX VALUE 'V4'.
   691     05  F                       PIC XX VALUE 'W5'.
   692     05  F                       PIC XX VALUE 'X6'.
   693     05  F                       PIC XX VALUE 'Y7'.
   694     05  F                       PIC XX VALUE 'Z8'.
   695 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   696     05  WS-VAL-IN               PIC X.
   697     05  WS-VAL-OUT              PIC 9.
   698 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   699 01  WS-COMPARE-BINARY-DATES.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  14
* EL050.cbl
   700     05  WS-971231                PIC XX VALUE X'92FF'.
   701     05  WS-931231                PIC XX VALUE X'8CFF'.
   702     05  WS-791231                PIC XX VALUE X'77FF'.
   703     05  WS-771001                PIC XX VALUE X'74A1'.
   704     05  WS-820301                PIC XX VALUE X'7B41'.
   705     05  WS-831031                PIC XX VALUE X'7DBF'.
   706     05  WS-831231                PIC XX VALUE X'7DFF'.
   707     05  WS-810831                PIC XX VALUE X'7A7F'.
   708     05  WS-830901                PIC XX VALUE X'7D81'.
   709
   710 01  FILE-ACCESS-IDS.
   711     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   712     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   713     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   714     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   715     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   716     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   717     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   718     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   719     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   720     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   721     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   722     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   723     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   724     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   725     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   726     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   727     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   728 01  DD-IU-SW                    PIC X   VALUE ' '.
   729     88  DD-IU-PRESENT                 VALUE 'Y'.
   730
   731 01  ACCESS-KEYS.
   732     12  ELMSTR-KEY.
   733         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   734         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   735     12  W-CLAIM-KEY.
   736         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   737         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   738
   739     12  ELCNTL-KEY.
   740         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   741         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   742         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   743         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   744
   745     12  ELCERT-KEY.
   746         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   747         16  CERT-CARRIER         PIC X       VALUE SPACE.
   748         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   749         16  CERT-STATE           PIC XX      VALUE SPACES.
   750         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   751         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   752         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   753
   754     12  ELCERT2-KEY.
   755         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   756         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   757
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  15
* EL050.cbl
   758     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   759
   760     12  ELCERT-SAVE.
   761         16  FILLER                      PIC XX    VALUE SPACES.
   762
   763         16  WCS-CONTROL-PRIMARY.
   764             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   765             20  WCS-CARRIER             PIC X     VALUE SPACE.
   766             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   767             20  WCS-STATE               PIC XX    VALUE SPACES.
   768             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   769             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   770             20  WCS-CERT-NO.
   771                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   772                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   773
   774         16  CS-CONTROL-BY-NAME.
   775             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   776             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   777             20  CS-INSURED-INITIALS.
   778                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   779                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   780
   781         16  CS-CONTROL-BY-SSN.
   782             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   783             20  CS-SOC-SEC-NO.
   784                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   785                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   786                 24  CS-SSN-LN3.
   787                     28 CS-INSURED-INITIALS-A2   PIC XX
   788                                     VALUE SPACES.
   789                     28 CS-PART-LAST-NAME-A2     PIC X
   790                                     VALUE SPACE.
   791
   792         16  CS-CONTROL-BY-CERT-NO.
   793             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   794             20  CS-CERT-NO-A4           PIC X(11)
   795                                     VALUE SPACES.
   796
   797         16  CS-CONTROL-BY-MEMB.
   798             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   799             20  CS-MEMBER-NO.
   800                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   801                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   802                 24  CS-MEMB-LN4.
   803                     28 CS-INSURED-INITIALS-A5   PIC XX
   804                                      VALUE SPACES.
   805                     28 CS-PART-LAST-NAME-A5     PIC XX
   806                                      VALUE SPACES.
   807
   808         16  FILLER              PIC X(360) VALUE SPACES.
   809
   810     12  ERACCT-KEY.
   811         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   812         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   813         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   814         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   815         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  16
* EL050.cbl
   816         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   817
   818     12  ERCOMP-KEY.
   819         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   820         16  COMP-CARRIER         PIC X     VALUE SPACES.
   821         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   822         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   823         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   824         16  COMP-TYPE            PIC X     VALUE SPACES.
   825
   826     12  ERLOFC-KEY.
   827         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   828         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   829         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   830         16  LOFC-STATE           PIC XX    VALUE SPACES.
   831         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   832         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   833
   834     12  WS-ELCRTT-KEY.
   835         16  WS-ELCRTT-PRIMARY       PIC X(33).
   836         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   837
   838     12  ERBXRF-KEY.
   839         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   840         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   841         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   842         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   843
   844     12  ERAGTC-KEY.
   845         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   846         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   847         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   848         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   849         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   850         16  AGTC-TYPE            PIC X     VALUE SPACES.
   851
   852     12  ERPLAN-KEY.
   853         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   854         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   855         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   856         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   857         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   858         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   859         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   860         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   861
   862     12  ERFORM-KEY.
   863         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   864         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   865         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   866         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   867
   868     12  ERREIN-KEY.
   869         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   870         16  REIN-TYPE            PIC X     VALUE SPACES.
   871         16  REIN-TABLE-CO.
   872             20  REIN-CODE-1      PIC X     VALUE SPACE.
   873             20  REIN-CODE-2      PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  17
* EL050.cbl
   874             20  REIN-CODE-3      PIC X     VALUE SPACE.
   875         16  FILLER               PIC X(3)  VALUE SPACES.
   876
   877     12  ERCTBL-KEY.
   878         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   879         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   880         16  CTBL-CNTRL-2.
   881             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   882             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   883
   884     12  ELCRTO-KEY.
   885         16  ELCRTO-COMPANY-CD       PIC X.
   886         16  ELCRTO-CARRIER          PIC X.
   887         16  ELCRTO-GROUPING         PIC X(6).
   888         16  ELCRTO-STATE            PIC XX.
   889         16  ELCRTO-ACCOUNT          PIC X(10).
   890         16  ELCRTO-CERT-EFF-DT      PIC XX.
   891         16  ELCRTO-CERT-NO.
   892             20  ELCRTO-CERT-PRIME   PIC X(10).
   893             20  ELCRTO-CERT-SFX     PIC X.
   894         16  ELCRTO-RECORD-TYPE      PIC X.
   895         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   896
   897
   898     12  WS-ACCESS.
   899         16  FILLER               PIC XX    VALUE SPACES.
   900         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   901
   902     12  WS-CARR-ACCESS.
   903         16  FILLER               PIC X(3)  VALUE SPACES.
   904         16  WS-CARR              PIC X     VALUE SPACE.
   905*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   906*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   907     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   908         88  WS-DMD-LF-RATING   VALUE 'Y'.
   909         88  WS-DMD-AH-RATING   VALUE 'Y'.
   910         88  WS-DMD-NO-RATING   VALUE 'N'.
   911
   912     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   913         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   914                                         'NJ' 'NL'
   915                                         'PJ' 'PL'
   916                                         'SJ' 'SL'.
   917     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   918         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   919                                         'NI' 'NJ' 'NL' 'NU'
   920                                         'PJ' 'PL' 'PI' 'PU'
   921                                         'SI' 'SJ' 'SL' 'SU'
   922                                         'MX' 'MY' 'MZ'.
   923 01  ERPDEF-KEY-SAVE             PIC X(18).
   924 01  ERPDEF-KEY.
   925     12  ERPDEF-COMPANY-CD       PIC X.
   926     12  ERPDEF-STATE            PIC XX.
   927     12  ERPDEF-PROD-CD          PIC XXX.
   928     12  F                       PIC X(7).
   929     12  ERPDEF-BEN-TYPE         PIC X.
   930     12  ERPDEF-BEN-CODE         PIC XX.
   931     12  ERPDEF-EXP-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  18
* EL050.cbl
   932
   933 01  ELSTAT-KEY-SAVE             PIC X(20).
   934 01  ELSTAT-KEY.
   935     12  ELSTAT-COMPANY-ID       PIC XXX.
   936     12  ELSTAT-CARRIER          PIC X.
   937     12  ELSTAT-GROUP            PIC X(6).
   938     12  ELSTAT-STATE            PIC XX.
   939     12  ELSTAT-EXP-DT           PIC 9(8).
   940 01  WS-ERROR-VALUES.
   941     12  ER-1570                     PIC S9(4)   VALUE +1570.
   942     12  ER-1571                     PIC S9(4)   VALUE +1571.
   943     12  er-1572                     pic s9(4)   value +1572.
   944     12  er-1573                     pic s9(4)   value +1573.
   945     12  er-1574                     pic s9(4)   value +1574.
   946     12  ER-1575                     PIC S9(4)   VALUE +1575.
   947     12  er-1576                     pic s9(4)   value +1576.
   948     12  er-1583                     pic s9(4)   value +1583.
   949     12  er-1743                     pic s9(4)   value +1743.
   950     12  er-1744                     pic s9(4)   value +1744.
   951     12  er-1745                     pic s9(4)   value +1745.
   952     12  er-1746                     pic s9(4)   value +1746.
   953     12  er-1747                     pic s9(4)   value +1747.
   954     12  er-1748                     pic s9(4)   value +1748.
   955     12  ER-1891                     PIC S9(4)   VALUE +1891.
   956     12  ER-1892                     PIC S9(4)   VALUE +1892.
   957     12  ER-1893                     PIC S9(4)   VALUE +1893.
   958     12  ER-1894                     PIC S9(4)   VALUE +1894.
   959     12  ER-1895                     PIC S9(4)   VALUE +1895.
   960     12  ER-1896                     PIC S9(4)   VALUE +1896.
   961     12  ER-1897                     PIC S9(4)   VALUE +1897.
   962     12  ER-1898                     PIC S9(4)   VALUE +1898.
   963     12  ER-1899                     PIC S9(4)   VALUE +1899.
   964     12  ER-1900                     PIC S9(4)   VALUE +1900.
   965     12  ER-1901                     PIC S9(4)   VALUE +1901.
   966     12  ER-1902                     PIC S9(4)   VALUE +1902.
   967     12  ER-1903                     PIC S9(4)   VALUE +1903.
   968     12  ER-1904                     PIC S9(4)   VALUE +1904.
   969     12  ER-1905                     PIC S9(4)   VALUE +1905.
   970     12  ER-1906                     PIC S9(4)   VALUE +1906.
   971     12  ER-1907                     PIC S9(4)   VALUE +1907.
   972     12  ER-1909                     PIC S9(4)   VALUE +1909.
   973     12  ER-1910                     PIC S9(4)   VALUE +1910.
   974     12  ER-1911                     PIC S9(4)   VALUE +1911.
   975     12  ER-1912                     PIC S9(4)   VALUE +1912.
   976     12  ER-1913                     PIC S9(4)   VALUE +1913.
   977     12  ER-1914                     PIC S9(4)   VALUE +1914.
   978     12  ER-1915                     PIC S9(4)   VALUE +1915.
   979     12  ER-1916                     PIC S9(4)   VALUE +1916.
   980     12  ER-1917                     PIC S9(4)   VALUE +1917.
   981     12  ER-1918                     PIC S9(4)   VALUE +1918.
   982     12  ER-1919                     PIC S9(4)   VALUE +1919.
   983     12  ER-1920                     PIC S9(4)   VALUE +1920.
   984     12  ER-1921                     PIC S9(4)   VALUE +1921.
   985     12  ER-1922                     PIC S9(4)   VALUE +1922.
   986     12  ER-1923                     PIC S9(4)   VALUE +1923.
   987     12  ER-1924                     PIC S9(4)   VALUE +1924.
   988     12  ER-1925                     PIC S9(4)   VALUE +1925.
   989     12  ER-1926                     PIC S9(4)   VALUE +1926.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  19
* EL050.cbl
   990     12  ER-1927                     PIC S9(4)   VALUE +1927.
   991     12  ER-1955                     PIC s9(4)   VALUE +1955.
   992     12  ER-1956                     PIC s9(4)   VALUE +1956.
   993     12  ER-1957                     PIC s9(4)   VALUE +1957.
   994     12  ER-1958                     PIC s9(4)   VALUE +1958.
   995     12  ER-1959                     PIC s9(4)   VALUE +1959.
   996     12  ER-1960                     PIC s9(4)   VALUE +1960.
   997     12  ER-1961                     PIC s9(4)   VALUE +1961.
   998     12  ER-1962                     PIC s9(4)   VALUE +1962.
   999     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1000     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1001     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1002     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1003     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1004     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1005     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1006     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1007     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1008     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1009     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1010     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1011     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1012     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1013     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1014     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1015     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1016     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1017     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1018     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1019     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1020     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1021     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1022     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1023     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1024     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1025     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1026     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1027     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1028     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1029     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1030     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1031     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1032     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1033     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1034     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1035     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1036     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1037     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1038     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1039     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1040     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1041     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1042     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1043     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1044     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1045     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1046     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1047     12  ER-2646                     PIC S9(4)   VALUE +2646.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  20
* EL050.cbl
  1048     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1049     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1050     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1051     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1052     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1053     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1054     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1055     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1056     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1057     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1058     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1059     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1060     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1061     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1062     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1063     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1064     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1065     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1066     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1067     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1068     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1069     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1070     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1071     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1072     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1073     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1074     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1075     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1076     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1077     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1078     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1079     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1080     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1081     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1082     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1083     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1084     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1085     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1086     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1087     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1088     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1089     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1090     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1091     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1092     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1093     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1094     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1095     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1096     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1097     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1098     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1099     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1100     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1101     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1102     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1103     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1104     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1105     12  ER-2704                     PIC S9(4)   VALUE +2704.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  21
* EL050.cbl
  1106     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1107     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1108     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1109     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1110     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1111     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1112     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1113     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1114     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1115     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1116     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1117     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1118     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1119     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1120     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1121     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1122     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1123     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1124     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1125     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1126     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1127     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1128     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1129     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1130     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1131     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1132     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1133     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1134     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1135     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1136     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1137     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1138     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1139     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1140     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1141     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1142     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1143     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1144     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1145     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1146     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1147     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1148     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1149     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1150     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1151     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1152     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1153     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1154     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1155     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1156     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1157     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1158     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1159     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1160     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1161     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1162     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1163     12  ER-2772                     PIC S9(4)   VALUE +2772.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  22
* EL050.cbl
  1164     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1165     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1166     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1167     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1168     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1169     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1170     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1171     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1172     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1173     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1174     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1175     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1176     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1177     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1178     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1179     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1180     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1181     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1182     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1183     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1184     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1185     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1186     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1187     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1188     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1189     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1190     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1191     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1192     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1193     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1194     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1195     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1196     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1197     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1198     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1199     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1200     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1201     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1202     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1203     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1204     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1205     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1206     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1207     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1208     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1209     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1210     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1211     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1212     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1213     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1214     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1215     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1216     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1217     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1218     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1219     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1220     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1221     12  ER-3782                     PIC S9(4)   VALUE +3782.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  23
* EL050.cbl
  1222     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1223     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1224     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1225     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1226     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1227     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1228     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1229     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1230     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1231     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1232     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1233     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1234     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1235     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1236     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1237     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1238     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1239     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1240     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1241     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1242     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1243     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1244     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1245     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1246     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1247     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1248     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1249     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1250     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1251     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1252     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1253     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1254     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1255     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1256     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1257     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1258     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1259     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1260     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1261     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1262     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1263     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1264     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1265     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1266     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1267     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1268     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1269     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1270     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1271     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1272     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1273     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1274     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1275     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1276     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1277     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1278     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1279     12  ER-8094                     PIC S9(4)   VALUE +8094.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  24
* EL050.cbl
  1280     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1281     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1282     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1283     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1284     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1285     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1286     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1287     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1288     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1289     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1290     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1291     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1292     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1293     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1294     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1295     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1296     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1297     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1298     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1299     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1300     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1301     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1302     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1303     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1304     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1305     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1306     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1307     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1308     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1309     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1310     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1311     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1312     12  er-9823                     pic s9(4)   value +9823.
  1313     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1314******************************************************************
  1315***************   END OF ELC50WS     ****************************
  1316******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  25
* EL050.cbl
  1319 01  WORKING-STORAGE-WORK-AREAS.
  1320     12  WS-RESPONSE             PIC S9(8)  COMP.
  1321         88  WS-RESP-NORMAL           VALUE +00.
  1322         88  WS-RESP-ERROR            VALUE +01.
  1323         88  WS-RESP-NOTFND           VALUE +13.
  1324         88  WS-RESP-DUPREC           VALUE +14.
  1325         88  WS-RESP-ENDFILE          VALUE +20.
  1326     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1327     12  WORK-AREAS.
  1328         16  WK-CONV-GREG.
  1329             24  WCG-CENT             PIC XX.
  1330             24  WCG-REST             PIC X(4).
  1331         16  WORK-GREGORIAN-DATE.
  1332             24  WK-GREG-CENT         PIC XX.
  1333             24  WK-GREG-DATE-YYMMDD.
  1334                 28  WK-GREG-YYMM     PIC X(4).
  1335                 28  WK-GREG-DD       PIC XX.
  1336
  1337         16  WORK-SELECT-DATE.
  1338             24  WK-SELECT-CENT            PIC XX.
  1339             24  WK-SELECT-DATE-YYMMDD.
  1340                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1341                 28  FILLER                PIC XX.
  1342
  1343         16  WK-FORM-NO.
  1344             24  WK-FORM-BANK-ID       PIC X(5).
  1345             24  WK-FORM-UNDRWRTR      PIC X(1).
  1346             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1347
  1348         16  WK-MEMBER-NO.
  1349             24  WK-MEMBER-1-6        PIC X(6).
  1350             24  WK-MEMBER-7-12       PIC X(6).
  1351
  1352         16  WK-FULL-CERT-NO.
  1353             24  WK-CERT-POS-1-2      PIC X(2).
  1354             24  WK-CERT-POS-3        PIC X(1).
  1355             24  WK-CERT-POS-4        PIC X(1).
  1356             24  WK-CERT-POS-5-6      PIC X(2).
  1357             24  WK-CERT-POS-7        PIC X(1).
  1358             24  WK-CERT-POS-8-11     PIC X(4).
  1359
  1360         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1361             88  VALID-RATE-CODE        VALUE 'Y'.
  1362             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1363
  1364         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1365         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1366         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1367         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1368         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1369         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1370         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1371         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1372         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1373         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1374
  1375* DLO001
  1376 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  26
* EL050.cbl
  1377     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1378     12  DMPF-RETURN-CODE          PIC XX.
  1379         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1380         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1381         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1382         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1383         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1384         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1385
  1386* DLO002
  1387 01  WS-DLO-INTERNAL-POLICY-FORM.
  1388     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1389     12  DIPF-RETURN-CODE          PIC XX.
  1390         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1391         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1392         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1393         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1394         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1395         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1396
  1397* DLO003
  1398 01  WS-DLO-VALID-BANK-ID.
  1399     12  DVBI-BANK-ID              PIC X(5).
  1400     12  DVBI-BANK-ID-TYPE         PIC X.
  1401         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1402         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1403         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1404         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1405         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1406     12  DVBI-RETURN-CODE          PIC XX.
  1407         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1408         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1409         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1410         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1411         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1412         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1413         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1414         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1415         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1416
  1417* DLO007
  1418 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1419     12  DCUA-RES-STATE            PIC XX.
  1420     12  DCUA-BEN-TYPE             PIC XX.
  1421     12  DCUA-SYS-IDENT            PIC X.
  1422         88  DCUA-CLAIM                        VALUE 'C'.
  1423         88  DCUA-PREMIUM                      VALUE 'P'.
  1424     12  DCUA-COVERAGE-RULE        PIC X.
  1425     12  DCUA-CLIENT-ID            PIC X(10).
  1426     12  DCUA-EFF-DATE             PIC X(8).
  1427     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1428     12  DCUA-RETURN-CODE          PIC XX.
  1429         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1430     12  DCUA-CERT-NUMBER          PIC X(11).
  1431     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1432     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1433
  1434* DLO011
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  27
* EL050.cbl
  1435 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1436     12  DPRB-RATE-CODE            PIC X(4).
  1437     12  DPRB-COVERAGE-CATEG       PIC X.
  1438     12  DPRB-RETURN-CODE          PIC XX.
  1439         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1440         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1441         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1442         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1443         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1444         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1445         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1446         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1447         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1448     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1449     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1450     12  DPRB-BEN-TYPE             PIC XX.
  1451
  1452* DLO017
  1453 01  WS-DLO-VALID-RATE-CODE.
  1454     12  DVRC-RATE-CODE            PIC X(4).
  1455     12  DVRC-RETURN-CODE          PIC XX.
  1456         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1457         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1458         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1459         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1460         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1461         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1462
  1463* DLO019
  1464 01  WS-DLO-ORIG-COV-CAT.
  1465     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1466     12  DOCC-RETURN-CODE          PIC XX.
  1467     12  DOCC-ORIG-COV-CAT         PIC X.
  1468     12  DOCC-UNDERWITER           PIC XX.
  1469     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1470     12  DOCC-FILLER               PIC X(6).
  1471
  1472* DLO021
  1473 01  WS-DLO-VALID-LOAN-OFFICER.
  1474     12  DVLO-LOAN-OFFICER.
  1475         16  DVLO-BILL-TYPE        PIC X.
  1476         16  DVLO-BILL-SOURCE      PIC X.
  1477         16  DVLO-BATCH-TYPE       PIC X.
  1478     12  DVLO-RETURN-CODE          PIC XX.
  1479         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1480         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1481         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1482         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1483         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1484         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1485
  1486* DLO022
  1487 01  WS-DLO-VALID-STATE-CODE.
  1488     12  DVSC-STATE-CODE           PIC XX.
  1489     12  DVSC-RETURN-CODE          PIC XX.
  1490         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1491
  1492* DLO023
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  28
* EL050.cbl
  1493 01  WS-DLO-VALID-CODE-VALUES.
  1494     12  DVCV-SYSTEM-ID            PIC XX.
  1495         88  DVCV-CLAIMS                       VALUE 'CL'.
  1496         88  DVCV-CREDIT                       VALUE 'CR'.
  1497     12  DVCV-RECORD-TYPE          PIC XX.
  1498         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1499         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1500         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1501         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1502         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1503         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1504         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1505         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1506     12  DVCV-RECORD-KEY           PIC X(6).
  1507     12  DVCV-RETURN-CODE          PIC XX.
  1508         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1509         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1510         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1511         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1512         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1513         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1514         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1515     12  DVCV-CODE-DESC            PIC X(60).
  1516     12  DVCV-GEN-DESC-1           PIC X(20).
  1517     12  DVCV-GEN-DESC-2           PIC X(20).
  1518     12  DVCV-GEN-DESC-3           PIC X(20).
  1519
  1520 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1521 01  hldi-pass-area.
  1522     03  PA-VIN                  PIC X(17).
  1523     03  PA-ErrorCode            PIC X(10).
  1524     03  PA-ErrorDesc            PIC X(30).
  1525     03  PA-ModelYear            PIC 9(7).
  1526     03  PA-MakeName             PIC X(50).
  1527     03  PA-ModelName            PIC X(50).
  1528     03  PA-SeriesName           PIC X(50).
  1529 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1530 01  zipcd-pass-area.
  1531     03  PA-zip                  PIC X(5).
  1532     03  PA-ErrorCode-zip        PIC X(10).
  1533     03  PA-city                 PIC x(50).
  1534     03  PA-state                PIC Xx.
  1535****  this is for aggregate report.
  1536****  Length is erpndb + 100 of passed-key-area
  1537 01  ws-passed-key-length        pic s9(4) comp value +587.
  1538 01  ws-pass-to-pemaggo.
  1539     05  ws-passed-erpndb        pic x(585).
  1540     05  ws-exceed-limit-yn      pic x.
  1541     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  29
* EL050.cbl
  1543*    COPY ERCBXRF.
  1544******************************************************************
  1545*                                                                *
  1546*                                                                *
  1547*                            ERCBXRF                             *
  1548*                                                                *
  1549*   ONLINE CREDIT SYSTEM                                         *
  1550*                                                                *
  1551*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1552*                                                                *
  1553*   FILE TYPE = VSAM,KSDS                                        *
  1554*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1555*                                                                *
  1556*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1557*       ALTERNATE PATH = NONE                                    *
  1558*                                                                *
  1559*   LOG = NO                                                     *
  1560*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1561*                                                                *
  1562******************************************************************
  1563
  1564 01  BANK-CROSS-REFERENCE.
  1565     12  BK-RECORD-ID                PIC XX.
  1566         88  VALID-BK-ID             VALUE 'BK'.
  1567
  1568     12  BK-CONTROL-PRIMARY.
  1569         16  BK-COMPANY-CD           PIC X.
  1570         16  BK-CARRIER              PIC X.
  1571         16  BK-GROUPING             PIC X(6).
  1572         16  BK-BANK-NO              PIC X(10).
  1573
  1574     12  BK-MAINT-INFORMATION.
  1575         16  BK-LAST-MAINT-DT        PIC XX.
  1576         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1577         16  BK-LAST-MAINT-USER      PIC X(4).
  1578         16  FILLER                  PIC X(9).
  1579
  1580     12  FILLER                      PIC X(37).
  1581
  1582     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1583
  1584     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1585                            DEPENDING ON BK-BANK-POINTER-CNT.
  1586         16  BK-AM-ACCOUNT           PIC X(10).
  1587         16  BK-AM-EXP-DT            PIC XX.
  1588         16  BK-AM-EFF-DT            PIC XX.
  1589         16  BK-AM-STATE             PIC XX.
  1590         16  FILLER                  PIC X(20).
  1591
  1592******************************************************************
  1593
  1594*    COPY ERCCOMP.
  1595******************************************************************
  1596*                                                                *
  1597*                                                                *
  1598*                            ERCCOMP                             *
  1599*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1600*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  30
* EL050.cbl
  1601*                                                                *
  1602*   ONLINE CREDIT SYSTEM                                         *
  1603*                                                                *
  1604*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1605*                                                                *
  1606*   FILE TYPE = VSAM,KSDS                                        *
  1607*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1608*                                                                *
  1609*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1610*       ALTERNATE PATH = NONE                                    *
  1611*                                                                *
  1612*   LOG = NO                                                     *
  1613*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1614*                                                                *
  1615******************************************************************
  1616*                   C H A N G E   L O G
  1617*
  1618* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1619*-----------------------------------------------------------------
  1620*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1621* EFFECTIVE    NUMBER
  1622*-----------------------------------------------------------------
  1623* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1624* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1625* 092205    2005050300006  PEMA  ADD LEASE FEE
  1626* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1627* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1628* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1629* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1630* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1631* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1632******************************************************************
  1633
  1634 01  COMPENSATION-MASTER.
  1635     12  CO-RECORD-ID                          PIC XX.
  1636         88  VALID-CO-ID                          VALUE 'CO'.
  1637
  1638     12  CO-CONTROL-PRIMARY.
  1639         16  CO-COMPANY-CD                     PIC X.
  1640         16  CO-CONTROL.
  1641             20  CO-CTL-1.
  1642                 24  CO-CARR-GROUP.
  1643                     28  CO-CARRIER            PIC X.
  1644                     28  CO-GROUPING.
  1645                         32  CO-GROUP-PREFIX   PIC XXX.
  1646                         32  CO-GROUP-PRIME    PIC XXX.
  1647                 24  CO-RESP-NO.
  1648                     28  CO-RESP-PREFIX        PIC X(4).
  1649                     28  CO-RESP-PRIME         PIC X(6).
  1650             20  CO-CTL-2.
  1651                 24  CO-ACCOUNT.
  1652                     28  CO-ACCT-PREFIX        PIC X(4).
  1653                     28  CO-ACCT-PRIME         PIC X(6).
  1654         16  CO-TYPE                           PIC X.
  1655             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1656             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1657             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1658
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  31
* EL050.cbl
  1659     12  CO-MAINT-INFORMATION.
  1660         16  CO-LAST-MAINT-DT                  PIC XX.
  1661         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1662         16  CO-LAST-MAINT-USER                PIC X(4).
  1663     12  FILLER                                PIC XX.
  1664     12  CO-STMT-TYPE                          PIC XXX.
  1665     12  CO-COMP-TYPE                          PIC X.
  1666         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1667     12  CO-STMT-OWNER                         PIC X(4).
  1668     12  CO-BALANCE-CONTROL                    PIC X.
  1669         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1670         88  CO-NO-BALANCE                        VALUE 'N'.
  1671
  1672     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1673         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1674         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1675         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1676
  1677     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1678         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1679         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1680
  1681     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1682     12  CO-GA-DIRECT-DEP                      PIC X.
  1683     12  CO-FUTURE-SPACE                       PIC X.
  1684         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1685
  1686     12  CO-ACCT-NAME                          PIC X(30).
  1687     12  CO-MAIL-NAME                          PIC X(30).
  1688     12  CO-ADDR-1                             PIC X(30).
  1689     12  CO-ADDR-2                             PIC X(30).
  1690     12  CO-ADDR-3.
  1691         16  CO-ADDR-CITY                      PIC X(27).
  1692         16  CO-ADDR-STATE                     PIC XX.
  1693     12  CO-CSO-1099                           PIC X.
  1694     12  CO-ZIP.
  1695         16  CO-ZIP-PRIME.
  1696             20  CO-ZIP-PRI-1ST                PIC X.
  1697                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1698             20  FILLER                        PIC X(4).
  1699         16  CO-ZIP-PLUS4                      PIC X(4).
  1700     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1701         16  CO-CAN-POSTAL-1                   PIC XXX.
  1702         16  CO-CAN-POSTAL-2                   PIC XXX.
  1703         16  FILLER                            PIC XXX.
  1704     12  CO-SOC-SEC                            PIC X(13).
  1705     12  CO-TELEPHONE.
  1706         16  CO-AREA-CODE                      PIC XXX.
  1707         16  CO-PREFIX                         PIC XXX.
  1708         16  CO-PHONE                          PIC X(4).
  1709
  1710     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1711
  1712     12  CO-AR-BAL-LEVEL                       PIC X.
  1713         88  CO-AR-REF-LVL                        VALUE '1'.
  1714         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1715         88  CO-AR-BILL-LVL                       VALUE '2'.
  1716         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  32
* EL050.cbl
  1717         88  CO-AR-FR-LVL                         VALUE '4'.
  1718
  1719     12  CO-AR-NORMAL-PRINT                    PIC X.
  1720         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1721         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1722
  1723     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1724
  1725     12  CO-AR-REPORTING                       PIC X.
  1726         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1727         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1728
  1729     12  CO-AR-PULL-CHECK                      PIC X.
  1730         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1731         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1732
  1733     12  CO-AR-BALANCE-PRINT                   PIC X.
  1734         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1735
  1736     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1737         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1738         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1739         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1740
  1741     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1742
  1743     12  CO-USER-CODE                          PIC X.
  1744     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1745
  1746******************************************************************
  1747*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1748*    THE LAST MONTH END RUN.
  1749******************************************************************
  1750
  1751     12  CO-LAST-ACTIVITY-DATE.
  1752         16  CO-ACT-YEAR                       PIC 99.
  1753         16  CO-ACT-MONTH                      PIC 99.
  1754         16  CO-ACT-DAY                        PIC 99.
  1755
  1756     12  CO-LAST-STMT-DT.
  1757         16  CO-LAST-STMT-YEAR                 PIC 99.
  1758         16  CO-LAST-STMT-MONTH                PIC 99.
  1759         16  CO-LAST-STMT-DAY                  PIC 99.
  1760
  1761     12  CO-MO-END-TOTALS.
  1762         16  CO-MONTHLY-TOTALS.
  1763             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1764             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1765             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1766             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1767             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1768
  1769         16  CO-AGING-TOTALS.
  1770             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1771             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1772             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1773             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1774
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  33
* EL050.cbl
  1775         16  CO-YTD-TOTALS.
  1776             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1777             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1778
  1779         16  CO-OVER-UNDER-TOTALS.
  1780             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1781             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1782
  1783     12  CO-MISCELLANEOUS-TOTALS.
  1784         16  CO-FICA-TOTALS.
  1785             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1786             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1787
  1788         16  CO-CLAIM-TOTALS.
  1789             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1790             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1791
  1792******************************************************************
  1793*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1794*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1795******************************************************************
  1796
  1797     12  CO-CURRENT-TOTALS.
  1798         16  CO-CURRENT-LAST-STMT-DT.
  1799             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1800             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1801             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1802
  1803         16  CO-CURRENT-MONTHLY-TOTALS.
  1804             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1805             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1806             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1807             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1808             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1809
  1810         16  CO-CURRENT-AGING-TOTALS.
  1811             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1812             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1813             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1814             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1815
  1816         16  CO-CURRENT-YTD-TOTALS.
  1817             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1818             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1819
  1820     12  CO-PAID-COMM-TOTALS.
  1821         16  CO-YTD-PAID-COMMS.
  1822             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1823             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1824
  1825     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1826         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1827         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1828
  1829     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1830         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1831         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1832         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  34
* EL050.cbl
  1833         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1834         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1835         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1836         88  CO-FINAL-LETTER                  VALUE 'F'.
  1837         88  CO-RECONCILING                   VALUE 'R'.
  1838         88  CO-PHONE-CALL                    VALUE 'P'.
  1839         88  CO-LEGAL                         VALUE 'L'.
  1840         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1841         88  CO-WRITE-OFF                     VALUE 'W'.
  1842         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1843
  1844     12  CO-CSR-CODE                       PIC X(4).
  1845
  1846     12  CO-GA-STATUS-INFO.
  1847         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1848         16  CO-GA-TERMINATION-DT          PIC XX.
  1849         16  CO-GA-STATUS-CODE             PIC X.
  1850             88  CO-GA-ACTIVE                 VALUE 'A'.
  1851             88  CO-GA-INACTIVE               VALUE 'I'.
  1852             88  CO-GA-PENDING                VALUE 'P'.
  1853         16  CO-GA-COMMENTS.
  1854             20  CO-GA-COMMENT-1           PIC X(40).
  1855             20  CO-GA-COMMENT-2           PIC X(40).
  1856             20  CO-GA-COMMENT-3           PIC X(40).
  1857             20  CO-GA-COMMENT-4           PIC X(40).
  1858
  1859     12  CO-RPTCD2                         PIC X(10).
  1860     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1861         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1862         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1863
  1864     12  CO-TYPE-AGENT                     PIC X(01).
  1865         88  CO-CORPORATION                   VALUE 'C'.
  1866         88  CO-PARTNERSHIP                   VALUE 'P'.
  1867         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1868         88  CO-TRUST                         VALUE 'T'.
  1869         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1870
  1871     12  CO-FAXNO.
  1872         16  CO-FAX-AREA-CODE                  PIC XXX.
  1873         16  CO-FAX-PREFIX                     PIC XXX.
  1874         16  CO-FAX-PHONE                      PIC X(4).
  1875
  1876     12  CO-BANK-INFORMATION.
  1877         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1878         16  CO-BANK-TRANSIT-NON REDEFINES
  1879             CO-BANK-TRANSIT-NO                PIC 9(8).
  1880
  1881         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1882     12  CO-MISC-DEDUCT-INFO REDEFINES
  1883                  CO-BANK-INFORMATION.
  1884         16  CO-MD-GL-ACCT                     PIC X(10).
  1885         16  CO-MD-DIV                         PIC XX.
  1886         16  CO-MD-CENTER                      PIC X(4).
  1887         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1888         16  CO-CREATE-AP-CHECK                PIC X.
  1889         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1890         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  35
* EL050.cbl
  1891     12  CO-ACH-STATUS                         PIC X.
  1892         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1893         88  CO-ACH-PENDING                        VALUE 'P'.
  1894
  1895     12  CO-BILL-SW                            PIC X.
  1896     12  CO-CONTROL-NAME                       PIC X(30).
  1897     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1898     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1899     12  CO-CLP-STATE                          PIC XX.
  1900     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1901     12  CO-SPP-REFUND-EDIT                    PIC X.
  1902
  1903******************************************************************
  1904
  1905*    COPY ERCAGTC.
  1906******************************************************************
  1907*                                                                *
  1908*                                                                *
  1909*                            ERCAGTC                             *
  1910*                            VMOD=2.001                          *
  1911*                                                                *
  1912*   ONLINE CREDIT SYSTEM                                         *
  1913*                                                                *
  1914*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1915*                                                                *
  1916*   FILE TYPE = VSAM,KSDS                                        *
  1917*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1918*                                                                *
  1919*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1920*       ALTERNATE PATH = NONE                                    *
  1921*                                                                *
  1922*   LOG = NO                                                     *
  1923*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1924*                                                                *
  1925******************************************************************
  1926*                   C H A N G E   L O G
  1927*
  1928* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1929*-----------------------------------------------------------------
  1930*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1931* EFFECTIVE    NUMBER
  1932*-----------------------------------------------------------------
  1933* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1934* 111004                         NEW FILE AND COPYBOOK
  1935* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1936******************************************************************
  1937 01  AGENT-COMMISSIONS.
  1938     12  AG-RECORD-ID                          PIC XX.
  1939         88  VALID-CO-ID                          VALUE 'AG'.
  1940     12  AG-CONTROL-PRIMARY.
  1941         16  AG-COMPANY-CD                     PIC X.
  1942         16  AG-CONTROL.
  1943             20  AG-CTL-1.
  1944                 24  AG-CARR-GROUP.
  1945                     28  AG-CARRIER            PIC X.
  1946                     28  AG-GROUPING           PIC X(6).
  1947                 24  AG-BANK                   PIC X(10).
  1948             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  36
* EL050.cbl
  1949                 24  AG-EXP-DT                 PIC XX.
  1950         16  AG-TYPE                           PIC X.
  1951             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1952             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1953     12  AG-MAINT-INFORMATION.
  1954         16  AG-LAST-MAINT-DT                  PIC XX.
  1955         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1956         16  AG-LAST-MAINT-USER                PIC X(4).
  1957         16  FILLER                            PIC X(10).
  1958     12  AG-EFF-DT                             PIC XX.
  1959     12  AG-COMM-STRUCTURE.
  1960         16  AG-AGT-COMMS OCCURS 10.
  1961             20  AG-AGT                PIC X(10).
  1962             20  AG-COM-TYP            PIC X.
  1963             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1964             20  AG-RECALC-LV-INDIC    PIC X.
  1965             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1966             20  AG-LRCALC-LV-INDIC    PIC X.
  1967             20  FILLER                PIC X(05).
  1968     12  FILLER                  PIC X(145).
  1969******************************************************************
  1970*    COPY ERCRESS.
  1971******************************************************************
  1972*                                                                *
  1973*                            ERCRESS                             *
  1974*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1975*                            VMOD=2.002                          *
  1976*                                                                *
  1977*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1978*                                                                *
  1979*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1980*   VSAM RESIDENT STATE TAX MASTER                              *
  1981*                                                                *
  1982*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1983*                                                                *
  1984*   FILE TYPE = VSAM,KSDS                                        *
  1985*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1986*                                                                *
  1987*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1988*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1989*                                                                *
  1990*   LOG = NO                                                     *
  1991*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1992*                                                                *
  1993*                                                                *
  1994******************************************************************
  1995
  1996 01  RESIDENT-STATE-TAX-MASTER.
  1997
  1998     10  ERRESS-PRIMARY-KEY.
  1999         15  RES-COMPANY-CD        PIC X.
  2000         15  RES-RESIDENT-STATE    PIC XX.
  2001         15  RES-COVERAGE-CATEGORY PIC X.
  2002         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2003*                                      YYYYMMDD
  2004*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2005
  2006     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  37
* EL050.cbl
  2007
  2008         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2009         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2010         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2011         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2012
  2013     10 RES-RECALC-SW              PIC   X.
  2014         88 RECALC                VALUE 'Y'.
  2015         88 NO-RECALC             VALUE 'N'.
  2016     10  RES-MAINT-BY              PIC X(4).
  2017     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2018     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2019*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  38
* EL050.cbl
  2021*    COPY ERCRESC.
  2022******************************************************************
  2023*                                                                *
  2024*                            ERCRESC                             *
  2025*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2026*                            VMOD=2.003                          *
  2027*                                                                *
  2028*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2029*                                                                *
  2030*   FILE TYPE = VSAM,KSDS                                        *
  2031*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2032*                                                                *
  2033*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2034*       ALTERNATE PATH1 = NONE                                   *
  2035*                                                                *
  2036*   LOG = NO                                                     *
  2037*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2038*                                                                *
  2039******************************************************************
  2040
  2041 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2042
  2043     10  ERRESC-RECORD-KEY.
  2044         15  RESC-COMPANY-CD           PIC   X.
  2045         15  RESC-CARRIER              PIC   X.
  2046         15  RESC-GROUP                PIC   X(6).
  2047         15  RESC-STATE                PIC   XX.
  2048         15  RESC-ACCOUNT              PIC   X(10).
  2049         15  RESC-AGENT                PIC   X(10).
  2050         15  RESC-RESIDENT-STATE       PIC   XX.
  2051         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2052*                                           YYYYMMDD
  2053     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2054
  2055     10  RESC-COMM-RECORD-DATA.
  2056         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2057             20 RESC-COVERAGE-CAT      PIC    X.
  2058             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2059             20 RESC-COMMISSION-TAB REDEFINES
  2060                RESC-COMMISSION-PER    PIC  XXX.
  2061
  2062     10  RESC-MAINT-BY                 PIC X(4).
  2063     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2064     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2065*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  39
* EL050.cbl
  2067*    COPY ERCPLAN.
  2068******************************************************************
  2069*                                                                *
  2070*                                                                *
  2071*                            ERCPLAN                             *
  2072*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2073*                            VMOD=2.003                          *
  2074*                                                                *
  2075*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2076*                                                                *
  2077*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2078*   PLAN MASTER                                                  *
  2079*                                                                *
  2080*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2081*                                                                *
  2082*   FILE TYPE = VSAM,KSDS                                        *
  2083*   RECORD SIZE = 420   RECFORM = FIX                            *
  2084*                                                                *
  2085*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2086*       ALTERNATE PATH1 = N/A                                    *
  2087*                                                                *
  2088*   LOG = NO                                                     *
  2089*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2090*                                                                *
  2091*                                                                *
  2092******************************************************************
  2093
  2094 01  PLAN-MASTER.
  2095     12  PL-RECORD-ID                      PIC XX.
  2096         88  VALID-PL-ID                      VALUE 'PL'.
  2097
  2098     12  PL-CONTROL-PRIMARY.
  2099         16  PL-COMPANY-CD                 PIC X.
  2100         16  PL-MSTR-CNTRL.
  2101             20  PL-CONTROL-A.
  2102                 24  PL-CARRIER            PIC X.
  2103                 24  PL-GROUPING           PIC X(6).
  2104                 24  PL-STATE              PIC XX.
  2105                 24  PL-ACCOUNT            PIC X(10).
  2106             20  PL-BENEFIT-TYPE           PIC X.
  2107             20  PL-BENEFIT-CODE           PIC XX.
  2108             20  PL-REVISION-NO            PIC X(3).
  2109
  2110     12  PL-CONTROL-BY-VAR-GRP.
  2111         16  PL-COMPANY-CD-A1              PIC X.
  2112         16  PL-VG-CARRIER                 PIC X.
  2113         16  PL-VG-GROUPING                PIC X(6).
  2114         16  PL-VG-STATE                   PIC XX.
  2115         16  PL-VG-ACCOUNT                 PIC X(10).
  2116         16  PL-BENEFIT-TYPE-A1            PIC X.
  2117         16  PL-BENEFIT-CODE-A1            PIC XX.
  2118         16  PL-REVISION-NO-A1             PIC 999.
  2119
  2120     12  PL-MAINT-INFORMATION.
  2121         16  PL-LAST-MAINT-DT              PIC XX.
  2122         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2123         16  PL-LAST-MAINT-USER            PIC X(4).
  2124         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  40
* EL050.cbl
  2125
  2126     12  PL-LIABILITY-LIMITS.
  2127         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2128         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2129             20  PL-LM-AGE                 PIC S99        COMP-3.
  2130             20  PL-LM-DUR                 PIC S999       COMP-3.
  2131             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2132             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2133
  2134     12  FILLER                            PIC X(30).
  2135
  2136     12  PL-GL-ACCOUNT-NOS.
  2137         16  PL-PREMIUM-GL                 PIC X(8).
  2138         16  PL-COMM-GL                    PIC X(8).
  2139         16  PL-CLAIM-GL                   PIC X(8).
  2140     12  FILLER                            PIC X(24).
  2141     12  PL-TOLERANCES.
  2142         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2143         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2144         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2145         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2146         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2147         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2148     12  PL-OVER-SHORT.
  2149         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2150         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2151     12  FILLER                            PIC X(24).
  2152     12  PLAN-MISC.
  2153         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2154         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2155         16  PL-IG                         PIC X.
  2156         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2157         16  PL-POLICY-FORM                PIC X(12).
  2158         16  PL-EDIT-FOR-FORM              PIC X(01).
  2159         16  PL-DEV-CODE                   PIC XXX.
  2160         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2161         16  PL-CALC-METHOD                PIC X.
  2162         16  PL-BENEFIT-GROUP              PIC X(05).
  2163         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2164
  2165         16  FILLER                        PIC X(99).
  2166******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  41
* EL050.cbl
  2168*    COPY ELCCERT.
  2169******************************************************************
  2170*                                                                *
  2171*                            ELCCERT.                            *
  2172*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2173*                            VMOD=2.013                          *
  2174*                                                                *
  2175*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2176*                                                                *
  2177*   FILE TYPE = VSAM,KSDS                                        *
  2178*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2179*                                                                *
  2180*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2181*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2182*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2183*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2184*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2185*                                                                *
  2186*   LOG = YES                                                    *
  2187*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2188******************************************************************
  2189*                   C H A N G E   L O G
  2190*
  2191* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2192*-----------------------------------------------------------------
  2193*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2194* EFFECTIVE    NUMBER
  2195*-----------------------------------------------------------------
  2196* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2197* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2198* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2199* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2200* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2201* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2202* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2203* 032612  CR2011110200001  PEMA  AHL CHANGES
  2204* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2205* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2206******************************************************************
  2207
  2208 01  CERTIFICATE-MASTER.
  2209     12  CM-RECORD-ID                      PIC XX.
  2210         88  VALID-CM-ID                      VALUE 'CM'.
  2211
  2212     12  CM-CONTROL-PRIMARY.
  2213         16  CM-COMPANY-CD                 PIC X.
  2214         16  CM-CARRIER                    PIC X.
  2215         16  CM-GROUPING.
  2216             20  CM-GROUPING-PREFIX        PIC X(3).
  2217             20  CM-GROUPING-PRIME         PIC X(3).
  2218         16  CM-STATE                      PIC XX.
  2219         16  CM-ACCOUNT.
  2220             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2221             20  CM-ACCOUNT-PRIME          PIC X(6).
  2222         16  CM-CERT-EFF-DT                PIC XX.
  2223         16  CM-CERT-NO.
  2224             20  CM-CERT-PRIME             PIC X(10).
  2225             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  42
* EL050.cbl
  2226
  2227     12  CM-CONTROL-BY-NAME.
  2228         16  CM-COMPANY-CD-A1              PIC X.
  2229         16  CM-INSURED-LAST-NAME          PIC X(15).
  2230         16  CM-INSURED-INITIALS.
  2231             20  CM-INSURED-INITIAL1       PIC X.
  2232             20  CM-INSURED-INITIAL2       PIC X.
  2233
  2234     12  CM-CONTROL-BY-SSN.
  2235         16  CM-COMPANY-CD-A2              PIC X.
  2236         16  CM-SOC-SEC-NO.
  2237             20  CM-SSN-STATE              PIC XX.
  2238             20  CM-SSN-ACCOUNT            PIC X(6).
  2239             20  CM-SSN-LN3.
  2240                 25  CM-INSURED-INITIALS-A2.
  2241                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2242                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2243                 25 CM-PART-LAST-NAME-A2         PIC X.
  2244
  2245     12  CM-CONTROL-BY-CERT-NO.
  2246         16  CM-COMPANY-CD-A4              PIC X.
  2247         16  CM-CERT-NO-A4                 PIC X(11).
  2248
  2249     12  CM-CONTROL-BY-MEMB.
  2250         16  CM-COMPANY-CD-A5              PIC X.
  2251         16  CM-MEMBER-NO.
  2252             20  CM-MEMB-STATE             PIC XX.
  2253             20  CM-MEMB-ACCOUNT           PIC X(6).
  2254             20  CM-MEMB-LN4.
  2255                 25  CM-INSURED-INITIALS-A5.
  2256                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2257                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2258                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2259
  2260     12  CM-INSURED-PROFILE-DATA.
  2261         16  CM-INSURED-FIRST-NAME.
  2262             20  CM-INSURED-1ST-INIT       PIC X.
  2263             20  FILLER                    PIC X(9).
  2264         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2265         16  CM-INSURED-SEX                PIC X.
  2266             88  CM-SEX-MALE                  VALUE 'M'.
  2267             88  CM-SEX-FEMAL                 VALUE 'F'.
  2268         16  CM-INSURED-JOINT-AGE          PIC 99.
  2269         16  CM-JOINT-INSURED-NAME.
  2270             20  CM-JT-LAST-NAME           PIC X(15).
  2271             20  CM-JT-FIRST-NAME.
  2272                 24  CM-JT-1ST-INIT        PIC X.
  2273                 24  FILLER                PIC X(9).
  2274             20  CM-JT-INITIAL             PIC X.
  2275
  2276     12  CM-LIFE-DATA.
  2277         16  CM-LF-BENEFIT-CD              PIC XX.
  2278         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2279         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2280         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2281         16  CM-LF-DEV-CODE                PIC XXX.
  2282         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2283         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  43
* EL050.cbl
  2284         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2285         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2286         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2287         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2288         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2289         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2290         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2291         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2292         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2293         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2294         16  cm-temp-epiq                  pic xx.
  2295             88  EPIQ-CLASS                  value 'EQ'.
  2296*        16  FILLER                        PIC XX.
  2297
  2298     12  CM-AH-DATA.
  2299         16  CM-AH-BENEFIT-CD              PIC XX.
  2300         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2301         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2302         16  CM-AH-DEV-CODE                PIC XXX.
  2303         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2304         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2305         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2306         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2307         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2308         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2309         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2310         16  CM-AH-PAID-THRU-DT            PIC XX.
  2311             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2312         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2313         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2314         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2315         16  FILLER                        PIC X.
  2316
  2317     12  CM-LOAN-INFORMATION.
  2318         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2319         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2320                                           PIC S9(5)V99  COMP-3.
  2321         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2322         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2323         16  CM-PAY-FREQUENCY              PIC S99.
  2324         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2325         16  CM-RATE-CLASS                 PIC XX.
  2326         16  CM-BENEFICIARY                PIC X(25).
  2327         16  CM-POLICY-FORM-NO             PIC X(12).
  2328         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2329         16  CM-LAST-ADD-ON-DT             PIC XX.
  2330         16  CM-DEDUCTIBLE-AMOUNTS.
  2331             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2332             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2333         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2334             20  CM-RESIDENT-STATE         PIC XX.
  2335             20  CM-RATE-CODE              PIC X(4).
  2336             20  FILLER                    PIC XX.
  2337         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2338             20  CM-LOAN-OFFICER           PIC X(5).
  2339             20  FILLER                    PIC XXX.
  2340         16  CM-CSR-CODE                   PIC XXX.
  2341         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  44
* EL050.cbl
  2342             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2343         16  CM-POST-CARD-IND              PIC X.
  2344         16  CM-NH-INTERFACE-SW            PIC X.
  2345         16  CM-PREMIUM-TYPE               PIC X.
  2346             88  CM-SING-PRM                  VALUE '1'.
  2347             88  CM-O-B-COVERAGE              VALUE '2'.
  2348             88  CM-OPEN-END                  VALUE '3'.
  2349         16  CM-IND-GRP-TYPE               PIC X.
  2350             88  CM-INDIVIDUAL                VALUE 'I'.
  2351             88  CM-GROUP                     VALUE 'G'.
  2352         16  CM-SKIP-CODE                  PIC X.
  2353             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2354             88  SKIP-JULY                    VALUE '1'.
  2355             88  SKIP-AUGUST                  VALUE '2'.
  2356             88  SKIP-SEPTEMBER               VALUE '3'.
  2357             88  SKIP-JULY-AUG                VALUE '4'.
  2358             88  SKIP-AUG-SEPT                VALUE '5'.
  2359             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2360             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2361             88  SKIP-JUNE                    VALUE '8'.
  2362             88  SKIP-JUNE-JULY               VALUE '9'.
  2363             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2364             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2365         16  CM-PAYMENT-MODE               PIC X.
  2366             88  PAY-MONTHLY                  VALUE SPACE.
  2367             88  PAY-WEEKLY                   VALUE '1'.
  2368             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2369             88  PAY-BI-WEEKLY                VALUE '3'.
  2370             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2371         16  CM-LOAN-NUMBER                PIC X(8).
  2372         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2373         16  CM-OLD-LOF                    PIC XXX.
  2374*        16  CM-LOAN-OFFICER               PIC XXX.
  2375         16  CM-REIN-TABLE                 PIC XXX.
  2376         16  CM-SPECIAL-REIN-CODE          PIC X.
  2377         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2378         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2379         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2380
  2381     12  CM-STATUS-DATA.
  2382         16  CM-ENTRY-STATUS               PIC X.
  2383         16  CM-ENTRY-DT                   PIC XX.
  2384
  2385         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2386         16  CM-LF-CANCEL-DT               PIC XX.
  2387         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2388
  2389         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2390         16  CM-LF-DEATH-DT                PIC XX.
  2391         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2392
  2393         16  CM-LF-CURRENT-STATUS          PIC X.
  2394             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2395                                                'M' '4' '5' '9'.
  2396             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2397             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2398             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2399             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  45
* EL050.cbl
  2400             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2401             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2402             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2403             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2404             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2405             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2406             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2407             88  CM-LF-DECLINED               VALUE 'D'.
  2408             88  CM-LF-VOIDED                 VALUE 'V'.
  2409
  2410         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2411         16  CM-AH-CANCEL-DT               PIC XX.
  2412         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2413
  2414         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2415         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2416         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2417
  2418         16  CM-AH-CURRENT-STATUS          PIC X.
  2419             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2420                                                'M' '4' '5' '9'.
  2421             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2422             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2423             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2424             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2425             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2426             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2427             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2428             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2429             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2430             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2431             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2432             88  CM-AH-DECLINED               VALUE 'D'.
  2433             88  CM-AH-VOIDED                 VALUE 'V'.
  2434
  2435         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2436             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2437             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2438             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2439         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2440
  2441         16  CM-ENTRY-BATCH                PIC X(6).
  2442         16  CM-LF-EXIT-BATCH              PIC X(6).
  2443         16  CM-AH-EXIT-BATCH              PIC X(6).
  2444         16  CM-LAST-MONTH-END             PIC XX.
  2445
  2446     12  CM-NOTE-SW                        PIC X.
  2447         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2448         88  CERT-NOTES-PRESENT               VALUE '1'.
  2449         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2450         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2451         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2452         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2453         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2454         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2455     12  CM-COMP-EXCP-SW                   PIC X.
  2456         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2457         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  46
* EL050.cbl
  2458     12  CM-INSURED-ADDRESS-SW             PIC X.
  2459         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2460         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2461
  2462*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2463     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2464     12  FILLER                            PIC X.
  2465
  2466*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2467     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2468     12  FILLER                            PIC X.
  2469*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2470     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2471
  2472     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2473         88  CERT-ADDED-BATCH                 VALUE ' '.
  2474         88  CERT-ADDED-ONLINE                VALUE '1'.
  2475         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2476         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2477         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2478     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2479         88  CERT-AS-LOADED                   VALUE ' '.
  2480         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2481         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2482         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2483         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2484         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2485         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2486         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2487
  2488     12  CM-ACCOUNT-COMM-PCTS.
  2489         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2490         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2491
  2492     12  CM-USER-FIELD                     PIC X.
  2493     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2494     12  CM-CLP-STATE                      PIC XX.
  2495     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2496     12  CM-USER-RESERVED                  PIC XXX.
  2497     12  FILLER REDEFINES CM-USER-RESERVED.
  2498         16  CM-AH-CLASS-CD                PIC XX.
  2499         16  F                             PIC X.
  2500******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  47
* EL050.cbl
  2502*    COPY ERCMAIL.
  2503******************************************************************
  2504*                                                                *
  2505*                                                                *
  2506*                            ERCMAIL                             *
  2507*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2508*                            VMOD=2.003                          *
  2509*                                                                *
  2510*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2511*                                                                *
  2512*   FILE TYPE = VSAM,KSDS                                        *
  2513*   RECORD SIZE = 374   RECFORM = FIX                            *
  2514*                                                                *
  2515*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2516*   ALTERNATE PATH    = NOT USED                                 *
  2517*                                                                *
  2518*   LOG = YES                                                    *
  2519*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2520******************************************************************
  2521*                   C H A N G E   L O G
  2522*
  2523* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2524*-----------------------------------------------------------------
  2525*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2526* EFFECTIVE    NUMBER
  2527*-----------------------------------------------------------------
  2528* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2529* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2530* 111108                   PEMA  ADD CRED BENE ADDR2
  2531******************************************************************
  2532
  2533 01  MAILING-DATA.
  2534     12  MA-RECORD-ID                      PIC XX.
  2535         88  VALID-MA-ID                       VALUE 'MA'.
  2536
  2537     12  MA-CONTROL-PRIMARY.
  2538         16  MA-COMPANY-CD                 PIC X.
  2539         16  MA-CARRIER                    PIC X.
  2540         16  MA-GROUPING.
  2541             20  MA-GROUPING-PREFIX        PIC XXX.
  2542             20  MA-GROUPING-PRIME         PIC XXX.
  2543         16  MA-STATE                      PIC XX.
  2544         16  MA-ACCOUNT.
  2545             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2546             20  MA-ACCOUNT-PRIME          PIC X(6).
  2547         16  MA-CERT-EFF-DT                PIC XX.
  2548         16  MA-CERT-NO.
  2549             20  MA-CERT-PRIME             PIC X(10).
  2550             20  MA-CERT-SFX               PIC X.
  2551
  2552     12  FILLER                            PIC XX.
  2553
  2554     12  MA-ACCESS-CONTROL.
  2555         16  MA-SOURCE-SYSTEM              PIC XX.
  2556             88  MA-FROM-CREDIT                VALUE 'CR'.
  2557             88  MA-FROM-VSI                   VALUE 'VS'.
  2558             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2559             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  48
* EL050.cbl
  2560         16  MA-RECORD-ADD-DT              PIC XX.
  2561         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2562         16  MA-LAST-MAINT-DT              PIC XX.
  2563         16  MA-LAST-MAINT-BY              PIC XXXX.
  2564         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2565
  2566     12  MA-PROFILE-INFO.
  2567         16  MA-QUALIFY-CODE-1             PIC XX.
  2568         16  MA-QUALIFY-CODE-2             PIC XX.
  2569         16  MA-QUALIFY-CODE-3             PIC XX.
  2570         16  MA-QUALIFY-CODE-4             PIC XX.
  2571         16  MA-QUALIFY-CODE-5             PIC XX.
  2572
  2573         16  MA-INSURED-LAST-NAME          PIC X(15).
  2574         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2575         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2576         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2577         16  MA-INSURED-BIRTH-DT           PIC XX.
  2578         16  MA-INSURED-SEX                PIC X.
  2579             88  MA-SEX-MALE                   VALUE 'M'.
  2580             88  MA-SEX-FEMALE                 VALUE 'F'.
  2581         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2582
  2583         16  MA-ADDRESS-CORRECTED          PIC X.
  2584         16  MA-JOINT-BIRTH-DT             PIC XX.
  2585*        16  FILLER                        PIC X(12).
  2586
  2587         16  MA-ADDRESS-LINE-1             PIC X(30).
  2588         16  MA-ADDRESS-LINE-2             PIC X(30).
  2589         16  MA-CITY-STATE.
  2590             20  MA-CITY                   PIC X(28).
  2591             20  MA-ADDR-STATE             PIC XX.
  2592         16  MA-ZIP.
  2593             20  MA-ZIP-CODE.
  2594                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2595                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2596                 24  FILLER                PIC X(4).
  2597             20  MA-ZIP-PLUS4              PIC X(4).
  2598         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2599             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2600             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2601             20  FILLER                    PIC X(3).
  2602
  2603         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2604
  2605         16  FILLER                        PIC XXX.
  2606*        16  FILLER                        PIC X(10).
  2607
  2608     12  MA-CRED-BENE-INFO.
  2609         16  MA-CRED-BENE-NAME                 PIC X(25).
  2610         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2611         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2612         16  MA-CRED-BENE-CTYST.
  2613             20  MA-CRED-BENE-CITY             PIC X(28).
  2614             20  MA-CRED-BENE-STATE            PIC XX.
  2615         16  MA-CRED-BENE-ZIP.
  2616             20  MA-CB-ZIP-CODE.
  2617                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  49
* EL050.cbl
  2618                     88  MA-CB-CANADIAN-POST-CODE
  2619                                           VALUE 'A' THRU 'Z'.
  2620                 24  FILLER                    PIC X(4).
  2621             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2622         16  MA-CB-CANADIAN-POSTAL-CODE
  2623                            REDEFINES MA-CRED-BENE-ZIP.
  2624             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2625             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2626             20  FILLER                        PIC X(3).
  2627     12  MA-POST-CARD-MAIL-DATA.
  2628         16  MA-MAIL-DATA OCCURS 7.
  2629             20  MA-MAIL-TYPE              PIC X.
  2630                 88  MA-12MO-MAILING           VALUE '1'.
  2631                 88  MA-EXP-MAILING            VALUE '2'.
  2632             20  MA-MAIL-STATUS            PIC X.
  2633                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2634                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2635                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2636             20  MA-MAIL-DATE              PIC XX.
  2637     12  FILLER                            PIC XX.
  2638     12  FILLER                            PIC XX.
  2639*    12  FILLER                            PIC X(30).
  2640******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  50
* EL050.cbl
  2642*    COPY ERCPNDM.
  2643******************************************************************
  2644*                                                                *
  2645*                                                                *
  2646*                            ERCPNDM                             *
  2647*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2648*                            VMOD=2.003                          *
  2649*                                                                *
  2650*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2651*                                                                *
  2652*   FILE TYPE = VSAM,KSDS                                        *
  2653*   RECORD SIZE = 374   RECFORM = FIX                            *
  2654*                                                                *
  2655*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2656*   ALTERNATE PATH    = NOT USED                                 *
  2657*                                                                *
  2658*   LOG = YES                                                    *
  2659*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2660******************************************************************
  2661*                   C H A N G E   L O G
  2662*
  2663* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2664*-----------------------------------------------------------------
  2665*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2666* EFFECTIVE    NUMBER
  2667*-----------------------------------------------------------------
  2668* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2669* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2670* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2671* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2672******************************************************************
  2673
  2674 01  PENDING-MAILING-DATA.
  2675     12  PM-RECORD-ID                      PIC XX.
  2676         88  VALID-MA-ID                       VALUE 'PM'.
  2677
  2678     12  PM-CONTROL-PRIMARY.
  2679         16  PM-COMPANY-CD                 PIC X.
  2680         16  PM-ENTRY-BATCH                PIC X(6).
  2681         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2682         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2683
  2684     12  FILLER                            PIC X(14).
  2685
  2686     12  PM-ACCESS-CONTROL.
  2687         16  PM-SOURCE-SYSTEM              PIC XX.
  2688             88  PM-FROM-CREDIT                VALUE 'CR'.
  2689             88  PM-FROM-VSI                   VALUE 'VS'.
  2690             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2691             88  PM-FROM-OTHER                 VALUE 'OT'.
  2692         16  PM-RECORD-ADD-DT              PIC XX.
  2693         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2694         16  PM-LAST-MAINT-DT              PIC XX.
  2695         16  PM-LAST-MAINT-BY              PIC XXXX.
  2696         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2697
  2698     12  PM-PROFILE-INFO.
  2699         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  51
* EL050.cbl
  2700         16  PM-QUALIFY-CODE-2             PIC XX.
  2701         16  PM-QUALIFY-CODE-3             PIC XX.
  2702         16  PM-QUALIFY-CODE-4             PIC XX.
  2703         16  PM-QUALIFY-CODE-5             PIC XX.
  2704
  2705         16  PM-INSURED-LAST-NAME          PIC X(15).
  2706         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2707         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2708         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2709         16  PM-INSURED-BIRTH-DT           PIC XX.
  2710         16  PM-INSURED-SEX                PIC X.
  2711             88  PM-SEX-MALE                   VALUE 'M'.
  2712             88  PM-SEX-FEMALE                 VALUE 'F'.
  2713         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2714
  2715         16  PM-ADDRESS-CORRECTED          PIC X.
  2716         16  PM-JOINT-BIRTH-DT             PIC XX.
  2717*        16  FILLER                        PIC X(12).
  2718
  2719         16  PM-ADDRESS-LINE-1             PIC X(30).
  2720         16  PM-ADDRESS-LINE-2             PIC X(30).
  2721         16  PM-CITY-STATE.
  2722             20  PM-CITY                   PIC X(28).
  2723             20  PM-STATE                  PIC XX.
  2724         16  PM-ZIP.
  2725             20  PM-ZIP-CODE.
  2726                 24  PM-ZIP-1              PIC X.
  2727                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2728                 24  FILLER                PIC X(4).
  2729             20  PM-ZIP-PLUS4              PIC X(4).
  2730         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2731             20  PM-CAN-POST1              PIC XXX.
  2732             20  PM-CAN-POST2              PIC XXX.
  2733             20  FILLER                    PIC XXX.
  2734
  2735         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2736         16  pm-city-st-zip-verified       pic x.
  2737         16  FILLER                        PIC XX.
  2738
  2739     12  PM-CRED-BENE-INFO.
  2740         16  PM-CRED-BENE-NAME             PIC X(25).
  2741         16  PM-CRED-BENE-ADDR             PIC X(30).
  2742         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2743         16  PM-CRED-BENE-CTYST.
  2744             20  PM-CRED-BENE-CITY         PIC X(28).
  2745             20  PM-CRED-BENE-STATE        PIC XX.
  2746         16  PM-CRED-BENE-ZIP.
  2747             20  PM-CB-ZIP-CODE.
  2748                 24  PM-CB-ZIP-1           PIC X.
  2749                     88  PM-CB-CANADIAN-POST-CODE
  2750                                  VALUE 'A' THRU 'Z'.
  2751                 24  FILLER                PIC X(4).
  2752             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2753         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2754             20  PM-CB-CAN-POST1           PIC XXX.
  2755             20  PM-CB-CAN-POST2           PIC XXX.
  2756             20  FILLER                    PIC XXX.
  2757     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  52
* EL050.cbl
  2758         16  PM-MAIL-DATA OCCURS 7.
  2759             20  PM-MAIL-TYPE              PIC X.
  2760                 88  PM-12MO-MAILING           VALUE '1'.
  2761                 88  PM-EXP-MAILING            VALUE '2'.
  2762             20  PM-MAIL-STATUS            PIC X.
  2763                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2764                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2765                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2766             20  PM-MAIL-DATE              PIC XX.
  2767     12  FILLER                            PIC XX.
  2768     12  FILLER                            PIC X(12).
  2769*    12  FILLER                            PIC X(30).
  2770
  2771******************************************************************
  2772*                                COPY ERCLOFC.
  2773******************************************************************
  2774*                                                                *
  2775*                                                                *
  2776*                            ERCLOFC                             *
  2777*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2778*                            VMOD=2.003                          *
  2779*                                                                *
  2780*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2781*                                                                *
  2782*   FILE TYPE = VSAM,KSDS                                        *
  2783*   RECORD SIZE = 670   RECFORM = FIX                            *
  2784*                                                                *
  2785*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2786*                                                                *
  2787*   LOG = YES                                                    *
  2788*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2789*                                                                *
  2790******************************************************************
  2791
  2792 01  LOAN-OFFICER-MASTER.
  2793     12  LO-RECORD-ID                PIC XX.
  2794         88  VALID-LO-ID                VALUE 'LO'.
  2795
  2796     12  LO-CONTROL-PRIMARY.
  2797         16  LO-COMPANY-CD           PIC X.
  2798         16  LO-CARRIER              PIC X.
  2799         16  LO-GROUPING.
  2800             20  LO-GROUPING-PREFIX  PIC XXX.
  2801             20  LO-GROUPING-PRIME   PIC XXX.
  2802         16  LO-STATE                PIC XX.
  2803         16  LO-ACCOUNT.
  2804             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2805             20  LO-ACCOUNT-PRIME    PIC X(6).
  2806         16  LO-OFFICER-CODE         PIC X(5).
  2807
  2808     12  LO-OFFICER-NAME             PIC X(30).
  2809
  2810     12  LO-LAST-MAINT-DT            PIC XX.
  2811     12  LO-LAST-USER                PIC X(4).
  2812     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2813
  2814     12  LO-COMP-CONTROL             PIC X.
  2815             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  53
* EL050.cbl
  2816             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2817     12  LO-DETAIL-CONTROL           PIC X.
  2818             88  LO-PRINT-DETAIL        VALUE 'D'.
  2819             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2820
  2821     12  LO-SV-CARRIER               PIC X.
  2822     12  LO-SV-GROUPING              PIC X(6).
  2823     12  LO-SV-STATE                 PIC XX.
  2824
  2825     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2826     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2827
  2828     12  LO-OFFICER-INFO.
  2829         16  FILLER OCCURS 12 TIMES.
  2830             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2831             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2832             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2833             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2834             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2835             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2836             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2837             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2838     12  FILLER                      PIC X(198).
  2839******************************************************************
  2840*                                COPY ERCPDEF.
  2841******************************************************************
  2842*                                                                *
  2843*                                                                *
  2844*                            ERCPDEF.                            *
  2845*                                                                *
  2846*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2847*                                                                *
  2848*    FILE TYPE = VSAM,KSDS                                       *
  2849*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2850*                                                                *
  2851*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2852*                                                                *
  2853*    LOG = YES                                                   *
  2854*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2855******************************************************************
  2856*                   C H A N G E   L O G
  2857*
  2858* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2859*-----------------------------------------------------------------
  2860*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2861* EFFECTIVE    NUMBER
  2862*-----------------------------------------------------------------
  2863* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2864* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2865* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2866******************************************************************
  2867 01  PRODUCT-MASTER.
  2868    12  PD-RECORD-ID                 PIC X(02).
  2869        88  VALID-PD-ID                  VALUE 'PD'.
  2870    12  PD-CONTROL-PRIMARY.
  2871        16  PD-COMPANY-CD            PIC X.
  2872        16  PD-STATE                 PIC XX.
  2873        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  54
* EL050.cbl
  2874        16  PD-FILLER                PIC X(7).
  2875        16  PD-BEN-TYPE              PIC X.
  2876        16  PD-BEN-CODE              PIC XX.
  2877        16  PD-PROD-EXP-DT           PIC XX.
  2878    12  FILLER                       PIC X(50).
  2879    12  PD-PRODUCT-DATA OCCURS 8.
  2880        16  PD-PROD-CODE             PIC X.
  2881            88  PD-PROD-LIFE           VALUE 'L'.
  2882            88  PD-PROD-PROP           VALUE 'P'.
  2883            88  PD-PROD-AH             VALUE 'A'.
  2884            88  PD-PROD-IU             VALUE 'I'.
  2885            88  PD-PROD-GAP            VALUE 'G'.
  2886            88  PD-PROD-FAML           VALUE 'F'.
  2887        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2888        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2889        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2890        16  PD-MAX-TERM              PIC S999        COMP-3.
  2891        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2892        16  FILLER                   PIC X.
  2893        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2894        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2895        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2896        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2897        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2898        16  PD-REC-CRIT-PERIOD       PIC 99.
  2899        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2900            20  PD-RECURRING-YN      PIC X.
  2901            20  FILLER               PIC X.
  2902        16  PD-RTW-MOS               PIC 99.
  2903        16  PD-MAX-EXTENSION         PIC 99.
  2904        16  pd-ben-pct               pic sv999 comp-3.
  2905*       16  FILLER                   PIC XX.
  2906    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2907    12  PD-TERM-LIMITS OCCURS 15.
  2908        16  PD-LOW-TERM              PIC S999        COMP-3.
  2909        16  PD-HI-TERM               PIC S999        COMP-3.
  2910*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2911    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2912        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2913        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2914    12  PD-EARN-FACTORS.
  2915        16  FILLER OCCURS 15.
  2916            20  FILLER OCCURS 15.
  2917                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2918    12  PD-PRODUCT-DESC              PIC X(80).
  2919    12  PD-TRUNCATED                 PIC X.
  2920    12  FILLER                       PIC X(59).
  2921    12  PD-MAINT-INFORMATION.
  2922        16  PD-LAST-MAINT-DT         PIC X(02).
  2923        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2924        16  PD-LAST-MAINT-BY         PIC X(04).
  2925*                                COPY ELCSTATE.
  2926******************************************************************
  2927*                                                                *
  2928*                                                                *
  2929*                            ELCSTATE.                           *
  2930*                                                                *
  2931*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  55
* EL050.cbl
  2932*                                                                *
  2933*   FILE TYPE = VSAM,KSDS                                        *
  2934*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2935*                                                                *
  2936*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2937*       ALTERNATE INDEX = NONE                                   *
  2938*                                                                *
  2939*   LOG = YES                                                    *
  2940*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2941******************************************************************
  2942*                   C H A N G E   L O G
  2943*
  2944* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2945*-----------------------------------------------------------------
  2946*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2947* EFFECTIVE    NUMBER
  2948*-----------------------------------------------------------------
  2949* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2950******************************************************************
  2951*
  2952 01  STATE-FILE.
  2953     12  SF-RECORD-ID                       PIC XX.
  2954         88  VALID-CF-ID                        VALUE 'SF'.
  2955     12  SF-CONTROL-PRIMARY.
  2956         16  SF-COMPANY-ID                  PIC XXX.
  2957         16  SF-CARRIER-CODE                PIC X.
  2958         16  SF-GROUPING                    PIC X(6).
  2959         16  SF-STATE-CODE                  PIC XX.
  2960         16  SF-EXPIRE-DATE                 PIC 9(8).
  2961****************************************************************
  2962*             STATE CONTROLS
  2963****************************************************************
  2964     12  SF-LAST-MAINT-DT                   PIC XX.
  2965     12  SF-LAST-MAINT-BY                   PIC X(4).
  2966     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2967     12  SF-STATE-RT-CONTROLS.
  2968         16  SF-ST-RT-CALC                  PIC X.
  2969     12  SF-ST-TAX-CONTROLS.
  2970         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2971         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2972         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2973     12  SF-ST-REFUND-OPTIONS.
  2974         16  SF-ST-RF-LR-CALC               PIC X.
  2975         16  SF-ST-RF-LL-CALC               PIC X.
  2976         16  SF-ST-RF-LN-CALC               PIC X.
  2977         16  SF-ST-RF-AH-CALC               PIC X.
  2978         16  SF-ST-RF-CP-CALC               PIC X.
  2979     12  SF-ST-UNEARN-PREM-OPTIONS.
  2980         16  SF-ST-LUEP-R78                 PIC X.
  2981         16  SF-ST-LUEP-PRO                 PIC X.
  2982         16  SF-ST-LUEP-ST                  PIC X.
  2983         16  SF-ST-LUEP-DOM                 PIC X.
  2984         16  SF-ST-AUEP-R78                 PIC X.
  2985         16  SF-ST-AUEP-PRO                 PIC X.
  2986         16  SF-ST-AUEP-ST                  PIC X.
  2987         16  SF-ST-AUEP-DOM                 PIC X.
  2988         16  SF-ST-CUEP-R78                 PIC X.
  2989         16  SF-ST-CUEP-PRO                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  56
* EL050.cbl
  2990         16  SF-ST-CUEP-ST                  PIC X.
  2991         16  SF-ST-CUEP-DOM                 PIC X.
  2992     12  SF-ST-EARN-PREM-OPTIONS.
  2993         16  SF-ST-LEP-R78                  PIC X.
  2994         16  SF-ST-LEP-PRO                  PIC X.
  2995         16  SF-ST-LEP-ST                   PIC X.
  2996         16  SF-ST-LEP-DOM                  PIC X.
  2997         16  SF-ST-AEP-R78                  PIC X.
  2998         16  SF-ST-AEP-PRO                  PIC X.
  2999         16  SF-ST-AEP-ST                   PIC X.
  3000         16  SF-ST-AEP-DOM                  PIC X.
  3001         16  SF-ST-CEP-R78                  PIC X.
  3002         16  SF-ST-CEP-PRO                  PIC X.
  3003         16  SF-ST-CEP-ST                   PIC X.
  3004         16  SF-ST-CEP-DOM                  PIC X.
  3005     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  57
* EL050.cbl
  3007*    COPY ELCCRTT.
  3008******************************************************************
  3009*                                                                *
  3010*                            ELCCRTT.                            *
  3011*                                                                *
  3012*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3013*                                                                *
  3014*   FILE TYPE = VSAM,KSDS                                        *
  3015*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3016*                                                                *
  3017*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3018*                                                                *
  3019*   LOG = YES                                                    *
  3020*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3021******************************************************************
  3022*                   C H A N G E   L O G
  3023*
  3024* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3025*-----------------------------------------------------------------
  3026*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3027* EFFECTIVE    NUMBER
  3028*-----------------------------------------------------------------
  3029* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3030* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3031* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3032* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3033* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3034* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3035* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3036* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3037* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3038******************************************************************
  3039
  3040 01  CERTIFICATE-TRAILERS.
  3041     12  CS-RECORD-ID                      PIC XX.
  3042         88  VALID-CS-ID                      VALUE 'CS'.
  3043
  3044     12  CS-CONTROL-PRIMARY.
  3045         16  CS-COMPANY-CD                 PIC X.
  3046         16  CS-CARRIER                    PIC X.
  3047         16  CS-GROUPING                   PIC X(6).
  3048         16  CS-STATE                      PIC XX.
  3049         16  CS-ACCOUNT                    PIC X(10).
  3050         16  CS-CERT-EFF-DT                PIC XX.
  3051         16  CS-CERT-NO.
  3052             20  CS-CERT-PRIME             PIC X(10).
  3053             20  CS-CERT-SFX               PIC X.
  3054         16  CS-TRAILER-TYPE               PIC X.
  3055             88  COMM-TRLR           VALUE 'A'.
  3056             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3057             88  CERT-DATA-TRLR      VALUE 'C'.
  3058
  3059     12  CS-DATA-AREA                      PIC X(516).
  3060
  3061     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3062         16  CS-BANK-COMMISSION-AREA.
  3063             20  CS-BANK-COMMS       OCCURS 10.
  3064                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  58
* EL050.cbl
  3065                 24  CS-COM-TYP            PIC X.
  3066                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3067                 24  CS-RECALC-LV-INDIC    PIC X.
  3068                 24  FILLER                PIC X(10).
  3069         16  FILLER                        PIC X(256).
  3070
  3071     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3072****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3073         16  CS-MB-CLAIM-DATA OCCURS 24.
  3074             20  CS-CLAIM-NO               PIC X(7).
  3075             20  CS-CLAIM-TYPE             PIC X.
  3076                 88  CS-AH-CLM               VALUE 'A'.
  3077                 88  CS-IU-CLM               VALUE 'I'.
  3078                 88  CS-GP-CLM               VALUE 'G'.
  3079                 88  CS-LF-CLM               VALUE 'L'.
  3080                 88  CS-PR-CLM               VALUE 'P'.
  3081                 88  CS-FL-CLM               VALUE 'F'.
  3082             20  CS-INSURED-TYPE           PIC X.
  3083                 88  CS-PRIM-INSURED          VALUE 'P'.
  3084                 88  CS-CO-BORROWER           VALUE 'C'.
  3085             20  CS-BENEFIT-PERIOD         PIC 99.
  3086             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3087             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3088             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3089         16  FILLER                        PIC X(12).
  3090     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3091         16  CS-VIN-NUMBER                 PIC X(17).
  3092         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3093         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3094         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3095         16  cs-agent-name.
  3096             20  cs-agent-fname            pic x(20).
  3097             20  cs-agent-mi               pic x.
  3098             20  cs-agent-lname            pic x(25).
  3099         16  cs-license-no                 pic x(15).
  3100         16  cs-npn-number                 pic x(10).
  3101         16  cs-agent-edit-status          pic x.
  3102             88  cs-ae-refer-to-manager      value 'M'.
  3103             88  cs-ae-cover-sheet           value 'C'.
  3104             88  cs-ae-sig-form              value 'S'.
  3105             88  cs-ae-verified              value 'V'.
  3106             88  cs-unidentified-signature   value 'U'.
  3107             88  cs-cert-returned            value 'R'.
  3108             88  cs-accept-no-commission     value 'N'.
  3109         16  cs-year                       pic 9999.
  3110         16  cs-make                       pic x(20).
  3111         16  cs-model                      pic x(20).
  3112         16  cs-future                     pic x(20).
  3113         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3114         16  FILLER                        PIC X(356). *> was 420
  3115*        16  FILLER                        PIC X(496).
  3116*    COPY ELCCRTO.
  3117******************************************************************
  3118*                                                                *
  3119*                            ELCCRTO.                            *
  3120*                                                                *
  3121*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3122*                                                                *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  59
* EL050.cbl
  3123*   FILE TYPE = VSAM,KSDS                                        *
  3124*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3125*                                                                *
  3126*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3127*                                                                *
  3128*   LOG = YES                                                    *
  3129*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3130******************************************************************
  3131*                   C H A N G E   L O G
  3132*
  3133* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3134*-----------------------------------------------------------------
  3135*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3136* EFFECTIVE    NUMBER
  3137*-----------------------------------------------------------------
  3138* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3139* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3140* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3141* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3142* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3143******************************************************************
  3144 01  ORIGINAL-CERTIFICATE.
  3145     12  OC-RECORD-ID                      PIC XX.
  3146         88  VALID-OC-ID                      VALUE 'OC'.
  3147     12  OC-CONTROL-PRIMARY.
  3148         16  OC-COMPANY-CD                 PIC X.
  3149         16  OC-CARRIER                    PIC X.
  3150         16  OC-GROUPING                   PIC X(6).
  3151         16  OC-STATE                      PIC XX.
  3152         16  OC-ACCOUNT                    PIC X(10).
  3153         16  OC-CERT-EFF-DT                PIC XX.
  3154         16  OC-CERT-NO.
  3155             20  OC-CERT-PRIME             PIC X(10).
  3156             20  OC-CERT-SFX               PIC X.
  3157         16  OC-RECORD-TYPE                PIC X.
  3158         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3159     12  OC-LAST-MAINT-DT                  PIC XX.
  3160     12  OC-LAST-MAINT-BY                  PIC X(4).
  3161     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3162     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3163     12  FILLER                            PIC X(49).
  3164     12  OC-ORIG-REC.
  3165         16  OC-INS-LAST-NAME              PIC X(15).
  3166         16  OC-INS-FIRST-NAME             PIC X(10).
  3167         16  OC-INS-MIDDLE-INIT            PIC X.
  3168         16  OC-INS-AGE                    PIC S999     COMP-3.
  3169         16  OC-JNT-LAST-NAME              PIC X(15).
  3170         16  OC-JNT-FIRST-NAME             PIC X(10).
  3171         16  OC-JNT-MIDDLE-INIT            PIC X.
  3172         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3173         16  OC-LF-BENCD                   PIC XX.
  3174         16  OC-LF-TERM                    PIC S999      COMP-3.
  3175         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3176         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3177         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3178         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3179         16  OC-LF-EXP-DT                  PIC XX.
  3180         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  60
* EL050.cbl
  3181         16  OC-LF-CANCEL-DT               PIC XX.
  3182         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3183         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3184         16  OC-AH-BENCD                   PIC XX.
  3185         16  OC-AH-TERM                    PIC S999      COMP-3.
  3186         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3187         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3188         16  OC-AH-EXP-DT                  PIC XX.
  3189         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3190         16  OC-AH-CP                      PIC 99.
  3191         16  OC-AH-CANCEL-DT               PIC XX.
  3192         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3193         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3194         16  OC-CRED-BENE-NAME             PIC X(25).
  3195         16  OC-1ST-PMT-DT                 PIC XX.
  3196         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3197         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3198         16  OC-ISSUE-TRAN-IND             PIC X.
  3199         16  OC-CANCEL-TRAN-IND            PIC X.
  3200         16  FILLER                        PIC X(211).
  3201
  3202     12  FILLER                            PIC X(50).
  3203******************************************************************
  3204
  3205*    COPY ELCDATE.
  3206******************************************************************
  3207*                                                                *
  3208*                                                                *
  3209*                            ELCDATE.                            *
  3210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3211*                            VMOD=2.003
  3212*                                                                *
  3213*                                                                *
  3214*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3215*                 LENGTH = 200                                   *
  3216******************************************************************
  3217
  3218 01  DATE-CONVERSION-DATA.
  3219     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3220     12  DC-OPTION-CODE                PIC X.
  3221         88  BIN-TO-GREG                VALUE ' '.
  3222         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3223         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3224         88  YMD-GREG-TO-BIN            VALUE '3'.
  3225         88  MDY-GREG-TO-BIN            VALUE '4'.
  3226         88  JULIAN-TO-BIN              VALUE '5'.
  3227         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3228         88  FIND-CENTURY               VALUE '7'.
  3229         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3230         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3231         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3232         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3233         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3234         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3235         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3236         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3237         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3238         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  61
* EL050.cbl
  3239         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3240         88  BIN-3-TO-GREG              VALUE 'I'.
  3241         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3242         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3243         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3244         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3245         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3246         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3247         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3248         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3249         88  THREE-CHARACTER-BIN
  3250                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3251         88  GREGORIAN-TO-BIN
  3252                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3253         88  BIN-TO-GREGORIAN
  3254                  VALUES ' ' '1' 'I' '8' 'G'.
  3255         88  JULIAN-TO-BINARY
  3256                  VALUES '5' 'C' 'E' 'F'.
  3257     12  DC-ERROR-CODE                 PIC X.
  3258         88  NO-CONVERSION-ERROR        VALUE ' '.
  3259         88  DATE-CONVERSION-ERROR
  3260                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3261         88  DATE-IS-ZERO               VALUE '1'.
  3262         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3263         88  DATE-IS-INVALID            VALUE '3'.
  3264         88  DATE1-GREATER-DATE2        VALUE '4'.
  3265         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3266         88  DATE-INVALID-OPTION        VALUE '9'.
  3267         88  INVALID-CENTURY            VALUE 'A'.
  3268         88  ONLY-CENTURY               VALUE 'B'.
  3269         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3270         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3271     12  DC-END-OF-MONTH               PIC X.
  3272         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3273     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3274         88  USE-NORMAL-PROCESS         VALUE ' '.
  3275         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3276         88  ADJUST-UP-100-YRS          VALUE '2'.
  3277     12  FILLER                        PIC X.
  3278     12  DC-CONVERSION-DATES.
  3279         16  DC-BIN-DATE-1             PIC XX.
  3280         16  DC-BIN-DATE-2             PIC XX.
  3281         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3282         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3283                       DC-GREG-DATE-1-EDIT.
  3284             20  DC-EDIT1-MONTH        PIC 99.
  3285             20  SLASH1-1              PIC X.
  3286             20  DC-EDIT1-DAY          PIC 99.
  3287             20  SLASH1-2              PIC X.
  3288             20  DC-EDIT1-YEAR         PIC 99.
  3289         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3290         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3291                     DC-GREG-DATE-2-EDIT.
  3292             20  DC-EDIT2-MONTH        PIC 99.
  3293             20  SLASH2-1              PIC X.
  3294             20  DC-EDIT2-DAY          PIC 99.
  3295             20  SLASH2-2              PIC X.
  3296             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  62
* EL050.cbl
  3297         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3298         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3299                     DC-GREG-DATE-1-YMD.
  3300             20  DC-YMD-YEAR           PIC 99.
  3301             20  DC-YMD-MONTH          PIC 99.
  3302             20  DC-YMD-DAY            PIC 99.
  3303         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3304         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3305                      DC-GREG-DATE-1-MDY.
  3306             20  DC-MDY-MONTH          PIC 99.
  3307             20  DC-MDY-DAY            PIC 99.
  3308             20  DC-MDY-YEAR           PIC 99.
  3309         16  DC-GREG-DATE-1-ALPHA.
  3310             20  DC-ALPHA-MONTH        PIC X(10).
  3311             20  DC-ALPHA-DAY          PIC 99.
  3312             20  FILLER                PIC XX.
  3313             20  DC-ALPHA-CENTURY.
  3314                 24 DC-ALPHA-CEN-N     PIC 99.
  3315             20  DC-ALPHA-YEAR         PIC 99.
  3316         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3317         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3318         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3319         16  DC-JULIAN-DATE            PIC 9(05).
  3320         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3321                                       PIC 9(05).
  3322         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3323             20  DC-JULIAN-YEAR        PIC 99.
  3324             20  DC-JULIAN-DAYS        PIC 999.
  3325         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3326         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3327         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3328     12  DATE-CONVERSION-VARIBLES.
  3329         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3330         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3331             20  FILLER                PIC 9(3).
  3332             20  HOLD-CEN-1-CCYY.
  3333                 24  HOLD-CEN-1-CC     PIC 99.
  3334                 24  HOLD-CEN-1-YY     PIC 99.
  3335             20  HOLD-CEN-1-MO         PIC 99.
  3336             20  HOLD-CEN-1-DA         PIC 99.
  3337         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3338             20  HOLD-CEN-1-R-MO       PIC 99.
  3339             20  HOLD-CEN-1-R-DA       PIC 99.
  3340             20  HOLD-CEN-1-R-CCYY.
  3341                 24  HOLD-CEN-1-R-CC   PIC 99.
  3342                 24  HOLD-CEN-1-R-YY   PIC 99.
  3343             20  FILLER                PIC 9(3).
  3344         16  HOLD-CENTURY-1-X.
  3345             20  FILLER                PIC X(3)  VALUE SPACES.
  3346             20  HOLD-CEN-1-X-CCYY.
  3347                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3348                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3349             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3350             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3351         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3352             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3353             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3354             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  63
* EL050.cbl
  3355                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3356                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3357             20  FILLER                PIC XXX.
  3358         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3359         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3360         16  DC-JULIAN-DATE-1          PIC 9(07).
  3361         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3362             20  DC-JULIAN-1-CCYY.
  3363                 24  DC-JULIAN-1-CC    PIC 99.
  3364                 24  DC-JULIAN-1-YR    PIC 99.
  3365             20  DC-JULIAN-DA-1        PIC 999.
  3366         16  DC-JULIAN-DATE-2          PIC 9(07).
  3367         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3368             20  DC-JULIAN-2-CCYY.
  3369                 24  DC-JULIAN-2-CC    PIC 99.
  3370                 24  DC-JULIAN-2-YR    PIC 99.
  3371             20  DC-JULIAN-DA-2        PIC 999.
  3372         16  DC-GREG-DATE-A-EDIT.
  3373             20  DC-EDITA-MONTH        PIC 99.
  3374             20  SLASHA-1              PIC X VALUE '/'.
  3375             20  DC-EDITA-DAY          PIC 99.
  3376             20  SLASHA-2              PIC X VALUE '/'.
  3377             20  DC-EDITA-CCYY.
  3378                 24  DC-EDITA-CENT     PIC 99.
  3379                 24  DC-EDITA-YEAR     PIC 99.
  3380         16  DC-GREG-DATE-B-EDIT.
  3381             20  DC-EDITB-MONTH        PIC 99.
  3382             20  SLASHB-1              PIC X VALUE '/'.
  3383             20  DC-EDITB-DAY          PIC 99.
  3384             20  SLASHB-2              PIC X VALUE '/'.
  3385             20  DC-EDITB-CCYY.
  3386                 24  DC-EDITB-CENT     PIC 99.
  3387                 24  DC-EDITB-YEAR     PIC 99.
  3388         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3389         16  DC-GREG-DATE-CYMD-R REDEFINES
  3390                              DC-GREG-DATE-CYMD.
  3391             20  DC-CYMD-CEN           PIC 99.
  3392             20  DC-CYMD-YEAR          PIC 99.
  3393             20  DC-CYMD-MONTH         PIC 99.
  3394             20  DC-CYMD-DAY           PIC 99.
  3395         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3396         16  DC-GREG-DATE-MDCY-R REDEFINES
  3397                              DC-GREG-DATE-MDCY.
  3398             20  DC-MDCY-MONTH         PIC 99.
  3399             20  DC-MDCY-DAY           PIC 99.
  3400             20  DC-MDCY-CEN           PIC 99.
  3401             20  DC-MDCY-YEAR          PIC 99.
  3402    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3403        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3404    12  DC-EL310-DATE                  PIC X(21).
  3405    12  FILLER                         PIC X(28).
  3406
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  64
* EL050.cbl
  3408*    COPY ELCCALC.
  3409******************************************************************
  3410*                                                                *
  3411*                           ELCCALC.                            *
  3412*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3413*                            VMOD=2.025                          *
  3414*                                                                *
  3415*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3416*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3417*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3418*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3419*                                                                *
  3420*  PASSED TO ELRTRM                                              *
  3421*  -----------------                                             *
  3422*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3423*  ORIGINAL TERM                                                 *
  3424*  BEGINNING DATE                                                *
  3425*  ENDING DATE                                                   *
  3426*  COMPANY I.D.                                                  *
  3427*  ACCOUNT MASTER USER FIELD                                     *
  3428*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3429*  FREE LOOK DAYS                                                *
  3430*                                                                *
  3431*  RETURNED FROM ELRTRM                                          *
  3432*  ---------------------                                         *
  3433*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3434*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3435*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3436*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3437*----------------------------------------------------------------*
  3438*  PASSED TO ELRAMT                                              *
  3439*  ----------------                                              *
  3440*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3441*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3442*  ORIGINAL AMOUNT                                               *
  3443*  ALTERNATE BENEFIT (BALLON)                                    *
  3444*  A.P.R. - NET PAY ONLY                                         *
  3445*  METHOD
  3446*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3447*  COMPANY I.D.                                                  *
  3448*  BENEFIT TYPE                                                  *
  3449*                                                                *
  3450*  RETURNED FROM ELRAMT                                          *
  3451*  --------------------                                          *
  3452*  REMAINING AMOUNT 1 - CURRENT                                  *
  3453*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3454*  REMAINING AMOUNT FACTOR
  3455*----------------------------------------------------------------*
  3456*  PASSED TO ELRESV                                              *
  3457*  -----------------                                             *
  3458*  CERTIFICATE EFFECTIVE DATE                                    *
  3459*  VALUATION DATE                                                *
  3460*  PAID THRU DATE                                                *
  3461*  BENEFIT                                                       *
  3462*  INCURRED DATE                                                 *
  3463*  REPORTED DATE                                                 *
  3464*  ISSUE AGE                                                     *
  3465*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  65
* EL050.cbl
  3466*  CDT PERCENT                                                   *
  3467*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3468* *CLAIM TYPE (LIFE, A/H)                                        *
  3469* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3470* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3471*                                                                *
  3472*  RETURNED FROM ELRESV                                          *
  3473*  --------------------                                          *
  3474*  CDT TABLE USED                                                *
  3475*  CDT FACTOR USED                                               *
  3476*  PAY TO CURRENT RESERVE                                        *
  3477*  I.B.N.R. - A/H ONLY                                           *
  3478*  FUTURE (ACCRUED) AH ONLY                                      *
  3479*----------------------------------------------------------------*
  3480*  PASSED TO ELRATE                                              *
  3481*  ----------------                                              *
  3482*  CERT ISSUE DATE                                               *
  3483*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3484*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3485*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3486*  STATE CODE (CLIENT DEFINED)                                   *
  3487*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3488*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3489*  DEVIATION CODE                                                *
  3490*  ISSUE AGE                                                     *
  3491*  ORIGINAL BENEFIT AMOUNT                                       *
  3492*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3493*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3494*  BENEFIT KIND (LIFE OR A/H)                                    *
  3495*  A.P.R.                                                        *
  3496*  METHOD
  3497*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3498*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3499*  COMPANY I.D. (3 CHARACTER)                                    *
  3500*  BENEFIT CODE                                                  *
  3501*  BENEFIT OVERRIDE CODE                                         *
  3502*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3503*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3504*  JOINT INDICATOR (CSL ONLY)                                    *
  3505*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3506*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3507*                                                                *
  3508*  RETURNED FROM ELRATE                                          *
  3509*  --------------------                                          *
  3510*  CALCULATED PREMIUM                                            *
  3511*  PREMIUM RATE                                                  *
  3512*  MORTALITY CODE                                                *
  3513*  MAX ATTAINED AGE                                              *
  3514*  MAX AGE                                                       *
  3515*  MAX TERM                                                      *
  3516*  MAX MONTHLY BENEFIT                                           *
  3517*  MAX TOTAL BENIFIT                                             *
  3518*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3519*----------------------------------------------------------------*
  3520*  PASSED TO ELRFND                                              *
  3521*  ----------------                                              *
  3522*  CERT ISSUE DATE                                               *
  3523*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  66
* EL050.cbl
  3524*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3525*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3526*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3527*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3528*  STATE CODE (CLIENT DEFINED)                                   *
  3529*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3530*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3531*  DEVIATION CODE                                                *
  3532*  ISSUE AGE                                                     *
  3533*  ORIGINAL BENEFIT AMOUNT                                       *
  3534*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3535*  PROCESS TYPE (CANCEL)                                         *
  3536*  BENEFIT KIND (LIFE OR A/H)                                    *
  3537*  A.P.R.                                                        *
  3538*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3539*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3540*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3541*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3542*  COMPANY I.D. (3 CHARACTER)                                    *
  3543*  BENEFIT CODE                                                  *
  3544*  BENEFIT OVERRIDE CODE                                         *
  3545*                                                                *
  3546*  RETURNED FROM ELRFND                                          *
  3547*  --------------------                                          *
  3548*  CALCULATED REFUND                                             *
  3549*----------------------------------------------------------------*
  3550*  PASSED TO ELEARN                                              *
  3551*  ----------------                                              *
  3552*  CERT ISSUE DATE                                               *
  3553*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3554*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3555*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3556*  STATE CODE (CLIENT DEFINED)                                   *
  3557*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3558*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3559*  DEVIATION CODE                                                *
  3560*  ISSUE AGE                                                     *
  3561*  ORIGINAL BENEFIT AMOUNT                                       *
  3562*  BENEFIT KIND (LIFE OR A/H)                                    *
  3563*  A.P.R.                                                        *
  3564*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3565*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3566*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3567*  COMPANY I.D. (3 CHARACTER)                                    *
  3568*  BENEFIT CODE                                                  *
  3569*  BENEFIT OVERRIDE CODE                                         *
  3570*                                                                *
  3571*  RETURNED FROM ELEARN                                          *
  3572*  --------------------                                          *
  3573*  INDICATED  EARNINGS                                           *
  3574*----------------------------------------------------------------*
  3575*                 LENGTH = 450                                   *
  3576*                                                                *
  3577******************************************************************
  3578******************************************************************
  3579*                   C H A N G E   L O G
  3580*
  3581* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  67
* EL050.cbl
  3582*-----------------------------------------------------------------
  3583*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3584* EFFECTIVE    NUMBER
  3585*-----------------------------------------------------------------
  3586* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3587* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3588* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3589* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3590* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3591* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3592* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3593* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3594* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3595* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3596* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3597******************************************************************
  3598
  3599 01  CALCULATION-PASS-AREA.
  3600     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3601                                     COMP.
  3602
  3603     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3604       88  NO-CP-ERROR                             VALUE ZERO.
  3605       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3606                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3607       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3608       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3609       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3610       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3611       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3612       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3613       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3614       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3615       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3616       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3617       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3618       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3619       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3620       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3621       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3622       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3623       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3624
  3625     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3626       88  NO-CP-ERROR-2                           VALUE ZERO.
  3627***********************  INPUT AREAS ****************************
  3628
  3629     12  CP-CALCULATION-AREA.
  3630         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3631         16  CP-CERT-EFF-DT        PIC XX.
  3632         16  CP-VALUATION-DT       PIC XX.
  3633         16  CP-PAID-THRU-DT       PIC XX.
  3634         16  CP-BENEFIT-TYPE       PIC X.
  3635           88  CP-AH                               VALUE 'A' 'D'
  3636                                                   'I' 'U'.
  3637           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3638           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3639         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  68
* EL050.cbl
  3640         16  CP-REPORTED-DT        PIC XX.
  3641         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3642         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3643         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3644                                     COMP-3.
  3645         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3646                                     COMP-3.
  3647         16  CP-CDT-METHOD         PIC X.
  3648           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3649           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3650           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3651         16  CP-CLAIM-TYPE         PIC X.
  3652           88  CP-AH-CLAIM                         VALUE 'A'.
  3653           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3654         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3655                                     COMP-3.
  3656         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3657                                     COMP-3.
  3658         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3659                                     COMP-3.
  3660         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3661                                     COMP-3.
  3662         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3663                                     COMP-3.
  3664         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3665                                     COMP-3.
  3666         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3667                                     COMP-3.
  3668         16  CP-REM-TERM-METHOD    PIC X.
  3669           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3670           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3671           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3672           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3673           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3674           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3675           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3676         16  CP-EARNING-METHOD     PIC X.
  3677           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3678           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3679           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3680           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3681           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3682           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3683           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3684           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3685           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3686           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3687           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3688           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3689           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3690           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3691         16  CP-PROCESS-TYPE       PIC X.
  3692           88  CP-CLAIM                            VALUE '1'.
  3693           88  CP-CANCEL                           VALUE '2'.
  3694           88  CP-ISSUE                            VALUE '3'.
  3695         16  CP-SPECIAL-CALC-CD    PIC X.
  3696           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3697           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  69
* EL050.cbl
  3698           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3699           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3700           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3701           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3702           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3703           88  CP-FARM-PLAN                    VALUE 'F'.
  3704           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3705           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3706           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3707           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3708           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3709           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3710           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3711           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3712           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3713           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3714                                                     'W' 'X'.
  3715           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3716           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3717           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3718           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3719           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3720           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3721           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3722           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3723           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3724           88  CP-CSL-METH-1                   VALUE '5'.
  3725           88  CP-CSL-METH-2                   VALUE '6'.
  3726           88  CP-CSL-METH-3                   VALUE '7'.
  3727           88  CP-CSL-METH-4                   VALUE '8'.
  3728
  3729         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3730                                     COMP-3.
  3731         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3732         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3733         16  CP-STATE              PIC XX          VALUE SPACE.
  3734         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3735         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3736           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3737               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3738         16  CP-R78-OPTION         PIC X.
  3739           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3740           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3741
  3742         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3743         16  CP-IBNR-RESERVE-SW    PIC X.
  3744         16  CP-CLAIM-STATUS       PIC X.
  3745         16  CP-RATE-FILE          PIC X.
  3746         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3747                                     COMP-3.
  3748
  3749         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3750         16  CP-AH-OVERRIDE-CODE   PIC X.
  3751
  3752         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3753                                     COMP-3.
  3754         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3755                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  70
* EL050.cbl
  3756         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3757                                     COMP-3.
  3758         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3759                                     COMP-3.
  3760         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3761                                     COMP-3.
  3762         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3763                                  PIC S9(7)V99 COMP-3.
  3764
  3765         16  CP-PAID-FROM-DATE     PIC X(02).
  3766         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3767         16  CP-EXT-DAYS-CALC      PIC X.
  3768           88  CP-EXT-NO-CHG                   VALUE ' '.
  3769           88  CP-EXT-CHG-LF                   VALUE '1'.
  3770           88  CP-EXT-CHG-AH                   VALUE '2'.
  3771           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3772         16  CP-DOMICILE-STATE     PIC XX.
  3773         16  CP-CARRIER            PIC X.
  3774         16  CP-REIN-FLAG          PIC X.
  3775         16  CP-REM-TRM-CALC-OPTION PIC X.
  3776           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3777                      '2' '3' '4' '5'.
  3778           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3779           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3780           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3781           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3782           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3783           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3784           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3785           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3786         16  CP-SIG-SWITCH         PIC X.
  3787         16  CP-RATING-METHOD      PIC X.
  3788           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3789           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3790           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3791           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3792           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3793           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3794           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3795           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3796           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3797         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3798                                     COMP-3.
  3799         16  CP-BEN-CATEGORY       PIC X.
  3800         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3801         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3802                                   PIC S99V9(5) COMP-3.
  3803         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3804         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3805                                   PIC S99V9(5) COMP-3.
  3806         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3807         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3808         16  CP-EXPIRE-DT          PIC XX.
  3809         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3810         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3811         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3812         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3813         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  71
* EL050.cbl
  3814             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3815             88  CP-CALC-CLP              VALUE 'C'.
  3816         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3817         16  CP-CANCEL-REASON      PIC X.
  3818         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3819         16  CP-PMT-MODE           PIC X.
  3820         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3821         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3822         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3823         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3824         16  FILLER                PIC X.
  3825
  3826***************    OUTPUT FROM ELRESV   ************************
  3827
  3828         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3829
  3830         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3831                                     COMP-3.
  3832         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3833                                     COMP-3.
  3834         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3835                                     COMP-3.
  3836         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3837                                     COMP-3.
  3838         16  FILLER                PIC X(09).
  3839***************    OUTPUT FROM ELRTRM   *************************
  3840
  3841         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3842                                     COMP-3.
  3843         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3844                                     COMP-3.
  3845         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3846                                     COMP-3.
  3847         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3848                                     COMP-3.
  3849         16  FILLER                PIC X(12).
  3850
  3851***************    OUTPUT FROM ELRAMT   *************************
  3852
  3853         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3854                                     COMP-3.
  3855         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3856                                     COMP-3.
  3857         16  FILLER                PIC X(12).
  3858
  3859***************    OUTPUT FROM ELRATE   *************************
  3860
  3861         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3862                                     COMP-3.
  3863         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3864                                     COMP-3.
  3865         16  CP-MORTALITY-CODE     PIC X(4).
  3866         16  CP-RATE-EDIT-FLAG     PIC X.
  3867             88  CP-RATES-NEED-APR                  VALUE '1'.
  3868         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3869                                     COMP-3.
  3870         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3871         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  72
* EL050.cbl
  3872         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3873                                   PIC S9(7)V99 COMP-3.
  3874         16  FILLER                PIC X(07).
  3875
  3876***************    OUTPUT FROM ELRFND   *************************
  3877
  3878         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3879                                     COMP-3.
  3880         16  CP-REFUND-TYPE-USED   PIC X.
  3881           88  CP-R-AS-R78                         VALUE '1'.
  3882           88  CP-R-AS-PRORATA                     VALUE '2'.
  3883           88  CP-R-AS-CALIF                       VALUE '3'.
  3884           88  CP-R-AS-TEXAS                       VALUE '4'.
  3885           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3886           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3887           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3888           88  CP-R-AS-MEAN                        VALUE '8'.
  3889           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3890           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3891           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3892           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3893           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3894           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3895         16  FILLER                PIC X(12).
  3896
  3897***************    OUTPUT FROM ELEARN   *************************
  3898
  3899         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3900                                     COMP-3.
  3901         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3902                                     COMP-3.
  3903         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3904                                     COMP-3.
  3905         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3906                                     COMP-3.
  3907         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3908                                     COMP-3.
  3909         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3910                                     COMP-3.
  3911         16  CP-EARNING-TYPE-USED  PIC X.
  3912           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3913           88  CP-E-AS-R78                         VALUE '1'.
  3914           88  CP-E-AS-PRORATA                     VALUE '2'.
  3915           88  CP-E-AS-TEXAS                       VALUE '4'.
  3916           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3917           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3918           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3919           88  CP-E-AS-MEAN                        VALUE '8'.
  3920           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3921         16  FILLER                PIC X(12).
  3922
  3923***************    OUTPUT FROM ELPMNT   *************************
  3924
  3925         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3926                                     COMP-3.
  3927         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3928                                     COMP-3.
  3929         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  73
* EL050.cbl
  3930
  3931***************   MISC WORK AREAS    *****************************
  3932         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3933                                     COMP-3.
  3934         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3935                                     COMP-3.
  3936         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3937                                     COMP-3.
  3938         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3939                                     COMP-3.
  3940         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3941                                     COMP-3.
  3942         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3943                                     COMP-3.
  3944         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3945             88  OPEN-RATE-FILE                   VALUE 'O'.
  3946             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3947             88  IO-ERROR                         VALUE 'E'.
  3948
  3949         16  CP-FIRST-PAY-DATE     PIC XX.
  3950
  3951         16  CP-JOINT-INDICATOR    PIC X.
  3952
  3953         16  CP-RESERVE-REMAINING-TERM
  3954                                   PIC S9(4)V9    VALUE ZERO
  3955                                     COMP-3.
  3956
  3957         16  CP-INSURED-BIRTH-DT   PIC XX.
  3958
  3959         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3960                                     COMP-3.
  3961
  3962         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3963                                     COMP-3.
  3964
  3965         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3966                                     COMP-3.
  3967
  3968         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3969                                     COMP-3.
  3970
  3971         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3972                                     COMP-3.
  3973
  3974         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3975                                     COMP-3.
  3976
  3977         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3978                                     COMP-3.
  3979
  3980         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3981             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3982
  3983         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3984                                     COMP-3.
  3985         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3986                                     COMP-3.
  3987         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  74
* EL050.cbl
  3988         16  cp-extra-periods      pic 9 value zeros.
  3989         16  cp-net-only-state     pic x value spaces.
  3990         16  FILLER                PIC X(13).
  3991******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  75
* EL050.cbl
  3993******************************************************************
  3994*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3995*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3996*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3997*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3998*** MODIFICATION.                                              ***
  3999*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4000*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4001******************************************************************
  4002*    COPY ERCPNDB.
  4003******************************************************************
  4004*                                                                *
  4005*                                                                *
  4006*                            ERCPNDB.                            *
  4007*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4008*                            VMOD=2.025                          *
  4009*                                                                *
  4010*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4011*                                                                *
  4012******************************************************************
  4013*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4014*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4015******************************************************************
  4016*                                                                *
  4017*                                                                *
  4018*   FILE TYPE = VSAM,KSDS                                        *
  4019*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4020*                                                                *
  4021*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4022*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4023*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4024*                                                 RKP=13,LEN=36  *
  4025*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4026*                                      AND CHG-SEQ.)             *
  4027*                                                RKP=49,LEN=11   *
  4028*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4029*                                      AND CHG-SEQ.)             *
  4030*                                                RKP=60,LEN=15   *
  4031*                                                                *
  4032*   LOG = NO                                                     *
  4033*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4034******************************************************************
  4035******************************************************************
  4036*                   C H A N G E   L O G
  4037*
  4038* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4039*-----------------------------------------------------------------
  4040*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4041* EFFECTIVE    NUMBER
  4042*-----------------------------------------------------------------
  4043* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4044* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4045* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4046* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4047* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4048* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4049* 032306                   PEMA  ADD BOW LOAN NUMBER
  4050* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  76
* EL050.cbl
  4051* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4052* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4053* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4054* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4055* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4056* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4057* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4058* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4059* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4060* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4061******************************************************************
  4062
  4063 01  PENDING-BUSINESS.
  4064     12  PB-RECORD-ID                     PIC XX.
  4065         88  VALID-PB-ID                        VALUE 'PB'.
  4066
  4067     12  PB-CONTROL-PRIMARY.
  4068         16  PB-COMPANY-CD                PIC X.
  4069         16  PB-ENTRY-BATCH               PIC X(6).
  4070         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4071         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4072
  4073     12  PB-CONTROL-BY-ACCOUNT.
  4074         16  PB-COMPANY-CD-A1             PIC X.
  4075         16  PB-CARRIER                   PIC X.
  4076         16  PB-GROUPING.
  4077             20  PB-GROUPING-PREFIX       PIC XXX.
  4078             20  PB-GROUPING-PRIME        PIC XXX.
  4079         16  PB-STATE                     PIC XX.
  4080         16  PB-ACCOUNT.
  4081             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4082             20  PB-ACCOUNT-PRIME         PIC X(6).
  4083         16  PB-CERT-EFF-DT               PIC XX.
  4084         16  PB-CERT-NO.
  4085             20  PB-CERT-PRIME            PIC X(10).
  4086             20  PB-CERT-SFX              PIC X.
  4087         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4088
  4089         16  PB-RECORD-TYPE               PIC X.
  4090             88  PB-MAILING-DATA                VALUE '0'.
  4091             88  PB-ISSUE                       VALUE '1'.
  4092             88  PB-CANCELLATION                VALUE '2'.
  4093             88  PB-BATCH-TRAILER               VALUE '9'.
  4094
  4095     12  PB-CONTROL-BY-ORIG-BATCH.
  4096         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4097         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4098         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4099         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4100
  4101     12  PB-CONTROL-BY-CSR.
  4102         16  PB-CSR-COMPANY-CD            PIC X.
  4103         16  PB-CSR-ID                    PIC X(4).
  4104         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4105         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4106         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4107******************************************************************
  4108*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  77
* EL050.cbl
  4109******************************************************************
  4110
  4111     12  PB-LAST-MAINT-DT                 PIC XX.
  4112     12  PB-LAST-MAINT-BY                 PIC X(4).
  4113     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4114
  4115     12  PB-RECORD-BODY                   PIC X(375).
  4116
  4117     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4118         16  PB-CERT-ORIGIN               PIC X.
  4119             88  CLASIC-CREATED-CERT         VALUE '1'.
  4120         16  PB-I-NAME.
  4121             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4122             20  PB-I-INSURED-FIRST-NAME.
  4123                 24  PB-I-INSURED-1ST-INIT PIC X.
  4124                 24  FILLER                PIC X(9).
  4125             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4126         16  PB-I-AGE                     PIC S99   COMP-3.
  4127         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4128         16  PB-I-BIRTHDAY                PIC XX.
  4129         16  PB-I-INSURED-SEX             PIC X.
  4130             88  PB-SEX-MALE     VALUE 'M'.
  4131             88  PB-SEX-FEMALE   VALUE 'F'.
  4132
  4133         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4134         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4135         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4136         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4137         16  PB-I-SKIP-CODE               PIC X.
  4138             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4139             88  PB-SKIP-JULY              VALUE '1'.
  4140             88  PB-SKIP-AUGUST            VALUE '2'.
  4141             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4142             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4143             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4144             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4145             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4146             88  PB-SKIP-JUNE              VALUE '8'.
  4147             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4148             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4149             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4150         16  PB-I-TERM-TYPE               PIC X.
  4151             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4152             88  PB-PAID-WEEKLY            VALUE 'W'.
  4153             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4154             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4155             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4156         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4157         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4158         16  PB-I-DATA-ENTRY-SW           PIC X.
  4159             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4160             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4161             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4162             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4163         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4164         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4165*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4166         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  78
* EL050.cbl
  4167         16  FILLER                       PIC X.
  4168
  4169         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4170             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4171             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4172                                                   '90' THRU '99'.
  4173         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4174                                          PIC XX.
  4175         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4176         16  PB-I-AMOUNT-FINANCED REDEFINES
  4177                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4178         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4179         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4180                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4181         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4182         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4183         16  PB-I-CLP-AMOUNT REDEFINES
  4184                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4185         16  PB-I-LF-CALC-FLAG            PIC X.
  4186             88 PB-COMP-LF-PREM               VALUE '?'.
  4187         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4188         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4189         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4190         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4191         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4192         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4193         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4194         16  PB-I-LF-ABBR                 PIC XXX.
  4195         16  PB-I-LF-INPUT-CD             PIC XX.
  4196
  4197         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4198             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4199             88  PB-INVALID-AH               VALUE '  ' '00'
  4200                                                   '90' THRU '99'.
  4201         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4202         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4203         16  PB-I-AH-CALC-FLAG            PIC X.
  4204             88 PB-COMP-AH-PREM                  VALUE '?'.
  4205         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4206         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4207         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4208         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4209         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4210         16  PB-I-AH-ABBR                 PIC XXX.
  4211         16  PB-I-AH-INPUT-CD             PIC XXX.
  4212
  4213         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4214         16  PB-I-REIN-TABLE              PIC XXX.
  4215         16  PB-I-BUSINESS-TYPE           PIC 99.
  4216         16  PB-I-INDV-GRP-CD             PIC X.
  4217         16  PB-I-MORT-CODE.
  4218             20  PB-I-TABLE               PIC X.
  4219             20  PB-I-INTEREST            PIC XX.
  4220             20  PB-I-MORT-TYP            PIC X.
  4221         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4222         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4223         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4224         16  PB-I-INDV-GRP-OVRD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  79
* EL050.cbl
  4225         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4226         16  PB-I-SIG-SW                  PIC X.
  4227             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4228         16  PB-I-RATE-CLASS              PIC XX.
  4229         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4230         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4231         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4232         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4233         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4234         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4235         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4236         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4237         16  PB-I-OB-FLAG                 PIC X.
  4238             88  PB-I-OB                      VALUE 'B'.
  4239             88  PB-I-SUMMARY                 VALUE 'Z'.
  4240         16  PB-I-ENTRY-STATUS            PIC X.
  4241             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4242                                              'M' '5' '9' '2'.
  4243             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4244             88  PB-I-POLICY-PENDING          VALUE '2'.
  4245             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4246             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4247             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4248             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4249             88  PB-I-REIN-ONLY               VALUE '9'.
  4250             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4251             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4252             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4253             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4254         16  PB-I-INT-CODE                PIC X.
  4255             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4256             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4257         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4258         16  PB-I-SOC-SEC-NO              PIC X(11).
  4259         16  PB-I-MEMBER-NO               PIC X(12).
  4260         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4261*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4262         16  PB-I-OLD-LOF                 PIC XXX.
  4263         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4264         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4265         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4266         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4267         16  PB-I-LIFE-INDICATOR          PIC X.
  4268             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4269         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4270         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4271                                          PIC S9(5)V99    COMP-3.
  4272         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4273             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4274             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4275         16  PB-I-1ST-PMT-DT              PIC XX.
  4276         16  PB-I-JOINT-INSURED.
  4277             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4278             20 PB-I-JOINT-FIRST-NAME.
  4279                24  PB-I-JOINT-FIRST-INIT PIC X.
  4280                24  FILLER                PIC X(9).
  4281             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4282*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  80
* EL050.cbl
  4283         16  PB-I-BENEFICIARY-NAME.
  4284             20  PB-I-BANK-NUMBER         PIC X(10).
  4285             20  FILLER                   PIC X(15).
  4286         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4287         16  PB-I-REFERENCE               PIC X(12).
  4288         16  FILLER REDEFINES PB-I-REFERENCE.
  4289             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4290             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4291             20  PB-I-CLP-STATE           PIC XX.
  4292         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4293             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4294             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4295             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4296         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4297         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4298         16  PB-I-RESIDENT-STATE          PIC XX.
  4299         16  PB-I-RATE-CODE               PIC X(4).
  4300         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4301         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4302         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4303         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4304         16  PB-I-BANK-NOCHRGB            PIC 99.
  4305         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4306         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4307
  4308     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4309         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4310             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4311         16  PB-C-CANCEL-ORIGIN           PIC X.
  4312             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4313         16  PB-C-LF-CANCEL-DT            PIC XX.
  4314         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4315         16  PB-C-LF-CALC-REQ             PIC X.
  4316             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4317         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4318         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4319         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4320             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4321         16  PB-C-AH-CANCEL-DT            PIC XX.
  4322         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4323         16  PB-C-AH-CALC-REQ             PIC X.
  4324             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4325         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4326         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4327         16  PB-C-LAST-NAME               PIC X(15).
  4328         16  PB-C-REFUND-SW               PIC X.
  4329             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4330             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4331         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4332         16  PB-C-PAYEE-CODE              PIC X(6).
  4333         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4334         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4335         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4336         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4337         16  PB-C-REFERENCE               PIC X(12).
  4338         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4339         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4340         16  PB-C-POST-CARD-IND           PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  81
* EL050.cbl
  4341         16  PB-C-CANCEL-REASON           PIC X.
  4342         16  PB-C-REF-INTERFACE-SW        PIC X.
  4343         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4344         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4345         16  FILLER                       PIC X(01).
  4346*        16  FILLER                       PIC X(18).
  4347         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4348*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4349         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4350         16  PB-CANCELED-CERT-DATA.
  4351             20  PB-CI-INSURED-NAME.
  4352                 24  PB-CI-LAST-NAME      PIC X(15).
  4353                 24  PB-CI-INITIALS       PIC XX.
  4354             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4355             20  PB-CI-INSURED-SEX        PIC X.
  4356             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4357             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4358             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4359             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4360             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4361             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4362             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4363             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4364             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4365             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4366             20  PB-CI-RATE-CLASS         PIC XX.
  4367             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4368             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4369             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4370             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4371             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4372             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4373             20  PB-CI-LF-ABBR            PIC X(3).
  4374             20  PB-CI-AH-ABBR            PIC X(3).
  4375             20  PB-CI-OB-FLAG            PIC X.
  4376                 88  PB-CI-OB                VALUE 'B'.
  4377             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4378                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4379                                           'M' '4' '5' '9' '2'.
  4380                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4381                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4382                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4383                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4384                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4385                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4386                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4387                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4388                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4389                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4390                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4391                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4392                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4393             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4394                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4395                                           'M' '4' '5' '9' '2'.
  4396                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4397                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4398                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  82
* EL050.cbl
  4399                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4400                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4401                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4402                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4403                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4404                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4405                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4406                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4407                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4408                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4409             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4410             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4411             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4412             20  PB-CI-MEMBER-NO          PIC X(12).
  4413             20  PB-CI-INT-CODE           PIC X.
  4414                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4415                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4416             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4417             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4418             20  PB-CI-COMP-EXCP-SW       PIC X.
  4419                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4420                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4421             20  PB-CI-ENTRY-STATUS       PIC X.
  4422             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4423             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4424             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4425             20  PB-CI-DEATH-DT           PIC XX.
  4426             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4427             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4428             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4429             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4430             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4431             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4432             20  PB-CI-ENTRY-DT              PIC XX.
  4433             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4434             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4435             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4436             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4437             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4438             20  PB-CI-OLD-LOF               PIC XXX.
  4439*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4440             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4441             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4442             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4443             20  PB-CI-INDV-GRP-CD           PIC X.
  4444             20  PB-CI-BENEFICIARY-NAME.
  4445                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4446                 24  FILLER                  PIC X(15).
  4447             20  PB-CI-NOTE-SW               PIC X.
  4448             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4449             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4450             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4451             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4452             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4453             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4454             20  PB-CI-FIRST-NAME            PIC X(10).
  4455             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4456
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  83
* EL050.cbl
  4457         16  FILLER                       PIC X(13).
  4458*032306  16  FILLER                       PIC X(27).
  4459*        16  FILLER                       PIC X(46).
  4460
  4461     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4462         16  FILLER                       PIC X(10).
  4463         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4464         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4465         16  PB-M-INSURED-MID-INIT        PIC X.
  4466         16  PB-M-INSURED-AGE             PIC 99.
  4467         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4468         16  PB-M-INSURED-SEX             PIC X.
  4469         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4470         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4471         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4472         16  PB-M-INSURED-CITY-STATE.
  4473             20  PB-M-INSURED-CITY        PIC X(28).
  4474             20  PB-M-INSURED-STATE       PIC XX.
  4475         16  PB-M-INSURED-ZIP-CODE.
  4476             20  PB-M-INSURED-ZIP-PRIME.
  4477                 24  PB-M-INSURED-ZIP-1   PIC X.
  4478                     88  PB-M-CANADIAN-POST-CODE
  4479                                             VALUE 'A' THRU 'Z'.
  4480                 24  FILLER               PIC X(4).
  4481             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4482         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4483                                        PB-M-INSURED-ZIP-CODE.
  4484             20  PM-M-INS-CAN-POST1       PIC XXX.
  4485             20  PM-M-INS-CAN-POST2       PIC XXX.
  4486             20  FILLER                   PIC XXX.
  4487         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4488         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4489         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4490         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4491         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4492         16  PB-M-CRED-BENE-CITYST.
  4493             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4494             20  PB-M-CRED-BENE-STATE     PIC XX.
  4495         16  FILLER                       PIC X(92).
  4496
  4497     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4498         16  FILLER                       PIC X(10).
  4499         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4500         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4501         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4502         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4503         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4504         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4505         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4506         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4507         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4508         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4509         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4510         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4511         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4512         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4513         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4514         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  84
* EL050.cbl
  4515         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4516         16  PB-ACCOUNT-NAME              PIC X(30).
  4517         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4518         16  PB-REFERENCE                 PIC X(12).
  4519         16  PB-B-RECEIVED-DT             PIC XX.
  4520         16  FILLER                       PIC X(234).
  4521
  4522     12  PB-RECORD-STATUS.
  4523         16  PB-CREDIT-SELECT-DT          PIC XX.
  4524         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4525         16  PB-BILLED-DT                 PIC XX.
  4526         16  PB-BILLING-STATUS            PIC X.
  4527             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4528             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4529             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4530         16  PB-RECORD-BILL               PIC X.
  4531             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4532             88  PB-RECORD-RETURNED           VALUE 'R'.
  4533             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4534             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4535             88  PB-OVERRIDE-AH               VALUE 'A'.
  4536             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4537         16  PB-BATCH-ENTRY               PIC X.
  4538             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4539             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4540             88  PB-REISSUED-CERT             VALUE 'E'.
  4541             88  PB-CASH-CERT                 VALUE 'C'.
  4542             88  PB-MONTHLY-CERT              VALUE 'M'.
  4543             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4544             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4545             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4546         16  PB-FORCE-CODE                PIC X.
  4547             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4548             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4549             88  PB-CANCEL-FORCE              VALUE '8'.
  4550             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4551             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4552             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4553             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4554             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4555             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4556             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4557             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4558         16  PB-FATAL-FLAG                PIC X.
  4559             88  PB-FATAL-ERRORS              VALUE 'X'.
  4560         16  PB-FORCE-ER-CD               PIC X.
  4561             88  PB-FORCE-ERRORS              VALUE 'F'.
  4562             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4563         16  PB-WARN-ER-CD                PIC X.
  4564             88  PB-WARNING-ERRORS            VALUE 'W'.
  4565         16  FILLER                       PIC X.
  4566         16  PB-OUT-BAL-CD                PIC X.
  4567             88  PB-OUT-OF-BAL                VALUE 'O'.
  4568         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4569         16  PB-AH-OVERRIDE-L1            PIC X.
  4570         16  PB-INPUT-DT                  PIC XX.
  4571         16  PB-INPUT-BY                  PIC X(4).
  4572         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  85
* EL050.cbl
  4573         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4574         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4575         16  PB-LF-EARNING-METHOD         PIC X.
  4576         16  PB-AH-EARNING-METHOD         PIC X.
  4577         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4578         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4579         16  PB-REIN-CD                   PIC XXX.
  4580         16  PB-LF-REFUND-TYPE            PIC X.
  4581         16  PB-AH-REFUND-TYPE            PIC X.
  4582         16  PB-ACCT-EFF-DT               PIC XX.
  4583         16  PB-ACCT-EXP-DT               PIC XX.
  4584         16  PB-COMPANY-ID                PIC X(3).
  4585         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4586         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4587         16  PB-SV-CARRIER                PIC X.
  4588         16  PB-SV-GROUPING               PIC X(6).
  4589         16  PB-SV-STATE                  PIC XX.
  4590         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4591         16  PB-GA-BILLING-INFO.
  4592             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4593                                          PIC XX.
  4594         16  PB-SV-REMIT-TO  REDEFINES
  4595             PB-GA-BILLING-INFO           PIC X(10).
  4596         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4597         16  PB-I-LOAN-OFFICER            PIC X(5).
  4598         16  PB-I-VIN                     PIC X(17).
  4599
  4600         16  FILLER                       PIC X(04).
  4601         16  IMNET-BYPASS-SW              PIC X.
  4602
  4603******************************************************************
  4604*                COMMON EDIT ERRORS                              *
  4605******************************************************************
  4606
  4607     12  PB-COMMON-ERRORS.
  4608         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4609                                           PIC S9(4)     COMP.
  4610
  4611******************************************************************
  4612
  4613* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4614*    COPY ELC50W1.
  4615******************************************************************
  4616*                                                                *
  4617*                                                                *
  4618*                             ELC50W1                            *
  4619*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4620*                            VMOD=2.004                          *
  4621*                                                                *
  4622*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4623*                                                                *
  4624*                                                                *
  4625******************************************************************
  4626
  4627     12  WK-WORK-AREA.
  4628         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4629         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4630         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  86
* EL050.cbl
  4631         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4632         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4633         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4634         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4635         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4636         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4637         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4638         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4639         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4640         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4641         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4642         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4643         16  WK-CREDIT-EDIT-CONTROLS.
  4644             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4645             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4646             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4647             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4648             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4649             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4650         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4651         16  WK-SAVE-REIN-DATA.
  4652             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4653             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4654             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4655         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4656             88  ENTRY-FROM-EL6311       VALUE '6'.
  4657         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4658         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4659     12  WK-RECORD-ADDRESSES.
  4660         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4661         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4662         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4663         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4664         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4665         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4666         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4667         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4668     12  WK-OVER-SHORT-AREA.
  4669         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4670         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4671         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4672             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4673         16  FILLER                   PIC X(5) VALUE SPACES.
  4674
  4675*    COPY ELCEDITC.
  4676******************************************************************
  4677*                                                                *
  4678*                                                                *
  4679*                            ELCEDITC                            *
  4680*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4681*                            VMOD=2.012                          *
  4682*                                                                *
  4683*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4684*                     EL6313, EL050 AND EL517.                   *
  4685*                                                                *
  4686******************************************************************
  4687******************************************************************
  4688*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  87
* EL050.cbl
  4689*
  4690* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4691*-----------------------------------------------------------------
  4692*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4693* EFFECTIVE    NUMBER
  4694*-----------------------------------------------------------------
  4695* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4696******************************************************************
  4697
  4698     12  EDIT-CRITERIA-DATA.
  4699         16  EC-CO-MONTH-END-DT       PIC XX.
  4700         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4701         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4702         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4703         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4704         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4705         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4706         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4707         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4708         16  EC-CO-REM-TERM-CALC      PIC X.
  4709               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4710               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4711               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4712               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4713
  4714         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4715               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4716               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4717               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4718               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4719               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4720               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4721               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4722               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4723               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4724               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4725
  4726         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4727               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4728               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4729               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4730               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4731               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4732               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4733               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4734               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4735
  4736         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4737                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4738                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4739
  4740         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4741                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4742                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4743                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4744                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4745                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4746                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  88
* EL050.cbl
  4747                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4748                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4749
  4750         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4751               88  EC-BR-REDUCING                   VALUE 'R'.
  4752               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4753
  4754         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4755         16  EC-BR-LF-DESC             PIC X(10).
  4756         16  EC-BR-AH-DESC             PIC X(10).
  4757         16  EC-BR-LF-COMMENT          PIC X(10).
  4758         16  EC-BR-AH-COMMENT          PIC X(10).
  4759
  4760         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4761               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4762               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4763               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4764               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4765
  4766         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4767               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4768               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4769               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4770               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4771
  4772         16  EC-BR-LF-REFUND-CALC      PIC X.
  4773                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4774                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4775                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4776                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4777                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4778                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4779                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4780
  4781         16  EC-BR-AH-REFUND-CALC      PIC X.
  4782                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4783                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4784                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4785                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4786                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4787                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4788                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4789                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4790
  4791         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4792                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4793                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4794                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4795
  4796         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4797                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4798                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4799                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4800
  4801         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4802         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4803         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4804         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  89
* EL050.cbl
  4805
  4806         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4807         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4808                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4809                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4810                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4811                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4812
  4813         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4814               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4815               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4816               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4817               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4818               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4819
  4820         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4821               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4822               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4823               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4824               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4825               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4826
  4827         16  EC-ST-LF-REFUND-CALC      PIC X.
  4828                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4829                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4830                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4831                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4832                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4833                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4834                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4835                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4836
  4837         16  EC-ST-AH-REFUND-CALC      PIC X.
  4838                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4839                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4840                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4841                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4842                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4843                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4844                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4845                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4846
  4847         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4848         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4849         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4850         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4851         16  EC-AM-EXPIRATION-DT       PIC XX.
  4852         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4853         16  EC-AM-CLASS-CD            PIC XX.
  4854         16  EC-AM-LF-DEVIATION        PIC XXX.
  4855         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4856         16  EC-AM-AH-DEVIATION        PIC XXX.
  4857         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4858         16  EC-AM-PHONE-NO            PIC X(10).
  4859
  4860         16  EC-AM-LF-REFUND-CALC      PIC X.
  4861                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4862                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  90
* EL050.cbl
  4863                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4864                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4865                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4866                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4867                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4868
  4869         16  EC-AM-AH-REFUND-CALC      PIC X.
  4870                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4871                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4872                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4873                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4874                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4875                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4876                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4877
  4878         16  EC-AM-BEN-I-G-CD          PIC X.
  4879                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4880                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4881                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4882
  4883         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4884         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4885         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4886         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4887         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4888         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4889         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4890         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4891         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4892
  4893         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4894         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4895         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4896         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4897         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4898         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4899         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4900         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4901         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4902         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4903         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4904         16  EC-RT-LF-NSP-ST           PIC XX.
  4905         16  EC-RT-AH-NSP-ST           PIC XX.
  4906         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4907         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4908
  4909         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4910             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4911                                             'M' '5' '9' '2'.
  4912             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4913             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4914             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4915             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4916             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4917             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4918             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4919             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4920             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  91
* EL050.cbl
  4921             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4922
  4923         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4924             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4925                                             'M' '5' '9' '2'.
  4926             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4927             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4928             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4929             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4930             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4931             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4932             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4933             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4934             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4935             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4936
  4937         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4938         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4939         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4940         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4941         16  EC-CM-DEATH-DT            PIC XX.
  4942
  4943*DMD CUSTOM CODING FIELDS BELOW
  4944*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4945         16  EC-BR-DMD-RATING-SW       PIC X.
  4946                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4947                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4948                 88  NO-DMD-RATING               VALUE 'N'.
  4949
  4950         16  EC-NEW-CERT               PIC X(11).
  4951         16  EC-NEW-STATE              PIC XX.
  4952         16  FILLER                    PIC X.
  4953*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4954         16  OVER-SHORT-EDIT-FIELDS.
  4955             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4956             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4957             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4958             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4959             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4960             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4961             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4962             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4963             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4964         16  FILLER                    PIC X(71).
  4965******************************************************************
  4966
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  92
* EL050.cbl
  4968*    COPY ELCDIFRD.
  4969******************************************************************
  4970*                                                                *
  4971*                                                                *
  4972*                            ELCDIFRD.                           *
  4973*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4974*                            VMOD=2.004                          *
  4975*                                                                *
  4976*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4977*                                                                *
  4978******************************************************************
  4979*
  4980  01  WS-DIFFERENCE-CALCULATION.
  4981        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4982        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4983        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4984        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4985        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4986        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4987        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4988        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4989        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4990        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4991        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4992
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  93
* EL050.cbl
  4994****************************************************************
  4995*
  4996* Copyright (c) 2007-2013 Dell Inc.
  4997* All rights reserved.
  4998*
  4999****************************************************************
  5000 01  DFHEIV.
  5001   02  DFHEIV0               PIC X(35).
  5002   02  DFHEIV1               PIC X(08).
  5003   02  DFHEIV2               PIC X(08).
  5004   02  DFHEIV3               PIC X(08).
  5005   02  DFHEIV4               PIC X(06).
  5006   02  DFHEIV5               PIC X(04).
  5007   02  DFHEIV6               PIC X(04).
  5008   02  DFHEIV7               PIC X(02).
  5009   02  DFHEIV8               PIC X(02).
  5010   02  DFHEIV9               PIC X(01).
  5011   02  DFHEIV10              PIC S9(7) COMP-3.
  5012   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5013   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5014   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5015   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5016   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5017   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5018   02  DFHEIV17              PIC X(04).
  5019   02  DFHEIV18              PIC X(04).
  5020   02  DFHEIV19              PIC X(04).
  5021   02  DFHEIV20              USAGE IS POINTER.
  5022   02  DFHEIV21              USAGE IS POINTER.
  5023   02  DFHEIV22              USAGE IS POINTER.
  5024   02  DFHEIV23              USAGE IS POINTER.
  5025   02  DFHEIV24              USAGE IS POINTER.
  5026   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5027   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5028   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5029   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5030   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5031   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5032   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5033   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5034   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5035   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5036   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5037   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5038   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5039   02  FILLER                PIC X(02).
  5040   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5041   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5042   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5043   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5044   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5045   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5046   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5047 LINKAGE  SECTION.
  5048*****************************************************************
  5049*                                                               *
  5050* Copyright (c) 2007-2013 Dell Inc.                             *
  5051* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  94
* EL050.cbl
  5052*                                                               *
  5053*****************************************************************
  5054 01  dfheiblk.
  5055     02  eibtime          pic s9(7) comp-3.
  5056     02  eibdate          pic s9(7) comp-3.
  5057     02  eibtrnid         pic x(4).
  5058     02  eibtaskn         pic s9(7) comp-3.
  5059     02  eibtrmid         pic x(4).
  5060     02  dfheigdi         pic s9(4) comp.
  5061     02  eibcposn         pic s9(4) comp.
  5062     02  eibcalen         pic s9(4) comp.
  5063     02  eibaid           pic x(1).
  5064     02  eibfiller1       pic x(1).
  5065     02  eibfn            pic x(2).
  5066     02  eibfiller2       pic x(2).
  5067     02  eibrcode         pic x(6).
  5068     02  eibfiller3       pic x(2).
  5069     02  eibds            pic x(8).
  5070     02  eibreqid         pic x(8).
  5071     02  eibrsrce         pic x(8).
  5072     02  eibsync          pic x(1).
  5073     02  eibfree          pic x(1).
  5074     02  eibrecv          pic x(1).
  5075     02  eibsend          pic x(1).
  5076     02  eibatt           pic x(1).
  5077     02  eibeoc           pic x(1).
  5078     02  eibfmh           pic x(1).
  5079     02  eibcompl         pic x(1).
  5080     02  eibsig           pic x(1).
  5081     02  eibconf          pic x(1).
  5082     02  eiberr           pic x(1).
  5083     02  eibrldbk         pic x(1).
  5084     02  eiberrcd         pic x(4).
  5085     02  eibsynrb         pic x(1).
  5086     02  eibnodat         pic x(1).
  5087     02  eibfiller5       pic x(2).
  5088     02  eibresp          pic s9(8) comp.
  5089     02  eibresp2         pic s9(8) comp.
  5090     02  dfheigdj         pic s9(4) comp.
  5091     02  dfheigdk         pic s9(4) comp.
  5092
  5093 01  DFHCOMMAREA                   PIC X(1036).
  5094
  5095*01 PARMLIST .
  5096*    02  FILLER                    PIC S9(8)   COMP.
  5097*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5098*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5099*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5100*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5101*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5102*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5103*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5104
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  95
* EL050.cbl
  5106*    COPY ELCCNTL.
  5107******************************************************************
  5108*                                                                *
  5109*                                                                *
  5110*                            ELCCNTL.                            *
  5111*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5112*                            VMOD=2.059                          *
  5113*                                                                *
  5114*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5115*                                                                *
  5116*   FILE TYPE = VSAM,KSDS                                        *
  5117*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5118*                                                                *
  5119*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5120*       ALTERNATE INDEX = NONE                                   *
  5121*                                                                *
  5122*   LOG = YES                                                    *
  5123*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5124******************************************************************
  5125*                   C H A N G E   L O G
  5126*
  5127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5128*-----------------------------------------------------------------
  5129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5130* EFFECTIVE    NUMBER
  5131*-----------------------------------------------------------------
  5132* 082503                   PEMA  ADD BENEFIT GROUP
  5133* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5134* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5135* 092705    2005050300006  PEMA  ADD SPP LEASES
  5136* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5137* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5138* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5139* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5140* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5141* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5142* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5143* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5144* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5145* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5146* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5147******************************************************************
  5148*
  5149 01  CONTROL-FILE.
  5150     12  CF-RECORD-ID                       PIC XX.
  5151         88  VALID-CF-ID                        VALUE 'CF'.
  5152
  5153     12  CF-CONTROL-PRIMARY.
  5154         16  CF-COMPANY-ID                  PIC XXX.
  5155         16  CF-RECORD-TYPE                 PIC X.
  5156             88  CF-COMPANY-MASTER              VALUE '1'.
  5157             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5158             88  CF-STATE-MASTER                VALUE '3'.
  5159             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5160             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5161             88  CF-CARRIER-MASTER              VALUE '6'.
  5162             88  CF-MORTALITY-MASTER            VALUE '7'.
  5163             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  96
* EL050.cbl
  5164             88  CF-TERMINAL-MASTER             VALUE '9'.
  5165             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5166             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5167             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5168             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5169             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5170             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5171             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5172             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5173             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5174         16  CF-ACCESS-CD-GENL              PIC X(4).
  5175         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5176             20  CF-PROCESSOR               PIC X(4).
  5177         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5178             20  CF-STATE-CODE              PIC XX.
  5179             20  FILLER                     PIC XX.
  5180         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5181             20  FILLER                     PIC XX.
  5182             20  CF-HI-BEN-IN-REC           PIC XX.
  5183         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5184             20  FILLER                     PIC XXX.
  5185             20  CF-CARRIER-CNTL            PIC X.
  5186         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5187             20  FILLER                     PIC XX.
  5188             20  CF-HI-TYPE-IN-REC          PIC 99.
  5189         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5190             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5191                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5192             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5193             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5194         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5195             20  FILLER                     PIC X.
  5196             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5197         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5198             20  FILLER                     PIC XX.
  5199             20  CF-MORTGAGE-PLAN           PIC XX.
  5200         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5201
  5202     12  CF-LAST-MAINT-DT                   PIC XX.
  5203     12  CF-LAST-MAINT-BY                   PIC X(4).
  5204     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5205
  5206     12  CF-RECORD-BODY                     PIC X(728).
  5207
  5208
  5209****************************************************************
  5210*             COMPANY MASTER RECORD                            *
  5211****************************************************************
  5212
  5213     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5214         16  CF-COMPANY-ADDRESS.
  5215             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5216             20  CF-CL-IN-CARE-OF           PIC X(30).
  5217             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5218             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5219             20  CF-CL-CITY-STATE           PIC X(30).
  5220             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5221             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  97
* EL050.cbl
  5222         16  CF-COMPANY-CD                  PIC X.
  5223         16  CF-COMPANY-PASSWORD            PIC X(8).
  5224         16  CF-SECURITY-OPTION             PIC X.
  5225             88  ALL-SECURITY                   VALUE '1'.
  5226             88  COMPANY-VERIFY                 VALUE '2'.
  5227             88  PROCESSOR-VERIFY               VALUE '3'.
  5228             88  NO-SECURITY                    VALUE '4'.
  5229             88  ALL-BUT-TERM                   VALUE '5'.
  5230         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5231             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5232         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5233             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5234         16  CF-INFORCE-LOCATION            PIC X.
  5235             88  CERTS-ARE-ONLINE               VALUE '1'.
  5236             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5237             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5238         16  CF-LOWER-CASE-LETTERS          PIC X.
  5239         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5240             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5241             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5242             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5243             88  CF-ACCNT-CNTL                  VALUE '3'.
  5244             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5245
  5246         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5247         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5248
  5249         16  CF-LGX-CREDIT-USER             PIC X.
  5250             88  CO-IS-NOT-USER                 VALUE 'N'.
  5251             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5252
  5253         16 CF-CREDIT-CALC-CODES.
  5254             20  CF-CR-REM-TERM-CALC PIC X.
  5255               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5256               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5257               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5258               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5259               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5260               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5261               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5262             20  CF-CR-R78-METHOD           PIC X.
  5263               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5264               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5265
  5266         16  CF-CLAIM-CONTROL-COUNTS.
  5267             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5268                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5269
  5270             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5271                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5272
  5273             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5274                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5275
  5276             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5277                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5278
  5279         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  98
* EL050.cbl
  5280
  5281         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5282             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5283             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5284             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5285             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5286                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5287                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5288             20  CF-CO-PREM-REJECT-SW       PIC X.
  5289                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5290                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5291             20  CF-CO-REF-REJECT-SW        PIC X.
  5292                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5293                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5294
  5295         16  CF-CO-REPORTING-DT             PIC XX.
  5296         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5297         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5298           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5299           88  CF-CO-MONTH-END                  VALUE '1'.
  5300
  5301         16  CF-LGX-CLAIM-USER              PIC X.
  5302             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5303             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5304
  5305         16  CF-CREDIT-EDIT-CONTROLS.
  5306             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5307             20  CF-MIN-AGE                 PIC 99.
  5308             20  CF-DEFAULT-AGE             PIC 99.
  5309             20  CF-MIN-TERM                PIC S999      COMP-3.
  5310             20  CF-MAX-TERM                PIC S999      COMP-3.
  5311             20  CF-DEFAULT-SEX             PIC X.
  5312             20  CF-JOINT-AGE-INPUT         PIC X.
  5313                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5314             20  CF-BIRTH-DATE-INPUT        PIC X.
  5315                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5316             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5317                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5318                 88  CF-ZERO-CARRIER            VALUE '1'.
  5319                 88  CF-ZERO-GROUPING           VALUE '2'.
  5320                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5321             20  CF-EDIT-SW                 PIC X.
  5322                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5323             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5324             20  CF-CR-PR-METHOD            PIC X.
  5325               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5326               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5327             20  FILLER                     PIC X.
  5328
  5329         16  CF-CREDIT-MISC-CONTROLS.
  5330             20  CF-REIN-TABLE-SW           PIC X.
  5331                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5332             20  CF-COMP-TABLE-SW           PIC X.
  5333                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5334             20  CF-EXPERIENCE-RETENTION-AGE
  5335                                            PIC S9        COMP-3.
  5336             20  CF-CONVERSION-DT           PIC XX.
  5337             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page  99
* EL050.cbl
  5338             20  CF-RUN-FREQUENCY-SW        PIC X.
  5339                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5340                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5341
  5342             20  CF-CR-CHECK-NO-CONTROL.
  5343                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5344                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5345                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5346                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5347                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5348                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5349
  5350                 24  CF-CR-CHECK-COUNT       REDEFINES
  5351                     CF-CR-CHECK-COUNTER      PIC X(4).
  5352
  5353                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5354                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5355
  5356                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5357                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5358                 24  CF-MAIL-PROCESSING       PIC X.
  5359                     88  MAIL-PROCESSING          VALUE 'Y'.
  5360
  5361         16  CF-MISC-SYSTEM-CONTROL.
  5362             20  CF-SYSTEM-C                 PIC X.
  5363                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5364             20  CF-SYSTEM-D                 PIC X.
  5365                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5366             20  CF-SOC-SEC-NO-SW            PIC X.
  5367                 88  SOC-SEC-NO-USED             VALUE '1'.
  5368             20  CF-MEMBER-NO-SW             PIC X.
  5369                 88  MEMBER-NO-USED              VALUE '1'.
  5370             20  CF-TAX-ID-NUMBER            PIC X(11).
  5371             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5372             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5373                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5374                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5375                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5376                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5377             20  CF-SYSTEM-E                 PIC X.
  5378                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5379
  5380         16  CF-LGX-LIFE-USER               PIC X.
  5381             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5382             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5383
  5384         16  CF-CR-MONTH-END-DT             PIC XX.
  5385
  5386         16  CF-FILE-MAINT-DATES.
  5387             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5388                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5389             20  CF-LAST-BATCH       REDEFINES
  5390                 CF-LAST-BATCH-NO               PIC X(4).
  5391             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5392             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5393             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5394             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5395             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 100
* EL050.cbl
  5396             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5397             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5398             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5399             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5400             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5401
  5402         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5403         16  FILLER                         PIC X.
  5404
  5405         16  CF-ALT-MORT-CODE               PIC X(4).
  5406         16  CF-MEMBER-CAPTION              PIC X(10).
  5407
  5408         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5409             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5410             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5411             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5412             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5413             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5414
  5415         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5416
  5417         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5418         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5419         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5420         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5421
  5422         16  CF-AH-OVERRIDE-L1              PIC X.
  5423         16  CF-AH-OVERRIDE-L2              PIC XX.
  5424         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5425         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5426
  5427         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5428         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5429
  5430         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5431         16  CF-AR-LAST-EL860-DT            PIC XX.
  5432         16  CF-MP-MONTH-END-DT             PIC XX.
  5433
  5434         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5435         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5436             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5437
  5438         16  CF-AR-MONTH-END-DT             PIC XX.
  5439
  5440         16  CF-CRDTCRD-USER                PIC X.
  5441             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5442             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5443
  5444         16  CF-CC-MONTH-END-DT             PIC XX.
  5445
  5446         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5447
  5448         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5449             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5450             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5451             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5452         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5453         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 101
* EL050.cbl
  5454         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5455         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5456             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5457             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5458         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5459         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5460         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5461             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5462         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5463
  5464         16  CF-CL-ZIP-CODE.
  5465             20  CF-CL-ZIP-PRIME.
  5466                 24  CF-CL-ZIP-1ST          PIC X.
  5467                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5468                 24  FILLER                 PIC X(4).
  5469             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5470         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5471             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5472             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5473             20  FILLER                     PIC XXX.
  5474
  5475         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5476         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5477         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5478         16  CF-CO-OPTION-START-DATE        PIC XX.
  5479         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5480           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5481                                                      '3' '4'.
  5482           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5483           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5484           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5485           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5486           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5487           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5488
  5489         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5490
  5491         16  CF-PAYMENT-APPROVAL-LEVELS.
  5492             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5493             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5494             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5495             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5496             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5497             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5498
  5499         16  CF-END-USER-REPORTING-USER     PIC X.
  5500             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5501             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5502
  5503         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5504             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5505             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5506
  5507         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5508
  5509         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5510         16  FILLER                         PIC X.
  5511
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 102
* EL050.cbl
  5512         16  CF-CREDIT-ARCHIVE-CNTL.
  5513             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5514             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5515             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5516
  5517         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5518
  5519         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5520             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5521             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5522
  5523         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5524             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5525             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5526
  5527         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5528
  5529         16  CF-CO-ACH-ID-CODE              PIC  X.
  5530             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5531             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5532             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5533         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5534         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5535         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5536         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5537         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5538         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5539         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5540         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5541         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5542                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5543         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5544                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5545
  5546         16  CF-CO-OVER-SHORT.
  5547             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5548             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5549
  5550*         16  FILLER                         PIC X(102).
  5551         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5552             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5553             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5554
  5555         16  CF-AH-APPROVAL-DAYS.
  5556             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5557             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5558             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5559             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5560
  5561         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5562
  5563         16  CF-APPROV-LEV-5.
  5564             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5565             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5566             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5567
  5568         16  FILLER                         PIC X(68).
  5569****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 103
* EL050.cbl
  5570*             PROCESSOR/USER RECORD                            *
  5571****************************************************************
  5572
  5573     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5574         16  CF-PROCESSOR-NAME              PIC X(30).
  5575         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5576         16  CF-PROCESSOR-TITLE             PIC X(26).
  5577         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5578                 88  MESSAGE-YES                VALUE 'Y'.
  5579                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5580
  5581*****************************************************
  5582****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5583****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5584****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5585****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5586*****************************************************
  5587
  5588         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5589             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5590             20  CF-APPLICATION-FORCE       PIC X.
  5591             20  CF-INDIVIDUAL-APP.
  5592                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5593                     28  CF-BROWSE-APP      PIC X.
  5594                     28  CF-UPDATE-APP      PIC X.
  5595
  5596         16  CF-CURRENT-TERM-ON             PIC X(4).
  5597         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5598             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5599             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5600             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5601             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5602             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5603             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5604             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5605         16  CF-PROCESSOR-CARRIER           PIC X.
  5606             88  NO-CARRIER-SECURITY            VALUE ' '.
  5607         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5608             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5609         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5610             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5611         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5612             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5613
  5614         16  CF-PROC-SYS-ACCESS-SW.
  5615             20  CF-PROC-CREDIT-CLAIMS-SW.
  5616                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5617                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5618                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5619                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5620             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5621                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5622                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5623             20  CF-PROC-LIFE-GNRLDGR-SW.
  5624                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5625                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5626                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5627                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 104
* EL050.cbl
  5628             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5629                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5630                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5631         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5632             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5633             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5634         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5635
  5636         16  CF-APPROVAL-LEVEL                  PIC X.
  5637             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5638             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5639             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5640             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5641             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5642
  5643         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5644
  5645         16  CF-LANGUAGE-TYPE                   PIC X.
  5646             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5647             88  CF-LANG-IS-FR                      VALUE 'F'.
  5648
  5649         16  CF-CSR-IND                         PIC X.
  5650         16  FILLER                             PIC X(239).
  5651
  5652****************************************************************
  5653*             PROCESSOR/REMINDERS RECORD                       *
  5654****************************************************************
  5655
  5656     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5657         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5658             20  CF-START-REMIND-DT         PIC XX.
  5659             20  CF-END-REMIND-DT           PIC XX.
  5660             20  CF-REMINDER-TEXT           PIC X(50).
  5661         16  FILLER                         PIC X(296).
  5662
  5663
  5664****************************************************************
  5665*             STATE MASTER RECORD                              *
  5666****************************************************************
  5667
  5668     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5669         16  CF-STATE-ABBREVIATION          PIC XX.
  5670         16  CF-STATE-NAME                  PIC X(25).
  5671         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5672         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5673             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5674             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5675             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5676             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5677                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5678                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5679             20  CF-ST-PREM-REJECT-SW       PIC X.
  5680                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5681                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5682             20  CF-ST-REF-REJECT-SW        PIC X.
  5683                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5684                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5685         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 105
* EL050.cbl
  5686         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5687         16  CF-ST-REFUND-RULES.
  5688             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5689             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5690             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5691         16  CF-ST-FST-PMT-EXTENSION.
  5692             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5693             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5694                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5695                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5696                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5697                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5698         16  CF-ST-STATE-CALL.
  5699             20  CF-ST-CALL-UNEARNED        PIC X.
  5700             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5701             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5702         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5703             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5704             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5705         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5706         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5707         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5708         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5709         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5710         16  FILLER                         PIC X.
  5711         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5712             20  CF-ST-BENEFIT-CD           PIC XX.
  5713             20  CF-ST-BENEFIT-KIND         PIC X.
  5714                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5715                 88  CF-ST-AH-KIND              VALUE 'A'.
  5716             20  CF-ST-REM-TERM-CALC        PIC X.
  5717                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5718                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5719                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5720                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5721                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5722                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5723                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5724                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5725
  5726             20  CF-ST-REFUND-CALC          PIC X.
  5727                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5728                 88  ST-REFD-BY-R78             VALUE '1'.
  5729                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5730                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5731                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5732                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5733                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5734                 88  ST-REFD-UTAH               VALUE '7'.
  5735                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5736                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5737                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5738
  5739             20  CF-ST-EARNING-CALC         PIC X.
  5740                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5741                 88  ST-EARN-BY-R78             VALUE '1'.
  5742                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5743                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 106
* EL050.cbl
  5744                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5745                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5746                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5747                 88  ST-EARN-MEAN               VALUE '8'.
  5748                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5749
  5750             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5751                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5752                 88  ST-OVRD-BY-R78             VALUE '1'.
  5753                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5754                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5755                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5756                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5757                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5758                 88  ST-OVRD-MEAN               VALUE '8'.
  5759                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5760             20  cf-st-extra-periods        pic 9.
  5761*            20  FILLER                     PIC X.
  5762
  5763         16  CF-ST-COMMISSION-CAPS.
  5764             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5765             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5766             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5767             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5768         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5769                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5770                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5771                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5772
  5773         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5774
  5775         16  CF-ST-STATUTORY-INTEREST.
  5776             20  CF-ST-STAT-DATE-FROM       PIC X.
  5777                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5778                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5779             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5780             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5781             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5782             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5783             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5784
  5785         16  CF-ST-OVER-SHORT.
  5786             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5787             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5788
  5789         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5790
  5791         16  CF-ST-RT-CALC                  PIC X.
  5792
  5793         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5794         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5795         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5796         16  CF-ST-RF-LR-CALC               PIC X.
  5797         16  CF-ST-RF-LL-CALC               PIC X.
  5798         16  CF-ST-RF-LN-CALC               PIC X.
  5799         16  CF-ST-RF-AH-CALC               PIC X.
  5800         16  CF-ST-RF-CP-CALC               PIC X.
  5801*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 107
* EL050.cbl
  5802*CIDMOD         16  FILLER                         PIC X(192).
  5803         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5804             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5805         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5806         16  CF-ST-VFY-2ND-BENE             PIC X.
  5807         16  CF-ST-CAUSAL-STATE             PIC X.
  5808         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5809         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5810         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5811             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5812         16  CF-ST-NET-ONLY-STATE           PIC X.
  5813             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5814         16  cf-commission-cap-required     pic x.
  5815         16  CF-ST-GA-COMMISSION-CAPS.
  5816             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5817             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5818             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5819             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5820         16  CF-ST-TOT-COMMISSION-CAPS.
  5821             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5822             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5823             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5824             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5825         16  FILLER                         PIC X(156).
  5826
  5827****************************************************************
  5828*             BENEFIT MASTER RECORD                            *
  5829****************************************************************
  5830
  5831     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5832         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5833             20  CF-BENEFIT-CODE            PIC XX.
  5834             20  CF-BENEFIT-NUMERIC  REDEFINES
  5835                 CF-BENEFIT-CODE            PIC XX.
  5836             20  CF-BENEFIT-ALPHA           PIC XXX.
  5837             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5838             20  CF-BENEFIT-COMMENT         PIC X(10).
  5839
  5840             20  CF-LF-COVERAGE-TYPE        PIC X.
  5841                 88  CF-REDUCING                VALUE 'R'.
  5842                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5843
  5844             20  CF-SPECIAL-CALC-CD         PIC X.
  5845                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5846                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5847                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5848                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5849                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5850                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5851                 88  CF-FARM-PLAN               VALUE 'F'.
  5852                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5853                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5854                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5855                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5856                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5857                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5858                 88  CF-PRUDENTIAL              VALUE 'P'.
  5859                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 108
* EL050.cbl
  5860                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5861                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5862                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5863                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5864                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5865
  5866             20  CF-JOINT-INDICATOR         PIC X.
  5867                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5868
  5869*            20  FILLER                     PIC X(12).
  5870             20  cf-maximum-benefits        pic s999 comp-3.
  5871             20  FILLER                     PIC X(09).
  5872             20  CF-BENEFIT-CATEGORY        PIC X.
  5873             20  CF-LOAN-TYPE               PIC X(8).
  5874
  5875             20  CF-CO-REM-TERM-CALC        PIC X.
  5876                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5877                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5878                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5879                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5880                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5881
  5882             20  CF-CO-EARNINGS-CALC        PIC X.
  5883                 88  CO-EARN-BY-R78             VALUE '1'.
  5884                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5885                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5886                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5887                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5888                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5889                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5890                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5891
  5892             20  CF-CO-REFUND-CALC          PIC X.
  5893                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5894                 88  CO-REFD-BY-R78             VALUE '1'.
  5895                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5896                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5897                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5898                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5899                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5900                 88  CO-REFD-MEAN               VALUE '8'.
  5901                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5902                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5903                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5904
  5905             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5906                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5907                 88  CO-OVRD-BY-R78             VALUE '1'.
  5908                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5909                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5910                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5911                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5912                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5913                 88  CO-OVRD-MEAN               VALUE '8'.
  5914                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5915
  5916             20  CF-CO-BEN-I-G-CD           PIC X.
  5917                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 109
* EL050.cbl
  5918                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5919                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5920
  5921         16  FILLER                         PIC X(304).
  5922
  5923
  5924****************************************************************
  5925*             CARRIER MASTER RECORD                            *
  5926****************************************************************
  5927
  5928     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5929         16  CF-ADDRESS-DATA.
  5930             20  CF-MAIL-TO-NAME            PIC X(30).
  5931             20  CF-IN-CARE-OF              PIC X(30).
  5932             20  CF-ADDRESS-LINE-1          PIC X(30).
  5933             20  CF-ADDRESS-LINE-2          PIC X(30).
  5934             20  CF-CITY-STATE              PIC X(30).
  5935             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5936             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5937
  5938         16  CF-CLAIM-NO-CONTROL.
  5939             20  CF-CLAIM-NO-METHOD         PIC X.
  5940                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5941                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5942                 88  CLAIM-NO-SEQ               VALUE '3'.
  5943                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5944             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5945                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5946                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5947                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5948
  5949         16  CF-CHECK-NO-CONTROL.
  5950             20  CF-CHECK-NO-METHOD         PIC X.
  5951                 88  CHECK-NO-MANUAL            VALUE '1'.
  5952                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5953                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5954                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5955             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5956                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5957
  5958         16  CF-DOMICILE-STATE              PIC XX.
  5959
  5960         16  CF-EXPENSE-CONTROLS.
  5961             20  CF-EXPENSE-METHOD          PIC X.
  5962                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5963                 88  DOLLARS-PER-PMT            VALUE '2'.
  5964                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5965                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5966             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5967             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5968
  5969         16  CF-CORRESPONDENCE-CONTROL.
  5970             20  CF-LETTER-RESEND-OPT       PIC X.
  5971                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5972                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5973             20  FILLER                     PIC X(4).
  5974
  5975         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 110
* EL050.cbl
  5976             20  CF-MANUAL-SW               PIC X.
  5977                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5978             20  CF-FUTURE-SW               PIC X.
  5979                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5980             20  CF-PTC-SW                  PIC X.
  5981                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5982             20  CF-IBNR-SW                 PIC X.
  5983                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5984             20  CF-PTC-LF-SW               PIC X.
  5985                 88  CF-LF-PTC-USED             VALUE '1'.
  5986             20  CF-CDT-ACCESS-METHOD       PIC X.
  5987                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5988                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5989                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5990             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5991
  5992         16  CF-CLAIM-CALC-METHOD           PIC X.
  5993             88  360-PLUS-MONTHS                VALUE '1'.
  5994             88  365-PLUS-MONTHS                VALUE '2'.
  5995             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5996             88  360-DAILY                      VALUE '4'.
  5997             88  365-DAILY                      VALUE '5'.
  5998
  5999         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6000         16  FILLER                         PIC X(11).
  6001
  6002         16  CF-LIMIT-AMOUNTS.
  6003             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6004             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6005             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6006             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6007             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6008             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6009             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6010             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6011             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6012             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6013
  6014         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6015         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6016         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6017
  6018         16  CF-ZIP-CODE.
  6019             20  CF-ZIP-PRIME.
  6020                 24  CF-ZIP-1ST             PIC X.
  6021                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6022                 24  FILLER                 PIC X(4).
  6023             20  CF-ZIP-PLUS4               PIC X(4).
  6024         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6025             20  CF-CAN-POSTAL-1            PIC XXX.
  6026             20  CF-CAN-POSTAL-2            PIC XXX.
  6027             20  FILLER                     PIC XXX.
  6028
  6029         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6030         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6031         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6032
  6033         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 111
* EL050.cbl
  6034             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6035             88  CF-NO-RATING                   VALUE 'N'.
  6036
  6037         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6038
  6039         16  CF-CARRIER-OVER-SHORT.
  6040             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6041             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6042
  6043         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6044         16  CF-SECPAY-SWITCH               PIC X.
  6045             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6046             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6047         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6048         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6049         16  FILLER                         PIC X(444).
  6050*        16  FILLER                         PIC X(452).
  6051
  6052
  6053****************************************************************
  6054*             MORTALITY MASTER RECORD                          *
  6055****************************************************************
  6056
  6057     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6058         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6059                                INDEXED BY CF-MORT-NDX.
  6060             20  CF-MORT-TABLE              PIC X(5).
  6061             20  CF-MORT-TABLE-TYPE         PIC X.
  6062                 88  CF-MORT-JOINT              VALUE 'J'.
  6063                 88  CF-MORT-SINGLE             VALUE 'S'.
  6064                 88  CF-MORT-COMBINED           VALUE 'C'.
  6065                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6066                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6067             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6068             20  CF-MORT-AGE-METHOD         PIC XX.
  6069                 88  CF-AGE-LAST                VALUE 'AL'.
  6070                 88  CF-AGE-NEAR                VALUE 'AN'.
  6071             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6072             20  CF-MORT-ADJUSTMENT-DIRECTION
  6073                                            PIC X.
  6074                 88  CF-MINUS                   VALUE '-'.
  6075                 88  CF-PLUS                    VALUE '+'.
  6076             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6077             20  CF-MORT-JOINT-CODE         PIC X.
  6078                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6079             20  CF-MORT-PC-Q               PIC X.
  6080                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6081             20  CF-MORT-TABLE-CODE         PIC X(4).
  6082             20  CF-MORT-COMMENTS           PIC X(15).
  6083             20  FILLER                     PIC X(14).
  6084
  6085         16  FILLER                         PIC X(251).
  6086
  6087
  6088****************************************************************
  6089*             BUSSINESS TYPE MASTER RECORD                     *
  6090****************************************************************
  6091
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 112
* EL050.cbl
  6092     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6093* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6094* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6095* AND RECORD 05 IS TYPES 81-99
  6096         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6097             20  CF-BUSINESS-TITLE          PIC  X(19).
  6098             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6099                                            PIC S9V9(4) COMP-3.
  6100             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6101             20  FILLER                     PIC  X.
  6102         16  FILLER                         PIC  X(248).
  6103
  6104
  6105****************************************************************
  6106*             TERMINAL MASTER RECORD                           *
  6107****************************************************************
  6108
  6109     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6110
  6111         16  CF-COMPANY-TERMINALS.
  6112             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6113                                  PIC X(4).
  6114         16  FILLER               PIC X(248).
  6115
  6116
  6117****************************************************************
  6118*             LIFE EDIT MASTER RECORD                          *
  6119****************************************************************
  6120
  6121     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6122         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6123             20  CF-LIFE-CODE-IN            PIC XX.
  6124             20  CF-LIFE-CODE-OUT           PIC XX.
  6125         16  FILLER                         PIC X(248).
  6126
  6127
  6128****************************************************************
  6129*             AH EDIT MASTER RECORD                            *
  6130****************************************************************
  6131
  6132     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6133         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6134             20  CF-AH-CODE-IN              PIC XXX.
  6135             20  CF-AH-CODE-OUT             PIC XX.
  6136         16  FILLER                         PIC X(248).
  6137
  6138
  6139****************************************************************
  6140*             CREDIBILITY TABLES                               *
  6141****************************************************************
  6142
  6143     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6144         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6145                             INDEXED BY CF-CRDB-NDX.
  6146             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6147             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6148             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6149         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 113
* EL050.cbl
  6150
  6151
  6152****************************************************************
  6153*             REPORT CUSTOMIZATION RECORD                      *
  6154****************************************************************
  6155
  6156     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6157         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6158             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6159             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6160             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6161**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6162****       A T-TRANSFER.                                   ****
  6163             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6164
  6165         16  FILLER                         PIC XX.
  6166
  6167         16  CF-CARRIER-CNTL-OPT.
  6168             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6169                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6170                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6171             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6172                                            PIC X.
  6173         16  CF-GROUP-CNTL-OPT.
  6174             20  CF-GROUP-OPT-SEQ           PIC 9.
  6175                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6176                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6177             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6178                                            PIC X(6).
  6179         16  CF-STATE-CNTL-OPT.
  6180             20  CF-STATE-OPT-SEQ           PIC 9.
  6181                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6182                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6183             20  CF-STATE-SELECT OCCURS 3 TIMES
  6184                                            PIC XX.
  6185         16  CF-ACCOUNT-CNTL-OPT.
  6186             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6187                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6188                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6189             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6190                                            PIC X(10).
  6191         16  CF-BUS-TYP-CNTL-OPT.
  6192             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6193                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6194                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6195             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6196                                            PIC XX.
  6197         16  CF-LF-TYP-CNTL-OPT.
  6198             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6199                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6200                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6201             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6202                                            PIC XX.
  6203         16  CF-AH-TYP-CNTL-OPT.
  6204             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6205                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6206                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6207             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 114
* EL050.cbl
  6208                                            PIC XX.
  6209         16  CF-REPTCD1-CNTL-OPT.
  6210             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6211                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6212                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6213             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6214                                            PIC X(10).
  6215         16  CF-REPTCD2-CNTL-OPT.
  6216             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6217                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6218                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6219             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6220                                            PIC X(10).
  6221         16  CF-USER1-CNTL-OPT.
  6222             20  CF-USER1-OPT-SEQ           PIC 9.
  6223                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6224                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6225             20  CF-USER1-SELECT OCCURS 3 TIMES
  6226                                            PIC X(10).
  6227         16  CF-USER2-CNTL-OPT.
  6228             20  CF-USER2-OPT-SEQ           PIC 9.
  6229                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6230                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6231             20  CF-USER2-SELECT OCCURS 3 TIMES
  6232                                            PIC X(10).
  6233         16  CF-USER3-CNTL-OPT.
  6234             20  CF-USER3-OPT-SEQ           PIC 9.
  6235                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6236                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6237             20  CF-USER3-SELECT OCCURS 3 TIMES
  6238                                            PIC X(10).
  6239         16  CF-USER4-CNTL-OPT.
  6240             20  CF-USER4-OPT-SEQ           PIC 9.
  6241                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6242                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6243             20  CF-USER4-SELECT OCCURS 3 TIMES
  6244                                            PIC X(10).
  6245         16  CF-USER5-CNTL-OPT.
  6246             20  CF-USER5-OPT-SEQ           PIC 9.
  6247                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6248                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6249             20  CF-USER5-SELECT OCCURS 3 TIMES
  6250                                            PIC X(10).
  6251         16  CF-REINS-CNTL-OPT.
  6252             20  CF-REINS-OPT-SEQ           PIC 9.
  6253                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6254                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6255             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6256                 24  CF-REINS-PRIME         PIC XXX.
  6257                 24  CF-REINS-SUB           PIC XXX.
  6258
  6259         16  CF-AGENT-CNTL-OPT.
  6260             20  CF-AGENT-OPT-SEQ           PIC 9.
  6261                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6262                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6263             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6264                                            PIC X(10).
  6265
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 115
* EL050.cbl
  6266         16  FILLER                         PIC X(43).
  6267
  6268         16  CF-LOSS-RATIO-SELECT.
  6269             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6270             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6271         16  CF-ENTRY-DATE-SELECT.
  6272             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6273             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6274         16  CF-EFFECTIVE-DATE-SELECT.
  6275             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6276             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6277
  6278         16  CF-EXCEPTION-LIST-IND          PIC X.
  6279             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6280
  6281         16  FILLER                         PIC X(318).
  6282
  6283****************************************************************
  6284*                  EXCEPTION REPORTING RECORD                  *
  6285****************************************************************
  6286
  6287     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6288         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6289             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6290
  6291         16  CF-COMBINED-LIFE-AH-OPT.
  6292             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6293             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6294             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6295             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6296
  6297         16  CF-LIFE-OPT.
  6298             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6299             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6300             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6301             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6302             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6303             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6304             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6305             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6306             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6307             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6308
  6309         16  CF-AH-OPT.
  6310             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6311             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6312             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6313             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6314             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6315             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6316             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6317             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6318             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6319             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6320
  6321         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6322             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6323             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 116
* EL050.cbl
  6324             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6325
  6326         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6327
  6328         16  FILLER                         PIC X(673).
  6329
  6330
  6331****************************************************************
  6332*             MORTGAGE SYSTEM PLAN RECORD                      *
  6333****************************************************************
  6334
  6335     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6336         16  CF-PLAN-TYPE                   PIC X.
  6337             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6338             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6339             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6340         16  CF-PLAN-ABBREV                 PIC XXX.
  6341         16  CF-PLAN-DESCRIPT               PIC X(10).
  6342         16  CF-PLAN-NOTES                  PIC X(20).
  6343         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6344         16  CF-PLAN-UNDERWRITING.
  6345             20  CF-PLAN-TERM-DATA.
  6346                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6347                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6348             20  CF-PLAN-AGE-DATA.
  6349                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6350                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6351                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6352             20  CF-PLAN-BENEFIT-DATA.
  6353                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6354                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6355                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6356                                            PIC S9(7)V99  COMP-3.
  6357         16  CF-PLAN-POLICY-FORMS.
  6358             20  CF-POLICY-FORM             PIC X(12).
  6359             20  CF-MASTER-APPLICATION      PIC X(12).
  6360             20  CF-MASTER-POLICY           PIC X(12).
  6361         16  CF-PLAN-RATING.
  6362             20  CF-RATE-CODE               PIC X(5).
  6363             20  CF-SEX-RATING              PIC X.
  6364                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6365                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6366             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6367             20  CF-SUB-STD-TYPE            PIC X.
  6368                 88  CF-PCT-OF-PREM            VALUE '1'.
  6369                 88  CF-PCT-OF-BENE            VALUE '2'.
  6370         16  CF-PLAN-PREM-TOLERANCES.
  6371             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6372             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6373         16  CF-PLAN-PYMT-TOLERANCES.
  6374             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6375             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6376         16  CF-PLAN-MISC-DATA.
  6377             20  FILLER                     PIC X.
  6378             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6379             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6380         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6381         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 117
* EL050.cbl
  6382             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6383                                                     '1'.
  6384             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6385                                                     '2'.
  6386         16  CF-MIB-SEARCH-SW               PIC X.
  6387             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6388             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6389             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6390             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6391         16  CF-ALPHA-SEARCH-SW             PIC X.
  6392             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6393             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6394             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6395             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6396             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6397             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6398             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6399             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6400             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6401             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6402                                                     'A' 'B' 'C'
  6403                                                     'X' 'Y' 'Z'.
  6404         16  CF-EFF-DT-RULE-SW              PIC X.
  6405             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6406             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6407             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6408             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6409             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6410         16  FILLER                         PIC X(4).
  6411         16  CF-HEALTH-QUESTIONS            PIC X.
  6412             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6413         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6414         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6415         16  CF-PLAN-SNGL-JNT               PIC X.
  6416             88  CF-COMBINED-PLAN              VALUE 'C'.
  6417             88  CF-JNT-PLAN                   VALUE 'J'.
  6418             88  CF-SNGL-PLAN                  VALUE 'S'.
  6419         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6420         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6421         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6422         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6423         16  CF-RERATE-CNTL                 PIC  X.
  6424             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6425             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6426             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6427             88  CF-AUTO-RECALC                 VALUE '4'.
  6428         16  CF-BENEFIT-TYPE                PIC  X.
  6429             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6430             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6431         16  CF-POLICY-FEE                  PIC S999V99
  6432                                                    COMP-3.
  6433         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6434         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6435         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6436         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6437         16  FILLER                         PIC  X(32).
  6438         16  CF-TERMINATION-FORM            PIC  X(04).
  6439         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 118
* EL050.cbl
  6440         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6441                                                       COMP-3.
  6442         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6443         16  CF-ISSUE-LETTER                PIC  X(4).
  6444         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6445         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6446             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6447             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6448         16  CF-MP-REFUND-CALC              PIC X.
  6449             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6450             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6451             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6452             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6453             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6454             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6455             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6456             88  CF-MP-REFD-MEAN                VALUE '8'.
  6457         16  CF-ALT-RATE-CODE               PIC  X(5).
  6458
  6459
  6460         16  FILLER                         PIC X(498).
  6461****************************************************************
  6462*             MORTGAGE COMPANY MASTER RECORD                   *
  6463****************************************************************
  6464
  6465     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6466         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6467         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6468             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6469             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6470             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6471             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6472             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6473
  6474         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6475         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6476         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6477         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6478         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6479
  6480         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6481             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6482         16  CF-MP-RECON-USE-IND            PIC X(1).
  6483             88  CF-MP-USE-RECON             VALUE 'Y'.
  6484         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6485             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6486         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6487             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6488             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6489         16  FILLER                         PIC X(1).
  6490         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6491             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6492         16  CF-MORTG-MIB-VERSION           PIC X.
  6493             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6494             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6495             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6496         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6497             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 119
* EL050.cbl
  6498                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6499             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6500                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6501             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6502                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6503             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6504                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6505             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6506                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6507             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6508                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6509         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6510         16  FILLER                         PIC X(7).
  6511         16  CF-MORTG-DESTINATION-SYMBOL.
  6512             20  CF-MORTG-MIB-COMM          PIC X(5).
  6513             20  CF-MORTG-MIB-TERM          PIC X(5).
  6514         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6515             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6516         16  FILLER                         PIC X(03).
  6517         16  CF-MP-CHECK-NO-CONTROL.
  6518             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6519                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6520                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6521                                                ' ' LOW-VALUES.
  6522                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6523                                               VALUE '3'.
  6524         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6525         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6526         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6527             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6528                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6529             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6530                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6531             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6532                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6533             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6534                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6535             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6536                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6537             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6538                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6539         16  CF-MORTG-BILLING-AREA.
  6540             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6541                                            PIC X.
  6542         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6543         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6544         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6545         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6546             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6547             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6548         16  FILLER                         PIC X.
  6549         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6550             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6551             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6552         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6553         16  FILLER                         PIC X(8).
  6554         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6555         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 120
* EL050.cbl
  6556         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6557         16  CF-ACH-COMPANY-ID.
  6558             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6559                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6560                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6561                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6562             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6563         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6564             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6565         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6566             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6567             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6568         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6569         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6570         16  FILLER                         PIC X(536).
  6571
  6572****************************************************************
  6573*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6574****************************************************************
  6575
  6576     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6577         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6578             20  CF-FEMALE-HEIGHT.
  6579                 24  CF-FEMALE-FT           PIC 99.
  6580                 24  CF-FEMALE-IN           PIC 99.
  6581             20  CF-FEMALE-MIN-WT           PIC 999.
  6582             20  CF-FEMALE-MAX-WT           PIC 999.
  6583         16  FILLER                         PIC X(428).
  6584
  6585     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6586         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6587             20  CF-MALE-HEIGHT.
  6588                 24  CF-MALE-FT             PIC 99.
  6589                 24  CF-MALE-IN             PIC 99.
  6590             20  CF-MALE-MIN-WT             PIC 999.
  6591             20  CF-MALE-MAX-WT             PIC 999.
  6592         16  FILLER                         PIC X(428).
  6593******************************************************************
  6594*             AUTOMATIC ACTIVITY RECORD                          *
  6595******************************************************************
  6596     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6597         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6598             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6599             20  CF-SYS-LETTER-ID           PIC X(04).
  6600             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6601             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6602             20  CF-SYS-RESET-SW            PIC X(01).
  6603             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6604             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6605
  6606         16  FILLER                         PIC X(50).
  6607
  6608         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6609             20  CF-USER-ACTIVE-SW          PIC X(01).
  6610             20  CF-USER-LETTER-ID          PIC X(04).
  6611             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6612             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6613             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 121
* EL050.cbl
  6614             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6615             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6616             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6617
  6618         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 122
* EL050.cbl
  6620*    COPY ERCACCT.
  6621******************************************************************
  6622*                                                                *
  6623*                                                                *
  6624*                            ERCACCT                             *
  6625*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6626*                            VMOD=2.031                          *
  6627*                                                                *
  6628*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6629*                                                                *
  6630*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6631*   VSAM ACCOUNT MASTER FILES.                                   *
  6632*                                                                *
  6633*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6634*                                                                *
  6635*   FILE TYPE = VSAM,KSDS                                        *
  6636*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6637*                                                                *
  6638*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6639*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6640*                                                                *
  6641*   LOG = NO                                                     *
  6642*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6643*                                                                *
  6644*                                                                *
  6645******************************************************************
  6646*                   C H A N G E   L O G
  6647*
  6648* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6649*-----------------------------------------------------------------
  6650*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6651* EFFECTIVE    NUMBER
  6652*-----------------------------------------------------------------
  6653* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6654* 092705    2005050300006  PEMA  ADD SPP LEASES
  6655* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6656* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6657* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6658* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6659* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6660* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6661******************************************************************
  6662
  6663 01  ACCOUNT-MASTER.
  6664     12  AM-RECORD-ID                      PIC XX.
  6665         88  VALID-AM-ID                      VALUE 'AM'.
  6666
  6667     12  AM-CONTROL-PRIMARY.
  6668         16  AM-COMPANY-CD                 PIC X.
  6669         16  AM-MSTR-CNTRL.
  6670             20  AM-CONTROL-A.
  6671                 24  AM-CARRIER            PIC X.
  6672                 24  AM-GROUPING.
  6673                     28 AM-GROUPING-PREFIX PIC XXX.
  6674                     28 AM-GROUPING-PRIME  PIC XXX.
  6675                 24  AM-STATE              PIC XX.
  6676                 24  AM-ACCOUNT.
  6677                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 123
* EL050.cbl
  6678                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6679             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6680                                           PIC X(19).
  6681             20  AM-CNTRL-B.
  6682                 24  AM-EXPIRATION-DT      PIC XX.
  6683                 24  FILLER                PIC X(4).
  6684             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6685                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6686
  6687     12  AM-CONTROL-BY-VAR-GRP.
  6688         16  AM-COMPANY-CD-A1              PIC X.
  6689         16  AM-VG-CARRIER                 PIC X.
  6690         16  AM-VG-GROUPING                PIC X(6).
  6691         16  AM-VG-STATE                   PIC XX.
  6692         16  AM-VG-ACCOUNT                 PIC X(10).
  6693         16  AM-VG-DATE.
  6694             20  AM-VG-EXPIRATION-DT       PIC XX.
  6695             20  FILLER                    PIC X(4).
  6696         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6697                                           PIC 9(11)      COMP-3.
  6698     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6699         16  FILLER                        PIC X(10).
  6700         16  AM-VG-KEY3.
  6701             20  AM-VG3-ACCOUNT            PIC X(10).
  6702             20  AM-VG3-EXP-DT             PIC XX.
  6703         16  FILLER                        PIC X(4).
  6704     12  AM-MAINT-INFORMATION.
  6705         16  AM-LAST-MAINT-DT              PIC XX.
  6706         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6707         16  AM-LAST-MAINT-USER            PIC X(4).
  6708         16  FILLER                        PIC XX.
  6709
  6710     12  AM-EFFECTIVE-DT                   PIC XX.
  6711     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6712
  6713     12  AM-PREV-DATES  COMP-3.
  6714         16  AM-PREV-EXP-DT                PIC 9(11).
  6715         16  AM-PREV-EFF-DT                PIC 9(11).
  6716
  6717     12  AM-REPORT-CODE-1                  PIC X(10).
  6718     12  AM-REPORT-CODE-2                  PIC X(10).
  6719
  6720     12  AM-CITY-CODE                      PIC X(4).
  6721     12  AM-COUNTY-PARISH                  PIC X(6).
  6722
  6723     12  AM-NAME                           PIC X(30).
  6724     12  AM-PERSON                         PIC X(30).
  6725     12  AM-ADDRS                          PIC X(30).
  6726     12  AM-CITY.
  6727         16  AM-ADDR-CITY                  PIC X(28).
  6728         16  AM-ADDR-STATE                 PIC XX.
  6729     12  AM-ZIP.
  6730         16  AM-ZIP-PRIME.
  6731             20  AM-ZIP-PRI-1ST            PIC X.
  6732                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6733             20  FILLER                    PIC X(4).
  6734         16  AM-ZIP-PLUS4                  PIC X(4).
  6735     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 124
* EL050.cbl
  6736         16  AM-CAN-POSTAL-1               PIC XXX.
  6737         16  AM-CAN-POSTAL-2               PIC XXX.
  6738         16  FILLER                        PIC XXX.
  6739     12  AM-TEL-NO.
  6740         16  AM-AREA-CODE                  PIC 999.
  6741         16  AM-TEL-PRE                    PIC 999.
  6742         16  AM-TEL-NBR                    PIC 9(4).
  6743     12  AM-TEL-LOC                        PIC X.
  6744         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6745         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6746
  6747     12  AM-COMM-STRUCTURE.
  6748         16  AM-DEFN-1.
  6749             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6750                 24  AM-AGT.
  6751                     28  AM-AGT-PREFIX     PIC X(4).
  6752                     28  AM-AGT-PRIME      PIC X(6).
  6753                 24  AM-COM-TYP            PIC X.
  6754                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6755                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6756                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6757                 24  AM-RECALC-LV-INDIC    PIC X.
  6758                 24  AM-RETRO-LV-INDIC     PIC X.
  6759                 24  AM-GL-CODES           PIC X.
  6760                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6761                 24  FILLER                PIC X(01).
  6762         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6763             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6764                 24  FILLER                PIC X(11).
  6765                 24  AM-L-COMA             PIC XXX.
  6766                 24  AM-J-COMA             PIC XXX.
  6767                 24  AM-A-COMA             PIC XXX.
  6768                 24  FILLER                PIC X(6).
  6769
  6770     12  AM-COMM-CHANGE-STATUS             PIC X.
  6771         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6772
  6773     12  AM-CSR-CODE                       PIC X(4).
  6774
  6775     12  AM-BILLING-STATUS                 PIC X.
  6776         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6777         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6778     12  AM-AUTO-REFUND-SW                 PIC X.
  6779         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6780         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6781     12  AM-GPCD                           PIC 99.
  6782     12  AM-IG                             PIC X.
  6783         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6784         88  AM-HAS-GROUP                     VALUE '2'.
  6785     12  AM-STATUS                         PIC X.
  6786         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6787         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6788         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6789         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6790         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6791         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6792         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6793         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 125
* EL050.cbl
  6794         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6795         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6796     12  AM-REMIT-TO                       PIC 99.
  6797     12  AM-ID-NO                          PIC X(11).
  6798
  6799     12  AM-CAL-TABLE                      PIC XX.
  6800     12  AM-LF-DEVIATION                   PIC XXX.
  6801     12  AM-AH-DEVIATION                   PIC XXX.
  6802     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6803     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6804     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6805     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6806     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6807     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6808
  6809     12  AM-USER-FIELDS.
  6810         16  AM-FLD-1                      PIC XX.
  6811         16  AM-FLD-2                      PIC XX.
  6812         16  AM-FLD-3                      PIC XX.
  6813         16  AM-FLD-4                      PIC XX.
  6814         16  AM-FLD-5                      PIC XX.
  6815
  6816     12  AM-1ST-PROD-DATE.
  6817         16  AM-1ST-PROD-YR                PIC XX.
  6818         16  AM-1ST-PROD-MO                PIC XX.
  6819         16  AM-1ST-PROD-DA                PIC XX.
  6820     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6821     12  AM-CERTS-PURGED-DATE.
  6822         16  AM-PUR-YR                     PIC XX.
  6823         16  AM-PUR-MO                     PIC XX.
  6824         16  AM-PUR-DA                     PIC XX.
  6825     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6826     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6827     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6828     12  AM-INACTIVE-DATE.
  6829         16  AM-INA-MO                     PIC 99.
  6830         16  AM-INA-DA                     PIC 99.
  6831         16  AM-INA-YR                     PIC 99.
  6832     12  AM-AR-HI-CERT-DATE                PIC XX.
  6833
  6834     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6835     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6836
  6837     12  AM-OB-PAYMENT-MODE                PIC X.
  6838         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6839         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6840         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6841         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6842
  6843     12  AM-AH-ONLY-INDICATOR              PIC X.
  6844         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6845         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6846
  6847     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6848
  6849     12  AM-OVER-SHORT.
  6850         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6851         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 126
* EL050.cbl
  6852
  6853     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6854     12  AM-DCC-CLP-STATE                  PIC XX.
  6855
  6856     12  AM-RECALC-COMM                    PIC X.
  6857     12  AM-RECALC-REIN                    PIC X.
  6858
  6859     12  AM-REI-TABLE                      PIC XXX.
  6860     12  AM-REI-ET-LF                      PIC X.
  6861     12  AM-REI-ET-AH                      PIC X.
  6862     12  AM-REI-PE-LF                      PIC X.
  6863     12  AM-REI-PE-AH                      PIC X.
  6864     12  AM-REI-PRT-ST                     PIC X.
  6865     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6866     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6867     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6868     12  AM-REI-GROUP-A                    PIC X(6).
  6869     12  AM-REI-MORT                       PIC X(4).
  6870     12  AM-REI-PRT-OW                     PIC X.
  6871     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6872     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6873     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6874     12  AM-REI-GROUP-B                    PIC X(6).
  6875
  6876     12  AM-TRUST-TYPE                     PIC X(2).
  6877
  6878     12  AM-EMPLOYER-STMT-USED             PIC X.
  6879     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6880
  6881     12  AM-STD-AH-TYPE                    PIC XX.
  6882     12  AM-EARN-METHODS.
  6883         16  AM-EARN-METHOD-R              PIC X.
  6884             88 AM-REF-RL-R78                 VALUE 'R'.
  6885             88 AM-REF-RL-PR                  VALUE 'P'.
  6886             88 AM-REF-RL-MEAN                VALUE 'M'.
  6887             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6888         16  AM-EARN-METHOD-L              PIC X.
  6889             88 AM-REF-LL-R78                 VALUE 'R'.
  6890             88 AM-REF-LL-PR                  VALUE 'P'.
  6891             88 AM-REF-LL-MEAN                VALUE 'M'.
  6892             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6893         16  AM-EARN-METHOD-A              PIC X.
  6894             88 AM-REF-AH-R78                 VALUE 'R'.
  6895             88 AM-REF-AH-PR                  VALUE 'P'.
  6896             88 AM-REF-AH-MEAN                VALUE 'M'.
  6897             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6898             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6899             88 AM-REF-AH-NET                 VALUE 'N'.
  6900
  6901     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6902     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6903     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6904
  6905     12  AM-RET-Y-N                        PIC X.
  6906     12  AM-RET-P-E                        PIC X.
  6907     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6908     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6909     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 127
* EL050.cbl
  6910     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6911         16  AM-POOL-PRIME                 PIC XXX.
  6912         16  AM-POOL-SUB                   PIC XXX.
  6913     12  AM-RETRO-EARNINGS.
  6914         16  AM-RET-EARN-R                 PIC X.
  6915         16  AM-RET-EARN-L                 PIC X.
  6916         16  AM-RET-EARN-A                 PIC X.
  6917     12  AM-RET-ST-TAX-USE                 PIC X.
  6918         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6919         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6920     12  AM-RETRO-BEG-EARNINGS.
  6921         16  AM-RET-BEG-EARN-R             PIC X.
  6922         16  AM-RET-BEG-EARN-L             PIC X.
  6923         16  AM-RET-BEG-EARN-A             PIC X.
  6924     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6925     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6926
  6927     12  AM-USER-SELECT-OPTIONS.
  6928         16  AM-USER-SELECT-1              PIC X(10).
  6929         16  AM-USER-SELECT-2              PIC X(10).
  6930         16  AM-USER-SELECT-3              PIC X(10).
  6931         16  AM-USER-SELECT-4              PIC X(10).
  6932         16  AM-USER-SELECT-5              PIC X(10).
  6933
  6934     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6935
  6936     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6937
  6938     12  AM-RPT045A-SWITCH                 PIC X.
  6939         88  RPT045A-OFF                   VALUE 'N'.
  6940
  6941     12  AM-INSURANCE-LIMITS.
  6942         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6943         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6944
  6945     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6946         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6947
  6948     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6949         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6950         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6951
  6952     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6953
  6954     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6955     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6956     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6957     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6958     12  AM-DCC-UEF-STATE                  PIC XX.
  6959     12  FILLER                            PIC XXX.
  6960     12  AM-REPORT-CODE-3                  PIC X(10).
  6961*    12  FILLER                            PIC X(22).
  6962
  6963     12  AM-RESERVE-DATE.
  6964         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6965         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6966         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6967
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 128
* EL050.cbl
  6968     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6969     12  AM-NOTIFICATION-TYPES.
  6970         16  AM-NOTIF-OF-LETTERS           PIC X.
  6971         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6972         16  AM-NOTIF-OF-REPORTS           PIC X.
  6973         16  AM-NOTIF-OF-STATUS            PIC X.
  6974
  6975     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6976         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6977         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6978         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6979         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6980
  6981     12  AM-BENEFIT-CONTROLS.
  6982         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6983             20  AM-BENEFIT-CODE           PIC XX.
  6984             20  AM-BENEFIT-TYPE           PIC X.
  6985             20  AM-BENEFIT-REVISION       PIC XXX.
  6986             20  AM-BENEFIT-REM-TERM       PIC X.
  6987             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6988             20  FILLER                    PIC XX.
  6989         16  FILLER                        PIC X(80).
  6990
  6991     12  AM-TRANSFER-DATA.
  6992         16  AM-TRANSFERRED-FROM.
  6993             20  AM-TRNFROM-CARRIER        PIC X.
  6994             20  AM-TRNFROM-GROUPING.
  6995                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6996                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6997             20  AM-TRNFROM-STATE          PIC XX.
  6998             20  AM-TRNFROM-ACCOUNT.
  6999                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7000                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7001             20  AM-TRNFROM-DTE            PIC XX.
  7002         16  AM-TRANSFERRED-TO.
  7003             20  AM-TRNTO-CARRIER          PIC X.
  7004             20  AM-TRNTO-GROUPING.
  7005                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7006                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7007             20  AM-TRNTO-STATE            PIC XX.
  7008             20  AM-TRNTO-ACCOUNT.
  7009                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7010                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7011             20  AM-TRNTO-DTE              PIC XX.
  7012         16  FILLER                        PIC X(10).
  7013
  7014     12  AM-SAVED-REMIT-TO                 PIC 99.
  7015
  7016     12  AM-COMM-STRUCTURE-SAVED.
  7017         16  AM-DEFN-1-SAVED.
  7018             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7019                 24  AM-AGT-SV             PIC X(10).
  7020                 24  AM-COM-TYP-SV         PIC X.
  7021                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7022                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7023                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7024                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7025                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 129
* EL050.cbl
  7026                 24  AM-GL-CODES-SV        PIC X.
  7027                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7028                 24  FILLER                PIC X.
  7029         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7030             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7031                 24  FILLER                PIC X(11).
  7032                 24  AM-L-COMA-SV          PIC XXX.
  7033                 24  AM-J-COMA-SV          PIC XXX.
  7034                 24  AM-A-COMA-SV          PIC XXX.
  7035                 24  FILLER                PIC X(6).
  7036
  7037     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7038         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7039            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7040            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7041            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7042
  7043     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7044     12  FILLER                            PIC X(120).
  7045
  7046     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7047         16  AM-CONTROL-NAME               PIC X(30).
  7048         16  AM-EXECUTIVE-ONE.
  7049             20  AM-EXEC1-NAME             PIC X(15).
  7050             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7051                                                          COMP-3.
  7052             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7053                                                          COMP-3.
  7054         16  AM-EXECUTIVE-TWO.
  7055             20  AM-EXEC2-NAME             PIC X(15).
  7056             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7057                                                          COMP-3.
  7058             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7059                                                          COMP-3.
  7060
  7061     12  AM-RETRO-ADDITIONAL-DATA.
  7062         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7063         16  AM-RETRO-PREM-P-E             PIC X.
  7064         16  AM-RETRO-CLMS-P-I             PIC X.
  7065         16  AM-RETRO-RET-BRACKET-LF.
  7066             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7067                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7068                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7069             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7070                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7071                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7072             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7073                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7074                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7075         16  AM-RETRO-RET-BRACKET-AH.
  7076             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7077                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7078                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7079                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7080             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7081                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7082                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7083             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 130
* EL050.cbl
  7084                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7085                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7086
  7087     12  AM-COMMENTS.
  7088         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7089
  7090     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7091         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7092         16  AM-FLI-BILLING-CODE           PIC X.
  7093         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7094         16  AM-FLI-UNITED-IDENT           PIC X.
  7095         16  AM-FLI-INTEREST-LOST-DATA.
  7096             20  AM-FLI-BANK-NO            PIC X(5).
  7097             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7098             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7099             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7100         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7101             20  AM-FLI-AGT                PIC X(9).
  7102             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7103             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7104         16  FILLER                        PIC X(102).
  7105
  7106     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7107         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7108             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7109             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7110             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7111             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7112             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7113         16  FILLER                          PIC X(10).
  7114******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 131
* EL050.cbl
  7116*    COPY ERCREIN.
  7117******************************************************************
  7118*                                                                *
  7119*                            ERCREIN                             *
  7120*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7121*                            VMOD=2.010                          *
  7122*                                                                *
  7123*   ONLINE CREDIT SYSTEM                                         *
  7124*                                                                *
  7125*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7126*                                                                *
  7127*   FILE TYPE = VSAM,KSDS                                        *
  7128*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7129*                                                                *
  7130*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7131*       ALTERNATE PATH = NONE                                    *
  7132*                                                                *
  7133*   LOG = NO                                                     *
  7134*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7135*                                                                *
  7136******************************************************************
  7137*                   C H A N G E   L O G
  7138*
  7139* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7140*-----------------------------------------------------------------
  7141*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7142* EFFECTIVE    NUMBER
  7143*-----------------------------------------------------------------
  7144* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7145* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7146******************************************************************
  7147 01  REINSURANCE-RECORD.
  7148     12  RE-RECORD-ID                      PIC XX.
  7149         88  VALID-RE-ID                      VALUE 'RE'.
  7150
  7151     12  RE-CONTROL-PRIMARY.
  7152         16  RE-COMPANY-CD                 PIC X.
  7153         16  RE-KEY.
  7154             20  RE-CODE                   PIC X.
  7155                 88  RE-TABLE-RECORD          VALUE 'A'.
  7156                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7157             20  RE-TABLE                  PIC XXX.
  7158             20  FILLER                    PIC XXX.
  7159         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7160             20  FILLER                    PIC X.
  7161             20  RE-COMPANY.
  7162                 24  RE-COMP-PRIME         PIC XXX.
  7163                 24  RE-COMP-SUB           PIC XXX.
  7164
  7165     12  RE-MAINT-INFORMATION.
  7166         16  RE-LAST-MAINT-DT              PIC XX.
  7167         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7168         16  RE-LAST-MAINT-USER            PIC X(4).
  7169         16  FILLER                        PIC X(10).
  7170
  7171     12  RE-TABLE-DATA.
  7172         16  RE-100-COMP                   PIC 99.
  7173
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 132
* EL050.cbl
  7174         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7175             20  RE-REI-COMP-NO.
  7176                 24  RE-REI-COMP           PIC XXX.
  7177                 24  RE-REI-COMP-SUB       PIC XXX.
  7178             20  RE-LF-QC                  PIC X.
  7179             20  RE-AH-QC                  PIC X.
  7180             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7181             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7182             20  RE-LFAGE-LO               PIC 99.
  7183             20  RE-LFAGE-HI               PIC 99.
  7184             20  RE-AHAGE-LO               PIC 99.
  7185             20  RE-AHAGE-HI               PIC 99.
  7186             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7187             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7188             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7189             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7190             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7191             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7192             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7193             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7194             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7195             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7196             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7197             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7198             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7199             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7200             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7201             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7202             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7203             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7204             20  RE-LF-BEN-CODE            PIC X.
  7205             20  RE-AH-BEN-CODE            PIC X.
  7206             20  RE-INTERACTIVE            PIC X.
  7207             20  RE-REMAINING              PIC X.
  7208             20  RE-LF-RUNOFF-SW           PIC X.
  7209             20  RE-AH-RUNOFF-SW           PIC X.
  7210             20  FILLER                    PIC X(19).
  7211
  7212         16  RE-COMP-INFO-END              PIC X(6).
  7213         16  RE-NSP-ST-CD-LF               PIC XX.
  7214         16  RE-NSP-ST-CD-AH               PIC XX.
  7215         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7216             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7217
  7218         16  FILLER                        PIC X(27).
  7219
  7220     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7221         16  RE-NAME                       PIC X(30).
  7222         16  RE-LF-PE                      PIC X.
  7223         16  RE-AH-PE                      PIC X.
  7224         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7225         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7226         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7227         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7228         16  RE-PRT-ST                     PIC X.
  7229         16  RE-PRT-OW                     PIC X.
  7230         16  RE-MORT-CODE                  PIC X(4).
  7231         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 133
* EL050.cbl
  7232         16  RE-ZERO-LF-FEE                PIC X.
  7233         16  RE-ZERO-AH-FEE                PIC X.
  7234         16  RE-CEDE-NAME                  PIC X(30).
  7235         16  RE-LF-COMM                    PIC X.
  7236         16  RE-AH-COMM                    PIC X.
  7237         16  RE-LF-TAX                     PIC X.
  7238         16  RE-AH-TAX                     PIC X.
  7239         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7240         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7241         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7242
  7243         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7244             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7245
  7246         16  RE-LF-CEDING-FEE-BRACKETS.
  7247             20  RE-LF-FEE-METHOD          PIC X.
  7248                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7249                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7250                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7251                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7252             20  RE-LF-FEE-BASIS           PIC X.
  7253                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7254                 88  RE-LF-NET-CEDED               VALUE '2'.
  7255                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7256                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7257                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7258                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7259                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7260                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7261             20  FILLER                    PIC XXX.
  7262             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7263                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7264                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7265
  7266         16  RE-AH-CEDING-FEE-BRACKETS.
  7267             20  RE-AH-FEE-METHOD          PIC X.
  7268                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7269                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7270                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7271                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7272             20  RE-AH-FEE-BASIS           PIC X.
  7273                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7274                 88  RE-AH-NET-CEDED               VALUE '2'.
  7275                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7276                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7277                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7278                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7279                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7280                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7281             20  FILLER                    PIC XXX.
  7282             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7283                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7284                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7285
  7286         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7287
  7288         16  RE-OLD-CEDING-STMT            PIC X.
  7289
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 134
* EL050.cbl
  7290         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7291         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7292         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7293         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7294         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7295         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7296         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7297         16  RE-MORT-SW                    PIC X.
  7298         16  RE-CEDING-TYPE-FLAG           PIC X.
  7299             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7300             88  RE-CEDED                          VALUE 'C'.
  7301             88  RE-ASSUMED                        VALUE 'A'.
  7302             88  RE-PHANTOM                        VALUE 'P'.
  7303
  7304         16  RE-CEDING-STMT-OPT-A          PIC X.
  7305             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7306         16  RE-CEDING-STMT-OPT-B          PIC X.
  7307             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7308         16  RE-CEDING-STMT-OPT-C          PIC X.
  7309             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7310         16  RE-CEDING-STMT-OPT-D          PIC X.
  7311             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7312         16  RE-CEDING-STMT-OPT-E          PIC X.
  7313             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7314
  7315         16  RE-PRT-CRSV                   PIC X.
  7316
  7317         16  RE-GL-CENTER                  PIC X(4).
  7318
  7319         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7320
  7321         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7322
  7323         16  RE-EARN-STOP-CODE             PIC X.
  7324             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7325             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7326
  7327         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7328             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7329
  7330         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7331         16  FILLER                        PIC X(2281).
  7332
  7333         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7334
  7335******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 135
* EL050.cbl
  7337*    COPY ERCCTBL.
  7338******************************************************************
  7339*                                                                *
  7340*                                                                *
  7341*                            ERCCTBL                             *
  7342*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7343*                            VMOD=2.003
  7344*                                                                *
  7345*   ONLINE CREDIT SYSTEM                                         *
  7346*                                                                *
  7347*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7348*                                                                *
  7349*   FILE TYPE = VSAM,KSDS                                        *
  7350*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7351*                                                                *
  7352*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7353*       ALTERNATE PATH = NONE                                    *
  7354*                                                                *
  7355*   LOG = NO                                                     *
  7356*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7357*                                                                *
  7358*                                                                *
  7359******************************************************************
  7360
  7361 01  COMM-TABLE-RECORD.
  7362     12  CT-RECORD-ID                      PIC XX.
  7363         88  VALID-CT-ID                      VALUE 'CT'.
  7364
  7365     12  CT-CONTROL-PRIMARY.
  7366         16  CT-COMPANY-CD                 PIC X.
  7367         16  CT-TABLE                      PIC XXX.
  7368         16  CT-CNTRL-2.
  7369             20  CT-BEN-TYPE               PIC X.
  7370             20  CT-BEN-CODE               PIC XX.
  7371
  7372     12  CT-MAINT-INFORMATION.
  7373         16  CT-LAST-MAINT-DT              PIC XX.
  7374         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7375         16  CT-LAST-MAINT-USER            PIC X(4).
  7376         16  FILLER                        PIC X(31).
  7377
  7378     12  CT-LIMITS.
  7379         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7380
  7381         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7382
  7383         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7384
  7385     12  CT-RATES.
  7386         16  CT-RTX          OCCURS 27 TIMES.
  7387             20  CT-RT                     PIC SV9(5)     COMP-3.
  7388             20  CT-RT-R   REDEFINES
  7389                 CT-RT                     PIC XXX.
  7390
  7391     12  FILLER                            PIC  X(42).
  7392
  7393******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 136
* EL050.cbl
  7395*    COPY ERCFORM.
  7396******************************************************************
  7397*                                                                *
  7398*                                                                *
  7399*                            ERCFORM.                            *
  7400*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7401*                            VMOD=2.003                          *
  7402*                                                                *
  7403*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7404*                                                                *
  7405*    FILE TYPE = VSAM,KSDS                                       *
  7406*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7407*                                                                *
  7408*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7409*                                                                *
  7410*    LOG = YES                                                   *
  7411*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7412******************************************************************
  7413 01  FORM-MASTER.
  7414    12  FO-RECORD-ID                 PIC X(02).
  7415        88  VALID-FO-ID                  VALUE 'FO'.
  7416
  7417    12  FO-CONTROL-PRIMARY.
  7418        16  FO-COMPANY-CD            PIC X(01).
  7419        16  FO-STATE                 PIC X(02).
  7420        16  FO-FORM-ID               PIC X(12).
  7421        16  FO-FORM-EXP-DT           PIC X(02).
  7422
  7423    12  FO-POLICY-FORM-DATA.
  7424        16  FO-IND-GRP-CD            PIC X(01).
  7425        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7426        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7427        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7428        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7429        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7430        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7431        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7432        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7433        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7434        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7435        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7436        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7437        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7438        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7439        16  FO-APP-CERT-USE-CD       PIC X(01).
  7440
  7441    12  FILLER                       PIC X(29).
  7442
  7443    12  FO-FORM-PLAN-TABLE.
  7444        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7445            20  FO-PLAN-TYPE         PIC X(01).
  7446            20  FO-PLAN-ID           PIC X(02).
  7447            20  FO-PLAN-TERM         PIC 9(03).
  7448            20  FO-PLAN-REFUND-METHOD
  7449                                     PIC X.
  7450
  7451    12  FILLER                       PIC X(30).
  7452
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 137
* EL050.cbl
  7453    12  FO-COMMENTS-AREA.
  7454        16  FO-COMMENT-LINE-1        PIC X(78).
  7455
  7456    12  FILLER                       PIC X(20).
  7457
  7458    12  FO-MAINT-INFORMATION.
  7459        16  FO-LAST-MAINT-DT         PIC X(02).
  7460        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7461        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 138
* EL050.cbl
  7463*    COPY ELCMSTR.
  7464******************************************************************
  7465*                                                                *
  7466*                            ELCMSTR.                            *
  7467*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7468*                            VMOD=2.012                          *
  7469*                                                                *
  7470*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7471*                                                                *
  7472*   FILE TYPE = VSAM,KSDS                                        *
  7473*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7474*                                                                *
  7475*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7476*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7477*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7478*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7479*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7480*                                                 RKP=75,LEN=21  *
  7481*                                                                *
  7482*   **** NOTE ****                                               *
  7483*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7484*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7485*                                                                *
  7486*   LOG = YES                                                    *
  7487*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7488******************************************************************
  7489*                   C H A N G E   L O G
  7490*
  7491* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7492*-----------------------------------------------------------------
  7493*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7494* EFFECTIVE    NUMBER
  7495*-----------------------------------------------------------------
  7496* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7497* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7498* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7499* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7500* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7501* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7502******************************************************************
  7503 01  CLAIM-MASTER.
  7504     12  CL-RECORD-ID                PIC XX.
  7505         88  VALID-CL-ID         VALUE 'CL'.
  7506
  7507     12  CL-CONTROL-PRIMARY.
  7508         16  CL-COMPANY-CD           PIC X.
  7509         16  CL-CARRIER              PIC X.
  7510         16  CL-CLAIM-NO             PIC X(7).
  7511         16  CL-CERT-NO.
  7512             20  CL-CERT-PRIME       PIC X(10).
  7513             20  CL-CERT-SFX         PIC X.
  7514
  7515     12  CL-CONTROL-BY-NAME.
  7516         16  CL-COMPANY-CD-A1        PIC X.
  7517         16  CL-INSURED-LAST-NAME    PIC X(15).
  7518         16  CL-INSURED-NAME.
  7519             20  CL-INSURED-1ST-NAME PIC X(12).
  7520             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 139
* EL050.cbl
  7521
  7522     12  CL-CONTROL-BY-SSN.
  7523         16  CL-COMPANY-CD-A2        PIC X.
  7524         16  CL-SOC-SEC-NO.
  7525             20  CL-SSN-STATE        PIC XX.
  7526             20  CL-SSN-ACCOUNT      PIC X(6).
  7527             20  CL-SSN-LN3          PIC X(3).
  7528
  7529     12  CL-CONTROL-BY-CERT-NO.
  7530         16  CL-COMPANY-CD-A4        PIC X.
  7531         16  CL-CERT-NO-A4.
  7532             20  CL-CERT-A4-PRIME    PIC X(10).
  7533             20  CL-CERT-A4-SFX      PIC X.
  7534
  7535     12  CL-CONTROL-BY-CCN.
  7536         16  CL-COMPANY-CD-A5        PIC X.
  7537         16  CL-CCN-A5.
  7538             20  CL-CCN.
  7539                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7540                 24  CL-CCN-PRIME-A5 PIC X(12).
  7541             20  CL-CCN-FILLER-A5    PIC X(4).
  7542
  7543     12  CL-INSURED-PROFILE-DATA.
  7544         16  CL-INSURED-BIRTH-DT     PIC XX.
  7545         16  CL-INSURED-SEX-CD       PIC X.
  7546             88  INSURED-IS-MALE        VALUE 'M'.
  7547             88  INSURED-IS-FEMALE      VALUE 'F'.
  7548             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7549         16  CL-INSURED-OCC-CD       PIC X(6).
  7550         16  FILLER                  PIC X(5).
  7551
  7552     12  CL-PROCESSING-INFO.
  7553         16  CL-PROCESSOR-ID         PIC X(4).
  7554         16  CL-CLAIM-STATUS         PIC X.
  7555             88  CLAIM-IS-OPEN          VALUE 'O'.
  7556             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7557         16  CL-CLAIM-TYPE           PIC X.
  7558*            88  AH-CLAIM               VALUE 'A'.
  7559*            88  LIFE-CLAIM             VALUE 'L'.
  7560*            88  PROPERTY-CLAIM         VALUE 'P'.
  7561*            88  IUI-CLAIM              VALUE 'I'.
  7562*            88  GAP-CLAIM              VALUE 'G'.
  7563*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7564         16  CL-CLAIM-PREM-TYPE      PIC X.
  7565             88  SINGLE-PREMIUM         VALUE '1'.
  7566             88  O-B-COVERAGE           VALUE '2'.
  7567             88  OPEN-END-COVERAGE      VALUE '3'.
  7568         16  CL-INCURRED-DT          PIC XX.
  7569         16  CL-REPORTED-DT          PIC XX.
  7570         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7571         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7572         16  CL-LAST-PMT-DT          PIC XX.
  7573         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7574         16  CL-PAID-THRU-DT         PIC XX.
  7575         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7576         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7577         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7578         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 140
* EL050.cbl
  7579             88  CL-360-DAY-YR          VALUE '1'.
  7580             88  CL-365-DAY-YR          VALUE '2'.
  7581             88  CL-FULL-MONTHS         VALUE '3'.
  7582         16  CL-CAUSE-CD             PIC X(6).
  7583
  7584         16  CL-PRIME-CERT-NO.
  7585             20  CL-PRIME-CERT-PRIME PIC X(10).
  7586             20  CL-PRIME-CERT-SFX   PIC X.
  7587
  7588         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7589             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7590             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7591
  7592         16  CL-MICROFILM-NO         PIC X(10).
  7593         16  FILLER REDEFINES CL-MICROFILM-NO.
  7594             20  CL-BENEFIT-PERIOD   PIC 99.
  7595             20  FILLER              PIC X(8).
  7596         16  CL-PROG-FORM-TYPE       PIC X.
  7597         16  CL-LAST-ADD-ON-DT       PIC XX.
  7598
  7599         16  CL-LAST-REOPEN-DT       PIC XX.
  7600         16  CL-LAST-CLOSE-DT        PIC XX.
  7601         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7602             88  FINAL-PAID             VALUE '1'.
  7603             88  CLAIM-DENIED           VALUE '2'.
  7604             88  AUTO-CLOSE             VALUE '3'.
  7605             88  MANUAL-CLOSE           VALUE '4'.
  7606             88  BENEFITS-CHANGED       VALUE 'C'.
  7607             88  SETUP-ERRORS           VALUE 'E'.
  7608         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7609         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7610         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7611             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7612         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7613         16  FILLER                  PIC X.
  7614
  7615     12  CL-CERTIFICATE-DATA.
  7616         16  CL-CERT-ORIGIN          PIC X.
  7617             88  CERT-WAS-ONLINE        VALUE '1'.
  7618             88  CERT-WAS-CREATED       VALUE '2'.
  7619             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7620         16  CL-CERT-KEY-DATA.
  7621             20  CL-CERT-CARRIER     PIC X.
  7622             20  CL-CERT-GROUPING    PIC X(6).
  7623             20  CL-CERT-STATE       PIC XX.
  7624             20  CL-CERT-ACCOUNT.
  7625                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7626                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7627             20  CL-CERT-EFF-DT      PIC XX.
  7628
  7629     12  CL-STATUS-CONTROLS.
  7630         16  CL-PRIORITY-CD          PIC X.
  7631             88  CONFIDENTIAL-DATA      VALUE '8'.
  7632             88  HIGHEST-PRIORITY       VALUE '9'.
  7633         16  CL-SUPV-ATTN-CD         PIC X.
  7634             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7635             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7636         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 141
* EL050.cbl
  7637         16  CL-RESTORED-DT          PIC XX.
  7638         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7639         16  CL-NEXT-RESEND-DT       PIC XX.
  7640         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7641         16  CL-CRITICAL-PERIOD      PIC 99.
  7642*        16  FILLER                  PIC XX.
  7643         16  CL-LAST-MAINT-DT        PIC XX.
  7644         16  CL-LAST-MAINT-USER      PIC X(4).
  7645         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7646         16  CL-LAST-MAINT-TYPE      PIC X.
  7647             88  CLAIM-SET-UP           VALUE ' '.
  7648             88  PAYMENT-MADE           VALUE '1'.
  7649             88  LETTER-SENT            VALUE '2'.
  7650             88  MASTER-WAS-ALTERED     VALUE '3'.
  7651             88  MASTER-WAS-RESTORED    VALUE '4'.
  7652             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7653             88  FILE-CONVERTED         VALUE '6'.
  7654             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7655             88  ERROR-CORRECTION       VALUE 'E'.
  7656         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7657         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7658         16  CL-BENEFICIARY          PIC X(10).
  7659         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7660         16  CL-DENIAL-TYPE          PIC X.
  7661             88  CL-TYPE-DENIAL          VALUE '1'.
  7662             88  CL-TYPE-RESCISSION      VALUE '2'.
  7663             88  CL-TYPE-REFORMATION     VALUE '3'.
  7664             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7665             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7666         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7667         16  filler                  pic x(3).
  7668*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7669*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7670*        16  CL-RTW-DT               PIC XX.
  7671
  7672     12  CL-TRAILER-CONTROLS.
  7673         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7674             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7675             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7676             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7677         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7678         16  FILLER                  PIC XX.
  7679         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7680         16  CL-ADDRESS-TRAILER-CNT.
  7681             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7682                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7683             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7684                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7685             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7686                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7687             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7688                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7689             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7690                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7691             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7692                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7693             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7694                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 142
* EL050.cbl
  7695
  7696     12  CL-CV-REFERENCE-NO.
  7697         16  CL-CV-REFNO-PRIME       PIC X(18).
  7698         16  CL-CV-REFNO-SFX         PIC XX.
  7699
  7700     12  CL-FILE-LOCATION            PIC X(4).
  7701
  7702     12  CL-PROCESS-ERRORS.
  7703         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7704             88  NO-FATAL-ERRORS        VALUE ZERO.
  7705         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7706             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7707
  7708     12  CL-PRODUCT-CD               PIC X.
  7709
  7710     12  CL-CURRENT-KEY-DATA.
  7711         16  CL-CURRENT-CARRIER      PIC X.
  7712         16  CL-CURRENT-GROUPING     PIC X(6).
  7713         16  CL-CURRENT-STATE        PIC XX.
  7714         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7715
  7716     12  CL-ASSOCIATES               PIC X.
  7717         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7718         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7719         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7720         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7721
  7722     12  CL-ACTIVITY-CODE            PIC 99.
  7723     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7724     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7725
  7726     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7727     12  CL-LAG-REPORT-CODE          PIC 9.
  7728     12  CL-LOAN-TYPE                PIC XX.
  7729     12  CL-LEGAL-STATE              PIC XX.
  7730
  7731     12  CL-YESNOSW                  PIC X.
  7732     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7733         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7734         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7735         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7736     12  cl-insured-type             pic x.
  7737         88  cl-claim-on-primary         value 'P'.
  7738         88  cl-claim-on-co-borrower     value 'C'.
  7739     12  cl-benefit-expiration-dt    PIC XX.
  7740
  7741 01  PLAN-RECORDS.
  7742     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7743     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7744
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 143
* EL050.cbl
  7746 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7747                          ACCOUNT-MASTER REINSURANCE-RECORD
  7748                          COMM-TABLE-RECORD FORM-MASTER
  7749                          CLAIM-MASTER PLAN-RECORDS.
  7750 0000-DFHEXIT SECTION.
  7751     MOVE '9#                    $   ' TO DFHEIV0.
  7752     MOVE 'EL050' TO DFHEIV1.
  7753     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7754
  7755     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7756
  7757
  7758* EXEC CICS  HANDLE CONDITION
  7759*           ERROR    (9300-ABEND)
  7760*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7761*    END-EXEC.
  7762*    MOVE '"$.J                  ! " #00007753' TO DFHEIV0
  7763     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7764     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7765     MOVE X'2220233030303037373533' TO DFHEIV0(25:11)
  7766     CALL 'kxdfhei1' USING DFHEIV0
  7767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7768
  7769
  7770 0000-COPY-PROCEDURE-DIV.
  7771*                          COPY ELC50PD.
  7772******************************************************************
  7773*                                                                *
  7774*                            ELC50PD                             *
  7775*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7776*                            VMOD=2.188                          *
  7777*                                                                *
  7778******************************************************************
  7779*                   C H A N G E   L O G
  7780*
  7781* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7782*-----------------------------------------------------------------
  7783*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7784* EFFECTIVE    NUMBER
  7785*-----------------------------------------------------------------
  7786* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7787* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7788* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7789*                             2709 AND 2718
  7790* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7791* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7792* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7793* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7794* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7795*                                IS OPEN OR CNC DT < PD THRU
  7796* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7797* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7798* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7799* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7800* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7801* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7802* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7803* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 144
* EL050.cbl
  7804* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7805* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7806* 020906                   PEMA  EXPAND LOAN OFFICER
  7807* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7808* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7809* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7810* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7811* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7812* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7813* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7814* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7815* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7816* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7817* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7818* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7819* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7820* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7821* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7822* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7823* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7824* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7825* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7826* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7827* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7828* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7829* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7830* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7831* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7832*                                UPDATE VIN ON CERT TRAILER
  7833* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7834* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7835* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7836* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7837* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7838* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7839* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7840* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7841* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7842* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7843* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7844* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7845* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7846* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7847* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7848* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7849* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7850* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7851* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7852* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7853* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7854* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7855* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7856* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7857* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7858* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7859* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7860* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7861* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 145
* EL050.cbl
  7862* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7863* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7864* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7865* 032912  CR2011110200001  PEMA  AHL CHANGES
  7866* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7867* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7868* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7869* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7870* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7871* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7872* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7873* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7874* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7875* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7876* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7877* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7878* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7879* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7880* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7881* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7882* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7883* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7884* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7885* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7886* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7887* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7888* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7889* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7890* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7891* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7892* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7893*                                CERT #, ADD 2898 FORCIBLE ERROR
  7894* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7895* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7896* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7897* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7898* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7899* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7900* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7901* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7902* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7903* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7904* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7905* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7906* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7907* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7908* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7909* 100617  CR2017062000003  PEMA  New comm cap edits
  7910* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7911******************************************************************
  7912************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7913******************************************************************
  7914
  7915     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7916
  7917     MOVE SPACES                 TO PB-FATAL-FLAG
  7918                                    PB-FORCE-ER-CD
  7919                                    PB-WARN-ER-CD
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 146
* EL050.cbl
  7920                                    PB-OUT-BAL-CD.
  7921
  7922     MOVE SPACE                  TO WS-IG-OVRD-AH
  7923                                    WS-IG-OVRD-LF
  7924                                    WS-IG-OVRD-AM
  7925                                    WS-IG-OVRD
  7926                                    WS-IG-OVRD-AH-PL
  7927                                    WS-IG-OVRD-LF-PL
  7928                                    WS-IG-OVRD-AH-BEN
  7929                                    WS-IG-OVRD-LF-BEN.
  7930
  7931******************************************************************
  7932*************       INITIALIZE COMMON ERRORS       ***************
  7933******************************************************************
  7934
  7935     MOVE +0                     TO PB-NO-OF-ERRORS.
  7936     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7937
  7938******************************************************************
  7939
  7940     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7941     SET JULIAN-TO-BIN           TO TRUE.
  7942*    MOVE 5                      TO DC-OPTION-CODE.
  7943     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7944     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7945
  7946     MOVE ZERO                   TO  SUB4.
  7947
  7948 0040-INITIALIZE-GA-BILL-DT.
  7949
  7950     ADD +1                      TO  SUB4.
  7951
  7952     IF  SUB4 GREATER THAN +5
  7953         GO TO 0050-CHECK-CNTL-FOUND.
  7954
  7955     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7956         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7957
  7958     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7959
  7960 0050-CHECK-CNTL-FOUND.
  7961
  7962     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7963        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7964                                         WS-AH-REM-TERM-CALC
  7965                                         EC-CO-REM-TERM-CALC
  7966        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7967        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7968        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7969                                         WS-TOL-AH-CLAIM
  7970        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7971                                         WS-TOL-AH-PREM
  7972                                         EC-CO-TOL-PREM
  7973        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7974                                         WS-TOL-AH-REFUND
  7975                                         EC-CO-TOL-REFUND
  7976        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7977                                         WS-AH-REFUND-OVS-AMT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 147
* EL050.cbl
  7978                                         EC-CO-OVR-SHT-AMT
  7979        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7980                                         WS-TOL-AH-PREM-PCT
  7981                                         EC-CO-TOL-PREM-PCT
  7982        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7983                                         WS-TOL-AH-REFUND-PCT
  7984                                         EC-CO-TOL-REFUND-PCT
  7985        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7986                                         WS-AH-REFUND-OVS-PCT
  7987                                         EC-CO-OVR-SHT-PCT
  7988        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7989        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7990        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7991        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7992        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7993        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7994        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7995        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7996        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7997        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7998        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7999        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8000                                         EC-CO-MONTH-END-DT
  8001        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8002          GO TO 0100-READ-ACCT.
  8003
  8004     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8005     MOVE SPACES                 TO CNTL-ACCESS.
  8006     MOVE '1'                    TO CNTL-REC-TYPE.
  8007     MOVE +0                     TO CNTL-SEQ-NO.
  8008
  8009     MOVE '1' TO RC-SW-1.
  8010     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8011     IF NOT CF-COMPANY-MASTER
  8012         MOVE ZEROS             TO WK-CO-TOL-PREM
  8013                                   WK-CO-TOL-CLAIM
  8014                                   WK-CO-TOL-REFUND
  8015                                   WK-REFUND-OVS-AMT
  8016                                   WK-REFUND-OVS-PCT
  8017                                   WK-CO-TOL-PREM-PCT
  8018                                   WK-CO-TOL-REFUND-PCT
  8019                                   WK-DEFAULT-APR
  8020                                   WK-CO-MAX-CAP
  8021        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8022                                   WK-CR-R78-METHOD
  8023                                   WK-CO-REF-REJECT-SW
  8024                                   WK-CO-PREM-REJECT-SW
  8025                                   WK-REM-TRM-CALC-OPTION
  8026                                   WK-BIRTH-DATE-INPUT
  8027                                   WK-JOINT-AGE-INPUT
  8028        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8029        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8030        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8031        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8032          GO TO 0099-COMPANY-NOT-FOUND.
  8033
  8034     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8035        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 148
* EL050.cbl
  8036     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8037        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8038     IF CF-CO-TOL-CAP NOT NUMERIC
  8039        MOVE +0                    TO CF-CO-TOL-CAP.
  8040     IF CF-DEFAULT-APR NOT NUMERIC
  8041        MOVE +0                    TO CF-DEFAULT-APR.
  8042
  8043     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8044     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8045     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8046     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8047     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8048     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8049     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8050     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8051     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8052     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8053     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8054     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8055
  8056     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8057          CF-CO-OVR-SHT-AMT > +0
  8058        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8059
  8060     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8061          CF-CO-OVR-SHT-PCT > +0
  8062        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8063
  8064     IF CF-VALID-REM-TRM-OPTION
  8065         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8066     ELSE
  8067         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8068
  8069     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8070     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8071     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8072     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8073
  8074     GO TO 0050-CHECK-CNTL-FOUND.
  8075
  8076 0099-COMPANY-NOT-FOUND.
  8077
  8078     MOVE ER-2616                TO WS-ERROR.
  8079     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8080
  8081 0100-READ-ACCT.
  8082
  8083     MOVE SPACES                 TO DATE-RANGE-SW.
  8084
  8085     IF WK-ACCT-ADDR = ZEROS
  8086        GO TO 0102-ACCT-GETMAIN.
  8087
  8088     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8089     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8090     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8091
  8092     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8093        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 149
* EL050.cbl
  8094        GO TO 0105-READ-ACCT
  8095     END-IF
  8096
  8097     IF PB-CARRIER NOT = SPACES
  8098        IF PB-CARRIER NOT = AM-VG-CARRIER
  8099           GO TO 0105-READ-ACCT.
  8100
  8101     IF PB-STATE NOT = SPACES
  8102        IF PB-STATE NOT = AM-VG-STATE
  8103           GO TO 0105-READ-ACCT.
  8104
  8105     IF PB-GROUPING NOT = SPACES
  8106        IF PB-GROUPING NOT = AM-VG-GROUPING
  8107           GO TO 0105-READ-ACCT.
  8108
  8109     MOVE 'X'                 TO DATE-RANGE-SW.
  8110
  8111     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8112        MOVE 'X'                 TO DATE-RANGE-SW
  8113        GO TO 0105-READ-ACCT.
  8114
  8115     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8116        GO TO 0105-READ-ACCT.
  8117
  8118     GO TO 0180-ACCOUNT-FOUND.
  8119
  8120 0102-ACCT-GETMAIN.
  8121     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8122     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8123
  8124 0105-READ-ACCT.
  8125     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8126     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8127     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8128     MOVE PB-STATE               TO ACCT-STATE.
  8129     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8130     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8131
  8132     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8133
  8134     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8135
  8136 0110-FIND-ACCT-TOLERANCES-LOOP.
  8137     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8138
  8139     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8140        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8141        GO TO 0199-ACCT-NOT-FOUND
  8142     END-IF
  8143     IF PB-CARRIER NOT = SPACES
  8144        IF PB-CARRIER NOT = AM-VG-CARRIER
  8145           GO TO 0199-ACCT-NOT-FOUND.
  8146
  8147     IF PB-STATE NOT = SPACES
  8148        IF PB-STATE NOT = AM-VG-STATE
  8149           GO TO 0199-ACCT-NOT-FOUND.
  8150
  8151     IF PB-GROUPING NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 150
* EL050.cbl
  8152        IF PB-GROUPING NOT = AM-VG-GROUPING
  8153           GO TO 0199-ACCT-NOT-FOUND.
  8154
  8155     MOVE 'X'                    TO DATE-RANGE-SW.
  8156
  8157     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8158        MOVE 'X'                 TO DATE-RANGE-SW
  8159        GO TO 0199-ACCT-NOT-FOUND.
  8160
  8161     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8162        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8163
  8164 0180-ACCOUNT-FOUND.
  8165     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8166     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8167     MOVE AM-STATE               TO PB-SV-STATE.
  8168     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8169
  8170     IF AM-CANCEL-FEE  NOT NUMERIC
  8171        MOVE ZEROS TO AM-CANCEL-FEE.
  8172
  8173     IF AM-MAX-MON-BEN NOT NUMERIC
  8174        MOVE ZEROS TO AM-MAX-MON-BEN.
  8175
  8176     IF AM-MAX-TOT-BEN NOT NUMERIC
  8177        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8178
  8179     IF AM-CLP-TOL-PCT NOT NUMERIC
  8180        MOVE +0                  TO AM-CLP-TOL-PCT
  8181     END-IF
  8182     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8183        MOVE +0                  TO AM-SPP-LEASE-COMM
  8184     END-IF
  8185     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8186        MOVE ER-2611             TO   WS-ERROR
  8187        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8188
  8189     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8190        MOVE ER-2621             TO   WS-ERROR
  8191        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8192
  8193     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8194        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8195        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8196        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8197         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8198
  8199     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8200     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8201     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8202     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8203     IF AM-CLP-TOL-PCT NOT = ZEROS
  8204        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8205     END-IF
  8206     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8207        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8208     END-IF
  8209*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 151
* EL050.cbl
  8210*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8211*                                   WS-ADMIN-FEES
  8212*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8213*          (SUB5 > +10)
  8214*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8215*             AND (AM-A-COM (SUB5) NUMERIC)
  8216*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8217*                + (AM-A-COM (SUB5) * 1000)
  8218*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8219*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8220*                + (AM-A-COM (SUB5) * 1000)
  8221*             END-IF
  8222*             IF AM-COM-TYP (SUB5) = 'N'
  8223*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8224*                + (AM-A-COM (SUB5) * 1000)
  8225*             END-IF
  8226*          END-IF
  8227*       END-PERFORM
  8228*    END-IF
  8229     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8230        AND (PB-ISSUE)
  8231        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8232                                    ws-cred-union-fees
  8233        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8234           (SUB5 > +10)
  8235           MOVE +0 TO WS-WK-RATE
  8236           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8237                                   'O' OR 'S')
  8238              IF (AM-A-COM (SUB5) NUMERIC)
  8239                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8240                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8241              ELSE
  8242                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8243                 IF PB-ISSUE
  8244                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8245                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8246                 ELSE
  8247                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8248                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8249                 END-IF
  8250                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8251                 MOVE ZEROS             TO WS-SUB1
  8252                                           WS-COMMISSION
  8253                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8254                 MOVE '0530'               TO CTBL-SW
  8255                 MOVE ' '                  TO WS-CTBL-READ-SW
  8256                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8257                 IF FIRST-TIME-THROUGH
  8258                    MOVE 'AA'              TO CTBL-BEN-CODE
  8259                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8260                 END-IF
  8261                 IF CTBL-TABLE-FOUND
  8262                    IF PB-ISSUE
  8263                       COMPUTE WS-COMM-CK-AMT =
  8264                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8265                    ELSE
  8266                       COMPUTE WS-COMM-CK-AMT =
  8267                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 152
* EL050.cbl
  8268                    END-IF
  8269                    PERFORM 8800-GET-COMP-RATE
  8270                              THRU 8800-EXIT
  8271                 END-IF
  8272              END-IF
  8273              if am-com-typ (sub5) = 'O' or 'S'
  8274                 compute ws-cred-union-fees rounded =
  8275                    ws-cred-union-fees +
  8276                    (pb-i-ah-premium-amt * ws-wk-rate)
  8277              else
  8278                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8279                + (WS-WK-RATE * 1000)
  8280              end-if
  8281           END-IF
  8282        END-PERFORM
  8283     END-IF
  8284     IF PB-COMPANY-ID EQUAL 'CRI'
  8285         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8286
  8287     IF PB-COMPANY-ID EQUAL 'NCL'
  8288         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8289     END-IF
  8290
  8291     GO TO 0200-READ-CERT.
  8292
  8293 0199-ACCT-NOT-FOUND.
  8294
  8295     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8296
  8297     IF DATE-RANGE-SW NOT = SPACES
  8298        MOVE ER-2601             TO WS-ERROR
  8299        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8300     ELSE
  8301        MOVE ER-2619             TO WS-ERROR
  8302        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8303
  8304     GO TO 9990-RETURN.
  8305
  8306 0200-READ-CERT.
  8307
  8308     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8309     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8310     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8311     MOVE PB-SV-STATE            TO CERT-STATE.
  8312     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8313     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8314     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8315
  8316     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8317
  8318     IF CERT-WAS-NOT-FOUND
  8319        GO TO 0299-CERT-NOT-FOUND.
  8320
  8321     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8322        MOVE ER-2759             TO WS-ERROR
  8323        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8324        GO TO 0298-UNLOCK-RETURN.
  8325
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 153
* EL050.cbl
  8326     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8327         MOVE ER-2758            TO WS-ERROR
  8328         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8329         GO TO 0298-UNLOCK-RETURN.
  8330
  8331     IF PB-ISSUE
  8332        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8333           IF CERT-WAS-CREATED-FOR-CLAIM
  8334              NEXT SENTENCE
  8335            ELSE
  8336              MOVE ER-2626       TO WS-ERROR
  8337              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8338              GO TO 0298-UNLOCK-RETURN.
  8339
  8340     IF NOT PB-CANCELLATION
  8341        GO TO 0300-CONTINUE-EDIT.
  8342
  8343     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8344     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8345     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8346     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8347     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8348     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8349
  8350     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8351     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8352     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8353     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8354     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8355     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8356     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8357     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8358     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8359
  8360     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8361     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8362     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8363     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8364     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8365     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8366     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8367
  8368     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8369     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8370
  8371     MOVE CM-CREDIT-INTERFACE-SW-1
  8372                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8373     MOVE CM-CREDIT-INTERFACE-SW-2
  8374                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8375
  8376     IF CM-O-B-COVERAGE
  8377         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8378
  8379     IF CM-LIVES NOT NUMERIC
  8380         MOVE ZERO                TO CM-LIVES.
  8381
  8382     IF CM-BILLED NOT NUMERIC
  8383         MOVE ZERO                TO CM-BILLED.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 154
* EL050.cbl
  8384
  8385     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8386         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8387         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8388         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8389         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8390         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8391         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8392         MOVE CM-LIVES             TO PB-CI-LIVES
  8393*The next line causes a problem with my change  I dont think it is
  8394*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8395
  8396     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8397     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8398     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8399     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8400     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8401     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8402
  8403     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8404     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8405     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8406     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8407
  8408     IF CM-LIFE-COMM-PCT NUMERIC
  8409         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8410     ELSE
  8411         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8412
  8413     IF CM-AH-COMM-PCT NUMERIC
  8414         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8415     ELSE
  8416         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8417
  8418     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8419
  8420     IF CM-LOAN-APR       NOT NUMERIC
  8421           MOVE ZERO               TO CM-LOAN-APR.
  8422
  8423     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8424           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8425
  8426     IF CM-LOAN-TERM      NOT NUMERIC
  8427           MOVE ZERO               TO CM-LOAN-TERM.
  8428
  8429     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8430           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8431
  8432     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8433           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8434
  8435     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8436     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8437     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8438     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8439     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8440     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8441     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 155
* EL050.cbl
  8442     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8443     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8444     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8445     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8446     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8447
  8448     IF CM-STATE = CM-SSN-STATE
  8449         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8450
  8451     IF CM-STATE NOT = CM-MEMB-STATE
  8452         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8453
  8454     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8455
  8456     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8457        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8458        IF CM-ADDL-CLP NOT NUMERIC
  8459           MOVE +0               TO CM-ADDL-CLP
  8460        END-IF
  8461        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8462        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8463           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8464        END-IF
  8465     END-IF
  8466     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8467        MOVE +0                  TO WS-ADMIN-FEES
  8468                                    WS-CSO-ADMIN-FEE
  8469                                    WS-COMM-AND-MFEE
  8470                                    WS-1ST-YR-ALLOW
  8471        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8472           (SUB5 > +10)
  8473           MOVE +0 TO WS-WK-RATE
  8474           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8475              IF (AM-A-COM (SUB5) NUMERIC)
  8476                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8477                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8478              ELSE
  8479                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8480                 IF PB-ISSUE
  8481                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8482                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8483                 ELSE
  8484                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8485                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8486                 END-IF
  8487                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8488                 MOVE ZEROS             TO WS-SUB1
  8489                                           WS-COMMISSION
  8490                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8491                 MOVE '0530'               TO CTBL-SW
  8492                 MOVE ' '                  TO WS-CTBL-READ-SW
  8493                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8494                 IF FIRST-TIME-THROUGH
  8495                    MOVE 'AA'              TO CTBL-BEN-CODE
  8496                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8497                 END-IF
  8498                 IF CTBL-TABLE-FOUND
  8499                    IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 156
* EL050.cbl
  8500                       COMPUTE WS-COMM-CK-AMT =
  8501                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8502                    ELSE
  8503                       COMPUTE WS-COMM-CK-AMT =
  8504                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8505                    END-IF
  8506                    PERFORM 8800-GET-COMP-RATE
  8507                              THRU 8800-EXIT
  8508                 END-IF
  8509              END-IF
  8510              IF AM-COM-TYP (SUB5) = 'I'
  8511                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8512                   + (WS-WK-RATE * 1000)
  8513              END-IF
  8514              IF AM-COM-TYP (SUB5) = 'N'
  8515                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8516                   + (WS-WK-RATE * 1000)
  8517              END-IF
  8518              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8519                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8520                   + (WS-WK-RATE * 1000)
  8521              END-IF
  8522              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8523                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8524                   + (WS-WK-RATE * 1000)
  8525              END-IF
  8526           END-IF
  8527        END-PERFORM
  8528     END-IF
  8529     GO TO 0300-CONTINUE-EDIT.
  8530
  8531 0298-UNLOCK-RETURN.
  8532      PERFORM 9250-UNLOCK-RETURN
  8533      GO TO 9990-RETURN.
  8534
  8535 0299-CERT-NOT-FOUND.
  8536
  8537     MOVE '1'                     TO CERT-STATUS-SW.
  8538
  8539     IF PB-COMPANY-ID = 'UCL'
  8540         IF WS-ERROR = ER-2799
  8541             GO TO 3000-CONTINUE-EDIT.
  8542
  8543     IF NOT PB-CANCELLATION
  8544         GO TO 0300-CONTINUE-EDIT.
  8545
  8546     MOVE ER-2726                  TO  WS-ERROR.
  8547     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8548     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8549     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8550                                    PB-CI-LF-TERM
  8551                                    PB-C-LF-REM-TERM
  8552                                    PB-CI-AH-TERM
  8553                                    PB-C-AH-REM-TERM
  8554                                    PB-CI-LF-BENEFIT-CD
  8555                                    PB-CI-LF-BENEFIT-AMT
  8556                                    PB-CI-LF-ALT-BENEFIT-AMT
  8557                                    PB-CI-LF-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 157
* EL050.cbl
  8558                                    PB-CI-LF-ALT-PREMIUM-AMT
  8559                                    PB-CI-AH-BENEFIT-CD
  8560                                    PB-CI-AH-BENEFIT-AMT
  8561                                    PB-CI-AH-PREMIUM-AMT
  8562                                    PB-CI-PAY-FREQUENCY
  8563                                    PB-CI-LOAN-APR
  8564                                    PB-CI-LOAN-TERM
  8565                                    PB-CI-LIFE-COMMISSION
  8566                                    PB-CI-AH-COMMISSION
  8567                                    PB-CI-CURR-SEQ
  8568                                    PB-CI-AH-CANCEL-AMT
  8569                                    PB-CI-LF-CANCEL-AMT
  8570                                    PB-CI-RATE-DEV-PCT-LF
  8571                                    PB-CI-RATE-DEV-PCT-AH
  8572                                    PB-CI-EXTENTION-DAYS
  8573                                    PB-CI-TERM-IN-DAYS
  8574                                    PB-CI-LIVES
  8575                                    PB-CI-LF-CRIT-PER
  8576                                    PB-CI-AH-CRIT-PER
  8577                                    PB-CI-ADDL-CLP
  8578                                    PB-CI-DDF-IU-RATE-UP.
  8579
  8580     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8581                                    PB-CI-AH-SETTLEMENT-DT
  8582                                    PB-CI-DEATH-DT
  8583                                    PB-CI-LF-PRIOR-CANCEL-DT
  8584                                    PB-CI-AH-PRIOR-CANCEL-DT
  8585                                    PB-CI-ENTRY-DT
  8586                                    PB-CI-LF-EXPIRE-DT
  8587                                    PB-CI-AH-EXPIRE-DT
  8588                                    PB-CI-LOAN-1ST-PMT-DT.
  8589
  8590     IF ACCOUNT-MAST-FOUND
  8591        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8592        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8593
  8594
  8595 0300-CONTINUE-EDIT.
  8596
  8597     IF PB-ISSUE
  8598        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8599            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8600
  8601     IF PB-ISSUE
  8602        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8603            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8604
  8605     IF PB-ISSUE
  8606       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8607          (AM-NO-AH-ONLY)
  8608           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8609               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8610                   MOVE ER-2679 TO WS-ERROR
  8611                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8612
  8613     IF PB-ISSUE
  8614        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8615        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 158
* EL050.cbl
  8616        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8617     ELSE
  8618        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8619        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8620        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8621
  8622     MOVE 'N'                    TO PLAN-MASTER-SW
  8623                                    PLAN-MASTER-LIFE-SW
  8624                                    FORM-MASTER-SW
  8625                                    WS-APP-CERT-SW.
  8626
  8627     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8628                                    WS-PL-TOL-LF-REFUND
  8629                                    WS-PL-REF-OVS-AMT
  8630                                    WS-PL-TOL-LF-PREM-PCT
  8631                                    WS-PL-TOL-LF-REFUND-PCT
  8632                                    WS-PL-REF-OVS-PCT
  8633                                    WS-PL-TOL-LF-CLAIM.
  8634
  8635     IF PB-COMPANY-ID = 'NCL'
  8636       IF PB-ISSUE
  8637         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8638             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8639             IF FORM-MASTER-FOUND
  8640                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8641
  8642     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8643        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8644
  8645********************** MON CODE **********************
  8646     IF PB-COMPANY-ID = 'MON'
  8647     IF PB-ISSUE
  8648     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8649        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8650             PB-I-LOAN-APR = ZERO)
  8651               MOVE 14.0         TO PB-I-LOAN-APR.
  8652******************************************************
  8653
  8654     IF PB-COMPANY-ID = 'NCL'
  8655       IF PB-ISSUE
  8656           IF FORM-MASTER-FOUND
  8657             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8658                AM-DISMBR-COVERAGE
  8659                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8660                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8661                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8662                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8663                                           PB-I-LIFE-BENEFIT-CD.
  8664
  8665     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8666
  8667     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8668         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8669         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8670         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8671         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8672         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8673           AND NOT LESS THAN CF-BENEFIT-CODE (1)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 159
* EL050.cbl
  8674             GO TO 0301-LIFE-BENEFIT-SEARCH
  8675         ELSE
  8676             NEXT SENTENCE
  8677     ELSE
  8678         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8679
  8680     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8681     MOVE '4'                    TO CNTL-REC-TYPE.
  8682     MOVE +0                     TO CNTL-SEQ-NO.
  8683     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8684
  8685     MOVE '1' TO RC-SW-2.
  8686     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8687
  8688     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8689        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8690         GO TO 0305-BENEFIT-NOT-FOUND.
  8691
  8692     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8693
  8694 0301-LIFE-BENEFIT-SEARCH.
  8695
  8696     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8697
  8698     IF NO-BENEFIT-FOUND
  8699        GO TO 0305-BENEFIT-NOT-FOUND.
  8700
  8701     IF WS-BEN-CD = '99'
  8702        GO TO 0305-BENEFIT-NOT-FOUND.
  8703
  8704     IF PB-COMPANY-ID = 'NCL'
  8705         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8706             GO TO 0304-LIFE-BENEFIT-FOUND.
  8707
  8708     MOVE +1                     TO SUB5.
  8709     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8710
  8711* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8712* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8713     IF PB-COMPANY-ID = 'DMD'
  8714         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8715
  8716 0302-EDIT-ACCT-LF-BENEFITS.
  8717
  8718     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8719        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8720           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8721                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8722           GO TO 03XX-GET-LIFE-ERPLAN.
  8723
  8724     IF SUB5 LESS THAN +20
  8725        ADD +1                   TO SUB5
  8726        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8727
  8728     MOVE +1                     TO SUB5.
  8729
  8730     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8731        GO TO 03XX-EDIT-FOR-NINETY-LF.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 160
* EL050.cbl
  8732
  8733 0303-EDIT-DMD-EXTRA-BENEFITS.
  8734
  8735     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8736        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8737           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8738                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8739           GO TO 03XX-GET-LIFE-ERPLAN.
  8740
  8741     IF SUB5 LESS THAN +30
  8742        ADD +1                   TO SUB5
  8743        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8744
  8745     MOVE +1                     TO SUB5.
  8746
  8747 03XX-EDIT-FOR-NINETY-LF.
  8748
  8749***************************************************************
  8750*                                                             *
  8751*    NINETY BENEFIT PLAN TYPES:                               *
  8752*                                                             *
  8753*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8754*      92 = ALL GROUP REDUCING BENEFITS                       *
  8755*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8756*      94 = ALL GROUP LEVEL BENEFITS                          *
  8757*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8758*           BENEFIT CONTROLS.                                 *
  8759*      99 = ALL BENEFITS                                      *
  8760*                                                             *
  8761***************************************************************
  8762
  8763     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8764                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8765
  8766     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8767       AND
  8768        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8769        GO TO 03XX-GET-LIFE-ERPLAN.
  8770
  8771     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8772       AND
  8773        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8774        IF CF-REDUCING (SUB3)
  8775           IF (PB-I-INDV-GRP-OVRD = 'I')
  8776              OR
  8777           ((AM-IG = '1') AND
  8778           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8779              OR
  8780           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8781           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8782           (AM-IG NOT = '2'))
  8783              GO TO 03XX-GET-LIFE-ERPLAN.
  8784
  8785     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8786       AND
  8787        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8788        IF CF-REDUCING (SUB3)
  8789           IF (PB-I-INDV-GRP-OVRD = 'G')
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 161
* EL050.cbl
  8790              OR
  8791           ((AM-IG = '2') AND
  8792           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8793              OR
  8794           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8795           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8796           (AM-IG NOT = '1'))
  8797              GO TO 03XX-GET-LIFE-ERPLAN.
  8798
  8799     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8800       AND
  8801        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8802        IF CF-LEVEL    (SUB3)
  8803           IF (PB-I-INDV-GRP-OVRD = 'I')
  8804              OR
  8805           ((AM-IG = '1') AND
  8806           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8807              OR
  8808           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8809           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8810            (AM-IG NOT = '2'))
  8811              GO TO 03XX-GET-LIFE-ERPLAN.
  8812
  8813     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8814       AND
  8815        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8816        IF CF-LEVEL    (SUB3)
  8817           IF (PB-I-INDV-GRP-OVRD = 'G')
  8818              OR
  8819           ((AM-IG = '2') AND
  8820           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8821              OR
  8822           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8823           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8824           (AM-IG NOT = '1'))
  8825              GO TO 03XX-GET-LIFE-ERPLAN.
  8826
  8827     IF SUB5 LESS THAN +20
  8828        ADD +1                   TO SUB5
  8829        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8830
  8831     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8832
  8833     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8834        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8835
  8836     MOVE +1                     TO SUB5.
  8837
  8838 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8839
  8840     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8841                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8842
  8843     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8844       AND
  8845        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8846        GO TO 03XX-GET-LIFE-ERPLAN.
  8847
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 162
* EL050.cbl
  8848     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8849       AND
  8850        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8851        IF CF-REDUCING (SUB3)
  8852           IF (PB-I-INDV-GRP-OVRD = 'I')
  8853              OR
  8854           ((AM-IG = '1') AND
  8855           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8856              OR
  8857           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8858           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8859           (AM-IG NOT = '2'))
  8860              GO TO 03XX-GET-LIFE-ERPLAN.
  8861
  8862     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8863       AND
  8864        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8865        IF CF-REDUCING (SUB3)
  8866           IF (PB-I-INDV-GRP-OVRD = 'G')
  8867              OR
  8868           ((AM-IG = '2') AND
  8869           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8870              OR
  8871           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8872           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8873           (AM-IG NOT = '1'))
  8874              GO TO 03XX-GET-LIFE-ERPLAN.
  8875
  8876     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8877       AND
  8878        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8879        IF CF-LEVEL    (SUB3)
  8880           IF (PB-I-INDV-GRP-OVRD = 'I')
  8881              OR
  8882           ((AM-IG = '1') AND
  8883           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8884              OR
  8885           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8886           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8887            (AM-IG NOT = '2'))
  8888              GO TO 03XX-GET-LIFE-ERPLAN.
  8889
  8890     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8891       AND
  8892        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8893        IF CF-LEVEL    (SUB3)
  8894           IF (PB-I-INDV-GRP-OVRD = 'G')
  8895              OR
  8896           ((AM-IG = '2') AND
  8897           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8898              OR
  8899           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8900           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8901           (AM-IG NOT = '1'))
  8902              GO TO 03XX-GET-LIFE-ERPLAN.
  8903
  8904     IF SUB5 LESS THAN +30
  8905        ADD +1                   TO SUB5
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 163
* EL050.cbl
  8906        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8907
  8908     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8909
  8910 03XX-EDIT-FOR-NINETY-LF-CONT.
  8911
  8912     MOVE +99                    TO SUB5.
  8913
  8914     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8915        IF PB-ISSUE
  8916           MOVE ER-1924          TO  WS-ERROR
  8917           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8918
  8919     GO TO 0304-LIFE-BENEFIT-FOUND.
  8920
  8921 03XX-GET-LIFE-ERPLAN.
  8922
  8923     IF WK-PLAN-ADDR EQUAL +0
  8924        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8925
  8926     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8927     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8928     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8929     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8930     MOVE 'Y'                    TO PLAN-MASTER-SW
  8931                                    PLAN-MASTER-LIFE-SW.
  8932     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8933
  8934 03XX-ERPLAN-LIFE-GETMAIN.
  8935
  8936     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8937     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8938
  8939 03XX-ERPLAN-LIFE-READ.
  8940
  8941     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8942     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8943     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8944     MOVE PB-SV-STATE            TO PLAN-STATE.
  8945     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8946     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8947     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8948     MOVE WS-SAVE-BENEFIT-REVISION
  8949                                 TO PLAN-REVISION-NO.
  8950
  8951     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8952     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8953
  8954     IF PB-COMPANY-ID = 'NCL'
  8955       IF NOT LF-PLAN-MASTER-FOUND
  8956         IF NOT PB-POLICY-IS-DECLINED  AND
  8957            NOT PB-POLICY-IS-VOIDED
  8958             MOVE  ER-1921         TO  WS-ERROR
  8959             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8960             GO TO 0304-LIFE-BENEFIT-FOUND.
  8961
  8962     IF NOT LF-PLAN-MASTER-FOUND
  8963        GO TO 0304-LIFE-BENEFIT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 164
* EL050.cbl
  8964
  8965 XXXX-CHECK-LF-PLAN-KEY.
  8966
  8967     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8968        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8969        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8970        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8971        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8972        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8973        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8974        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8975        MOVE 'N'                 TO PLAN-MASTER-SW
  8976          GO TO 03XX-ERPLAN-LIFE-READ.
  8977
  8978     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8979
  8980     IF  PB-CANCELLATION
  8981         GO TO  0303-LF-ACCT-BEN-FOUND.
  8982
  8983     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8984        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8985           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8986           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8987              MOVE ER-2644             TO WS-ERROR
  8988              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8989           ELSE
  8990              NEXT SENTENCE
  8991        ELSE
  8992           IF PB-COMPANY-ID NOT = 'NCL'
  8993              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8994                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8995
  8996 0303-LF-ACCT-BEN-FOUND.
  8997
  8998     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8999
  9000     IF PL-DEV-CODE NOT = SPACES
  9001        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9002
  9003     IF PL-DEV-PCT NUMERIC AND
  9004        PL-DEV-PCT NOT = ZEROS
  9005        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9006
  9007     IF PL-TOL-PREM-AMT GREATER THAN +0
  9008        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9009
  9010     IF PL-TOL-REF-AMT GREATER THAN +0
  9011        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9012
  9013     IF PL-TOL-PREM-PCT GREATER THAN +0
  9014        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9015
  9016     IF PL-TOL-REF-PCT GREATER THAN +0
  9017        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9018
  9019     IF PL-TOL-CLM-AMT GREATER THAN +0
  9020        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9021
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 165
* EL050.cbl
  9022     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9023                          PL-OVER-SHORT-AMT > +0
  9024        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9025
  9026     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9027                          PL-OVER-SHORT-PCT > +0
  9028        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9029
  9030     IF PL-SALES-TAX NUMERIC AND
  9031                          PL-SALES-TAX > +0
  9032         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9033
  9034     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9035        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9036                                    WS-IG-OVRD-AM.
  9037
  9038 0304-LIFE-BENEFIT-FOUND.
  9039
  9040     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9041
  9042     IF PB-ISSUE
  9043        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9044     ELSE
  9045        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9046
  9047     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9048     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9049     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9050     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9051     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9052                                         WS-LF-REFUND-CALC.
  9053     if (ws-lf-earnings-calc = '5')
  9054        and (pb-i-loan-apr = zeros)
  9055        and (benefit-code-chg)
  9056        move +99.9999 to pb-i-loan-apr
  9057     end-if
  9058
  9059     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9060        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9061
  9062     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9063        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9064     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9065
  9066     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9067     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9068     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9069     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9070     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9071     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9072
  9073     IF PB-COMPANY-ID = 'NCL'  AND
  9074        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9075         NEXT SENTENCE
  9076     ELSE
  9077         IF SUB5 NOT GREATER THAN +20
  9078            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9079               MOVE WS-SAVE-BENEFIT-REM-TERM
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 166
* EL050.cbl
  9080                                      TO WS-AM-LF-BENE-REM-TERM
  9081                                         EC-BR-LF-REM-TERM-CALC.
  9082
  9083     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9084     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9085
  9086     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9087
  9088 0305-BENEFIT-NOT-FOUND.
  9089
  9090     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9091     MOVE ER-2604                TO WS-ERROR.
  9092     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9093
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 167
* EL050.cbl
  9095
  9096 0310-FIND-AH-BENEFIT-RECORD.
  9097
  9098     MOVE 'N'                    TO PLAN-MASTER-SW
  9099                                    PLAN-MASTER-AH-SW.
  9100
  9101     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9102                                    WS-PL-TOL-AH-REFUND
  9103                                    WS-AH-PL-REF-OVS-AMT
  9104                                    WS-PL-TOL-AH-PREM-PCT
  9105                                    WS-PL-TOL-AH-REFUND-PCT
  9106                                    WS-AH-PL-REF-OVS-PCT
  9107                                    WS-PL-TOL-AH-CLAIM.
  9108     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9109
  9110
  9111     if pb-issue
  9112        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9113           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9114        end-if
  9115        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9116           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9117           GO TO 0399-BENEFIT-NOT-FOUND
  9118        end-if
  9119     end-if
  9120
  9121     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9122        GO TO 0400-FIND-CARRIER.
  9123
  9124     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9125
  9126     IF WK-AH-BEN-ADDR NOT = ZEROS
  9127         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9128         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9129         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9130         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9131           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9132             GO TO 0311-AH-BENEFIT-SEARCH
  9133         ELSE
  9134             NEXT SENTENCE
  9135     ELSE
  9136         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9137
  9138     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9139     MOVE '5'                    TO CNTL-REC-TYPE.
  9140     MOVE +0                     TO CNTL-SEQ-NO.
  9141     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9142
  9143     MOVE '2' TO RC-SW-2.
  9144     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9145
  9146     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9147        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9148          GO TO 0399-BENEFIT-NOT-FOUND.
  9149
  9150     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9151
  9152 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 168
* EL050.cbl
  9153
  9154     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9155
  9156     IF NO-BENEFIT-FOUND
  9157         GO TO 0399-BENEFIT-NOT-FOUND.
  9158
  9159     IF WS-BEN-CD = '99'
  9160        GO TO 0399-BENEFIT-NOT-FOUND.
  9161
  9162     IF PB-COMPANY-ID  =  'NCL'
  9163         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9164             GO TO 0314-A-H-BENEFIT-FOUND.
  9165
  9166     MOVE +1                     TO SUB5.
  9167     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9168
  9169* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9170* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9171     IF PB-COMPANY-ID = 'DMD'
  9172         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9173
  9174 0312-EDIT-ACCT-AH-BENEFITS.
  9175
  9176     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9177        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9178           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9179                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9180           GO TO 03XX-GET-AH-ERPLAN.
  9181
  9182     IF SUB5 LESS THAN +20
  9183        ADD +1                   TO SUB5
  9184        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9185
  9186     MOVE +1                     TO SUB5.
  9187
  9188     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9189        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9190
  9191 0313-EDIT-DMD-EXTRA-BENEFITS.
  9192
  9193     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9194        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9195           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9196                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9197           GO TO 03XX-GET-AH-ERPLAN.
  9198
  9199     IF SUB5 LESS THAN +30
  9200        ADD +1                   TO SUB5
  9201        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9202
  9203     MOVE +1                     TO SUB5.
  9204
  9205 03XX-EDIT-FOR-NINETY-AH.
  9206
  9207***************************************************************
  9208*                                                             *
  9209*    NINETY BENEFIT PLAN TYPES:                               *
  9210*                                                             *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 169
* EL050.cbl
  9211*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9212*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9213*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9214*           BENEFIT CONTROLS.                                 *
  9215*      99 = ALL BENEFITS.                                     *
  9216*                                                             *
  9217***************************************************************
  9218
  9219     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9220                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9221
  9222     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9223       AND
  9224        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9225        GO TO 03XX-GET-AH-ERPLAN.
  9226
  9227     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9228       AND
  9229        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9230           IF (PB-I-INDV-GRP-OVRD = 'I')
  9231              OR
  9232           ((AM-IG = '1') AND
  9233           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9234              OR
  9235           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9236           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9237           (AM-IG NOT = '2'))
  9238              GO TO 03XX-GET-AH-ERPLAN.
  9239
  9240     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9241       AND
  9242        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9243           IF (PB-I-INDV-GRP-OVRD = 'G')
  9244              OR
  9245           ((AM-IG = '2') AND
  9246           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9247              OR
  9248           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9249           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9250           (AM-IG NOT = '1'))
  9251              GO TO 03XX-GET-AH-ERPLAN.
  9252
  9253     IF SUB5 LESS THAN +20
  9254        ADD +1                   TO SUB5
  9255        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9256
  9257     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9258        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9259
  9260     MOVE +1                    TO SUB5.
  9261
  9262 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9263
  9264     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9265                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9266
  9267     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9268       AND
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 170
* EL050.cbl
  9269        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9270        GO TO 03XX-GET-AH-ERPLAN.
  9271
  9272     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9273       AND
  9274        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9275           IF (PB-I-INDV-GRP-OVRD = 'I')
  9276              OR
  9277           ((AM-IG = '1') AND
  9278           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9279              OR
  9280           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9281           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9282           (AM-IG NOT = '2'))
  9283              GO TO 03XX-GET-AH-ERPLAN.
  9284
  9285     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9286       AND
  9287        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9288           IF (PB-I-INDV-GRP-OVRD = 'G')
  9289              OR
  9290           ((AM-IG = '2') AND
  9291           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9292              OR
  9293           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9294           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9295           (AM-IG NOT = '1'))
  9296              GO TO 03XX-GET-AH-ERPLAN.
  9297
  9298     IF SUB5 LESS THAN +30
  9299        ADD +1                   TO SUB5
  9300        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9301
  9302 03XX-EDIT-FOR-NINETY-AH-CONT.
  9303
  9304     MOVE +99                    TO SUB5.
  9305
  9306     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9307
  9308     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9309        IF PB-ISSUE
  9310           MOVE ER-1925          TO  WS-ERROR
  9311           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9312
  9313     GO TO 0314-A-H-BENEFIT-FOUND.
  9314
  9315 03XX-GET-AH-ERPLAN.
  9316
  9317     IF WK-PLAN-ADDR EQUAL +0
  9318         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9319
  9320     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9321     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9322     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9323     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9324     MOVE 'Y'                    TO PLAN-MASTER-SW
  9325                                    PLAN-MASTER-AH-SW.
  9326*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 171
* EL050.cbl
  9327     GO TO 03XX-ERPLAN-AH-READ.
  9328
  9329 03XX-ERPLAN-AH-GETMAIN.
  9330
  9331     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9332     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9333
  9334 03XX-ERPLAN-AH-READ.
  9335
  9336     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9337     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9338     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9339     MOVE PB-SV-STATE            TO PLAN-STATE.
  9340     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9341     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9342     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9343     MOVE WS-SAVE-BENEFIT-REVISION
  9344                                 TO PLAN-REVISION-NO.
  9345
  9346     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9347     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9348
  9349     IF PB-COMPANY-ID = 'NCL'
  9350       IF NOT AH-PLAN-MASTER-FOUND
  9351         IF NOT PB-POLICY-IS-DECLINED  AND
  9352            NOT PB-POLICY-IS-VOIDED
  9353             MOVE  ER-1922         TO  WS-ERROR
  9354             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9355             GO TO 0314-A-H-BENEFIT-FOUND.
  9356
  9357     IF NOT AH-PLAN-MASTER-FOUND
  9358        GO TO 0314-A-H-BENEFIT-FOUND.
  9359
  9360 XXXX-CHECK-AH-PLAN-KEY.
  9361
  9362     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9363        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9364        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9365        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9366        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9367        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9368        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9369        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9370        MOVE 'N'                 TO PLAN-MASTER-SW
  9371          GO TO 03XX-ERPLAN-AH-READ.
  9372
  9373     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9374
  9375     IF  PB-CANCELLATION
  9376         GO TO  0313-AH-ACCT-BEN-FOUND.
  9377
  9378     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9379       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9380          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9381          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9382             MOVE ER-2644             TO WS-ERROR
  9383             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9384          ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 172
* EL050.cbl
  9385             NEXT SENTENCE
  9386       ELSE
  9387          IF PB-COMPANY-ID NOT = 'NCL'
  9388             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9389                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9390
  9391 0313-AH-ACCT-BEN-FOUND.
  9392
  9393     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9394
  9395     IF PL-DEV-CODE NOT = SPACES
  9396        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9397
  9398     IF PL-DEV-PCT NUMERIC AND
  9399        PL-DEV-PCT NOT = ZEROS
  9400        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9401
  9402     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9403        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9404
  9405     IF PL-TOL-REF-AMT NOT EQUAL +0
  9406        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9407
  9408     IF PL-TOL-PREM-PCT GREATER THAN +0
  9409        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9410
  9411     IF PL-TOL-REF-PCT GREATER THAN +0
  9412        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9413
  9414     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9415        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9416
  9417     IF PL-OVER-SHORT-AMT NUMERIC AND
  9418                          PL-OVER-SHORT-AMT > +0
  9419        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9420
  9421     IF PL-OVER-SHORT-PCT NUMERIC AND
  9422                          PL-OVER-SHORT-PCT > +0
  9423        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9424
  9425     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9426        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9427        IF WS-IG-OVRD-AM EQUAL SPACES
  9428            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9429
  9430 0314-A-H-BENEFIT-FOUND.
  9431
  9432     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9433
  9434     IF PB-ISSUE
  9435        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9436       ELSE
  9437        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9438
  9439     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9440     if cf-maximum-benefits (sub3) numeric
  9441        move cf-maximum-benefits (sub3)
  9442                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 173
* EL050.cbl
  9443     else
  9444        move zeros               to ws-ah-max-bens
  9445     end-if
  9446     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9447     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9448     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9449                                         WS-AH-REFUND-CALC.
  9450
  9451     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9452        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9453
  9454     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9455        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9456     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9457
  9458     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9459     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9460     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9461     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9462     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9463     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9464
  9465     IF PB-COMPANY-ID = 'NCL'  AND
  9466        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9467         NEXT SENTENCE
  9468     ELSE
  9469         IF SUB5 NOT GREATER THAN +20
  9470            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9471                MOVE WS-SAVE-BENEFIT-REM-TERM
  9472                                      TO WS-AM-AH-BENE-REM-TERM
  9473                                         EC-BR-AH-REM-TERM-CALC.
  9474
  9475     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9476     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9477
  9478     GO TO 0400-FIND-CARRIER.
  9479
  9480 0399-BENEFIT-NOT-FOUND.
  9481
  9482     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9483     MOVE ER-2605                TO WS-ERROR.
  9484     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9485
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 174
* EL050.cbl
  9487
  9488 0400-FIND-CARRIER.
  9489
  9490     MOVE PB-SV-CARRIER          TO WS-CARR.
  9491
  9492     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9493     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9494     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9495     MOVE '6'                    TO CNTL-REC-TYPE.
  9496
  9497*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9498     MOVE SPACE                  TO WS-DMD-RATING-SW
  9499                                    EC-BR-DMD-RATING-SW.
  9500
  9501     MOVE '2'                    TO RC-SW-1.
  9502     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9503
  9504     IF NOT CF-CARRIER-MASTER
  9505        GO TO 0400-CARRIER-NOT-FOUND.
  9506
  9507 0400-BUILD-CARR-TOL.
  9508
  9509     IF CF-CR-TOL-PREM NUMERIC AND
  9510        CF-CR-TOL-PREM GREATER THAN +0
  9511        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9512                                    WS-TOL-AH-PREM.
  9513
  9514     IF CF-CR-TOL-REFUND NUMERIC AND
  9515        CF-CR-TOL-REFUND GREATER THAN +0
  9516        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9517                                    WS-TOL-AH-REFUND.
  9518
  9519     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9520        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9521        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9522                                    WS-AH-REFUND-OVS-AMT.
  9523
  9524     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9525        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9526        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9527                                    WS-AH-REFUND-OVS-PCT.
  9528
  9529     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9530        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9531        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9532                                    WS-TOL-AH-PREM-PCT.
  9533
  9534     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9535        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9536        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9537                                     WS-TOL-AH-REFUND-PCT.
  9538
  9539     IF CF-COMPANY-ID EQUAL 'DMD'
  9540         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9541                                    EC-BR-DMD-RATING-SW.
  9542
  9543     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9544     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 175
* EL050.cbl
  9545        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9546     END-IF
  9547     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9548        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9549     END-IF
  9550     IF WS-TOL-CLP-PCT = ZEROS
  9551        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9552     END-IF
  9553
  9554     IF WS-SPP-LEASE-COMM = ZEROS
  9555        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9556     END-IF
  9557     GO TO 0400-FIND-ERPDEF.
  9558
  9559 0400-CARRIER-NOT-FOUND.
  9560
  9561     MOVE ER-2602                TO WS-ERROR.
  9562     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9563
  9564 0400-FIND-ERPDEF.
  9565*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9566     IF (PB-COMPANY-ID = 'DCC')
  9567        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9568        CONTINUE
  9569     ELSE
  9570        GO TO 0400-FIND-ERCOMP
  9571     END-IF
  9572     MOVE ' '                    TO PDEF-MASTER-SW
  9573     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9574     MOVE PB-STATE               TO ERPDEF-STATE
  9575     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9576        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9577     END-IF
  9578     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9579     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9580     IF PB-ISSUE
  9581        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9582     ELSE
  9583        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9584     END-IF
  9585     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9586     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9587     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9588     IF PDEF-MASTER-FOUND
  9589        MOVE 'N'                 TO PDEF-MASTER-SW
  9590        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9591        IF PDEF-MASTER-FOUND
  9592           IF (ERPDEF-KEY-SAVE (1:16) =
  9593                        PD-CONTROL-PRIMARY (1:16))
  9594              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9595              CONTINUE
  9596           ELSE
  9597              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9598              IF (ERPDEF-KEY-SAVE (1:16) =
  9599                        PD-CONTROL-PRIMARY (1:16))
  9600                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9601                 CONTINUE
  9602              ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 176
* EL050.cbl
  9603                 MOVE 'N'        TO PDEF-MASTER-SW
  9604              END-IF
  9605           END-IF
  9606        END-IF
  9607        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9608     END-IF
  9609     IF PDEF-MASTER-FOUND
  9610        IF PD-TRUNCATED = 'Y'
  9611           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9612        END-IF
  9613     END-IF
  9614     .
  9615 0400-FIND-ERCOMP.
  9616     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9617        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9618           (WS-SUB1 > +10)
  9619           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9620                 OR 'A' OR 'N'
  9621              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9622              MOVE PB-CARRIER    TO COMP-CARRIER
  9623              MOVE PB-GROUPING   TO COMP-GROUPING
  9624              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9625              MOVE AM-AGT (WS-SUB1)
  9626                                 TO COMP-FIN-RESP
  9627              MOVE 'G'           TO COMP-TYPE
  9628              PERFORM 8582-READ-COMPENSATION-MASTER
  9629                                 THRU 8582-EXIT
  9630              IF COMP-MASTER-FOUND
  9631                 IF CO-GA-INACTIVE
  9632                    MOVE ER-2763 TO WS-ERROR
  9633                    PERFORM 9900-ERROR-FORMAT
  9634                                 THRU 9900-EXIT
  9635                    MOVE +11     TO WS-SUB1
  9636                 END-IF
  9637                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9638                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9639                    MOVE ER-2788 TO WS-ERROR
  9640                    PERFORM 9900-ERROR-FORMAT
  9641                                 THRU 9900-EXIT
  9642                    MOVE +11     TO WS-SUB1
  9643                 END-IF
  9644              END-IF
  9645           END-IF
  9646        END-PERFORM
  9647     END-IF
  9648     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9649        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9650           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9651                                    WS-CLP-STATE
  9652        ELSE
  9653           MOVE SPACES           TO PB-I-CLP-STATE
  9654                                    WS-CLP-STATE
  9655        END-IF
  9656     END-IF
  9657
  9658     IF (PB-COMPANY-ID = 'DCC')
  9659        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9660        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 177
* EL050.cbl
  9661        CONTINUE
  9662     ELSE
  9663        GO TO 0400-FIND-STATE-RECORD
  9664     END-IF
  9665     MOVE SPACES                 TO WS-CLP-STATE
  9666     MOVE +0                     TO WS-BANK-FEE
  9667                                    WS-BANK-LFEE
  9668                                    WS-BANK-NOCHRGB
  9669
  9670     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9671     IF (PB-ISSUE)
  9672        AND (PB-I-BANK-NUMBER NOT =
  9673            SPACES AND ZEROS AND LOW-VALUES)
  9674        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9675     ELSE
  9676        IF (PB-CANCELLATION)
  9677           AND (PB-CI-BANK-NUMBER NOT =
  9678                SPACES AND ZEROS AND LOW-VALUES)
  9679           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9680        END-IF
  9681     END-IF
  9682     IF COMP-FIN-RESP NOT = LOW-VALUES
  9683        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9684        MOVE PB-CARRIER          TO COMP-CARRIER
  9685        MOVE PB-GROUPING         TO COMP-GROUPING
  9686        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9687        MOVE 'B'                 TO COMP-TYPE
  9688        PERFORM 8582-READ-COMPENSATION-MASTER
  9689                                 THRU 8582-EXIT
  9690        IF COMP-MASTER-FOUND
  9691           IF CO-MAX-BANK-FEE NOT NUMERIC
  9692              MOVE +0            TO CO-MAX-BANK-FEE
  9693           END-IF
  9694           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9695              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9696           END-IF
  9697           IF CO-GA-INACTIVE
  9698              MOVE ER-2763       TO WS-ERROR
  9699              PERFORM 9900-ERROR-FORMAT
  9700                                 THRU 9900-EXIT
  9701           END-IF
  9702           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9703              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9704              MOVE ER-2788 TO WS-ERROR
  9705              PERFORM 9900-ERROR-FORMAT
  9706                                 THRU 9900-EXIT
  9707              MOVE +11     TO WS-SUB1
  9708           END-IF
  9709           IF WS-AH-BEN-CATEGORY = 'G'
  9710              MOVE CO-MAX-BANK-FEE
  9711                                 TO WS-BANK-FEE
  9712                                    PB-I-BANK-FEE
  9713           ELSE
  9714              MOVE CO-MAX-BANK-FEE-LEASE
  9715                                 TO WS-BANK-LFEE
  9716                                    PB-I-BANK-FEE
  9717           END-IF
  9718           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 178
* EL050.cbl
  9719              AND (WS-AH-REFUND-CALC = 'G'))
  9720                        OR
  9721              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9722              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9723              CONTINUE
  9724           ELSE
  9725              MOVE ER-2789 TO WS-ERROR
  9726              PERFORM 9900-ERROR-FORMAT
  9727                                 THRU 9900-EXIT
  9728           END-IF
  9729           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9730                                    PB-I-CLP-STATE
  9731           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9732           MOVE CO-CARRIER       TO BXRF-CARRIER
  9733           MOVE CO-GROUPING      TO BXRF-GROUPING
  9734           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9735           MOVE BXRF-MAX-REC-LENGTH
  9736                                 TO BXRF-REC-LENGTH
  9737           PERFORM 8584-READ-BANK-CROSS-REF
  9738                                 THRU 8584-EXIT
  9739           IF BXRF-MASTER-FOUND
  9740              MOVE ' '           TO BANK-ACCT-SW
  9741              MOVE BK-BANK-POINTER-CNT
  9742                                 TO BK-BANK-POINTER-CNT
  9743              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9744                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9745                 OR (BANK-ACCT-FOUND)
  9746                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9747                    AND (BK-AM-EXP-DT (WS-SUB1)
  9748                                 > PB-CERT-EFF-DT)
  9749                    AND (BK-AM-EFF-DT (WS-SUB1)
  9750                                 NOT > PB-CERT-EFF-DT)
  9751                    SET BANK-ACCT-FOUND TO TRUE
  9752                 END-IF
  9753              END-PERFORM
  9754              IF NOT BANK-ACCT-FOUND
  9755                 MOVE ZEROS      TO WS-BANK-FEE
  9756                                    WS-BANK-LFEE
  9757                 MOVE ER-2869    TO WS-ERROR
  9758                 PERFORM 9900-ERROR-FORMAT
  9759                                 THRU 9900-EXIT
  9760              ELSE
  9761                 PERFORM 5000-PROCESS-REPS
  9762                                 THRU 5000-EXIT
  9763                 IF AGENT-MASTER-FOUND
  9764                    MOVE +0      TO WS-BANK-FEE
  9765                                    WS-BANK-LFEE
  9766*                   MOVE AG-SPP-FEES (1)
  9767*                                TO PB-I-BANK-FEE
  9768*                                   WS-BANK-FEE
  9769                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9770                       (WS-SUB1 > +10)
  9771                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9772                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9773                       END-IF
  9774                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9775                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9776                       END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 179
* EL050.cbl
  9777                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9778                          AG-SPP-FEES (WS-SUB1)
  9779                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9780                          AG-SPP-LFEES (WS-SUB1)
  9781                    END-PERFORM
  9782                    IF WS-AH-BEN-CATEGORY = 'G'
  9783                       MOVE WS-BANK-FEE
  9784                                 TO PB-I-BANK-FEE
  9785                    ELSE
  9786                       MOVE WS-BANK-LFEE
  9787                                 TO PB-I-BANK-FEE
  9788                    END-IF
  9789                 END-IF
  9790              END-IF
  9791           END-IF
  9792        ELSE
  9793           MOVE ER-2879          TO WS-ERROR
  9794           PERFORM 9900-ERROR-FORMAT
  9795                                 THRU 9900-EXIT
  9796        END-IF
  9797     ELSE
  9798        MOVE ER-2879             TO WS-ERROR
  9799        PERFORM 9900-ERROR-FORMAT
  9800                                 THRU 9900-EXIT
  9801     END-IF
  9802     IF WS-AH-BEN-CATEGORY = 'G'
  9803        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9804        + WS-BANK-FEE
  9805     ELSE
  9806        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9807        + WS-BANK-LFEE
  9808     END-IF
  9809     .
  9810 0400-FIND-STATE-RECORD.
  9811
  9812     IF WK-STATE-ADDR NOT = ZEROS
  9813         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9814         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9815         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9816         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9817         IF PB-SV-STATE = CF-STATE-CODE
  9818             GO TO 0405-CONTINUE-EDIT
  9819         ELSE
  9820             NEXT SENTENCE
  9821     ELSE
  9822         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9823
  9824     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9825     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9826     MOVE '3'                    TO CNTL-REC-TYPE.
  9827     MOVE +0                     TO CNTL-SEQ-NO.
  9828
  9829     MOVE '3'                    TO RC-SW-2.
  9830     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9831
  9832     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9833        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9834        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 180
* EL050.cbl
  9835        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9836                                    WS-TOL-AH-CLAIM
  9837                                    WS-MINIMUM-REFUND
  9838                                    WS-TOL-LF-PREM
  9839                                    WS-TOL-AH-PREM
  9840                                    WS-TOL-LF-REFUND
  9841                                    WS-TOL-AH-REFUND
  9842                                    EC-ST-TOL-PREM-PCT
  9843                                    WS-TOL-LF-PREM-PCT
  9844                                    WS-TOL-AH-PREM-PCT
  9845                                    EC-ST-TOL-REFUND-PCT
  9846                                    WS-TOL-LF-REFUND-PCT
  9847                                    WS-TOL-AH-REFUND-PCT
  9848                                    EC-ST-TOL-PREM
  9849                                    EC-ST-TOL-REFUND
  9850                                    EC-ST-FST-PMT-DAYS-MAX
  9851                                    WS-FREE-LOOK-PERIOD
  9852                                    WS-ST-LF-PREM-TAX
  9853                                    WS-ST-AH-PREM-TAX-I
  9854                                    WS-ST-AH-PREM-TAX-G
  9855                                    WS-BANK-FEE
  9856                                    WS-BANK-LFEE
  9857                                    WS-TOL-CLP-PCT
  9858                                    WS-SPP-LEASE-COMM
  9859                                    WS-INT-PERIODS
  9860                                    WS-EXTRA-PMTS
  9861        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9862                                    EC-ST-FST-PMT-DAYS-CHG
  9863                                    WS-LF-REM-TERM-CALC
  9864                                    WS-LF-REFUND-CALC
  9865                                    EC-ST-LF-REM-TERM-CALC
  9866                                    EC-ST-LF-REFUND-CALC
  9867                                    WS-AH-REM-TERM-CALC
  9868                                    WS-AH-REFUND-CALC
  9869                                    WS-LF-BEN-CATEGORY
  9870                                    WS-AH-BEN-CATEGORY
  9871                                    WS-CLP-STATE
  9872                                    WS-ST-REFUND-CLAIM-FLAG
  9873                                    WS-ST-CAUSAL-STATE
  9874                                    ws-st-agent-sig-edit
  9875                                    EC-ST-AH-REM-TERM-CALC
  9876                                    EC-ST-AH-REFUND-CALC
  9877          GO TO 0499-STATE-NOT-FOUND.
  9878
  9879     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9880
  9881 0405-CONTINUE-EDIT.
  9882
  9883     if pb-company-id = 'AHL'
  9884        continue
  9885     else
  9886        IF PB-CERT-PRIME NOT NUMERIC
  9887           MOVE ER-2722          TO WS-ERROR
  9888           PERFORM 9900-ERROR-FORMAT
  9889                                 THRU 9900-EXIT
  9890        end-if
  9891     END-IF
  9892*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 181
* EL050.cbl
  9893*       MOVE +0                  TO SUB3
  9894*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9895*       IF SUB3 > +0
  9896*          MOVE ER-2722          TO WS-ERROR
  9897*          PERFORM 9900-ERROR-FORMAT
  9898*                                THRU 9900-EXIT
  9899*       END-IF
  9900*    END-IF
  9901*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
  9902*       IF PB-CERT-PRIME NOT NUMERIC
  9903*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9904*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9905*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9906*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9907*
  9908*          MOVE ER-2722          TO WS-ERROR
  9909*          PERFORM 9900-ERROR-FORMAT
  9910*                                THRU 9900-EXIT
  9911*       END-IF
  9912*    END-IF
  9913
  9914     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9915
  9916     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9917        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9918                                    WS-TOL-AH-CLAIM.
  9919
  9920     IF CF-ST-REFUND-MIN NOT NUMERIC
  9921        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9922
  9923     IF CF-ST-REFUND-MIN NOT = ZEROS
  9924        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9925
  9926     IF CF-ST-TOL-PREM  NOT = ZEROS
  9927        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9928                                    WS-TOL-AH-PREM
  9929        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9930
  9931     IF CF-ST-TOL-REFUND NOT = ZEROS
  9932        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9933                                    WS-TOL-AH-REFUND
  9934        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9935
  9936     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9937        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9938        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9939                                    WS-AH-REFUND-OVS-AMT
  9940                                    EC-ST-OVR-SHT-AMT.
  9941
  9942     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9943        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9944        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9945                                    WS-TOL-LF-PREM-PCT
  9946                                    WS-TOL-AH-PREM-PCT.
  9947
  9948     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9949        CF-ST-TOL-REF-PCT GREATER THAN +0
  9950        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 182
* EL050.cbl
  9951                                    WS-TOL-LF-REFUND-PCT
  9952                                    WS-TOL-AH-REFUND-PCT.
  9953
  9954     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9955        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9956        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9957                                    WS-AH-REFUND-OVS-PCT
  9958                                    EC-ST-OVR-SHT-PCT.
  9959
  9960     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9961     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9962
  9963     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9964          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9965
  9966     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9967     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9968     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9969
  9970     IF CF-ST-LF-PREM-TAX NUMERIC
  9971        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9972     END-IF
  9973     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9974        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9975     END-IF
  9976     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9977        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9978     END-IF
  9979
  9980     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9981         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9982     END-IF.
  9983
  9984     IF CF-ST-CAUSAL-STATE > SPACES
  9985         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9986     END-IF.
  9987     if cf-st-extra-interest-periods not numeric
  9988        move zeros               to cf-st-extra-interest-periods
  9989     end-if
  9990     if cf-st-extra-payments not numeric
  9991        move zeros               to cf-st-extra-payments
  9992     end-if
  9993
  9994     move cf-st-extra-interest-periods
  9995                                 to ws-int-periods
  9996     move cf-st-extra-payments   to ws-extra-pmts
  9997     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9998     move cf-st-net-only-state   to ws-net-only-state
  9999     if cf-st-comm-cap-sl not numeric
 10000        move zeros               to cf-st-comm-cap-sl
 10001     end-if
 10002     if cf-st-comm-cap-jl not numeric
 10003        move zeros               to cf-st-comm-cap-jl
 10004     end-if
 10005     if cf-st-comm-cap-sa not numeric
 10006        move zeros               to cf-st-comm-cap-sa
 10007     end-if
 10008     if cf-st-comm-cap-ja not numeric
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 183
* EL050.cbl
 10009        move zeros               to cf-st-comm-cap-ja
 10010     end-if
 10011     if cf-st-ga-comm-cap-sl not numeric
 10012        move zeros               to cf-st-ga-comm-cap-sl
 10013     end-if
 10014     if cf-st-ga-comm-cap-jl not numeric
 10015        move zeros               to cf-st-ga-comm-cap-jl
 10016     end-if
 10017     if cf-st-ga-comm-cap-sa not numeric
 10018        move zeros               to cf-st-ga-comm-cap-sa
 10019     end-if
 10020     if cf-st-ga-comm-cap-ja not numeric
 10021        move zeros               to cf-st-ga-comm-cap-ja
 10022     end-if
 10023
 10024     if cf-st-tot-comm-cap-sl not numeric
 10025        move zeros               to cf-st-tot-comm-cap-sl
 10026     end-if
 10027     if cf-st-tot-comm-cap-jl not numeric
 10028        move zeros               to cf-st-tot-comm-cap-jl
 10029     end-if
 10030     if cf-st-tot-comm-cap-sa not numeric
 10031        move zeros               to cf-st-tot-comm-cap-sa
 10032     end-if
 10033     if cf-st-tot-comm-cap-ja not numeric
 10034        move zeros               to cf-st-tot-comm-cap-ja
 10035     end-if
 10036
 10037     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10038     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10039     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10040     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10041     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10042     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10043     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10044     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10045     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10046     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10047     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10048     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10049     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10050     IF WS-LF-BENEFIT-CD = ZEROS
 10051        GO TO 0410-CHECK-AH.
 10052
 10053     IF CF-ST-RT-CALC NOT = SPACES
 10054        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10055                                    EC-ST-LF-REM-TERM-CALC
 10056     END-IF
 10057
 10058     IF WS-LF-COVERAGE-TYPE = 'R'
 10059        IF WS-LF-EARNINGS-CALC = '5'
 10060           IF CF-ST-RF-LN-CALC > '0'
 10061              MOVE CF-ST-RF-LN-CALC
 10062                                 TO WS-LF-REFUND-CALC
 10063                                    EC-ST-LF-REFUND-CALC
 10064           END-IF
 10065        ELSE
 10066           IF CF-ST-RF-LR-CALC > '0'
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 184
* EL050.cbl
 10067              MOVE CF-ST-RF-LR-CALC
 10068                                 TO WS-LF-REFUND-CALC
 10069                                    EC-ST-LF-REFUND-CALC
 10070           END-IF
 10071        END-IF
 10072     ELSE
 10073        IF CF-ST-RF-LL-CALC > '0'
 10074           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10075                                    EC-ST-LF-REFUND-CALC
 10076        END-IF
 10077     END-IF
 10078
 10079     IF CF-ST-RT-CALC NOT = SPACES
 10080        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10081                                    EC-ST-LF-REM-TERM-CALC
 10082     END-IF
 10083
 10084     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10085     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10086
 10087     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10088
 10089     IF NO-BENEFIT-FOUND
 10090        GO TO 0410-CHECK-AH.
 10091
 10092     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10093        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10094                                 TO EC-ST-LF-REM-TERM-CALC
 10095                                    WS-LF-REM-TERM-CALC
 10096     END-IF
 10097
 10098     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10099        MOVE CF-ST-REFUND-CALC (SUB3)
 10100                                 TO WS-LF-REFUND-CALC
 10101                                    EC-ST-LF-REFUND-CALC
 10102     END-IF
 10103*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10104     if cf-st-extra-periods (sub3) not numeric
 10105        move zeros               to cf-st-extra-periods (sub3)
 10106     end-if
 10107     if cf-st-extra-periods (sub3) > zeros
 10108        if ws-lf-ben-category = 'P'
 10109           move cf-st-extra-periods (sub3)
 10110                                 to ws-extra-pmts
 10111        else
 10112           if ws-lf-ben-category = 'I'
 10113              move cf-st-extra-periods (sub3)
 10114                                 to ws-int-periods
 10115           end-if
 10116        end-if
 10117     end-if
 10118     .
 10119 0410-CHECK-AH.
 10120
 10121     IF WS-AH-BENEFIT-CD = ZEROS
 10122        GO TO 0500-SET-ACCOUNT.
 10123
 10124     IF CF-ST-RT-CALC NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 185
* EL050.cbl
 10125        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10126                                    EC-ST-AH-REM-TERM-CALC
 10127     END-IF
 10128
 10129     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10130        IF CF-ST-RF-CP-CALC > '0'
 10131           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10132                                    EC-ST-AH-REFUND-CALC
 10133        END-IF
 10134     ELSE
 10135        IF CF-ST-RF-AH-CALC > '0'
 10136           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10137                                    EC-ST-AH-REFUND-CALC
 10138        END-IF
 10139     END-IF
 10140     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10141     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10142
 10143     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10144
 10145     IF NO-BENEFIT-FOUND
 10146        GO TO 0500-SET-ACCOUNT.
 10147
 10148     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10149        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10150                                 TO WS-AH-REM-TERM-CALC
 10151                                    EC-ST-AH-REM-TERM-CALC
 10152     END-IF
 10153
 10154     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10155        MOVE CF-ST-REFUND-CALC (SUB3)
 10156                                 TO WS-AH-REFUND-CALC
 10157                                    EC-ST-AH-REFUND-CALC
 10158     END-IF
 10159
 10160*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10161
 10162     GO TO 0500-SET-ACCOUNT.
 10163
 10164 0499-STATE-NOT-FOUND.
 10165
 10166     MOVE ER-2603                TO WS-ERROR.
 10167     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10168
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 186
* EL050.cbl
 10170
 10171 0500-SET-ACCOUNT.
 10172*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10173     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10174        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10175        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10176        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10177        MOVE '3'                 TO CNTL-REC-TYPE
 10178        MOVE +0                  TO CNTL-SEQ-NO
 10179
 10180        MOVE '3'                 TO RC-SW-2
 10181        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10182
 10183        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10184           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10185           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10186           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10187                                    WS-ST-AH-PREM-TAX-I
 10188                                    WS-ST-AH-PREM-TAX-G
 10189        ELSE
 10190           IF CF-ST-LF-PREM-TAX NUMERIC
 10191              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10192           END-IF
 10193           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10194              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10195           END-IF
 10196           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10197              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10198           END-IF
 10199        END-IF
 10200        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10201     END-IF
 10202*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10203*  FOR DCC ONLY
 10204     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10205
 10206        MOVE ' '                 TO STAT-MASTER-SW
 10207        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10208        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10209        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10210        MOVE PB-STATE            TO ELSTAT-STATE
 10211        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10212           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10213        END-IF
 10214
 10215        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10216        SET BIN-TO-GREG          TO TRUE
 10217        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10218        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10219        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10220
 10221        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10222        IF STAT-MASTER-FOUND
 10223           MOVE 'N'              TO STAT-MASTER-SW
 10224           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10225           IF STAT-MASTER-FOUND
 10226              IF (ELSTAT-KEY-SAVE (1:12) =
 10227                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 187
* EL050.cbl
 10228                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10229                    MOVE 'F'        TO STAT-MASTER-SW
 10230                 ELSE
 10231                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10232                    IF (STAT-MASTER-FOUND)
 10233                       AND (ELSTAT-KEY-SAVE (1:12) =
 10234                           SF-CONTROL-PRIMARY (1:12))
 10235                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10236                       MOVE 'F'     TO STAT-MASTER-SW
 10237                    END-IF
 10238                 END-IF
 10239              END-IF
 10240           END-IF
 10241        END-IF
 10242
 10243        IF STAT-MASTER-SW = 'F'
 10244           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10245              and (sf-st-lf-prem-tax > zeros)
 10246              MOVE SF-ST-LF-PREM-TAX
 10247                                 TO WS-ST-LF-PREM-TAX
 10248           END-IF
 10249           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10250              and (sf-st-ah-prem-tax-i > zeros)
 10251              MOVE SF-ST-AH-PREM-TAX-I
 10252                                 TO WS-ST-AH-PREM-TAX-I
 10253           END-IF
 10254           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10255              and (sf-st-ah-prem-tax-g > zeros)
 10256              MOVE SF-ST-AH-PREM-TAX-G
 10257                                 TO WS-ST-AH-PREM-TAX-G
 10258           END-IF
 10259        END-IF
 10260     END-IF
 10261     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10262        AND (PB-ISSUE)
 10263        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10264        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10265        AND (AM-GPCD = 06)
 10266        MOVE 'Y'                 TO WS-GOOD-HIN
 10267        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10268           MOVE PB-I-VIN         TO WS-WORK-VIN
 10269           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10270              (V1 > 16)
 10271              IF WS-WORK-VIN (V1:1) NUMERIC
 10272                 MOVE WS-WORK-VIN-N (V1)
 10273                                 TO WS-ROW-B-VAL (V1)
 10274              ELSE
 10275                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10276                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10277                    OR (V2 > 26)
 10278                 END-PERFORM
 10279                 IF V2 < 27
 10280                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10281                 ELSE
 10282                    MOVE 'N'     TO WS-GOOD-HIN
 10283                 END-IF
 10284              END-IF
 10285              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 188
* EL050.cbl
 10286                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10287              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10288                 WS-ROW-D-VAL (V1)
 10289           END-PERFORM
 10290           MOVE ZEROS            TO WS-VIN-REMAINDER
 10291           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10292             REMAINDER WS-VIN-REMAINDER
 10293           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10294              CONTINUE
 10295           ELSE
 10296              MOVE 'N'           TO WS-GOOD-HIN
 10297           END-IF
 10298        ELSE
 10299           MOVE 'N'              TO WS-GOOD-HIN
 10300        END-IF
 10301        IF WS-GOOD-HIN NOT = 'Y'
 10302           MOVE ER-3826           TO WS-ERROR
 10303           PERFORM 9900-ERROR-FORMAT
 10304                                 THRU 9900-EXIT
 10305        END-IF
 10306     END-IF
 10307     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10308        AND (PB-ISSUE)
 10309        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10310        AND (AM-GPCD NOT = 06)
 10311        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10312           perform 3400-edit-vin thru 3400-exit
 10313        ELSE
 10314          MOVE ER-3826           TO WS-ERROR
 10315          PERFORM 9900-ERROR-FORMAT
 10316                                 THRU 9900-EXIT
 10317        END-IF
 10318     END-IF
 10319     if (pb-company-id = 'CID')
 10320        and (pb-issue)
 10321        and (pb-i-vin not = spaces and low-values and zeros)
 10322        perform 3400-edit-vin    thru 3400-exit
 10323     end-if
 10324******************************************************************
 10325******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10326******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10327******* METHODS.
 10328******************************************************************
 10329     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10330        IF PB-CANCELLATION
 10331           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10332              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10333                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10334                IF FORM-MASTER-FOUND
 10335                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10336******************************************************************
 10337
 10338     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10339     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10340
 10341     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10342     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10343     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 189
* EL050.cbl
 10344     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10345
 10346
 10347     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10348     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10349     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10350
 10351     IF AM-LF-OB-RATE NOT NUMERIC
 10352         MOVE ZERO               TO AM-LF-OB-RATE.
 10353
 10354     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10355         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10356
 10357     IF AM-AH-OB-RATE NOT NUMERIC
 10358         MOVE ZERO               TO AM-AH-OB-RATE.
 10359
 10360     IF WS-LF-JOINT-INDICATOR = 'J'
 10361         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10362     ELSE
 10363         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10364
 10365     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10366
 10367     IF WS-IG-OVRD-AM  EQUAL SPACE
 10368         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10369
 10370     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10371         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10372                                       WS-IG-OVRD
 10373     ELSE
 10374         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10375             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10376                                       WS-IG-OVRD
 10377         ELSE
 10378             MOVE AM-IG             TO WS-IG-OVRD-AH
 10379                                       WS-IG-OVRD.
 10380
 10381     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10382         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10383                                       WS-IG-OVRD
 10384     ELSE
 10385         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10386             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10387                                       WS-IG-OVRD
 10388         ELSE
 10389             MOVE AM-IG             TO WS-IG-OVRD-LF
 10390                                       WS-IG-OVRD.
 10391
 10392     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10393     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10394     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10395     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10396*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10397     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10398                                              TO 'PRLDSFCTIA'.
 10399
 10400     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10401     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 190
* EL050.cbl
 10402     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10403     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10404
 10405     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10406     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10407     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10408     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10409     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10410     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10411     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10412
 10413     IF WS-ACCT-AH-DEV-PCT > +0
 10414        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10415     ELSE
 10416        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10417
 10418     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10419        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10420     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10421        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10422
 10423        IF AM-EARN-METHOD-L = 'S'
 10424            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10425                                        WS-LF-REFUND-CALC.
 10426
 10427        IF AM-EARN-METHOD-R = 'S'
 10428            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10429                                        WS-LF-REFUND-CALC.
 10430
 10431     IF WS-LF-COVERAGE-TYPE = 'R'
 10432         IF AM-EARN-METHOD-R = 'R'
 10433            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10434                                    WS-LF-REFUND-CALC.
 10435     IF WS-LF-COVERAGE-TYPE = 'R'
 10436         IF AM-EARN-METHOD-R = 'P'
 10437            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10438                                    WS-LF-REFUND-CALC.
 10439     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10440         IF AM-EARN-METHOD-L = 'R'
 10441            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10442                                    WS-LF-REFUND-CALC.
 10443     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10444         IF AM-EARN-METHOD-L = 'P'
 10445            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10446                                    WS-LF-REFUND-CALC.
 10447     IF WS-LF-COVERAGE-TYPE = 'R'
 10448         IF AM-EARN-METHOD-R = 'A'
 10449            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10450                                    WS-LF-REFUND-CALC.
 10451     IF WS-LF-COVERAGE-TYPE = 'R'
 10452         IF AM-EARN-METHOD-R = 'M'
 10453            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10454                                    WS-LF-REFUND-CALC.
 10455     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10456         IF AM-EARN-METHOD-L = 'A'
 10457            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10458                                    WS-LF-REFUND-CALC.
 10459     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 191
* EL050.cbl
 10460         IF AM-EARN-METHOD-L = 'M'
 10461            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10462                                    WS-LF-REFUND-CALC.
 10463
 10464     IF AM-EARN-METHOD-A = 'R'
 10465        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10466                                    WS-AH-REFUND-CALC.
 10467     IF AM-EARN-METHOD-A = 'P'
 10468        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10469                                    WS-AH-REFUND-CALC.
 10470     IF AM-EARN-METHOD-A = 'C'
 10471        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10472                                    WS-AH-REFUND-CALC.
 10473     IF AM-EARN-METHOD-A = 'A'
 10474        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10475                                    WS-AH-REFUND-CALC.
 10476     IF AM-EARN-METHOD-A = 'M'
 10477        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10478                                    WS-AH-REFUND-CALC.
 10479     IF AM-EARN-METHOD-A = 'N'
 10480        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10481                                    WS-AH-REFUND-CALC.
 10482     IF AM-EARN-METHOD-A = 'S'
 10483        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10484                                    WS-AH-REFUND-CALC.
 10485
 10486     IF AM-TOL-PREM NOT = ZEROS
 10487        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10488                                    WS-TOL-AH-PREM.
 10489
 10490     IF AM-OVR-SHT-AMT NUMERIC AND
 10491                  AM-OVR-SHT-AMT > 0
 10492        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10493                                    EC-AM-LF-OVR-SHT-AMT
 10494                                    WS-AH-REFUND-OVS-AMT
 10495                                    EC-AM-AH-OVR-SHT-AMT.
 10496
 10497     IF AM-OVR-SHT-PCT NUMERIC AND
 10498                    AM-OVR-SHT-PCT > 0
 10499        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10500                                    EC-AM-LF-OVR-SHT-PCT
 10501                                    WS-AH-REFUND-OVS-PCT
 10502                                    EC-AM-AH-OVR-SHT-PCT.
 10503
 10504     IF AM-TOL-REF-PCT NUMERIC AND
 10505                  AM-TOL-REF-PCT > 0
 10506        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10507                                    WS-TOL-AH-REFUND-PCT.
 10508
 10509     IF AM-TOL-REF  NOT = ZEROS  AND
 10510                  AM-TOL-REF NUMERIC
 10511        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10512                                    EC-AM-LF-TOL-REFUND
 10513                                    WS-TOL-AH-REFUND
 10514                                    EC-AM-AH-TOL-REFUND.
 10515
 10516     IF AM-TOL-CLM  NOT = ZEROS
 10517        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 192
* EL050.cbl
 10518                                    WS-TOL-AH-CLAIM.
 10519
 10520     IF AM-CLP-TOL-PCT NOT NUMERIC
 10521        MOVE +0                  TO AM-CLP-TOL-PCT
 10522     END-IF
 10523
 10524     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10525        MOVE +0                  TO AM-SPP-LEASE-COMM
 10526     END-IF
 10527     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10528        MOVE WS-PL-TOL-LF-PREM-PCT
 10529                                 TO WS-TOL-LF-PREM-PCT.
 10530
 10531     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10532        MOVE WS-PL-TOL-AH-PREM-PCT
 10533                                 TO WS-TOL-AH-PREM-PCT.
 10534
 10535     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10536        MOVE WS-PL-TOL-LF-REFUND-PCT
 10537                                 TO WS-TOL-LF-REFUND-PCT.
 10538
 10539     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10540        MOVE WS-PL-TOL-AH-REFUND-PCT
 10541                                 TO WS-TOL-AH-REFUND-PCT.
 10542
 10543     IF WS-PL-REF-OVS-AMT > +0
 10544        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10545
 10546     IF WS-PL-REF-OVS-PCT > +0
 10547        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10548
 10549     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10550        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10551     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10552        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10553     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10554        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10555     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10556        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10557     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10558        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10559     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10560        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10561
 10562     IF WS-AH-PL-REF-OVS-AMT > +0
 10563        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10564
 10565     IF WS-AH-PL-REF-OVS-PCT > +0
 10566        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10567
 10568     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10569     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10570
 10571     IF PB-CANCELLATION
 10572        GO TO 3000-CONTINUE-EDIT.
 10573
 10574     MOVE +1 TO SUB1.
 10575     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 193
* EL050.cbl
 10576     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10577
 10578     IF CF-COMPANY-ID = 'DMD'
 10579       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10580         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10581        ELSE
 10582         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10583
 10584  0525-FIND-ACCT-COMM.
 10585     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10586        NEXT SENTENCE
 10587      ELSE
 10588         ADD +1 TO SUB1
 10589         IF SUB1 LESS +11
 10590            GO TO 0525-FIND-ACCT-COMM
 10591          ELSE
 10592             GO TO 0550-st-comm-cap-check.
 10593
 10594     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10595     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10596                                    PB-I-LIFE-COMMISSION.
 10597***  IF PB-COMPANY-ID = 'CRI'
 10598     IF PB-PREM-ACCTNG-ONLY
 10599         GO TO 0550-st-comm-cap-check.
 10600
 10601     MOVE '0530' TO CTBL-SW.
 10602     MOVE ' '    TO WS-CTBL-READ-SW.
 10603
 10604
 10605 0530-GET-AH-COMP.
 10606     IF NO-AH-COVERAGE  OR
 10607        NO-AH-BENEFIT-MATCH
 10608           GO TO 0540-NEXT-READ-STEP.
 10609
 10610     IF AM-A-COM (SUB1) NUMERIC
 10611        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10612         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10613         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10614         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10615         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10616     ELSE
 10617          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10618          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10619          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10620          MOVE ZEROS             TO WS-SUB1
 10621                                    WS-COMMISSION
 10622          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10623          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10624          IF WS-COMMISSION > ZEROS
 10625             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10626             GO TO 0540-NEXT-READ-STEP
 10627          END-IF
 10628          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10629          IF CTBL-TABLE-FOUND
 10630             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10631                                        PB-I-AH-TERM
 10632             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10633             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 194
* EL050.cbl
 10634             GO TO 0540-NEXT-READ-STEP
 10635          ELSE
 10636             IF FIRST-TIME-THROUGH
 10637                 GO TO 0530-GET-AH-COMP
 10638             ELSE
 10639                 MOVE ER-2609                TO WS-ERROR
 10640                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10641
 10642 0540-NEXT-READ-STEP.
 10643     MOVE '0540' TO CTBL-SW.
 10644     MOVE ' '    TO WS-CTBL-READ-SW.
 10645
 10646 0540-GET-LF-COMP.
 10647     IF NO-LIFE-COVERAGE  OR
 10648        NO-LF-BENEFIT-MATCH
 10649           GO TO 0550-st-comm-cap-check.
 10650
 10651     IF WS-LF-JOINT-INDICATOR = 'J'
 10652        IF AM-J-COM (SUB1) NUMERIC
 10653           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10654           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10655           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10656           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10657           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10658        ELSE
 10659           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10660           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10661           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10662           MOVE ZEROS                TO WS-SUB1
 10663                                        WS-COMMISSION
 10664           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10665           IF WS-COMMISSION > ZEROS
 10666              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10667              GO TO 0550-st-comm-cap-check
 10668           END-IF
 10669           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10670           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10671           IF CTBL-TABLE-FOUND
 10672              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10673              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10674              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10675              GO TO 0550-st-comm-cap-check
 10676           ELSE
 10677              IF FIRST-TIME-THROUGH
 10678                  GO TO 0540-GET-LF-COMP
 10679              ELSE
 10680                  MOVE ER-2609                TO WS-ERROR
 10681                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10682                  GO TO 0550-st-comm-cap-check.
 10683
 10684     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10685        IF AM-L-COM (SUB1) NUMERIC
 10686           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10687           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10688           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10689           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10690           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10691        ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 195
* EL050.cbl
 10692           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10693           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10694           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10695           MOVE ZEROS                TO WS-SUB1
 10696                                        WS-COMMISSION
 10697           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10698           IF WS-COMMISSION IS GREATER THAN ZEROS
 10699              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10700              GO TO 0550-st-comm-cap-check
 10701           END-IF
 10702           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10703           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10704           IF CTBL-TABLE-FOUND
 10705              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10706              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10707              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10708              GO TO 0550-st-comm-cap-check
 10709           ELSE
 10710              IF FIRST-TIME-THROUGH
 10711                  GO TO 0540-GET-LF-COMP
 10712              ELSE
 10713                  MOVE ER-2609                TO WS-ERROR
 10714                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10715
 10716 0550-st-comm-cap-check.
 10717
 10718     move +0                     to ws-tot-sl-wk-rate
 10719                                    ws-sl-wk-rate
 10720                                    ws-ga-sl-wk-rate
 10721                                    ws-tot-jl-wk-rate
 10722                                    ws-jl-wk-rate
 10723                                    ws-ga-jl-wk-rate
 10724                                    ws-tot-sa-wk-rate
 10725                                    ws-sa-wk-rate
 10726                                    ws-ga-sa-wk-rate
 10727                                    ws-tot-ja-wk-rate
 10728                                    ws-ja-wk-rate
 10729                                    ws-ga-ja-wk-rate
 10730     perform varying sub5 from +1 by +1 until
 10731        (sub5 > +10)
 10732        move +0                  to ws-wk-rate
 10733        if (am-gl-codes (sub5) <> 'Y')
 10734           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10735           if pb-i-lf-benefit-cd <> '  ' and '00'
 10736              move zeros         to ws-wk-rate
 10737              if (am-l-com (sub5) numeric)
 10738                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10739                 move am-l-com(sub5)
 10740                                 to ws-wk-rate
 10741              else
 10742                 move pb-company-cd to ctbl-company-cd
 10743                 move pb-i-lf-benefit-cd
 10744                                 to ctbl-ben-code
 10745                 move pb-i-lf-term  to ws-work-term
 10746                 move pb-life-override-l1
 10747                                 to ctbl-ben-type
 10748                 move zeros      to ws-sub1
 10749                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 196
* EL050.cbl
 10750                 move am-l-coma (sub5)
 10751                                 to ctbl-table
 10752                 move '0540'     to ctbl-sw
 10753                 perform 0552-get-it
 10754                                 thru 0552-exit
 10755              end-if
 10756              compute ws-tot-sl-wk-rate =
 10757                 ws-tot-sl-wk-rate + ws-wk-rate
 10758              if am-com-typ(sub5) = 'C' or 'D'
 10759                 compute ws-sl-wk-rate =
 10760                    ws-sl-wk-rate + ws-wk-rate
 10761              else
 10762                 if am-com-typ(sub5) = 'O' or 'P'
 10763                    compute ws-ga-sl-wk-rate =
 10764                       ws-ga-sl-wk-rate + ws-wk-rate
 10765                 end-if
 10766              end-if
 10767
 10768              move zeros         to ws-wk-rate
 10769              if (am-j-com (sub5) numeric)
 10770                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10771                 move am-j-com(sub5)
 10772                                 to ws-wk-rate
 10773              else
 10774                 move pb-company-cd to ctbl-company-cd
 10775                 move pb-i-lf-benefit-cd
 10776                                 to ctbl-ben-code
 10777                 move pb-i-lf-term  to ws-work-term
 10778                 move pb-life-override-l1
 10779                                 to ctbl-ben-type
 10780                 move zeros      to ws-sub1
 10781                                    ws-commission
 10782                 move am-j-coma (sub5)
 10783                                 to ctbl-table
 10784                 move '0540'     to ctbl-sw
 10785                 perform 0552-get-it
 10786                                 thru 0552-exit
 10787              end-if
 10788              compute ws-tot-jl-wk-rate =
 10789                 ws-tot-jl-wk-rate + ws-wk-rate
 10790              if am-com-typ(sub5) = 'C' or 'D'
 10791                 compute ws-jl-wk-rate =
 10792                    ws-jl-wk-rate + ws-wk-rate
 10793              else
 10794                 if am-com-typ(sub5) = 'O' or 'P'
 10795                    compute ws-ga-jl-wk-rate =
 10796                       ws-ga-jl-wk-rate + ws-wk-rate
 10797                 end-if
 10798              end-if
 10799           end-if
 10800           move zeros            to ws-wk-rate
 10801
 10802           if pb-i-ah-benefit-cd <> '  ' and '00'
 10803              if (am-a-com (sub5) numeric)
 10804                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10805                 move am-a-com(sub5)
 10806                                 to ws-wk-rate
 10807              else
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 197
* EL050.cbl
 10808                 move pb-company-cd to ctbl-company-cd
 10809                 move pb-i-ah-benefit-cd
 10810                                 to ctbl-ben-code
 10811                 move pb-i-ah-term  to ws-work-term
 10812                 move pb-ah-override-l1
 10813                                 to ctbl-ben-type
 10814                 move zeros      to ws-sub1
 10815                                    ws-commission
 10816                 move am-a-coma (sub5)
 10817                                 to ctbl-table
 10818                 move '0530'     to ctbl-sw
 10819                 perform 0552-get-it
 10820                                 thru 0552-exit
 10821              end-if
 10822              compute ws-tot-sa-wk-rate =
 10823                 ws-tot-sa-wk-rate + ws-wk-rate
 10824              if am-com-typ(sub5) = 'C' or 'D'
 10825                 compute ws-sa-wk-rate =
 10826                    ws-sa-wk-rate + ws-wk-rate
 10827              else
 10828                 if am-com-typ(sub5) = 'O' or 'P'
 10829                    compute ws-ga-sa-wk-rate =
 10830                       ws-ga-sa-wk-rate + ws-wk-rate
 10831                 end-if
 10832              end-if
 10833           end-if
 10834        end-if
 10835     end-perform
 10836
 10837     go to 0550-continue
 10838
 10839     .
 10840 0552-get-it.
 10841
 10842     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10843     MOVE ZEROS                  TO WS-SUB1
 10844                                    WS-COMMISSION
 10845     MOVE ' '                    TO WS-CTBL-READ-SW
 10846     PERFORM 8300-READ-CTBL-TABLE
 10847                                 THRU 8300-EXIT
 10848     IF FIRST-TIME-THROUGH
 10849        MOVE 'AA'                TO CTBL-BEN-CODE
 10850        PERFORM 8300-READ-CTBL-TABLE
 10851                                 THRU 8300-EXIT
 10852     END-IF
 10853     IF CTBL-TABLE-FOUND
 10854        if pb-life-override-l1 = ctbl-ben-type
 10855           move pb-i-lf-benefit-amt
 10856                                 to WS-COMM-CK-AMT
 10857        else
 10858           compute ws-comm-ck-amt =
 10859              pb-I-ah-benefit-amt * pb-i-ah-term
 10860        end-if
 10861        PERFORM 8800-GET-COMP-RATE
 10862                                 THRU 8800-EXIT
 10863     else
 10864        move zeros               to ws-wk-rate
 10865     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 198
* EL050.cbl
 10866
 10867     .
 10868 0552-exit.
 10869     exit.
 10870
 10871 0550-continue.
 10872
 10873     if ws-lf-joint-indicator = 'J'
 10874        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10875           and (ws-st-comm-cap-jl <> zeros)
 10876           MOVE ER-1956          TO WS-ERROR
 10877           PERFORM 9900-ERROR-FORMAT
 10878                                 THRU 9900-EXIT
 10879        end-if
 10880        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10881           and (ws-st-ga-comm-cap-jl <> zeros)
 10882           MOVE ER-1959          TO WS-ERROR
 10883           PERFORM 9900-ERROR-FORMAT
 10884                                 THRU 9900-EXIT
 10885        end-if
 10886        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10887           and (ws-st-tot-comm-cap-jl <> zeros)
 10888           MOVE ER-1962          TO WS-ERROR
 10889           PERFORM 9900-ERROR-FORMAT
 10890                                 THRU 9900-EXIT
 10891        end-if
 10892     else
 10893        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10894           and (ws-st-comm-cap-sl <> zeros)
 10895           MOVE ER-1955          TO WS-ERROR
 10896           PERFORM 9900-ERROR-FORMAT
 10897                                 THRU 9900-EXIT
 10898        end-if
 10899        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10900           and (ws-st-ga-comm-cap-sl <> zeros)
 10901           MOVE ER-1958          TO WS-ERROR
 10902           PERFORM 9900-ERROR-FORMAT
 10903                                 THRU 9900-EXIT
 10904        end-if
 10905        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10906           and (ws-st-tot-comm-cap-sl <> zeros)
 10907           MOVE ER-1961          TO WS-ERROR
 10908           PERFORM 9900-ERROR-FORMAT
 10909                                 THRU 9900-EXIT
 10910        end-if
 10911
 10912     if ws-ah-joint-indicator = 'J'
 10913        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10914           and (ws-st-comm-cap-ja <> zeros)
 10915           MOVE ER-1957          TO WS-ERROR
 10916           PERFORM 9900-ERROR-FORMAT
 10917                                 THRU 9900-EXIT
 10918        end-if
 10919        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 10920           and (ws-st-ga-comm-cap-ja <> zeros)
 10921           MOVE ER-1960          TO WS-ERROR
 10922           PERFORM 9900-ERROR-FORMAT
 10923                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 199
* EL050.cbl
 10924        end-if
 10925        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 10926           and (ws-st-tot-comm-cap-ja <> zeros)
 10927           MOVE ER-1963          TO WS-ERROR
 10928           PERFORM 9900-ERROR-FORMAT
 10929                                 THRU 9900-EXIT
 10930        end-if
 10931     else
 10932        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 10933           and (ws-st-comm-cap-sa <> zeros)
 10934           MOVE ER-1957          TO WS-ERROR
 10935           PERFORM 9900-ERROR-FORMAT
 10936                                 THRU 9900-EXIT
 10937        end-if
 10938        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 10939           and (ws-st-ga-comm-cap-sa <> zeros)
 10940           MOVE ER-1960          TO WS-ERROR
 10941           PERFORM 9900-ERROR-FORMAT
 10942                                 THRU 9900-EXIT
 10943        end-if
 10944        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 10945           and (ws-st-tot-comm-cap-sa <> zeros)
 10946           MOVE ER-1963          TO WS-ERROR
 10947           PERFORM 9900-ERROR-FORMAT
 10948                                 THRU 9900-EXIT
 10949        end-if
 10950     end-if
 10951     .
 10952 0560-EDIT-CONTINUE.
 10953     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10954                                    WS-AH-PMF-COMM
 10955*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10956*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10957     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10958        (SUB1 > +10)
 10959        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10960           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10961           MOVE '0530'           TO CTBL-SW
 10962           MOVE ' '              TO WS-CTBL-READ-SW
 10963           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10964           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10965           MOVE '0540'           TO CTBL-SW
 10966           MOVE ' '              TO WS-CTBL-READ-SW
 10967           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10968        END-IF
 10969     END-PERFORM
 10970     GO TO 0564-EDIT-CONTINUE
 10971     .
 10972 0561-CHECK-AH.
 10973     IF (NO-AH-COVERAGE)
 10974        OR (NO-AH-BENEFIT-MATCH)
 10975        CONTINUE
 10976     ELSE
 10977        IF (AM-A-COM (SUB1) NUMERIC)
 10978           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10979           IF (AM-COM-TYP (SUB1) = 'A')
 10980              AND (WS-AH-PMF-COMM = ZEROS)
 10981              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 200
* EL050.cbl
 10982           END-IF
 10983           CONTINUE
 10984        ELSE
 10985           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10986           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10987           MOVE PB-AH-OVERRIDE-L1
 10988                                 TO CTBL-BEN-TYPE
 10989           MOVE ZEROS            TO WS-SUB1
 10990                                    WS-COMMISSION
 10991           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10992           PERFORM 8300-READ-CTBL-TABLE
 10993                                 THRU 8300-EXIT
 10994           IF CTBL-TABLE-FOUND
 10995              IF (AM-COM-TYP (SUB1) = 'A')
 10996                 AND (WS-AH-PMF-COMM = ZEROS)
 10997                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10998                                        PB-I-AH-TERM
 10999                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11000                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 11001              END-IF
 11002              CONTINUE
 11003           ELSE
 11004              IF FIRST-TIME-THROUGH
 11005                 GO TO 0561-CHECK-AH
 11006              ELSE
 11007                 MOVE ER-2609    TO WS-ERROR
 11008                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11009              END-IF
 11010           END-IF
 11011        END-IF
 11012     END-IF
 11013     .
 11014 0561-EXIT.
 11015     EXIT.
 11016 0563-CHECK-LF.
 11017     IF (NO-LIFE-COVERAGE)
 11018        OR (NO-LF-BENEFIT-MATCH)
 11019        CONTINUE
 11020     ELSE
 11021        IF WS-LF-JOINT-INDICATOR = 'J'
 11022           IF AM-J-COM (SUB1) NUMERIC
 11023              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11024              IF (AM-COM-TYP (SUB1) = 'A')
 11025                 AND (WS-LF-PMF-COMM = ZEROS)
 11026                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11027              END-IF
 11028              CONTINUE
 11029           ELSE
 11030              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11031              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11032              MOVE PB-LIFE-OVERRIDE-L1
 11033                                 TO CTBL-BEN-TYPE
 11034              MOVE ZEROS         TO WS-SUB1
 11035                                    WS-COMMISSION
 11036              MOVE AM-J-COMA (SUB1)
 11037                                 TO CTBL-TABLE
 11038              PERFORM 8300-READ-CTBL-TABLE
 11039                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 201
* EL050.cbl
 11040              IF CTBL-TABLE-FOUND
 11041                 IF (AM-COM-TYP (SUB1) = 'A')
 11042                    AND (WS-LF-PMF-COMM = ZEROS)
 11043                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11044                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11045                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11046                 END-IF
 11047                 CONTINUE
 11048              ELSE
 11049                 IF FIRST-TIME-THROUGH
 11050                    GO TO 0563-CHECK-LF
 11051                 ELSE
 11052                    MOVE ER-2609 TO WS-ERROR
 11053                    PERFORM 9900-ERROR-FORMAT
 11054                                 THRU 9900-EXIT
 11055*                   GO TO 0560-EDIT-CONTINUE
 11056                 END-IF
 11057              END-IF
 11058           END-IF
 11059        ELSE
 11060           IF AM-L-COM (SUB1) NUMERIC
 11061              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11062              IF (AM-COM-TYP (SUB1) = 'A')
 11063                 AND (WS-LF-PMF-COMM = ZEROS)
 11064                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11065              END-IF
 11066              CONTINUE
 11067           ELSE
 11068              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11069              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11070              MOVE PB-LIFE-OVERRIDE-L1
 11071                                 TO CTBL-BEN-TYPE
 11072              MOVE ZEROS         TO WS-SUB1
 11073                                    WS-COMMISSION
 11074              MOVE AM-L-COMA (SUB1)
 11075                                 TO CTBL-TABLE
 11076              PERFORM 8300-READ-CTBL-TABLE
 11077                                 THRU 8300-EXIT
 11078              IF CTBL-TABLE-FOUND
 11079                 CONTINUE
 11080              ELSE
 11081                 IF FIRST-TIME-THROUGH
 11082                    GO TO 0563-CHECK-LF
 11083                 ELSE
 11084                    MOVE ER-2609 TO WS-ERROR
 11085                    PERFORM 9900-ERROR-FORMAT
 11086                                 THRU 9900-EXIT
 11087                 END-IF
 11088              END-IF
 11089           END-IF
 11090        END-IF
 11091     END-IF
 11092     .
 11093 0563-EXIT.
 11094     EXIT.
 11095 0564-EDIT-CONTINUE.
 11096
 11097     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 202
* EL050.cbl
 11098         IF PB-I-NUM-BILLED EQUAL ZEROS
 11099            MOVE ER-8148       TO WS-ERROR
 11100            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11101
 11102*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11103*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11104*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11105*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11106*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11107*         IF NO-CONVERSION-ERROR
 11108*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11109*         ELSE
 11110*             IF PB-COMPANY-ID EQUAL 'HAN'
 11111*                 MOVE ZEROS     TO PB-I-AGE.
 11112     IF PB-I-BIRTHDAY > LOW-VALUES
 11113        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11114        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11115        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11116        PERFORM 8500-DATE-CONVERT
 11117                                 THRU 8500-EXIT
 11118        IF NO-CONVERSION-ERROR
 11119           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11120           IF PB-I-AGE > ZEROS
 11121              IF WS-WORK-AGE NOT = PB-I-AGE
 11122                 MOVE ER-9501    TO WS-ERROR
 11123                 PERFORM 9900-ERROR-FORMAT
 11124                                 THRU 9900-EXIT
 11125              END-IF
 11126           ELSE
 11127              MOVE WS-WORK-AGE   TO PB-I-AGE
 11128           END-IF
 11129        END-IF
 11130     END-IF
 11131     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11132                                   WS-INS-AGE-SET
 11133     IF PB-I-AGE = ZEROS
 11134        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11135           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11136                                   WS-INS-AGE-SET
 11137           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11138
 11139     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11140                                   WS-AH-EDIT-AGE.
 11141
 11142     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11143        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11144        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11145        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11146        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11147        IF NO-CONVERSION-ERROR
 11148           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11149           IF PB-I-JOINT-AGE > 0
 11150              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11151                 MOVE ER-9503    TO WS-ERROR
 11152                 PERFORM 9900-ERROR-FORMAT
 11153                                 THRU 9900-EXIT
 11154              END-IF
 11155           ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 203
* EL050.cbl
 11156              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11157           END-IF
 11158        ELSE
 11159           MOVE ZEROS            TO PB-I-JOINT-AGE
 11160        END-IF
 11161     END-IF
 11162     IF PB-I-JOINT-AGE NOT NUMERIC
 11163        MOVE ZERO               TO PB-I-JOINT-AGE.
 11164
 11165     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11166                                   WS-JNT-AGE-SET
 11167     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11168        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11169           (WS-AH-JOINT-INDICATOR = 'J')
 11170           IF PB-I-JOINT-AGE = ZEROS
 11171               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11172                                          WS-JNT-AGE-SET
 11173               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11174           END-IF
 11175        END-IF
 11176     END-IF
 11177
 11178     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11179     IF WS-LF-JOINT-INDICATOR = 'J'
 11180        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11181        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11182            IF  PB-I-JOINT-AGE = ZERO
 11183                MOVE ER-2686       TO WS-ERROR
 11184                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11185            ELSE
 11186                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11187                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11188                    IF PB-COMPANY-ID NOT = 'LBL'
 11189                        MOVE ER-2685    TO WS-ERROR
 11190                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11191
 11192     IF WS-AH-JOINT-INDICATOR = 'J'
 11193        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11194            IF  PB-I-JOINT-AGE = ZERO
 11195                MOVE ER-2686       TO WS-ERROR
 11196                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11197            ELSE
 11198                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11199                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11200                                           WS-EDIT-AGE
 11201                    IF PB-COMPANY-ID NOT = 'LBL'
 11202                        MOVE ER-2685    TO WS-ERROR
 11203                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11204
 11205******************************************************************
 11206*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11207******************************************************************
 11208
 11209     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11210        (WS-AH-SPECIAL-CALC-CD = 'O')
 11211        NEXT SENTENCE
 11212     ELSE
 11213        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 204
* EL050.cbl
 11214          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11215           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11216            WS-AH-JOINT-INDICATOR = 'J')  AND
 11217           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11218            MOVE ER-2627             TO WS-ERROR
 11219            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11220
 11221     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11222        (WS-AH-SPECIAL-CALC-CD = 'O')
 11223         NEXT SENTENCE
 11224     ELSE
 11225         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11226            WS-AH-JOINT-INDICATOR = 'J'
 11227             IF PB-I-JOINT-INSURED = SPACES
 11228                 IF PB-COMPANY-ID NOT = 'JAL'
 11229                     MOVE ER-2696    TO WS-ERROR
 11230                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11231
 11232     IF PB-COMPANY-ID NOT = 'BOA'
 11233        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11234           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11235           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11236               PB-I-JOINT-INSURED NOT = SPACES)
 11237                MOVE ER-2691         TO WS-ERROR
 11238                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11239
 11240     IF PB-COMPANY-ID = 'BOA'
 11241        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11242           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11243            IF PB-I-JOINT-AGE NOT = ZEROS
 11244                MOVE ER-2691         TO WS-ERROR
 11245                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11246
 11247     IF PB-COMPANY-ID = 'CRI'
 11248        IF PB-I-SIG-SW = 'J'
 11249           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11250              WS-AH-JOINT-INDICATOR NOT = 'J'
 11251              MOVE ER-2675       TO WS-ERROR
 11252              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11253
 11254     IF PB-COMPANY-ID = 'CRI'
 11255        IF PB-I-SIG-SW = 'S'
 11256           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11257              WS-AH-JOINT-INDICATOR = 'J'
 11258              MOVE ER-2676       TO WS-ERROR
 11259              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11260
 11261     IF PB-COMPANY-ID = 'CVL'
 11262         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11263            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11264              MOVE ER-2783           TO WS-ERROR
 11265              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11266     IF (WS-LF-JOINT-INDICATOR = 'J')
 11267        AND (WS-AH-JOINT-INDICATOR = 'J')
 11268        AND (PB-I-LF-TERM > 120)
 11269        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11270        MOVE ER-2783             TO WS-ERROR
 11271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 205
* EL050.cbl
 11272     END-IF
 11273     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11274
 11275     IF PB-I-INDV-GRP-OVRD = 'I'
 11276        MOVE ER-2666             TO WS-ERROR
 11277        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11278        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11279
 11280     IF PB-I-INDV-GRP-OVRD = 'G'
 11281        MOVE ER-2666             TO WS-ERROR
 11282        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11283        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11284
 11285     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11286        NEXT SENTENCE
 11287     ELSE
 11288        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11289
 11290     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11291        IF WS-ERROR = ER-2666
 11292           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11293           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11294
 11295     IF PB-COMPANY-ID = 'CID'
 11296        IF PB-STATE = 'UT' OR 'MO'
 11297           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11298                 OR '76' OR '77')
 11299                      OR
 11300               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11301                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11302                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11303                   OR '2K' OR '2L'))
 11304              AND PB-I-INDV-GRP-CD = 'I'
 11305              MOVE ER-2721             TO WS-ERROR
 11306              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11307           END-IF
 11308        END-IF
 11309     END-IF
 11310
 11311     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11312     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11313        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11314     ELSE
 11315        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11316     END-IF
 11317
 11318*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11319*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11320     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11321                                    ACCOUNT-AH-CK-SW.
 11322
 11323     IF PB-REISSUED-CERT       OR
 11324        PB-REIN-ONLY-CERT      OR
 11325        PB-POLICY-IS-DECLINED  OR
 11326        PB-POLICY-IS-VOIDED
 11327*       OR PB-MONTHLY-CERT
 11328         GO TO 3000-CONTINUE-EDIT.
 11329
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 206
* EL050.cbl
 11330     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11331        IF WS-EDIT-AGE           > +65
 11332           MOVE ER-2709          TO WS-ERROR
 11333           PERFORM 9900-ERROR-FORMAT
 11334                                 THRU 9900-EXIT
 11335        ELSE
 11336           IF WS-EDIT-AGE        > +55
 11337              MOVE ER-2718       TO WS-ERROR
 11338              PERFORM 9900-ERROR-FORMAT
 11339                                 THRU 9900-EXIT
 11340           END-IF
 11341        END-IF
 11342     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11343        IF WS-EDIT-AGE           > +65
 11344           MOVE ER-2709          TO WS-ERROR
 11345           PERFORM 9900-ERROR-FORMAT
 11346                                 THRU 9900-EXIT
 11347        END-IF
 11348     END-IF
 11349     .
 11350
 11351 0565-LIFE-PLAN-LIMIT-EDITS.
 11352
 11353     IF NOT LF-PLAN-MASTER-FOUND
 11354        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11355                                    EC-AM-LF-MAX-TOT-BEN
 11356        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11357
 11358     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11359
 11360     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11361         IF PL-LM-AGE (1) = ZEROS
 11362             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11363
 11364     IF NO-LF-BENEFIT-MATCH          OR
 11365        WS-LF-BENEFIT-CD = ZEROS     OR
 11366        WS-LF-SPECIAL-CALC-CD = 'M'
 11367        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11368
 11369     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11370     MOVE +1                     TO SUB2.
 11371
 11372     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11373        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11374           MOVE +5   TO SUB2
 11375           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11376              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11377              (PL-LM-AGE (SUB2) EQUAL +0)
 11378              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11379              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11380
 11381     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11382
 11383     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11384                               + PB-I-LF-ALT-BENEFIT-AMT.
 11385
 11386 0568-CHECK-LIFE-ATT-AGE.
 11387
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 207
* EL050.cbl
 11388     IF PL-ATT-AGE NUMERIC AND
 11389        PL-ATT-AGE > +0
 11390        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11391     END-IF
 11392*    IF PL-ATT-AGE NUMERIC AND
 11393*       PL-ATT-AGE > +0
 11394*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11395*       IF PB-I-BIRTHDAY > LOW-VALUES
 11396*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11397*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11398*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11399*          SET BIN-PLUS-ELAPSED  TO TRUE
 11400*          PERFORM 8500-DATE-CONVERT
 11401*                                THRU 8500-EXIT
 11402*          IF NO-CONVERSION-ERROR
 11403*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11404*             MOVE ER-2669       TO WS-ERROR
 11405*             PERFORM 9900-ERROR-FORMAT
 11406*                                THRU 9900-EXIT
 11407*          END-IF
 11408*       ELSE
 11409*          IF WS-ATT-AGE >= PL-ATT-AGE
 11410*             MOVE ER-2669       TO WS-ERROR
 11411*             PERFORM 9900-ERROR-FORMAT
 11412*                                THRU 9900-EXIT
 11413*          END-IF
 11414*       END-IF
 11415*    END-IF
 11416     .
 11417 0570-CHECK-LIFE-LIMITS.
 11418
 11419     IF PB-COMPANY-ID EQUAL 'CRI'
 11420        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11421           IF SUB2 GREATER THAN +4
 11422              MOVE ER-2637 TO WS-ERROR
 11423              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11424              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11425
 11426     IF PB-COMPANY-ID  =  'NCL'
 11427        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11428            SUB2 GREATER THAN +8
 11429             MOVE 'U'         TO PB-BATCH-ENTRY
 11430             MOVE ER-2637     TO WS-ERROR
 11431             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11432             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11433
 11434     IF SUB2 > +8
 11435        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11436           AND (PB-I-SIG-SW = 'Y')
 11437           CONTINUE
 11438        ELSE
 11439           MOVE ER-2637          TO WS-ERROR
 11440           PERFORM 9900-ERROR-FORMAT
 11441                                 THRU 9900-EXIT
 11442        END-IF
 11443        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11444     END-IF
 11445     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 208
* EL050.cbl
 11446     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11447     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11448
 11449     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11450        ADD +1  TO SUB2
 11451        GO TO 0570-CHECK-LIFE-LIMITS.
 11452
 11453     IF PB-COMPANY-ID = 'NCL'
 11454         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11455
 11456     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11457        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11458        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11459           AND (PB-I-SIG-SW = 'Y')
 11460           CONTINUE
 11461        ELSE
 11462           MOVE ER-2637          TO WS-ERROR
 11463           PERFORM 9900-ERROR-FORMAT
 11464                                 THRU 9900-EXIT
 11465        END-IF
 11466     END-IF
 11467     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11468
 11469
 11470 0570-CHECK-NCL-LIFE-LIMITS.
 11471
 11472     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11473        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11474         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11475
 11476     IF APP-CERT-USED
 11477         IF SUB2  LESS THAN  +5
 11478             MOVE +5          TO SUB2
 11479             GO TO 0570-CHECK-LIFE-LIMITS.
 11480
 11481     MOVE ER-2637             TO WS-ERROR.
 11482     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11483
 11484     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11485
 11486 0575-CHECK-NCL-SIG-SWITCH.
 11487
 11488     IF NOT APP-CERT-USED
 11489         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11490
 11491     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11492        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11493        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11494        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11495         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11496
 11497     IF SUB2 GREATER THAN +4
 11498         IF PL-LM-AGE (5) = ZEROS  AND
 11499            PL-LM-AGE (6) = ZEROS  AND
 11500            PL-LM-AGE (7) = ZEROS  AND
 11501            PL-LM-AGE (8) = ZEROS
 11502             MOVE  ER-1927        TO WS-ERROR
 11503             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 209
* EL050.cbl
 11504             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11505         ELSE
 11506             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11507                 MOVE  ER-1920    TO WS-ERROR
 11508                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11509
 11510     IF PB-I-SIG-SW  = 'Y'
 11511       IF NOT PB-I-POLICY-ACCEPTED  AND
 11512          NOT PB-I-POLICY-DECLINED
 11513           MOVE 'U'               TO PB-BATCH-ENTRY
 11514           MOVE  ER-1926          TO WS-ERROR
 11515           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11516
 11517
 11518 0580-AH-PLAN-LIMIT-EDITS.
 11519
 11520     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11521        IF PB-I-AH-BENEFIT-AMT > +1250
 11522           MOVE ER-2702          TO WS-ERROR
 11523           PERFORM 9900-ERROR-FORMAT
 11524                                 THRU 9900-EXIT
 11525        END-IF
 11526     END-IF
 11527
 11528     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11529        AND (PB-MONTHLY-CERT)
 11530        IF PB-I-AH-BENEFIT-AMT > +3000
 11531           MOVE ER-2881          TO WS-ERROR
 11532           PERFORM 9900-ERROR-FORMAT
 11533                                 THRU 9900-EXIT
 11534        END-IF
 11535     END-IF
 11536     IF NOT AH-PLAN-MASTER-FOUND
 11537        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11538        GO TO 3000-CONTINUE-EDIT.
 11539
 11540     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11541
 11542     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11543         IF PL-LM-AGE (1) = ZEROS
 11544             GO TO 3000-CONTINUE-EDIT.
 11545
 11546     IF NO-AH-BENEFIT-MATCH          OR
 11547        WS-AH-BENEFIT-CD = ZEROS     OR
 11548        WS-AH-SPECIAL-CALC-CD = 'M'
 11549        GO TO 3000-CONTINUE-EDIT.
 11550
 11551     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11552     MOVE +1                     TO SUB2.
 11553
 11554     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11555        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11556           MOVE +5 TO SUB2
 11557           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11558              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11559              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11560              (PL-LM-AGE (SUB2) EQUAL +0)
 11561              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 210
* EL050.cbl
 11562              GO TO 3000-CONTINUE-EDIT.
 11563
 11564     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11565
 11566 0590-CHECK-AH-ATT-AGE.
 11567
 11568     IF PL-ATT-AGE NUMERIC AND
 11569        PL-ATT-AGE GREATER THAN +0
 11570        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11571     END-IF
 11572*       IF WS-ATT-AGE >= PL-ATT-AGE
 11573*          MOVE ER-3054          TO WS-ERROR
 11574*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11575     .
 11576 0597-CHECK-AH-LIMITS.
 11577
 11578     IF PB-COMPANY-ID EQUAL 'CRI'
 11579        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11580           IF SUB2 GREATER THAN +4
 11581              MOVE ER-2638       TO WS-ERROR
 11582              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11583              GO TO 3000-CONTINUE-EDIT.
 11584
 11585     IF PB-COMPANY-ID  =  'NCL'
 11586        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11587            SUB2 GREATER THAN +8
 11588             MOVE 'U'            TO PB-BATCH-ENTRY
 11589             MOVE ER-2638        TO WS-ERROR
 11590             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11591             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11592
 11593     IF SUB2 > +8
 11594        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11595           AND (PB-I-SIG-SW = 'Y')
 11596           CONTINUE
 11597        ELSE
 11598           MOVE ER-2638          TO WS-ERROR
 11599           PERFORM 9900-ERROR-FORMAT
 11600                                 THRU 9900-EXIT
 11601        END-IF
 11602        GO TO 3000-CONTINUE-EDIT
 11603     END-IF
 11604
 11605     IF PB-COMPANY-ID = 'CRI'
 11606        IF WS-ERROR = ER-2638
 11607           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11608
 11609     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11610     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11611     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11612     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11613
 11614     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11615        ADD +1                   TO SUB2
 11616        GO TO 0597-CHECK-AH-LIMITS.
 11617
 11618     IF PB-COMPANY-ID = 'NCL'
 11619         GO TO 0597-CHECK-NCL-AH-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 211
* EL050.cbl
 11620
 11621     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11622        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11623        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11624                                 > PL-LM-AMT (SUB2))
 11625        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11626           AND (PB-I-SIG-SW = 'Y')
 11627           CONTINUE
 11628        ELSE
 11629           MOVE ER-2638          TO WS-ERROR
 11630           PERFORM 9900-ERROR-FORMAT
 11631                                 THRU 9900-EXIT
 11632        END-IF
 11633     END-IF
 11634
 11635     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11636         IF  WS-ERROR    EQUAL    ER-2638
 11637             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11638                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11639                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11640                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11641                MOVE  ER-1910    TO  WS-ERROR
 11642                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11643
 11644     IF PB-COMPANY-ID = 'CRI'
 11645        IF WS-ERROR = ER-2638
 11646            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11647            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11648            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11649
 11650     GO TO 3000-CONTINUE-EDIT.
 11651
 11652 0597-CHECK-NCL-AH-LIMITS.
 11653
 11654     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11655        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11656        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11657                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11658         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11659
 11660     IF APP-CERT-USED
 11661         IF SUB2  LESS THAN  +5
 11662             MOVE +5             TO SUB2
 11663             GO TO 0597-CHECK-AH-LIMITS.
 11664
 11665     MOVE ER-2638                TO WS-ERROR.
 11666     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11667
 11668     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11669
 11670 0599-CHECK-NCL-SIG-SWITCH.
 11671
 11672     IF NOT APP-CERT-USED
 11673         GO TO 3000-CONTINUE-EDIT.
 11674
 11675     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11676        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11677        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 212
* EL050.cbl
 11678        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11679         GO TO 3000-CONTINUE-EDIT.
 11680
 11681     IF SUB2 GREATER THAN +4
 11682         IF PL-LM-AGE (5) = ZEROS  AND
 11683            PL-LM-AGE (6) = ZEROS  AND
 11684            PL-LM-AGE (7) = ZEROS  AND
 11685            PL-LM-AGE (8) = ZEROS
 11686             MOVE  ER-1927        TO WS-ERROR
 11687             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11688             GO TO 3000-CONTINUE-EDIT
 11689         ELSE
 11690             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11691                 MOVE  ER-1920    TO WS-ERROR
 11692                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11693
 11694     IF PB-I-SIG-SW  = 'Y'
 11695       IF NOT PB-I-POLICY-ACCEPTED  AND
 11696          NOT PB-I-POLICY-DECLINED
 11697           MOVE 'U'               TO PB-BATCH-ENTRY
 11698           MOVE  ER-1926          TO WS-ERROR
 11699           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11700
 11701******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 213
* EL050.cbl
 11703
 11704 3000-CONTINUE-EDIT.
 11705
 11706     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11707     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11708     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11709     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11710     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11711
 11712     IF BROWSE-STARTED
 11713        PERFORM 9990-RETURN THRU 9990-EXIT
 11714        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11715
 11716     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11717        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11718        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11719        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11720*       MOVE 1                   TO DC-OPTION-CODE
 11721        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11722        IF DATE-CONVERSION-ERROR
 11723           MOVE ER-2622          TO WS-ERROR
 11724           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11725        ELSE
 11726           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11727              MOVE ER-2623       TO WS-ERROR
 11728              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11729           ELSE
 11730              MOVE ER-2622       TO WS-ERROR
 11731              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11732
 11733     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11734     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11735     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11736*    MOVE 1                      TO DC-OPTION-CODE.
 11737     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11738     IF DATE-CONVERSION-ERROR
 11739        GO TO 3005-EDIT-CONTINUE
 11740     ELSE
 11741        IF DC-ELAPSED-DAYS GREATER +180
 11742           MOVE ER-2613          TO WS-ERROR
 11743           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11744        ELSE
 11745           IF DC-ELAPSED-DAYS GREATER +90
 11746              MOVE ER-2612       TO WS-ERROR
 11747              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11748           ELSE
 11749             IF DC-ELAPSED-DAYS GREATER +60
 11750                MOVE ER-2614     TO WS-ERROR
 11751                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11752
 11753 3005-EDIT-CONTINUE.
 11754
 11755     IF PB-CANCELLATION
 11756         GO TO 3700-EDIT-CANCEL.
 11757
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 214
* EL050.cbl
 11759******************************************************************
 11760*                  E D I T   I S S U E                           *
 11761******************************************************************
 11762
 11763 3020-EDIT-ISSUE.
 11764
 11765      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11766      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11767      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11768      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11769      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11770
 11771     IF PB-ISSUE-FORCE
 11772        OR PB-ISSUE-DATE-FORCED
 11773        OR PB-FORCE-OFF
 11774        OR PB-OVERCHARGE-FORCE
 11775        or pb-exceeded-limit-forced
 11776        CONTINUE
 11777     ELSE
 11778        MOVE ER-2670             TO WS-ERROR
 11779        PERFORM 9900-ERROR-FORMAT
 11780                                 THRU 9900-EXIT
 11781     END-IF
 11782     .
 11783 3022-SET-POLICY-STATUS.
 11784
 11785     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11786
 11787     IF (PB-REISSUED-CERT)
 11788             OR
 11789        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11790         AND (PB-MONTHLY-CERT))
 11791         MOVE '5'                TO PB-I-ENTRY-STATUS
 11792         MOVE 'E'                TO PB-BATCH-ENTRY
 11793     END-IF
 11794
 11795     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11796        IF PB-MONTHLY-CERT
 11797           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11798        END-IF
 11799        IF PB-CASH-CERT
 11800           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11801        END-IF
 11802     END-IF
 11803     IF PB-POLICY-IS-DECLINED
 11804         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11805     IF PB-POLICY-IS-VOIDED
 11806         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11807     IF PB-NEEDS-UNDERWRITING
 11808         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11809     IF PB-REIN-ONLY-CERT
 11810         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11811     IF PB-PREM-ACCTNG-ONLY
 11812         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11813
 11814     MOVE SPACE                  TO PB-I-OB-FLAG.
 11815
 11816     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 215
* EL050.cbl
 11817         MOVE ER-2665            TO WS-ERROR
 11818         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11819         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11820
 11821     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11822        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11823           MOVE 'Z'             TO PB-I-OB-FLAG.
 11824
 11825     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11826        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11827           MOVE 'Z'             TO PB-I-OB-FLAG.
 11828
 11829     IF ACCOUNT-MAST-FOUND
 11830         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11831         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11832         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11833         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11834         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11835         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11836         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11837     END-IF
 11838
 11839     IF ACCOUNT-MAST-FOUND
 11840        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11841         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11842
 11843     IF (ACCOUNT-MAST-FOUND)
 11844*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11845        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11846        IF PB-REISSUED-CERT
 11847           CONTINUE
 11848        ELSE
 11849           MOVE ER-2608          TO WS-ERROR
 11850           PERFORM 9900-ERROR-FORMAT
 11851                                 THRU 9900-EXIT
 11852         END-IF
 11853     END-IF
 11854
 11855     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11856        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11857        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11858
 11859**********   DMD CUSTOM CODE FOLLOWS  **********
 11860 3024-EDIT-DMD-FIELDS.
 11861     IF PB-COMPANY-ID NOT = 'DMD'
 11862        GO TO 3025-EDIT-REINSURANCE.
 11863
 11864*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11865*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11866*** ERROR IF THEY ARE NOT EQUAL.
 11867
 11868     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11869     SET BIN-TO-GREG               TO TRUE.
 11870     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11871     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11872**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11873
 11874     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 216
* EL050.cbl
 11875     SET BIN-TO-GREG               TO TRUE.
 11876     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11877     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11878**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11879
 11880     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11881        MOVE ER-8116               TO WS-ERROR
 11882        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11883
 11884     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11885
 11886     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11887                                      WK-FULL-CERT-NO.
 11888     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11889
 11890     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11891
 11892     IF PB-VALID-LIFE
 11893        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11894     ELSE
 11895        IF PB-VALID-AH
 11896          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11897
 11898
 11899     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11900     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11901     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11902                                      DCUA-UNDRWRTR-CODE
 11903                                      DCUA-UNDRWRTR-GROUP-CODE
 11904                                      DCUA-RETURN-CODE.
 11905
 11906****************************************************************
 11907*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11908***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11909***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11910***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11911***   TO THIS RECORD.                                        ***
 11912****************************************************************
 11913     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11914     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11915     IF DCUA-SUCCESSFUL-PROCESS
 11916        GO TO 3024-EDIT-DL7-CONT.
 11917
 11918     IF DCUA-RETURN-CODE EQUAL '01'
 11919        MOVE ER-8110               TO WS-ERROR
 11920        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11921        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11922        GO TO 3024-EDIT-DL7-CONT.
 11923
 11924     IF DCUA-RETURN-CODE EQUAL '02'
 11925        MOVE ER-8111               TO WS-ERROR
 11926        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11927        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11928        GO TO 3024-EDIT-DL7-CONT.
 11929
 11930     IF DCUA-RETURN-CODE EQUAL '03'
 11931        MOVE ER-8074               TO WS-ERROR
 11932        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 217
* EL050.cbl
 11933        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11934        GO TO 3024-EDIT-DL7-CONT.
 11935
 11936     IF DCUA-RETURN-CODE EQUAL '04'
 11937        MOVE ER-8075               TO WS-ERROR
 11938        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11939        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11940        GO TO 3024-EDIT-DL7-CONT.
 11941
 11942     IF DCUA-RETURN-CODE EQUAL '05'
 11943        MOVE ER-8076               TO WS-ERROR
 11944        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11945        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11946        GO TO 3024-EDIT-DL7-CONT.
 11947
 11948     IF DCUA-RETURN-CODE EQUAL '06'
 11949        MOVE ER-8077               TO WS-ERROR
 11950        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11951        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11952        GO TO 3024-EDIT-DL7-CONT.
 11953
 11954     IF DCUA-RETURN-CODE EQUAL '07'
 11955        MOVE ER-8078               TO WS-ERROR
 11956        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11957        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11958        GO TO 3024-EDIT-DL7-CONT.
 11959
 11960     IF DCUA-RETURN-CODE EQUAL 'E1'
 11961        MOVE ER-8079               TO WS-ERROR
 11962        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11963        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11964        GO TO 3024-EDIT-DL7-CONT.
 11965
 11966     IF DCUA-RETURN-CODE EQUAL 'E2'
 11967        MOVE ER-8080               TO WS-ERROR
 11968        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11969        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11970        GO TO 3024-EDIT-DL7-CONT.
 11971
 11972     IF DCUA-RETURN-CODE EQUAL 'E3'
 11973        MOVE ER-8098               TO WS-ERROR
 11974        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11975        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11976        GO TO 3024-EDIT-DL7-CONT.
 11977
 11978     IF DCUA-RETURN-CODE EQUAL 'C1'
 11979        MOVE ER-8099               TO WS-ERROR
 11980        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11981        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11982        GO TO 3024-EDIT-DL7-CONT.
 11983
 11984     IF DCUA-RETURN-CODE EQUAL 'U1'
 11985        MOVE ER-8109               TO WS-ERROR
 11986        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11987        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11988        GO TO 3024-EDIT-DL7-CONT.
 11989
 11990     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 218
* EL050.cbl
 11991        MOVE ER-8112               TO WS-ERROR
 11992        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11993        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11994        GO TO 3024-EDIT-DL7-CONT.
 11995
 11996     IF DCUA-RETURN-CODE EQUAL 'N2'
 11997        MOVE ER-8113               TO WS-ERROR
 11998        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11999        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12000        GO TO 3024-EDIT-DL7-CONT.
 12001
 12002     IF DCUA-RETURN-CODE EQUAL 'N3'
 12003        MOVE ER-8114               TO WS-ERROR
 12004        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12005        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12006        GO TO 3024-EDIT-DL7-CONT.
 12007
 12008     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12009     MOVE ER-8097                  TO WS-ERROR.
 12010     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12011     GO TO 3024-EDIT-DL7-CONT.
 12012
 12013 3024-EDIT-DL7-CONT.
 12014
 12015     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12016     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12017     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12018        NEXT SENTENCE
 12019     ELSE
 12020        MOVE ER-9263               TO WS-ERROR
 12021        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12022
 12023******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12024******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12025     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12026        NEXT SENTENCE
 12027     ELSE
 12028        MOVE ER-8039               TO WS-ERROR
 12029        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12030
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 219
* EL050.cbl
 12032****************************************************************
 12033*** VALIDATE STATE  : DLO022                                 ***
 12034****************************************************************
 12035     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12036     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12037
 12038     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12039     IF DVSC-SUCCESSFUL-EDIT
 12040        GO TO 3024-EDIT-DL22-CONT.
 12041
 12042     IF DVSC-RETURN-CODE EQUAL '01'
 12043        MOVE ER-8300               TO WS-ERROR
 12044        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12045        GO TO 3024-EDIT-DL22-CONT.
 12046
 12047     IF DVSC-RETURN-CODE EQUAL '02'
 12048        MOVE ER-8301               TO WS-ERROR
 12049        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12050        GO TO 3024-EDIT-DL22-CONT.
 12051
 12052     IF DVSC-RETURN-CODE EQUAL '03'
 12053        MOVE ER-8302               TO WS-ERROR
 12054        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12055        GO TO 3024-EDIT-DL22-CONT.
 12056
 12057     IF DVSC-RETURN-CODE EQUAL 'N1'
 12058        MOVE ER-8304               TO WS-ERROR
 12059        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12060        GO TO 3024-EDIT-DL22-CONT.
 12061
 12062     MOVE ER-8303                  TO WS-ERROR
 12063     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12064
 12065 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 220
* EL050.cbl
 12067****************************************************************
 12068*** VALIDATE LOAN OFFICER : DLO021                           ***
 12069****************************************************************
 12070
 12071     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12072     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12073     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12074     IF DVLO-SUCCESSFUL-EDIT
 12075        GO TO 3024-EDIT-DL21-CONT.
 12076
 12077     IF DVLO-RETURN-CODE EQUAL '01'
 12078        MOVE ER-8081               TO WS-ERROR
 12079        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12080        GO TO 3024-EDIT-DL21-CONT.
 12081
 12082     IF DVLO-RETURN-CODE EQUAL '02'
 12083        MOVE ER-8082               TO WS-ERROR
 12084        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12085        GO TO 3024-EDIT-DL21-CONT.
 12086
 12087     IF DVLO-RETURN-CODE EQUAL '03'
 12088        MOVE ER-8083               TO WS-ERROR
 12089        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12090        GO TO 3024-EDIT-DL21-CONT.
 12091
 12092     IF DVLO-RETURN-CODE EQUAL '04'
 12093        MOVE ER-8084               TO WS-ERROR
 12094        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12095        GO TO 3024-EDIT-DL21-CONT.
 12096
 12097     IF DVLO-RETURN-CODE EQUAL '05'
 12098        MOVE ER-8085               TO WS-ERROR
 12099        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12100        GO TO 3024-EDIT-DL21-CONT.
 12101
 12102     MOVE ER-7825                  TO WS-ERROR
 12103     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12104     GO TO 3024-EDIT-DL21-CONT.
 12105
 12106 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 221
* EL050.cbl
 12108
 12109****************************************************************
 12110*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12111****************************************************************
 12112
 12113     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12114     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12115     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12116     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12117     IF DIPF-SUCCESSFUL-EDIT
 12118        GO TO 3024-EDIT-DL02-CONT.
 12119
 12120     IF DIPF-RETURN-CODE EQUAL '01'
 12121        MOVE ER-8086               TO WS-ERROR
 12122        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12123        GO TO 3024-EDIT-DL02-CONT.
 12124
 12125     IF DIPF-RETURN-CODE EQUAL '02'
 12126        MOVE ER-8087               TO WS-ERROR
 12127        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12128        GO TO 3024-EDIT-DL02-CONT.
 12129
 12130     IF DIPF-RETURN-CODE EQUAL '03'
 12131        MOVE ER-8088               TO WS-ERROR
 12132        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12133        GO TO 3024-EDIT-DL02-CONT.
 12134
 12135     MOVE ER-8095                  TO WS-ERROR
 12136     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12137     GO TO 3024-EDIT-DL02-CONT.
 12138
 12139 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 222
* EL050.cbl
 12141
 12142****************************************************************
 12143*** VALIDATE BANK ID : DLO003                                ***
 12144****************************************************************
 12145
 12146     MOVE WK-GREG-CENT           TO WCG-CENT.
 12147     MOVE WK-GREG-YYMM           TO WCG-REST.
 12148     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12149        MOVE ER-8040               TO WS-ERROR
 12150        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12151
 12152     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12153     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12154     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12155     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12156     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12157     IF DVBI-SUCCESSFUL-EDIT
 12158        GO TO 3024-EDIT-DL03-CONT.
 12159
 12160     IF DVBI-RETURN-CODE EQUAL '01'
 12161        MOVE ER-8089               TO WS-ERROR
 12162        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12163        GO TO 3024-EDIT-DL03-CONT.
 12164
 12165     IF DVBI-RETURN-CODE EQUAL '02'
 12166        MOVE ER-8090               TO WS-ERROR
 12167        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12168        GO TO 3024-EDIT-DL03-CONT.
 12169
 12170     IF DVBI-RETURN-CODE EQUAL '03'
 12171        MOVE ER-8091               TO WS-ERROR
 12172        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12173        GO TO 3024-EDIT-DL03-CONT.
 12174
 12175     IF DVBI-RETURN-CODE EQUAL '04'
 12176        MOVE ER-8092               TO WS-ERROR
 12177        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12178        GO TO 3024-EDIT-DL03-CONT.
 12179
 12180     IF DVBI-RETURN-CODE EQUAL '05'
 12181        MOVE ER-8093               TO WS-ERROR
 12182        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12183        GO TO 3024-EDIT-DL03-CONT.
 12184
 12185     IF DVBI-RETURN-CODE EQUAL '06'
 12186        MOVE ER-8094               TO WS-ERROR
 12187        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12188        GO TO 3024-EDIT-DL03-CONT.
 12189
 12190     MOVE ER-8096                  TO WS-ERROR
 12191     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12192     GO TO 3024-EDIT-DL03-CONT.
 12193
 12194 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 223
* EL050.cbl
 12196
 12197     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12198        NEXT SENTENCE
 12199     ELSE
 12200        MOVE ER-8042               TO WS-ERROR
 12201        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12202
 12203     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12204     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12205     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12206
 12207     IF DMPF-RETURN-CODE = '01'
 12208        MOVE ER-8067               TO WS-ERROR
 12209        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12210        GO TO 3024-EDIT-DL01-CONT.
 12211
 12212     IF DMPF-RETURN-CODE = '02'
 12213        MOVE ER-8068               TO WS-ERROR
 12214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12215        GO TO 3024-EDIT-DL01-CONT.
 12216
 12217     IF DMPF-RETURN-CODE = '03'
 12218        MOVE ER-8069               TO WS-ERROR
 12219        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12220        GO TO 3024-EDIT-DL01-CONT.
 12221
 12222     IF DMPF-RETURN-CODE = 'E1'
 12223        MOVE ER-8070               TO WS-ERROR
 12224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12225        GO TO 3024-EDIT-DL01-CONT.
 12226
 12227     IF DMPF-RETURN-CODE = 'N1'
 12228        MOVE ER-8071               TO WS-ERROR
 12229        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12230        GO TO 3024-EDIT-DL01-CONT.
 12231
 12232     IF DMPF-RETURN-CODE NOT = 'OK'
 12233        MOVE ER-8072               TO WS-ERROR
 12234        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12235
 12236 3024-EDIT-DL01-CONT.
 12237******************************************************************
 12238***  VALIDATES RATE CODES : DLO017                             ***
 12239******************************************************************
 12240
 12241      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12242      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12243      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12244      IF DVRC-SUCCESSFUL-EDIT
 12245        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12246        GO TO 3024-CHECK-VALID-RATE.
 12247
 12248      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12249
 12250      IF DVRC-RETURN-CODE EQUAL '01'
 12251         MOVE ER-7817                   TO WS-ERROR
 12252         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12253         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 224
* EL050.cbl
 12254
 12255      IF DVRC-RETURN-CODE EQUAL '02'
 12256         MOVE ER-7818                   TO WS-ERROR
 12257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12258         GO TO 3025-EDIT-REINSURANCE.
 12259
 12260      IF DVRC-RETURN-CODE EQUAL '03'
 12261         MOVE ER-7819                   TO WS-ERROR
 12262         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12263         GO TO 3025-EDIT-REINSURANCE.
 12264
 12265       MOVE ER-7820                     TO WS-ERROR.
 12266       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12267       GO TO 3025-EDIT-REINSURANCE.
 12268
 12269******************************************************************
 12270***  GET PREMIUM RATES : DLO011                                ***
 12271******************************************************************
 12272
 12273 3024-CHECK-VALID-RATE.
 12274
 12275     IF VALID-RATE-CODE
 12276        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12277        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12278        MOVE SPACES                TO DPRB-RETURN-CODE
 12279        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12280     ELSE
 12281         GO TO 3025-EDIT-REINSURANCE.
 12282
 12283      IF DPRB-SUCCESSFUL-PROCESS
 12284         IF PB-VALID-LIFE
 12285             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12286             GO TO 3025-EDIT-REINSURANCE
 12287         ELSE
 12288             IF PB-VALID-AH
 12289                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12290                 GO TO 3025-EDIT-REINSURANCE.
 12291
 12292      IF DPRB-RETURN-CODE EQUAL '01'
 12293         MOVE ER-7812                   TO WS-ERROR
 12294         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12295         GO TO 3025-EDIT-REINSURANCE.
 12296
 12297      IF DPRB-RETURN-CODE EQUAL '02'
 12298         MOVE ER-7813                   TO WS-ERROR
 12299         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12300         GO TO 3025-EDIT-REINSURANCE.
 12301
 12302      IF DPRB-RETURN-CODE EQUAL '03'
 12303         MOVE ER-7814                   TO WS-ERROR
 12304         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12305         GO TO 3025-EDIT-REINSURANCE.
 12306
 12307      IF DPRB-RETURN-CODE EQUAL '04'
 12308         IF NOT DPRB-1ST-TIME
 12309            MOVE ER-7815                   TO WS-ERROR
 12310            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12311            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 225
* EL050.cbl
 12312          ELSE
 12313         IF PB-VALID-LIFE
 12314            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12315          ELSE
 12316            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12317         END-IF
 12318         MOVE SPACES                TO DOCC-RETURN-CODE
 12319         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12320         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12321         IF DOCC-RETURN-CODE = 'OK'
 12322             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12323             GO TO 3024-CHECK-VALID-RATE
 12324           ELSE
 12325             MOVE ER-7823               TO WS-ERROR
 12326             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12327             GO TO 3025-EDIT-REINSURANCE.
 12328
 12329       MOVE ER-7816                     TO WS-ERROR.
 12330       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12331       GO TO 3025-EDIT-REINSURANCE.
 12332
 12333**********   DMD CUSTOM CODE ABOVE    **********
 12334
 12335 3025-EDIT-REINSURANCE.
 12336     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12337         GO TO 3027-EDIT-CONTINUE.
 12338
 12339     MOVE LOW-VALUES               TO ERREIN-KEY.
 12340     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12341     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12342                                      REIN-CODE-2
 12343                                      REIN-CODE-3.
 12344     MOVE 'A'                      TO REIN-TYPE.
 12345
 12346     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12347
 12348     MOVE '3026' TO REIN-SW.
 12349     MOVE ' '                   TO WS-REIN-READ-SW.
 12350
 12351     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12352     IF REIN-TABLE-NOT-FOUND
 12353         GO TO 3026-NO-SPEC-TABLE.
 12354
 12355     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12356     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12357                                   WS-NSP-ST-CD-LF.
 12358     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12359                                   WS-NSP-ST-CD-AH.
 12360
 12361     GO TO 3040-EDIT-CONTINUE.
 12362
 12363 3026-NO-SPEC-TABLE.
 12364
 12365     MOVE ER-2664                TO WS-ERROR.
 12366     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12367     GO TO 3040-EDIT-CONTINUE.
 12368
 12369 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 226
* EL050.cbl
 12370
 12371     IF PB-I-REIN-TABLE = SPACES
 12372       GO TO 3040-EDIT-CONTINUE.
 12373
 12374     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12375          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12376          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12377           GO TO 3040-EDIT-CONTINUE.
 12378
 12379     MOVE LOW-VALUES            TO ERREIN-KEY.
 12380     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12381     MOVE 'A'                   TO REIN-TYPE.
 12382     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12383
 12384     MOVE '3028'                TO REIN-SW.
 12385     MOVE ' '                   TO WS-REIN-READ-SW.
 12386
 12387     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12388     IF REIN-TABLE-NOT-FOUND
 12389         GO TO 3028-NO-REIN-TABLE.
 12390
 12391     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12392     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12393                                   WS-NSP-ST-CD-LF.
 12394     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12395                                   WS-NSP-ST-CD-AH.
 12396
 12397     GO TO 3040-EDIT-CONTINUE.
 12398
 12399 3028-NO-REIN-TABLE.
 12400
 12401     MOVE ER-2615                TO WS-ERROR.
 12402     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12403     GO TO 3040-EDIT-CONTINUE.
 12404
 12405 3040-EDIT-CONTINUE.
 12406
 12407     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12408         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12409
 12410     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12411         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12412
 12413     IF (NOT PB-REISSUED-CERT)
 12414        AND (NOT PB-MONTHLY-CERT)
 12415        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12416            MOVE '001'           TO PB-I-LF-TERM
 12417            MOVE 'M'             TO PB-I-INSURED-SEX.
 12418
 12419     IF (NOT PB-REISSUED-CERT)
 12420        AND (NOT PB-MONTHLY-CERT)
 12421        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12422            MOVE '001'           TO PB-I-AH-TERM
 12423            MOVE 'M'             TO PB-I-INSURED-SEX.
 12424
 12425 3040-EDIT-1ST-PMT-DT.
 12426     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12427     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 227
* EL050.cbl
 12428         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12429
 12430******************************************************************
 12431*                                                                *
 12432*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12433*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12434*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12435*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12436*                                                                *
 12437******************************************************************
 12438
 12439     IF PB-EFF-DT-PROCESSING
 12440        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12441                                    PB-I-LF-EXPIRE-DT
 12442                                    PB-I-AH-EXPIRE-DT
 12443        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12444        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12445        MOVE ZERO                TO DC-ELAPSED-DAYS
 12446        MOVE +1                  TO DC-ELAPSED-MONTHS
 12447        SET BIN-PLUS-ELAPSED     TO TRUE
 12448*       MOVE 6                   TO DC-OPTION-CODE
 12449        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12450        IF NO-CONVERSION-ERROR
 12451           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12452
 12453******************************************************************
 12454*                                                                *
 12455*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12456*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12457*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12458*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12459*                                                                *
 12460******************************************************************
 12461
 12462     IF PB-EXT-DAYS-PROCESSING
 12463          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12464                                         PB-I-LF-EXPIRE-DT
 12465                                         PB-I-AH-EXPIRE-DT
 12466          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12467          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12468          MOVE +1                     TO DC-ELAPSED-MONTHS
 12469          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12470          SET BIN-PLUS-ELAPSED        TO TRUE
 12471*         MOVE 6                      TO DC-OPTION-CODE
 12472          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12473          IF NO-CONVERSION-ERROR
 12474             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12475
 12476******************************************************************
 12477*                                                                *
 12478*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12479*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12480*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12481*        (EXPIRE DATE - (TERM -1))  *  -1.
 12482*                                                                *
 12483******************************************************************
 12484
 12485     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 228
* EL050.cbl
 12486        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12487           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12488              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12489              MOVE PB-I-AH-TERM      TO WS-TERM
 12490           ELSE
 12491              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12492              MOVE PB-I-LF-TERM      TO WS-TERM
 12493        ELSE
 12494           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12495              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12496              MOVE PB-I-LF-TERM      TO WS-TERM
 12497           ELSE
 12498              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12499              MOVE PB-I-AH-TERM      TO WS-TERM.
 12500
 12501     IF PB-EXPIRE-DT-PROCESSING
 12502        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12503        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12504        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12505        MOVE ZERO                TO DC-ELAPSED-DAYS
 12506                                    DC-ODD-DAYS-OVER
 12507          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12508          SET BIN-PLUS-ELAPSED    TO TRUE
 12509*         MOVE 6                  TO DC-OPTION-CODE
 12510          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12511          IF NO-CONVERSION-ERROR
 12512             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12513
 12514******************************************************************
 12515*                                                                *
 12516*            1ST PAYMENT DATE PROCESSING                         *
 12517*                                                                *
 12518******************************************************************
 12519
 12520     IF PB-1ST-PMT-DT-PROCESSING
 12521        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12522                                    PB-I-AH-EXPIRE-DT
 12523        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12524
 12525     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12526         NEXT SENTENCE
 12527     ELSE
 12528         MOVE ER-2680                 TO WS-ERROR
 12529         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12530         GO TO 3060-ORIG-TERM-CHECK.
 12531
 12532     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12533     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12534     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12535*    MOVE 1                      TO DC-OPTION-CODE.
 12536     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12537                                    DC-ELAPSED-DAYS
 12538                                    DC-ODD-DAYS-OVER.
 12539
 12540     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12541
 12542     IF DATE-CONVERSION-ERROR
 12543        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 229
* EL050.cbl
 12544
 12545     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12546     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12547        AND (WS-LF-COVERAGE-TYPE = 'L')
 12548        IF (DC-ELAPSED-MONTHS > 1)
 12549                      OR
 12550           ((DC-ELAPSED-MONTHS = 1)
 12551           AND (DC-ODD-DAYS-OVER > 0))
 12552           MOVE ER-2882          TO WS-ERROR
 12553           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12554        END-IF
 12555     END-IF
 12556     if dc-elapsed-months > 0
 12557        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12558        + dc-odd-days-over
 12559     end-if
 12560     IF PB-EXT-DAYS-PROCESSING
 12561        CONTINUE
 12562     ELSE
 12563        IF DC-ELAPSED-MONTHS = +0
 12564           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12565        ELSE
 12566           IF (WS-LF-EARNINGS-CALC = '4')
 12567              AND (DC-ELAPSED-MONTHS > ZERO)
 12568              AND (DC-ELAPSED-DAYS > ZERO)
 12569              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12570           ELSE
 12571              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12572                                 THRU 6499-EXIT
 12573              MOVE WS-ODD-DAYS-OVER
 12574                                 TO PB-I-EXTENTION-DAYS
 12575           END-IF
 12576        END-IF
 12577     END-IF
 12578******************************************************************
 12579*                                                                *
 12580*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12581*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12582*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12583*            AND ANY ODD DAYS.                                   *
 12584*                                                                *
 12585******************************************************************
 12586
 12587     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12588                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12589     IF WS-LF-EARNINGS-CALC NOT = '4'
 12590        IF DC-ELAPSED-DAYS > ZEROS
 12591           MOVE ER-2681          TO WS-ERROR
 12592           PERFORM 9900-ERROR-FORMAT
 12593                                 THRU 9900-EXIT
 12594        END-IF
 12595     END-IF
 12596
 12597     IF WS-LF-EARNINGS-CALC NOT = '4'
 12598        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12599           MOVE ER-2681          TO WS-ERROR
 12600           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12601
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 230
* EL050.cbl
 12602     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12603        (PB-I-LF-TERM NOT = ZERO) AND
 12604         NOT NO-LIFE-COVERAGE
 12605          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12606          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12607          IF WS-LF-EARNINGS-CALC = '4'
 12608             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12609             PB-I-PAY-FREQUENCY
 12610          END-IF
 12611          MOVE ZERO              TO DC-ELAPSED-DAYS
 12612                                    DC-ODD-DAYS-OVER
 12613          MOVE 1                 TO DC-END-OF-MONTH
 12614          SET BIN-PLUS-ELAPSED        TO TRUE
 12615*         MOVE 6                 TO DC-OPTION-CODE
 12616          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12617          IF NO-CONVERSION-ERROR
 12618             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12619             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12620                (WS-LF-SPECIAL-CALC-CD = 'L')
 12621                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12622                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12623                  MOVE +1             TO DC-ELAPSED-MONTHS
 12624                  SET BIN-PLUS-ELAPSED  TO TRUE
 12625*                 MOVE 6              TO DC-OPTION-CODE
 12626                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12627                  IF NO-CONVERSION-ERROR
 12628                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12629
 12630* okay, i had to move the new att age edit down here because the
 12631* expiration date could get recalculated and i need the exp date
 12632     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12633        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12634        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12635        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12636           AND ZEROS
 12637           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12638           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12639           SET ELAPSED-BETWEEN-BIN TO TRUE
 12640           PERFORM 8500-DATE-CONVERT
 12641                                 THRU 8500-EXIT
 12642           IF NO-CONVERSION-ERROR
 12643              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12644                 MOVE ER-2669       TO WS-ERROR
 12645*                PERFORM 9900-ERROR-FORMAT
 12646*                                THRU 9900-EXIT
 12647              END-IF
 12648           END-IF
 12649        ELSE
 12650           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12651           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12652              MOVE ER-2669       TO WS-ERROR
 12653*             PERFORM 9900-ERROR-FORMAT
 12654*                                THRU 9900-EXIT
 12655           ELSE
 12656              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12657                 MOVE ER-1570    TO WS-ERROR
 12658                 PERFORM 9900-ERROR-FORMAT
 12659                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 231
* EL050.cbl
 12660              END-IF
 12661           END-IF
 12662        END-IF
 12663        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12664           AND ZEROS
 12665           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12666           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12667           SET ELAPSED-BETWEEN-BIN TO TRUE
 12668           PERFORM 8500-DATE-CONVERT
 12669                                 THRU 8500-EXIT
 12670           IF NO-CONVERSION-ERROR
 12671              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12672                 MOVE ER-2669       TO WS-ERROR
 12673*                PERFORM 9900-ERROR-FORMAT
 12674*                                THRU 9900-EXIT
 12675              END-IF
 12676           END-IF
 12677        ELSE
 12678           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12679             (PB-I-LF-TERM / 12)
 12680           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12681              MOVE ER-2669       TO WS-ERROR
 12682*             PERFORM 9900-ERROR-FORMAT
 12683*                                THRU 9900-EXIT
 12684           ELSE
 12685              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12686                 MOVE ER-1571    TO WS-ERROR
 12687                 PERFORM 9900-ERROR-FORMAT
 12688                                 THRU 9900-EXIT
 12689              END-IF
 12690           END-IF
 12691        END-IF
 12692        IF WS-ERROR = ER-2669
 12693           PERFORM 9900-ERROR-FORMAT
 12694                                 THRU 9900-EXIT
 12695        END-IF
 12696     END-IF
 12697     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12698        (PB-I-AH-TERM NOT = ZERO) AND
 12699         NOT NO-AH-COVERAGE
 12700          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12701             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12702             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12703             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12704          ELSE
 12705             IF WS-LF-EARNINGS-CALC = '4'
 12706                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12707                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12708                PB-I-PAY-FREQUENCY
 12709             ELSE
 12710                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12711                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12712             END-IF
 12713          END-IF
 12714          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12715                                         DC-ODD-DAYS-OVER
 12716          MOVE 1                      TO DC-END-OF-MONTH
 12717          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 232
* EL050.cbl
 12718*         MOVE 6                      TO DC-OPTION-CODE
 12719          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12720          IF NO-CONVERSION-ERROR
 12721             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12722     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12723        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12724        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12725        IF PB-I-BIRTHDAY > LOW-VALUES
 12726           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12727           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12728           SET ELAPSED-BETWEEN-BIN TO TRUE
 12729           PERFORM 8500-DATE-CONVERT
 12730                                 THRU 8500-EXIT
 12731           IF NO-CONVERSION-ERROR
 12732              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12733                 MOVE ER-3054       TO WS-ERROR
 12734*                PERFORM 9900-ERROR-FORMAT
 12735*                                THRU 9900-EXIT
 12736              END-IF
 12737           END-IF
 12738        ELSE
 12739           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12740           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12741              MOVE ER-3054       TO WS-ERROR
 12742*             PERFORM 9900-ERROR-FORMAT
 12743*                                THRU 9900-EXIT
 12744           END-IF
 12745        END-IF
 12746        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12747           AND ZEROS
 12748           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12749           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12750           SET ELAPSED-BETWEEN-BIN TO TRUE
 12751           PERFORM 8500-DATE-CONVERT
 12752                                 THRU 8500-EXIT
 12753           IF NO-CONVERSION-ERROR
 12754              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12755                 MOVE ER-3054       TO WS-ERROR
 12756*                PERFORM 9900-ERROR-FORMAT
 12757*                                THRU 9900-EXIT
 12758              END-IF
 12759           END-IF
 12760        ELSE
 12761           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12762             (PB-I-AH-TERM / 12)
 12763           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12764              MOVE ER-3054       TO WS-ERROR
 12765*             PERFORM 9900-ERROR-FORMAT
 12766*                                THRU 9900-EXIT
 12767           END-IF
 12768        END-IF
 12769        IF WS-ERROR = ER-3054
 12770           PERFORM 9900-ERROR-FORMAT
 12771                                 THRU 9900-EXIT
 12772        END-IF
 12773     END-IF
 12774     MOVE SPACE                       TO DC-END-OF-MONTH.
 12775
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 233
* EL050.cbl
 12776     IF PB-COMPANY-ID = 'NCB'
 12777        GO TO 3040-EDIT-EXTENSION-DAYS.
 12778
 12779     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12780       AND
 12781        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12782        NEXT SENTENCE
 12783     ELSE
 12784        GO TO 3040-EDIT-EXTENSION-DAYS.
 12785
 12786     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12787        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12788        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12789     ELSE
 12790        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12791        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12792
 12793     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12794*    MOVE '1'      TO DC-OPTION-CODE
 12795     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12796     IF (NO-CONVERSION-ERROR)
 12797        AND (DC-ELAPSED-MONTHS > +1)
 12798        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12799        MOVE ER-2668   TO WS-ERROR
 12800        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12801
 12802 3040-EDIT-EXTENSION-DAYS.
 12803
 12804     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12805        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12806         GO TO 3050-EDIT-TERM-IN-DAYS
 12807     ELSE
 12808         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12809
 12810     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12811         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12812     ELSE
 12813        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12814           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12815           MOVE ER-2681         TO WS-ERROR
 12816           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12817
 12818     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12819        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12820        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12821         GO TO 3060-ORIG-TERM-CHECK.
 12822
 12823     GO TO 3060-ORIG-TERM-CHECK.
 12824
 12825 3050-EDIT-TERM-IN-DAYS.
 12826
 12827     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12828
 12829     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12830         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12831     ELSE
 12832         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12833            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 234
* EL050.cbl
 12834            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12835
 12836     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12837                                       REMAINDER WS-WORK-TERM.
 12838     IF WS-WORK-TERM GREATER THAN ZERO
 12839         ADD +1 TO PB-I-LF-TERM.
 12840
 12841     IF NOT NO-AH-COVERAGE
 12842         MOVE ER-2684            TO WS-ERROR
 12843         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12844
 12845
 12846 3060-ORIG-TERM-CHECK.
 12847
 12848******************************************************************
 12849*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12850******************************************************************
 12851
 12852     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12853        NEXT SENTENCE
 12854     ELSE
 12855        IF NOT NO-LIFE-COVERAGE
 12856           IF PB-I-LF-TERM NUMERIC
 12857              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12858              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12859              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12860                  NEXT SENTENCE
 12861           ELSE
 12862              MOVE ER-2647       TO WS-ERROR
 12863              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12864
 12865     IF NOT NO-AH-COVERAGE
 12866         IF PB-I-AH-TERM NUMERIC
 12867            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12868            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12869            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12870             NEXT SENTENCE
 12871          ELSE
 12872              MOVE ER-2658       TO WS-ERROR
 12873              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12874
 12875     IF PB-COMPANY-ID = 'NCB'
 12876        GO TO 3070-LOAN-TERM-CHECK.
 12877
 12878     IF POLICY-HAS-AH
 12879       AND
 12880        POLICY-HAS-LIFE
 12881       AND
 12882        PB-I-LF-TERM NUMERIC
 12883       AND
 12884        PB-I-AH-TERM NUMERIC
 12885        NEXT SENTENCE
 12886     ELSE
 12887        GO TO 3070-LOAN-TERM-CHECK.
 12888
 12889     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12890     IF WS-TEX-FACT-2 LESS THAN +0
 12891        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 235
* EL050.cbl
 12892
 12893     IF WS-TEX-FACT-2 GREATER THAN +1
 12894        MOVE ER-2668             TO WS-ERROR
 12895        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12896
 12897 3070-LOAN-TERM-CHECK.
 12898
 12899     IF (WS-LF-BENEFIT-CD = ZERO)
 12900         OR (NO-LF-BENEFIT-MATCH)
 12901            GO TO 3125-EDIT-PMT-FREQ.
 12902*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12903*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12904*          AND 'V' AND 'W' AND 'X'
 12905*          GO TO 3125-EDIT-PMT-FREQ
 12906*       END-IF
 12907*    ELSE
 12908*       IF WS-AH-DCC-TRUNC = 'T'
 12909*          CONTINUE
 12910*       ELSE
 12911*          GO TO 3125-EDIT-PMT-FREQ
 12912*       END-IF
 12913*    END-IF
 12914     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12915                    OR
 12916        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12917        AND (WS-AH-DCC-TRUNC = 'T'))
 12918        CONTINUE
 12919     ELSE
 12920        GO TO 3125-EDIT-PMT-FREQ
 12921     END-IF
 12922     IF PB-I-LOAN-TERM NOT NUMERIC
 12923         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12924
 12925     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12926        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12927*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12928        PB-I-LOAN-TERM NOT GREATER THAN +360
 12929         NEXT SENTENCE
 12930     ELSE
 12931         MOVE ER-2648            TO WS-ERROR
 12932         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12933
 12934     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12935        MOVE ER-3058             TO WS-ERROR
 12936        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12937     end-if
 12938
 12939     IF WS-STATE-ABBREVIATION = 'NC'
 12940        IF PB-I-LOAN-TERM > +59
 12941           CONTINUE
 12942        ELSE
 12943           MOVE ER-2792          TO WS-ERROR
 12944           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12945        END-IF
 12946     END-IF
 12947
 12948     .
 12949 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 236
* EL050.cbl
 12950     IF (WS-LF-BENEFIT-CD = ZERO)
 12951         OR (NO-LF-BENEFIT-MATCH)
 12952            GO TO 3127-EDIT-LOAN-OFFICER.
 12953     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12954                    OR
 12955        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12956        AND (WS-AH-DCC-TRUNC = 'T'))
 12957                    OR
 12958         (PB-COMPANY-ID = 'AHL')
 12959        CONTINUE
 12960     ELSE
 12961        IF (PB-I-LOAN-TERM > ZEROS)
 12962           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12963           MOVE ER-1575          TO WS-ERROR
 12964           PERFORM 9900-ERROR-FORMAT
 12965                                 THRU 9900-EXIT
 12966        END-IF
 12967     END-IF
 12968     IF WS-LF-EARNINGS-CALC NOT = '4'
 12969         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12970            MOVE ER-2653         TO WS-ERROR
 12971            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12972            GO TO 3127-EDIT-LOAN-OFFICER
 12973         ELSE
 12974            GO TO 3127-EDIT-LOAN-OFFICER.
 12975
 12976     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12977         MOVE ER-2655            TO WS-ERROR
 12978         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12979         GO TO 3127-EDIT-LOAN-OFFICER.
 12980
 12981     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12982         MOVE ER-2654            TO WS-ERROR
 12983         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12984         GO TO 3127-EDIT-LOAN-OFFICER.
 12985
 12986     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12987         GIVING WS-TEX-FACT-2
 12988             REMAINDER WS-TEX-FACT-3.
 12989
 12990*    IF WS-TEX-FACT-3 NOT = ZERO
 12991*       MOVE ER-2654             TO WS-ERROR
 12992*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12993
 12994
 12995 3127-EDIT-LOAN-OFFICER.
 12996
 12997     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12998        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12999           MOVE ER-2690          TO WS-ERROR
 13000           PERFORM 9900-ERROR-FORMAT
 13001                                 THRU 9900-EXIT
 13002        ELSE
 13003           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13004           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13005           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13006           MOVE PB-SV-STATE      TO LOFC-STATE
 13007           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 237
* EL050.cbl
 13008           MOVE PB-I-LOAN-OFFICER
 13009                                 TO LOFC-CODE
 13010           PERFORM 8586-READ-LOAN-OFFICER
 13011                                 THRU 8586-EXIT
 13012           IF (NOT LOFC-MASTER-FOUND)
 13013              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13014              MOVE ER-3006       TO WS-ERROR
 13015              PERFORM 9900-ERROR-FORMAT
 13016                                 THRU 9900-EXIT
 13017           END-IF
 13018        END-IF
 13019     END-IF
 13020     .
 13021 3129-EDIT-APR.
 13022
 13023     IF (WS-LF-BENEFIT-CD = ZERO)
 13024        OR (NO-LF-BENEFIT-MATCH)
 13025        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13026           GO TO 3130-EDIT-AGE
 13027*       ELSE
 13028*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13029*             GO TO 3130-EDIT-AGE
 13030*          END-IF
 13031        END-IF
 13032     END-IF
 13033
 13034     IF (WS-STATE-ABBREVIATION = 'OH')
 13035         AND (PB-I-RATE-CLASS NOT = 'L ')
 13036         AND (PB-I-LF-TERM GREATER THAN 60)
 13037         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13038         GO TO 3129-APR-CONT.
 13039
 13040     IF (WS-STATE-ABBREVIATION = 'RI')
 13041         AND (PB-I-LF-TERM GREATER THAN 60)
 13042         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13043         GO TO 3129-APR-CONT.
 13044
 13045     IF (WS-STATE-ABBREVIATION = 'UT')
 13046         AND (PB-I-LF-TERM GREATER THAN 62)
 13047         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13048         AND (PB-CERT-EFF-DT LESS WS-830901)
 13049         GO TO 3129-APR-CONT.
 13050
 13051     IF PB-COMPANY-ID = 'LAP'
 13052        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13053           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13054              MOVE ER-2656         TO WS-ERROR
 13055              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13056              GO TO 3130-EDIT-AGE.
 13057
 13058     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13059        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13060        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13061        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13062        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13063        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13064         GO TO 3130-EDIT-AGE.
 13065
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 238
* EL050.cbl
 13066 3129-APR-CONT.
 13067     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13068         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13069         GO TO 3130-EDIT-AGE.
 13070
 13071     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13072         WS-AH-BENEFIT-CD (1:1) = 'S')
 13073        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13074        AND (PB-I-LOAN-APR = ZERO)
 13075        MOVE ER-2657             TO WS-ERROR
 13076        PERFORM 9900-ERROR-FORMAT
 13077                                 THRU 9900-EXIT
 13078        GO TO 3130-EDIT-AGE
 13079     END-IF
 13080*    IF PB-I-LOAN-APR = ZERO
 13081*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13082*    END-IF
 13083
 13084     if pb-i-loan-apr = +99.9999
 13085        move er-2656             to ws-error
 13086        PERFORM 9900-ERROR-FORMAT
 13087                                 THRU 9900-EXIT
 13088        GO TO 3130-EDIT-AGE
 13089     end-if
 13090*    IF PB-I-LOAN-APR = ZERO
 13091*       MOVE ER-2656             TO WS-ERROR
 13092*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13093*       GO TO 3130-EDIT-AGE.
 13094
 13095*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13096     if pb-i-loan-apr not = +99.9999
 13097        IF PB-I-LOAN-APR > +30.000
 13098           MOVE ER-2657          TO WS-ERROR
 13099           PERFORM 9900-ERROR-FORMAT
 13100                                 THRU 9900-EXIT
 13101        end-if
 13102     end-if
 13103     .
 13104 3130-EDIT-AGE.
 13105
 13106******************************************************************
 13107*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13108******************************************************************
 13109
 13110     IF NOT NO-LIFE-COVERAGE
 13111        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13112           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13113               MOVE ER-2628             TO WS-ERROR
 13114               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13115
 13116     IF NOT NO-AH-COVERAGE
 13117        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13118           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13119               MOVE ER-2628         TO WS-ERROR
 13120               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13121
 13122 3133-SEX-CODE.
 13123     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 239
* EL050.cbl
 13124         IF WS-DEFAULT-SEX = 'M'
 13125             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13126          ELSE
 13127             IF WS-DEFAULT-SEX = 'F'
 13128             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13129
 13130     IF PB-I-INSURED-SEX = '1'
 13131         MOVE 'M' TO PB-I-INSURED-SEX.
 13132
 13133     IF PB-I-INSURED-SEX = '2'
 13134         MOVE 'F' TO PB-I-INSURED-SEX.
 13135
 13136 3134-SIG-SW-EDIT.
 13137     IF PB-I-SIG-SW = SPACE
 13138         MOVE 'N'                TO  PB-I-SIG-SW.
 13139
 13140     IF PB-COMPANY-ID = 'NCL'
 13141         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13142             NEXT SENTENCE
 13143         ELSE
 13144             MOVE ER-1923        TO  WS-ERROR
 13145             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13146     ELSE
 13147     IF PB-COMPANY-ID = 'CRI'
 13148         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13149             NEXT SENTENCE
 13150         ELSE
 13151             MOVE ER-2606        TO  WS-ERROR
 13152             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13153     ELSE
 13154     IF PB-COMPANY-ID = 'TMS'
 13155         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13156             NEXT SENTENCE
 13157         ELSE
 13158             MOVE ER-2689        TO  WS-ERROR
 13159             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13160     ELSE
 13161         IF PB-I-SIG-SW = 'Y' OR 'N'
 13162             NEXT SENTENCE
 13163         ELSE
 13164             MOVE ER-2651        TO  WS-ERROR
 13165             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13166
 13167     IF PB-COMPANY-ID = 'FLA'
 13168         IF (WS-EDIT-AGE GREATER 54  OR
 13169             WS-AH-EDIT-AGE GREATER 54)  AND
 13170            PB-I-SIG-SW = 'N'
 13171            MOVE ER-2651         TO  WS-ERROR
 13172            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13173
 13174 3135-NAME-EDIT.
 13175
 13176     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13177        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13178        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13179           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13180                                 TO PB-I-JOINT-FIRST-NAME
 13181        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 240
* EL050.cbl
 13182     END-IF
 13183     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13184        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13185        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13186           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13187                                 TO PB-I-JOINT-LAST-NAME
 13188        END-PERFORM
 13189     END-IF
 13190     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13191        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13192        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13193           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13194                                 TO PB-I-INSURED-FIRST-NAME
 13195        END-PERFORM
 13196     END-IF
 13197     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13198        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13199        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13200           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13201                                 TO PB-I-INSURED-LAST-NAME
 13202        END-PERFORM
 13203     END-IF
 13204     IF PB-I-INSURED-LAST-NAME = SPACES
 13205       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13206       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13207           MOVE ER-2660    TO WS-ERROR
 13208           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13209
 13210 3136-EDIT-SEX.
 13211
 13212******************************************************************
 13213*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13214******************************************************************
 13215
 13216     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13217        (WS-AH-SPECIAL-CALC-CD = 'O')
 13218        NEXT SENTENCE
 13219     ELSE
 13220        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13221           NEXT SENTENCE
 13222        ELSE
 13223           MOVE ER-2629            TO WS-ERROR
 13224           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13225
 13226 3137-EDIT-EFF-DATE.
 13227
 13228     IF PB-REISSUED-CERT       OR
 13229        PB-POLICY-IS-DECLINED  OR
 13230        PB-POLICY-IS-VOIDED
 13231         GO TO 3139-EDIT-COVERAGE-CODES.
 13232
 13233     MOVE SPACE                  TO WS-2671-SW
 13234                                    WS-2672-SW.
 13235
 13236     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13237         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13238             MOVE ER-2703        TO WS-ERROR
 13239             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 241
* EL050.cbl
 13240             GO TO 3139-EDIT-COVERAGE-CODES.
 13241
 13242     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13243         GO TO 3139-EDIT-COVERAGE-CODES.
 13244
 13245     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13246     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13247*    MOVE '1'                    TO DC-OPTION-CODE.
 13248     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13249     MOVE +0                     TO DC-ELAPSED-MONTHS
 13250                                    DC-ELAPSED-DAYS.
 13251     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13252
 13253     IF DATE-CONVERSION-ERROR
 13254         GO TO 3139-EDIT-COVERAGE-CODES.
 13255
 13256     IF DC-ELAPSED-DAYS GREATER +180
 13257         MOVE ER-2672            TO WS-ERROR
 13258         MOVE 'Y'                TO WS-2672-SW
 13259         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13260     END-IF
 13261
 13262     IF WS-ERROR = ER-2671  AND
 13263        PB-COMPANY-ID  = 'LBL'
 13264        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13265        MOVE SPACE               TO WS-2671-SW
 13266        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13267
 13268     IF PB-ISSUE-DATE-FORCED  AND
 13269      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13270         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13271         MOVE ER-2673            TO WS-ERROR
 13272         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13273         MOVE SPACE              TO WS-2671-SW
 13274                                    WS-2672-SW.
 13275
 13276     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13277         IF PB-ISSUE-DATE-FORCED
 13278             MOVE ER-2600          TO  WS-ERROR
 13279             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13280         ELSE
 13281             MOVE ER-2692          TO  WS-ERROR
 13282             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13283
 13284
 13285 3139-EDIT-COVERAGE-CODES.
 13286
 13287     if pb-company-id not = 'AHL'
 13288        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13289           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13290           MOVE ER-2787          TO WS-ERROR
 13291           PERFORM 9900-ERROR-FORMAT
 13292                                 THRU 9900-EXIT
 13293        END-IF
 13294     end-if
 13295     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13296        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13297                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 242
* EL050.cbl
 13298           MOVE ER-2719          TO WS-ERROR
 13299           PERFORM 9900-ERROR-FORMAT
 13300                                 THRU 9900-EXIT
 13301        END-IF
 13302     END-IF
 13303
 13304     IF PB-POLICY-IS-DECLINED  OR
 13305        PB-POLICY-IS-VOIDED
 13306         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13307
 13308     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13309        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13310         MOVE ER-2630                TO WS-ERROR
 13311         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13312
 13313     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13314        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13315        PB-I-LF-PREMIUM-AMT = ZERO
 13316         GO TO 3140-CHECK-AH-FOR-ZERO.
 13317
 13318     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13319        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13320        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13321         GO TO 3140-CHECK-AH-FOR-ZERO.
 13322
 13323     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13324        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13325        MOVE ER-2631             TO WS-ERROR
 13326        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13327     END-IF
 13328
 13329
 13330******************************************************************
 13331*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13332******************************************************************
 13333
 13334     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13335        NEXT SENTENCE
 13336     ELSE
 13337        IF PB-I-LF-BENEFIT-AMT = ZERO
 13338           MOVE ER-2632             TO WS-ERROR
 13339           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13340
 13341
 13342******************************************************************
 13343*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13344******************************************************************
 13345
 13346     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13347        CONTINUE
 13348     ELSE
 13349        IF PB-I-LF-PREMIUM-AMT = ZERO
 13350           IF (NOT PB-COMP-LF-PREM)
 13351              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13352              and (ws-lf-ben-category not = 'C')
 13353              MOVE ER-2633       TO WS-ERROR
 13354              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13355           END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 243
* EL050.cbl
 13356        END-IF
 13357     END-IF
 13358     .
 13359 3140-CHECK-AH-FOR-ZERO.
 13360
 13361     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13362        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13363        PB-I-AH-PREMIUM-AMT = ZERO
 13364         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13365
 13366     IF PB-COMPANY-ID = 'CSL'  AND
 13367        PB-I-AH-BENEFIT-CD = ZERO  AND
 13368        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13369        PB-I-AH-PREMIUM-AMT = ZERO
 13370         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13371
 13372     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13373        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13374        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13375         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13376
 13377     IF PB-I-AH-BENEFIT-CD = ZERO
 13378         MOVE ER-2634            TO WS-ERROR
 13379         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13380
 13381******************************************************************
 13382*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13383******************************************************************
 13384
 13385     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13386        NEXT SENTENCE
 13387     ELSE
 13388        IF PB-I-AH-BENEFIT-AMT = ZERO
 13389           MOVE ER-2635             TO WS-ERROR
 13390           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13391
 13392******************************************************************
 13393*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13394******************************************************************
 13395
 13396     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13397        NEXT SENTENCE
 13398     ELSE
 13399        IF PB-I-AH-PREMIUM-AMT = ZERO
 13400            IF NOT PB-COMP-AH-PREM
 13401                MOVE ER-2636    TO WS-ERROR
 13402                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13403
 13404
 13405 3140-EDIT-MAX-AMT-SIZES.
 13406* CUSTOM CODE FOR CLIENT    'DMD'
 13407     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13408                                     WS-RES-MUNI-TAX
 13409                                     PB-I-STATE-TAX
 13410                                     PB-I-MUNI-TAX.
 13411
 13412     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13413
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 244
* EL050.cbl
 13414     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13415        GO TO 3150-RATE-OUTSTAND-BAL.
 13416
 13417     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13418        GO TO 3150-RATE-OUTSTAND-BAL.
 13419
 13420     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13421        GO TO 3150-RATE-OUTSTAND-BAL.
 13422
 13423     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13424                             OR 'RIC')
 13425        GO TO 3150-RATE-OUTSTAND-BAL.
 13426
 13427     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13428        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13429            GO TO 3150-RATE-OUTSTAND-BAL
 13430        ELSE
 13431           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13432               GO TO 3150-RATE-OUTSTAND-BAL.
 13433
 13434     IF NOT PB-NO-MONTHS-SKIPPED
 13435        GO TO 3150-RATE-OUTSTAND-BAL.
 13436
 13437     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13438        GO TO 3150-RATE-OUTSTAND-BAL.
 13439
 13440     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13441        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13442           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13443             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13444           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13445           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13446              MOVE ER-2693     TO WS-ERROR
 13447              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13448              GO TO 3150-RATE-OUTSTAND-BAL
 13449           ELSE
 13450              GO TO 3150-RATE-OUTSTAND-BAL.
 13451
 13452 3150-RATE-OUTSTAND-BAL.
 13453
 13454* DMD RATING TEST
 13455     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13456         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13457         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13458         MOVE ER-2687                 TO WS-ERROR
 13459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13460         MOVE 'B'                     TO PB-I-OB-FLAG
 13461         GO TO 3260-EDIT-CONTINUE.
 13462
 13463     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13464         IF  WS-ERROR    EQUAL    ER-2693
 13465             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13466                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13467                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13468                 MOVE  +0            TO  WS-ERROR.
 13469
 13470     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13471         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 245
* EL050.cbl
 13472             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13473                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13474                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13475                 MOVE  +0            TO  WS-ERROR.
 13476
 13477     IF PLAN-MASTER-AH-SW = 'Y'
 13478        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13479            IF  WS-ERROR    EQUAL    ER-2693
 13480              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13481                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13482                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13483                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13484                 MOVE  ER-1910           TO  WS-ERROR
 13485                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13486
 13487     IF PLAN-MASTER-AH-SW = 'Y'
 13488        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13489            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13490               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13491               MOVE  ER-1910           TO  WS-ERROR
 13492               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13493
 13494     IF PLAN-MASTER-AH-SW = 'Y'
 13495        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13496            IF  WS-ERROR    EQUAL    ER-2693
 13497                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13498                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13499                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13500                 MOVE  +0       TO  WS-ERROR.
 13501
 13502     IF WS-ERROR = ER-2693
 13503        IF PB-COMPANY-ID = 'JAL' AND
 13504           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13505           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13506           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13507
 13508     IF WS-ERROR = ER-2693
 13509        IF PB-COMPANY-ID = 'NCL'  AND
 13510           PB-I-AH-BENEFIT-CD = 'OA'
 13511           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13512           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13513
 13514     IF WS-ERROR = ER-2693
 13515        IF PB-COMPANY-ID = 'CNL' AND
 13516           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13517           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13518           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13519
 13520     IF WS-ERROR = ER-2693
 13521        IF PB-COMPANY-ID = 'HER'
 13522           IF WS-LEVEL
 13523              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13524              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13525
 13526     IF ((LF-BENEFIT-FOUND) AND
 13527         (NOT NO-LIFE-COVERAGE)  AND
 13528         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13529       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 246
* EL050.cbl
 13530             (NOT NO-AH-COVERAGE)    AND
 13531             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13532         NEXT SENTENCE
 13533     ELSE
 13534         GO TO 3215-EDIT-RATES.
 13535
 13536     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13537        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13538           MOVE ER-2674          TO WS-ERROR
 13539           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13540           GO TO 3215-EDIT-RATES.
 13541
 13542     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13543        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13544           MOVE ER-2674          TO WS-ERROR
 13545           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13546           GO TO 3215-EDIT-RATES.
 13547
 13548     MOVE 'B'                    TO PB-I-OB-FLAG.
 13549
 13550     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13551         NEXT SENTENCE
 13552     ELSE
 13553         IF NOT NO-LIFE-COVERAGE
 13554             IF WS-ACCT-LF-OB-RT = ZERO
 13555                MOVE ER-2641    TO WS-ERROR
 13556                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13557
 13558     IF PB-COMPANY-ID = 'CRI'
 13559       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13560         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13561         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13562         IF WS-ERROR = ER-2675
 13563            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13564            MOVE ER-2687              TO WS-ERROR
 13565            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13566         ELSE
 13567            MOVE ER-2687              TO WS-ERROR
 13568            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13569
 13570
 13571     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13572         NEXT SENTENCE
 13573     ELSE
 13574       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13575            NEXT SENTENCE
 13576       ELSE
 13577         IF NOT NO-AH-COVERAGE
 13578             IF WS-ACCT-AH-OB-RT = ZERO
 13579                MOVE ER-2642    TO WS-ERROR
 13580                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13581
 13582     IF PB-COMPANY-ID = 'CRI'
 13583       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13584         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13585         IF WS-ERROR = ER-2676
 13586            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13587            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 247
* EL050.cbl
 13588            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13589         ELSE
 13590            MOVE ER-2687              TO WS-ERROR
 13591            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13592
 13593     IF PB-COMPANY-ID NOT = 'GIC'
 13594         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13595            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13596     ELSE
 13597         IF PB-I-LF-PREM-CALC = ZEROS
 13598             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13599                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13600
 13601     IF PB-COMPANY-ID NOT = 'GIC'
 13602         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13603            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13604     ELSE
 13605         IF PB-I-AH-PREM-CALC = ZEROS
 13606             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13607                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13608
 13609     MOVE ZEROS TO PB-I-MORT-CODE.
 13610
 13611     GO TO 3260-EDIT-CONTINUE.
 13612
 13613
 13614 3215-EDIT-RATES.
 13615     IF ACCOUNT-MAST-FOUND
 13616         NEXT SENTENCE
 13617     ELSE
 13618         GO TO 3999-END-EDIT.
 13619
 13620 3220-CHECK-LF-RATES.
 13621
 13622     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13623        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13624        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13625        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13626           AND (NOT WS-LF-CASH))
 13627                           OR
 13628           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13629           AND (NOT WS-AH-CASH)))
 13630                       AND
 13631           (PB-I-ENTRY-STATUS NOT = '5')
 13632           MOVE 'M'              TO PB-BATCH-ENTRY
 13633                                    PB-I-ENTRY-STATUS
 13634        END-IF
 13635     END-IF
 13636     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13637                                    PB-I-AH-PREM-CALC
 13638                                    PB-I-LF-ALT-PREM-CALC
 13639                                    PB-I-LF-ALT-RATE
 13640                                    PB-I-LF-REI-RATE
 13641                                    PB-I-LF-ALT-REI-RATE
 13642                                    PB-I-AH-REI-RATE
 13643                                    PB-I-TOT-FEES-CALC.
 13644
 13645     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 248
* EL050.cbl
 13646        NEXT SENTENCE
 13647     ELSE
 13648        MOVE ZEROS               TO PB-I-LF-RATE
 13649                                    PB-I-AH-RATE.
 13650
 13651     IF PB-I-TOT-FEES NOT NUMERIC
 13652        MOVE ZEROS               TO PB-I-TOT-FEES
 13653     END-IF
 13654     IF PB-I-LIVES NOT NUMERIC
 13655         MOVE ZERO               TO PB-I-LIVES.
 13656
 13657     IF PB-I-NUM-BILLED NOT NUMERIC
 13658         MOVE ZERO               TO PB-I-NUM-BILLED.
 13659
 13660     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13661        MOVE +0                  TO PB-I-LF-PREM-TAX
 13662     END-IF
 13663
 13664     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13665        MOVE +0                  TO PB-I-AH-PREM-TAX
 13666     END-IF
 13667
 13668     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13669        PB-I-PAY-FREQUENCY = ZEROS
 13670            MOVE 12 TO CP-PAY-FREQUENCY
 13671     ELSE
 13672            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13673
 13674     IF PB-I-STATE-TAX NOT NUMERIC
 13675         MOVE ZEROS               TO PB-I-STATE-TAX.
 13676
 13677     IF PB-I-MUNI-TAX NOT NUMERIC
 13678         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13679
 13680     MOVE SPACES                 TO CP-BEN-CATEGORY
 13681     IF PB-COMPANY-ID  = 'CSL'  AND
 13682        PB-I-LF-TERM NOT = ZERO
 13683        COMPUTE WS-PAYMENT-AMT =
 13684             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13685        COMPUTE WS-CSL-AMT1 =
 13686             PB-I-LF-TERM * AM-MAX-MON-BEN
 13687        COMPUTE WS-CSL-AMT2 =
 13688             WS-PAYMENT-AMT * PB-I-LF-TERM
 13689        IF CP-PAY-FREQUENCY NOT = 12
 13690           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13691           MOVE '8' TO WS-CSL-CALC-CD
 13692        ELSE
 13693           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13694              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13695               AM-MAX-TOT-BEN
 13696               MOVE '6' TO WS-CSL-CALC-CD
 13697           ELSE
 13698              IF (WS-CSL-AMT1  GREATER THAN
 13699                 AM-MAX-TOT-BEN) AND
 13700                 (WS-CSL-AMT2  GREATER THAN
 13701                 AM-MAX-TOT-BEN)
 13702                 MOVE '7' TO WS-CSL-CALC-CD
 13703              ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 249
* EL050.cbl
 13704                 MOVE '5' TO WS-CSL-CALC-CD.
 13705
 13706     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13707         NEXT SENTENCE
 13708     ELSE
 13709         GO TO 3300-CHECK-AH-RATES.
 13710
 13711*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13712
 13713     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13714        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13715              OR
 13716           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13717           MOVE ER-2618          TO WS-ERROR
 13718           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13719           GO TO 3300-CHECK-AH-RATES.
 13720
 13721     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13722           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13723                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13724
 13725     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13726         MOVE ER-2687             TO WS-ERROR
 13727         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13728         MOVE 'Z000'              TO PB-I-MORT-CODE
 13729         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13730         GO TO 3300-CHECK-AH-RATES.
 13731
 13732     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13733        IF PB-I-LIVES = ZERO
 13734           MOVE ER-2688          TO WS-ERROR
 13735           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13736
 13737     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13738
 13739     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13740     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13741     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13742     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13743     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13744     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13745     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13746     MOVE '3'                    TO CP-PROCESS-TYPE.
 13747     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13748     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13749
 13750******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13751     IF PB-COMPANY-ID EQUAL 'CDL'
 13752         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13753            CP-EARN-AS-NET-PAY)
 13754             IF PB-CERT-EFF-DT GREATER  WS-931231
 13755                 MOVE '1'        TO CP-EARNING-METHOD.
 13756*******
 13757
 13758     MOVE PB-SV-STATE            TO CP-STATE.
 13759     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13760     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13761     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 250
* EL050.cbl
 13762     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13763     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13764                                    CP-RATING-BENEFIT-AMT.
 13765     IF CP-STATE-STD-ABBRV = 'OR'
 13766         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13767                                         PB-I-LF-ALT-BENEFIT-AMT.
 13768     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13769     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13770     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13771     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13772     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13773     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13774     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13775     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13776     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13777                                    CP-REMAINING-TERM
 13778                                    CP-LOAN-TERM.
 13779
 13780     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13781         NEXT SENTENCE
 13782     ELSE
 13783         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13784             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13785                                           PB-I-LF-PREMIUM-AMT.
 13786
 13787     IF PB-COMPANY-ID EQUAL 'CSL'
 13788        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13789           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13790                                         PB-I-LF-PREMIUM-AMT.
 13791
 13792     IF PB-COMPANY-ID EQUAL 'NCB'
 13793         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13794            CP-EARN-AS-NET-PAY
 13795             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13796                 PB-I-LF-PREMIUM-AMT.
 13797
 13798     IF (CP-TRUNCATED-LIFE)
 13799        or ((pb-company-id = 'AHL')
 13800           and (pb-i-loan-term > pb-i-lf-term))
 13801        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13802
 13803     IF PB-COMPANY-ID EQUAL 'CRI'
 13804        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13805
 13806     IF CP-TERM-IS-DAYS
 13807         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13808     ELSE
 13809         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13810     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13811        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13812        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13813        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13814        IF WS-LF-BEN-CATEGORY = 'D'
 13815           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13816           MOVE PB-I-LIFE-COMMISSION
 13817                                 TO CP-DCC-ACT-COMM
 13818           MOVE WS-LF-BEN-CATEGORY
 13819                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 251
* EL050.cbl
 13820        END-IF
 13821        IF (CP-BENEFIT-CD (1:1) = 'P')
 13822           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13823           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13824           add pb-i-ah-premium-amt to cp-original-premium
 13825        END-IF
 13826     END-IF
 13827     IF PB-COMPANY-ID = 'CSL'
 13828         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13829         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13830         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13831
 13832     IF PB-COMPANY-ID = 'CSL'
 13833        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13834
 13835     IF (CP-SPECIAL-CALC-CD = 'H')
 13836        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13837         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13838                                    TO CP-ALTERNATE-BENEFIT
 13839         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13840     if (pb-company-id = 'CID')
 13841        and (ws-lf-earnings-calc = '4')
 13842        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13843        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13844        move pb-i-term-type      to cp-pmt-mode
 13845        move pb-i-no-of-payments to cp-no-of-pmts
 13846     end-if
 13847     move ws-net-only-state      to cp-net-only-state
 13848     IF (PB-COMPANY-ID = 'CID')
 13849        AND (WS-LF-EARNINGS-CALC = 'B')
 13850        AND (CP-STATE-STD-ABBRV = 'MN')
 13851        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13852                                 TO CP-ALTERNATE-BENEFIT
 13853        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13854     END-IF
 13855     IF (PB-COMPANY-ID = 'CID')
 13856        AND (WS-LF-EARNINGS-CALC = 'B')
 13857        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13858                                 TO CP-ALTERNATE-BENEFIT
 13859        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13860        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13861*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13862*         pb-i-lf-alt-premium-amt
 13863        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13864        IF WS-LF-BEN-CATEGORY = 'P'
 13865           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13866        ELSE
 13867           IF WS-LF-BEN-CATEGORY = 'I'
 13868              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13869           END-IF
 13870        END-IF
 13871     END-IF
 13872     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13873     MOVE 'R'                   TO CP-RATE-FILE.
 13874     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13875
 13876     IF CP-ERROR-RATE-NOT-FOUND
 13877        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 252
* EL050.cbl
 13878        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13879        GO TO 3300-CHECK-AH-RATES.
 13880
 13881     IF PB-COMPANY-ID EQUAL 'CRI'
 13882        IF CP-ERROR-NO-LIMITS-CRI
 13883           IF NOT ACCOUNT-LIFE-CHECKED
 13884              MOVE ER-2607      TO WS-ERROR
 13885              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13886
 13887******************************************************************
 13888*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13889*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13890******************************************************************
 13891
 13892* CALC LIFE AGE AT EXPIRATION.
 13893
 13894     COMPUTE WS-AGE-AT-EXPIRE =
 13895          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13896
 13897*    IF PB-STATE = 'CO' OR 'UT'
 13898*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13899*        MOVE 'F'            TO PB-FATAL-FLAG
 13900*        MOVE ER-2709        TO WS-ERROR
 13901*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13902*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13903
 13904*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13905*        MOVE 'X'            TO PB-FATAL-FLAG
 13906*        MOVE ER-2718        TO WS-ERROR
 13907*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13908*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13909
 13910* CALC A & H AGE AT EXPIRATION.
 13911
 13912     COMPUTE WS-AGE-AT-EXPIRE =
 13913          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13914
 13915*    IF PB-STATE = 'CO' OR 'UT'
 13916*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13917*        MOVE 'F'            TO PB-FATAL-FLAG
 13918*        MOVE ER-2709        TO WS-ERROR
 13919*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13920*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13921
 13922*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13923*        MOVE 'X'            TO PB-FATAL-FLAG
 13924*        MOVE ER-2718        TO WS-ERROR
 13925*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13926*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13927
 13928     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13929        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13930
 13931     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13932        and (not pb-monthly-cert)
 13933        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13934     end-if
 13935
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 253
* EL050.cbl
 13936     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13937        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13938
 13939     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13940         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13941         MOVE ER-2639        TO WS-ERROR
 13942         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13943
 13944
 13945******************************************************************
 13946*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13947******************************************************************
 13948
 13949 PREMIUM-EDITING-IS-BYPASSED.
 13950     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13951        AND (CP-R-MAX-ATT-AGE > +0)
 13952        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13953        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13954           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13955           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13956           MOVE '1'              TO DC-OPTION-CODE
 13957           PERFORM 8500-DATE-CONVERT
 13958                                 THRU 8500-EXIT
 13959           IF NO-CONVERSION-ERROR
 13960              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13961                 MOVE ER-2661       TO WS-ERROR
 13962*                PERFORM 9900-ERROR-FORMAT
 13963*                                THRU 9900-EXIT
 13964              END-IF
 13965           END-IF
 13966        ELSE
 13967           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13968           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13969              MOVE ER-2661       TO WS-ERROR
 13970*             PERFORM 9900-ERROR-FORMAT
 13971*                                THRU 9900-EXIT
 13972           ELSE
 13973              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13974                 MOVE ER-1570    TO WS-ERROR
 13975                 PERFORM 9900-ERROR-FORMAT
 13976                                 THRU 9900-EXIT
 13977              END-IF
 13978           END-IF
 13979        END-IF
 13980        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13981           MOVE PB-I-JOINT-BIRTHDAY
 13982                                 TO DC-BIN-DATE-1
 13983           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13984           MOVE '1'              TO DC-OPTION-CODE
 13985           PERFORM 8500-DATE-CONVERT
 13986                                 THRU 8500-EXIT
 13987           IF NO-CONVERSION-ERROR
 13988              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13989                 MOVE ER-2661       TO WS-ERROR
 13990*                PERFORM 9900-ERROR-FORMAT
 13991*                                THRU 9900-EXIT
 13992              END-IF
 13993           ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 254
* EL050.cbl
 13994              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13995           END-IF
 13996        ELSE
 13997           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13998             (PB-I-LF-TERM / 12)
 13999           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14000              MOVE ER-2661       TO WS-ERROR
 14001*             PERFORM 9900-ERROR-FORMAT
 14002*                                THRU 9900-EXIT
 14003           ELSE
 14004              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14005                 MOVE ER-1571    TO WS-ERROR
 14006                 PERFORM 9900-ERROR-FORMAT
 14007                                 THRU 9900-EXIT
 14008              END-IF
 14009           END-IF
 14010        END-IF
 14011        IF WS-ERROR = ER-2661
 14012           PERFORM 9900-ERROR-FORMAT
 14013                                 THRU 9900-EXIT
 14014        END-IF
 14015     END-IF
 14016*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14017*       MOVE ER-2661             TO WS-ERROR
 14018*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14019
 14020     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14021        MOVE ER-2662             TO WS-ERROR
 14022        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14023
 14024     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14025        MOVE ER-2677             TO WS-ERROR
 14026        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14027
 14028     IF CP-ERROR-LOAN-TERM
 14029        MOVE ER-2648             TO WS-ERROR
 14030        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14031
 14032 3221-CHECK-ERROR-RATE-OPEN.
 14033
 14034     IF CP-ERROR-RATE-FILE-NOTOPEN
 14035         GO TO 3990-FILES-NOT-OPEN.
 14036
 14037     IF PB-COMPANY-ID NOT = 'DMD'
 14038        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14039     END-IF
 14040     .
 14041 3221-CONTINUE.
 14042     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14043                                    WS-DCC-AH-RATE
 14044     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14045        IF WS-LF-BEN-CATEGORY = 'D'
 14046           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14047              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14048        END-IF
 14049     END-IF
 14050     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14051*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 255
* EL050.cbl
 14052     IF (PB-COMPANY-ID = 'CID')
 14053        AND (WS-LF-EARNINGS-CALC = 'B')
 14054        AND (CP-STATE-STD-ABBRV = 'MN')
 14055        AND (PB-CERT-EFF-DT > X'A4FF')
 14056        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14057     END-IF
 14058     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14059
 14060     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14061     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14062        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14063        AND (PB-I-POLICY-IS-MONTHLY)
 14064        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14065        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14066     END-IF
 14067     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14068     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14069     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14070     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14071     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14072        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14073        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14074        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14075        MOVE ER-2786             TO WS-ERROR
 14076        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14077     END-IF
 14078
 14079     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14080
 14081******************************************************************
 14082*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14083******************************************************************
 14084     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14085        and ((not pb-monthly-cert)
 14086        or (ws-lf-ben-category = 'C'))
 14087        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14088
 14089     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14090        GO TO 3225-CHECK-ALT-LIFE-RATE
 14091     ELSE
 14092       IF PB-I-LF-RATE = ZERO
 14093          MOVE ER-2641          TO WS-ERROR
 14094          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14095
 14096 3225-CHECK-ALT-LIFE-RATE.
 14097
 14098     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14099        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14100        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14101         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14102
 14103     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14104         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14105             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14106                   OR
 14107              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14108              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14109              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 256
* EL050.cbl
 14110             MOVE ER-2720        TO  WS-ERROR
 14111             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14112             GO TO 3225-RATING-CONT
 14113         ELSE
 14114             GO TO 3225-RATING-CONT.
 14115     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14116        AND (AM-GPCD = 01 OR 06 OR 15)
 14117        MOVE ER-2798             TO WS-ERROR
 14118        PERFORM 9900-ERROR-FORMAT
 14119                                 THRU 9900-EXIT
 14120*       GO TO 3225-RATING-CONT
 14121     END-IF
 14122     if (pb-company-id = 'CID')
 14123        and (ws-lf-earnings-calc = 'B')
 14124        and (ws-lf-ben-category = 'P' or 'I')
 14125        and (ws-net-only-state = 'Y')
 14126        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14127        display ' balloon prem ' pb-i-lf-alt-prem-calc
 14128        go to 3225-rating-cont
 14129     end-if
 14130     IF (PB-COMPANY-ID = 'CID')
 14131        AND (WS-LF-EARNINGS-CALC = 'B')
 14132        AND (CP-STATE-STD-ABBRV = 'MN')
 14133        AND (PB-CERT-EFF-DT > X'A4FF')
 14134        GO TO 3225-RATING-CONT
 14135     END-IF
 14136     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14137        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14138           AND (PB-I-POLICY-IS-MONTHLY)
 14139           GO TO 3225-RATING-CONT
 14140        END-IF
 14141     END-IF
 14142
 14143     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14144        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14145        CP-EARN-AS-REG-BALLOON
 14146        NEXT SENTENCE
 14147     ELSE
 14148        MOVE '2'                 TO CP-EARNING-METHOD.
 14149
 14150 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14151
 14152     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14153
 14154     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14155        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14156        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14157         NEXT SENTENCE
 14158     ELSE
 14159         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14160
 14161     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14162     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14163     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14164                                     CP-RATING-BENEFIT-AMT.
 14165     IF CP-STATE-STD-ABBRV = 'OR'
 14166         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14167                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 257
* EL050.cbl
 14168     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14169        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14170     END-IF
 14171     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14172     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14173     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14174                                    CP-REMAINING-TERM
 14175                                    CP-LOAN-TERM.
 14176     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14177        ADD +1                   TO CP-ORIGINAL-TERM
 14178                                    CP-REMAINING-TERM
 14179                                    CP-LOAN-TERM.
 14180
 14181     MOVE 'R'                   TO CP-RATE-FILE.
 14182     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14183
 14184     IF CP-ERROR-RATE-NOT-FOUND
 14185         MOVE ER-2641            TO WS-ERROR
 14186         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14187         GO TO 3300-CHECK-AH-RATES.
 14188
 14189     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14190     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14191
 14192     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14193         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14194
 14195     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14196                               + PB-I-LF-ALT-BENEFIT-AMT.
 14197
 14198     IF ACCOUNT-LIFE-CHECKED  OR
 14199        PB-POLICY-IS-VOIDED   OR
 14200        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14201        and (not pb-monthly-cert))
 14202        GO TO 3225-CONTINUE.
 14203
 14204     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14205        GO TO 3225-CONTINUE.
 14206
 14207     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14208                             EC-RT-LF-MAX-TOT-BEN
 14209        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14210        MOVE ER-2639       TO WS-ERROR
 14211        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14212
 14213 3225-CONTINUE.
 14214     IF PB-I-LF-ALT-RATE = ZERO
 14215         MOVE ER-2659            TO WS-ERROR
 14216         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14217
 14218     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14219        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14220        MOVE ER-2698             TO WS-ERROR
 14221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14222
 14223 3225-RATING-CONT.
 14224
 14225     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 258
* EL050.cbl
 14226        and (not pb-monthly-cert)
 14227         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14228         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14229         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14230            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14231            CONTINUE
 14232         ELSE
 14233            MOVE ER-2687         TO WS-ERROR
 14234            PERFORM 9900-ERROR-FORMAT
 14235                                 THRU 9900-EXIT
 14236         END-IF
 14237         GO TO 3290-EDIT-LF-REIN-RATE
 14238     END-IF
 14239
 14240* DMD RATING TEST
 14241     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14242         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14243         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14244         MOVE ER-2687                 TO WS-ERROR
 14245         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14246         GO TO 3290-EDIT-LF-REIN-RATE.
 14247
 14248 3230-CLIENT-MORT-CD-SPECIALS.
 14249
 14250     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14251     SET BIN-TO-GREG          TO TRUE.
 14252*    MOVE ' '                 TO DC-OPTION-CODE.
 14253     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14254     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14255
 14256 C-POS-3230-MORT-CD.
 14257     IF PB-COMPANY-ID = 'POS' AND
 14258        PB-SV-CARRIER = '2'
 14259         NEXT SENTENCE
 14260     ELSE
 14261         GO TO C-POS-3240-MORT-CD.
 14262
 14263     IF PB-SV-GROUPING = '030'
 14264        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14265         MOVE '2350' TO PB-I-MORT-CODE
 14266      ELSE
 14267         MOVE '3300' TO PB-I-MORT-CODE.
 14268
 14269
 14270 C-POS-3240-MORT-CD.
 14271     IF PB-COMPANY-ID = 'POS' AND
 14272        PB-SV-CARRIER = '1'
 14273         NEXT SENTENCE
 14274     ELSE
 14275         GO TO 3230-CONTINUE.
 14276
 14277     IF PB-SV-STATE = '45' OR '47'
 14278        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14279         MOVE '5200' TO PB-I-MORT-CODE
 14280     ELSE
 14281         MOVE '8300' TO PB-I-MORT-CODE.
 14282
 14283 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 259
* EL050.cbl
 14284
 14285     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14286        GO TO 3240-CONTINUE
 14287     END-IF
 14288
 14289     IF PB-CERT-EFF-DT > WS-971231
 14290        GO TO 3240-CONTINUE
 14291     END-IF
 14292
 14293     IF LF-BENEFIT-FOUND AND
 14294        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14295         MOVE 'F250'       TO PB-I-MORT-CODE
 14296     ELSE
 14297         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14298             MOVE '7250'   TO PB-I-MORT-CODE
 14299         ELSE
 14300             MOVE '4251'   TO PB-I-MORT-CODE
 14301         END-IF
 14302     END-IF
 14303
 14304     .
 14305 3240-CONTINUE.
 14306
 14307     IF PB-COMPANY-ID NOT = 'GNL'
 14308         GO TO 3256-CONTINUE.
 14309
 14310     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14311         MOVE 'A300' TO PB-I-MORT-CODE
 14312     ELSE
 14313         MOVE '8350' TO PB-I-MORT-CODE.
 14314
 14315 3256-CONTINUE.
 14316     IF PB-COMPANY-ID NOT = 'ABL'
 14317         GO TO 3260-EDIT-CONTINUE.
 14318
 14319     IF PB-I-LF-TERM GREATER THAN 59
 14320         MOVE 'F550' TO PB-I-MORT-CODE
 14321     ELSE
 14322         MOVE 'E550' TO PB-I-MORT-CODE.
 14323
 14324 3260-EDIT-CONTINUE.
 14325     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14326
 14327 3290-EDIT-LF-REIN-RATE.
 14328     IF LF-REIN-NSP-NOT-USED
 14329         GO TO 3290-RATING-CONT.
 14330
 14331     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14332        GO TO 3290-RATING-CONT.
 14333     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14334     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14335     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14336     MOVE '3'                   TO CP-PROCESS-TYPE.
 14337     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14338
 14339******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14340     IF PB-COMPANY-ID EQUAL 'CDL'
 14341         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 260
* EL050.cbl
 14342            CP-EARN-AS-NET-PAY)
 14343             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14344*            MOVE SPACE          TO DC-OPTION-CODE
 14345             SET BIN-TO-GREG     TO TRUE
 14346             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14347***  Y2K PROJ 7744
 14348             IF DC-GREG-DATE-CYMD GREATER 19931231
 14349                 MOVE '1'        TO CP-EARNING-METHOD.
 14350***  Y2K PROJ 7744
 14351*******
 14352
 14353     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14354     MOVE PB-SV-STATE           TO CP-STATE.
 14355     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14356     MOVE ZERO                  TO CP-DEVIATION-CODE
 14357                                   CP-RATE-DEV-PCT.
 14358     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14359     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14360                                   CP-RATING-BENEFIT-AMT.
 14361
 14362************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14363     IF PB-COMPANY-ID EQUAL 'NCB'
 14364         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14365            CP-EARN-AS-NET-PAY
 14366             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14367                 PB-I-LF-PREMIUM-AMT.
 14368************
 14369
 14370     IF CP-STATE-STD-ABBRV = 'OR'
 14371         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14372                                         PB-I-LF-ALT-BENEFIT-AMT.
 14373     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14374     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14375     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14376     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14377     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14378     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14379     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14380     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14381                                   CP-REMAINING-TERM
 14382                                   CP-LOAN-TERM.
 14383     IF CP-TRUNCATED-LIFE
 14384        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14385
 14386     IF CP-TERM-IS-DAYS
 14387         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14388     ELSE
 14389         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14390
 14391     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14392        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14393     END-IF
 14394     IF PB-COMPANY-ID NOT = 'TIC'
 14395          MOVE ZERO          TO CP-CLASS-CODE.
 14396
 14397     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14398
 14399     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 261
* EL050.cbl
 14400     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14401
 14402     IF CP-ERROR-RATE-NOT-FOUND
 14403        IF PB-I-OB
 14404           MOVE ER-2625      TO WS-ERROR
 14405           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14406           GO TO 3299-EDIT-CONTINUE
 14407        ELSE
 14408           MOVE ER-2643      TO WS-ERROR
 14409           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14410           GO TO 3299-EDIT-CONTINUE.
 14411
 14412     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14413
 14414     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14415     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14416
 14417     IF PB-I-LF-REI-RATE = ZERO
 14418         MOVE ER-2643        TO WS-ERROR
 14419         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14420
 14421 3290-CHECK-ALT-REIN-RATE.
 14422
 14423     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14424        GO TO 3290-RATING-CONT.
 14425
 14426     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14427     MOVE '2'                    TO CP-EARNING-METHOD.
 14428     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14429     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14430     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14431     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14432                                     CP-RATING-BENEFIT-AMT.
 14433     IF CP-STATE-STD-ABBRV = 'OR'
 14434         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14435                                         PB-I-LF-ALT-BENEFIT-AMT.
 14436     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14437        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14438     END-IF
 14439     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14440     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14441     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14442                                    CP-REMAINING-TERM
 14443                                    CP-LOAN-TERM.
 14444     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14445        ADD +1                   TO CP-ORIGINAL-TERM
 14446                                    CP-REMAINING-TERM
 14447                                    CP-LOAN-TERM.
 14448
 14449     MOVE 'R'                   TO CP-RATE-FILE.
 14450     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14451
 14452     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14453
 14454     IF PB-I-LF-ALT-REI-RATE = ZERO
 14455         MOVE ER-2643            TO WS-ERROR
 14456         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14457
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 262
* EL050.cbl
 14458 3290-RATING-CONT.
 14459
 14460     IF PB-I-OB
 14461*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14462        GO TO 3300-CHECK-AH-RATES.
 14463
 14464 3299-EDIT-CONTINUE.
 14465
 14466     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14467         NEXT SENTENCE
 14468     ELSE
 14469         MOVE ER-2620           TO WS-ERROR
 14470         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14471
 14472 3300-CHECK-AH-RATES.
 14473     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14474         NEXT SENTENCE
 14475     ELSE
 14476         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14477
 14478     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14479        and (not pb-monthly-cert))
 14480                  or
 14481        ((CF-COMPANY-ID = 'DMD') AND
 14482                (NO-DMD-RATING))
 14483         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14484            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14485            CONTINUE
 14486         ELSE
 14487            MOVE ER-2687         TO WS-ERROR
 14488            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14489         END-IF
 14490         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14491         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14492     END-IF
 14493
 14494     IF PB-I-OB
 14495        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14496
 14497     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14498         MOVE ER-2687             TO WS-ERROR
 14499         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14500         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14501         GO TO 3999-END-EDIT.
 14502
 14503*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14504     if pb-company-id = 'AHL'
 14505        go to 3300-skip-crit-per
 14506     end-if
 14507     if (pb-i-ah-crit-per not = zeros)
 14508        and (ws-ah-special-calc-cd not = 'C')
 14509        MOVE ER-1572             TO WS-ERROR
 14510        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14511        go to 3300-skip-crit-per
 14512     END-IF
 14513     if (pb-company-id = 'DCC' or 'VPP')
 14514        and (am-dcc-product-code not = spaces)
 14515        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 263
* EL050.cbl
 14516     end-if
 14517     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14518        IF PB-I-AH-CRIT-PER = ZERO
 14519           move ws-ah-max-bens   to pb-i-ah-crit-per
 14520*          MOVE ER-2618       TO WS-ERROR
 14521*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14522*          GO TO 3999-END-EDIT
 14523        END-IF
 14524     END-IF
 14525     if (ws-ah-special-calc-cd = 'C')
 14526        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14527        MOVE ER-1576             TO WS-ERROR
 14528        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14529     end-if
 14530
 14531     .
 14532 3300-skip-crit-per.
 14533     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14534     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14535     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14536     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14537     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14538     MOVE PB-SV-STATE            TO CP-STATE.
 14539     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14540     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14541     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14542*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14543     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14544     MOVE '3'                    TO CP-PROCESS-TYPE.
 14545     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14546     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14547                                    CP-RATING-BENEFIT-AMT.
 14548     IF PB-COMPANY-ID = 'CID'
 14549               OR
 14550        CP-STATE-STD-ABBRV = 'OR'
 14551         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14552                                         PB-I-AH-TERM.
 14553     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14554        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14555           AND (PB-I-POLICY-IS-MONTHLY)
 14556           MOVE PB-I-LF-BENEFIT-AMT
 14557                                 TO CP-NET-BENEFIT-AMT
 14558           move pb-i-ah-premium-amt to cp-original-premium
 14559           add pb-i-lf-premium-amt to cp-original-premium
 14560        END-IF
 14561     END-IF
 14562     MOVE SPACES                 TO CP-BEN-CATEGORY
 14563     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14564        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14565        EVALUATE TRUE
 14566           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14567              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14568              MOVE PB-I-LF-BENEFIT-AMT
 14569                                 TO CP-RATING-BENEFIT-AMT
 14570              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14571           WHEN WS-AH-BEN-CATEGORY = 'G'
 14572              MOVE PB-I-UNPAID-CASH-PRICE
 14573                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 264
* EL050.cbl
 14574           WHEN WS-AH-BEN-CATEGORY = 'D'
 14575              MOVE WS-AH-PMF-COMM
 14576                                 TO CP-DCC-PMF-COMM
 14577              MOVE PB-I-AH-COMMISSION
 14578                                 TO CP-DCC-ACT-COMM
 14579        END-EVALUATE
 14580     END-IF
 14581     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14582     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14583     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14584     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14585     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14586     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14587     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14588                                    CP-REMAINING-TERM
 14589                                    WS-WORK-TERM.
 14590     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14591
 14592     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14593     SET BIN-TO-GREG             TO TRUE.
 14594*    MOVE ' '                    TO DC-OPTION-CODE.
 14595     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14596     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14597
 14598     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14599     IF NOT VALID-SKIP-CODE
 14600         MOVE ER-2683            TO WS-ERROR
 14601         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14602         GO TO 3320-RATE-CONTINUE.
 14603
 14604     IF PB-NO-MONTHS-SKIPPED
 14605         GO TO 3320-RATE-CONTINUE.
 14606
 14607     MOVE SPACE TO NUMBER-OF-MONTHS.
 14608
 14609     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14610         MOVE 'S'                TO SK-MO (6).
 14611     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14612         MOVE 'S'                TO SK-MO (7).
 14613     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14614         MOVE 'S'                TO SK-MO (8).
 14615     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14616         MOVE 'S'                TO SK-MO (9).
 14617     IF PB-I-SKIP-CODE = 'A'
 14618         MOVE 'S'                TO SK-MO (10).
 14619
 14620     MOVE 1                      TO SUB2.
 14621     MOVE PB-I-AH-TERM           TO SUB3.
 14622     MOVE WS-MONTH               TO SUB1.
 14623     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14624     GO TO 3320-RATE-CONTINUE.
 14625
 14626 3310-GET-SKIP-MO.
 14627     IF SUB1 = 13
 14628         MOVE 1                  TO SUB1.
 14629
 14630     IF SK-MO (SUB1) = 'S'
 14631         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 265
* EL050.cbl
 14632
 14633     ADD 1 TO SUB2
 14634              SUB1.
 14635
 14636 3320-RATE-CONTINUE.
 14637
 14638     IF WS-WORK-TERM = ZERO
 14639         MOVE 1                  TO WS-WORK-TERM.
 14640
 14641     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14642                                    CP-LOAN-TERM.
 14643
 14644     IF PB-COMPANY-ID EQUAL 'DMD'
 14645         NEXT SENTENCE
 14646     ELSE
 14647         MOVE ZERO               TO PB-I-AH-RATE
 14648                                    PB-I-AH-REI-RATE.
 14649
 14650
 14651     IF PB-COMPANY-ID EQUAL 'CRI'
 14652        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14653
 14654     IF PB-COMPANY-ID = 'CSL'
 14655         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14656         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14657         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14658         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14659
 14660     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14661        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14662           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14663              PB-I-RATE-DEV-PCT-LF
 14664        END-IF
 14665        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14666                                 TO CP-ALTERNATE-BENEFIT
 14667        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14668        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14669        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14670     END-IF
 14671*    if ws-clp-state not = spaces
 14672*       move ws-clp-state to cp-state
 14673*    end-if
 14674     IF (PB-COMPANY-ID = 'CID')
 14675        AND (WS-LF-EARNINGS-CALC = 'B')
 14676        AND (CP-STATE-STD-ABBRV = 'MN')
 14677        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14678     ELSE
 14679        MOVE ' '                 TO CP-AH-BALLOON-SW
 14680     END-IF
 14681     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14682     MOVE 'R'                   TO CP-RATE-FILE.
 14683     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14684
 14685     IF (CP-ERROR-RATE-NOT-FOUND)
 14686        and (not pb-monthly-cert)
 14687        IF PB-I-OB
 14688           MOVE ER-2624          TO WS-ERROR
 14689           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 266
* EL050.cbl
 14690           GO TO 3340-CALCULATE-PREMIUM-AMT
 14691        ELSE
 14692          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14693              NEXT SENTENCE
 14694          ELSE
 14695           MOVE ER-2642          TO WS-ERROR
 14696           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14697           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14698
 14699     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14700        CP-ERROR-DIV-BY-ZERO
 14701           MOVE ER-3782          TO WS-ERROR
 14702           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14703
 14704     IF PB-COMPANY-ID EQUAL 'CRI'
 14705        IF CP-ERROR-NO-LIMITS-CRI
 14706           IF NOT ACCOUNT-AH-CHECKED
 14707              MOVE ER-2607          TO WS-ERROR
 14708              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14709
 14710     IF ACCOUNT-AH-CHECKED
 14711        NEXT SENTENCE
 14712     ELSE
 14713       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14714          MOVE ER-2640           TO WS-ERROR
 14715          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14716
 14717     IF PB-COMPANY-ID = 'CRI'
 14718         IF WS-ERROR = ER-2640
 14719             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14720     IF ACCOUNT-AH-CHECKED
 14721        CONTINUE
 14722     ELSE
 14723        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14724           AND (CP-R-MAX-ATT-AGE > +0)
 14725           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14726           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14727              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14728              MOVE PB-I-AH-EXPIRE-DT
 14729                                 TO DC-BIN-DATE-2
 14730              MOVE '1'           TO DC-OPTION-CODE
 14731              PERFORM 8500-DATE-CONVERT
 14732                                 THRU 8500-EXIT
 14733              IF NO-CONVERSION-ERROR
 14734                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14735                    MOVE ER-2661       TO WS-ERROR
 14736*                   PERFORM 9900-ERROR-FORMAT
 14737*                                THRU 9900-EXIT
 14738                 END-IF
 14739              END-IF
 14740           ELSE
 14741              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14742              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14743                 MOVE ER-2661    TO WS-ERROR
 14744*                PERFORM 9900-ERROR-FORMAT
 14745*                                THRU 9900-EXIT
 14746              ELSE
 14747                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 267
* EL050.cbl
 14748                    MOVE ER-1570 TO WS-ERROR
 14749                    PERFORM 9900-ERROR-FORMAT
 14750                                 THRU 9900-EXIT
 14751                 END-IF
 14752              END-IF
 14753           END-IF
 14754           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14755              MOVE PB-I-JOINT-BIRTHDAY
 14756                                    TO DC-BIN-DATE-1
 14757              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14758              MOVE '1'              TO DC-OPTION-CODE
 14759              PERFORM 8500-DATE-CONVERT
 14760                                    THRU 8500-EXIT
 14761              IF NO-CONVERSION-ERROR
 14762                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14763                    MOVE ER-2661       TO WS-ERROR
 14764*                   PERFORM 9900-ERROR-FORMAT
 14765*                                   THRU 9900-EXIT
 14766                 END-IF
 14767              END-IF
 14768           ELSE
 14769              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14770                (PB-I-AH-TERM / 12)
 14771              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14772                 MOVE ER-2661       TO WS-ERROR
 14773*                PERFORM 9900-ERROR-FORMAT
 14774*                                   THRU 9900-EXIT
 14775              ELSE
 14776                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14777                    MOVE ER-1571 TO WS-ERROR
 14778                    PERFORM 9900-ERROR-FORMAT
 14779                                 THRU 9900-EXIT
 14780                 END-IF
 14781              END-IF
 14782           END-IF
 14783           IF WS-ERROR = ER-2661
 14784              PERFORM 9900-ERROR-FORMAT
 14785                                    THRU 9900-EXIT
 14786           END-IF
 14787        END-IF
 14788     END-IF
 14789*    IF ACCOUNT-AH-CHECKED
 14790*       NEXT SENTENCE
 14791*    ELSE
 14792*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14793*          MOVE ER-2661          TO WS-ERROR
 14794*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14795
 14796     IF ACCOUNT-AH-CHECKED
 14797        NEXT SENTENCE
 14798     ELSE
 14799        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14800           MOVE ER-2663          TO WS-ERROR
 14801           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14802
 14803     IF ACCOUNT-AH-CHECKED OR
 14804        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14805         PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 268
* EL050.cbl
 14806        NEXT SENTENCE
 14807     ELSE
 14808        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14809           MOVE ER-2667            TO WS-ERROR
 14810           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14811
 14812     IF PB-COMPANY-ID = 'CRI'
 14813         IF WS-ERROR = ER-2667
 14814             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14815
 14816     IF ACCOUNT-AH-CHECKED
 14817        NEXT SENTENCE
 14818     ELSE
 14819        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14820           MOVE ER-2678            TO WS-ERROR
 14821           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14822
 14823     IF CP-ERROR-RATE-FILE-NOTOPEN
 14824         GO TO 3990-FILES-NOT-OPEN.
 14825
 14826 3321-CONTINUE.
 14827     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14828     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14829     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14830*    IF (PB-COMPANY-ID = 'DCC')
 14831        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14832        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14833                                    PB-I-LF-ALT-PREM-CALC
 14834        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14835        IF WS-AH-BEN-CATEGORY = 'G'
 14836           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14837           + PB-I-ADDL-CLP)
 14838           * (1 + WS-TOL-CLP-PCT)
 14839*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14840        ELSE
 14841           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14842           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14843*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14844        END-IF
 14845        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14846                                 TO PB-I-AH-PREM-CALC
 14847        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14848           MOVE ER-8152          TO WS-ERROR
 14849           PERFORM 9900-ERROR-FORMAT
 14850                                 THRU 9900-EXIT
 14851        ELSE
 14852           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14853                 PB-I-ADDL-CLP)
 14854              MOVE ER-8148       TO WS-ERROR
 14855              PERFORM 9900-ERROR-FORMAT
 14856                                 THRU 9900-EXIT
 14857           END-IF
 14858        END-IF
 14859     END-IF
 14860     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14861        AND (PB-I-POLICY-IS-MONTHLY)
 14862        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14863        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 269
* EL050.cbl
 14864        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14865           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14866        END-IF
 14867     END-IF
 14868     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14869        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14870        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14871        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14872        MOVE ER-2786             TO WS-ERROR
 14873        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14874     END-IF
 14875     MOVE +0                     TO PB-I-AH-CLP
 14876     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14877        evaluate true
 14878           when WS-AH-BEN-CATEGORY = 'D'
 14879              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14880                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14881           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14882              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14883           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14884              compute ws-cred-union-fees rounded =
 14885                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14886                    pb-i-ah-commission)
 14887              COMPUTE PB-I-AH-CLP =
 14888                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14889        end-evaluate
 14890     END-IF
 14891     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14892
 14893     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14894         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14895
 14896     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14897         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14898
 14899     if (ws-ah-special-calc-cd = 'E')
 14900        and (pb-monthly-cert)
 14901        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14902     end-if
 14903     IF PB-COMPANY-ID = 'CRI'
 14904         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14905            PB-I-PAYMENT-AMOUNT = ZERO
 14906             NEXT SENTENCE
 14907         ELSE
 14908             COMPUTE PB-I-AH-PREM-CALC =
 14909                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14910                 (CP-PREMIUM-RATE / 100)
 14911             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14912                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14913                                             PB-I-RATE-DEV-PCT-AH.
 14914
 14915     IF (PB-I-AH-RATE  = ZERO)
 14916        and (not pb-monthly-cert)
 14917       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14918           NEXT SENTENCE
 14919       ELSE
 14920         MOVE ER-2642            TO WS-ERROR
 14921         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 270
* EL050.cbl
 14922
 14923     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14924     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14925     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14926     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14927     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14928     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14929
 14930     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14931        AND (WS-AH-BEN-CATEGORY = 'G')
 14932        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14933        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14934        IF CP-DEVIATION-CODE NOT = '000'
 14935           MOVE '000'            TO CP-DEVIATION-CODE
 14936           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14937           IF NO-CP-ERROR
 14938              COMPUTE PB-I-DDF-IU-RATE-UP =
 14939              PB-I-AH-CLP - CP-CALC-PREMIUM
 14940           ELSE
 14941              MOVE ER-3057        TO WS-ERROR
 14942              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14943           END-IF
 14944        END-IF
 14945     END-IF
 14946     .
 14947 3335-EDIT-AH-REIN-NSP-RATE.
 14948     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14949        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14950              compute ws-cred-union-fees rounded =
 14951                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14952                    pb-i-ah-commission)
 14953              COMPUTE PB-I-AH-CLP =
 14954                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14955        end-if
 14956     END-IF
 14957     IF AH-REIN-NSP-NOT-USED
 14958         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14959
 14960     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14961     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14962         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14963     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14964     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14965     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14966     MOVE PB-SV-STATE            TO CP-STATE.
 14967     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14968     MOVE ZERO                   TO CP-DEVIATION-CODE
 14969                                    CP-RATE-DEV-PCT.
 14970*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14971     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14972     MOVE '3'                    TO CP-PROCESS-TYPE.
 14973     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14974     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14975                                    CP-RATING-BENEFIT-AMT.
 14976     IF CP-STATE-STD-ABBRV = 'OR'
 14977         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14978                                         PB-I-AH-TERM.
 14979     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 271
* EL050.cbl
 14980     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14981     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14982     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14983     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14984     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14985                                    CP-REMAINING-TERM
 14986                                    WS-WORK-TERM.
 14987     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14988     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14989        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14990     END-IF
 14991     IF  PB-COMPANY-ID = 'TIC'
 14992         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14993            MOVE ZERO TO CP-CLASS-CODE.
 14994
 14995     IF PB-COMPANY-ID NOT = 'TIC'
 14996          MOVE ZERO          TO CP-CLASS-CODE.
 14997
 14998     MOVE ZERO               TO CP-DEVIATION-CODE.
 14999
 15000     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 15001
 15002     MOVE ZERO               TO PB-I-AH-REI-RATE.
 15003
 15004     MOVE 'R'                   TO CP-RATE-FILE.
 15005     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15006
 15007     IF CP-ERROR-RATE-NOT-FOUND
 15008         MOVE ER-2645        TO WS-ERROR
 15009         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15010         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15011
 15012     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15013
 15014     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15015     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15016
 15017     IF PB-I-AH-REI-RATE = ZERO
 15018         MOVE ER-2645        TO WS-ERROR
 15019         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15020
 15021
 15022 3340-CALCULATE-PREMIUM-AMT.
 15023
 15024     IF PB-COMPANY-ID = 'NCL'
 15025         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15026             WS-AH-SPECIAL-CALC-CD = 'O')
 15027             GO TO 3999-END-EDIT.
 15028
 15029     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15030                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15031                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15032                         OR 'AHL'
 15033         NEXT SENTENCE
 15034     ELSE
 15035         IF WS-STATE-ABBREVIATION = 'CT'
 15036             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15037                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 272
* EL050.cbl
 15038                 COMPUTE PB-I-LF-PREM-CALC =
 15039                                     PB-I-LF-PREM-CALC * .90
 15040                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15041                                     PB-I-LF-ALT-PREM-CALC * .90
 15042                 COMPUTE PB-I-AH-PREM-CALC =
 15043                                     PB-I-AH-PREM-CALC * .90.
 15044
 15045     IF PB-COMP-LF-PREM
 15046        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15047        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15048
 15049     IF PB-COMP-AH-PREM
 15050        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15051
 15052 3340-CHECK-DCC-TOT-FEES.
 15053     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15054        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15055        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15056        AND (PB-I-POLICY-IS-MONTHLY)
 15057        CONTINUE
 15058     ELSE
 15059        GO TO 3340-EDIT-LF-AH-TOL
 15060     END-IF
 15061     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15062     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15063     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15064        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15065           PB-I-RATE-DEV-PCT-LF
 15066     END-IF
 15067     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15068        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15069           PB-I-RATE-DEV-PCT-AH
 15070     END-IF
 15071     MOVE 'N'                    TO CP-BEN-CATEGORY
 15072     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15073
 15074     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15075     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15076     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15077     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15078     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15079     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15080     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15081     MOVE '3'                    TO CP-PROCESS-TYPE.
 15082     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15083     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15084
 15085     MOVE PB-SV-STATE            TO CP-STATE.
 15086     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15087     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15088     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15089     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15090     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15091                                    CP-RATING-BENEFIT-AMT.
 15092     IF CP-STATE-STD-ABBRV = 'OR'
 15093         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15094                                         PB-I-LF-ALT-BENEFIT-AMT.
 15095     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 273
* EL050.cbl
 15096     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15097     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15098     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15099     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15100     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15101     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15102     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15103     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15104                                    CP-REMAINING-TERM
 15105                                    CP-LOAN-TERM.
 15106     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15107        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15108           PB-I-LF-PREMIUM-AMT
 15109     end-if
 15110
 15111     IF CP-TRUNCATED-LIFE
 15112        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15113
 15114     IF CP-TERM-IS-DAYS
 15115         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15116     ELSE
 15117         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15118
 15119     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15120     IF CP-SPECIAL-CALC-CD = 'H'
 15121         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15122                                    TO CP-ALTERNATE-BENEFIT
 15123         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15124     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15125     MOVE 'R'                    TO CP-RATE-FILE
 15126     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15127     IF NOT CP-ERROR-RATE-NOT-FOUND
 15128        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15129        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15130           AND (CP-BENEFIT-CD (1:1) = 'S')
 15131           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15132                                    PB-I-LF-PREMIUM-AMT
 15133        END-IF
 15134     ELSE
 15135        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15136     END-IF
 15137     .
 15138 3340-EDIT-LF-AH-TOL.
 15139
 15140***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15141***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15142***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15143***
 15144     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15145         PB-I-AH-PREMIUM-AMT
 15146          GIVING WS-CALC-WORK.
 15147
 15148     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15149        AND WS-CALC-WORK NOT = ZERO
 15150         MOVE ER-2649            TO WS-ERROR
 15151         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15152
 15153     SUBTRACT PB-I-LF-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 274
* EL050.cbl
 15154             FROM PB-I-LF-PREMIUM-AMT
 15155                 GIVING WS-UNSIGN-WRK1.
 15156
 15157     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15158             FROM PB-I-LF-ALT-PREMIUM-AMT
 15159                 GIVING WS-UNSIGN-WRK4.
 15160
 15161     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15162                                + WS-UNSIGN-WRK4.
 15163
 15164     SUBTRACT PB-I-AH-PREM-CALC
 15165             FROM PB-I-AH-PREMIUM-AMT
 15166                 GIVING WS-UNSIGN-WRK2.
 15167
 15168******************************************************************
 15169*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15170******************************************************************
 15171
 15172     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15173         MOVE ZERO TO WS-UNSIGN-WRK1.
 15174
 15175     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15176         MOVE ZERO TO WS-UNSIGN-WRK2.
 15177
 15178     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15179             GIVING WS-UNSIGN-WRK3.
 15180
 15181 3342-CONTINUE.
 15182
 15183     IF (PB-I-LF-RATE = ZERO  AND
 15184         PB-I-AH-RATE = ZERO)
 15185         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15186            WS-AH-SPECIAL-CALC-CD = 'O'
 15187              NEXT SENTENCE
 15188         ELSE
 15189             GO TO 3345-EDIT-CONTINUE.
 15190
 15191     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15192         NEXT SENTENCE
 15193     ELSE
 15194     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15195        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15196           IF (PB-REISSUED-CERT         OR
 15197               PB-POLICY-IS-DECLINED    OR
 15198               PB-POLICY-IS-VOIDED)
 15199              NEXT SENTENCE
 15200           ELSE
 15201              IF WS-PREM-REJECT-SW = SPACE
 15202                 MOVE ER-2652    TO WS-ERROR
 15203                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15204                 GO TO 3344-CHECK-AH
 15205              ELSE
 15206                 MOVE ER-2650    TO WS-ERROR
 15207                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15208                 GO TO 3344-CHECK-AH.
 15209
 15210***
 15211***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 275
* EL050.cbl
 15212***
 15213
 15214     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15215         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15216            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15217             (1 + WS-TOL-LF-PREM-PCT)
 15218         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15219            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15220             (1 - WS-TOL-LF-PREM-PCT)
 15221     ELSE
 15222         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15223         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15224
 15225***
 15226***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15227***
 15228
 15229     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15230         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15231          WS-TOL-LF-PREM.
 15232
 15233     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15234         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15235          WS-TOL-LF-PREM.
 15236
 15237     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15238        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15239
 15240     IF PB-REISSUED-CERT
 15241        or PB-POLICY-IS-DECLINED
 15242        or PB-POLICY-IS-VOIDED
 15243        continue
 15244     ELSE
 15245        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15246              > WS-TOL-LF-HIGH-PREM-AMT)
 15247           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15248              < WS-TOL-LF-LOW-PREM-AMT))
 15249                      or
 15250           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15251              > WS-TOL-LF-HIGH-PREM-PCT)
 15252           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15253              < WS-TOL-LF-LOW-PREM-PCT))
 15254           IF WS-PREM-REJECT-SW = SPACE
 15255              MOVE ER-2652       TO WS-ERROR
 15256              PERFORM 9900-ERROR-FORMAT
 15257                                 THRU 9900-EXIT
 15258           ELSE
 15259              MOVE ER-2650       TO WS-ERROR
 15260              PERFORM 9900-ERROR-FORMAT
 15261                                 THRU 9900-EXIT
 15262           end-if
 15263        end-if
 15264     end-if
 15265
 15266*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15267*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15268*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15269*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 276
* EL050.cbl
 15270
 15271     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15272        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15273                      OR
 15274           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15275           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15276           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15277           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15278        END-IF
 15279     END-IF
 15280
 15281     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15282        IF WS-COMP-MAX-CAP GREATER THAN +0
 15283           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15284              IF (PB-REISSUED-CERT         OR
 15285                  PB-POLICY-IS-DECLINED    OR
 15286                  PB-POLICY-IS-VOIDED)
 15287                 NEXT SENTENCE
 15288              ELSE
 15289                  MOVE ER-2646   TO  WS-ERROR
 15290                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15291
 15292 3344-CVL-TOLERANCE-CHECK.
 15293
 15294      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15295          GO TO 3344-CHECK-AH.
 15296
 15297      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15298          GO TO 3344-CHECK-AH.
 15299
 15300      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15301                                     WS-UNSIGN-WRK6.
 15302
 15303      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15304          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15305                                 + PB-I-LF-PREMIUM-AMT
 15306                                 - PB-I-LF-PREM-CALC.
 15307
 15308      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15309          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15310                                 + PB-I-LF-ALT-PREMIUM-AMT
 15311                                 - PB-I-LF-ALT-PREM-CALC.
 15312
 15313      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15314          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15315              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15316                 MOVE ER-2652    TO  WS-ERROR
 15317                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15318              ELSE
 15319                 MOVE ER-2650    TO  WS-ERROR
 15320                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15321
 15322      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15323          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 15324              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15325                 MOVE ER-2652    TO  WS-ERROR
 15326                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15327              ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 277
* EL050.cbl
 15328                 MOVE ER-2650    TO  WS-ERROR
 15329                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15330
 15331 3344-CHECK-AH.
 15332
 15333****************************************************************
 15334***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15335***
 15336
 15337     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15338         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15339             (1 + WS-TOL-AH-PREM-PCT)
 15340         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15341             (1 - WS-TOL-AH-PREM-PCT)
 15342     ELSE
 15343         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15344         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15345
 15346***
 15347***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15348***
 15349
 15350     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15351         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15352
 15353     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15354         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15355
 15356     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15357        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15358
 15359     IF (PB-REISSUED-CERT)
 15360        OR (PB-POLICY-IS-DECLINED)
 15361        OR (PB-POLICY-IS-VOIDED)
 15362        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15363        CONTINUE
 15364     ELSE
 15365        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15366              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15367                          or
 15368           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15369              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15370           IF WS-PREM-REJECT-SW = SPACE
 15371              MOVE ER-3052       TO WS-ERROR
 15372              PERFORM 9900-ERROR-FORMAT
 15373                                 THRU 9900-EXIT
 15374           ELSE
 15375              MOVE ER-3050       TO WS-ERROR
 15376              PERFORM 9900-ERROR-FORMAT
 15377                                 THRU 9900-EXIT
 15378           END-IF
 15379        END-IF
 15380     END-IF
 15381     if (pb-company-id = 'DCC' or 'VPP')
 15382        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15383        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15384        and (pb-i-policy-is-monthly)
 15385        compute ws-tol-ah-high-prem-amt =
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 278
* EL050.cbl
 15386           pb-i-tot-fees-calc + ws-tol-ah-prem
 15387        compute ws-tol-ah-low-prem-amt =
 15388           pb-i-tot-fees-calc - ws-tol-ah-prem
 15389        if ws-tol-ah-prem-pct > zeros
 15390           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15391              (1 + ws-tol-ah-prem-pct)
 15392           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15393              (1 - ws-tol-ah-prem-pct)
 15394        else
 15395           move +9999999.99      to ws-tol-ah-high-prem-pct
 15396           move +0               to ws-tol-ah-low-prem-pct
 15397        end-if
 15398        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15399            or
 15400           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15401                          or
 15402           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15403           or
 15404           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15405            move er-3049         to ws-error
 15406           perform 9900-error-format
 15407                                 thru 9900-exit
 15408
 15409        end-if
 15410     end-if
 15411     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15412         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15413             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15414             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15415
 15416     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15417        IF WS-COMP-MAX-CAP GREATER THAN +0
 15418           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15419              IF (PB-REISSUED-CERT         OR
 15420                  PB-POLICY-IS-DECLINED    OR
 15421                  PB-POLICY-IS-VOIDED)
 15422                 NEXT SENTENCE
 15423              ELSE
 15424                  MOVE ER-2646   TO  WS-ERROR
 15425                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15426
 15427     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15428        (WS-COMP-MAX-CAP EQUAL +0)
 15429           GO TO 3345-EDIT-CONTINUE.
 15430
 15431     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15432        GREATER THAN WS-COMP-MAX-CAP
 15433           MOVE ER-2646          TO  WS-ERROR
 15434           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15435
 15436 3345-EDIT-CONTINUE.
 15437
 15438*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15439*       IF PB-ENTRY-BATCH   NUMERIC
 15440*          IF PB-ISSUE
 15441*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15442*          ELSE
 15443*              IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 279
* EL050.cbl
 15444*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15445
 15446*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15447*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15448*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15449*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15450*        ELSE
 15451*            MOVE  ER-1909            TO  WS-ERROR
 15452*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15453
 15454     IF PB-I-POLICY-ACCEPTED
 15455        IF PB-POLICY-IS-DECLINED  OR
 15456           PB-REISSUED-CERT  OR
 15457           PB-REIN-ONLY-CERT  OR
 15458           PB-POLICY-IS-VOIDED
 15459            MOVE  ER-1891         TO  WS-ERROR
 15460            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15461        ELSE
 15462            MOVE SPACE            TO  PB-BATCH-ENTRY
 15463            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15464
 15465     IF PB-I-POLICY-DECLINED
 15466        IF PB-REISSUED-CERT  OR
 15467           PB-REIN-ONLY-CERT  OR
 15468           PB-POLICY-IS-VOIDED
 15469            MOVE  ER-1906         TO  WS-ERROR
 15470            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15471        ELSE
 15472            MOVE  'D'             TO  PB-BATCH-ENTRY
 15473                                      PB-I-ENTRY-STATUS.
 15474
 15475     IF PB-I-NEEDS-UNDERWRITING
 15476        IF PB-POLICY-IS-DECLINED OR
 15477           PB-REISSUED-CERT  OR
 15478           PB-REIN-ONLY-CERT  OR
 15479           PB-POLICY-IS-VOIDED
 15480            MOVE  ER-1907         TO  WS-ERROR
 15481            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15482        ELSE
 15483            MOVE 'U'              TO  PB-BATCH-ENTRY
 15484                                      PB-I-ENTRY-STATUS.
 15485
 15486     IF PB-NEEDS-UNDERWRITING
 15487        MOVE  ER-1901             TO  WS-ERROR
 15488        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15489     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15490        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15491        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15492        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15493           AND (NOT WS-LF-CASH))
 15494                           OR
 15495           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15496           AND (NOT WS-AH-CASH)))
 15497                       AND
 15498           (PB-I-ENTRY-STATUS NOT = '5')
 15499           MOVE 'M'              TO PB-BATCH-ENTRY
 15500                                    PB-I-ENTRY-STATUS
 15501        END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 280
* EL050.cbl
 15502     END-IF
 15503     move pending-business       to ws-passed-erpndb
 15504     move ' '                    to ws-exceed-limit-yn
 15505     perform 7780-call-agg       thru 7780-exit
 15506*    display ' el050 exceed ' ws-exceed-limit-yn
 15507     if ws-exceed-limit-yn = 'Y'
 15508        MOVE  ER-9813            TO WS-ERROR
 15509        move 'Y'                 to ws-9813-sw
 15510        PERFORM  9900-ERROR-FORMAT
 15511                                 THRU 9900-EXIT
 15512     end-if
 15513     if (PB-EXCEEDED-LIMIT-FORCED)
 15514        and (ws-9813-sw = 'Y')
 15515        subtract +1 from PB-NO-OF-ERRORS
 15516        move er-9823             to ws-error
 15517        PERFORM  9900-ERROR-FORMAT
 15518                                 THRU 9900-EXIT
 15519     end-if
 15520     IF  PB-COMPANY-ID NOT = 'NCL'
 15521         GO TO 3999-END-EDIT.
 15522
 15523     IF PB-REISSUED-CERT  OR
 15524        PB-POLICY-IS-DECLINED  OR
 15525        PB-POLICY-IS-VOIDED  OR
 15526        PB-I-OB
 15527         GO TO 3999-END-EDIT.
 15528
 15529     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15530         MOVE  ER-2644            TO  WS-ERROR
 15531         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15532         GO TO 3999-END-EDIT.
 15533
 15534     MOVE 'N'                     TO  FORM-MASTER-SW.
 15535     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15536
 15537     IF NOT FORM-MASTER-FOUND
 15538         GO TO 3999-END-EDIT.
 15539
 15540     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15541                                      FORM-MASTER-AH-SW.
 15542
 15543     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15544         MOVE  +1                 TO SUB6
 15545         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15546
 15547     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15548         MOVE  +1                 TO SUB6
 15549         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15550
 15551     IF LF-FORM-MASTER-FOUND  OR
 15552        AH-FORM-MASTER-FOUND
 15553         GO TO 3360-CHECK-FORM-LIMITS
 15554     ELSE
 15555         GO TO 3999-END-EDIT.
 15556
 15557******************************************************************
 15558*                  3350-GET-ERFORM                               *
 15559*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 281
* EL050.cbl
 15560*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15561******************************************************************
 15562
 15563 3350-GET-ERFORM.
 15564
 15565     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15566         GO TO  3350-ERFORM-GETMAIN.
 15567
 15568     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15569     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15570     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15571     MOVE 'Y'                     TO FORM-MASTER-SW.
 15572
 15573     IF PB-CANCELLATION
 15574         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15575            PB-SV-STATE          EQUAL   FO-STATE       AND
 15576            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15577              GO TO 3350-EXIT
 15578         ELSE
 15579             NEXT SENTENCE
 15580     ELSE
 15581         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15582            PB-SV-STATE          EQUAL   FO-STATE       AND
 15583            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15584              GO TO 3350-EXIT.
 15585
 15586 3350-ERFORM-GETMAIN.
 15587
 15588     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15589     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15590
 15591 3350-ERFORM-READ.
 15592
 15593     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15594     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15595     IF PB-CANCELLATION
 15596         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15597     ELSE
 15598         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15599     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15600
 15601     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15602
 15603     IF FORM-MASTER-FOUND
 15604       IF PB-CANCELLATION
 15605          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15606             PB-SV-STATE          EQUAL   FO-STATE       AND
 15607             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15608              GO  TO 3350-EXIT
 15609          ELSE
 15610              NEXT SENTENCE
 15611       ELSE
 15612          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15613             PB-SV-STATE          EQUAL   FO-STATE       AND
 15614             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15615              GO  TO 3350-EXIT.
 15616
 15617     MOVE  'N'                    TO  FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 282
* EL050.cbl
 15618     MOVE  ER-1895                TO  WS-ERROR.
 15619     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15620
 15621 3350-EXIT.
 15622      EXIT.
 15623
 15624******************************************************************
 15625*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15626*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15627*   VALID FOR THE POLICY FORM USED.                              *
 15628******************************************************************
 15629
 15630 3355-EDIT-FORM-LF-BENEFITS.
 15631
 15632     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15633        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15634         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15635         GO TO   3355-EXIT.
 15636
 15637     IF  SUB6    LESS THAN   +40
 15638         ADD  +1      TO  SUB6
 15639         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15640
 15641     MOVE  ER-1896         TO  WS-ERROR.
 15642     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15643
 15644 3355-EXIT.
 15645      EXIT.
 15646
 15647******************************************************************
 15648*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15649*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15650*   VALID FOR THE POLICY FORM USED.                              *
 15651******************************************************************
 15652
 15653 3356-EDIT-FORM-AH-BENEFITS.
 15654
 15655     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15656        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15657         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15658         GO TO  3356-EXIT.
 15659
 15660      IF  SUB6    LESS THAN     +40
 15661          ADD  +1      TO  SUB6
 15662          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15663
 15664     MOVE  ER-1897         TO  WS-ERROR.
 15665     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15666
 15667 3356-EXIT.
 15668      EXIT.
 15669
 15670******************************************************************
 15671*                  3357-BENEFIT-SEARCH                           *
 15672*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15673*   CANCELLATIONS ONLY.                                          *
 15674******************************************************************
 15675 3357-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 283
* EL050.cbl
 15676     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15677         MOVE +1                          TO SUB6
 15678         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15679
 15680     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15681         MOVE +1                          TO SUB6
 15682         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15683
 15684 3357-EXIT.
 15685     EXIT.
 15686
 15687******************************************************************
 15688*                  3358-BENEFIT-LIFE-SEARCH                      *
 15689*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15690*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15691*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15692******************************************************************
 15693 3358-BENEFIT-LIFE-SEARCH.
 15694     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15695       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15696         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15697           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15698              IF FO-PLAN-REFUND-METHOD (SUB6)
 15699                     IS GREATER THAN SPACES
 15700                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15701                                          WS-LF-REFUND-CALC
 15702                 GO TO 3358-EXIT.
 15703
 15704     IF SUB6 LESS THAN +40
 15705         ADD +1                 TO SUB6
 15706         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15707
 15708 3358-EXIT.
 15709     EXIT.
 15710******************************************************************
 15711*                  3359-BENEFIT-AH-SEARCH                        *
 15712*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15713*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15714*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15715******************************************************************
 15716 3359-BENEFIT-AH-SEARCH.
 15717     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15718       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15719         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15720           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15721              IF FO-PLAN-REFUND-METHOD (SUB6)
 15722                      IS GREATER THAN SPACES
 15723                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15724                                          WS-AH-REFUND-CALC
 15725                 GO TO 3359-EXIT.
 15726
 15727     IF SUB6 LESS THAN +40
 15728         ADD +1                 TO SUB6
 15729         GO TO 3359-BENEFIT-AH-SEARCH.
 15730
 15731 3359-EXIT.
 15732     EXIT.
 15733
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 284
* EL050.cbl
 15734******************************************************************
 15735*                  3360-CHECK-FORM-LIMITS                        *
 15736*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15737*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15738******************************************************************
 15739
 15740 3360-CHECK-FORM-LIMITS.
 15741
 15742     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15743         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15744
 15745     IF NOT LF-FORM-MASTER-FOUND
 15746         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15747
 15748 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15749
 15750     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15751       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15752        WS-LF-JOINT-INDICATOR = 'J'  AND
 15753        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15754         IF PB-COMPANY-ID = 'NCL'
 15755            MOVE  ER-1911          TO  WS-ERROR
 15756            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15757         ELSE
 15758            MOVE  ER-1892          TO  WS-ERROR
 15759            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15760
 15761 3360-CHECK-FORM-LF-ATT-AGE.
 15762
 15763     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15764
 15765     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15766         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15767         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15768            IF PB-COMPANY-ID = 'NCL'
 15769                MOVE  ER-1913      TO  WS-ERROR
 15770                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15771            ELSE
 15772                MOVE  ER-1894      TO  WS-ERROR
 15773                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15774
 15775 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15776
 15777     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15778         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15779         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15780            IF PB-COMPANY-ID = 'NCL'
 15781                MOVE  ER-1914      TO  WS-ERROR
 15782                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15783            ELSE
 15784                MOVE  ER-1899      TO  WS-ERROR
 15785                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15786
 15787 3360-CHECK-FORM-LF-TERM-BAMT.
 15788
 15789     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15790         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15791         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 285
* EL050.cbl
 15792           IF  PB-COMPANY-ID = 'NCL'
 15793               MOVE  ER-1916       TO  WS-ERROR
 15794               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15795           ELSE
 15796               MOVE  ER-1902       TO  WS-ERROR
 15797               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15798
 15799     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15800                                    PB-I-LF-ALT-BENEFIT-AMT.
 15801
 15802     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15803         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15804         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15805             IF  PB-COMPANY-ID = 'NCL'
 15806                 MOVE  ER-1918     TO  WS-ERROR
 15807                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15808             ELSE
 15809                 MOVE  ER-1904     TO  WS-ERROR
 15810                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15811
 15812******************************************************************
 15813*                  3360-CHECK-FORM-AH-LIMITS                     *
 15814*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15815*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15816******************************************************************
 15817
 15818 3360-CHECK-FORM-AH-LIMITS.
 15819
 15820     IF NOT AH-FORM-MASTER-FOUND
 15821         GO TO 3999-END-EDIT.
 15822
 15823 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15824
 15825     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15826       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15827        WS-AH-JOINT-INDICATOR = 'J'  AND
 15828        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15829         IF PB-COMPANY-ID = 'NCL'
 15830            MOVE  ER-1912          TO  WS-ERROR
 15831            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15832         ELSE
 15833            MOVE  ER-1893          TO  WS-ERROR
 15834            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15835
 15836 3360-CHECK-FORM-AH-ATT-AGE.
 15837
 15838     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15839
 15840     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15841         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15842         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15843            IF PB-COMPANY-ID = 'NCL'
 15844                MOVE  ER-1913      TO  WS-ERROR
 15845                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15846            ELSE
 15847                MOVE  ER-1894      TO  WS-ERROR
 15848                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15849
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 286
* EL050.cbl
 15850 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15851
 15852     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15853         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15854         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15855            IF PB-COMPANY-ID = 'NCL'
 15856                MOVE  ER-1915      TO  WS-ERROR
 15857                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15858            ELSE
 15859                MOVE  ER-1900      TO  WS-ERROR
 15860                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15861
 15862 3360-CHECK-FORM-AH-TERM-BAMT.
 15863
 15864     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15865         FO-AH-MAX-TERM    GREATER THAN  +0
 15866         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15867             IF  PB-COMPANY-ID = 'NCL'
 15868                 MOVE  ER-1917     TO  WS-ERROR
 15869                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15870             ELSE
 15871                  MOVE  ER-1903    TO  WS-ERROR
 15872                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15873
 15874     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15875         FO-MAX-AH-AMT    GREATER THAN  +0
 15876         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15877             IF  PB-COMPANY-ID = 'NCL'
 15878                 MOVE  ER-1919     TO  WS-ERROR
 15879                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15880             ELSE
 15881                 MOVE  ER-1905     TO  WS-ERROR
 15882                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15883
 15884     GO TO 3999-END-EDIT.
 15885
 15886******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 287
* EL050.cbl
 15888 3400-edit-vin.
 15889
 15890     move spaces                 to hldi-pass-area
 15891     MOVE PB-I-VIN               TO WS-WORK-VIN
 15892     MOVE +8                     TO V2
 15893     MOVE ZEROS                  TO WS-VIN-TOTAL
 15894     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15895      (V1 > 17)
 15896        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15897           MOVE ER-3825          TO WS-ERROR
 15898           PERFORM 9900-ERROR-FORMAT
 15899                                 THRU 9900-EXIT
 15900        ELSE
 15901           IF V1 = 8
 15902              MOVE 10            TO V2
 15903           END-IF
 15904           IF V1 = 9
 15905              MOVE 0             TO V2
 15906           END-IF
 15907           IF V1 = 10
 15908              MOVE 9             TO V2
 15909           END-IF
 15910           IF WS-WORK-VIN (V1:1) NUMERIC
 15911              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15912               + (WS-WORK-VIN-N (V1) * V2)
 15913           ELSE
 15914              MOVE WS-WORK-VIN (V1:1)
 15915                            TO WS-HEX-BYTE
 15916              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15917              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15918               + (WS-NUM (V3) * V2)
 15919           END-IF
 15920           COMPUTE V2 = V2 - 1
 15921        END-IF
 15922     END-PERFORM
 15923     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15924     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15925        REMAINDER WS-VIN-REMAINDER
 15926     IF ((WS-WORK-VIN (9:1) = 'X')
 15927        AND (WS-VIN-REMAINDER = 10))
 15928                OR
 15929        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15930        if pb-company-id = 'VPP'
 15931           perform 3410-check-with-hldi
 15932                                 thru 3410-exit
 15933        end-if
 15934     ELSE
 15935        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15936           MOVE ER-3826          TO WS-ERROR
 15937           PERFORM 9900-ERROR-FORMAT
 15938                                 THRU 9900-EXIT
 15939        ELSE
 15940           MOVE ER-3827          TO WS-ERROR
 15941           PERFORM 9900-ERROR-FORMAT
 15942                                 THRU 9900-EXIT
 15943        END-IF
 15944     END-IF
 15945
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 288
* EL050.cbl
 15946     .
 15947 3400-exit.
 15948     exit.
 15949 3410-check-with-hldi.
 15950     move spaces                 to hldi-pass-area
 15951     move pb-i-vin               to pa-vin
 15952     perform 7785-call-hldi      thru 7785-exit
 15953*    display 'PA-VIN        ' PA-VIN
 15954*    display 'PA-ErrorCode  ' PA-ErrorCode
 15955*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 15956*    display 'PA-ModelYear  ' PA-ModelYear
 15957*    display 'PA-MakeName   ' PA-MakeName
 15958*    display 'PA-ModelName  ' PA-ModelName
 15959*    display 'PA-SeriesName ' PA-SeriesName
 15960     if pa-errorcode (1:1) not = '0'
 15961        move spaces              to hldi-pass-area
 15962        move pb-i-vin            to pa-vin
 15963*       move pa-errordesc        to pa-seriesname
 15964*       perform 7786-call-hldim  thru 7786-exit
 15965*       display 'PA-VIN        ' PA-VIN
 15966*       display 'PA-ErrorCode  ' PA-ErrorCode
 15967*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 15968*       display 'PA-ModelYear  ' PA-ModelYear
 15969*       display 'PA-MakeName   ' PA-MakeName
 15970*       display 'PA-ModelName  ' PA-ModelName
 15971*       display 'PA-SeriesName ' PA-SeriesName
 15972     end-if
 15973     .
 15974 3410-exit.
 15975     exit.
 15976******************************************************************
 15977*                  E D I T   C A N C E L                         *
 15978******************************************************************
 15979
 15980 3700-EDIT-CANCEL.
 15981     IF PB-COMPANY-ID = 'DMD'
 15982         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15983                                         WS-RES-MUNI-TAX
 15984                                         PB-CI-STATE-TAX
 15985                                         PB-CI-MUNI-TAX
 15986         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15987
 15988*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15989*       IF PB-ENTRY-BATCH  NUMERIC
 15990*          IF PB-CANCELLATION
 15991*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15992*          ELSE
 15993*             IF PB-ISSUE
 15994*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15995
 15996     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15997        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15998     END-IF
 15999*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 16000*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 16001
 16002     IF CM-ENTRY-STATUS = 'V'
 16003        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 289
* EL050.cbl
 16004        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16005        GO TO 3999-END-EDIT.
 16006
 16007     IF CM-ENTRY-STATUS = 'D'
 16008        MOVE ER-2781             TO WS-ERROR
 16009        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16010        GO TO 3999-END-EDIT.
 16011
 16012     IF CM-ENTRY-STATUS = 'U'
 16013        MOVE ER-2782             TO WS-ERROR
 16014        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16015
 16016***************************************************************
 16017*                                                             *
 16018*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16019*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16020*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16021*   OF ANOTHER COVERAGE.                                      *
 16022*                                                             *
 16023***************************************************************
 16024
 16025     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16026                                    PB-C-AH-CANCEL-VOID-SW.
 16027
 16028     IF PB-C-LF-CANCEL-AMT = ZERO
 16029        NEXT SENTENCE
 16030     ELSE
 16031        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16032           AND
 16033           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16034               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16035               MOVE ER-2745           TO WS-ERROR
 16036               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16037
 16038     IF PB-C-AH-CANCEL-AMT = ZERO
 16039        NEXT SENTENCE
 16040     ELSE
 16041        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16042           AND
 16043           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16044               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16045               MOVE ER-2745           TO WS-ERROR
 16046               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16047
 16048     IF WS-LF-EARNINGS-CALC = '4'
 16049        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16050
 16051     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 16052     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16053     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16054     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16055     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16056     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16057
 16058     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16059                                      PB-C-AH-REF-CALC.
 16060     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16061
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 290
* EL050.cbl
 16062******************************************************************
 16063*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16064*             TO VALIDATE COVERAGE.                              *
 16065******************************************************************
 16066
 16067     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16068        PB-C-LF-CANCEL-AMT = ZEROS
 16069          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16070      ELSE
 16071          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16072
 16073     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16074        PB-C-AH-CANCEL-AMT = ZEROS
 16075          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16076      ELSE
 16077          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16078
 16079     EVALUATE TRUE
 16080         WHEN PB-CANCEL-FORCE             OR
 16081              PB-CANCEL-DATE-FORCED       OR
 16082              PB-FORCE-OFF
 16083                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16084                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16085                  END-IF
 16086         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16087               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16088              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16089                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16090         WHEN OTHER
 16091              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16092                 MOVE ER-2794              TO WS-ERROR
 16093              ELSE
 16094                 MOVE ER-2749              TO WS-ERROR
 16095              END-IF
 16096              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16097     END-EVALUATE.
 16098
 16099
 16100*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16101*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16102*            MOVE  ER-1909            TO  WS-ERROR
 16103*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16104*        ELSE
 16105*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16106
 16107     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16108     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16109        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 16110     ELSE
 16111        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16112     END-IF
 16113     .
 16114 3705-EDIT-CANCEL-DT.
 16115
 16116     IF LF-COVERAGE-CANCELLED
 16117        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16118         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16119         MOVE WS-CURRENT-MONTH-END
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 291
* EL050.cbl
 16120                                 TO DC-BIN-DATE-2
 16121         SET ELAPSED-BETWEEN-BIN TO TRUE
 16122*        MOVE 1                  TO DC-OPTION-CODE
 16123         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16124         IF DATE-CONVERSION-ERROR
 16125            NEXT SENTENCE
 16126          ELSE
 16127             IF DC-ELAPSED-DAYS GREATER +180
 16128                IF PB-CANCEL-DATE-FORCED  OR
 16129                   PB-CANCEL-DATE-FORCED-NO-FEE
 16130                      MOVE ER-2751  TO WS-ERROR
 16131                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16132                 ELSE
 16133                   MOVE ER-2752  TO WS-ERROR
 16134                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16135
 16136     IF AH-COVERAGE-CANCELLED
 16137        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16138         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16139         MOVE WS-CURRENT-MONTH-END
 16140                                 TO DC-BIN-DATE-2
 16141         SET ELAPSED-BETWEEN-BIN TO TRUE
 16142*        MOVE 1                  TO DC-OPTION-CODE
 16143         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16144         IF DATE-CONVERSION-ERROR
 16145            NEXT SENTENCE
 16146          ELSE
 16147             IF DC-ELAPSED-DAYS GREATER +180
 16148                IF PB-CANCEL-DATE-FORCED OR
 16149                   PB-CANCEL-DATE-FORCED-NO-FEE
 16150                      MOVE ER-2751  TO WS-ERROR
 16151                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16152                 ELSE
 16153                   MOVE ER-2752  TO WS-ERROR
 16154                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16155
 16156     IF WS-ERROR = ER-2752
 16157        AND (PB-COMPANY-ID = 'ABL'
 16158         OR  PB-COMPANY-ID = 'FGL'
 16159         OR  PB-COMPANY-ID = 'IST'
 16160         OR  PB-COMPANY-ID = 'JHL'
 16161         OR  PB-COMPANY-ID = 'LAP'
 16162         OR  PB-COMPANY-ID = 'LBL'
 16163         OR  PB-COMPANY-ID = 'NCB'
 16164         OR  PB-COMPANY-ID = 'NLI'
 16165         OR  PB-COMPANY-ID = 'OFI'
 16166         OR  PB-COMPANY-ID = 'PLI'
 16167         OR  PB-COMPANY-ID = 'TAO'
 16168         OR  PB-COMPANY-ID = 'TIC'
 16169         OR  PB-COMPANY-ID = 'HER'
 16170         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16171         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16172            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16173            MOVE ER-2762     TO WS-ERROR
 16174            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16175
 16176     IF LF-COVERAGE-CANCELLED
 16177        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 292
* EL050.cbl
 16178        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16179             MOVE ER-2733         TO WS-ERROR
 16180             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16181
 16182     IF AH-COVERAGE-CANCELLED
 16183        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16184        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16185              MOVE ER-2733        TO WS-ERROR
 16186              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16187
 16188     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16189        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16190        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16191           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16192            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16193              IF PB-COMPANY-ID NOT = 'LAP'
 16194               MOVE ER-2704            TO WS-ERROR
 16195               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16196
 16197     IF CERT-WAS-NOT-FOUND
 16198         GO TO 3999-END-EDIT.
 16199
 16200     IF PB-COMPANY-ID EQUAL 'CDC'
 16201        IF LF-COVERAGE-CANCELLED
 16202           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16203            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16204            MOVE PB-C-LF-CANCEL-DT
 16205                                 TO DC-BIN-DATE-2
 16206            SET ELAPSED-BETWEEN-BIN TO TRUE
 16207*           MOVE 1               TO DC-OPTION-CODE
 16208            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16209            IF DATE-CONVERSION-ERROR
 16210               NEXT SENTENCE
 16211             ELSE
 16212                IF DC-ELAPSED-DAYS GREATER +60
 16213                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16214
 16215     IF PB-COMPANY-ID EQUAL 'CDC'
 16216        IF AH-COVERAGE-CANCELLED
 16217           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16218            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16219            MOVE PB-C-AH-CANCEL-DT
 16220                                 TO DC-BIN-DATE-2
 16221            MOVE +0              TO DC-ELAPSED-DAYS
 16222                                    DC-ELAPSED-MONTHS
 16223            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16224*           MOVE 1               TO DC-OPTION-CODE
 16225            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16226            IF DATE-CONVERSION-ERROR
 16227               NEXT SENTENCE
 16228             ELSE
 16229                IF DC-ELAPSED-DAYS GREATER +60
 16230                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16231
 16232     MOVE +0                     TO DC-ELAPSED-DAYS
 16233                                    DC-ELAPSED-MONTHS.
 16234
 16235     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 293
* EL050.cbl
 16236        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16237          MOVE 'Z'                TO PB-CI-OB-FLAG
 16238          MOVE ER-2767            TO WS-ERROR
 16239          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16240          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16241          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16242          GO TO 3775-OVER-REF-CHK
 16243        ELSE
 16244          MOVE ZEROS              TO PB-CI-LIVES
 16245                                     PB-C-LIVES
 16246          IF PB-CI-OB-FLAG NOT = 'B'
 16247             MOVE SPACE           TO PB-CI-OB-FLAG.
 16248
 16249     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16250         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16251     ELSE
 16252         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16253
 16254     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16255        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16256            MOVE ER-2760         TO WS-ERROR
 16257            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16258
 16259     IF LF-COVERAGE-CANCELLED
 16260        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16261         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16262            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16263               MOVE ER-2774       TO WS-ERROR
 16264               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16265
 16266     IF AH-COVERAGE-CANCELLED
 16267        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16268         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16269            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16270               MOVE ER-2775       TO WS-ERROR
 16271               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16272
 16273     IF LF-COVERAGE-CANCELLED
 16274        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16275         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16276            MOVE ER-2776         TO WS-ERROR
 16277            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16278
 16279     IF AH-COVERAGE-CANCELLED
 16280        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16281         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16282            MOVE ER-2777         TO WS-ERROR
 16283            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16284
 16285     IF LF-COVERAGE-CANCELLED
 16286        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16287        if pb-ci-lf-expire-dt = low-values or spaces
 16288           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16289           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16290           MOVE PB-CI-EXTENTION-DAYS
 16291                                 TO DC-ELAPSED-DAYS
 16292           SET BIN-PLUS-ELAPSED  TO TRUE
 16293           PERFORM 8500-DATE-CONVERT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 294
* EL050.cbl
 16294                                 THRU 8500-EXIT
 16295           IF DATE-CONVERSION-ERROR
 16296              move low-values    to dc-bin-date-2
 16297           end-if
 16298        else
 16299           move pb-ci-lf-expire-dt
 16300                                 to dc-bin-date-2
 16301        end-if
 16302        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16303           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16304                             OR  'FIA'
 16305              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16306           ELSE
 16307              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16308              MOVE ER-2731       TO WS-ERROR
 16309              PERFORM 9900-ERROR-FORMAT
 16310                                 THRU 9900-EXIT
 16311           end-if
 16312        end-if
 16313     end-if
 16314*    IF LF-COVERAGE-CANCELLED
 16315*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16316*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16317*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16318*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16319*        SET BIN-PLUS-ELAPSED      TO TRUE
 16320*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16321*        IF DATE-CONVERSION-ERROR
 16322*           NEXT SENTENCE
 16323*         ELSE
 16324*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16325*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16326*                            OR  'FIA'
 16327*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16328*              ELSE
 16329*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16330*               MOVE ER-2731       TO WS-ERROR
 16331*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16332     .
 16333 3705-EDIT-AH-CANCEL-DT.
 16334     IF AH-COVERAGE-CANCELLED
 16335        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16336        if pb-ci-AH-expire-dt = low-values or spaces
 16337           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16338           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16339           MOVE PB-CI-EXTENTION-DAYS
 16340                                 TO DC-ELAPSED-DAYS
 16341           SET BIN-PLUS-ELAPSED  TO TRUE
 16342           PERFORM 8500-DATE-CONVERT
 16343                                 THRU 8500-EXIT
 16344           IF DATE-CONVERSION-ERROR
 16345              move low-values    to dc-bin-date-2
 16346           end-if
 16347        else
 16348           move pb-ci-ah-expire-dt
 16349                                 to dc-bin-date-2
 16350        end-if
 16351        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 295
* EL050.cbl
 16352           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16353                             OR  'FIA'
 16354              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16355           ELSE
 16356              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16357              MOVE ER-2771       TO WS-ERROR
 16358              PERFORM 9900-ERROR-FORMAT
 16359                                 THRU 9900-EXIT
 16360           end-if
 16361        end-if
 16362     end-if
 16363*    IF AH-COVERAGE-CANCELLED
 16364*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16365*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16366*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16367*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16368**       MOVE 6                    TO DC-OPTION-CODE
 16369*        SET BIN-PLUS-ELAPSED      TO TRUE
 16370*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16371*        IF DATE-CONVERSION-ERROR
 16372*           NEXT SENTENCE
 16373*         ELSE
 16374*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16375*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16376*                             OR 'FIA'
 16377*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16378*             ELSE
 16379*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16380*              MOVE ER-2771       TO WS-ERROR
 16381*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16382     .
 16383 3705-EDIT-CONTINUED.
 16384
 16385*    IF LF-COVERAGE-CANCELLED
 16386*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16387*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16388*            MOVE ER-2727         TO WS-ERROR
 16389*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16390*
 16391*    IF AH-COVERAGE-CANCELLED
 16392*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16393*        IF PB-COMPANY-ID = 'ACE'
 16394*           MOVE ER-2727        TO WS-ERROR
 16395*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16396*        ELSE
 16397*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16398*              MOVE ER-2727     TO WS-ERROR
 16399*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16400
 16401     IF PB-COMPANY-ID = 'ACE'
 16402       IF AH-COVERAGE-CANCELLED
 16403         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16404           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16405              MOVE ER-2732      TO WS-ERROR
 16406              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16407
 16408     IF PB-COMPANY-ID      EQUAL   'HER'
 16409        IF WS-ERROR        EQUAL   ER-2727
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 296
* EL050.cbl
 16410            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16411            MOVE  ER-2725          TO  WS-ERROR
 16412            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16413
 16414     IF PB-C-CLAIM-CREATED-CANCEL
 16415            MOVE ER-2748         TO WS-ERROR
 16416            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16417
 16418     IF PB-C-LAST-NAME NOT = SPACES
 16419         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16420            MOVE ER-2747         TO WS-ERROR
 16421            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16422
 16423 3710-EDIT-LUMP-SUM-PRIOR.
 16424
 16425     IF AH-COVERAGE-CANCELLED
 16426         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16427             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16428                MOVE ER-2735    TO WS-ERROR
 16429                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16430
 16431     IF LF-COVERAGE-CANCELLED
 16432         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16433             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16434                MOVE ER-2735    TO WS-ERROR
 16435                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16436
 16437 3710-EDIT-PRIOR-DEATH.
 16438
 16439*    IF LF-COVERAGE-CANCELLED
 16440*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16441*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16442*           (NOT PB-CI-OB)
 16443*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16444*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16445*                   MOVE ER-2732  TO WS-ERROR
 16446*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16447*
 16448*    IF AH-COVERAGE-CANCELLED
 16449*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16450*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16451*           (NOT PB-CI-OB)
 16452*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16453*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16454*                   MOVE ER-2732  TO WS-ERROR
 16455*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16456
 16457     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 16458         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16459            (NOT PB-COMP-LF-CANCEL)
 16460             NEXT SENTENCE
 16461         ELSE
 16462           IF PB-C-LF-CANCEL-VOIDED
 16463              NEXT SENTENCE
 16464           ELSE
 16465              MOVE ER-2753      TO WS-ERROR
 16466              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16467
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 297
* EL050.cbl
 16468     IF CANCEL-FUTURE-DT
 16469         GO TO 3999-END-EDIT.
 16470
 16471 3715-GET-REMAIN-TERM-LF.
 16472
 16473     IF NO-LF-BENEFIT-MATCH  OR
 16474        WS-LF-BENEFIT-CD = ZEROS
 16475        GO TO 3730-GET-AH-REMAIN-TERM.
 16476
 16477     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16478     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16479     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16480     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16481     MOVE PB-SV-STATE            TO CP-STATE.
 16482     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16483     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16484     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16485     MOVE '2'                    TO CP-PROCESS-TYPE.
 16486     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16487     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16488     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16489     IF (PB-COMPANY-ID = 'CID')
 16490        AND (CP-STATE-STD-ABBRV = 'WI')
 16491        MOVE '7'                 TO CP-REM-TERM-METHOD
 16492        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16493     ELSE
 16494        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16495        MOVE WS-REM-TRM-CALC-OPTION
 16496                                 TO CP-REM-TRM-CALC-OPTION
 16497     END-IF
 16498**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16499     IF (PB-COMPANY-ID = 'CID')
 16500        AND (CP-STATE-STD-ABBRV = 'MO')
 16501        AND (PB-CERT-EFF-DT >= X'9B41')
 16502        AND (PB-CERT-EFF-DT <= X'A2FB')
 16503        MOVE '7'                 TO CP-REM-TERM-METHOD
 16504        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16505     END-IF
 16506     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16507                                    CP-LOAN-TERM.
 16508     IF CP-TRUNCATED-LIFE
 16509        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16510
 16511     IF CP-TERM-IS-DAYS
 16512         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16513     ELSE
 16514         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16515
 16516     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16517
 16518     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16519
 16520     IF LF-COVERAGE-CANCELLED
 16521        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16522        NEXT SENTENCE
 16523      ELSE
 16524          GO TO 3730-GET-AH-REMAIN-TERM.
 16525
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 298
* EL050.cbl
 16526 3720-GET-LF-REFUND.
 16527
 16528     IF PB-C-LF-CANCEL-VOIDED
 16529        GO TO 3730-GET-AH-REMAIN-TERM
 16530     end-if
 16531
 16532     IF PB-COMPANY-ID EQUAL 'BOA'
 16533         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16534         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16535         GO TO 3730-GET-AH-REMAIN-TERM.
 16536
 16537     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16538        (WS-AH-SPECIAL-CALC-CD = 'M')
 16539         MOVE ER-2767            TO WS-ERROR
 16540         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16541         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16542         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16543         GO TO 3780-UPDATE-CANCEL-CERT.
 16544
 16545*    if (ws-lf-earnings-calc = '6')
 16546*       or (pb-c-lf-refund-override = '6')
 16547*       move cp-remaining-term-1 to cp-remaining-term-2
 16548*    end-if
 16549     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16550
 16551     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16552     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16553     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16554     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16555     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16556     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16557     IF PB-COMPANY-ID = 'DCC'
 16558        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16559        IF PDEF-MASTER-FOUND
 16560           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16561              (V1 > +8)
 16562              OR (PD-PROD-CODE (V1) = 'L')
 16563           END-PERFORM
 16564           IF V1 < +9
 16565              MOVE PD-MAX-AMT (V1)
 16566                           TO CP-R-MAX-TOT-BEN
 16567                              EC-AM-LF-MAX-TOT-BEN
 16568           END-IF
 16569        ELSE
 16570        MOVE ' '                 TO PDEF-MASTER-SW
 16571        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16572        MOVE PB-STATE            TO ERPDEF-STATE
 16573        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16574           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16575        END-IF
 16576        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16577        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16578        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16579        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16580        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16581        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16582        IF PDEF-MASTER-FOUND
 16583           MOVE 'N'              TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 299
* EL050.cbl
 16584           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16585           IF PDEF-MASTER-FOUND
 16586              IF (ERPDEF-KEY-SAVE (1:16) =
 16587                           PD-CONTROL-PRIMARY (1:16))
 16588                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16589                 CONTINUE
 16590              ELSE
 16591                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16592                 IF (ERPDEF-KEY-SAVE (1:16) =
 16593                           PD-CONTROL-PRIMARY (1:16))
 16594                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16595                    CONTINUE
 16596                 ELSE
 16597                    MOVE 'N'     TO PDEF-MASTER-SW
 16598                 END-IF
 16599              END-IF
 16600
 16601              IF PDEF-MASTER-FOUND
 16602                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16603                    (V1 > +8)
 16604                    OR (PD-PROD-CODE (V1) = 'L')
 16605                 END-PERFORM
 16606                 IF V1 < +9
 16607                    MOVE PD-MAX-AMT (V1)
 16608                                 TO CP-R-MAX-TOT-BEN
 16609                                    EC-AM-LF-MAX-TOT-BEN
 16610                 END-IF
 16611              END-IF
 16612           END-IF
 16613           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16614        END-IF
 16615        END-IF
 16616     END-IF
 16617     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16618
 16619     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16620
 16621     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16622                                    PB-C-LF-REM-TERM.
 16623
 16624     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16625     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16626
 16627     IF PB-COMPANY-ID EQUAL 'FLC'
 16628        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16629           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16630           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16631                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16632                    - CM-LF-ITD-DEATH-AMT
 16633           IF PB-C-LF-REF-CALC LESS THAN +0
 16634              MOVE +0            TO PB-C-LF-REF-CALC
 16635              GO TO 3730-GET-AH-REMAIN-TERM
 16636           ELSE
 16637              GO TO 3730-GET-AH-REMAIN-TERM.
 16638
 16639     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16640                            OR '4' OR '5' OR '6' OR '8'
 16641                            OR '9' OR 'G'
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 300
* EL050.cbl
 16642        MOVE PB-C-LF-REFUND-OVERRIDE
 16643                                 TO CP-EARNING-METHOD.
 16644
 16645     if pb-company-id = 'AHL'
 16646        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16647        if cp-class-code = spaces
 16648           move zeros            to cp-class-code
 16649        end-if
 16650     ELSE
 16651        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16652     END-IF
 16653*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16654     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16655     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16656                                    CP-RATING-BENEFIT-AMT.
 16657     IF CP-STATE-STD-ABBRV = 'OR'
 16658         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16659                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16660     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16661     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16662     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16663     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16664     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16665     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16666     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16667     IF WS-DEFAULT-APR NOT NUMERIC
 16668         MOVE ZEROS TO WS-DEFAULT-APR.
 16669****   N O T E   ****
 16670*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16671*      THE OH HARD CODING IN ELCRFNDP
 16672
 16673     IF PB-COMPANY-ID = 'CID'
 16674        IF CP-STATE-STD-ABBRV = 'OH'
 16675           MOVE WS-LF-EARNINGS-CALC
 16676                                 TO CP-EARNING-METHOD
 16677        END-IF
 16678     END-IF
 16679
 16680****   N O T E   ****
 16681
 16682*    IF CP-EARN-AS-NET-PAY
 16683*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16684*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16685*               MOVE WS-DEFAULT-APR
 16686*                                TO  CP-LOAN-APR
 16687*               MOVE ER-3780     TO  WS-ERROR
 16688*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16689*           ELSE
 16690*               MOVE ER-3781     TO  WS-ERROR
 16691*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16692*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16693     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16694
 16695     IF CP-REFUND-TYPE-USED NOT = SPACE
 16696         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16697
 16698     IF CP-ERROR-RATE-IS-ZERO OR
 16699        CP-ERROR-RATE-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 301
* EL050.cbl
 16700        MOVE ER-2740             TO WS-ERROR
 16701        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16702
 16703     IF CP-ERROR-RATE-FILE-NOTOPEN
 16704        MOVE ER-2617             TO WS-ERROR
 16705        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16706
 16707     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16708        AND PB-CI-ENTRY-STATUS = 'M'
 16709        MOVE +0                  TO PB-C-LF-REF-CALC
 16710     ELSE
 16711        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16712     END-IF
 16713
 16714     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16715         GO TO 3730-GET-AH-REMAIN-TERM.
 16716
 16717*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16718*       ADD +1                   TO PB-C-LF-REM-TERM
 16719*                                   CP-REMAINING-TERM
 16720*                                   CP-ORIGINAL-TERM.
 16721
 16722     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16723     MOVE '2'                    TO CP-EARNING-METHOD
 16724                                    CP-RATING-METHOD.
 16725     IF PB-COMPANY-ID = 'CID'
 16726        IF (CP-STATE-STD-ABBRV = 'MN')
 16727           AND (PB-CERT-EFF-DT > X'A4FF')
 16728           AND (WS-LF-EARNINGS-CALC = 'B')
 16729           MOVE '5'              TO CP-EARNING-METHOD
 16730           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16731        END-IF
 16732     END-IF
 16733     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16734                                        CP-REMAINING-BENEFIT
 16735                                        CP-RATING-BENEFIT-AMT.
 16736     IF CP-STATE-STD-ABBRV = 'OR'
 16737         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16738                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16739     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16740     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16741
 16742     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16743
 16744     IF CP-ERROR-RATE-IS-ZERO OR
 16745        CP-ERROR-RATE-NOT-FOUND
 16746        MOVE ER-2740             TO WS-ERROR
 16747        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16748
 16749     IF CP-ERROR-RATE-FILE-NOTOPEN
 16750        MOVE ER-2617             TO WS-ERROR
 16751        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16752
 16753     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16754
 16755******************************************************************
 16756
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 302
* EL050.cbl
 16758 3730-GET-AH-REMAIN-TERM.
 16759     IF NO-AH-BENEFIT-MATCH  OR
 16760        WS-AH-BENEFIT-CD = ZEROS
 16761         GO TO 3770-CHECK-REFUNDS.
 16762
 16763     IF PB-CI-AH-LUMP-SUM-DISAB
 16764         IF  PB-C-AH-CANCEL-AMT = ZERO
 16765            IF NOT PB-COMP-AH-CANCEL
 16766             GO TO 3770-CHECK-REFUNDS.
 16767
 16768     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16769     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16770     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16771     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16772     MOVE PB-SV-STATE            TO CP-STATE.
 16773     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16774     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16775     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16776     MOVE '2'                    TO CP-PROCESS-TYPE.
 16777     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16778     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16779     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16780     IF (PB-COMPANY-ID = 'CID')
 16781        AND (CP-STATE-STD-ABBRV = 'WI')
 16782        MOVE '7'                 TO CP-REM-TERM-METHOD
 16783        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16784     ELSE
 16785        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16786        MOVE WS-REM-TRM-CALC-OPTION
 16787                                 TO CP-REM-TRM-CALC-OPTION
 16788     END-IF
 16789     IF (PB-COMPANY-ID = 'CID')
 16790        AND (CP-STATE-STD-ABBRV = 'MO')
 16791        AND (PB-CERT-EFF-DT >= X'9B41')
 16792        AND (PB-CERT-EFF-DT <= X'A2FB')
 16793        MOVE '7'                 TO CP-REM-TERM-METHOD
 16794        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16795     END-IF
 16796     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16797                                    CP-LOAN-TERM.
 16798     IF NOT CP-TERM-IS-DAYS
 16799         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16800
 16801     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16802
 16803     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16804
 16805     IF AH-COVERAGE-CANCELLED
 16806        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16807        NEXT SENTENCE
 16808      ELSE
 16809         GO TO 3770-CHECK-REFUNDS.
 16810
 16811 3740-GET-AH-REFUND.
 16812
 16813     IF PB-C-AH-CANCEL-VOIDED
 16814        GO TO 3780-UPDATE-CANCEL-CERT
 16815     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 303
* EL050.cbl
 16816
 16817     IF PB-COMPANY-ID = 'BOA'
 16818         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16819         GO TO 3770-CHECK-REFUNDS.
 16820
 16821     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16822*    MOVE ' '                    TO DC-OPTION-CODE
 16823     SET BIN-TO-GREG             TO TRUE
 16824     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16825     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16826                                    PB-C-AH-REM-TERM.
 16827     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16828     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16829
 16830     IF PB-COMPANY-ID EQUAL 'FLC'
 16831        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16832           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16833           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16834                    - CM-AH-ITD-AH-PMT)
 16835           IF PB-C-AH-REF-CALC LESS THAN +0
 16836              MOVE +0            TO PB-C-AH-REF-CALC
 16837              GO TO 3770-CHECK-REFUNDS
 16838           ELSE
 16839              GO TO 3770-CHECK-REFUNDS.
 16840
 16841     IF PB-COMPANY-ID = 'DCC'
 16842        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16843            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16844           MOVE 'S'              TO CP-EARNING-METHOD
 16845        END-IF
 16846     END-IF
 16847     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16848                            OR '4' OR '5' OR '6' OR '8'
 16849                            OR '9' OR 'G' OR 'S'
 16850        MOVE PB-C-AH-REFUND-OVERRIDE
 16851                                 TO CP-EARNING-METHOD.
 16852
 16853     if pb-company-id = 'AHL'
 16854        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16855        if cp-class-code = spaces
 16856           move zeros            to cp-class-code
 16857        end-if
 16858     ELSE
 16859        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16860     END-IF
 16861*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16862     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16863     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16864                                    CP-RATING-BENEFIT-AMT.
 16865     IF CP-STATE-STD-ABBRV = 'OR'
 16866         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16867                                         PB-CI-AH-TERM.
 16868     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16869     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16870     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16871     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16872     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16873     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 304
* EL050.cbl
 16874
 16875     IF CP-STATE-STD-ABBRV = 'OH'
 16876        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16877                                AND 'CID' AND 'DCC' and 'VPP'
 16878                                AND 'AHL')
 16879           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16880              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16881              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16882              MOVE '6' TO CP-EARNING-METHOD
 16883           END-IF
 16884        END-IF
 16885        IF PB-COMPANY-ID = 'CID'
 16886           IF NO-LIFE-COVERAGE
 16887              IF CP-CRITICAL-PERIOD
 16888                 MOVE '2'       TO CP-EARNING-METHOD
 16889              ELSE
 16890                 MOVE '6'       TO CP-EARNING-METHOD
 16891              END-IF
 16892           ELSE
 16893              IF WS-LF-COVERAGE-TYPE = 'L'
 16894                 MOVE '2'       TO CP-EARNING-METHOD
 16895              ELSE
 16896                 IF (PB-CI-LF-TERM > +60) OR
 16897                    (WS-LF-EARNINGS-CALC = '5')
 16898                    IF CP-CRITICAL-PERIOD
 16899                       MOVE '2'  TO CP-EARNING-METHOD
 16900                    ELSE
 16901                       MOVE '6'  TO CP-EARNING-METHOD
 16902                    END-IF
 16903                 ELSE
 16904                    MOVE '1'     TO CP-EARNING-METHOD
 16905                 END-IF
 16906              END-IF
 16907           END-IF
 16908        END-IF
 16909     END-IF
 16910
 16911*    IF CP-STATE-STD-ABBRV = 'VA'
 16912*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16913*          IF CP-ORIGINAL-TERM GREATER 61
 16914*             MOVE '6' TO CP-EARNING-METHOD
 16915*          ELSE
 16916*             MOVE '1' TO CP-EARNING-METHOD.
 16917
 16918     IF WS-DEFAULT-APR NOT NUMERIC
 16919         MOVE ZEROS TO WS-DEFAULT-APR.
 16920     IF CP-EARN-AS-NET-PAY
 16921         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16922            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16923                MOVE WS-DEFAULT-APR
 16924                                 TO  CP-LOAN-APR
 16925                MOVE ER-3780     TO  WS-ERROR
 16926                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16927            ELSE
 16928                MOVE ER-3781     TO  WS-ERROR
 16929                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16930     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16931     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 305
* EL050.cbl
 16932        AND CP-CANCEL-REASON = 'R'
 16933        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16934        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16935     END-IF
 16936     IF PB-COMPANY-ID = 'DCC'
 16937        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16938        AND (CP-EARNING-METHOD = 'D')
 16939        AND (CP-CANCEL-REASON NOT = 'R')
 16940        CONTINUE
 16941     ELSE
 16942        GO TO 3750-CONTINUE
 16943     END-IF
 16944     MOVE ' '                    TO DD-IU-SW
 16945     IF NOT PDEF-MASTER-FOUND
 16946        MOVE ' '                 TO PDEF-MASTER-SW
 16947        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16948        MOVE PB-STATE            TO ERPDEF-STATE
 16949        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16950           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16951        END-IF
 16952        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16953        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16954        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16955        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16956        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16957        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16958        IF PDEF-MASTER-FOUND
 16959           MOVE 'N'              TO PDEF-MASTER-SW
 16960           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16961           IF PDEF-MASTER-FOUND
 16962              IF (ERPDEF-KEY-SAVE (1:16) =
 16963                           PD-CONTROL-PRIMARY (1:16))
 16964                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16965                 CONTINUE
 16966              ELSE
 16967                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16968                 IF (ERPDEF-KEY-SAVE (1:16) =
 16969                           PD-CONTROL-PRIMARY (1:16))
 16970                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16971                    CONTINUE
 16972                 ELSE
 16973                    MOVE ER-2740 TO WS-ERROR
 16974                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16975                    GO TO 3770-CHECK-REFUNDS
 16976                 END-IF
 16977              END-IF
 16978           END-IF
 16979           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16980        END-IF
 16981     END-IF
 16982     IF PDEF-MASTER-FOUND
 16983        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16984           (V1 > +8)
 16985           OR (PD-PROD-CODE (V1) = 'I')
 16986        END-PERFORM
 16987        IF V1 < +9
 16988           SET DD-IU-PRESENT        TO TRUE
 16989        END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 306
* EL050.cbl
 16990        IF WS-AH-DCC-TRUNC = 'T'
 16991           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16992        ELSE
 16993           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16994        END-IF
 16995        EVALUATE TRUE
 16996           WHEN WS-TERM > +168
 16997              MOVE 15               TO V1
 16998           WHEN WS-TERM > +156
 16999              MOVE 14               TO V1
 17000           WHEN WS-TERM > +144
 17001              MOVE 13               TO V1
 17002           WHEN WS-TERM > +132
 17003              MOVE 12               TO V1
 17004           WHEN WS-TERM > +120
 17005              MOVE 11               TO V1
 17006           WHEN WS-TERM > +108
 17007              MOVE 10               TO V1
 17008           WHEN WS-TERM > +96
 17009              MOVE 9                TO V1
 17010           WHEN WS-TERM > +84
 17011              MOVE 8                TO V1
 17012           WHEN WS-TERM > +72
 17013              MOVE 7                TO V1
 17014           WHEN WS-TERM > +60
 17015              MOVE 6                TO V1
 17016           WHEN WS-TERM > +48
 17017              MOVE 5                TO V1
 17018           WHEN WS-TERM > +36
 17019              MOVE 4                TO V1
 17020           WHEN WS-TERM > +24
 17021              MOVE 3                TO V1
 17022           WHEN WS-TERM > +12
 17023              MOVE 2                TO V1
 17024           WHEN OTHER
 17025              MOVE 1                TO V1
 17026        END-EVALUATE
 17027
 17028        EVALUATE TRUE
 17029*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17030*             < +13)
 17031*             AND (DD-IU-PRESENT)
 17032*             MOVE 2                TO V2
 17033*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17034*             MOVE 1                TO V2
 17035           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17036              MOVE 2                TO V2
 17037           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17038              MOVE 3                TO V2
 17039           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17040              MOVE 4                TO V2
 17041           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17042              MOVE 5                TO V2
 17043           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17044              MOVE 6                TO V2
 17045           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17046              MOVE 7                TO V2
 17047           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 307
* EL050.cbl
 17048              MOVE 8                TO V2
 17049           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17050              MOVE 9                TO V2
 17051           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17052              MOVE 10               TO V2
 17053           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17054              MOVE 11               TO V2
 17055           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17056              MOVE 12               TO V2
 17057           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17058              MOVE 13               TO V2
 17059           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17060              MOVE 14               TO V2
 17061           WHEN OTHER
 17062              MOVE 15               TO V2
 17063        END-EVALUATE
 17064
 17065        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17066                                 TO CP-DDF-LO-FACT
 17067        MOVE PD-UEP-FACTOR (V1 V2)
 17068                                 TO CP-DDF-HI-FACT
 17069
 17070        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17071        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17072        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17073           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17074        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17075        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17076        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17077           + PD-1ST-YR-ADMIN-ALLOW
 17078
 17079        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17080*       IF PI-CLP-YN = 'Y'
 17081*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17082*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17083*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17084*       END-IF
 17085
 17086        IF DD-IU-PRESENT
 17087           MOVE 'I'              TO CP-EARNING-METHOD
 17088        END-IF
 17089        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17090                                     CP-CLP-RATE-UP
 17091        IF CP-IU-RATE-UP NOT = ZEROS
 17092           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17093              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17094           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17095              / (1 - WS-WORK-FACT)
 17096        END-IF
 17097     END-IF
 17098     .
 17099 3750-CONTINUE.
 17100     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17101
 17102     IF CP-REFUND-TYPE-USED NOT = SPACE
 17103         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17104
 17105     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 308
* EL050.cbl
 17106        CP-ERROR-RATE-NOT-FOUND
 17107        MOVE ER-2740             TO WS-ERROR
 17108        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17109
 17110     IF CP-ERROR-RATE-FILE-NOTOPEN
 17111        MOVE ER-2617             TO WS-ERROR
 17112        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17113     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17114        AND (PB-CI-ENTRY-STATUS = 'M')
 17115        MOVE +0                  TO PB-C-AH-REF-CALC
 17116     ELSE
 17117        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17118     END-IF
 17119     if pb-company-id = 'VPP'
 17120        MOVE cm-ah-clp           to cp-original-premium
 17121        move zeros               to cp-calc-refund
 17122        perform 7600-get-refund  thru 7600-exit
 17123        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17124           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17125        else
 17126           move zeros            to pb-c-ah-rfnd-clp
 17127        end-if
 17128        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17129           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17130           pb-ci-cancel-fee
 17131     end-if
 17132     IF PB-COMPANY-ID = 'DCC'
 17133        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17134        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17135        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17136        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17137        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17138        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17139        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17140        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17141*       if pb-c-cancel-amt < +0
 17142*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17143*       end-if
 17144*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17145     END-IF
 17146     .
 17147 3770-CHECK-REFUNDS.
 17148
 17149     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17150        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17151           MOVE ER-2766          TO WS-ERROR
 17152           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17153           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17154           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17155              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17156
 17157     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17158        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17159           MOVE ER-2766          TO WS-ERROR
 17160           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17161           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17162           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17163              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 309
* EL050.cbl
 17164
 17165     IF PB-COMP-LF-CANCEL
 17166        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17167        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17168           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17169              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17170
 17171     IF PB-COMP-AH-CANCEL
 17172        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17173        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17174           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17175              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17176
 17177     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17178             GIVING WS-UNSIGN-WRK1
 17179     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17180             GIVING WS-UNSIGN-WRK2.
 17181
 17182     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17183         MOVE ZERO TO WS-UNSIGN-WRK1.
 17184
 17185     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17186         MOVE ZERO TO WS-UNSIGN-WRK2.
 17187
 17188     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17189
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 310
* EL050.cbl
 17191
 17192 3772-CONTINUE.
 17193
 17194**********************************
 17195*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17196*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17197*** DOUBLES THE TOLERANCE AMOUNT.
 17198***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17199**********************************
 17200     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17201     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17202         IF WS-REF-REJECT-SW = SPACE
 17203             MOVE ER-2754        TO WS-ERROR
 17204             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17205           ELSE
 17206             MOVE ER-2736        TO WS-ERROR
 17207             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17208**********************************
 17209
 17210 3773-CONTINUE.
 17211
 17212     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17213        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17214           MOVE ER-2723          TO WS-ERROR
 17215           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17216
 17217     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17218        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17219           MOVE ER-2724          TO WS-ERROR
 17220           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17221
 17222     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17223         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17224             (1 + WS-LF-REFUND-OVS-PCT)
 17225     ELSE
 17226         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17227
 17228     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17229         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17230             (1 - WS-TOL-LF-REFUND-PCT)
 17231     ELSE
 17232         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17233
 17234     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17235        AND (PB-CI-ENTRY-STATUS = 'M')
 17236        AND (PB-C-LF-CANCEL-AMT > +0)
 17237        MOVE ER-3843             TO WS-ERROR
 17238        PERFORM 9900-ERROR-FORMAT
 17239                                 THRU 9900-EXIT
 17240     END-IF
 17241     EVALUATE TRUE
 17242        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17243           CONTINUE
 17244        WHEN PB-C-LF-CANCEL-AMT = +0
 17245                 AND PB-C-LF-REF-CALC > +0
 17246           CONTINUE
 17247        WHEN WS-LF-REFUND-OVS-AMT = 0
 17248                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 311
* EL050.cbl
 17249           CONTINUE
 17250        WHEN OTHER
 17251           IF WS-TOL-LF-REFUND  = +0
 17252              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17253           END-IF
 17254           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17255                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17256                          (PB-C-LF-CANCEL-AMT))
 17257              CONTINUE
 17258           ELSE
 17259              IF WS-LF-REFUND-OVS-AMT = +0
 17260                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17261              END-IF
 17262              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17263                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17264                                       PB-C-LF-CANCEL-AMT)
 17265                 CONTINUE
 17266              ELSE
 17267                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17268                   MOVE ER-2754   TO  WS-ERROR
 17269                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17270                 ELSE
 17271                    MOVE ER-2736   TO  WS-ERROR
 17272                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17273                 END-IF
 17274              END-IF
 17275           END-IF
 17276     END-EVALUATE.
 17277
 17278     EVALUATE TRUE
 17279        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17280           CONTINUE
 17281        WHEN PB-C-LF-CANCEL-AMT = +0
 17282                 AND PB-C-LF-REF-CALC > +0
 17283           CONTINUE
 17284        WHEN OTHER
 17285           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17286               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17287              CONTINUE
 17288           ELSE
 17289              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17290               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17291                CONTINUE
 17292              ELSE
 17293                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17294                     MOVE ER-2754   TO  WS-ERROR
 17295                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17296                 ELSE
 17297                     MOVE ER-2736   TO  WS-ERROR
 17298                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17299                 END-IF
 17300              END-IF
 17301           END-IF
 17302     END-EVALUATE.
 17303
 17304     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17305         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17306             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 312
* EL050.cbl
 17307     ELSE
 17308         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17309
 17310     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17311         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17312             (1 - WS-TOL-AH-REFUND-PCT)
 17313     ELSE
 17314         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17315
 17316     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17317        AND (PB-CI-ENTRY-STATUS = 'M')
 17318        AND (PB-C-AH-CANCEL-AMT > +0)
 17319        MOVE ER-3843             TO WS-ERROR
 17320        PERFORM 9900-ERROR-FORMAT
 17321                                 THRU 9900-EXIT
 17322     END-IF
 17323     EVALUATE TRUE
 17324        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17325           CONTINUE
 17326*       WHEN PB-C-AH-REF-CALC = +0 AND
 17327*                  PB-C-AH-CANCEL-AMT > +0
 17328        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17329                   PB-C-AH-REF-CALC > +0
 17330           CONTINUE
 17331        WHEN WS-AH-REFUND-OVS-AMT = +0
 17332                AND WS-TOL-AH-REFUND = +0
 17333           CONTINUE
 17334        WHEN OTHER
 17335           IF WS-TOL-AH-REFUND = +0
 17336              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17337           END-IF
 17338           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17339               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17340                                         PB-C-AH-CANCEL-AMT)
 17341              CONTINUE
 17342           ELSE
 17343              IF WS-AH-REFUND-OVS-AMT = +0
 17344                 MOVE +9999999.99 TO
 17345                         WS-AH-REFUND-OVS-AMT
 17346              END-IF
 17347              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17348                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17349                                         PB-C-AH-CANCEL-AMT)
 17350                 CONTINUE
 17351              ELSE
 17352                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17353                    MOVE ER-2754   TO  WS-ERROR
 17354                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17355                 ELSE
 17356                    MOVE ER-2736   TO  WS-ERROR
 17357                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17358                 END-IF
 17359              END-IF
 17360           END-IF
 17361     END-EVALUATE.
 17362
 17363     EVALUATE TRUE
 17364        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 313
* EL050.cbl
 17365           CONTINUE
 17366*       WHEN PB-C-AH-REF-CALC > +0 AND
 17367*                  PB-C-AH-CANCEL-AMT = +0
 17368        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17369                   PB-C-AH-REF-CALC = +0
 17370           CONTINUE
 17371        WHEN OTHER
 17372           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17373               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17374              CONTINUE
 17375           ELSE
 17376              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17377                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17378                 CONTINUE
 17379              ELSE
 17380                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17381                     MOVE ER-2754   TO  WS-ERROR
 17382                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17383                 ELSE
 17384                     MOVE ER-2736   TO  WS-ERROR
 17385                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17386                 END-IF
 17387              END-IF
 17388           END-IF
 17389     END-EVALUATE.
 17390
 17391     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17392        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17393        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17394           AND  PB-C-LF-REF-CALC < +1.00
 17395           AND  PB-C-AH-REF-CALC < +1.00
 17396           CONTINUE
 17397        ELSE
 17398           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17399              AND (PB-CI-ENTRY-STATUS = 'M')
 17400              CONTINUE
 17401           ELSE
 17402              MOVE ER-2741       TO WS-ERROR
 17403              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17404           END-IF
 17405        END-IF
 17406     END-IF
 17407
 17408     IF (PB-C-LF-CANCEL-AMT = ZERO
 17409        AND WS-LF-BENEFIT-CD NOT = ZERO
 17410        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17411        AND PB-C-LF-REF-CALC NOT = ZERO)
 17412        OR
 17413        (PB-C-LF-CANCEL-AMT = ZERO
 17414        AND WS-LF-BENEFIT-CD NOT = ZERO
 17415        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17416             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17417                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17418                NEXT SENTENCE
 17419             ELSE
 17420                MOVE ER-2739        TO WS-ERROR
 17421                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17422
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 314
* EL050.cbl
 17423     IF (PB-C-AH-CANCEL-AMT = ZERO
 17424        AND WS-AH-BENEFIT-CD NOT = ZERO
 17425        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17426        AND PB-C-AH-REF-CALC NOT = ZERO)
 17427        OR
 17428        (PB-C-AH-CANCEL-AMT = ZERO
 17429        AND WS-AH-BENEFIT-CD NOT = ZERO
 17430        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17431             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17432                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17433                NEXT SENTENCE
 17434             ELSE
 17435                MOVE ER-2738        TO WS-ERROR
 17436                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17437
 17438 3775-OVER-REF-CHK.
 17439
 17440     IF PB-CI-ENTRY-STATUS = '5'
 17441        GO TO 3780-UPDATE-CANCEL-CERT.
 17442
 17443     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17444                              PB-CI-LF-ALT-PREMIUM-AMT.
 17445
 17446     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17447        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17448                                 PB-C-LF-REF-CALC
 17449      ELSE
 17450        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17451                                 PB-C-LF-CANCEL-AMT.
 17452
 17453     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17454        MOVE ER-2755             TO WS-ERROR
 17455        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17456
 17457     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17458
 17459     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17460        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17461                                 PB-C-AH-REF-CALC
 17462      ELSE
 17463        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17464                                 PB-C-AH-CANCEL-AMT.
 17465
 17466     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17467        MOVE ER-2778             TO WS-ERROR
 17468        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17469
 17470     IF PB-CI-OB-FLAG NOT = 'Z'
 17471        NEXT SENTENCE
 17472       ELSE
 17473         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17474            MOVE ER-2757           TO WS-ERROR
 17475            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17476
 17477 3780-UPDATE-CANCEL-CERT.
 17478
 17479     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17480        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 315
* EL050.cbl
 17481        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17482
 17483     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17484         MOVE ER-2729              TO WS-ERROR
 17485         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17486
 17487     IF PB-CI-LF-BENEFIT-CD = ZERO
 17488         GO TO 3780-UPDATE-CONT-1.
 17489
 17490     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17491         GO TO 3780-UPDATE-CONT-1.
 17492
 17493     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17494       AND
 17495        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17496       AND
 17497        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17498       AND
 17499        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17500            NEXT SENTENCE
 17501       ELSE
 17502        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17503          AND
 17504***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17505***       AND
 17506           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17507            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17508               MOVE ER-2730      TO WS-ERROR
 17509               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17510               GO TO 3999-END-EDIT
 17511            ELSE
 17512               GO TO 3999-END-EDIT
 17513        ELSE
 17514            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17515               MOVE ER-2765           TO WS-ERROR
 17516               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17517               GO TO 3785-CHECK-NH.
 17518*              GO TO 3999-END-EDIT.
 17519
 17520 3780-UPDATE-CONT-1.
 17521     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17522
 17523     IF PB-CI-AH-BENEFIT-CD = ZERO
 17524         GO TO 3780-UPDATE-CONT-2.
 17525
 17526     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17527         GO TO 3780-UPDATE-CONT-2.
 17528
 17529     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17530
 17531     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17532       AND
 17533        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17534       AND
 17535        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17536       AND
 17537        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17538            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 316
* EL050.cbl
 17539       ELSE
 17540        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17541          AND
 17542***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17543***       AND
 17544           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17545           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17546            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17547               MOVE ER-2773      TO WS-ERROR
 17548               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17549               GO TO 3999-END-EDIT
 17550            ELSE
 17551               GO TO 3999-END-EDIT
 17552            END-IF
 17553           ELSE
 17554             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17555                IF MSTR-CERT-NO = W-CL-CERT-NO
 17556                   MOVE ER-2890 TO WS-ERROR
 17557                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17558                   GO TO 3999-END-EDIT
 17559                ELSE
 17560                   MOVE ER-2898 TO WS-ERROR
 17561                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17562                   GO TO 3999-END-EDIT
 17563                END-IF
 17564             ELSE
 17565                GO TO 3785-CHECK-NH
 17566             END-IF
 17567           END-IF
 17568          ELSE
 17569            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17570              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17571                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17572                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17573                      MOVE ER-2890 TO WS-ERROR
 17574                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17575                      GO TO 3999-END-EDIT
 17576                   ELSE
 17577                      MOVE ER-2898 TO WS-ERROR
 17578                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17579                      GO TO 3999-END-EDIT
 17580                   END-IF
 17581                ELSE
 17582                   MOVE ER-2765 TO WS-ERROR
 17583                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17584                   GO TO 3785-CHECK-NH
 17585                END-IF
 17586              ELSE
 17587               MOVE ER-2765      TO WS-ERROR
 17588               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17589               GO TO 3785-CHECK-NH.
 17590*              GO TO 3999-END-EDIT.
 17591
 17592 3780-UPDATE-CONT-2.
 17593
 17594     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17595        AND WS-LF-BENEFIT-CD = ZERO
 17596           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 317
* EL050.cbl
 17597           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17598
 17599     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17600        AND WS-AH-BENEFIT-CD = ZERO
 17601           MOVE ER-2744           TO WS-ERROR
 17602           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17603
 17604     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17605        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17606        AND
 17607        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17608         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17609           MOVE ER-2746           TO WS-ERROR
 17610           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17611
 17612     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17613       AND
 17614        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17615             MOVE ER-2737        TO WS-ERROR
 17616             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17617
 17618     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17619       AND
 17620        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17621             MOVE ER-2737        TO WS-ERROR
 17622             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17623
 17624     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17625         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17626             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17627             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17628         ELSE
 17629             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17630                 MOVE ER-2768    TO WS-ERROR
 17631                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17632             ELSE
 17633                 MOVE ER-2756    TO WS-ERROR
 17634                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17635
 17636     IF CERT-PEND-ISSUE-RETURNED
 17637        MOVE ER-2772             TO WS-ERROR
 17638        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17639 3785-CHECK-NH.
 17640*    IF PB-STATE NOT = 'NH' and 'TN'
 17641     IF PB-STATE NOT = 'NH'
 17642        GO TO 3999-END-EDIT
 17643     END-IF
 17644
 17645     MOVE ER-2796                TO WS-ERROR
 17646     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17647     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17648        OR (CM-NH-INTERFACE-SW = 'Y')
 17649        MOVE ER-2793             TO WS-ERROR
 17650        PERFORM 9900-ERROR-FORMAT
 17651                                 THRU 9900-EXIT
 17652     END-IF
 17653     MOVE +0                     TO WS-PAYMENT-AMT
 17654     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 318
* EL050.cbl
 17655        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17656               PB-C-AH-CANCEL-DT
 17657           GO TO 3999-END-EDIT
 17658        END-IF
 17659     end-if
 17660***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17661***-_-
 17662***-_-   For TN it's only flat cancels
 17663***-_-
 17664***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17665     if pb-state = 'TN'
 17666        if ((pb-c-lf-cancel-dt <> low-values)
 17667           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17668                      or
 17669           ((pb-c-ah-cancel-dt <> low-values)
 17670           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17671           GO TO 3999-END-EDIT
 17672        END-IF
 17673     end-if
 17674     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17675        GO TO 3999-END-EDIT
 17676     END-IF
 17677***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17678***-_-
 17679***-_-   if cancel date within 15 days of effective date, bypass
 17680***-_-
 17681***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17682     IF PB-STATE NOT = 'NH'
 17683        GO TO 3785-CONTINUE
 17684     END-IF
 17685     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17686     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17687     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17688        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17689     END-IF
 17690     MOVE '1'                    TO DC-OPTION-CODE
 17691     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17692     IF NO-CONVERSION-ERROR
 17693        IF DC-ELAPSED-DAYS < +16
 17694           GO TO 3999-END-EDIT
 17695        END-IF
 17696     END-IF
 17697***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17698***-_-
 17699***-_-   if cancel date within 30 days of current date then
 17700***-_-   bypass else subtract 15 days from period
 17701***-_-
 17702***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17703     MOVE +0                     TO DC-ELAPSED-DAYS
 17704     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17705     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17706     MOVE '1'                    TO DC-OPTION-CODE
 17707     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17708     IF NO-CONVERSION-ERROR
 17709        IF DC-ELAPSED-DAYS > +30
 17710           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17711        ELSE
 17712           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 319
* EL050.cbl
 17713        END-IF
 17714     ELSE
 17715        GO TO 3999-END-EDIT
 17716     END-IF
 17717     .
 17718 3785-CONTINUE.
 17719     if pb-state = 'TN'
 17720        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17721        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17722        MOVE '1'                 TO DC-OPTION-CODE
 17723        PERFORM 8500-DATE-CONVERT
 17724                                 THRU 8500-EXIT
 17725        IF no-CONVERSION-ERROR
 17726           IF DC-ELAPSED-DAYS < +16
 17727              GO TO 3999-END-EDIT
 17728           END-IF
 17729        END-IF
 17730     end-if
 17731***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17732***-_-
 17733***-_-   'NH' is 10%, TN is 3.5%
 17734***-_-
 17735***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17736     if pb-state = 'NH'
 17737        move +1.10               to ws-work-rate
 17738     else
 17739        move +1.035              to ws-work-rate
 17740     end-if
 17741     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17742        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17743           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17744     IF WS-PAYMENT-AMT < 600.00
 17745        GO TO 3999-END-EDIT
 17746     END-IF
 17747     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17748
 17749     IF (ERMAIL-FOUND = ' ')
 17750         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17751         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17752        GO TO 3999-END-EDIT
 17753     END-IF
 17754     MOVE ER-2795                TO WS-ERROR
 17755     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17756
 17757     GO TO 3999-END-EDIT.
 17758******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 320
* EL050.cbl
 17760 3990-FILES-NOT-OPEN.
 17761
 17762     MOVE ER-2617                TO WS-ERROR.
 17763     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17764     GO TO 9990-RETURN.
 17765
 17766 3999-END-EDIT.
 17767
 17768     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17769
 17770     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17771         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17772         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17773             PERFORM 9250-UNLOCK-RETURN
 17774             GO TO 9990-RETURN
 17775          ELSE
 17776             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17777             GO TO 9990-RETURN.
 17778
 17779     IF PB-CANCELLATION
 17780          GO TO 9990-RETURN.
 17781
 17782     IF CERT-WAS-NOT-FOUND
 17783        MOVE SPACES              TO CERTIFICATE-MASTER.
 17784
 17785     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17786
 17787     IF CERT-WAS-FOUND
 17788         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17789             PERFORM 9250-UNLOCK-RETURN
 17790          ELSE
 17791            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17792      ELSE
 17793         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17794
 17795*    if pb-company-id = 'VPP'
 17796*       perform 8150-read-elcrtt thru 8150-exit
 17797*       if ws-vehicle-odometer numeric
 17798*          if ws-vehicle-odometer > 6000
 17799*             move er-1583       to ws-error
 17800*             PERFORM 9900-ERROR-FORMAT
 17801*                                THRU 9900-EXIT
 17802*          end-if
 17803*       end-if
 17804*    end-if
 17805     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17806        IF ((PB-COMPANY-ID = 'DCC')
 17807           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17808                         or
 17809            (pb-company-id = 'CID' or 'VPP')
 17810            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17811        END-IF
 17812     END-IF.
 17813
 17814     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17815         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17816     END-IF.
 17817     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 321
* EL050.cbl
 17818     perform 8150-read-elcrtt    thru 8150-exit
 17819     if ws-ins-age-defaulted = 'Y'
 17820        move er-1573             to ws-error
 17821        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17822     end-if
 17823
 17824     if ws-jnt-age-defaulted = 'Y'
 17825        move er-1574             to ws-error
 17826        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17827     end-if
 17828***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17829***                                                           ****
 17830***  Set an error if the state requires verification of agent ****
 17831***  and agent hasn't verified yet and the status is not =    ****
 17832***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17833***  and the entry date > 09/01/2015.                         ****
 17834***                                                           ****
 17835***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17836     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17837        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17838        and (pb-account (9:2) not = 'OB')
 17839        if (ws-st-agent-sig-edit = 'Y')
 17840           and (am-report-code-1 not = 'CONLEY')
 17841           evaluate true
 17842              when cs-agent-edit-status = 'C'
 17843                 move er-1743    to ws-error
 17844                 perform 9900-error-format
 17845                                 thru 9900-exit
 17846              when cs-agent-edit-status = 'S'
 17847                 move er-1744    to ws-error
 17848                 perform 9900-error-format
 17849                                 thru 9900-exit
 17850              when cs-agent-edit-status = 'M'
 17851                 move er-1745    to ws-error
 17852                 perform 9900-error-format
 17853                                 thru 9900-exit
 17854              when cs-agent-edit-status = 'R'
 17855                 move er-1747    to ws-error
 17856                 perform 9900-error-format
 17857                                 thru 9900-exit
 17858              when cs-agent-edit-status = 'N'
 17859                 move er-1748    to ws-error
 17860                 perform 9900-error-format
 17861                                 thru 9900-exit
 17862              when cs-agent-edit-status <> 'V' and 'U' and
 17863                                           'R' and 'N'
 17864                 move er-1746    to ws-error
 17865                 perform 9900-error-format
 17866                                 thru 9900-exit
 17867           end-evaluate
 17868        end-if
 17869     end-if
 17870     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17871     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17872        AND (WS-NO-SECURE-PAY))
 17873                  OR
 17874        (WS-LF-SPECIAL-CALC-CD = 'O'
 17875        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 322
* EL050.cbl
 17876        SET SKIP-ADDR-EDIT       TO TRUE
 17877     END-IF
 17878     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17879        AND (NOT SKIP-ADDR-EDIT)
 17880        MOVE ER-2963             TO WS-ERROR
 17881        PERFORM 9900-ERROR-FORMAT
 17882                                 THRU 9900-EXIT
 17883        GO TO 9990-RETURN
 17884     END-IF
 17885     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17886     IF ERPNDM-FOUND NOT = 'X'
 17887        move 'Y'                 to erpndm-unlock-sw
 17888        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17889           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17890           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17891           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 17892           or (pm-zip-code    = zeros)
 17893           or (pm-zip-code not numeric))
 17894           AND (NOT SKIP-ADDR-EDIT)
 17895           MOVE ER-2694          TO WS-ERROR
 17896           PERFORM 9900-ERROR-FORMAT
 17897                                 THRU 9900-EXIT
 17898        END-IF
 17899        MOVE ' '                 TO STATE-RECORD-ERROR
 17900        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17901        MOVE PM-STATE            TO CNTL-ACCESS
 17902        MOVE '3'                 TO CNTL-REC-TYPE
 17903        MOVE +0                  TO CNTL-SEQ-NO
 17904        MOVE '0'                 TO RC-SW-2
 17905        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17906        IF (NO-STATE-RECORD)
 17907           OR (CF-RECORD-TYPE NOT = '3')
 17908           OR (PM-STATE NOT = CF-STATE-CODE)
 17909           IF (PM-STATE = SPACES)
 17910              AND (SKIP-ADDR-EDIT)
 17911              CONTINUE
 17912           ELSE
 17913              MOVE ER-2963       TO WS-ERROR
 17914              PERFORM 9900-ERROR-FORMAT
 17915                                 THRU 9900-EXIT
 17916           END-IF
 17917        END-IF
 17918        if (ws-error not = er-2963 and er-2694)
 17919           and (pm-city-st-zip-verified = ' ')
 17920           and (pb-company-id = 'CID')
 17921           move spaces           to zipcd-pass-area
 17922           move pm-zip-code      to pa-zip
 17923           move pm-city          to pa-city
 17924           move pm-state         to pa-state
 17925           perform 7790-call-zip-verify
 17926                                 thru 7790-exit
 17927           if pa-errorcode-zip (1:1) = ' '
 17928                    move 'Y'     to pm-city-st-zip-verified
 17929                    PERFORM 8102-REWRITE-ERPNDM
 17930                                 THRU 8102-EXIT
 17931                    move 'N'     to erpndm-unlock-sw
 17932           else
 17933              MOVE ER-3061       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 323
* EL050.cbl
 17934              PERFORM 9900-ERROR-FORMAT
 17935                                 THRU 9900-EXIT
 17936           end-if
 17937        end-if
 17938        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17939           MOVE ER-2883          TO WS-ERROR
 17940           PERFORM 9900-ERROR-FORMAT
 17941                                 THRU 9900-EXIT
 17942        END-IF
 17943        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17944           MOVE ' '                 TO STATE-RECORD-ERROR
 17945           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17946           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17947           MOVE '3'                 TO CNTL-REC-TYPE
 17948           MOVE +0                  TO CNTL-SEQ-NO
 17949           MOVE '0'                 TO RC-SW-2
 17950           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17951           IF NO-STATE-RECORD
 17952              OR (CF-RECORD-TYPE NOT = '3')
 17953              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17954              MOVE ER-2964          TO WS-ERROR
 17955              PERFORM 9900-ERROR-FORMAT
 17956                                    THRU 9900-EXIT
 17957           END-IF
 17958        END-IF
 17959     ELSE
 17960        IF NOT SKIP-ADDR-EDIT
 17961           MOVE ER-2393          TO WS-ERROR
 17962           PERFORM 9900-ERROR-FORMAT
 17963                                 THRU 9900-EXIT
 17964        END-IF
 17965     END-IF
 17966     if need-to-unlock-erpndm
 17967        perform 8104-unlock-erpndm
 17968                                 thru 8104-exit
 17969     end-if
 17970     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17971
 17972     IF (ERMAIL-FOUND = ' ' AND
 17973        ERPNDM-FOUND = ' ')
 17974        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17975           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17976           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17977          OR
 17978           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17979          OR
 17980           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17981           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17982           GO TO 3999-UNLOCK-ERMAIL.
 17983
 17984     IF ERPNDM-FOUND = 'X'
 17985        GO TO 3999-UNLOCK-ERMAIL.
 17986
 17987     IF PM-INSURED-LAST-NAME      = SPACES
 17988        AND PM-INSURED-FIRST-NAME = SPACES
 17989        AND PM-ADDRESS-LINE-1     = SPACES
 17990        AND PM-ADDRESS-LINE-2     = SPACES
 17991        AND PM-CITY-STATE         = SPACES
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 324
* EL050.cbl
 17992        AND PM-CRED-BENE-NAME     = SPACES
 17993        AND PM-CRED-BENE-ADDR     = SPACES
 17994        AND PM-CRED-BENE-CTYST    = SPACES
 17995        GO TO 3999-UNLOCK-ERMAIL
 17996     END-IF
 17997
 17998     MOVE SPACES                 TO MAILING-DATA.
 17999
 18000     MOVE 'MA'                   TO MA-RECORD-ID.
 18001     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18002     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18003     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18004     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18005     MOVE PB-SV-STATE            TO MA-STATE.
 18006     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18007     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18008
 18009     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18010     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18011
 18012     IF ERMAIL-FOUND = ' '
 18013        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18014     ELSE
 18015        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18016        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18017        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18018
 18019     GO TO 9990-RETURN.
 18020
 18021 3999-UNLOCK-ERMAIL.
 18022     IF ERMAIL-FOUND = ' '
 18023        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18024
 18025     GO TO 9990-RETURN.
 18026******************************************************************
 18027
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 325
* EL050.cbl
 18029 4000-UPDATE-CANCELLED-CERT.
 18030     IF CERT-WAS-NOT-FOUND
 18031        GO TO 4299-EXIT.
 18032
 18033*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18034     IF PB-C-NH-INT-ON-REFS > ZEROS
 18035        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 18036     END-IF
 18037     IF PB-C-REF-INTERFACE-SW = 'Y'
 18038        MOVE PB-C-REF-INTERFACE-SW
 18039                                 TO CM-NH-INTERFACE-SW
 18040     END-IF
 18041     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18042     IF ERMAIL-FOUND = 'X'
 18043        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18044        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18045        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18046        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18047           MOVE ER-2694          TO WS-ERROR
 18048           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18049     END-IF
 18050
 18051     IF PB-C-POST-CARD-IND = 'Y'
 18052        MOVE +8                  TO SUB
 18053*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18054        IF ERMAIL-FOUND = ' '
 18055           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18056              (SUB > +7)
 18057              OR (MA-MAIL-STATUS (SUB) = '1')
 18058           END-PERFORM
 18059        END-IF
 18060        IF (SUB > +7)
 18061           OR (ERMAIL-FOUND = 'X')
 18062           MOVE ER-3789          TO WS-ERROR
 18063           PERFORM 9900-ERROR-FORMAT
 18064                                 THRU 9900-EXIT
 18065        END-IF
 18066     ELSE
 18067        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18068     END-IF
 18069
 18070     IF ERMAIL-FOUND = ' '
 18071        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18072     END-IF.
 18073
 18074     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18075
 18076     IF PB-CI-OB-FLAG = 'Z'
 18077        GO TO 4150-SUMMARY-CERT-CANCEL.
 18078
 18079     IF PB-C-LF-CANCEL-VOIDED
 18080         PERFORM 4200-REVERSE-LF-CANCEL.
 18081     IF PB-C-AH-CANCEL-VOIDED
 18082         PERFORM 4200-REVERSE-AH-CANCEL.
 18083
 18084 4100-APPLY-LF-CANCEL.
 18085
 18086     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 326
* EL050.cbl
 18087
 18088 4100-CHECK-LF-ERRORS.
 18089
 18090     ADD +1                       TO WS-SUB.
 18091
 18092     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18093        IF LF-COVERAGE-CANCELLED
 18094           GO TO 4100-LF-CANCEL-CONT
 18095        ELSE
 18096           GO TO 4100-UPDATE-LF-COVERAGE.
 18097
 18098     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18099                                   ER-2729 OR
 18100                                   ER-2730 OR
 18101                                   ER-2731 OR
 18102                                   ER-2732 OR
 18103                                   ER-2737 OR
 18104                                   ER-2740 OR
 18105                                   ER-2743 OR
 18106                                   ER-2749 OR
 18107                                   ER-2750 OR
 18108                                   ER-2755 OR
 18109                                   ER-2757 OR
 18110                                   ER-2760 OR
 18111                                   ER-2772 OR
 18112                                   ER-2774 OR
 18113                                   ER-2776 OR
 18114                                   ER-2794
 18115        GO TO 4100-UPDATE-LF-COVERAGE.
 18116
 18117     GO TO 4100-CHECK-LF-ERRORS.
 18118
 18119 4100-UPDATE-LF-COVERAGE.
 18120
 18121     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18122     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18123     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18124        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18125     END-IF
 18126     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18127                                      TO CM-CREDIT-INTERFACE-SW-2.
 18128     IF CM-LF-CANCEL-DT = LOW-VALUE
 18129         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18130
 18131     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18132         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18133                                         CM-LF-STATUS-AT-CANCEL.
 18134
 18135     GO TO 4100-APPLY-AH-CANCEL.
 18136
 18137 4100-LF-CANCEL-CONT.
 18138     IF PB-C-LF-CANCEL-VOIDED
 18139         GO TO 4100-APPLY-AH-CANCEL.
 18140
 18141     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18142         GO TO 4100-APPLY-AH-CANCEL.
 18143
 18144     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 327
* EL050.cbl
 18145        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18146           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18147        ELSE
 18148           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18149
 18150     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18151     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18152
 18153     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18154         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18155
 18156     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18157        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18158         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18159         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18160
 18161     IF PB-RECORD-RETURNED
 18162        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18163      ELSE
 18164        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18165
 18166 4100-APPLY-AH-CANCEL.
 18167
 18168     MOVE +0                      TO WS-SUB.
 18169
 18170 4100-CHECK-AH-ERRORS.
 18171
 18172     ADD +1                       TO WS-SUB.
 18173
 18174     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18175        IF AH-COVERAGE-CANCELLED
 18176           GO TO 4100-AH-CANCEL-CONT
 18177        ELSE
 18178           GO TO 4100-UPDATE-AH-COVERAGE.
 18179
 18180     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18181                                   ER-2729 OR
 18182                                   ER-2732 OR
 18183                                   ER-2737 OR
 18184                                   ER-2740 OR
 18185                                   ER-2744 OR
 18186                                   ER-2749 OR
 18187                                   ER-2750 OR
 18188                                   ER-2755 OR
 18189                                   ER-2757 OR
 18190                                   ER-2760 OR
 18191                                   ER-2771 OR
 18192                                   ER-2772 OR
 18193                                   ER-2773 OR
 18194                                   ER-2775 OR
 18195                                   ER-2777 OR
 18196                                   ER-2778 OR
 18197                                   ER-2794
 18198        GO TO 4100-UPDATE-AH-COVERAGE.
 18199
 18200     GO TO 4100-CHECK-AH-ERRORS.
 18201
 18202 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 328
* EL050.cbl
 18203
 18204     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18205     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18206     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18207     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18208                                      TO CM-CREDIT-INTERFACE-SW-2.
 18209     IF CM-AH-CANCEL-DT = LOW-VALUE
 18210         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18211
 18212     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18213         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18214                                         CM-AH-STATUS-AT-CANCEL.
 18215
 18216     IF LF-COVERAGE-CANCELLED
 18217         IF PB-RECORD-RETURNED
 18218              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18219          ELSE
 18220              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18221
 18222     GO TO 4299-EXIT.
 18223
 18224 4100-AH-CANCEL-CONT.
 18225     IF PB-C-AH-CANCEL-VOIDED
 18226         GO TO 4299-EXIT.
 18227
 18228     if cm-credit-interface-sw-2 = ' '
 18229        if pb-fatal-errors or pb-unforced-errors
 18230           move '4'              to cm-credit-interface-sw-2
 18231        else
 18232           move '1'              to cm-credit-interface-sw-2
 18233        end-if
 18234     end-if
 18235     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18236         GO TO 4299-EXIT.
 18237
 18238     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18239        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18240           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18241        ELSE
 18242           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18243
 18244     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18245     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18246
 18247     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18248         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18249
 18250     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18251         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18252         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18253
 18254     IF PB-RECORD-RETURNED
 18255        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18256      ELSE
 18257        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18258
 18259     GO TO 4299-EXIT.
 18260
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 329
* EL050.cbl
 18261 4150-SUMMARY-CERT-CANCEL.
 18262     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18263
 18264     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18265        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18266                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18267     ELSE
 18268        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18269                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18270
 18271     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18272        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18273                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18274     ELSE
 18275        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18276                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18277
 18278     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18279        NEXT SENTENCE
 18280     ELSE
 18281        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18282
 18283     GO TO 4299-EXIT.
 18284
 18285 4200-REVERSE-LF-CANCEL.
 18286     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18287
 18288     IF CM-LF-CANCEL-APPLIED
 18289        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18290        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18291        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 18292
 18293     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18294
 18295     IF PB-RECORD-RETURNED
 18296        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18297       ELSE
 18298        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18299
 18300 4200-REVERSE-LF-EXIT.
 18301       EXIT.
 18302
 18303 4200-REVERSE-AH-CANCEL.
 18304     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18305
 18306     IF CM-AH-CANCEL-APPLIED
 18307        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18308        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18309        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18310
 18311     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18312
 18313     IF PB-RECORD-RETURNED
 18314        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18315       ELSE
 18316        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18317
 18318 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 330
* EL050.cbl
 18319       EXIT.
 18320
 18321 4299-EXIT.
 18322       EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 331
* EL050.cbl
 18324
 18325 4500-UPDATE-NEW-CERT.
 18326     IF CERT-WAS-FOUND
 18327         NEXT SENTENCE
 18328       ELSE
 18329         GO TO 4520-BUILD-NEW-KEY.
 18330
 18331     IF  CLASIC-CREATED-CERT
 18332         GO TO 4999-EXIT.
 18333
 18334     IF  CERT-WAS-CREATED-FOR-CLAIM
 18335         GO TO 4520-BUILD-NEW-KEY.
 18336
 18337     IF CERT-ADDED-BATCH
 18338        IF CM-RECORD-ID = 'CM'
 18339            GO TO 4999-EXIT.
 18340
 18341 4520-BUILD-NEW-KEY.
 18342* BUILD CONTROL PRIMARY
 18343
 18344     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18345                                       CM-COMPANY-CD-A1
 18346                                       CM-COMPANY-CD-A2
 18347                                       CM-COMPANY-CD-A4
 18348                                       CM-COMPANY-CD-A5.
 18349
 18350     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18351     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18352     MOVE PB-SV-STATE               TO CM-STATE.
 18353     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18354     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18355     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18356     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18357
 18358     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18359
 18360     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18361     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18362     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18363     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18364
 18365     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18366        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18367
 18368     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18369         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18370         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18371         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18372         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18373     ELSE
 18374         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18375
 18376     IF PB-COMPANY-ID   EQUAL  'CRI'
 18377         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18378         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18379         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18380         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18381         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 332
* EL050.cbl
 18382
 18383     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18384        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18385         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18386
 18387     IF PB-COMPANY-ID  = 'LBL'
 18388        IF PB-I-JOINT-COVERAGE
 18389            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18390                                           PB-I-MEMBER-NO
 18391            GO TO 4550-CONT-CERT-PROCESS.
 18392
 18393     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18394        NEXT SENTENCE
 18395     ELSE
 18396        GO TO 4540-BUILD-MEMBER-NO.
 18397
 18398******************************************************************
 18399*                                                                *
 18400*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18401*    FOR 'MON'.                                                  *
 18402*                                                                *
 18403******************************************************************
 18404
 18405     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18406     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18407     MOVE +1                     TO WS-SUB1
 18408                                    WS-SUB2.
 18409
 18410 4530-EDIT-MEMB-NAME.
 18411
 18412     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18413        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18414        ADD +1                       TO WS-SUB2.
 18415
 18416     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18417        ADD +1                       TO WS-SUB1
 18418        GO TO 4530-EDIT-MEMB-NAME.
 18419
 18420     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18421     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18422     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18423*    MOVE SPACE                      TO DC-OPTION-CODE.
 18424     SET  BIN-TO-GREG                TO TRUE.
 18425     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18426     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18427
 18428     GO TO 4550-CONT-CERT-PROCESS.
 18429
 18430******************************************************************
 18431*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18432******************************************************************
 18433
 18434 4540-BUILD-MEMBER-NO.
 18435
 18436     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18437         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18438         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18439         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 333
* EL050.cbl
 18440         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18441     ELSE
 18442         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18443
 18444     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18445        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18446         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18447
 18448 4550-CONT-CERT-PROCESS.
 18449
 18450*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18451*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18452*    ELSE
 18453*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18454
 18455     IF CERT-WAS-CREATED-FOR-CLAIM
 18456        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18457        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18458
 18459     IF CERT-AND-CLAIM-ONLINE
 18460        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18461        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18462
 18463     MOVE 'CM'                     TO CM-RECORD-ID.
 18464     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18465
 18466     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18467        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18468        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18469     ELSE
 18470        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18471        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18472
 18473     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18474     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18475     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18476     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18477     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18478     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18479     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18480                                      CM-LF-ITD-CANCEL-AMT
 18481                                      CM-LF-ITD-DEATH-AMT
 18482                                      CM-AH-ITD-AH-PMT
 18483                                      CM-AH-ITD-LUMP-PMT
 18484                                      CM-AH-ITD-CANCEL-AMT
 18485                                      CM-LF-NSP-PREMIUM-AMT
 18486                                      CM-AH-NSP-PREMIUM-AMT.
 18487*                                     CM-CLAIM-DEDUCT-WITHHELD
 18488*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18489     if pb-i-loan-apr = +99.9999
 18490        move zeros                 to cm-loan-apr
 18491     else
 18492        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18493     end-if
 18494     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18495     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18496     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18497     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 334
* EL050.cbl
 18498     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18499     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18500     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18501     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18502     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18503     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18504     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18505
 18506     IF PB-I-LIVES NOT NUMERIC
 18507         MOVE ZERO                 TO PB-I-LIVES.
 18508
 18509     IF PB-I-NUM-BILLED NOT NUMERIC
 18510         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18511
 18512     MOVE PB-I-LIVES               TO CM-LIVES.
 18513     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18514
 18515     IF PB-COMPANY-ID EQUAL  'DMD'
 18516         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18517         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18518
 18519     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18520     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18521     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18522     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18523     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18524     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18525
 18526     IF PB-I-LF-POLICY-FEE NUMERIC
 18527        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18528     ELSE
 18529        MOVE +0                    TO CM-LF-POLICY-FEE.
 18530
 18531     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18532        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18533        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18534     ELSE
 18535        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18536
 18537     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18538     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18539     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18540     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18541     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18542     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18543     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18544     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18545     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18546
 18547     IF PB-I-CANCEL-FEE NUMERIC
 18548        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18549     ELSE
 18550        MOVE +0                  TO CM-CANCEL-FEE
 18551     END-IF
 18552
 18553     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18554        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18555     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 335
* EL050.cbl
 18556        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18557
 18558     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18559     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18560
 18561     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18562                                      CM-LF-DEATH-EXIT-DT
 18563                                      CM-AH-SETTLEMENT-EXIT-DT.
 18564
 18565*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18566*                       'TIH' OR 'OFL' OR 'FLA' OR
 18567*                       'TII' OR 'TMS' OR 'CRI' OR
 18568*                       'NCL'
 18569     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18570
 18571     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18572         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18573            MOVE '2'                TO CM-PREMIUM-TYPE.
 18574
 18575     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18576         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18577            MOVE '2'                TO CM-PREMIUM-TYPE.
 18578
 18579     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18580         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18581     ELSE
 18582         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18583         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18584
 18585     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18586     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18587     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18588     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18589     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18590     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18591     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18592     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18593
 18594     IF PB-NO-MONTHS-SKIPPED
 18595         MOVE SPACE                 TO CM-SKIP-CODE
 18596     ELSE
 18597         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18598
 18599     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18600     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18601                                       CM-LF-STATUS-AT-CANCEL.
 18602
 18603     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18604     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18605                                       CM-AH-STATUS-AT-CANCEL.
 18606
 18607     MOVE '1'                       TO CM-ENTRY-STATUS.
 18608
 18609     IF PB-REISSUED-CERT
 18610        MOVE '5'                    TO CM-ENTRY-STATUS.
 18611
 18612     IF PB-MONTHLY-CERT
 18613        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 336
* EL050.cbl
 18614
 18615     IF PB-CASH-CERT
 18616        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18617
 18618     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18619     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18620     IF PB-POLICY-IS-DECLINED
 18621        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18622
 18623     IF PB-POLICY-IS-VOIDED
 18624        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18625
 18626     IF PB-NEEDS-UNDERWRITING
 18627        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18628
 18629     IF PB-REIN-ONLY-CERT
 18630        MOVE '9'                    TO CM-ENTRY-STATUS.
 18631
 18632     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18633         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18634     ELSE
 18635         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18636
 18637     IF PB-RECORD-RETURNED
 18638        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18639      ELSE
 18640        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18641
 18642     IF PB-I-MAIL-ADDRS-PRESENT
 18643        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18644
 18645     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18646                                       CM-ENTRY-DT.
 18647
 18648 4999-EXIT.
 18649     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 337
* EL050.cbl
 18651
 18652 5000-PROCESS-REPS.
 18653     MOVE ' '                    TO AGTC-MASTER-SW
 18654     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18655     MOVE CO-TYPE                TO AGTC-TYPE
 18656     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18657     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18658     IF (AGTC-MASTER-SW NOT = 'N')
 18659        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18660        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18661        PERFORM 8583-READ-ERAGTC-NEXT
 18662                                 THRU 8583-EXIT
 18663     END-IF
 18664     IF AGTC-MASTER-SW = 'N'
 18665        CONTINUE
 18666     ELSE
 18667        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18668           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18669              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18670              MOVE 'Y'           TO AGTC-MASTER-SW
 18671           END-IF
 18672        END-IF
 18673     END-IF
 18674     .
 18675 5000-EXIT.
 18676     EXIT.
 18677 6370-EDIT-INPUT-LF-CODE.
 18678     move ' ' to ws-benefit-cd-chg-sw
 18679     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18680        MOVE +1                  TO SUB
 18681        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18682        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18683        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18684        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18685        GO TO 6370-SEARCH-LOOP.
 18686
 18687     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18688
 18689     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18690     MOVE SPACES                 TO CNTL-ACCESS.
 18691*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18692     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18693     MOVE +0                     TO CNTL-SEQ-NO.
 18694     MOVE '4' TO RC-SW-2.
 18695     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18696
 18697     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18698        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18699        GO TO 6370-NO-LF-FOUND.
 18700
 18701     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18702     MOVE +1                     TO SUB.
 18703
 18704 6370-SEARCH-LOOP.
 18705     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18706         GO TO 6370-NO-LF-FOUND.
 18707
 18708     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 338
* EL050.cbl
 18709        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18710           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18711           set benefit-code-chg to true
 18712        end-if
 18713        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18714        GO TO 6370-HER-NET-PAY-CHECK.
 18715
 18716     ADD 1   TO SUB.
 18717*    IF SUB GREATER 120
 18718     IF SUB GREATER 200
 18719         GO TO 6370-NO-LF-FOUND.
 18720
 18721     GO TO 6370-SEARCH-LOOP.
 18722
 18723 6370-NO-LF-FOUND.
 18724
 18725     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18726        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18727        set benefit-code-chg to true
 18728     end-if
 18729     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18730
 18731 6370-HER-NET-PAY-CHECK.
 18732
 18733     IF PB-COMPANY-ID = 'CID'
 18734        IF PB-SV-STATE = 'CA' OR 'MN'
 18735           IF PB-I-LF-BENEFIT-CD = '02'
 18736              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18737           ELSE
 18738              IF PB-I-LF-BENEFIT-CD = '04'
 18739                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18740              END-IF
 18741           END-IF
 18742        END-IF
 18743     END-IF
 18744
 18745     IF PB-COMPANY-ID NOT = 'HER'
 18746         GO TO 6370-EXIT.
 18747
 18748     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18749         GO TO 6370-EXIT.
 18750
 18751     IF PB-I-LF-TERM NOT NUMERIC
 18752         MOVE ZEROS              TO PB-I-LF-TERM.
 18753
 18754     IF PB-I-LOAN-TERM NOT NUMERIC
 18755         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18756
 18757     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18758         GO TO 6370-EXIT.
 18759
 18760     IF PB-I-LF-BENEFIT-CD = '33'
 18761         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18762
 18763     IF PB-I-LF-BENEFIT-CD = '34'
 18764         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18765
 18766 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 339
* EL050.cbl
 18767     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 340
* EL050.cbl
 18769
 18770 6380-EDIT-INPUT-AH-CODE.
 18771     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18772        MOVE +1                  TO SUB
 18773        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18774        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18775        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18776        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18777        GO TO 6380-SEARCH-LOOP.
 18778
 18779     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18780
 18781     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18782     MOVE SPACES                 TO CNTL-ACCESS.
 18783     MOVE 'A'                    TO CNTL-REC-TYPE.
 18784*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18785     MOVE +0                     TO CNTL-SEQ-NO.
 18786     MOVE '5' TO RC-SW-2.
 18787     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18788
 18789     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18790        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18791        GO TO 6380-NO-AH-FOUND.
 18792
 18793     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18794     MOVE +1 TO SUB.
 18795
 18796 6380-SEARCH-LOOP.
 18797     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18798         GO TO 6380-NO-AH-FOUND.
 18799
 18800     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18801         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18802         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18803
 18804     ADD 1   TO SUB.
 18805     IF SUB GREATER THAN 96
 18806*    IF SUB GREATER THAN 300
 18807         GO TO 6380-NO-AH-FOUND.
 18808
 18809     GO TO 6380-SEARCH-LOOP.
 18810
 18811 6380-NO-AH-FOUND.
 18812
 18813     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18814
 18815     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18816         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18817     ELSE
 18818         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18819
 18820 6380-CSO-AH-ONLY-CHECKS.
 18821
 18822     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18823        NEXT SENTENCE
 18824      ELSE
 18825        GO TO 6380-EXIT.
 18826
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 341
* EL050.cbl
 18827     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18828         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18829
 18830
 18831     GO TO 6380-EXIT
 18832     .
 18833 6380-CSO-LIFE-WITH-AH-CHECKS.
 18834
 18835
 18836     .
 18837 6380-EXIT.
 18838     EXIT.
 18839
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 342
* EL050.cbl
 18841
 18842 6400-COMPUTE-EXTENSION-DAYS.
 18843
 18844******************************************************************
 18845*                                                                *
 18846*                   COMPUTE EXTENSION DAYS                       *
 18847*                                                                *
 18848*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18849*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18850*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18851*    THE EXTENSION DAYS.                                         *
 18852*                                                                *
 18853******************************************************************
 18854
 18855     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18856     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18857
 18858******************************************************************
 18859*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18860*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18861******************************************************************
 18862
 18863     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18864        COMPUTE WS-ODD-DAYS-OVER =
 18865               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18866     ELSE
 18867        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18868
 18869     IF WS-ODD-DAYS-OVER = ZEROS
 18870           GO TO 6499-EXIT
 18871     ELSE
 18872        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18873           IF WS-WDF-MONTH = 02
 18874              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18875              ADD 2       TO  WS-ODD-DAYS-OVER
 18876              GO TO 6499-EXIT
 18877           ELSE
 18878              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18879                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18880                 GO TO 6499-EXIT
 18881               ELSE
 18882                 GO TO 6499-EXIT
 18883        ELSE
 18884           GO TO 6499-EXIT.
 18885
 18886 6412-CHECK-TO-DAY.
 18887
 18888        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18889           IF WS-WDT-DAY = 28
 18890              ADD 2              TO WS-ODD-DAYS-OVER
 18891           ELSE
 18892              IF WS-WDT-DAY = 29
 18893                 ADD 1           TO WS-ODD-DAYS-OVER
 18894              ELSE
 18895                 NEXT SENTENCE
 18896        ELSE
 18897           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18898              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 343
* EL050.cbl
 18899
 18900     GO TO 6499-EXIT.
 18901
 18902
 18903 6415-CHECK-LEAP-YEAR.
 18904
 18905     IF DC-DAYS-IN-MONTH = 29
 18906        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18907
 18908 6415-EXIT.
 18909     EXIT.
 18910
 18911 6499-EXIT.
 18912      EXIT.
 18913
 18914 6500-END.
 18915     EXIT.
 18916
 18917
 18918******************************************************************
 18919************* PROCEDURE DIVISION FOR EL050 ***********************
 18920********************** ELC50PD END *******************************
 18921
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 344
* EL050.cbl
 18923
 18924**START***********************************************************
 18925*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18926*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18927******************************************************************
 18928*
 18929 6600-GET-STATE-MUNICIPAL-TAX.
 18930
 18931     IF PB-COMPANY-ID NOT = 'DMD'
 18932         GO TO 6640-EXIT.
 18933
 18934     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18935     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18936     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18937*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18938*
 18939***  Y2K PROJ 7744
 18940     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18941     SET BIN-TO-GREG          TO TRUE.
 18942     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18943
 18944     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18945
 18946     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18947     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18948
 18949
 18950* EXEC CICS HANDLE CONDITION
 18951*        INVREQ    (6610-START-BROWSE)
 18952*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18953*        NOTFND    (6630-END-OF-FILE)
 18954*    END-EXEC.
 18955*    MOVE '"$8JI                 ! # #00018939' TO DFHEIV0
 18956     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18957     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18958     MOVE X'2320233030303138393339' TO DFHEIV0(25:11)
 18959     CALL 'kxdfhei1' USING DFHEIV0
 18960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18961
 18962
 18963 6610-START-BROWSE.
 18964
 18965
 18966* EXEC CICS HANDLE CONDITION
 18967*        NOTFND    (6630-END-OF-FILE)
 18968*        DISABLED  (6630-ERRESS-PROBLEM)
 18969*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18970*        ENDFILE   (6630-END-OF-FILE)
 18971*    END-EXEC.
 18972*    MOVE '"$IcJ''                ! $ #00018947' TO DFHEIV0
 18973     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18974     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18975     MOVE X'2420233030303138393437' TO DFHEIV0(25:11)
 18976     CALL 'kxdfhei1' USING DFHEIV0
 18977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18978
 18979
 18980
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 345
* EL050.cbl
 18981* EXEC CICS STARTBR
 18982*        DATASET (FILE-ID-ERRESS)
 18983*        RIDFLD  (WS-ERRESS-KEY)
 18984*        GTEQ
 18985*    END-EXEC.
 18986     MOVE 0
 18987       TO DFHEIV11
 18988*    MOVE '&,         G          &   #00018954' TO DFHEIV0
 18989     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18990     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18991     MOVE X'2020233030303138393534' TO DFHEIV0(25:11)
 18992     CALL 'kxdfhei1' USING DFHEIV0,
 18993           FILE-ID-ERRESS,
 18994           WS-ERRESS-KEY,
 18995           DFHEIV99,
 18996           DFHEIV11,
 18997           DFHEIV99
 18998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18999
 19000
 19001 6620-READ-NEXT-ERRESS-MASTER.
 19002
 19003
 19004* EXEC CICS HANDLE CONDITION
 19005*        NOTFND    (6630-END-OF-FILE)
 19006*        ENDFILE   (6630-END-OF-FILE)
 19007*        DISABLED  (6630-ERRESS-PROBLEM)
 19008*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19009*    END-EXEC.
 19010*    MOVE '"$I''cJ                ! % #00018962' TO DFHEIV0
 19011     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19012     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19013     MOVE X'2520233030303138393632' TO DFHEIV0(25:11)
 19014     CALL 'kxdfhei1' USING DFHEIV0
 19015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19016
 19017
 19018
 19019* EXEC CICS READNEXT
 19020*        DATASET (FILE-ID-ERRESS)
 19021*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19022*        RIDFLD  (WS-ERRESS-KEY)
 19023*    END-EXEC.
 19024     MOVE LENGTH OF
 19025      RESIDENT-STATE-TAX-MASTER
 19026       TO DFHEIV12
 19027     MOVE 0
 19028       TO DFHEIV11
 19029*    MOVE '&.IL                  )   #00018969' TO DFHEIV0
 19030     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19031     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19032     MOVE X'2020233030303138393639' TO DFHEIV0(25:11)
 19033     CALL 'kxdfhei1' USING DFHEIV0,
 19034           FILE-ID-ERRESS,
 19035           RESIDENT-STATE-TAX-MASTER,
 19036           DFHEIV12,
 19037           WS-ERRESS-KEY,
 19038           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 346
* EL050.cbl
 19039           DFHEIV11,
 19040           DFHEIV99,
 19041           DFHEIV99
 19042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19043
 19044
 19045     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19046
 19047* EXEC CICS ENDBR
 19048*            DATASET (FILE-ID-ERRESS)
 19049*       END-EXEC
 19050     MOVE 0
 19051       TO DFHEIV11
 19052*    MOVE '&2                    $   #00018976' TO DFHEIV0
 19053     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19054     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19055     MOVE X'2020233030303138393736' TO DFHEIV0(25:11)
 19056     CALL 'kxdfhei1' USING DFHEIV0,
 19057           FILE-ID-ERRESS,
 19058           DFHEIV11,
 19059           DFHEIV99
 19060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19061        GO TO 6630-END-OF-FILE.
 19062
 19063     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19064        NEXT SENTENCE
 19065      ELSE
 19066        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19067
 19068*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19069*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19070*
 19071     MOVE +2                     TO WS-SUB1.
 19072
 19073     IF PB-ISSUE
 19074     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19075        MOVE +1                  TO WS-SUB1.
 19076
 19077     IF PB-CANCELLATION
 19078     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19079        MOVE +1                  TO WS-SUB1.
 19080*
 19081*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19082*
 19083***  Y2K PROJ 7744
 19084     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19085***  Y2K PROJ 7744
 19086
 19087*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19088* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19089* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19090
 19091     ADD 1                    TO WS-YEAR-YY.
 19092
 19093     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19094         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19095                              TO WS-RES-STATE-TAX
 19096         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 347
* EL050.cbl
 19097                              TO WS-RES-MUNI-TAX
 19098     ELSE
 19099         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19100                              TO WS-RES-STATE-TAX
 19101         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19102                              TO WS-RES-MUNI-TAX.
 19103
 19104*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19105
 19106     IF PB-CANCELLATION
 19107         GO TO 6640-CANCEL-TAX.
 19108
 19109     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19110         COMPUTE PB-I-STATE-TAX ROUNDED =
 19111                                   PB-I-LF-PREMIUM-AMT
 19112                                 * WS-RES-STATE-TAX
 19113         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19114                                   PB-I-LF-PREMIUM-AMT
 19115                                 * WS-RES-MUNI-TAX
 19116     ELSE
 19117     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19118         COMPUTE PB-I-STATE-TAX ROUNDED =
 19119                                   PB-I-AH-PREMIUM-AMT
 19120                                 * WS-RES-STATE-TAX
 19121         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19122                                   PB-I-AH-PREMIUM-AMT
 19123                                 * WS-RES-MUNI-TAX.
 19124
 19125
 19126* EXEC CICS ENDBR
 19127*         DATASET (FILE-ID-ERRESS)
 19128*    END-EXEC.
 19129     MOVE 0
 19130       TO DFHEIV11
 19131*    MOVE '&2                    $   #00019043' TO DFHEIV0
 19132     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19133     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19134     MOVE X'2020233030303139303433' TO DFHEIV0(25:11)
 19135     CALL 'kxdfhei1' USING DFHEIV0,
 19136           FILE-ID-ERRESS,
 19137           DFHEIV11,
 19138           DFHEIV99
 19139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19140
 19141
 19142     GO TO 6640-EXIT.
 19143
 19144 6640-CANCEL-TAX.
 19145     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19146
 19147     IF PB-C-LF-CANCEL-AMT > ZEROS
 19148         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19149                                   PB-C-LF-CANCEL-AMT
 19150                                 * WS-RES-STATE-TAX
 19151         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19152                                   PB-C-LF-CANCEL-AMT
 19153                                *  WS-RES-MUNI-TAX
 19154     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 348
* EL050.cbl
 19155     IF PB-C-AH-CANCEL-AMT > ZEROS
 19156         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19157                                   PB-C-AH-CANCEL-AMT
 19158                                 * WS-RES-STATE-TAX
 19159         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19160                                   PB-C-AH-CANCEL-AMT
 19161                                *  WS-RES-MUNI-TAX.
 19162
 19163
 19164* EXEC CICS ENDBR
 19165*         DATASET (FILE-ID-ERRESS)
 19166*    END-EXEC.
 19167     MOVE 0
 19168       TO DFHEIV11
 19169*    MOVE '&2                    $   #00019068' TO DFHEIV0
 19170     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19171     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19172     MOVE X'2020233030303139303638' TO DFHEIV0(25:11)
 19173     CALL 'kxdfhei1' USING DFHEIV0,
 19174           FILE-ID-ERRESS,
 19175           DFHEIV11,
 19176           DFHEIV99
 19177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19178
 19179
 19180     GO TO 6640-EXIT.
 19181
 19182 6630-END-OF-FILE.
 19183     MOVE ER-8002              TO WS-ERROR.
 19184     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19185
 19186     GO TO 6640-EXIT.
 19187
 19188 6630-ERRESS-PROBLEM.
 19189     MOVE ER-8044              TO WS-ERROR.
 19190     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19191
 19192 6640-EXIT.
 19193     EXIT.
 19194
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 349
* EL050.cbl
 19196 6650-GET-RES-STATE-COMM.
 19197
 19198     IF PB-COMPANY-ID NOT = 'DMD'
 19199         GO TO 6700-COMM-EXIT.
 19200
 19201     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19202     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19203     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19204     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19205     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19206     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19207     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19208
 19209*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19210*
 19211***  Y2K PROJ 7744
 19212     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19213     SET BIN-TO-GREG          TO TRUE.
 19214     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19215
 19216     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19217***  Y2K PROJ 7744
 19218
 19219     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19220
 19221
 19222* EXEC CICS HANDLE CONDITION
 19223*        INVREQ    (6660-START-BROWSE)
 19224*        DISABLED  (6690-ERRESC-PROBLEM)
 19225*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19226*        NOTFND    (6690-END-OF-FILE)
 19227*    END-EXEC.
 19228*    MOVE '"$8cJI                ! & #00019113' TO DFHEIV0
 19229     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19230     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19231     MOVE X'2620233030303139313133' TO DFHEIV0(25:11)
 19232     CALL 'kxdfhei1' USING DFHEIV0
 19233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19234
 19235
 19236
 19237* EXEC CICS RESETBR
 19238*        DATASET (FILE-ID-ERRESC)
 19239*        RIDFLD  (WS-ERRESC-KEY)
 19240*    END-EXEC.
 19241     MOVE 0
 19242       TO DFHEIV11
 19243*    MOVE '&4         G          &   #00019120' TO DFHEIV0
 19244     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19245     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19246     MOVE X'2020233030303139313230' TO DFHEIV0(25:11)
 19247     CALL 'kxdfhei1' USING DFHEIV0,
 19248           FILE-ID-ERRESC,
 19249           WS-ERRESC-KEY,
 19250           DFHEIV99,
 19251           DFHEIV11,
 19252           DFHEIV99
 19253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 350
* EL050.cbl
 19254
 19255
 19256 6660-START-BROWSE.
 19257
 19258
 19259* EXEC CICS HANDLE CONDITION
 19260*        NOTFND    (6690-END-OF-FILE)
 19261*        DISABLED  (6690-ERRESC-PROBLEM)
 19262*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19263*        ENDFILE   (6690-END-OF-FILE)
 19264*    END-EXEC.
 19265*    MOVE '"$IcJ''                ! '' #00019127' TO DFHEIV0
 19266     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19267     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19268     MOVE X'2720233030303139313237' TO DFHEIV0(25:11)
 19269     CALL 'kxdfhei1' USING DFHEIV0
 19270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19271
 19272
 19273
 19274* EXEC CICS STARTBR
 19275*        DATASET (FILE-ID-ERRESC)
 19276*        RIDFLD  (WS-ERRESC-KEY)
 19277*        GTEQ
 19278*    END-EXEC.
 19279     MOVE 0
 19280       TO DFHEIV11
 19281*    MOVE '&,         G          &   #00019134' TO DFHEIV0
 19282     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19283     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19284     MOVE X'2020233030303139313334' TO DFHEIV0(25:11)
 19285     CALL 'kxdfhei1' USING DFHEIV0,
 19286           FILE-ID-ERRESC,
 19287           WS-ERRESC-KEY,
 19288           DFHEIV99,
 19289           DFHEIV11,
 19290           DFHEIV99
 19291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19292
 19293
 19294     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19295
 19296 6670-READ-NEXT-ERRESC-MASTER.
 19297
 19298
 19299* EXEC CICS HANDLE CONDITION
 19300*        NOTFND    (6690-END-OF-FILE)
 19301*        DISABLED  (6690-ERRESC-PROBLEM)
 19302*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19303*        ENDFILE   (6690-END-OF-FILE)
 19304*    END-EXEC.
 19305*    MOVE '"$IcJ''                ! ( #00019144' TO DFHEIV0
 19306     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19307     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19308     MOVE X'2820233030303139313434' TO DFHEIV0(25:11)
 19309     CALL 'kxdfhei1' USING DFHEIV0
 19310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19311
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 351
* EL050.cbl
 19312
 19313
 19314* EXEC CICS READNEXT
 19315*        DATASET (FILE-ID-ERRESC)
 19316*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19317*        RIDFLD  (ERRESC-RECORD-KEY)
 19318*    END-EXEC.
 19319     MOVE LENGTH OF
 19320      ACCOUNT-RESIDENT-ST-COMMISSION
 19321       TO DFHEIV12
 19322     MOVE 0
 19323       TO DFHEIV11
 19324*    MOVE '&.IL                  )   #00019151' TO DFHEIV0
 19325     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19326     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19327     MOVE X'2020233030303139313531' TO DFHEIV0(25:11)
 19328     CALL 'kxdfhei1' USING DFHEIV0,
 19329           FILE-ID-ERRESC,
 19330           ACCOUNT-RESIDENT-ST-COMMISSION,
 19331           DFHEIV12,
 19332           ERRESC-RECORD-KEY,
 19333           DFHEIV99,
 19334           DFHEIV11,
 19335           DFHEIV99,
 19336           DFHEIV99
 19337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19338
 19339
 19340     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19341        NEXT SENTENCE
 19342     ELSE
 19343
 19344* EXEC CICS ENDBR
 19345*            DATASET (FILE-ID-ERRESC)
 19346*       END-EXEC
 19347     MOVE 0
 19348       TO DFHEIV11
 19349*    MOVE '&2                    $   #00019160' TO DFHEIV0
 19350     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19351     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19352     MOVE X'2020233030303139313630' TO DFHEIV0(25:11)
 19353     CALL 'kxdfhei1' USING DFHEIV0,
 19354           FILE-ID-ERRESC,
 19355           DFHEIV11,
 19356           DFHEIV99
 19357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19358        GO TO 6690-END-OF-FILE.
 19359
 19360     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19361
 19362* EXEC CICS ENDBR
 19363*            DATASET (FILE-ID-ERRESC)
 19364*       END-EXEC
 19365     MOVE 0
 19366       TO DFHEIV11
 19367*    MOVE '&2                    $   #00019166' TO DFHEIV0
 19368     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19369     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 352
* EL050.cbl
 19370     MOVE X'2020233030303139313636' TO DFHEIV0(25:11)
 19371     CALL 'kxdfhei1' USING DFHEIV0,
 19372           FILE-ID-ERRESC,
 19373           DFHEIV11,
 19374           DFHEIV99
 19375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19376        GO TO 6690-END-OF-FILE.
 19377
 19378     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19379        NEXT SENTENCE
 19380      ELSE
 19381        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19382
 19383* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19384*
 19385     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19386
 19387     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19388
 19389     IF WS-SUB1 > ZERO
 19390         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19391             PERFORM 6680-SET-COMMISSION
 19392         ELSE
 19393             PERFORM 6680-SET-TABLE-CODE.
 19394
 19395
 19396* EXEC CICS ENDBR
 19397*         DATASET (FILE-ID-ERRESC)
 19398*    END-EXEC.
 19399     MOVE 0
 19400       TO DFHEIV11
 19401*    MOVE '&2                    $   #00019188' TO DFHEIV0
 19402     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19403     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19404     MOVE X'2020233030303139313838' TO DFHEIV0(25:11)
 19405     CALL 'kxdfhei1' USING DFHEIV0,
 19406           FILE-ID-ERRESC,
 19407           DFHEIV11,
 19408           DFHEIV99
 19409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19410
 19411
 19412     GO TO 6700-COMM-EXIT.
 19413
 19414 6680-SET-TABLE-CODE.
 19415     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19416        MOVE ZEROS             TO WS-SUB1
 19417     ELSE
 19418* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19419* TO COMPUTE AH COMMISSION.
 19420        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19421        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19422        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19423        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19424        PERFORM 6680-READ-CTBL-TABLE
 19425        IF WS-CTBL-READ-SW NOT = 'Y'
 19426           MOVE ZEROS          TO WS-SUB1.
 19427
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 353
* EL050.cbl
 19428 6680-READ-CTBL-TABLE.
 19429*
 19430* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19431* TO COMPUTE LIFE COMMISSION
 19432
 19433     IF CTBL-SW = '0540'
 19434        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19435        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19436        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19437
 19438     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19439
 19440     IF CTBL-TABLE-FOUND
 19441        IF CTBL-SW = '0530'
 19442             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19443                                    * PB-I-AH-TERM
 19444             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19445             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19446        ELSE
 19447             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19448             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19449             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19450     ELSE
 19451        IF FIRST-TIME-THROUGH
 19452            GO TO 6680-READ-CTBL-TABLE
 19453        ELSE
 19454            MOVE ZEROS         TO WS-SUB1.
 19455
 19456 6680-SET-COMMISSION.
 19457     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19458           MOVE ZEROS          TO WS-SUB1
 19459       ELSE
 19460           MOVE RESC-COMMISSION-PER (WS-SUB)
 19461                               TO WS-COMMISSION
 19462           IF CTBL-SW = '0530'
 19463               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19464           ELSE
 19465               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19466
 19467 6680-SEARCH-CATEGORY.
 19468     ADD +1                   TO WS-SUB.
 19469     IF WS-SUB > +12
 19470         GO TO 6680-EXIT.
 19471
 19472     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19473          MOVE WS-SUB         TO WS-SUB1
 19474          GO TO 6680-EXIT.
 19475
 19476     GO TO 6680-SEARCH-CATEGORY.
 19477
 19478 6680-EXIT.
 19479     EXIT.
 19480
 19481 6690-END-OF-FILE.
 19482     GO TO 6700-COMM-EXIT.
 19483
 19484 6690-ERRESC-PROBLEM.
 19485      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 354
* EL050.cbl
 19486      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19487
 19488      GO TO 6700-COMM-EXIT.
 19489
 19490 6700-COMM-EXIT.
 19491     EXIT.
 19492
 19493 7000-GET-RATE.
 19494
 19495* EXEC CICS LINK
 19496*        PROGRAM    ('ELRATE')
 19497*        COMMAREA   (CALCULATION-PASS-AREA)
 19498*        LENGTH     (CP-COMM-LENGTH)
 19499*    END-EXEC.
 19500     MOVE 'ELRATE' TO DFHEIV1
 19501*    MOVE '."C                   (   #00019274' TO DFHEIV0
 19502     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19503     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19504     MOVE X'2020233030303139323734' TO DFHEIV0(25:11)
 19505     CALL 'kxdfhei1' USING DFHEIV0,
 19506           DFHEIV1,
 19507           CALCULATION-PASS-AREA,
 19508           CP-COMM-LENGTH,
 19509           DFHEIV99,
 19510           DFHEIV99,
 19511           DFHEIV99,
 19512           DFHEIV99
 19513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19514
 19515
 19516 7000-EXIT.
 19517     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 355
* EL050.cbl
 19519 7100-FIND-BENEFIT-IN-STATE.
 19520     MOVE 'N'                    TO BEN-SEARCH-SW.
 19521
 19522     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19523         VARYING SUB3 FROM 1 BY 1 UNTIL
 19524            ((SUB3 GREATER 50) OR
 19525              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19526               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19527
 19528     IF SUB3 NOT = 51
 19529         MOVE 'Y'                TO BEN-SEARCH-SW.
 19530
 19531     GO TO 7199-EXIT.
 19532
 19533 7100-BENEFIT-DUMMY.
 19534
 19535 7100-DUMMY-EXIT.
 19536     EXIT.
 19537
 19538 7199-EXIT.
 19539     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 356
* EL050.cbl
 19541 7200-FIND-BENEFIT.
 19542     MOVE 'N'                    TO BEN-SEARCH-SW.
 19543
 19544     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19545         VARYING SUB3 FROM 1 BY 1 UNTIL
 19546            ((SUB3 GREATER 8) OR
 19547            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19548
 19549     IF SUB3 NOT = 9
 19550         MOVE 'Y'                TO BEN-SEARCH-SW.
 19551
 19552     GO TO 7200-EXIT.
 19553
 19554 7200-BENEFIT-DUMMY.
 19555
 19556 7200-DUMMY-EXIT.
 19557     EXIT.
 19558
 19559 7200-EXIT.
 19560     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 357
* EL050.cbl
 19562 7250-LOOK-FOR-RESCINDED-CLAIM.
 19563     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19564                                    W-CL-COMP-CD.
 19565     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19566                                    W-CL-CERT-NO.
 19567
 19568
 19569* EXEC CICS HANDLE CONDITION
 19570*        NOTFND  (7250-CONTINUE)
 19571*        ENDFILE (7250-CONTINUE)
 19572*    END-EXEC.
 19573*    MOVE '"$I''                  ! ) #00019332' TO DFHEIV0
 19574     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19576     MOVE X'2920233030303139333332' TO DFHEIV0(25:11)
 19577     CALL 'kxdfhei1' USING DFHEIV0
 19578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19579
 19580
 19581
 19582* EXEC CICS IGNORE CONDITION
 19583*        DUPKEY
 19584*    END-EXEC.
 19585*    MOVE '"*$                   !   #00019337' TO DFHEIV0
 19586     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19587     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19588     MOVE X'2020233030303139333337' TO DFHEIV0(25:11)
 19589     CALL 'kxdfhei1' USING DFHEIV0
 19590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19591
 19592
 19593
 19594* EXEC CICS STARTBR
 19595*        DATASET   (CLMS-ID)
 19596*        RIDFLD    (ELMSTR-KEY)
 19597*        GENERIC   EQUAL
 19598*        KEYLENGTH (ELMSTR-LENGTH)
 19599*    END-EXEC.
 19600     MOVE 0
 19601       TO DFHEIV11
 19602*    MOVE '&,   KG    E          &   #00019341' TO DFHEIV0
 19603     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19604     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19605     MOVE X'2020233030303139333431' TO DFHEIV0(25:11)
 19606     CALL 'kxdfhei1' USING DFHEIV0,
 19607           CLMS-ID,
 19608           ELMSTR-KEY,
 19609           ELMSTR-LENGTH,
 19610           DFHEIV11,
 19611           DFHEIV99
 19612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19613
 19614
 19615     MOVE 'Y'                    TO W-BROWSE-SW.
 19616
 19617 7250-NEXT-CLAIM.
 19618
 19619
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 358
* EL050.cbl
 19620* EXEC CICS READNEXT
 19621*        DATASET   (CLMS-ID)
 19622*        RIDFLD    (ELMSTR-KEY)
 19623*        SET       (ADDRESS OF CLAIM-MASTER)
 19624*    END-EXEC.
 19625     MOVE 0
 19626       TO DFHEIV11
 19627*    MOVE '&.S                   )   #00019352' TO DFHEIV0
 19628     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19629     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19630     MOVE X'2020233030303139333532' TO DFHEIV0(25:11)
 19631     CALL 'kxdfhei1' USING DFHEIV0,
 19632           CLMS-ID,
 19633           DFHEIV20,
 19634           DFHEIV99,
 19635           ELMSTR-KEY,
 19636           DFHEIV99,
 19637           DFHEIV11,
 19638           DFHEIV99,
 19639           DFHEIV99
 19640     SET ADDRESS OF CLAIM-MASTER TO
 19641         DFHEIV20
 19642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19643
 19644
 19645     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19646        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19647         GO TO 7250-CONTINUE
 19648     END-IF.
 19649
 19650     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19651        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19652        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19653        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19654        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19655         GO TO 7250-NEXT-CLAIM
 19656     END-IF.
 19657
 19658     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19659        OR (CL-CLAIM-TYPE = 'I')
 19660        OR (CL-CLAIM-TYPE = 'G')
 19661        OR (CL-CLAIM-TYPE = 'F')
 19662          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19663              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19664              GO TO 7250-CONTINUE
 19665          END-IF
 19666     END-IF.
 19667
 19668     GO TO 7250-NEXT-CLAIM.
 19669
 19670 7250-CONTINUE.
 19671
 19672     IF W-BROWSE-SW = 'Y'
 19673
 19674* EXEC CICS ENDBR
 19675*            DATASET   (CLMS-ID)
 19676*        END-EXEC
 19677     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 359
* EL050.cbl
 19678       TO DFHEIV11
 19679*    MOVE '&2                    $   #00019386' TO DFHEIV0
 19680     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19681     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19682     MOVE X'2020233030303139333836' TO DFHEIV0(25:11)
 19683     CALL 'kxdfhei1' USING DFHEIV0,
 19684           CLMS-ID,
 19685           DFHEIV11,
 19686           DFHEIV99
 19687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19688         MOVE 'N' TO W-BROWSE-SW
 19689     END-IF.
 19690
 19691 7250-EXIT.
 19692     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 360
* EL050.cbl
 19694 7300-CHECK-FOR-OPEN-CLMS.
 19695
 19696*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19697*    MOVE SPACES                 TO CNTL-ACCESS.
 19698*    MOVE '1'                    TO CNTL-REC-TYPE.
 19699*    MOVE +0                     TO CNTL-SEQ-NO.
 19700
 19701*    MOVE '3'                    TO RC-SW-1.
 19702*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19703
 19704*    IF NOT CF-COMPANY-MASTER
 19705*         PERFORM 0099-COMPANY-NOT-FOUND
 19706*         GO TO 7300-EXIT.
 19707
 19708     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19709                                    W-CL-COMP-CD.
 19710     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19711                                    W-CL-CERT-NO.
 19712
 19713
 19714* EXEC CICS HANDLE CONDITION
 19715*        NOTFND  (7300-CONTINUE)
 19716*        ENDFILE (7300-CONTINUE)
 19717*    END-EXEC.
 19718*    MOVE '"$I''                  ! * #00019414' TO DFHEIV0
 19719     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19720     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19721     MOVE X'2A20233030303139343134' TO DFHEIV0(25:11)
 19722     CALL 'kxdfhei1' USING DFHEIV0
 19723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19724
 19725
 19726
 19727* EXEC CICS IGNORE CONDITION
 19728*        DUPKEY
 19729*    END-EXEC.
 19730*    MOVE '"*$                   !   #00019419' TO DFHEIV0
 19731     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19732     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19733     MOVE X'2020233030303139343139' TO DFHEIV0(25:11)
 19734     CALL 'kxdfhei1' USING DFHEIV0
 19735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19736
 19737
 19738
 19739* EXEC CICS STARTBR
 19740*        DATASET   (CLMS-ID)
 19741*        RIDFLD    (ELMSTR-KEY)
 19742*        GENERIC   EQUAL
 19743*        KEYLENGTH (ELMSTR-LENGTH)
 19744*    END-EXEC.
 19745     MOVE 0
 19746       TO DFHEIV11
 19747*    MOVE '&,   KG    E          &   #00019423' TO DFHEIV0
 19748     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19749     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19750     MOVE X'2020233030303139343233' TO DFHEIV0(25:11)
 19751     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 361
* EL050.cbl
 19752           CLMS-ID,
 19753           ELMSTR-KEY,
 19754           ELMSTR-LENGTH,
 19755           DFHEIV11,
 19756           DFHEIV99
 19757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19758
 19759
 19760     MOVE 'Y'                    TO W-BROWSE-SW.
 19761
 19762 7300-NEXT-CLAIM.
 19763
 19764
 19765* EXEC CICS READNEXT
 19766*        DATASET   (CLMS-ID)
 19767*        RIDFLD    (ELMSTR-KEY)
 19768*        SET       (ADDRESS OF CLAIM-MASTER)
 19769*    END-EXEC.
 19770     MOVE 0
 19771       TO DFHEIV11
 19772*    MOVE '&.S                   )   #00019434' TO DFHEIV0
 19773     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19774     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19775     MOVE X'2020233030303139343334' TO DFHEIV0(25:11)
 19776     CALL 'kxdfhei1' USING DFHEIV0,
 19777           CLMS-ID,
 19778           DFHEIV20,
 19779           DFHEIV99,
 19780           ELMSTR-KEY,
 19781           DFHEIV99,
 19782           DFHEIV11,
 19783           DFHEIV99,
 19784           DFHEIV99
 19785     SET ADDRESS OF CLAIM-MASTER TO
 19786         DFHEIV20
 19787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19788
 19789
 19790     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19791        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19792         GO TO 7300-CONTINUE.
 19793
 19794     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19795        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19796        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19797        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19798        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19799         GO TO 7300-NEXT-CLAIM.
 19800
 19801*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19802     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19803        OR (CL-CLAIM-TYPE = 'I')
 19804        OR (CL-CLAIM-TYPE = 'G')
 19805        OR (CL-CLAIM-TYPE = 'F')
 19806        IF CLAIM-IS-OPEN
 19807           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19808             AND PB-C-AH-CANCEL-DT > SPACES
 19809              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 362
* EL050.cbl
 19810              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19811           END-IF
 19812           EVALUATE TRUE
 19813             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19814                 MOVE ER-2884      TO WS-ERROR
 19815             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19816                 MOVE ER-2887      TO WS-ERROR
 19817             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19818                 MOVE ER-2886      TO WS-ERROR
 19819             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19820                 MOVE ER-2888      TO WS-ERROR
 19821             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19822                 MOVE ER-2885      TO WS-ERROR
 19823             WHEN OTHER
 19824                 MOVE ER-2768      TO WS-ERROR
 19825           END-EVALUATE
 19826           IF PB-C-AH-CANCEL-VOIDED OR
 19827              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19828                NOT AH-COVERAGE-CANCELLED)
 19829               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19830               MOVE ER-2768      TO WS-ERROR
 19831           END-IF
 19832           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19833           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19834              PB-FORCE-CODE NOT EQUAL '8'
 19835               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19836           END-IF
 19837           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19838           GO TO 7300-NEXT-CLAIM
 19839        ELSE
 19840           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19841*****THIS IS A RESCISSION OR REFORMATION
 19842              IF AH-COVERAGE-CANCELLED
 19843                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19844                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19845                    MOVE 1                   TO DC-ELAPSED-DAYS
 19846                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19847                    SET BIN-PLUS-ELAPSED     TO TRUE
 19848                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19849                    IF NO-CONVERSION-ERROR
 19850                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19851                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19852                          MOVE ER-2897 TO WS-ERROR
 19853                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19854                          GO TO 7300-NEXT-CLAIM
 19855                       END-IF
 19856                    END-IF
 19857                 ELSE
 19858                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19859                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19860                         MOVE ER-2890 TO WS-ERROR
 19861                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19862                         GO TO 7300-NEXT-CLAIM
 19863                      ELSE
 19864                         MOVE ER-2898 TO WS-ERROR
 19865                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19866                         GO TO 7300-NEXT-CLAIM
 19867                      END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 363
* EL050.cbl
 19868                   END-IF
 19869                 END-IF
 19870              END-IF
 19871           ELSE
 19872              IF CL-DENIAL-TYPE = '1'  AND
 19873                 CL-TOTAL-PAID-AMT = 0
 19874                    GO TO 7300-NEXT-CLAIM
 19875              END-IF
 19876              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19877               AND PB-C-AH-CANCEL-DT > SPACES
 19878                 MOVE ER-2756        TO WS-ERROR
 19879                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19880                 GO TO 7300-NEXT-CLAIM
 19881              END-IF
 19882           END-IF
 19883        END-IF
 19884     ELSE
 19885*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19886        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19887           IF (CLAIM-IS-OPEN)
 19888              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19889                 <> zeros
 19890              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19891                 <> zeros)
 19892              MOVE ER-2889      TO WS-ERROR
 19893              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19894              GO TO 7300-NEXT-CLAIM
 19895           ELSE
 19896              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19897*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19898                 IF (LF-COVERAGE-CANCELLED AND
 19899                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19900                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19901                         MOVE ER-2890 TO WS-ERROR
 19902                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19903                         GO TO 7300-NEXT-CLAIM
 19904                      ELSE
 19905                         MOVE ER-2898 TO WS-ERROR
 19906                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19907                         GO TO 7300-NEXT-CLAIM
 19908                      END-IF
 19909                 END-IF
 19910              ELSE
 19911                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19912                    and (CL-TOTAL-PAID-AMT = 0)
 19913                    GO TO 7300-NEXT-CLAIM
 19914                 END-IF
 19915                 IF (
 19916                      (AH-COVERAGE-CANCELLED)
 19917                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19918                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19919                      and (pb-ci-ah-cancel-amt +
 19920                         pb-c-ah-cancel-amt) <> zeros
 19921                    )
 19922                               OR
 19923                    (
 19924                      (LF-COVERAGE-CANCELLED)
 19925                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 364
* EL050.cbl
 19926                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19927                      and (pb-ci-lf-cancel-amt +
 19928                         pb-c-lf-cancel-amt) <> zeros
 19929                    )
 19930                       MOVE ER-2965 TO WS-ERROR
 19931                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19932                       GO TO 7300-NEXT-CLAIM
 19933                 END-IF
 19934                 IF LF-COVERAGE-CANCELLED
 19935                  IF CL-TOTAL-PAID-AMT > 0
 19936                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19937                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19938                        MOVE ER-2891 TO WS-ERROR
 19939                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19940                        GO TO 7300-NEXT-CLAIM
 19941                      END-IF
 19942                    ELSE
 19943****only show this error if cert num matches exactly
 19944                      IF PB-CERT-NO = CL-CERT-NO
 19945                         MOVE ER-2892 TO WS-ERROR
 19946                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19947                         GO TO 7300-NEXT-CLAIM
 19948                      END-IF
 19949                    END-IF
 19950                  END-IF
 19951                 END-IF
 19952              END-IF
 19953           END-IF
 19954        END-IF
 19955     END-IF
 19956
 19957     GO TO 7300-NEXT-CLAIM.
 19958
 19959 7300-CONTINUE.
 19960
 19961     IF W-BROWSE-SW = 'Y'
 19962
 19963* EXEC CICS ENDBR
 19964*            DATASET   (CLMS-ID)
 19965*        END-EXEC.
 19966     MOVE 0
 19967       TO DFHEIV11
 19968*    MOVE '&2                    $   #00019612' TO DFHEIV0
 19969     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19970     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19971     MOVE X'2020233030303139363132' TO DFHEIV0(25:11)
 19972     CALL 'kxdfhei1' USING DFHEIV0,
 19973           CLMS-ID,
 19974           DFHEIV11,
 19975           DFHEIV99
 19976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19977
 19978
 19979 7300-EXIT.
 19980     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 365
* EL050.cbl
 19982
 19983 7400-GET-REMAIN-TERM.
 19984
 19985* EXEC CICS LINK
 19986*        PROGRAM    ('ELRTRM')
 19987*        COMMAREA   (CALCULATION-PASS-AREA)
 19988*        LENGTH     (CP-COMM-LENGTH)
 19989*    END-EXEC.
 19990     MOVE 'ELRTRM' TO DFHEIV1
 19991*    MOVE '."C                   (   #00019621' TO DFHEIV0
 19992     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19993     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19994     MOVE X'2020233030303139363231' TO DFHEIV0(25:11)
 19995     CALL 'kxdfhei1' USING DFHEIV0,
 19996           DFHEIV1,
 19997           CALCULATION-PASS-AREA,
 19998           CP-COMM-LENGTH,
 19999           DFHEIV99,
 20000           DFHEIV99,
 20001           DFHEIV99,
 20002           DFHEIV99
 20003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20004
 20005
 20006 7400-EXIT.
 20007     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 366
* EL050.cbl
 20009
 20010 7500-GET-REMAIN-AMOUNT.
 20011
 20012* EXEC CICS LINK
 20013*        PROGRAM    ('ELRAMT')
 20014*        COMMAREA   (CALCULATION-PASS-AREA)
 20015*        LENGTH     (CP-COMM-LENGTH)
 20016*    END-EXEC.
 20017     MOVE 'ELRAMT' TO DFHEIV1
 20018*    MOVE '."C                   (   #00019632' TO DFHEIV0
 20019     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20020     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20021     MOVE X'2020233030303139363332' TO DFHEIV0(25:11)
 20022     CALL 'kxdfhei1' USING DFHEIV0,
 20023           DFHEIV1,
 20024           CALCULATION-PASS-AREA,
 20025           CP-COMM-LENGTH,
 20026           DFHEIV99,
 20027           DFHEIV99,
 20028           DFHEIV99,
 20029           DFHEIV99
 20030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20031
 20032
 20033 7500-EXIT.
 20034     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 367
* EL050.cbl
 20036
 20037 7600-GET-REFUND.
 20038
 20039* EXEC CICS LINK
 20040*        PROGRAM    ('ELRFND')
 20041*        COMMAREA   (CALCULATION-PASS-AREA)
 20042*        LENGTH     (CP-COMM-LENGTH)
 20043*    END-EXEC.
 20044     MOVE 'ELRFND' TO DFHEIV1
 20045*    MOVE '."C                   (   #00019643' TO DFHEIV0
 20046     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20047     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20048     MOVE X'2020233030303139363433' TO DFHEIV0(25:11)
 20049     CALL 'kxdfhei1' USING DFHEIV0,
 20050           DFHEIV1,
 20051           CALCULATION-PASS-AREA,
 20052           CP-COMM-LENGTH,
 20053           DFHEIV99,
 20054           DFHEIV99,
 20055           DFHEIV99,
 20056           DFHEIV99
 20057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20058
 20059
 20060 7600-EXIT.
 20061     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 368
* EL050.cbl
 20063 7700-CALL-DL1.
 20064
 20065* EXEC CICS LINK
 20066*        PROGRAM    ('DLO001')
 20067*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20068*        LENGTH     (DLO001-COMM-LENGTH)
 20069*    END-EXEC.
 20070     MOVE 'DLO001' TO DFHEIV1
 20071*    MOVE '."C                   (   #00019653' TO DFHEIV0
 20072     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20073     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20074     MOVE X'2020233030303139363533' TO DFHEIV0(25:11)
 20075     CALL 'kxdfhei1' USING DFHEIV0,
 20076           DFHEIV1,
 20077           WS-DLO-MASTER-POLICY-FORM,
 20078           DLO001-COMM-LENGTH,
 20079           DFHEIV99,
 20080           DFHEIV99,
 20081           DFHEIV99,
 20082           DFHEIV99
 20083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20084
 20085
 20086 7700-EXIT.
 20087     EXIT.
 20088
 20089 7710-CALL-DL2.
 20090
 20091* EXEC CICS LINK
 20092*        PROGRAM    ('DLO002')
 20093*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20094*        LENGTH     (DLO002-COMM-LENGTH)
 20095*    END-EXEC.
 20096     MOVE 'DLO002' TO DFHEIV1
 20097*    MOVE '."C                   (   #00019663' TO DFHEIV0
 20098     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20099     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20100     MOVE X'2020233030303139363633' TO DFHEIV0(25:11)
 20101     CALL 'kxdfhei1' USING DFHEIV0,
 20102           DFHEIV1,
 20103           WS-DLO-INTERNAL-POLICY-FORM,
 20104           DLO002-COMM-LENGTH,
 20105           DFHEIV99,
 20106           DFHEIV99,
 20107           DFHEIV99,
 20108           DFHEIV99
 20109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20110
 20111
 20112 7710-EXIT.
 20113     EXIT.
 20114
 20115 7720-CALL-DL3.
 20116
 20117* EXEC CICS LINK
 20118*        PROGRAM    ('DLO003')
 20119*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20120*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 369
* EL050.cbl
 20121*    END-EXEC.
 20122     MOVE 'DLO003' TO DFHEIV1
 20123*    MOVE '."C                   (   #00019673' TO DFHEIV0
 20124     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20125     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20126     MOVE X'2020233030303139363733' TO DFHEIV0(25:11)
 20127     CALL 'kxdfhei1' USING DFHEIV0,
 20128           DFHEIV1,
 20129           WS-DLO-VALID-BANK-ID,
 20130           DLO003-COMM-LENGTH,
 20131           DFHEIV99,
 20132           DFHEIV99,
 20133           DFHEIV99,
 20134           DFHEIV99
 20135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20136
 20137
 20138 7720-EXIT.
 20139     EXIT.
 20140
 20141 7730-CALL-DL7.
 20142
 20143* EXEC CICS LINK
 20144*        PROGRAM    ('DLO007')
 20145*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20146*        LENGTH     (DLO007-COMM-LENGTH)
 20147*    END-EXEC.
 20148     MOVE 'DLO007' TO DFHEIV1
 20149*    MOVE '."C                   (   #00019683' TO DFHEIV0
 20150     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20151     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20152     MOVE X'2020233030303139363833' TO DFHEIV0(25:11)
 20153     CALL 'kxdfhei1' USING DFHEIV0,
 20154           DFHEIV1,
 20155           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20156           DLO007-COMM-LENGTH,
 20157           DFHEIV99,
 20158           DFHEIV99,
 20159           DFHEIV99,
 20160           DFHEIV99
 20161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20162
 20163
 20164 7730-EXIT.
 20165     EXIT.
 20166
 20167 7740-CALL-DL11.
 20168
 20169* EXEC CICS LINK
 20170*        PROGRAM    ('DLO011')
 20171*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20172*        LENGTH     (DLO011-COMM-LENGTH)
 20173*    END-EXEC.
 20174     MOVE 'DLO011' TO DFHEIV1
 20175*    MOVE '."C                   (   #00019693' TO DFHEIV0
 20176     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20177     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20178     MOVE X'2020233030303139363933' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 370
* EL050.cbl
 20179     CALL 'kxdfhei1' USING DFHEIV0,
 20180           DFHEIV1,
 20181           WS-DLO-PREM-RATES-BEN-TYPE,
 20182           DLO011-COMM-LENGTH,
 20183           DFHEIV99,
 20184           DFHEIV99,
 20185           DFHEIV99,
 20186           DFHEIV99
 20187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20188
 20189
 20190 7740-EXIT.
 20191     EXIT.
 20192
 20193 7750-CALL-DL17.
 20194
 20195* EXEC CICS LINK
 20196*        PROGRAM    ('DLO017')
 20197*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20198*        LENGTH     (DLO017-COMM-LENGTH)
 20199*    END-EXEC.
 20200     MOVE 'DLO017' TO DFHEIV1
 20201*    MOVE '."C                   (   #00019703' TO DFHEIV0
 20202     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20203     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20204     MOVE X'2020233030303139373033' TO DFHEIV0(25:11)
 20205     CALL 'kxdfhei1' USING DFHEIV0,
 20206           DFHEIV1,
 20207           WS-DLO-VALID-RATE-CODE,
 20208           DLO017-COMM-LENGTH,
 20209           DFHEIV99,
 20210           DFHEIV99,
 20211           DFHEIV99,
 20212           DFHEIV99
 20213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20214
 20215
 20216 7750-EXIT.
 20217     EXIT.
 20218
 20219 7755-CALL-DL19.
 20220
 20221* EXEC CICS LINK
 20222*        PROGRAM    ('DLO019')
 20223*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20224*        LENGTH     (DLO019-COMM-LENGTH)
 20225*    END-EXEC.
 20226     MOVE 'DLO019' TO DFHEIV1
 20227*    MOVE '."C                   (   #00019713' TO DFHEIV0
 20228     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20229     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20230     MOVE X'2020233030303139373133' TO DFHEIV0(25:11)
 20231     CALL 'kxdfhei1' USING DFHEIV0,
 20232           DFHEIV1,
 20233           WS-DLO-ORIG-COV-CAT,
 20234           DLO019-COMM-LENGTH,
 20235           DFHEIV99,
 20236           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 371
* EL050.cbl
 20237           DFHEIV99,
 20238           DFHEIV99
 20239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20240
 20241
 20242 7755-EXIT.
 20243     EXIT.
 20244
 20245 7760-CALL-DL21.
 20246
 20247* EXEC CICS LINK
 20248*        PROGRAM    ('DLO021')
 20249*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20250*        LENGTH     (DLO021-COMM-LENGTH)
 20251*    END-EXEC.
 20252     MOVE 'DLO021' TO DFHEIV1
 20253*    MOVE '."C                   (   #00019723' TO DFHEIV0
 20254     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20255     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20256     MOVE X'2020233030303139373233' TO DFHEIV0(25:11)
 20257     CALL 'kxdfhei1' USING DFHEIV0,
 20258           DFHEIV1,
 20259           WS-DLO-VALID-LOAN-OFFICER,
 20260           DLO021-COMM-LENGTH,
 20261           DFHEIV99,
 20262           DFHEIV99,
 20263           DFHEIV99,
 20264           DFHEIV99
 20265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20266
 20267
 20268 7760-EXIT.
 20269     EXIT.
 20270
 20271 7770-CALL-DL22.
 20272
 20273* EXEC CICS LINK
 20274*        PROGRAM    ('DLO022')
 20275*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20276*        LENGTH     (DLO022-COMM-LENGTH)
 20277*    END-EXEC.
 20278     MOVE 'DLO022' TO DFHEIV1
 20279*    MOVE '."C                   (   #00019733' TO DFHEIV0
 20280     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20281     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20282     MOVE X'2020233030303139373333' TO DFHEIV0(25:11)
 20283     CALL 'kxdfhei1' USING DFHEIV0,
 20284           DFHEIV1,
 20285           WS-DLO-VALID-STATE-CODE,
 20286           DLO022-COMM-LENGTH,
 20287           DFHEIV99,
 20288           DFHEIV99,
 20289           DFHEIV99,
 20290           DFHEIV99
 20291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20292
 20293
 20294 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 372
* EL050.cbl
 20295     EXIT.
 20296
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 373
* EL050.cbl
 20298
 20299 7780-CALL-AGG.
 20300
 20301* EXEC CICS LINK
 20302*        PROGRAM    ('ELAGGO')
 20303*        COMMAREA   (WS-PASS-to-pemaggo)
 20304*        LENGTH     (ws-passed-key-LENGTH)
 20305*    END-EXEC.
 20306     MOVE 'ELAGGO' TO DFHEIV1
 20307*    MOVE '."C                   (   #00019745' TO DFHEIV0
 20308     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20309     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20310     MOVE X'2020233030303139373435' TO DFHEIV0(25:11)
 20311     CALL 'kxdfhei1' USING DFHEIV0,
 20312           DFHEIV1,
 20313           WS-PASS-to-pemaggo,
 20314           ws-passed-key-LENGTH,
 20315           DFHEIV99,
 20316           DFHEIV99,
 20317           DFHEIV99,
 20318           DFHEIV99
 20319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20320
 20321 7780-EXIT.
 20322     EXIT.
 20323 7785-CALL-HLDI.
 20324
 20325* EXEC CICS LINK
 20326*        PROGRAM    ('ELHLDI')
 20327*        COMMAREA   (HLDI-PASS-AREA)
 20328*        LENGTH     (HLDI-PASS-AREA-LEN)
 20329*    END-EXEC.
 20330     MOVE 'ELHLDI' TO DFHEIV1
 20331*    MOVE '."C                   (   #00019753' TO DFHEIV0
 20332     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20333     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20334     MOVE X'2020233030303139373533' TO DFHEIV0(25:11)
 20335     CALL 'kxdfhei1' USING DFHEIV0,
 20336           DFHEIV1,
 20337           HLDI-PASS-AREA,
 20338           HLDI-PASS-AREA-LEN,
 20339           DFHEIV99,
 20340           DFHEIV99,
 20341           DFHEIV99,
 20342           DFHEIV99
 20343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20344
 20345 7785-EXIT.
 20346     EXIT.
 20347 7786-CALL-HLDIM.
 20348
 20349* EXEC CICS LINK
 20350*        PROGRAM    ('ELHLDIM')
 20351*        COMMAREA   (HLDI-PASS-AREA)
 20352*        LENGTH     (HLDI-PASS-AREA-LEN)
 20353*    END-EXEC.
 20354     MOVE 'ELHLDIM' TO DFHEIV1
 20355*    MOVE '."C                   (   #00019761' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 374
* EL050.cbl
 20356     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20357     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20358     MOVE X'2020233030303139373631' TO DFHEIV0(25:11)
 20359     CALL 'kxdfhei1' USING DFHEIV0,
 20360           DFHEIV1,
 20361           HLDI-PASS-AREA,
 20362           HLDI-PASS-AREA-LEN,
 20363           DFHEIV99,
 20364           DFHEIV99,
 20365           DFHEIV99,
 20366           DFHEIV99
 20367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20368
 20369 7786-EXIT.
 20370     EXIT.
 20371 7790-CALL-ZIP-VERIFY.
 20372
 20373
 20374* EXEC CICS LINK
 20375*        PROGRAM    ('WSZIPCD')
 20376*        COMMAREA   (ZIPCD-PASS-AREA)
 20377*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20378*    END-EXEC.
 20379     MOVE 'WSZIPCD' TO DFHEIV1
 20380*    MOVE '."C                   (   #00019770' TO DFHEIV0
 20381     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20382     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20383     MOVE X'2020233030303139373730' TO DFHEIV0(25:11)
 20384     CALL 'kxdfhei1' USING DFHEIV0,
 20385           DFHEIV1,
 20386           ZIPCD-PASS-AREA,
 20387           ZIPCD-PASS-AREA-LEN,
 20388           DFHEIV99,
 20389           DFHEIV99,
 20390           DFHEIV99,
 20391           DFHEIV99
 20392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20393
 20394
 20395 7790-EXIT.
 20396     EXIT.
 20397 7800-REWRITE-CERT.
 20398******************************************************************
 20399*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20400*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20401******************************************************************
 20402
 20403     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20404        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20405        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20406        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20407
 20408* EXEC CICS REWRITE
 20409*                  DATASET (CERT-ID)
 20410*                  FROM    (CERTIFICATE-MASTER)
 20411*              END-EXEC
 20412     MOVE LENGTH OF
 20413      CERTIFICATE-MASTER
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 375
* EL050.cbl
 20414       TO DFHEIV11
 20415*    MOVE '&& L                  %   #00019788' TO DFHEIV0
 20416     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20417     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20418     MOVE X'2020233030303139373838' TO DFHEIV0(25:11)
 20419     CALL 'kxdfhei1' USING DFHEIV0,
 20420           CERT-ID,
 20421           CERTIFICATE-MASTER,
 20422           DFHEIV11,
 20423           DFHEIV99
 20424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20425        GO TO 7800-EXIT.
 20426
 20427       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20428       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20429
 20430 7800-EXIT.
 20431      EXIT.
 20432
 20433 7900-DELETE-CERT.
 20434
 20435* EXEC CICS DELETE
 20436*        DATASET (CERT-ID)
 20437*    END-EXEC.
 20438*    MOVE '&(                    &   #00019801' TO DFHEIV0
 20439     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20440     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20441     MOVE X'2020233030303139383031' TO DFHEIV0(25:11)
 20442     CALL 'kxdfhei1' USING DFHEIV0,
 20443           CERT-ID,
 20444           DFHEIV99,
 20445           DFHEIV99,
 20446           DFHEIV99,
 20447           DFHEIV99
 20448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20449
 20450
 20451 7900-EXIT.
 20452     EXIT.
 20453
 20454 8000-WRITE-CERT.
 20455
 20456* EXEC CICS HANDLE CONDITION
 20457*        DUPKEY    (8000-FREE-MAIN)
 20458*    END-EXEC.
 20459*    MOVE '"$$                   ! + #00019809' TO DFHEIV0
 20460     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20462     MOVE X'2B20233030303139383039' TO DFHEIV0(25:11)
 20463     CALL 'kxdfhei1' USING DFHEIV0
 20464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20465
 20466
 20467
 20468* EXEC CICS WRITE
 20469*        DATASET     (CERT-ID)
 20470*        FROM        (CERTIFICATE-MASTER)
 20471*        RIDFLD      (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 376
* EL050.cbl
 20472*    END-EXEC.
 20473     MOVE LENGTH OF
 20474      CERTIFICATE-MASTER
 20475       TO DFHEIV11
 20476*    MOVE '&$ L                  ''   #00019813' TO DFHEIV0
 20477     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20478     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20479     MOVE X'2020233030303139383133' TO DFHEIV0(25:11)
 20480     CALL 'kxdfhei1' USING DFHEIV0,
 20481           CERT-ID,
 20482           CERTIFICATE-MASTER,
 20483           DFHEIV11,
 20484           ELCERT-KEY,
 20485           DFHEIV99,
 20486           DFHEIV99
 20487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20488
 20489
 20490 8000-FREE-MAIN.
 20491
 20492 8000-EXIT.
 20493      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 377
* EL050.cbl
 20495
 20496 8100-READ-ERPNDM.
 20497
 20498* EXEC CICS HANDLE CONDITION
 20499*         NOTFND     (8100-NOTFND)
 20500*         ENDFILE    (8100-NOTFND)
 20501*    END-EXEC.
 20502*    MOVE '"$I''                  ! , #00019826' TO DFHEIV0
 20503     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20504     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20505     MOVE X'2C20233030303139383236' TO DFHEIV0(25:11)
 20506     CALL 'kxdfhei1' USING DFHEIV0
 20507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20508
 20509
 20510     MOVE SPACES                 TO ERPNDM-FOUND.
 20511     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20512
 20513
 20514* EXEC CICS READ UPDATE
 20515*         DATASET   (FILE-ERPNDM)
 20516*         RIDFLD    (PM-CONTROL-PRIMARY)
 20517*         INTO      (PENDING-MAILING-DATA)
 20518*    END-EXEC.
 20519     MOVE LENGTH OF
 20520      PENDING-MAILING-DATA
 20521       TO DFHEIV11
 20522*    MOVE '&"IL       EU         (   #00019834' TO DFHEIV0
 20523     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20524     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20525     MOVE X'2020233030303139383334' TO DFHEIV0(25:11)
 20526     CALL 'kxdfhei1' USING DFHEIV0,
 20527           FILE-ERPNDM,
 20528           PENDING-MAILING-DATA,
 20529           DFHEIV11,
 20530           PM-CONTROL-PRIMARY,
 20531           DFHEIV99,
 20532           DFHEIV99,
 20533           DFHEIV99
 20534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20535
 20536
 20537     GO TO 8100-EXIT.
 20538
 20539 8100-NOTFND.
 20540
 20541     MOVE 'X'                    TO ERPNDM-FOUND.
 20542     MOVE ER-2694                TO WS-ERROR.
 20543     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20544     MOVE ER-2883                TO WS-ERROR
 20545     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20546     .
 20547 8100-EXIT.
 20548     EXIT.
 20549 8102-REWRITE-ERPNDM.
 20550
 20551
 20552* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 378
* EL050.cbl
 20553*         DATASET    (FILE-ERPNDM)
 20554*         FROM       (PENDING-MAILING-DATA)
 20555*    END-EXEC
 20556     MOVE LENGTH OF
 20557      PENDING-MAILING-DATA
 20558       TO DFHEIV11
 20559*    MOVE '&& L                  %   #00019854' TO DFHEIV0
 20560     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20561     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20562     MOVE X'2020233030303139383534' TO DFHEIV0(25:11)
 20563     CALL 'kxdfhei1' USING DFHEIV0,
 20564           FILE-ERPNDM,
 20565           PENDING-MAILING-DATA,
 20566           DFHEIV11,
 20567           DFHEIV99
 20568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20569
 20570     .
 20571 8102-EXIT.
 20572     EXIT.
 20573 8104-UNLOCK-ERPNDM.
 20574
 20575
 20576* EXEC CICS UNLOCK
 20577*         DATASET   (FILE-ERPNDM)
 20578*    END-EXEC
 20579*    MOVE '&*                    #   #00019864' TO DFHEIV0
 20580     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20581     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20582     MOVE X'2020233030303139383634' TO DFHEIV0(25:11)
 20583     CALL 'kxdfhei1' USING DFHEIV0,
 20584           FILE-ERPNDM,
 20585           DFHEIV99
 20586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20587
 20588     .
 20589 8104-EXIT.
 20590     EXIT.
 20591 8110-READ-ERMAIL.
 20592
 20593* EXEC CICS HANDLE CONDITION
 20594*         NOTFND     (8110-NOTFND)
 20595*         ENDFILE    (8110-NOTFND)
 20596*    END-EXEC.
 20597*    MOVE '"$I''                  ! - #00019872' TO DFHEIV0
 20598     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20599     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20600     MOVE X'2D20233030303139383732' TO DFHEIV0(25:11)
 20601     CALL 'kxdfhei1' USING DFHEIV0
 20602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20603
 20604
 20605     MOVE SPACES                 TO ERMAIL-FOUND.
 20606     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20607     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20608     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20609     MOVE PB-SV-STATE            TO MA-STATE.
 20610
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 379
* EL050.cbl
 20611
 20612* EXEC CICS READ
 20613*         UPDATE
 20614*         DATASET   (FILE-ERMAIL)
 20615*         RIDFLD    (MA-CONTROL-PRIMARY)
 20616*         INTO      (MAILING-DATA)
 20617*    END-EXEC.
 20618     MOVE LENGTH OF
 20619      MAILING-DATA
 20620       TO DFHEIV11
 20621*    MOVE '&"IL       EU         (   #00019883' TO DFHEIV0
 20622     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20623     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20624     MOVE X'2020233030303139383833' TO DFHEIV0(25:11)
 20625     CALL 'kxdfhei1' USING DFHEIV0,
 20626           FILE-ERMAIL,
 20627           MAILING-DATA,
 20628           DFHEIV11,
 20629           MA-CONTROL-PRIMARY,
 20630           DFHEIV99,
 20631           DFHEIV99,
 20632           DFHEIV99
 20633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20634
 20635
 20636     GO TO 8110-EXIT.
 20637
 20638 8110-NOTFND.
 20639     MOVE 'X'                    TO ERMAIL-FOUND.
 20640
 20641 8110-EXIT.
 20642     EXIT.
 20643
 20644 8120-REWRITE-ERMAIL.
 20645
 20646* EXEC CICS REWRITE
 20647*         DATASET    (FILE-ERMAIL)
 20648*         FROM       (MAILING-DATA)
 20649*    END-EXEC.
 20650     MOVE LENGTH OF
 20651      MAILING-DATA
 20652       TO DFHEIV11
 20653*    MOVE '&& L                  %   #00019899' TO DFHEIV0
 20654     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20655     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20656     MOVE X'2020233030303139383939' TO DFHEIV0(25:11)
 20657     CALL 'kxdfhei1' USING DFHEIV0,
 20658           FILE-ERMAIL,
 20659           MAILING-DATA,
 20660           DFHEIV11,
 20661           DFHEIV99
 20662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20663
 20664
 20665 8120-EXIT.
 20666     EXIT.
 20667
 20668 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 380
* EL050.cbl
 20669
 20670* EXEC CICS HANDLE CONDITION
 20671*         DUPKEY   (8130-EXIT)
 20672*    END-EXEC.
 20673*    MOVE '"$$                   ! . #00019908' TO DFHEIV0
 20674     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20675     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20676     MOVE X'2E20233030303139393038' TO DFHEIV0(25:11)
 20677     CALL 'kxdfhei1' USING DFHEIV0
 20678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20679
 20680
 20681
 20682* EXEC CICS WRITE
 20683*         DATASET     (FILE-ERMAIL)
 20684*         RIDFLD      (MA-CONTROL-PRIMARY)
 20685*         FROM        (MAILING-DATA)
 20686*    END-EXEC.
 20687     MOVE LENGTH OF
 20688      MAILING-DATA
 20689       TO DFHEIV11
 20690*    MOVE '&$ L                  ''   #00019912' TO DFHEIV0
 20691     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20692     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20693     MOVE X'2020233030303139393132' TO DFHEIV0(25:11)
 20694     CALL 'kxdfhei1' USING DFHEIV0,
 20695           FILE-ERMAIL,
 20696           MAILING-DATA,
 20697           DFHEIV11,
 20698           MA-CONTROL-PRIMARY,
 20699           DFHEIV99,
 20700           DFHEIV99
 20701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20702
 20703
 20704 8130-EXIT.
 20705     EXIT.
 20706
 20707 8140-UNLOCK-ERMAIL.
 20708
 20709* EXEC CICS UNLOCK
 20710*         DATASET   (FILE-ERMAIL)
 20711*    END-EXEC.
 20712*    MOVE '&*                    #   #00019922' TO DFHEIV0
 20713     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20714     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20715     MOVE X'2020233030303139393232' TO DFHEIV0(25:11)
 20716     CALL 'kxdfhei1' USING DFHEIV0,
 20717           FILE-ERMAIL,
 20718           DFHEIV99
 20719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20720
 20721
 20722 8140-EXIT.
 20723     EXIT.
 20724
 20725 8150-read-elcrtt.
 20726
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 381
* EL050.cbl
 20727
 20728* EXEC CICS HANDLE CONDITION
 20729*        NOTFND   (8150-exit)
 20730*    END-EXEC
 20731*    MOVE '"$I                   ! / #00019931' TO DFHEIV0
 20732     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20733     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20734     MOVE X'2F20233030303139393331' TO DFHEIV0(25:11)
 20735     CALL 'kxdfhei1' USING DFHEIV0
 20736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20737
 20738     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20739     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20740
 20741
 20742* EXEC CICS READ
 20743*        DATASET  (CRTT-ID)
 20744*        RIDFLD   (WS-ELCRTT-KEY)
 20745*        INTO     (CERTIFICATE-TRAILERS)
 20746*    END-EXEC
 20747     MOVE LENGTH OF
 20748      CERTIFICATE-TRAILERS
 20749       TO DFHEIV11
 20750*    MOVE '&"IL       E          (   #00019938' TO DFHEIV0
 20751     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20752     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20753     MOVE X'2020233030303139393338' TO DFHEIV0(25:11)
 20754     CALL 'kxdfhei1' USING DFHEIV0,
 20755           CRTT-ID,
 20756           CERTIFICATE-TRAILERS,
 20757           DFHEIV11,
 20758           WS-ELCRTT-KEY,
 20759           DFHEIV99,
 20760           DFHEIV99,
 20761           DFHEIV99
 20762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20763
 20764     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20765     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20766     move cs-vehicle-odometer    to ws-vehicle-odometer
 20767
 20768     .
 20769 8150-exit.
 20770     exit.
 20771 8180-UPDATE-VIN-NUMBER.
 20772
 20773* EXEC CICS HANDLE CONDITION
 20774*        NOTFND   (8180-NOTFND)
 20775*    END-EXEC.
 20776*    MOVE '"$I                   ! 0 #00019952' TO DFHEIV0
 20777     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20778     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20779     MOVE X'3020233030303139393532' TO DFHEIV0(25:11)
 20780     CALL 'kxdfhei1' USING DFHEIV0
 20781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20782
 20783
 20784     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 382
* EL050.cbl
 20785     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20786
 20787
 20788* EXEC CICS READ
 20789*        UPDATE
 20790*        DATASET  (CRTT-ID)
 20791*        RIDFLD   (WS-ELCRTT-KEY)
 20792*        INTO     (CERTIFICATE-TRAILERS)
 20793*    END-EXEC.
 20794     MOVE LENGTH OF
 20795      CERTIFICATE-TRAILERS
 20796       TO DFHEIV11
 20797*    MOVE '&"IL       EU         (   #00019959' TO DFHEIV0
 20798     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20799     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20800     MOVE X'2020233030303139393539' TO DFHEIV0(25:11)
 20801     CALL 'kxdfhei1' USING DFHEIV0,
 20802           CRTT-ID,
 20803           CERTIFICATE-TRAILERS,
 20804           DFHEIV11,
 20805           WS-ELCRTT-KEY,
 20806           DFHEIV99,
 20807           DFHEIV99,
 20808           DFHEIV99
 20809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20810
 20811
 20812     IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 20813        or (hldi-pass-area not = spaces)
 20814        move pa-modelyear        to cs-year
 20815        move pa-makename         to cs-make
 20816        move pa-modelname        to cs-model
 20817        move pa-seriesname       to cs-future
 20818        MOVE PB-I-VIN TO CS-VIN-NUMBER
 20819
 20820* EXEC CICS REWRITE
 20821*           DATASET  (CRTT-ID)
 20822*           FROM     (CERTIFICATE-TRAILERS)
 20823*        END-EXEC
 20824     MOVE LENGTH OF
 20825      CERTIFICATE-TRAILERS
 20826       TO DFHEIV11
 20827*    MOVE '&& L                  %   #00019973' TO DFHEIV0
 20828     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20829     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20830     MOVE X'2020233030303139393733' TO DFHEIV0(25:11)
 20831     CALL 'kxdfhei1' USING DFHEIV0,
 20832           CRTT-ID,
 20833           CERTIFICATE-TRAILERS,
 20834           DFHEIV11,
 20835           DFHEIV99
 20836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20837     ELSE
 20838
 20839* EXEC CICS UNLOCK
 20840*          DATASET  (CRTT-ID)
 20841*       END-EXEC
 20842*    MOVE '&*                    #   #00019978' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 383
* EL050.cbl
 20843     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20844     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20845     MOVE X'2020233030303139393738' TO DFHEIV0(25:11)
 20846     CALL 'kxdfhei1' USING DFHEIV0,
 20847           CRTT-ID,
 20848           DFHEIV99
 20849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20850     END-IF.
 20851
 20852     GO TO 8180-EXIT.
 20853
 20854 8180-NOTFND.
 20855
 20856     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20857     MOVE 'CS'         TO CS-RECORD-ID.
 20858     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20859     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20860     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20861     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20862
 20863* EXEC CICS WRITE
 20864*       DATASET  (CRTT-ID)
 20865*       RIDFLD   (WS-ELCRTT-KEY)
 20866*       FROM     (CERTIFICATE-TRAILERS)
 20867*    END-EXEC.
 20868     MOVE LENGTH OF
 20869      CERTIFICATE-TRAILERS
 20870       TO DFHEIV11
 20871*    MOVE '&$ L                  ''   #00019993' TO DFHEIV0
 20872     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20873     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20874     MOVE X'2020233030303139393933' TO DFHEIV0(25:11)
 20875     CALL 'kxdfhei1' USING DFHEIV0,
 20876           CRTT-ID,
 20877           CERTIFICATE-TRAILERS,
 20878           DFHEIV11,
 20879           WS-ELCRTT-KEY,
 20880           DFHEIV99,
 20881           DFHEIV99
 20882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20883
 20884
 20885 8180-EXIT.
 20886     EXIT.
 20887
 20888 8190-UPDATE-REFUND-CLAIM-FLAG.
 20889
 20890* EXEC CICS HANDLE CONDITION
 20891*        NOTFND   (8190-NOTFND)
 20892*    END-EXEC.
 20893*    MOVE '"$I                   ! 1 #00020003' TO DFHEIV0
 20894     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20895     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20896     MOVE X'3120233030303230303033' TO DFHEIV0(25:11)
 20897     CALL 'kxdfhei1' USING DFHEIV0
 20898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20899
 20900
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 384
* EL050.cbl
 20901     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20902     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20903
 20904
 20905* EXEC CICS READ
 20906*        UPDATE
 20907*        DATASET  (CRTT-ID)
 20908*        RIDFLD   (WS-ELCRTT-KEY)
 20909*        INTO     (CERTIFICATE-TRAILERS)
 20910*    END-EXEC.
 20911     MOVE LENGTH OF
 20912      CERTIFICATE-TRAILERS
 20913       TO DFHEIV11
 20914*    MOVE '&"IL       EU         (   #00020010' TO DFHEIV0
 20915     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20916     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20917     MOVE X'2020233030303230303130' TO DFHEIV0(25:11)
 20918     CALL 'kxdfhei1' USING DFHEIV0,
 20919           CRTT-ID,
 20920           CERTIFICATE-TRAILERS,
 20921           DFHEIV11,
 20922           WS-ELCRTT-KEY,
 20923           DFHEIV99,
 20924           DFHEIV99,
 20925           DFHEIV99
 20926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20927
 20928
 20929     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20930
 20931* EXEC CICS REWRITE
 20932*       DATASET  (CRTT-ID)
 20933*       FROM     (CERTIFICATE-TRAILERS)
 20934*    END-EXEC.
 20935     MOVE LENGTH OF
 20936      CERTIFICATE-TRAILERS
 20937       TO DFHEIV11
 20938*    MOVE '&& L                  %   #00020018' TO DFHEIV0
 20939     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20940     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20941     MOVE X'2020233030303230303138' TO DFHEIV0(25:11)
 20942     CALL 'kxdfhei1' USING DFHEIV0,
 20943           CRTT-ID,
 20944           CERTIFICATE-TRAILERS,
 20945           DFHEIV11,
 20946           DFHEIV99
 20947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20948
 20949
 20950     GO TO 8190-EXIT.
 20951
 20952 8190-NOTFND.
 20953
 20954     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20955     MOVE 'CS'         TO CS-RECORD-ID.
 20956     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20957     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20958     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 385
* EL050.cbl
 20959     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20960
 20961* EXEC CICS WRITE
 20962*       DATASET  (CRTT-ID)
 20963*       RIDFLD   (WS-ELCRTT-KEY)
 20964*       FROM     (CERTIFICATE-TRAILERS)
 20965*    END-EXEC.
 20966     MOVE LENGTH OF
 20967      CERTIFICATE-TRAILERS
 20968       TO DFHEIV11
 20969*    MOVE '&$ L                  ''   #00020033' TO DFHEIV0
 20970     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20971     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20972     MOVE X'2020233030303230303333' TO DFHEIV0(25:11)
 20973     CALL 'kxdfhei1' USING DFHEIV0,
 20974           CRTT-ID,
 20975           CERTIFICATE-TRAILERS,
 20976           DFHEIV11,
 20977           WS-ELCRTT-KEY,
 20978           DFHEIV99,
 20979           DFHEIV99
 20980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20981
 20982
 20983 8190-EXIT.
 20984     EXIT.
 20985
 20986 8195-UPDATE-AGE-FLAGS.
 20987
 20988* EXEC CICS HANDLE CONDITION
 20989*        NOTFND   (8195-NOTFND)
 20990*    END-EXEC.
 20991*    MOVE '"$I                   ! 2 #00020043' TO DFHEIV0
 20992     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20994     MOVE X'3220233030303230303433' TO DFHEIV0(25:11)
 20995     CALL 'kxdfhei1' USING DFHEIV0
 20996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20997
 20998
 20999     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21000     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21001
 21002
 21003* EXEC CICS READ
 21004*        UPDATE
 21005*        DATASET  (CRTT-ID)
 21006*        RIDFLD   (WS-ELCRTT-KEY)
 21007*        INTO     (CERTIFICATE-TRAILERS)
 21008*    END-EXEC.
 21009     MOVE LENGTH OF
 21010      CERTIFICATE-TRAILERS
 21011       TO DFHEIV11
 21012*    MOVE '&"IL       EU         (   #00020050' TO DFHEIV0
 21013     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21014     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21015     MOVE X'2020233030303230303530' TO DFHEIV0(25:11)
 21016     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 386
* EL050.cbl
 21017           CRTT-ID,
 21018           CERTIFICATE-TRAILERS,
 21019           DFHEIV11,
 21020           WS-ELCRTT-KEY,
 21021           DFHEIV99,
 21022           DFHEIV99,
 21023           DFHEIV99
 21024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21025
 21026
 21027     IF WS-INS-AGE-SET = 'Y'
 21028        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21029     END-IF
 21030     IF WS-JNT-AGE-SET = 'Y'
 21031        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21032     END-IF
 21033
 21034
 21035* EXEC CICS REWRITE
 21036*       DATASET  (CRTT-ID)
 21037*       FROM     (CERTIFICATE-TRAILERS)
 21038*    END-EXEC.
 21039     MOVE LENGTH OF
 21040      CERTIFICATE-TRAILERS
 21041       TO DFHEIV11
 21042*    MOVE '&& L                  %   #00020064' TO DFHEIV0
 21043     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21044     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21045     MOVE X'2020233030303230303634' TO DFHEIV0(25:11)
 21046     CALL 'kxdfhei1' USING DFHEIV0,
 21047           CRTT-ID,
 21048           CERTIFICATE-TRAILERS,
 21049           DFHEIV11,
 21050           DFHEIV99
 21051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21052
 21053
 21054     GO TO 8195-EXIT.
 21055
 21056 8195-NOTFND.
 21057
 21058     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21059     MOVE 'CS'         TO CS-RECORD-ID.
 21060     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21061     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21062     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21063     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21064     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21065
 21066* EXEC CICS WRITE
 21067*       DATASET  (CRTT-ID)
 21068*       RIDFLD   (WS-ELCRTT-KEY)
 21069*       FROM     (CERTIFICATE-TRAILERS)
 21070*    END-EXEC.
 21071     MOVE LENGTH OF
 21072      CERTIFICATE-TRAILERS
 21073       TO DFHEIV11
 21074*    MOVE '&$ L                  ''   #00020080' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 387
* EL050.cbl
 21075     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21076     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21077     MOVE X'2020233030303230303830' TO DFHEIV0(25:11)
 21078     CALL 'kxdfhei1' USING DFHEIV0,
 21079           CRTT-ID,
 21080           CERTIFICATE-TRAILERS,
 21081           DFHEIV11,
 21082           WS-ELCRTT-KEY,
 21083           DFHEIV99,
 21084           DFHEIV99
 21085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21086
 21087
 21088 8195-EXIT.
 21089     EXIT.
 21090
 21091 8200-READ-REIN-TABLE.
 21092
 21093* EXEC CICS HANDLE CONDITION
 21094*         NOTFND   (8200-NOTFND)
 21095*    END-EXEC.
 21096*    MOVE '"$I                   ! 3 #00020090' TO DFHEIV0
 21097     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21098     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21099     MOVE X'3320233030303230303930' TO DFHEIV0(25:11)
 21100     CALL 'kxdfhei1' USING DFHEIV0
 21101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21102
 21103
 21104
 21105* EXEC CICS READ
 21106*        DATASET     (REIN-ID)
 21107*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21108*        RIDFLD      (ERREIN-KEY)
 21109*    END-EXEC.
 21110*    MOVE '&"S        E          (   #00020094' TO DFHEIV0
 21111     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21112     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21113     MOVE X'2020233030303230303934' TO DFHEIV0(25:11)
 21114     CALL 'kxdfhei1' USING DFHEIV0,
 21115           REIN-ID,
 21116           DFHEIV20,
 21117           DFHEIV99,
 21118           ERREIN-KEY,
 21119           DFHEIV99,
 21120           DFHEIV99,
 21121           DFHEIV99
 21122     SET ADDRESS OF REINSURANCE-RECORD TO
 21123         DFHEIV20
 21124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21125
 21126
 21127     GO TO 8200-EXIT.
 21128
 21129 8200-NOTFND.
 21130     MOVE 'N'             TO WS-REIN-READ-SW.
 21131
 21132 8200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 388
* EL050.cbl
 21133      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 389
* EL050.cbl
 21135
 21136 8300-READ-CTBL-TABLE.
 21137
 21138* EXEC CICS HANDLE CONDITION
 21139*        NOTFND    (8300-NOTFND)
 21140*        DISABLED  (8300-ERRESS-PROBLEM)
 21141*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21142*        ENDFILE   (8300-NOTFND)
 21143*    END-EXEC.
 21144*    MOVE '"$IcJ''                ! 4 #00020110' TO DFHEIV0
 21145     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21146     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21147     MOVE X'3420233030303230313130' TO DFHEIV0(25:11)
 21148     CALL 'kxdfhei1' USING DFHEIV0
 21149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21150
 21151
 21152
 21153* EXEC CICS READ
 21154*        DATASET     (CTBL-ID)
 21155*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21156*        RIDFLD      (ERCTBL-KEY)
 21157*    END-EXEC.
 21158*    MOVE '&"S        E          (   #00020117' TO DFHEIV0
 21159     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21160     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21161     MOVE X'2020233030303230313137' TO DFHEIV0(25:11)
 21162     CALL 'kxdfhei1' USING DFHEIV0,
 21163           CTBL-ID,
 21164           DFHEIV20,
 21165           DFHEIV99,
 21166           ERCTBL-KEY,
 21167           DFHEIV99,
 21168           DFHEIV99,
 21169           DFHEIV99
 21170     SET ADDRESS OF COMM-TABLE-RECORD TO
 21171         DFHEIV20
 21172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21173
 21174
 21175     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21176
 21177     GO TO 8300-EXIT.
 21178
 21179 8300-NOTFND.
 21180
 21181     IF CTBL-SW = '0530'
 21182         MOVE 'AA'                     TO WS-AH-COMP-CD
 21183         MOVE '0550'                   TO CTBL-SW
 21184         MOVE '1'                      TO WS-CTBL-READ-SW
 21185         GO TO 8300-EXIT.
 21186
 21187     IF CTBL-SW = '0540'
 21188         MOVE 'AA'                     TO WS-LF-COMP-CD
 21189         MOVE '0550'                   TO CTBL-SW
 21190         MOVE '1'                      TO WS-CTBL-READ-SW
 21191         GO TO 8300-EXIT.
 21192
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 390
* EL050.cbl
 21193     IF CTBL-SW = '0550'
 21194         MOVE '2'                      TO WS-CTBL-READ-SW
 21195         GO TO 8300-EXIT.
 21196
 21197     GO TO 8300-EXIT.
 21198
 21199 8300-ERRESS-PROBLEM.
 21200
 21201      MOVE ER-8050              TO WS-ERROR.
 21202      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21203
 21204     GO TO 8300-EXIT.
 21205
 21206 8300-EXIT.
 21207      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 391
* EL050.cbl
 21209
 21210
 21211 8400-GETMAIN-ERFORM.
 21212
 21213
 21214* EXEC CICS   GETMAIN
 21215*        LENGTH  (500)
 21216*        SET     (ADDRESS OF FORM-MASTER)
 21217*    END-EXEC.
 21218     MOVE 500
 21219       TO DFHEIV11
 21220*    MOVE '," L                  $   #00020161' TO DFHEIV0
 21221     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21222     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21223     MOVE X'2020233030303230313631' TO DFHEIV0(25:11)
 21224     CALL 'kxdfhei1' USING DFHEIV0,
 21225           DFHEIV20,
 21226           DFHEIV11,
 21227           DFHEIV99
 21228     SET ADDRESS OF FORM-MASTER TO
 21229         DFHEIV20
 21230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21231
 21232
 21233     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21234
 21235 8400-EXIT.
 21236      EXIT.
 21237
 21238 8450-READ-FORM-MASTER.
 21239
 21240
 21241* EXEC CICS  HANDLE CONDITION
 21242*        NOTFND   (8450-FORM-NOT-FOUND)
 21243*        ENDFILE  (8450-FORM-NOT-FOUND)
 21244*    END-EXEC.
 21245*    MOVE '"$I''                  ! 5 #00020173' TO DFHEIV0
 21246     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21247     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21248     MOVE X'3520233030303230313733' TO DFHEIV0(25:11)
 21249     CALL 'kxdfhei1' USING DFHEIV0
 21250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21251
 21252
 21253
 21254* EXEC CICS   READ
 21255*        DATASET   (FORM-ID)
 21256*        RIDFLD    (ERFORM-KEY)
 21257*        INTO      (FORM-MASTER)
 21258*        GTEQ
 21259*    END-EXEC.
 21260     MOVE LENGTH OF
 21261      FORM-MASTER
 21262       TO DFHEIV11
 21263*    MOVE '&"IL       G          (   #00020178' TO DFHEIV0
 21264     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21265     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21266     MOVE X'2020233030303230313738' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 392
* EL050.cbl
 21267     CALL 'kxdfhei1' USING DFHEIV0,
 21268           FORM-ID,
 21269           FORM-MASTER,
 21270           DFHEIV11,
 21271           ERFORM-KEY,
 21272           DFHEIV99,
 21273           DFHEIV99,
 21274           DFHEIV99
 21275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21276
 21277
 21278     MOVE  'Y'           TO  FORM-MASTER-SW.
 21279
 21280     GO TO  8450-EXIT.
 21281
 21282 8450-FORM-NOT-FOUND.
 21283
 21284     MOVE  'N'           TO  FORM-MASTER-SW.
 21285
 21286 8450-EXIT.
 21287      EXIT.
 21288
 21289 8500-DATE-CONVERT.
 21290
 21291* EXEC CICS LINK
 21292*        PROGRAM    ('ELDATCV')
 21293*        COMMAREA   (DATE-CONVERSION-DATA)
 21294*        LENGTH     (DC-COMM-LENGTH)
 21295*    END-EXEC.
 21296     MOVE 'ELDATCV' TO DFHEIV1
 21297*    MOVE '."C                   (   #00020197' TO DFHEIV0
 21298     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21299     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21300     MOVE X'2020233030303230313937' TO DFHEIV0(25:11)
 21301     CALL 'kxdfhei1' USING DFHEIV0,
 21302           DFHEIV1,
 21303           DATE-CONVERSION-DATA,
 21304           DC-COMM-LENGTH,
 21305           DFHEIV99,
 21306           DFHEIV99,
 21307           DFHEIV99,
 21308           DFHEIV99
 21309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21310
 21311
 21312 8500-EXIT.
 21313     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 393
* EL050.cbl
 21315
 21316 8555-RELOAD-CONTROL-FILE.
 21317     CONTINUE.
 21318
 21319 8555-EXIT.
 21320     EXIT.
 21321
 21322 8557-GETMAIN-ERPLAN.
 21323
 21324
 21325* EXEC CICS GETMAIN
 21326*        LENGTH    (840)
 21327*        SET       (ADDRESS OF PLAN-RECORDS)
 21328*    END-EXEC.
 21329     MOVE 840
 21330       TO DFHEIV11
 21331*    MOVE '," L                  $   #00020215' TO DFHEIV0
 21332     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21333     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21334     MOVE X'2020233030303230323135' TO DFHEIV0(25:11)
 21335     CALL 'kxdfhei1' USING DFHEIV0,
 21336           DFHEIV20,
 21337           DFHEIV11,
 21338           DFHEIV99
 21339     SET ADDRESS OF PLAN-RECORDS TO
 21340         DFHEIV20
 21341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21342
 21343
 21344     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21345
 21346 8557-EXIT.
 21347     EXIT.
 21348
 21349 8560-GETMAIN.
 21350
 21351* EXEC CICS GETMAIN
 21352*        LENGTH    (2000)
 21353*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21354*    END-EXEC.
 21355     MOVE 2000
 21356       TO DFHEIV11
 21357*    MOVE '," L                  $   #00020226' TO DFHEIV0
 21358     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21359     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21360     MOVE X'2020233030303230323236' TO DFHEIV0(25:11)
 21361     CALL 'kxdfhei1' USING DFHEIV0,
 21362           DFHEIV20,
 21363           DFHEIV11,
 21364           DFHEIV99
 21365     SET ADDRESS OF ACCOUNT-MASTER TO
 21366         DFHEIV20
 21367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21368
 21369
 21370     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21371
 21372 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 394
* EL050.cbl
 21373     EXIT.
 21374
 21375 8570-START-ACCOUNT-MASTER.
 21376
 21377* EXEC CICS HANDLE CONDITION
 21378*        NOTFND    (0199-ACCT-NOT-FOUND)
 21379*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21380*    END-EXEC.
 21381*    MOVE '"$I''                  ! 6 #00020237' TO DFHEIV0
 21382     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21383     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21384     MOVE X'3620233030303230323337' TO DFHEIV0(25:11)
 21385     CALL 'kxdfhei1' USING DFHEIV0
 21386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21387
 21388
 21389
 21390* EXEC CICS STARTBR
 21391*        DATASET    (ACCT-ID)
 21392*        RIDFLD     (ERACCT-KEY)
 21393*        GTEQ
 21394*    END-EXEC.
 21395     MOVE 0
 21396       TO DFHEIV11
 21397*    MOVE '&,         G          &   #00020242' TO DFHEIV0
 21398     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21399     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21400     MOVE X'2020233030303230323432' TO DFHEIV0(25:11)
 21401     CALL 'kxdfhei1' USING DFHEIV0,
 21402           ACCT-ID,
 21403           ERACCT-KEY,
 21404           DFHEIV99,
 21405           DFHEIV11,
 21406           DFHEIV99
 21407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21408
 21409
 21410 8570-EXIT.
 21411     EXIT.
 21412
 21413 8580-READ-ACCOUNT-MASTER.
 21414
 21415* EXEC CICS HANDLE CONDITION
 21416*        NOTFND    (0199-ACCT-NOT-FOUND)
 21417*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21418*    END-EXEC.
 21419*    MOVE '"$I''                  ! 7 #00020252' TO DFHEIV0
 21420     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21421     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21422     MOVE X'3720233030303230323532' TO DFHEIV0(25:11)
 21423     CALL 'kxdfhei1' USING DFHEIV0
 21424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21425
 21426
 21427
 21428* EXEC CICS READNEXT
 21429*        DATASET     (ACCT-ID)
 21430*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 395
* EL050.cbl
 21431*        RIDFLD      (ERACCT-KEY)
 21432*    END-EXEC.
 21433     MOVE LENGTH OF
 21434      ACCOUNT-MASTER
 21435       TO DFHEIV12
 21436     MOVE 0
 21437       TO DFHEIV11
 21438*    MOVE '&.IL                  )   #00020257' TO DFHEIV0
 21439     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21440     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21441     MOVE X'2020233030303230323537' TO DFHEIV0(25:11)
 21442     CALL 'kxdfhei1' USING DFHEIV0,
 21443           ACCT-ID,
 21444           ACCOUNT-MASTER,
 21445           DFHEIV12,
 21446           ERACCT-KEY,
 21447           DFHEIV99,
 21448           DFHEIV11,
 21449           DFHEIV99,
 21450           DFHEIV99
 21451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21452
 21453
 21454 8580-EXIT.
 21455     EXIT.
 21456
 21457 8582-READ-COMPENSATION-MASTER.
 21458
 21459* EXEC CICS HANDLE CONDITION
 21460*        NOTFND    (8582-COMP-NOT-FOUND)
 21461*        ENDFILE   (8582-COMP-NOT-FOUND)
 21462*    END-EXEC.
 21463*    MOVE '"$I''                  ! 8 #00020267' TO DFHEIV0
 21464     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21466     MOVE X'3820233030303230323637' TO DFHEIV0(25:11)
 21467     CALL 'kxdfhei1' USING DFHEIV0
 21468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21469
 21470
 21471
 21472* EXEC CICS READ
 21473*        DATASET     (COMP-ID)
 21474*        INTO        (COMPENSATION-MASTER)
 21475*        RIDFLD      (ERCOMP-KEY)
 21476*    END-EXEC.
 21477     MOVE LENGTH OF
 21478      COMPENSATION-MASTER
 21479       TO DFHEIV11
 21480*    MOVE '&"IL       E          (   #00020272' TO DFHEIV0
 21481     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21482     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21483     MOVE X'2020233030303230323732' TO DFHEIV0(25:11)
 21484     CALL 'kxdfhei1' USING DFHEIV0,
 21485           COMP-ID,
 21486           COMPENSATION-MASTER,
 21487           DFHEIV11,
 21488           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 396
* EL050.cbl
 21489           DFHEIV99,
 21490           DFHEIV99,
 21491           DFHEIV99
 21492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21493
 21494
 21495     MOVE 'Y'                    TO COMP-MASTER-SW
 21496
 21497     GO TO 8582-EXIT
 21498     .
 21499 8582-COMP-NOT-FOUND.
 21500
 21501     MOVE 'N'                    TO COMP-MASTER-SW.
 21502
 21503 8582-EXIT.
 21504     EXIT.
 21505
 21506 8583-READ-ERAGTC.
 21507
 21508* EXEC CICS HANDLE CONDITION
 21509*        NOTFND    (8583-AGTC-NOT-FOUND)
 21510*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21511*    END-EXEC.
 21512*    MOVE '"$I''                  ! 9 #00020290' TO DFHEIV0
 21513     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21514     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21515     MOVE X'3920233030303230323930' TO DFHEIV0(25:11)
 21516     CALL 'kxdfhei1' USING DFHEIV0
 21517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21518
 21519
 21520
 21521* EXEC CICS STARTBR
 21522*        DATASET    (AGTC-ID)
 21523*        RIDFLD     (ERAGTC-KEY)
 21524*        GTEQ
 21525*    END-EXEC.
 21526     MOVE 0
 21527       TO DFHEIV11
 21528*    MOVE '&,         G          &   #00020295' TO DFHEIV0
 21529     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21530     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21531     MOVE X'2020233030303230323935' TO DFHEIV0(25:11)
 21532     CALL 'kxdfhei1' USING DFHEIV0,
 21533           AGTC-ID,
 21534           ERAGTC-KEY,
 21535           DFHEIV99,
 21536           DFHEIV11,
 21537           DFHEIV99
 21538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21539
 21540
 21541 8583-READ-ERAGTC-NEXT.
 21542
 21543* EXEC CICS READNEXT
 21544*        DATASET     (AGTC-ID)
 21545*        INTO        (AGENT-COMMISSIONS)
 21546*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 397
* EL050.cbl
 21547*    END-EXEC.
 21548     MOVE LENGTH OF
 21549      AGENT-COMMISSIONS
 21550       TO DFHEIV12
 21551     MOVE 0
 21552       TO DFHEIV11
 21553*    MOVE '&.IL                  )   #00020302' TO DFHEIV0
 21554     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21555     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21556     MOVE X'2020233030303230333032' TO DFHEIV0(25:11)
 21557     CALL 'kxdfhei1' USING DFHEIV0,
 21558           AGTC-ID,
 21559           AGENT-COMMISSIONS,
 21560           DFHEIV12,
 21561           ERAGTC-KEY,
 21562           DFHEIV99,
 21563           DFHEIV11,
 21564           DFHEIV99,
 21565           DFHEIV99
 21566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21567
 21568
 21569*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21570
 21571     GO TO 8583-EXIT
 21572     .
 21573 8583-AGTC-NOT-FOUND.
 21574
 21575     MOVE 'N'                    TO AGTC-MASTER-SW.
 21576
 21577 8583-EXIT.
 21578     EXIT.
 21579
 21580 8584-READ-BANK-CROSS-REF.
 21581
 21582* EXEC CICS HANDLE CONDITION
 21583*        NOTFND    (8584-BXRF-NOT-FOUND)
 21584*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21585*    END-EXEC.
 21586*    MOVE '"$I''                  ! : #00020320' TO DFHEIV0
 21587     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21589     MOVE X'3A20233030303230333230' TO DFHEIV0(25:11)
 21590     CALL 'kxdfhei1' USING DFHEIV0
 21591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21592
 21593
 21594
 21595* EXEC CICS READ
 21596*        DATASET     (BXRF-ID)
 21597*        INTO        (BANK-CROSS-REFERENCE)
 21598*        RIDFLD      (ERBXRF-KEY)
 21599*        LENGTH      (BXRF-REC-LENGTH)
 21600*    END-EXEC.
 21601*    MOVE '&"IL       E          (   #00020325' TO DFHEIV0
 21602     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21603     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21604     MOVE X'2020233030303230333235' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 398
* EL050.cbl
 21605     CALL 'kxdfhei1' USING DFHEIV0,
 21606           BXRF-ID,
 21607           BANK-CROSS-REFERENCE,
 21608           BXRF-REC-LENGTH,
 21609           ERBXRF-KEY,
 21610           DFHEIV99,
 21611           DFHEIV99,
 21612           DFHEIV99
 21613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21614
 21615
 21616     MOVE 'Y'                    TO BXRF-MASTER-SW
 21617
 21618     GO TO 8584-EXIT
 21619     .
 21620 8584-BXRF-NOT-FOUND.
 21621
 21622     MOVE 'N'                    TO BXRF-MASTER-SW.
 21623
 21624 8584-EXIT.
 21625     EXIT.
 21626
 21627 8585-READ-PLAN-MASTER.
 21628
 21629
 21630* EXEC CICS HANDLE CONDITION
 21631*        NOTFND    (8585-PLAN-NOT-FOUND)
 21632*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21633*    END-EXEC.
 21634*    MOVE '"$I''                  ! ; #00020345' TO DFHEIV0
 21635     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21636     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21637     MOVE X'3B20233030303230333435' TO DFHEIV0(25:11)
 21638     CALL 'kxdfhei1' USING DFHEIV0
 21639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21640
 21641
 21642
 21643* EXEC CICS READ
 21644*        DATASET     (PLAN-ID)
 21645*        INTO        (PLAN-MASTER)
 21646*        RIDFLD      (ERPLAN-KEY)
 21647*    END-EXEC.
 21648     MOVE LENGTH OF
 21649      PLAN-MASTER
 21650       TO DFHEIV11
 21651*    MOVE '&"IL       E          (   #00020350' TO DFHEIV0
 21652     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21653     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21654     MOVE X'2020233030303230333530' TO DFHEIV0(25:11)
 21655     CALL 'kxdfhei1' USING DFHEIV0,
 21656           PLAN-ID,
 21657           PLAN-MASTER,
 21658           DFHEIV11,
 21659           ERPLAN-KEY,
 21660           DFHEIV99,
 21661           DFHEIV99,
 21662           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 399
* EL050.cbl
 21663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21664
 21665
 21666     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21667
 21668     GO TO 8585-EXIT.
 21669
 21670 8585-PLAN-NOT-FOUND.
 21671
 21672     MOVE 'N'                    TO PLAN-MASTER-SW.
 21673
 21674 8585-EXIT.
 21675     EXIT.
 21676
 21677 8586-READ-LOAN-OFFICER.
 21678
 21679* EXEC CICS READ
 21680*        DATASET     (LOFC-ID)
 21681*        INTO        (LOAN-OFFICER-MASTER)
 21682*        RIDFLD      (ERLOFC-KEY)
 21683*        RESP        (WS-RESPONSE)
 21684*    END-EXEC
 21685     MOVE LENGTH OF
 21686      LOAN-OFFICER-MASTER
 21687       TO DFHEIV11
 21688*    MOVE '&"IL       E          (  N#00020368' TO DFHEIV0
 21689     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21690     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21691     MOVE X'204E233030303230333638' TO DFHEIV0(25:11)
 21692     CALL 'kxdfhei1' USING DFHEIV0,
 21693           LOFC-ID,
 21694           LOAN-OFFICER-MASTER,
 21695           DFHEIV11,
 21696           ERLOFC-KEY,
 21697           DFHEIV99,
 21698           DFHEIV99,
 21699           DFHEIV99
 21700     MOVE EIBRESP  TO WS-RESPONSE
 21701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21702
 21703     IF WS-RESP-NORMAL
 21704        MOVE 'Y'                 TO LOFC-MASTER-SW
 21705     ELSE
 21706        MOVE 'N'                 TO LOFC-MASTER-SW
 21707     END-IF
 21708     .
 21709 8586-EXIT.
 21710     EXIT.
 21711 8587-START-ERPDEF.
 21712
 21713* EXEC CICS STARTBR
 21714*       DATASET   (PDEF-ID)
 21715*       RIDFLD    (ERPDEF-KEY)
 21716*       GTEQ
 21717*       RESP      (WS-RESPONSE)
 21718*    END-EXEC
 21719     MOVE 0
 21720       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 400
* EL050.cbl
 21721*    MOVE '&,         G          &  N#00020384' TO DFHEIV0
 21722     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21723     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21724     MOVE X'204E233030303230333834' TO DFHEIV0(25:11)
 21725     CALL 'kxdfhei1' USING DFHEIV0,
 21726           PDEF-ID,
 21727           ERPDEF-KEY,
 21728           DFHEIV99,
 21729           DFHEIV11,
 21730           DFHEIV99
 21731     MOVE EIBRESP  TO WS-RESPONSE
 21732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21733     IF WS-RESP-NORMAL
 21734        MOVE 'Y'                 TO PDEF-MASTER-SW
 21735     ELSE
 21736        MOVE 'N'                 TO PDEF-MASTER-SW
 21737     END-IF
 21738     .
 21739 8587-EXIT.
 21740     EXIT.
 21741 8588-READ-ERPDEF.
 21742
 21743* EXEC CICS READNEXT
 21744*       DATASET   (PDEF-ID)
 21745*       RIDFLD    (ERPDEF-KEY)
 21746*       INTO      (PRODUCT-MASTER)
 21747*       RESP      (WS-RESPONSE)
 21748*    END-EXEC
 21749     MOVE LENGTH OF
 21750      PRODUCT-MASTER
 21751       TO DFHEIV12
 21752     MOVE 0
 21753       TO DFHEIV11
 21754*    MOVE '&.IL                  )  N#00020399' TO DFHEIV0
 21755     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21756     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21757     MOVE X'204E233030303230333939' TO DFHEIV0(25:11)
 21758     CALL 'kxdfhei1' USING DFHEIV0,
 21759           PDEF-ID,
 21760           PRODUCT-MASTER,
 21761           DFHEIV12,
 21762           ERPDEF-KEY,
 21763           DFHEIV99,
 21764           DFHEIV11,
 21765           DFHEIV99,
 21766           DFHEIV99
 21767     MOVE EIBRESP  TO WS-RESPONSE
 21768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21769     IF WS-RESP-NORMAL
 21770        MOVE 'Y'                 TO PDEF-MASTER-SW
 21771     ELSE
 21772        MOVE 'N'                 TO PDEF-MASTER-SW
 21773     END-IF
 21774     .
 21775 8588-EXIT.
 21776     EXIT.
 21777 8589-ENDBR-ERPDEF.
 21778
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 401
* EL050.cbl
 21779* EXEC CICS ENDBR
 21780*       DATASET   (PDEF-ID)
 21781*    END-EXEC
 21782     MOVE 0
 21783       TO DFHEIV11
 21784*    MOVE '&2                    $   #00020414' TO DFHEIV0
 21785     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21786     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21787     MOVE X'2020233030303230343134' TO DFHEIV0(25:11)
 21788     CALL 'kxdfhei1' USING DFHEIV0,
 21789           PDEF-ID,
 21790           DFHEIV11,
 21791           DFHEIV99
 21792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21793     .
 21794 8589-EXIT.
 21795     EXIT.
 21796 8590-READ-CERT-MASTER.
 21797     IF PB-COMPANY-ID = 'UCL'
 21798         GO TO 8690-READ-CERT-MASTER-UCL.
 21799
 21800
 21801* EXEC CICS HANDLE CONDITION
 21802*         NOTFND    (0299-CERT-NOT-FOUND)
 21803*    END-EXEC.
 21804*    MOVE '"$I                   ! < #00020424' TO DFHEIV0
 21805     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21806     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21807     MOVE X'3C20233030303230343234' TO DFHEIV0(25:11)
 21808     CALL 'kxdfhei1' USING DFHEIV0
 21809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21810
 21811
 21812
 21813* EXEC CICS READ
 21814*        DATASET     (CERT-ID)
 21815*        INTO        (CERTIFICATE-MASTER)
 21816*        RIDFLD      (ELCERT-KEY)
 21817*        UPDATE
 21818*    END-EXEC.
 21819     MOVE LENGTH OF
 21820      CERTIFICATE-MASTER
 21821       TO DFHEIV11
 21822*    MOVE '&"IL       EU         (   #00020428' TO DFHEIV0
 21823     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21824     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21825     MOVE X'2020233030303230343238' TO DFHEIV0(25:11)
 21826     CALL 'kxdfhei1' USING DFHEIV0,
 21827           CERT-ID,
 21828           CERTIFICATE-MASTER,
 21829           DFHEIV11,
 21830           ELCERT-KEY,
 21831           DFHEIV99,
 21832           DFHEIV99,
 21833           DFHEIV99
 21834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21835
 21836
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 402
* EL050.cbl
 21837 8590-EXIT.
 21838     EXIT.
 21839
 21840 8690-READ-CERT-MASTER-UCL.
 21841
 21842* EXEC CICS HANDLE CONDITION
 21843*         NOTFND    (8700-READ-CERT-MASTER)
 21844*    END-EXEC.
 21845*    MOVE '"$I                   ! = #00020439' TO DFHEIV0
 21846     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21847     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21848     MOVE X'3D20233030303230343339' TO DFHEIV0(25:11)
 21849     CALL 'kxdfhei1' USING DFHEIV0
 21850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21851
 21852
 21853 8690-READ-CERT-CONT.
 21854
 21855* EXEC CICS READ
 21856*        DATASET     (CERT-ID)
 21857*        INTO        (CERTIFICATE-MASTER)
 21858*        RIDFLD      (ELCERT-KEY)
 21859*        UPDATE
 21860*    END-EXEC.
 21861     MOVE LENGTH OF
 21862      CERTIFICATE-MASTER
 21863       TO DFHEIV11
 21864*    MOVE '&"IL       EU         (   #00020444' TO DFHEIV0
 21865     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21866     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21867     MOVE X'2020233030303230343434' TO DFHEIV0(25:11)
 21868     CALL 'kxdfhei1' USING DFHEIV0,
 21869           CERT-ID,
 21870           CERTIFICATE-MASTER,
 21871           DFHEIV11,
 21872           ELCERT-KEY,
 21873           DFHEIV99,
 21874           DFHEIV99,
 21875           DFHEIV99
 21876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21877
 21878
 21879     GO TO 8590-EXIT.
 21880
 21881 8700-READ-CERT-MASTER.
 21882     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21883     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21884
 21885* EXEC CICS HANDLE CONDITION
 21886*         DUPKEY    (8720-COMP-ACCOUNTS)
 21887*         ENDFILE   (8730-END-BROWSE)
 21888*         NOTFND    (8740-NOT-FOUND)
 21889*    END-EXEC.
 21890*    MOVE '"$$''I                 ! > #00020456' TO DFHEIV0
 21891     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21893     MOVE X'3E20233030303230343536' TO DFHEIV0(25:11)
 21894     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 403
* EL050.cbl
 21895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21896
 21897
 21898
 21899* EXEC CICS STARTBR
 21900*        DATASET     ('ELCERT5')
 21901*        RIDFLD      (ELCERT2-KEY)
 21902*        EQUAL
 21903*    END-EXEC.
 21904     MOVE 'ELCERT5' TO DFHEIV1
 21905     MOVE 0
 21906       TO DFHEIV11
 21907*    MOVE '&,         E          &   #00020462' TO DFHEIV0
 21908     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21909     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21910     MOVE X'2020233030303230343632' TO DFHEIV0(25:11)
 21911     CALL 'kxdfhei1' USING DFHEIV0,
 21912           DFHEIV1,
 21913           ELCERT2-KEY,
 21914           DFHEIV99,
 21915           DFHEIV11,
 21916           DFHEIV99
 21917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21918
 21919
 21920 8710-READ-NEXT.
 21921
 21922* EXEC CICS READNEXT
 21923*        DATASET     ('ELCERT5')
 21924*        INTO        (CERTIFICATE-MASTER)
 21925*        RIDFLD      (ELCERT2-KEY)
 21926*    END-EXEC.
 21927     MOVE LENGTH OF
 21928      CERTIFICATE-MASTER
 21929       TO DFHEIV12
 21930     MOVE 'ELCERT5' TO DFHEIV1
 21931     MOVE 0
 21932       TO DFHEIV11
 21933*    MOVE '&.IL                  )   #00020469' TO DFHEIV0
 21934     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21935     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21936     MOVE X'2020233030303230343639' TO DFHEIV0(25:11)
 21937     CALL 'kxdfhei1' USING DFHEIV0,
 21938           DFHEIV1,
 21939           CERTIFICATE-MASTER,
 21940           DFHEIV12,
 21941           ELCERT2-KEY,
 21942           DFHEIV99,
 21943           DFHEIV11,
 21944           DFHEIV99,
 21945           DFHEIV99
 21946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21947
 21948
 21949 8720-COMP-ACCOUNTS.
 21950
 21951* EXEC CICS ENTER
 21952*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 404
* EL050.cbl
 21953*         FROM (PB-C-LAST-NAME)
 21954*    END-EXEC.
 21955     MOVE 001
 21956       TO DFHEIV11
 21957*    MOVE ':$F                   %   #00020476' TO DFHEIV0
 21958     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21959     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21960     MOVE X'2020233030303230343736' TO DFHEIV0(25:11)
 21961     CALL 'kxdfhei1' USING DFHEIV0,
 21962           DFHEIV11,
 21963           PB-C-LAST-NAME,
 21964           DFHEIV99,
 21965           DFHEIV99
 21966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21967
 21968
 21969
 21970* EXEC CICS ENTER
 21971*         TRACEID (002)
 21972*         FROM (CM-INSURED-LAST-NAME)
 21973*    END-EXEC.
 21974     MOVE 002
 21975       TO DFHEIV11
 21976*    MOVE ':$F                   %   #00020481' TO DFHEIV0
 21977     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21978     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21979     MOVE X'2020233030303230343831' TO DFHEIV0(25:11)
 21980     CALL 'kxdfhei1' USING DFHEIV0,
 21981           DFHEIV11,
 21982           CM-INSURED-LAST-NAME,
 21983           DFHEIV99,
 21984           DFHEIV99
 21985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21986
 21987
 21988     IF PB-CERT-NO NOT = CM-CERT-NO
 21989         GO TO 8730-END-BROWSE.
 21990
 21991     IF PB-ACCOUNT = CM-ACCOUNT
 21992         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21993             MOVE ER-2799        TO WS-ERROR
 21994             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21995             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21996             GO TO 8730-END-BROWSE.
 21997
 21998     GO TO 8710-READ-NEXT.
 21999
 22000 8730-END-BROWSE.
 22001
 22002* EXEC CICS ENDBR
 22003*         DATASET    ('ELCERT5')
 22004*    END-EXEC.
 22005     MOVE 'ELCERT5' TO DFHEIV1
 22006     MOVE 0
 22007       TO DFHEIV11
 22008*    MOVE '&2                    $   #00020499' TO DFHEIV0
 22009     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22010     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 405
* EL050.cbl
 22011     MOVE X'2020233030303230343939' TO DFHEIV0(25:11)
 22012     CALL 'kxdfhei1' USING DFHEIV0,
 22013           DFHEIV1,
 22014           DFHEIV11,
 22015           DFHEIV99
 22016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22017
 22018
 22019 8740-NOT-FOUND.
 22020     GO TO 0299-CERT-NOT-FOUND.
 22021
 22022 8750-START-ELSTAT.
 22023
 22024* EXEC CICS STARTBR
 22025*       DATASET   (STAT-ID)
 22026*       RIDFLD    (ELSTAT-KEY)
 22027*       GTEQ
 22028*       RESP      (WS-RESPONSE)
 22029*    END-EXEC
 22030     MOVE 0
 22031       TO DFHEIV11
 22032*    MOVE '&,         G          &  N#00020507' TO DFHEIV0
 22033     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22034     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22035     MOVE X'204E233030303230353037' TO DFHEIV0(25:11)
 22036     CALL 'kxdfhei1' USING DFHEIV0,
 22037           STAT-ID,
 22038           ELSTAT-KEY,
 22039           DFHEIV99,
 22040           DFHEIV11,
 22041           DFHEIV99
 22042     MOVE EIBRESP  TO WS-RESPONSE
 22043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22044     IF WS-RESP-NORMAL
 22045        MOVE 'Y'                 TO STAT-MASTER-SW
 22046     ELSE
 22047        MOVE 'N'                 TO STAT-MASTER-SW
 22048     END-IF
 22049     .
 22050 8750-EXIT.
 22051     EXIT.
 22052 8752-READ-ELSTAT.
 22053
 22054* EXEC CICS READNEXT
 22055*       DATASET   (STAT-ID)
 22056*       RIDFLD    (ELSTAT-KEY)
 22057*       INTO      (STATE-FILE)
 22058*       RESP      (WS-RESPONSE)
 22059*    END-EXEC
 22060     MOVE LENGTH OF
 22061      STATE-FILE
 22062       TO DFHEIV12
 22063     MOVE 0
 22064       TO DFHEIV11
 22065*    MOVE '&.IL                  )  N#00020522' TO DFHEIV0
 22066     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22067     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22068     MOVE X'204E233030303230353232' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 406
* EL050.cbl
 22069     CALL 'kxdfhei1' USING DFHEIV0,
 22070           STAT-ID,
 22071           STATE-FILE,
 22072           DFHEIV12,
 22073           ELSTAT-KEY,
 22074           DFHEIV99,
 22075           DFHEIV11,
 22076           DFHEIV99,
 22077           DFHEIV99
 22078     MOVE EIBRESP  TO WS-RESPONSE
 22079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22080     IF WS-RESP-NORMAL
 22081        MOVE 'Y'                 TO STAT-MASTER-SW
 22082     ELSE
 22083        MOVE 'N'                 TO STAT-MASTER-SW
 22084     END-IF
 22085     .
 22086 8752-EXIT.
 22087     EXIT.
 22088 8800-GET-COMP-RATE.
 22089     MOVE +1 TO IB.
 22090     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22091         ADD +9 TO IB
 22092         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22093             ADD +9 TO IB
 22094             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22095                MOVE ZEROS       TO WS-WK-RATE
 22096                GO TO 8800-EXIT.
 22097
 22098     IF PB-I-AGE GREATER CT-AGE (1)
 22099         ADD +3 TO IB
 22100         IF PB-I-AGE GREATER CT-AGE (2)
 22101             ADD +3 TO IB
 22102             IF PB-I-AGE GREATER CT-AGE (3)
 22103                MOVE ZEROS       TO WS-WK-RATE
 22104                GO TO 8800-EXIT.
 22105
 22106     IF WS-WORK-TERM GREATER CT-TRM (1)
 22107         ADD +1 TO IB
 22108         IF WS-WORK-TERM GREATER CT-TRM (2)
 22109             ADD +1 TO IB
 22110             IF WS-WORK-TERM GREATER CT-TRM (3)
 22111                MOVE ZEROS       TO WS-WK-RATE
 22112                GO TO 8800-EXIT.
 22113
 22114     IF CT-RT (IB) NOT NUMERIC
 22115         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22116         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22117         GO TO 8800-GET-COMP-RATE.
 22118
 22119     MOVE CT-RT (IB) TO WS-WK-RATE.
 22120
 22121 8800-EXIT.
 22122     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 407
* EL050.cbl
 22124 8900-ADDRESS-FILE.
 22125     IF ERACCT-FILE-ADDRESSED
 22126         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22127         GO TO 8900-ADDRESS-EXIT.
 22128
 22129     IF ELCNTL-FILE-ADDRESSED
 22130         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22131         GO TO 8900-ADDRESS-EXIT.
 22132
 22133     IF ERPLAN-FILE-ADDRESSED
 22134         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22135         GO TO 8900-ADDRESS-EXIT.
 22136
 22137     IF ERFORM-FILE-ADDRESSED
 22138         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22139         GO TO 8900-ADDRESS-EXIT.
 22140
 22141 8900-ADDRESS-EXIT.
 22142     EXIT.
 22143
 22144 9000-READ-CONTROL.
 22145
 22146* EXEC CICS HANDLE CONDITION
 22147*        NOTFND    (9000-NOTFND)
 22148*    END-EXEC.
 22149*    MOVE '"$I                   ! ? #00020593' TO DFHEIV0
 22150     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22151     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22152     MOVE X'3F20233030303230353933' TO DFHEIV0(25:11)
 22153     CALL 'kxdfhei1' USING DFHEIV0
 22154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22155
 22156
 22157
 22158* EXEC CICS READ
 22159*        DATASET     (CNTL-ID)
 22160*        SET         (ADDRESS OF CONTROL-FILE)
 22161*        RIDFLD      (ELCNTL-KEY)
 22162*        GTEQ
 22163*    END-EXEC.
 22164*    MOVE '&"S        G          (   #00020597' TO DFHEIV0
 22165     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22166     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22167     MOVE X'2020233030303230353937' TO DFHEIV0(25:11)
 22168     CALL 'kxdfhei1' USING DFHEIV0,
 22169           CNTL-ID,
 22170           DFHEIV20,
 22171           DFHEIV99,
 22172           ELCNTL-KEY,
 22173           DFHEIV99,
 22174           DFHEIV99,
 22175           DFHEIV99
 22176     SET ADDRESS OF CONTROL-FILE TO
 22177         DFHEIV20
 22178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22179
 22180
 22181     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 408
* EL050.cbl
 22182
 22183 9000-NOTFND.
 22184     IF RC-SW-1 = '1'
 22185        MOVE ER-2616              TO WS-ERROR
 22186        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22187        GO TO 9000-EXIT.
 22188
 22189     IF RC-SW-1 = '2'
 22190        MOVE ER-2602              TO WS-ERROR
 22191        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22192
 22193 9000-EXIT.
 22194      EXIT.
 22195
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 409
* EL050.cbl
 22197 9100-READ-CONTROL.
 22198
 22199* EXEC CICS HANDLE CONDITION
 22200*        NOTFND  (9100-NOTFND)
 22201*        ENDFILE (9100-NOTFND)
 22202*    END-EXEC.
 22203*    MOVE '"$I''                  ! @ #00020621' TO DFHEIV0
 22204     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22205     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22206     MOVE X'4020233030303230363231' TO DFHEIV0(25:11)
 22207     CALL 'kxdfhei1' USING DFHEIV0
 22208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22209
 22210
 22211
 22212* EXEC CICS READ
 22213*        DATASET     (CNTL-ID)
 22214*        INTO        (CONTROL-FILE)
 22215*        RIDFLD      (ELCNTL-KEY)
 22216*        GTEQ
 22217*    END-EXEC.
 22218     MOVE LENGTH OF
 22219      CONTROL-FILE
 22220       TO DFHEIV11
 22221*    MOVE '&"IL       G          (   #00020626' TO DFHEIV0
 22222     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22223     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22224     MOVE X'2020233030303230363236' TO DFHEIV0(25:11)
 22225     CALL 'kxdfhei1' USING DFHEIV0,
 22226           CNTL-ID,
 22227           CONTROL-FILE,
 22228           DFHEIV11,
 22229           ELCNTL-KEY,
 22230           DFHEIV99,
 22231           DFHEIV99,
 22232           DFHEIV99
 22233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22234
 22235
 22236     GO TO 9100-EXIT.
 22237
 22238 9100-NOTFND.
 22239     IF RC-SW-2 = '0'
 22240        MOVE '1'                  TO STATE-RECORD-ERROR
 22241        GO TO 9100-EXIT
 22242     END-IF
 22243     IF RC-SW-2 = '1'
 22244        MOVE '1'                  TO LF-BENEFIT-ERROR
 22245        MOVE ER-2604              TO WS-ERROR
 22246        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22247        GO TO 9100-EXIT.
 22248
 22249     IF RC-SW-2 = '2'
 22250        MOVE '1'                  TO AH-BENEFIT-ERROR
 22251        MOVE ER-2605              TO WS-ERROR
 22252        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22253        GO TO 9100-EXIT.
 22254
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 410
* EL050.cbl
 22255     IF RC-SW-2 = '3'
 22256         MOVE ER-2603           TO WS-ERROR
 22257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22258         GO TO 9100-EXIT.
 22259
 22260     IF RC-SW-2 = '4'
 22261         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22262         GO TO 9100-EXIT.
 22263
 22264     IF RC-SW-2 = '5'
 22265         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22266         IF WS-AH-INPUT-CD-1 = SPACE
 22267             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22268         ELSE
 22269             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22270
 22271 9100-EXIT.
 22272      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 411
* EL050.cbl
 22274 9200-CONTROL-GETMAIN.
 22275
 22276* EXEC CICS GETMAIN
 22277*         LENGTH   (750)
 22278*         SET      (ADDRESS OF CONTROL-FILE)
 22279*    END-EXEC.
 22280     MOVE 750
 22281       TO DFHEIV11
 22282*    MOVE '," L                  $   #00020672' TO DFHEIV0
 22283     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22284     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22285     MOVE X'2020233030303230363732' TO DFHEIV0(25:11)
 22286     CALL 'kxdfhei1' USING DFHEIV0,
 22287           DFHEIV20,
 22288           DFHEIV11,
 22289           DFHEIV99
 22290     SET ADDRESS OF CONTROL-FILE TO
 22291         DFHEIV20
 22292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22293
 22294
 22295     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22296
 22297 9200-EXIT.
 22298     EXIT.
 22299
 22300 9250-UNLOCK-RETURN.
 22301
 22302* EXEC CICS UNLOCK
 22303*        DATASET   (CERT-ID)
 22304*    END-EXEC.
 22305*    MOVE '&*                    #   #00020683' TO DFHEIV0
 22306     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22307     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22308     MOVE X'2020233030303230363833' TO DFHEIV0(25:11)
 22309     CALL 'kxdfhei1' USING DFHEIV0,
 22310           CERT-ID,
 22311           DFHEIV99
 22312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22313
 22314
 22315 9300-ABEND.
 22316     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22317
 22318
 22319* EXEC CICS LINK
 22320*        PROGRAM   ('EL004')
 22321*        COMMAREA  (WS-ERROR-LINE)
 22322*        LENGTH    (72)
 22323*    END-EXEC.
 22324     MOVE 'EL004' TO DFHEIV1
 22325     MOVE 72
 22326       TO DFHEIV11
 22327*    MOVE '."C                   (   #00020690' TO DFHEIV0
 22328     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22329     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22330     MOVE X'2020233030303230363930' TO DFHEIV0(25:11)
 22331     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 412
* EL050.cbl
 22332           DFHEIV1,
 22333           WS-ERROR-LINE,
 22334           DFHEIV11,
 22335           DFHEIV99,
 22336           DFHEIV99,
 22337           DFHEIV99,
 22338           DFHEIV99
 22339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22340
 22341
 22342     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22343
 22344
 22345* EXEC CICS ABEND
 22346*        ABCODE ('EL50')
 22347*    END-EXEC.
 22348     MOVE 'EL50' TO DFHEIV5
 22349*    MOVE '.,A                   "   #00020698' TO DFHEIV0
 22350     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22351     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22352     MOVE X'2020233030303230363938' TO DFHEIV0(25:11)
 22353     CALL 'kxdfhei1' USING DFHEIV0,
 22354           DFHEIV5
 22355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22356
 22357
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 413
* EL050.cbl
 22359
 22360******************************************************************
 22361*                                                                *
 22362*            E R R O R   F O R M A T   R O U T I N E             *
 22363*                                                                *
 22364******************************************************************
 22365
 22366 9900-ERROR-FORMAT.
 22367
 22368     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22369                    PB-COMMON-ERROR (2) OR
 22370                    PB-COMMON-ERROR (3) OR
 22371                    PB-COMMON-ERROR (4) OR
 22372                    PB-COMMON-ERROR (5) OR
 22373                    PB-COMMON-ERROR (6) OR
 22374                    PB-COMMON-ERROR (7) OR
 22375                    PB-COMMON-ERROR (8) OR
 22376                    PB-COMMON-ERROR (9) OR
 22377                    PB-COMMON-ERROR (10)
 22378        GO TO 9900-EXIT.
 22379
 22380     IF PB-NO-OF-ERRORS = +10
 22381        GO TO 9900-EXIT.
 22382
 22383     ADD +1  TO PB-NO-OF-ERRORS.
 22384     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22385                                       (PB-NO-OF-ERRORS).
 22386 9900-EXIT.
 22387     EXIT.
 22388
 22389 9990-RETURN.
 22390     IF BROWSE-STARTED
 22391
 22392* EXEC CICS ENDBR
 22393*            DATASET  (ACCT-ID)
 22394*       END-EXEC.
 22395     MOVE 0
 22396       TO DFHEIV11
 22397*    MOVE '&2                    $   #00020735' TO DFHEIV0
 22398     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22399     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22400     MOVE X'2020233030303230373335' TO DFHEIV0(25:11)
 22401     CALL 'kxdfhei1' USING DFHEIV0,
 22402           ACCT-ID,
 22403           DFHEIV11,
 22404           DFHEIV99
 22405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22406
 22407
 22408 9990-EXIT.
 22409     EXIT.
 22410
 22411
 22412****Check for CRTO record, add one if not found.
 22413 9991-CHECK-FOR-ELCRTO.
 22414
 22415* EXEC CICS HANDLE CONDITION
 22416*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 414
* EL050.cbl
 22417*         ENDFILE (9991-CRTO-NOT-FOUND)
 22418*     END-EXEC.
 22419*    MOVE '"$I''                  ! A #00020745' TO DFHEIV0
 22420     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22421     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22422     MOVE X'4120233030303230373435' TO DFHEIV0(25:11)
 22423     CALL 'kxdfhei1' USING DFHEIV0
 22424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22425
 22426     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22427     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22428     MOVE +0                     TO ELCRTO-SEQ-NO
 22429
 22430
 22431* EXEC CICS READ
 22432*       DATASET   ('ELCRTO')
 22433*       INTO      (ORIGINAL-CERTIFICATE)
 22434*       RIDFLD    (ELCRTO-KEY)
 22435*       GTEQ
 22436*       RESP      (WS-RESPONSE)
 22437*    END-EXEC
 22438     MOVE LENGTH OF
 22439      ORIGINAL-CERTIFICATE
 22440       TO DFHEIV11
 22441     MOVE 'ELCRTO' TO DFHEIV1
 22442*    MOVE '&"IL       G          (  N#00020753' TO DFHEIV0
 22443     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22444     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22445     MOVE X'204E233030303230373533' TO DFHEIV0(25:11)
 22446     CALL 'kxdfhei1' USING DFHEIV0,
 22447           DFHEIV1,
 22448           ORIGINAL-CERTIFICATE,
 22449           DFHEIV11,
 22450           ELCRTO-KEY,
 22451           DFHEIV99,
 22452           DFHEIV99,
 22453           DFHEIV99
 22454     MOVE EIBRESP  TO WS-RESPONSE
 22455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22456
 22457     IF WS-RESP-NORMAL
 22458        AND (OC-CONTROL-PRIMARY (1:33) =
 22459                 PB-CONTROL-BY-ACCOUNT (1:33))
 22460        AND (OC-RECORD-TYPE =  'I')
 22461           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22462               GO TO 9991-CHECK-INDICATORS
 22463           ELSE
 22464               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22465               GO TO 9991-CRTO-ADD-REC
 22466           END-IF
 22467     END-IF.
 22468
 22469 9991-CRTO-NOT-FOUND.
 22470
 22471     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22472     MOVE 'OC'                TO OC-RECORD-ID
 22473     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22474                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 415
* EL050.cbl
 22475     MOVE +4096               TO OC-KEY-SEQ-NO.
 22476
 22477 9991-CRTO-ADD-REC.
 22478
 22479     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22480     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22481     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22482     MOVE 'I'                 TO OC-RECORD-TYPE
 22483     IF PB-ISSUE
 22484         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22485         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22486         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22487         MOVE PB-I-AGE               TO OC-INS-AGE
 22488         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22489         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22490         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22491         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22492         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22493         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22494         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22495         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22496         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22497         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22498         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22499         IF PB-I-JOINT-COMMISSION > +0
 22500             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22501         ELSE
 22502             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22503         END-IF
 22504         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22505         MOVE +0                     TO OC-LF-CANCEL-AMT
 22506                                        OC-LF-ITD-CANCEL-AMT
 22507         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22508         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22509         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22510         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22511         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22512         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22513         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22514         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22515         MOVE +0                     TO OC-AH-CANCEL-AMT
 22516                                        OC-AH-ITD-CANCEL-AMT
 22517         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22518         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22519         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22520     ELSE
 22521         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22522         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22523         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22524         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22525         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22526         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22527         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22528         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22529         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22530          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22531             MOVE SPACES             TO OC-LF-BENCD
 22532             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 416
* EL050.cbl
 22533                                        OC-LF-BEN-AMT
 22534                                        OC-LF-PRM-AMT
 22535                                        OC-LF-ALT-BEN-AMT
 22536                                        OC-LF-ALT-PRM-AMT
 22537                                        OC-LF-COMM-PCT
 22538                                        OC-LF-CANCEL-AMT
 22539             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22540             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22541         ELSE
 22542             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22543             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22544             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22545             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22546             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22547             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22548             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22549             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22550             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22551             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22552         END-IF
 22553         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22554         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22555          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22556             MOVE SPACES             TO OC-AH-BENCD
 22557             MOVE ZEROS              TO OC-AH-TERM
 22558                                        OC-AH-BEN-AMT
 22559                                        OC-AH-PRM-AMT
 22560                                        OC-AH-COMM-PCT
 22561                                        OC-AH-CANCEL-AMT
 22562                                        OC-AH-CP
 22563             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22564             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22565         ELSE
 22566             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22567             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22568             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22569             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22570             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22571             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22572             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22573             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22574             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22575         END-IF
 22576         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22577         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22578         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22579         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22580     END-IF
 22581     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22582
 22583     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22584
 22585
 22586* EXEC CICS READ
 22587*         DATASET   (FILE-ERMAIL)
 22588*         RIDFLD    (MA-CONTROL-PRIMARY)
 22589*         INTO      (MAILING-DATA)
 22590*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 417
* EL050.cbl
 22591*    END-EXEC
 22592     MOVE LENGTH OF
 22593      MAILING-DATA
 22594       TO DFHEIV11
 22595*    MOVE '&"IL       E          (  N#00020889' TO DFHEIV0
 22596     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22597     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22598     MOVE X'204E233030303230383839' TO DFHEIV0(25:11)
 22599     CALL 'kxdfhei1' USING DFHEIV0,
 22600           FILE-ERMAIL,
 22601           MAILING-DATA,
 22602           DFHEIV11,
 22603           MA-CONTROL-PRIMARY,
 22604           DFHEIV99,
 22605           DFHEIV99,
 22606           DFHEIV99
 22607     MOVE EIBRESP  TO WS-RESPONSE
 22608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22609
 22610     IF WS-RESP-NORMAL
 22611         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22612     END-IF.
 22613
 22614     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22615     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22616
 22617
 22618* EXEC CICS READ
 22619*         DATASET  (CRTT-ID)
 22620*         RIDFLD   (WS-ELCRTT-KEY)
 22621*         INTO     (CERTIFICATE-TRAILERS)
 22622*         RESP     (WS-RESPONSE)
 22623*    END-EXEC
 22624     MOVE LENGTH OF
 22625      CERTIFICATE-TRAILERS
 22626       TO DFHEIV11
 22627*    MOVE '&"IL       E          (  N#00020903' TO DFHEIV0
 22628     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22629     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22630     MOVE X'204E233030303230393033' TO DFHEIV0(25:11)
 22631     CALL 'kxdfhei1' USING DFHEIV0,
 22632           CRTT-ID,
 22633           CERTIFICATE-TRAILERS,
 22634           DFHEIV11,
 22635           WS-ELCRTT-KEY,
 22636           DFHEIV99,
 22637           DFHEIV99,
 22638           DFHEIV99
 22639     MOVE EIBRESP  TO WS-RESPONSE
 22640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22641
 22642     IF WS-RESP-NORMAL
 22643         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22644         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22645     END-IF.
 22646
 22647
 22648* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 418
* EL050.cbl
 22649*       DATASET   ('ELCRTO')
 22650*       FROM      (ORIGINAL-CERTIFICATE)
 22651*       RIDFLD    (OC-CONTROL-PRIMARY)
 22652*       RESP      (WS-RESPONSE)
 22653*    END-EXEC.
 22654     MOVE LENGTH OF
 22655      ORIGINAL-CERTIFICATE
 22656       TO DFHEIV11
 22657     MOVE 'ELCRTO' TO DFHEIV1
 22658*    MOVE '&$ L                  ''  N#00020915' TO DFHEIV0
 22659     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22660     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22661     MOVE X'204E233030303230393135' TO DFHEIV0(25:11)
 22662     CALL 'kxdfhei1' USING DFHEIV0,
 22663           DFHEIV1,
 22664           ORIGINAL-CERTIFICATE,
 22665           DFHEIV11,
 22666           OC-CONTROL-PRIMARY,
 22667           DFHEIV99,
 22668           DFHEIV99
 22669     MOVE EIBRESP  TO WS-RESPONSE
 22670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22671
 22672
 22673     GO TO 9991-EXIT.
 22674
 22675 9991-CHECK-INDICATORS.
 22676
 22677     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22678         GO TO 9991-EXIT
 22679     END-IF.
 22680
 22681     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22682         GO TO 9991-EXIT
 22683     END-IF.
 22684
 22685
 22686* EXEC CICS READ
 22687*       DATASET   ('ELCRTO')
 22688*       INTO      (ORIGINAL-CERTIFICATE)
 22689*       RIDFLD    (OC-CONTROL-PRIMARY)
 22690*       UPDATE
 22691*       RESP      (WS-RESPONSE)
 22692*    END-EXEC
 22693     MOVE LENGTH OF
 22694      ORIGINAL-CERTIFICATE
 22695       TO DFHEIV11
 22696     MOVE 'ELCRTO' TO DFHEIV1
 22697*    MOVE '&"IL       EU         (  N#00020934' TO DFHEIV0
 22698     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22699     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22700     MOVE X'204E233030303230393334' TO DFHEIV0(25:11)
 22701     CALL 'kxdfhei1' USING DFHEIV0,
 22702           DFHEIV1,
 22703           ORIGINAL-CERTIFICATE,
 22704           DFHEIV11,
 22705           OC-CONTROL-PRIMARY,
 22706           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 419
* EL050.cbl
 22707           DFHEIV99,
 22708           DFHEIV99
 22709     MOVE EIBRESP  TO WS-RESPONSE
 22710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22711     IF WS-RESP-NORMAL
 22712        IF PB-ISSUE
 22713          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22714          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22715          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22716          MOVE PB-I-AGE               TO OC-INS-AGE
 22717          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22718          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22719          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22720          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22721          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22722          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22723          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22724          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22725          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22726          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22727          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22728          IF PB-I-JOINT-COMMISSION > +0
 22729              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22730          ELSE
 22731              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22732          END-IF
 22733          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22734          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22735          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22736          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22737          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22738          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22739          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22740          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22741          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22742
 22743          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22744
 22745* EXEC CICS READ
 22746*             DATASET   (FILE-ERMAIL)
 22747*             RIDFLD    (MA-CONTROL-PRIMARY)
 22748*             INTO      (MAILING-DATA)
 22749*             RESP      (WS-RESPONSE)
 22750*         END-EXEC
 22751     MOVE LENGTH OF
 22752      MAILING-DATA
 22753       TO DFHEIV11
 22754*    MOVE '&"IL       E          (  N#00020974' TO DFHEIV0
 22755     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22756     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22757     MOVE X'204E233030303230393734' TO DFHEIV0(25:11)
 22758     CALL 'kxdfhei1' USING DFHEIV0,
 22759           FILE-ERMAIL,
 22760           MAILING-DATA,
 22761           DFHEIV11,
 22762           MA-CONTROL-PRIMARY,
 22763           DFHEIV99,
 22764           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 420
* EL050.cbl
 22765           DFHEIV99
 22766     MOVE EIBRESP  TO WS-RESPONSE
 22767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22768          IF WS-RESP-NORMAL
 22769             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22770          END-IF
 22771
 22772          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22773          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22774
 22775* EXEC CICS READ
 22776*             DATASET  (CRTT-ID)
 22777*             RIDFLD   (WS-ELCRTT-KEY)
 22778*             INTO     (CERTIFICATE-TRAILERS)
 22779*             RESP     (WS-RESPONSE)
 22780*         END-EXEC
 22781     MOVE LENGTH OF
 22782      CERTIFICATE-TRAILERS
 22783       TO DFHEIV11
 22784*    MOVE '&"IL       E          (  N#00020986' TO DFHEIV0
 22785     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22787     MOVE X'204E233030303230393836' TO DFHEIV0(25:11)
 22788     CALL 'kxdfhei1' USING DFHEIV0,
 22789           CRTT-ID,
 22790           CERTIFICATE-TRAILERS,
 22791           DFHEIV11,
 22792           WS-ELCRTT-KEY,
 22793           DFHEIV99,
 22794           DFHEIV99,
 22795           DFHEIV99
 22796     MOVE EIBRESP  TO WS-RESPONSE
 22797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22798          IF WS-RESP-NORMAL
 22799             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22800                               OC-INS-AGE-DEFAULT-FLAG
 22801             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22802                               OC-JNT-AGE-DEFAULT-FLAG
 22803          END-IF
 22804
 22805        ELSE
 22806          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22807             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22808             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22809             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22810          END-IF
 22811          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22812             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22813             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22814             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22815          END-IF
 22816          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22817        END-IF
 22818
 22819* EXEC CICS REWRITE
 22820*          DATASET   ('ELCRTO')
 22821*          FROM      (ORIGINAL-CERTIFICATE)
 22822*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 421
* EL050.cbl
 22823*       END-EXEC
 22824     MOVE LENGTH OF
 22825      ORIGINAL-CERTIFICATE
 22826       TO DFHEIV11
 22827     MOVE 'ELCRTO' TO DFHEIV1
 22828*    MOVE '&& L                  %  N#00021012' TO DFHEIV0
 22829     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22830     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22831     MOVE X'204E233030303231303132' TO DFHEIV0(25:11)
 22832     CALL 'kxdfhei1' USING DFHEIV0,
 22833           DFHEIV1,
 22834           ORIGINAL-CERTIFICATE,
 22835           DFHEIV11,
 22836           DFHEIV99
 22837     MOVE EIBRESP  TO WS-RESPONSE
 22838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22839     END-IF.
 22840
 22841 9991-EXIT.
 22842     EXIT.
 22843
 22844
 22845 9999-RETURN.
 22846     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22847
 22848
 22849* EXEC CICS RETURN
 22850*    END-EXEC.
 22851*    MOVE '.(                    ''   #00021026' TO DFHEIV0
 22852     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22853     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22854     MOVE X'2020233030303231303236' TO DFHEIV0(25:11)
 22855     CALL 'kxdfhei1' USING DFHEIV0,
 22856           DFHEIV99,
 22857           DFHEIV99,
 22858           DFHEIV99,
 22859           DFHEIV99,
 22860           DFHEIV99,
 22861           DFHEIV99
 22862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22863
 22864
 22865
 22866* GOBACK.
 22867     MOVE '9%                    "   ' TO DFHEIV0
 22868     MOVE 'EL050' TO DFHEIV1
 22869     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22870     GOBACK.
 22871
 22872 9999-DFHBACK SECTION.
 22873     MOVE '9%                    "   ' TO DFHEIV0
 22874     MOVE 'EL050' TO DFHEIV1
 22875     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22876     GOBACK.
 22877 9999-DFHEXIT.
 22878     IF DFHEIGDJ EQUAL 0001
 22879         NEXT SENTENCE
 22880     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 422
* EL050.cbl
 22881         GO TO 9300-ABEND,
 22882               3990-FILES-NOT-OPEN
 22883         DEPENDING ON DFHEIGDI
 22884     ELSE IF DFHEIGDJ EQUAL 3
 22885         GO TO 6610-START-BROWSE,
 22886               6630-ERRESS-PROBLEM,
 22887               6630-END-OF-FILE
 22888         DEPENDING ON DFHEIGDI
 22889     ELSE IF DFHEIGDJ EQUAL 4
 22890         GO TO 6630-END-OF-FILE,
 22891               6630-ERRESS-PROBLEM,
 22892               6630-ERRESS-PROBLEM,
 22893               6630-END-OF-FILE
 22894         DEPENDING ON DFHEIGDI
 22895     ELSE IF DFHEIGDJ EQUAL 5
 22896         GO TO 6630-END-OF-FILE,
 22897               6630-END-OF-FILE,
 22898               6630-ERRESS-PROBLEM,
 22899               6630-ERRESS-PROBLEM
 22900         DEPENDING ON DFHEIGDI
 22901     ELSE IF DFHEIGDJ EQUAL 6
 22902         GO TO 6660-START-BROWSE,
 22903               6690-ERRESC-PROBLEM,
 22904               6690-ERRESC-PROBLEM,
 22905               6690-END-OF-FILE
 22906         DEPENDING ON DFHEIGDI
 22907     ELSE IF DFHEIGDJ EQUAL 7
 22908         GO TO 6690-END-OF-FILE,
 22909               6690-ERRESC-PROBLEM,
 22910               6690-ERRESC-PROBLEM,
 22911               6690-END-OF-FILE
 22912         DEPENDING ON DFHEIGDI
 22913     ELSE IF DFHEIGDJ EQUAL 8
 22914         GO TO 6690-END-OF-FILE,
 22915               6690-ERRESC-PROBLEM,
 22916               6690-ERRESC-PROBLEM,
 22917               6690-END-OF-FILE
 22918         DEPENDING ON DFHEIGDI
 22919     ELSE IF DFHEIGDJ EQUAL 9
 22920         GO TO 7250-CONTINUE,
 22921               7250-CONTINUE
 22922         DEPENDING ON DFHEIGDI
 22923     ELSE IF DFHEIGDJ EQUAL 10
 22924         GO TO 7300-CONTINUE,
 22925               7300-CONTINUE
 22926         DEPENDING ON DFHEIGDI
 22927     ELSE IF DFHEIGDJ EQUAL 11
 22928         GO TO 8000-FREE-MAIN
 22929         DEPENDING ON DFHEIGDI
 22930     ELSE IF DFHEIGDJ EQUAL 12
 22931         GO TO 8100-NOTFND,
 22932               8100-NOTFND
 22933         DEPENDING ON DFHEIGDI
 22934     ELSE IF DFHEIGDJ EQUAL 13
 22935         GO TO 8110-NOTFND,
 22936               8110-NOTFND
 22937         DEPENDING ON DFHEIGDI
 22938     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 423
* EL050.cbl
 22939         GO TO 8130-EXIT
 22940         DEPENDING ON DFHEIGDI
 22941     ELSE IF DFHEIGDJ EQUAL 15
 22942         GO TO 8150-exit
 22943         DEPENDING ON DFHEIGDI
 22944     ELSE IF DFHEIGDJ EQUAL 16
 22945         GO TO 8180-NOTFND
 22946         DEPENDING ON DFHEIGDI
 22947     ELSE IF DFHEIGDJ EQUAL 17
 22948         GO TO 8190-NOTFND
 22949         DEPENDING ON DFHEIGDI
 22950     ELSE IF DFHEIGDJ EQUAL 18
 22951         GO TO 8195-NOTFND
 22952         DEPENDING ON DFHEIGDI
 22953     ELSE IF DFHEIGDJ EQUAL 19
 22954         GO TO 8200-NOTFND
 22955         DEPENDING ON DFHEIGDI
 22956     ELSE IF DFHEIGDJ EQUAL 20
 22957         GO TO 8300-NOTFND,
 22958               8300-ERRESS-PROBLEM,
 22959               8300-ERRESS-PROBLEM,
 22960               8300-NOTFND
 22961         DEPENDING ON DFHEIGDI
 22962     ELSE IF DFHEIGDJ EQUAL 21
 22963         GO TO 8450-FORM-NOT-FOUND,
 22964               8450-FORM-NOT-FOUND
 22965         DEPENDING ON DFHEIGDI
 22966     ELSE IF DFHEIGDJ EQUAL 22
 22967         GO TO 0199-ACCT-NOT-FOUND,
 22968               0199-ACCT-NOT-FOUND
 22969         DEPENDING ON DFHEIGDI
 22970     ELSE IF DFHEIGDJ EQUAL 23
 22971         GO TO 0199-ACCT-NOT-FOUND,
 22972               0199-ACCT-NOT-FOUND
 22973         DEPENDING ON DFHEIGDI
 22974     ELSE IF DFHEIGDJ EQUAL 24
 22975         GO TO 8582-COMP-NOT-FOUND,
 22976               8582-COMP-NOT-FOUND
 22977         DEPENDING ON DFHEIGDI
 22978     ELSE IF DFHEIGDJ EQUAL 25
 22979         GO TO 8583-AGTC-NOT-FOUND,
 22980               8583-AGTC-NOT-FOUND
 22981         DEPENDING ON DFHEIGDI
 22982     ELSE IF DFHEIGDJ EQUAL 26
 22983         GO TO 8584-BXRF-NOT-FOUND,
 22984               8584-BXRF-NOT-FOUND
 22985         DEPENDING ON DFHEIGDI
 22986     ELSE IF DFHEIGDJ EQUAL 27
 22987         GO TO 8585-PLAN-NOT-FOUND,
 22988               8585-PLAN-NOT-FOUND
 22989         DEPENDING ON DFHEIGDI
 22990     ELSE IF DFHEIGDJ EQUAL 28
 22991         GO TO 0299-CERT-NOT-FOUND
 22992         DEPENDING ON DFHEIGDI
 22993     ELSE IF DFHEIGDJ EQUAL 29
 22994         GO TO 8700-READ-CERT-MASTER
 22995         DEPENDING ON DFHEIGDI
 22996     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 11-Dec-17 15:09 Page 424
* EL050.cbl
 22997         GO TO 8720-COMP-ACCOUNTS,
 22998               8730-END-BROWSE,
 22999               8740-NOT-FOUND
 23000         DEPENDING ON DFHEIGDI
 23001     ELSE IF DFHEIGDJ EQUAL 31
 23002         GO TO 9000-NOTFND
 23003         DEPENDING ON DFHEIGDI
 23004     ELSE IF DFHEIGDJ EQUAL 32
 23005         GO TO 9100-NOTFND,
 23006               9100-NOTFND
 23007         DEPENDING ON DFHEIGDI
 23008     ELSE IF DFHEIGDJ EQUAL 33
 23009         GO TO 9991-CRTO-NOT-FOUND,
 23010               9991-CRTO-NOT-FOUND
 23011         DEPENDING ON DFHEIGDI.
 23012     MOVE '9%                    "   ' TO DFHEIV0
 23013     MOVE 'EL050' TO DFHEIV1
 23014     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23015     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41680     Code:       94447
